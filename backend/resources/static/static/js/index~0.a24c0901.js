/*
 * Copyright 2025 coze-dev Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";(self.webpackChunk_coze_studio_app=self.webpackChunk_coze_studio_app||[]).push([["6882"],{270086:function(e,t,r){r.d(t,{U:()=>k});var n=r("151064"),a=r("664319"),o=r("252237"),i=r.n(o),s=r("552995"),l=r("295252"),c=r("589872"),d=r("808431"),u=r("803926"),v=r("407821"),m=r.n(v),g=r("472772"),p=r.n(g),f=r("395245"),h=r.n(f),_=r("297998"),x=r.n(_),y=r("646576"),b=r.n(y),S=r("606121"),C=r.n(S),j=r("916167"),w={};w.styleTagTransform=C(),w.setAttributes=x(),w.insert=h().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=b(),m()(j.Z,w);var E=j.Z&&j.Z.locals?j.Z.locals:void 0,k=()=>{var{messageWidth:e}=(0,d.F)(),t=(0,l.r)(),{loadEagerly:r}=(0,u.jM)(),{useMessageIndexStore:o}=(0,c.N)(),{nextHasMore:v,scrollViewFarFromBottom:m}=o((0,a.N)(e=>({nextHasMore:e.nextHasMore,scrollViewFarFromBottom:e.scrollViewFarFromBottom})));return(0,n.jsx)(s.FH,{alignWidth:e,className:E.aligner,children:(0,n.jsx)(s.Y$,{onClick:r,className:i()(E.tip),show:v||m,showBackground:t})})};k.displayName="ToNewestTip"},933457:function(e,t,r){r.d(t,{w:()=>k});var n=r("151064"),a=r("664319"),o=r("252237"),i=r.n(o),s=r("552995"),l=e=>{var{bizTheme:t}=e;return"home"===t?"whiteness":"grey"},c=r("295252"),d=r("589872"),u=r("808431"),v=r("407821"),m=r.n(v),g=r("472772"),p=r.n(g),f=r("395245"),h=r.n(f),_=r("297998"),x=r.n(_),y=r("646576"),b=r.n(y),S=r("606121"),C=r.n(S),j=r("647110"),w={};w.styleTagTransform=C(),w.setAttributes=x(),w.insert=h().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=b(),m()(j.Z,w);var E=j.Z&&j.Z.locals?j.Z.locals:void 0,k=()=>{var{messageWidth:e,layout:t,theme:r}=(0,u.F)(),{configs:o}=(0,d.Q)(),{useWaitingStore:v,useSenderInfoStore:m,useMessagesStore:g}=(0,d.N)(),p=m((0,a.N)(e=>{var t=e.waitingSenderId||Object.keys(e.botInfoMap).at(0);return e.getBotInfo(t)})),{waiting:f}=v((0,a.N)(e=>{var t;return{waiting:!!e.waiting&&!(null===(t=e.responding)||void 0===t?void 0:t.response.length)}})),{functionCallLength:h,llmLength:_}=g((0,a.N)(e=>{var t,r=null===(t=e.messageGroupList.at(0))||void 0===t?void 0:t.memberSet;return{functionCallLength:null==r?void 0:r.functionCallMessageIdList.length,llmLength:null==r?void 0:r.llmAnswerMessageIdList.length}})),x=(0,c.r)(),y=(null==o?void 0:o.showFunctionCallDetail)?!h&&!_:!_,{selectable:b}=(0,u.F)();return f?(0,n.jsx)("div",{"data-testid":"chat-area.waiting-generating-loading",className:i()(E["dot-wrapper"],{[E["dot-wrapper-selectable"]]:b,[E["dot-wrapper-no-avatar"]]:!y}),style:{width:e},children:(0,n.jsx)(s._p,{messageId:null,theme:"none",senderInfo:p||{id:""},showUserInfo:y,getBotInfo:m.getState().getBotInfo,layout:t,showBackground:x,children:(0,n.jsx)(s.H0,{theme:l({bizTheme:r}),showBackground:x})})}):null}},899100:function(e,t,r){r.d(t,{i:()=>b});var n=r("151064"),a=r("252237"),o=r.n(a),i=r("407821"),s=r.n(i),l=r("472772"),c=r.n(l),d=r("395245"),u=r.n(d),v=r("297998"),m=r.n(v),g=r("646576"),p=r.n(g),f=r("606121"),h=r.n(f),_=r("846324"),x={};x.styleTagTransform=h(),x.setAttributes=m(),x.insert=u().bind(null,"head"),x.domAPI=c(),x.insertStyleElement=p(),s()(_.Z,x);var y=_.Z&&_.Z.locals?_.Z.locals:void 0,b=e=>{var{children:t,className:r}=e;return(0,n.jsx)("div",{className:o()(y.wrapper,"common-wrapper",r),children:t})}},417964:function(e,t,r){r.d(t,{x:function(){return i}});var n=r(336205),a=r(341665),o=r(519698),i=()=>({[a.CE.TEXT]:{enable:!0},[a.CE.IMAGE]:{enable:!0},[a.CE.CARD]:{enable:!0,copywriting:{empty:{title:n.o.t("card_not_support_display_title"),description:n.o.t("card_not_support_display_content")}},region:"cn-inhouse"},[a.CE.FILE]:{enable:!0,fileAttributeKeys:{statusKey:"upload_status",statusEnum:{successEnum:o.K.Success,failEnum:o.K.Error,cancelEnum:o.K.Canceled,uploadingEnum:o.K.Uploading},percentKey:"upload_percent"},copywriting:{tooltips:{cancel:n.o.t("bot_preview_file_cancel"),copy:n.o.t("bot_preview_file_copyURL"),retry:n.o.t("bot_preview_file_retry")}}}})},536348:function(e,t,r){r.d(t,{CX:function(){return i},Z2:function(){return a},n_:function(){return o},wM:function(){return s}});var n=r(336205),a=100,o=6e4,i="files_exceeds_limit",s=e=>{var{limitText:t="20MB"}=e;return n.o.t("file_too_large",{max_size:t})}},874498:function(e,t,r){r.d(t,{M_:function(){return o},Mn:function(){return n},O6:function(){return i},O9:function(){return c},Ss:function(){return s},Wm:function(){return l},Wq:function(){return a},_O:function(){return m},h$:function(){return v},j4:function(){return u},qj:function(){return d}});var n=15,a=500,o=3e3,i=6,s=5e3,l=3,c=1e3,d="0",u=20,v=19,m=["0","-1"]},784237:function(e,t,r){r.d(t,{Wv:function(){return a},pT:function(){return n},w0:function(){return o}});var n=600,a=50,o=30},137588:function(e,t,r){r.d(t,{Oy:()=>o,X2:()=>s});var n=r("455069"),a=(0,n.createContext)({}),o=a.Provider,i=e=>{var t=(0,n.useContext)(a)[e];if(void 0===t)throw Error("cannot find AfterInitService: ".concat(e));return t},s=()=>i("markReadService")},591938:function(e,t,r){r.d(t,{N:function(){return n}});var n=(0,r(455069).createContext)(null)},113001:function(e,t,r){r.d(t,{O:function(){return s}});var n=r(455069),a=r(765377),o=r(368289),i=r(591938),s=()=>{var e=(0,n.useContext)(i.N);return e?e:((0,a.Cj)("ChatActionLockService not provided"),o.f)}},947039:function(e,t,r){r.d(t,{_:function(){return n}});var n=(0,r(455069).createContext)({refreshMessageList:null,reporter:null,botId:null,scene:null,manualInit:null,lifeCycleService:null,configs:null,eventCenter:null})},191579:function(e,t,r){r.d(t,{f:function(){return o},w:function(){return a}});var n,a=((n={})[n.Knowledge=0]="Knowledge",n[n.LongTermMemory=1]="LongTermMemory",n[n.JumpToAgent=2]="JumpToAgent",n[n.Backwards=3]="Backwards",n),o=[0,1,2,3]},146114:function(e,t,r){r.d(t,{N:function(){return n},t:function(){return a}});var n=(0,r(455069).createContext)({}),a=n.Provider},575495:function(e,t,r){r.d(t,{L:function(){return n}});var n=(0,r(455069).createContext)({})},464247:function(e,t,r){r.d(t,{k:function(){return i}});var n=r(473980),a=r(151064),o=r(575495),i=e=>{var{children:t}=e,r=(0,n._)(e,["children"]);return(0,a.jsx)(o.L.Provider,{value:r,children:t})};i.displayName="ChatInputLayoutProvider"},816101:function(e,t,r){r.d(t,{_:function(){return n}});var n=(0,r(455069).createContext)({})},740136:function(e,t,r){r.d(t,{I:function(){return o}});var n=r(455069),a=r(816101),o=()=>(0,n.useContext)(a._)},494026:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(473980),a=r(151064),o=r(816101),i=e=>{var{children:t}=e,r=(0,n._)(e,["children"]);return(0,a.jsx)(o._.Provider,{value:r,children:t})};i.displayName="ChatAreaChatInputPropsProvider"},405983:function(e,t,r){r.d(t,{N:function(){return d},X:function(){return c}});var n=r(473980),a=r(151064),o=r(455069),i=r(871873),s=r(336205),l=()=>({textareaPlaceholder:"",textareaBottomTips:"",clearContextDividerText:"",clearContextTooltipContent:"",audioButtonTooltipContent:""}),c=(0,o.createContext)(l()),d=e=>{var{children:t}=e,r=(0,n._)(e,["children"]);return(0,a.jsx)(c.Provider,{value:(0,i.Z)({},l(),{clearContextDividerText:s.o.t("context_clear_finish")},r),children:t})};d.displayName="ChatAreaCopywritingProvider"},601219:function(e,t,r){r.d(t,{g:function(){return o}});var n=r(455069),a=r(405983),o=()=>(0,n.useContext)(a.X)},348108:function(e,t,r){r.d(t,{s:function(){return n}});var n=(0,r(455069).createContext)({isDragOver:!1})},922798:function(e,t,r){r.d(t,{L:function(){return o}});var n=r(455069),a=r(348108),o=()=>(0,n.useContext)(a.s)},378049:function(e,t,r){r.d(t,{P:function(){return i}});var n=r(473980),a=r(151064),o=r(348108),i=e=>{var{children:t}=e,r=(0,n._)(e,["children"]);return(0,a.jsx)(o.s.Provider,{value:r,children:t})};i.displayName="ChatAreaDragUploadContextProvider"},803926:function(e,t,r){r.d(t,{jM:()=>c,iF:()=>l});var n=r("455069"),a=r("765377"),o=r("829495"),i=r("151064"),s=(0,n.createContext)({loadMoreClient:null}),l=e=>{var{children:t,loadMoreClient:r}=e;return(0,i.jsx)(s.Provider,{value:{loadMoreClient:r},children:t})},c=()=>{var e=(0,n.useContext)(s).loadMoreClient;return e?e:((0,a.Cj)("loadMoreClient not provided"),o.B)}},432333:function(e,t,r){r.d(t,{J:function(){return n}});var n=(0,r(455069).createContext)({messageUniqKey:"",groupId:"",regenerateMessage:()=>Promise.resolve(),isFirstUserOrFinalAnswerMessage:!1,isLastUserOrFinalAnswerMessage:!1,message:void 0,meta:void 0,isGroupChatActive:!1})},525395:function(e,t,r){r.d(t,{d:function(){return s}});var n=r(808549),a=r(473980),o=r(455069),i=r(432333),s=()=>{var e=(0,o.useContext)(i.J),{message:t,messageUniqKey:r,meta:s}=e,l=(0,a._)(e,["message","messageUniqKey","meta"]);if(!t||!s)throw Error("failed to get message or meta by message id or local_id ".concat(r));return(0,n._)({message:t,messageUniqKey:r,meta:s},l)}},62541:function(e,t,r){r.d(t,{r:()=>v});var n=r("808549"),a=r("120454"),o=r("473980"),i=r("151064"),s=r("615655"),l=r("818584"),c=e=>{var{waiting:t,sending:r,groupId:n}=e,a=(null==t?void 0:t.replyId)===n&&t.phase===l.zr.Formal;if(!r)return a;var o=r.message_id===n||(null==r?void 0:r.extra_info.local_message_id)===n;return a||o},d=r("589872"),u=r("432333"),v=e=>{var{children:t,messageUniqKey:r,groupId:l}=e,v=(0,o._)(e,["children","messageUniqKey","groupId"]),{useMessagesStore:m,useMessageMetaStore:g,useWaitingStore:p}=(0,d.N)(),f=p(e=>c((0,a._)((0,n._)({},e),{groupId:l}))),h=m(e=>e.findMessage(r),s.Z),_=g(e=>e.getMetaByMessage(r),s.Z);return(0,i.jsx)(u.J.Provider,{value:(0,n._)({message:h,groupId:l,meta:_,messageUniqKey:r,isGroupChatActive:f},v),children:t})};v.displayName="MessageBoxProvider"},808431:function(e,t,r){r.d(t,{F:function(){return o}});var n=r(455069),a=r(801389),o=()=>(0,n.useContext)(a.p)},801389:function(e,t,r){r.d(t,{F$:function(){return f},Fi:function(){return m},hK:function(){return g},p:function(){return p}});var n=r(808549),a=r(151064),o=r(455069),i=r(871873),s=r(580868),l=r(346707),c=r(341665),d=r(532267),u=()=>({enableMarkRead:!1,enableTwoWayLoad:!1,showUserExtendedInfo:!1,enableImageAutoSize:!1,imageAutoSizeContainerWidth:void 0,enablePasteUpload:!1,isInputReadonly:!1,enableDragUpload:!0,enableSelectOnboarding:!0,uikitChatInputButtonStatus:{},onboardingSuggestionsShowMode:d.y3.Random,showBackground:!1,stopRespondOverrideWaiting:void 0}),v=()=>({newMessageInterruptScenario:"replying",enableMessageBoxActionBar:!1,selectable:!1,showClearContextDivider:!0,messageWidth:"100%",messageMaxWidth:"",readonly:!1,uiKitChatInputButtonConfig:{isSendButtonVisible:!0,isClearHistoryButtonVisible:!0,isMoreButtonVisible:!0},uikitChatInputButtonStatus:{isClearContextButtonDisabled:!1},enableMention:!1,theme:"debug",enableLegacyUpload:!1,enableMultimodalUpload:!0,fileLimit:1,showInputArea:!0,showOnboardingMessage:!0,forceShowOnboardingMessage:!1,showStopRespond:!0,layout:c.Ar.PC,isMiniScreen:!1,isOnboardingCentered:!1,stopRespondOverrideWaiting:void 0}),m=(0,o.createContext)(u()),g=()=>(0,o.useContext)(m),p=(0,o.createContext)((0,n._)({},v(),u())),f=e=>{var{children:t,value:r}=e,n=(0,i.Z)(v(),u(),(0,s.Z)(r,l.Z));return(0,a.jsx)(p.Provider,{value:n,children:t})}},397707:function(e,t,r){r.d(t,{E:function(){return a},d:function(){return n}});var n=(0,r(455069).createContext)({getScrollView:null}),a=n.Provider},582341:function(e,t,r){r.d(t,{U:function(){return n}});var n=(0,r(455069).createContext)(void 0)},142203:function(e,t,r){r.d(t,{M:function(){return o}});var n=r(455069),a=r(582341),o=()=>(0,n.useContext)(a.U)},993384:function(e,t,r){r.d(t,{z:function(){return n}});var n=(0,r(455069).createContext)({useBatchFileUploadStore:null,useChatActionStore:null,useFileStore:null,useGlobalInitStore:null,useMessageIndexStore:null,useMessageMetaStore:null,useMessagesStore:null,useOnboardingStore:null,usePluginStore:null,useSectionIdStore:null,useSelectionStore:null,useSenderInfoStore:null,useSuggestionsStore:null,useWaitingStore:null,useAudioUIStore:null})},983429:function(e,t,r){r.d(t,{T:function(){return n}});var n=(0,r(455069).createContext)({uploadControllerMap:{},createControllerAndUpload:()=>void 0,cancelUploadById:()=>void 0,clearAllSideEffect:()=>void 0})},122849:function(e,t,r){r.d(t,{Q:function(){return o}});var n=r(455069),a=r(983429),o=()=>(0,n.useContext)(a.T)},487942:function(e,t,r){r.d(t,{B:function(){return d}});var n=r(825955),a=r(808549),o=r(120454),i=r(765377),s=r(525080),l=r(863462),c=r(874498),d=e=>{var{reporter:t,getChatCore:r,ignoreMessageConfigList:n,lifeCycleService:a}=e,o=u({reporter:t,getChatCore:r,ignoreMessageConfigList:n,lifeCycleService:a});return new i.bw(o,{limit:c.Wm,timeWindow:c.Ss,onLimitDelay:c.O9}).invoke},u=e=>{var t,{reporter:r,getChatCore:i,ignoreMessageConfigList:d,lifeCycleService:u}=e;return t=(0,n._)(function*(e){var{count:t,cursor:n,loadDirection:v}=e;try{var m=i(),g={count:null!=t?t:c.Mn,cursor:n,load_direction:v},p=yield u.message.onBeforeGetMessageHistoryList({ctx:g}),f=yield m.getHistoryMessage(p),h=(0,o._)((0,a._)({},f),{message_list:(0,s.T)({historyMessageList:f.message_list,reporter:r,ignoreMessageConfigList:d})});return r.successEvent({eventName:l.q.GetMessageList}),h}catch(e){throw r.errorEvent((0,a._)({eventName:l.q.GetMessageList},(0,l.a)(e))),e}}),function(e){return t.apply(this,arguments)}}},292291:function(e,t,r){r.d(t,{k:()=>i});var n=r("455069");r("382534");var a=r("589872");r("707804"),r("829495");var o=r("803926");r("821886"),r("487942");var i=()=>{var e=(0,o.jM)(),{useGlobalInitStore:t}=(0,a.N)(),r=t(e=>e.chatCore);(0,n.useEffect)(()=>{e.injectChatCoreIntoEnv(r)},[r])}},821886:function(e,t,r){r.d(t,{t:function(){return s}});var n=r(455069),a=r(871482),o=e=>e();class i{listenMessagesLengthChange(e){return this.fns.add(e),{dispose:()=>{this.fns.delete(e)}}}constructor(e){this.fns=new Set,this.forceDispose=()=>{this.fns.clear(),this.unsubscribe()},this.unsubscribe=e.subscribe(e=>e.messages.length,()=>this.fns.forEach(o))}}var s=e=>{var t=(0,n.useRef)([]),r=(0,a.xD)(()=>{t.current.forEach(o),t.current=[]}),s=(0,n.useMemo)(()=>new i(e),[]);return(0,n.useEffect)(()=>s.forceDispose,[]),(0,n.useEffect)(()=>{var{dispose:e}=s.listenMessagesLengthChange(r);return e},[]),e=>t.current.push(e)}},589872:function(e,t,r){r.d(t,{N:function(){return l},Q:function(){return s}});var n=r(455069),a=r(339468),o=r(993384),i=r(947039),s=()=>{var e=(0,n.useContext)(i._),t=(0,n.useContext)(o.z);if(!(0,a.e)(e)||!(0,a.e)(t))throw Error("chatAreaContext is not valid");return e},l=()=>{var e=(0,n.useContext)(o.z);if(!(0,a.e)(e))throw Error("chatAreaContext is not valid");return e}},681387:function(e,t,r){r.d(t,{R:function(){return o}});var n=r(455069),a=r(146114),o=()=>{var e;return null!==(e=(0,n.useContext)(a.N).componentTypes)&&void 0!==e?e:{}}},103525:function(e,t,r){r.d(t,{D:function(){return a}});var n=r(589872),a=()=>{var{useGlobalInitStore:e}=(0,n.N)();return e(e=>e.getChatCore())}},901062:function(e,t,r){r.d(t,{X:function(){return o}});var n=r(455069),a=r(397707),o=()=>{var{getScrollView:e}=(0,n.useContext)(a.d);if(!e)throw Error("scrollView context not provide");return e}},237464:function(e,t,r){r.d(t,{w:function(){return o}});var n=r(339468),a=r(589872),o=()=>{var e=(0,a.N)();if(!(0,n.e)(e))throw Error("chatAreaStoreSetContext is not valid");var{useGlobalInitStore:t}=e;return t(e=>e.initStatus)}},361042:function(e,t,r){r.d(t,{K:function(){return i}});var n=r(803926),a=r(113001),o=r(589872),i=()=>{var e=(0,o.Q)(),t=(0,n.jM)(),r=(0,a.O)();return{context:e,storeSet:(0,o.N)(),services:{loadMoreClient:t,chatActionLockService:r}}}},213655:function(e,t,r){r.d(t,{Y:()=>l});var n=r("808549"),a=r("120454"),o=r("416290"),i=e=>parseFloat(e),s=r("808431"),l=e=>{var{scrollViewWrapper:t}=e,{isOnboardingCentered:r,enableImageAutoSize:l}=(0,s.F)(),c=r||l?t:null,d=(0,o.Z)(c);if(!!c&&!!d){var u=getComputedStyle(c);return(0,a._)((0,n._)({},d),{paddingLeft:i(u.getPropertyValue("padding-left")),paddingRight:i(u.getPropertyValue("padding-right"))})}}},583906:function(e,t,r){r.d(t,{B:function(){return o}});var n=r(589872),a=r(122849),o=()=>{var{useBatchFileUploadStore:e}=(0,n.N)(),{cancelUploadById:t}=(0,a.Q)();return r=>{var{immerDeleteFileDataById:n}=e.getState();n(r),t(r)}}},249552:function(e,t,r){r.d(t,{T:function(){return d}});var n=r(455069),a=r(801815),o=r(664115),i=r(224237),s=r(808431),l=r(213539),c=r(998815),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,[t,r]=(0,n.useState)(!1),d=(0,c.N)(),u=(0,n.useRef)(null),{fileLimit:v,enableMultimodalUpload:m,enableDragUpload:g}=(0,s.F)(),p=(0,l.n)(),f=(0,n.useRef)(null),h=()=>{if(!!f.current)clearTimeout(f.current),f.current=null};return(0,n.useEffect)(()=>{var t=u.current;if(!!m&&!!g){if(!t){(0,i.x)("No Drag Target");return}var n=e=>{if((0,i.x)("dragenter",e),h(),!!(0,o.Fw)(e))r(!0)},s=e=>{if(e.preventDefault(),h(),(0,i.x)("dragover",e),!!(0,o.Fw)(e))r(!0)},l=t=>{h(),(0,i.x)("dragleave",{e:t}),f.current=setTimeout(()=>{r(!1)},e)},c=e=>{if((0,i.x)("dragdrop",e),h(),!(0,o.Fw)(e))return;r(!1),e.preventDefault();var t=p({fileLimit:v,fileList:(0,o.zw)(e)});if(!!t.length)t.forEach(e=>{d((0,a.x0)(),e)})};return t.addEventListener("dragenter",n),t.addEventListener("dragover",s),t.addEventListener("dragleave",l),t.addEventListener("drop",c),()=>{h(),t.removeEventListener("dragenter",n),t.removeEventListener("dragover",s),t.removeEventListener("dragleave",l),t.removeEventListener("drop",c)}}},[m,u.current]),{ref:u,isDragOver:t}}},884903:function(e,t,r){r.d(t,{q:function(){return l}});var n=r(801815),a=r(664115),o=r(808431),i=r(213539),s=r(998815),l=()=>{var e=(0,s.N)(),{fileLimit:t,enablePasteUpload:r}=(0,o.F)(),l=(0,i.n)();return o=>{if(!r)return;var i=(0,a.Xq)(o);if(!i.length)return;o.preventDefault();var s=l({fileLimit:t,fileList:i});if(!!s.length)s.forEach(t=>{e((0,n.x0)(),t)})}}},998815:function(e,t,r){r.d(t,{N:function(){return l},j:function(){return c}});var n=r(589872),a=r(519698),o=r(122849),i=r(536348),s=()=>{var{useBatchFileUploadStore:e,useSenderInfoStore:t}=(0,n.N)(),{createControllerAndUpload:r,cancelUploadById:s}=(0,o.Q)(),l=t(e=>e.userInfo);return(t,n)=>{if(!l)throw Error("failed to get user info");var{immerUpdateFileDataById:o}=e.getState();r({fileId:t,file:n,userId:l.id,onReady:(e,t)=>{o(t,e=>{e.status=a.K.Uploading})},onProgress:(e,t)=>{o(t,t=>{t.percent=e.percent})},onComplete:(e,t)=>{var{uploadResult:r}=e;o(t,e=>{e.status=a.K.Success,e.percent=i.Z2;var t,n,o=r.Uri;if(!o)throw e.status=a.K.Error,Error("upload complete without uri");if(e.uri=o,e.fileType===a.T.Image)e.meta={width:null!==(t=r.ImageWidth)&&void 0!==t?t:0,height:null!==(n=r.ImageHeight)&&void 0!==n?n:0}})},onError:(e,t)=>{o(t,e=>{e.status=a.K.Error}),s(t)}})}},l=()=>{var{useBatchFileUploadStore:e}=(0,n.N)(),t=s();return(r,n)=>{var{immerCreateFileData:a}=e.getState();a(r,n),t(r,n)}},c=()=>{var e=s(),{useBatchFileUploadStore:t}=(0,n.N)();return(r,n)=>{var{immerUpdateFileDataById:o}=t.getState();o(r,e=>{e.percent=0,e.status=a.K.Init}),e(r,n)}}},213539:function(e,t,r){r.d(t,{n:function(){return d}});var n=r(336205),a=r(775699),o=r(341665),i=r(589872),s=r(664115),l=r(918744),c=r(536348),d=()=>{var{useBatchFileUploadStore:e}=(0,i.N)();return t=>{var{fileLimit:r,fileList:i}=t;if(!i.length)return[];var d=!i.every(s.lW),u=!i.every(s.vE);d&&a.FN.warning({content:(0,c.wM)({limitText:"".concat(o.fE,"MB")}),showClose:!1}),u&&a.FN.warning({content:n.o.t("upload_empty_file"),showClose:!1});var v=i.filter(s.lW).filter(s.vE);return(0,l.b)({fileCount:v.length,fileLimit:r,existingFileCount:e.getState().getExistingFileCount()})?(a.FN.warning({content:n.o.t(c.CX),showClose:!1}),[]):v}}},549231:function(e,t,r){r.d(t,{K_:function(){return s},Q9:function(){return l},y3:function(){return c}});var n=r(589872),a=r(933953),o=r(644775),i=(e,t)=>{var{messages:r,messageGroupList:n}=e.getState(),a=n.find(e=>e.groupId===t);return a?a.memberSet.llmAnswerMessageIdList.map(e=>(0,o.$)(r,e)).filter(e=>!!e).filter(o.kY):null},s=(e,t)=>{var r=i(e,t);return r&&r.at(0)||null},l=e=>{var{memberSet:t}=e,{useMessagesStore:r}=(0,n.N)();return r(e=>!!t.functionCallMessageIdList.map(t=>e.findMessage(t)).some(e=>e&&(0,a.DV)(e)))},c=e=>{var{memberSet:t}=e,{useMessagesStore:r}=(0,n.N)();return r(e=>!!t.functionCallMessageIdList.map(t=>e.findMessage(t)).some(e=>e&&(0,a.bO)(e)))}},794322:function(e,t,r){r.d(t,{r:function(){return p}});var n=r(825955),a=r(808549),o=r(455069),i=r(871482),s=r(380835),l=r(589872),c=r(731865),d=r(953126),u=r(863462),v=r(803926),m=r(113001),g=r(847782),p=()=>{var{reporter:e,eventCallback:t,lifeCycleService:r}=(0,l.Q)(),{useGlobalInitStore:p,useSectionIdStore:f,useSuggestionsStore:h,useMessagesStore:_,useSelectionStore:x}=(0,l.N)(),{setLatestSectionId:y}=f(),{loadEagerly:b}=(0,v.jM)(),S=_(e=>e.addMessages),C=(0,m.O)(),j=(0,g.RF)(),w=p(e=>e.getChatCore()),E=h(e=>e.clearSuggestions),k=x(e=>{var t;return null===(t=e.onboardingIdList)||void 0===t?void 0:t.at(-1)}),I=(0,i.xD)(()=>{var e=document.getElementById((0,c.h)(k));null==e||e.scrollIntoView()}),T=(0,o.useRef)(null);return(0,o.useEffect)(()=>()=>{if(!!T.current)clearTimeout(T.current)},[]),(0,n._)(function*(){if(!C.globalAction.getIsLock("clearContext"))try{C.globalAction.lock("clearContext",null),yield b();var n,o,i,l={insert_history_message_list:[]},c=null==t?void 0:null===(o=t.onClearContextBefore)||void 0===o?void 0:o.call(t,l),v=yield r.command.onBeforeClearContext({ctx:null!=c?c:l});yield j();var m=yield w.clearMessageContext(v);if(!m)throw Error("fail to get clearMessageContext res");var{new_section_id:g,new_section_message_list:p}=m;if(y(g),E(),(null==p?void 0:p.length)&&S(p.map(t=>(0,d.F)(t,e)),{toLatest:!0}),null==p?void 0:p.some(e=>e.content_type===s.zc.Card)){var f=setTimeout(()=>{I()},150);T.current=f}else I();e.event({eventName:u.q.ClearContext}),null==t||null===(i=t.onClearContextAfter)||void 0===i||i.call(t),yield r.command.onAfterClearContext()}catch(o){null==t||null===(n=t.onClearContextError)||void 0===n||n.call(t),yield r.command.onClearContextError(),e.errorEvent((0,a._)({eventName:u.q.ClearContext},(0,u.a)(o)))}finally{C.globalAction.unlock("clearContext")}})}},505506:function(e,t,r){r.d(t,{B:function(){return u},v:function(){return d}});var n=r(825955),a=r(808549),o=r(702005),i=r(361042),s=r(912947),l=r(863462),c=r(847782),d=()=>u((0,i.K)()),u=e=>(0,n._)(function*(){var t,{context:{lifeCycleService:r,reporter:n,eventCallback:i},storeSet:d,services:{loadMoreClient:u,chatActionLockService:v}}=e,{useGlobalInitStore:m,useMessagesStore:g,useSectionIdStore:p,useSuggestionsStore:f}=d,{setLatestSectionId:h}=p.getState(),_=m.getState().getChatCore(),{clearMessage:x}=g.getState(),{clearSuggestions:y}=f.getState(),b=(0,o.E)(e),S=(0,c.yv)(e);if(!v.globalAction.getIsLock("clearHistory")){v.globalAction.lock("clearHistory",null);try{null==i||null===(C=i.onClearHistoryBefore)||void 0===C||C.call(i),yield r.command.onBeforeClearHistory(),s.W4.emit(s.nA.CANCEL_UPLOAD_FILE),yield S();var C,j=yield _.clearHistory();if(b(),x(),y(),!(null==j?void 0:j.new_section_id))throw Error("clear history got no section id");h(j.new_section_id),n.successEvent({eventName:l.q.ClearHistory})}catch(e){n.errorEvent((0,a._)({eventName:l.q.ClearHistory},(0,l.a)(e)))}finally{v.globalAction.unlock("clearHistory"),u.onClearHistory(),null==i||null===(t=i.onClearHistoryAfter)||void 0===t||t.call(i),yield r.command.onAfterClearHistory()}}})},971764:function(e,t,r){r.d(t,{Y:function(){return l}});var n=r(808549),a=r(120454),o=r(589872),i=r(761882),s=r(113001),l=()=>{var e=(0,o.Q)(),t=(0,o.N)(),r=(0,s.O)();return o=>(0,i.zG)(o,(0,a._)((0,n._)({},e),{storeSet:t,chatActionLockService:r}))}},210252:function(e,t,r){r.d(t,{Y:function(){return a}});var n=r(589872),a=()=>{var{useChatActionStore:e}=(0,n.N)();return e(e=>!!e.globalActionLock.clearHistory)}},919806:function(e,t,r){r.d(t,{O:function(){return o}});var n=r(808431),a=r(525395),o=()=>{var{readonly:e,enableMessageBoxActionBar:t}=(0,n.F)(),{isGroupChatActive:r}=(0,a.d)();return t&&!r&&!e}},87803:function(e,t,r){r.d(t,{P:()=>x,R:()=>_});var n=r("455069"),a=r("2930"),o=r("589872"),i=r("825955"),s=r("808549"),l=r("311807"),c=r("765377"),d=r("382534"),u=r("433506"),v=r("863462"),m=r("874498");class g{constructor({getEnvInfo:e,reporter:t,updateIndex:r}){this.getEnvInfo=e,this.reporter=t,this.updateIndex=r}}class p{constructor(e){var t=this;this.getHelper=e,this.index="0",this.requireMarkRead=e=>{(0,c._X)(e).greaterThan(this.index)&&(this.index=e),this.throttledMarkRead()},this.throttledMarkRead=(0,l.Z)(()=>this.executeMarkRead(),m.Wq,{leading:!1,trailing:!0,maxWait:m.M_}),this.executeMarkRead=(0,i._)(function*(){var e=t.index,{reporter:r,updateIndex:n,getEnvInfo:a}=t.getHelper(),{conversationId:o,currentReadIndex:i}=a();if(!o){(0,c.Cj)("get no conversationId");return}if(!!(0,c._X)(e).greaterThan(i))try{var l=yield d.nA.MarkRead({conversation_id:o||"",mark_time:Date.now(),read_message_index:e});n({readIndex:l.read_message_index}),r.event({eventName:v.q.MarkMessageRead,meta:{read_index:e}})}catch(e){r.errorEvent((0,s._)({eventName:u.Z.MarkMessageReadFail},(0,c.aH)(e)))}})}}var f=r("808431"),h=r("137588"),_=()=>{var e=(0,a.Av)(),{useMessageIndexStore:t,useGlobalInitStore:r}=(0,o.N)(),i=(0,n.useRef)(null);return i.current=new g({getEnvInfo:()=>({conversationId:r.getState().conversationId,currentReadIndex:t.getState().readIndex}),reporter:e,updateIndex:t.getState().updateIndex}),(0,n.useMemo)(()=>new p(()=>i.current),[])},x=()=>{var e=(0,h.X2)(),{enableMarkRead:t}=(0,f.F)(),r=(0,n.useRef)(!1),{useMessageIndexStore:a}=(0,o.N)();return n=>{if(!t||a.getState().ignoreIndexAndHistoryMessages)return;var o=n.message_index;if(!r.current&&void 0!==o)e.requireMarkRead(o),r.current=!0}}},233708:function(e,t,r){r.d(t,{to:()=>T,vv:()=>L,My:()=>I,eh:()=>_.e,Us:()=>N,UG:()=>E,EL:()=>Z,VT:()=>A});var n,a=r("589872"),o=r("825955"),i=r("664319"),s=r("380835"),l=r("847782"),c=r("473980"),d=r("644775"),u=r("801815"),v=r("335740"),m=r("433506"),g=e=>{var{userMessage:t,reporter:r}=e,n=(0,v.Z)(t),a=!!n.extra_info.local_message_id,o=!!n._fromHistory;return a?n:(!o&&r.event({eventName:m.q.NonHistoricalMessageWithoutLocalId}),n.extra_info.local_message_id=(0,u.x0)(),n)},p=r("815454");var f=(n=(0,o._)(function*(e){var{messageGroup:{memberSet:t,groupId:r},context:{storeSet:n,chatActionLockService:a,reporter:o,sendMessage:i}}=e;if(!(a.answerAction.getIsLock(r,"regenerate")||a.globalAction.getIsLock("sendMessageToACK"))){var{useMessagesStore:s,useSuggestionsStore:l}=n,{clearSuggestions:u}=l.getState(),{deleteMessageByIdList:v,messages:m}=s.getState(),{userMessageId:f,llmAnswerMessageIdList:h,functionCallMessageIdList:_,followUpMessageIdList:x}=t,y=(0,c._)(t,["userMessageId","llmAnswerMessageIdList","functionCallMessageIdList","followUpMessageIdList"]);if((0,p.T)(y),!f)throw Error("regenerate message failed to get userMessageId");var b=(0,d.$)(m,f);if(!b)throw Error("regenerate message error: failed to get userMessage");v(_),v(h),v(x),u();var S=g({userMessage:b,reporter:o});try{a.answerAction.lock(r,"regenerate"),a.globalAction.lock("sendMessageToACK",{messageUniqKey:(0,d.lF)(S)}),yield i({message:S,options:{isRegenMessage:!0}},"regenerate")}finally{a.answerAction.unlock(r,"regenerate"),a.globalAction.unlock("sendMessageToACK")}}}),function(e){return n.apply(this,arguments)}),h=r("113001"),_=r("82449"),x=r("405281"),y=r("103525"),b=r("85685"),S=r("912947"),C=r("519698"),j=()=>{var{useSectionIdStore:e,useFileStore:t,useWaitingStore:r,useMessagesStore:n}=(0,a.N)(),o=(0,y.D)(),s=e(e=>e.latestSectionId),{updateTemporaryFile:l}=t((0,i.N)(e=>({updateTemporaryFile:e.updateTemporaryFile}))),{clearSending:c}=r((0,i.N)(e=>({clearSending:e.clearSending}))),{updateMessage:u,findMessage:m}=n((0,i.N)((0,i.N)(e=>({updateMessage:e.updateMessage,findMessage:e.findMessage}))));return e=>{var{file:t,mentionList:r}=e,n=o.createImageMessage({payload:{file:t,mention_list:r},pluginUploadManager:t=>{S.W4.on(S.nA.CANCEL_UPLOAD_FILE,e=>{var t=n.extra_info.local_message_id;if(e===t)(0,S.r7)(t),c()}),t.on("complete",()=>{(0,S.r7)(n.extra_info.local_message_id),S.W4.off(S.nA.CANCEL_UPLOAD_FILE)}),t.on("ready",()=>{(0,S.$d)({localMessageId:n.extra_info.local_message_id,uploader:t}),l(n.extra_info.local_message_id,e)}),t.on("error",()=>{var t=(0,v.Z)(n);(0,S.r7)(t.extra_info.local_message_id),l(t.extra_info.local_message_id,e),(0,d.hI)(t)&&(t._sendFailed=!0,t.is_finish=!0),m(t.extra_info.local_message_id)&&u(t.extra_info.local_message_id,t),c()})}},{section_id:s});return n}},w=()=>{var{useSectionIdStore:e,useFileStore:t,useMessagesStore:r,useWaitingStore:n}=(0,a.N)(),o=(0,y.D)(),s=e(e=>e.latestSectionId),{updateTemporaryFile:l}=t((0,i.N)(e=>({updateTemporaryFile:e.updateTemporaryFile}))),{updateMessage:c,findMessage:d}=r((0,i.N)((0,i.N)(e=>({updateMessage:e.updateMessage,findMessage:e.findMessage})))),{clearSending:u}=n((0,i.N)(e=>({clearSending:e.clearSending})));return e=>{var{file:t,mentionList:r}=e,n=o.createFileMessage({payload:{file:t,mention_list:r},pluginUploadManager:t=>{S.W4.on(S.nA.CANCEL_UPLOAD_FILE,e=>{var t=n.extra_info.local_message_id;if(e===t){(0,S.r7)(t);var r=(0,b.H)(n,{status:C.K.Canceled,percent:0});r.is_finish=!0,d(r.extra_info.local_message_id)&&c(r.extra_info.local_message_id,r),u()}}),t.on("progress",e=>{var t=(0,b.H)(n,{status:C.K.Uploading,percent:e.percent});d(t.extra_info.local_message_id)&&c(t.extra_info.local_message_id,t)}),t.on("complete",()=>{(0,S.r7)(n.extra_info.local_message_id);var e=(0,b.H)(n,{status:C.K.Success,percent:100});d(e.extra_info.local_message_id)&&c(e.extra_info.local_message_id,e),S.W4.off(S.nA.CANCEL_UPLOAD_FILE)}),t.on("ready",()=>{(0,S.$d)({localMessageId:n.extra_info.local_message_id,uploader:t}),l(n.extra_info.local_message_id,e);var r=(0,b.H)(n,{status:C.K.Uploading,percent:0});d(r.extra_info.local_message_id)&&c(r.extra_info.local_message_id,r)}),t.on("error",()=>{(0,S.r7)(n.extra_info.local_message_id),l(n.extra_info.local_message_id,e);var t=(0,b.H)(n,{status:C.K.Error,percent:0});t._sendFailed=!0,t.is_finish=!0,d(t.extra_info.local_message_id)&&c(t.extra_info.local_message_id,t),u()})}},{section_id:s});return n}},E=()=>{var e=w(),t=(0,x.Zb)();return(r,n)=>{t(e(r),n)}},k=()=>{var{useSectionIdStore:e}=(0,a.N)(),t=(0,y.D)(),r=e(e=>e.latestSectionId);return e=>t.createTextAndFileMixMessage(e,{section_id:r})},I=()=>{var e=j(),t=(0,x.Zb)();return(r,n)=>{t(e(r),n)}},T=()=>{var e,t=(0,x.Zb)(),r=k(),{useBatchFileUploadStore:n,useFileStore:i}=(0,a.N)();return e=(0,o._)(function*(e,a,o){var s=r(e);n.getState().clearAllData(),e.audioFile&&i.getState().addAudioFile({localMessageId:s.extra_info.local_message_id,audioFile:e.audioFile});var l=yield t(s,a,o);(0,d.iC)(l)}),function(t,r,n){return e.apply(this,arguments)}},M=()=>{var{useSectionIdStore:e}=(0,a.N)(),t=(0,y.D)(),r=e(e=>e.latestSectionId);return e=>t.createNormalizedPayloadMessage(e,{section_id:r})},A=()=>{var e=(0,x.Zb)(),t=M(),{useBatchFileUploadStore:r}=(0,a.N)();return(n,a)=>{var o=t(n);r.getState().clearAllData(),e(o,a)}},N=()=>{var e=(0,_.e)(),{useFileStore:t,useMessagesStore:r}=(0,a.N)(),n=E(),o=I(),c=t((0,i.N)(e=>e.temporaryFile)),d=(0,l.bm)();return t=>{var{deleteMessageByIdStruct:a}=r.getState();if(!!d){if(a(t),t.content_type===s.zc.Text&&e({text:t.content,mentionList:t.mention_list},"other"),[s.zc.File,s.zc.Image].includes(t.content_type)){var i=t.content_type===s.zc.File,{extra_info:{local_message_id:l}}=t,u=c[l];u&&(i?n(u,"other"):o(u,"other"))}}}},L=()=>{var e,t=(0,x.Dh)(),{reporter:r}=(0,a.Q)(),n=(0,a.N)(),i=(0,h.O)();return e=(0,o._)(function*(e){return f({messageGroup:e,context:{storeSet:n,sendMessage:t,chatActionLockService:i,reporter:r}})}),function(t){return e.apply(this,arguments)}},Z=()=>{var e,t=L(),{useMessagesStore:r}=(0,a.N)();return e=(0,o._)(function*(e){var{messageGroupList:n}=r.getState(),a=n.find(t=>{var{memberSet:r}=t;return r.userMessageId===e});if(!a)throw Error("regenerate message error: failed to get message");yield t(a)}),function(t){return e.apply(this,arguments)}}},405281:function(e,t,r){r.d(t,{eK:()=>A,Dh:()=>k,Zb:()=>T});var n,a,o=r("825955"),i=r("808549"),s=r("120454"),l=r("871873"),c=r("193616"),d=r("889959"),u=r("380835"),v=r("499283"),m=r("674343"),g=r("847782"),p=r("361042"),f=r("912001"),h=r("644775"),_=r("335740");var x=(n=(0,o._)(function*(e,t){var r,{chatCore:n,audioFile:a}=t;if(!n)return;var o=new FormData;o.append("file",a);var i=yield n.chatASR(o),s=null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.text;if(!!s){var l=(0,_.Z)(e);if((0,h.pZ)(l)&&(l.content=s),(0,h.xB)(l)){var c=l.content_obj.item_list.find(e=>e.type===u.zc.Text);c&&(c.text=s,l.content=JSON.stringify(l.content_obj))}return l}}),function(e,t){return n.apply(this,arguments)}),y=e=>{var{message:t,deleteMessageByIdStruct:r,getAudioProcessStateByLocalId:n}=e;if("processing"===n(t.extra_info.local_message_id))return r(t),"reverted"},b=e=>{var{message:t,removeAudioFileByLocalId:r,updateAudioProcessState:n}=e,a=t.extra_info.local_message_id;r(a),n({localMessageId:a,state:"finish"})},S=r("552995"),C=r("519698"),j=(e,t)=>{var r,n,{useMessagesStore:a}=t;e.content_type===u.zc.File&&(0,S.zE)(e.content_obj)&&(null===(r=e.content_obj.file_list)||void 0===r?void 0:r[0])&&(null===(n=e.content_obj.file_list)||void 0===n||n.forEach(e=>e.upload_status=C.K.Success),e.content=JSON.stringify(e.content_obj))},w=r("675665"),E=r("863462"),k=()=>I((0,p.K)()),I=e=>{var t;return t=(0,o._)(function*(t,r){var n=(0,g.yv)(e),{storeSet:a,context:{eventCallback:o,lifeCycleService:u,reporter:p}}=e,{useGlobalInitStore:h,useMessagesStore:_,useWaitingStore:x,useSectionIdStore:y}=a,{chatCore:b}=h.getState(),{updateMessage:S}=_.getState(),{latestSectionId:C,setLatestSectionId:k}=y.getState(),{startWaiting:I,startSending:T,clearSending:M}=x.getState(),{message:A,options:N}=t,L=n(),Z={extendFiled:{device_id:String(d.ZP.deviceId)}},G=(0,l.Z)({},Z,N);if(!b)throw Error("chatCore is not ready");var P=(0,s._)((0,i._)({},A),{is_finish:!1});delete P._sendFailed,S(P),T(P);try{yield L;var B,R,D,F,U=null==o?void 0:null===(B=o.onBeforeMessageSend)||void 0===B?void 0:B.call(o,{message:(0,f.a)(A),options:(0,f.a)(G)},r),{message:O,options:z}=yield u.message.onBeforeSendMessage({ctx:{message:null!==(D=null==U?void 0:U.message)&&void 0!==D?D:A,options:null!==(F=null==U?void 0:U.options)&&void 0!==F?F:G,from:r}});S(O);var W=yield b.sendMessage(O,z);W.section_id!==C&&k(W.section_id),p.successEvent({eventName:E.q.SendMessage}),j(W,{useMessagesStore:_}),null==o||null===(R=o.onMessageSendSuccess)||void 0===R||R.call(o,{message:W},r),yield u.message.onAfterSendMessage({ctx:{message:W,from:r}}),I(W),S(A,W)}catch(e){p.errorEvent((0,i._)({eventName:E.q.SendMessage},(0,E.a)(e)));var H,K=(0,s._)((0,i._)({},A),{_sendFailed:!0,is_finish:!0});if(S(K),null==o||null===(H=o.onMessageSendFail)||void 0===H||H.call(o,{message:A},r,e),yield u.message.onSendMessageError({ctx:{message:K,from:r,error:e}}),(0,c.Z)(e)){var V=(0,w.Pb)(e.message);(0,w.nI)(e)&&(0,w.R$)(e.ext.code)&&m.FN.error({content:e.message,showClose:!1}),(null==V?void 0:V.code)&&[w.Nt.COZE_TOKEN_INSUFFICIENT,w.Nt.COZE_TOKEN_INSUFFICIENT_WORKFLOW].includes(null==V?void 0:V.code)&&(0,v.Dt)(v.wE.COZE_TOKEN_INSUFFICIENT)}}finally{M()}}),function(e,r){return t.apply(this,arguments)}},T=()=>A((0,p.K)());var M=(a=(0,o._)(function*(e,t){var{getAudioFileByLocalId:r,chatCore:n,updateMessage:a,removeAudioFileByLocalId:o,updateAudioProcessState:i}=t,s=e.extra_info.local_message_id,l=r(s);if(!l||e.message_id)return e;i({localMessageId:s,state:"processing"});var c=yield x(e,{chatCore:n,audioFile:l});if(!!c)return a(c),c}),function(e,t){return a.apply(this,arguments)}),A=e=>{var t;return t=(0,o._)(function*(t,r,n){var{context:{lifeCycleService:a,reporter:o},services:{chatActionLockService:i,loadMoreClient:s},storeSet:{useMessagesStore:l,useGlobalInitStore:c,useFileStore:d}}=e;if(i.globalAction.getIsLock("sendMessageToACK"))return"LOCKED";var{addMessage:v,updateMessage:m,deleteMessageByIdStruct:g}=l.getState(),{getAudioFileByLocalId:p,removeAudioFileByLocalId:f,updateAudioProcessState:_,getAudioProcessStateByLocalId:x}=d.getState(),{chatCore:S}=c.getState(),C=I(e);try{i.globalAction.lock("sendMessageToACK",{messageUniqKey:(0,h.lF)(t)}),yield s.loadEagerly();var{message:j}=yield a.message.onBeforeAppendSenderMessageIntoStore({ctx:{message:t,from:r}});v(j);var E=yield M(j,{chatCore:S,updateMessage:m,getAudioFileByLocalId:p,removeAudioFileByLocalId:f,updateAudioProcessState:_});if(!E)return y({message:j,getAudioProcessStateByLocalId:x,deleteMessageByIdStruct:g}),"VOICE_NOT_RECOGNIZE";yield a.message.onAfterAppendSenderMessageIntoStore({ctx:{message:E,from:r}}),yield C({message:E,options:n},r||"inputAndSend")}catch(e){if("reverted"===y({message:t,getAudioProcessStateByLocalId:x,deleteMessageByIdStruct:g})){if(e instanceof u.MS){if(e.code===String(w.Nt.COZE_TOKEN_INSUFFICIENT_VOICE))return"TOKEN_INSUFFICIENT_VOICE";if(e.code===String(w.Nt.COZE_PRO_TOKEN_INSUFFICIENT_VOICE))return"PRO_TOKEN_INSUFFICIENT_VOICE"}return"VOICE_NOT_RECOGNIZE"}var k=e instanceof Error?e:Error("use SendNewMessage has some error");o.error({error:k,message:"useSendNewMessage has some error"})}finally{b({message:t,removeAudioFileByLocalId:f,updateAudioProcessState:_}),i.globalAction.unlock("sendMessageToACK")}}),function(e,r,n){return t.apply(this,arguments)}}},82449:function(e,t,r){r.d(t,{e:function(){return l},i:function(){return c}});var n=r(825955),a=r(361042),o=r(644775),i=r(405281),s=e=>t=>{var{storeSet:r}=e,{useSectionIdStore:n,useGlobalInitStore:a}=r,o=a.getState().getChatCore(),{latestSectionId:i}=n.getState();return o.createTextMessage({payload:{text:t.text,mention_list:t.mentionList}},{section_id:i})},l=()=>c((0,a.K)()),c=e=>{var t;return t=(0,n._)(function*(t,r,n){var a=s(e),l=(0,i.eK)(e),c=a(t);t.audioFile&&e.storeSet.useFileStore.getState().addAudioFile({localMessageId:c.extra_info.local_message_id,audioFile:t.audioFile});var d=yield l(c,r,n);(0,o.iC)(d)}),function(e,r,n){return t.apply(this,arguments)}}},847782:function(e,t,r){r.d(t,{RF:function(){return v},bm:function(){return u},yv:function(){return m}});var n=r(808549),a=r(120454),o=r(828470),i=r(361042),s=r(589872),l=r(263111),c=r(818584),d=r(808431),u=()=>{var{newMessageInterruptScenario:e}=(0,d.F)(),{useWaitingStore:t,useBatchFileUploadStore:r}=(0,s.N)(),n=(0,o.B)(),a=r(e=>e.hasFileNotSuccess());return t(t=>{var{waiting:r,sending:n}=t;if(!r&&!n)return!0;switch(e){case"replying":return!n;case"suggesting":return(null==r?void 0:r.phase)===c.zr.Suggestion;case"never":return!1;default:throw Error("unexpected interrupt Scenario: ".concat(e))}})&&!n&&!a},v=()=>m((0,i.K)()),m=e=>()=>{var{context:t,storeSet:r}=e;return(0,l.yE)((0,a._)((0,n._)({},t),{storeSet:r}))}},2930:function(e,t,r){r.d(t,{Av:function(){return o},Lx:function(){return i},wX:function(){return s}});var n=r(589872),a=r(808431),o=()=>(0,n.Q)().reporter,i=()=>(0,a.F)().messageWidth,s=()=>(0,a.F)().layout},828470:function(e,t,r){r.d(t,{B:function(){return o}});var n=r(589872),a=r(473393),o=()=>{var{useChatActionStore:e}=(0,n.N)();return e(e=>a.mU.sendMessageToACK(e.globalActionLock))}},693062:function(e,t,r){r.d(t,{l:function(){return o}});var n=r(664319),a=r(589872),o=()=>{var{useMessagesStore:e,useSectionIdStore:t}=(0,a.N)(),r=t(e=>e.latestSectionId),{isEmpty:o,latestSectionHasMessage:i}=e((0,n.N)(e=>({isEmpty:0===e.messages.length,latestSectionHasMessage:!!e.messages.filter(e=>e.section_id===r).length})));return{isEmpty:o,latestSectionHasMessage:i}}},383603:function(e,t,r){r.d(t,{O:function(){return o}});var n=r(142203),a=r(808431),o=e=>{var{onboardingHeight:t=0,minOffset:r=0}=e,{isOnboardingCentered:o}=(0,a.F)(),i=(0,n.M)();if(!!o&&!!(null==i?void 0:i.height))return Math.max((i.height-t)/2,r)}},914157:function(e,t,r){r.d(t,{S:function(){return o},e:function(){return i}});var n=r(825955),a=r(361042),o=()=>i((0,a.K)()),i=e=>{var t;return t=(0,n._)(function*(t){var r,n,{context:a,storeSet:o}=e,{eventCallback:i,lifeCycleService:s}=a,{useSelectionStore:l}=o,{setOnboardingSelected:c,selectedOnboardingId:d}=l.getState(),u=!!d;c(t.selectedId),null==i||null===(r=i.onOnboardingSelectChange)||void 0===r||r.call(i,t,u),yield s.command.onOnboardingSelectChange({ctx:{selected:t,isAlreadyHasSelect:u,content:null!==(n=t.onboarding.prologue)&&void 0!==n?n:""}})}),function(e){return t.apply(this,arguments)}}},295252:function(e,t,r){r.d(t,{r:function(){return a}});var n=r(808431),a=()=>{var{showBackground:e}=(0,n.F)();return e}},702005:function(e,t,r){r.d(t,{E:function(){return i},k:function(){return o}});var n=r(361042),a=r(914157),o=()=>i((0,n.K)()),i=e=>()=>{var{storeSet:t}=e,{useSelectionStore:r}=t,{clearSelectedReplyIdList:n}=r.getState(),o=(0,a.e)(e);n(),o({selectedId:null,onboarding:{}})}},888604:function(e,t,r){r.d(t,{U:function(){return o}});var n=r(455069),a=r(295252),o=e=>{var t,{hasHeaderNode:r,maskNode:o,styles:i}=e,[s,l]=(0,n.useState)(!0),c=(0,a.r)();return{onReachTop:()=>l(!1),onLeaveTop:()=>l(!0),beforeClassName:c?"absolute left-0":"",beforeNode:s&&r&&c?o:null,maskClassName:c&&null!==(t=i["scroll-mask"])&&void 0!==t?t:"",showGradient:s}}},270561:function(e,t,r){r.d(t,{$:function(){return l}});var n=r(664319),a=r(693062),o=r(847782),i=r(589872),s=r(808431),l=e=>{var{isClearContextButtonDisabled:t,isMoreButtonDisabled:r}=e,{useMessagesStore:l,useWaitingStore:c,useBatchFileUploadStore:d}=(0,i.N)(),u=c(e=>!!e.sending),v=!(0,o.bm)(),m=d(e=>e.fileIdList.length),{fileLimit:g}=(0,s.F)(),{latestSectionHasMessage:p}=(0,a.l)(),{hasMessage:f}=l((0,n.N)(e=>({hasMessage:!!e.messages.length})));return{isSendButtonDisabled:v,isMoreButtonDisabled:v||m>=g||r,isClearHistoryButtonDisabled:!f||u,isClearContextButtonDisabled:!f||u||!p||t}}},721033:function(e,t,r){r.d(t,{F:function(){return c}});var n=r(808549),a=r(120454),o=r(664319),i=r(341665),s=r(589872),l=r(808431),c=e=>{var{layout:t,showUserExtendedInfo:r}=(0,l.F)(),{useSenderInfoStore:c}=(0,s.N)(),d=c((0,o.N)(e=>e.getMessageUserInfo))(null==e?void 0:e.sender_id);if(!d)return null;var u=(0,a._)((0,n._)({},d),{userLabel:null,userUniqueName:""});return t===i.Ar.PC&&r?d:u}},827790:function(e,t,r){r.d(t,{P:function(){return f}});var n=r(825955),a=r(808549),o=r(120454),i=r(664319),s=r(626389),l=r.n(s),c=r(552995),d=r(336205),u=r(775699),v=r(589872),m=r(912947),g=r(506917),p=r(808431),f=()=>{var e,{eventCallback:t,lifeCycleService:r,eventCenter:s}=(0,v.Q)(),{useFileStore:f}=(0,v.N)(),{enableMention:h}=(0,p.F)(),{updatePreviewURL:_}=f((0,i.N)(e=>({updatePreviewURL:e.updatePreviewURL})));return{onLinkClick(e,n){var o;null==t||null===(o=t.onMessageLinkClick)||void 0===o||o.call(t,e,n),r.command.onMessageLinkClick({ctx:(0,a._)({event:n},e.extra)})},onMessageRetry:()=>void 0,onCopyUpload:e=>{var t,r,n,{message:a,extra:{fileIndex:o}}=e;(0,c.zE)(a.content_obj)&&(l()(null!==(r=null===(t=a.content_obj.file_list[null!=o?o:0])||void 0===t?void 0:t.file_url)&&void 0!==r?r:""),u.O$.success({content:null!==(n=d.o.t("copy_success"))&&void 0!==n?n:"Copy Successfully"}))},onCancelUpload:e=>{var{message:t}=e;return m.W4.emit(m.nA.CANCEL_UPLOAD_FILE,t.extra_info.local_message_id)},onRetryUpload:e=>{var{message:t}=e;s.emit(g.V.RESEND_MESSAGE,{message:t})},onImageClick:(e=(0,n._)(function*(e){var{extra:n}=e;(null==t?void 0:t.onImageClick)?t.onImageClick(n):_(n.url),yield r.command.onImageClick({ctx:{url:n.url}})}),function(t){return e.apply(this,arguments)}),onCardSendMsg:e=>{var{extra:t}=e,r={mentionList:h?t.mentionList:[],text:t.msg||""};s.emit(g.V.SEND_TEXT_MESSAGE,(0,o._)((0,a._)({},r),{clickLocation:"clickCard",options:t.options}))},onCardUpdateStatus:e=>{if("string"==typeof e.extra.action){var t={messageID:e.message.message_id,action:e.extra.action};s.emit(g.V.UPDATE_CARD_STATUS,t)}},onCardLinkElementEnter:e=>{r.command.onCardLinkElementMouseEnter({ctx:e})},onCardLinkElementLeave:e=>{r.command.onCardLinkElementMouseLeave({ctx:e})},onMdBoxLinkElementEnter:e=>{r.command.onMdBoxLinkElementMouseEnter({ctx:e})},onMdBoxLinkElementLeave:e=>{r.command.onMdBoxLinkElementMouseLeave({ctx:e})},onMdBoxImageElementEnter(e){r.command.onMdBoxImageElementMouseEnter({ctx:e})},onMdBoxImageElementLeave(e){r.command.onMdBoxImageElementMouseLeave({ctx:e})}}}},833096:function(e,t,r){r.d(t,{H:function(){return l}});var n=r(346707),a=r(552995),o=r(341665),i=r(142203),s=r(808431),l=()=>{var e,{enableImageAutoSize:t,imageAutoSizeContainerWidth:r,layout:l}=(0,s.F)(),{width:c,paddingLeft:d,paddingRight:u}=null!==(e=(0,i.M)())&&void 0!==e?e:{};if(t&&(0,n.Z)(r)&&(0,n.Z)(c))return{enableImageAutoSize:!1,imageAutoSizeContainerWidth:void 0};var v=(null!=c?c:0)-(null!=d?d:0)-(null!=u?u:0)-(l===o.Ar.MOBILE?a.M0:a.pJ)-a.cU;return{enableImageAutoSize:t,imageAutoSizeContainerWidth:null!=r?r:v}}},780601:function(e,t,r){r.d(t,{Lx:()=>rT.Lx,KF:()=>rs.K,aF:()=>t0,i4:()=>r$,zc:()=>M.zc,y1:()=>r6,rj:()=>rE,Bw:()=>r0,Ox:()=>r7,R2:()=>H.R2,e6:()=>rK,to:()=>rI.to,$V:()=>ni.$,BO:()=>r8,CJ:()=>rH,NN:()=>x.N,YN:()=>r2,Nd:()=>no,WB:()=>ne,O7:()=>rW.O,hI:()=>z.hI,p7:()=>r4,w5:()=>rk.w,rz:()=>rD.r,EL:()=>rI.EL,Pb:()=>H.Pb,bU:()=>rB,eg:()=>z.eg,r1:()=>rQ,mJ:()=>z.mJ,rw:()=>rF.r,Sq:()=>rU.S,bs:()=>tK.bs,hU:()=>s.h,tf:()=>eO,xs:()=>M.xs,x1:()=>r5,lL:()=>nr.l,iE:()=>rz,dH:()=>rC.d,Br:()=>nn.B,Mg:()=>rO.M,S3:()=>r3,fM:()=>rj.f,jD:()=>rS,mV:()=>nt.m,vk:()=>z.vk,tT:()=>rN,eh:()=>rI.eh,FL:()=>rq,Wp:()=>rA,W9:()=>rY,mZ:()=>M.mZ,VB:()=>H.VB,YI:()=>rR.Y,pZ:()=>z.pZ,wX:()=>rT.wX});var n,a,o,i,s=r("752853"),l=r("808549"),c=r("120454"),d=r("151064"),u=r("455069"),v=r("552995"),m=(e,t)=>t?e.findIndex(e=>e===t):-1,g=e=>e.type.startsWith("image/"),p=r("732562"),f=r("664115");class h{start(){}on(e,t){this.eventBus.on(e,t)}pause(){var e;null===(e=this.uploader)||void 0===e||e.pause()}cancel(){this.abortController.abort()}constructor(e){this.eventBus=new p.v,this.userId="",this.file=e.file,this.fileType=e.type,this.userId=e.userId,this.abortController=new AbortController,(0,f.cT)({file:this.file,fileType:this.fileType,userId:this.userId,signal:this.abortController.signal,onProgress:e=>{this.eventBus.emit("progress",e)},onUploaderReady:e=>{this.eventBus.emit("ready",!0),this.uploader=e},onUploadError:e=>{this.eventBus.emit("error",e)},onGetTokenError:e=>{var t={type:"error",extra:{error:e,message:e.message}};this.eventBus.emit("error",t)},onSuccess:e=>{this.eventBus.emit("complete",e)}})}}class _{constructor({fileId:e,file:t,userId:r,onProgress:n,onComplete:a,onError:o,onReady:i,multiUploadPlugin:s=h}){this.cancel=()=>{this.uploadPlugin.cancel()},this.fileId=e,this.uploadPlugin=new s({file:t,userId:r,type:g(t)?"image":"object"}),this.uploadPlugin.on("progress",t=>n(t,e)),this.uploadPlugin.on("complete",t=>a(t,e)),this.uploadPlugin.on("error",t=>o(t,e)),this.uploadPlugin.on("ready",t=>i(t,e))}}var x=r("589872"),y=r("983429"),b=e=>{var{children:t}=e,{configs:r}=(0,x.Q)(),n=(0,u.useRef)({}),a=()=>{Object.entries(n.current).forEach(e=>{var[,t]=e;return t.cancel()}),n.current={}};return(0,u.useEffect)(()=>a,[]),(0,d.jsx)(y.T.Provider,{value:{uploadControllerMap:n.current,createControllerAndUpload:e=>{n.current[e.fileId]=new _((0,c._)((0,l._)({},e),{multiUploadPlugin:r.uploadPlugin}))},cancelUploadById:e=>{var t=n.current[e];if(!!t)t.cancel(),delete n.current[e]},clearAllSideEffect:a},children:t})},S=r("993384"),C=r("801389"),j=r("803926"),w=r("591938"),E=r("224237"),k=r("871873"),I=r("825955"),T=r("917085"),M=r("380835"),A=r("765377"),N=r("382534"),L=r("707804"),Z=r("829495"),G=r("499283"),P=r("674343"),B=e=>"follow_up"===e.type,R=e=>{var t=[],r=[];for(var n of e)B(n)?r.unshift({replyId:n.reply_id,suggestion:n.content}):t.push(n);return{messageList:t,idAndSuggestions:r}},D=r("761882"),F=new class e{constructor(...e){var t=this;this.strategyList=[],this.execute=(0,I._)(function*(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];yield Promise.all(t.strategyList.map(e=>e.execute(...r)))}),this.strategyList=e}}(new class e{constructor(){var e;this.execute=(e=(0,I._)(function*(e,t){var{action:r}=t,{remove_query_id:n}=e.extra_info;if(!!n)yield r.deleteMessageGroupByUserMessageId(n)}),function(t,r){return e.apply(this,arguments)})}},new class e{constructor(){this.execute=(e,t)=>{var{action:r}=t,{new_section_id:n}=e.extra_info;return n?(r.setNewSectionIdStruct({replyId:e.reply_id,newSectionId:n}),Promise.resolve()):Promise.resolve()}}}),U=new class e{constructor(){this.execute=(e,t)=>{var{action:r}=t;return r.getNewSectionIdStruct()?r.checkNewSectionIdValid(e.reply_id)?(r.updateStoreSectionId(),r.setNewSectionIdStruct(null),Promise.resolve()):(r.setNewSectionIdStruct(null),Promise.resolve()):Promise.resolve()}}};class O{constructor({storeSet:e,reporter:t,eventCallback:r,lifeCycleService:n,chatActionLockService:a}){this.newSectionIdStruct=null,this.setStrategy=e=>(this.strategy=e,this),this.executeStrategy=e=>{var t;return null===(t=this.strategy)||void 0===t?void 0:t.execute(e,{action:this.action})};var o,{useMessagesStore:i,useWaitingStore:s,useSuggestionsStore:l,useMessageMetaStore:c,useSectionIdStore:d,useGlobalInitStore:u}=e;this.action={deleteMessageGroupByUserMessageId:(o=(0,I._)(function*(e){var{getMessageGroupByUserMessageId:o}=i.getState(),d=o(e);if(!!d)return(0,D.zG)(d.groupId,{storeSet:{useMessageMetaStore:c,useMessagesStore:i,useSuggestionsStore:l,useWaitingStore:s,useGlobalInitStore:u},reporter:t,eventCallback:r,lifeCycleService:n,chatActionLockService:a})}),function(e){return o.apply(this,arguments)}),setNewSectionIdStruct:e=>{this.newSectionIdStruct=e},getNewSectionIdStruct:()=>this.newSectionIdStruct,checkNewSectionIdValid:e=>{var t;return(null===(t=this.newSectionIdStruct)||void 0===t?void 0:t.replyId)===e},updateStoreSectionId:()=>{var e;if(!!(null===(e=this.newSectionIdStruct)||void 0===e?void 0:e.newSectionId))d.getState().setLatestSectionId(this.newSectionIdStruct.newSectionId)}}}}var z=r("644775"),W=r("772418"),H=r("675665"),K=r("898449"),V=["success","error","timeout"],q=["error","timeout"],Y=e=>{var t,r,{chatCore:n,reporter:a,useMessagesStore:o,useWaitingStore:i,useSuggestionsStore:s,useSectionIdStore:l,securityStrategyContext:c,eventCallback:{onMessageSuccess:d,onReceiveMessage:u,onMessageError:v},configs:m,lifeCycleService:g}=e;(0,E.x)({message:"listenMessageUpdate"});var{updateResponding:p,updateWaiting:f,clearUnsettledByReplyId:h}=i.getState(),_=e=>{var{data:t}=e,{latestSectionId:r,setLatestSectionId:n}=l.getState();for(var i of t){if(g.message.onBeforeReceiveMessage({ctx:{message:i}}),!(0,W.E)(m.ignoreMessageConfigList,i)){r!==i.section_id&&n(i.section_id),null==u||u({message:i});var{message:d}=g.message.onBeforeProcessReceiveMessage({ctx:{message:i}});p(d),B(d)?J(d,s):Q(d,o,a),f(d),g.message.onAfterProcessReceiveMessage({ctx:{message:i}})}c.setStrategy(F).executeStrategy(i)}},x=e=>{var{data:t,abort:r,error:n}=e,i=t.pullingStatus;if("error"===i){var l={replyId:t.reply_id,localMessageId:t.local_message_id,error:n};null==v||v(l),g.message.onMessagePullingError({ctx:l});var u=(0,H.Pb)(null==n?void 0:n.message);if((null==u?void 0:u.code)&&u.code===H.VB.SuggestError){s.getState().setGenerateSuggestionError(t.reply_id);return}if((null==u?void 0:u.code)&&[H.Nt.COZE_TOKEN_INSUFFICIENT,H.Nt.COZE_TOKEN_INSUFFICIENT_WORKFLOW].includes(u.code)){(0,G.Dt)(G.wE.COZE_TOKEN_INSUFFICIENT);return}u&&(0,H.R$)(u.code)&&P.FN.error({content:null==u?void 0:u.msg,showClose:!1})}if("success"===i){var m={localMessageId:t.local_message_id,replyId:t.reply_id};null==d||d(m),g.message.onMessagePullingSuccess({ctx:m})}V.includes(i)&&(X({data:t,reporter:a,useMessagesStore:o}),h(t.reply_id),c.setStrategy(U).executeStrategy({reply_id:t.reply_id,extra_info:{}})),q.includes(i),"timeout"===i&&(null==r||r())};return(null===(t=(r=g.app).onBeforeListenChatCore)||void 0===t?void 0:t.call(r,{onMessageStatusChange:x,onMessageUpdate:_}))?()=>void 0:(n.on(M.ZP.EVENTS.MESSAGE_RECEIVED_AND_UPDATE,_),n.on(M.ZP.EVENTS.MESSAGE_PULLING_STATUS,x),()=>{n.off(M.ZP.EVENTS.MESSAGE_RECEIVED_AND_UPDATE,_),n.off(M.ZP.EVENTS.MESSAGE_PULLING_STATUS,x)})},X=e=>{var{data:t,useMessagesStore:r}=e,{messages:n,updateMessage:a}=r.getState(),o=t.reply_id,i=(0,z.xR)(n,o);if(!!i.length){var s=$(a);i.forEach(s)}},J=(e,t)=>{var{updateSuggestion:r}=t.getState();r(e.reply_id,e.content)},Q=(e,t,r)=>{var{updateMessage:n,hasMessage:a,addMessage:o}=t.getState(),i=(0,K.F)(e,r);a(i)?n(i):o(i)},$=e=>t=>{if(!t.is_finish)e((0,c._)((0,l._)({},t),{is_finish:!0}))},ee=r("525080"),et=new Map,er=new Map,en=e=>{et.delete(e),er.delete(e)},ea=(e,t)=>{er.set(e,t)},eo=e=>{var t=er.get(e);return t?(er.delete(e),t):null},ei=r("368289"),es=r("263111"),el=r("505506"),ec=r("583906"),ed=r("901062"),eu=r("575495"),ev=()=>(0,u.useContext)(eu.L),em=e=>{var{setLatestSectionId:t,clear:r}=e.getState();return{setLatestSectionId:t,clearSectionId:r}},eg=r("889959"),ep=e=>{var{storeSet:t}=e;return e=>{var{replyId:r,options:n}=e,{useGlobalInitStore:a,useMessagesStore:o,useWaitingStore:i}=t,s=a.getState().getChatCore(),{messages:c}=o.getState(),{startWaiting:d}=i.getState(),u=(0,z.$)(c,r),v={extendFiled:{device_id:String(eg.ZP.deviceId)}},m=(0,l._)({},v,n);if(!s||!u)throw Error("chatCore is not ready");d(u),s.resumeMessage(u,m)}},ef=r("82449"),eh=e=>{var{storeSet:t,eventCallback:r,reporter:n,lifeCycleService:a,deps:o}=e;return{stopResponding:()=>(0,es.yE)({storeSet:t,eventCallback:r,reporter:n,lifeCycleService:a}),sendResumeMessage:ep({storeSet:t}),sendTextMessage:(0,ef.i)(o)}},e_=(e,t)=>r=>{var{selector:n,listener:a,options:o}=r,i=e.subscribe(n,a,o);return t.getState().appendServiceOffSubscriptionList(i),i},ex=(e,t)=>r=>{var{selector:n,listener:a,options:o}=r,i=e.subscribe(n,a,o);return t.getState().appendServiceOffSubscriptionList(i),i},ey=(e,t)=>r=>{var{selector:n,listener:a,options:o}=r,i=e.subscribe(n,a,o);return t.getState().appendServiceOffSubscriptionList(i),i},eb=(e,t)=>r=>{var{selector:n,listener:a,options:o}=r,i=e.subscribe(n,a,o);return t.getState().appendServiceOffSubscriptionList(i),i},eS=(e,t)=>r=>{var{selector:n,listener:a,options:o}=r,i=e.subscribe(n,a,o);return t.getState().appendServiceOffSubscriptionList(i),i},eC=(e,t)=>r=>{var{selector:n,listener:a,options:o}=r,i=e.subscribe(n,a,o);return t.getState().appendServiceOffSubscriptionList(i),i},ej=e=>{var{updatePrologue:t,partialUpdateOnboardingData:r}=e.getState();return{updatePrologue:t,partialUpdateOnboardingData:r}},ew=e=>{var{clearMessage:t,addMessages:r,deleteMessageByIdList:n,updateMessage:a}=e.getState();return{clearMessage:t,addMessages:r,deleteMessageByIdList:n,updateMessage:a}},eE=e=>{var{updateIgnoreIndexAndHistoryMessages:t}=e.getState();return{updateIgnoreIndexAndHistoryMessages:t}},ek=e=>{var{getMessageGroupById:t,getMessageGroupByUserMessageId:r,getMessageIndexRange:n,findMessage:a}=e.getState();return{getMessageGroupById:t,getMessageGroupByUserMessageId:r,getMessageIndexRange:n,findMessage:a}},eI=e=>{var{getMetaByMessage:t}=e.getState();return{getMetaByMessage:t}},eT=e=>()=>{var{getBotInfo:t,botInfoMap:r}=e.getState();return{getBotInfo:t,botInfoMap:r}},eM=e=>()=>{var{fileDataMap:t,fileIdList:r,fileTypeMap:n}=e.getState();return{fileDataMap:t,fileIdList:r,fileTypeMap:n}},eA=e=>()=>{var{latestSectionId:t}=e.getState();return{latestSectionId:t}},eN=e=>()=>{var{messages:t}=e.getState();return{messages:t}},eL=e=>()=>{var{metaList:t}=e.getState();return{metaList:t}},eZ=e=>()=>{var{initStatus:t}=e.getState();return{initStatus:t}},eG=e=>{var{refreshMessageList:t}=e;return{refreshMessageList:t}},eP=e=>{var{storeSet:t,eventCallback:r,reporter:n,lifeCycleService:a,refreshMessageList:o,getCommonDeps:i}=e,{useGlobalInitStore:s,useMessageMetaStore:d,useMessagesStore:u,useOnboardingStore:v,useSelectionStore:m,useWaitingStore:g,usePluginStore:p,useSenderInfoStore:f,useMessageIndexStore:h,useBatchFileUploadStore:_,useSectionIdStore:x}=t,y=i();return{limitSubscriptions:{subscribeGlobalInit:eC(s,p),subscribeMessage:eS(u,p),subscribeMessageMeta:eb(d,p),subscribeOnboarding:ey(v,p),subscribeSelection:ex(m,p),subscribeWaiting:e_(g,p)},writeableAPI:{messageList:(0,c._)((0,l._)({},eG({refreshMessageList:o}),ew(u)),{clearChatHistory:(0,el.B)(y)}),messageIndex:(0,l._)({},eE(h)),message:eh({storeSet:t,eventCallback:r,lifeCycleService:a,reporter:n,deps:y}),onboarding:ej(v),sectionId:em(x)},readonlyAPI:{globalInit:{getGlobalInitStoreInstantValues:eZ(s)},message:(0,l._)({getMessagesStoreInstantValues:eN(u)},ek(u)),messageMeta:(0,l._)({getMessageMetaInstantValues:eL(d)},eI(d)),botInfo:{getBotInfoStoreInstantValues:eT(f)},batchFile:{getFileStoreInstantValues:eM(_)},sectionId:{getSectionIdInstantValues:eA(x)}},readonlyHook:{scrollView:{useGetScrollView:ed.X},input:{useChatInputLayout:ev}},writeableHook:{file:{useDeleteFile:ec.B}}}},eB=e=>{var{pluginRegistryList:t=[],storeSet:r,refreshMessageList:n,reporter:a,eventCallback:o,lifeCycleService:i,getCommonDeps:s}=e,l=[];for(var c of t){if(!c||!c.createPluginBizContext||!c.Plugin){console.error("register plugin has params empty!");continue}var d=c.createPluginBizContext(),u=eP({storeSet:r,refreshMessageList:n,reporter:a,eventCallback:o,lifeCycleService:i,getCommonDeps:s}),v=new c.Plugin(d,u);l.push(v)}var{usePluginStore:m}=r;return m.getState().setPluginInstanceList(l),()=>{m.getState().offAllSubscription()}},eR=["700012014"],eD=e=>"code"in e&&eR.includes(String(e.code)),eF=r("912947"),eU=r("433506");var eO=((n={}).Readonly="readonly",n.Writeable="writeable",n);var ez=((a={}).LifeCycleStart="lifeCycleStart",a.LifeCycleEnd="lifeCycleEnd",a.PluginStart="pluginStart",a.PluginEnd="pluginEnd",a);var eW=((o={}).App="app",o.Message="message",o.Command="command",o),eH=e=>e.pluginMode===eO.Writeable,eK=r("912001");class eV{onTextContentRendering(e){var{ctx:t}=e,{usePluginStore:r}=this.lifeCycleContext,{pluginInstanceList:n}=r.getState(),a=(0,eK.a)(t);for(var o of n)if(eH(o)){var i,s,l,c,d,u,v=null===(u=o.lifeCycleServices)||void 0===u?void 0:null===(d=u.renderLifeCycleService)||void 0===d?void 0:null===(c=d.onTextContentRendering)||void 0===c?void 0:c.call(d,a);if(!v)continue;a=(0,eK.a)(v)}else null===(l=o.lifeCycleServices)||void 0===l||null===(s=l.renderLifeCycleService)||void 0===s||null===(i=s.onTextContentRendering)||void 0===i||i.call(s,a);return a}onMessageBoxRender(e){var{ctx:t}=e,{usePluginStore:r}=this.lifeCycleContext,{pluginInstanceList:n}=r.getState(),a=(0,eK.a)(t);for(var o of n){var i,s,l,c=null===(l=o.lifeCycleServices)||void 0===l?void 0:null===(s=l.renderLifeCycleService)||void 0===s?void 0:null===(i=s.onMessageBoxRender)||void 0===i?void 0:i.call(s,a);if(!!c)a=c}return a}constructor(e){this.lifeCycleContext=e}}var eq=Math.random(),eY=e=>{var t,{lifeCycleName:r,lifeCycleScope:n,reporter:a}=e,{trace:o}=null!==(t=null==a?void 0:a.tracer({eventName:"chatAreaPluginCycleLifeBenchmark"}))&&void 0!==t?t:{};if(!!o&&!!(eq<=.05))return{recordLifeCycleStart:()=>o(r,{meta:{lifeCycleScope:n,lifeCycleStage:ez.LifeCycleStart}}),recordLifeCycleEnd:()=>o(r,{meta:{lifeCycleScope:n,lifeCycleStage:ez.LifeCycleEnd}}),recordPluginStart:e=>o(r,{meta:{pluginName:e.pluginName,lifeCycleScope:n,lifeCycleStage:ez.PluginStart}}),recordPluginEnd:e=>o(r,{meta:{pluginName:e.pluginName,lifeCycleScope:n,lifeCycleStage:ez.PluginEnd}})}};class eX{onBeforeGetMessageHistoryList(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e="onBeforeGetMessageHistoryList",n=eW.Message,{reporter:a,usePluginStore:o}=r.lifeCycleContext,i=eY({lifeCycleName:e,lifeCycleScope:n,reporter:a}),{pluginInstanceList:s}=o.getState();null==i||i.recordLifeCycleStart();var l=(0,eK.a)(t);for(var c of s){if(null==i||i.recordPluginStart(c),eH(c)){var d,u,v,m,g,p,f=yield null===(p=c.lifeCycleServices)||void 0===p?void 0:null===(g=p.messageLifeCycleService)||void 0===g?void 0:null===(m=g.onBeforeGetMessageHistoryList)||void 0===m?void 0:m.call(g,l);if(!f){null==i||i.recordPluginEnd(c);continue}(0,E.x)("".concat(n,"/").concat(e,"/").concat(c.pluginName,": newContext ").concat(f)),l=(0,eK.a)(f)}else yield null===(v=c.lifeCycleServices)||void 0===v?void 0:null===(u=v.messageLifeCycleService)||void 0===u?void 0:null===(d=u.onBeforeGetMessageHistoryList)||void 0===d?void 0:d.call(u,l);null==i||i.recordPluginEnd(c)}return null==i||i.recordLifeCycleEnd(),l})()}onBeforeSendMessage(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e="onBeforeSendMessage",n=eW.Message,{reporter:a,usePluginStore:o}=r.lifeCycleContext,i=eY({lifeCycleName:e,lifeCycleScope:n,reporter:a}),{pluginInstanceList:s}=o.getState();null==i||i.recordLifeCycleStart();var l=(0,eK.a)(t);for(var c of s){if(null==i||i.recordPluginStart(c),eH(c)){var d,u,v,m,g,p,f=yield null===(p=c.lifeCycleServices)||void 0===p?void 0:null===(g=p.messageLifeCycleService)||void 0===g?void 0:null===(m=g.onBeforeSendMessage)||void 0===m?void 0:m.call(g,l);if(!f){null==i||i.recordPluginEnd(c);continue}(0,E.x)("".concat(n,"/").concat(e,"/").concat(c.pluginName,": newContext ").concat(f)),l=(0,eK.a)(f)}else yield null===(v=c.lifeCycleServices)||void 0===v?void 0:null===(u=v.messageLifeCycleService)||void 0===u?void 0:null===(d=u.onBeforeSendMessage)||void 0===d?void 0:d.call(u,l);null==i||i.recordPluginEnd(c)}return null==i||i.recordLifeCycleEnd(),l})()}onAfterSendMessage(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,o=eW.Message,{reporter:i,usePluginStore:s}=r.lifeCycleContext,l=eY({lifeCycleName:"onAfterSendMessage",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();null==l||l.recordLifeCycleStart();var d=(0,eK.a)(t);for(var u of c)null==l||l.recordPluginStart(u),yield null===(a=u.lifeCycleServices)||void 0===a?void 0:null===(n=a.messageLifeCycleService)||void 0===n?void 0:null===(e=n.onAfterSendMessage)||void 0===e?void 0:e.call(n,d),null==l||l.recordPluginEnd(u);null==l||l.recordLifeCycleEnd()})()}onBeforeReceiveMessage(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(a);for(var l of i)null===(n=l.lifeCycleServices)||void 0===n||null===(r=n.messageLifeCycleService)||void 0===r||null===(t=r.onBeforeReceiveMessage)||void 0===t||t.call(r,s);return s}onBeforeProcessReceiveMessage(e){var{ctx:t}=e,r=eW.Message,{usePluginStore:n}=this.lifeCycleContext,{pluginInstanceList:a}=n.getState(),o=(0,eK.a)(t);for(var i of a)if(eH(i)){var s,l,c,d,u,v,m=null===(v=i.lifeCycleServices)||void 0===v?void 0:null===(u=v.messageLifeCycleService)||void 0===u?void 0:null===(d=u.onBeforeProcessReceiveMessage)||void 0===d?void 0:d.call(u,o);if(!m)continue;(0,E.x)("".concat(r,"/").concat("onBeforeProcessReceiveMessage","/").concat(i.pluginName,": newContext ").concat(m)),o=(0,eK.a)(m)}else null===(c=i.lifeCycleServices)||void 0===c||null===(l=c.messageLifeCycleService)||void 0===l||null===(s=l.onBeforeProcessReceiveMessage)||void 0===s||s.call(l,o);return o}onBeforeMessageGroupListUpdate(e){var{ctx:t}=e,{usePluginStore:r}=this.lifeCycleContext,{pluginInstanceList:n}=r.getState(),a=(0,eK.a)(t);for(var o of n)if(eH(o)){var i,s,l,c,d,u,v=null===(u=o.lifeCycleServices)||void 0===u?void 0:null===(d=u.messageLifeCycleService)||void 0===d?void 0:null===(c=d.onBeforeMessageGroupListUpdate)||void 0===c?void 0:c.call(d,a);if(!v)continue;a=(0,eK.a)(v)}else null===(l=o.lifeCycleServices)||void 0===l||null===(s=l.messageLifeCycleService)||void 0===s||null===(i=s.onBeforeMessageGroupListUpdate)||void 0===i||i.call(s,a);return a}onAfterProcessReceiveMessage(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(a);for(var l of i)null===(n=l.lifeCycleServices)||void 0===n||null===(r=n.messageLifeCycleService)||void 0===r||null===(t=r.onAfterProcessReceiveMessage)||void 0===t||t.call(r,s)}onBeforeDeleteMessage(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,o=eW.Message,{reporter:i,usePluginStore:s}=r.lifeCycleContext,l=eY({lifeCycleName:"onBeforeDeleteMessage",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();null==l||l.recordLifeCycleStart();var d=(0,eK.a)(t);for(var u of c)null==l||l.recordPluginStart(u),yield null===(a=u.lifeCycleServices)||void 0===a?void 0:null===(n=a.messageLifeCycleService)||void 0===n?void 0:null===(e=n.onBeforeDeleteMessage)||void 0===e?void 0:e.call(n,d),null==l||l.recordPluginEnd(u);null==l||l.recordLifeCycleEnd()})()}onAfterDeleteMessage(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,o=eW.Message,{reporter:i,usePluginStore:s}=r.lifeCycleContext,l=eY({lifeCycleName:"onAfterDeleteMessage",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();null==l||l.recordLifeCycleStart();var d=(0,eK.a)(t);for(var u of c)null==l||l.recordPluginStart(u),yield null===(a=u.lifeCycleServices)||void 0===a?void 0:null===(n=a.messageLifeCycleService)||void 0===n?void 0:null===(e=n.onAfterDeleteMessage)||void 0===e?void 0:e.call(n,d),null==l||l.recordPluginEnd(u);null==l||l.recordLifeCycleEnd()})()}onDeleteMessageError(e){var t=this;return(0,I._)(function*(){var r,n,a,o=eW.Message,{reporter:i,usePluginStore:s}=t.lifeCycleContext,l=eY({lifeCycleName:"onDeleteMessageError",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();for(var d of(null==l||l.recordLifeCycleStart(),c))null==l||l.recordPluginStart(d),yield null===(a=d.lifeCycleServices)||void 0===a?void 0:null===(n=a.messageLifeCycleService)||void 0===n?void 0:null===(r=n.onDeleteMessageError)||void 0===r?void 0:r.call(n,e),null==l||l.recordPluginEnd(d);null==l||l.recordLifeCycleEnd()})()}onSendMessageError(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,o=eW.Message,{reporter:i,usePluginStore:s}=r.lifeCycleContext,l=eY({lifeCycleName:"onSendMessageError",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();null==l||l.recordLifeCycleStart();var d=(0,eK.a)(t);for(var u of c)null==l||l.recordPluginStart(u),yield null===(a=u.lifeCycleServices)||void 0===a?void 0:null===(n=a.messageLifeCycleService)||void 0===n?void 0:null===(e=n.onSendMessageError)||void 0===e?void 0:e.call(n,d),null==l||l.recordPluginEnd(u);null==l||l.recordLifeCycleEnd()})()}onBeforeDistributeMessageIntoMemberSet(e){var{ctx:t}=e,{usePluginStore:r}=this.lifeCycleContext,{pluginInstanceList:n}=r.getState(),a=(0,eK.a)(t);for(var o of n)if(eH(o)){var i,s,l,c,d,u,v=null===(u=o.lifeCycleServices)||void 0===u?void 0:null===(d=u.messageLifeCycleService)||void 0===d?void 0:null===(c=d.onBeforeDistributeMessageIntoMemberSet)||void 0===c?void 0:c.call(d,a);if(!v)continue;a=(0,eK.a)(v)}else null===(l=o.lifeCycleServices)||void 0===l||null===(s=l.messageLifeCycleService)||void 0===s||null===(i=s.onBeforeDistributeMessageIntoMemberSet)||void 0===i||i.call(s,a);return a}onBeforeAppendSenderMessageIntoStore(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var{usePluginStore:e}=r.lifeCycleContext,{pluginInstanceList:n}=e.getState(),a=(0,eK.a)(t);for(var o of n)if(eH(o)){var i,s,l,c,d,u,v=yield null===(u=o.lifeCycleServices)||void 0===u?void 0:null===(d=u.messageLifeCycleService)||void 0===d?void 0:null===(c=d.onBeforeAppendSenderMessageIntoStore)||void 0===c?void 0:c.call(d,a);if(!v)continue;a=(0,eK.a)(v)}else yield null===(l=o.lifeCycleServices)||void 0===l?void 0:null===(s=l.messageLifeCycleService)||void 0===s?void 0:null===(i=s.onBeforeAppendSenderMessageIntoStore)||void 0===i?void 0:i.call(s,a);return a})()}onAfterAppendSenderMessageIntoStore(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,{usePluginStore:o}=r.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(t);for(var l of i)yield null===(a=l.lifeCycleServices)||void 0===a?void 0:null===(n=a.messageLifeCycleService)||void 0===n?void 0:null===(e=n.onAfterAppendSenderMessageIntoStore)||void 0===e?void 0:e.call(n,s)})()}onMessagePullingError(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(a);for(var l of i)null===(n=l.lifeCycleServices)||void 0===n||null===(r=n.messageLifeCycleService)||void 0===r||null===(t=r.onMessagePullingError)||void 0===t||t.call(r,s)}onMessagePullingSuccess(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(a);for(var l of i)null===(n=l.lifeCycleServices)||void 0===n||null===(r=n.messageLifeCycleService)||void 0===r||null===(t=r.onMessagePullingSuccess)||void 0===t||t.call(r,s)}constructor(e){this.lifeCycleContext=e}}class eJ{onBeforeClearContext(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e=eW.Command,{reporter:n,usePluginStore:a}=r.lifeCycleContext,o=eY({lifeCycleName:"onBeforeClearContext",lifeCycleScope:e,reporter:n}),{pluginInstanceList:i}=a.getState();null==o||o.recordLifeCycleStart();var s=(0,eK.a)(t);for(var l of i){if(null==o||o.recordPluginStart(l),eH(l)){var c,d,u,v,m,g,p=yield null===(g=l.lifeCycleServices)||void 0===g?void 0:null===(m=g.commandLifeCycleService)||void 0===m?void 0:null===(v=m.onBeforeClearContext)||void 0===v?void 0:v.call(m,s);if(!p)continue;s=(0,eK.a)(p)}else yield null===(u=l.lifeCycleServices)||void 0===u?void 0:null===(d=u.commandLifeCycleService)||void 0===d?void 0:null===(c=d.onBeforeClearContext)||void 0===c?void 0:c.call(d,s);null==o||o.recordPluginEnd(l)}return null==o||o.recordLifeCycleEnd(),s})()}onAfterClearContext(){var e=this;return(0,I._)(function*(){var t,r,n,a=eW.Command,{reporter:o,usePluginStore:i}=e.lifeCycleContext,s=eY({lifeCycleName:"onAfterClearContext",lifeCycleScope:a,reporter:o}),{pluginInstanceList:l}=i.getState();for(var c of(null==s||s.recordLifeCycleStart(),l))null==s||s.recordPluginStart(c),yield null===(n=c.lifeCycleServices)||void 0===n?void 0:null===(r=n.commandLifeCycleService)||void 0===r?void 0:null===(t=r.onAfterClearContext)||void 0===t?void 0:t.call(r),null==s||s.recordPluginEnd(c);null==s||s.recordLifeCycleEnd()})()}onBeforeClearHistory(){var e=this;return(0,I._)(function*(){var t,r,n,a=eW.Command,{reporter:o,usePluginStore:i}=e.lifeCycleContext,s=eY({lifeCycleName:"onBeforeClearHistory",lifeCycleScope:a,reporter:o}),{pluginInstanceList:l}=i.getState();for(var c of(null==s||s.recordLifeCycleStart(),l))null==s||s.recordPluginStart(c),yield null===(n=c.lifeCycleServices)||void 0===n?void 0:null===(r=n.commandLifeCycleService)||void 0===r?void 0:null===(t=r.onBeforeClearHistory)||void 0===t?void 0:t.call(r),null==s||s.recordPluginEnd(c);null==s||s.recordLifeCycleEnd()})()}onAfterClearHistory(){var e=this;return(0,I._)(function*(){var t,r,n,a=eW.Command,{reporter:o,usePluginStore:i}=e.lifeCycleContext,s=eY({lifeCycleName:"onAfterClearHistory",lifeCycleScope:a,reporter:o}),{pluginInstanceList:l}=i.getState();for(var c of(null==s||s.recordLifeCycleStart(),l))null==s||s.recordPluginStart(c),yield null===(n=c.lifeCycleServices)||void 0===n?void 0:null===(r=n.commandLifeCycleService)||void 0===r?void 0:null===(t=r.onAfterClearHistory)||void 0===t?void 0:t.call(r),null==s||s.recordPluginEnd(c);null==s||s.recordLifeCycleEnd()})()}onBeforeStopResponding(){var e=this;return(0,I._)(function*(){var t,r,n,a=eW.Command,{reporter:o,usePluginStore:i}=e.lifeCycleContext,s=eY({lifeCycleName:"onBeforeStopResponding",lifeCycleScope:a,reporter:o}),{pluginInstanceList:l}=i.getState();for(var c of(null==s||s.recordLifeCycleStart(),l))null==s||s.recordPluginStart(c),yield null===(n=c.lifeCycleServices)||void 0===n?void 0:null===(r=n.commandLifeCycleService)||void 0===r?void 0:null===(t=r.onBeforeStopResponding)||void 0===t?void 0:t.call(r),null==s||s.recordPluginEnd(c);null==s||s.recordLifeCycleEnd()})()}onAfterStopResponding(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,o=eW.Command,{reporter:i,usePluginStore:s}=r.lifeCycleContext,l=eY({lifeCycleName:"onAfterStopResponding",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();for(var d of(null==l||l.recordLifeCycleStart(),c))null==l||l.recordPluginStart(d),yield null===(a=d.lifeCycleServices)||void 0===a?void 0:null===(n=a.commandLifeCycleService)||void 0===n?void 0:null===(e=n.onAfterStopResponding)||void 0===e?void 0:e.call(n,t),null==l||l.recordPluginEnd(d);null==l||l.recordLifeCycleStart()})()}onClearContextError(){var e=this;return(0,I._)(function*(){var t,r,n,a=eW.Command,{reporter:o,usePluginStore:i}=e.lifeCycleContext,s=eY({lifeCycleName:"onBeforeClearContext",lifeCycleScope:a,reporter:o}),{pluginInstanceList:l}=i.getState();for(var c of(null==s||s.recordLifeCycleStart(),l))null==s||s.recordPluginStart(c),yield null===(n=c.lifeCycleServices)||void 0===n?void 0:null===(r=n.commandLifeCycleService)||void 0===r?void 0:null===(t=r.onClearContextError)||void 0===t?void 0:t.call(r),null==s||s.recordPluginEnd(c);null==s||s.recordLifeCycleEnd()})()}onImageClick(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,{usePluginStore:o}=r.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(t);for(var l of i)yield null===(a=l.lifeCycleServices)||void 0===a?void 0:null===(n=a.commandLifeCycleService)||void 0===n?void 0:null===(e=n.onImageClick)||void 0===e?void 0:e.call(n,s)})()}onInputClick(){var e=this;return(0,I._)(function*(){var t,r,n,{usePluginStore:a}=e.lifeCycleContext,{pluginInstanceList:o}=a.getState();for(var i of o)yield null===(n=i.lifeCycleServices)||void 0===n?void 0:null===(r=n.commandLifeCycleService)||void 0===r?void 0:null===(t=r.onInputClick)||void 0===t?void 0:t.call(r)})()}onOnboardingSelectChange(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,{usePluginStore:o}=r.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(t);for(var l of i)yield null===(a=l.lifeCycleServices)||void 0===a?void 0:null===(n=a.commandLifeCycleService)||void 0===n?void 0:null===(e=n.onOnboardingSelectChange)||void 0===e?void 0:e.call(n,s)})()}onSelectionChange(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,{usePluginStore:o}=r.lifeCycleContext,{pluginInstanceList:i}=o.getState(),s=(0,eK.a)(t);for(var l of i)yield null===(a=l.lifeCycleServices)||void 0===a?void 0:null===(n=a.commandLifeCycleService)||void 0===n?void 0:null===(e=n.onSelectionChange)||void 0===e?void 0:e.call(n,s)})()}onStopRespondingError(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,o=eW.Command,{reporter:i,usePluginStore:s}=r.lifeCycleContext,l=eY({lifeCycleName:"onStopRespondingError",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState();for(var d of(null==l||l.recordLifeCycleStart(),c))null==l||l.recordPluginStart(d),yield null===(a=d.lifeCycleServices)||void 0===a?void 0:null===(n=a.commandLifeCycleService)||void 0===n?void 0:null===(e=n.onStopRespondingError)||void 0===e?void 0:e.call(n,t),null==l||l.recordPluginEnd(d);null==l||l.recordLifeCycleEnd()})()}onInputPaste(e){var{ctx:t}=e,r=this;return(0,I._)(function*(){var e,n,a,{usePluginStore:o}=r.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)yield null===(a=s.lifeCycleServices)||void 0===a?void 0:null===(n=a.commandLifeCycleService)||void 0===n?void 0:null===(e=n.onInputPaste)||void 0===e?void 0:e.call(n,t)})()}onViewScroll(){var e,t,r,{usePluginStore:n}=this.lifeCycleContext,{pluginInstanceList:a}=n.getState();for(var o of a)null===(r=o.lifeCycleServices)||void 0===r||null===(t=r.commandLifeCycleService)||void 0===t||null===(e=t.onViewScroll)||void 0===e||e.call(t)}onCardLinkElementMouseEnter(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onCardLinkElementMouseEnter)||void 0===t||t.call(r,a)}onCardLinkElementMouseLeave(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onCardLinkElementMouseLeave)||void 0===t||t.call(r,a)}onMdBoxImageElementMouseEnter(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onMdBoxImageElementMouseEnter)||void 0===t||t.call(r,a)}onMdBoxImageElementMouseLeave(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onMdBoxImageElementMouseLeave)||void 0===t||t.call(r,a)}onMdBoxLinkElementMouseEnter(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onMdBoxLinkElementMouseEnter)||void 0===t||t.call(r,a)}onMdBoxLinkElementMouseLeave(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onMdBoxLinkElementMouseLeave)||void 0===t||t.call(r,a)}onMessageLinkClick(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.commandLifeCycleService)||void 0===r||null===(t=r.onMessageLinkClick)||void 0===t||t.call(r,a)}constructor(e){this.lifeCycleContext=e}}class eQ{onAfterCreateStores(e){var t,r,n,a=eW.App,{reporter:o,usePluginStore:i}=this.lifeCycleContext,s=eY({lifeCycleName:"onAfterCreateStores",lifeCycleScope:a,reporter:o}),{pluginInstanceList:l}=i.getState();for(var c of(null==s||s.recordLifeCycleStart(),l))null==s||s.recordPluginStart(c),null===(n=c.lifeCycleServices)||void 0===n||null===(r=n.appLifeCycleService)||void 0===r||null===(t=r.onAfterCreateStores)||void 0===t||t.call(r,e),null==s||s.recordPluginEnd(c);null==s||s.recordLifeCycleEnd()}onBeforeInitial(){var e,t,r,n=eW.App,{reporter:a,usePluginStore:o}=this.lifeCycleContext,i=eY({lifeCycleName:"onBeforeInitial",lifeCycleScope:n,reporter:a}),{pluginInstanceList:s}=o.getState();for(var l of(null==i||i.recordLifeCycleStart(),s))null==i||i.recordPluginStart(l),null===(r=l.lifeCycleServices)||void 0===r||null===(t=r.appLifeCycleService)||void 0===t||null===(e=t.onBeforeInitial)||void 0===e||e.call(t),null==i||i.recordPluginEnd(l);null==i||i.recordLifeCycleEnd()}onAfterInitial(e){var t,r,n,{ctx:a}=e,o=eW.App,{reporter:i,usePluginStore:s}=this.lifeCycleContext,l=eY({lifeCycleName:"onAfterInitial",lifeCycleScope:o,reporter:i}),{pluginInstanceList:c}=s.getState(),d=(0,eK.a)(a);for(var u of(null==l||l.recordLifeCycleStart(),c))null==l||l.recordPluginStart(u),null===(n=u.lifeCycleServices)||void 0===n||null===(r=n.appLifeCycleService)||void 0===r||null===(t=r.onAfterInitial)||void 0===t||t.call(r,d),null==l||l.recordPluginEnd(u);null==l||l.recordLifeCycleEnd()}onInitialError(){var e,t,r,n=eW.App,{reporter:a,usePluginStore:o}=this.lifeCycleContext,i=eY({lifeCycleName:"onInitialError",lifeCycleScope:n,reporter:a}),{pluginInstanceList:s}=o.getState();for(var l of(null==i||i.recordLifeCycleStart(),s))null==i||i.recordPluginStart(l),null===(r=l.lifeCycleServices)||void 0===r||null===(t=r.appLifeCycleService)||void 0===t||null===(e=t.onInitialError)||void 0===e||e.call(t),null==i||i.recordPluginEnd(l);null==i||i.recordLifeCycleEnd()}onBeforeDestroy(){var e,t,r,n=eW.App,{reporter:a,usePluginStore:o}=this.lifeCycleContext,i=eY({lifeCycleName:"onBeforeDestroy",lifeCycleScope:n,reporter:a}),{pluginInstanceList:s}=o.getState();for(var l of(null==i||i.recordLifeCycleStart(),s))null==i||i.recordPluginStart(l),null===(r=l.lifeCycleServices)||void 0===r||null===(t=r.appLifeCycleService)||void 0===t||null===(e=t.onBeforeDestroy)||void 0===e||e.call(t),null==i||i.recordPluginEnd(l);null==i||i.recordLifeCycleEnd()}onBeforeRefreshMessageList(){var e,t,r,{usePluginStore:n}=this.lifeCycleContext,{pluginInstanceList:a}=n.getState();for(var o of a)null===(r=o.lifeCycleServices)||void 0===r||null===(t=r.appLifeCycleService)||void 0===t||null===(e=t.onBeforeRefreshMessageList)||void 0===e||e.call(t)}onAfterRefreshMessageList(){var e,t,r,{usePluginStore:n}=this.lifeCycleContext,{pluginInstanceList:a}=n.getState();for(var o of a)null===(r=o.lifeCycleServices)||void 0===r||null===(t=r.appLifeCycleService)||void 0===t||null===(e=t.onAfterRefreshMessageList)||void 0===e||e.call(t)}onRefreshMessageListError(e){var t,r,n,{ctx:a}=e,{usePluginStore:o}=this.lifeCycleContext,{pluginInstanceList:i}=o.getState();for(var s of i)null===(n=s.lifeCycleServices)||void 0===n||null===(r=n.appLifeCycleService)||void 0===r||null===(t=r.onRefreshMessageListError)||void 0===t||t.call(r,a)}onBeforeListenChatCore(e){var{usePluginStore:t}=this.lifeCycleContext,{pluginInstanceList:r}=t.getState(),n=!1;for(var a of r){var o,i,s,l=null===(s=a.lifeCycleServices)||void 0===s?void 0:null===(i=s.appLifeCycleService)||void 0===i?void 0:null===(o=i.onBeforeListenChatCore)||void 0===o?void 0:o.call(i,e);(null==l?void 0:l.abortListen)&&(n=!0)}return n}constructor(e){this.lifeCycleContext=e}}class e${constructor(e){this.lifeCycleContext=e,this.app=new eQ(this.lifeCycleContext),this.command=new eJ(this.lifeCycleContext),this.message=new eX(this.lifeCycleContext),this.render=new eV(this.lifeCycleContext)}}var e0=r("487942"),e1=e=>!!e.waiting||!!e.sending,e2=e=>{var t=new Set,r=e.subscribe(e1,e=>{t.forEach(t=>t(e))});return{listenProcessChatStateChange:e=>(t.add(e),{dispose:()=>{t.delete(e)}}),forceDispose:()=>{t.clear(),r()}}},e5=(e,t)=>(r,n)=>{var{toLatest:a,clearFirst:o}=n,{useMessagesStore:i}=e,{addMessages:s,findMessage:l}=i.getState();null==t||t({data:r}),s(o?r.message_list:r.message_list.filter(e=>!l(e.message_id)),{toLatest:a,clearFirst:o})},e4=e=>{switch(e){case M.xs.CozeHome:return"coze_home";case M.xs.Playground:return"bot_editor";default:return"third_part"}},e7=r("473980"),e8=r("479910"),e6=r("598208"),e9=r("61111"),e3=e=>(0,e6.Ue)()((0,e8.mW)((e,t)=>({pluginInstanceList:[],serviceOffSubscriptionList:[],setPluginInstanceList:t=>{e({pluginInstanceList:t},!1,"setPluginInstanceList")},updateServiceOffSubscriptionListByImmer:t=>{e((0,e9.Uy)(e=>t(e.serviceOffSubscriptionList)),!1,"updateServiceOffSubscriptionListByImmer")},appendServiceOffSubscriptionList:r=>{var{serviceOffSubscriptionList:n}=t();e({serviceOffSubscriptionList:[...n,r]},!1,"appendServiceOffSubscriptionList")},offAllSubscription:()=>{var{serviceOffSubscriptionList:e}=t();e.forEach(e=>e())},clearPluginStore:()=>{e({pluginInstanceList:[],serviceOffSubscriptionList:[]},!1,"clearPluginStore")}}),{name:"botStudio.ChatAreaPluginStore.".concat(e),enabled:!1}));class te{clearStoreSet(){if(!!this.prePositionedStoreSet){var e=this.prePositionedStoreSet,{usePluginStore:t}=e,r=(0,e7._)(e,["usePluginStore"]);(0,A.j_)(r),t.getState().clearPluginStore()}}constructor(e){this.context=e;var t=e3(this.context.mark);this.prePositionedStoreSet={usePluginStore:t}}}var tt=r("818584"),tr=r("716894"),tn=e=>(0,tr.F)()((0,e8.mW)((e,t)=>({suggestionBatchMap:{},setGenerateSuggestionError:t=>{e((0,e9.Uy)(e=>{var r=e.suggestionBatchMap[t];if(!r){e.suggestionBatchMap[t]={isError:!0,suggestions:[]};return}r.isError=!0}),!1,"setGenerateSuggestionError")},updateSuggestion:(t,r)=>{e((0,e9.Uy)(e=>{ta(t,r,e)}),!1,"updateSuggestion")},updateSuggestionsBatch:t=>{e((0,e9.Uy)(e=>{for(var r of t){var{replyId:n,suggestion:a}=r;ta(n,a,e)}}),!1,"updateSuggestionBatch")},getSuggestions:e=>{if(!!e)return t().suggestionBatchMap[e]},clearSuggestions:()=>{e({suggestionBatchMap:{}},!1,"clearSuggestions")}}),{name:"botStudio.ChatAreaSuggestions.".concat(e),enabled:!1})),ta=(e,t,r)=>{var n,{suggestionBatchMap:a}=r,o=null!==(n=a[e])&&void 0!==n?n:{suggestions:[]};if(a[e]=o,!o.suggestions.includes(t))o.suggestions.push(t)},to=r("615655"),ti=()=>({botInfoMap:{},userInfoMap:{},userInfo:null,waitingSenderId:null}),ts=e=>(0,e6.Ue)()((0,e8.mW)((0,e8.XR)((e,t)=>(0,c._)((0,l._)({},ti()),{updateWaitingSenderId:t=>e({waitingSenderId:t},!1,"updateWaitingSenderId"),updateBotInfo:r=>{e({botInfoMap:r(t().botInfoMap)},!1,"botInfoMap")},setSenderInfoBatch:r=>{var n={},{botInfoMap:a}=t();for(var o of r){var{id:i}=o,s=a[i];!(0,to.Z)(s,o)&&(n[i]=o)}if(!!Object.keys(n).length)e((0,e9.Uy)(e=>{(0,k.Z)(e.botInfoMap,n)}),!1,"setSenderInfoBatch")},updateBotInfoByImmer:t=>{e((0,e9.Uy)(e=>t(e.botInfoMap)),!1,"updateBotInfoByImmer")},setUserInfoMap:t=>{e({userInfoMap:t},!1,"setUserInfoMap")},setBotInfoMap:t=>{e({botInfoMap:t},!1,"setBotInfo")},updateUserInfo:t=>{e({userInfo:t},!1,"updateUserInfo")},getMessageUserInfo:e=>{var{userInfoMap:r,userInfo:n}=t();return e?r[e]||n||null:n},getBotInfo:e=>{var{botInfoMap:r}=t();if(!!e)return r[e]},clearSenderInfoStore:()=>{e(ti(),!1,"clearSenderInfoStore")}})),{name:"botStudio.ChatAreaSenderInfoStore.".concat(e),enabled:!1})),tl=r("707187"),tc=e=>(0,e6.Ue)()((0,e8.mW)((0,e8.XR)(e=>({selectedReplyIdList:[],selectedOnboardingId:null,onboardingIdList:[],addReplyId:t=>{e((0,e9.Uy)(e=>{e.selectedReplyIdList.push(t)}),!1,"addReplyId")},removeReplyId:t=>{e((0,e9.Uy)(e=>{e.selectedReplyIdList=e.selectedReplyIdList.filter(e=>e!==t)}),!1,"removeReplyId")},updateReplyIdList:t=>{e({selectedReplyIdList:t},!1,"updateReplyIdList")},clearSelectedReplyIdList:()=>{e({selectedReplyIdList:[]},!1,"clearSelectedReplyIdList")},setOnboardingSelected:t=>{e({selectedOnboardingId:t},!1,"setOnboardingSelected")},addOnboardingId:t=>{e((0,e9.Uy)(e=>{e.onboardingIdList.push(t)}),!1,"addOnboardingId")},removeOnboardingId:t=>{e((0,e9.Uy)(e=>{e.onboardingIdList=e.onboardingIdList.filter(e=>e!==t)}),!1,"removeOnboardingId")}})),{name:"botStudio.ChatAreaSelectionStore.".concat(e),enabled:!1})),td=(e,t,r)=>{var n,{useMessagesStore:a,useSelectionStore:o}=e;return o.subscribe(e=>e.selectedReplyIdList,(n=(0,I._)(function*(e){var n,{messageGroupList:o,messages:i}=a.getState(),s=o.filter(e=>e.selectable),l=s.filter(t=>e.includes(t.groupId)),c=(0,tl.w)(l),d={messageList:i.filter(e=>c.includes(e.message_id)),replyIdList:e,checkedLength:e.length,isAllChecked:l.length>0&&l.length===s.length};null==t||null===(n=t.onSelectionChange)||void 0===n||n.call(t,d),yield r.command.onSelectionChange({ctx:d})}),function(e){return n.apply(this,arguments)}))},tu=e=>(0,e6.Ue)()((0,e8.mW)((0,e8.XR)((e,t)=>({latestSectionId:"",prevSectionId:"",setLatestSectionId:r=>{var{latestSectionId:n}=t();e({latestSectionId:r,prevSectionId:n},!1,"setLatestSectionId")},clear:()=>e({latestSectionId:""},!1,"clear")})),{name:"botStudio.ChatAreaSectionId.".concat(e),enabled:!1})),tv=r("580868"),tm=r("346707"),tg=r("686555"),tp=e=>(0,e6.Ue)()((0,e8.mW)((0,e8.XR)(e=>({prologue:"",suggestions:[],avatar:"",name:"",clearOnboardingStore:()=>e({prologue:"",suggestions:[]},!1,"clearOnboardingStore"),partialUpdateOnboardingData:(t,r)=>e((0,tv.Z)({prologue:t,suggestions:r},tm.Z),!1,"partialUpdateOnboardingData"),recordBotInfo:t=>{var{name:r,avatar:n}=null!=t?t:{};e({name:r,avatar:n},!1,"recordBotInfo")},immerUpdateSuggestionById:(t,r)=>{e((0,e9.Uy)(e=>{var n=e.suggestions.find(e=>e.id===t);n&&(n.content=r)}),!1,"immerUpdateSuggestionById")},immerDeleteSuggestionById:t=>{e((0,e9.Uy)(e=>{(0,tg.Z)(e.suggestions,e=>e.id===t)}),!1,"deleteSuggestionById")},immerAddSuggestion:t=>{e((0,e9.Uy)(e=>{e.suggestions.push(t)}),!1,"addSuggestion")},updatePrologue:t=>{e({prologue:t},!1,"updatePrologue")},setSuggestionList:t=>{e({suggestions:t},!1,"setSuggestionList")}})),{name:"botStudio.ChatAreaOnboarding.".concat(e),enabled:!1})),tf=e=>{var t=e.at(0);if(!!t)t.showSuggestions=!t.showContextDivider},th=r("815454"),t_=r("625592"),tx=r("187792"),ty=e=>{var{group:t,messages:r,isShow:n}=e;if(!n){t.showContextDivider=null;return}if((0,tx.q)(t,r).some(e=>!!e.extra_info.new_section_id)){t.showContextDivider="without-onboarding";return}t.showContextDivider="with-onboarding"},tb=e=>{var{message:t}=e;return"user"===t.role?"user":"answer"===t.type||(0,z.eg)(t)?"llm":"follow_up"===t.type?"follow_up":"function_call"},tS=e=>"assistant"===e.role?e.reply_id:e.message_id||e.extra_info.local_message_id,tC=(e,t)=>({groupId:e,sectionId:t,isLatest:!1,showContextDivider:null,memberSet:{userMessageId:"",functionCallMessageIdList:[],llmAnswerMessageIdList:[],followUpMessageIdList:[]}}),tj=(e,t)=>{for(var r=[],n=new Map,a=(e,t)=>{if(!r.includes(e)){var a=tC(e,t);return n.set(e,a),r.push(e),a}var o=n.get(e);if(!o)throw Error("fail to get back group of ".concat(e));return o},o=e=>{var r=a(tS(e),e.section_id);if(!!r){var n=tb({message:e}),{memberSetType:o=n}=t.message.onBeforeDistributeMessageIntoMemberSet({ctx:{message:e,memberSetType:n}});if(!o)throw Error("fail to get member set type");switch(o){case"user":r.memberSet.userMessageId=(0,z.lF)(e);break;case"llm":r.memberSet.llmAnswerMessageIdList.push((0,z.lF)(e));break;case"function_call":r.memberSet.functionCallMessageIdList.push((0,z.lF)(e));break;case"follow_up":r.memberSet.followUpMessageIdList.push((0,z.lF)(e));break;default:(0,t_.A)(o)}}},i=e.length-1;i>-1;i--){var s=e.at(i);if(!s)throw Error("fail to iterate scanMessageToMakeGroups");o(s)}var l=r.reverse(),c=(0,A.hB)(n,l);return c.forEach(tw),tE(c,e),function(e){var t=e.at(0);t&&(t.isLatest=!0)}(c),c},tw=e=>{var t=e.memberSet,{functionCallMessageIdList:r,llmAnswerMessageIdList:n,userMessageId:a,followUpMessageIdList:o}=t,i=(0,e7._)(t,["functionCallMessageIdList","llmAnswerMessageIdList","userMessageId","followUpMessageIdList"]);(0,th.T)(i),r.reverse(),n.reverse(),o.reverse()},tE=(e,t)=>{for(var r=0;r<e.length-1;r++){var n=e.at(r),a=e.at(r+1);if(!n||!a)throw Error("impossible scanGroupsToMarkContextDividers");ty({group:a,isShow:n.sectionId!==a.sectionId,messages:t})}},tk=e=>{var{messageGroupList:t,latestSectionId:r,messageList:n}=e,a=t.at(0);if(!!a)ty({group:a,isShow:a.sectionId!==r,messages:n})},tI=(e,t)=>{var r=new Set(e.map(e=>e.message_id).filter(e=>!!e)),n=new Set(e.map(e=>e.extra_info.local_message_id).filter(e=>!!e));return t.filter(e=>!r.has(e.message_id)&&!n.has(e.extra_info.local_message_id))},tT=e=>(t,r)=>{e((0,e9.Uy)(e=>{if("string"==typeof t){if(!(0,z.tx)(r)){(0,A.Cj)("message is required when use id to updateMessage");return}var n=(0,z.XW)(e.messages,t);if(n<0){(0,A.Cj)("cannot find message with id ".concat(t));return}e.messages[n]=r;return}var a=(0,z.Hw)(e.messages,t);if(a<0){(0,A.Cj)("cannot find message with id ".concat((0,z.E2)(t)));return}r?e.messages[a]=r:(0,z.tx)(t)?e.messages[a]=t:(0,A.Cj)("id struct is not valid message")}),!1,"updateMessage")},tM=r("231595"),tA=()=>({hasMore:!1,cursor:"0"}),tN=()=>({messageGroupList:[],messages:[],pagination:tA()}),tL=e=>(0,tr.F)()((0,e8.mW)((0,e8.XR)((e,t)=>(0,c._)((0,l._)({},tN()),{findMessage:e=>{var{messages:r}=t();return"string"==typeof e?(0,z.$)(r,e):(0,z.cC)(r,e)},hasMessage:e=>{var{messages:r}=t();return"string"==typeof e?!!(0,z.$)(r,e):!!(0,z.cC)(r,e)},updateMessage:tT(e),addMessage:t=>{e((0,e9.Uy)(e=>{if((0,z.cC)(e.messages,t)){console.error("unexpected addMessage duplicate");return}e.messages.unshift(t)}),!1,"addMessage")},addMessages:function(t){var{clearFirst:r=!1,toLatest:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(e=>{if(r)return{messages:t};var a=e.messages,o=tI(a,t);return{messages:n?o.concat(a):a.concat(o)}},!1,"addMessages")},deleteMessageByIdStruct:t=>{e((0,e9.Uy)(e=>{var r=(0,z.Hw)(e.messages,t);if(r<0){console.error("cannot find message ".concat(t.message_id));return}e.messages.splice(r,1)}),!1,"deleteMessageByIdStruct")},deleteMessageById:t=>{e((0,e9.Uy)(e=>{var r=(0,z.XW)(e.messages,t);if(r<0){console.error("cannot find message ".concat(t));return}e.messages.splice(r,1)}),!1,"deleteMessageById")},deleteMessageByIdList:r=>{e({messages:t().messages.filter(e=>0>r.findIndex(t=>t===(0,z.lF)(e)))},!1,"deleteMessageByIdList")},setGroupMessageList:t=>{e({messageGroupList:t},!1,"setGroupMessageList")},updateMessageGroupByImmer:t=>{e((0,e9.Uy)(e=>t(e.messageGroupList)),!1,"updateMessageGroupByImmer")},getMessageIndexRange:()=>(0,tM.Q)(t().messages),getMessageGroupById:e=>(0,D.Xn)(t().messageGroupList,e),getMessageGroupByUserMessageId:e=>(0,D.ge)(t().messageGroupList,e),isLastMessageGroup:e=>{var{messageGroupList:r}=t(),n=r.at(0);return(null==n?void 0:n.groupId)===e},clearMessage:()=>{t().clearMessageStore()},clearMessageStore:()=>{e(tN(),!1,"clearAll")}})),{name:"botStudio.ChatAreaMessage.".concat(e),enabled:!1})),tZ=e=>{var{useMessagesStore:t,useSectionIdStore:r}=e;return r.subscribe(e=>e.latestSectionId,e=>{var{updateMessageGroupByImmer:r,messages:n}=t.getState();r(t=>{tk({messageGroupList:t,latestSectionId:e,messageList:n}),tf(t)})})},tG=(e,t,r)=>{var{useMessagesStore:n,useSectionIdStore:a}=e;return n.subscribe(e=>e.messages,e=>{var o,{latestSectionId:i}=a.getState(),s=tj(e,r);tk({messageGroupList:s,latestSectionId:i,messageList:e}),tf(s);var l=null==t?void 0:null===(o=t.onBeforeMessageGroupListUpdate)||void 0===o?void 0:o.call(t,(0,eK.a)(s),(0,eK.a)(e)),c=(0,eK.a)({messageGroupList:null!=l?l:s}),{messageGroupList:d}=r.message.onBeforeMessageGroupListUpdate({ctx:c});n.getState().setGroupMessageList(null!=d?d:s)})},tP=e=>{var{metaList:t,configs:r,getIsVisibleMessageMeta:n}=e;tB({metaList:t,configs:r,getIsVisibleMessageMeta:n})},tB=e=>{var{metaList:t,configs:r,getIsVisibleMessageMeta:n}=e,a=null!=n?n:z.Fl,o=t.filter(e=>a(e,r));if(!(o.length<=1))for(var i=o.length-1;i>0;i--){var s=o[i-1];if(!(o[i]&&s))return;s.beforeHasJumpVerbose&&s.isGroupFirstAnswer&&(s.showMultiAgentDivider=!0)}},tR=(e,t)=>{tD(e,t),tF(e,t),tU(e,t)},tD=(e,t)=>{var r=t.at(0);if(!!r){var n=(0,tl.w)([r]);e.filter(e=>n.some(t=>(0,z.Bc)(e,t))).forEach(e=>e.isFromLatestGroup=!0)}},tF=(e,t)=>{t.forEach(t=>{var{memberSet:r}=t,n=tO(r);if(!!n){var a=e.find(e=>(0,z.Bc)(e,n));if(!a){(0,A.Cj)("cannot find meta by group answer id ".concat(n));return}a.isGroupLastMessage=!0}})},tU=(e,t)=>{t.forEach(t=>{var{memberSet:r}=t,n=r.llmAnswerMessageIdList.at(0);if(!!n){var a=e.find(e=>(0,z.Bc)(e,n));if(!a){(0,A.Cj)("cannot find meta by group answer id ".concat(n));return}a.isGroupLastAnswerMessage=!0}})},tO=e=>{var{llmAnswerMessageIdList:t,functionCallMessageIdList:r,userMessageId:n}=e,a=t.at(0);if(a)return a;var o=r.at(0);return o?o:n},tz=(e,t)=>{var r=e.filter(e=>(0,z.Fl)(e,t));if(!(r.length<=1))t.groupUserMessage?tW(r):tH(r)},tW=e=>{for(var t=0;t<e.length-1;t++){var r=e[t],n=e[t+1];if(!(!r||!n||r.role!==n.role||"assistant"!==r.role||r.sectionId!==n.sectionId||(0,z.eg)(r)||(0,z.mJ)(r)))r.hideAvatar=!0}},tH=e=>{for(var t=0;t<e.length-1;t++){var r=e[t],n=e[t+1];if(!!r&&!!n&&r.role===n.role&&"user"!==r.role&&"assistant"===r.role&&r.replyId===n.replyId)r.hideAvatar=!0}},tK=r("933953"),tV=r("144552"),tq=(e,t)=>{var r=t[e];if(!r)throw Error("cannot find message of index: ".concat(e));return!r._fromHistory&&"function_call"===r.type&&!tX(r,e,t)},tY=new Map,tX=(e,t,r)=>{var n,a,{message_id:o}=e;return(null===(n=tY.get(o))||void 0===n?!!void 0:!!n.isFinish)||(tJ(e,t,r),!!(null===(a=tY.get(o))||void 0===a?void 0:a.isFinish))},tJ=(e,t,r)=>{var n=e.index;if("number"!=typeof n){console.error("function call message without index",e);return}var a=n+1;(0,tV.p)(r,t,15).find(t=>{var r,n;t.reply_id===e.reply_id&&((null===(r=t.extra_info)||void 0===r?void 0:r.call_id)===(null===(n=e.extra_info)||void 0===n?void 0:n.call_id)||t.index===a)&&"tool_response"===t.type&&tY.set(e.message_id,{isFinish:!0,isStreamPlugin:!1,streamPlugin:null})})},tQ=r("4154"),t$=e=>"object"==typeof e&&null!==e,t0=e=>{var t=(0,tQ.d)(e);return t$(t)?t:{}},t1=e=>{var t,{index:r,messages:n}=e,a=n[r];if(!a)throw Error("get message exception: invalid index: ".concat(r));return{_fromHistory:a._fromHistory,showActions:!1,showMultiAgentDivider:!1,isReceiving:"assistant"===a.role&&!a.is_finish,isSending:"user"===a.role&&!a.is_finish,isFunctionCalling:tq(r,n),isFail:!!a._sendFailed,message_id:a.message_id,role:a.role,type:a.type,isFromLatestGroup:!1,isGroupLastMessage:!1,isGroupLastAnswerMessage:!1,sectionId:a.section_id,hideAvatar:!1,botState:t0(a.extra_info.bot_state),replyId:a.reply_id,isGroupFirstAnswer:!1,beforeHasJumpVerbose:!1,verboseMsgType:(null===(t=(0,tK.Qq)(a.content))||void 0===t?void 0:t.msg_type)||"",extra_info:{local_message_id:a.extra_info.local_message_id},source:a.source,cardDisabled:(0,z.zH)(r,n)}},t2=e=>{for(var t=null,r=e.length-1;r>=0;r--){var n=e[r];if(!!n){if(n.verboseMsgType===M.kc.JUMP_TO){t=n;continue}var a=t&&n.replyId===t.replyId,o="answer"===n.type;a&&o&&(n.beforeHasJumpVerbose=!0)}}},t5=e=>{for(var t=e.filter(e=>"answer"===e.type),r=null,n=t.length-1;n>=0;n--){var a=t[n];if(!!a){if(!r){a.isGroupFirstAnswer=!0,r=a;continue}a.replyId!==r.replyId&&(a.isGroupFirstAnswer=!0,r=a)}}},t4=e=>(0,tr.F)()((0,e8.mW)((0,e8.XR)((e,t)=>({metaList:[],getMetaByMessage:e=>{var r=(0,z.$)(t().metaList,e);if(!r)throw Error("fail to find meta of ".concat(e));return r},updateMeta:t=>{e({metaList:t},!1,"updateMeta")},updateMetaByImmer:t=>{e((0,e9.Uy)(e=>t(e.metaList)),!1,"updateMetaByImmer")},clear:()=>{e({metaList:[]},!1,"clear")}})),{name:"botStudio.ChatAreaMessageMeta.".concat(e),enabled:!1})),t7=(e,t)=>{var{useMessagesStore:r,useMessageMetaStore:n,useSectionIdStore:a}=e;return r.subscribe(e=>e.messageGroupList,e=>{var{messages:o}=r.getState(),i=o.map((e,t)=>t1({index:t,messages:o}));tR(i,e),t5(i),t2(i),tP({metaList:i,configs:t,latestSectionId:a.getState().latestSectionId}),tz(i,t),n.getState().updateMeta(i)})},t8=(e,t)=>{var{useMessageMetaStore:r,useSectionIdStore:n}=e;return n.subscribe(e=>e.latestSectionId,e=>{var{updateMetaByImmer:n}=r.getState();n(e=>{tz(e,t)})})},t6=()=>({ignoreIndexAndHistoryMessages:!1,endIndex:"0",readIndex:"0",maxLoadIndex:"0",prevHasMore:!1,nextHasMore:!1,cursor:"0",nextCursor:"0",scrollViewFarFromBottom:!1,loadLock:{"load-eagerly":null,"load-next":null,"load-prev":null,"load-silently":null},loadError:[]}),t9=e=>(0,e6.Ue)()((0,e8.mW)((e,t)=>(0,c._)((0,l._)({},t6()),{updateIgnoreIndexAndHistoryMessages:t=>e({ignoreIndexAndHistoryMessages:t},!1,"updateIgnoreIndexAndHistoryMessages"),updateIndex:r=>{var n=t(),a={};if((0,A._X)(r.endIndex||"0").greaterThan(n.endIndex)&&(a.endIndex=r.endIndex),(0,A._X)(r.readIndex||"0").greaterThan(n.readIndex)&&(a.readIndex=r.readIndex),!!Object.keys(a).length)e(a,!1,"updateIndex")},privateUpdateLoadIndexRange:r=>{if(!!(0,A._X)(r).greaterThan(t().maxLoadIndex))e({maxLoadIndex:r},!1,"updateMaxLoadIndex")},updateHasMore:t=>e(t,!1,"updateHasMore"),updateCursor:t=>e(t,!1,"updateCursor"),updateLockAndErrorByImmer:t=>e((0,e9.Uy)(t),!1,"updateLockAndError"),setScrollViewFarFromBottom:r=>{if(t().scrollViewFarFromBottom!==r)e({scrollViewFarFromBottom:r},!1,"setScrollViewFarFromBottom")},resetLoadLockAndError:()=>{e({loadLock:t6().loadLock,loadError:[]},!1,"resetLoadLockAndError")},resetCursors:()=>{var t=t6();e({cursor:t.cursor,nextCursor:t.nextCursor},!1,"resetCursor")},resetHasMore:()=>{var t=t6();e({nextHasMore:t.nextHasMore,prevHasMore:t.prevHasMore},!1,"resetHasMore")},alignMessageIndexes:()=>{var{readIndex:r,endIndex:n}=t();if(r!==n){var a="";e({readIndex:a=(0,A._X)(r).greaterThan(n)?r:n,endIndex:a},!1,"alignIndexes")}},clearAll:()=>{e(t6(),!1,"clearAll")}}),{name:"botStudio.ChatAreaMessageIndex.".concat(e),enabled:!1})),t3=e=>{var{useMessagesStore:t,useMessageIndexStore:r}=e;return t.subscribe(e=>e.messages,e=>{re(e,r)})},re=(e,t)=>{var{max:r="0"}=(0,tM.Q)(e)||{};t.getState().privateUpdateLoadIndexRange(r)},rt=r("102400"),rr=e=>(0,e6.Ue)()((0,e8.mW)((0,e8.XR)((e,t)=>({initStatus:"unInit",chatCore:null,conversationId:null,offChatCoreListen:()=>void 0,setInitStatus:t=>{e({initStatus:t},!1,"setInitStatus")},setConversationId:t=>{e({conversationId:t},!1,"")},setChatCore:t=>{e({chatCore:t},!1,"setChatCore")},setChatCoreOffListen:t=>{e({offChatCoreListen:t},!1,"setChatCoreOffListen")},getChatCore:()=>{var{chatCore:e}=t();return e?e:(0,rt.X)()},clearSideEffect:()=>{var r;t().offChatCoreListen(),null===(r=t().chatCore)||void 0===r||r.destroy(),e({initStatus:"unInit",chatCore:null,conversationId:null},!1,"clearInitStore")}})),{name:"botStudio.ChatAreaInit.".concat(e),enabled:!1})),rn=()=>({temporaryFile:{},previewURL:"",audioFileMap:{},audioProcessMap:{}}),ra=e=>(0,e6.Ue)()((0,e8.mW)((e,t)=>(0,c._)((0,l._)({},rn()),{addAudioFile:t=>{var{localMessageId:r,audioFile:n}=t;e((0,e9.Uy)(e=>{e.audioFileMap[r]=n}),!1,"addAudioFile")},getAudioFileByLocalId:e=>t().audioFileMap[e],getAudioProcessStateByLocalId:e=>t().audioProcessMap[e],clearAudioStore:()=>{e(rn(),!1,"clearAudioStore")},updateTemporaryFile:(t,r)=>{e((0,e9.Uy)(e=>{e.temporaryFile[t]=r}),!1,"updateTemporaryFile")},deleteTemporaryFile:t=>{e((0,e9.Uy)(e=>{e.temporaryFile[t]=null}),!1,"deleteTemporaryFile")},removeAudioFileByLocalId:t=>{e((0,e9.Uy)(e=>{if(!!e.audioFileMap[t])delete e.audioFileMap[t]}),!1,"removeAudioFileByLocalId")},updateAudioProcessState:t=>{var{localMessageId:r,state:n}=t;e((0,e9.Uy)(e=>{if("processing"===n){e.audioProcessMap[r]=n;return}"finish"===n&&"processing"===e.audioProcessMap[r]&&delete e.audioProcessMap[r]}),!1,"updateAudioProcessState")},updatePreviewURL:t=>{e({previewURL:t},!1,"updatePreviewURL")},clear:()=>e(rn(),!1,"clear")}),{name:"botStudio.ChatAreaFileStore.".concat(e),enabled:!1})),ro=()=>({answerActionLockMap:{},globalActionLock:{clearContext:null,clearHistory:null,sendMessageToACK:null}}),ri=e=>(0,e6.Ue)()((0,e8.mW)((e,t)=>(0,c._)((0,l._)({},ro()),{updateAnswerActionLockMapByImmer(t){e(e=>({answerActionLockMap:(0,e9.Uy)(e.answerActionLockMap,t)}),!1,"updateAnswerActionLockMapByImmer")},updateGlobalActionLockOnlyDefined:r=>{e({globalActionLock:(0,k.Z)({},t().globalActionLock,(0,tv.Z)(r,tm.Z))},!1,"updateGlobalActionLockOnlyDefined")},updateAnswerActionLockMapOnlyDefined:(t,r)=>{e(e=>({answerActionLockMap:(0,e9.Uy)(e.answerActionLockMap,e=>{var n=e[t],a=(0,tv.Z)(r,tm.Z);if(!n){e[t]=(0,k.Z)({},{deleteMessageGroup:null,regenerate:null},a);return}e[t]=(0,k.Z)({},n,a)})}),!1,"updateAnswerActionLockMapOnlyDefined")},updateGlobalActionLockByImmer(t){e(e=>({globalActionLock:(0,e9.Uy)(e.globalActionLock,t)}),!1,"updateGlobalActionLockByImmer")},getAnswerActionLockMap:()=>t().answerActionLockMap,getGlobalActionLock:()=>t().globalActionLock,clearAll:()=>e(ro(),!1,"clearAll")}),{enabled:!1,name:"botStudio.ChatAreaAction.".concat(e)})),rs=r("519698"),rl=()=>({fileDataMap:{},fileIdList:[],fileTypeMap:{}}),rc=e=>(0,e6.Ue)()((0,e8.mW)((e,t)=>(0,c._)((0,l._)({},rl()),{immerCreateFileData:(t,r)=>{e((0,e9.Uy)(e=>{var n={percent:0,uri:null,file:r,id:t,status:rs.K.Uploading},a=g(r)?(0,c._)((0,l._)({},n),{fileType:rs.T.Image,meta:null}):(0,c._)((0,l._)({},n),{fileType:rs.T.File});if(e.fileDataMap[t])throw Error("duplicate file id ".concat(t));e.fileDataMap[t]=a,e.fileTypeMap[t]=a.fileType,e.fileIdList.push(t)}),!1,"immerCreateFileData")},immerDeleteFileDataById:t=>{e((0,e9.Uy)(e=>{var r=m(e.fileIdList,t);if(r<0)throw Error("failed to find file ".concat(t));e.fileIdList.splice(r,1),delete e.fileDataMap[t],delete e.fileTypeMap[t]}),!1,"immerDeleteFileDataById")},immerUpdateFileDataById:(t,r)=>{e((0,e9.Uy)(e=>{var n=e.fileDataMap[t];if(!n)throw Error("failed to find file ".concat(t));r(n)}),!1,"immerUpdateFileDataById")},hasFileNotSuccess:()=>t().fileIdList.some(e=>{var r;return(null===(r=t().fileDataMap[e])||void 0===r?void 0:r.status)!==rs.K.Success}),clearAllData:()=>{e(rl(),!1,"clearAllData")},getFileDataList:()=>t().fileIdList.map(e=>t().fileDataMap[e]).filter(e=>!!e),getFileType:e=>t().fileTypeMap[e],getExistingFileCount:()=>t().fileIdList.length}),{enabled:!1,name:"botStudio.ChatAreaBatchFileUpload.".concat(e)})),rd=()=>({isRecording:!1,isPointerMoveOut:!1,audioLeftTime:null,recordingInteractionType:null}),ru=e=>(0,e6.Ue)()((0,e8.mW)(e=>(0,c._)((0,l._)({},rd()),{setIsRecording:t=>{e({isRecording:t},!1,"setIsRecording")},setIsPointerMoveOut:t=>{e({isPointerMoveOut:t},!1,"setIsPointerMoveOut")},setAudioLeftTime:t=>{e({audioLeftTime:t},!1,"setAudioLeftTime")},clearAudioLeftTime:()=>{e({audioLeftTime:null},!1,"clearAudioLeftTime")},setRecordingInteractionType:t=>{e({recordingInteractionType:t},!1,"setRecordingInteractionType")},clear:()=>e(rd(),!1,"clear")}),{name:"botStudio.ChatAreaAudioUIStore.".concat(e),enabled:!1})),rv=e=>{var{updateIgnoreIndexAndHistoryMessages:t}=e.getState();return{updateIgnoreIndexAndHistoryMessages:t}};class rm{runCreateLifeCycle(){if(!this.storeSet){console.error("store set not ready");return}this.context.lifeCycleService.app.onAfterCreateStores({messageIndexStore:rv(this.storeSet.useMessageIndexStore)})}createStoreSet(){var e=rr(this.context.mark),t=t4(this.context.mark),r=tL(this.context.mark),n=tu(this.context.mark),a=(0,tt.oQ)(this.context.mark),o=tp(this.context.mark),i=ra(this.context.mark),s=tn(this.context.mark),l=tc(this.context.mark),c=ts(this.context.mark),d=rc(this.context.mark),u=t9(this.context.mark),v=ri(this.context.mark);return{useGlobalInitStore:e,useMessageMetaStore:t,useMessagesStore:r,useSectionIdStore:n,useWaitingStore:a,useOnboardingStore:o,useFileStore:i,useSuggestionsStore:s,useSelectionStore:l,useSenderInfoStore:c,useBatchFileUploadStore:d,useMessageIndexStore:u,useChatActionStore:v,useAudioUIStore:ru(this.context.mark)}}subscribeStore(){if(!!this.storeSet){var{useMessagesStore:e,useMessageMetaStore:t,useSectionIdStore:r,useSelectionStore:n,useMessageIndexStore:a}=this.storeSet,o=t7({useMessagesStore:e,useMessageMetaStore:t,useSectionIdStore:r},this.context.configs),i=t8({useMessageMetaStore:t,useSectionIdStore:r},this.context.configs),s=td({useMessagesStore:e,useSelectionStore:n},this.context.eventCallback,this.context.lifeCycleService),l=tZ({useMessagesStore:e,useSectionIdStore:r}),c=tG({useMessagesStore:e,useSectionIdStore:r},this.context.eventCallback,this.context.lifeCycleService),d=t3({useMessageIndexStore:a,useMessagesStore:e});this.unsubscribeStore=()=>{o(),i(),s(),l(),c(),d()}}}clearStoreSet(){if(!!this.storeSet){var e=this.storeSet,{useBatchFileUploadStore:t,useChatActionStore:r,useFileStore:n,useGlobalInitStore:a,useMessageIndexStore:o,useMessageMetaStore:i,useMessagesStore:s,useOnboardingStore:l,useSectionIdStore:c,useSelectionStore:d,useSenderInfoStore:u,useSuggestionsStore:v,useWaitingStore:m,useAudioUIStore:g}=e,p=(0,e7._)(e,["useBatchFileUploadStore","useChatActionStore","useFileStore","useGlobalInitStore","useMessageIndexStore","useMessageMetaStore","useMessagesStore","useOnboardingStore","useSectionIdStore","useSelectionStore","useSenderInfoStore","useSuggestionsStore","useWaitingStore","useAudioUIStore"]);(0,A.j_)(p),a.getState().clearSideEffect(),i.getState().clear(),s.getState().clearMessageStore(),c.getState().clear(),m.getState().clearAllUnsettledUnconditionally(),l.getState().clearOnboardingStore(),n.getState().clear(),v.getState().clearSuggestions(),d.getState().clearSelectedReplyIdList(),u.getState().clearSenderInfoStore(),t.getState().clearAllData(),o.getState().clearAll(),r.getState().clearAll(),g.getState().clear()}}constructor(e){if(this.unsubscribeStore=()=>{},this.context=e,this.storeSet=this.createStoreSet(),!this.storeSet){console.error("init store error");return}this.subscribeStore()}}class rg{assertInitialized(){var{loadMoreClient:e,loadMoreDispose:t,loadMoreEnvTools:r,mark:n,reporter:a,lifeCycleService:o,chatActionLockService:i,destroyPlugins:s,initStoreService:l,preInitStoreService:c,storeSet:d}=this;if(!e||!r||!n||!a||!o||!i||!s||!t||!l||!c||!d)throw Error("InitService error")}initServices(){this.mark=e4(this.context.scene),this.reporter=this.context.reporter.createReporterWithPreset({namespace:"bot-platform"}),this.preInitStoreService=new te({mark:this.mark,scene:this.context.scene,extendDataLifecycle:this.context.extendDataLifecycle,reporter:this.reporter}),this.lifeCycleService=new e$({reporter:this.reporter,usePluginStore:this.preInitStoreService.prePositionedStoreSet.usePluginStore}),this.initStoreService=new rm({scene:this.context.scene,mark:this.mark,lifeCycleService:this.lifeCycleService,extendDataLifecycle:this.context.extendDataLifecycle,configs:this.context.configs,reporter:this.reporter,eventCallback:null!==(e=this.context.eventCallback)&&void 0!==e?e:null,prePositionedStoreSet:this.preInitStoreService.prePositionedStoreSet}),this.storeSet=(0,l._)({},this.initStoreService.storeSet,this.preInitStoreService.prePositionedStoreSet),this.chatActionLockService=this.createChatActionLockService();var e,{loadMoreClient:t,loadMoreDispose:r,loadMoreEnvTools:n}=this.createLoadMoreService(),a={context:{lifeCycleService:this.lifeCycleService,eventCallback:this.context.eventCallback,reporter:this.context.reporter},services:{loadMoreClient:t,chatActionLockService:this.chatActionLockService},storeSet:this.storeSet};this.destroyPlugins=eB({pluginRegistryList:this.context.pluginRegistryList,storeSet:this.storeSet,refreshMessageList:this.refreshMessageList,eventCallback:this.context.eventCallback,reporter:this.reporter,lifeCycleService:this.lifeCycleService,getCommonDeps:()=>a}),this.initStoreService.runCreateLifeCycle(),this.loadMoreClient=t,this.loadMoreDispose=r,this.loadMoreEnvTools=n}createChatActionLockService(){var{getAnswerActionLockMap:e,getGlobalActionLock:t,updateGlobalActionLockByImmer:r,updateAnswerActionLockMapByImmer:n}=this.storeSet.useChatActionStore.getState();return new ei.c({updateGlobalActionLockByImmer:r,getGlobalActionLock:t,updateAnswerActionLockMapByImmer:n,getAnswerActionLockMap:e,readEnvValues:()=>{var e;return{enableChatActionLock:null!==(e=this.context.enableChatActionLock)&&void 0!==e&&e}},reporter:this.context.reporter})}createLoadMoreService(){var{useMessageIndexStore:e,useGlobalInitStore:t,useWaitingStore:r}=this.storeSet,{listenProcessChatStateChange:n,forceDispose:a}=e2(this.storeSet.useWaitingStore);this.loadMoreDispose=a;var o=(()=>{var a,{updateCursor:o,updateIndex:i,updateHasMore:s,updateLockAndErrorByImmer:d,resetCursors:u,resetHasMore:v,resetLoadLockAndError:m,alignMessageIndexes:g,clearAll:p}=e.getState(),f=new L.P({reporter:this.reporter,updateCursor:o,updateHasMore:s,updateIndex:i,resetCursors:u,resetHasMore:v,resetLoadLockAndError:m,alignMessageIndexes:g,updateLockAndErrorByImmer:d,clearMessageIndexStore:p,insertMessages:e5(this.storeSet,null===(a=this.context.eventCallback)||void 0===a?void 0:a.onBeforeLoadMoreInsertMessages),loadRequest:(0,e0.B)({reporter:this.reporter,getChatCore:()=>f.chatCore,ignoreMessageConfigList:this.context.configs.ignoreMessageConfigList,lifeCycleService:this.lifeCycleService}),requestMessageIndex:e=>N.nA.GetConversationParticipantsReadIndex({conversation_id:e||t.getState().conversationId||""}),readEnvValues:()=>{var t=e.getState(),n=r.getState();return(0,c._)((0,l._)({},this.context.loadMoreFlagRef.current,t),{isProcessingChat:e1(n)})},waitMessagesLengthChangeLayoutEffect:()=>{},listenProcessChatStateChange:n});return f})();return{loadMoreEnvTools:o,loadMoreClient:new Z.Y(o),loadMoreDispose:a}}locateToUnreadMessage(){this.loadMoreClient.locateToUnreadMessage({messages:this.storeSet.useMessagesStore.getState().messages,readIndex:this.storeSet.useMessageIndexStore.getState().readIndex})}clearInitSideEffect(){this.initStoreService.clearStoreSet(),this.preInitStoreService.clearStoreSet()}requestInitData(e){var{onBefore:t,onAfter:r,onError:n}=e,a=this;return(0,I._)(function*(){if(a.getIsSkipInit())return null;null==t||t();var e=a.latestRequestIndex+1;a.latestRequestIndex=e;try{var o=yield a.context.requestToInit();if(a.requestAborted||e<a.latestRequestIndex)return null;return a.loadMoreClient.clearMessageIndexStore(),a.initStoreService.runCreateLifeCycle(),o}catch(e){console.error("init error",e),null==n||n();var{error:i,meta:s}=(0,A.aH)(e);a.reporter.errorEvent({eventName:eU.q.Init,error:i,meta:Object.assign({},s,{isPolicyException:eD(i)})})}return null==r||r(),null})()}processInit(){var e=this;return(0,I._)(function*(){e.setInitStatus("loading"),e.requestAborted=!1;var t,r,n=yield e.requestInitData({onError:()=>{var t,r;e.setInitStatus("initFail"),null===(r=e.context.eventCallback)||void 0===r||null===(t=r.onInitError)||void 0===t||t.call(r),e.lifeCycleService.app.onInitialError()}});if(!!n&&!e.requestAborted)return e.loadMoreClient.handleInitialLoadIndex(n),e.recordUserAndBotInfo({requestData:n}),e.createAndRecordChatCore({requestData:n}),e.registerUploadPlugin(),e.recordConversationParams({requestData:n}),e.setInitStatus("initSuccess"),null===(r=e.context.eventCallback)||void 0===r||null===(t=r.onInitSuccess)||void 0===t||t.call(r),n})()}createAndRecordChatCore(e){var t,r,{requestData:n}=e;if(!(null==n?void 0:n.conversationId)){this.reporter.errorEvent({eventName:eU.q.Init,error:Error("Invalid Response without conversationId")}),this.setInitStatus("initFail"),null===(r=this.context.eventCallback)||void 0===r||null===(t=r.onInitError)||void 0===t||t.call(r),this.lifeCycleService.app.onInitialError();return}var{useGlobalInitStore:a,useMessagesStore:o,useWaitingStore:i,useSuggestionsStore:s,useSectionIdStore:c}=this.storeSet,{setConversationId:d,setChatCore:u,setChatCoreOffListen:v}=a.getState();d(n.conversationId);var m=new M.ZP((0,l._)({bot_version:n.botVersion,conversation_id:n.conversationId,space_id:this.context.spaceId,bot_id:this.context.botId,preset_bot:this.context.presetBot,draft_mode:this.context.scene===M.xs.Playground,biz:this.mark,env:"boe",deployVersion:"inhouse",logLevel:"error",scene:this.context.scene,enableDebug:this.context.enableChatCoreDebug},this.context.createChatCoreOverrideConfig));u(m),v((()=>{var e,t=new O({storeSet:this.storeSet,reporter:this.reporter,eventCallback:this.context.eventCallback,lifeCycleService:this.lifeCycleService,chatActionLockService:this.chatActionLockService});return Y({chatCore:m,useMessagesStore:o,useWaitingStore:i,useSuggestionsStore:s,useSectionIdStore:c,reporter:this.reporter,eventCallback:null!==(e=this.context.eventCallback)&&void 0!==e?e:{},configs:this.context.configs,securityStrategyContext:t,lifeCycleService:this.lifeCycleService})})())}recordConversationParams(e){var{requestData:t}=e,{useOnboardingStore:r,useMessagesStore:n,useSectionIdStore:a,useSuggestionsStore:o}=this.storeSet,{partialUpdateOnboardingData:i}=r.getState(),{addMessages:s}=n.getState(),{setLatestSectionId:l}=a.getState(),{lastSectionId:c,messageList:d,prologue:u,onboardingSuggestions:v}=t;l(null!=c?c:"");var m=(0,ee.T)({historyMessageList:null!=d?d:[],ignoreMessageConfigList:this.context.configs.ignoreMessageConfigList,reporter:this.reporter});if(m){s(m,{clearFirst:!0});var{idAndSuggestions:g}=R(m);o.getState().updateSuggestionsBatch(g)}i(u,v)}setInitStatus(e){var{setInitStatus:t}=this.storeSet.useGlobalInitStore.getState();t(e)}getIsSkipInit(){var e,t=(null===(e=this.storeSet)||void 0===e?void 0:e.useGlobalInitStore.getState().initStatus)==="initSuccess",r="full-site"===this.context.extendDataLifecycle;return t&&r}constructor(e){var t=this;this.latestRequestIndex=0,this.nextContext=null,this.requestAborted=!1,this.eventCenter=(0,T.Z)(),this.updateContext=e=>{this.nextContext=(0,l._)({},this.context,e)},this.immediatelyUpdateContext=e=>{this.context=(0,l._)({},this.context,e)},this.init=(0,I._)(function*(){if("initSuccess"===t.storeSet.useGlobalInitStore.getState().initStatus)return;t.lifeCycleService.app.onBeforeInitial();var e=yield t.processInit();if(!!e)t.reporter.successEvent({eventName:eU.q.Init}),t.lifeCycleService.app.onAfterInitial({ctx:{messageListFromService:e}}),ea(t.context.scene,t)}),this.refreshMessageList=(0,I._)(function*(){t.lifeCycleService.app.onBeforeRefreshMessageList(),yield(0,es.yE)({storeSet:t.storeSet,lifeCycleService:t.lifeCycleService,reporter:t.reporter}),t.nextContext&&(t.context=t.nextContext);try{!(yield t.processInit())&&t.lifeCycleService.app.onRefreshMessageListError({ctx:{error:Error("request data is empty")}})}catch(e){t.lifeCycleService.app.onRefreshMessageListError({ctx:{error:e}})}finally{t.lifeCycleService.app.onAfterRefreshMessageList()}}),this.destroy=e=>{var t,r;if(!this.getIsSkipInit()||!!(null==e?void 0:e.disableSkip))null===(t=this.lifeCycleService)||void 0===t||t.app.onBeforeDestroy(),this.abortRequest(),null===(r=this.storeSet)||void 0===r||r.useMessageIndexStore.getState().setScrollViewFarFromBottom(!1),en(this.context.scene),(0,eF.vf)(),this.destroyPlugins(),this.clearInitSideEffect(),this.loadMoreDispose()},this.destroyFullSite=()=>{this.destroy({disableSkip:!0})},this.abortRequest=()=>{this.requestAborted=!0},this.registerUploadPlugin=()=>{var e,{chatCore:t}=this.storeSet.useGlobalInitStore.getState();if(!(null===(e=this.context.userInfo)||void 0===e?void 0:e.id)||!t){console.error("UserId is Empty or Chat Core not Ready");return}var r="upload-plugin";if(!t.checkPluginIsRegistered(r))t.registerPlugin(r,this.context.configs.uploadPlugin,{userId:this.context.userInfo.id,appId:0})},this.recordUserAndBotInfo=e=>{var{requestData:t}=e,{useSenderInfoStore:r,useOnboardingStore:n}=this.storeSet,{userInfoMap:a,botInfoMap:o}=t,{setUserInfoMap:i,setBotInfoMap:s,updateUserInfo:l}=r.getState(),{recordBotInfo:c}=n.getState();if(o){s(o);var d=Object.values(o).at(0);c({name:null==d?void 0:d.nickname,avatar:null==d?void 0:d.url})}if(a){i(a);return}this.context.userInfo&&(i({["".concat(this.context.userInfo.id)]:this.context.userInfo}),l(this.context.userInfo))},this.context=e,this.initServices(),this.assertInitialized(),this.locateToUnreadMessage(),this.init()}}var rp={showFunctionCallDetail:!0,ignoreMessageConfigList:[],groupUserMessage:!1,uploadPlugin:h,isShowFunctionCallBox:!0},rf=e=>{var{spaceId:t,botId:r,userInfo:n,presetBot:a,requestToInit:o,scene:i,eventCallback:s,reporter:l,configs:c,createChatCoreOverrideConfig:d,enableChatCoreDebug:v,enableChatActionLock:m,extendDataLifecycle:g,pluginRegistryList:p,enableTwoWayLoad:f,enableMarkRead:h}=e,_=(0,k.Z)({},rp,c),x=(0,u.useRef)({enableTwoWayLoad:null!=f&&f,enableMarkRead:null!=h&&h});x.current={enableTwoWayLoad:null!=f&&f,enableMarkRead:null!=h&&h};var y=(0,u.useRef)(null);if(!y.current){var b="full-site"===g,S=eo(i);b&&S?(y.current=S,ea(i,S)):y.current=new rg({spaceId:t,botId:r,userInfo:n,presetBot:a,requestToInit:o,scene:i,eventCallback:s,reporter:l,configs:_,createChatCoreOverrideConfig:d,enableChatCoreDebug:v,enableChatActionLock:m,loadMoreFlagRef:x,extendDataLifecycle:g,pluginRegistryList:p})}return y.current.updateContext({requestToInit:o,userInfo:n,createChatCoreOverrideConfig:d}),y.current.immediatelyUpdateContext({userInfo:n,createChatCoreOverrideConfig:d}),{initControllerRef:y,configs:_}},rh=e=>{var{userInfo:t,storeSet:r}=e;(0,u.useEffect)(()=>{if(!!t){var{useSenderInfoStore:e}=r,{updateUserInfo:n,setUserInfoMap:a,userInfoMap:o}=e.getState();n(t),a((0,k.Z)([],o,{[t.id]:t}))}},[t,r])},r_=r("821886"),rx=r("947039"),ry=(0,u.forwardRef)((e,t)=>{var r,{botId:n,scene:a,userInfo:o,children:i,enableMarkRead:s,enableDragUpload:c,enableTwoWayLoad:m,showUserExtendedInfo:g,enableImageAutoSize:p,imageAutoSizeContainerWidth:f,enablePasteUpload:h,isInputReadonly:_,enableSelectOnboarding:x,uikitChatInputButtonStatus:y,onboardingSuggestionsShowMode:k,eventCallback:I,showBackground:T,stopRespondOverrideWaiting:M}=e;rb(e),(0,E.x)("render ChatAreaProvider");var{initControllerRef:A,configs:N}=rf(e),{destroyFullSite:L,storeSet:Z,reporter:G,init:P,lifeCycleService:B,eventCenter:R,loadMoreClient:D,chatActionLockService:F,refreshMessageList:U}=A.current,O=(0,r_.t)(null===(r=A.current.storeSet)||void 0===r?void 0:r.useMessagesStore);return A.current.loadMoreEnvTools.waitMessagesLengthChangeLayoutEffect=O,(0,u.useImperativeHandle)(t,()=>({resetStateFullSite:L,updateSenderInfo:null==Z?void 0:Z.useSenderInfoStore.getState().updateBotInfoByImmer,updateWaitingSenderId:null==Z?void 0:Z.useSenderInfoStore.getState().updateWaitingSenderId,refreshMessageList:U})),rh({userInfo:o,storeSet:Z}),(0,u.useEffect)(()=>()=>{var e;null===(e=A.current)||void 0===e||e.destroy()},[]),(0,d.jsx)(rx._.Provider,{value:{refreshMessageList:U,reporter:G,botId:n,scene:a,eventCallback:I,configs:N,manualInit:P,lifeCycleService:B,eventCenter:R},children:(0,d.jsx)(S.z.Provider,{value:(0,l._)({},Z),children:(0,d.jsx)(C.Fi.Provider,{value:{enableMarkRead:s,enableTwoWayLoad:m,showUserExtendedInfo:g,enableImageAutoSize:p,imageAutoSizeContainerWidth:f,enablePasteUpload:h,isInputReadonly:_,enableDragUpload:c,enableSelectOnboarding:x,uikitChatInputButtonStatus:y,onboardingSuggestionsShowMode:k,showBackground:T,stopRespondOverrideWaiting:M},children:(0,d.jsx)(v.B3.Provider,{value:{readLocalStoreValue:(0,v.yq)(G),writeLocalStoreValue:(0,v.X3)(G)},children:(0,d.jsx)(b,{children:(0,d.jsx)(j.iF,{loadMoreClient:D,children:(0,d.jsx)(w.N.Provider,{value:F,children:i})})})})})})})});ry.displayName="ChatAreaProviderNew";var rb=e=>{if(!e.botId&&!e.presetBot)throw Error("Either botId or presetBot must to be provided!")},rS=(0,u.forwardRef)((e,t)=>(0,d.jsx)(ry,(0,c._)((0,l._)({},e),{ref:t})));rS.displayName="ChatAreaProvider";var rC=r("525395"),rj=r("191579"),rw=r("339468"),rE=()=>{var e=(0,x.Q)(),{useOnboardingStore:t,useSectionIdStore:r}=(0,x.N)();if(!(0,rw.e)(e))throw Error("chatAreaContext is not valid");var{refreshMessageList:n,reporter:a}=e,{partialUpdateOnboardingData:o,updatePrologue:i,immerUpdateSuggestionById:s,immerAddSuggestion:l,immerDeleteSuggestionById:c,setSuggestionList:d,recordBotInfo:u}=t.getState();return{partialUpdateOnboardingData:o,updatePrologue:i,immerAddSuggestion:l,immerUpdateSuggestionById:s,immerDeleteSuggestionById:c,getOnboardingContent:()=>{var{prologue:e,suggestions:r}=t.getState();return{prologue:e,suggestions:r}},refreshMessageList:n,setOnboardingSuggestionList:d,reporter:a,recordBotInfo:u,getLatestSectionId:()=>r.getState().latestSectionId}};r("501802");var rk=r("237464"),rI=r("233708"),rT=r("2930"),rM=r("664319"),rA=()=>{var{useSenderInfoStore:e}=(0,x.N)();return e((0,rM.N)(e=>({getBotInfo:e.getBotInfo,updateBotInfo:e.updateBotInfo,setSenderInfoBatch:e.setSenderInfoBatch})))},rN=e=>{var{useSenderInfoStore:t}=(0,x.N)(),{botInfo:r}=t((0,rM.N)(t=>({botInfo:e?t.getBotInfo(e):void 0})));return r},rL=r("103525");r("405281"),r("693062");var rZ=r("702005"),rG=r("914157"),rP=r("808431"),rB=()=>{var e,{useMessagesStore:t,useSelectionStore:r,useOnboardingStore:n}=(0,x.N)(),{updateReplyIdList:a,onboardingIdList:o}=r(e=>({updateReplyIdList:e.updateReplyIdList,onboardingIdList:e.onboardingIdList})),{enableSelectOnboarding:i}=(0,rP.F)(),s=(0,rZ.k)(),l=(0,rG.S)(),c=n(e=>e.prologue),d=(0,el.v)();var u=(e=(0,I._)(function*(){s(),yield d()}),function(){return e.apply(this,arguments)});return{clearHistory:u,selectAll:e=>{var{maxLength:r,direction:n}=null!=e?e:{},s=t.getState().messageGroupList.filter(e=>e.selectable).map(e=>e.groupId).filter(e=>!!e);if((0,tm.Z)(r)||!n){a(s);return}a(("backward"===n?s:s.reverse()).slice(0,r));var d=o.at(0);i&&l({selectedId:null!=d?d:null,onboarding:{prologue:c}})},unselectAll:s,getMessageList:()=>(0,eK.a)(t.getState().messages)}},rR=r("971764"),rD=r("295252"),rF=r("794322");r("863462");var rU=r("721823"),rO=r("726256"),rz=()=>{var{useMessagesStore:e,useSectionIdStore:t}=(0,x.N)(),r=t(e=>e.latestSectionId);return{latestSectionMessageLength:e((0,rM.N)(e=>e.messages.filter(e=>e.section_id===r).length))}},rW=r("383603");r("847782"),r("923781");var rH=()=>{var e=(0,rL.D)();return t=>e.getRegisteredPlugin(t)};r("601219"),r("417964");var rK=e=>{var{usePluginStore:t}=(0,x.N)(),r=t((0,rM.N)(t=>t.pluginInstanceList.find(t=>t.pluginName===e)));return r?r.publicMethods:null},rV=e=>e.pluginMode===eO.Readonly,rq=e=>{var{usePluginStore:t}=(0,x.N)(),{pluginName:r}=(0,rU.f)(),n=t((0,rM.N)(t=>t.pluginInstanceList.find(t=>t.pluginName===(null!=e?e:r))));if(!n)throw Error("cannot find target plugin");if(eH(n))return n;throw Error("cannot find target writeable plugin, please confirm ".concat(e," is writeable mode plugin"))},rY=e=>{var{usePluginStore:t}=(0,x.N)(),{pluginName:r}=(0,rU.f)(),n=t((0,rM.N)(t=>t.pluginInstanceList.find(t=>t.pluginName===(null!=e?e:r))));if(!n)throw Error("cannot find target plugin");if(rV(n))return n;throw Error("cannot find target readonly plugin, please confirm ".concat(e," is readonly mode plugin"))};class rX{constructor(e){this.pluginInstance=e}}class rJ extends rX{}class rQ extends rJ{}class r$ extends rJ{}class r0 extends rJ{}class r1{_injectChatAreaContext(e){if(this.chatAreaPluginContext){console.error("Repeat inject chat area context");return}this.chatAreaPluginContext=e}constructor(e,t){this.pluginMode=eO.Readonly,this.pluginBizContext=e,this.chatAreaPluginContext=t}}class r2 extends r1{constructor(e,t){super(e,t)}}class r5 extends r1{constructor(e,t){super(e,t)}}var r4=((i={}).Demo="demo",i.MemoryComponents="memoryComponents",i.StoreHistoryMessageList="storeHistoryMessageList",i.ShareMessageComponents="shareMessageComponents",i.KnowledgeComponents="knowledgeComponents",i.Resume="resume",i.MessageGrab="messageGrab",i.ChatBackground="ChatBackground",i.Tts="Tts",i.DebugCommon="DebugCommon",i.ChatPlayground="ChatPlayground",i.PremiumPlans="PremiumPlans",i.TemplateMessageSelector="TemplateMessageSelector",i.WebsdkChatCozeSdkPlugin="WebsdkChatCozeSdkPlugin",i.WebsdkDefaultChatPlugin="WebsdkDefaultChatPlugin",i.WebsdkChatCommonPlugin="WebsdkChatCommonPlugin",i.UIBuilderChatUIPlugin="UIBuilderChatUIPlugin",i.UIBuilderEventcallbackPlugin="UIBuilderEventcallbackPlugin",i.AgentTemplateSubScene="AgentTemplateSubScene",i.Reasoning="Reasoning",i.CozeDev="CozeDev",i);class r7 extends rJ{}var r8=(e,t)=>{var r=t(e);return r9(r,e),r},r6=(e,t)=>{var r=t(e);return r9(r,e),r},r9=(e,t)=>{var{appLifeCycleService:r,messageLifeCycleService:n,commandLifeCycleService:a,renderLifeCycleService:o}=e,i=(0,e7._)(e,["appLifeCycleService","messageLifeCycleService","commandLifeCycleService","renderLifeCycleService"]);(0,A.j_)(i),r&&(r.pluginInstance=t),n&&(n.pluginInstance=t),a&&(a.pluginInstance=t),o&&(o.pluginInstance=t)},r3=e=>e,ne=()=>{var{useSectionIdStore:e}=(0,x.N)();return e(e=>e.latestSectionId)},nt=r("799536"),nr=r("482298"),nn=r("828470"),na=r("473393"),no=e=>{var{useChatActionStore:t}=(0,x.N)();return t(t=>na.wN.deleteMessageGroup(e,t.answerActionLockMap,t.globalActionLock))},ni=r("270561")},721823:function(e,t,r){r.d(t,{S:function(){return l},f:function(){return s}});var n=r(473980),a=r(151064),o=r(455069),i=(0,o.createContext)({}),s=()=>(0,o.useContext)(i),l=e=>{var{children:t}=e,r=(0,n._)(e,["children"]);return(0,a.jsx)(i.Provider,{value:r,children:t})}},726256:function(e,t,r){r.d(t,{M:()=>i});var n=r("664319"),a=r("589872"),o=()=>{var{usePluginStore:e}=(0,a.N)();return e((0,n.N)(e=>e.pluginInstanceList))},i=e=>o().map(t=>{var r;return{pluginName:t.pluginName,Component:null===(r=t.customComponents)||void 0===r?void 0:r[e]}}).filter(e=>!!e.Component)},863462:function(e,t,r){r.d(t,{q:()=>n.q,a:()=>a.aH});var n=r("433506"),a=r("765377")},433506:function(e,t,r){r.d(t,{Z:function(){return i},q:function(){return o}});var n,a,o=((n={}).ClearHistory="chat_area_clear_history",n.ClearContext="chat_area_clear_context",n.BreakMessage="chat_area_break_message",n.BreakMessageAccurately="chat_area_break_message_accurately",n.Init="chat_area_init",n.GetMessageList="chat_area_get_message_list",n.SendMessage="chat_area_send_message",n.DeleteMessage="chat_area_delete_message",n.TriggerEvent="chat_area_trigger_event",n.UpdateSenderInfoByHistoryFail="chat_area_update_sender_info_by_history_fail",n.NonHistoricalMessageWithoutLocalId="non_historical_message_without_local_id",n.MarkMessageRead="chat_area_mark_message_read",n.LoadSilently="chat_area_load_silently",n.LoadEagerly="chat_area_load_eagerly",n.LoadMoreConsumeMessageIndexChange="chat_area_load_more_consume_message_index_change",n.LoadMoreResetIndexStoreOnClearHistory="chat_area_load_more_reset_index_store_on_clear_history",n.LoadMoreOnMessageUnexpectedIndexChange="chat_area_load_more_on_message_unexpected_index_change",n.GetHooksMessageHeaderConfig="get_hooks_message_header_config",n.MessageUnitRoleHooksError="message_unit_role_hooks_error",n);var i=((a={}).OldChatMessageImageStructNotImageObjectError="chat_area_old_chat_message_image_struct_not_image_object_error",a.LoadByScrollPrevFail="chat_area_load_by_scroll_prev_fail",a.LoadByScrollNextFail="chat_area_load_by_scroll_next_fail",a.MarkMessageReadFail="chat_area_mark_message_read_fail",a.LoadSilentlyFail="chat_area_load_silently_fail",a.LoadEagerlyFail="chat_area_load_eagerly_fail",a.RefreshMessageIndexFail="chat_area_refresh_message_index_fail",a.LoadInitialGetUnreadMessageIdFail="chat_area_load_initial_get_unread_message_fail",a.LoadInitialGetReadMessageFail="chat_area_load_initial_get_read_message_fail",a.LoadMoreResetIndexStoreOnClearHistoryFail="chat_area_load_more_reset_index_store_on_clear_history_fail",a)},473393:function(e,t,r){r.d(t,{O1:function(){return d},dA:function(){return c},mU:function(){return l},v6:function(){return s},vj:function(){return i},wN:function(){return u}});var n=r(808549),a=r(120454),o=()=>({deleteMessageGroup:null,regenerate:null}),i={sendMessageToACK:e=>{var{timestamp:t,param:r}=e;return e=>{var n;e.sendMessageToACK={timestamp:t,messageUniqKey:null!==(n=null==r?void 0:r.messageUniqKey)&&void 0!==n?n:null}}},clearContext:e=>{var{timestamp:t}=e;return e=>{e.clearContext={timestamp:t}}},clearHistory:e=>{var{timestamp:t}=e;return e=>{e.clearHistory={timestamp:t}}}},s={sendMessageToACK:e=>{e.sendMessageToACK=null},clearContext:e=>{e.clearContext=null},clearHistory:e=>{e.clearHistory=null}},l={sendMessageToACK:e=>!!e.sendMessageToACK||!!e.clearHistory||!!e.clearContext,clearContext:e=>!!e.sendMessageToACK||!!e.clearHistory||!!e.clearContext,clearHistory:e=>!!e.sendMessageToACK||!!e.clearHistory||!!e.clearContext},c={deleteMessageGroup:(e,t)=>{var{timestamp:r}=t;return t=>{var i=t[e];if(!i){t[e]=(0,a._)((0,n._)({},o()),{deleteMessageGroup:{timestamp:r}});return}i.deleteMessageGroup={timestamp:r}}},regenerate:(e,t)=>{var{timestamp:r}=t;return t=>{var i=t[e];if(!i){t[e]=(0,a._)((0,n._)({},o()),{regenerate:{timestamp:r}});return}i.regenerate={timestamp:r}}}},d={deleteMessageGroup:e=>t=>{var r=t[e];if(!!r)r.deleteMessageGroup=null},regenerate:e=>t=>{var r=t[e];if(!!r)r.regenerate=null}},u={deleteMessageGroup:(e,t,r)=>{var n,a;return!!(null===(n=t[e])||void 0===n?void 0:n.deleteMessageGroup)||(null===(a=r.sendMessageToACK)||void 0===a?void 0:a.messageUniqKey)===e},regenerate:(e,t,r)=>{var n;return!!(null===(n=t[e])||void 0===n?void 0:n.regenerate)||l.sendMessageToACK(r)}}},368289:function(e,t,r){r.d(t,{c:function(){return a},f:function(){return o}});var n=r(473393);class a{constructor({updateAnswerActionLockMapByImmer:e,updateGlobalActionLockByImmer:t,getAnswerActionLockMap:r,getGlobalActionLock:a,readEnvValues:o,reporter:i}){this.getIsEnableLock=()=>this.readEnvValues().enableChatActionLock,this.globalAction={lock:(e,t)=>{var r=Date.now();if(!this.getIsEnableLock())return r;var a=n.vj[e]({timestamp:r,param:t});return this.updateGlobalActionLockByImmer(a),this.reporter.info({message:"[chat-area] global action lock: ".concat(e)}),r},unlock:e=>{var t=n.v6[e];this.updateGlobalActionLockByImmer(t),this.reporter.info({message:"[chat-area] global action unlock, action: ".concat(e)})},getIsLock:e=>{var t=this.getGlobalActionLock();return n.mU[e](t)}},this.answerAction={lock:(e,t)=>{var r=Date.now();if(!this.getIsEnableLock())return r;var a=n.dA[t](e,{timestamp:r});return this.updateAnswerActionLockMapByImmer(a),this.reporter.info({message:"[chat-area] answer action lock, action: ".concat(t," groupId: ").concat(e)}),r},unlock:(e,t)=>{var r=n.O1[t](e);this.updateAnswerActionLockMapByImmer(r),this.reporter.info({message:"[chat-area] answer action unlock, action: ".concat(t," groupId: ").concat(e)})},getIsLock:(e,t)=>{var r=this.getGlobalActionLock(),a=this.getAnswerActionLockMap();return n.wN[t](e,a,r)}},this.updateAnswerActionLockMapByImmer=e,this.updateGlobalActionLockByImmer=t,this.getAnswerActionLockMap=r,this.getGlobalActionLock=a,this.readEnvValues=o,this.reporter=i}}var o=new a({updateGlobalActionLockByImmer:()=>({}),getGlobalActionLock:()=>({sendMessageToACK:null,clearContext:null,clearHistory:null}),updateAnswerActionLockMapByImmer:()=>({}),getAnswerActionLockMap:()=>({}),readEnvValues:()=>({enableChatActionLock:!1}),reporter:{info:()=>({})}})},525080:function(e,t,r){r.d(t,{T:function(){return o}});var n=r(772418),a=r(953126),o=e=>{var{historyMessageList:t,ignoreMessageConfigList:r,reporter:o}=e;return t.map(e=>(0,a.F)(e,o)).filter(e=>!(0,n.E)(r,e)).map(a.w)}},898449:function(e,t,r){r.d(t,{F:function(){return i}});var n=r(335740),a=r(644775),o=r(433506),i=(e,t)=>{if(!(0,a.hI)(e))return e;var r,i,s=(0,n.Z)(e);return!s.content_obj&&(s.content_obj={image_list:[{key:"",image_ori:{url:"",width:0,height:0},image_thumb:{url:"",width:0,height:0}}]}),!("image_list"in s.content_obj)&&(s.content_obj={image_list:s.content_obj}),(null===(r=s.content_obj.image_list)||void 0===r?void 0:r.length)&&(null===(i=s.content_obj.image_list)||void 0===i||i.forEach(e=>{!e.image_ori&&(e.image_ori={url:"",width:0,height:0},t.errorEvent({eventName:o.Z.OldChatMessageImageStructNotImageObjectError,error:Error("image_ori not exist")})),!e.image_thumb&&(e.image_thumb={url:"",width:0,height:0},t.errorEvent({eventName:o.Z.OldChatMessageImageStructNotImageObjectError,error:Error("image_thumb not exist")})),!e.image_thumb.url&&(e.image_thumb.url=e.image_ori.url)})),s.content=JSON.stringify(s.content_obj),s}},953126:function(e,t,r){r.d(t,{F:function(){return m},w:function(){return g}});var n=r(808549),a=r(120454),o=r(871873),i=r(380835),s=r(4154),l=r(85685),c=r(644775),d=r(519698),u=r(874498),v=r(898449),m=(e,t)=>{var r={role:"assistant",type:"answer",content:"",reasoning_content:"",content_type:i.zc.Text,message_id:"",reply_id:"",section_id:"",extra_info:{local_message_id:"",input_tokens:"",output_tokens:"",token:"",plugin_status:"",time_cost:"",workflow_tokens:"",bot_state:"",plugin_request:"",tool_name:"",plugin:""},broken_pos:9999999,sender_id:"",mention_list:[],content_obj:(0,s.d)(e.content),is_finish:!0},a=(0,n._)({},e,void 0===e.source?{}:{source:(0,c.Rr)(e.source)}),u=(0,o.Z)(r,a);_(u);var m=(0,v.F)(u,t);return(0,c.J7)(m)?(0,l.H)(m,{percent:100,status:d.K.Success}):m},g=e=>(0,a._)((0,n._)({},e),{_fromHistory:!0}),p=e=>{if(e.source===i.mZ.Notice&&!!u._O.includes(e.reply_id))e.reply_id="notice_".concat(e.message_id)},f=e=>{if(e.source===i.mZ.AsyncResult)e.reply_id="async-result_".concat(e.message_id)},h=e=>{if(e.source===i.mZ.TaskManualTrigger||"task_manual_trigger"===e.type)e.reply_id="task_manual_trigger_".concat(e.message_id)},_=e=>{p(e),f(e),h(e)}},675665:function(e,t,r){r.d(t,{Nt:function(){return v},Pb:function(){return d},R$:function(){return m},R2:function(){return g},VB:function(){return u},nI:function(){return c}});var n,a,o=r(64605),i=r(193616),s=r(4154),l=e=>(0,o.Z)(e)&&"code"in e&&"msg"in e,c=e=>(0,i.Z)(e)&&"ext"in e&&"flatten"in e,d=e=>{if(!!e){var t=(0,s.d)(e);if(l(t))return t}};var u=((n={})[n.SuggestError=0x29b95613]="SuggestError",n[n.OutTokenLimit=0x29db35c7]="OutTokenLimit",n[n.MENTION_BOT_NOT_FOUND=0x29b95615]="MENTION_BOT_NOT_FOUND",n);var v=((a={})[a.COZE_TOKEN_INSUFFICIENT=0x29d8ebe4]="COZE_TOKEN_INSUFFICIENT",a[a.COZE_TOKEN_INSUFFICIENT_WORKFLOW=0x29d91ee0]="COZE_TOKEN_INSUFFICIENT_WORKFLOW",a[a.COZE_TOKEN_INSUFFICIENT_VOICE=0x2acbbc0f]="COZE_TOKEN_INSUFFICIENT_VOICE",a[a.COZE_PRO_TOKEN_INSUFFICIENT_VOICE=0x2acbbc10]="COZE_PRO_TOKEN_INSUFFICIENT_VOICE",a),m=e=>!0,g=0x29b9561b},772418:function(e,t,r){r.d(t,{E:function(){return d}});var n=r(380835),a=r(933953),o=r(4154),i=r(191579),s={[i.w.Knowledge]:(e,t)=>"knowledge"===t.type||(0,a.w9)(e)||(0,a.OD)(e),[i.w.LongTermMemory]:a.Wf,[i.w.JumpToAgent]:a.Az,[i.w.Backwards]:a._d},l={[n.kc.BACK_WORD]:!0,[n.kc.GENERATE_ANSWER_FINISH]:!0,[n.kc.JUMP_TO]:!0,[n.kc.LONG_TERM_MEMORY]:!0,[n.kc.STREAM_PLUGIN_FINISH]:!0,[n.kc.KNOWLEDGE_RECALL]:!0,[n.kc.INTERRUPT]:!0,[n.kc.HOOK_CALL]:!0},c=e=>(0,a.ur)(e)&&l[e.msg_type]||(0,a.w9)(e),d=(e,t)=>{var r=(0,o.d)(t.content);if(!(0,a.lt)(t))return!1;if(!c(r))return!0;for(var n of e)if(s[n](r,t))return!0;return!1}},829495:function(e,t,r){r.d(t,{B:()=>E,Y:()=>w});var n=r("825955"),a=r("765377"),o=r("102400"),i=r("863462"),s=r("874498");class l{constructor(e){this.envTools=e}}class c{constructor(e){this.envTools=e}}class d{constructor(e){this.envTools=e}}var u=r("231595"),v=r("433506");class m extends d{runAsync(){var e=this;return(0,n._)(function*(){var{data:t,envTools:r}=e,{messageIndexHelper:n}=r;return n.recordFirstLoadAndRefreshIndex(t),new Promise(e=>r.waitMessagesLengthChangeLayoutEffect(()=>{new g(r,{readIndex:t.read_message_index,messages:t.messageList||[]}).run(),e()}))})()}constructor(e,t){super(e),this.data=t}}class g extends c{run(){var{enableMarkRead:e}=this.envTools.readEnvValues();if(!!e)this.locateUnreadMessage(this.data)}locateUnreadMessage(e){var{readIndex:t}=e;if(!!(0,u._)(t)&&!!e.messages.length){var{reporter:r}=this.envTools,n=this.getNextReadMessageDom({readIndex:t,messages:e.messages});if(!n){r.errorEvent({eventName:v.Z.LoadInitialGetUnreadMessageIdFail,error:Error("fail to get targetMessageBox of: ".concat(t))});return}n.scrollIntoView()}}getNextReadMessageDom(e){var{messages:t,readIndex:r}=e,{reporter:n}=this.envTools,o=(0,a.Qb)(r).next(),i=[];for(var s of t||[]){var l=s.message_index;if(l===o&&(i[0]=s.message_id),l===r&&(i[1]=s.message_id),i[0]&&i[1])break}if(!i[0]&&!i[1])return n.errorEvent({eventName:v.Z.LoadInitialGetReadMessageFail,error:Error("read_message_index: ".concat(r))}),null;for(var c of i){var d='[data-message-id="'.concat(c,'"]'),u=document.querySelector(d);if(u)return u}return null}constructor(e,t){super(e),this.data=t}}class p extends c{constructor(...e){super(...e),this.run=()=>{var{alignMessageIndexes:e,resetHasMore:t,resetCursors:r,reporter:n,resetLoadLockAndError:a}=this.envTools;try{t(),r(),e(),a(),n.event({eventName:i.q.LoadMoreResetIndexStoreOnClearHistory})}catch(e){n.errorEvent({eventName:v.Z.LoadMoreResetIndexStoreOnClearHistoryFail,error:e})}}}}var f=r("808549"),h=r("380835");class _ extends l{load(){var e=this;return(0,n._)(function*(){var{loadLockErrorHelper:t,readEnvValues:r,reporter:n,insertMessages:a,messageIndexHelper:o}=e.envTools,s="load-silently",{loadLock:l}=t.onLoadStart(s),{nextCursor:c}=r();try{n.event({eventName:i.q.LoadSilently,meta:{cursor:c}});var d=h.bG.Next,u=yield e.envTools.loadRequest({cursor:c,loadDirection:d});if(!t.verifyLock(s,l))return;yield e.envTools.waitChatProcessFinish(),a(u,{toLatest:!0}),o.updateIndexAndHasMoreAfterLoad(u,{refreshIndexByRequest:!0,loadDirection:d}),t.onLoadSuccess(s)}catch(e){t.onLoadError(s),n.errorEvent((0,f._)({eventName:v.Z.LoadSilentlyFail},(0,i.a)(e)))}})()}constructor(...e){super(...e),this.action="load-silently"}}class x extends l{load(){var e=this;return(0,n._)(function*(){var{messageIndexHelper:t}=e.envTools;t.updateEndIndexForMore(e.endIndex),yield Promise.resolve()})()}constructor(e,t){super(e),this.endIndex=t,this.action=null}}class y extends l{load(){var e=this;return(0,n._)(function*(){var{readEnvValues:t}=e.envTools,{enableTwoWayLoad:r,nextHasMore:n,scrollViewFarFromBottom:a}=t(),o=r&&n||e.unconditionally;if(!!a||!!o)o?yield e.executeLoad():e.onlyScrollToBottom()})()}onlyScrollToBottom(){var e,{getScrollController:t}=this.envTools;null===(e=t())||void 0===e||e.scrollToPercentage(1)}executeLoad(){var e=this;return(0,n._)(function*(){var{messageIndexHelper:t,reporter:r,loadLockErrorHelper:n,loadRequest:a,insertMessages:o}=e.envTools,{action:l}=e;if(!n.checkLoadLockUsing(l)){var{loadLock:c}=n.onLoadStart(l);e.onlyScrollToBottom();try{var d=h.bG.Prev,u=yield a({cursor:s.qj,loadDirection:d,count:s.j4});if(!n.verifyLock(l,c))return;var m=t.getShouldAbortLoadedMessage(u.message_list),{abort:g}=m;o(u,{toLatest:!0,clearFirst:g}),t.updateIndexAndHasMoreAfterLoad(u,{refreshIndexByRequest:!1,loadDirection:d}),n.onLoadSuccess(l),r.event({eventName:v.q.LoadEagerly,meta:Object(m)})}catch(e){r.errorEvent((0,f._)({eventName:v.Z.LoadSilentlyFail},(0,i.a)(e))),n.onLoadError(l)}}})()}constructor(e,t=!1){super(e),this.unconditionally=t,this.action="load-eagerly"}}var b=r("297158"),S=r("784237");class C extends l{load(){var e=this;return(0,n._)(function*(){if(!!e.getShouldLoad()){var{readEnvValues:t,loadRequest:r,insertMessages:n,messageIndexHelper:a,loadLockErrorHelper:o}=e.envTools,{cursor:s}=t(),{action:l}=e,c=h.bG.Prev,{loadLock:d}=o.onLoadStart(l);try{var u=yield r({cursor:s,loadDirection:c});if(!o.verifyLock(l,d))return;n(u,{toLatest:!1}),a.updateIndexAndHasMoreAfterLoad(u,{refreshIndexByRequest:!0,loadDirection:c}),o.onLoadSuccess(l)}catch(e){b.E7.errorEvent((0,f._)({eventName:v.Z.LoadByScrollPrevFail},(0,i.a)(e))),o.onLoadError(l)}}})()}getShouldLoad(){var{readEnvValues:e,loadLockErrorHelper:t}=this.envTools,{prevHasMore:r}=e();return!!r&&!t.checkLoadLockUsing(this.action)}constructor(...e){super(...e),this.action="load-prev"}}class j extends l{load(){var e=this;return(0,n._)(function*(){if(!!e.getShouldLoad()){var{readEnvValues:t,loadRequest:r,insertMessages:n,messageIndexHelper:a,loadLockErrorHelper:o}=e.envTools,{nextCursor:s}=t(),{action:l}=e,{loadLock:c}=o.onLoadStart(l);try{var d=yield r({cursor:s,loadDirection:h.bG.Next});if(!o.verifyLock(l,c))return;a.updateIndexAndHasMoreAfterLoad(d,{refreshIndexByRequest:!0,loadDirection:h.bG.Next}),n(d,{toLatest:!0}),o.onLoadSuccess(l,{remainLock:!0}),e.simulateOverflowAnchor(c)}catch(e){b.E7.errorEvent((0,f._)({eventName:v.Z.LoadByScrollNextFail},(0,i.a)(e))),o.onLoadError(l)}}})()}getShouldLoad(){var{readEnvValues:e,loadLockErrorHelper:t}=this.envTools,{nextHasMore:r}=e();return!!r&&!t.checkLoadLockUsing(this.action)}simulateOverflowAnchor(e){var t=()=>this.envTools.loadLockErrorHelper.verifyLock(this.action,e),r=this.envTools.getScrollController();if(!r){(0,a.Cj)("cannot get scrollController in simulateOverflowAnchor");return}var{getOriginScrollInfo:n}=r,o=n();this.envTools.waitMessagesLengthChangeLayoutEffect(()=>{if(!!t()){var e=n(),a=o.scrollHeight-e.scrollHeight+S.Wv;r.scrollTo(()=>a);setTimeout(()=>{if(!!t()){var{action:e}=this;this.envTools.updateLockAndErrorByImmer(t=>{t.loadLock[e]=null})}},S.w0)}})}constructor(...e){super(...e),this.action="load-next"}}class w{injectChatCoreIntoEnv(e){this.loadEnv.injectChatCore(e||(0,o.X)())}injectGetScrollController(e){this.loadEnv.injectGetScrollController(e)}clearMessageIndexStore(){this.loadEnv.clearMessageIndexStore()}constructor(e){var t,r,o=this;this.loadEnv=e,this.handleInitialLoadIndex=(t=(0,n._)(function*(e){yield new m(o.loadEnv,e).runAsync()}),function(e){return t.apply(this,arguments)}),this.locateToUnreadMessage=e=>new g(this.loadEnv,e).run(),this.loadEagerly=()=>new y(this.loadEnv).load(),this.loadEagerlyUnconditionally=()=>new y(this.loadEnv,!0).load(),this.loadByScrollPrev=()=>new C(this.loadEnv).load(),this.loadByScrollNext=()=>new j(this.loadEnv).load(),this.loadSilently=()=>new _(this.loadEnv).load(),this.loadPassively=e=>new x(this.loadEnv,e).load(),this.onClearHistory=()=>new p(this.loadEnv).run(),this.onMessageIndexChange=(r=(0,n._)(function*(e){var{ignoreIndexAndHistoryMessages:t}=o.loadEnv.readEnvValues();if(!t){yield o.loadEnv.waitChatCoreReady();var{maxLoadIndex:r}=o.loadEnv.readEnvValues(),n=(0,a._X)(e).greaterThan(r);!n&&o.loadEnv.reporter.event({eventName:i.q.LoadMoreOnMessageUnexpectedIndexChange,meta:{maxLoadIndex:r,newEndIsGreater:n,endIndex:e}}),yield o.loadEnv.waitChatProcessFinish();var l=(0,a.Me)(e,r,s.O6);o.loadEnv.reporter.event({eventName:i.q.LoadMoreConsumeMessageIndexChange,meta:{shouldBeSilent:l,endIndex:e}}),l?yield o.loadSilently():yield o.loadPassively(e)}}),function(e){return r.apply(this,arguments)})}}var E={handleInitialLoadIndex:()=>Promise.resolve(),onClearHistory:()=>void 0,loadEagerly:()=>Promise.resolve(),loadEagerlyUnconditionally:()=>Promise.resolve(),injectChatCoreIntoEnv:()=>void 0,injectGetScrollController:()=>void 0,loadByScrollPrev:()=>Promise.resolve(),loadByScrollNext:()=>Promise.resolve(),loadPassively:()=>Promise.resolve(),loadSilently:()=>Promise.resolve(),onMessageIndexChange:()=>Promise.resolve(),clearMessageIndexStore:()=>void 0}},707804:function(e,t,r){r.d(t,{P:()=>g});var n=r("825955"),a=r("765377"),o=r("102400"),i=r("808549"),s=r("380835"),l=r("231595"),c=r("433506"),d=r("874498");class u{updateIndexAndHasMoreAfterLoad(e,t){var{refreshIndexByRequest:r,loadDirection:o}=t,i=this;return(0,n._)(function*(){var{updateHasMore:t,updateCursor:n,updateIndex:s,readEnvValues:l}=i.envTools;(0,a.Rm)(s,{readIndex:e.read_message_index});var c=i.getHasMoreByDirection(e,o);(0,a.Rm)(t,c);var d=i.getCursorByDirection(e,o);(0,a.Rm)(n,d);var{enableMarkRead:u}=l();r&&u&&(yield i.refreshIndexByRequest(null))})()}getHasMoreByDirection(e,t){var{hasmore:r,next_has_more:n}=e,a={prevHasMore:r,nextHasMore:n};return r&&t===s.bG.Next&&delete a.prevHasMore,n&&t===s.bG.Prev&&delete a.nextHasMore,a}getCursorByDirection(e,t){return t===s.bG.Next?{nextCursor:e.next_cursor}:{cursor:e.cursor}}refreshIndexByRequest(e){var t=this;return(0,n._)(function*(){var{requestMessageIndex:r,reporter:n,updateIndex:o}=t.envTools;try{var s=yield r(e);o({readIndex:s.read_message_index,endIndex:s.end_message_index})}catch(e){n.errorEvent((0,i._)({eventName:c.Z.LoadSilentlyFail},(0,a.aH)(e)))}})()}getShouldAbortLoadedMessage(e){var{maxLoadIndex:t}=this.envTools.readEnvValues(),{min:r,max:n}=(0,l.Q)(e),o="start ".concat(r,", end ").concat(n);if("0"===t||!r||!n)return{maxLoadIndex:t,abort:!0,indexInfo:o};if((0,a._X)(r).lesserThan(t))return{maxLoadIndex:t,abort:!1,indexInfo:o};var i=(0,a.Me)(t,r,d.h$);return{maxLoadIndex:t,abort:!i,indexInfo:o}}constructor(e){var t,r=this;this.envTools=e,this.recordFirstLoadAndRefreshIndex=(t=(0,n._)(function*(e){var t,n,o,{updateCursor:i,updateHasMore:s,updateIndex:l,readEnvValues:c}=r.envTools;if(l({readIndex:null!==(t=null==e?void 0:e.read_message_index)&&void 0!==t?t:"0"}),s({prevHasMore:null!==(n=null==e?void 0:e.hasMore)&&void 0!==n&&n,nextHasMore:null!==(o=null==e?void 0:e.next_has_more)&&void 0!==o&&o}),(0,a.Rm)(i,{cursor:null==e?void 0:e.cursor,nextCursor:null==e?void 0:e.next_cursor}),!!c().enableMarkRead&&!c().ignoreIndexAndHistoryMessages)yield r.refreshIndexByRequest(e.conversationId)}),function(e){return t.apply(this,arguments)}),this.updateEndIndexForMore=e=>{var{updateHasMore:t,readEnvValues:r,updateIndex:n}=this.envTools,{maxLoadIndex:o,endIndex:i}=r();if(!(e===i||(0,a._X)(o).greaterThan(e)))t({nextHasMore:!0}),n({endIndex:e})}}}var v=r("144552");class m{getCurrentLoadLock(e){var{readEnvValues:t}=this.envTools,{loadLock:r}=t();return r[e]}checkLoadLockUsing(e){return null!==this.getCurrentLoadLock(e)||this.getHigherPriorityAction(e).some(e=>null!==this.getCurrentLoadLock(e))}onLoadStart(e){var t=Date.now(),{updateLockAndErrorByImmer:r}=this.envTools;return r(r=>{var{loadLock:n,loadError:a}=r;n[e]=t,r.loadError=a.filter(t=>t!==e),this.getCoveredAction(e).forEach(e=>{n[e]=null,r.loadError=a.filter(t=>t!==e)})}),{loadLock:t}}getHigherPriorityAction(e){return"load-next"===e?["load-eagerly"]:[]}getCoveredAction(e){return"load-eagerly"===e?["load-next"]:[]}verifyLock(e,t){return t===this.envTools.readEnvValues().loadLock[e]}onLoadSuccess(e,t){var{updateLockAndErrorByImmer:r}=this.envTools;r(r=>{var{loadLock:n,loadError:a}=r;!(null==t?void 0:t.remainLock)&&(n[e]=null),r.loadError=a.filter(t=>t!==e)})}onLoadError(e){var{updateLockAndErrorByImmer:t}=this.envTools;t(t=>{var{loadLock:r,loadError:n}=t;r[e]=null,(0,v.N)(n,e)})}constructor(e){this.envTools=e}}class g{waitChatProcessFinish(){var e=this;return(0,n._)(function*(){if(!!e.readEnvValues().isProcessingChat)return new Promise(t=>{var{dispose:r}=e.listenProcessChatStateChange(e=>{!e&&(r(),t())})})})()}waitChatCoreReady(){if((0,o.p)(this.chatCore))return this.chatCoreDeferred}constructor({loadRequest:e,readEnvValues:t,updateIndex:r,insertMessages:n,updateHasMore:i,updateCursor:s,reporter:l,updateLockAndErrorByImmer:c,requestMessageIndex:d,waitMessagesLengthChangeLayoutEffect:v,listenProcessChatStateChange:g,alignMessageIndexes:p,resetCursors:f,resetHasMore:h,resetLoadLockAndError:_,clearMessageIndexStore:x}){this.loadLockErrorHelper=new m(this),this.messageIndexHelper=new u(this),this.chatCoreDeferred=new a.BH,this.injectGetScrollController=e=>{this.getScrollController=e},this.injectChatCore=e=>{this.chatCore=e,this.chatCoreDeferred.resolve()},this.getScrollController=()=>null,this.chatCore=(0,o.X)(),this.insertMessages=n,this.updateIndex=r,this.updateHasMore=i,this.updateCursor=s,this.readEnvValues=t,this.loadRequest=e,this.requestMessageIndex=d,this.reporter=l,this.resetHasMore=h,this.resetCursors=f,this.alignMessageIndexes=p,this.updateLockAndErrorByImmer=c,this.resetLoadLockAndError=_,this.waitMessagesLengthChangeLayoutEffect=v,this.listenProcessChatStateChange=g,this.clearMessageIndexStore=x}}},940089:function(e,t,r){r.d(t,{E:function(){return i}});var n=r(380835),a=r(664115),o=r(519698);class i{sendTextMessage(e){var{methods:t}=this.context,{inputPayload:r,from:n}=e;return t.sendTextMessage(r,n)}sendFileMessage(e){var{storeSets:{useBatchFileUploadStore:t},methods:{sendNormalizedMessage:r}}=this.context,{inputPayload:n,from:i}=e,s=t.getState().getFileDataList();if(s.some(e=>(null==e?void 0:e.fileType)!==o.T.File))throw Error("invalid send single common file message ".concat(s));return r({payload:(0,a.HD)(s,n.mentionList)},i)}sendImageMessage(e){var{storeSets:{useBatchFileUploadStore:t},methods:{sendNormalizedMessage:r}}=this.context,{inputPayload:n,from:i}=e,s=t.getState().getFileDataList();if(s.some(e=>e.fileType!==o.T.Image))throw Error("invalid send single common file message ".concat(s));var l=s.filter(e=>e.fileType===o.T.Image);return r({payload:(0,a.Ru)(l,n.mentionList)},i)}sendMultimodalMessage(e){var{storeSets:{useBatchFileUploadStore:t},methods:{sendMultimodalMessage:r}}=this.context,{inputPayload:o,from:i}=e;return r({payload:{mixList:[...(0,a.Po)(t.getState().getFileDataList()),{type:n.zc.Text,text:o.text}],mention_list:o.mentionList},audioFile:o.audioFile},i)}constructor(e){this.context=e}}},231595:function(e,t,r){r.d(t,{Q:function(){return i},_:function(){return a}});var n=r(765377),a=e=>void 0!==e&&"0"!==e&&/^\d+$/.test(e),o=e=>a(e.message_index),i=e=>{var t=e.filter(o),r=t.length!==e.length,a=t.map(e=>e.message_index),i=(0,n.X9)(...a);return{withNoIndexed:r,min:null==i?void 0:i.min,max:null==i?void 0:i.max}}},519698:function(e,t,r){r.d(t,{K:function(){return o},T:function(){return i}});var n,a,o=((n={})[n.Init=0]="Init",n[n.Uploading=1]="Uploading",n[n.Success=2]="Success",n[n.Canceled=3]="Canceled",n[n.Error=4]="Error",n);var i=((a={}).File="file",a.Image="image",a)},818584:function(e,t,r){r.d(t,{oQ:function(){return v},zr:function(){return l}});var n,a=r(716894),o=r(479910),i=r(61111),s=r(933953);var l=((n={}).Formal="formal",n.Suggestion="suggestion",n),c=(e,t)=>t.find(t=>t.id===e.message_id),d=(e,t)=>t.findIndex(t=>t.index===e),u=e=>({index:e.index,type:e.type,id:e.message_id,streamPlugin:e.extra_info.stream_plugin_running?{streamUuid:e.extra_info.stream_plugin_running}:null}),v=e=>(0,a.F)()((0,o.mW)((0,o.XR)((e,t)=>({sending:null,waiting:null,responding:null,startSending:t=>e({sending:t},!1,"startSending"),clearSending:()=>e({sending:null},!1,"clearSending"),getIsOnlyWaitingSuggestions:()=>{var{waiting:e}=t();return(null==e?void 0:e.phase)==="suggestion"},startWaiting:t=>{var r;return e({waiting:{replyId:t.message_id,questionLocalMessageId:null===(r=t.extra_info)||void 0===r?void 0:r.local_message_id,phase:"formal"}},!1,"setWaitingId")},updateWaiting:r=>{var n,{reply_id:a}=r;if((null===(n=t().waiting)||void 0===n?void 0:n.replyId)===a)(0,s.DV)(r)&&e((0,i.Uy)(e=>{if(!e.waiting)throw Error("is not in waiting");e.waiting.phase="suggestion"}),!1,"updateWaiting")},updateResponding:t=>{e((0,i.Uy)(e=>{g(e,t)}),!1,"updateResponding")},updateRespondingByImmer:t=>{e((0,i.Uy)(e=>t(e)),!1,"updateRespondingByImmer")},clearUnsettledByReplyId:t=>{e((0,i.Uy)(e=>{var r,n;(null===(r=e.waiting)||void 0===r?void 0:r.replyId)===t&&(e.waiting=null),(null===(n=e.responding)||void 0===n?void 0:n.replyId)===t&&(e.responding=null)}),!1,"clearAllUnsettledByReplyId")},clearAllUnsettledUnconditionally:()=>{e((0,i.Uy)(e=>{e.waiting=null,e.responding=null,e.sending=null}),!1,"clearAllUnsettledUnconditionally")},clearWaitingStore:()=>{e({sending:null,waiting:null,responding:null})},getIsSending:()=>!!t().sending,getIsWaiting:e=>{var r;return(null===(r=t().waiting)||void 0===r?void 0:r.phase)===e},getIsResponding:()=>!!t().responding})),{name:"botStudio.ChatAreaWaiting.".concat(e),enabled:!1})),m=e=>"answer"===e.type&&e.is_finish,g=(e,t)=>{var{responding:r}=e,n=(0,s.RR)(t);if(!r){if(n||"tool_response"===t.type)return;e.responding={replyId:t.reply_id,response:[u(t)]};return}if(r.replyId!==t.reply_id){console.error("updateRespondingInImmer not match reply id, income: ".concat(t.reply_id,", record: ").concat(null==r?void 0:r.replyId));return}if(n){e.responding=null;return}if("answer"===t.type&&!c(t,r.response)&&r.response.push(u(t)),m(t)){var a=c(t,r.response);if(!a)return;var o=r.response.indexOf(a);o>=0&&r.response.splice(o,1)}if("tool_response"===t.type){p({responding:r,message:t});return}if("function_call"===t.type){r.response.push(u(t));return}},p=e=>{var{responding:t,message:r}=e;f({responding:t,message:r})},f=e=>{var{responding:t,message:r}=e,n=r.index;if("number"!=typeof n){console.error("unexpected empty index of ".concat(r.type," ").concat(r.index));return}var a=n-1,o=d(a,t.response);if(o<0){console.error("updateRespondingInImmer: cannot find related function call , expect index ".concat(a));return}t.response.splice(o,1)}},144552:function(e,t,r){r.d(t,{N:function(){return a},p:function(){return n}});var n=(e,t,r)=>{var n=Math.max(t-r,0),a=Math.min(t+r,e.length);return e.slice(n,a)},a=(e,t)=>{if(!e.includes(t))e.push(t)}},482298:function(e,t,r){r.d(t,{l:function(){return a}});var n=r(380835),a=e=>{var{message:t,bizTheme:r,onParseReceiveMessageBoxTheme:a}=e,o="follow_up"===t.type||t.content_type===n.zc.Card,i=t.content_type===n.zc.Image,s=null==a?void 0:a({message:t});return s?s:i?"border":o?"none":"home"===r?"whiteness":"grey"}},506917:function(e,t,r){r.d(t,{V:function(){return a}});var n,a=((n={}).RESEND_MESSAGE="resendMessage",n.SEND_TEXT_MESSAGE="sendTextMessage",n.UPDATE_CARD_STATUS="updateCardStatus",n)},625592:function(e,t,r){r.d(t,{A:function(){return n}});var n=e=>0},102400:function(e,t,r){r.d(t,{X:function(){return o},p:function(){return i}});var n=r(765377),a=Symbol("fake-chat-core"),o=()=>new Proxy({},{get(e,t){if(t===a)return!0;var r="This error is caused when calling: ".concat(String(t));return(0,n.Cj)("!!!chatCore not found, make sure to call chatArea hooks inside chatAreaProvider!!! ".concat(r)),()=>Object.create(null)}}),i=e=>e[a]},912947:function(e,t,r){r.d(t,{$d:function(){return s},W4:function(){return a},nA:function(){return o},r7:function(){return l},vf:function(){return d}});var n,a=new(r(732562)).Z;var o=((n={}).CANCEL_UPLOAD_FILE="CANCEL_UPLOAD_FILE",n),i={},s=e=>{var{localMessageId:t,uploader:r}=e;i[t]=r},l=e=>{var t;if(!!e)null===(t=i[e])||void 0===t||t.cancel(),delete i[e]},c=()=>{Object.keys(i).forEach(e=>l(e))},d=()=>{a.removeAllListeners(),c()}},620215:function(e,t,r){r.d(t,{Y4:function(){return u},u:function(){return d}});var n=r(808549),a=r(120454),o=r(380835),i=r(933953),s=r(4154),l=r(625592),c=r(598215),d=e=>null==e?void 0:e.time_cost,u=e=>{var t=e.map((e,t)=>{var r=v(e);return r?{role:r,llmOutput:e,callId:e.extra_info.call_id,apiIndexMark:r===c.Q.TOOL?t-1:void 0,time:d(e.extra_info)}:null}).filter(Boolean);return e.reduceRight((e,t,r)=>(f(t,e,r),e),t).reverse()},v=e=>{var{type:t,content:r}=e;if("knowledge"===t)return c.Q.DATA_SET;if("function_call"===t)return c.Q.TOOL;if("verbose"===t){var n=(0,s.d)(r);if(!(0,i.ur)(n))return(0,i.w9)(n)?c.Q.DATA_SET:void 0;var{msg_type:a}=n;return a===o.kc.HOOK_CALL?c.Q.HOOKS:a===o.kc.KNOWLEDGE_RECALL?c.Q.DATA_SET:a===o.kc.JUMP_TO||a===o.kc.BACK_WORD||a===o.kc.LONG_TERM_MEMORY?c.Q.VERBOSE:a===o.kc.GENERATE_ANSWER_FINISH||a===o.kc.STREAM_PLUGIN_FINISH||a===o.kc.INTERRUPT?void 0:void(0,l.A)(a)}},m=(e,t,r)=>e.find(e=>e.role===c.Q.TOOL&&(r?e.streamUuid===r:e.apiIndexMark===t)),g=(e,t)=>e.find(e=>e.role===c.Q.TOOL&&e.callId===t),p=(e,t)=>{var r,n,a=g(t,e.extra_info.call_id);if(!!a)a.apiResponse=e,a.isFinish=!0,a.time=(Number(null!==(r=a.time)&&void 0!==r?r:"0")+Number(null!==(n=d(e.extra_info))&&void 0!==n?n:"0")).toFixed(1)},f=(e,t,r)=>{if(function(e){return"tool_response"===e.type&&!!e.extra_info.call_id}(e)){p(e,t);return}if(function(e){var t;return"tool_response"===e.type&&!(h(t=e)||(0,i.f)(t))}(e)){var o,s,l=m(t,r);if(!l)return;l.apiResponse=e,l.isFinish=!0,l.time=(Number(null!==(o=l.time)&&void 0!==o?o:"0")+Number(null!==(s=d(e.extra_info))&&void 0!==s?s:"0")).toFixed(1);return}if(h(e)){var c=m(t,r);if(!c)return;c.streamUuid=e.extra_info.stream_plugin_running,c.apiResponse=e;return}if((0,i.f)(e)){var u,v,g=(0,i.Qq)(e.content);if(!g)return;var{dataObj:f}=g;if(!f)return;var{tool_output_content:_,uuid:x}=f,y=m(t,r,x);if(!y)return;y.isFinish=!0,y.apiResponse=(0,a._)((0,n._)({},e),{content:_}),y.time=(Number(null!==(u=y.time)&&void 0!==u?u:"0")+Number(null!==(v=d(e.extra_info))&&void 0!==v?v:"0")).toFixed(1)}};function h(e){return"tool_response"===e.type&&!!e.extra_info.stream_plugin_running}},598215:function(e,t,r){r.d(t,{Q:function(){return a}});var n,a=((n={}).DATA_SET="dataSet",n.VERBOSE="verbose",n.TOOL="tool",n.HOOKS="hooks",n)},731865:function(e,t,r){r.d(t,{h:function(){return n}});function n(e){return e?"new-conversation-".concat(e):""}},918744:function(e,t,r){r.d(t,{b:function(){return n}});var n=e=>{var{fileCount:t,fileLimit:r,existingFileCount:n}=e;return t>r-n}},339468:function(e,t,r){r.d(t,{e:function(){return n}});var n=e=>Object.keys(e).map(t=>e[t]).reduce((e,t)=>e&&null!==t,!0)},224237:function(e,t,r){r.d(t,{x:function(){return n}});var n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]}},707187:function(e,t,r){r.d(t,{w:function(){return n}});var n=e=>e.map(e=>Object.keys(e.memberSet).map(t=>{var r=e.memberSet[t];return Array.isArray(r)?r:r?[r]:[]}).flat()).flat()},187792:function(e,t,r){r.d(t,{q:function(){return o}});var n=r(644775),a=r(707187),o=(e,t)=>(0,a.w)([e]).map(e=>(0,n.$)(t,e)).filter(e=>!!e)},815454:function(e,t,r){r.d(t,{T:function(){return n}});var n=r(765377).j_},761882:function(e,t,r){r.d(t,{A3:function(){return p},Xn:function(){return m},ge:function(){return g},zG:function(){return f}});var n,a=r(825955),o=r(808549),i=r(473980),s=r(615655),l=r(765377);r(933953);var c=r(263111);r(644775);var d=r(912947),u=r(863462),v=r(815454),m=(e,t)=>{if(!!t)return e.find(e=>e.groupId===t)},g=(e,t)=>{if(!!t)return e.find(e=>e.memberSet.userMessageId===t)},p=(e,t)=>(0,s.Z)(e,t);var f=(n=(0,a._)(function*(e,t){var{storeSet:r,reporter:n,eventCallback:a,lifeCycleService:s,chatActionLockService:m}=t;if(!m.answerAction.getIsLock(e,"deleteMessageGroup")){var{useMessagesStore:g,useMessageMetaStore:p,useSuggestionsStore:f,useGlobalInitStore:h}=r,_=h.getState().getChatCore(),{getMessageGroupById:x,findMessage:y,isLastMessageGroup:b}=g.getState(),{clearSuggestions:S}=f.getState(),{getMetaByMessage:C}=p.getState(),j=x(e);if(!j){(0,l.Cj)("message group not found, id: ".concat(e));return}m.answerAction.lock(e,"deleteMessageGroup");var{memberSet:{userMessageId:w,llmAnswerMessageIdList:E,functionCallMessageIdList:k,followUpMessageIdList:I}}=j,T=(0,i._)(j.memberSet,["userMessageId","llmAnswerMessageIdList","functionCallMessageIdList","followUpMessageIdList"]);(0,v.T)(T);var M=w?y(w):void 0,A=w?C(w):void 0,N=b(e),{deleteMessageByIdList:L,deleteMessageById:Z}=g.getState();try{yield s.message.onBeforeDeleteMessage({ctx:{messageGroup:j}}),M&&d.W4.emit(d.nA.CANCEL_UPLOAD_FILE,M.extra_info.local_message_id);var G,P=w||E.at(0);if(!P)throw Error("failed to find message to delete ".concat(P));yield Promise.all([_.deleteMessage({message_id:P}),(null==A?void 0:A.isGroupLastMessage)&&(0,c.yE)(t)]),w&&Z(w),L(k),L(E),L(I),N&&S(),null==a||null===(G=a.onDeleteMessage)||void 0===G||G.call(a,{messageGroup:j}),yield s.message.onAfterDeleteMessage({ctx:{messageGroup:j}}),n.successEvent({eventName:u.q.DeleteMessage})}catch(e){yield s.message.onDeleteMessageError({messageGroup:j}),n.errorEvent((0,o._)({eventName:u.q.DeleteMessage},(0,u.a)(e)))}finally{m.answerAction.unlock(e,"deleteMessageGroup")}}}),function(e,t){return n.apply(this,arguments)})},644775:function(e,t,r){r.d(t,{$:()=>g,vk:()=>M,Hw:()=>v,lF:()=>c,Fl:()=>S,Rr:()=>k,J7:()=>h,xB:()=>y,tx:()=>j,kY:()=>I,Tj:()=>x,E2:()=>w,XW:()=>p,Bc:()=>m,hI:()=>_,iC:()=>Z,jV:()=>E,xR:()=>u,cC:()=>d,zH:()=>N,pZ:()=>f,eg:()=>T,mJ:()=>A});var n=r("380835"),a=r("765377"),o=r("336205"),i=r("674343"),s=["function_call","verbose","tool_response","knowledge"],l=e=>s.includes(e),c=e=>{if(e.message_id)return e.message_id;var t=e.extra_info.local_message_id;if(!t)throw Error("message without any id");return t},d=(e,t)=>{var r=g(e,t.message_id);return void 0!==r?r:g(e,t.extra_info.local_message_id)},u=(e,t)=>e.filter(e=>e.reply_id===t),v=(e,t)=>{var r=p(e,t.message_id);return r>=0?r:p(e,t.extra_info.local_message_id)},m=(e,t)=>e.message_id===t||e.extra_info.local_message_id===t,g=(e,t)=>{if(!!t)return e.find(e=>m(e,t))},p=(e,t)=>t?e.findIndex(e=>m(e,t)):-1,f=e=>(null==e?void 0:e.content_type)===n.zc.Text,h=e=>(null==e?void 0:e.content_type)===n.zc.File,_=e=>(null==e?void 0:e.content_type)===n.zc.Image,x=e=>(null==e?void 0:e.content_type)===n.zc.Card,y=e=>(null==e?void 0:e.content_type)===n.zc.Mix,b=["tool_response"],S=(e,t)=>{if(b.includes(e.type))return!1;var{showFunctionCallDetail:r=!0}=null!=t?t:{};return(!(!r&&l(e.type))||!!e.isFunctionCalling)&&!0},C=["content","type","role"],j=e=>void 0!==e&&C.every(t=>t in e),w=e=>"message_id: ".concat(e.message_id,", local message id: ").concat(e.extra_info.local_message_id),E=(e,t)=>{var r=!!t.length,n=!!e.trim();return(!r&&!n&&(0,a.Cj)("invalid send message case"),r)?"multimodal":"text"},k=e=>{if(!Object.values(n.mZ).includes(e))throw Error("unhandled message: ".concat(n.mZ));return e},I=e=>{var{type:t,source:r}=e;return"answer"===t&&(void 0===r||r===n.mZ.Chat)},T=e=>{var{type:t,source:r}=e;return"task_manual_trigger"===t||r===n.mZ.TaskManualTrigger},M=e=>{var{source:t}=e;return t===n.mZ.Notice},A=e=>{var{source:t}=e;return t===n.mZ.AsyncResult},N=(e,t)=>{var r,n,a=t[e];if(!a)throw Error("cannot find message of index: ".concat(e));if("answer"!==a.type)return!1;var o=x(a),i=(null===(n=t.filter(e=>"answer"===e.type||"user"===e.role))||void 0===n?void 0:null===(r=n.at(0))||void 0===r?void 0:r.message_id)!==a.message_id;return o&&i},L=()=>({VOICE_NOT_RECOGNIZE:o.o.t("chat_voice_input_toast_no_content_recognized"),TOKEN_INSUFFICIENT_VOICE:o.o.t("coze_free_credits_insufficient"),PRO_TOKEN_INSUFFICIENT_VOICE:o.o.t("coze_pro_payment_overdue")}),Z=e=>{if("LOCKED"!==e&&void 0!==e){var t=L();i.FN.error({content:t[e],showClose:!1})}}},85685:function(e,t,r){r.d(t,{H:()=>c});var n=r("808549"),a=r("120454"),o=r("335740"),i=r("628949"),s=r("380835"),l=e=>{var t,r,n,a=(0,o.Z)(e);if(!(null==a?void 0:null===(t=a.content_obj)||void 0===t?void 0:t.file_list)||!(null==a?void 0:null===(r=a.content_obj)||void 0===r?void 0:r.file_list.length))return a;for(var l of null==a?void 0:null===(n=a.content_obj)||void 0===n?void 0:n.file_list){var c=function(e){if(!e)return{v:a};var t,r,{file_name:n,file_type:o}=e,i=null!==(r=null===(t=s.Co.find(e=>e.fileType===o||e.accept.some(e=>n.endsWith(e))))||void 0===t?void 0:t.fileType)&&void 0!==r?r:s.Wz.DEFAULT_UNKNOWN;e.file_type=i}(l);if("object"===(0,i._)(c))return c.v}return a.content=JSON.stringify(a.content_obj),a},c=(e,t)=>{var{percent:r,status:i}=t,{content_obj:s}=l(e),c={file_list:s.file_list.map(e=>(0,a._)((0,n._)({},e),{upload_percent:r,upload_status:i}))};return(0,o.Z)((0,a._)((0,n._)({},e),{content_obj:c,content:JSON.stringify(c)}))}},912001:function(e,t,r){function n(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],e}r.d(t,{a:function(){return n}}),new WeakMap,Symbol("proxy-freeze-identifier")},4154:function(e,t,r){r.d(t,{R:function(){return a},d:function(){return n}});var n=e=>{if(!!e)try{return JSON.parse(e)}catch(e){return}},a=(e,t)=>{try{return{parseSuccess:!0,value:JSON.parse(e),useFallback:!1}}catch(e){if(null!==t)return{parseSuccess:!1,useFallback:!0,value:t};return{parseSuccess:!1,useFallback:!1,value:null}}}},263111:function(e,t,r){r.d(t,{yE:()=>h});var n,a,o,i,s,l=r("825955"),c=r("808549"),d=r("120454"),u=r("863462");var v=((n={}).NoWaiting="noWaiting",n.CatchError="catchError",n),m=r("549231"),g=r("187792");r("644775");var p=(a=(0,l._)(function*(e){var t,{finalAnswer:r,waiting:n,chatCore:a,reporter:o}=e;try{yield a.breakMessage({query_message_id:(null==n?void 0:n.replyId)||"",local_message_id:(null==n?void 0:n.questionLocalMessageId)||"",answer_message_id:r.message_id||"",broken_pos:(null===(t=r.content)||void 0===t?void 0:t.length)||0}),o.successEvent({eventName:u.q.BreakMessage})}catch(e){o.errorEvent((0,c._)({eventName:u.q.BreakMessage},(0,u.a)(e)))}}),function(e){return a.apply(this,arguments)});var f=(o=(0,l._)(function*(e){var{waiting:t,chatCore:r,reporter:n}=e;try{yield r.breakMessage({query_message_id:(null==t?void 0:t.replyId)||"",local_message_id:(null==t?void 0:t.questionLocalMessageId)||""}),n.successEvent({eventName:u.q.BreakMessageAccurately})}catch(e){n.errorEvent((0,c._)({eventName:u.q.BreakMessageAccurately},(0,u.a)(e)))}}),function(e){return o.apply(this,arguments)});var h=(i=(0,l._)(function*(e){var{storeSet:{useGlobalInitStore:t,useMessagesStore:r,useWaitingStore:n},reporter:a,lifeCycleService:o}=e;yield o.command.onBeforeStopResponding();var i=t.getState().getChatCore(),{waiting:s,clearAllUnsettledUnconditionally:l}=n.getState(),{updateMessage:u}=r.getState(),g=(0,m.K_)(r,null==s?void 0:s.replyId);if(!s){console.log("call stop, but not found waiting"),yield o.command.onStopRespondingError({ctx:{scene:v.NoWaiting}});return}l();try{g?(yield p({waiting:s,finalAnswer:g,chatCore:i,reporter:a}),u((0,d._)((0,c._)({},g),{is_finish:!0}))):yield f({waiting:s,chatCore:i,reporter:a})}catch(e){yield o.command.onStopRespondingError({ctx:{scene:v.CatchError}})}_(s.replyId,e)}),function(e){return i.apply(this,arguments)});var _=(s=(0,l._)(function*(e,t){var{eventCallback:{onAfterStopResponding:r}={},storeSet:{useMessagesStore:n},lifeCycleService:a}=t,o={brokenReplyId:e,brokenFlattenMessageGroup:x(e,n)};null==r||r(o),yield a.command.onAfterStopResponding({ctx:o})}),function(e,t){return s.apply(this,arguments)}),x=(e,t)=>{var{getMessageGroupById:r,messages:n}=t.getState(),a=r(e);return a?(0,g.q)(a,n):null}},664115:function(e,t,r){r.d(t,{Fw:function(){return C},HD:function(){return E},Po:function(){return j},Ru:function(){return k},Xd:function(){return w},Xq:function(){return x},cT:function(){return f},dn:function(){return y},lW:function(){return b},vE:function(){return S},zw:function(){return _}});var n=r(825955),a=r(808549),o=r(120454),i=r(537952),s=r(341665),l=r(552995),c=r(380835),d=r(765377),u=r(382534),v=r(519698),m=r(863462),g=r(536348),p=e=>{e.removeAllListeners("stream-progress"),e.removeAllListeners("complete"),e.removeAllListeners("error"),e.removeAllListeners("progress")};function f(e){var{file:t,fileType:r="image",userId:a,signal:o,onProgress:s,onUploaderReady:l,onUploadError:c,onGetTokenError:v,onSuccess:f}=e;return new Promise(e=>{var h,_,x=null,y=!0;null==o||o.addEventListener("abort",()=>{null==x||x.cancel(),y=!1,x&&p(x),e()});var b=(h=(0,n._)(function*(){try{var e=(yield u.nA.GetUploadAuthToken({scene:"bot_task"},{timeout:g.n_})).data;if(!e)throw Error("Invalid GetUploadAuthToken Response");return e}catch(e){null==v||v((0,m.a)(e).error)}}),function(){return h.apply(this,arguments)}),S=n=>{var{service_id:o,upload_host:d,auth:u,schema:v}=n;x=(0,i.o)({schema:v,useFileExtension:!0,userId:a,appId:0,imageHost:"https://".concat(d),imageConfig:{serviceId:o||""},objectConfig:{serviceId:o||""},imageFallbackHost:"",region:"cn-north-1",uploadTimeout:g.n_},!1),null==l||l(x),x.on("complete",t=>{null==f||f(t),e()}),x.on("error",e=>{null==c||c(e)}),x.on("progress",e=>{null==s||s(e)});var m=x.addFile({file:t,stsToken:{CurrentTime:(null==u?void 0:u.current_time)||"",ExpiredTime:(null==u?void 0:u.expired_time)||"",SessionToken:(null==u?void 0:u.session_token)||"",AccessKeyId:(null==u?void 0:u.access_key_id)||"",SecretAccessKey:(null==u?void 0:u.secret_access_key)||""},type:r});x.start(m)},C=()=>y;(_=(0,n._)(function*(){if(!C())return;var e=yield b();if(!!e&&!!C())try{S(e)}catch(e){(0,d.Cj)("upload error: ".concat(e instanceof Error?e.message:String(e)))}}),function(){return _.apply(this,arguments)})()})}var h=e=>{if("function"==typeof(null==e?void 0:e.webkitGetAsEntry)){var t;return!!(null===(t=e.webkitGetAsEntry())||void 0===t?void 0:t.isDirectory)}return!1},_=e=>{var t,r,n,a=null===(t=e.dataTransfer)||void 0===t?void 0:t.files,o=Array.from(null!==(n=null===(r=e.dataTransfer)||void 0===r?void 0:r.items)&&void 0!==n?n:[]);return Array.from(null!=a?a:[]).filter((e,t)=>!!e&&!h(o[t]))},x=e=>{var t,r,n=Array.from(null!==(r=null===(t=e.clipboardData)||void 0===t?void 0:t.items)&&void 0!==r?r:[]);return Array.from(n).map(e=>e.getAsFile()).filter((e,t)=>!!e&&!h(n[t]))},y=e=>c.Co.find(t=>{var r;return(null===(r=t.judge)||void 0===r?void 0:r.call(t,e))||t.accept.some(t=>e.name.endsWith(t))}),b=e=>e.size<=s.CN,S=e=>e.size>0,C=e=>{var t;return!!(null===(t=e.dataTransfer)||void 0===t?void 0:t.types.includes("Files"))},j=e=>e.map(e=>{var t,r,{uri:n}=e;if(!n)throw Error("failed to get file uri");if(e.fileType===v.T.File)return{type:c.zc.File,file:e.file,uri:n};var{meta:a}=e;return{type:c.zc.Image,file:e.file,uri:n,width:null!==(t=null==a?void 0:a.width)&&void 0!==t?t:0,height:null!==(r=null==a?void 0:a.height)&&void 0!==r?r:0}}),w=e=>{if(!!e&&e!==c.Wz.IMAGE)return l.$Y[e]},E=(e,t)=>{var r=e.map(e=>(0,o._)((0,a._)({},e),{fileTypeConfig:y(e.file)})).filter(e=>{var t;return!!(e&&e.uri&&(null===(t=e.fileTypeConfig)||void 0===t?void 0:t.fileType))});return{contentType:c.zc.File,contentObj:{file_list:r.map(e=>({file_key:e.uri,file_name:e.file.name,file_size:e.file.size,file_url:"",file_type:e.fileTypeConfig.fileType}))},mention_list:t}},k=(e,t)=>{var r=e.map(e=>(0,o._)((0,a._)({},e),{blobUrl:URL.createObjectURL(e.file),fileTypeConfig:y(e.file)})).filter(e=>!!(e.fileTypeConfig&&e.uri));return{contentType:c.zc.Image,contentObj:{image_list:r.map(e=>{var t,r,n,a,o,i,s,l;return{key:e.uri,image_thumb:{url:e.blobUrl,width:null!==(o=null===(t=e.meta)||void 0===t?void 0:t.width)&&void 0!==o?o:0,height:null!==(i=null===(r=e.meta)||void 0===r?void 0:r.height)&&void 0!==i?i:0},image_ori:{url:e.blobUrl,width:null!==(s=null===(n=e.meta)||void 0===n?void 0:n.width)&&void 0!==s?s:0,height:null!==(l=null===(a=e.meta)||void 0===a?void 0:a.height)&&void 0!==l?l:0}}})},mention_list:t}}},933953:function(e,t,r){r.d(t,{Az:function(){return h},DV:function(){return m},OD:function(){return u},Qq:function(){return y},RR:function(){return p},Wf:function(){return x},_d:function(){return _},bO:function(){return g},bs:function(){return v},f:function(){return f},hu:function(){return c},lt:function(){return i},ur:function(){return l},w9:function(){return d}});var n=r(64605),a=r(380835),o=r(4154),i=e=>"verbose"===e.type,s=(e,t)=>{if(!i(e))return!1;var{content:r}=e,n=(0,o.R)(r,null).value;return!!n&&n.msg_type===t},l=e=>(0,n.Z)(e)&&"msg_type"in e&&"data"in e;function c(e){return(0,n.Z)(e)}var d=e=>(0,n.Z)(e)&&"verbose_type"in e&&"chunks"in e&&"knowledge"===e.verbose_type,u=e=>l(e)&&e.msg_type===a.kc.KNOWLEDGE_RECALL,v=e=>{var t,r,n;return s(e,a.kc.INTERRUPT)&&(null===(n=e.required_action)||void 0===n?void 0:null===(r=n.submit_tool_outputs)||void 0===r?void 0:null===(t=r.tool_calls)||void 0===t?void 0:t.some(e=>"require_info"===e.type))},m=e=>{var t,r=y(e.content);return s(e,a.kc.GENERATE_ANSWER_FINISH)&&(null==r?void 0:null===(t=r.dataObj)||void 0===t?void 0:t.finish_reason)!==a.Y.INTERRUPT},g=e=>{var t,r,n;return null==e?void 0:null===(n=e.required_action)||void 0===n?void 0:null===(r=n.submit_tool_outputs)||void 0===r?void 0:null===(t=r.tool_calls)||void 0===t?void 0:t.some(e=>"reply_message"===e.type)},p=e=>s(e,a.kc.GENERATE_ANSWER_FINISH),f=e=>s(e,a.kc.STREAM_PLUGIN_FINISH),h=e=>l(e)&&e.msg_type===a.kc.JUMP_TO,_=e=>l(e)&&e.msg_type===a.kc.BACK_WORD,x=e=>l(e)&&e.msg_type===a.kc.LONG_TERM_MEMORY,y=e=>{var t=(0,o.R)(e,null).value;if(!t)return null;var{msg_type:r,data:n}=t;return n?{msg_type:r,data:"",dataObj:(0,o.R)(n,null).value}:{msg_type:r,data:"",dataObj:null}}},380835:function(e,t,r){r.d(t,{NX:()=>j,Co:()=>Z.Co,MS:()=>E,zc:()=>O.zc,Wz:()=>Z.Wz,Y:()=>O.Y,kc:()=>O.kc,hr:()=>Z.hr,mZ:()=>O.mZ,bG:()=>ef,MN:()=>N,Xo:()=>eI,xs:()=>ep,Md:()=>ek,ZP:()=>eT});var n,a,o,i,s,l,c,d,u,v,m=r("732562"),g=r("825955"),p=r("808549"),f=r("473980"),h=r("871873"),_=r("165882"),x=r("625222"),y=r("371066"),b=r("222363"),S=e=>(0,x.Z)(e,e=>null!=e&&""!==e),C=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,y.Z)(...t,(e,t)=>{if((0,b.Z)(e))return e.concat(t)})};var j=((n={}).SendMessage="sendMessage",n.ResumeMessage="resumeMessage",n.GetMessage="getMessage",n.ClearHistory="clearHistory",n.ClearMessageContext="clearMessageContext",n.DeleteMessage="deleteMessage",n.BreakMessage="breakMessage",n.ReportMessage="reportMessage",n.ChatASR="chatASR",n),w=r("902845");class E extends w.d7{constructor(e,t,r){var n;super(t,e,r.config,r.request,r),this.code=e,this.msg=t,this.name="ApiError",this.type="Api Response Error",this.raw=r.data,this.logId=null===(n=r.headers)||void 0===n?void 0:n["x-tt-logid"]}}var k=e=>{var{data:t={}}=e,{code:r,msg:n}=t;return 0!==r?Promise.reject(new E(String(r),n,e)):e},I=e=>{var t;return e.headers.set("x-requested-with","XMLHttpRequest"),(null===(t=e.method)||void 0===t?void 0:t.toLowerCase())==="post"&&!e.headers.get("content-type")&&(e.headers.set("content-type","application/json"),!e.data&&(e.data={})),e},T=()=>({hooks:{onBeforeRequest:[I],onAfterResponse:[k]},scenes:{[j.SendMessage]:{url:"/api/conversation/chat",method:"POST"},[j.ResumeMessage]:{url:"/api/conversation/resume_chat",method:"POST"},[j.GetMessage]:{url:"/api/conversation/get_message_list",method:"POST"},[j.ClearHistory]:{url:"/api/conversation/clear_message",method:"POST"},[j.ClearMessageContext]:{url:"/api/conversation/create_section",method:"POST"},[j.DeleteMessage]:{url:"/api/conversation/delete_message",method:"POST"},[j.BreakMessage]:{url:"/api/conversation/break_message",method:"POST"},[j.ReportMessage]:{url:"/api/conversation/message/report",method:"POST"},[j.ChatASR]:{url:"/api/audio/transcriptions",method:"POST"}}});class M{createRequest(){this.reportLogWithScope.info({message:"RequestManager is initialized",meta:(0,p._)({},this.mergedBaseOptions)});var{baseURL:e,timeout:t,headers:r}=this.mergedBaseOptions;this.request=_.Z.create({baseURL:e,timeout:t,headers:r}),this.useRequestInterceptor(),this.useResponseInterceptor()}appendRequestOptions(e){this.mergedBaseOptions=C(this.mergedBaseOptions,e)}useRequestInterceptor(){var e,t,r,n=this;var a=(e=(0,g._)(function*(e){var t=n.mergedBaseOptions,{hooks:r,scenes:a}=t,o=(0,f._)(t,["hooks","scenes"]);if(!r)return(0,h.Z)(e,o);var{onBeforeRequest:i=[]}=r;for(var s of i)e=yield s(e);return(0,h.Z)(e,o)}),function(t){return e.apply(this,arguments)}),o=this;var i=(t=(0,g._)(function*(e){var{scenes:t}=o.mergedBaseOptions;if(!t)return e;var{url:r}=e,n=Object.values(t).find(e=>e.url===r);if(!n)return e;var{hooks:a}=n,i=(0,f._)(n,["hooks"]);if(!a)return(0,h.Z)(e,i);var{onBeforeRequest:s=[]}=a;for(var l of s)e=yield l(e);return(0,h.Z)((0,p._)({},i),e)}),function(e){return t.apply(this,arguments)});this.request.interceptors.request.use((r=(0,g._)(function*(e){var t=yield a(e);return yield i(t)}),function(e){return r.apply(this,arguments)}))}useResponseInterceptor(){var e,t,r,n,a=this;var o=(e=(0,g._)(function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"onAfterResponse",r=e,{hooks:n}=a.mergedBaseOptions;if(!n)return e;for(var o of n[t]||[])r=yield o(e);return r}),function(t){return e.apply(this,arguments)}),i=this;var s=(t=(0,g._)(function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"onAfterResponse",{scenes:r}=i.mergedBaseOptions,n=e;if(!r)return e;var{url:a}=e.config,o=Object.values(r).find(e=>e.url===a);if(!o)return e;var{hooks:s}=o;if(!s)return e;for(var l of s[t]||[])n=yield l(e);return n}),function(e){return t.apply(this,arguments)});this.request.interceptors.response.use((r=(0,g._)(function*(e){var t=yield o(e);return yield s(t)}),function(e){return r.apply(this,arguments)}),(n=(0,g._)(function*(e){var t=yield o(e,"onErrorResponse");return yield s(t,"onErrorResponse")}),function(e){return n.apply(this,arguments)}))}getSceneConfig(e){var t=this.mergedBaseOptions,{hooks:r,scenes:n}=t,a=(0,f._)(t,["hooks","scenes"]);return(0,h.Z)(a,n[e])}constructor({options:e,reportLog:t}){this.mergedBaseOptions=C(T(),e),this.reportLog=t,this.reportLogWithScope=this.reportLog.createLoggerWith({scope:"RequestManager"}),this.createRequest()}}_.Z.create();var A=r("297158"),N=e=>{var{env:t,deployVersion:r}=e;return[r,t].join("-")},L=r("168607"),Z=r("686250"),G=(0,L.rY)(),P=e=>{var{env:t}=e;return{bid:"bot_studio_sdk",release:Z.AX,env:t,integrations:[(0,L.ax)(),(0,L.$7)()]}},B=r("788637");class R{static merge(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).reduce((e,t)=>(function(e,t){var{meta:r}=e,n=(0,f._)(e,["meta"]),{meta:a}=t,o=(0,f._)(t,["meta"]),i=(0,p._)({},r,a);return(0,p._)({},n,o,(0,B.Z)(i)?{}:{meta:i})})(e,t),{})}get(){return this.options}constructor(e){this.options=e}}var D={env:"production",deployVersion:"release"},F={namespace:"chat-core",meta:{}};class U{init(){if(console.log("debugger slardar instance init",this.hasSlardarInitd),!this.hasSlardarInitd){this.hasSlardarInitd=!0;var e=this.ctx.get();G.init(P({env:N({env:(null==e?void 0:e.env)||D.env,deployVersion:(null==e?void 0:e.deployVersion)||D.deployVersion})})),G.start()}}createLoggerWith(e){return new U(this.resolveCloneParams(e||{}))}resolveCloneParams(e){return R.merge(this.ctx.get(),e)}initReport(e){this.reportLogWithBaseInfo=A.E7.createReporterWithPreset(this.resolveCloneParams(e||{})),this.reportLogWithBaseInfo.init(G)}initLog(e){this.loggerWithBaseInfo=A.kg.createLoggerWith({ctx:this.resolveCloneParams(e||{})})}isNeedReport(e){var{logLevel:t}=this.ctx.get();return"disable"!==t&&("error"!==t||"error"===e)}info(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!!this.isNeedReport("info"))this.loggerWithBaseInfo.info(...t)}error(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!!this.isNeedReport("error"))this.loggerWithBaseInfo.error(...t)}slardarInfo(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.reportLogWithBaseInfo.info(...t)}slardarSuccess(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.reportLogWithBaseInfo.success(...t)}slardarError(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.reportLogWithBaseInfo.error(...t)}slardarEvent(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.reportLogWithBaseInfo.event(...t)}slardarSuccessEvent(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.reportLogWithBaseInfo.successEvent(...t)}slardarErrorEvent(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.reportLogWithBaseInfo.errorEvent(...t)}slardarTracer(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.reportLogWithBaseInfo.tracer(...t)}constructor(e){this.hasSlardarInitd=!1;var t=R.merge(e||{},F);this.ctx=new R(t),this.initLog(t),this.initReport(t)}}var O=r("873352");class z{add(e){this.preSendLocalMessageEventsMap.set(e.extra_info.local_message_id,e),this.reportLogWithScope.info({message:"-",meta:{buffer:this.preSendLocalMessageEventsMap}})}updateLocalMessageStatus(e,t){var r=this.preSendLocalMessageEventsMap.get(e);r&&(r.local_message_status=t,this.preSendLocalMessageEventsMap.set(e,r),this.reportLogWithScope.info({message:"-",meta:{buffer:this.preSendLocalMessageEventsMap,local_message_status:t}}))}getStashedLocalMessage(e){return this.preSendLocalMessageEventsMap.get(e)}on(e,t){this.preSendLocalMessageEvents.on(e,t)}once(e,t){this.preSendLocalMessageEvents.once(e,t)}emit(e,t){if(this.preSendLocalMessageEvents.emit(e,t),e===O.Yz.MESSAGE_SEND_SUCCESS){this.preSendLocalMessageEventsMap.delete(t.extra_info.local_message_id),this.reportLogWithScope.info({message:"-",meta:{buffer:this.preSendLocalMessageEventsMap}});return}if([O.Yz.MESSAGE_SEND_FAIL,O.Yz.MESSAGE_SEND_TIMEOUT].includes(e)){var{local_message_id:r}=t.ext;r&&this.preSendLocalMessageEventsMap.delete(r),this.reportLogWithScope.info({message:"-/",meta:{buffer:this.preSendLocalMessageEventsMap}});return}e===O.Yz.FILE_UPLOAD_STATUS_CHANGE&&this.preSendLocalMessageEventsMap.set(t.extra_info.local_message_id,t)}destroy(){this.preSendLocalMessageEvents.removeAllListeners(),this.preSendLocalMessageEventsMap.clear()}constructor(e){this.preSendLocalMessageEvents=new m.Z,this.preSendLocalMessageEventsMap=new Map,this.reportLog=e.reportLog,this.reportLogWithScope=this.reportLog.createLoggerWith({scope:"preSendLocalMessageEventsManager"}),this.preSendLocalMessageEventsMap=new Map}}var W=(e,t)=>{try{return{parseSuccess:!0,value:JSON.parse(e),useFallback:!1}}catch(e){if(null!==t)return{parseSuccess:!1,useFallback:!0,value:t};return{parseSuccess:!1,useFallback:!1,value:null}}};var H=((a={}).MESSAGE_FETCH_HISTORY_ERROR="message_fetch_history_error",a.MESSAGE_CLEAR_CONTEXT_ERROR="message_clear_context_error",a.MESSAGE_CLEAR_HISTORY_ERROR="message_clear_history_error",a.MESSAGE_DELETE_ERROR="message_delete_error",a.MESSAGE_INTERRUPT_ERROR="message_interrupt_error",a.MESSAGE_REPORT_ERROR="message_report_error",a.CHAT_ASR_ERROR="chat_asr_error",a);class K{getHistoryMessage(e){var t=this;return(0,g._)(function*(){try{var r=(yield t.request.post(t.requestManager.getSceneConfig(j.GetMessage).url,e)).data;return r.message_list=K.convertMessageList(r.message_list),r}catch(e){throw t.reportLogWithScope.slardarErrorEvent({eventName:H.MESSAGE_FETCH_HISTORY_ERROR,error:e}),e}})()}clearMessageContextUrl(e){var t=this;return(0,g._)(function*(){try{return(yield t.request.post(t.requestManager.getSceneConfig(j.ClearMessageContext).url,e)).data}catch(e){t.reportLogWithScope.slardarErrorEvent({eventName:H.MESSAGE_CLEAR_CONTEXT_ERROR,error:e})}})()}clearHistory(e){var t=this;return(0,g._)(function*(){try{return(yield t.request.post(t.requestManager.getSceneConfig(j.ClearHistory).url,e)).data}catch(e){t.reportLogWithScope.slardarErrorEvent({eventName:H.MESSAGE_CLEAR_HISTORY_ERROR,error:e})}})()}deleteMessage(e){var t=this;return(0,g._)(function*(){try{return(yield t.request.post(t.requestManager.getSceneConfig(j.DeleteMessage).url,e)).data}catch(e){t.reportLogWithScope.slardarErrorEvent({eventName:H.MESSAGE_DELETE_ERROR,error:e})}})()}breakMessage(e){var t=this;return(0,g._)(function*(){try{return(yield t.request.post(t.requestManager.getSceneConfig(j.BreakMessage).url,e)).data}catch(e){t.reportLogWithScope.slardarErrorEvent({eventName:H.MESSAGE_INTERRUPT_ERROR,error:e})}})()}reportMessage(e){var t=this;return(0,g._)(function*(){try{return(yield t.request.post(t.requestManager.getSceneConfig(j.ReportMessage).url,e)).data}catch(e){t.reportLogWithScope.slardarErrorEvent({eventName:H.MESSAGE_REPORT_ERROR,error:e})}})()}chatASR(e){var t=this;return(0,g._)(function*(){try{return(yield t.request.post(t.requestManager.getSceneConfig(j.ChatASR).url,e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){throw t.reportLogWithScope.slardarErrorEvent({eventName:H.CHAT_ASR_ERROR,error:e}),e}})()}constructor(e){var{reportLog:t,requestManager:r}=e;this.reportLog=t,this.requestManager=r,this.request=r.request,this.reportLogWithScope=this.reportLog.createLoggerWith({scope:"message"})}}K.convertMessageList=e=>(e.forEach(e=>{e.content_obj=e.content_type===O.zc.Text?void 0:W(e.content,null).value}),e);var V=r("120454"),q=r("801815"),Y=r("335740");class X extends Error{constructor(e,t){super(e),this.flatten=()=>{var{message:e,ext:t}=this;return(0,p._)({message:e},t)},this.name="chatCoreError",this.ext=t||{}}}class J{static create(e){return new J(e)}constructor(e){this.extra_info={local_message_id:"",input_tokens:"",output_tokens:"",token:"",plugin_status:"success",time_cost:"",workflow_tokens:"",bot_state:"",plugin_request:"",tool_name:"",plugin:""};var{bot_id:t,preset_bot:r,extra_info:{local_message_id:n},content_type:a,content:o,content_obj:i,role:s,type:l,message_status:c,message_id:d,reply_id:u,user:v,section_id:m,local_message_status:g,mention_list:p,file_upload_result:f}=e;this.bot_id=t,this.preset_bot=r,this.user=v,this.extra_info.local_message_id=n,this.content_type=a,this.content=o,this.content_obj=i,this.file_upload_result=void 0,this.role=s,this.type=l,this.message_status=c,this.message_id=d,this.reply_id=u,this.section_id=m,this.local_message_status=g||"unsent",this.mention_list=p,this.file_upload_result=f}}class Q{createTextMessage(e,t,r){var{payload:n}=e,a=J.create(this.assembleMessageCommonProps({content:n.text,content_obj:n.text,content_type:O.zc.Text,section_id:(null==r?void 0:r.section_id)||"",mention_list:e.payload.mention_list}));return t.add(a),(0,Y.Z)(a)}createImageMessage(e){var{payload:{file:t,mention_list:r},pluginUploadManager:n}=e.messageProps,{UploadPlugin:a,messageEventsManager:o,options:i,uploadPluginConstructorOptions:s}=e,l=J.create(this.assembleMessageCommonProps({content:JSON.stringify(this.assembleImageMessageContent(t)),content_obj:this.assembleImageMessageContent(t),content_type:O.zc.Image,section_id:(null==i?void 0:i.section_id)||"",mention_list:r}));o.add(l);var c=new a((0,p._)({file:t,type:"image"},s));return null==n||n(c),c.on("complete",e=>{this.updateImageMessageContent(l,e.uploadResult),this.updateMessageUploadResult(l,"success"),o.emit(O.Yz.FILE_UPLOAD_STATUS_CHANGE,l)}),c.on("error",()=>{this.updateMessageUploadResult(l,"fail")}),(0,Y.Z)(l)}createFileMessage(e){var{payload:{file:t,mention_list:r},pluginUploadManager:n}=e.messageProps,{UploadPlugin:a,messageEventsManager:o,options:i,uploadPluginConstructorOptions:s}=e,l=J.create(this.assembleMessageCommonProps({content:JSON.stringify(this.assembleFileMessageContent(t)),content_obj:this.assembleFileMessageContent(t),content_type:O.zc.File,section_id:(null==i?void 0:i.section_id)||"",mention_list:r}));o.add(l);var c=new a((0,p._)({file:t,type:"object"},s));return null==n||n(c),c.on("complete",e=>{var{uploadResult:t,type:r}=e;"success"===r&&(this.updateFileMessageContent(l,t),this.updateMessageUploadResult(l,"success"),o.emit(O.Yz.FILE_UPLOAD_STATUS_CHANGE,l))}),c.on("error",()=>{this.updateMessageUploadResult(l,"fail"),o.emit(O.Yz.FILE_UPLOAD_STATUS_CHANGE,l)}),(0,Y.Z)(l)}createTextAndFileMixMessage(e,t,r){var{payload:{mixList:n,mention_list:a}}=e,o=J.create(this.assembleMessageCommonProps({content:JSON.stringify(this.assembleTextAndFileMixMessageContent(n)),content_obj:this.assembleTextAndFileMixMessageContent(n),content_type:O.zc.Mix,section_id:(null==r?void 0:r.section_id)||"",mention_list:a}));return t.add(o),(0,Y.Z)(o)}createNormalizedMessage(e,t,r){var{payload:{contentObj:n,contentType:a,mention_list:o}}=e,i=J.create(this.assembleMessageCommonProps({content:JSON.stringify(n),content_obj:n,content_type:a,section_id:(null==r?void 0:r.section_id)||"",mention_list:o,file_upload_result:"success"}));return t.add(i),(0,Y.Z)(i)}assembleImageMessageContent(e){var t=URL.createObjectURL(e);return{image_list:[{key:"",image_thumb:{url:t,width:0,height:0},image_ori:{url:t,width:0,height:0},feedback:null}]}}updateImageMessageContent(e,t){var{Uri:r="",Url:n="",ImageWidth:a=0,ImageHeight:o=0}=t;e.content_obj.image_list[0]=(0,V._)((0,p._)({},e.content_obj.image_list[0]),{key:r,image_thumb:(0,V._)((0,p._)({},e.content_obj.image_list[0].image_thumb),{width:a,height:o,url:n}),image_ori:(0,V._)((0,p._)({},e.content_obj.image_list[0].image_ori),{width:a,height:o,url:n})}),e.content=JSON.stringify(e.content_obj)}updateFileMessageContent(e,t){var{Uri:r="",Url:n=""}=t;e.content_obj.file_list[0].file_key=r,e.content_obj.file_list[0].file_url=n,e.content=JSON.stringify(e.content_obj)}updateMessageUploadResult(e,t){return e.file_upload_result=t,e}assembleFileMessageContent(e){var t,r=null===(t=(0,Z.hr)(e))||void 0===t?void 0:t.fileType;if(!r)throw new X("");return{file_list:[{file_key:"",file_name:e.name,file_type:r,file_size:e.size,file_url:""}]}}assembleTextAndFileMixMessageContent(e){return{item_list:e.map(e=>{var{type:t}=e;if(t===O.zc.Text)return{type:t,text:e.text};if(t===O.zc.File){var r,n=(null===(r=(0,Z.hr)(e.file))||void 0===r?void 0:r.fileType)||Z.Wz.DEFAULT_UNKNOWN;return{type:t,file:{file_key:e.uri,file_name:e.file.name,file_type:n,file_size:e.file.size,file_url:""}}}if(t===O.zc.Image){var a=URL.createObjectURL(e.file);return{type:t,image:{key:e.uri,image_thumb:{url:a,width:e.width,height:e.height},image_ori:{url:a,width:e.width,height:e.height},feedback:null}}}})}}assembleMessageCommonProps(e){var t={message_id:"",reply_id:"",is_finish:!0,extra_info:{local_message_id:(0,q.x0)(),input_tokens:"",output_tokens:"",token:"",plugin_status:"success",time_cost:"",workflow_tokens:"",bot_state:"",plugin_request:"",tool_name:"",plugin:""},role:"user",type:"question"};return(0,h.Z)(t,this.bot_id?{bot_id:this.bot_id}:{},this.preset_bot?{preset_bot:this.preset_bot}:{},this.user?{user:this.user}:{},this.scene?{scene:this.scene}:{},e)}getSendMessageStructure(e,t){var{extra_info:{local_message_id:r},content_type:n,content:a,message_id:o,mention_list:i}=e,{user:s,bot_id:l,preset_bot:c,scene:d,bot_version:u,draft_mode:v}=this,{stream:m,chatHistory:g,isRegenMessage:p,extendFiled:f}=t;return S((0,h.Z)({bot_id:l,preset_bot:c,conversation_id:this.conversation_id,local_message_id:r,content_type:n,query:a,user:s,extra:{},scene:d,bot_version:u,draft_mode:v,stream:m,chat_history:g,regen_message_id:p?o:void 0,mention_list:i},f))}constructor(e){var{bot_id:t,conversation_id:r,preset_bot:n,user:a,scene:o,bot_version:i,draft_mode:s}=e;this.bot_id=t,this.preset_bot=n,this.conversation_id=r,this.user=a,this.scene=o,this.bot_version=i,this.draft_mode=s}}var $=r("62851");class ee{pushChunk(e){this.streamChunkBuffer.push(e)}concatContentAndUpdateMessage(e){var t,r,n=this.streamMessageBuffer.findIndex(t=>t.message_id===e.message_id);if(-1===n){this.streamMessageBuffer.push(e);return}var a=this.streamMessageBuffer.at(n);e.content=((null==a?void 0:a.content)||"")+e.content,e.reasoning_content=(null!==(t=null==a?void 0:a.reasoning_content)&&void 0!==t?t:"")+(null!==(r=e.reasoning_content)&&void 0!==r?r:""),e.content_obj=e.content,this.streamMessageBuffer.splice(n,1,e)}clearMessageBuffer(){this.streamMessageBuffer=[],this.streamChunkBuffer=[]}clearMessageBufferByReplyId(e){this.streamMessageBuffer=this.streamMessageBuffer.filter(t=>t.reply_id!==e&&t.message_id!==e),this.streamChunkBuffer=this.streamChunkBuffer.filter(t=>t.message.reply_id!==e&&t.message.message_id!==e)}getChunkByMessageId(e){return this.streamChunkBuffer.filter(t=>t.message.message_id===e)}constructor(){this.streamMessageBuffer=[],this.streamChunkBuffer=[]}}class et{addChunkAndProcess(e,t){this.streamBuffer.pushChunk(e),(0,$.Z)(this.preProcessChunk.bind(this),this.concatChunkMessage.bind(this),this.assembleDebugMessage.bind(this))(e,t)}getProcessedMessageByChunk(e){return this.streamBuffer.streamMessageBuffer.find(t=>t.message_id===e.message.message_id)}getProcessedMessageByMessageId(e){return this.streamBuffer.streamMessageBuffer.find(t=>t.message_id===e)}getAckMessageByLocalMessageId(e){return this.streamBuffer.streamMessageBuffer.find(t=>t.extra_info.local_message_id===e&&"ack"===t.type)}getFirstReplyMessageByChunk(e){if(!!this.streamBuffer.streamMessageBuffer.find(t=>"ack"===t.type&&t.message_id===e.message.reply_id))return this.streamBuffer.streamMessageBuffer.find(t=>"ack"!==t.type&&t.reply_id===e.message.reply_id)}getAckMessageByChunk(e){return this.streamBuffer.streamMessageBuffer.find(t=>"ack"===t.type&&t.message_id===e.message.reply_id)}isFirstReplyMessage(e){return!!this.getAckMessageByChunk(e)&&!this.getFirstReplyMessageByChunk(e)}getReplyMessagesByReplyId(e){return this.streamBuffer.streamMessageBuffer.filter(t=>"ack"!==t.type&&t.reply_id===e)}getReplyMessagesLengthByReplyId(e){return"".concat(this.getReplyMessagesByReplyId(e).reduce((e,t)=>e+t.content.length,0))}appendDebugMessage(e){var t=(0,Y.Z)(e);return t.debug_messages=this.streamBuffer.getChunkByMessageId(e.message_id),t.stream_chunk_buffer=this.streamBuffer.streamChunkBuffer,t.stream_message_buffer=this.streamBuffer.streamMessageBuffer,t}isMessageAnswerEnd(e){var{message:t}=e;return!!this.getReplyMessagesByReplyId(t.reply_id).find(e=>{var{type:t,content:r}=e;if("verbose"!==t)return!1;var{value:n}=W(r,null);if(!n)return!1;var{value:a}=W(n.data,null);return n.msg_type===O.kc.GENERATE_ANSWER_FINISH&&(null==a?void 0:a.finish_reason)!==O.Y.INTERRUPT})}preProcessChunk(e,t){var{message:r,is_finish:n,index:a}=e,{logId:o}=t||{};return(0,V._)((0,p._)({mention_list:[]},r),{logId:o,bot_id:this.bot_id,preset_bot:this.preset_bot,is_finish:n,index:a,content_obj:r.content_type!==O.zc.Text?W(r.content,null).value:r.content})}concatChunkMessage(e){return this.streamBuffer.concatContentAndUpdateMessage(e),e}assembleDebugMessage(e){return this.enableDebug?(e.debug_messages=this.streamBuffer.getChunkByMessageId(e.message_id),e):e}constructor(e){this.streamBuffer=new ee;var{bot_id:t,preset_bot:r,enableDebug:n}=e;this.bot_id=t,this.preset_bot=r,this.enableDebug=n}}var er=r("335022"),en=r("650548");class ea{constructor(e){this.attempts=0,this.maxRetryAttempts=0,this.add=()=>{this.attempts++},this.reset=()=>{this.attempts=0},this.matchMaxRetryAttempts=()=>this.attempts>=this.maxRetryAttempts,this.maxRetryAttempts=(null==e?void 0:e.maxRetryAttempts)||3}}class eo{constructor({localMessageID:e,retryCounterConfig:t,betweenChunkTimeout:r,totalFetchTimeout:n,headers:a}){this.setReplyID=e=>{this.replyID=e},this.setSeqID=e=>{this.seqID=e},this.setLogID=e=>{if(!!e)this.logID=e},this.localMessageID=e,this.retryCounter=new ea(t),this.abortSignal=new AbortController,this.betweenChunkTimeout=r,this.totalFetchTimeout=n,this.headers=a}}var ei=((o={}).ERROR="error",o.DONE="done",o.MESSAGE="message",o),es=(e,t)=>{var{terminate:r}=t,{type:n}=e;if("event"===n){var{data:a,event:o}=e;switch(o){case"message":return{event:o,data:W(a,null).value||void 0};case"done":r();return;case"error":return{event:o,data:a};default:return}}},el=()=>new eo({localMessageID:"DataClamp placeholder, please check your HttpChunk Instance"});class ec extends m.Z{customEmit(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return super.emit(e,...r)}}var ed=e=>{var{localMessageID:t="",replyID:r,logID:n}=null!=e?e:{};return{localMessageID:t,replyID:r,logID:n}};var eu=((i={}).HTTP_CHUNK_UNEXPECTED_ABORT_ERROR="http_chunk_unexpected_abort_error",i);var ev=((s={}).MESSAGE_RECEIVED="http_chunk_message_received",s.MESSAGE_RECEIVED_INVALID="http_chunk_message_received_invalid",s.TOTAL_FETCH_TIMEOUT="http_chunk_total_fetch_timeout",s.BETWEEN_CHUNK_TIMEOUT="http_chunk_between_chunk_timeout",s.FETCH_START="http_chunk_fetch_start",s.FETCH_SUCCESS="http_chunk_fetch_success",s.FETCH_ERROR="http_chunk_fetch_error",s.INVALID_MESSAGE="http_chunk_invalid_message",s.READ_STREAM_START="http_chunk_read_stream_start",s.READ_STREAM_ERROR="http_chunk_read_stream_error",s.ALL_SUCCESS="http_chunk_all_success",s);class em extends ec{constructor({retryCounterConfig:e,requestManager:t,tokenManager:r,reportLogWithScope:n}){var a,o;super(),a=this,this.handleMessageSuccess=e=>{var{fetchDataHelper:t=el()}=e,{localMessageID:r}=t;this.fetchDataHelperMap.delete(r),this.customEmit(ev.ALL_SUCCESS,ed(t))},this.handleMessage=e=>{var t,{message:{data:r},fetchDataHelper:n=el()}=e,{logID:a,replyID:o}=n;if(!(null!==(t=r)&&"object"==typeof t&&"seq_id"in t&&"message"in t&&"is_finish"in t&&"seq_id"in t)){this.customEmit(ev.INVALID_MESSAGE,{logID:a,replyID:o});return}n.setReplyID(r.message.reply_id),this.customEmit(ev.MESSAGE_RECEIVED,{chunk:r,logID:a})},this.pullMessage=(o=(0,g._)(function*(e){var t,r,n,{value:o,isRePullMessage:i,fetchDataHelper:s,fetchUrl:l,scene:c}=e,d=[["content-type","application/json"],...(null===(t=a.tokenManager)||void 0===t?void 0:t.getApiKeyAuthorizationValue())?[["Authorization",a.tokenManager.getApiKeyAuthorizationValue()]]:[],...s.headers?Array.isArray(s.headers)?s.headers:Object.entries(s.headers):[]],{hooks:u}=(null===(r=(n=a.requestManager).getSceneConfig)||void 0===r?void 0:r.call(n,c))||{},{onBeforeSendMessage:v=[],onGetMessageStreamParser:m}=u||{},g={url:l,body:JSON.stringify(o),headers:d,method:"POST"};for(var f of v)g=yield f(g);yield(0,er.$)(g.url,{onStart:e=>(s.setLogID(e.headers.get("x-tt-logid")),Promise.resolve()),onFetchStart:e=>{a.customEmit(ev.FETCH_START,ed(e))},onFetchSuccess:e=>{a.customEmit(ev.FETCH_SUCCESS,ed(e))},onStartReadStream:e=>{a.customEmit(ev.READ_STREAM_START,ed(e))},onError:e=>{var{fetchStreamError:t,dataClump:r}=e;return a.handleError({errorInfo:(0,V._)((0,p._)({},t),{ext:ed(r)}),fetchDataHelper:r})},onAllSuccess:e=>a.handleMessageSuccess({fetchDataHelper:e}),validateMessage:e=>{var{message:t}=e;return t.event!==ei.ERROR?{status:"success"}:{error:Error(String(t.data)),status:"error"}},onMessage:e=>{var{message:t,dataClump:r}=e;return a.handleMessage({message:t,fetchDataHelper:r})},streamParser:(null==m?void 0:m(o))||es,dataClump:s,body:g.body,headers:g.headers,method:g.method,signal:s.abortSignal.signal,totalFetchTimeout:s.totalFetchTimeout,onTotalFetchTimeout:e=>a.handleTotalFetchTimeout({fetchDataHelper:e}),betweenChunkTimeout:s.betweenChunkTimeout,onBetweenChunkTimeout:e=>a.handleBetweenChunkTimeout({fetchDataHelper:e})})}),function(e){return o.apply(this,arguments)}),this.handleBetweenChunkTimeout=e=>{var{fetchDataHelper:t=el()}=e;this.customEmit(ev.BETWEEN_CHUNK_TIMEOUT,ed(t))},this.handleTotalFetchTimeout=e=>{var{fetchDataHelper:t=el()}=e;this.customEmit(ev.TOTAL_FETCH_TIMEOUT,ed(t))},this.handleError=e=>{var{errorInfo:t}=e;if(t.code===en.A.FetchException){this.customEmit(ev.FETCH_ERROR,t);return}this.customEmit(ev.READ_STREAM_ERROR,t)},this.sendMessage=(e,t)=>{var r,n,a=e.local_message_id;if(!a){this.customEmit(ev.FETCH_ERROR,{code:en.A.FetchException,msg:"SendMessageError: SendMessage is Invalid"});return}var o=new eo({localMessageID:a,retryCounterConfig:this.retryCounterConfig,betweenChunkTimeout:null==t?void 0:t.betweenChunkTimeout,totalFetchTimeout:null==t?void 0:t.totalFetchTimeout,headers:null==t?void 0:t.headers});this.fetchDataHelperMap.size>=100&&this.fetchDataHelperMap.clear(),this.fetchDataHelperMap.set(a,o);var i=(null==t?void 0:t.requestScene)||j.SendMessage,{url:s,baseURL:l}=(null===(r=(n=this.requestManager).getSceneConfig)||void 0===r?void 0:r.call(n,i))||{},c=l?"".concat(l).concat(s):s;this.pullMessage({value:e,isRePullMessage:!1,fetchDataHelper:o,fetchUrl:c,scene:i})},this.abort=e=>{var t,r,n=this.fetchDataHelperMap.get(e);if(this.fetchDataHelperMap.delete(e),null==n?!void 0:!n.abortSignal.signal.aborted)try{null==n||null===(t=(r=n.abortSignal).abort)||void 0===t||t.call(r,"ABORT_FETCH"),this.reportLogWithScope.slardarSuccessEvent({eventName:eu.HTTP_CHUNK_UNEXPECTED_ABORT_ERROR})}catch(e){var a=new X("An error occurred in calling abort in synchronous code",{rawError:e});this.reportLogWithScope.slardarErrorEvent({eventName:eu.HTTP_CHUNK_UNEXPECTED_ABORT_ERROR,error:a,meta:a.flatten()})}},this.drop=()=>{this.fetchDataHelperMap.forEach(e=>{this.abort(e.localMessageID)})},this.retryCounterConfig=e,this.fetchDataHelperMap=new Map,this.requestManager=t,this.tokenManager=r,this.reportLogWithScope=n}}var eg=e=>"preset_bot"in e&&!!e.preset_bot;var ep=((l={})[l.Default=0]="Default",l[l.Explore=1]="Explore",l[l.BotStore=2]="BotStore",l[l.CozeHome=3]="CozeHome",l[l.Playground=4]="Playground",l[l.AgentAPP=6]="AgentAPP",l[l.PromptOptimize=7]="PromptOptimize",l[l.OpenAipSdk=1e3]="OpenAipSdk",l);var ef=((c={})[c.Unknown=0]="Unknown",c[c.Prev=1]="Prev",c[c.Next=2]="Next",c);var eh=((d={}).MESSAGE_RECEIVED_AND_UPDATE="message_received_and_update",d.MESSAGE_PULLING_STATUS="message_pulling_status",d.ERROR="error",d);var e_=((u={}).SDK_INIT="chat_sdk_init",u.SDK_MESSAGE_UPLOAD_FAIL="chat_sdk_message_upload_fail",u.SDK_BREAK_MESSAGE="chat_sdk_break_message",u.SDK_MESSAGE_SEND_TRACER="chat_sdk_message_send_tracer",u.SDK_PULL_STREAM_TRACER="chat_sdk_pull_stream_tracer",u);class ex{static getUniqueKey(e,t){return"".concat(e,"_").concat(t)}getTracer(e,t){return this.eventTracers.get(ex.getUniqueKey(e,t))||{trace:void 0}}setTracer(e,t,r){var{trace:n,meta:a}=r;this.eventTracers.set(ex.getUniqueKey(e,t),{trace:n,meta:a})}deleteTracer(e,t){this.eventTracers.delete(ex.getUniqueKey(e,t))}createTracer(e){return this.reporter.slardarTracer({eventName:e})}constructor(e){this.eventTracers=new Map,this.sendMessageTracer={start:(e,t)=>{var{trace:r}=this.createTracer("chat_sdk_message_send_tracer");this.setTracer(e,"chat_sdk_message_send_tracer",{trace:r}),null==r||r("start",{meta:t})},success:(e,t)=>{var{trace:r}=this.getTracer(e,"chat_sdk_message_send_tracer");null==r||r("success",{meta:t}),this.deleteTracer(e,"chat_sdk_message_send_tracer")},error:e=>{var{local_message_id:t}=e.ext;if(!!t){var{trace:r}=this.getTracer(t,"chat_sdk_message_send_tracer");null==r||r("error",{meta:e.flatten(),error:e}),this.deleteTracer(t,"chat_sdk_message_send_tracer")}},timeout:e=>{var{trace:t}=this.getTracer(e,"chat_sdk_message_send_tracer");null==t||t("timeout"),this.deleteTracer(e,"chat_sdk_message_send_tracer")}},this.pullStreamTracer={start:(e,t)=>{var{trace:r}=this.createTracer("chat_sdk_pull_stream_tracer");this.setTracer(e,"chat_sdk_pull_stream_tracer",{trace:r,meta:t}),null==r||r("start",{meta:t})},success:(e,t)=>{var{trace:r}=this.getTracer(e,"chat_sdk_pull_stream_tracer");null==r||r("success",{meta:t}),this.deleteTracer(e,"chat_sdk_pull_stream_tracer")},break:(e,t)=>{var{trace:r}=this.getTracer(e,"chat_sdk_pull_stream_tracer");null==r||r("success",{meta:t}),this.deleteTracer(e,"chat_sdk_pull_stream_tracer")},error:(e,t)=>{var{local_message_id:r}=e.ext;if(!!r){var{trace:n}=this.getTracer(r,"chat_sdk_pull_stream_tracer");null==n||n("error",{meta:(0,p._)({},e.flatten(),t),error:e}),this.deleteTracer(r,"chat_sdk_pull_stream_tracer")}},timeout:e=>{var{local_message_id:t}=e.ext;if(!!t){var{trace:r}=this.getTracer(t,"chat_sdk_pull_stream_tracer");null==r||r("timeout",{meta:e.flatten(),error:e}),this.deleteTracer(t,"chat_sdk_pull_stream_tracer")}},receiveAck:(e,t)=>{var{trace:r}=this.getTracer(e,"chat_sdk_pull_stream_tracer");null==r||r("ack",{meta:t})},receiveFirstAnsChunk:(e,t)=>{var{trace:r}=this.getTracer(e,"chat_sdk_pull_stream_tracer");null==r||r("first_ans_chunk",{meta:t})}},this.reporter=e}}class ey{resumeMessage(e,t){var r=(0,p._)({sendTimeout:Z.r,betweenChunkTimeout:Z.js,stream:!0,chatHistory:[],isRegenMessage:!1},t),n=this.preSendLocalMessageFactory.getSendMessageStructure(e,r);this.httpChunk.sendMessage(n,{betweenChunkTimeout:null==t?void 0:t.betweenChunkTimeout,headers:null==t?void 0:t.headers,requestScene:j.ResumeMessage})}sendMessage(e,t){var r=this;return(0,g._)(function*(){var n=(0,p._)({sendTimeout:Z.r,betweenChunkTimeout:Z.js,stream:!0,chatHistory:[],isRegenMessage:!1},t);return(r.reportLogWithScope.info({message:"",meta:{message:e}}),e.content_type===O.zc.Image)?yield r.sendImageMessage(e,n):e.content_type===O.zc.File?yield r.sendFileMessage(e,n):yield r.sendTextMessage(e,n)})()}sendImageMessage(e,t){var r=this;return(0,g._)(function*(){var n=yield r.onUploadEventFinish(e,t),a=r.preSendLocalMessageFactory.getSendMessageStructure(n,t);return yield r.sendChannelMessage(a,t)})()}sendFileMessage(e,t){var r=this;return(0,g._)(function*(){var n=yield r.onUploadEventFinish(e,t),a=r.preSendLocalMessageFactory.getSendMessageStructure(n,t);return yield r.sendChannelMessage(a,t)})()}sendTextMessage(e,t){var r=this;return(0,g._)(function*(){var n=r.preSendLocalMessageFactory.getSendMessageStructure(e,t);return yield r.sendChannelMessage(n,t)})()}onUploadEventFinish(e,t){return new Promise((r,n)=>{if(null==t?void 0:t.isRegenMessage){r(e);return}var a=this.preSendLocalMessageEventsManager.getStashedLocalMessage(e.extra_info.local_message_id);if(null==a?void 0:a.file_upload_result){if((null==a?void 0:a.file_upload_result)==="success"){r(e);return}this.reportLogWithScope.slardarEvent({eventName:e_.SDK_MESSAGE_UPLOAD_FAIL,meta:{message:""}}),n(Error(""));return}this.preSendLocalMessageEventsManager.on(O.Yz.FILE_UPLOAD_STATUS_CHANGE,t=>{if(t.extra_info.local_message_id===e.extra_info.local_message_id)"success"===t.file_upload_result?r(t):(this.reportLogWithScope.slardarEvent({eventName:e_.SDK_MESSAGE_UPLOAD_FAIL,meta:{message:"-fail"}}),n(Error("")))})})}sendChannelMessage(e,t){var{sendTimeout:r,betweenChunkTimeout:n,headers:a}=t,{local_message_id:o}=e;return new Promise((t,i)=>{var s,l=!1,c=setTimeout(()=>{var t;if(!l)l=!0,this.preSendLocalMessageEventsManager.updateLocalMessageStatus(e.local_message_id,"send_timeout"),null===(t=this.reportEventsTracer)||void 0===t||t.sendMessageTracer.timeout(o),this.preSendLocalMessageEventsManager.emit(O.Yz.MESSAGE_SEND_TIMEOUT,new X("",{local_message_id:e.local_message_id})),i(new X("",{local_message_id:e.local_message_id}))},r);null===(s=this.reportEventsTracer)||void 0===s||s.sendMessageTracer.start(o),this.httpChunk.sendMessage(e,{betweenChunkTimeout:n,headers:a,requestScene:j.SendMessage}),this.preSendLocalMessageEventsManager.once(O.Yz.MESSAGE_SEND_SUCCESS,r=>{var n;if(r.extra_info.local_message_id===e.local_message_id&&!l)l=!0,clearTimeout(c),this.preSendLocalMessageEventsManager.updateLocalMessageStatus(r.extra_info.local_message_id,"send_success"),null===(n=this.reportEventsTracer)||void 0===n||n.sendMessageTracer.success(o,{logId:r.logId}),t(r)}),this.preSendLocalMessageEventsManager.once(O.Yz.MESSAGE_SEND_FAIL,t=>{var r;if(t.ext.local_message_id===e.local_message_id&&!l)l=!0,clearTimeout(c),this.preSendLocalMessageEventsManager.updateLocalMessageStatus(t.ext.local_message_id,"send_fail"),null===(r=this.reportEventsTracer)||void 0===r||r.sendMessageTracer.error(t),i(t)})})}constructor({preSendLocalMessageFactory:e,httpChunk:t,preSendLocalMessageEventsManager:r,reportLogWithScope:n,reportEventsTracer:a}){this.preSendLocalMessageFactory=e,this.httpChunk=t,this.preSendLocalMessageEventsManager=r,this.reportLogWithScope=n,this.reportEventsTracer=a}}var eb=r("765377");class eS{registerPlugin(e,t,r){"upload-plugin"===e&&(this.UploadPlugin=t,this.uploadPluginConstructorOptions=r||{})}checkPluginIsRegistered(e){return"upload-plugin"===e&&!!this.UploadPlugin}getRegisteredPlugin(e){if("upload-plugin"===e)return this.UploadPlugin;(0,eb.Sn)(e)}constructor(){this.UploadPlugin=null,this.uploadPluginConstructorOptions={}}}class eC{getHistoryMessage(e){var t=this;return(0,g._)(function*(){var r=S((0,p._)({conversation_id:t.conversation_id,scene:t.scene,bot_id:t.bot_id,preset_bot:t.preset_bot,draft_mode:t.draft_mode},e));return yield t.messageManager.getHistoryMessage(r)})()}clearMessageContext(e){var t=this;return(0,g._)(function*(){return yield t.messageManager.clearMessageContextUrl((0,p._)({conversation_id:t.conversation_id,scene:t.scene},e))})()}clearHistory(){var e=this;return(0,g._)(function*(){return yield e.messageManager.clearHistory({bot_id:e.bot_id,conversation_id:e.conversation_id,scene:e.scene})})()}deleteMessage(e){var t=this;return(0,g._)(function*(){return yield t.messageManager.deleteMessage((0,p._)({bot_id:t.bot_id,conversation_id:t.conversation_id,scene:t.scene},e))})()}reportMessage(e){var t=this;return(0,g._)(function*(){return yield t.messageManager.reportMessage((0,p._)({bot_id:t.bot_id,biz_conversation_id:t.conversation_id,scene:t.scene},e))})()}breakMessage(e){var t=this;return(0,g._)(function*(){t.httpChunk.abort(e.local_message_id);var r,n=t.chunkProcessor.getReplyMessagesLengthByReplyId(e.query_message_id);return null===(r=t.reportEventsTracer)||void 0===r||r.pullStreamTracer.break(e.local_message_id,{contentLength:n}),t.reportLogWithScope.slardarEvent({eventName:e_.SDK_BREAK_MESSAGE,meta:(0,p._)({},e)}),yield t.messageManager.breakMessage((0,p._)({conversation_id:t.conversation_id,scene:t.scene},e))})()}chatASR(e){var t=this;return(0,g._)(function*(){return yield t.messageManager.chatASR(e)})()}constructor({messageManager:e,conversation_id:t,scene:r,bot_id:n,preset_bot:a,draft_mode:o,httpChunk:i,chunkProcessor:s,reportEventsTracer:l,reportLogWithScope:c}){this.convertMessageList=e=>K.convertMessageList(e),this.messageManager=e,this.conversation_id=t,this.scene=r,this.bot_id=n,this.preset_bot=a,this.draft_mode=o,this.httpChunk=i,this.chunkProcessor=s,this.reportEventsTracer=l,this.reportLogWithScope=c}}class ej{onHttpChunkEvents(){this.httpChunk.on(ev.FETCH_START,this.handleHttpChunkFetchStart),this.httpChunk.on(ev.MESSAGE_RECEIVED,this.handleHttpChunkMessageReceived),this.httpChunk.on(ev.ALL_SUCCESS,this.handleHttpChunkStreamSuccess),this.httpChunk.on(ev.READ_STREAM_START,this.handleHttpChunkReadStreamStart),this.httpChunk.on(ev.FETCH_ERROR,this.handleHttpChunkFetchError),this.httpChunk.on(ev.READ_STREAM_ERROR,this.handleReadStreamError),this.httpChunk.on(ev.BETWEEN_CHUNK_TIMEOUT,this.handleHttpChunkTimeout)}constructor({httpChunk:e,reportLogWithScope:t,chunkProcessor:r,preSendLocalMessageEventsManager:n,chatSdkEventEmit:a,chatSdkEventBus:o,reportEventsTracer:i}){this.handleHttpChunkFetchStart=e=>{var t,r,{localMessageID:n}=e;null===(r=this.reportEventsTracer)||void 0===r||null===(t=r.pullStreamTracer)||void 0===t||t.start(n)},this.handleHttpChunkMessageReceived=e=>{var t,r,n,a,{chunk:o,logID:i}=e,s=this.chunkProcessor.getAckMessageByChunk(o),{local_message_id:l=""}=(null==s?void 0:s.extra_info)||e.chunk.message.extra_info,c="pulling";this.chunkProcessor.isMessageAnswerEnd(o)&&(c="answerEnd"),this.chatSdkEventEmit(eh.MESSAGE_PULLING_STATUS,{name:eh.MESSAGE_PULLING_STATUS,data:{pullingStatus:c,local_message_id:l,reply_id:e.chunk.message.reply_id||""}});var d=this.chatSdkEventBus.eventNames().includes(eh.MESSAGE_RECEIVED_AND_UPDATE);this.chunkProcessor.isFirstReplyMessage(o)&&(null===(r=this.reportEventsTracer)||void 0===r||null===(t=r.pullStreamTracer)||void 0===t||t.receiveFirstAnsChunk(l,{logId:i})),this.chunkProcessor.addChunkAndProcess(o,{logId:i});var u=this.chunkProcessor.getProcessedMessageByChunk(o);if(d&&this.reportLogWithScope.info({message:"&",meta:{logMessageWithDebugInfo:this.chunkProcessor.appendDebugMessage(u)}}),"ack"===o.message.type){null===(a=this.reportEventsTracer)||void 0===a||null===(n=a.pullStreamTracer)||void 0===n||n.receiveAck(l,{logId:i}),this.preSendLocalMessageEventsManager.emit(O.Yz.MESSAGE_SEND_SUCCESS,u);return}this.chatSdkEventEmit(eh.MESSAGE_RECEIVED_AND_UPDATE,{name:eh.MESSAGE_RECEIVED_AND_UPDATE,data:[u]})},this.handleReadStreamError=e=>{var t,r,{ext:{localMessageID:n="",replyID:a="",logID:o=""}={},code:i,msg:s}=e,l=new X(s,{code:i,local_message_id:n,logId:o,reply_id:a,rawError:e}),c=this.chunkProcessor.getAckMessageByLocalMessageId(n);if(!c){this.preSendLocalMessageEventsManager.emit(O.Yz.MESSAGE_SEND_FAIL,l);return}c&&this.chatSdkEventEmit(eh.MESSAGE_PULLING_STATUS,{name:eh.MESSAGE_PULLING_STATUS,data:{pullingStatus:"error",local_message_id:n,reply_id:a},error:l});var d=this.chunkProcessor.getReplyMessagesLengthByReplyId(a);null===(r=this.reportEventsTracer)||void 0===r||null===(t=r.pullStreamTracer)||void 0===t||t.error(l,{contentLength:d})},this.handleHttpChunkFetchError=e=>{var{ext:{localMessageID:t="",replyID:r="",logID:n=""}={},code:a,msg:o}=e,i=new X(o,{code:a,local_message_id:t,logId:n,reply_id:r,rawError:e});this.preSendLocalMessageEventsManager.emit(O.Yz.MESSAGE_SEND_FAIL,i)},this.handleHttpChunkStreamSuccess=e=>{var t,r,{localMessageID:n,replyID:a}=e;this.chatSdkEventEmit(eh.MESSAGE_PULLING_STATUS,{name:eh.MESSAGE_PULLING_STATUS,data:{pullingStatus:"success",local_message_id:n,reply_id:a||""}});var o=a&&this.chunkProcessor.getReplyMessagesLengthByReplyId(a);null===(r=this.reportEventsTracer)||void 0===r||null===(t=r.pullStreamTracer)||void 0===t||t.success(n,{contentLength:o}),this.reportLogWithScope.info({message:"",meta:{local_message_id:n,reply_id:a||"",streamBuffer:this.chunkProcessor.streamBuffer}}),a&&this.chunkProcessor.streamBuffer.clearMessageBufferByReplyId(a)},this.handleHttpChunkReadStreamStart=e=>{var{localMessageID:t,replyID:r,logID:n}=e;this.reportLogWithScope.info({message:"",meta:{local_message_id:t,reply_id:r||"",logID:n}}),this.chatSdkEventEmit(eh.MESSAGE_PULLING_STATUS,{name:eh.MESSAGE_PULLING_STATUS,data:{pullingStatus:"start",local_message_id:t,reply_id:r||""}})},this.handleHttpChunkTimeout=e=>{var{localMessageID:t,replyID:r,logID:n}=e,a=new X("",{local_message_id:t,reply_id:r||"",logId:n});this.reportLogWithScope.info({message:"",meta:{chatCoreError:a}}),this.chatSdkEventEmit(eh.MESSAGE_PULLING_STATUS,{name:eh.MESSAGE_PULLING_STATUS,data:{pullingStatus:"timeout",local_message_id:t,reply_id:r||""},error:a,abort:()=>{this.httpChunk.abort(t)}})},this.httpChunk=e,this.reportLogWithScope=t,this.chunkProcessor=r,this.preSendLocalMessageEventsManager=n,this.chatSdkEventEmit=a,this.reportEventsTracer=i,this.chatSdkEventBus=o}}class ew{createTextMessage(e,t){return this.preSendLocalMessageFactory.createTextMessage(e,this.preSendLocalMessageEventsManager,t)}createImageMessage(e,t){var{UploadPlugin:r,uploadPluginConstructorOptions:n}=this.pluginsService;if(!r)throw this.reportLogWithScope.info({message:""}),Error("");return this.preSendLocalMessageFactory.createImageMessage({messageProps:e,UploadPlugin:r,uploadPluginConstructorOptions:n,messageEventsManager:this.preSendLocalMessageEventsManager,options:t})}createFileMessage(e,t){var{UploadPlugin:r,uploadPluginConstructorOptions:n}=this.pluginsService;if(!r)throw this.reportLogWithScope.info({message:""}),Error("");return this.preSendLocalMessageFactory.createFileMessage({messageProps:e,UploadPlugin:r,uploadPluginConstructorOptions:n,messageEventsManager:this.preSendLocalMessageEventsManager,options:t})}createTextAndFileMixMessage(e,t){return this.preSendLocalMessageFactory.createTextAndFileMixMessage(e,this.preSendLocalMessageEventsManager,t)}createNormalizedPayloadMessage(e,t){return this.preSendLocalMessageFactory.createNormalizedMessage(e,this.preSendLocalMessageEventsManager,t)}constructor({preSendLocalMessageFactory:e,preSendLocalMessageEventsManager:t,reportLogWithScope:r,pluginsService:n}){this.preSendLocalMessageFactory=e,this.preSendLocalMessageEventsManager=t,this.reportLogWithScope=r,this.pluginsService=n}}class eE{static create(e){var{unique_key:t}=eE.getUniqueKey(e);if(eE.instances.has(t))return console.error("duplicate chat core instance error"),eE.instances.get(t);var r=new eE(e);return eE.instances.set(t,r),r}static getUniqueKey(e){return eg(e)?{unique_key:e.preset_bot,bot_id:"",preset_bot:e.preset_bot}:{unique_key:e.bot_id,bot_id:e.bot_id,preset_bot:""}}initProps(e){var{bot_id:t,preset_bot:r}=eE.getUniqueKey(e),{enableDebug:n,logLevel:a,conversation_id:o,biz:i,user:s,env:l,deployVersion:c,scene:d,bot_version:u,draft_mode:v,space_id:m}=e;this.bot_id=t,this.space_id=m,this.preset_bot=r,this.conversation_id=o,this.biz=i,this.enableDebug=n||!1,this.logLevel=a||"error",this.user=s||"",this.env=l,this.deployVersion=c,this.scene=d,this.bot_version=u,this.draft_mode=v}initModules(e){this.initReportLog(),this.reportEventsTracer=new ex(this.reportLogWithScope),this.initRequestManager(e),this.initTokenManager(this.requestManager,e),this.preSendLocalMessageEventsManager=new z({reportLog:this.reportLog}),this.preSendLocalMessageFactory=new Q({bot_id:this.bot_id,preset_bot:this.preset_bot,conversation_id:this.conversation_id,user:this.user,scene:this.scene,bot_version:this.bot_version,draft_mode:this.draft_mode}),this.chunkProcessor=new et({bot_id:this.bot_id,preset_bot:this.preset_bot,enableDebug:this.enableDebug}),this.httpChunk=new em({tokenManager:e.tokenManager,requestManager:this.requestManager,reportLogWithScope:this.reportLogWithScope}),this.messageManager=new K({reportLog:this.reportLog,requestManager:this.requestManager})}onEvents(){this.httpChunkService.onHttpChunkEvents()}initServices(){this.pluginsService=new eS,this.createMessageService=new ew({preSendLocalMessageFactory:this.preSendLocalMessageFactory,preSendLocalMessageEventsManager:this.preSendLocalMessageEventsManager,reportLogWithScope:this.reportLogWithScope,pluginsService:this.pluginsService}),this.sendMessageService=new ey({preSendLocalMessageFactory:this.preSendLocalMessageFactory,httpChunk:this.httpChunk,preSendLocalMessageEventsManager:this.preSendLocalMessageEventsManager,reportLogWithScope:this.reportLogWithScope,reportEventsTracer:this.reportEventsTracer}),this.messageManagerService=new eC({messageManager:this.messageManager,conversation_id:this.conversation_id,scene:this.scene,bot_id:this.bot_id,preset_bot:this.preset_bot,draft_mode:this.draft_mode,httpChunk:this.httpChunk,chunkProcessor:this.chunkProcessor,reportEventsTracer:this.reportEventsTracer,reportLogWithScope:this.reportLogWithScope}),this.httpChunkService=new ej({httpChunk:this.httpChunk,reportLogWithScope:this.reportLogWithScope,chunkProcessor:this.chunkProcessor,preSendLocalMessageEventsManager:this.preSendLocalMessageEventsManager,chatSdkEventEmit:this.emit.bind(this),chatSdkEventBus:this.eventBus,reportEventsTracer:this.reportEventsTracer})}initReportLog(){this.reportLog=new U({logLevel:this.logLevel,env:this.env,deployVersion:this.deployVersion,meta:{biz:this.biz,chatCoreVersion:"1.1.0"}}),this.reportLog.init(),this.reportLogWithScope=this.reportLog.createLoggerWith({scope:"chat-sdk"})}initTokenManager(e,t){if(this.tokenManager=t.tokenManager,!!this.tokenManager)e.appendRequestOptions({hooks:{onBeforeRequest:[e=>{if(!this.tokenManager)return e;var t=this.tokenManager.getApiKeyAuthorizationValue();return t&&e.headers.set("Authorization",t),e}]}})}initRequestManager(e){this.requestManagerOptions=e.requestManagerOptions,this.requestManager=new M({options:this.requestManagerOptions,reportLog:this.reportLog})}destroy(){this.httpChunk.drop(),this.eventBus.removeAllListeners(),this.chunkProcessor.streamBuffer.clearMessageBuffer();var{unique_key:e}=eE.getUniqueKey({bot_id:this.bot_id,preset_bot:this.preset_bot});eE.instances.delete(e),this.preSendLocalMessageEventsManager.destroy(),this.reportLogWithScope.info({message:"SDK"})}on(e,t){return this.eventBus.eventNames().includes(e)&&this.reportLogWithScope.slardarError({message:"",error:Error(""),meta:{event:e}}),this.eventBus.on(e,t),()=>{this.eventBus.off(e,t)}}off(e,t){this.eventBus.off(e,t)}emit(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.eventBus.emit(e,...r)}createTextMessage(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.createMessageService.createTextMessage(...t)}createImageMessage(e,t){return this.createMessageService.createImageMessage(e,t)}createFileMessage(e,t){return this.createMessageService.createFileMessage(e,t)}createTextAndFileMixMessage(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.createMessageService.createTextAndFileMixMessage(...t)}createNormalizedPayloadMessage(e,t){return this.createMessageService.createNormalizedPayloadMessage(e,t)}resumeMessage(e,t){return this.sendMessageService.resumeMessage(e,t)}sendMessage(e,t){return this.sendMessageService.sendMessage(e,t)}registerPlugin(e,t,r){this.pluginsService.registerPlugin(e,t,r)}checkPluginIsRegistered(e){return this.pluginsService.checkPluginIsRegistered(e)}getRegisteredPlugin(e){return this.pluginsService.getRegisteredPlugin(e)}getHistoryMessage(e){return this.messageManagerService.getHistoryMessage(e)}clearMessageContext(e){return this.messageManagerService.clearMessageContext(e)}clearHistory(){return this.messageManagerService.clearHistory()}deleteMessage(e){return this.messageManagerService.deleteMessage(e)}reportMessage(e){return this.messageManagerService.reportMessage(e)}breakMessage(e){return this.messageManagerService.breakMessage(e)}chatASR(e){return this.space_id&&e.append("space_id",this.space_id),this.messageManagerService.chatASR(e)}updateConversationId(e){this.conversation_id=e,this.messageManagerService.conversation_id=e,this.preSendLocalMessageFactory.conversation_id=e}constructor(e){this.eventBus=new m.Z,this.initProps(e),this.initModules(e),this.initServices(),this.onEvents(),this.reportLogWithScope.slardarEvent({eventName:e_.SDK_INIT,meta:e})}}eE.instances=new Map,eE.EVENTS=eh,eE.convertMessageList=e=>K.convertMessageList(e);class ek{getToken(){return this.token}updateToken(e){this.token=e}updateApiKey(e){this.apiKey=e}getApiKey(){return this.apiKey}getApiKeyAuthorizationValue(){return"Bearer ".concat(null===this||void 0===this?void 0:this.getApiKey())}refreshApiKey(e){this.apiKey=e}constructor(e){var{token:t,tokenRefresher:r,apiKey:n}=e;this.token=t,this.apiKey=n,this.tokenRefresher=r}}var eI=((v={})[v.Feedback=0]="Feedback",v[v.Delete=1]="Delete",v[v.UpdataCard=2]="UpdataCard",v);r("537952");var eT=eE},873352:function(e,t,r){r.d(t,{Y:function(){return u},Yz:function(){return c},kc:function(){return d},mZ:function(){return s},zc:function(){return l}});var n,a,o,i,s={Chat:0,TaskManualTrigger:1,Notice:2,AsyncResult:3};var l=((n={}).Text="text",n.Link="link",n.Music="music",n.Video="video",n.Card="card",n.Image="image",n.File="file",n.Tako="tako",n.Custom="custom",n.Mix="mix",n);var c=((a={}).FILE_UPLOAD_STATUS_CHANGE="file_upload_status_change",a.MESSAGE_SEND_SUCCESS="message_send_success",a.MESSAGE_SEND_FAIL="message_send_fail",a.MESSAGE_SEND_TIMEOUT="message_send_timeout",a);var d=((o={}).JUMP_TO="multi_agents_jump_to_agent",o.BACK_WORD="multi_agents_backwards",o.LONG_TERM_MEMORY="time_capsule_recall",o.GENERATE_ANSWER_FINISH="generate_answer_finish",o.STREAM_PLUGIN_FINISH="stream_plugin_finish",o.KNOWLEDGE_RECALL="knowledge_recall",o.INTERRUPT="interrupt",o.HOOK_CALL="hook_call",o);var u=((i={})[i.ALL_FINISH=0]="ALL_FINISH",i[i.INTERRUPT=1]="INTERRUPT",i)},686250:function(e,t,r){r.d(t,{AX:function(){return a},Co:function(){return n.Co},Wz:function(){return n.Wz},hr:function(){return n.hr},js:function(){return i},r:function(){return s}});var n=r(187151),a="1.1.0",o=6e4,i=3e5,s=6e4;Date.now()},341665:function(e,t,r){r.d(t,{nE:()=>h,CN:()=>y,do:()=>m,CE:()=>l,AJ:()=>b,fE:()=>x,QG:()=>f,Ar:()=>s});var n,a,o,i,s=((n={}).MOBILE="mobile",n.PC="pc",n);var l=((a={})[a.TEXT=1]="TEXT",a[a.IMAGE=2]="IMAGE",a[a.CARD=3]="CARD",a[a.FILE=4]="FILE",a[a.TAKO=5]="TAKO",a[a.SUGGESTION=100]="SUGGESTION",a[a.SIMPLE_FUNCTION=101]="SIMPLE_FUNCTION",a),c=r("455069"),d=r("151064"),u=r("917085"),v=r("363036");var m=((o={})[o.WINDOW_RESIZE=0]="WINDOW_RESIZE",o[o.AFTER_CARD_RENDER=1]="AFTER_CARD_RENDER",o),g=e=>{var{eventCenter:t,chatContainerRef:r}=e;(0,c.useEffect)(()=>{if(!!r.current){var e=new ResizeObserver(()=>{t.emit(m.WINDOW_RESIZE)});return e.observe(r.current),()=>{e.disconnect()}}},[])},p=(0,c.createContext)(null),f=e=>{var{chatContainerRef:t,children:r}=e,n=(0,v.Z)(()=>(0,u.Z)(),[]);return g({eventCenter:n,chatContainerRef:t}),(0,d.jsx)(p.Provider,{value:n,children:r})},h=()=>(0,c.useContext)(p),_=r("686250"),x=500,y=524288e3;var b=((i={})[i.IMAGE=0]="IMAGE",i[i.FILE=1]="FILE",i);_.Co.map(e=>e.accept).flat(1).join(",")},552995:function(e,t,r){r.d(t,{$Y:()=>tv,uo:()=>eY,P8:()=>e0.Z,yq:()=>rQ,tg:()=>tz,zc:()=>eN.zc,AC:()=>ei,B3:()=>rV,X3:()=>r$,pJ:()=>r2,$I:()=>et,uu:()=>tO,Od:()=>e2.Z,XB:()=>r8.Z,VL:()=>e4.Z,DE:()=>rL,K8:()=>rx,FH:()=>rz,M0:()=>r5,_p:()=>t0,wq:()=>r_,Bt:()=>rw,bc:()=>eX,dN:()=>ti.Z,my:()=>es,t5:()=>eq,cU:()=>r4,Y$:()=>rK,zE:()=>tj,NR:()=>r9,xg:()=>rg,Hg:()=>t8,H0:()=>rN,Y_:()=>tI,Yj:()=>rk,f4:()=>tl.Z,Uh:()=>rF,eO:()=>r7.Z,Nl:()=>e8.Z,dj:()=>ey,it:()=>eo,ti:()=>te.Z});var n,a,o=r("808549"),i=r("120454"),s=r("473980"),l=r("151064"),c=r("455069"),d=r("667630"),u=r("871873"),v=r("252237"),m=r.n(v),g=r("232413"),p=r("136515"),f=r("915757"),h=r("674343"),_=r("341665"),x=r("810981"),y=(e,t)=>{if(t<=0)return Array(e).fill(8);var r=Array(e).fill(0).map((r,n)=>b(n,e,t)),n=Math.min(...r),a=Math.max(...r),o=a-n;return r.map(e=>8+(e-n)/(a-n)*Math.min(12,o))},b=(e,t,r)=>{var n=e/t,a=2,o=-2,i=2;return n<1/6?(a=1+3*n*6,o=.1+-.9*n*6,i=.3+.3*n*6):n<2/6?(a=4+-2*(n-1/6)*6,o=-.8+.8*(n-1/6)*6,i=.6+0*(n-1/6)*6):n<.5?(a=2+6*(n-2/6)*6,o=0+(Number(-1.6)-0)*(n-2/6)*6,i=.6+.6*(n-2/6)*6):n<4/6?(a=8+-6*(n-.5)*6,o=-1.6+1.6*(n-.5)*6,i=1.2+-.6*(n-.5)*6):n<5/6?(a=2+2*(n-4/6)*6,o=0+(Number(-.8)-0)*(n-4/6)*6,i=.6+0*(n-4/6)*6):n<1&&(a=4+-3*(n-5/6)*6,o=-.8+.9*(n-5/6)*6,i=.1+-.3*(n-5/6)*6),a+r*(Math.random()*(i-o)+o)*(24-a)},S=(e,t,r)=>{var n="#FFF";switch(r){case"primary":var a=0,o=0,i=0,s=0,l=e/t;l<.2?(a=.2+.8*l/.2,o=83,i=71,s=255):l<.8?(a=1,o=Math.round(83+94*(l-.2)/.6),i=Math.round(71+-34*(l-.2)/.6),s=Math.round(255+-14*(l-.2)/.6)):(a=1-.8*(l-.8)/.2,o=177,i=37,s=241),n="rgba(".concat(o,", ").concat(i,", ").concat(s,", ").concat(a.toFixed(2),")");break;case"warning":n="#FF0030";break;default:var c=0,d=e/t;c=d<.2?.2+.8*d/.2:d<.8?1-(1-.9)*(d-.2)/.6:.9-.7*(d-.8)/.2,n="rgba(255, 255, 255, ".concat(c.toFixed(2),")")}return n},C=r("407821"),j=r.n(C),w=r("472772"),E=r.n(w),k=r("395245"),I=r.n(k),T=r("297998"),M=r.n(T),A=r("646576"),N=r.n(A),L=r("606121"),Z=r.n(L),G=r("933039"),P={};P.styleTagTransform=Z(),P.setAttributes=M(),P.insert=I().bind(null,"head"),P.domAPI=E(),P.insertStyleElement=N(),j()(G.Z,P);var B=G.Z&&G.Z.locals?G.Z.locals:void 0,R={large:41,medium:29,small:4},D=e=>{var{size:t="medium",volumeNumber:r=0,type:n="default",wrapperClassName:a,waveClassName:o}=e,i=Math.max(Math.min(r,100),0),s=R[t]||29,c=y(s,i);return(0,l.jsx)(h.T,{spacing:3,align:"center",className:m()(B.container,a),children:c.map((e,r)=>(0,l.jsx)("div",{className:m()(B["audio-wave-".concat(r)],B[n],B.bar,B[t],o),style:{backgroundColor:S(r,s,n),height:e}},"".concat(n,"_").concat(r)))})},F=(0,c.forwardRef)((e,t)=>{var{isRecording:r,getVolume:n,isPointerMoveOut:a,layout:o,text:i}=e,[s,d]=(0,c.useState)(0),u=(0,c.useRef)(null),{run:v,flush:m}=(0,x.Z)(()=>{var e;d(null!==(e=null==n?void 0:n())&&void 0!==e?e:0),u.current=requestAnimationFrame(v)},{wait:100});return(0,c.useEffect)(()=>{if(!!r)return v(),()=>{if(m(),"number"==typeof u.current)cancelAnimationFrame(u.current),u.current=null}},[r]),(0,l.jsx)("div",{ref:t,className:"w-full h-32px relative",children:(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center pointer-events-none",children:r?(0,l.jsx)(D,{size:"medium",type:o===_.Ar.MOBILE?"default":a?"warning":"primary",volumeNumber:s}):(0,l.jsx)("div",{className:"coz-fg-primary text-lg font-medium leading-[20px]",children:i})})})}),U=r("380835"),O=r("193893"),z=r("64605"),W=r("896335"),H=r("529801"),K=r("765377"),V=(0,c.createContext)({imageAutoSizeContainerWidth:void 0,eventCallbacks:void 0}),q=()=>(0,c.useContext)(V),Y=(0,c.createContext)({}),X=Y.Provider,J=()=>(0,c.useContext)(Y),Q=e=>{try{return new URL(e)}catch(e){return null}},$=e=>{var t=Q(e);return!!t&&("http:"===t.protocol||"https:"===t.protocol)},ee=e=>{var t=Q(e);return!!t&&"coco:"===t.protocol},et=e=>{var t,r,{className:n,style:a,href:d,children:u,onSendMessage:v,onLinkClick:g,onLinkRender:p,onOpenLink:f,type:h,onLinkElementEnter:_,onLinkElementLeave:x}=e,y=(0,s._)(e,["className","style","href","children","onSendMessage","onLinkClick","onLinkRender","onOpenLink","type","onLinkElementEnter","onLinkElementLeave"]),b=e=>{if(f){null==f||f(e);return}window.open(e)},S=d?Q(d):null,C=(0,c.useRef)(null),{eventCallbacks:j}=J(),{eventCallbacks:w}=q(),{onMdBoxLinkElementEnter:E,onMdBoxLinkElementLeave:k}=null!=j?j:{},{onMdBoxLinkElementEnter:I,onMdBoxLinkElementLeave:T}=null!=w?w:{},M=null!==(t=null!=_?_:E)&&void 0!==t?t:I,A=null!==(r=null!=x?x:k)&&void 0!==r?r:T;return(0,c.useEffect)(()=>{d&&S&&(null==p||p({url:d,parsedUrl:S}))},[d]),(0,l.jsx)("a",(0,i._)((0,o._)({},(0,H.Z)(y,"href")),{className:m()(["!coz-fg-hglt"],n),style:a,onClick:e=>{if(!d||!S){e.preventDefault();return}if(ee(d)){e.preventDefault();var t=S.searchParams.get("msg"),r=S.searchParams.get("ext"),n=r?(0,K.WP)(r,e=>{reportError(e)}):void 0,a=(0,z.Z)(n)&&"s$wiki_link"in n&&(0,W.Z)(null==n?void 0:n.s$wiki_link)?null==n?void 0:n.s$wiki_link:"";if(a){$(a)&&(null==g||g(e,{url:d,parsedUrl:S,exts:{wiki_link:a,type:O.Un.wiki},openLink:b}));return}if(t){null==v||v(t);return}null==g||g(e,{url:d,parsedUrl:S,exts:{type:O.Un.coco},openLink:b})}if(!!$(d))g?g(e,{url:d,parsedUrl:S,exts:{type:O.Un.normal},openLink:b}):(e.preventDefault(),e.stopPropagation(),window.open(d))},href:S?d:void 0,target:"_blank",onMouseEnter:()=>{if(!!C.current)null==M||M({element:C.current,link:null!=d?d:""})},onMouseLeave:()=>{if(!!C.current)null==A||A({element:C.current,link:null!=d?d:""})},ref:C,children:u}))},er=r("615655"),en=(e,t,r)=>{var n=e/t,a=r,o=r/n,i=!1;return e<=r&&t<=240?(a=e,o=t):n>r/120?(a=r,o=120,i=!0):n<=.5?(a=120,o=240,i=!0):.5<=n&&n<=r/240?(a=240*n,o=240):r/240<=n&&n<=r/240&&(a=r,o=r/n),{displayHeight:o,displayWidth:a,isCover:i}},ea=r("277127"),eo=(0,c.memo)(e=>{var t,r,n,a,o,[i,s]=(0,c.useState)(!1),{className:d,src:u,onImageClick:v,imageAutoSizeContainerWidth:g,enablePreview:p,style:f}=e,_=(0,c.useRef)(null),{imageAutoSizeContainerWidth:x,eventCallbacks:y,onError:b}=J(),{onMdBoxImageElementEnter:S,onMdBoxImageElementLeave:C}=null!=y?y:{},{imageAutoSizeContainerWidth:j,eventCallbacks:w}=q(),{onMdBoxImageElementEnter:E,onMdBoxImageElementLeave:k}=null!=w?w:{},I=null!==(r=null!==(t=e.onImageElementEnter)&&void 0!==t?t:S)&&void 0!==r?r:E,T=null!==(a=null!==(n=e.onImageElementLeave)&&void 0!==n?n:C)&&void 0!==a?a:k,M=null!==(o=null!=g?g:x)&&void 0!==o?o:j,A=(0,c.useRef)({}),[N,L]=(0,c.useState)({}),[Z,G]=(0,c.useState)(!0),[P,B]=(0,c.useState)(ea),R=(0,c.useRef)(null),D=(e,t)=>{if(!!M){var{displayHeight:r,displayWidth:n,isCover:a}=en(e,t,M);L({display:"block",width:n,height:r,objectFit:a?"cover":void 0,objectPosition:"left top"})}},F=()=>{if(!!R.current)clearTimeout(R.current)},U=e=>{var{loadImageSrc:t}=e,r=new Image;r.src=t,F(),r.onload=()=>{F(),A.current={width:r.width,height:r.height},D(r.width,r.height),B(t),G(!1)},r.onerror=()=>{F(),R.current=setTimeout(()=>{B(ea),G(!1),null==b||b(Error("coze image load error: time out"))},1e4)}};return(0,c.useEffect)(()=>{G(!0),U({loadImageSrc:null!=u?u:""})},[u]),(0,c.useEffect)(()=>{if(!!M&&!!A.current&&!!A.current.width&&!!A.current.height)D(A.current.width,A.current.height)},[M,A.current]),(0,l.jsxs)("div",{ref:_,className:m()("w-fit",d),onMouseEnter:()=>{if(!!_.current)null==I||I({element:_.current,link:null!=u?u:""})},onMouseLeave:()=>{if(!!_.current)null==T||T({element:_.current,link:null!=u?u:""})},style:f,children:[p&&u?(0,l.jsx)(h.eT,{src:null!=u?u:"",visible:i,onVisibleChange:()=>s(!1)}):null,(0,l.jsx)(h.Od,{style:{width:240,height:120},className:"coz-mg-secondary",loading:Z,active:!0,children:(0,l.jsx)("img",{src:null!=P?P:"",style:N,className:m()("rounded-[8px]",d,{"cursor-zoom-in":!!v||p}),onClick:e=>{null==v||v(e,{src:null!=P?P:"",status:O.zu.Success}),p&&s(!0)}})})]})},(e,t)=>(0,er.Z)(e,t)),ei=e=>(0,l.jsx)(eo,(0,i._)((0,o._)({},e),{enablePreview:!0}));ei.displayName="CozeImageWithPreview";var es=e=>(0,l.jsx)(O.HK,(0,o._)({slots:{Image:eo,Link:et}},e)),el=e=>e&&"string"==typeof e,ec=r("739197"),ed={};ed.styleTagTransform=Z(),ed.setAttributes=M(),ed.insert=I().bind(null,"head"),ed.domAPI=E(),ed.insertStyleElement=N(),j()(ec.Z,ed),ec.Z&&ec.Z.locals&&ec.Z.locals;var eu=e=>{var t,{message:r,readonly:n,onImageClick:a,onLinkClick:s,mdBoxProps:d,enableAutoSizeImage:u,imageOptions:v}=e,m=(0,c.useRef)(null),{content:g}=r;if(!el(g))return null;var p=!r.is_finish,f=g.slice(0,null!==(t=r.broken_pos)&&void 0!==t?t:1/0);return(0,l.jsx)("div",{className:"chat-uikit-text-content","data-testid":"bot.ide.chat_area.message.text-answer-message-content",ref:m,"data-grab-mark":r.message_id,"data-grab-source":r.source,children:(0,l.jsx)(es,(0,i._)((0,o._)({markDown:f,autoFixSyntax:{autoFixEnding:p},showIndicator:p,smooth:p,imageOptions:(0,o._)({forceHttps:!1},v),eventCallbacks:{onImageClick:(e,t)=>{t.src&&(null==a||a({message:r,extra:{url:t.src}}))},onLinkClick:(e,t)=>{null==s||s({message:r,extra:(0,o._)({},t)},e),n&&(e.preventDefault(),e.stopPropagation())}}},d),{slots:(0,o._)({Image:u?eo:O.Ee,Link:et},null==d?void 0:d.slots)}))})};eu.displayName="TextContent";var ev=r("788637"),em=e=>e&&"image_list"in e,eg=r("483099"),ep={};ep.styleTagTransform=Z(),ep.setAttributes=M(),ep.insert=I().bind(null,"head"),ep.domAPI=E(),ep.insertStyleElement=N(),j()(eg.Z,ep),eg.Z&&eg.Z.locals&&eg.Z.locals;var ef=e=>{var{message:t}=e,{content_obj:r=(0,K.w8)({str:t.content,onParseError:e=>{(0,K.Cj)(e.message)},onVerifyError:e=>{(0,K.Cj)(e.message)},verifyStruct:e=>!!(e&&"image_list"in(0,o._)({},e))})}=t;return em(r)?(0,l.jsx)(ex,(0,o._)({content_obj:r},e)):null},eh={},e_=e=>null==e?void 0:e.startsWith("blob:"),ex=e=>{var t,r,n,a,o,i,s,d,u,v,{message:g,onImageClick:p,className:f,content_obj:_}=e,{imageAutoSizeContainerWidth:x=0}=J(),y=g.extra_info.local_message_id,b=null!==(i=null==_?void 0:null===(n=_.image_list)||void 0===n?void 0:null===(r=n.at(0))||void 0===r?void 0:null===(t=r.image_ori)||void 0===t?void 0:t.url)&&void 0!==i?i:"",{displayHeight:S,displayWidth:C,isCover:j}=en(null!==(s=null===(a=_.image_list.at(0))||void 0===a?void 0:a.image_ori.width)&&void 0!==s?s:0,null!==(d=null===(o=_.image_list.at(0))||void 0===o?void 0:o.image_ori.height)&&void 0!==d?d:0,x);e_(b)&&x>0&&(eh[y]={url:b,displayHeight:S,displayWidth:C});var[w,E]=(0,c.useState)(null!==(u=eh[y])&&void 0!==u?u:{url:b,displayWidth:C,displayHeight:S});return(0,c.useEffect)(()=>{var e=new Image;return b.startsWith("http")&&(e.src=b,e.onload=()=>{E({url:b,displayHeight:S,displayWidth:C})}),()=>{e.onload=null}},[b,x]),(0,l.jsx)(h.Od,{loading:(0,ev.Z)(null==w?void 0:w.url),style:{width:null==w?void 0:w.displayWidth,height:null==w?void 0:w.displayHeight},children:(0,l.jsx)("img",{src:null!==(v=null==w?void 0:w.url)&&void 0!==v?v:ea,style:{width:null==w?void 0:w.displayWidth,height:null==w?void 0:w.displayHeight,maxWidth:"100%",objectFit:j?"cover":void 0,objectPosition:"left top"},onClick:e=>null==p?void 0:p({message:g,extra:{url:null==w?void 0:w.url}}),className:m()("block",f,{"cursor-zoom-in":!!p})})})};ef.displayName="SingleImageContentWithAutoSize";var ey=(e,t)=>{try{return JSON.parse(e)}catch(e){return null!=t?t:void 0}},eb=r("879258"),eS=e=>{var{thumbUrl:t,originalUrl:r,onClick:n,className:a}=e;return(0,l.jsx)("div",{className:m()(a,"chat-uikit-single-image-content"),onClick:()=>null==n?void 0:n(r),children:(0,l.jsx)(h.Ee,{src:t||eb,className:"chat-uikit-single-image-content__image",preview:!1})})};eS.displayName="SingleImageContentUI";var eC={},ej=e=>null==e?void 0:e.startsWith("blob:"),ew=e=>{var t,r,n,a,{message:o,onImageClick:i}=e,{content_obj:s=ey(o.content)}=o,d=o.extra_info.local_message_id,u=null!==(a=null==s?void 0:null===(n=s.image_list)||void 0===n?void 0:null===(r=n.at(0))||void 0===r?void 0:null===(t=r.image_ori)||void 0===t?void 0:t.url)&&void 0!==a?a:"";ej(u)&&(eC[d]=u);var[v,m]=(0,c.useState)(ej(u)?u:eC[d]);return((0,c.useEffect)(()=>{var e=new Image;return u.startsWith("http")&&(e.src=u,e.onload=()=>{m(u)}),()=>{e.onload=null}},[u]),em(s))?(0,l.jsx)(eS,{onClick:e=>{null==i||i({message:o,extra:{url:e}})},thumbUrl:v,originalUrl:v}):null};ew.displayName="SingleImageContent";var eE=(e,t)=>e&&"function_call"===t.type,ek=e=>{var t,{message:r,copywriting:n}=e,{content:a}=r,o=(0,K.WP)(a,()=>void 0);return eE(o,r)?(0,l.jsxs)("div",{className:"coz-fg-hglt select-none flex items-center max-w-[230px] text-xxl leading-[26px]",children:[(0,l.jsx)(f.j2n,{className:"animate-spin"}),(0,l.jsx)("div",{className:"mr-[4px] ml-[8px]",children:null!==(t=null==n?void 0:n.using)&&void 0!==t?t:"using"}),(0,l.jsx)(h.ZT.Text,{className:"coz-fg-hglt flex-1 text-xxl font-bold leading-[26px]",ellipsis:{showTooltip:{opts:{content:o.name,style:{wordWrap:"inherit"}}}},children:o.name})]}):null};ek.displayName="SimpleFunctionContent";var eI=r("850398"),eT={};eT.styleTagTransform=Z(),eT.setAttributes=M(),eT.insert=I().bind(null,"head"),eT.domAPI=E(),eT.insertStyleElement=N(),j()(eI.Z,eT),eI.Z&&eI.Z.locals&&eI.Z.locals;var eM=e=>{var{content:t,isContentLoading:r}=e;return el(t)?(0,l.jsx)("div",{className:"chat-uikit-plain-text-content",children:r?(0,l.jsx)(rN,{className:"!p-0 !h-20px"}):(0,l.jsx)("span",{children:"".concat(eA(e)).concat(t)})}):null};eM.displayName="PlainTextContent";var eA=e=>{var t,{mentioned:r,getBotInfo:n}=e;if(!r)return"";var a=null===(t=n(r.id))||void 0===t?void 0:t.nickname;return a?"@".concat(a," "):""},eN=r("873352"),eL=e=>(0,z.Z)(e)&&"item_list"in e&&Array.isArray(e.item_list),eZ=e=>(0,z.Z)(e)&&"type"in e&&"text"in e&&e.type===eN.zc.Text,eG=e=>(0,z.Z)(e)&&"key"in e&&"image_thumb"in e&&"image_ori"in e,eP=e=>(0,z.Z)(e)&&"type"in e&&"image"in e&&eG(e.image)&&e.type===eN.zc.Image,eB=e=>(0,z.Z)(e)&&"file_key"in e&&"file_name"in e&&"file_type"in e&&"file_size"in e&&"file_url"in e,eR=e=>(0,z.Z)(e)&&"type"in e&&"file"in e&&eB(e.file)&&e.type===eN.zc.File,eD=r("316828"),eF=(0,eD.j)(["coz-fg-primary","w-fit","max-w-full","text-lg","font-normal","leading-[1.5]","rounded-normal","mb-4px","overflow-hidden"],{variants:{color:{primary:["chat-uikit-message-box-bg-primary"],whiteness:["bg-[var(--coz-mg-card)]"],grey:["bg-[var(--coz-mg-primary)]"]},border:{highlight:["coz-stroke-hglt","border-[1px]","border-solid"],primary:["coz-stroke-primary","border-[1px]","border-solid"]},showBackground:{true:[]},tight:{true:["p-0"],false:["py-12px","px-16px"]}},compoundVariants:[{color:"primary",showBackground:!0,className:["!coz-bg-image-user","!coz-stroke-image-user","!coz-fg-white"]},{color:"whiteness",showBackground:!0,className:["!coz-bg-image-bots","!coz-stroke-image-bots","border-[1px]","border-solid"]},{color:"grey",showBackground:!0,className:["!coz-bg-image-bots","!coz-stroke-image-bots","!coz-fg-white"]}]}),eU=e=>{var{textItemList:t,renderTextContentAddonTop:r,message:n,showBackground:a,getBotInfo:o,isContentLoading:i}=e;return(0,l.jsx)(l.Fragment,{children:t.map(e=>{if(eZ(e))return e.text||n.mention_list.at(0)?(0,l.jsxs)("div",{className:eF({color:"primary",border:null,tight:!1,showBackground:a}),style:{width:"fit-content"},children:[r,(0,l.jsx)(eM,{isContentLoading:i,content:e.text,mentioned:n.mention_list.at(0),getBotInfo:o})]},e.text):null})})},eO=r("454476"),ez={};ez.styleTagTransform=Z(),ez.setAttributes=M(),ez.insert=I().bind(null,"head"),ez.domAPI=E(),ez.insertStyleElement=N(),j()(eO.Z,ez),eO.Z&&eO.Z.locals&&eO.Z.locals;var eW=e=>1===e?{gutter:[1,1],span:24}:{gutter:[2,2],span:12},eH=e=>{var{data:t,eventCallbacks:r}=e,{onImageClick:n,onImageRender:a}=r||{},{image_list:o=[]}=t||{},i=eW(null==o?void 0:o.length);return(0,l.jsx)("div",{className:m()("chat-uikit-image-box","rounded-normal"),children:(0,l.jsx)(h.X2,{gutter:i.gutter,children:o.map((e,t)=>{var{image_thumb:r}=e;return(0,l.jsx)(h.JX,{span:i.span,children:(0,l.jsx)(O.Ee,{onImageClick:n,onImageRender:a,src:r.url,imageOptions:{squareContainer:!0},className:"object-cover"})},t)})})})},eK=e=>{var{originMessage:t,key:r,url:n,width:a,height:s}=e,l={image_list:[{key:r,image_ori:{url:n,width:a,height:s},image_thumb:{url:n,width:a,height:s}}]};return(0,i._)((0,o._)({},t),{content_obj:l,content:JSON.stringify(l),content_type:U.zc.Image})},eV=e=>{var{imageItemList:t,message:r,onImageClick:n}=e,a=e=>{null==n||n({message:r,extra:{url:e}})};return(0,l.jsx)(l.Fragment,{children:!!t.length&&(1===t.length?(0,l.jsx)(ef,{message:eK({originMessage:r,url:t[0].image.image_ori.url,key:t[0].image.image_ori.url,width:t[0].image.image_ori.width,height:t[0].image.image_ori.height}),onImageClick:n,className:"mb-[16px] rounded-[16px] overflow-hidden"},t[0].image.image_thumb.url):(0,l.jsx)("div",{className:eF({color:"whiteness",border:null,tight:!0,showBackground:!1}),style:{width:"240px"},children:(0,l.jsx)(eH,{data:{image_list:t.map(e=>e.image)},eventCallbacks:{onImageClick:(e,t)=>{var r;return a(null!==(r=t.src)&&void 0!==r?r:"")}}})},t[0].image.image_thumb.url))})},eq=e=>{var{content:t,children:r,hideToolTip:n,theme:a="dark"}=e,c=(0,s._)(e,["content","children","hideToolTip","theme"]);return t?(0,l.jsx)(h.u,(0,i._)((0,o._)({trigger:n?"custom":"hover",visible:!n&&void 0,content:t,theme:a},c),{style:{marginBottom:"8px"},children:r})):(0,l.jsx)(l.Fragment,{children:r})};eq.displayName="UIKitTooltip";var eY=e=>{var t=e.lastIndexOf(".");if(t<0)return{nameWithoutExtension:e,extension:""};var r=e.slice(t);return{extension:r,nameWithoutExtension:e.slice(0,t)}},eX=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!e)return"0 Byte";var r=Math.floor(Math.log(e)/Math.log(1024)),n=parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t));return"".concat(n," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])},eJ=(0,eD.j)(["select-none","relative","overflow-hidden","flex","flex-row","items-center","box-border","p-12px","border-[1px]","border-solid","rounded-normal","coz-mg-card","w-full"],{variants:{layout:{pc:["min-w-[282px]","max-w-[320px]"],mobile:["w-full"]},isError:{true:["coz-stroke-hglt-red"],false:["coz-stroke-primary"]},showBackground:{true:["!coz-bg-image-bots","!coz-stroke-image-bots"],false:[]}},compoundVariants:[{showBackground:!0,isError:!1,className:[]}]}),eQ=(0,eD.j)(["text-lg","font-normal","leading-[20px]"],{variants:{layout:{pc:["w-[180px]"],mobile:["w-full","max-w-[calc(100vw-170px)]"]},isCanceled:{true:["coz-fg-dim"],false:["coz-fg-primary"]}}}),e$=r("686250"),e0=r("198349"),e1=r("56832"),e2=r("252881"),e5=r("178532"),e4=r("467885"),e7=r("810041"),e8=r("548440"),e6=r("466152"),e9=r("28746"),e3=r("125042"),te=r("560207"),tt=r("108522"),tr=r("220204"),tn=r("105655"),ta=r("242240"),to=r("893975"),ti=r("656991"),ts=r("610062"),tl=r("107414"),tc=r("810895"),td=r("929607"),tu=r("429003"),tv={[e$.Wz.CSV]:ta.Z,[e$.Wz.DOCX]:te.Z,[e$.Wz.EXCEL]:e0.Z,[e$.Wz.PDF]:e9.Z,[e$.Wz.AUDIO]:tl.Z,[e$.Wz.VIDEO]:e2.Z,[e$.Wz.ARCHIVE]:td.Z,[e$.Wz.CODE]:ti.Z,[e$.Wz.TXT]:e4.Z,[e$.Wz.PPT]:e8.Z,[e$.Wz.DEFAULT_UNKNOWN]:tr.Z},tm={[e$.Wz.CSV]:to.Z,[e$.Wz.DOCX]:tt.Z,[e$.Wz.EXCEL]:e1.Z,[e$.Wz.PDF]:e3.Z,[e$.Wz.AUDIO]:tc.Z,[e$.Wz.VIDEO]:e5.Z,[e$.Wz.ARCHIVE]:tu.Z,[e$.Wz.CODE]:ts.Z,[e$.Wz.TXT]:e7.Z,[e$.Wz.PPT]:e6.Z,[e$.Wz.DEFAULT_UNKNOWN]:tn.Z},tg=r("75831"),tp={};tp.styleTagTransform=Z(),tp.setAttributes=M(),tp.insert=I().bind(null,"head"),tp.domAPI=E(),tp.insertStyleElement=N(),j()(tg.Z,tp),tg.Z&&tg.Z.locals&&tg.Z.locals;var tf=e=>{var{file:t,attributeKeys:r,tooltipsCopywriting:n,readonly:a,onCancel:o,onCopy:i,onRetry:s,className:c,layout:d,showBackground:u}=e,{statusKey:v,statusEnum:g,percentKey:p}=r,x=t[p],y=[g.cancelEnum,g.failEnum].includes(t[v])?tm:tv,{extension:b,nameWithoutExtension:S}=eY(t.file_name),C=t[v]===g.cancelEnum;return(0,l.jsxs)("div",{className:m()(eJ({isError:t[v]===g.failEnum,layout:d===_.Ar.PC?"pc":"mobile",showBackground:u}),c),children:[(0,l.jsx)("img",{src:y[t.file_type],className:"h-[32px] w-[32px]"}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col ml-8px overflow-hidden",children:[(0,l.jsx)(h.ZT.Text,{ellipsis:{showTooltip:d!==_.Ar.MOBILE&&{opts:{content:t.file_name,style:{wordWrap:"break-word"}}},suffix:b},className:eQ({isCanceled:C,layout:d===_.Ar.PC?"pc":"mobile"}),children:S}),(0,l.jsx)("span",{className:m()("text-base font-normal leading-[16px]",C?"coz-fg-dim":"coz-fg-secondary"),children:eX(t.file_size)})]}),a?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"ml-8px",children:[t[v]===g.uploadingEnum&&(0,l.jsx)(eq,{theme:"light",position:"top",content:null==n?void 0:n.cancel,hideToolTip:d===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{icon:(0,l.jsx)(f.rmE,{}),size:"small",color:"secondary",onClick:o})}),[g.cancelEnum,g.failEnum].includes(t[v])&&(0,l.jsx)(eq,{theme:"light",position:"top",content:null==n?void 0:n.retry,hideToolTip:d===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{icon:(0,l.jsx)(f.mxP,{}),size:"small",color:"secondary",onClick:s})}),t[v]===g.successEnum&&(0,l.jsx)(eq,{theme:"light",position:"top",content:null==n?void 0:n.copy,hideToolTip:d===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{icon:(0,l.jsx)(f.UtC,{}),size:"small",color:"secondary",onClick:i})})]}),t[v]===g.uploadingEnum&&(0,l.jsx)("div",{className:m()("coz-fg-hglt-dim absolute top-0 left-0 w-[280px] h-[72px]","chat-uikit-file-card-progress-animation"),style:{width:"".concat(x/100*280,"px")}})]})]})};tf.displayName="FileCard";var th=e=>{var{fileItemList:t,fileAttributeKeys:r,fileCopywriting:n,readonly:a,onRetry:o,onCancel:i,onCopy:s,message:c,layout:d,showBackground:u}=e,v=()=>{null==i||i({message:c,extra:{}})},m=()=>{null==o||o({message:c,extra:{}})},g=()=>{null==s||s({message:c,extra:{}})};return(0,l.jsx)(l.Fragment,{children:t.map(e=>eR(e)&&r?(0,l.jsx)(tf,{className:"chat-uikit-multi-modal-file-image-content select-none",file:e.file,attributeKeys:r,tooltipsCopywriting:null==n?void 0:n.tooltips,readonly:a,onCancel:v,onCopy:g,onRetry:m,layout:d,showBackground:u},e.file.file_key):null)})},t_=r("819731"),tx={};tx.styleTagTransform=Z(),tx.setAttributes=M(),tx.insert=I().bind(null,"head"),tx.domAPI=E(),tx.insertStyleElement=N(),j()(t_.Z,tx),t_.Z&&t_.Z.locals&&t_.Z.locals;var ty=e=>{var{renderTextContentAddonTop:t,message:r,getBotInfo:n,fileAttributeKeys:a,copywriting:o,onCancel:i,onCopy:s,onRetry:c,readonly:d,onImageClick:u,layout:v,showBackground:m,isContentLoading:g}=e,{content_obj:p}=r;if(!eL(p))return null;var f=p.item_list.filter(e=>eR(e)),h=p.item_list.filter(e=>eZ(e)),_=p.item_list.filter(e=>eP(e));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(th,{fileItemList:f,fileAttributeKeys:a,fileCopywriting:o,readonly:d,onRetry:c,onCancel:i,onCopy:s,message:r,layout:v,showBackground:m}),(0,l.jsx)(eV,{imageItemList:_,message:r,onImageClick:u}),(0,l.jsx)(eU,{textItemList:h,renderTextContentAddonTop:t,message:r,showBackground:m,getBotInfo:n,isContentLoading:g})]})};ty.displayName="MultimodalContent";var tb=r("9430"),tS=e=>{var t,{message:r,onImageClick:n}=e,{content_obj:a=ey(r.content)}=r;return em(a)?(0,l.jsx)("div",{className:"chat-uikit-image-content",children:(0,l.jsx)(eH,{data:{image_list:null!==(t=null==a?void 0:a.image_list)&&void 0!==t?t:[]},eventCallbacks:{onImageClick:(e,t)=>{null==n||n({message:r,extra:{url:t.src}})}}})}):null};tS.displayName="ImageContentImpl";var tC=e=>(0,l.jsx)(tb.SV,{fallback:(0,l.jsx)("div",{className:"chat-uikit-image-error-boundary",children:(0,l.jsx)(h.Ee,{src:eb,preview:!1})}),children:(0,l.jsx)(tS,(0,o._)({},e))});tC.displayName="ImageContent";var tj=e=>e&&"file_list"in e,tw=e=>{var{message:t,copywriting:r,fileAttributeKeys:n,readonly:a,onCancel:o,onCopy:i,onRetry:s,layout:c,showBackground:d}=e,{content_obj:u=ey(t.content)}=t;if(!tj(u)||!n||u.file_list.length<=0)return null;var v=()=>{null==o||o({message:t,extra:{}})},g=()=>{null==s||s({message:t,extra:{}})},p=e=>{null==i||i({message:t,extra:{fileIndex:e}})};return(0,l.jsx)(l.Fragment,{children:u.file_list.map((e,t)=>(0,l.jsx)(tf,{file:e,attributeKeys:n,tooltipsCopywriting:null==r?void 0:r.tooltips,readonly:a,onCancel:v,onCopy:()=>p(t),onRetry:g,layout:c,showBackground:d,className:m()({"mb-[8px]":t<u.file_list.length-1})}))})};tw.displayName="FileContent";var tE=e=>void 0===e||e,tk=["answer","question","ack","task_manual_trigger"],tI=e=>{var{message:t,contentConfigs:r,readonly:n,getBotInfo:a,layout:o,showBackground:i,enableAutoSizeImage:s,isCardDisabled:c,isContentLoading:d,enhancedContentConfigList:u}=e,v=tE(null==r?void 0:null===(S=r[_.CE.TEXT])||void 0===S?void 0:S.enable),m=tE(null==r?void 0:null===(C=r[_.CE.IMAGE])||void 0===C?void 0:C.enable),g=null==r?void 0:null===(j=r[_.CE.FILE])||void 0===j?void 0:j.enable,p=null==r?void 0:null===(w=r[_.CE.SIMPLE_FUNCTION])||void 0===w?void 0:w.enable,f=null==u?void 0:u.find(e=>e.rule({contentType:t.content_type,contentConfigs:r,message:t}));if(f)return f.render({message:t,eventCallbacks:e.eventCallbacks,contentConfigs:r,options:{isCardDisabled:c,isContentLoading:d,showBackground:i,readonly:n}});if(t.content_type===U.zc.Text){var{eventCallbacks:h,mdBoxProps:x}=e,{onImageClick:y,onLinkClick:b}=null!=h?h:{};if(tk.includes(t.type)&&v)return"user"===t.role?(0,l.jsx)(eM,{isContentLoading:d,content:t.content,getBotInfo:a,mentioned:t.mention_list.at(0)}):(0,l.jsx)(eu,{message:t,readonly:n,onImageClick:y,onLinkClick:b,enableAutoSizeImage:s,mdBoxProps:x})}if(t.content_type===U.zc.File&&g){var S,C,j,w,E,{copywriting:k,fileAttributeKeys:I}=null!==(E=r[_.CE.FILE])&&void 0!==E?E:{},{eventCallbacks:T}=e,{onCancelUpload:M,onCopyUpload:A,onRetryUpload:N}=null!=T?T:{};return(0,l.jsx)(tw,{message:t,copywriting:k,fileAttributeKeys:I,readonly:n,onCancel:M,onCopy:A,onRetry:N,layout:o,showBackground:i})}if(t.content_type===U.zc.Image&&m){var{eventCallbacks:L}=e,{onImageClick:Z}=null!=L?L:{};if(!em(t.content_obj))return null;var G=s?ef:ew;return t.content_obj.image_list.length>1?(0,l.jsx)(tC,{message:t,onImageClick:Z}):(0,l.jsx)(G,{message:t,onImageClick:Z})}if("function_call"===t.type&&p){var P,{copywriting:B}=null!==(P=r[_.CE.SIMPLE_FUNCTION])&&void 0!==P?P:{};return(0,l.jsx)(ek,{message:t,copywriting:B})}if(t.content_type===U.zc.Mix&&g&&m&&v){var R,{copywriting:D,fileAttributeKeys:F}=null!==(R=r[_.CE.FILE])&&void 0!==R?R:{},{eventCallbacks:O}=e,{onCancelUpload:z,onCopyUpload:W,onRetryUpload:H,onImageClick:K}=null!=O?O:{};return(0,l.jsx)(ty,{isContentLoading:d,renderTextContentAddonTop:e.multimodalTextContentAddonTop,message:t,getBotInfo:a,fileAttributeKeys:F,copywriting:D,readonly:n,onCancel:z,onCopy:W,onRetry:H,onImageClick:K,layout:o,showBackground:i})}return(0,l.jsxs)("span",{children:["Not Support ",t.content_type," Content"]})};tI.displayName="UIKitContentBox";var tT=r("966140"),tM=r("906092"),tA=r("871482"),tN=r("297158"),tL=e=>{var{userLabel:t}=e;return(null==t?void 0:t.icon_url)&&(null==t?void 0:t.label_name)?(0,l.jsx)(eq,{content:t.label_name,theme:"light",children:(0,l.jsx)("div",{className:m()("flex-[0_0_auto] flex items-center h-[20px] ml-[4px]",(null==t?void 0:t.jump_link)&&"cursor-pointer"),onClick:e=>{(null==t?void 0:t.jump_link)&&(null==e||e.preventDefault(),null==e||e.stopPropagation(),window.open(null==t?void 0:t.jump_link,"_blank"))},children:(0,l.jsx)("img",{src:t.icon_url,width:14,height:14})})}):null},tZ=e=>{var{userUniqueName:t,className:r,showBackground:n}=e;return t?(0,l.jsxs)("div",{className:m()("coz-fg-secondary text-[12px] leading-[16px] font-normal ml-[4px]",n&&"!coz-fg-images-secondary",r),children:["@",t]}):null},tG=r("479886"),tP=r.n(tG),tB=e=>{if(e<1)return"";var t=Date.now(),r=tP()(t),n=tP()(e);return r.year()!==n.year()?n.format("YYYY-MM-DD HH:mm"):r.month()!==n.month()||r.date()!==n.date()?n.format("MM-DD HH:mm"):n.format("HH:mm")},tR=e=>{var{contentTime:t,className:r,showBackground:n}=e;return t?(0,l.jsx)("span",{className:m()("text-[12px] leading-[16px] ml-[8px] font-normal","chat-uikit-message-box-container__message-content-time",{"coz-fg-images-secondary":n,"coz-fg-secondary":!n},r),children:tB(t)}):null};tR.displayName="MessageContentTime";var tD=r("998600"),tF=e=>{var{messageId:t,cardContainerRef:r,onResize:n}=e,a=(0,_.nE)(),o=(0,tD.Z)(e=>{var t=e();null==t||t.disconnect()},{wait:3e4});(0,c.useEffect)(()=>{if(!!a){var e=null,i=a=>{var{messageId:i}=a;if(!!r.current&&i===t)(e=new ResizeObserver(()=>{o.run(()=>e),n()})).observe(r.current)};return a.on(_.do.AFTER_CARD_RENDER,i),()=>{a.off(_.do.AFTER_CARD_RENDER,i),null==e||e.disconnect()}}},[])},tU=(0,c.createContext)({}),tO=tU.Provider,tz=()=>(0,c.useContext)(tU).uiKitCustomComponents||{},tW=r("207914"),tH=(0,eD.j)(["flex","flex-row","my-0"],{variants:{isMobileLayout:{true:["mx-[12px]"],false:["mx-[24px]"]}}}),tK=(0,eD.j)(["text-base","font-normal","leading-[16px]","break-words","flex-shrink-0","!max-w-[400px]"],{variants:{showBackground:{true:["coz-fg-images-user-name"],false:["coz-fg-secondary"]}}}),tV=e=>{var{theme:t}=e;return"primary"===t||"whiteness"===t||"grey"===t?{color:t,border:null,tight:!1}:"colorful"===t?{color:"primary",border:null,tight:!1}:"border"===t?{color:"whiteness",border:"primary",tight:!0}:"color-border"===t?{color:"whiteness",border:"highlight",tight:!1}:"color-border-card"===t?{color:"whiteness",border:"highlight",tight:!0}:"none"===t?{tight:!0,color:null,border:null}:((0,K.Sn)(t),{tight:!1,color:null,border:null})},tq=r("336205"),tY=e=>{var{error:t}=e,{onError:r}=J(),n=(0,c.useRef)(!1);return(0,c.useEffect)(()=>{if(!!r&&!!t&&!n.current)r(t),n.current=!0},[r,t]),(0,l.jsx)("div",{className:"p-[12px]",children:(0,l.jsx)("span",{className:"text-[14px] font-medium text-[#222222]",children:tq.o.t("message_content_error")})})},tX=e=>{var{children:t}=e;return(0,l.jsx)(l.Fragment,{children:t})},tJ=r("264869"),tQ={};tQ.styleTagTransform=Z(),tQ.setAttributes=M(),tQ.insert=I().bind(null,"head"),tQ.domAPI=E(),tQ.insertStyleElement=N(),j()(tJ.Z,tQ),tJ.Z&&tJ.Z.locals&&tJ.Z.locals;var t$=e=>{var{children:t,theme:r,nickname:n,avatar:a,showUserInfo:i,renderFooter:s,hoverContent:d,right:u,senderId:v,classname:g,messageBubbleClassname:f,messageBubbleWrapperClassname:x,messageBoxWrapperClassname:y,messageHoverWrapperClassName:b,messageErrorWrapperClassname:S,isHoverShowUserInfo:C=!0,layout:j,contentTime:w,showBackground:E,extendedUserInfo:k,topRightSlot:I,imageAutoSizeContainerWidth:T,enableImageAutoSize:M,messageId:A,eventCallbacks:N,onError:L}=e,{userLabel:Z,userUniqueName:G}=null!=k?k:{},[P,B]=(0,c.useState)(a||tW),{MentionOperateTool:R=()=>null,AvatarWrap:D=tX}=tz(),F=(0,c.useRef)(null),U=(0,c.useRef)(null),O=(0,c.useRef)(null),z=(0,_.nE)(),W=j===_.Ar.MOBILE,H=(0,tA.$0)(()=>{if(!U.current||!O.current)return;var e="".concat(U.current.offsetWidth,"px");if(O.current.style.width!==e)O.current.style.width=e});(0,p.Z)(()=>{B(a||tW)},[a]),tF({messageId:A,cardContainerRef:U,onResize:H}),(0,c.useEffect)(()=>{if(!!z)return z.on(_.do.WINDOW_RESIZE,H),()=>{z.off(_.do.WINDOW_RESIZE,H)}},[]);var K=(0,tT.Z)(()=>F.current),[V,q]=(0,c.useState)(!1);return(0,tM.Z)(()=>{q(!1)},F),(0,l.jsx)(X,{value:{layout:j,imageAutoSizeContainerWidth:T,enableImageAutoSize:M,eventCallbacks:N,onError:L},children:(0,l.jsx)("div",{className:m()("max-w-full",g),ref:F,onClick:()=>{W&&q(!0)},children:(0,l.jsxs)("div",{className:m()(tH({isMobileLayout:W}),y),children:[(0,l.jsx)("div",{className:"mr-[12px] w-32px h-32px",children:i?(0,l.jsx)(D,{children:(0,l.jsx)(h.qE,{size:"small",src:P,onError:()=>B(tW)})}):null}),(0,l.jsx)("div",{className:"flex-1 max-w-[calc(100%-44px)]",children:(0,l.jsxs)("div",{className:"relative flex flex-col w-fit max-w-full",children:[i&&n?(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(h.ZT.Text,{ellipsis:{showTooltip:{opts:{content:n}}},className:tK({showBackground:!!E}),children:n}),(0,l.jsx)(tL,{userLabel:Z}),(0,l.jsxs)("div",{className:"flex shrink w-full h-[20px]",children:[K&&C?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tZ,{userUniqueName:G,showBackground:E}),(0,l.jsx)(R,{senderId:v}),(0,l.jsx)(tR,{contentTime:w,showBackground:!!E,className:"flex-shrink-0"})]}):null,(0,l.jsx)("div",{className:"flex gap-x-[8px] ml-auto",children:I})]})]}):null,(0,l.jsxs)("div",{ref:U,className:m()(x,"select-text relative flex flex-row w-fit max-w-full"),children:[(0,l.jsx)("div",{className:m()(f,eF((0,o._)({showBackground:!!E},tV({theme:r}))),j===_.Ar.MOBILE?"!text-[16px]":""),children:(0,l.jsx)(tN.SV,{errorBoundaryName:"chat-message-box-children",FallbackComponent:tY,children:t})}),(0,l.jsx)("div",{className:m()("absolute right-0 bottom-[1px]",S),children:u}),K||V?(0,l.jsx)("div",{className:m()("absolute right-[-12px] bottom-[-20px]",b),children:d}):null]}),(0,l.jsx)("div",{ref:O,className:"overflow-visible",children:null==s?void 0:s(H)})]})})]})})})};t$.displayName="UIKitMessageBoxWrap";var t0=e=>{var{theme:t="none",renderFooter:r,hoverContent:n,senderInfo:a,showUserInfo:o,right:i,classname:s,messageBubbleClassname:c,messageBubbleWrapperClassname:d,messageBoxWrapperClassname:u,messageHoverWrapperClassName:v,messageErrorWrapperClassname:m,isHoverShowUserInfo:g,layout:p=_.Ar.PC,showBackground:f=!1,topRightSlot:h,imageAutoSizeContainerWidth:x,enableImageAutoSize:y,messageId:b,eventCallbacks:S,onError:C}=null!=e?e:{},{url:j,nickname:w,id:E,userLabel:k,userUniqueName:I}=null!=a?a:{};return(0,l.jsx)(t$,{messageId:b,theme:t,avatar:j,nickname:w,showUserInfo:o,renderFooter:r,hoverContent:n,right:i,senderId:E||"",classname:s,messageBubbleWrapperClassname:d,messageBubbleClassname:c,messageBoxWrapperClassname:u,messageHoverWrapperClassName:v,messageErrorWrapperClassname:m,isHoverShowUserInfo:g,layout:p,contentTime:t1(e),showBackground:f,extendedUserInfo:{userLabel:k,userUniqueName:I},topRightSlot:h,imageAutoSizeContainerWidth:x,enableImageAutoSize:y,eventCallbacks:S,onError:C,children:t2(e)})},t1=e=>{if("message"in e)return Number(e.message.content_time)},t2=e=>{if("children"in e)return e.children;var{message:t,contentConfigs:r,eventCallbacks:n,getBotInfo:a,layout:o=_.Ar.PC,showBackground:i=!1,isContentLoading:s,isCardDisabled:c}=e;return(0,l.jsx)(tI,{message:t,contentConfigs:r,eventCallbacks:n,getBotInfo:a,layout:o,showBackground:i,isContentLoading:s,isCardDisabled:c})};t0.displayName="UIKitMessageBox";var t5=r("894415"),t4={};t4.styleTagTransform=Z(),t4.setAttributes=M(),t4.insert=I().bind(null,"head"),t4.domAPI=E(),t4.insertStyleElement=N(),j()(t5.Z,t4);var t7=t5.Z&&t5.Z.locals?t5.Z.locals:void 0,t8=(0,c.forwardRef)((e,t)=>{var{className:r,showBackground:n}=e,a=(0,s._)(e,["className","showBackground"]);return(0,l.jsx)(h.hU,(0,o._)({ref:t,className:m()(r,n?["!coz-bg-image-bots",t7["outlined-icon-button-background"]]:t7["outlined-icon-button"],t7["base-outlined-icon-button"])},a))}),t6=r("444479"),t9=r("803901"),t3="ontouchstart"in window,re=e=>"TouchEvent"in window&&e instanceof TouchEvent,rt=e=>{if(re(e)){var t,r,n,a;return{clientX:null!==(n=null===(t=e.touches[0])||void 0===t?void 0:t.clientX)&&void 0!==n?n:0,clientY:null!==(a=null===(r=e.touches[0])||void 0===r?void 0:r.clientY)&&void 0!==a?a:0}}return e},rr=e=>{var{target:t,events:r,options:n={}}=e,{onStart:a,onEnd:o,onMoveEnter:i,onMoveLeave:s}=r,{shortcutKey:l=()=>!1,getIsShortcutKeyDisabled:d,enabled:u=!0,getActiveZoneTarget:v}=n,m=(0,t6.Z)(a),g=(0,t6.Z)(o),p=(0,t6.Z)(i),f=(0,t6.Z)(s),h=(0,c.useRef)(!1),_=(0,c.useRef)(!1),x=(0,c.useRef)(!1),y=e=>{var t;if(!!u&&!!h.current)h.current=!1,null===(t=g.current)||void 0===t||t.call(g,e)},b=(0,tA.$0)(e=>{e.preventDefault();var r,n,a=(null==v?void 0:v())||t.current;if(!!_.current&&!!a){var{clientX:o,clientY:i}=rt(e),s=a.getBoundingClientRect(),l=o<s.left||o>s.right||i<s.top||i>s.bottom;l&&!x.current&&(x.current=!0,null===(r=f.current)||void 0===r||r.call(f)),!l&&x.current&&(x.current=!1,null===(n=p.current)||void 0===n||n.call(p))}}),S=(0,tA.$0)(e=>{var t;if(x.current=!1,!_.current)_.current=!0,re(e)?(e.preventDefault(),document.addEventListener("touchmove",b)):document.addEventListener("mousemove",b),null===(t=m.current)||void 0===t||t.call(m,e)}),C=(0,tA.$0)(e=>{var t;if(!!_.current)document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b),_.current=!1,null===(t=g.current)||void 0===t||t.call(g,e)});(0,t9.Z)(l,e=>{var t;if(!u)return;if(null==d?void 0:d())return y(e);if(!h.current)h.current=!0,null===(t=m.current)||void 0===t||t.call(m,e)},{exactMatch:!0,events:["keydown"]}),(0,t9.Z)(l,y,{exactMatch:!1,events:["keyup"]}),(0,c.useEffect)(()=>{var e=()=>{y(void 0)};return window.addEventListener("blur",e),()=>{window.removeEventListener("blur",e)}},[]),(0,c.useEffect)(()=>{var e=t.current;if(!!e&&!!u)return t3?(e.addEventListener("touchstart",S),e.addEventListener("touchend",C)):(e.addEventListener("mousedown",S),document.addEventListener("mouseup",C)),()=>{t3?(e.removeEventListener("touchstart",S),e.removeEventListener("touchend",C)):(e.removeEventListener("mousedown",S),document.removeEventListener("mouseup",C))}}),(0,c.useEffect)(()=>()=>{document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b)},[])},rn=e=>e$.Co.find(t=>{var r;return(null===(r=t.judge)||void 0===r?void 0:r.call(t,e))||t.accept.some(t=>e.name.endsWith(t))}),ra=e=>{var{copywritingConfig:t={},maxFileSize:r=_.CN,children:n,onUpload:a,isDisabled:o,isFileCountExceedsLimit:i,limitFileCount:s=1}=e;return(0,l.jsx)(h.gq,{limit:1===s?1:void 0,draggable:!1,action:"",fileList:[],onFileChange:e=>{var n,{fileSizeReachLimitToast:o,fileExceedsLimitToast:s,fileEmptyToast:l}=t;if(i(e.length)){h.FN.warning({showClose:!1,content:s});return}if(!!e.length){var c=e.some(e=>e.size>r),d=e.some(e=>e.size<=0);for(var u of(c&&h.FN.warning({showClose:!1,content:o}),d&&h.FN.warning({showClose:!1,content:l}),e.filter(e=>e.size<=r&&e.size>0).map(e=>({file:e,fileTypeConfig:rn(e)}))))(null===(n=u.fileTypeConfig)||void 0===n?void 0:n.fileType)===e$.Wz.IMAGE?null==a||a(_.AJ.IMAGE,u.file):null==a||a(_.AJ.FILE,u.file)}},disabled:o,multiple:s>1,uploadTrigger:"custom",children:n})};ra.displayName="UiKitChatUpload";var ro=e=>{var{onSubmit:t,defaultValue:r="",allowEmpty:n=!1,onBeforeSubmit:a,isDisabled:o=!1,inputNativeCallbacks:i={}}=e,[s,l]=(0,c.useState)(r),d=(0,c.useRef)(!1),u=(0,c.useRef)(null),v=(0,c.useRef)({start:0,end:0}),m=()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.resizableTextArea.textArea},g=(0,tA.xD)(()=>h()),p=(0,c.useRef)();p.current=()=>({inputText:s,isComposing:d.current,isDisabled:o,selection:v.current,hasSelection:v.current.start!==v.current.end}),(0,c.useEffect)(()=>{if(!!i.getController)i.getController({requireSetMousePosition:f,readState:()=>p.current(),setInputText:e=>{l(e),g()},focus:()=>{var e;null===(e=m())||void 0===e||e.focus()}})},[i.getController]);var f=(0,tA.xD)(e=>{var t=m();if(!!t)t.focus(),t.setSelectionRange(e,e)}),h=()=>{var e=m();if(!!e){var t=e.selectionStart,r=e.selectionEnd;v.current={start:t,end:r}}},_=()=>{if((!!n||!!s.trim())&&!o&&(!a||!!a()))t(s),l("")},x=e=>{if(!("Enter"!==e.code||d.current||ri(e)))e.preventDefault(),_()},y=()=>{var e=m();if(!!e){var t=e.selectionStart;l("".concat(s.substring(0,t),"\n").concat(s.substring(t))),setTimeout(()=>{e.selectionStart=t+1,e.selectionEnd=t+1},0)}};return{onChange:e=>{h(),l(e.target.value),Promise.resolve().then(()=>{var e;null==i||null===(e=i.onAfterOnChange)||void 0===e||e.call(i)})},setIsComposing:(e,t)=>{d.current=t},submit:_,onKeyDown:e=>{h();var t,r=null===(t=i.onBeforeProcessKeyDown)||void 0===t?void 0:t.call(i,e);if(null==r?!void 0:!r.exit){if((e.metaKey||e.altKey||e.ctrlKey)&&"Enter"===e.code){y();return}x(e)}},inputText:s,setInputText:l,rcTextareaRef:u,updateSelectPos:h,onKeyUp:e=>{var t;h(),null===(t=i.onAfterProcessKeyUp)||void 0===t||t.call(i,e)}}},ri=e=>"Enter"===e.code&&(e.shiftKey||e.altKey||e.metaKey),rs=e=>{var{isDisabled:t,tooltipContent:r,onClick:n,layout:a}=e;return(0,l.jsx)(eq,{content:r,hideToolTip:a===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{className:m()("!rounded-full",!t&&"!coz-fg-hglt"),disabled:t,"data-testid":"bot-home-chart-send-button",size:"default",color:"secondary",icon:(0,l.jsx)(f.PdF,{className:"text-18px"}),onClick:n})})},rl=e=>{var{isDisabled:t,tooltipContent:r,layout:n}=e;return(0,l.jsx)(eq,{disableFocusListener:!0,content:r,hideToolTip:n===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{className:"!rounded-full","data-testid":"chat-area.chat-upload-button",color:"secondary",disabled:t,icon:(0,l.jsx)(f._M$,{className:m()(t?"coz-fg-dim":"coz-fg-primary","text-18px")})})})},rc=e=>{var{isDisabled:t,tooltipContent:r,onClick:n,layout:a,className:o,showBackground:i}=e;return(0,l.jsx)(eq,{content:r,hideToolTip:a===_.Ar.MOBILE,children:(0,l.jsx)(t8,{"data-testid":"bot-edit-debug-chat-clear-button",showBackground:i,disabled:t,icon:(0,l.jsx)(f.bGR,{className:"text-18px"}),size:"default",onClick:n,className:m()("mr-12px","!rounded-full",o)})})},rd=e=>{var{isDisabled:t,tooltipContent:r,onClick:n,layout:a,className:o,showBackground:i}=e;return(0,l.jsx)(eq,{content:r,hideToolTip:a===_.Ar.MOBILE,children:(0,l.jsx)(t8,{"data-testid":"chat-input-clear-context-button",showBackground:i,disabled:t,icon:(0,l.jsx)(f.zd$,{className:"text-18px"}),size:"default",onClick:n,className:m()("mr-12px","!rounded-full",o)})})},ru=r("670988"),rv={};rv.styleTagTransform=Z(),rv.setAttributes=M(),rv.insert=I().bind(null,"head"),rv.domAPI=E(),rv.insertStyleElement=N(),j()(ru.Z,rv);var rm=ru.Z&&ru.Z.locals?ru.Z.locals:void 0,rg=(0,c.forwardRef)((e,t)=>{var r,{onBeforeSubmit:n,onFocus:a,onBlur:v,isReadonly:x,leftActions:y,rightActions:b,addonTop:S,addonLeft:C,aboveOutside:j,buildInButtonConfig:w,buildInButtonStatus:E,copywritingConfig:k,onSendMessage:I,onClearHistory:T,onClearContext:M,onUpload:A,onInputClick:N,hasOtherContentToSend:L,layout:Z,isFileCountExceedsLimit:G,inputTooltip:P,showBackground:B,limitFileCount:R,onPaste:D,CustomSendButton:U,isInputReadonly:O,inputNativeCallbacks:z,audioRecordEvents:W={},audioRecordState:H={},audioRecordOptions:K,className:V,wrapperClassName:q}=e,Y=(0,s._)(e,["onBeforeSubmit","onFocus","onBlur","isReadonly","leftActions","rightActions","addonTop","addonLeft","aboveOutside","buildInButtonConfig","buildInButtonStatus","copywritingConfig","onSendMessage","onClearHistory","onClearContext","onUpload","onInputClick","hasOtherContentToSend","layout","isFileCountExceedsLimit","inputTooltip","showBackground","limitFileCount","onPaste","CustomSendButton","isInputReadonly","inputNativeCallbacks","audioRecordEvents","audioRecordState","audioRecordOptions","className","wrapperClassName"]),{isSendButtonVisible:X=!0,isClearHistoryButtonVisible:J=!0,isMoreButtonVisible:Q=!0,isClearContextButtonVisible:$=!1}=null!=w?w:{},{isClearHistoryButtonDisabled:ee,isMoreButtonDisabled:et,isSendButtonDisabled:er,isClearContextButtonDisabled:en}=null!=E?E:{},{tooltip:ea,inputPlaceholder:eo,uploadConfig:ei,bottomTips:es}=null!=k?k:{},{sendButtonTooltipContent:el,clearHistoryButtonTooltipContent:ec,clearContextButtonTooltipContent:ed,moreButtonTooltipContent:eu,audioButtonTooltipContent:ev,keyboardButtonTooltipContent:em}=null!=ea?ea:{},[eg,ep]=(0,c.useState)(!1),[ef,eh]=(0,c.useState)(0),[e_,ex]=(0,c.useState)(!1),[ey,eb]=(0,g.Z)(Y,{defaultValue:"input",valuePropName:"inputMode",trigger:"onInputModeChange"}),eS=(0,c.useRef)(null);rr({target:eS,events:W,options:(0,u.Z)({},K,{enabled:"audio"===ey&&(null==K?void 0:K.enabled)})});var eC=(0,c.useRef)(null),[ej,ew]=(0,c.useState)("100%");(0,c.useEffect)(()=>{var e=eC.current;if(!!e){var t=new ResizeObserver(()=>{ew(e.clientWidth)});return t.observe(e),()=>{t.disconnect()}}},[]);var eE="input"===ey,ek="audio"===ey,{onChange:eI,setIsComposing:eT,onKeyDown:eM,inputText:eA,setInputText:eN,submit:eL,rcTextareaRef:eZ,updateSelectPos:eG,onKeyUp:eP}=ro({onSubmit:e=>{null==I||I({text:e,mentionList:[]}),ep(!1),eh(0)},onBeforeSubmit:n,isDisabled:er,allowEmpty:L,inputNativeCallbacks:z}),eB=B?"!coz-fg-images-white":"",eR=ee||x,eD=!(null==eA?void 0:eA.trim())&&!L||er||x,eF=et||x,eU=en||x;(0,p.Z)(()=>{var e;if("input"===ey)null===(e=eZ.current)||void 0===e||e.focus()},[ey]),(0,c.useImperativeHandle)(t,()=>({input:eZ,setValue:eN,sendMessage:I}));var eO=null!=U?U:rs;return(0,l.jsxs)("div",{className:rm["input-container"],children:[(0,l.jsxs)("div",{className:m()(rm["input-wrap"],"py-0",Z===_.Ar.MOBILE?"px-[16px]":"px-[24px]","input-wraper-for-reset"),children:[j,(0,l.jsxs)("div",{className:m()(rm["left-actions-container"],["mb-8px"],"boolean"==typeof H.isRecording&&H.isRecording?[rm["animate-left"],"!w-0"]:rm["animate-left-revert"]),children:[y,$?(0,l.jsx)(rd,{showBackground:!!B,tooltipContent:ed,isDisabled:eU,onClick:()=>{null==M||M()},"data-testid":"bot-edit-debug-chat-clear-button",layout:Z,className:eB}):null,J?(0,l.jsx)(rc,{showBackground:!!B,tooltipContent:ec,isDisabled:eR,onClick:()=>{null==T||T()},"data-testid":"bot-edit-debug-chat-clear-button",layout:Z,className:eB}):null]}),(0,l.jsx)("div",{ref:eC,className:"flex-[1] flex justify-end overflow-hidden",children:(0,l.jsxs)("div",{style:{width:ej},className:m()(rm["textarea-with-top-rows"],["coz-bg-max","coz-stroke-plus","relative"],e_&&rm["input-focus"],(e_||H.isRecording)&&["!coz-stroke-hglt"],H.isRecording&&H.isPointerMoveOut&&"!coz-stroke-hglt-red",H.isRecording?"overflow-visible":"overflow-hidden","audio"===ey&&"cursor-pointer",("audio"===ey||H.isRecording)&&"hover:coz-stroke-hglt",B&&rm["background-theme"],{"!coz-bg-image-bots":B},Z===_.Ar.MOBILE&&H.isRecording&&(H.isPointerMoveOut?rm["mobile-audio-bg-danger"]:rm["mobile-audio-bg"]),q),children:[S,(0,l.jsxs)("div",{className:m()(rm["textarea-with-actions-container"],rm["coz-textarea-with-actions-container-padding"],"py-8px","pr-8px","pl-20px",{[rm["textarea-with-actions-container__row"]]:!eg,[rm["textarea-with-actions-container__col"]]:eg}),children:[P?(0,l.jsx)(P,{children:(0,l.jsx)("i",{className:rm["input-tooltip-anchor"]})}):null,C,eE?(0,l.jsx)(d.Z,{"data-testid":"bot.ide.chat_area.chat_input.textarea",disabled:O||x,className:m()(rm.textarea,["coz-fg-primary","coz-bg-max","disabled:coz-bg-max","placeholder:coz-fg-dim"],{[rm["textarea--with-margin"]]:eg}),autoSize:{minRows:1,maxRows:5},classNames:{textarea:m()(rm.textarea,Z===_.Ar.MOBILE?"text-[16px]":"text-[14px]")},ref:eZ,placeholder:eo,onChange:e=>{eI(e),eg&&e.target.value.length<ef&&ep(!1)},value:eA,onCompositionStart:e=>eT(e,!0),onCompositionEnd:e=>eT(e,!1),onKeyDown:eM,onKeyUp:eP,onResize:e=>{var t,{height:r}=e;!eg&&r>24&&(null==eA?void 0:null===(t=eA.trim())||void 0===t?void 0:t.length)!==0&&(ep(!0),eh(eA.length))},onSelect:eG,onClick:N,onFocus:e=>{null==a||a(e),ex(!0)},onBlur:e=>{null==v||v(e),ex(!1)},onPaste:D}):null,ek?(0,l.jsx)(F,(0,i._)((0,o._)({ref:eS},H),{layout:Z})):null,(0,l.jsxs)("div",{className:m()(H.isRecording?"opacity-0 w-0":"opacity-100",rm["textarea-actions-container"],rm["textarea-actions-container-transition"]),children:[(0,l.jsxs)("div",{className:rm["textarea-actions-right"],children:[(r=X&&eE,(null==K?void 0:K.enabled)?r&&eA:r)?(0,l.jsx)(eO,{tooltipContent:el,isDisabled:eD,onClick:eL,layout:Z}):null,!eA&&!ek&&(null==K?void 0:K.enabled)?(0,l.jsx)(eq,{content:ev,hideToolTip:Z===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{className:"!rounded-full",color:"secondary",icon:(0,l.jsx)(f.R3$,{className:"text-18px"}),onClick:()=>{eb("audio")}})}):null,ek?(0,l.jsx)(eq,{content:em,hideToolTip:Z===_.Ar.MOBILE,children:(0,l.jsx)(h.hU,{className:"!rounded-full",color:"secondary",icon:(0,l.jsx)(f.W9T,{className:"text-18px"}),onClick:()=>{eb("input")}})}):null]}),b||Q?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.iz,{layout:"vertical",style:{height:"14px"}}),(0,l.jsxs)("div",{className:rm["textarea-actions-left"],children:[b,Q?(0,l.jsx)(ra,{onUpload:(e,t)=>null==A?void 0:A(e,{file:t,mentionList:[]}),isFileCountExceedsLimit:G,copywritingConfig:ei,isDisabled:eF,limitFileCount:R,children:(0,l.jsx)(rl,{tooltipContent:eu,isDisabled:eF,layout:Z})}):null]})]}):null]})]})]})})]}),es?(0,l.jsx)("div",{className:m()(rm["bottom-tips"],"coz-fg-dim",B&&"!coz-fg-images-secondary"),children:(0,l.jsx)("span",{children:es})}):null]})});rg.displayName="UiKitChatInput";var rp=(0,eD.j)(["w-fit","border-[1px]","border-solid","rounded-normal","coz-fg-primary","py-6px","px-16px","flex","items-center","justify-center","mb-8px","max-w-full","text-[14px]","font-normal","leading-[20px]","break-words"],{variants:{showBackground:{true:["coz-bg-image-question","coz-stroke-image-bots"],false:["coz-stroke-plus"]},color:{white:[],grey:[]},readonly:{true:["cursor-default"],false:["cursor-pointer"]}},compoundVariants:[{showBackground:!1,color:"white",className:[]},{showBackground:!1,color:"grey",className:["bg-[var(--coz-mg-secondary)]"]},{readonly:!1,showBackground:!1,className:["hover:bg-[var(--coz-mg-secondary-hovered)]","active:bg-[var(--coz-mg-secondary-pressed)]"]},{readonly:!1,showBackground:!0,className:["chat-uikit-suggestion-item-background-mg"]}]}),rf=r("34238"),rh={};rh.styleTagTransform=Z(),rh.setAttributes=M(),rh.insert=I().bind(null,"head"),rh.domAPI=E(),rh.insertStyleElement=N(),j()(rf.Z,rh),rf.Z&&rf.Z.locals&&rf.Z.locals;var r_=e=>{var{content:t,message:r,readonly:n,onSuggestionClick:a,showBackground:o,className:i,color:s}=e,{content_obj:c=t}=null!=r?r:{};return el(c)?(0,l.jsx)("div",{className:m()(i,"!bg-[235, 235, 235, 0.75]",rp({showBackground:!!o,readonly:!!n,color:null!=s?s:"white"})),onClick:()=>{if(!n){var e=null==r?void 0:r.sender_id;null==a||a({text:c,mentionList:e?[{id:e}]:[]})}},children:(0,l.jsx)("span",{className:"w-full",children:c})}):null};r_.displayName="SuggestionItem";var rx="NO_MESSAGE_ID",ry=r("970544"),rb=(0,eD.j)(["leading-[28px]","font-medium","text-20px"],{variants:{showBackground:{true:["coz-fg-images-user-name"],false:["coz-fg-plus"]}}}),rS=r("472606"),rC={};rC.styleTagTransform=Z(),rC.setAttributes=M(),rC.insert=I().bind(null,"head"),rC.domAPI=E(),rC.insertStyleElement=N(),j()(rS.Z,rC),rS.Z&&rS.Z.locals&&rS.Z.locals;var rj=e=>{var{avatar:t,wrapperClassName:r,onError:n,name:a,showBackground:o}=e;return(0,l.jsxs)("div",{className:r,children:[(0,l.jsx)(h.qE,{className:m()("h-[64px] w-[64px]","rounded-[16px]"),src:t,shape:"square",onError:n}),a?(0,l.jsx)(h.ZT.Text,{ellipsis:!0,className:rb({showBackground:!!o}),children:a}):null]})},rw=(0,c.forwardRef)((e,t)=>{var{avatar:r,name:n,prologue:a,suggestionList:i,readonly:s,suggestionListWithString:d,onSuggestionClick:u,className:v,prologueClassName:g,mdBoxProps:f,style:h,showBackground:x,layout:y,enableAutoSizeImage:b,imageAutoSizeContainerWidth:S,eventCallbacks:C,suggestionsWrap:j=!1,suggestionsWithStringWrap:w=!1,suggestionItemColor:E}=e,[k,I]=(0,c.useState)(r||ry),T=i||d,M=!a&&!(null==T?void 0:T.length);return(0,p.Z)(()=>{I(r||ry)},[r]),(0,l.jsx)(V.Provider,{value:{imageAutoSizeContainerWidth:S,eventCallbacks:C},children:(0,l.jsxs)("div",{ref:t,className:m()("chat-uikit-on-boarding",v,{"chat-uikit-on-boarding-pc":y===_.Ar.PC}),style:h,children:[(0,l.jsx)(rj,{wrapperClassName:m()("chat-uikit-on-boarding__bot",!M&&"chat-uikit-on-boarding__bot__with__onboarding"),avatar:k,name:n,showBackground:x,onError:()=>I(ry)}),(0,l.jsxs)("div",{className:m()("chat-uikit-on-boarding__prologue-sug"),children:[a?(0,l.jsx)("div",{className:m()(["py-12px","px-16px",y===_.Ar.MOBILE?"text-[16px]":"text-lg","leading-[20px]","rounded-normal","bg-[var(--coz-mg-primary)]"],"chat-uikit-on-boarding__prologue",g,{"!coz-bg-image-bots !coz-stroke-image-bots":x}),"data-grab-mark":rx,children:(0,l.jsx)(O.HK,(0,o._)({markDown:a,autoFixSyntax:{autoFixEnding:!1},slots:{Image:b?rE:void 0,Link:et}},f))}):null,!!(null==i?void 0:i.length)&&(0,l.jsx)("div",{className:m()("chat-uikit-on-boarding__suggestions","mt-8px",{"flex-wrap !flex-row gap-2":j}),children:null==i?void 0:i.map((e,t)=>(0,l.jsx)(r_,{className:m()({"!mb-0":j}),message:e,readonly:s,onSuggestionClick:e=>{var{text:t}=e;return null==u?void 0:u(t)},showBackground:x,color:E},t))}),!!(null==d?void 0:d.length)&&(0,l.jsx)("div",{className:m()("chat-uikit-on-boarding__suggestions","mt-8px",{"flex-wrap !flex-row gap-2":w}),children:null==d?void 0:d.map((e,t)=>(0,l.jsx)(r_,{className:m()({"!mb-0":w}),content:e,readonly:s,onSuggestionClick:e=>{var{text:t}=e;return null==u?void 0:u(t)},showBackground:x,color:E},t))})]})]})})}),rE=e=>{var{imageAutoSizeContainerWidth:t}=(0,c.useContext)(V);return(0,l.jsx)(ei,(0,i._)((0,o._)({},e),{imageAutoSizeContainerWidth:t}))};rE.displayName="CozeImageWithSizeProps";var rk=e=>{var{content:t,onClick:r,className:n}=e;return(0,l.jsx)(h.zx,{color:"secondary",onClick:r,className:m()("coz-stroke-primary","coz-fg-primary","border-[1px]","border-solid","coz-shadow-default",n),icon:(0,l.jsx)(f.noE,{}),children:t})};rk.displayName="StopRespondButton";var rI=(0,eD.j)(["h-[44px]","w-fit","flex","justify-center","items-center","py-12px","px-16px","rounded-normal"],{variants:{backgroundColor:{whiteness:["bg-[var(--coz-mg-card)]"],grey:["bg-[var(--coz-mg-primary)]"],primary:["bg-[var(coz-mg-hglt-plus)]"],withBackground:["coz-bg-image-bots","coz-stroke-image-bots"],none:["coz-stroke-primary"]}}}),rT=r("380784"),rM={};rM.styleTagTransform=Z(),rM.setAttributes=M(),rM.insert=I().bind(null,"head"),rM.domAPI=E(),rM.insertStyleElement=N(),j()(rT.Z,rM),rT.Z&&rT.Z.locals&&rT.Z.locals;var rA=e=>{var{theme:t,showBackground:r}=e;return r?{backgroundColor:"withBackground"}:t?{backgroundColor:t}:{backgroundColor:null}},rN=e=>{var{className:t,theme:r="none",showBackground:n}=e;return(0,l.jsx)("div",{className:m()(rI(rA({showBackground:!!n,theme:r})),t),children:(0,l.jsx)("div",{className:"chat-uikit-coz-thinking-placeholder"})})},rL={pc:{size:{width:486,height:346},centerWidth:346},mobile:{size:{width:248,height:346},centerWidth:206}},rZ=e=>rL[e].size.width/rL[e].size.height,rG=(e,t,r)=>e>t*(1-(r>0?r:0)*2),rP=r("416290"),rB=e=>{var{backgroundInfo:t}=e,r=(0,c.useRef)(null),n=(0,rP.Z)(r),{width:a=0,height:o=0}=null!=n?n:{},i=a/o<=rZ("mobile"),s=null==t?void 0:t.mobile_background_image,l=null==t?void 0:t.web_background_image,d=i?s:l,{theme_color:u}=null!=d?d:{},{size:v}=rL[i?"mobile":"pc"];return{targetRef:r,currentBackgroundInfo:d,targetWidth:a,targetHeight:o,currentThemeColor:u,cropperSize:v}},rR=e=>{var{position:t,preview:r,showGradient:n,background:a,direction:o}=e;return(0,l.jsx)("div",{className:m()("absolute -translate-y-1/2 top-1/2 h-full z-10",{"transition-all duration-500":!r}),style:{[o]:"".concat((t>0?t:0)*100-.1,"%"),width:"10%",background:a,opacity:n?1:0}})},rD=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{left:n=0,width:a=0}=t;return(0,ev.Z)(t)?e:{left:n/r,right:(r-a-n)/r}},rF=e=>{var{preview:t=!1,backgroundInfo:r}=e,{currentBackgroundInfo:n,targetHeight:a,targetWidth:o,targetRef:i,cropperSize:s}=rB({backgroundInfo:r}),{theme_color:d,gradient_position:u={},canvas_position:v={}}=null!=n?n:{},{left:m=0,right:g=0}=rD(u,v,s.width),{top:p=0,height:f=0}=v,[h,_]=(0,c.useState)(null!=d?d:"transparent"),x=a*s.width/s.height,y=function(e,t){if(!/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/.test(e))return e;var r=e.slice(5,-1).split(",");return r.push("0.95"),"rgba(".concat(r.join(","),")")}(h,.95);return(0,c.useEffect)(()=>{d&&_(d)},[n]),(0,l.jsxs)("div",{"data-testid":"chat.with_rule_img_background",ref:i,className:"rule-img-background absolute left-1/2 -translate-x-1/2 w-full h-full overflow-hidden pointer-events-none",style:{background:t?"none":h,zIndex:t?100:0},children:[(0,l.jsx)("div",{className:"bg-[rgba(0,0,0,0.12)] absolute w-full h-full z-[200] rounded-t-[6px]"}),(0,l.jsxs)("div",{className:"relative w-fit h-fit left-1/2 -translate-x-1/2",children:[(0,l.jsx)(rR,{preview:t,showGradient:rG(o,x,m),position:m,direction:"left",background:"linear-gradient(90deg,  ".concat(h," 10%, ").concat(y," 28%, transparent 92.4%)")}),t?(0,l.jsx)("div",{style:{height:a,width:o}}):(0,l.jsx)("div",{style:{width:x,height:a,position:"relative",overflow:"hidden"},children:(0,l.jsx)("img",{src:null==n?void 0:n.origin_image_url,alt:"",style:{height:"".concat(f/s.height*100,"%"),position:"absolute",left:"".concat(m?100*m:-(200*g),"%"),top:"".concat(p/s.height*100,"%")}})}),(0,l.jsx)(rR,{preview:t,showGradient:rG(o,x,g),position:g,direction:"right",background:"linear-gradient(90deg,  transparent 10% , ".concat(y," 72%, ").concat(h," 92%)")})]})]})};r("650818");var rU=r("471972"),rO={};rO.styleTagTransform=Z(),rO.setAttributes=M(),rO.insert=I().bind(null,"head"),rO.domAPI=E(),rO.insertStyleElement=N(),j()(rU.Z,rO),rU.Z&&rU.Z.locals&&rU.Z.locals;var rz=e=>{var{alignWidth:t,children:r,className:n,innerWrapClassName:a}=e;return(0,l.jsx)("div",{className:m()("full-width-aligner",n),style:{width:t||"100%"},children:(0,l.jsx)("span",{className:m()("full-width-aligner-inner-wrap",a),children:r})})};rz.displayName="UIKitFullWidthAligner";var rW=r("313713"),rH={};rH.styleTagTransform=Z(),rH.setAttributes=M(),rH.insert=I().bind(null,"head"),rH.domAPI=E(),rH.insertStyleElement=N(),j()(rW.Z,rH),rW.Z&&rW.Z.locals&&rW.Z.locals;var rK=e=>{var{onClick:t,style:r,className:n,show:a,showBackground:o}=e;return(0,l.jsx)(t8,{className:m()(["shadow-normal","coz-fg-hglt","to-newest-tip-ui-animation","!rounded-full"],!a&&["pointer-events-none","opacity-0"],n),size:"large",onClick:t,style:r,icon:(0,l.jsx)(f.shs,{className:"rotate-180"}),showBackground:o})};rK.displayName="UIKitToNewestTip";var rV=(0,c.createContext)({readLocalStoreValue:()=>{throw Error("unimplemented readLocalStoreValue")},writeLocalStoreValue:()=>{throw Error("unimplemented writeLocalStoreValue")}});var rq=((n={}).FailReadLocalStorage="uikit_FailReadLocalStorage",n.FailWriteLocalStorage="uikit_FailWriteLocalStorage",n),rY="cache:@coze-common/chat-area";var rX=e=>(!a&&(a=r0(e)),a),rJ=()=>({}),rQ=e=>(t,r)=>{var n,a=rX(e);return a?null!==(n=a[t])&&void 0!==n?n:r:r},r$=e=>(t,r)=>{var n=rX(e)||rJ();n[t]=r,r1(e,n)},r0=e=>{try{var t=window.localStorage.getItem(rY);if(!t)return null;var r=JSON.parse(t);if((0,z.Z)(r))return r;return null}catch(t){return e.errorEvent({eventName:rq.FailReadLocalStorage,error:t}),null}},r1=(e,t)=>{try{if((0,z.Z)(t)){var r=JSON.stringify(t);window.localStorage.setItem(rY,r)}}catch(t){e.errorEvent({eventName:rq.FailWriteLocalStorage,error:t})}},r2=94,r5=66,r4=26,r7=r("446721"),r8=r("87564"),r6=(0,eD.j)(["px-24px","py-10px","rounded-[99px]"],{variants:{theme:{primary:["bg-[#F2F3F7]"],danger:["bg-[#FFEFF1]"],background:["coz-bg-image-bots"]},color:{primary:["coz-fg-primary"],danger:["coz-fg-hglt-red"]}}}),r9=e=>{var{children:t,theme:r="primary",color:n="primary",className:a}=e,o=r6({theme:r,color:n});return(0,l.jsx)("div",{className:m()(o,a),children:t})}},871482:function(e,t,r){r.d(t,{xD:()=>a,$0:()=>o});var n=r("455069"),a=e=>{var[t,r]=(0,n.useState)(0),a=(0,n.useRef)(),o=(0,n.useRef)(()=>void 0);return o.current=e,(0,n.useLayoutEffect)(()=>{if(!!t)return a.current&&o.current(...a.current)},[t]),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.current=t,r(e=>e+1)}},o=e=>{var t=(0,n.useRef)(e);return t.current=e,(0,n.useRef)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.current(...r)}).current}},765377:function(e,t,r){r.d(t,{bw:()=>I,zV:()=>L,BH:()=>C,aH:()=>d,Qb:()=>b,Sn:()=>E,WP:()=>o,j_:()=>w,Cj:()=>v,Me:()=>x,X9:()=>_,_X:()=>y,Rm:()=>p,w8:()=>i,hB:()=>j});var n=r("896335"),a=r("550655");n.Z,a.Z;var o=(e,t)=>{try{return JSON.parse(e)}catch(e){return t(e),null}},i=e=>{var{str:t,onParseError:r,verifyStruct:n,onVerifyError:a}=e,i=o(t,r);try{return!function(e){if(!n(e))throw Error("verify struct no pass")}(i),i}catch(e){return a(e),null}},s=r("808549"),l=r("120454"),c=r("64605"),d=(e,t)=>e instanceof Error?{error:e,meta:{reason:t}}:(0,c.Z)(e)?{error:Error(""),meta:(0,l._)((0,s._)({},u(e)),{reason:t})}:{error:Error(String(e)),meta:{reason:t}},u=e=>"reason"in e?(0,l._)((0,s._)({},e),{reasonOfInputError:e.reason}):e,v=e=>{var t=Error("[chat-area] ".concat(e));setTimeout(()=>{throw t})},m=r("580868"),g=r("346707"),p=(e,t)=>{var r=(0,m.Z)(t,g.Z);if(!!Object.keys(r).length)e(r)},f=r("850392"),h=r.n(f),_=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.at(0);if(void 0===n)return null;var a=h()(n),o=h()(n);for(var i of t){var s=h()(i);a=(0,f.min)(a,s),o=(0,f.max)(o,s)}return{min:a.toString(),max:o.toString()}},x=(e,t,r)=>h()(e).minus(h()(t)).abs().lesser(h()(r)),y=e=>{var t=h()(e);return{greaterThan:e=>t.greater(h()(e)),lesserThan:e=>t.lesser(h()(e)),eq:e=>t.eq(h()(e))}},b=e=>{var t=h()(e);return{add:e=>t.add(e).toString(),subtract:e=>t.subtract(e).toString(),prev:()=>t.prev().toString(),next:()=>t.next().toString()}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(t=>setTimeout(t,e))};class C{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.then=this.promise.then.bind(this.promise)}}var j=(e,t)=>{var r=[];for(var n of t){var a=e.get(n);if(!a){v("[flatMapByKeyList] cannot find ".concat(n," in map"));continue}r.push(a)}return r},w=e=>void 0,E=e=>void 0,k=r("825955");class I{getNewInvokeDelay(){var{timeWindow:e,limit:t,onLimitDelay:r}=this.config,n=Date.now(),a=n-e,o=this.records.findIndex(e=>e>=a);if(o<0)return 0;var i=this.records.slice(o);if(i.length<t)return 0;var s=i.at(-1);return s?s+r-n:0}clearRecords(){var{timeWindow:e}=this.config,t=Date.now()-e,r=this.records.findLastIndex(e=>e<t);r>=0&&(this.records=this.records.slice(r+1))}constructor(e,t){var r=this;this.fn=e,this.config=t,this.records=[],this.invoke=(0,k._)(function*(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=r.getNewInvokeDelay(),o=Date.now();return r.records.push(a+o),a&&(yield S(a)),r.clearRecords(),r.fn(...t)})}}var T=e=>!!e&&(0,c.Z)(e)&&"children"in e&&!(0,g.Z)(null==e?void 0:e.children),M=e=>(0,c.Z)(e)&&"type"in e&&!(0,g.Z)(e)&&"link"===e.type,A=e=>!(0,g.Z)(e)&&(0,c.Z)(e)&&"type"in e&&"image"===e.type,N=e=>!(0,g.Z)(e)&&(0,c.Z)(e)&&"type"in e&&"text"===e.type,L={isParent:T,isLink:M,isImage:A,isText:N}},664679:function(e,t,r){r.d(t,{k:function(){return n}});var n=(0,r(917085).Z)()},686436:function(e,t,r){r.d(t,{M1:()=>i.M1,W6:()=>i.W6,e2:()=>a.e2,uf:()=>m.uf,qY:()=>i.qY,qo:()=>o.qoQ,Bw:()=>l.Bw,Ho:()=>i.Ho,Ps:()=>l.Ps,DL:()=>m.DL,NQ:()=>c.NQ,rB:()=>x.rB,F7:()=>v.F7,bP:()=>i.bP,Ew:()=>x.Ew,GA:()=>s.GA,Kz:()=>c.Kz,OP:()=>o.OPe,oJ:()=>a.oJ,wY:()=>i.wY,uB:()=>a.uB,$e:()=>x.$e,FU:()=>d.FU,Rf:()=>c.Rf,JW:()=>i.JW,XH:()=>a.XH,n2:()=>a.n2,p3:()=>o.p37,X2:()=>j,JA:()=>a.JA,KV:()=>i.KV,Ys:()=>x.Ys,_J:()=>o._J4,gN:()=>o.gNt,aK:()=>c.aK,mQ:()=>i.mQ,eX:()=>b.e,kq:()=>l.kq,U$:()=>o.U$M,L4:()=>a.L4,VO:()=>i.VO,RX:()=>i.RX,pQ:()=>s.pQ,Q5:()=>o.Q5$,_s:()=>a._s,kB:()=>c.kB,qf:()=>c.qf,qP:()=>n.qP,gw:()=>a.gw,yT:()=>i.yT,cI:()=>o.cIP,FD:()=>a.FD,Zd:()=>n.Zd,fu:()=>l.fu,hU:()=>l.hU,fT:()=>a.fT,z2:()=>i.z2,t$:()=>S,NS:()=>g.N,WV:()=>i.WV,eG:()=>s.eG,q7:()=>x.q7,Lp:()=>i.Lp,VI:()=>x.VI,PF:()=>a.PF,vo:()=>o.vow,zE:()=>o.zEJ,CT:()=>a.CT,OO:()=>a.OO,ou:()=>d.ou,$Y:()=>x.$Y,RD:()=>i.RD,fY:()=>a.fY,l0:()=>o.l09,xm:()=>i.xm,vK:()=>h.vK,dn:()=>u.dn,o:()=>l.o,GH:()=>l.GH,ER:()=>i.ER,KU:()=>a.KU,kD:()=>c.kD,qR:()=>x.qR,sS:()=>u.sS,w4:()=>y.w4,k9:()=>l.k9,G2:()=>a.G2,J2:()=>v.J2,XD:()=>f.createFreeStackPlugin,PV:()=>a.PV,ts:()=>x.ts,v2:()=>i.v2,rQ:()=>o.rQR,iw:()=>a.iw,qp:()=>d.qp,km:()=>i.km,Dc:()=>a.Dc,FC:()=>l.FC,d1:()=>s.d1,lV:()=>c.lV,x0:()=>a.x0,nW:()=>o.nWM,Em:()=>c.Em,St:()=>a.St,AU:()=>m.AU,c$:()=>a.c$,i2:()=>x.i2,yf:()=>l.yf,qm:()=>x.qm,O0:()=>i.O0,er:()=>o.erw,Hx:()=>o.Hxo,Lz:()=>s.Lz,Z4:()=>v.Z4,fE:()=>x.fE,fq:()=>o.fq6,v7:()=>l.v7,Np:()=>_.Np,Zv:()=>p.Z,I5:()=>n.I5,Yi:()=>h.Yi,SP:()=>a.SP,mh:()=>i.mh,yy:()=>i.yy,Ws:()=>o.Ws2,gO:()=>a.gO,Lw:()=>s.Lw,F2:()=>o.F26,Zs:()=>i.Zs,b5:()=>l.b5,XQ:()=>i.XQ,dm:()=>a.dm,Z1:()=>a.Z1,C$:()=>o.C$T,Sy:()=>s.Sy,cv:()=>i.cv,OK:()=>c.OK,iX:()=>i.iX,QW:()=>a.QW,aI:()=>i.aI,Nj:()=>d.Nj,V7:()=>c.V7,XN:()=>f.StackingContextManager,nd:()=>v.nd,ZO:()=>a.ZO}),r("327212");var n=r("355923"),a=r("58096"),o=r("198343"),i=r("952522"),s=r("2553"),l=r("160724"),c=r("755000"),d=r("896097"),u=r("815083"),v=r("15047"),m=r("898415"),g=r("820078"),p=r("938238"),f=r("296746"),h=r("241852"),_=r("727962"),x=r("810059"),y=r("339409"),b=r("384030"),S=Symbol("WorkflowJSONFormatContribution"),C=r("455069");function j(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=(0,o.KUq)().get(o.v2K),n=r.getEntity(e,t),a=(0,o.JAk)(n.version);return(0,C.useLayoutEffect)(()=>{var e=n.onEntityChange(()=>{a(n.version)});return()=>e.dispose()},[r,a,n]),n}},537952:function(e,t,r){r.d(t,{o:function(){return o}});var n=r(205460),a=r.n(n),o=(e,t)=>{var r=(e.imageHost||e.imageFallbackHost||"").replace(/^https:\/\//,e.schema?"".concat(e.schema,"://"):""),n=new(a())({schema:e.schema,region:t?"ap-singapore-1":"cn-north-1",imageHost:r,appId:e.appId,userId:e.userId,useFileExtension:e.useFileExtension,uploadTimeout:e.uploadTimeout,imageConfig:e.imageConfig}),o=n.addImageFile.bind(n);return n.addFile=function(e){return o({file:e.file,stsToken:e.stsToken})},n}},889959:function(e,t){class r{getInitConfig(){}getLaunchConfig(){}addEventListener(e,t){}removeEventListener(e,t){}send(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}reconnect(){}pingOnce(){}close(){}destroy(){}constructor(e,t){}}t.ZP=new class e{createConnection(e){return new r(e,this.channel)}createChannel(e){}constructor(){this.deviceId="",this.channel=null}}},109915:function(e,t,r){r.d(t,{l:()=>S,o:()=>j});var n=r("151064");r("455069");var a=r("336205"),o=r("407821"),i=r.n(o),s=r("472772"),l=r.n(s),c=r("395245"),d=r.n(c),u=r("297998"),v=r.n(u),m=r("646576"),g=r.n(m),p=r("606121"),f=r.n(p),h=r("467290"),_={};_.styleTagTransform=f(),_.setAttributes=v(),_.insert=d().bind(null,"head"),_.domAPI=l(),_.insertStyleElement=g(),i()(h.Z,_);var x=h.Z&&h.Z.locals?h.Z.locals:void 0,y=e=>{var{label:t,content:r}=e;return(0,n.jsxs)("div",{role:"article",className:"flex flex-col gap-[4px]",children:[(0,n.jsx)("div",{className:x["case-block-label"],children:t}),(0,n.jsx)("div",{className:"flex",children:r})]})},b=e=>{var{description:t}=e;return(0,n.jsx)("div",{className:x["rewrite-block-content"],children:t})},S=()=>(0,n.jsxs)("div",{className:"flex flex-col gap-[8px]",children:[(0,n.jsx)("div",{className:x["tips-headline"],children:a.o.t("kl_write_034")}),[{labelKey:"kl_write_035",contentKey:"kl_write_036"},{labelKey:"kl_write_037",contentKey:"kl_write_038"},{labelKey:"kl_write_039",contentKey:"kl_write_040"}].map(e=>{var{labelKey:t,contentKey:r}=e;return(0,n.jsx)(y,{label:a.o.t(t),content:(0,n.jsx)(b,{description:a.o.t(r)})},t)})]}),C=e=>{var{labelContentPairs:t}=e;return(0,n.jsx)("div",{className:x["rerank-block-content"],children:t.map((e,t)=>{var{label:r,content:a}=e;return(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{style:{minWidth:"50px",color:"var(--Fg-COZ-fg-hglt, #543EF7)"},className:x["rerank-block-content-text"],children:r}),(0,n.jsx)("div",{style:{color:"var(--Fg-COZ-fg-primary, rgba(32, 41, 65, 0.89))"},className:x["rerank-block-content-text"],children:a})]},"".concat(r,"-").concat(t))})})},j=()=>{var e=[{label:a.o.t("kl_write_041",{index:"A"}),content:a.o.t("kl_write_042")},{label:a.o.t("kl_write_041",{index:"B"}),content:a.o.t("kl_write_043")},{label:a.o.t("kl_write_041",{index:"C"}),content:a.o.t("kl_write_044")},{label:a.o.t("kl_write_041",{index:"D"}),content:a.o.t("kl_write_045")}],t=[{label:a.o.t("kl_write_041",{index:"C"}),content:a.o.t("kl_write_044")},{label:a.o.t("kl_write_041",{index:"D"}),content:a.o.t("kl_write_045")},{label:a.o.t("kl_write_041",{index:"B"}),content:a.o.t("kl_write_043")},{label:a.o.t("kl_write_041",{index:"A"}),content:a.o.t("kl_write_042")}];return(0,n.jsxs)("div",{className:"flex flex-col gap-[8px]",children:[(0,n.jsx)("div",{className:x["tips-headline"],children:a.o.t("kl_write_034")}),(0,n.jsx)(y,{label:a.o.t("kl_write_046"),content:(0,n.jsx)(C,{labelContentPairs:e})}),(0,n.jsx)(y,{label:a.o.t("kl_write_047"),content:(0,n.jsx)(C,{labelContentPairs:t})})]})}},308079:function(e,t,r){r.d(t,{G:function(){return l}});var n=r(808549),a=r(120454),o=r(151064),i=r(455069),s=r(771588),l=e=>(0,i.forwardRef)((t,r)=>(0,o.jsx)(s.ZPm,(0,a._)((0,n._)({svg:e},t),{ref:r})))},44172:function(e,t,r){r.d(t,{$5C:function(){return cT},$RR:function(){return cw},$lV:function(){return lW},$rt:function(){return lJ},A$t:function(){return cI},Aj:function(){return lZ},C26:function(){return cj},Cs7:function(){return cp},D6Z:function(){return lS},D6v:function(){return lq},FQ:function(){return lp},GOH:function(){return cv},Hnk:function(){return lz},Hub:function(){return lb},I2v:function(){return lR},IEX:function(){return cl},IsH:function(){return cG},J_i:function(){return l$},JhV:function(){return ly},Jr5:function(){return ci},KBW:function(){return l5},KHq:function(){return lF},KNN:function(){return lU},K_Z:function(){return l3},Kjt:function(){return lN},LAr:function(){return lO},LGu:function(){return l7},LJy:function(){return le},LxD:function(){return ca},NKR:function(){return s6},N_R:function(){return sD},O5N:function(){return lG},OlJ:function(){return cb},OlV:function(){return ll},Ov0:function(){return lf},PRD:function(){return cx},PUI:function(){return lk},Pil:function(){return cd},QHI:function(){return cZ},Qi1:function(){return s8},R$2:function(){return lj},Rfd:function(){return sq},SdY:function(){return cN},TgS:function(){return lA},UCZ:function(){return cm},UYy:function(){return li},Ucq:function(){return lC},Uj_:function(){return cB},Us8:function(){return sB},VG8:function(){return cC},VKQ:function(){return sV},Vxy:function(){return sZ},WDf:function(){return lr},WTs:function(){return l6},WXt:function(){return l2},Wdl:function(){return cD},XD7:function(){return ct},XvT:function(){return sH},YCp:function(){return cy},YOo:function(){return cM},YeJ:function(){return sF},YnB:function(){return sU},Zog:function(){return lE},_h$:function(){return s0},aUG:function(){return sW},bCE:function(){return lx},bMz:function(){return sJ},bQR:function(){return cA},bho:function(){return lX},bti:function(){return ls},bu3:function(){return l4},ckl:function(){return s7},cmr:function(){return co},crV:function(){return s$},dcc:function(){return cS},dd3:function(){return lh},eIx:function(){return cE},eQ:function(){return ck},f5h:function(){return sY},fkE:function(){return ln},h16:function(){return ch},h3G:function(){return cu},h9l:function(){return sR},i07:function(){return s4},i2p:function(){return ce},i7w:function(){return cs},iCu:function(){return s3},ia5:function(){return lc},iox:function(){return la},jVj:function(){return sX},jt6:function(){return l9},k0G:function(){return sO},k2L:function(){return cc},k8G:function(){return c_},lls:function(){return cR},mBV:function(){return lm},mGJ:function(){return lY},mQT:function(){return sA},mSE:function(){return ld},nCf:function(){return lo},pV2:function(){return sG},plM:function(){return l0},q5R:function(){return s1},q5x:function(){return sN},qy1:function(){return sK},r90:function(){return lg},rMo:function(){return cr},rPP:function(){return lK},rRB:function(){return sL},rwS:function(){return lQ},rwp:function(){return lM},s3j:function(){return lP},s7F:function(){return lH},s9d:function(){return lV},sZw:function(){return cn},ses:function(){return cL},t1r:function(){return lu},t2M:function(){return cP},tr8:function(){return l_},tsT:function(){return lD},ubE:function(){return lL},v$_:function(){return lw},vUr:function(){return sz},vl3:function(){return lt},wHY:function(){return s9},w_1:function(){return s5},xAI:function(){return lB},xu0:function(){return l8},yA0:function(){return lv},yB2:function(){return cf},yMZ:function(){return l1},yOl:function(){return cg},ycV:function(){return sQ},yl5:function(){return sP},yok:function(){return lI},z2G:function(){return lT},zwE:function(){return s2}});var n=r(151064),a=r(308079),o=r(77981),i=r(133476),s=r(639863),l=r(881481),c=r(597469),d=r(441242),u=r(643528),v=r(88804),m=r(233038),g=r(893097),p=r(542987),f=r(517433),h=r(595285),_=r(660309),x=r(671981),y=r(760583),b=r(289793),S=r(848919),C=r(445983),j=r(101954),w=r(256617),E=r(672760),k=r(430356),I=r(219016),T=r(696887),M=r(631980),A=r(464705),N=r(731412),L=r(671766),Z=r(88673),G=r(973910),P=r(931912),B=r(536367),R=r(48453),D=r(424031),F=r(515235),U=r(938804),O=r(384354),z=r(526355),W=r(515919),H=r(833995),K=r(707841),V=r(832212),q=r(625752),Y=r(587198),X=r(62260),J=r(883799),Q=r(517064),$=r(774789),ee=r(619505),et=r(439052),er=r(119353),en=r(847200),ea=r(985825),eo=r(233653),ei=r(129030),es=r(188183),el=r(358308),ec=r(945409),ed=r(497222),eu=r(185946),ev=r(381776),em=r(813508),eg=r(11528),ep=r(348592),ef=r(773461),eh=r(112376),e_=r(946141),ex=r(912968),ey=r(900375),eb=r(967645),eS=r(358023),eC=r(430809),ej=r(606040),ew=r(598934),eE=r(78586),ek=r(809809),eI=r(687145),eT=r(821887),eM=r(143676),eA=r(508583),eN=r(192776),eL=r(786072),eZ=r(804815),eG=r(831801),eP=r(827623),eB=r(853486),eR=r(574257),eD=r(396587),eF=r(801477),eU=r(408834),eO=r(753176),ez=r(1232),eW=r(894057),eH=r(624966),eK=r(392957),eV=r(232994),eq=r(127116),eY=r(946546),eX=r(155221),eJ=r(35439),eQ=r(565962),e$=r(230170),e0=r(301286),e1=r(228659),e2=r(217292),e5=r(195618),e4=r(413245),e7=r(681379),e8=r(215406),e6=r(399987),e9=r(383827),e3=r(31573),te=r(119166),tt=r(430751),tr=r(999919),tn=r(404301),ta=r(108910),to=r(856950),ti=r(596699),ts=r(90444),tl=r(225054),tc=r(572329),td=r(871643),tu=r(137439),tv=r(164536),tm=r(957787),tg=r(128280),tp=r(738594),tf=r(187800),th=r(395632),t_=r(964394),tx=r(7163),ty=r(986844),tb=r(939765),tS=r(40192),tC=r(892823),tj=r(907337),tw=r(820765),tE=r(557531),tk=r(62908),tI=r(390160),tT=r(926254),tM=r(613314),tA=r(237439),tN=r(9117),tL=r(537892),tZ=r(928799),tG=r(346824),tP=r(276198),tB=r(382547),tR=r(222871),tD=r(311173),tF=r(72602),tU=r(828908),tO=r(314297),tz=r(169186),tW=r(614425),tH=r(873616),tK=r(716196),tV=r(335208),tq=r(568757),tY=r(176896),tX=r(419263),tJ=r(129151),tQ=r(76526),t$=r(569010),t0=r(241893),t1=r(504658),t2=r(796122),t5=r(255222),t4=r(768209),t7=r(509942),t8=r(57146),t6=r(524282),t9=r(360185),t3=r(267503),re=r(497709),rt=r(572117),rr=r(607170),rn=r(187974),ra=r(28275),ro=r(304580),ri=r(323283),rs=r(578251),rl=r(736245),rc=r(338773),rd=r(979498),ru=r(521522),rv=r(501885),rm=r(508545),rg=r(874339),rp=r(521449),rf=r(159255),rh=r(835211),r_=r(270388),rx=r(442884),ry=r(810576),rb=r(535676),rS=r(562707),rC=r(637629),rj=r(302663),rw=r(140940),rE=r(662806),rk=r(490317),rI=r(871594),rT=r(112394),rM=r(648754),rA=r(734536),rN=r(933571),rL=r(433572),rZ=r(478875),rG=r(267806),rP=r(778544),rB=r(529976),rR=r(323072),rD=r(593185),rF=r(942048),rU=r(955016),rO=r(455300),rz=r(594519),rW=r(826401),rH=r(250925),rK=r(841739),rV=r(214288),rq=r(154884),rY=r(825038),rX=r(276508),rJ=r(898093),rQ=r(375084),r$=r(291988),r0=r(438135),r1=r(448013),r2=r(572312),r5=r(943722),r4=r(9727),r7=r(279827),r8=r(880966),r6=r(546593),r9=r(904362),r3=r(858052),ne=r(736201),nt=r(184429),nr=r(424029),nn=r(595023),na=r(407270),no=r(275236),ni=r(417422),ns=r(173257),nl=r(232444),nc=r(694048),nd=r(280136),nu=r(110792),nv=r(713806),nm=r(161890),ng=r(496890),np=r(932889),nf=r(777576),nh=r(221903),n_=r(16902),nx=r(393590),ny=r(983414),nb=r(152891),nS=r(188063),nC=r(391969),nj=r(457917),nw=r(68048),nE=r(377400),nk=r(292579),nI=r(582488),nT=r(501053),nM=r(985413),nA=r(289369),nN=r(277501),nL=r(388098),nZ=r(815136),nG=r(85625),nP=r(481360),nB=r(371294),nR=r(661794),nD=r(983863),nF=r(989312),nU=r(387118),nO=r(883319),nz=r(32065),nW=r(676993),nH=r(231236),nK=r(944989),nV=r(341921),nq=r(217027),nY=r(595548),nX=r(422067),nJ=r(242391),nQ=r(571554),n$=r(334906),n0=r(778056),n1=r(920559),n2=r(290327),n5=r(330597),n4=r(951729),n7=r(568642),n8=r(383682),n6=r(438640),n9=r(256245),n3=r(192596),ae=r(99652),at=r(733941),ar=r(34759),an=r(638475),aa=r(46823),ao=r(310583),ai=r(911724),as=r(914605),al=r(847622),ac=r(17398),ad=r(2936),au=r(803661),av=r(864866),am=r(352875),ag=r(540643),ap=r(603975),af=r(168625),ah=r(661161),a_=r(686374),ax=r(765534),ay=r(33226),ab=r(238448),aS=r(921606),aC=r(618234),aj=r(36958),aw=r(815402),aE=r(346695),ak=r(542686),aI=r(19429),aT=r(53513),aM=r(517871),aA=r(864441),aN=r(474242),aL=r(642661),aZ=r(356353),aG=r(48195),aP=r(339743),aB=r(430868),aR=r(291548),aD=r(788025),aF=r(300467),aU=r(576080),aO=r(497790),az=r(4021),aW=r(390961),aH=r(203796),aK=r(407913),aV=r(811399),aq=r(917516),aY=r(222207),aX=r(619464),aJ=r(14866),aQ=r(717447),a$=r(170237),a0=r(265877),a1=r(643541),a2=r(799418),a5=r(277448),a4=r(386274),a7=r(639036),a8=r(688180),a6=r(339391),a9=r(803379),a3=r(921802),oe=r(551121),ot=r(319316),or=r(161487),on=r(767825),oa=r(238911),oo=r(353981),oi=r(505835),os=r(166843),ol=r(411594),oc=r(250441),od=r(880354),ou=r(32757),ov=r(605047),om=r(804778),og=r(773472),op=r(226017),of=r(216174),oh=r(14890),o_=r(300674),ox=r(294190),oy=r(44595),ob=r(880029),oS=r(485951),oC=r(71913),oj=r(411862),ow=r(607410),oE=r(921193),ok=r(443377),oI=r(345556),oT=r(530358),oM=r(305392),oA=r(911841),oN=r(869668),oL=r(394200),oZ=r(814816),oG=r(811799),oP=r(333749),oB=r(95458),oR=r(586046),oD=r(576770),oF=r(236306),oU=r(932682),oO=r(785958),oz=r(548684),oW=r(200136),oH=r(456591),oK=r(928258),oV=r(500813),oq=r(586395),oY=r(306798),oX=r(886022),oJ=r(833578),oQ=r(183629),o$=r(259533),o0=r(126477),o1=r(791841),o2=r(844517),o5=r(879715),o4=r(578764),o7=r(663495),o8=r(204982),o6=r(129779),o9=r(783755),o3=r(232656),ie=r(719516),it=r(667680),ir=r(98997),ia=r(13398),io=r(790476),ii=r(917974),is=r(433600),il=r(775472),ic=r(953245),id=r(355440),iu=r(88218),iv=r(667553),im=r(175175),ig=r(786677),ip=r(677106),ih=r(443930),i_=r(215751),ix=r(401175),iy=r(19879),ib=r(126590),iS=r(150673),iC=r(983299),ij=r(662543),iw=r(917190),iE=r(814071),ik=r(87901),iI=r(736718),iT=r(44373),iM=r(473483),iA=r(520064),iN=r(484485),iL=r(632751),iZ=r(417490),iG=r(108871),iP=r(547490),iB=r(356441),iR=r(537493),iD=r(151377),iF=r(739106),iU=r(469978),iO=r(893199),iz=r(485886),iW=r(163817),iH=r(538996),iK=r(400566),iV=r(719902),iq=r(927044),iY=r(871109),iX=r(738825),iJ=r(975232),iQ=r(334769),i$=r(398669),i0=r(199275),i1=r(247573),i2=r(756916),i5=r(15558),i4=r(653667),i7=r(266904),i8=r(454749),i6=r(181221),i9=r(334562),i3=r(764381),se=r(128997),st=r(10109),sr=r(930401),sn=r(136796),sa=r(403282),so=r(718378),si=r(437054),ss=r(662966),sl=r(968609),sc=r(25037),sd=r(668084),su=r(432282),sv=r(306987),sm=r(845302),sg=r(47765),sp=r(335376),sf=r(491232),sh=r(19813),s_=r(68138),sx=r(157410),sy=r(911505),sb=r(477466),sS=r(585138),sC=r(916718),sj=r(869356),sw=r(891518),sE=r(674570),sk=r(357010),sI=r(162971),sT=r(609485),sM=r(201520);(0,a.G)((0,n.jsx)(o.r,{})),(0,a.G)((0,n.jsx)(i.r,{})),(0,a.G)((0,n.jsx)(i5.r,{})),(0,a.G)((0,n.jsx)(i2.r,{})),(0,a.G)((0,n.jsx)(sa.r,{})),(0,a.G)((0,n.jsx)(sn.r,{})),(0,a.G)((0,n.jsx)(i6.r,{})),(0,a.G)((0,n.jsx)(i8.r,{})),(0,a.G)((0,n.jsx)(tr.r,{})),(0,a.G)((0,n.jsx)(sh.r,{}));var sA=(0,a.G)((0,n.jsx)(nw.r,{}));(0,a.G)((0,n.jsx)(su.r,{})),(0,a.G)((0,n.jsx)(sf.r,{})),(0,a.G)((0,n.jsx)(sd.r,{})),(0,a.G)((0,n.jsx)(sm.r,{})),(0,a.G)((0,n.jsx)(sv.r,{})),(0,a.G)((0,n.jsx)(sp.r,{})),(0,a.G)((0,n.jsx)(sg.r,{})),(0,a.G)((0,n.jsx)(tg.r,{})),(0,a.G)((0,n.jsx)(i7.r,{})),(0,a.G)((0,n.jsx)(ip.r,{})),(0,a.G)((0,n.jsx)(sb.r,{})),(0,a.G)((0,n.jsx)(ac.r,{})),(0,a.G)((0,n.jsx)(ad.r,{})),(0,a.G)((0,n.jsx)(eO.r,{})),(0,a.G)((0,n.jsx)(eI.r,{})),(0,a.G)((0,n.jsx)(eM.r,{})),(0,a.G)((0,n.jsx)(rW.r,{})),(0,a.G)((0,n.jsx)(ih.r,{})),(0,a.G)((0,n.jsx)(si.r,{})),(0,a.G)((0,n.jsx)(tO.r,{}));var sN=(0,a.G)((0,n.jsx)(tR.r,{}));(0,a.G)((0,n.jsx)(oh.r,{})),(0,a.G)((0,n.jsx)(r9.r,{}));var sL=(0,a.G)((0,n.jsx)(t9.r,{})),sZ=(0,a.G)((0,n.jsx)(aC.r,{}));(0,a.G)((0,n.jsx)(i4.r,{})),(0,a.G)((0,n.jsx)(i9.r,{})),(0,a.G)((0,n.jsx)(a5.r,{}));var sG=(0,a.G)((0,n.jsx)(oe.r,{}));(0,a.G)((0,n.jsx)(iN.r,{}));var sP=(0,a.G)((0,n.jsx)(a4.r,{}));(0,a.G)((0,n.jsx)(ot.r,{}));var sB=(0,a.G)((0,n.jsx)(ab.r,{}));(0,a.G)((0,n.jsx)(ay.r,{})),(0,a.G)((0,n.jsx)(aH.r,{}));var sR=(0,a.G)((0,n.jsx)(r$.r,{})),sD=(0,a.G)((0,n.jsx)(iE.r,{}));(0,a.G)((0,n.jsx)(ik.r,{})),(0,a.G)((0,n.jsx)(nU.r,{}));var sF=(0,a.G)((0,n.jsx)(r5.r,{})),sU=(0,a.G)((0,n.jsx)(rD.r,{})),sO=(0,a.G)((0,n.jsx)(rJ.r,{}));(0,a.G)((0,n.jsx)(of.r,{})),(0,a.G)((0,n.jsx)(r8.r,{})),(0,a.G)((0,n.jsx)(ii.r,{}));var sz=(0,a.G)((0,n.jsx)(ir.r,{}));(0,a.G)((0,n.jsx)(ia.r,{}));var sW=(0,a.G)((0,n.jsx)(ax.r,{})),sH=(0,a.G)((0,n.jsx)(nk.r,{}));(0,a.G)((0,n.jsx)(iI.r,{})),(0,a.G)((0,n.jsx)(oX.r,{}));var sK=(0,a.G)((0,n.jsx)(aj.r,{}));(0,a.G)((0,n.jsx)(o9.r,{})),(0,a.G)((0,n.jsx)(oj.r,{})),(0,a.G)((0,n.jsx)(rf.r,{})),(0,a.G)((0,n.jsx)(nv.r,{})),(0,a.G)((0,n.jsx)(ng.r,{}));var sV=(0,a.G)((0,n.jsx)(nr.r,{})),sq=(0,a.G)((0,n.jsx)(nE.r,{}));(0,a.G)((0,n.jsx)(au.r,{})),(0,a.G)((0,n.jsx)(rU.r,{}));var sY=(0,a.G)((0,n.jsx)(od.r,{}));(0,a.G)((0,n.jsx)(tf.r,{})),(0,a.G)((0,n.jsx)(r4.r,{})),(0,a.G)((0,n.jsx)(ow.r,{}));var sX=(0,a.G)((0,n.jsx)(r1.r,{}));(0,a.G)((0,n.jsx)(oQ.r,{})),(0,a.G)((0,n.jsx)(t8.r,{})),(0,a.G)((0,n.jsx)(ou.r,{})),(0,a.G)((0,n.jsx)(t7.r,{}));var sJ=(0,a.G)((0,n.jsx)(oB.r,{}));(0,a.G)((0,n.jsx)(nO.r,{})),(0,a.G)((0,n.jsx)(rZ.r,{})),(0,a.G)((0,n.jsx)(rS.r,{}));var sQ=(0,a.G)((0,n.jsx)(i_.r,{})),s$=(0,a.G)((0,n.jsx)(ix.r,{}));(0,a.G)((0,n.jsx)(rh.r,{})),(0,a.G)((0,n.jsx)(aK.r,{})),(0,a.G)((0,n.jsx)(eq.r,{})),(0,a.G)((0,n.jsx)(eE.r,{})),(0,a.G)((0,n.jsx)(io.r,{}));var s0=(0,a.G)((0,n.jsx)(oZ.r,{})),s1=(0,a.G)((0,n.jsx)(oL.r,{}));(0,a.G)((0,n.jsx)(oT.r,{})),(0,a.G)((0,n.jsx)(iu.r,{})),(0,a.G)((0,n.jsx)(oO.r,{}));var s2=(0,a.G)((0,n.jsx)(tq.r,{})),s5=(0,a.G)((0,n.jsx)(tY.r,{})),s4=(0,a.G)((0,n.jsx)(tJ.r,{}));(0,a.G)((0,n.jsx)(tX.r,{})),(0,a.G)((0,n.jsx)(ap.r,{})),(0,a.G)((0,n.jsx)(ss.r,{})),(0,a.G)((0,n.jsx)(se.r,{})),(0,a.G)((0,n.jsx)(eD.r,{})),(0,a.G)((0,n.jsx)(og.r,{})),(0,a.G)((0,n.jsx)(oU.r,{})),(0,a.G)((0,n.jsx)(iw.r,{})),(0,a.G)((0,n.jsx)(nN.r,{}));var s7=(0,a.G)((0,n.jsx)(nA.r,{})),s8=(0,a.G)((0,n.jsx)(rj.r,{}));(0,a.G)((0,n.jsx)(rT.r,{})),(0,a.G)((0,n.jsx)(rQ.r,{})),(0,a.G)((0,n.jsx)(nF.r,{}));var s6=(0,a.G)((0,n.jsx)(nG.r,{}));(0,a.G)((0,n.jsx)(nP.r,{}));var s9=(0,a.G)((0,n.jsx)(iL.r,{}));(0,a.G)((0,n.jsx)(nf.r,{})),(0,a.G)((0,n.jsx)($.r,{})),(0,a.G)((0,n.jsx)(o$.r,{})),(0,a.G)((0,n.jsx)(o0.r,{})),(0,a.G)((0,n.jsx)(nd.r,{}));var s3=(0,a.G)((0,n.jsx)(nu.r,{}));(0,a.G)((0,n.jsx)(tK.r,{}));var le=(0,a.G)((0,n.jsx)(tV.r,{}));(0,a.G)((0,n.jsx)(ob.r,{})),(0,a.G)((0,n.jsx)(oS.r,{})),(0,a.G)((0,n.jsx)(rC.r,{})),(0,a.G)((0,n.jsx)(rw.r,{}));var lt=(0,a.G)((0,n.jsx)(rI.r,{}));(0,a.G)((0,n.jsx)(rE.r,{})),(0,a.G)((0,n.jsx)(a$.r,{})),(0,a.G)((0,n.jsx)(a0.r,{})),(0,a.G)((0,n.jsx)(aJ.r,{})),(0,a.G)((0,n.jsx)(aQ.r,{})),(0,a.G)((0,n.jsx)(ak.r,{})),(0,a.G)((0,n.jsx)(e4.r,{})),(0,a.G)((0,n.jsx)(aI.r,{})),(0,a.G)((0,n.jsx)(eT.r,{})),(0,a.G)((0,n.jsx)(eA.r,{})),(0,a.G)((0,n.jsx)(nh.r,{})),(0,a.G)((0,n.jsx)(n_.r,{})),(0,a.G)((0,n.jsx)(ov.r,{})),(0,a.G)((0,n.jsx)(om.r,{})),(0,a.G)((0,n.jsx)(it.r,{})),(0,a.G)((0,n.jsx)(aX.r,{})),(0,a.G)((0,n.jsx)(aq.r,{})),(0,a.G)((0,n.jsx)(rp.r,{}));var lr=(0,a.G)((0,n.jsx)(o_.r,{}));(0,a.G)((0,n.jsx)(i$.r,{})),(0,a.G)((0,n.jsx)(ol.r,{})),(0,a.G)((0,n.jsx)(nB.r,{})),(0,a.G)((0,n.jsx)(t3.r,{}));var ln=(0,a.G)((0,n.jsx)(a6.r,{})),la=(0,a.G)((0,n.jsx)(a8.r,{}));(0,a.G)((0,n.jsx)(a7.r,{}));var lo=(0,a.G)((0,n.jsx)(r2.r,{}));(0,a.G)((0,n.jsx)(is.r,{})),(0,a.G)((0,n.jsx)(n6.r,{})),(0,a.G)((0,n.jsx)(n9.r,{})),(0,a.G)((0,n.jsx)(n3.r,{})),(0,a.G)((0,n.jsx)(aa.r,{})),(0,a.G)((0,n.jsx)(ao.r,{})),(0,a.G)((0,n.jsx)(ai.r,{})),(0,a.G)((0,n.jsx)(as.r,{})),(0,a.G)((0,n.jsx)(al.r,{}));var li=(0,a.G)((0,n.jsx)(at.r,{}));(0,a.G)((0,n.jsx)(tN.r,{})),(0,a.G)((0,n.jsx)(ar.r,{})),(0,a.G)((0,n.jsx)(an.r,{})),(0,a.G)((0,n.jsx)(ae.r,{})),(0,a.G)((0,n.jsx)(nt.r,{}));var ls=(0,a.G)((0,n.jsx)(oG.r,{}));(0,a.G)((0,n.jsx)(et.r,{})),(0,a.G)((0,n.jsx)(t_.r,{}));var ll=(0,a.G)((0,n.jsx)(np.r,{})),lc=(0,a.G)((0,n.jsx)(oq.r,{})),ld=(0,a.G)((0,n.jsx)(aN.r,{}));(0,a.G)((0,n.jsx)(aL.r,{})),(0,a.G)((0,n.jsx)(aT.r,{})),(0,a.G)((0,n.jsx)(oC.r,{})),(0,a.G)((0,n.jsx)(rN.r,{}));var lu=(0,a.G)((0,n.jsx)(iY.r,{})),lv=(0,a.G)((0,n.jsx)(iQ.r,{})),lm=(0,a.G)((0,n.jsx)(iV.r,{})),lg=(0,a.G)((0,n.jsx)(iK.r,{})),lp=(0,a.G)((0,n.jsx)(ra.r,{})),lf=(0,a.G)((0,n.jsx)(iH.r,{})),lh=(0,a.G)((0,n.jsx)(iW.r,{})),l_=(0,a.G)((0,n.jsx)(r6.r,{}));(0,a.G)((0,n.jsx)(ox.r,{})),(0,a.G)((0,n.jsx)(nR.r,{})),(0,a.G)((0,n.jsx)(nD.r,{})),(0,a.G)((0,n.jsx)(aD.r,{})),(0,a.G)((0,n.jsx)(aR.r,{})),(0,a.G)((0,n.jsx)(rx.r,{})),(0,a.G)((0,n.jsx)(r_.r,{}));var lx=(0,a.G)((0,n.jsx)(t6.r,{}));(0,a.G)((0,n.jsx)(iJ.r,{})),(0,a.G)((0,n.jsx)(iX.r,{})),(0,a.G)((0,n.jsx)(iq.r,{})),(0,a.G)((0,n.jsx)(i0.r,{})),(0,a.G)((0,n.jsx)(eN.r,{})),(0,a.G)((0,n.jsx)(eS.r,{})),(0,a.G)((0,n.jsx)(ti.r,{})),(0,a.G)((0,n.jsx)(eQ.r,{}));var ly=(0,a.G)((0,n.jsx)(sE.r,{}));(0,a.G)((0,n.jsx)(sS.r,{}));var lb=(0,a.G)((0,n.jsx)(sI.r,{})),lS=(0,a.G)((0,n.jsx)(sj.r,{}));(0,a.G)((0,n.jsx)(sk.r,{})),(0,a.G)((0,n.jsx)(sC.r,{})),(0,a.G)((0,n.jsx)(sT.r,{})),(0,a.G)((0,n.jsx)(sw.r,{})),(0,a.G)((0,n.jsx)(sM.r,{})),(0,a.G)((0,n.jsx)(aZ.r,{})),(0,a.G)((0,n.jsx)(or.r,{})),(0,a.G)((0,n.jsx)(on.r,{})),(0,a.G)((0,n.jsx)(aB.r,{})),(0,a.G)((0,n.jsx)(nc.r,{})),(0,a.G)((0,n.jsx)(n4.r,{})),(0,a.G)((0,n.jsx)(il.r,{})),(0,a.G)((0,n.jsx)(t$.r,{})),(0,a.G)((0,n.jsx)(nl.r,{})),(0,a.G)((0,n.jsx)(rq.r,{})),(0,a.G)((0,n.jsx)(iv.r,{})),(0,a.G)((0,n.jsx)(aS.r,{})),(0,a.G)((0,n.jsx)(im.r,{})),(0,a.G)((0,n.jsx)(ny.r,{})),(0,a.G)((0,n.jsx)(tQ.r,{}));var lC=(0,a.G)((0,n.jsx)(a1.r,{}));(0,a.G)((0,n.jsx)(nz.r,{}));var lj=(0,a.G)((0,n.jsx)(rR.r,{}));(0,a.G)((0,n.jsx)(oA.r,{})),(0,a.G)((0,n.jsx)(oM.r,{})),(0,a.G)((0,n.jsx)(oN.r,{})),(0,a.G)((0,n.jsx)(aG.r,{})),(0,a.G)((0,n.jsx)(oa.r,{})),(0,a.G)((0,n.jsx)(av.r,{})),(0,a.G)((0,n.jsx)(am.r,{})),(0,a.G)((0,n.jsx)(iT.r,{})),(0,a.G)((0,n.jsx)(rY.r,{}));var lw=(0,a.G)((0,n.jsx)(ag.r,{}));(0,a.G)((0,n.jsx)(nx.r,{})),(0,a.G)((0,n.jsx)(rk.r,{}));var lE=(0,a.G)((0,n.jsx)(rm.r,{})),lk=(0,a.G)((0,n.jsx)(rv.r,{})),lI=(0,a.G)((0,n.jsx)(ru.r,{})),lT=(0,a.G)((0,n.jsx)(rg.r,{}));(0,a.G)((0,n.jsx)(nL.r,{}));var lM=(0,a.G)((0,n.jsx)(rX.r,{}));(0,a.G)((0,n.jsx)(nZ.r,{})),(0,a.G)((0,n.jsx)(oK.r,{})),(0,a.G)((0,n.jsx)(oV.r,{})),(0,a.G)((0,n.jsx)(iC.r,{})),(0,a.G)((0,n.jsx)(iS.r,{})),(0,a.G)((0,n.jsx)(ib.r,{})),(0,a.G)((0,n.jsx)(ij.r,{}));var lA=(0,a.G)((0,n.jsx)(o6.r,{})),lN=(0,a.G)((0,n.jsx)(o8.r,{}));(0,a.G)((0,n.jsx)(o3.r,{})),(0,a.G)((0,n.jsx)(ee.r,{})),(0,a.G)((0,n.jsx)(o7.r,{})),(0,a.G)((0,n.jsx)(nI.r,{})),(0,a.G)((0,n.jsx)(nM.r,{})),(0,a.G)((0,n.jsx)(re.r,{})),(0,a.G)((0,n.jsx)(iy.r,{})),(0,a.G)((0,n.jsx)(oR.r,{})),(0,a.G)((0,n.jsx)(oo.r,{})),(0,a.G)((0,n.jsx)(ah.r,{})),(0,a.G)((0,n.jsx)(n0.r,{})),(0,a.G)((0,n.jsx)(nQ.r,{})),(0,a.G)((0,n.jsx)(oi.r,{})),(0,a.G)((0,n.jsx)(n$.r,{})),(0,a.G)((0,n.jsx)(nW.r,{})),(0,a.G)((0,n.jsx)(nH.r,{})),(0,a.G)((0,n.jsx)(nV.r,{})),(0,a.G)((0,n.jsx)(nK.r,{})),(0,a.G)((0,n.jsx)(nq.r,{})),(0,a.G)((0,n.jsx)(nY.r,{}));var lL=(0,a.G)((0,n.jsx)(n1.r,{})),lZ=(0,a.G)((0,n.jsx)(n2.r,{}));(0,a.G)((0,n.jsx)(nJ.r,{})),(0,a.G)((0,n.jsx)(n5.r,{})),(0,a.G)((0,n.jsx)(nX.r,{})),(0,a.G)((0,n.jsx)(oy.r,{})),(0,a.G)((0,n.jsx)(n7.r,{})),(0,a.G)((0,n.jsx)(ie.r,{}));var lG=(0,a.G)((0,n.jsx)(t2.r,{})),lP=(0,a.G)((0,n.jsx)(oD.r,{}));(0,a.G)((0,n.jsx)(t5.r,{}));var lB=(0,a.G)((0,n.jsx)(ey.r,{}));(0,a.G)((0,n.jsx)(ry.r,{})),(0,a.G)((0,n.jsx)(rb.r,{})),(0,a.G)((0,n.jsx)(rG.r,{})),(0,a.G)((0,n.jsx)(rP.r,{})),(0,a.G)((0,n.jsx)(ev.r,{})),(0,a.G)((0,n.jsx)(ec.r,{})),(0,a.G)((0,n.jsx)(ea.r,{})),(0,a.G)((0,n.jsx)(el.r,{})),(0,a.G)((0,n.jsx)(iz.r,{}));var lR=(0,a.G)((0,n.jsx)(iD.r,{})),lD=(0,a.G)((0,n.jsx)(iO.r,{})),lF=(0,a.G)((0,n.jsx)(iU.r,{})),lU=(0,a.G)((0,n.jsx)(iP.r,{})),lO=(0,a.G)((0,n.jsx)(iR.r,{})),lz=(0,a.G)((0,n.jsx)(iB.r,{})),lW=(0,a.G)((0,n.jsx)(iG.r,{})),lH=(0,a.G)((0,n.jsx)(iF.r,{}));(0,a.G)((0,n.jsx)(rt.r,{})),(0,a.G)((0,n.jsx)(rr.r,{}));var lK=(0,a.G)((0,n.jsx)(eC.r,{})),lV=(0,a.G)((0,n.jsx)(r0.r,{}));(0,a.G)((0,n.jsx)(ri.r,{})),(0,a.G)((0,n.jsx)(oc.r,{})),(0,a.G)((0,n.jsx)(rn.r,{})),(0,a.G)((0,n.jsx)(rs.r,{})),(0,a.G)((0,n.jsx)(ro.r,{})),(0,a.G)((0,n.jsx)(oH.r,{})),(0,a.G)((0,n.jsx)(aP.r,{})),(0,a.G)((0,n.jsx)(iA.r,{})),(0,a.G)((0,n.jsx)(th.r,{}));var lq=(0,a.G)((0,n.jsx)(ig.r,{})),lY=(0,a.G)((0,n.jsx)(a3.r,{}));(0,a.G)((0,n.jsx)(nT.r,{}));var lX=(0,a.G)((0,n.jsx)(tA.r,{}));(0,a.G)((0,n.jsx)(oI.r,{})),(0,a.G)((0,n.jsx)(r3.r,{}));var lJ=(0,a.G)((0,n.jsx)(ne.r,{}));(0,a.G)((0,n.jsx)(e7.r,{}));var lQ=(0,a.G)((0,n.jsx)(aY.r,{})),l$=(0,a.G)((0,n.jsx)(aV.r,{})),l0=(0,a.G)((0,n.jsx)(rl.r,{}));(0,a.G)((0,n.jsx)(rB.r,{})),(0,a.G)((0,n.jsx)(oY.r,{})),(0,a.G)((0,n.jsx)(e2.r,{}));var l1=(0,a.G)((0,n.jsx)(e8.r,{}));(0,a.G)((0,n.jsx)(ek.r,{})),(0,a.G)((0,n.jsx)(tM.r,{}));var l2=(0,a.G)((0,n.jsx)(ej.r,{}));(0,a.G)((0,n.jsx)(r7.r,{})),(0,a.G)((0,n.jsx)(ty.r,{})),(0,a.G)((0,n.jsx)(tk.r,{})),(0,a.G)((0,n.jsx)(eV.r,{})),(0,a.G)((0,n.jsx)(aE.r,{})),(0,a.G)((0,n.jsx)(os.r,{})),(0,a.G)((0,n.jsx)(a2.r,{})),(0,a.G)((0,n.jsx)(af.r,{})),(0,a.G)((0,n.jsx)(x.r,{})),(0,a.G)((0,n.jsx)(eB.r,{})),(0,a.G)((0,n.jsx)(oF.r,{})),(0,a.G)((0,n.jsx)(id.r,{})),(0,a.G)((0,n.jsx)(tD.r,{})),(0,a.G)((0,n.jsx)(tL.r,{})),(0,a.G)((0,n.jsx)(rc.r,{})),(0,a.G)((0,n.jsx)(rd.r,{})),(0,a.G)((0,n.jsx)(rM.r,{})),(0,a.G)((0,n.jsx)(aw.r,{}));var l5=(0,a.G)((0,n.jsx)(tT.r,{})),l4=(0,a.G)((0,n.jsx)(tb.r,{})),l7=(0,a.G)((0,n.jsx)(tU.r,{}));(0,a.G)((0,n.jsx)(nj.r,{}));var l8=(0,a.G)((0,n.jsx)(tc.r,{}));(0,a.G)((0,n.jsx)(eG.r,{})),(0,a.G)((0,n.jsx)(a9.r,{})),(0,a.G)((0,n.jsx)(m.r,{})),(0,a.G)((0,n.jsx)(g.r,{})),(0,a.G)((0,n.jsx)(f.r,{})),(0,a.G)((0,n.jsx)(d.r,{})),(0,a.G)((0,n.jsx)(p.r,{})),(0,a.G)((0,n.jsx)(u.r,{})),(0,a.G)((0,n.jsx)(v.r,{})),(0,a.G)((0,n.jsx)(eb.r,{})),(0,a.G)((0,n.jsx)(eF.r,{})),(0,a.G)((0,n.jsx)(nn.r,{})),(0,a.G)((0,n.jsx)(no.r,{})),(0,a.G)((0,n.jsx)(na.r,{})),(0,a.G)((0,n.jsx)(rA.r,{})),(0,a.G)((0,n.jsx)(rL.r,{})),(0,a.G)((0,n.jsx)(nm.r,{})),(0,a.G)((0,n.jsx)(nC.r,{}));var l6=(0,a.G)((0,n.jsx)(oP.r,{}));(0,a.G)((0,n.jsx)(ns.r,{})),(0,a.G)((0,n.jsx)(tS.r,{})),(0,a.G)((0,n.jsx)(t1.r,{})),(0,a.G)((0,n.jsx)(t0.r,{})),(0,a.G)((0,n.jsx)(nb.r,{}));var l9=(0,a.G)((0,n.jsx)(oJ.r,{})),l3=(0,a.G)((0,n.jsx)(P.r,{})),ce=(0,a.G)((0,n.jsx)(B.r,{})),ct=(0,a.G)((0,n.jsx)(R.r,{})),cr=(0,a.G)((0,n.jsx)(D.r,{}));(0,a.G)((0,n.jsx)(G.r,{}));var cn=(0,a.G)((0,n.jsx)(L.r,{})),ca=(0,a.G)((0,n.jsx)(M.r,{})),co=(0,a.G)((0,n.jsx)(N.r,{}));(0,a.G)((0,n.jsx)(A.r,{}));var ci=(0,a.G)((0,n.jsx)(T.r,{})),cs=(0,a.G)((0,n.jsx)(I.r,{})),cl=(0,a.G)((0,n.jsx)(E.r,{})),cc=(0,a.G)((0,n.jsx)(w.r,{})),cd=(0,a.G)((0,n.jsx)(C.r,{})),cu=(0,a.G)((0,n.jsx)(S.r,{})),cv=(0,a.G)((0,n.jsx)(b.r,{})),cm=(0,a.G)((0,n.jsx)(Z.r,{})),cg=(0,a.G)((0,n.jsx)(k.r,{})),cp=(0,a.G)((0,n.jsx)(y.r,{})),cf=(0,a.G)((0,n.jsx)(j.r,{})),ch=(0,a.G)((0,n.jsx)(iM.r,{}));(0,a.G)((0,n.jsx)(ic.r,{})),(0,a.G)((0,n.jsx)(az.r,{})),(0,a.G)((0,n.jsx)(aU.r,{})),(0,a.G)((0,n.jsx)(aF.r,{})),(0,a.G)((0,n.jsx)(aO.r,{})),(0,a.G)((0,n.jsx)(aW.r,{})),(0,a.G)((0,n.jsx)(o1.r,{})),(0,a.G)((0,n.jsx)(o4.r,{})),(0,a.G)((0,n.jsx)(o5.r,{})),(0,a.G)((0,n.jsx)(o2.r,{})),(0,a.G)((0,n.jsx)(aA.r,{})),(0,a.G)((0,n.jsx)(aM.r,{})),(0,a.G)((0,n.jsx)(nS.r,{})),(0,a.G)((0,n.jsx)(tp.r,{})),(0,a.G)((0,n.jsx)(eZ.r,{}));var c_=(0,a.G)((0,n.jsx)(op.r,{})),cx=(0,a.G)((0,n.jsx)(tH.r,{}));(0,a.G)((0,n.jsx)(eP.r,{})),(0,a.G)((0,n.jsx)(tj.r,{}));var cy=(0,a.G)((0,n.jsx)(tw.r,{})),cb=(0,a.G)((0,n.jsx)(tE.r,{}));(0,a.G)((0,n.jsx)(a_.r,{})),(0,a.G)((0,n.jsx)(t4.r,{}));var cS=(0,a.G)((0,n.jsx)(n8.r,{})),cC=(0,a.G)((0,n.jsx)(oz.r,{})),cj=(0,a.G)((0,n.jsx)(oW.r,{})),cw=(0,a.G)((0,n.jsx)(e3.r,{}));(0,a.G)((0,n.jsx)(rF.r,{})),(0,a.G)((0,n.jsx)(Y.r,{})),(0,a.G)((0,n.jsx)(eY.r,{})),(0,a.G)((0,n.jsx)(eX.r,{})),(0,a.G)((0,n.jsx)(to.r,{})),(0,a.G)((0,n.jsx)(rO.r,{})),(0,a.G)((0,n.jsx)(rz.r,{}));var cE=(0,a.G)((0,n.jsx)(tF.r,{}));(0,a.G)((0,n.jsx)(tP.r,{})),(0,a.G)((0,n.jsx)(td.r,{})),(0,a.G)((0,n.jsx)(ta.r,{})),(0,a.G)((0,n.jsx)(eL.r,{})),(0,a.G)((0,n.jsx)(e9.r,{})),(0,a.G)((0,n.jsx)(e6.r,{})),(0,a.G)((0,n.jsx)(eK.r,{})),(0,a.G)((0,n.jsx)(te.r,{})),(0,a.G)((0,n.jsx)(tl.r,{})),(0,a.G)((0,n.jsx)(tm.r,{})),(0,a.G)((0,n.jsx)(tv.r,{})),(0,a.G)((0,n.jsx)(tu.r,{})),(0,a.G)((0,n.jsx)(tx.r,{})),(0,a.G)((0,n.jsx)(eU.r,{}));var ck=(0,a.G)((0,n.jsx)(e0.r,{}));(0,a.G)((0,n.jsx)(tZ.r,{})),(0,a.G)((0,n.jsx)(ni.r,{})),(0,a.G)((0,n.jsx)(ef.r,{})),(0,a.G)((0,n.jsx)(er.r,{})),(0,a.G)((0,n.jsx)(ei.r,{})),(0,a.G)((0,n.jsx)(en.r,{}));var cI=(0,a.G)((0,n.jsx)(Q.r,{})),cT=(0,a.G)((0,n.jsx)(J.r,{})),cM=(0,a.G)((0,n.jsx)(X.r,{}));(0,a.G)((0,n.jsx)(sy.r,{})),(0,a.G)((0,n.jsx)(s_.r,{})),(0,a.G)((0,n.jsx)(sx.r,{})),(0,a.G)((0,n.jsx)(W.r,{}));var cA=(0,a.G)((0,n.jsx)(O.r,{})),cN=(0,a.G)((0,n.jsx)(K.r,{}));(0,a.G)((0,n.jsx)(z.r,{})),(0,a.G)((0,n.jsx)(F.r,{}));var cL=(0,a.G)((0,n.jsx)(q.r,{}));(0,a.G)((0,n.jsx)(U.r,{}));var cZ=(0,a.G)((0,n.jsx)(V.r,{})),cG=(0,a.G)((0,n.jsx)(H.r,{}));(0,a.G)((0,n.jsx)(s.r,{})),(0,a.G)((0,n.jsx)(l.r,{})),(0,a.G)((0,n.jsx)(rH.r,{})),(0,a.G)((0,n.jsx)(rV.r,{})),(0,a.G)((0,n.jsx)(rK.r,{})),(0,a.G)((0,n.jsx)(ex.r,{})),(0,a.G)((0,n.jsx)(e_.r,{})),(0,a.G)((0,n.jsx)(eH.r,{})),(0,a.G)((0,n.jsx)(tn.r,{})),(0,a.G)((0,n.jsx)(eh.r,{})),(0,a.G)((0,n.jsx)(ez.r,{})),(0,a.G)((0,n.jsx)(ts.r,{})),(0,a.G)((0,n.jsx)(h.r,{})),(0,a.G)((0,n.jsx)(_.r,{})),(0,a.G)((0,n.jsx)(ok.r,{})),(0,a.G)((0,n.jsx)(oE.r,{})),(0,a.G)((0,n.jsx)(tB.r,{})),(0,a.G)((0,n.jsx)(i3.r,{})),(0,a.G)((0,n.jsx)(tI.r,{})),(0,a.G)((0,n.jsx)(eW.r,{})),(0,a.G)((0,n.jsx)(e$.r,{})),(0,a.G)((0,n.jsx)(eJ.r,{})),(0,a.G)((0,n.jsx)(e5.r,{})),(0,a.G)((0,n.jsx)(tC.r,{}));var cP=(0,a.G)((0,n.jsx)(e1.r,{}));(0,a.G)((0,n.jsx)(tG.r,{})),(0,a.G)((0,n.jsx)(ew.r,{})),(0,a.G)((0,n.jsx)(ep.r,{})),(0,a.G)((0,n.jsx)(eo.r,{}));var cB=(0,a.G)((0,n.jsx)(i1.r,{}));(0,a.G)((0,n.jsx)(c.r,{})),(0,a.G)((0,n.jsx)(eg.r,{})),(0,a.G)((0,n.jsx)(em.r,{})),(0,a.G)((0,n.jsx)(ed.r,{})),(0,a.G)((0,n.jsx)(es.r,{}));var cR=(0,a.G)((0,n.jsx)(eu.r,{}));(0,a.G)((0,n.jsx)(iZ.r,{})),(0,a.G)((0,n.jsx)(tt.r,{})),(0,a.G)((0,n.jsx)(tW.r,{})),(0,a.G)((0,n.jsx)(tz.r,{})),(0,a.G)((0,n.jsx)(eR.r,{})),(0,a.G)((0,n.jsx)(st.r,{}));var cD=(0,a.G)((0,n.jsx)(sc.r,{}));(0,a.G)((0,n.jsx)(sl.r,{})),(0,a.G)((0,n.jsx)(sr.r,{})),(0,a.G)((0,n.jsx)(so.r,{}))},775699:function(e,t,r){r.d(t,{l0:()=>tO.Z,yh:()=>eK,HY:()=>d.HY,UO:()=>d.UO,Zb:()=>d.Zb,iz:()=>d.iz,JO:()=>d.JO,II:()=>E,u_:()=>d.u_,gn:()=>d.gn,FX:()=>d.FX,Ph:()=>d.Ph,NF:()=>te,BZ:()=>d.BZ,J2:()=>d.J2,XZ:()=>d.XZ,cO:()=>d.cO,iR:()=>d.iR,K4:()=>tk,_3:()=>em,u3:()=>E,T:()=>d.T,_n:()=>eP,M5:()=>eW,u:()=>d.u,Ee:()=>d.Ee,JL:()=>d.JL,Dj:()=>d.Dj,iV:()=>d.iV,eT:()=>d.eT,tl:()=>d.tl,Y8:()=>d.Y8,X2:()=>d.X2,Jm:()=>d.Jm,ZT:()=>d.Sx,yO:()=>tP,tz:()=>e0,FN:()=>d.FN,O$:()=>ty,aV:()=>d.aV,nb:()=>tt,mQ:()=>d.mQ,dG:()=>e7,fS:()=>td,dd:()=>eX,Ex:()=>d.Ex,Vp:()=>d.Vp,OF:()=>tR.Z,Rn:()=>d.Rn,rs:()=>d.rs,y$:()=>d.y$,Uu:()=>d.Uu,K9:()=>G,N5:()=>$,P6:()=>F,cl:()=>tB.Z,JX:()=>d.JX,Rg:()=>d.Rg,YZ:()=>ti,iA:()=>d.iA,qE:()=>d.qE,y3:()=>M,vy:()=>eV,gl:()=>eh,tL:()=>tF.Z,Iw:()=>d.Iw,Od:()=>d.Od,Kx:()=>d.Kx,hU:()=>d.hU,fI:()=>eF,FS:()=>eq,H3:()=>tE,XQ:()=>tD.Z,$:()=>el,oL:()=>tg,zx:()=>M,Q2:()=>tU.Z,CP:()=>tz.Z,ck:()=>tk,mp:()=>d.mp,q0:()=>eX,Cj:()=>J,Lt:()=>d.Lt,gq:()=>d.gq,jL:()=>d.jL,um:()=>d.um,yC:()=>d.yC});var n=r("808549"),a=r("120454"),o=r("473980"),i=r("151064"),s=r("455069"),l=r("252237"),c=r.n(l),d=r("561290"),u=r("407821"),v=r.n(u),m=r("472772"),g=r.n(m),p=r("395245"),f=r.n(p),h=r("297998"),_=r.n(h),x=r("646576"),y=r.n(x),b=r("606121"),S=r.n(b),C=r("34667"),j={};j.styleTagTransform=S(),j.setAttributes=_(),j.insert=f().bind(null,"head"),j.domAPI=g(),j.insertStyleElement=y(),v()(C.Z,j);var w=C.Z&&C.Z.locals?C.Z.locals:void 0,E=(0,s.forwardRef)((e,t)=>{var{className:r}=e,s=(0,o._)(e,["className"]);return(0,i.jsx)(d.II,(0,a._)((0,n._)({className:c()(r,w["ui-input"])},s),{ref:t}))}),k=r("103045"),I={};I.styleTagTransform=S(),I.setAttributes=_(),I.insert=f().bind(null,"head"),I.domAPI=g(),I.insertStyleElement=y(),v()(k.Z,I);var T=k.Z&&k.Z.locals?k.Z.locals:void 0,M=(0,s.forwardRef)((e,t)=>{var{className:r}=e,s=(0,o._)(e,["className"]);return(0,i.jsx)(d.zx,(0,a._)((0,n._)({},s),{className:c()(r,T.button,"borderless"!==s.theme&&T["button-min-width"],"small"===s.size&&T["button-size-small"],"default"===s.size&&T["button-size-default"]),ref:t}))}),A=r("869030"),N={};N.styleTagTransform=S(),N.setAttributes=_(),N.insert=f().bind(null,"head"),N.domAPI=g(),N.insertStyleElement=y(),v()(A.Z,N);var L=A.Z&&A.Z.locals?A.Z.locals:void 0,Z=(0,d.Q2)(E,{}),G=e=>{var t,r,{fieldClassName:l}=e,d=(0,o._)(e,["fieldClassName"]),u=(0,s.useRef)(null);return(0,i.jsx)("div",{style:{"--var-error-msg-offset":d.addonBefore?"".concat(null!==(r=null===(t=u.current)||void 0===t?void 0:t.offsetLeft)&&void 0!==r?r:0,"px"):"0px"},children:(0,i.jsx)(Z,(0,a._)((0,n._)({},d),{fieldClassName:c()(l,L.field),ref:u}))})},P=r("821284"),B={};B.styleTagTransform=S(),B.setAttributes=_(),B.insert=f().bind(null,"head"),B.domAPI=g(),B.insertStyleElement=y(),v()(P.Z,B);var R=P.Z&&P.Z.locals?P.Z.locals:void 0,D=(0,d.Q2)(d.Kx,{}),F=(0,s.forwardRef)((e,t)=>{var{fieldClassName:r}=e,s=(0,o._)(e,["fieldClassName"]);return(0,i.jsx)(D,(0,a._)((0,n._)({ref:t},s),{fieldClassName:c()(r,R.field)}))}),U=r("825251"),O=r("70131"),z=r("896335"),W=r("44172"),H=r("180380"),K=r("461299"),V={};V.styleTagTransform=S(),V.setAttributes=_(),V.insert=f().bind(null,"head"),V.domAPI=g(),V.insertStyleElement=y(),v()(K.Z,V);var q=K.Z&&K.Z.locals?K.Z.locals:void 0,Y=e=>{var{disabled:t,label:r,onClick:n,selected:a,value:o,key:s,optionClassName:l}=e;return(0,i.jsxs)("div",{className:c()(q["ui-select-option"],t&&q["ui-select-option-disabled"],a&&q["ui-select-option-selected"],l),onClick:e=>{if(!t)null==n||n(e)},"data-testid":"ui.select.option",children:[(0,i.jsx)("div",{className:q["ui-select-option-icon"],children:(0,i.jsx)(W.v$_,{className:q.icon})}),(0,z.Z)(r)?(0,i.jsx)("div",{className:q["ui-select-option-text"],children:r}):r]},s||o)},X=(0,s.forwardRef)((e,t)=>{var{theme:r,className:s,label:l,size:u="default",clickToHide:v=!0}=e,m=(0,o._)(e,["theme","className","label","size","clickToHide"]),{selectedClassname:g}=m;return"borderless"===r?(0,i.jsx)(d.Ph,(0,a._)((0,n._)({},m),{ref:t,clickToHide:v,className:c()(s,q["borderless-ui-select"],q["ui-select"],q["ui-select-".concat(u)]),triggerRender:e=>{var t;return(0,i.jsxs)("div",{className:q["filter-content"],"data-testid":"ui.select.trigger",children:[l&&(0,i.jsx)("div",{className:q["filter-label"],children:"".concat(l,":")}),(0,i.jsxs)("div",{className:c()(q["borderless-filter-render"],q["size-".concat(u)]),children:[(0,i.jsx)(d.Sx.Text,{ellipsis:!0,className:c()(q["borderless-filter-text"],g),children:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.map(e=>e.label)}),(0,i.jsx)(H.Z,{className:q["filter-icon"]})]})]})}})):(0,i.jsx)(d.Ph,(0,a._)((0,n._)({},m),{ref:t,clickToHide:v,className:c()(s,q["ui-select"],q["light-ui-select"],q["ui-select-".concat(u)])}))}),J=(0,s.forwardRef)((e,t)=>{var{theme:r="borderless",dropdownClassName:a,maxHeight:s=216}=e,l=(0,o._)(e,["theme","dropdownClassName","maxHeight"]);return(0,i.jsx)(X,(0,n._)({clickToHide:!0,ref:t,renderOptionItem:e=>(0,i.jsx)(Y,(0,n._)({},e)),theme:r,dropdownClassName:c()(a,q["ui-select-dropdown"]),maxHeight:s},l))});J.OptGroup=d.Ph.OptGroup,J.Option=d.Ph.Option;var Q=(0,d.Q2)(e=>(0,i.jsx)(J,(0,n._)({},e))),$=e=>{var t=(0,U._)({},(0,O._)(e));return(0,i.jsx)(Q,(0,a._)((0,n._)({},t),{theme:"light"}))};$.Option=J.Option,$.OptGroup=J.OptGroup;var ee=r("131325"),et=r("365798"),er=r("416290"),en=r("69650"),ea=r("382174"),eo=r("579167"),ei={};ei.styleTagTransform=S(),ei.setAttributes=_(),ei.insert=f().bind(null,"head"),ei.domAPI=g(),ei.insertStyleElement=y(),v()(eo.Z,ei);var es=eo.Z&&eo.Z.locals?eo.Z.locals:void 0,el=(0,s.forwardRef)((e,t)=>{var r,{offsetY:l=0,scrollX:u=0,tableProps:v,empty:m,total:g=0,onLoad:p,enableLoad:f,wrapperClassName:h,useHoverStyle:_=!0,mergeTableList:x=(e,t)=>[...e,...t]}=e,y=null!=v?v:{},{dataSource:b}=y,S=(0,o._)(y,["dataSource"]),C=(0,er.Z)(document.body),[j,w]=(0,s.useState)(!1);(0,s.useEffect)(()=>{!(null==S?void 0:S.loading)&&w(!0)},[null==S?void 0:S.loading]);var E=j&&!!(null==b?void 0:b.length),k=(0,s.useRef)(),I=(0,s.useRef)(null),T=(0,s.useRef)(p),M=(0,s.useRef)(!1),[A,N]=(0,s.useState)([]),L=(0,s.useRef)(!1),Z=g>A.length,G=Z&&!S.loading,P=(0,s.useRef)(G),B=(0,s.useRef)(null);return null===(r=B.current)||void 0===r||r.changeState({done:g<=A.length}),(0,s.useEffect)(()=>{T.current=p,P.current=!!f&&G},[p,G,f]),(0,s.useEffect)(()=>{P.current&&f&&!M.current?N(e=>x(e,null!=b?b:[])):N(null!=b?b:[]),M.current=!1},[b,f]),(0,s.useEffect)(()=>{if(!I.current||!f||!Z)return()=>{var e;null===(e=k.current)||void 0===e||e.unmount(),P.current=!0,L.current=!1};var e=I.current.tableRef.current.bodyWrapRef.current;if(f&&!L.current){var t=document.createElement("div");e.append(t),k.current=(0,ee.createRoot)(t),k.current.render((0,i.jsx)(ec,{ref:B,onIntersecting:e=>{if(e&&P.current){var t;null===(t=T.current)||void 0===t||t.call(T)}}})),L.current=!0}},[E,f,Z]),(0,s.useImperativeHandle)(t,()=>(0,et.Z)({},I.current,{reset:()=>{M.current=!0},getTableList:()=>A})),(0,i.jsxs)("div",{className:c()(es["table-wrapper"],h),children:[!j&&(0,i.jsx)("div",{className:es["spin-container"],children:(0,i.jsx)(d.yC,{spinning:!0,size:"large"})}),E?(0,i.jsx)(d.iA,(0,a._)((0,n._)({ref:I,pagination:!1,scroll:{y:((null==C?void 0:C.height)||0)-l,x:u}},S),{className:c()(es["table-list"],S.className,{[es.tableListHoverStyle]:_}),loading:!f&&(null==S?void 0:S.loading),dataSource:f?A:b})):null,!j||(null==S?void 0:S.loading)||(null==b?void 0:b.length)?null:(0,i.jsx)("div",{className:es["empty-content"],children:m})]})}),ec=(0,s.forwardRef)((e,t)=>{var{onIntersecting:r}=e,{i18n:n}=(0,s.useContext)(en.g),a=(0,s.useRef)(null),[o,l]=(0,s.useState)({done:!1});return(0,s.useEffect)(()=>{var e=new IntersectionObserver(e=>{var t;r(null===(t=e[0])||void 0===t?void 0:t.isIntersecting)});return a.current&&e.observe(a.current),()=>e.disconnect()},[]),(0,s.useImperativeHandle)(t,()=>({changeState:l})),o.done?null:(0,i.jsxs)("div",{ref:a,className:es.indicator,children:[!o.done&&(0,i.jsx)(ea.Z,{className:es["indicator-loading"]}),(0,i.jsx)("span",{children:o.done?"":n.t("loading")})]})}),ed=r("285886"),eu={};eu.styleTagTransform=S(),eu.setAttributes=_(),eu.insert=f().bind(null,"head"),eu.domAPI=g(),eu.insertStyleElement=y(),v()(ed.Z,eu);var ev=ed.Z&&ed.Z.locals?ed.Z.locals:void 0,em=(0,s.forwardRef)((e,t)=>{var{className:r,wrapperClass:s,iconSize:l="default"}=e,u=(0,o._)(e,["className","wrapperClass","iconSize"]);return(0,i.jsx)("div",{className:c()(ev["icon-button"],ev["icon-button-".concat(l)],s),children:(0,i.jsx)(d.zx,(0,a._)((0,n._)({ref:t,className:c()(r)},u),{size:"small",theme:"borderless"}))})}),eg=r("27702"),ep={};ep.styleTagTransform=S(),ep.setAttributes=_(),ep.insert=f().bind(null,"head"),ep.domAPI=g(),ep.insertStyleElement=y(),v()(eg.Z,ep);var ef=eg.Z&&eg.Z.locals?eg.Z.locals:void 0,eh=e=>{var t,r,{i18n:o}=(0,s.useContext)(en.g),{editProps:l,deleteProps:c,copyProps:u}=e,v=(0,s.useCallback)(t=>{var r=e["".concat(t,"Props")];return{color:(null==r?void 0:r.disabled)?"rgba(136, 138, 142, 0.5)":"rgba(136, 138, 142, 1)"}},[l,c,u]);return(0,i.jsxs)("div",{className:ef["ui-action-content"],onClick:e=>{e.stopPropagation()},children:[u&&!u.hide?(0,i.jsx)(d.u,(0,a._)((0,n._)({spacing:12,content:o.t("Copy"),position:"top"},null==u?void 0:u.tooltip),{children:(0,i.jsx)("span",{className:ef["action-btn"],children:(0,i.jsx)(em,{disabled:null==u?void 0:u.disabled,icon:(0,i.jsx)(W.vUr,{className:ef.icon}),onClick:null==u?void 0:u.handler,style:v("copy"),"data-testid":"ui.table-action.copy"})})})):null,l&&!l.hide?(0,i.jsx)(d.u,(0,a._)((0,n._)({spacing:12,content:o.t("Edit"),position:"top"},null==l?void 0:l.tooltip),{children:(0,i.jsx)("span",{className:ef["action-btn"],children:(0,i.jsx)(em,{disabled:null==l?void 0:l.disabled,icon:(0,i.jsx)(W.yl5,{className:ef.icon}),onClick:null==l?void 0:l.handler,style:v("edit"),"data-testid":"ui.table-action.edit"})})})):null,!c.hide&&(0,i.jsx)("div",{children:(0,i.jsx)(d.gn,(0,a._)((0,n._)({trigger:"click",okType:"danger",title:o.t("delete_title"),content:o.t("delete_desc"),okText:o.t("confirm"),cancelText:o.t("cancel"),style:{width:350},icon:null!==(r=null==c?void 0:null===(t=c.popconfirm)||void 0===t?void 0:t.icon)&&void 0!==r?r:(0,i.jsx)(W.rPP,{})},c.popconfirm),{onConfirm:null==c?void 0:c.handler,disabled:c.disabled,children:(0,i.jsx)("span",{children:(0,i.jsx)(d.u,(0,a._)((0,n._)({spacing:12,content:o.t("Delete"),position:"top"},c.tooltip),{children:(0,i.jsx)(em,{disabled:c.disabled,icon:(0,i.jsx)(W.WDf,{className:ef.icon}),style:v("delete"),onClick:c.handleClick,"data-testid":"ui.table-action.delete"})}))})}))})]})},e_=r("39181"),ex={};ex.styleTagTransform=S(),ex.setAttributes=_(),ex.insert=f().bind(null,"head"),ex.domAPI=g(),ex.insertStyleElement=y(),v()(e_.Z,ex),e_.Z&&e_.Z.locals&&e_.Z.locals;var ey=r("187615"),eb={};eb.styleTagTransform=S(),eb.setAttributes=_(),eb.insert=f().bind(null,"head"),eb.domAPI=g(),eb.insertStyleElement=y(),v()(ey.Z,eb),ey.Z&&ey.Z.locals&&ey.Z.locals;var eS=r("59955"),eC=r("68021"),ej={};ej.styleTagTransform=S(),ej.setAttributes=_(),ej.insert=f().bind(null,"head"),ej.domAPI=g(),ej.insertStyleElement=y(),v()(eC.Z,ej);var ew=eC.Z&&eC.Z.locals?eC.Z.locals:void 0,eE=r("120341"),ek={};ek.styleTagTransform=S(),ek.setAttributes=_(),ek.insert=f().bind(null,"head"),ek.domAPI=g(),ek.insertStyleElement=y(),v()(eE.Z,ek);var eI=eE.Z&&eE.Z.locals?eE.Z.locals:void 0,eT=r("535220"),eM={};eM.styleTagTransform=S(),eM.setAttributes=_(),eM.insert=f().bind(null,"head"),eM.domAPI=g(),eM.insertStyleElement=y(),v()(eT.Z,eM);var eA=eT.Z&&eT.Z.locals?eT.Z.locals:void 0,eN=(0,s.forwardRef)((e,t)=>{var{className:r,children:n}=e;return(0,i.jsx)("div",{ref:t,className:c()(eA["ui-content"],r),children:n})}),eL=r("765087"),eZ={};eZ.styleTagTransform=S(),eZ.setAttributes=_(),eZ.insert=f().bind(null,"head"),eZ.domAPI=g(),eZ.insertStyleElement=y(),v()(eL.Z,eZ);var eG=eL.Z&&eL.Z.locals?eL.Z.locals:void 0,eP=e=>{var{className:t,children:r,title:n}=e,{i18n:a}=(0,s.useContext)(en.g),o=n||a.t("platform_name");return(0,i.jsxs)("div",{className:c()(eG["ui-layout"],t),children:[(0,i.jsx)(eS.q,{children:(0,i.jsx)("title",{children:o})}),r]})};eP.Header=e=>{var{className:t,children:r,title:n="",breadcrumb:a}=e;return(0,i.jsxs)("div",{className:c()(ew["ui-header"],t),"data-testid":"ui.header",children:[n&&(0,i.jsx)("div",{className:ew.title,children:n}),!!a&&a,r]})},eP.Content=eN,eP.Footer=e=>{var{className:t,children:r}=e;return(0,i.jsx)("div",{className:c()(eI["ui-footer"],t),children:r})};var eB=r("504613"),eR={};eR.styleTagTransform=S(),eR.setAttributes=_(),eR.insert=f().bind(null,"head"),eR.domAPI=g(),eR.insertStyleElement=y(),v()(eB.Z,eR);var eD=eB.Z&&eB.Z.locals?eB.Z.locals:void 0,eF=e=>{var{children:t,wrapperClass:r,containerClass:s,theme:l="black"}=e,u=(0,o._)(e,["children","wrapperClass","containerClass","theme"]);return(0,i.jsx)("div",{className:c()(eD["ui-tab-bar"],eD["tab-bar-".concat(l)],r),children:(0,i.jsx)(d.mQ,(0,a._)((0,n._)({},u),{tabPaneMotion:!1,type:"button",renderTabBar:(e,r)=>(0,i.jsxs)("div",{className:c()(eD.header,s),children:[(0,i.jsx)(r,(0,n._)({},e)),(0,i.jsx)("div",{className:eD["tool-bar"],children:t})]})}))})},eU=r("562201"),eO={};eO.styleTagTransform=S(),eO.setAttributes=_(),eO.insert=f().bind(null,"head"),eO.domAPI=g(),eO.insertStyleElement=y(),v()(eU.Z,eO);var ez=eU.Z&&eU.Z.locals?eU.Z.locals:void 0;class eW extends d.u_{render(){var e=this.props,{centered:t=!0,type:r="info",showScrollBar:s=!1,className:l,okButtonProps:u,cancelButtonProps:v}=e,m=(0,o._)(e,["centered","type","showScrollBar","className","okButtonProps","cancelButtonProps"]);return(0,i.jsx)(d.u_,(0,a._)((0,n._)({},m),{maskClosable:!1,centered:t,cancelButtonProps:(0,n._)({style:(0,n._)({minWidth:"96px"},null==v?void 0:v.style)},v),okButtonProps:(0,n._)({style:(0,n._)({minWidth:"96px"},null==u?void 0:u.style)},u),className:c()(ez["modal-".concat(r)],ez["ui-modal"],s&&ez["show-scroll-bar"],l)}))}constructor(e){super(e),this.props=e}}eW.defaultProps.centered=!0;var eH=r("979838"),eK=e=>{var{children:t,style:r,className:n}=e;return(0,i.jsx)("div",{style:r,className:c()(n,ez["aside-main"]),children:t})};eK.Header=e=>{var{children:t,className:r,style:n}=e;return(0,i.jsx)("div",{className:c()(r,ez["aside-header"]),style:n,children:t})},eK.Divider=e=>{var{className:t,style:r}=e;return(0,i.jsx)(d.iz,{margin:12,className:c()(t,ez["aside-divider"]),style:r})},eK.Content=e=>{var{children:t,className:r,style:n}=e;return(0,i.jsx)("div",{className:r,style:n,children:t})};var eV=e=>{var{children:t,style:r,className:n}=e;return(0,i.jsx)("div",{style:r,className:c()(n,ez.main),children:t})};eV.Header=e=>{var{children:t,className:r,style:n}=e;return(0,i.jsx)("div",{className:c()(["main-header"],r),style:n,children:t})},eV.Content=e=>{var{children:t,className:r,style:n}=e;return(0,i.jsx)("div",{className:c()(r,ez["main-content"]),style:n,children:t})};var eq=e=>{var{sider:t,content:r,header:s,filter:l,extra:d}=e,u=(0,o._)(e,["sider","content","header","filter","extra"]);return(0,i.jsx)(eW,(0,a._)((0,n._)({},u),{type:"base-composition",header:null,footer:null,className:c()(ez["ui-composition-modal"],u.className),children:(0,i.jsxs)("div",{className:ez["composition-modal-layout"],children:[(0,i.jsxs)("div",{className:c()(ez.aside,u.siderWrapperClassName),children:[(0,i.jsx)("div",{className:ez.title,children:s}),t]}),(0,i.jsxs)("div",{className:ez.content,children:[(0,i.jsxs)("div",{className:c()({[ez.header]:!0,[ez["filter-empty"]]:!l}),children:[l,d,(0,i.jsx)(em,{"data-testid":"close-icon-button",type:"tertiary",icon:(0,i.jsx)(eH.Z,{}),onClick:u.onCancel})]}),r]})]})}))},eY=(0,s.forwardRef)((e,t)=>{var{type:r="info",hideOkButton:s=!1,hideContent:l=!1,hideCancelButton:u=!1,showCloseIcon:v=!1,className:m,centered:g=!0,okButtonProps:p,cancelButtonProps:f}=e,h=(0,o._)(e,["type","hideOkButton","hideContent","hideCancelButton","showCloseIcon","className","centered","okButtonProps","cancelButtonProps"]);return(0,i.jsx)(d.u_,(0,a._)((0,n._)({},h),{maskClosable:!1,ref:t,centered:g,header:(0,i.jsx)("div",{className:"semi-modal-header",style:{paddingTop:l?"1rem":"0"},children:(0,i.jsx)("h5",{className:"semi-typography semi-modal-title semi-typography-primary semi-typography-normal semi-typography-h5",id:"semi-modal-title","x-semi-prop":"title",children:h.title})}),cancelButtonProps:(0,n._)({style:(0,n._)({width:s?"100%":"7.25rem"},null==f?void 0:f.style)},f),okButtonProps:(0,n._)({style:(0,n._)({width:u?"100%":"7.25rem"},null==p?void 0:p.style)},p),hasCancel:!u,className:c()(ez["modal-".concat(r)],ez["ui-mobile-modal"],m)}))}),eX=e=>{var{type:t="info",centered:r=!0,isMobile:l=!1}=e,c=(0,o._)(e,["type","centered","isMobile"]),[d,u]=(0,s.useState)(!1);return{modal:e=>l?(0,i.jsx)(eY,(0,a._)((0,n._)({type:t,centered:r},c),{visible:d,children:e})):(0,i.jsx)(eW,(0,a._)((0,n._)({type:t,centered:r},c),{visible:d,children:e})),open:()=>u(!0),close:()=>u(!1),visible:d}},eJ=r("607251"),eQ={};eQ.styleTagTransform=S(),eQ.setAttributes=_(),eQ.insert=f().bind(null,"head"),eQ.domAPI=g(),eQ.insertStyleElement=y(),v()(eJ.Z,eQ);var e$=eJ.Z&&eJ.Z.locals?eJ.Z.locals:void 0,e0=e=>{var{tabs:{tabsProps:t,tabPanes:r}}=e,s=(0,o._)(e,["tabs"]);return(0,i.jsx)(eW,(0,a._)((0,n._)({},s),{type:"base-composition",header:null,footer:null,className:c()(e$["ui-tabs-modal"],s.className),children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(em,{wrapperClass:e$["close-btn"],type:"tertiary",icon:(0,i.jsx)(eH.Z,{}),onClick:s.onCancel}),(0,i.jsx)(d.mQ,(0,a._)((0,n._)({},t),{contentStyle:{flex:1,padding:0,overflowY:"hidden"},className:c()(e$.tabs,null==t?void 0:t.className),children:r.map((e,t)=>{var r,{tabPaneProps:o,content:s}=e;return(0,i.jsx)(d.Jm,(0,a._)((0,n._)({},o),{className:c()(e$["tab-pane"],o.className),children:s}),null!==(r=o.itemKey)&&void 0!==r?r:t)})}))]})}))},e1=r("921463"),e2=r("871873"),e5=()=>{var e=(0,s.useRef)(null),t=(0,s.useRef)(null),r=(0,s.useRef)(!1),n=(0,s.useRef)(0);return{getGrabAnchorBufferExceed:()=>n.current>10,updateCheckState:n=>{var{currentLeft:a,currentTop:o}=n,i=a===e.current&&o===t.current;r.current=i,e.current=a,t.current=o},updateGrabAnchorBuffer:()=>{n.current+=1},getShouldUpdateGrabAnchor:()=>r.current,refreshCheckState:()=>{r.current=!1,n.current=0}}},e4=e=>{var{grabTarget:t,grabAnchor:r=t,isModifyStyle:n,onPositionChange:a}=e,[o,i]=(0,s.useState)(!1),l=(0,s.useRef)(!1),c=(0,s.useRef)(0),d=(0,s.useRef)(0),{getGrabAnchorBufferExceed:u,getShouldUpdateGrabAnchor:v,updateCheckState:m,updateGrabAnchorBuffer:g,refreshCheckState:p}=e5(),f=e=>{i(e),l.current=e},h=(0,s.useCallback)(e=>{var r=document.documentElement,o=t.current;if(!l.current||!o)return;e.preventDefault();var i=Math.min(Math.max(e.clientX-c.current,0),r.offsetWidth-o.offsetWidth),s=Math.min(Math.max(e.clientY-d.current,0),r.offsetHeight-o.offsetHeight);if(m({currentLeft:i,currentTop:s}),null==a||a({top:s,left:i}),!!n)o.style.left="".concat(i,"px"),o.style.top="".concat(s,"px")},[]),_=(0,s.useCallback)(()=>{f(!1),x(),p()},[]),x=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",_)},y=()=>{document.addEventListener("mousemove",h),document.addEventListener("mouseup",_)},b=e=>{var r=t.current;if(!!r){var n=r.offsetLeft,a=r.offsetTop;c.current=e.clientX-n,d.current=e.clientY-a}};return{subscribeGrab:()=>{var e=r.current;if(!!e){var t=e=>{if(0===e.button)y(),f(!0),e.stopPropagation(),b(e)},n=e=>{if(!l.current||!v())return;if(g(),!!u())b(e),p()};return e.addEventListener("mousedown",t),e.addEventListener("mousemove",n),()=>{e.removeEventListener("mousedown",t),e.removeEventListener("mousemove",n),p(),x()}}},grabbing:o}},e7=e=>{var{className:t,style:r,visible:o,title:l,zIndex:d,footer:u,children:v,onCancel:m,type:g,focusKey:p,onWindowFocus:f}=(0,e2.Z)({},e7.defaultProps,e),h=(0,s.useRef)(null),_=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;return o&&(e=x()),()=>{null==e||e()}},[o]);var{subscribeGrab:x,grabbing:y}=e4({grabTarget:_,grabAnchor:h,isModifyStyle:!0});return o?(0,e1.createPortal)((0,i.jsx)("div",{className:ez["drag-modal"],children:(0,i.jsxs)("div",{className:c()(ez["modal-".concat(g)],ez["drag-modal-wrapper"],!!u&&ez["footer-custom"],t),ref:_,onMouseDown:()=>{p&&(null==f||f(p))},style:(0,a._)((0,n._)({},r),{zIndex:d}),children:[(0,i.jsxs)("div",{ref:h,className:ez["drag-modal-wrapper-title"],style:{cursor:y?"grabbing":"grab"},children:[l,(0,i.jsx)(M,{className:ez["drag-modal-wrapper-close-btn"],onClick:m,icon:(0,i.jsx)(eH.Z,{}),size:"small",theme:"borderless"})]}),(0,i.jsx)("div",{className:ez["drag-modal-wrapper-content"],children:v}),u?(0,i.jsx)("div",{className:ez["drag-modal-wrapper-footer"],children:u}):null]})}),document.body):null};e7.defaultProps={type:"info"};var e8=()=>document.documentElement.clientWidth<=640,e6=r("252735"),e9={};e9.styleTagTransform=S(),e9.setAttributes=_(),e9.insert=f().bind(null,"head"),e9.domAPI=g(),e9.insertStyleElement=y(),v()(e6.Z,e9);var e3=e6.Z&&e6.Z.locals?e6.Z.locals:void 0,te=e=>{var{children:t,brandNode:r}=e;return(0,i.jsxs)("div",{className:e8()?e3["mobile-frame"]:e3.frame,children:[!e8()&&(0,i.jsx)("div",{className:e3.brand,children:r}),t]})},tt=e=>{var{className:t,children:r}=e;return(0,i.jsx)("div",{className:c()(e8()?e3["mobile-panel"]:e3.panel,t),children:r})},tr=r("763055"),tn=r("455923"),ta={};ta.styleTagTransform=S(),ta.setAttributes=_(),ta.insert=f().bind(null,"head"),ta.domAPI=g(),ta.insertStyleElement=y(),v()(tn.Z,ta);var to=tn.Z&&tn.Z.locals?tn.Z.locals:void 0;function ti(e){var{className:t,isNotFound:r=!1,empty:n,notFound:a}=e;return(0,i.jsx)("div",{className:c()(to["ui-empty"],t),children:r?(0,i.jsx)(d.HY,{title:null==a?void 0:a.title,image:(null==a?void 0:a.icon)?a.icon:(0,i.jsx)(tr.xs,{style:{width:150,height:"100%"}}),darkModeImage:(null==a?void 0:a.iconDarkMode)?a.iconDarkMode:(0,i.jsx)(tr.m3,{style:{width:150,height:"100%"}})}):(0,i.jsx)(d.HY,{title:null==n?void 0:n.title,description:(null==n?void 0:n.description)||"",image:(null==n?void 0:n.icon)?n.icon:(0,i.jsx)(tr.ts,{style:{width:150,height:"100%"}}),darkModeImage:(null==n?void 0:n.iconDarkMode)?n.iconDarkMode:(0,i.jsx)(tr.Id,{style:{width:150,height:"100%"}}),children:!!(null==n?void 0:n.btnText)&&(0,i.jsx)(M,{theme:"solid",onClick:null==n?void 0:n.btnOnClick,loading:null==n?void 0:n.loading,style:{opacity:(null==n?void 0:n.loading)?.6:1},children:n.btnText})})})}ti.Semi=d.HY;var ts=r("983334"),tl={};tl.styleTagTransform=S(),tl.setAttributes=_(),tl.insert=f().bind(null,"head"),tl.domAPI=g(),tl.insertStyleElement=y(),v()(ts.Z,tl);var tc=ts.Z&&ts.Z.locals?ts.Z.locals:void 0,td=(0,s.forwardRef)((e,t)=>{var{className:r}=e,s=(0,o._)(e,["className"]);return(0,i.jsx)(d.Vp,(0,a._)((0,n._)({},s),{className:c()(tc["ui-tag"],r),ref:t}))}),tu=r("192190"),tv={};tv.styleTagTransform=S(),tv.setAttributes=_(),tv.insert=f().bind(null,"head"),tv.domAPI=g(),tv.insertStyleElement=y(),v()(tu.Z,tv);var tm=tu.Z&&tu.Z.locals?tu.Z.locals:void 0;function tg(e){var{dropdownClassName:t,className:r}=e,s=(0,o._)(e,["dropdownClassName","className"]);return(0,i.jsx)(d.vT,(0,a._)((0,n._)({},s),{className:c()(r,tm["ui-cascader"]),dropdownClassName:c()(t,tm["ui-cascader-dropdown"])}))}tg.FormItem=(0,d.Q2)(tg);var tp=r("580868"),tf=r("346707"),th=r("786338"),t_={};t_.styleTagTransform=S(),t_.setAttributes=_(),t_.insert=f().bind(null,"head"),t_.domAPI=g(),t_.insertStyleElement=y(),v()(th.Z,t_);var tx=th.Z&&th.Z.locals?th.Z.locals:void 0;d.FN.config({top:80});var ty=d.x1.create();function tb(e){var{className:t,icon:r}=e,a=(0,o._)(e,["className","icon"]);return d.FN.create(function(e){return(0,tp.Z)(e,tf.Z)}((0,n._)({className:c()(tx.container,t),icon:(()=>{if(r)return r;switch(a.type){case"success":return(0,i.jsx)(W.PUI,{className:tx.icon});case"warning":return(0,i.jsx)(W.yok,{className:tx.icon});case"error":return(0,i.jsx)(W.z2G,{className:tx.icon});case"info":return(0,i.jsx)(W.Zog,{className:tx.icon});default:return}})(),theme:"light",showClose:!1,top:80},a)))}function tS(e){return t=>(0,z.Z)(t)?tb({content:t,type:e}):tb((0,e2.Z)({},t,{type:e}))}ty.create=tS(),ty.info=tS("info"),ty.error=tS("error"),ty.success=tS("success"),ty.warning=tS("warning");var tC=r("909713"),tj={};tj.styleTagTransform=S(),tj.setAttributes=_(),tj.insert=f().bind(null,"head"),tj.domAPI=g(),tj.insertStyleElement=y(),v()(tC.Z,tj);var tw=tC.Z&&tC.Z.locals?tC.Z.locals:void 0,tE=e=>(0,i.jsx)(d.Lt.Menu,(0,a._)((0,n._)({},e),{className:c()(tw.menu,e.className)})),tk=e=>(0,i.jsx)(d.Lt.Item,(0,a._)((0,n._)({},e),{className:c()(tw.item,e.className)})),tI=r("633441"),tT={};tT.styleTagTransform=S(),tT.setAttributes=_(),tT.insert=f().bind(null,"head"),tT.domAPI=g(),tT.insertStyleElement=y(),v()(tI.Z,tT),tI.Z&&tI.Z.locals&&tI.Z.locals;var tM=r("986136"),tA={};tA.styleTagTransform=S(),tA.setAttributes=_(),tA.insert=f().bind(null,"head"),tA.domAPI=g(),tA.insertStyleElement=y(),v()(tM.Z,tA),tM.Z&&tM.Z.locals&&tM.Z.locals;var tN=(0,s.forwardRef)((e,t)=>{var{onSearch:r,onChange:l,onCompositionStart:c,onCompositionUpdate:d,onCompositionEnd:u}=e,v=(0,o._)(e,["onSearch","onChange","onCompositionStart","onCompositionUpdate","onCompositionEnd"]),m=(0,s.useRef)(!1),g=(0,s.useRef)(null);return(0,s.useImperativeHandle)(t,()=>g.current),(0,i.jsx)(E,(0,a._)((0,n._)({},v),{"data-testid":"ui.search-input",ref:g,onChange:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==l||l(...t),!m.current&&(null==r||r(t[0]))},onCompositionStart:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];null==c||c(...t),m.current=!0},onCompositionUpdate:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];null==d||d(...t),m.current=!0},onCompositionEnd:function(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];null==u||u(...n),m.current=!1,null==r||r(null===(e=g.current)||void 0===e?void 0:e.value)}}))}),tL=r("577257"),tZ={};tZ.styleTagTransform=S(),tZ.setAttributes=_(),tZ.insert=f().bind(null,"head"),tZ.domAPI=g(),tZ.insertStyleElement=y(),v()(tL.Z,tZ);var tG=tL.Z&&tL.Z.locals?tL.Z.locals:void 0,tP=(0,s.forwardRef)((e,t)=>{var{loading:r,onSearch:l,onChange:d,showClear:u=!0,value:v,prefix:m}=e,g=(0,o._)(e,["loading","onSearch","onChange","showClear","value","prefix"]),[p,f]=(0,s.useState)(e.value);return(0,s.useEffect)(()=>{f(v)},[v]),(0,i.jsx)(tN,(0,a._)((0,n._)({},g),{ref:t,value:p,showClear:u,onChange:(e,t)=>{f(e),null==d||d(e,t)},className:c()(tG["ui-search"],e.className),prefix:s.isValidElement(m)?m:(0,i.jsx)("div",{className:c()(tG["icon-search"],p&&tG.active),children:(0,i.jsx)(W.nCf,{})}),onSearch:l}))}),tB=r("585818"),tR=r("902097"),tD=r("399167"),tF=r("824750"),tU=r("561412"),tO=r("435280"),tz=r("913932")},715363:function(e,t,r){r.d(t,{he:()=>ev,yt:()=>$});var n,a,o,i=r("151064"),s=r("455069"),l=r("155440"),c=r("896335"),d=r("252237"),u=r.n(d),v=r("64605");var m=((n={})[n.Hidden=0]="Hidden",n[n.Visible=1]="Visible",n[n.Half=2]="Half",n[n.Last=3]="Last",n),g=r("227997"),p=r.n(g);function f(e){return!!(e&&e instanceof p())}var h=e=>{switch(e){case m.Visible:return m.Half;case m.Last:return m.Hidden;default:return e}},_=e=>{if(!(0,v.Z)(e)||f(e))return[{path:[],lines:[],value:e,isObj:!1,children:[]}];var t=new Map,r=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!(0,v.Z)(e)||f(e))return[];var a=t.get(n)||[],o=Object.keys(e);return o.map((i,s)=>{var l=e[i],c=n.concat(i),d=s===o.length-1,u=a.map(h).concat(d?m.Last:m.Visible);return t.set(c,u),{path:c,lines:u,value:l,children:r(l,c),isObj:(0,v.Z)(l)&&!f(l)}})};return r(e)},x=r("808549"),y=r("120454"),b=r("15474"),S=r("392300"),C=(e,t)=>{var r;return t?j(e):1===e.length&&(null===(r=e[0])||void 0===r?void 0:r.isObj)?{[e[0].path.join(".")]:!0}:null},j=e=>e.reduce((e,t)=>(0,x._)((0,y._)((0,x._)({},e),{[t.path.join(".")]:!0}),j(t.children)),{}),w=(0,b.kr)({expand:{},onExpand:S.Z}),E=e=>{var{fields:t,children:r,defaultExpandAllFields:n}=e,[a,o]=(0,s.useState)(null),l=(0,s.useCallback)((e,t)=>o(r=>(0,y._)((0,x._)({},r),{[e]:t})),[o]);return(0,s.useEffect)(()=>{if(!a){var e=C(t,n);e&&o(e)}},[a,t,o,n]),(0,i.jsx)(w.Provider,{value:{expand:a,onExpand:l},children:r})},k=e=>{var{text:t}=e,r=t.split("\n");return(0,i.jsx)("div",{className:"flex",children:(0,i.jsx)("div",{className:u()("select-auto","py-[2px] px-0","text-sm"),children:r.map(e=>(0,i.jsx)("div",{className:"pl-4","data-testid":"json-viewer-text-field-paragraph",children:(0,i.jsx)("span",{className:"whitespace-pre-wrap",children:(0,i.jsx)("span",{children:e})})}))})})},I=r("318293"),T=r("336205"),M=r("712767"),A=r("407821"),N=r.n(A),L=r("472772"),Z=r.n(L),G=r("395245"),P=r.n(G),B=r("297998"),R=r.n(B),D=r("646576"),F=r.n(D),U=r("606121"),O=r.n(U),z=r("500324"),W={};W.styleTagTransform=O(),W.setAttributes=R(),W.insert=P().bind(null,"head"),W.domAPI=Z(),W.insertStyleElement=F(),N()(z.Z,W);var H=z.Z&&z.Z.locals?z.Z.locals:void 0,K=e=>{var{status:t}=e;return(0,i.jsx)("div",{className:u()(H["json-viewer-line"],{[H.hidden]:t===m.Hidden,[H.visible]:t===m.Visible,[H.half]:t===m.Half,[H.last]:t===m.Last})})},V=r("437320"),q=r("156133"),Y=r("550655"),X=r("775699"),{Text:J}=X.ZT,Q=e=>{for(var t={"\\":"\\\\","\n":"\\n","\r":"\\r","	":"\\t"},r="",n=0;n<e.length;n++){var a=e[n];r+=t[a]||a}return r};var $=((a={}).Error="$error",a.Warning="$warning",a);var ee=((o={})[o.Default=0]="Default",o[o.Number=1]="Number",o[o.Boolean=2]="Boolean",o),et=e=>{var{str:t}=e,[r,n]=(0,s.useState)(!1),a=(0,s.useMemo)(()=>Q(r?t:t.slice(0,1e4)),[t,r]);return(0,i.jsxs)(i.Fragment,{children:[a,!r&&(0,i.jsx)(X.ZT.Text,{link:!0,onClick:()=>n(!0),children:T.o.t("see_more")})]})},er=e=>(0,s.useMemo)(()=>{if((0,V.Z)(e))return{value:"null",type:ee.Default};if((0,v.Z)(e)){if(f(e))return{value:e.toFixed(),type:ee.Number};return{value:"",type:ee.Default}}if((0,q.Z)(e))return{value:e.toString(),type:ee.Boolean};else if((0,c.Z)(e))return""===e?{value:'""',type:ee.Default}:e.length>1e4?{value:(0,i.jsx)(et,{str:e}),type:ee.Default}:{value:Q(e),type:ee.Default};else if((0,Y.Z)(e))return{value:e,type:ee.Number};return{value:e,type:ee.Default}},[e]),en=e=>{var t=(0,b.Sz)(w,t=>{var r;return(null===(r=t.expand)||void 0===r?void 0:r[e])||!1}),r=(0,b.Sz)(w,e=>e.onExpand),n=(0,s.useCallback)(()=>{r(e,!t)},[e,t,r]);return{expand:t,onChange:n}},ea=r("429830"),eo={};eo.styleTagTransform=O(),eo.setAttributes=R(),eo.insert=P().bind(null,"head"),eo.domAPI=Z(),eo.insertStyleElement=F(),N()(ea.Z,eo);var ei=ea.Z&&ea.Z.locals?ea.Z.locals:void 0,es=e=>{var{value:t}=e,{value:r,type:n}=er(t);return(0,i.jsx)("span",{"data-testid":"json-viewer-field-value",className:u()({[ei["field-value-number"]]:n===ee.Number,[ei["field-value-boolean"]]:n===ee.Boolean}),children:r})},el=e=>{var{field:t}=e,{lines:r,children:n,path:a,isObj:o}=t,l=(0,s.useMemo)(()=>r.slice(1),[r]),c=(0,s.useMemo)(()=>a.join("."),[a]),d=(0,s.useMemo)(()=>c===$.Error,[c]),v=(0,s.useMemo)(()=>c===$.Warning,[c]),m=(0,s.useMemo)(()=>(0,I.Z)(a),[a]),g=(0,s.useMemo)(()=>d?T.o.t("workflow_detail_testrun_error_front"):v?T.o.t("workflow_detail_testrun_warning_front"):m?"".concat(m," : "):"",[m,d,v]),{expand:p,onChange:f}=en(a.join("."));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:ei["json-viewer-field"],children:[l.map((e,t)=>(0,i.jsx)(K,{status:e},t)),(0,i.jsx)("div",{"data-testid":"json-viewer-field-content",className:u()("field-content",ei["field-content"],{[ei["is-error"]]:d,[ei["is-warning"]]:v}),onClick:o?f:void 0,children:o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{"data-testid":"json-viewer-json-field-expander",className:u()("field-icon",ei["field-icon"],{[ei.expand]:p}),children:(0,i.jsx)(M.Z,{size:"inherit"})}),(0,i.jsx)("span",{className:u()("field-key",ei["field-key"]),children:m}),(0,i.jsx)("span",{className:u()("field-len",ei["field-len"]),children:" {".concat(n.length,"}")})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:u()("field-block",ei["field-block"])}),g?(0,i.jsx)("span",{className:u()("field-key",ei["field-key"]),children:g}):null,(0,i.jsx)("span",{className:u()("field-value",ei["field-value"],{"whitespace-pre-wrap":!o}),children:(0,i.jsx)(es,{value:t.value})})]})})]}),p?n.map(e=>(0,i.jsx)(el,{field:e},e.path.join("."))):null]})},ec=r("915637"),ed={};ed.styleTagTransform=O(),ed.setAttributes=R(),ed.insert=P().bind(null,"head"),ed.domAPI=Z(),ed.insertStyleElement=F(),N()(ec.Z,ed);var eu=ec.Z&&ec.Z.locals?ec.Z.locals:void 0,ev=e=>{var{data:t,className:r,defaultExpandAllFields:n}=e;return(0,i.jsx)("div",{"data-testid":"json-viewer-wrapper",className:u()(eu["json-viewer-wrapper"],r),draggable:!0,onDragStart:e=>{e.stopPropagation(),e.preventDefault()},children:(()=>{if((0,l.Z)(t))return(0,i.jsx)(el,{field:{path:[],lines:[],value:"Null",isObj:!1,children:[]}},"Null");if((0,c.Z)(t))return(0,i.jsx)(k,{text:t});var e=_(t);return(0,i.jsx)(E,{fields:e,defaultExpandAllFields:n,children:e.map(e=>(0,i.jsx)(el,{field:e},e.path.join(".")))})})()})}},507518:function(e,t,r){r.d(t,{p:()=>Z});var n,a=r("151064"),o=r("455069"),i=r("311807"),s=r("345420"),l=r("252237"),c=r.n(l);var d=((n={}).Top="top",n.Bottom="bottom",n.Inner="inner",n),u=r("825955"),v=r("550655"),m=()=>"function"==typeof window.webkitConvertPointFromNodeToPage,g=()=>{var e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(null!==e&&5===e.length){var[,t,r,n,a]=e.map(e=>parseInt(e,10));return{major:t,minor:r,build:n,patch:a}}},p=r("407821"),f=r.n(p),h=r("472772"),_=r.n(h),x=r("395245"),y=r.n(x),b=r("297998"),S=r.n(b),C=r("646576"),j=r.n(C),w=r("606121"),E=r.n(w),k=r("528049"),I={};I.styleTagTransform=E(),I.setAttributes=S(),I.insert=y().bind(null,"head"),I.domAPI=_(),I.insertStyleElement=j(),f()(k.Z,I);var T=k.Z&&k.Z.locals?k.Z.locals:void 0,M=(()=>{var e=g();if(!e)return!0;var{major:t}=e;return t>=83})(),A=e=>{var t,{reverse:r,scrollStatusRef:n}=e,a=(0,o.useRef)(null),i=(0,o.useRef)(null),s=(0,o.useRef)(!1),l=()=>{var{current:e}=i;if(!e)throw Error("Not found ScrollView ref instance");return e},c=()=>{var e=l();return r&&!M?e.scrollTop-(e.scrollHeight-e.offsetHeight):e.scrollTop},v=e=>{var t=l();if(r&&!M){t.scrollTop=e+(t.scrollHeight-t.offsetHeight);return}t.scrollTop=e},g=e=>{var{current:t}=i;if(!!t){var n=e(c());m()?r?v(Math.max(n,t.offsetHeight-t.scrollHeight+1)):v(Math.min(n,t.scrollHeight-t.offsetHeight-1)):v(n)}};var p=(t=(0,u._)(function*(e){if(s.current)return;var{current:t}=i;if(!t)return;var{offsetHeight:n,scrollHeight:a}=t;if(!(a<=n))return v((r?n-a:a-n)*(r?1-e:e)),new Promise(e=>{requestAnimationFrame(()=>{e()})})}),function(e){return t.apply(this,arguments)}),f=()=>{var{current:e}=i;if(!e)return 0;var{scrollHeight:t,offsetHeight:n}=e,a=c();return r?t-(n+-a):a};return(0,o.useEffect)(()=>{var e,t;null===(e=i.current)||void 0===e||e.addEventListener("touchstart",()=>{s.current=!0}),null===(t=i.current)||void 0===t||t.addEventListener("touchend",()=>{s.current=!1})},[]),{wrapperRef:a,ref:i,controller:{getScrollViewWrapper:()=>a,scrollTo:g,scrollToPercentage:p,getScrollPercentage:()=>{var{current:e}=i;if(!e)return 0;var{scrollHeight:t,offsetHeight:n}=e,a=Math.abs(c())/(t-n);return r?1-a:a},getScrollTop:f,getOriginScrollInfo:()=>{var{current:e}=i;return e?{scrollHeight:e.scrollHeight,scrollTop:e.scrollTop,rect:e.getBoundingClientRect()}:{scrollHeight:0,scrollTop:0,rect:null}},getScrollBottom:()=>{var{current:e}=i;return e?e.scrollHeight-f()-e.offsetHeight:0},refreshAnchor:()=>{(null==n?void 0:n.current)===d.Top?p(0):(null==n?void 0:n.current)===d.Bottom&&p(1)},disableScroll:()=>{var e;s.current=!0,null===(e=i.current)||void 0===e||e.classList.add(T["disable-scroll"]),g(e=>e-1)},enableScroll:()=>{var e;s.current=!1,null===(e=i.current)||void 0===e||e.classList.remove(T["disable-scroll"])},checkContentIsFull:()=>{var e,t=i.current;if(!t)return console.warn("[checkContentIsFull] container not found"),!1;var r=t.getBoundingClientRect(),n=t.parentElement,a=null==n?void 0:n.getBoundingClientRect();return(null!==(e=null==a?void 0:a.height)&&void 0!==e?e:0)===r.height}}}},N=e=>{var{scrollTo:t,getScrollBottom:r,reverse:n,enableThreshold:a=10}=e;(0,o.useLayoutEffect)(()=>{if(!!m()&&!!n){var e,o,i=()=>{var n=document.querySelector(".".concat("scroll-view-anchor-container"));if(n){var s,l=null===(s=n.lastElementChild)||void 0===s?void 0:s.outerHTML,c=n.getBoundingClientRect().height;if(e&&(0,v.Z)(o)&&o!==c&&l!==e&&Math.abs(r())>a){var d=c-o;t(e=>e-d)}o=c,e=null!=l?l:void 0}requestAnimationFrame(i)};requestAnimationFrame(i)}},[])},L=(0,o.createContext)({current:null}),Z=(0,o.forwardRef)(function(e,t){var{style:r,className:n,children:l,before:u,beforeClassName:v,after:m,innerBefore:g,reverse:p=!1,reachTopThreshold:f,onReachTop:h,onLeaveTop:_,reachBottomThreshold:x,onReachBottom:y,onLeaveBottom:b,showScrollbar:S,autoShowScrollbar:C,onScroll:j,scrollbarWidthNone:w=!0}=e,E=p?d.Bottom:d.Top,k=(0,o.useRef)(null),I=(0,o.useRef)(E),{wrapperRef:M,ref:Z,controller:G}=A({reverse:p,scrollStatusRef:I}),{getScrollTop:P,getScrollBottom:B,scrollTo:R}=G,D=(0,o.useRef)(!1),F=(0,o.useRef)(!1);(0,o.useImperativeHandle)(t,()=>G,[G]);var U=(0,o.useMemo)(()=>(0,i.Z)(e=>{I.current=e},100),[]),O=(0,o.useCallback)(e=>{if(!!e.currentTarget){null==j||j(e);var{offsetHeight:t}=e.currentTarget,r=null!=f?f:t,n=null!=x?x:t;P()<r?!D.current&&(D.current=!0,null==h||h()):D.current&&(D.current=!1,null==_||_()),B()<n?!F.current&&(F.current=!0,null==y||y()):F.current&&(F.current=!1,null==b||b()),I.current=d.Inner,0>=P()&&0>=B()?U(E):0>=P()?U(d.Top):0>=B()?U(d.Bottom):U(d.Inner)}},[f,x,P,B,h,_,y,b]);return N({scrollTo:R,reverse:p,getScrollBottom:B}),(0,a.jsx)(L.Provider,{value:k,children:(0,a.jsxs)("div",{className:c()(T["scroll-view"],n),style:r,ref:M,children:[u?(0,a.jsx)("div",{className:c()(T.before,v),children:(0,s.Z)(u)?null==u?void 0:u(G):u}):null,(0,a.jsx)("div",{className:c()(T.content),ref:k,"data-testid":"chat-area.message-content",children:(0,a.jsxs)("div",{ref:Z,"data-scroll-element":"scrollable",className:c()(T.scrollable,S&&T["show-scrollbar"],C&&T["auto-show-scrollbar"],w&&T["scrollbar-width-none"],{[T.reverse]:p}),onScroll:O,children:[(0,s.Z)(l)?l(G):l,g?(0,a.jsx)("div",{className:c()(T.before),children:(0,s.Z)(g)?null==g?void 0:g(G):g}):null]})}),m?(0,a.jsx)("div",{className:c()(T.after),children:(0,s.Z)(m)?null==m?void 0:m(G):m}):null]})})})},461190:function(e,t,r){r.d(t,{E2:()=>R,EY:()=>G,wn:()=>P,_N:()=>ee,e0:()=>X,HA:()=>ec}),r("151126");var n,a=r("808549"),o=r("120454"),i=r("151064"),s=r("455069"),l=r("252237"),c=r.n(l),d=r("998600"),u=r("336205"),v=r("674343"),m=r("775699"),g=r("910656"),p=r("763055");var f=((n={}).EDIT="edit",n.DELETE="delete",n.DELETEALL="deleteAll",n),h=r("825955"),_=r("44172"),x=r("222220"),y=r("407821"),b=r.n(y),S=r("472772"),C=r.n(S),j=r("395245"),w=r.n(j),E=r("297998"),k=r.n(E),I=r("646576"),T=r.n(I),M=r("606121"),A=r.n(M),N=r("363190"),L={};L.styleTagTransform=A(),L.setAttributes=k(),L.insert=w().bind(null,"head"),L.domAPI=C(),L.insertStyleElement=T(),b()(N.Z,L);var Z=N.Z&&N.Z.locals?N.Z.locals:void 0,G=e=>{var t,{value:r,record:n,index:l,onBlur:c,onChange:d,dataIndex:u="",validator:g={},editable:p=!1,isEditing:f}=e,{validate:y,errorMsg:b}=g,[S,C]=(0,s.useState)(f),[j,w]=(0,s.useState)(String(r)),E=(0,s.useRef)(null);(0,s.useEffect)(()=>{C(f)},[f]);var k=(t=(0,h._)(function*(){if(c&&r!==j){var e=(0,o._)((0,a._)({},n),{[u]:j});if(delete e.tableViewKey,I)w(String(r));else try{yield c(j,e,l)}catch(e){console.log("update table content error",e),w(String(r))}}C(!1)}),function(){return t.apply(this,arguments)}),I=(0,s.useMemo)(()=>!!(null==y?void 0:y(String(j),n,l)),[j,y]);return(0,s.useEffect)(()=>{w(r)},[r]),(0,s.useEffect)(()=>{var e=E.current;if(!S||!e)return;var t=String(j).length;if(e.focus(),!!t)e.setSelectionRange(t,t)},[S]),(0,i.jsxs)("div",{className:"".concat(Z["cell-text-render"]," text-render-wrapper"),"data-testid":x.M.CommonTableViewTextRender,children:[S?(0,i.jsxs)("span",{className:"".concat(Z["cell-text-edit"]," ").concat(I?Z["cell-text-error"]:""," cell-text-area-wrapper"),children:[(0,i.jsx)(v.Kx,{ref:E,autoFocus:!0,autosize:!0,validateStatus:I?"error":"default",rows:1,className:Z["cell-text-area"],value:String(j),onBlur:k,onChange:e=>{d&&d(e,n,l),w(e)}}),I?(0,i.jsx)("div",{className:Z["cell-text-edit-error"],children:(0,i.jsx)(m.u,{content:b,children:(0,i.jsx)(_.z2G,{})})}):null]}):null,!S&&(0,i.jsx)("div",{className:"".concat(Z["cell-text-preview"]," text-content"),onClick:()=>C(!0),children:j})]})},P=e=>{var{value:t,className:r,size:n,color:a}=e;return(0,i.jsx)(v.Vp,{className:c()(r,Z["tag-render"]),size:n,color:null!=a?a:"primary",children:t})},B=r("915757"),R=e=>{var{record:t,index:r,editProps:n={disabled:!1},deleteProps:a={disabled:!1}}=e,{disabled:o,onEdit:s}=n,{disabled:l,onDelete:d}=a;return(0,i.jsxs)("div",{className:c()(Z["actions-render"],"table-view-actions"),children:[!o&&(0,i.jsx)(v.zx,{size:"mini",color:"secondary",icon:(0,i.jsx)(B.JAz,{className:"text-[14px]"}),className:Z["action-edit"],onClick:()=>s&&s(t,r)}),!l&&(0,i.jsx)(v.zx,{size:"mini",color:"secondary",icon:(0,i.jsx)(B.dVD,{className:"text-[14px]"}),className:Z["action-delete"],onClick:()=>d&&d(r)})]})},D=r("473980"),F=r("458620"),U=r("727914"),O=r("178385"),z=r("382534"),W=r("263825"),H=e=>new Promise((t,r)=>{var n=new FileReader;n.onload=e=>{var n,a=null===(n=e.target)||void 0===n?void 0:n.result;if(!a||"string"!=typeof a){r(new U.sH("getBase64","file read invalid"));return}t(a.replace(/^.*?,/,""))},n.onerror=()=>{r(new U.sH("getBase64","file read fail"))},n.onabort=()=>{r(new U.sH("getBase64","file read abort"))},n.readAsDataURL(e)}),K=e=>{var t=e.lastIndexOf(".");return e.slice(t+1)},V=e=>0x1400000>e,q=e=>{var t,{src:r,setSrc:n,onChange:a,editable:o=!0}=e,[l,c]=(0,s.useState)(""),[d,m]=(0,s.useState)(!1),{open:g,close:p,modal:f}=(0,W.sr)({width:640,title:u.o.t("knowledge_insert_img_004"),okText:u.o.t("Confirm"),okButtonProps:{disabled:d},cancelText:u.o.t("Cancel"),onCancel:()=>{p()},onOk:()=>{null==a||a(r,l),p()}});var x=(t=(0,h._)(function*(e){var{onSuccess:t,onProgress:r,file:a}=e;if("string"!=typeof a)try{var{name:o,fileInstance:i,url:s}=a;if(m(!0),i){n(s||"");var l,d,u=K(o),v=yield H(i),g=yield z.nA.UploadFile({file_head:{file_type:u,biz_type:O.ym.BIZ_BOT_DATASET},data:v},{onUploadProgress:e=>{var t;r({total:null!==(t=e.total)&&void 0!==t?t:i.size,loaded:e.loaded})}});t(g.data),c((null==g?void 0:null===(l=g.data)||void 0===l?void 0:l.upload_uri)||""),n((null==g?void 0:null===(d=g.data)||void 0===d?void 0:d.upload_url)||"")}else throw new U.sH(F.b.KnowledgeUploadFile,"Upload image fail")}catch(e){throw new U.sH(F.b.KnowledgeUploadFile,"Upload image fail: ".concat(e))}finally{m(!1)}}),function(e){return t.apply(this,arguments)});return{node:f((0,i.jsxs)("div",{className:Z["image-preview-modal"],children:[(0,i.jsx)(v.gq,{className:Z["image-upload"],maxSize:20480,fileList:[],limit:1,accept:"image/*",disabled:!o||d,customRequest:x,draggable:!0,onChange:e=>{var t,{currentFile:r}=e;if(r){;!V((null==r?void 0:null===(t=r.fileInstance)||void 0===t?void 0:t.size)||0)&&v.FN.error(u.o.t("knowledge_insert_img_013"))}},children:(0,i.jsx)(v.yC,{spinning:d,tip:u.o.t("knowledge_insert_img_009"),wrapperClassName:d?"spin-uploading":"",children:(0,i.jsxs)("div",{className:Z["image-wrapper"],children:[o?(0,i.jsx)("div",{className:Z["image-hover"],children:(0,i.jsx)(e=>{var{showTips:t=!1}=e;return(0,i.jsxs)("div",{className:Z["image-upload-empty"],children:[(0,i.jsx)(B.Isu,{className:"text-[32px] coz-fg-hglt"}),(0,i.jsx)("div",{className:Z["image-upload-text"],children:u.o.t("knowledge_insert_img_006")}),t?(0,i.jsx)("div",{className:Z["image-upload-tips"],children:u.o.t("knowledge_insert_img_007")}):null]})},{showTips:!0})}):null,(0,i.jsx)(v.Ee,{src:r,preview:!1,fallback:(0,i.jsx)(_.qy1,{})})]})})}),(0,i.jsxs)("div",{className:"mb-[16px]",children:[(0,i.jsx)(v.ZT,{className:"coz-fg-secondary text-[12px] fw-[500] px-[8px]",children:u.o.t("knowledge_insert_img_005")}),(0,i.jsx)(v.II,{value:r,onChange:e=>{n(e),c("")},disabled:!o||d})]})]})),open:g,close:p}},Y=e=>{var{srcList:t,onClick:r,setCurSrc:n}=e,s=(0,D._)(e,["srcList","onClick","setCurSrc"]);return(0,i.jsx)("div",{className:Z["image-container"],onClick:()=>{(!t.length||!t[0])&&(null==r||r())},children:t.map(e=>(0,i.jsx)(m.Ee,(0,o._)((0,a._)({},s),{onClick:()=>{null==n||n(e),null==r||r()},preview:!1,src:e,fallback:(0,i.jsx)(_.qy1,{className:Z["image-failed"],onClick:()=>{null==n||n(e),null==r||r()}}),placeholder:(0,i.jsx)("div",{className:"image-skeleton",onClick:r})})))})},X=e=>{var{srcList:t=[],editable:r=!0,onChange:n,className:a="",customEmpty:o}=e,[l,c]=(0,s.useState)((null==t?void 0:t[0])||""),{open:d,node:u}=q({editable:r,src:l,setSrc:c,onChange:n});return(0,s.useEffect)(()=>{c((null==t?void 0:t[0])||"")},[t]),(0,i.jsxs)("div",{className:"".concat(a," ").concat(Z["image-render-wrapper"]," ").concat(l?"":Z["image-render-empty"]),children:[t&&t.length||!o?(0,i.jsx)(Y,{srcList:t,onClick:d,setCurSrc:c}):o({onClick:d}),u]})},J=e=>e.fixed||"column-selection"===e.key?(0,o._)((0,a._)({},e),{resizable:!1,width:38}):(0,o._)((0,a._)({},e),{width:100>Number(e.width)?100:Number(e.width)}),Q=e=>(null==e?void 0:e.tableViewKey)||"",$=e=>{var{selected:t,onEdit:r,onDelete:n}=e,{record:a,indexs:o}=t,s={text:"knowledge_tableview_02",icon:(0,i.jsx)(B.dVD,{}),onClick:()=>{n&&o&&n(o)}};return{[f.EDIT]:{text:"knowledge_tableview_01",icon:(0,i.jsx)(B.JAz,{}),onClick:()=>{r&&a&&o&&r(a,o[0])}},[f.DELETE]:s,[f.DELETEALL]:s}},ee=new class e{mapToString(e){return JSON.stringify(Array.from(e))}stringToMap(e){return JSON.parse(e).reduce((e,t)=>{var[r,n]=t;return e.set(r,n)},new Map)}initWidthMap(){!window.localStorage.getItem(this.mapName)&&window.localStorage.setItem(this.mapName,this.mapToString(new Map))}setWidthMap(e,t){if(!!t)try{var r=this.stringToMap(window.localStorage.getItem(this.mapName)||"");r.has(t)?r.delete(t):r.size>=this.capacity&&r.delete(r.keys().next().value),r.set(t,e),window.localStorage.setItem(this.mapName,this.mapToString(r))}catch(e){throw new U.sH(F.b.KnowledgeTableViewSetColWidth,"table view set width map fail: ".concat(e))}}getTableWidthMap(e){try{var t=this.stringToMap(window.localStorage.getItem(this.mapName)||""),r=t.get(e);return t.delete(e),t.set(e,r),r}catch(e){throw new U.sH(F.b.KnowledgeTableViewGetColWidth,"table view get width map fail: ".concat(e))}}constructor(){this.mapName="TABLE_VIEW_COL_WIDTH_MAP",this.capacity=20}},et=r("979838"),er=r("937140"),en={};en.styleTagTransform=A(),en.setAttributes=k(),en.insert=w().bind(null,"head"),en.domAPI=C(),en.insertStyleElement=T(),b()(er.Z,en);var ea=er.Z&&er.Z.locals?er.Z.locals:void 0,eo=e=>{var{configs:t,visible:r,style:n,selected:a,onExit:o,onEdit:l,onDelete:d}=e,m=$({selected:a,onEdit:l,onDelete:d});return((0,s.useEffect)(()=>{var e=e=>{o&&o()};return window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[]),r&&t&&t.length)?(0,i.jsx)("div",{style:n,className:c()(ea["table-edit-menu"],"context-menu-disabled"),children:(0,i.jsx)(v.v2.SubMenu,{mode:"menu",children:t.map(e=>{var{text:t,onClick:r,icon:n}=m[e];return(0,i.jsx)(v.v2.Item,{onClick:()=>{r()},icon:n,children:u.o.t(t)})})})}):(0,i.jsx)("div",{className:"context-menu-disabled"})},ei=e=>{var{configs:t,visible:r,selected:n,onExit:a,onEdit:o,onDelete:s}=e,l=$({selected:n,onEdit:o,onDelete:s}),{indexs:c}=n;return(0,i.jsx)(i.Fragment,{children:r?(0,i.jsx)("div",{className:ea["table-edit-toolbar"],style:{marginLeft:"".concat(((null==n?void 0:n.indexs)||[]).length>1?"-145px":"-203.5px")},children:(0,i.jsxs)(v.hE,{className:ea["button-group"],children:[n?(0,i.jsx)("div",{className:ea["selected-count"],children:u.o.t("table_view_002",{n:null==c?void 0:c.length})}):null,(0,i.jsx)(v.iz,{layout:"vertical",margin:"8px"}),t.length>0?(0,i.jsx)(v.T,{spacing:8,children:t.map(e=>{var{text:t,onClick:r}=l[e];return(0,i.jsx)(v.zx,{onClick:r,color:"primary",children:u.o.t(t)})})}):null,(0,i.jsx)(v.iz,{layout:"vertical",margin:"8px"}),(0,i.jsx)(v.zx,{icon:(0,i.jsx)(et.Z,{}),onClick:a,color:"secondary"})]})}):null})},es=e=>{var{isVirtualized:t,onScroll:r,children:n}=e;return t?(0,i.jsx)(g.qj,{children:e=>{var{width:t,height:i}=e;return n({scroll:{y:i-41,x:t},style:{width:t},virtualized:{itemSize:56,onScroll:e=>r((0,o._)((0,a._)({},e),{height:i})),overScanCount:30}})}}):(0,i.jsx)(s.Fragment,{children:n()})},el=()=>(0,i.jsx)(m.YZ,{empty:{icon:(0,i.jsx)(p.xs,{}),description:u.o.t("dataset_segment_empty_desc")}}),ec=(0,s.forwardRef)((e,t)=>{var{tableKey:r,editProps:n={},isVirtualized:l=!1,rowSelect:u=!1,rowOperation:g=!1,resizable:p=!1,dataSource:h,columns:_,loading:x=!1,className:y,scrollToBottom:b,empty:S,onResize:C,tableProps:j={}}=e,{onEdit:w,onDelete:E}=n,[k,I]=(0,s.useState)(!1),[T,M]=(0,s.useState)({}),[A,N]=(0,s.useState)([]),[L,Z]=(0,s.useState)(),{theme:P}=(0,v.Fg)(),B=(0,s.useMemo)(()=>"dark"===P?ea.dark:ea.light,[P]),R=(0,s.useMemo)(()=>!!(null==A?void 0:A.length),[A]),D=(0,s.useMemo)(()=>h.map((e,t)=>(0,o._)((0,a._)({},e),{tableViewKey:String(t)})),[h]),F=(0,s.useMemo)(()=>(null==A?void 0:A.length)&&(null==A?void 0:A.length)>1?[f.DELETEALL]:[f.EDIT,f.DELETE],[A]),U=e=>e.map(e=>(0,o._)((0,a._)({},e),{onCell:(e,t)=>({onContextMenu:e=>{e.preventDefault()},onMouseDown:e=>{if(1===e.button&&I(!1),2===e.button&&g){e.preventDefault();var{offsetWidth:r,offsetHeight:n}=document.body;t&&(null==A?void 0:A.length)&&!A.includes(String(t))&&N([]),Z(t),I(!0),M({position:"fixed",top:e.pageY+36*F.length>n?e.pageY-36*F.length:e.pageY,left:e.pageX+176>r?e.pageX-176:e.pageX,zIndex:100})}}}),render:e.render?e.render:(e,t,r)=>(0,i.jsx)(G,{value:e,record:t,index:r})})),[O,z]=(0,s.useState)(U(_)),W=(0,s.useMemo)(()=>({width:38,fixed:!0,selectedRowKeys:A,onChange:e=>{I(!1),N(null!=e?e:[])}}),[A,N]),H={selected:{record:L?D[L]:{},indexs:(null==A?void 0:A.length)?A:[Number(L)]},style:T,configs:F,onDelete:E,onEdit:w},K=(0,d.Z)(()=>{null==b||b()},{wait:100}),V=()=>56*((null==D?void 0:D.length)||0)+41;return(0,s.useImperativeHandle)(t,()=>({resetSelected:()=>N([]),getTableHeight:V})),(0,s.useEffect)(()=>{ee.initWidthMap()},[]),(0,s.useEffect)(()=>{z(U(_))},[_]),(0,s.useEffect)(()=>{z(U(O))},[F.length]),(0,i.jsxs)("div",{className:c()([ea["data-table-view"]],y),children:[D.length||x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(es,{isVirtualized:l,onScroll:e=>{var{scrollDirection:t,scrollOffset:r,scrollUpdateWasRequested:n,height:a}=e;I(!1),"forward"===t&&r&&r+a-41>=56*D.length&&!n&&K&&K.run()},children:e=>(0,i.jsx)(m.$,{wrapperClassName:"".concat(ea["table-wrapper"]," ").concat(B," table-wrapper"),tableProps:(0,o._)((0,a._)({},e||{},j),{rowKey:Q,resizable:!!p&&{onResize:e=>C?C(e):J(e),onResizeStop:e=>{var t=O.map(t=>t.dataIndex===e.dataIndex?e:t);z(t);var n={};t.forEach(e=>{e.dataIndex&&(n[e.dataIndex]=e.width)}),ee.setWidthMap(n,r)}},loading:x,rowSelection:!!u&&W,pagination:!1,dataSource:D,columns:O})},r)}),(0,i.jsx)(eo,(0,o._)((0,a._)({},H),{visible:k,onExit:()=>I(!1)})),(0,i.jsx)(ei,(0,o._)((0,a._)({},H),{visible:R,onExit:()=>N([])}))]}):null,h.length||x?null:S||(0,i.jsx)(el,{})]})})},910656:function(e,t,r){r.d(t,{qj:function(){return a.ZP},t7:function(){return n.t7}});var n=r(517432),a=r(962939)},177198:function(e,t,r){r.d(t,{A:function(){return a}});var n,a=((n={}).BotTab="bot.tab",n.BotListSearch="bot.list.search.input",n.BotListCreateBtn="bot.list.create.btn",n.BotListIcon="bot.list.icon",n.BotListIconDel="bot.list.delete.icon",n.BotListIconEdit="bot.list.edit.icon",n.BotKnowledgeAutoMaticBtn="bot.knowledge.auto_matic.btn",n.BotKnowledgeSettingModalTitle="bot.knowledge.setting.modal.title.text",n.BotKnowledgeSettingModalAutoRadio="bot.knowledge.setting.modal.auto.radio",n.BotKnowledgeSettingModalManualRadio="bot.knowledge.setting.modal.manual.radio",n.BotKnowledgeSettingNoRecallReplyModeDefaultRadio="bot.knowledge.setting.reply.mode.default.radio",n.BotKnowledgeSettingNoRecallReplyModeCustomizePromptRadio="bot.knowledge.setting.reply.mode.customizeprompt.radio",n.BotKnowledgeSettingShowSourceDisplayTitle="bot.knowledge.setting.show.source.display.title.text",n.BotKnowledgeSettingShowSourceDisplaySwitch="bot.knowledge.setting.show.source.display.switch",n.BotKnowledgeSettingShowSourceModeCardRadio="bot.knowledge.setting.show.source.mode.cardlist.radio",n.BotKnowledgeSettingShowSourceModeTextRadio="bot.knowledge.setting.show.source.mode.replybottom.radio",n.BotKnowledgeSelectListModalCreateBtn="bot.knowledge.select.list.modal.create.btn",n.BotKnowledgeSelectListModalCreateDateSelect="bot.knowledge.select.list.modal.create.date.select",n.BotKnowledgeSelectListModalAllTab="bot.knowledge.select.list.modal.all.tab",n.BotKnowledgeSelectListModalTextTab="bot.knowledge.select.list.modal.text.tab",n.BotKnowledgeSelectListModalTableTab="bot.knowledge.select.list.modal.table.tab",n.BotKnowledgeSelectListModalPhotoTab="bot.knowledge.select.list.modal.photo.tab",n.BotKnowledgeSelectListModalName="bot.knowledge.select.list.modal.name.text",n.BotKnowledgeSelectListModalAddBtn="bot.knowledge.select.list.modal.add.btn",n.BotVariableAddModalNameInput="bot.variable.add.modal.name.input",n.BotVariableAddModalDefaultValueInput="bot.variable.add.modal.default_value.input",n.BotVariableAddModalDescInput="bot.variable.add.modal.desc.input",n.BotVariableAddModalDelBtn="bot.variable.add.modal.del.btn",n.BotVariableAddModalSwitch="bot.variable.add.modal.switch",n.BotVariableAddModalNameText="bot.variable.add.modal.name.text",n.BotVariableAddModalDefaultValueText="bot.variable.add.modal.default_value.text",n.BotVariableAddModalDescText="bot.variable.add.modal.desc.text",n.BotVariableAddModalAddBtn="bot.variable.add.modal.add.btn",n.BotVariableAddModalSaveBtn="bot.variable.add.modal.save.btn",n.BotVariableAddModalCancelBtn="bot.variable.add.modal.cancel.btn",n.BotVariableDebugModalNameText="bot.variable.debug.modal.name.text",n.BotVariableDebugModalValueInput="bot.variable.debug.modal.value.input",n.BotVariableDebugModalEditDateText="bot.variable.debug.modal.edit_date.text",n.BotVariableDebugModalNameTitleText="bot.variable.debug.modal.name.title.text",n.BotVariableDebugModalValueTitleText="bot.variable.debug.modal.value.title.text",n.BotVariableDebugModalEditDateTitleText="bot.variable.debug.modal.edit_date.title.text",n.BotVariableDebugModalResetBtn="bot.variable.debug.modal.reset.btn",n.BotLtmDebugModalResetBtn="bot.ltm.debug.modal.reset.btn",n.BotDatabaseAddModalTitle="bot.database.add.modal.title.text",n.BotDatabaseAddModalTitleCreateAiBtn="bot.database.add.modal.title.create_ai.btn",n.BotDatabaseAddModalTitleCreateAiModalTitle="bot.database.add.modal.title.create_ai.modal.title.text",n.BotDatabaseAddModalTitleCreateAiModalDesc="bot.database.add.modal.title.create_ai.modal.desc.input",n.BotDatabaseAddModalTitleCreateAiModalCreateBtn="bot.database.add.modal.title.create_ai.modal.create.btn",n.BotDatabaseAddModalTitleCloseIcon="bot.database.add.modal.title.close.icon",n.BotDatabaseAddModalAddCustomBtn="bot.database.add.modal.add_custom.btn",n.BotDatabaseAddModalTemplateTitle="bot.database.add.modal.template.title.text",n.BotDatabaseAddModalUseTemplateBtn="bot.database.add.modal.use_template.btn",n.BotDatabaseAddModalPreviewTemplateBtn="bot.database.add.modal.preview_template.btn",n.BotDatabaseAddModalTableNameInput="bot.database.add.modal.table_name.input",n.BotDatabaseAddModalTableDescInput="bot.database.add.modal.table_desc.input",n.BotDatabaseAddModalTableQueryModeSelect="bot.database.add.modal.table_query_mode.select",n.BotDatabaseAddModalFieldNameInput="bot.database.add.modal.field_name.input",n.BotDatabaseAddModalFieldDescInput="bot.database.add.modal.field_desc.input",n.BotDatabaseAddModalFieldTypeSelect="bot.database.add.modal.field_type.select",n.BotDatabaseAddModalFieldRequiredSwitch="bot.database.add.modal.field_required.switch",n.BotDatabaseAddModalFieldDelBtn="bot.database.add.modal.field_del.btn",n.BotDatabaseAddModalAddBtn="bot.database.add.modal.add.btn",n.BotDatabaseAddModalSubmitBtn="bot.database.add.modal.submit.btn",n.BotDatabaseEditTableStructureBtn="bot.database.edit_table_structure.btn",n.BotDatabaseDebugModalTableNameTab="bot.database.debug.modal.table_name.tab",n.BotDatabaseDebugModalResetBtn="bot.database.debug.modal.reset.btn",n.BotMemoryDebugBtn="bot.memory_debug.btn",n.BotMemoryDebugDropdownItem="bot.memory_debug.dropdown",n.BotMemoryDebugModalTab="bot.memory_debug.modal.tab",n)},222220:function(e,t,r){r.d(t,{M:function(){return a}});var n,a=((n={}).PictureUpload="common.picture.upload",n.CommonFilePicker="common.file.picker",n.CommonDataTypeSelect="common.data_type.select",n.CommonTableViewTextRender="common.table_view.text_render",n)},385038:function(e,t,r){r.d(t,{w:function(){return a}});var n,a=((n={}).KnowledgeTab="knowledge.tab",n.KnowledgeSearchType="knowledge.list.search.type.select",n.KnowledgeSearchFounder="knowledge.list.search.founder.select",n.KnowledgeCreateBtn="knowledge.list.create.btn",n.KnowledgeListSwitch="knowledge.list.switch",n.KnowledgeListAllTab="knowledge.list.all.tab",n.KnowledgeListTextTab="knowledge.list.text.tab",n.KnowledgeListTableTab="knowledge.list.table.tab",n.KnowledgeEditModalDescInput="knowledge.edit.modal.desc.input",n.KnowledgeEditModalNameInput="knowledge.edit.modal.name.input",n.CreateKnowledgeModal="knowledge.create.modal",n.CreateKnowledgeModalTitle="knowledge.create.modal.title.text",n.CreateKnowledgeModalTextRadioGroup="knowledge.create.modal.text.RadioGroup",n.CreateKnowledgeModalTableRadioGroup="knowledge.create.modal.table.RadioGroup",n.CreateKnowledgeModalPhotoRadioGroup="knowledge.create.modal.photo.RadioGroup",n.CreateKnowledgeModalNameInput="knowledge.create.modal.name.input",n.CreateKnowledgeModalDescInput="knowledge.create.modal.desc.input",n.CreateKnowledgeModalAvatarUploader="knowledge.create.modal.avatar.uploader",n.CreateKnowledgeModalTextLocalRadio="knowledge.create.modal.text.local.radio",n.CreateKnowledgeModalTextOnlineRadio="knowledge.create.modal.text.online.radio",n.CreateKnowledgeModalTextNotionRadio="knowledge.create.modal.text.notion.radio",n.CreateKnowledgeModalTextGoogleRadio="knowledge.create.modal.text.google.radio",n.CreateKnowledgeModalTextFeishuRadio="knowledge.create.modal.text.feishu.radio",n.CreateKnowledgeModalTextWechatRadio="knowledge.create.modal.text.wechat.radio",n.CreateKnowledgeModalTextCustomRadio="knowledge.create.modal.text.custom.radio",n.CreateKnowledgeModalTableLocalRadio="knowledge.create.modal.table.local.radio",n.CreateKnowledgeModalTableApiRadio="knowledge.create.modal.table.api.radio",n.CreateKnowledgeModalTableGoogleRadio="knowledge.create.modal.table.google.radio",n.CreateKnowledgeModalTableFeishuRadio="knowledge.create.modal.table.feishu.radio",n.CreateKnowledgeModalTableCustomRadio="knowledge.create.modal.table.custom.radio",n.CreateKnowledgeModalPhotoImgRadio="knowledge.create.modal.photo.img.radio",n.CreateKnowledgeModalTextLarkRadio="knowledge.create.modal.text.lark.radio",n.CreateKnowledgeModalTableLarkRadio="knowledge.create.modal.table.lark.radio",n.CreateKnowledgeModalSubmitAndImportButton="knowledge.create.modal.submit_and_import.button",n.CreateTextUploadNav="knowledge.create.text.upload.nav.text",n.UploadUnitFile="knowledge.create.upload.unit.file.upload",n.UploadUnitNextBtn="knowledge.create.unit.next.btn",n.UploadUnitUpBtn="knowledge.create.unit.up.btn",n.UploadUnitAddBtn="knowledge.create.unit.add.btn",n.UploadUnitCancelBtn="knowledge.create.unit.cancel.btn",n.CreateUnitConfirmBtn="knowledge.create.unit.confirm.btn",n.LocalUploadListName="knowledge.upload.list.name.input",n.LocalUploadListNameView="knowledge.upload.list.name.text",n.LocalUploadListStatus="knowledge.upload.list.status.text",n.LocalUploadListFileSize="knowledge.upload.list.file_size.text",n.LocalUploadListFrequency="knowledge.create.text.upload.list.frequency.text",n.LocalUploadListDelete="ui.table-action.delete",n.CreateUnitResegmentAutoRadio="knowledge.create.unit.resegment.auto.radio",n.CreateUnitResegmentCustomRadio="knowledge.create.unit.resegment.custom.radio",n.ResegmentCustomIdentifierSelect="knowledge.create.unit.resegment.custom.identifier.select",n.ResegmentCustomMaxLenInput="knowledge.create.unit.resegment.custom.max_len.input",n.ResegmentCustomRuleText="knowledge.create.unit.resegment.custom.rule.text",n.CreateUnitProgressTitle="knowledge.create.unit.progress.title.text",n.CreateUnitListProgressSuccessIcon="knowledge.create.unit.progress.success.icon",n.CreateUnitListProgressName="knowledge.create.unit.progress.name.text",n.CreateUnitListProgressPercent="knowledge.create.unit.progress.percent.text",n.OnlineUploadAutoBtn="knowledge.create.text.online.auto.btn",n.OnlineUploadManualBtn="knowledge.create.text.online.manual.btn",n.OnlineUploadModal="knowledge.create.text.online.upload.modal",n.OnlineUploadModalAddTypeSelect="knowledge.create.text.online.upload.modal.add_type.select",n.OnlineUploadModalFrequencySelect="knowledge.create.text.online.upload.modal.frequency.select",n.OnlineUploadModalExampleUrlSelect="knowledge.create.text.online.upload.modal.example_url.input",n.CustomUploadNameInput="knowledge.create.custom.upload.name.input",n.SegmentEditor="knowledge.segment.editor",n.SegmentEditorInsertImgBtn="knowledge.segment.editor.insert_img.btn",n.FeishuUploadCountText="knowledge.create.feishu.upload.count.text",n.FeishuUploadAccountText="knowledge.create.feishu.upload.account.text",n.FeishuUploadListName="knowledge.create.feishu.upload.list.name.text",n.FeishuUploadSourceSpaceMine="knowledge.create.feishu.upload.source.space.mine",n.FeishuUploadSourceSpaceWiki="knowledge.create.feishu.upload.source.space.wiki",n.FeishuUploadUpdateFrequencyValue="knowledge.create.feishu.upload.update.frequency.value",n.FeishuUploadAppendFrequencyValue="knowledge.create.feishu.upload.append.frequency.value",n.TableLocalTableConfigurationDataSheet="knowledge.create.table.local.table_configuration.data_sheet.select",n.TableLocalTableConfigurationSheetHeader="knowledge.create.table.local.table_configuration.sheet_header.select",n.TableLocalTableConfigurationStarRow="knowledge.create.table.local.table_configuration.star_row.select",n.TableLocalTableConfigurationIndex="knowledge.create.table.local.table_configuration.index.text",n.TableLocalTableConfigurationColumnName="knowledge.create.table.local.table_configuration.column_name.text",n.TableLocalTableConfigurationDesc="knowledge.create.table.local.table_configuration.desc.text",n.TableLocalTableConfigurationType="knowledge.create.table.local.table_configuration.type.text",n.TableLocalTableConfigurationAction="knowledge.create.table.local.table_configuration.action.text",n.TableLocalPreviewTitle="knowledge.create.table.local.preview.title.text",n.TableLocalPreviewSemantic="knowledge.create.table.local.preview.semantic.tag",n.TableLocalPreviewFooterTotal="knowledge.create.table.local.preview.footer.total.text",n.TableLocalTableStructureTitle="knowledge.create.table.local.table_structure.title.text",n.TableApiAddUrlModalWebInput="knowledge.create.table.api.modal.web.input",n.TableApiAddUrlModalFrequency="knowledge.create.table.api.modal.frequency.select",n.TableCustomUAddFieldBtn="knowledge.create.table.custom.add_field.btn",n.TableStructureIndexCheckbox="knowledge.create.table.table_structure.index.checkbox",n.ImageAnnotationAiRadio="knowledge.create.image.annotation.ai.radio",n.ImageAnnotationManualRadio="knowledge.create.image.annotation.manual.radio",n.ImageAnnotationAllTab="knowledge.create.image.annotation.all.tab",n.ImageAnnotationUnAnnotationTab="knowledge.create.image.annotation.un_annotation.tab",n.ImageAnnotationAnnotationedTab="knowledge.create.image.annotation.annotationed.tab",n.IncrementTableUploadStructureTitle="knowledge.increment.table.upload.structure_title.text",n.IncrementTableUploadStructureColumnName="knowledge.increment.table.upload.structure_column_name.input",n.IncrementTableUploadStructureAddBtn="knowledge.increment.table.upload.structure_add.btn",n.SegmentDetailUpdateBtn="knowledge.segment.detail.update.btn",n.SegmentDetailTitle="knowledge.segment.detail.title.text",n.SegmentDetailTitleEditIcon="knowledge.segment.detail.title.edit.icon",n.SegmentDetailResetBtn="knowledge.segment.detail.reset.btn",n.SegmentDetailAddBtn="knowledge.segment.detail.add.btn",n.SegmentDetailSystemBtn="knowledge.segment.detail.system.btn",n.SegmentDetailSystemDropdownMenu="knowledge.segment.detail.system.dropdown_menu",n.SegmentDetailSystemWebUrlDropdownMenu="knowledge.segment.detail.system.web_url.dropdown_menu",n.SegmentDetailTableConfigBtn="knowledge.segment.detail.table_config.btn",n.SegmentDetailDropdownItem="knowledge.segment.detail.dropdown.item",n.SegmentDetailLocalFileItem="knowledge.segment.detail.dropdown.item.text_doc",n.SegmentDetailContentItemEditIcon="knowledge.segment.detail.content.edit.icon",n.SegmentDetailContentItemFrequencyIcon="knowledge.segment.detail.content.frequency.icon",n.SegmentDetailContentItemAddTopIcon="knowledge.segment.detail.content.add_top.icon",n.SegmentDetailContentItemAddBottomIcon="knowledge.segment.detail.content.add_bottom.icon",n.SegmentDetailContentItemFetchSliceIcon="knowledge.segment.detail.content.fetch_slice.icon",n.SegmentDetailContentItemFetchSliceModalSaveBtn="knowledge.segment.detail.content.fetch_slice.modal.save.btn",n.SegmentDetailContentItemWebUrlIcon="knowledge.segment.detail.content.web_url.icon",n.SegmentDetailContentDeleteIcon="knowledge.segment.detail.content.delete.icon",n.SegmentDetailContentAddRowBtn="knowledge.segment.detail.content.add_row.btn",n.SegmentDetailContentSelectTrigger="knowledge.segment.detail.content.select.trigger",n.SegmentDetailContentSelectTriggerEditIcon="knowledge.segment.detail.content.select.trigger.edit.icon",n.SegmentDetailBatchFrequencyModalSelect="knowledge.segment.detail.batch_frequency.modal.select",n.SegmentDetailBatchFrequencyModalcheckboxAll="knowledge.segment.detail.batch_frequency.modal.checkbox_all",n.SegmentDetailBatchFrequencyModalcheckboxItem="knowledge.segment.detail.batch_frequency.modal.checkbox_item",n.ResegmentUploadUnitNextBtn="knowledge.resegment.unit.next.btn",n.ResegmentUnitConfirmBtn="knowledge.resegment.unit.confirm.btn",n.UnitDetailTags="knowledge.unit.detail.tags",n.UnitDetailTagsProcessing="knowledge.unit.detail.tags.processing.tag",n.UnitDetailTagsFailed="knowledge.unit.detail.tags.failed.tag",n.KnowledgeAddContentNavBar="knowledge.unit.add.content.navbar",n)},745474:function(e,t,r){r.d(t,{Z9:()=>C,s5:()=>M,xV:()=>j,xW:()=>w});var n,a=r("151064");r("455069");var o=r("297158"),i=r("336205"),s=r("763055"),l=r("407821"),c=r.n(l),d=r("472772"),u=r.n(d),v=r("395245"),m=r.n(v),g=r("297998"),p=r.n(g),f=r("646576"),h=r.n(f),_=r("606121"),x=r.n(_),y=r("204343"),b={};b.styleTagTransform=x(),b.setAttributes=p(),b.insert=m().bind(null,"head"),b.domAPI=u(),b.insertStyleElement=h(),c()(y.Z,b);var S=y.Z&&y.Z.locals?y.Z.locals:void 0,C=e=>{var{namespace:t}=e;return(0,a.jsx)("div",{className:S.wrapper,children:(0,a.jsxs)("div",{className:S.content,children:[(0,a.jsx)(s.B9,{width:140,height:140}),(0,a.jsx)("div",{className:S.title,children:i.o.t("data_error_title",{module:t})}),(0,a.jsx)("div",{className:S.paragraph,children:i.o.t("data_error_msg")})]})})},j=e=>{var{children:t,namespace:r}=e;return(0,a.jsx)(o.SV,{onError:e=>{o.kg.persist.error({eventName:"".concat(r,"_error_boundary"),error:e})},errorBoundaryName:"".concat(r,"-error-boundary"),FallbackComponent:()=>(0,a.jsx)(C,{namespace:r}),children:t})};var w=((n={}).KNOWLEDGE="knowledge",n.DATABASE="database",n.FILEBOX="filebox",n.VARIABLE="variable",n.TIMECAPSULE="timeCapsule",n.MEMORY="memory",n),E=r("962289"),k=r("808549"),I=r("473980"),T=e=>{var{type:t,namespace:r,event:n,meta:a}=e,{meta:i}=n,s=(0,I._)(n,["meta"]),l=(0,k._)({namespace:r,meta:(0,k._)({},a,i)},s);"error"===t?o.E7.errorEvent(l):o.E7.event(l)},M=new class e{getMeta(){var e=window.location.pathname,t=/\/space\/(\d+)\/knowledge(\/(\d+)(\/(\d+))?)?/gi.exec(e);return{spaceId:(0,E.Z)(t,1),knowledgeId:(0,E.Z)(t,3),documentId:(0,E.Z)(t,5)}}errorEvent(e,t){T({type:"error",namespace:e,event:t,meta:this.getMeta()})}event(e,t){T({type:"custom",namespace:e,event:t,meta:this.getMeta()})}}},263825:function(e,t,r){r.d(t,{od:()=>ei,sr:()=>es,NB:()=>K,R:()=>v,hJ:()=>ee,eI:()=>Q,AT:()=>l,iQ:()=>F,y8:()=>D,HA:()=>s,$6:()=>d,WU:()=>c,S2:()=>et,L5:()=>U});var n,a,o=r("537714"),i=r("280053"),s=e=>{switch(e){case o.Cm.TABLE:case o.Cm.TABLE_API:case o.Cm.TABLE_DOC:case o.Cm.TABLE_CUSTOM:case o.Cm.TABLE_FEISHU:case o.Cm.TABLE_GOOGLE_DRIVE:return i.a5.Table;case o.Cm.IMAGE:case o.Cm.IMAGE_FILE:return i.a5.Image;default:return i.a5.Text}};var l=((n={}).ALL="ALL",n.TEXT="TEXT",n.TABLE="TABLE",n.IMAGE="IMAGE",n);var c=((a={})[a.NotUpdate=0]="NotUpdate",a[a.EveryDay=1]="EveryDay",a[a.ThreeDay=3]="ThreeDay",a[a.SevenDay=7]="SevenDay",a[a.ThirtyDay=30]="ThirtyDay",a),d=e=>e===i.NZ.FeishuWeb||e===i.NZ.LarkWeb,u=r("336205"),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{documentSource:t}=e;return[{value:0,label:u.o.t("datasets_frequencyModal_frequency_noUpdate")},{value:1,label:u.o.t("datasets_frequencyModal_frequency_day",{num:1})},{value:3,label:u.o.t("datasets_frequencyModal_frequency_day",{num:3})},{value:7,label:u.o.t("datasets_frequencyModal_frequency_day",{num:7})},...d(t)?[]:[{value:30,label:u.o.t("datasets_frequencyModal_frequency_day",{num:30})}]]},m=r("808549"),g=r("120454"),p=r("151064"),f=r("455069"),h=r("594022"),_=r("252237"),x=r.n(_),y=r("626862"),b=r("674343"),S=r("222220"),C=r("407821"),j=r.n(C),w=r("472772"),E=r.n(w),k=r("395245"),I=r.n(k),T=r("297998"),M=r.n(T),A=r("646576"),N=r.n(A),L=r("606121"),Z=r.n(L),G=r("891794"),P={};P.styleTagTransform=Z(),P.setAttributes=M(),P.insert=I().bind(null,"head"),P.domAPI=E(),P.insertStyleElement=N(),j()(G.Z,P);var B=G.Z&&G.Z.locals?G.Z.locals:void 0,R=e=>{var t=(0,y.Z)({value:e.value});return(0,p.jsxs)("div",{"data-testid":S.M.CommonDataTypeSelect,className:x()(B["select-wapper"],(null==e?void 0:e.errorMsg)?B["error-wapper"]:null),children:[(0,p.jsx)(b.Ph,(0,g._)((0,m._)({},e.selectProps),{style:{width:"100%"},clickToHide:!0,value:t.value,onChange:r=>{var n;t.value=r,null==e||null===(n=e.handleChange)||void 0===n||n.call(e,r)}})),(null==e?void 0:e.errorMsg)?(0,p.jsx)("div",{className:"singleline-select-error-content",children:(0,p.jsx)("div",{className:"select-error-text",children:null==e?void 0:e.errorMsg})}):null]})},D=e=>({[h.QD.Unknown]:"Unknown",[h.QD.Text]:u.o.t("db_add_table_field_type_txt"),[h.QD.Number]:u.o.t("db_add_table_field_type_int"),[h.QD.Date]:u.o.t("db_add_table_field_type_time"),[h.QD.Float]:u.o.t("db_add_table_field_type_number"),[h.QD.Boolean]:u.o.t("db_add_table_field_type_bool"),[h.QD.Image]:u.o.t("knowledge_insert_img_010")})[e]||"",F=()=>[{value:h.QD.Text,label:D(h.QD.Text)},{value:h.QD.Number,label:D(h.QD.Number)},{value:h.QD.Date,label:D(h.QD.Date)},{value:h.QD.Float,label:D(h.QD.Float)},{value:h.QD.Boolean,label:D(h.QD.Boolean)},{value:h.QD.Image,label:D(h.QD.Image)}],U=e=>{var t,[r,n]=(0,f.useState)(e.value);return(0,p.jsx)(R,{value:r,selectProps:(0,g._)((0,m._)({},e.selectProps),{optionList:(null===(t=e.selectProps)||void 0===t?void 0:t.optionList)||F()}),errorMsg:e.errorMsg,handleChange:t=>{var r;n(t),null===(r=e.handleChange)||void 0===r||r.call(e,t)}})};r("94347");var O=r("14727"),z={};z.styleTagTransform=Z(),z.setAttributes=M(),z.insert=I().bind(null,"head"),z.domAPI=E(),z.insertStyleElement=N(),j()(O.Z,z);var W=O.Z&&O.Z.locals?O.Z.locals:void 0,H=e=>{var{maxLen:t,len:r}=e;return(0,p.jsxs)("span",{className:W["limit-count"],children:[(0,p.jsx)("span",{children:r}),(0,p.jsx)("span",{children:"/"}),(0,p.jsx)("span",{children:t})]})},K=(0,b.Q2)(e=>{var{value:t,maxLength:r,getValueLength:n}=e,a=(0,f.useMemo)(()=>n?n(t):t?t.toString().length:0,[t,n]);return(0,p.jsx)(b.II,(0,g._)((0,m._)({},e),{autoComplete:"off",suffix:!!r&&(0,p.jsx)(H,{maxLen:null!=r?r:0,len:a})}))}),V=r("473980"),q=r("497803"),Y={};Y.styleTagTransform=Z(),Y.setAttributes=M(),Y.insert=I().bind(null,"head"),Y.domAPI=E(),Y.insertStyleElement=N(),j()(q.Z,Y);var X=q.Z&&q.Z.locals?q.Z.locals:void 0,J=(0,b.Q2)(b.Kx,{}),Q=(0,f.forwardRef)((e,t)=>{var{fieldClassName:r}=e,n=(0,V._)(e,["fieldClassName"]);return(0,p.jsx)(J,(0,g._)((0,m._)({ref:t},n),{fieldClassName:x()(r,X.field)}))}),$=r("825955");function ee(){var e=(0,f.useRef)(null);return null===e.current&&(e.current=new AbortController),(0,f.useEffect)(()=>()=>{e.current&&e.current.abort()},[]),e.current.signal}function et(e,t){return(0,$._)(function*(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];try{if(t.aborted)throw Error("Function aborted");var o=e(...n);if(o instanceof Promise)return yield Promise.race([o,new Promise((e,r)=>{t.addEventListener("abort",()=>r(Error("Function aborted")),{once:!0})})]);return o}catch(e){console.log(e)}})}var er=r("775699"),en=r("422724"),ea={};ea.styleTagTransform=Z(),ea.setAttributes=M(),ea.insert=I().bind(null,"head"),ea.domAPI=E(),ea.insertStyleElement=N(),j()(en.Z,ea);var eo=en.Z&&en.Z.locals?en.Z.locals:void 0,ei=e=>{var{className:t}=e,r=(0,V._)(e,["className"]);return(0,er.dd)((0,g._)((0,m._)({},r),{className:x()(eo["ui-data-modal"],t)}))},es=e=>{var{centered:t=!0}=e,r=(0,V._)(e,["centered"]),[n,a]=(0,f.useState)(!1),[o,i]=(0,f.useState)(!1);return{modal:e=>(0,p.jsx)(b.u_,(0,g._)((0,m._)({closeOnEsc:!0,centered:!!t,visible:n,okButtonProps:{disabled:o}},r),{children:e})),open:()=>a(!0),close:()=>a(!1),visible:n,disableOk:()=>i(!0),enableOk:()=>i(!1),canOk:!o}}},975083:function(e,t,r){r.d(t,{J:()=>p,S:()=>f});var n=r("151064"),a=r("455069"),o=r("808549"),i=r("120454"),s=r("479910"),l=r("598208"),c={processingDatasets:new Set},d=()=>(0,l.Ue)()((0,s.mW)((e,t)=>(0,i._)((0,o._)({},c),{getIsProcessing:e=>{var{processingDatasets:r}=t();return r.has(e)},addProcessingDataset:r=>{var{processingDatasets:n}=t();n.add(r),e({processingDatasets:n})},clearProcessingSet:()=>{var{processingDatasets:r}=t();r.clear(),e({processingDatasets:r})},deleteProcessingDataset:r=>{var{processingDatasets:n}=t();if(!!n.has(r))n.delete(r),e({processingDatasets:n})}}))),u=e=>(0,l.Ue)()((0,s.mW)((0,s.XR)((t,r)=>({params:e})),{enabled:!1,name:"knowledge.params"})),v=r("525069"),m=e=>({canEdit:!(null==e?void 0:e.version),dataSetDetail:{},documentList:[],curDocId:"",searchValue:"",photoFilterValue:"All"}),g=e=>(0,l.Ue)()((0,s.mW)(function(t,r){for(var n=arguments.length,a=Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return(0,i._)((0,o._)({},m(e),(0,v.G)(),(0,v.Y)(t,r,...a)),{setDataSetDetail:r=>{t({dataSetDetail:r}),t({canEdit:(null==r?void 0:r.can_edit)&&!(null==e?void 0:e.version)})},setDocumentList:e=>{t({documentList:e})},setSearchValue:e=>{t({searchValue:e})},setPhotoFilterValue:e=>{t({photoFilterValue:e})},setCanEdit:e=>{t({canEdit:e})},setCurDocId:e=>{t({curDocId:e})},reset:()=>{t(m(e))}})},{name:"DEV_TOOLS_NAME_SPACE",enabled:!1})),p=(0,a.createContext)({paramsStore:void 0,knowledgeStore:void 0,processingKnowledge:void 0,callbacks:{},resourceNavigate:{}}),f=e=>{var{children:t,params:r,onUpdateDisplayName:o,onStatusChange:i,resourceNavigate:s}=e,l=(0,a.useRef)(),c=(0,a.useRef)(),v=(0,a.useRef)();return l.current=u(r),!c.current&&(c.current=g({version:r.version})),!v.current&&(v.current=d()),(0,n.jsx)(p.Provider,{value:{paramsStore:l.current,knowledgeStore:c.current,processingKnowledge:v.current,callbacks:{onUpdateDisplayName:o,onStatusChange:i},resourceNavigate:s},children:t})}},22916:function(e,t,r){r.d(t,{j_:()=>x,S9:()=>l.S,JK:()=>l.J,kJ:()=>u,DY:()=>c,Y8:()=>g.Y,kF:()=>d,EV:()=>v,G6:()=>g.G,PR:()=>m});var n=r("455069"),a=r("716894"),o=r("992499"),i=r("458620"),s=r("727914"),l=r("975083"),c=e=>{var t=(0,n.useContext)(l.J);if(!t.paramsStore)throw new s.sH(i.b.normalError,"params store context");return(0,a.s)(t.paramsStore,e,o.X)},d=()=>c(e=>e.params),u=()=>{var{callbacks:{onStatusChange:e,onUpdateDisplayName:t}}=(0,n.useContext)(l.J);return{onStatusChange:e,onUpdateDisplayName:t}},v=()=>{var{resourceNavigate:e}=(0,n.useContext)(l.J);return e},m=e=>{var t=(0,n.useContext)(l.J);if(!t.knowledgeStore)throw new s.sH(i.b.normalError,"params store context");return(0,a.s)(t.knowledgeStore,e,o.X)},g=r("525069"),p=r("808549"),f=r("120454"),h=r("280053"),_=()=>({enableStorageStrategy:!1,storageLocation:h.Ac.Default,openSearchConfig:{},testConnectionSuccess:!1}),x=e=>(0,f._)((0,p._)({},_()),{setEnableStorageStrategy:t=>e({enableStorageStrategy:t}),setStorageLocation:t=>e({storageLocation:t}),setOpenSearchConfig:t=>e({openSearchConfig:t}),setTestConnectionSuccess:t=>e({testConnectionSuccess:t})})},525069:function(e,t,r){r.d(t,{G:function(){return o},Y:function(){return i}});var n=r(808549),a=r(120454),o=()=>({levelSegments:[]}),i=e=>(0,a._)((0,n._)({},o()),{setLevelSegments:t=>e(()=>({levelSegments:t}))})},558194:function(e,t,r){r.d(t,{A:()=>a});var n=r("479910"),a=(0,r("598208").Ue)()((0,n.mW)(e=>({dataSetList:[],setDataSetList:t=>{e({dataSetList:t},!1,"setDataSetList")}}),{name:"Coze.Agent.Dataset",enabled:!1}))},848032:function(e,t,r){r.d(t,{U:function(){return o},X:function(){return i}});var n,a,o=((n={}).ADD="add",n.REMOVE="remove",n);var i=((a={}).All="All",a.HasCaption="HasCaption",a.NoCaption="NoCaption",a)},328591:function(e,t,r){r.d(t,{$L:()=>ev,mq:()=>ed,Ej:()=>n.Ej,Eb:()=>ec,ey:()=>eu});var n=r("695673"),a=r("808549"),o=r("120454"),i=r("825955"),s=r("151064"),l=r("455069"),c=r("263825"),d=r("22916"),u=r("537714"),v=r("385038"),m=r("75117"),g=r("336205"),p=r("653598"),f=r("178385"),h=r("382534"),_=r("674343"),x=r("775699"),y=r("915757"),b=r("937221"),S=r("319695"),C=r("497034"),j=r("407821"),w=r.n(j),E=r("472772"),k=r.n(E),I=r("395245"),T=r.n(I),M=r("297998"),A=r.n(M),N=r("646576"),L=r.n(N),Z=r("606121"),G=r.n(Z),P=r("779021"),B={};B.styleTagTransform=G(),B.setAttributes=A(),B.insert=T().bind(null,"head"),B.domAPI=k(),B.insertStyleElement=L(),w()(P.Z,B);var R=P.Z&&P.Z.locals?P.Z.locals:void 0,D=(0,x.Q2)(e=>{var{onChange:t}=e;return(0,s.jsxs)(_.FX,{defaultValue:p.a5.Text,onChange:e=>{null==t||t(e.target.value)},type:"pureCard",direction:"horizontal",className:R["select-format-type"],children:[(0,s.jsxs)(_.Y8,{value:p.a5.Text,"data-testid":v.w.CreateKnowledgeModalTextRadioGroup,children:[(0,s.jsx)("div",{className:"radio-logo",children:(0,s.jsx)(b.r,{})}),(0,s.jsx)("div",{children:g.o.t("create-knowledge-text-type")})]},p.a5.Text),(0,s.jsxs)(_.Y8,{value:p.a5.Table,"data-testid":v.w.CreateKnowledgeModalTableRadioGroup,children:[(0,s.jsx)("div",{className:"radio-logo",children:(0,s.jsx)(S.r,{})}),(0,s.jsx)("div",{children:g.o.t("create-knowledge-table-type")}),(0,s.jsx)(_.u,{content:g.o.t("knowledge_table_nl2sql_tooltip"),children:(0,s.jsx)(y.L03,{className:"info-icon"})})]},p.a5.Table),(0,s.jsxs)(_.Y8,{value:p.a5.Image,"data-testid":v.w.CreateKnowledgeModalPhotoRadioGroup,children:[(0,s.jsx)("div",{className:"radio-logo",children:(0,s.jsx)(C.r,{})}),(0,s.jsx)("div",{children:g.o.t("knowledge_photo_001")})]},p.a5.Image)]})}),F=r("280053"),U=e=>{var{title:t,description:r,icon:n,e2e:a,key:o,value:i}=e;return(0,s.jsxs)(_.Y8,{value:i,extra:(0,s.jsx)(_.ZT.Text,{type:"tertiary",ellipsis:{showTooltip:{opts:{content:r}}},style:{lineHeight:"20px",width:180},children:r}),className:"flex-[0_0_49%]","data-testid":a,children:[n?(0,s.jsx)("div",{className:"flex items-center mr-2",children:n}):null,t]},o)},O=()=>(0,s.jsx)(U,{title:g.o.t("datasets_createFileModel_step1_LocalTitle"),description:g.o.t("datasets_createFileModel_step1_LocalDescription"),icon:(0,s.jsx)(y.da8,{className:"w-4 h-4"}),e2e:v.w.CreateKnowledgeModalTextLocalRadio,value:u.Cm.TEXT_DOC},u.Cm.TEXT_DOC),z=()=>(0,s.jsx)(U,{title:g.o.t("datasets_createFileModel_step1_CustomTitle"),description:g.o.t("datasets_createFileModel_step1_CustomDescription"),icon:(0,s.jsx)(y.YRi,{className:"w-4 h-4"}),e2e:v.w.CreateKnowledgeModalTextCustomRadio,value:u.Cm.TEXT_CUSTOM},u.Cm.TEXT_CUSTOM),W=r("226160"),H={};H.styleTagTransform=G(),H.setAttributes=A(),H.insert=T().bind(null,"head"),H.domAPI=k(),H.insertStyleElement=L(),w()(W.Z,H);var K=W.Z&&W.Z.locals?W.Z.locals:void 0,V=e=>{var{value:t,onChange:r,children:n}=e;return(0,s.jsx)("div",{className:K["radio-wrapper"],children:(0,s.jsx)(_.FX,{type:"pureCard",onChange:r,value:t,direction:"horizontal",name:"format-type",className:K["radio-group"],children:n})})},q=e=>{var{initValue:t,onChange:r}=e;return(0,s.jsxs)(V,{value:t,onChange:e=>{r(e.target.value)},children:[(0,s.jsx)(O,{}),(0,s.jsx)(z,{})]})},Y=()=>(0,s.jsx)(U,{title:g.o.t("datasets_createFileModel_step1_TabLocalTitle"),description:g.o.t("datasets_createFileModel_step1_TabLocalDescription"),icon:(0,s.jsx)(y.da8,{className:"w-4 h-4"}),e2e:v.w.CreateKnowledgeModalTableLocalRadio,value:u.Cm.TABLE_DOC},u.Cm.TABLE_DOC),X=()=>(0,s.jsx)(U,{title:g.o.t("datasets_createFileModel_step1_TabCustomTitle"),description:g.o.t("datasets_createFileModel_step1_TabCustomDescription"),icon:(0,s.jsx)(y.YRi,{className:"w-4 h-4"}),e2e:v.w.CreateKnowledgeModalTableCustomRadio,value:u.Cm.TABLE_CUSTOM},u.Cm.TABLE_CUSTOM),J=e=>{var{initValue:t,onChange:r}=e;return(0,s.jsxs)(V,{value:t,onChange:e=>{r(e.target.value)},children:[(0,s.jsx)(Y,{}),(0,s.jsx)(X,{})]})},Q=()=>(0,s.jsx)(U,{title:g.o.t("knowledge_photo_002"),description:g.o.t("knowledge_photo_003"),icon:(0,s.jsx)(y.da8,{className:"w-4 h-4"}),e2e:v.w.CreateKnowledgeModalPhotoImgRadio,value:u.Cm.IMAGE_FILE},u.Cm.IMAGE_FILE),$=e=>{var{initValue:t,onChange:r}=e;return(0,s.jsx)(V,{value:t,onChange:e=>{r(e.target.value)},children:(0,s.jsx)(Q,{})})},ee=e=>{var{formatType:t,initValue:r,onChange:n}=e;return t===F.a5.Text?(0,s.jsx)(q,{initValue:r,onChange:n}):t===F.a5.Image?(0,s.jsx)($,{initValue:r,onChange:n}):t===F.a5.Table?(0,s.jsx)(J,{initValue:r,onChange:n}):void 0},et=r("130084"),er={};er.styleTagTransform=G(),er.setAttributes=A(),er.insert=T().bind(null,"head"),er.domAPI=k(),er.insertStyleElement=L(),w()(et.Z,er);var en=et.Z&&et.Z.locals?et.Z.locals:void 0,ea=e=>{var t,{onImportKnowledgeTypeChange:r,onSelectFormatTypeChange:n}=e,d=(0,_.XQ)(),[x,y]=(0,l.useState)(p.a5.Text),[b,S]=(0,l.useState)({name:"",desc:""}),[C,j]=(0,l.useState)({uri:"",url:""});var w=(t=(0,i._)(function*(e){var t,r,n,a,{icon:o}=yield h.MJ.GetIcon({format_type:e});j(o);var i=d.getValue("icon_uri");(!i||(null===(t=i[0])||void 0===t?void 0:t.isDefault))&&d.setValue("icon_uri",[{url:null!==(r=null==o?void 0:o.url)&&void 0!==r?r:"",uri:null!==(n=null==o?void 0:o.uri)&&void 0!==n?n:"",uid:null!==(a=null==o?void 0:o.uri)&&void 0!==a?a:"",isDefault:!0}])}),function(e){return t.apply(this,arguments)}),[E,k]=(0,l.useState)(u.Cm.TEXT_DOC);return(0,l.useEffect)(()=>{w(x),x===p.a5.Text?k(u.Cm.TEXT_DOC):x===p.a5.Table?k(u.Cm.TABLE_DOC):x===p.a5.Image&&k(u.Cm.IMAGE_FILE)},[x]),(0,l.useEffect)(()=>{if(!!E)null==r||r(E)},[E]),(0,s.jsxs)("div",{"data-testid":v.w.CreateKnowledgeModal,children:[(0,s.jsx)(D,{field:"format_type",noLabel:!0,onChange:e=>{y(e),d.setValue("format_type",e),null==n||n(e)}}),(0,s.jsx)(c.NB,{"data-testid":v.w.CreateKnowledgeModalNameInput,field:"name",label:g.o.t("datasets_model_create_name"),maxLength:100,onChange:e=>{S(t=>(0,o._)((0,a._)({},t),{name:(null==e?void 0:e.trim())||""}))},rules:[{required:!0,whitespace:!0,message:g.o.t("dataset-name-empty-tooltip")},{pattern:/^[^"'`\\]+$/,message:g.o.t("dataset-name-has-wrong-word-tooltip")}],placeholder:g.o.t("datasets_model_create_name_placeholder")}),(0,s.jsx)(c.eI,{field:"description","data-testid":v.w.CreateKnowledgeModalDescInput,label:g.o.t("datasets_model_create_description"),autosize:{minRows:1,maxRows:2},maxCount:2e3,maxLength:2e3,placeholder:g.o.t("datasets_model_create_description_placeholder"),onChange:e=>{S(t=>(0,o._)((0,a._)({},t),{desc:(null==e?void 0:e.trim())||""}))}}),(0,s.jsxs)("div",{className:"semi-form-field","x-label-pos":"top","x-field-id":"name","x-extra-pos":"bottom",children:[(0,s.jsx)("label",{className:"semi-form-field-label semi-form-field-label-left",children:(0,s.jsx)("div",{className:"semi-form-field-label-text","x-semi-prop":"label",children:g.o.t("create-dataset-import-type")})}),(0,s.jsx)(ee,{formatType:x,initValue:E,onChange:k})]}),(0,s.jsx)(m.s,{label:g.o.t("datasets_model_create_avatar"),field:"icon_uri",testId:v.w.CreateKnowledgeModalAvatarUploader,fileBizType:f.ym.BIZ_DATASET_ICON,uploadClassName:en["upload-avatar-container"],iconType:f.Tu.Dataset,generateInfo:b,generateTooltip:{generateBtnText:g.o.t("dataset_create_knowledge_generate_avatar_tips"),contentNotLegalText:g.o.t("dataset_create_knowledge_generate_content_tips")},initValue:[{url:null==C?void 0:C.url,uri:null==C?void 0:C.uri,isDefault:!0}]})]})},eo=r("214942"),ei=r("344513"),es={};es.styleTagTransform=G(),es.setAttributes=A(),es.insert=T().bind(null,"head"),es.domAPI=k(),es.insertStyleElement=L(),w()(ei.Z,es);var el=ei.Z&&ei.Z.locals?ei.Z.locals:void 0,ec=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onFinish:r,beforeCreate:n,projectID:a}=t,o=(0,l.useRef)(null),[m,f]=(0,l.useState)(p.a5.Text),x=(0,eo.rY)(e=>e.getSpaceId()),y=(0,d.EV)(),[b,S]=(0,l.useState)(u.Cm.TEXT_DOC);var C=(e=(0,i._)(function*(){yield null===(e=o.current)||void 0===e?void 0:e.formApi.validate();var e,t,r,n,i,{dataset_id:s}=yield h.MJ.CreateDataset({project_id:a||void 0,name:null===(t=o.current)||void 0===t?void 0:t.formApi.getValue("name"),format_type:m,description:null===(r=o.current)||void 0===r?void 0:r.formApi.getValue("description"),icon_uri:null===(i=o.current)||void 0===i?void 0:null===(n=i.formApi.getValue("icon_uri"))||void 0===n?void 0:n[0].uid,space_id:x||void 0});return s}),function(){return e.apply(this,arguments)}),{open:j,close:w,modal:E}=(0,c.sr)({title:(0,s.jsx)("div",{"data-testid":v.w.CreateKnowledgeModalTitle,children:g.o.t("datasets_model_create_title")}),centered:!0,className:el["create-knowledge-modal"],onCancel:()=>{w()},footer:(0,s.jsxs)("div",{className:"flex w-full justify-end",children:[(0,s.jsx)(_.zx,{color:"primary",onClick:()=>{w()},children:g.o.t("cancel")}),(0,s.jsx)(_.fl,{color:"primary",onClick:(0,i._)(function*(){null==n||n(!1);var e,t=yield C();r?r(t||"",b,!1):null===(e=y.toResource)||void 0===e||e.call(y,"knowledge",t)}),children:g.o.t("kl_write_108")}),(0,s.jsx)(_.fl,{"data-testid":v.w.CreateKnowledgeModalSubmitAndImportButton,color:"primary",onClick:(0,i._)(function*(){null==n||n(!0);var e,t=yield C();r?r(t||"",b,!0):null===(e=y.upload)||void 0===e||e.call(y,{type:b})}),children:g.o.t("kl_write_109")})]})});return{modal:E((0,s.jsx)(_.l0,{ref:o,showValidateIcon:!1,className:el["create-form"],children:(0,s.jsx)(ea,{onImportKnowledgeTypeChange:S,onSelectFormatTypeChange:f})})),open:()=>{f(p.a5.Text),j()},close:w}},ed=e=>{var{onClickAddKnowledge:t,beforeCreate:r,projectID:i}=e,s=ec({projectID:i,onFinish:(e,r,n)=>{null==t||t(e,r,n),s.close()},beforeCreate:r});return(0,n.mq)((0,o._)((0,a._)({},e),{createKnowledgeModal:s}))},eu=e=>{var{projectID:t,onClickAddKnowledge:r,beforeCreate:i}=e,s=ec({projectID:t,onFinish:(e,t,n)=>{null==r||r(e,t,n),s.close()},beforeCreate:i});return(0,n.ey)((0,o._)((0,a._)({},e),{createKnowledgeModal:s}))},ev=e=>{var{projectID:t,onClickAddKnowledge:r,beforeCreate:i}=e,l=ec({projectID:t,onFinish:(e,t,n)=>{null==r||r(e,t,n),l.close()},beforeCreate:i});return(0,s.jsx)(n.$L,(0,o._)((0,a._)({},e),{createKnowledgeModal:l}))}},695673:function(e,t,r){r.d(t,{wO:()=>eB,by:()=>h,I1:()=>f,Af:()=>ed,bp:()=>eA,mp:()=>e_,yI:()=>tx,mq:()=>t_,nV:()=>eF,Ej:()=>G,ey:()=>tm,qS:()=>ev,fj:()=>_,AT:()=>d.AT,$L:()=>tg,i0:()=>tI,Yw:()=>eS});var n,a,o,i=r("808549"),s=r("120454"),l=r("151064"),c=r("455069"),d=r("263825"),u=r("385038"),v=r("75117"),m=r("336205"),g=r("178385"),p=r("674343"),f=100,h=300,_=1e4,x="data-refactor",y=r("407821"),b=r.n(y),S=r("472772"),C=r.n(S),j=r("395245"),w=r.n(j),E=r("297998"),k=r.n(E),I=r("646576"),T=r.n(I),M=r("606121"),A=r.n(M),N=r("620266"),L={};L.styleTagTransform=A(),L.setAttributes=k(),L.insert=w().bind(null,"head"),L.domAPI=C(),L.insertStyleElement=T(),b()(N.Z,L);var Z=N.Z&&N.Z.locals?N.Z.locals:void 0;function G(e){var t=(0,c.useRef)(null),r=(0,c.useRef)({}),n=(0,c.useRef)(""),[a,o]=(0,c.useState)(""),[f,h]=(0,c.useState)({name:"",desc:""}),_=()=>{var e,r=null===(e=t.current)||void 0===e?void 0:e.formApi.getValues();if(r)return(0,s._)((0,i._)({},r),{icon_uri:r.icon_uri})},{open:y,close:b,modal:S,disableOk:C,enableOk:j,canOk:w}=(0,d.sr)({title:m.o.t("datasets_editProfile_title"),cancelText:m.o.t("Cancel"),centered:!0,okText:m.o.t("Confirm"),onOk:()=>{e.onOk((0,s._)((0,i._)({},_()),{id:n.current})),b()},onCancel:()=>{b()}}),E=(0,c.useCallback)(()=>{var e,r=null===(e=t.current)||void 0===e?void 0:e.formApi.getValue("name");return r?/["'`\\]+/g.test(r)?m.o.t("dataset-name-has-wrong-word-tooltip"):"":m.o.t("dataset-name-empty-tooltip")},[]);return{node:S((0,l.jsx)("div",{className:"".concat(x," ").concat(Z["create-dataset-modal"]),children:(0,l.jsxs)(p.l0,{ref:t,showValidateIcon:!1,initValues:r.current,onValueChange:e=>{var{name:t,description:r}=e;h({name:(null==t?void 0:t.trim())||"",desc:(null==r?void 0:r.trim())||""}),o(""),!t||E()?C():!w&&j()},children:[(0,l.jsx)(d.NB,{"data-testid":u.w.KnowledgeEditModalNameInput,field:"name",label:m.o.t("datasets_model_create_name"),maxLength:100,rules:[{required:!0,message:m.o.t("datasets_model_create_name_placeholder")}],placeholder:m.o.t("datasets_model_create_name_placeholder"),validate:E}),(0,l.jsx)(d.eI,{"data-testid":u.w.KnowledgeEditModalDescInput,field:"description",label:m.o.t("datasets_model_create_description"),rows:2,maxCount:2e3,maxLength:2e3,placeholder:m.o.t("datasets_model_create_description_placeholder")}),a?(0,l.jsx)(p.l0.ErrorMessage,{error:a}):null,(0,l.jsx)(v.s,{label:m.o.t("datasets_model_create_avatar"),withAutoGenerate:!0,renderAutoGenerate:e.renderAutoGenerateKnowledgeIcon,field:"icon_uri",generateInfo:f,generateTooltip:{generateBtnText:m.o.t("dataset_create_knowledge_generate_avatar_tips"),contentNotLegalText:m.o.t("dataset_create_knowledge_generate_content_tips")},initValue:r.current.icon_uri,iconType:g.Tu.Dataset,fileBizType:g.ym.BIZ_DATASET_ICON})]})})),open:y,edit:e=>{r.current=e,n.current=e.id,h({name:e.name||"",desc:e.description||""}),y()},close:()=>{b()}}}var P=r("311807"),B=r("788637"),R=r("61111"),D=r("252237"),F=r.n(D),U=r("177198"),O=r("109915"),z=r("775699"),W=r("44172"),H=r("839974"),K=r("730274"),V=e=>{var{datasetInfo:t,field:r,value:n}=e;return t.recall_strategy?t.recall_strategy[r]=n:t.recall_strategy={[r]:n},t},q=r("286248"),Y={};Y.styleTagTransform=A(),Y.setAttributes=k(),Y.insert=w().bind(null,"head"),Y.domAPI=C(),Y.insertStyleElement=T(),b()(q.Z,Y);var X=q.Z&&q.Z.locals?q.Z.locals:void 0,J=e=>{var{min:t=0,max:r=100,step:n=1,precision:a=0,value:o,marks:i,onChange:s,disabled:c}=e;return(0,l.jsxs)("div",{className:X["slider-area"],children:[(0,l.jsxs)("div",{className:X["slider-wrapper"],children:[(0,l.jsx)("div",{className:X.slider,children:(0,l.jsx)(z.iR,{step:n,min:t,max:r,value:o,marks:i,disabled:c,onChange:e=>s(e)})}),(0,l.jsx)(z.Rn,{className:X["input-number"],step:n,precision:a,onChange:e=>{var t=Number(e);(t=isNaN(t)?o:Math.max(t=t||o,0))>r&&(t=r),s(t)},value:o,min:t,max:r,disabled:c})]}),(0,l.jsxs)("div",{className:X["slider-boundary"],children:[(0,l.jsx)("div",{className:X.min,children:t}),(0,l.jsx)("div",{className:X.max,children:r})]})]})};function Q(e){var{title:t,tip:r,tipStyle:n={}}=e;return(0,l.jsxs)("div",{className:X["title-area"],children:[t,!!r&&(0,l.jsx)(p.J2,{showArrow:!0,position:"top",zIndex:1031,style:(0,i._)({maxWidth:"276px"},n),content:r,children:(0,l.jsx)(W.aUG,{className:X["title-area-icon"]})})]})}var $=e=>{var{title:t,tip:r,children:n,className:a,tipStyle:o}=e;return(0,l.jsxs)("div",{className:F()(X["setting-item-container"],a),children:[(0,l.jsx)(Q,{title:m.o.t(t),tip:r||"",tipStyle:o}),(0,l.jsx)("div",{className:F()(X["setting-item"],"dataset-setting-content-item"),children:n})]})};function ee(e){var t,{options:r,value:n,disabled:a,onChange:o}=e,s=null===(t=r.find(e=>e.value===n))||void 0===t?void 0:t.desc;return(0,l.jsxs)("div",{className:X["radio-area"],children:[(0,l.jsx)(z.FX,{onChange:e=>o(e.target.value),value:n,disabled:a,children:r.map(e=>(0,l.jsxs)("div",{"data-testid":e.e2e,className:F()(X["radio-item"],n===e.value?X.active:X.normal),children:[(0,l.jsx)(z.Y8,{value:e.value,children:e.label}),!!e.tip&&(0,l.jsx)(z.J2,{showArrow:!0,position:"top",zIndex:1031,style:(0,i._)({backgroundColor:"#41464c",color:"#fff",maxWidth:"276px"},e.tipStyle||{}),content:e.tip,children:(0,l.jsx)(W.aUG,{className:X["radio-item-icon"]})})]},e.value))}),s?(0,l.jsx)("div",{className:X["radio-desc"],children:s}):null]})}var et=r("626389"),er=r.n(et),en=r("522961"),ea=r("407214"),eo=()=>[{label:m.o.t("knowledge_hybird_search_title"),value:1,tip:m.o.t("knowledge_hybird_search_tooltip")},{label:m.o.t("knowledge_semantic_search_title"),value:0,tip:m.o.t("knowledge_semantic_search_tooltip")},{label:m.o.t("knowledge_full_text_search_title"),value:20,tip:m.o.t("knowledge_full_text_search_tooltip")}],ei=()=>{var e=e=>{if(!!er()(e))z.FN.success({content:m.o.t("copy_success"),showClose:!1})};return[{e2e:U.A.BotKnowledgeSettingModalAutoRadio,label:m.o.t("dataset_automatic_call"),value:1},{e2e:U.A.BotKnowledgeSettingModalManualRadio,label:m.o.t("dataset_on_demand_call"),value:0,desc:(0,l.jsxs)(l.Fragment,{children:[m.o.t("bot_edit_dataset_on_demand_prompt1"),(0,l.jsx)(z.u,{content:m.o.t("bot_edit_datasets_copyName"),children:(0,l.jsxs)(z.fS,{onClick:()=>e(m.o.t("dataset_recall_copy_value")),type:"light",className:X["setting-item-copy"],children:[m.o.t("dataset_recall_copy_label"),(0,l.jsx)(W.vUr,{className:X["icon-copy"]})]})}),m.o.t("bot_edit_dataset_on_demand_prompt2")]})}]},es=()=>[{e2e:U.A.BotKnowledgeSettingNoRecallReplyModeDefaultRadio,label:m.o.t("No_recall_003"),value:K.Tp.Default},{e2e:U.A.BotKnowledgeSettingNoRecallReplyModeCustomizePromptRadio,label:m.o.t("No_recall_004"),value:K.Tp.CustomizePrompt,tip:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{lineHeight:"20px",color:"rgba(29, 28, 35, 1)",marginBottom:"8px"},children:m.o.t("No_recall_007")}),(0,l.jsx)(z.Ee,{width:344,preview:!1,src:"zh-CN"===m.o.language?en:ea})]}),tipStyle:{backgroundColor:"#fff",padding:"16px",minWidth:"376px",maxWidth:"376px"}}],el={"zh-CN":"/docs/guides/knowledge",en:"/docs/guides/knowledge_overview?_lang=en"},ec=()=>{var e=(0,m.D)(),t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"knowledge";window.open("".concat(window.location.origin).concat(el[e]||"/docs/guides/".concat(t)))};return[{e2e:U.A.BotKnowledgeSettingShowSourceModeCardRadio,label:m.o.t("knowledge_source_card_0002"),value:K.w_.CardList,tip:(0,l.jsxs)("div",{className:X["show-source-mode-tip"],children:[(0,l.jsx)("div",{className:X.title,children:m.o.t("knowledge_source_card_0004")}),(0,l.jsx)("div",{className:X.space,children:[{title:m.o.t("what_is_coze"),content:m.o.t("landingpage_description"),guideModule:"welcome"},{title:m.o.t("knowledge_source_display_tooltip_link"),content:m.o.t("knowledge_source_display_tooltip_content"),guideModule:"knowledge"}].map(e=>(0,l.jsxs)("div",{className:X.card,onClick:r=>{t(e.guideModule)},children:[(0,l.jsx)("div",{className:X.title,children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)(z.ZT.Text,{className:X.content,ellipsis:{rows:3,showTooltip:!1},children:e.content})]}))})]}),tipStyle:{backgroundColor:"#fff",maxWidth:"436px",minWidth:"436px",padding:"16px"}},{e2e:U.A.BotKnowledgeSettingShowSourceModeTextRadio,label:m.o.t("knowledge_source_card_0001"),value:K.w_.ReplyBottom,tip:(0,l.jsxs)("div",{className:X["show-source-mode-tip"],children:[(0,l.jsx)("div",{className:X.title,children:m.o.t("knowledge_source_card_0003")}),(0,l.jsxs)("div",{className:X.main,children:[(0,l.jsx)(z.ZT.Text,{className:X.content,children:m.o.t("knowledge_source_display_tooltip_content")}),(0,l.jsx)("div",{className:X.link,children:(0,l.jsxs)("div",{onClick:e=>{t()},children:["1. ",m.o.t("knowledge_source_display_tooltip_link")]})})]})]}),tipStyle:{backgroundColor:"#fff",maxWidth:"436px",minWidth:"436px",padding:"16px"}}]};function ed(e){var{dataSetInfo:t,onDataSetInfoChange:r,showTitle:n=!0,isReadonly:a=!1,showNL2SQLConfig:o,showAuto:d=!0,showSourceDisplay:u=!0}=e,{auto:v,min_score:g,top_k:p,search_strategy:f,show_source:h,no_recall_reply_mode:_,no_recall_reply_customize_prompt:x,show_source_mode:y,recall_strategy:b={}}=t,{use_nl2sql:S=!0,use_rerank:C=!0,use_rewrite:j=!0}=b,w=(0,m.D)(),E=(0,H.L)(),k=(0,c.useRef)(null),I=(0,P.Z)(e=>{r((0,s._)((0,i._)({},t),{no_recall_reply_customize_prompt:e}))},300);return(0,l.jsxs)("div",{className:X.setting,children:[n?(0,l.jsx)("div",{"data-testid":U.A.BotKnowledgeSettingModalTitle,className:F()(X["setting-title"],"dataset-setting-content-title"),children:m.o.t("dataset_settings_title")}):null,(0,l.jsx)("div",{className:X.recall_title,children:m.o.t("dataset-setting_recall_title")}),d?(0,l.jsx)($,{title:m.o.t("dataset_call_method"),tip:m.o.t("knowledge_call_method_tooltip"),children:(0,l.jsx)(ee,{options:ei(),value:v?1:0,onChange:e=>r((0,s._)((0,i._)({},t),{auto:!!e})),disabled:a})}):null,(0,l.jsx)($,{title:m.o.t("knowledge_search_strategy_title"),tip:m.o.t("knowledge_search_strategy_tooltip"),children:(0,l.jsx)(ee,{options:eo(),value:null!=f?f:0,onChange:e=>r((0,s._)((0,i._)({},t),{search_strategy:e})),disabled:a})}),(0,l.jsx)($,{title:m.o.t("dataset_max_recall"),tip:m.o.t("bot_edit_datasetsSettings_MaxTip"),children:(0,l.jsx)(J,{min:1,max:10,step:1,precision:0,value:p,marks:{3:m.o.t("dataset_max_recall_default")},onChange:e=>{r((0,s._)((0,i._)({},t),{top_k:e}))},disabled:a})}),p>5&&(0,l.jsx)(z.jL,{bordered:!0,type:"warning",fullMode:!1,closeIcon:null,className:F()(X["tip-area"],"dataset-setting-content-tip-area"),icon:(0,l.jsx)(W.O5N,{className:X.icon}),description:(0,l.jsx)("span",{className:X.desc,children:m.o.t("dataset_max_recall_desc")})}),b.use_rerank?(0,l.jsx)($,{title:m.o.t("dataset_min_degree"),tip:m.o.t("bot_edit_datasetsSettings_MinTip"),children:(0,l.jsx)(J,{min:.01,max:.99,step:.01,precision:2,value:g,marks:{.5:m.o.t("dataset_min_degree_default")},disabled:a,onChange:e=>{r((0,s._)((0,i._)({},t),{min_score:e}))}})}):null,o?(0,l.jsx)($,{title:m.o.t("kl_write_022"),tip:m.o.t("kl_write_023"),children:(0,l.jsx)(z.rs,{checked:S,onChange:e=>{r((0,R.Uy)(t,t=>V({datasetInfo:t,field:"use_nl2sql",value:e})))}})}):null,(0,l.jsx)($,{title:m.o.t("kl_write_024"),tip:(0,l.jsx)(O.l,{}),children:(0,l.jsx)(z.rs,{checked:j,onChange:e=>{r((0,R.Uy)(t,t=>V({datasetInfo:t,field:"use_rewrite",value:e})))}})}),(0,l.jsx)($,{title:m.o.t("kl_write_026"),tip:(0,l.jsx)(O.o,{}),children:(0,l.jsx)(z.rs,{checked:C,onChange:e=>{r((0,R.Uy)(t,t=>{var r={datasetInfo:t,field:"use_rerank",value:e};return e?!r.datasetInfo.min_score&&(r.datasetInfo.min_score=.01):r.datasetInfo.min_score=0,V(r)}))}})}),E["bot.data.no_recall_reply"]?(0,l.jsxs)("div",{className:X["setting-source-display"],children:[(0,l.jsx)("div",{className:X["setting-source-display-title"],children:m.o.t("No_recall_001")}),(0,l.jsx)($,{title:m.o.t("No_recall_002"),tip:(0,l.jsx)("div",{className:X.display_tooltip,children:m.o.t("No_recall_005")}),children:(0,l.jsx)(ee,{options:es(),value:null!=_?_:K.Tp.Default,onChange:e=>r((0,s._)((0,i._)({},t),{no_recall_reply_mode:e,no_recall_reply_customize_prompt:e===K.Tp.CustomizePrompt&&(0,B.Z)(x)?m.o.t("No_recall_006"):x})),disabled:a})}),_===K.Tp.CustomizePrompt?(0,l.jsx)(z.l0,{initValues:{no_recall_reply_customize_prompt:null!=x?x:m.o.t("No_recall_006")},children:(0,l.jsx)(z.l0.TextArea,{maxLength:500,maxCount:500,ref:k,onChange:I,rows:2,disabled:a,placeholder:m.o.t("card_builder_dataEditor_get_errormsg_please_enter"),pure:!0,field:"no_recall_reply_customize_prompt"})}):null]}):null,E["bot.data.source_display"]&&u?(0,l.jsxs)("div",{className:X["setting-source-display"],children:[(0,l.jsx)("div",{className:X["setting-source-display-title"],"data-testid":U.A.BotKnowledgeSettingShowSourceDisplayTitle,children:m.o.t("knowledge_source_display_title")}),(0,l.jsx)($,{title:m.o.t("knowledge_source_display_status"),tipStyle:{backgroundColor:"#fff",color:"var(--Light-usage-text---color-text-0, #1D1C24)",maxWidth:"453px",minWidth:"453px"},tip:(0,l.jsxs)("div",{className:X.display_tooltip,children:[(0,l.jsx)("div",{className:X.display_tooltip_title,children:m.o.t("knowledge_source_display_tooltip_title")}),(0,l.jsxs)("div",{className:X.display_tooltip_content,children:[(0,l.jsx)("div",{children:m.o.t("knowledge_source_display_tooltip_content")}),(0,l.jsxs)("div",{className:X.display_tooltip_content_link,children:[(0,l.jsx)("div",{className:X.link_num,children:"1."}),(0,l.jsx)("div",{className:X.display_tooltip_link,onClick:()=>window.open("".concat(window.location.origin).concat(el[w]||"/docs/guides/knowledge")),children:m.o.t("knowledge_source_display_tooltip_link")})]})]})]}),children:(0,l.jsx)(z.rs,{"data-testid":U.A.BotKnowledgeSettingShowSourceDisplaySwitch,className:X.display_status,checked:h,disabled:a,onChange:e=>{r((0,i._)((0,s._)((0,i._)({},t),{show_source:e}),!y&&e?{show_source_mode:K.w_.CardList}:{}))}})}),h?(0,l.jsx)($,{title:m.o.t("Display format"),children:(0,l.jsx)(ee,{options:ec(),value:null!=y?y:K.w_.ReplyBottom,onChange:e=>r((0,s._)((0,i._)({},t),{show_source_mode:e})),disabled:a})}):null]}):null]})}var eu=r("825955"),ev=e=>{var{onDel:t}=e,{modal:r,open:n,close:a}=(0,d.sr)({title:m.o.t("delete_title"),cancelText:m.o.t("Cancel"),okText:m.o.t("Delete"),showCloseIcon:!1,okButtonColor:"red",okButtonProps:{type:"danger"},onOk:(0,eu._)(function*(){yield null==t?void 0:t(),null==a||a()}),onCancel:()=>a()});return{node:r((0,l.jsx)("div",{className:"coz-fg-secondary",children:m.o.t("delete_desc")})),delete:n,close:a}},em=r("735114"),eg=r("745474"),ep=r("458620"),ef=r("727914"),eh=r("382534"),e_=e=>{var{docId:t,onDel:r}=e,{run:n,loading:a}=(0,em.Z)(()=>{if(!t)throw new ef.sH(ep.b.KnowledgeDeleteDocument,"".concat(ep.b.KnowledgeDeleteDocument,": missing doc_id"));return eh.MJ.DeleteDocument({document_ids:[t]})},{onSuccess:()=>{null==s||s(),null==r||r()},onError:e=>{eg.s5.errorEvent(eg.xW.KNOWLEDGE,{eventName:ep.b.KnowledgeDeleteDocument,error:e}),p.FN.error({content:"update fail",showClose:!1})},manual:!0}),{modal:o,open:i,close:s}=(0,d.sr)({width:320,title:m.o.t("kl2_007"),cancelText:m.o.t("Cancel"),okText:m.o.t("Delete"),showCloseIcon:!1,okButtonColor:"red",okButtonProps:{loading:a,type:"danger"},onOk:()=>{n()},onCancel:()=>s()});return{node:o((0,l.jsx)("div",{className:F()("coz-fg-secondary",x),children:m.o.t("dataset_detail_table_deleteModel_description")})),delete:i,close:s}},ex=r("653598"),ey=(e,t)=>e>t?"".concat(t,"+"):"".concat(e),eb=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!e)return"0 Byte";var r=Math.floor(Math.log(e)/Math.log(1024)),n=parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t));return"".concat(n," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])};r("421703");var eS=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.replace(/<div[^>]*>/g,"\n").replace(/<\/div>/g,"").replace(/<span[^>]*>/g,"").replace(/<\/span>/g,"").replace(/<br>/g,"\n");return!t&&(r=r.replaceAll(/<img.*?(?:>|\/>)/gi,e=>{var t=e.match(/data-tos-key=[\'\"]?([^\'\"]*)[\'\"]?/i),r=e.match(/src=[\'\"]?([^\'\"]*)[\'\"]?/i);return(null==t?void 0:t[1])?'<img src="" data-tos-key="'.concat(null==t?void 0:t[1],'" >'):'<img src="'.concat((null==r?void 0:r[1])||"",'" >')})),r},eC=r("825251"),ej=r("70131"),ew=r("473980"),eE=r("461190"),ek=r("915757"),eI=r("132361"),eT={};eT.styleTagTransform=A(),eT.setAttributes=k(),eT.insert=w().bind(null,"head"),eT.domAPI=C(),eT.insertStyleElement=T(),b()(eI.Z,eT);var eM=eI.Z&&eI.Z.locals?eI.Z.locals:void 0,eA=e=>{if(!e)return[];var t=e.match(/<img[^>]+src\s*=\s*['"]([^'"]+)['"][^>]*>/g),r=[];if(t)for(var n of t){var a,o=null===(a=n.match(/src\s*=\s*['"]([^'"]+)['"]/))||void 0===a?void 0:a[1];o&&r.push(o)}return r},eN=e=>{var{columns:t,tableData:r,canEdit:n}=e;return(0,l.jsxs)("div",{className:"".concat(eM["table-content-modal"]," ").concat(n?"":eM["has-preview-modal"]),children:[(0,l.jsx)("div",{className:eM["table-header"],children:(0,l.jsx)("div",{className:"".concat(eM["table-row"]," ").concat(eM["header-row"]),children:t.map(e=>(0,l.jsx)("div",{className:eM[e.key],children:e.title},e.key))})}),(0,l.jsx)("div",{className:eM["table-body"],children:r.map((e,r)=>(0,l.jsx)("div",{className:"".concat(eM["table-row"]," ").concat(eM["tbody-row"]),children:t.map(t=>(0,l.jsx)("div",{className:eM[t.key],children:"function"==typeof t.render?t.render(e,r):e[t.key]},t.key))},r))})]})},eL=e=>{var t=(0,eC._)({},(0,ej._)(e));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.zx,{color:"primary",onClick:t.onCancel,children:m.o.t("datasets_createFileModel_CancelBtn")}),(0,l.jsx)(p.zx,{loading:t.loading,onClick:e=>{var r;null===(r=t.onSubmit)||void 0===r||r.call(t,e)},children:m.o.t("datasets_segment_detailModel_save")})]})},eZ=c.memo(e=>{var{index:t,disabled:r,error:n,value:a,handleTextAreaChange:o}=e,[i,s]=(0,c.useState)(a);return(0,l.jsx)(p.Kx,{disabled:r,value:i,onChange:s,onBlur:()=>o(t,i||""),autosize:{minRows:1,maxRows:3},maxLength:2e3,style:{border:n?"1px solid #F93920":""}})}),eG=e=>(0,l.jsx)(p.zx,(0,s._)((0,i._)({color:"highlight",icon:(0,l.jsx)(ek.Q2$,{className:"text-[14px]"})},e),{children:m.o.t("knowledge_insert_img_002")})),eP=e=>{var{onCancel:t,onSubmit:r,tableData:n,canEdit:a,handleTextAreaChange:o,loading:c}=e,d=(0,ew._)(e,["onCancel","onSubmit","tableData","canEdit","handleTextAreaChange","loading"]),u=[{key:"column_name",title:m.o.t("datasets_segment_tableStructure_field_name")},{key:"is_semantic",title:m.o.t("datasets_segment_tableStructure_semantic_name"),render:e=>e.is_semantic?m.o.t("datasets_segment_tableStructure_semantic_yes"):m.o.t("datasets_segment_tableStructure_semantic_no")},{key:"value",title:m.o.t("datasets_segment_tableStructure_field_value"),render:(e,t)=>e.column_type===ex.QD.Image?(0,l.jsx)("div",{className:eM["image-render-wrapper"],children:(0,l.jsx)(eE.e0,{className:e.value?"modal-image-render":"modal-empty-image-render",customEmpty:e=>(0,l.jsx)(eG,(0,i._)({},e||{})),srcList:eA(e.value),onChange:(e,r)=>{var n="";(e||r)&&(n='<img src="'.concat(null!=e?e:"",'" ').concat(r?'data-tos-key="'.concat(r,'"'):"",">")),o(t,n)}})}):(0,l.jsxs)("div",{children:[(0,l.jsx)(eZ,{index:t,disabled:!a,value:e.value,handleTextAreaChange:o,error:e.error}),e.error?(0,l.jsx)("div",{className:eM["error-tips"],children:e.error}):null]})}];return(0,l.jsx)(p.u_,(0,s._)((0,i._)({size:"medium",centered:!0,maskClosable:!1,keepDOM:!1,onCancel:t,footer:(0,l.jsx)(eL,{onCancel:t,loading:c,onSubmit:()=>{r()}})},d),{children:(0,l.jsx)(eN,{tableData:n,canEdit:a,columns:u,handleTextAreaChange:o})}))};var eB=((n={})[n.Create=0]="Create",n[n.Edit=1]="Edit",n),eR=e=>{var t={};return e.map(e=>{t[e.column_id]=e.value||""}),JSON.stringify(t)},eD=(e,t)=>{var r=e.map(e=>(0,s._)((0,i._)({},e),{error:"",value:"",column_id:e.id||"",column_name:e.column_name||"",is_semantic:!!e.is_semantic}));return 0===t.length?r:(t.forEach(e=>{var t=r.find(t=>t.id===e.column_id);t&&(t.value=e.value||"")}),r)},eF=e=>{var t,r,{title:n,meta:a=[],canEdit:o,disabled:d,onSubmit:u,onFinish:v,loading:g}=e,[p,f]=(0,c.useState)(!1),[h,_]=(0,c.useState)([]),x=(0,c.useRef)(a),y=(0,c.useRef)(0),b=()=>{var e=!0,t=h.map(t=>{var r=(0,i._)({},t);return(null==r?void 0:r.is_semantic)&&(0===r.value.length?(r.error=m.o.t("knowledge_table_content_empty"),e=!1):r.value.length>2e3&&(r.error=m.o.t("knowledge_table_content_limt",{number:2e3}),e=!1)),r});return!e&&_(t),e};var{run:S,loading:C}=(0,em.Z)((t=(0,eu._)(function*(e,t){if(!e)throw new ef.sH("normal_error","missing doc_id");return yield eh.MJ.CreateSlice({document_id:e,raw_text:eR(t)}),t}),function(e,r){return t.apply(this,arguments)}),{manual:!0,onSuccess:e=>{v(y.current,e),k()},onError:e=>{eg.s5.errorEvent(eg.xW.KNOWLEDGE,{eventName:ep.b.KnowledgeCreateSlice,error:e})}});var{run:j,loading:w}=(0,em.Z)((r=(0,eu._)(function*(e,t){if(!e)throw new ef.sH("normal_error","missing slice_id");var r=t.map(e=>e.column_type===ex.QD.Image?(0,s._)((0,i._)({},e),{value:eS(e.value)}):e);return yield eh.MJ.UpdateSlice({slice_id:e,raw_text:eR(r)}),t}),function(e,t){return r.apply(this,arguments)}),{manual:!0,onSuccess:e=>{v(y.current,e),k()},onError:e=>{eg.s5.errorEvent(eg.xW.KNOWLEDGE,{eventName:ep.b.KnowledgeUpdateSlice,error:e})}}),E=(0,c.useMemo)(()=>C||w||g,[C,w,g]);(0,c.useEffect)(()=>{x.current=a},[a]);var k=()=>{f(!1)},I=e=>{e&&e.length?_(eD(x.current,e)):_(eD(x.current,[])),f(!0)};return{fetchCreateTableSegment:S,fetchUpdateTableSegment:j,edit:e=>{var t=e;"string"==typeof e&&(t=JSON.parse(e)),y.current=1,Array.isArray(t)&&I(t)},create:()=>{y.current=0,I()},close:k,node:p?(0,l.jsx)(eP,{title:n,visible:p,onSubmit:()=>{b()&&("function"==typeof u?u(y.current,h):(f(!1),v(y.current,h)))},onCancel:k,canEdit:null==o||o,tableData:h,loading:E,handleTextAreaChange:(e,t)=>{var r,n=[...h];n[e].value=t,(null===(r=n[e])||void 0===r?void 0:r.is_semantic)&&(0===t.length?n[e].error=m.o.t("knowledge_table_content_empty"):t.length>2e3?n[e].error=m.o.t("knowledge_table_content_limt",{number:2e3}):n[e].error=""),_(n)}}):null}},eU=r("388993"),eO=r("707107"),ez=r("778043"),eW=r("345420"),eH=r("974235"),eK=r("136515"),eV=r("293318"),eq=r("214942"),eY=r("280053"),eX=r("402635"),eJ=r("74547"),eQ={};eQ.styleTagTransform=A(),eQ.setAttributes=k(),eQ.insert=w().bind(null,"head"),eQ.domAPI=C(),eQ.insertStyleElement=T(),b()(eJ.Z,eQ);var e$=eJ.Z&&eJ.Z.locals?eJ.Z.locals:void 0;var e0=(a=(0,eu._)(function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{query:r,search_type:n,space_id:a,scope_type:o,format_type:i,projectID:s}=e,l=yield eh.MJ.ListDataset({space_id:a,page:t,size:20,filter:{name:r,scope_type:o,format_type:i},order_field:n,project_id:s});return{list:(null==l?void 0:l.dataset_list)||[],nextPageIndex:t+1,total:Number(null==l?void 0:l.total)}}),function(e){return a.apply(this,arguments)}),e1=eY.X$.CreateTime,e2=e=>{var{onAdd:t,scene:r,canCreate:n,createKnowledgeModal:a}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:F()(e$.content,e$.centered),children:(0,l.jsx)(z.YZ,{className:e$.empty,empty:(0,s._)((0,i._)({},n?{btnText:m.o.t("datasets_create_btn"),btnOnClick:()=>{if("modal"===r){t();return}null==a||a.open()}}:{}),{title:m.o.t("datasets_empty_title"),description:m.o.t("datasets_empty_description")})})}),null==a?void 0:a.modal]})};var e5=((o={}).PAGE="page",o.MODAL="modal",o),e4=e=>{var t;return e.includes(d.AT.ALL)?d.AT.ALL:null!==(t=e.at(0))&&void 0!==t?t:d.AT.ALL},e7=e=>{var{hideHeader:t,children:r,showFilters:n,headerClassName:a,scene:o="page",onClickAddKnowledge:i,canCreate:s,defaultType:u,knowledgeTypeConfigList:v=[d.AT.ALL,d.AT.TEXT,d.AT.TABLE,d.AT.IMAGE],projectID:f,beforeCreate:h,createKnowledgeModal:_}=e,y=(0,ez.Z)(v),[b,S]=(0,c.useState)(u||e4(y)),[C,j]=(0,c.useState)(),[w,E]=(0,c.useState)(e1),[k,I]=(0,c.useState)(f?eX.zf.ScopeSelf:eX.zf.ScopeAll),T=[{label:m.o.t("scope_all"),value:eX.zf.ScopeAll},{label:m.o.t("scope_self"),value:eX.zf.ScopeSelf}],{id:M,space_type:A}=(0,eq.rY)(e=>e.space),N=A===g.Sn.Personal,L=(0,c.useRef)(null),{loading:Z,data:G,loadingMore:B,noMore:R,reload:D}=(0,eH.Z)(e=>{if(!e||1===e.nextPageIndex){var t;null===(t=L.current)||void 0===t||t.scroll(0,0)}return e0({space_id:M||"",query:C,search_type:w,scope_type:N?eX.zf.ScopeSelf:k,format_type:b===d.AT.ALL?void 0:({[d.AT.TABLE]:eY.a5.Table,[d.AT.TEXT]:eY.a5.Text,[d.AT.IMAGE]:eY.a5.Image})[b],projectID:f},null==e?void 0:e.nextPageIndex)},{manual:!0,isNoMore:e=>!!(!(null==e?void 0:e.total)||(e.nextPageIndex-1)*20>=e.total),onError:e=>{eg.s5.errorEvent(eg.xW.KNOWLEDGE,{eventName:ep.b.KnowledgeGetDataSetList,error:e})},target:L,reloadDeps:[C,w,k,f]});(0,eK.Z)(()=>{W()},[M]);var O=(0,eV.Z)();(0,c.useEffect)(()=>{"visible"===O&&D()},[O]);var W=()=>{j(void 0),E(e1)},H=e=>{E(e)},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";j(e)},V=()=>{null==_||_.open()},q=()=>(null==G?void 0:G.total)?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:F()(e$.content,e$.scrollable),ref:L,children:(0,eW.Z)(r)?r({size:20,query:C,searchType:w,loading:B,list:G.list,noMore:R,resetFilter:W,refresh:D}):r})}):Z?null:(0,l.jsx)(e2,{scene:o,onAdd:()=>{V()},canCreate:s,createKnowledgeModal:_}),Y=(0,c.useMemo)(()=>()=>(0,l.jsx)(p.II,{autoFocus:!0,placeholder:m.o.t("db2_014"),onChange:(0,P.Z)(K,500)},"query-input"),[]),X=(0,c.useMemo)(()=>()=>(0,l.jsx)(z.y3,{theme:"solid",onClick:V,"data-testid":U.A.BotKnowledgeSelectListModalCreateBtn,children:m.o.t("datasets_create_btn")}),[V]),J=(0,c.useMemo)(()=>()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:e$["file-type-tab"],children:y.reduce((e,t,r)=>{var n=Q(t);return 0!==r?e.concat([(0,l.jsx)(z.iz,{layout:"vertical",margin:"12px"}),n]):e.concat([n])},[])}),(0,l.jsx)("div",{className:"flex",children:(0,ez.Z)(n).map(e=>"scope-type"===e?N?null:(0,l.jsx)(z.Cj,{label:m.o.t("Creator"),showClear:!1,value:k,optionList:T,onChange:e=>{I(e)}}):"search-type"===e?(0,l.jsx)(z.Cj,{"data-testid":U.A.BotKnowledgeSelectListModalCreateDateSelect,label:m.o.t("Sort"),showClear:!1,value:w,optionList:[{label:m.o.t("Create_time"),value:eY.X$.CreateTime},{label:m.o.t("Update_time"),value:eY.X$.UpdateTime}],onChange:e=>{H(e)}}):void 0)})]}),[a,H,k,T,N,n,y]);(0,c.useEffect)(()=>{D()},[b]);var Q=e=>e===d.AT.ALL?(0,l.jsx)("div",{"data-testid":U.A.BotKnowledgeSelectListModalAllTab,onClick:()=>S(d.AT.ALL),className:b===d.AT.ALL?e$["file-type-tab-item-active"]:e$["file-type-tab-item"],children:m.o.t("kl2_010")},d.AT.ALL):e===d.AT.TEXT?(0,l.jsx)("div",{"data-testid":U.A.BotKnowledgeSelectListModalTextTab,onClick:()=>S(d.AT.TEXT),className:b===d.AT.TEXT?e$["file-type-tab-item-active"]:e$["file-type-tab-item"],children:m.o.t("kl2_011")},d.AT.TEXT):e===d.AT.TABLE?(0,l.jsx)("div",{"data-testid":U.A.BotKnowledgeSelectListModalTableTab,onClick:()=>S(d.AT.TABLE),className:b===d.AT.TABLE?e$["file-type-tab-item-active"]:e$["file-type-tab-item"],children:m.o.t("kl2_012")},d.AT.TABLE):e===d.AT.IMAGE?(0,l.jsx)("div",{"data-testid":U.A.BotKnowledgeSelectListModalPhotoTab,onClick:()=>S(d.AT.IMAGE),className:b===d.AT.IMAGE?e$["file-type-tab-item-active"]:e$["file-type-tab-item"],children:m.o.t("knowledge_photo_025")},d.AT.IMAGE):null;return{renderContentFilter:()=>(0,l.jsxs)(z.yC,{spinning:Z,wrapperClassName:e$.spin,children:[(0,l.jsxs)("div",{className:F()(e$.container,x),children:[!t&&(null==n?void 0:n.length)?(0,l.jsxs)("div",{className:F()(e$.header,a,e$["new-filter-header"]),children:[(0,l.jsx)("div",{className:e$["file-type-tab"],children:y.reduce((e,t,r)=>{var n=Q(t);return 0!==r?e.concat([(0,l.jsx)(z.iz,{layout:"vertical",margin:"12px"}),n]):e.concat([n])},[])}),(0,l.jsxs)("div",{className:"flex gap-[8px]",children:[(0,ez.Z)(n).map(e=>{if("scope-type"===e)return N?null:(0,l.jsx)(z.Cj,{label:m.o.t("Creator"),showClear:!1,value:k,optionList:T,onChange:e=>{I(e)}});if("search-type"===e)return(0,l.jsx)(z.Cj,{"data-testid":U.A.BotKnowledgeSelectListModalCreateDateSelect,label:m.o.t("Sort"),showClear:!1,value:w,optionList:[{label:m.o.t("Create_time"),value:eY.X$.CreateTime},{label:m.o.t("Update_time"),value:eY.X$.UpdateTime}],onChange:e=>{H(e)}});if("query-input"===e)return(0,l.jsx)(z.yO,{loading:Z,onSearch:K},"filterType")}),"modal"===o&&s?(0,l.jsx)(z.y3,{theme:"solid",onClick:V,"data-testid":U.A.BotKnowledgeSelectListModalCreateBtn,children:m.o.t("datasets_create_btn")}):null]})]}):null,q()]}),null==_?void 0:_.modal]}),renderSearch:Y,renderCreateBtn:X,renderFilters:J}},e8=r("479886"),e6=r("689951"),e9=r("382174"),e3=r("9934"),te={};te.styleTagTransform=A(),te.setAttributes=k(),te.insert=w().bind(null,"head"),te.domAPI=C(),te.insertStyleElement=T(),b()(e3.Z,te);var tt=e3.Z&&e3.Z.locals?e3.Z.locals:void 0,tr=e=>{var{fileNames:t=[],showTitle:r=!0,children:n}=e;return(0,l.jsx)(z.J2,{className:tt.popover,content:(0,l.jsxs)("div",{children:[r?(0,l.jsx)("p",{children:m.o.t("datasets_processing_notice")}):null,(0,l.jsx)("p",{children:t.join("\n")})]}),children:n})},tn=r("756962"),ta={};ta.styleTagTransform=A(),ta.setAttributes=k(),ta.insert=w().bind(null,"head"),ta.domAPI=C(),ta.insertStyleElement=T(),b()(tn.Z,ta);var to=tn.Z&&tn.Z.locals?tn.Z.locals:void 0,{Text:ti}=z.ZT;function ts(e){var[t,{setFalse:r,setTrue:n}]=(0,e6.Z)(!1);return(0,l.jsx)(z.y3,(0,s._)((0,i._)({onMouseEnter:()=>{n()},onMouseLeave:()=>{r()}},e),{className:F()({[e.className||""]:!!e.className,[to.addedMouseIn]:t}),children:t?m.o.t("Remove"):m.o.t("Added")}))}var tl=e=>{var t,r,n,a,o,i;return(0,l.jsxs)(z.T,{className:to.tags,wrap:!0,children:[(null===(t=e.processing_file_list)||void 0===t?void 0:t.length)?(0,l.jsx)(tr,{fileNames:e.processing_file_list||[],children:(0,l.jsx)(z.fS,{color:"teal",className:to["file-list"],children:m.o.t("dataset_data_processing_tag",{num:(null===(r=e.processing_file_list)||void 0===r?void 0:r.length)||0})})}):null,(0,l.jsx)(z.fS,{color:"grey",children:eb(parseInt(String(e.all_file_size)))}),(null===(n=e.file_list)||void 0===n?void 0:n.length)?(0,l.jsx)(z.J2,{trigger:"hover",showArrow:!0,content:(0,l.jsxs)("div",{className:to["file-list-details"],children:[(0,l.jsx)("div",{className:to["dataset-name"],children:e.name||""}),(0,l.jsx)("div",{className:to["file-info"],children:null===(a=e.file_list)||void 0===a?void 0:a.map(e=>(0,l.jsxs)("div",{className:to["file-info-item"],children:[(0,l.jsx)(W.Rfd,{className:to["icon-note"]}),e]},e))})]}),children:(0,l.jsx)(z.fS,{color:"grey",children:m.o.t("dataset_bot_count_tag",{num:ey((null===(o=e.file_list)||void 0===o?void 0:o.length)||0,99)})})}):(0,l.jsx)(z.fS,{color:"grey",children:m.o.t("dataset_bot_count_tag",{num:ey((null===(i=e.file_list)||void 0===i?void 0:i.length)||0,99)})}),e.storage_location===eY.Ac.OpenSearch?(0,l.jsx)(z.fS,{color:"cyan",children:m.o.t("knowledge_es_001")}):null]})},tc=e=>{var{list:t,loading:r,noMore:n,onAdd:a,onRemove:o,isAdded:s,searchType:c,onClickKnowledgeDetail:d}=e,{id:u,space_type:v}=(0,eq.rY)(e=>e.space),p=v===g.Sn.Personal,f=(e,t)=>{e.stopPropagation(),d?d(t):window.open("/space/".concat(u,"/knowledge/").concat(t))};return(0,l.jsxs)("div",{className:to.container,children:[t.map(e=>{var t,r;return(0,l.jsxs)("div",{className:to.item,onClick:t=>f(t,(null==e?void 0:e.dataset_id)||""),children:[(0,l.jsx)(z.qE,{shape:"square",src:e.icon_url,className:to.left}),(0,l.jsxs)("div",{className:to.content,"data-testid":"".concat(U.A.BotKnowledgeSelectListModalName,".").concat(e.name),"data-dtestid":"".concat(U.A.BotKnowledgeSelectListModalName,".").concat(e.name),children:[(0,l.jsx)(ti,{className:to.title,ellipsis:{showTooltip:!0},children:e.name||""}),e.description?(0,l.jsx)(z.ZT.Text,{className:to.description,ellipsis:{rows:1},children:e.description}):null,!e.description&&!!(null===(t=e.file_list)||void 0===t?void 0:t.length)&&(0,l.jsx)(z.ZT.Text,{className:to.description,ellipsis:{rows:1},children:null===(r=e.file_list)||void 0===r?void 0:r.join("")}),(0,l.jsxs)("div",{className:to["tags-wapper"],children:[(0,l.jsx)(tl,(0,i._)({},e)),(0,l.jsxs)("div",{className:to.info,children:[!p&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z.qE,{src:e.avatar_url,style:{width:14,height:14}}),(0,l.jsx)(ti,{className:F()(to.creator),ellipsis:{showTooltip:!0},children:e.creator_name||""}),(0,l.jsx)("span",{className:to["border-right"]})]}),c===eY.X$.CreateTime?(0,l.jsx)("span",{className:to.creator,children:m.o.t("dataset_bot_create_time_knowledge",{time:(0,e8.unix)(e.create_time||0).format("YYYY-MM-DD HH:mm")})}):(0,l.jsx)("span",{className:to.creator,children:m.o.t("dataset_bot_update_time_knowledge",{time:(0,e8.unix)(e.update_time||0).format("YYYY-MM-DD HH:mm")})})]})]})]}),(0,l.jsx)("div",{className:to.right,onClick:e=>e.stopPropagation(),"data-testid":"".concat(U.A.BotKnowledgeSelectListModalAddBtn,".").concat(e.name),children:s(e.dataset_id||"")?(0,l.jsx)(ts,{className:F()(to.button,to.added),onClick:()=>o(e),children:m.o.t("Added")}):(0,l.jsx)(z.y3,{disabled:e.status===eX._z.DatasetForbid,className:to.button,onClick:()=>a(e),"data-testid":"bot.database.add.modal.add.button",children:m.o.t("Add_2")})})]},e.dataset_id||"")}),r?(0,l.jsxs)("div",{className:to["loading-more"],children:[(0,l.jsx)(e9.Z,{spin:!0,style:{marginRight:"4px"}}),(0,l.jsx)("div",{children:m.o.t("Loading")})]}):null,n?(0,l.jsx)("div",{className:to["no-more"],children:(0,l.jsx)("div",{children:m.o.t("No_more")})}):null]})},td=r("935522"),tu={};tu.styleTagTransform=A(),tu.setAttributes=k(),tu.insert=w().bind(null,"head"),tu.domAPI=C(),tu.insertStyleElement=T(),b()(td.Z,tu);var tv=td.Z&&td.Z.locals?td.Z.locals:void 0,tm=e=>{var{datasetList:t,onDatasetListChange:r,onClickAddKnowledge:n,beforeCreate:a,onClickKnowledgeDetail:o,canCreate:i=!0,defaultType:s,knowledgeTypeConfigList:c,projectID:d,showFilters:u=["scope-type","search-type","query-input"],hideHeader:v,createKnowledgeModal:m}=e,g=(0,eU.G)(e=>e.botId),{renderContentFilter:p,renderSearch:f,renderCreateBtn:h,renderFilters:_}=e7({hideHeader:v,showFilters:u,scene:e5.MODAL,headerClassName:F()(tv["dataset-header"],x),onClickAddKnowledge:n,beforeCreate:a,canCreate:i,defaultType:s,knowledgeTypeConfigList:c,projectID:d,createKnowledgeModal:m,children:e=>{var n,{list:a,loading:i,noMore:s,searchType:c}=e;return(0,l.jsx)(tc,{searchType:c,noMore:s,list:a,loading:i,onAdd:(n=(0,eu._)(function*(e){yield r([...t,e]),(0,eO.Gg)(eO.Kg.click_database_select,{operation:"add",bot_id:g})}),function(e){return n.apply(this,arguments)}),onRemove:e=>{r(t.filter(t=>t.dataset_id!==e.dataset_id)),(0,eO.Gg)(eO.Kg.click_database_select,{operation:"remove",bot_id:g})},isAdded:e=>t.some(t=>t.dataset_id===e),onClickKnowledgeDetail:o})}});return{renderContent:p,renderSearch:f,renderCreateBtn:h,renderFilters:_}},tg=e=>{var{datasetList:t,onDatasetListChange:r,onClickAddKnowledge:n,beforeCreate:a,onClickKnowledgeDetail:o,canCreate:i=!0,defaultType:s,knowledgeTypeConfigList:c,projectID:d,createKnowledgeModal:u}=e,{renderContent:v}=tm({datasetList:t,onDatasetListChange:r,onClickAddKnowledge:n,beforeCreate:a,onClickKnowledgeDetail:o,canCreate:i,defaultType:s,knowledgeTypeConfigList:c,projectID:d,createKnowledgeModal:u});return(0,l.jsx)(l.Fragment,{children:v()})},tp=e=>{var{label:t,onClick:r,selected:n}=e;return(0,l.jsxs)("div",{onClick:r,className:F()(["flex items-center gap-[8px] px-[12px]","px-[12px] py-[6px] rounded-[8px]","cursor-pointer","hover:text-[var(--light-usage-text-color-text-0,#1c1f23)]","hover:bg-[var(--light-usage-fill-color-fill-0,rgba(46,50,56,5%))]",n&&"text-[var(--light-usage-text-color-text-0,#1c1d23)] bg-[var(--light-usage-fill-color-fill-0,rgba(46,47,56,5%))]"]),children:[(0,l.jsx)(ek.Iqn,{}),t]})};r("22916");var tf=r("125227"),th={};th.styleTagTransform=A(),th.setAttributes=k(),th.insert=w().bind(null,"head"),th.domAPI=C(),th.insertStyleElement=T(),b()(tf.Z,th),tf.Z&&tf.Z.locals&&tf.Z.locals;var t_=e=>{var{datasetList:t,onDatasetListChange:r,onClickAddKnowledge:n,beforeCreate:a,onClickKnowledgeDetail:o,modalProps:s,canCreate:d=!0,defaultType:u,knowledgeTypeConfigList:v,projectID:g,hideCreate:p,createKnowledgeModal:f}=e,[h,_]=(0,c.useState)(!1),[y,b]=(0,c.useState)(g?"project":"library"),S=()=>{_(!1)},{renderContent:C,renderSearch:j,renderCreateBtn:w,renderFilters:E}=tm({hideHeader:!0,showFilters:["scope-type","search-type"],datasetList:t,onDatasetListChange:r,onClickAddKnowledge:n,beforeCreate:a,onClickKnowledgeDetail:o,canCreate:d,defaultType:u,knowledgeTypeConfigList:v,projectID:"project"===y?g:"",createKnowledgeModal:f});return{node:(0,l.jsx)(z.FS,(0,i._)({type:"base-composition",header:m.o.t("dataset_set_title"),visible:h,className:F()(tv.modal,tv["upgrade-level"],x),centered:!0,onCancel:S,filter:(0,l.jsx)("div",{className:"flex justify-between gap-[24px]",children:E()}),sider:(0,l.jsxs)(z.yh,{className:"!pt-[16px]",children:[(0,l.jsxs)(z.yh.Header,{className:"flex flex-col gap-[16px]",children:[j(),p?null:w()]}),(0,l.jsxs)(z.yh.Content,{className:"flex flex-col gap-[4px] mt-[16px]",children:[(0,l.jsx)(tp,{label:m.o.t("project_resource_modal_library_resources",{resource:m.o.t("resource_type_knowledge")}),onClick:()=>{b("library")},selected:"library"===y}),g?(0,l.jsx)(tp,{label:m.o.t("project_resource_modal_project_resources",{resource:m.o.t("resource_type_knowledge")}),onClick:()=>{b("project")},selected:"project"===y}):null]})]}),content:(0,l.jsx)(z.vy,{className:"px-[12px]",children:C()})},s)),close:S,open:()=>{_(!0)}}},tx=e=>{var t=(0,c.useRef)(null),{docId:r,documentSource:n}=e,[a,o]=(0,c.useState)({updateType:ex.f3.NoUpdate,updateInterval:d.WU.EveryDay}),[,i]=(0,c.useState)(!1),{run:s,loading:u}=(0,em.Z)((0,eu._)(function*(){if(!r)throw new ef.sH(ep.b.KnowledgeUpdateDocumentFrequency,"".concat(ep.b.KnowledgeUpdateDocumentFrequency,": missing doc_id"));var e,n=null===(e=t.current)||void 0===e?void 0:e.formApi.getValues();return yield eh.MJ.UpdateDocument({document_id:r,update_rule:{update_type:n.updateInterval?eY.$o.Cover:0,update_interval:n.updateInterval}}),{updateType:n.updateInterval?eY.$o.Cover:0,updateInterval:n.updateInterval}}),{manual:!0,onSuccess:()=>{var t;f(),null==e||null===(t=e.onFinish)||void 0===t||t.call(e,a)},onError:e=>{eg.s5.errorEvent(eg.xW.KNOWLEDGE,{eventName:ep.b.KnowledgeUpdateDocumentFrequency,error:e})}}),{modal:v,open:g,close:f}=(0,d.sr)({title:m.o.t("datasets_segment_Update"),centered:!0,cancelText:m.o.t("Cancel"),okText:m.o.t("Confirm"),okButtonProps:{loading:u},onOk:()=>{s()},onCancel:()=>f()});return{node:v((0,l.jsx)(p.l0,{className:x,showValidateIcon:!1,labelPosition:"top",ref:t,initValues:a,onChange:e=>{if(e.values){var t;o(e.values),i((null===(t=e.values)||void 0===t?void 0:t.updateInterval)===0)}},children:(0,l.jsx)(p.ih,{field:"updateInterval",label:m.o.t("datasets_frequencyModal_frequency"),placeholder:m.o.t("datasets_frequencyModal_frequency"),style:{width:"100%"},optionList:(0,d.R)({documentSource:n})})})),edit:e=>{o(e),i(0===e.updateInterval),g()},close:f}};eY.NZ.Document,ek.da8,eY.NZ.Web,ek.KQ3,eY.NZ.FrontCrawl,ek.KQ3,eY.NZ.Notion,ek.S6N,eY.NZ.FeishuWeb,ek.Ahw,eY.NZ.GoogleDrive,ek.Q4r,eY.NZ.OpenApi,ek.YRi,eY.NZ.Custom,ek.YRi,eY.NZ.ThirdParty,eY.NZ.LarkWeb,ek.Ahw,eY.NZ.WeChat,ek.yrb;var ty=r("282776"),tb={};tb.styleTagTransform=A(),tb.setAttributes=k(),tb.insert=w().bind(null,"head"),tb.domAPI=C(),tb.insertStyleElement=T(),b()(ty.Z,tb),ty.Z&&ty.Z.locals&&ty.Z.locals;var tS=r("974522"),tC={};tC.styleTagTransform=A(),tC.setAttributes=k(),tC.insert=w().bind(null,"head"),tC.domAPI=C(),tC.insertStyleElement=T(),b()(tS.Z,tC),tS.Z&&tS.Z.locals&&tS.Z.locals;var tj=r("448793"),tw={};tw.styleTagTransform=A(),tw.setAttributes=k(),tw.insert=w().bind(null,"head"),tw.domAPI=C(),tw.insertStyleElement=T(),b()(tj.Z,tw),tj.Z&&tj.Z.locals&&tj.Z.locals;var tE=r("799733"),tk={};tk.styleTagTransform=A(),tk.setAttributes=k(),tk.insert=w().bind(null,"head"),tk.domAPI=C(),tk.insertStyleElement=T(),b()(tE.Z,tk),tE.Z&&tE.Z.locals&&tE.Z.locals;var tI=e=>{var{name:t,onOk:r}=e,[n,a]=(0,c.useState)(t);(0,c.useEffect)(()=>{a(t)},[t]);var o=()=>{u(),a(t)},{modal:i,open:s,close:u}=(0,d.sr)({width:480,title:m.o.t("knowledge_edit_unit_name_title"),cancelText:m.o.t("Cancel"),okText:m.o.t("Confirm"),okButtonProps:{disabled:!n},onOk:()=>{o(),null==r||r(n)},onCancel:o});return{node:i((0,l.jsx)(p.Kx,{value:n,onChange:a,maxCount:100,maxLength:100,rows:3})),open:s}},tT=r("86288");m.o.t("knowledge_weixin_015"),tT.oF.None,m.o.t("knowledge_weixin_016"),tT.oF.EveryDay,m.o.t("knowledge_weixin_017"),tT.oF.EveryThreeDay,m.o.t("knowledge_weixin_018"),tT.oF.EverySevenDay},537714:function(e,t,r){r.d(t,{VP:()=>B,Dm:()=>F,zM:()=>O,Ao:()=>U,gq:()=>G,uy:()=>D,RB:()=>x,xZ:()=>R,Cm:()=>P});var n,a,o,i,s,l,c,d=r("151064"),u=r("455069"),v=r("252237"),m=r.n(v),g=r("458620"),p=r("775699"),f=r("727914"),h=r("915757"),_=(0,u.createContext)({storeRef:{knowledge:void 0}}),x=e=>{var t,{createStore:r,children:n}=e,a=(0,u.useRef)({});return!(null===(t=a.current)||void 0===t?void 0:t.knowledge)&&(a.current.knowledge=r()),(0,d.jsx)(_.Provider,{value:{storeRef:a.current},children:n})},y=r("407821"),b=r.n(y),S=r("472772"),C=r.n(S),j=r("395245"),w=r.n(j),E=r("297998"),k=r.n(E),I=r("646576"),T=r.n(I),M=r("606121"),A=r.n(M),N=r("187930"),L={};L.styleTagTransform=A(),L.setAttributes=k(),L.insert=w().bind(null,"head"),L.domAPI=C(),L.insertStyleElement=T(),b()(N.Z,L);var Z=N.Z&&N.Z.locals?N.Z.locals:void 0,G=e=>{(0,u.useEffect)(()=>()=>{v()},[]);var t,r,n=(0,u.useContext)(_);if(!n.storeRef.knowledge)throw new f.sH(g.b.normalError,"no knowledge store context");var a=n.storeRef.knowledge,{config:o}=e;if(!o)return null;var{className:i,useUploadMount:s,showStep:l=!0}=o,c=a(e=>e.currentStep),v=a(e=>e.reset),[x,y]=null!==(r=null==s?void 0:s(a))&&void 0!==r?r:[],b=o.steps.map(e=>{var t,r;return null===(r=null===(t=e.showThisStep)||void 0===t?void 0:t.call(e,y))||void 0===r||r}),S=o.steps.filter((e,t)=>b[t]),C=null===(t=S.find(e=>e.step===c))||void 0===t?void 0:t.content;return x?x:(0,d.jsxs)("div",{className:m()("".concat(i," ").concat("data-refactor"),Z["knowledge-steps"]),children:[l?(0,d.jsx)(p.Rg,{type:"basic",hasLine:!1,current:c,className:"mb-[32px]",children:S.map(e=>c>e.step?(0,d.jsx)(p.Rg.Step,{title:e.title,icon:(0,d.jsx)("div",{className:Z["finish-icon"],children:(0,d.jsx)(h.P03,{})})},e.title):(0,d.jsx)(p.Rg.Step,{title:e.title},e.title))}):null,C?(0,d.jsx)(C,{useStore:a,checkStatus:y}):null]})};var P=((n={}).TEXT_DOC="text_doc",n.TEXT_URL="text_url",n.TEXT_EXTENSION="text_extension",n.TEXT_CUSTOM="text_custom",n.TEXT_NOTION="text_notion",n.TEXT_GOOGLE_DRIVE="text_google_drive",n.TEXT_FEISHU="text_feishu",n.TEXT_WECHAT="text_wechat",n.TEXT_LARK="text_lark",n.TABLE_DOC="table_doc",n.TABLE_API="table_api",n.TABLE_CUSTOM="table_custom",n.TABLE_GOOGLE_DRIVE="table_google_drive",n.TABLE_FEISHU="table_feishu",n.TABLE_LARK="table_lark",n.IMAGE_FILE="image_file",n.TABLE="table",n.TEXT="text",n.IMAGE="image",n);var B=((a={}).RESEGMENT="resegment",a.ADD="add",a.UPDATE="update",a.INCREMENTAL="incremental",a);var R=((o={}).DISABLE="disable",o.LOADING="loading",o.ENABLE="enable",o);var D=((i={}).UPLOAD_UNIT="uploadUnit",i.GET_TASK_PROGRESS="getTaskProGress",i.TASK_FINISH="taskFinish",i);var F=((s={}).SUCCESS="success",s.UPLOAD_FAIL="uploadFail",s.VALIDATE_FAIL="validateFail",s.VALIDATING="validating",s.UPLOADING="uploading",s.WAIT="wait",s);var U=((l={}).EntityStatusProcess="process",l.EntityStatusSuccess="success",l.EntityStatusFail="failure",l);var O=((c={})[c.LOADING=0]="LOADING",c[c.NO_AUTH=1]="NO_AUTH",c[c.NO_FILE=2]="NO_FILE",c[c.SIMPLE=3]="SIMPLE",c[c.HAD_SEGMENT_RULES=4]="HAD_SEGMENT_RULES",c)},216035:function(e,t,r){r.d(t,{j:()=>M});var n=r("151064"),a=r("455069"),o=r("745474"),i=r("458620"),s=r("336205"),l=r("775699"),c=r("280053"),d=r("130146"),u=e=>{var t=e;return t=t.replaceAll(/<(\n)*img((?!(<(\n)*img))(.|\n))*>/g,"")},v=r("407821"),m=r.n(v),g=r("472772"),p=r.n(g),f=r("395245"),h=r.n(f),_=r("297998"),x=r.n(_),y=r("646576"),b=r.n(y),S=r("606121"),C=r.n(S),j=r("38868"),w={};w.styleTagTransform=C(),w.setAttributes=x(),w.insert=h().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=b(),m()(j.Z,w);var E=j.Z&&j.Z.locals?j.Z.locals:void 0,k=e=>({[c.NZ.Custom]:s.o.t("chat-area-knowledge-custom-data-source"),[c.NZ.Document]:s.o.t("chat-area-knowledge-local-data-source"),[c.NZ.FeishuWeb]:s.o.t("chat-area-knowledge-feishu-data-source"),[c.NZ.Web]:s.o.t("chat-area-knowledge-online-data-source"),[c.NZ.FrontCrawl]:s.o.t("chat-area-knowledge-crawl-data-source"),[c.NZ.GoogleDrive]:s.o.t("chat-area-knowledge-google-data-source"),[c.NZ.Notion]:s.o.t("chat-area-knowledge-notion-data-source"),[c.NZ.LarkWeb]:s.o.t("Lark_00002")})[e],I=e=>({[c.a5.Table]:s.o.t("knowledge-dataset-type-table"),[c.a5.Text]:s.o.t("knowledge-dataset-type-text"),[c.a5.Image]:s.o.t("knowledge_photo_025")})[e];function T(e){var t,r,{llmOutput:c,index:v}=e,{meta:m,slice:g,score:p}=c,[f,h]=(0,a.useState)(!1),[_,x]=(0,a.useState)(!1),y=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e,t,r,n;x((null!==(r=null===(e=y.current)||void 0===e?void 0:e.scrollHeight)&&void 0!==r?r:0)>(null!==(n=null===(t=y.current)||void 0===t?void 0:t.clientHeight)&&void 0!==n?n:0))},[]);var b=(0,a.useMemo)(()=>m.document.format_type?I(m.document.format_type):null,[m.document]),S=(0,a.useMemo)(()=>m.document.source_type?k(m.document.source_type):null,[m.document]),C=u(g);return(0,n.jsx)("div",{className:E["recall-slice"],children:(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Vp,{className:E["recall-slice-tag"],children:"Recall slice ".concat(v+1)}),(0,n.jsxs)("div",{className:E["recall-slice-title"],children:[null!==(r=null===(t=m.document)||void 0===t?void 0:t.name)&&void 0!==r?r:"",(0,n.jsx)("div",{onClick:()=>{var{href:e,origin:t}=window.location,r=e.split("/"),n=r.indexOf("space");(-1===n||n===r.length-1)&&o.s5.errorEvent(o.xW.KNOWLEDGE,{eventName:i.b.KnowledgeSourceGetURL,error:Error()});var a=r[n+1];!/^[1-9][0-9]+$/.test(a)&&o.s5.errorEvent(o.xW.KNOWLEDGE,{eventName:i.b.KnowledgeSourceGetURL,error:Error()}),window.open("".concat(t,"/space/").concat(a,"/knowledge/").concat(m.dataset.id,"?first_auto_open_edit_document_id=").concat(m.document.id),"_blank")},className:E["recall-slice-title-icon"],children:(0,n.jsx)(d.r,{})})]}),(0,n.jsxs)("div",{className:E["recall-slice-tags"],children:[m.dataset.name?(0,n.jsx)(l.u,{content:m.dataset.name,children:(0,n.jsx)(l.Vp,{children:m.dataset.name})}):null,b?(0,n.jsx)(l.u,{content:b,children:(0,n.jsxs)(l.Vp,{children:[b," "]})}):null,S?(0,n.jsx)(l.u,{content:S,children:(0,n.jsxs)(l.Vp,{children:[S," "]})}):null,p>0&&(0,n.jsx)(l.Vp,{children:"Score: ".concat(p.toFixed(2))})]}),(0,n.jsxs)("div",{className:E["recall-slice-content"],children:[(0,n.jsx)("div",{ref:y,className:f?E["recall-slice-content-open"]:E["recall-slice-content-collapsed"],children:C}),_?f?(0,n.jsx)("div",{className:E["recall-slice-content-action"],onClick:()=>h(!1),children:s.o.t("collapse-chat-knowledge-source-header")}):(0,n.jsx)("div",{className:E["recall-slice-content-action"],onClick:()=>h(!0),children:s.o.t("view-all-chat-knowledge-source-header")}):null]})]})})}function M(e){return(0,n.jsx)("div",{className:E["recall-slices"],children:e.llmOutputs.map((e,t)=>(0,n.jsx)(T,{llmOutput:e,index:t}))})}},39663:function(e,t,r){r.d(t,{ps:()=>G,p1:()=>F,Jb:()=>L,bc:()=>S,HL:()=>Q,sE:()=>q,d9:()=>R,UC:()=>B,RG:()=>P,Rt:()=>et,Sz:()=>j,IT:()=>V,ZL:()=>M,Xx:()=>J,p6:()=>I,$H:()=>k,bG:()=>N,kS:()=>Y,q5:()=>E,Pc:()=>C});var n,a,o,i,s,l,c,d=r("455069"),u=r("293318"),v=r("537845"),m=r("825955"),g=r("808549"),p=r("120454"),f=r("479910"),h=r("598208"),_=r("382534"),x={isSettled:!1,userInfo:null,hasError:!1,userAuthInfos:[],userLabel:null},y=(0,h.Ue)()((0,f.mW)((0,f.XR)((e,t)=>(0,p._)((0,g._)({},x),{reset:()=>{e((0,p._)((0,g._)({},x),{isSettled:!0}))},setIsSettled:t=>{e({isSettled:t})},setUserInfo:r=>{var n;(null==r?void 0:r.user_id_str)&&(null==r?void 0:r.user_id_str)!==(null===(n=t().userInfo)||void 0===n?void 0:n.user_id_str)&&b(null==r?void 0:r.user_id_str),e({userInfo:r})},getUserAuthInfos:(0,m._)(function*(){var{data:t=[]}=yield _.nA.GetUserAuthList();e({userAuthInfos:t})})})),{enabled:!1,name:"botStudio.userStore"}));var b=(n=(0,m._)(function*(e){var t,r,n=yield _.pr.MGetUserBasicInfo({user_ids:[e]}),a=null==n?void 0:null===(r=n.id_user_info_map)||void 0===r?void 0:null===(t=r[e])||void 0===t?void 0:t.user_label;y.setState({userLabel:a})}),function(e){return n.apply(this,arguments)}),S=()=>y(e=>{if(e.isSettled){var t;return(null===(t=e.userInfo)||void 0===t?void 0:t.user_id_str)?"logined":"not_login"}return"settling"}),C=()=>y(e=>e.userInfo),j=()=>y(e=>e.hasError),w="coze_current_uid",E=e=>{var t=(0,u.Z)(),r=S(),n="logined"===r,a=(0,v.Z)(()=>{e()});(0,d.useEffect)(()=>{if("hidden"===t&&n){var e,r=null===(e=y.getState().userInfo)||void 0===e?void 0:e.user_id_str;return()=>{r!==localStorage.getItem(w)&&a()}}},[t,n]),(0,d.useEffect)(()=>{if("settling"!==r){var e,t;localStorage.setItem(w,null!==(t=null===(e=y.getState().userInfo)||void 0===e?void 0:e.user_id_str)&&void 0!==t?t:"")}},[r])},k=()=>y(e=>e.userLabel),I=()=>y(e=>e.userAuthInfos),T=r("581997"),M=()=>{var e=C(),t=S();(0,d.useEffect)(()=>{"logined"===t&&T.D.setUserId(null==e?void 0:e.user_id_str),"not_login"===t&&T.D.setUserId()},[t,null==e?void 0:e.user_id_str])},A=r("336205"),N=()=>y.getState().userInfo,L=()=>{var e,t=y.getState();return t.isSettled?(null===(e=t.userInfo)||void 0===e?void 0:e.user_id_str)?"logined":"not_login":"settling"},Z=()=>y.getState().reset(),G=e=>y.getState().setUserInfo(e),P=()=>y.getState().userLabel,B=()=>y.getState().getUserAuthInfos(),R=e=>y.subscribe(e=>e.userAuthInfos,e),D=/^[0-9A-Za-z_]+$/,F=e=>D.exec(e)?e.length<4?A.o.t("username_too_short"):null:A.o.t("username_invalid_letter"),U=r("297158");var O=(a=(0,m._)(function*(e){y.setState({hasError:!1});var t=yield e();y.getState().setUserInfo(t)}),function(e){return a.apply(this,arguments)});var z=(o=(0,m._)(function*(e){yield e(),y.getState().reset()}),function(e){return o.apply(this,arguments)});var W=(i=(0,m._)(function*(e){y.setState({hasError:!1});var{userInfo:t,hasError:r}=yield e();if(r){y.setState({hasError:!0});return}t&&(0,U.Vq)(t),y.setState({userInfo:t,isSettled:!0})}),function(e){return i.apply(this,arguments)}),H=(e,t,r)=>{var n=y(e=>e.isSettled),a=(0,v.Z)(r);(0,d.useEffect)(()=>{!n&&W(t)},[n]),(0,d.useEffect)(()=>{var t,r=!!(null===(t=y.getState().userInfo)||void 0===t?void 0:t.user_id_str);e&&n&&!r&&a()},[e,n]),(0,d.useEffect)(()=>{var t=!1,r=()=>{y.getState().reset(),e&&!t&&(t=!0,a())};return(0,_.RA)(_.wE.UNAUTHORIZED,r),()=>{(0,_.go)(_.wE.UNAUTHORIZED,r)}},[e])},K=r("903124");var V={checkLogin:(0,m._)(function*(){return(yield K.m.PassportAccountInfoV2({})).data}),logout:(0,m._)(function*(){yield K.m.PassportWebLogoutGet({next:"/"})}),uploadAvatar:(s=(0,m._)(function*(e){var{avatar:t}=e;return(yield K.m.UserUpdateAvatar({avatar:t})).data}),function(e){return s.apply(this,arguments)}),updatePassword:(l=(0,m._)(function*(e){yield K.m.PassportWebEmailPasswordResetGet((0,p._)((0,g._)({},e),{code:""})),Z()}),function(e){return l.apply(this,arguments)}),updateUserProfile:e=>K.m.UserUpdateProfile(e)},q=()=>O(V.checkLogin),Y=()=>z(V.logout);var X=(c=(0,m._)(function*(){try{return{userInfo:yield V.checkLogin()}}catch(e){return{userInfo:void 0}}}),function(){return c.apply(this,arguments)}),J=()=>W(X),Q=()=>void 0,$=r("157728"),ee=e=>{var t=(0,$.useNavigate)(),{pathname:r,search:n}=(0,$.useLocation)();return()=>{var a="".concat(r).concat(n);e?t("".concat(e).concat(n),{replace:!0}):t("".concat("/sign","?").concat("redirect","=").concat(encodeURIComponent(a)))}},et=e=>{var{needLogin:t,loginFallbackPath:r}=e;H(!!t,X,ee(r))}},565515:function(e,t,r){r.r(t),r.d(t,{useLogout:()=>n.aU,RequireAuthContainer:()=>n.ww,LoginPage:()=>x});var n=r("884524"),a=r("151064"),o=r("455069"),i=r("24445"),s=r("336205"),l=r("674343"),c=r("775699"),d=r("825955"),u=r("157728"),v=r("735114"),m=r("903124"),g=r("39663"),p=e=>{var{email:t,password:r}=e,n=(0,v.Z)((0,d._)(function*(){return(yield m.m.PassportWebEmailLoginPost({email:t,password:r})).data}),{manual:!0,onSuccess:g.ps}),a=(0,v.Z)((0,d._)(function*(){return(yield m.m.PassportWebEmailRegisterV2Post({email:t,password:r})).data}),{manual:!0,onSuccess:g.ps}),i=(0,g.bc)(),s=(0,u.useNavigate)();return(0,o.useEffect)(()=>{"logined"===i&&s("/")},[i]),{login:n.run,register:a.run,loginLoading:n.loading,registerLoading:a.loading}},f=r("279404"),h=r("939973"),_=()=>(0,a.jsxs)("div",{className:"relative flex items-center",children:[(0,a.jsx)("img",{src:f,className:"w-[100px] h-[100px] rounded-[21px] border border-solid coz-stroke-plus"}),(0,a.jsx)("img",{src:h,className:"absolute left-1/2 translate-x-[34px] top-[40px] w-[51px]"})]}),x=()=>{var[e,t]=(0,o.useState)(""),[r,n]=(0,o.useState)(""),[d,u]=(0,o.useState)(!1),{login:v,register:m,loginLoading:g,registerLoading:f}=p({email:e,password:r}),h=!e||!r||d;return(0,a.jsx)(c.NF,{brandNode:(0,a.jsx)(i.e,{isOversea:!1}),children:(0,a.jsx)(c.nb,{className:"w-[600px] h-[640px] pt-[96px]",children:(0,a.jsxs)("div",{className:"flex flex-col items-center w-full h-full",children:[(0,a.jsx)(_,{}),(0,a.jsx)("div",{className:"text-[24px] font-medium coze-fg-plug leading-[36px] mt-[32px]",children:s.o.t("open_source_login_welcome")}),(0,a.jsxs)("div",{className:"mt-[64px] w-[320px] flex flex-col items-stretch [&_.semi-input-wrapper]:overflow-hidden",children:[(0,a.jsxs)(l.l0,{onErrorChange:e=>{u(Object.keys(e).length>0)},children:[(0,a.jsx)(l.l0.Input,{"data-testid":"login.input.email",noLabel:!0,type:"email",field:"email",rules:[{required:!0,message:s.o.t("open_source_login_placeholder_email")},{pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:s.o.t("open_source_login_placeholder_email")}],onChange:e=>{t(e)},placeholder:s.o.t("open_source_login_placeholder_email")}),(0,a.jsx)(l.l0.Input,{"data-testid":"login.input.password",noLabel:!0,rules:[{required:!0,message:s.o.t("open_source_login_placeholder_password")}],field:"password",type:"password",onChange:n,placeholder:s.o.t("open_source_login_placeholder_password")})]}),(0,a.jsx)(l.zx,{"data-testid":"login.button.login",className:"mt-[12px]",disabled:h||f,onClick:v,loading:g,color:"hgltplus",children:s.o.t("login_button_text")}),(0,a.jsx)(l.zx,{"data-testid":"login.button.signup",className:"mt-[20px]",disabled:h||g,onClick:m,loading:f,color:"primary",children:s.o.t("register")}),(0,a.jsx)("div",{className:"mt-[12px] flex justify-center",children:(0,a.jsx)("a",{"data-testid":"login.link.terms",href:"https://github.com/coze-dev/coze-studio?tab=Apache-2.0-1-ov-file",target:"_blank",className:"no-underline coz-fg-hglt",children:s.o.t("open_source_terms_linkname")})})]})]})})})}},884524:function(e,t,r){r.d(t,{mP:()=>eo,ie:()=>eu,ww:()=>f,aU:()=>d});var n=r("825955"),a=r("151064"),o=r("157728"),i=r("455069"),s=r("336205"),l=r("674343"),c=r("39663"),d=()=>{var e=(0,o.useNavigate)(),[t,r]=(0,i.useState)(!1);return{node:(0,a.jsx)(l.u_,{visible:t,title:s.o.t("log_out_desc"),okText:s.o.t("basic_log_out"),cancelText:s.o.t("Cancel"),centered:!0,onOk:(0,n._)(function*(){yield(0,c.kS)(),r(!1),e("/")}),onCancel:()=>{r(!1)},okButtonColor:"red"}),open:()=>{r(!0)},close:()=>{r(!1)}}},u=r("775699"),v=()=>(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(u.yC,{spinning:!0,style:{height:"100%",width:"100%"}})}),m=e=>{var{onRetry:t}=e;return(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-center flex-col",children:[s.o.t("login_failed"),(0,a.jsx)(u.y3,{onClick:t,children:s.o.t("Retry")})]})},g=e=>{var{children:t}=e;return(0,a.jsx)("div",{className:"z-1 absolute bg-[#F7F7FA] w-full h-full left-0 top-0",children:t})},p=e=>{var{needLogin:t,loginOptional:r}=e,n=(0,c.bc)();return(0,c.Sz)()&&t?(0,a.jsxs)(g,{children:[(0,a.jsx)(m,{onRetry:c.Xx}),";"]}):t&&!r&&"logined"!==n?(0,a.jsx)(g,{children:(0,a.jsx)(v,{})}):null},f=e=>{var{children:t,needLogin:r,loginOptional:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p,{needLogin:r,loginOptional:n}),t]})},h=r("252237"),_=r.n(h),x=r("735114"),y=r("287487"),b=r("26276"),S=r("458620"),C=r("378925"),j=r("915757"),w=r("499283"),E=r("382534"),k=r("808549"),I=r("473980"),T=r("407821"),M=r.n(T),A=r("472772"),N=r.n(A),L=r("395245"),Z=r.n(L),G=r("297998"),P=r.n(G),B=r("646576"),R=r.n(B),D=r("606121"),F=r.n(D),U=r("177162"),O={};O.styleTagTransform=F(),O.setAttributes=P(),O.insert=Z().bind(null,"head"),O.domAPI=N(),O.insertStyleElement=R(),M()(U.Z,O);var z=U.Z&&U.Z.locals?U.Z.locals:void 0,W=e=>{var{className:t,scene:r="page",errorMessage:n}=e,o=(0,I._)(e,["className","scene","errorMessage"]),i=!!n;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.II,(0,k._)({className:_()(z.input,i&&z.error,"modal"===r?z.modal:z.page,t),validateStatus:i?"error":"default",prefix:"@",placeholder:s.o.t("username_placeholder"),maxLength:20},o)),(0,a.jsx)(l.l0.ErrorMessage,{error:n})]})},H=r("538834"),K={};K.styleTagTransform=F(),K.setAttributes=P(),K.insert=Z().bind(null,"head"),K.domAPI=N(),K.insertStyleElement=R(),M()(H.Z,K);var V=H.Z&&H.Z.locals?H.Z.locals:void 0,q=e=>{var{onSave:t,onCancel:r,loading:n,children:o,className:i,style:c,errorMessage:d,value:u}=e;return(0,a.jsxs)("div",{className:_()(V["field-edit"],i),style:c,children:[(0,a.jsx)("div",{className:V["field-edit-children"],children:o}),(0,a.jsx)(l.zx,{className:V.btn,color:"primary",loading:n,onClick:()=>{null==r||r()},"data-testid":"bot-edit-field-cancel-button",children:s.o.t("Cancel")}),(0,a.jsx)(l.zx,{disabled:!!d||!u,className:V.btn,loading:n,onClick:()=>{null==t||t()},"data-testid":"bot-edit-field-save-button",children:s.o.t("setting_name_save")})]})},Y=e=>{var t,{value:r,onChange:o,onCancel:s,customComponent:c,onSave:d,loading:u,className:v,style:m,readonly:g,disabled:p,disabledTip:f,errorMessage:h,customContent:x}=e,[y,b]=(0,i.useState)(!1);var S=(t=(0,n._)(function*(){yield null==d?void 0:d(r),b(!1)}),function(){return t.apply(this,arguments)}),C=(0,a.jsx)(l.hU,{disabled:p,icon:(0,a.jsx)(j.JAz,{}),size:"mini",color:"secondary",className:"ml-[8px]",onClick:()=>{b(!0)}});return y?c?(0,a.jsx)(q,{value:r,errorMessage:h,onSave:S,loading:u,onCancel:()=>{b(!1),null==s||s()},children:(0,a.jsx)(c,{errorMessage:h,onEnterPress:S,value:r,onChange:o})}):(0,a.jsx)(q,{value:r,errorMessage:h,onSave:S,loading:u,onCancel:()=>{b(!1),null==s||s()},children:(0,a.jsx)(l.II,{onEnterPress:S,value:r,onChange:o})}):(0,a.jsxs)("div",{className:_()(V["filed-readonly"],v),style:m,children:[x||(0,a.jsx)(l.ZT.Text,{fontSize:"14px",className:"!font-medium coz-fg-primary",ellipsis:!0,children:r}),!g&&(p&&f?(0,a.jsx)(l.u,{content:f,children:C}):C)]})},X=e=>{var{value:t,onChange:r,onEnterPress:n}=e;return(0,a.jsx)(l.II,{value:t,onChange:r,maxLength:20,autoFocus:!0,onEnterPress:n,placeholder:s.o.t("setting_name_placeholder")})},J=e=>{var{value:t,onChange:r,onEnterPress:n,errorMessage:o}=e;return(0,a.jsx)(W,{style:{marginBottom:0},value:t,errorMessage:o,onChange:r,autoFocus:!0,onEnterPress:n})},Q=e=>{var{value:t,onChange:r,onEnterPress:n}=e;return(0,a.jsx)(l.II,{mode:"password",value:t,onChange:r,autoFocus:!0,onEnterPress:n})},$=()=>[{label:s.o.t("settings_language_zh"),value:"zh-CN"},{label:s.o.t("settings_language_en"),value:"en-US"}],ee=e=>{var{value:t,onChange:r,onEnterPress:n,errorMessage:o}=e;return(0,a.jsx)(l.Ph,{optionList:$(),value:t,onChange:e=>{null==r||r(e)},className:"w-[120px]"})},et=e=>{var{children:t,label:r}=e;return(0,a.jsxs)("div",{className:V["label-wrap"],children:[(0,a.jsx)(u.l0.Label,{text:r,className:V.label}),t]})},er=(0,S.z)({eventName:S.b.editUserProfile}),en=(0,S.z)({eventName:S.b.updateUserProfileCheck}),ea=e=>{var t,r,n,a,o;return(null==e?void 0:null===(t=e.bui_audit_info)||void 0===t?void 0:t.audit_status)===1?null!==(a=null!==(n=null==e?void 0:null===(r=e.bui_audit_info)||void 0===r?void 0:r.audit_info.user_unique_name)&&void 0!==n?n:null==e?void 0:e.app_user_info.user_unique_name)&&void 0!==a?a:"":null!==(o=null==e?void 0:e.app_user_info.user_unique_name)&&void 0!==o?o:""},eo=()=>{var e,t,r,o,d,u,v,m,g,p=y.Z.useUserInfo(),[f,h]=(0,i.useState)(null==p?void 0:p.name),[S,k]=(0,i.useState)(ea(p)),[I,T]=(0,i.useState)(""),[M,A]=(0,i.useState)(null!==(m=null!==(v=null==p?void 0:p.locale)&&void 0!==v?v:navigator.language)&&void 0!==m?m:"en-US"),[N,L]=(0,i.useState)(""),[Z,G]=(0,i.useState)(!1),[P,B]=(0,i.useState)(null!==(g=null==p?void 0:p.avatar_url)&&void 0!==g?g:""),R=(0,i.useRef)(null);var D=(e=(0,n._)(function*(e){if(!!e)try{er.start(),G(!0),yield c.IT.updateUserProfile({name:e}),er.success()}catch(e){throw er.error({error:e,reason:"update nickname failed"}),e}finally{G(!1)}}),function(t){return e.apply(this,arguments)});var F=(t=(0,n._)(function*(e){try{var t;er.start(),yield c.IT.updatePassword({password:null!=e?e:"",email:null!==(t=null==p?void 0:p.email)&&void 0!==t?t:""}),er.success()}catch(e){throw er.error({error:e,reason:"update password failed"}),e}}),function(e){return t.apply(this,arguments)});var U=(r=(0,n._)(function*(e){if(!!e)try{er.start(),yield c.IT.updateUserProfile({locale:e}),localStorage.setItem("i18next","en-US"===e?"en":e),er.success(),setTimeout(()=>{window.location.reload()},500)}catch(e){throw er.error({error:e,reason:"update language failed"}),e}}),function(e){return r.apply(this,arguments)}),O=e=>{if(!e)return T(""),"";var t=(0,c.p1)(e)||"";return T(t),t};var{run:z,cancel:W}=(0,x.Z)((o=(0,n._)(function*(e){yield E.nA.UpdateUserProfileCheck({user_unique_name:e},{__disableErrorToast:!0})}),function(e){return o.apply(this,arguments)}),{manual:!0,debounceWait:1e3,debounceLeading:!1,debounceTrailing:!0,onBefore:()=>{en.start(),G(!0)},onError:e=>{if(en.error({error:e,reason:e.message}),(0,w.k0)(e)){var t;T(null!==(t=e.msg)&&void 0!==t?t:"")}},onSuccess:()=>{en.success(),T("")},onFinally:()=>{G(!1)}});var H=(d=(0,n._)(function*(e){if(!!e)try{er.start(),G(!0),yield c.IT.updateUserProfile({user_unique_name:e}),er.success()}catch(e){if(er.error({error:e,reason:"update username failed"}),(0,w.k0)(e)){var t;T(null!==(t=e.msg)&&void 0!==t?t:"")}throw e}finally{G(!1)}}),function(e){return d.apply(this,arguments)}),K=()=>{(0,C.sE)(),T("")};return(0,i.useEffect)(()=>{var e;h(null==p?void 0:p.name),k(ea(p)),B(null!==(e=null==p?void 0:p.avatar_url)&&void 0!==e?e:"")},[p]),(0,i.useEffect)(()=>((0,C.sE)(),()=>{(0,C.sE)()}),[]),(0,a.jsxs)("div",{className:_()(V["edit-profile"],"flex flex-col w-full h-full"),children:[(0,a.jsx)(b.J6,{className:V["update-avatar"],value:P,onSuccess:e=>{B(e),l.FN.success({content:s.o.t("upload_avatar_success"),showClose:!1})},onError:()=>l.FN.error({content:"upload_avatar_failed"}),ref:R}),(0,a.jsx)(et,{label:s.o.t("user_info_username"),children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)(Y,{loading:Z,className:V["info-field"],value:S,onChange:e=>{k(null!=e?e:""),O(e)?(W(),G(!1)):e&&z(e)},customContent:S?void 0:(0,a.jsxs)("div",{className:_()("inline-flex items-center gap-[2px] shrink-0","text-[12px] font-[500] coz-fg-hglt-red"),children:[(0,a.jsx)(j.U6C,{}),s.o.t("setting_username_empty")]}),errorMessage:I,customComponent:J,onSave:H,onCancel:()=>{k(ea(p)),K()}})})}),(0,a.jsx)(et,{label:s.o.t("user_info_custom_name"),children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)(Y,{loading:Z,className:V["info-field"],value:f,onChange:h,customComponent:X,onSave:D,onCancel:K})})}),(0,a.jsx)(et,{label:s.o.t("user_info_email"),children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)(Y,{readonly:!0,className:V["info-field"],value:(null==p?void 0:p.email)||"-"})})}),(0,a.jsx)(et,{label:s.o.t("user_info_password"),children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)(Y,{className:V["info-field"],value:N,customContent:"******",customComponent:Q,onChange:e=>L(null!=e?e:""),onSave:F,onCancel:K})})}),(0,a.jsx)(et,{label:s.o.t("language"),children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)(Y,{className:V["info-field"],value:M,customContent:null===(u=$().find(e=>e.value===M))||void 0===u?void 0:u.label,customComponent:ee,onChange:e=>A(null!=e?e:"zh-CN"),onSave:U})})})]})},ei=r("120454"),es=e=>{var[t,r]=(0,i.useState)(!1);return{modal:r=>(0,a.jsx)(l.u_,(0,ei._)((0,k._)({},e),{visible:t,children:r})),open:()=>r(!0),close:()=>r(!1)}},el=r("386868"),ec={};ec.styleTagTransform=F(),ec.setAttributes=P(),ec.insert=Z().bind(null,"head"),ec.domAPI=N(),ec.insertStyleElement=R(),M()(el.Z,ec);var ed=el.Z&&el.Z.locals?el.Z.locals:void 0,eu=e=>{var{tabs:t,onClose:r}=e,n=t.filter(e=>"divider"!==e),[o,c]=(0,i.useState)(()=>{var e;return null===(e=n[0])||void 0===e?void 0:e.id}),{content:d,tabName:v}=n.find(e=>String(e.id)===o)||{},m=t.map(e=>"divider"===e?{tab:(0,a.jsx)(u.iz,{className:"disabled pt-[1px] pb-[1px]"}),itemKey:"general",disabled:!0}:{tab:e.tabName,itemKey:String(e.id)}),{open:g,close:p,modal:f}=es({title:null,centered:!0,onCancel:()=>{null==r||r(),p()},className:ed["profile-modal"],height:600,width:1120,linearGradientMask:!0}),h=(0,a.jsxs)(l.T,{align:"start",spacing:24,className:"flex",children:[(0,a.jsxs)(l.T,{vertical:!0,align:"start",spacing:16,className:ed["profile-left"],children:[(0,a.jsx)(l.ZT.Text,{className:"".concat(ed["text-20"]," pl-[8px]"),children:s.o.t("profile_settings")}),(0,a.jsx)(u.fI,{wrapperClass:ed["profile-tab"],tabList:m,activeKey:o,onChange:c,tabPosition:"left",type:"button"})]}),(0,a.jsx)("div",{className:ed.divider}),(0,a.jsxs)(l.T,{vertical:!0,className:"w-full"+" ".concat(ed["profile-right"]),children:[(0,a.jsx)(l.ZT.Text,{className:"".concat(ed.title),children:v}),(0,a.jsx)("div",{className:ed.container,children:null==d?void 0:d(p)})]})]});return{node:(0,a.jsx)(a.Fragment,{children:f(h)}),open:e=>{e&&n.find(t=>String(t.id)===e)&&c(e),g()},close:()=>{p()}}}},368696:function(e,t,r){r.d(t,{HU:()=>l});var n=r("808549"),a=r("120454"),o=r("479910"),i=r("598208"),s={isCurrentEnterpriseInit:!0,isEnterpriseListInit:!0,enterpriseId:"personal",isEnterpriseExist:!0};(0,i.Ue)()((0,o.mW)(()=>(0,a._)((0,n._)({},s),{setEnterprise:e=>{},updateEnterpriseByImmer:e=>{},clearEnterprise:()=>{},setEnterpriseId:e=>{},setIsCurrentEnterpriseInit:e=>{},setIsEnterpriseListInit:e=>{},setEnterpriseList:e=>{},setIsEnterpriseExist:e=>{},fetchEnterprise:e=>{}}),{enabled:!1,name:"botStudio.enterpriseStore"})),r("455069");var l=()=>null},378925:function(e,t,r){r.d(t,{Pc:()=>u,p6:()=>v,ri:()=>i,bG:()=>s,Nu:()=>c,sE:()=>p,dT:()=>d,d9:()=>g,UC:()=>l,FR:()=>o,gg:()=>a,$H:()=>m,$_:()=>x});var n=r("39663"),a=e=>n.IT.uploadAvatar({avatar:e}),o=()=>"settling"!==h(),i=()=>"logined"===h(),s=n.bG,l=n.UC,c=()=>"settling"!==f(),d=()=>"logined"===f(),u=n.Pc,v=n.p6,m=n.$H,g=n.d9,p=n.sE,f=n.bc,h=n.Jb;r("212270");var _=r("721566");function x(e){var{space:t}=(0,_.$_)(e);return t}},689624:function(e,t,r){r.d(t,{By:()=>eo,Rl:()=>e_});var n,a=r("151064"),o=r("157728"),i=r("455069"),s=r("61279"),l=r("808549"),c=r("120454"),d=r("252237"),u=r.n(d),v=r("297158"),m=r("336205"),g=r("915757"),p=r("289276"),f={chrome:"87.0.0","edge-chromium":"100.0.0",edge:"100.0.0",safari:"14.0.0",firefox:"79.0.0",ie:"999999.0.0"},h="https://www.google.cn/chrome/",_="https://www.microsoft.com/zh-cn/edge",x={chrome:h,"edge-chromium":_,edge:_,safari:"https://apps.apple.com/cn/app/safari/id1146562112",firefox:"https://www.mozilla.org/zh-CN/firefox/new/",ie:h},y=()=>b(),b=()=>{var e,t=(0,p.qY)(navigator.userAgent);if(!t)return null;var{name:r,version:n}=t;if("bot"===r||"react-native"===r||"node"===r)return null;var a=f[r];return!a||function(e,t){for(var r=e.split(".").map(Number),n=t.split(".").map(Number),a=Math.max(r.length,n.length),o=0;o<a;o++){var i=o<r.length?r[o]:0,s=o<n.length?n[o]:0;if(i>s)return 1;if(i<s)return -1}return 0}(n,a)>=0?null:{downloadUrl:null!==(e=x[r])&&void 0!==e?e:h}};var S=((n={}).BrowserUpgradeTipsVisible="browserUpgradeTipsVisible",n.BrowserUpgradeClick="browserUpgradeClick",n),C=r("407821"),j=r.n(C),w=r("472772"),E=r.n(w),k=r("395245"),I=r.n(k),T=r("297998"),M=r.n(T),A=r("646576"),N=r.n(A),L=r("606121"),Z=r.n(L),G=r("424287"),P={};P.styleTagTransform=Z(),P.setAttributes=M(),P.insert=I().bind(null,"head"),P.domAPI=E(),P.insertStyleElement=N(),j()(G.Z,P);var B=G.Z&&G.Z.locals?G.Z.locals:void 0,R=e=>{var{children:t}=e,[r,n]=(0,i.useState)({url:"",visible:!1}),[o,s]=(0,i.useState)(0),d=(0,i.useRef)(null);return(0,i.useEffect)(()=>{var e=y();if(!!e){var{downloadUrl:t}=e;v.E7.event({eventName:S.BrowserUpgradeTipsVisible}),n({url:t,visible:!!t})}},[]),(0,i.useEffect)(()=>{var e;if(!d.current){s(0);return}s(null!==(e=d.current.getBoundingClientRect().height)&&void 0!==e?e:0)},[r]),(0,a.jsxs)(a.Fragment,{children:[r.visible?(0,a.jsxs)("div",{className:u()(B["banner-wrapper"],B["flex-helper"],B["flex-direction-row-helper"],B["flex-items-center"]),ref:d,children:[(0,a.jsxs)("div",{className:u()(B["banner-item"],B["flex-1-helper"],B["flex-items-center"],B["flex-justify-center"]),children:[(0,a.jsxs)("span",{children:[m.o.t("browser_upgrade"),": "]}),(0,a.jsx)("span",{className:B["banner-upgrade-button"],onClick:()=>{if(!!r.url)v.E7.event({eventName:S.BrowserUpgradeClick}),window.open(r.url)},children:m.o.t("browser_upgrade_button")})]}),(0,a.jsx)("div",{onClick:()=>{n(e=>(0,c._)((0,l._)({},e),{visible:!1}))},children:(0,a.jsx)(g.rmE,{className:B.close})})]}):null,(0,a.jsx)("div",{style:{height:"calc(100% - ".concat(o,"px)"),position:"relative"},children:t})]})},D=r("69650"),F=r("378925"),U=r("37626"),O=r("674343"),z=r("775699"),W=r("212270"),H=r("707107"),K=r("900093"),V=r("664679"),q=e=>{var{autoCreate:t,urlSearch:r,currentSpaceId:n}=e,a=(0,i.useRef)(null),o=()=>{a.current=window.open()},s=()=>{if(!!a.current)a.current.close()},{modalContextHolder:l,createProject:c}=(0,K.Uy)({bizCreateFrom:"navi",selectSpace:!0,onCreateBotSuccess:(e,n)=>{var o="/space/".concat(n,"/bot/").concat(e);t&&(o+=r),e&&a.current?a.current.location=o:s()},onBeforeCreateBot:()=>{(0,H.Gg)(H.Kg.create_bot_click,{source:"menu_bar"}),o()},onCreateBotError:()=>{s()},onBeforeCreateProject:()=>{o()},onCreateProjectError:()=>{s()},onBeforeCopyProjectTemplate:e=>{var{toSpaceId:t}=e;t!==n&&o()},onProjectTemplateCopyError:()=>{s()},onCreateProjectSuccess:e=>{var{projectId:n,spaceId:o}=e,i="/space/".concat(o,"/project-ide/").concat(n);if(!!a.current)t&&(a.current.location=i+r),a.current.location=i},onCopyProjectTemplateSuccess:e=>{V.k.emit("createProjectByCopyTemplateFromSidebar",e),a.current&&(a.current.location="/space/".concat(e.toSpaceId,"/develop"))}});return(0,i.useEffect)(()=>{t&&c()},[t]),{createBot:c,createBotModal:l}},Y=r("565515"),X=r("30961"),J={showTooltip:!0},Q=()=>{var e,t=(0,F.Pc)(),r=(0,F.$H)();if(!t)return null;var n=null==t?void 0:null===(e=t.app_user_info)||void 0===e?void 0:e.user_unique_name;return(0,a.jsx)(O.Lt.Item,{className:"!h-fit",children:(0,a.jsx)("div",{className:"flex justify-between items-center w-full",children:(0,a.jsxs)(O.T,{spacing:8,className:"shrink grow overflow-hidden",children:[(0,a.jsx)(O.Ct,{position:"rightBottom",countStyle:{right:6,bottom:6},count:(null==r?void 0:r.icon_url)?(0,a.jsx)(O.u,{showArrow:!0,position:"right",content:null==r?void 0:r.label_name,trigger:(null==r?void 0:r.label_name)?"hover":"custom",children:(0,a.jsx)("div",{className:"bg-white rounded-full w-[16px] h-[16px] flex items-center justify-center",children:(0,a.jsx)(O.EZ,{src:null==r?void 0:r.icon_url,className:"w-[12px] h-[12px] rounded-full",type:"person",onClick:e=>{(null==r?void 0:r.jump_link)&&(null==e||e.preventDefault(),null==e||e.stopPropagation(),window.open(null==r?void 0:r.jump_link,"_blank"))}})})}):null,className:"shrink-0",children:(0,a.jsx)(O.EZ,{src:t.avatar_url,className:"w-[32px] h-[32px] rounded-full",type:"person"})}),(0,a.jsxs)("div",{className:"flex-1 text-[14px] leading-[20px] overflow-hidden sp",children:[(0,a.jsx)(O.ZT.Text,{className:"coz-fg-primary font-[500]",ellipsis:J,children:t.name}),(0,a.jsxs)(O.ZT.Text,{className:"coz-fg-secondary",ellipsis:J,children:[n?"@":"",n]})]})]})})})},$=r("150637"),ee=r("884524"),et=()=>{var e=[{id:"account",tabName:m.o.t("menu_profile_account"),content:()=>(0,a.jsx)(ee.mP,{})},{id:"api-auth",tabName:m.o.t("settings_api_authorization"),content:()=>(0,a.jsx)($.Nj,{size:"small",type:"primary"})}],{node:t,open:r}=(0,ee.ie)({tabs:e});return{node:t,open:r}},er=()=>{var[e,t]=(0,i.useState)(!1),r=(0,F.Pc)(),{node:n,open:o}=(0,Y.useLogout)(),{node:s,open:l}=et();return r?(0,a.jsxs)(W.Tg,{menus:[(0,a.jsx)(Q,{},"user-info"),(0,a.jsx)(O.Lt.Divider,{},"divider-1"),{key:"api-auth",prefixIcon:(0,a.jsx)(g.sGJ,{}),title:m.o.t("settings_api_authorization"),onClick:()=>{l("api-auth")},dataTestId:"layout_avatar_api-auth"},{key:"account-settings",prefixIcon:(0,a.jsx)(g.qBd,{}),title:m.o.t("navi_bar_account_settings"),onClick:()=>{l("account")},dataTestId:"layout_avatar_profile-settings"},(0,a.jsx)(O.Lt.Divider,{},"divider-2"),{key:"logout",prefixIcon:(0,a.jsx)(g.sGJ,{}),title:m.o.t("basic_log_out"),onClick:()=>{o()},dataTestId:"layout_avatar_logout-button"}],visible:e,onVisibleChange:t,children:[n,s]}):null},en=()=>{var e=(0,X.A1)(),t=(0,o.useLocation)(),r=(0,F.dT)(),n=new URLSearchParams(t.search).get("page_mode");if(e.pageModeByQuery&&"modal"===n)return!1;var a=e.requireAuth&&e.requireAuthOptional||!e.requireAuth;return(!e.hasSider||!a||!!r)&&!!e.hasSider},ea=e=>{var{children:t}=e,r=(0,X.A1)(),n=en(),{space_id:i}=(0,o.useParams)(),{createBot:s,createBotModal:l}=q({currentSpaceId:i});return(0,a.jsx)(Y.RequireAuthContainer,{needLogin:!!r.requireAuth,loginOptional:!!r.requireAuthOptional,children:(0,a.jsxs)(W.By,{hasSider:n,banner:null,actions:[{tooltip:m.o.t("creat_tooltip_create"),icon:(0,a.jsx)(g._M$,{}),onClick:s,dataTestId:"layout_create-agent-button"}],menus:[{title:m.o.t("navigation_workspace"),icon:(0,a.jsx)(g.wmN,{}),activeIcon:(0,a.jsx)(g.N61,{}),path:"/space",dataTestId:"layout_workspace-button"},{title:m.o.t("menu_title_store"),icon:(0,a.jsx)(g.ksg,{}),activeIcon:(0,a.jsx)(g.PwU,{}),path:"/explore",dataTestId:"layout_explore-button"}],extras:[{icon:(0,a.jsx)(g.da8,{}),tooltip:m.o.t("menu_documents"),onClick:()=>{window.open("https://www.coze.cn/open/docs/guides")},dataTestId:"layout_document-button"}],footer:(0,a.jsx)(er,{}),children:[t,l]})})},eo=()=>{var e,t,r=(0,F.Pc)(),n=(0,s.Z)(),l=null!==(t=null!==(e=null==r?void 0:r.locale)&&void 0!==e?e:navigator.language)&&void 0!==t?t:"en-US",c="en-US"===l?"en":l;return(0,i.useEffect)(()=>{r&&m.o.language!==c&&(localStorage.setItem("i18next",c),m.o.setLang(c),n())},[r,c,n]),(0,a.jsx)(D.b,{i18n:m.o,children:(0,a.jsx)(O.X4,{locale:"en-US"===l?U.iF:U.bF,children:(0,a.jsx)(z.Iw,{locale:"en-US"===l?O._z:O.U1,children:(0,a.jsx)(O.f6,{defaultTheme:"light",changeSemiTheme:!0,changeBySystem:!1,children:(0,a.jsx)(R,{children:(0,a.jsx)(ea,{children:(0,a.jsx)(o.Outlet,{})})})})})})})},ei=r("727914"),es=r("685096"),el=r("39663"),ec=()=>{var e=(0,i.useRef)(!1);(0,el.q5)(()=>{if(!e.current)e.current=!0,O.u_.confirm({title:m.o.t("account_update_hint"),okText:m.o.t("api_analytics_refresh"),closeOnEsc:!1,maskClosable:!1,onOk:()=>{window.location.reload()}})})},ed=r("298203"),eu=()=>{var e=(0,X.mE)();(0,i.useEffect)(()=>{e?(0,ed.jz)():(0,ed.PE)()},[e])},ev=r("287487"),em=r("279516"),eg=r("214942"),ep=()=>{var e=ev.Z.useIsSettled(),t=ev.Z.useIsLogined();(0,i.useEffect)(()=>{e&&!t&&(eg.rY.getState().reset(),em.GR.getState().reset())},[t,e])},ef=r("883014"),eh=()=>{var e=(0,ef.i)(e=>e.setInitialized);(0,i.useEffect)(()=>{e()},[])},e_=()=>{var{requireAuth:e,requireAuthOptional:t,loginFallbackPath:r}=(0,X.A1)();(0,el.Rt)({needLogin:!!(e&&!t),loginFallbackPath:r}),(0,el.ZL)(),(0,i.useEffect)(()=>{v.E7.info({message:"Ok fine"}),v.E7.init(es.Z),v.kg.init(es.Z)},[]),(0,ei.TH)(es.Z),eh(),ep(),eu(),ec()}},883014:function(e,t,r){r.d(t,{i:()=>l});var n=r("808549"),a=r("120454"),o=r("479910"),i=r("598208"),s={commonConfigs:{botIdeGuideVideoUrl:"",homeBannerTask:[],quickStart:[],oceanProjectSpaces:[],douyinAvatarSpaces:[]},initialized:!1},l=(0,i.Ue)()((0,o.mW)(e=>(0,a._)((0,n._)({},s),{updateCommonConfigs(t){e(e=>(0,a._)((0,n._)({},e),{commonConfigs:t}))},setInitialized:()=>{e({initialized:!0})}})))},212270:function(e,t,r){r.d(t,{xE:()=>V,By:()=>ev,Tg:()=>eh,gk:()=>O});var n=r("151064"),a=r("44172"),o=r("455069"),i=r("298203"),s=r("30961"),l=r("479910"),c=(0,r("598208").Ue)()((0,l.mW)(e=>({mobileTips:!1,setMobileTips:t=>{e({mobileTips:t})}}),{enabled:!1,name:"botStudio.signMobile"})),d=r("336205"),u=r("775699"),v=r("407821"),m=r.n(v),g=r("472772"),p=r.n(g),f=r("395245"),h=r.n(f),_=r("297998"),x=r.n(_),y=r("646576"),b=r.n(y),S=r("606121"),C=r.n(S),j=r("610071"),w={};w.styleTagTransform=C(),w.setAttributes=x(),w.insert=h().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=b(),m()(j.Z,w);var E=j.Z&&j.Z.locals?j.Z.locals:void 0,k=()=>{var{open:e,close:t,modal:r}=(0,u.q0)({title:d.o.t("landing_mobile_popup_title"),okText:d.o.t("landing_mobile_popup_button"),centered:!0,hideCancelButton:!0,isMobile:!0,onOk:()=>{t()}});return{node:r((0,n.jsx)("span",{className:E["mobile-tips-span"],children:d.o.t("landing_mobile_popup_context")})),open:()=>{e()},close:()=>{t()}}},I=r("392300"),T=(0,o.createContext)({sideSheetVisible:!1,setSideSheetVisible:I.Z}).Provider,M=()=>{var{mobileTips:e,setMobileTips:t}=c(),{node:r,open:n}=k(),a=(0,s.A1)(),l=(0,s.Fm)(),d=(0,s.mE)(),u=l||d;return(0,o.useEffect)(()=>{a.showMobileTips&&(!e&&(0,i.tq)()&&(n(),t(!0)),u?(0,i.jz)():(0,i.PE)())},[a.showMobileTips,u]),{isResponsive:u,mobileTipsModal:a.showMobileTips?r:null}},A=r("157728"),N=r("664319"),L=r("687983"),Z=r("22985"),G=r("297158"),P=r("727914"),B=r("763055"),R=r("721566"),D=r("561293"),F={};F.styleTagTransform=C(),F.setAttributes=x(),F.insert=h().bind(null,"head"),F.domAPI=p(),F.insertStyleElement=b(),m()(D.Z,F);var U=D.Z&&D.Z.locals?D.Z.locals:void 0,O=()=>{var e,t,r=(0,A.useNavigate)(),a=(0,R._)(),{menuKey:i}=(0,s.A1)(),{id:l,getPersonalSpaceID:c}=(0,R.rY)((0,N.N)(e=>({id:e.space.id,getPersonalSpaceID:e.getPersonalSpaceID}))),v=(0,A.useRouteError)();(0,P.f5)(v);var m=(0,o.useMemo)(()=>{if(function(e){return!!e&&"object"==typeof e&&("message"in e&&"string"==typeof e.message||!1)}(v))return/Minified\sReact\serror\s\#306/i.test(v.message)},[v]),g=(0,o.useMemo)(()=>{if((0,P.KV)(v)){var e;return null===(e=v.ext)||void 0===e?void 0:e.customGlobalErrorConfig}},[v]),[p]=(0,o.useState)(()=>{var e,t;return null===(t=(0,G.f5)())||void 0===t?void 0:null===(e=t.config())||void 0===e?void 0:e.sessionId});return(0,n.jsx)("div",{className:U.wrapper,children:(0,n.jsxs)("div",{className:U.content,children:[(0,n.jsx)(B.B9,{width:140,height:140}),(0,n.jsx)(u.ZT.Title,{className:U.title,children:null!==(e=null==g?void 0:g.title)&&void 0!==e?e:d.o.t("errorpage_bot_title",{},"Failed to view the ".concat(a))}),(0,n.jsx)(u.ZT.Paragraph,{className:U.paragraph,children:null!==(t=null==g?void 0:g.subtitle)&&void 0!==t?t:d.o.t("errorpage_subtitle",{},"Please check your link or try again after joining the bot's team.")}),!!p&&(0,n.jsx)("div",{className:"leading-[12px] mb-[24px] text-[12px] text-gray-400",children:p}),(0,n.jsx)(u.y3,{theme:"solid",onClick:()=>{var e="";if(Z.el.Space===i){var t,n,o=null!==(n=null!=l?l:c())&&void 0!==n?n:null===(t=R.rY.getState().spaceList[0])||void 0===t?void 0:t.id;e=o?"/space/".concat(o,"/").concat(a):"/space"}else e=i&&i in Z.el?"/".concat(i):"/";m?window.location.href=(0,L.Z)(e):r(e)},children:d.o.t("errorpage_bot_btn",{},"Go to Bot Platform")})]})})},z=r("674343"),W=r("203154"),H={};H.styleTagTransform=C(),H.setAttributes=x(),H.insert=h().bind(null,"head"),H.domAPI=p(),H.insertStyleElement=b(),m()(W.Z,H);var K=W.Z&&W.Z.locals?W.Z.locals:void 0,V=e=>{var{onClickBack:t}=e;return(0,n.jsx)("div",{className:K["bot-exit-btn"],children:(0,n.jsx)(z.hU,{color:"secondary",icon:(0,n.jsx)(a.D6v,{}),onClick:t,"data-testid":"bot-exit-button"})})},q=r("808549"),Y=r("120454"),X=r("473980"),J=r("252237"),Q=r.n(J),$=r("703534"),ee={};ee.styleTagTransform=C(),ee.setAttributes=x(),ee.insert=h().bind(null,"head"),ee.domAPI=p(),ee.insertStyleElement=b(),m()($.Z,ee);var et=$.Z&&$.Z.locals?$.Z.locals:void 0,er="submenu-width",en=()=>{var{subMenu:e}=(0,s.A1)(),[t,r]=(0,o.useState)(()=>{var e=localStorage.getItem(er);return e?Math.min(380,Math.max(200,Number(e))):200}),a=(0,o.useCallback)(e=>{e.preventDefault();var n=e.pageX,a=e=>{var a=Math.min(380,Math.max(200,t+e.pageX-n));r(a),localStorage.setItem(er,String(a))},o=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",o)},[t]);return e?(0,n.jsxs)("div",{className:"relative flex flex-row",children:[(0,n.jsx)("div",{className:"overflow-auto flex flex-col box-border px-[6px] py-[12px]",style:{width:"".concat(t,"px")},children:(0,n.jsx)(o.Suspense,{children:(0,n.jsx)(e,{})})}),(0,n.jsx)("div",{className:et["sub-menu-resize"],onMouseDown:a,children:(0,n.jsx)("div",{className:et["sub-menu-resize-line"]})})]}):null},ea=r("707107"),eo=e=>{(0,ea.Gg)(ea.Kg.tab_click,{content:e}),(0,ea.Gg)(ea.Kg.coze_space_sidenavi_ck,{item:e,navi_type:"prime",need_login:!0,have_access:!0})},ei=Q()("w-[60px] h-[48px]","flex flex-col items-center justify-center","rounded-[6px]","transition-all","hover:coz-mg-primary-hovered"),es=e=>{var{title:t,icon:r,activeIcon:a,path:o,dataTestId:i}=e,s=(0,A.useLocation)(),l=!1,c="";Array.isArray(o)?(l=o.some(e=>s.pathname.startsWith(e)),c=o.find(e=>s.pathname.startsWith(e))||o[0]):(l=s.pathname.startsWith(o),c=o);var d=c.startsWith("https://"),u="primary-menu-".concat(c.startsWith("/")?c.slice(1):c);return(0,n.jsx)(A.NavLink,{to:c,target:d?"_blank":void 0,className:"no-underline",onClick:()=>{eo(t)},"data-testid":i,children:(0,n.jsxs)("div",{className:Q()(ei,l?"coz-mg-primary coz-fg-plus":"coz-bg-max coz-fg-secondary"),id:u,children:[(0,n.jsx)("div",{className:"text-[20px] leading-none",children:l?a:r}),(0,n.jsx)("div",{className:"mt-[2px] h-[14px] font-[500] flex items-center justify-center overflow-hidden leading-none overflow-hidden w-full",children:(0,n.jsx)("span",{className:"text-[20px] scale-50 whitespace-nowrap",children:t})})]})})},el=e=>{var{icon:t,iconClass:r,onClick:a,tooltip:i,dataTestId:s,className:l,portal:c,renderButton:d}=e,[u,v]=(0,o.useState)(!1),m=()=>{v(!1),eo(i),null==a||a()},g=d?d({onClick:m,icon:t,dataTestId:s}):(0,n.jsx)(z.hU,{color:"secondary",size:"large",className:Q()(l,{"!h-full":!!r}),icon:(0,n.jsx)("div",{className:Q()("text-[20px] coz-fg-primary h-[20px]",r),children:t}),onClick:m,"data-testid":s});return(0,n.jsxs)(n.Fragment,{children:[i?(0,n.jsx)(z.u,{content:i,position:"right",clickToHide:!0,visible:u,onVisibleChange:v,children:g}):g,c]})},ec=Q()("relative","h-full","border-[1px] border-solid coz-stroke-primary rounded-[14px]","coz-bg-max","flex flex-row items-stretch"),ed=Q()("px-[6px] py-[16px]","flex flex-col h-full items-center"),eu=e=>{var{actions:t,menus:r,extras:i,onClickLogo:l,footer:c=null}=e,{subMenu:d}=(0,s.A1)();return(0,n.jsx)("div",{className:"pl-8px py-8px h-full",children:(0,n.jsxs)("div",{className:ec,children:[(0,n.jsxs)("div",{className:Q()(ed,!!d&&"border-0 border-r-[1px] border-solid coz-stroke-primary"),children:[(0,n.jsx)(a.UYy,{onClick:l,className:"cursor-pointer w-[40px] h-[40px]"}),(0,n.jsx)("div",{className:"mt-[16px]",children:null==t?void 0:t.map((e,t)=>(0,o.createElement)(el,(0,Y._)((0,q._)({},e),{key:t})))}),(0,n.jsx)(z.iz,{className:"my-12px w-[24px]"}),(0,n.jsx)(z.T,{spacing:4,vertical:!0,className:"flex-1 overflow-auto",children:null==r?void 0:r.map((e,t)=>(0,o.createElement)(es,(0,Y._)((0,q._)({},e),{key:t})))}),(0,n.jsxs)(z.T,{spacing:4,vertical:!0,className:"mt-[12px]",children:[null==i?void 0:i.map((e,t)=>(0,o.createElement)(el,(0,Y._)((0,q._)({},e),{key:t}))),c]})]}),(0,n.jsx)(en,{})]})})};eu.displayName="GlobalLayoutSider";var ev=e=>{var{hasSider:t,children:r,banner:a}=e,i=(0,X._)(e,["hasSider","children","banner"]),[s,l]=(0,o.useState)(!1),{isResponsive:c,mobileTipsModal:d}=M(),u=(0,A.useLocation)();(0,o.useEffect)(()=>{l(!1)},[u.pathname,u.search,c]);var v=c?(0,n.jsx)(z.Uu,{placement:"left",visible:s,className:et["side-sheet"],closeOnEsc:!0,onCancel:()=>{l(!1)},children:(0,o.createElement)(eu,(0,Y._)((0,q._)({},i),{key:"GlobalLayoutSider"}))}):(0,o.createElement)(eu,(0,Y._)((0,q._)({},i),{key:"GlobalLayoutSider"}));return(0,n.jsxs)(T,{value:{sideSheetVisible:s,setSideSheetVisible:l},children:[a,(0,n.jsxs)(z.Ar,{className:Q()("flex !flex-row items-stretch w-full coz-bg-plus",a?"h-[calc(100%_-_30px)]":"h-full"),children:[t?v:null,(0,n.jsx)(z.Ar,{className:"flex-1 relative flex flex-col overflow-x-hidden coz-bg-plus",children:r}),d]})]})},em=r("39663"),eg=r("103910"),ep={};ep.styleTagTransform=C(),ep.setAttributes=x(),ep.insert=h().bind(null,"head"),ep.domAPI=p(),ep.insertStyleElement=b(),m()(eg.Z,ep);var ef=eg.Z&&eg.Z.locals?eg.Z.locals:void 0,eh=e=>{var{menus:t,userBadge:r=null,userTips:a=null,children:i,disableVisibleChange:s,visible:l,onVisibleChange:c}=e,d=(0,em.Pc)();return d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.Lt,{trigger:"custom",position:"rightBottom",visible:l,onVisibleChange:c,onClickOutSide:()=>{!s&&(null==c||c(!1))},render:(0,n.jsx)(z.Lt.Menu,{className:Q()(ef.menu,"w-[250px]"),mode:"menu",children:null==t?void 0:t.map(e=>{var t;return null===(t=e)||"string"==typeof t||"number"==typeof t||"boolean"==typeof t||(0,o.isValidElement)(t)||Array.isArray(t)?e:(0,n.jsx)(z.Lt.Item,{onClick:t=>{eo(e.title),null==c||c(!1),e.onClick()},"data-testid":e.dataTestId,children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"mr-[8px] flex items-center",children:e.prefixIcon}),(0,n.jsx)("div",{children:e.title})]}),(0,n.jsx)("div",{className:"flex items-center",children:e.extra})]})},e.title)})}),children:(0,n.jsxs)("div",{className:Q()("relative","p-[4px] rounded-[8px] transition-colors hover:coz-mg-secondary-hovered","leading-none",l&&"coz-mg-secondary-hovered"),onClick:()=>{!s&&(null==c||c(!l))},"data-testid":"layout_avatar-menu-button",children:[(0,n.jsx)(z.Ct,{position:"rightBottom",countStyle:{right:6,bottom:6},count:r,children:(0,n.jsx)(z.qE,{src:d.avatar_url,className:Q()("w-[32px] h-[32px] rounded-full")})}),a]})}),i]}):null}},581997:function(e,t,r){r.d(t,{D:()=>R});var n=r("825955"),a=r("893134"),o=r("642427"),i=r("562590"),s=r("655461"),l=r("808217"),c=r("808549"),d=r("120454"),u=r("643095"),v=r("732562"),m=["coachmark","workspace-spaceId","workspace-subMenu","workspace-develop-filters","workspace-library-filters","workspace-ocean-project-filters","coze-home-session-area-hidden-key","template-purchase-agreement-checked","coze-promptkit-recommend-pannel-hidden-key","workflow-toolbar-role-onboarding-hidden","coze-project-entity-hidden-key","enterpriseId","resourceCopyTaskIds","coze-create-enterprise-success","coze-show-product-matrix-tips"],g={coachmark:{bindAccount:!0},"workspace-spaceId":{bindAccount:!0},"workspace-subMenu":{bindAccount:!0},"template-purchase-agreement-checked":{bindAccount:!0},enterpriseId:{bindAccount:!0},resourceCopyTaskIds:{bindAccount:!0}},p=e=>!!e&&"object"==typeof e&&Object.values(e).every(e=>"string"==typeof e),f=e=>!!e&&"object"==typeof e&&null!==e,h=e=>{if(!f(e)||"permanent"in e&&!p(e.permanent))return!1;if("userRelated"in e){var{userRelated:t}=e;if(!f(t)||Object.values(t).some(e=>!p(e)))return!1}return!0},_=e=>{if(!e)return{};try{var t=JSON.parse(e);return h(t)?t:{}}catch(e){return{}}},x=e=>Object.entries(e).reduce((e,t)=>{var[r,n]=t;return m.includes(r)?(0,d._)((0,c._)({},e),{[r]:n}):e},{}),y=e=>(e.permanent&&(e.permanent=x(e.permanent)),e.userRelated&&(e.userRelated=Object.entries(e.userRelated).reduce((e,t)=>{var[r,n]=t;return(0,d._)((0,c._)({},e),{[r]:x(n)})},{})),e),b="__coz_biz_cache__",S=new WeakMap,C=new WeakMap,j=new WeakMap,w=new WeakSet,E=new WeakSet,k=new WeakSet,I=new WeakSet,T=new WeakSet,M=new WeakSet;class A extends v.Z{setUserId(e){(0,i._)(this,C,e),this.emit("change"),this.emit("setUserId",e)}setValue(e,t){var r,{bindAccount:n}=null!==(r=g[e])&&void 0!==r?r:{};if(n){if(!(0,a._)(this,C))return;(0,s._)(this,k,Z).call(this,e,t)}else(0,s._)(this,E,L).call(this,e,t);this.emit("change")}getValue(e){var t,{bindAccount:r}=null!==(t=g[e])&&void 0!==t?t:{};return r?(0,s._)(this,T,P).call(this,e):(0,s._)(this,I,G).call(this,e)}getValueSync(e){var t=this;return(0,n._)(function*(){var r,{bindAccount:n}=null!==(r=g[e])&&void 0!==r?r:{};return n?(!(0,a._)(t,C)&&(yield(0,s._)(t,M,B).call(t)),(0,s._)(t,T,P).call(t,e)):(0,s._)(t,I,G).call(t,e)})()}constructor(){super(),(0,l._)(this,w),(0,l._)(this,E),(0,l._)(this,k),(0,l._)(this,I),(0,l._)(this,T),(0,l._)(this,M),(0,o._)(this,S,{writable:!0,value:void 0}),(0,o._)(this,C,{writable:!0,value:void 0}),(0,o._)(this,j,{writable:!0,value:void 0}),(0,i._)(this,S,{}),(0,i._)(this,j,(0,u.Z)(()=>{localStorage.setItem(b,JSON.stringify((0,a._)(this,S)))},300)),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&(0,s._)(this,w,N).call(this)}),(0,s._)(this,w,N).call(this)}}function N(){(0,i._)(this,S,y(_(localStorage.getItem(b)))),this.emit("change")}function L(e,t){t?(0,a._)(this,S).permanent=(0,d._)((0,c._)({},(0,a._)(this,S).permanent),{[e]:t}):(0,a._)(this,S).permanent&&delete a._(this,S).permanent[e],(0,a._)(this,j).call(this)}function Z(e,t){var r,n,o,i,s;if(!!(0,a._)(this,C))t?(0,a._)(this,S).userRelated=(0,d._)((0,c._)({},(0,a._)(this,S).userRelated),{[(0,a._)(this,C)]:(0,d._)((0,c._)({},null===(o=(0,a._)(this,S).userRelated)||void 0===o?void 0:o[(0,a._)(this,C)]),{[e]:t})}):(null===(n=(0,a._)(this,S).userRelated)||void 0===n?void 0:null===(r=n[(0,a._)(this,C)])||void 0===r?void 0:r[e])&&(null===(s=(0,a._)(this,S).userRelated)||void 0===s||null===(i=s[(0,a._)(this,C)])||void 0===i||delete i[e]),(0,a._)(this,j).call(this)}function G(e){var t;return null===(t=(0,a._)(this,S).permanent)||void 0===t?void 0:t[e]}function P(e){var t,r;if(!!(0,a._)(this,C))return null===(r=(0,a._)(this,S).userRelated)||void 0===r?void 0:null===(t=r[(0,a._)(this,C)])||void 0===t?void 0:t[e]}function B(){return new Promise(e=>{var t=r=>{r&&(e((0,a._)(this,C)),this.off("setUserId",t))};this.on("setUserId",t)})}var R=new A;r("455069")},345249:function(e,t,r){r.d(t,{r:()=>_});var n,a=r("825955"),o=r("808549"),i=r("120454"),s=r("479910"),l=r("598208"),c=r("458620"),d=r("727914"),u=r("178385"),v=r("382534"),m=r("297158");var g=((n={}).EmptySpaceList="empty_space_List",n.PollingSpaceList="polling_space_list",n),p=e=>{var{request:t,isValid:r,maxRetry:n=4,interval:o=800}=e,i=0;return new Promise(e=>{var s,l=(s=(0,a._)(function*(){var a=yield t();r(a)?e({data:a,isSuccess:!0,tryCount:i}):++i<n?setTimeout(l,o):e({data:a,isSuccess:!1,tryCount:i})}),function(){return s.apply(this,arguments)});l()})},f=e=>{var{isSuccess:t,tryCount:r}=e;m.E7.errorEvent(t?{eventName:g.PollingSpaceList,error:new d.sH(g.PollingSpaceList,r.toString())}:{eventName:g.EmptySpaceList,error:new d.sH(g.EmptySpaceList,"space list is empty")})},h={space:{},spaceList:[],recentlyUsedSpaceList:[],loading:!1,maxTeamSpaceNum:3,createdTeamSpaceNum:0,inited:!1,spaces:{bot_space_list:[],has_personal_space:!0,team_space_num:0,max_team_space_num:3}},_=(0,l.Ue)()((0,s.mW)((e,t)=>{var r,n;return(0,i._)((0,o._)({},h),{reset:()=>{e(h,!1,"reset")},getSpaceId:()=>{var{id:e}=t().space;if(!e)throw new d.sH(c.b.parmasValidation,"lack space_id");return e},getPersonalSpaceID:()=>{var e,r;return null===(r=t().spaces.bot_space_list)||void 0===r?void 0:null===(e=r.find(e=>e.space_type===u.Sn.Personal))||void 0===e?void 0:e.id},checkSpaceID:e=>{var r;return!!(null===(r=t().spaces.bot_space_list)||void 0===r?void 0:r.find(t=>t.id===e))},setSpace:r=>{var{space:n,spaces:a}=t();if(r){var s=a.bot_space_list.find(e=>e.id===r);if(s)e({space:s},!1,"setSpace");else throw Error("can not find space: ".concat(r))}else e({space:(0,i._)((0,o._)({},n),{id:""})},!1,"setSpace")},createSpace:(r=(0,a._)(function*(e){var t=yield v.pr.SaveSpaceV2(e);if(0===t.code)return t.data;throw Error("create error: ".concat(t.msg))}),function(e){return r.apply(this,arguments)}),exitSpace:e=>Promise.resolve(void 0),deleteSpace:e=>Promise.resolve(void 0),updateSpace:e=>Promise.resolve({}),transferSpace:()=>Promise.resolve(void 0),fetchSpaces:(n=(0,a._)(function*(r){var n,o,i,s,l,c,d=(n=(0,a._)(function*(){var{data:e}=yield v.pr.GetSpaceListV2({});return e}),function(){return n.apply(this,arguments)}),m=t().loading,g=r?d():m||d();if(g===m)return m;e({loading:g},!1,"fetchSpaces");var h=yield g;if(!(null==h?void 0:h.has_personal_space)){yield t().createSpace({name:"Personal",description:"Personal Space",icon_uri:"",space_type:u.Sn.Personal});var _=yield p({request:d,isValid:e=>{var t,r;return(null!==(r=null==e?void 0:null===(t=e.bot_space_list)||void 0===t?void 0:t.length)&&void 0!==r?r:0)>0}});f(_),h=_.data}var x={bot_space_list:null!==(o=null==h?void 0:h.bot_space_list)&&void 0!==o?o:[],has_personal_space:null===(i=null==h?void 0:h.has_personal_space)||void 0===i||i,team_space_num:null!==(s=null==h?void 0:h.team_space_num)&&void 0!==s?s:0,max_team_space_num:null!==(l=null==h?void 0:h.max_team_space_num)&&void 0!==l?l:3};return e({spaceList:x.bot_space_list,recentlyUsedSpaceList:null!==(c=null==h?void 0:h.recently_used_space_list)&&void 0!==c?c:[],createdTeamSpaceNum:x.team_space_num,maxTeamSpaceNum:x.max_team_space_num,loading:!1,inited:!0,spaces:x},!1,"fetchSpaces"),h}),function(e){return n.apply(this,arguments)})})},{enabled:!1,name:"botStudio.spaceStore"}))},721566:function(e,t,r){r.d(t,{B3:()=>s,_:()=>u,pc:()=>i,rY:()=>n.r,$_:()=>l});var n=r("345249"),a=r("455069"),o=r("368696"),i=e=>{var[t,r]=(0,a.useState)(!0),i=(0,o.HU)();return(0,a.useEffect)(()=>{e||!n.r.getState().inited?(r(!0),n.r.getState().fetchSpaces(!0).finally(()=>{r(!1)})):r(!1)},[null==i?void 0:i.organization_id,e]),t},s=e=>{var t=(0,n.r)(e=>e.spaceList);return{spaces:t,loading:i(e)}},l=(e,t)=>{var r=(0,n.r)(t=>t.spaceList.find(t=>t.id===e));return{space:r,loading:i(t)}},c=r("157728"),d=e=>{var t=e.match(/^\/space\/[^/]+\/([A-Za-z0-9_-]+)/);return t?t[1]:void 0},u=()=>{var{pathname:e}=(0,c.useLocation)();return d(e)}},892010:function(e,t,r){r.r(t),r.d(t,{SpaceSubModuleEnum:()=>m,SpaceLayout:()=>R,WorkspaceSubMenu:()=>G,useInitSpace:()=>B});var n,a=r("151064"),o=r("157728"),i=r("455069"),s=r("613092"),l=r("721566"),c=r("336205"),d=r("915757"),u=r("674343"),v=r("30961");var m=((n={}).DEVELOP="develop",n.LIBRARY="library",n),g=r("825955"),p=r("808549"),f=r("120454"),h=r("178385"),_=r("75117"),x=r("407821"),y=r.n(x),b=r("472772"),S=r.n(b),C=r("395245"),j=r.n(C),w=r("297998"),E=r.n(w),k=r("646576"),I=r.n(k),T=r("606121"),M=r.n(T),A=r("181314"),N={};N.styleTagTransform=M(),N.setAttributes=E(),N.insert=j().bind(null,"head"),N.domAPI=S(),N.insertStyleElement=I(),y()(A.Z,N);var L=A.Z&&A.Z.locals?A.Z.locals:void 0,Z=function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{autoNavigate:n=!0,onSuccess:v}=r,m=(0,o.useNavigate)(),[x,y]=(0,i.useState)(!1),[b,S]=(0,i.useState)(""),[C,j]=(0,i.useState)(""),[w,E]=(0,i.useState)([]),[k,I]=(0,i.useState)(!1),T=(0,i.useRef)(null),M=(0,l.rY)(e=>e.createSpace),A=(0,l.rY)(e=>e.fetchSpaces);var N=(e=(0,g._)(function*(){if(!b.trim()){u.FN.warning(c.o.t("team_create_name_placeholder",{},"Please enter workspace name"));return}I(!0);try{var e,t=yield M({name:b.trim(),description:C.trim(),icon_uri:(null==w?void 0:null===(e=w[0])||void 0===e?void 0:e.url)||"",space_type:s.SpaceType.Team});if(null==t?void 0:t.check_not_pass){u.FN.warning(c.o.t("workspace_create_check_failed",{},"Workspace name or description contains inappropriate content. Please modify and try again.")),I(!1);return}console.log("[CreateSpace] Starting to refresh space list after creation"),console.log("[CreateSpace] Created space result:",t),yield A(!0),console.log("[CreateSpace] Space list refreshed, result.id:",null==t?void 0:t.id,"type:",typeof(null==t?void 0:t.id));var r=!1;if(null==t?void 0:t.id){var a=0,o=String(t.id);for(console.log("[CreateSpace] Target space ID (string):",o);a<10;){var i=l.rY.getState(),d=i.spaceList;console.log("[CreateSpace] Retry",a,"Current space list:",d.map(e=>({id:e.id,idType:typeof e.id,name:e.name})));var g=i.checkSpaceID(o),p=d.some(e=>String(e.id)===o);if(console.log("[CreateSpace] Space exists (checkSpaceID):",g),console.log("[CreateSpace] Space exists (manual check):",p),g||p){r=!0,console.log("[CreateSpace]  New space found in list:",o);break}console.log("[CreateSpace] Space not found, waiting",500,"ms before retry"),yield new Promise(e=>setTimeout(e,500)),console.log("[CreateSpace] Refreshing space list again..."),yield A(!0),a++}if(!r){var f=l.rY.getState().spaceList;console.error("[CreateSpace]  New space NOT found in list after",10,"retries.","\nTarget Space ID:",o,"(type:",typeof o,")","\nCurrent space list IDs:",f.map(e=>"".concat(e.id," (").concat(typeof e.id,")")),"\nCurrent space list:",f.map(e=>({id:e.id,name:e.name})))}}if(u.FN.success(c.o.t("workspace_creation_success",{},"Workspace created successfully")),y(!1),S(""),j(""),E([]),(null==t?void 0:t.id)&&r){if(console.log("[CreateSpace] Proceeding with navigation, space found in list"),null==v||v(t.id),n){try{var h=l.rY.getState(),_=String(t.id);console.log("[CreateSpace] Setting current space to:",_),h.setSpace(_),console.log("[CreateSpace]  Current space set successfully")}catch(e){console.error("[CreateSpace]  Failed to set current space:",e)}var x="/space/".concat(t.id,"/develop");console.log("[CreateSpace] Navigating to:",x),setTimeout(()=>{m(x)},100)}}else(null==t?void 0:t.id)&&!r&&(console.warn("[CreateSpace] Space not found, showing refresh prompt"),u.FN.info(c.o.t("workspace_created_please_refresh",{},"Workspace created successfully. Please refresh the page to see the new workspace.")),null==v||v(t.id))}catch(e){var k=(null==e?void 0:e.message)||c.o.t("workspace_creation_failed",{},"Failed to create workspace");u.FN.error(k),console.error("Create space error:",e)}finally{I(!1)}}),function(){return e.apply(this,arguments)}),Z=()=>{y(!1),S(""),j(""),E([])};return{node:(0,a.jsx)(u.u_,{visible:x,title:c.o.t("enterprise_workspace_management_create_space_title",{},"Create Workspace"),okText:c.o.t("Confirm",{},"Confirm"),cancelText:c.o.t("Cancel",{},"Cancel"),centered:!0,confirmLoading:k,onOk:N,onCancel:Z,children:(0,a.jsxs)("div",{className:"py-[12px]",children:[(0,a.jsxs)("div",{className:"mb-[16px]",children:[(0,a.jsxs)("div",{className:"mb-[8px] text-[14px] coz-fg-primary",children:[c.o.t("workspace_icon",{},"Workspace Icon"),(0,a.jsxs)("span",{className:"ml-[4px] text-[12px] coz-fg-tertiary",children:["(",c.o.t("Optional",{},"Optional"),")"]})]}),(0,a.jsx)(u.gq,{action:"",className:L.upload,limit:1,customRequest:e=>{(0,_.$)((0,f._)((0,p._)({},e),{fileBizType:h.ym.BIZ_BOT_ICON,onSuccess:t=>{e.onSuccess(t),E([{uid:(null==t?void 0:t.upload_uri)||"",url:(null==t?void 0:t.upload_url)||""}])}}))},fileList:w,accept:".jpeg,.jpg,.png,.gif",showReplace:!1,showUploadList:!1,ref:T,maxSize:2048,onSizeError:()=>{u.FN.error({content:c.o.t("dataset_upload_image_warning",{},"Please upload an image less than 2MB"),showClose:!1})},children:(0,a.jsxs)("div",{className:L["avatar-wrap"],children:[(null===(t=w[0])||void 0===t?void 0:t.url)?(0,a.jsx)("img",{src:w[0].url,alt:"workspace icon",className:L.avatar}):(0,a.jsx)("div",{className:L.placeholder,children:(0,a.jsx)(d.Isu,{className:"text-[32px] coz-fg-tertiary"})}),(0,a.jsx)("div",{className:L.mask,children:(0,a.jsx)("div",{className:"relative inline-flex",children:(0,a.jsx)(d.JAz,{className:"text-[24px]"})})})]})})]}),(0,a.jsxs)("div",{className:"mb-[16px]",children:[(0,a.jsxs)("div",{className:"mb-[8px] text-[14px] coz-fg-primary",children:[c.o.t("team_create_name",{},"Workspace Name"),(0,a.jsx)("span",{className:"text-[#f53f3f] ml-[4px]",children:"*"})]}),(0,a.jsx)(u.II,{value:b,onChange:e=>S(e),placeholder:c.o.t("team_create_name_placeholder",{},"Please enter workspace name"),maxLength:50,showClear:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-[8px] text-[14px] coz-fg-primary",children:[c.o.t("workspace_description",{},"Description"),(0,a.jsxs)("span",{className:"ml-[4px] text-[12px] coz-fg-tertiary",children:["(",c.o.t("Optional",{},"Optional"),")"]})]}),(0,a.jsx)("textarea",{className:"w-full p-[8px] border border-[#e0e0e0] rounded-[4px] text-[14px] coz-fg-primary resize-none focus:border-[#3370ff] focus:outline-none",value:C,onChange:e=>j(e.target.value),placeholder:c.o.t("workspace_description_placeholder",{},"Enter workspace description"),maxLength:200,rows:3,style:{fontFamily:"inherit"}})]})]})}),open:()=>{y(!0)},close:Z}},G=()=>{var{subMenuKey:e}=(0,v.A1)(),t=(0,o.useNavigate)(),r=(0,l.rY)(e=>e.space),n=(0,l.rY)(e=>e.spaceList),{node:g,open:p}=Z({autoNavigate:!0,onSuccess:e=>{console.log("Workspace created successfully:",e)}}),f=[{icon:(0,a.jsx)(d.Cr5,{}),activeIcon:(0,a.jsx)(d.zj2,{}),title:()=>c.o.t("navigation_workspace_develop",{},"Develop"),path:m.DEVELOP,dataTestId:"navigation_workspace_develop"},{icon:(0,a.jsx)(d.Guk,{}),activeIcon:(0,a.jsx)(d.Iqn,{}),title:()=>c.o.t("navigation_workspace_library",{},"Library"),path:m.LIBRARY,dataTestId:"navigation_workspace_library"}],h=(0,i.useMemo)(()=>{var e;return((null===(e=c.o.getLanguage)||void 0===e?void 0:e.call(c.o))||"zh-CN").startsWith("zh")?"".concat(c.o.t("add")).concat(c.o.t("navigation_workspace")):"".concat(c.o.t("add")," ").concat(c.o.t("navigation_workspace"))},[]),_=(0,a.jsx)(s.SpaceSwitcherDropdown,{currentSpace:r,spaceList:n,onSpaceClick:e=>{t("/space/".concat(e,"/develop"))},onAddSpaceClick:()=>{p()},searchPlaceholder:c.o.t("workspace_search_placeholder",{},"Search your workspace"),addSpaceText:h,children:(0,a.jsx)("div",{className:"cursor-pointer w-full",children:(0,a.jsxs)(u.T,{className:"h-[48px] px-[8px] w-full hover:coz-mg-secondary-hovered rounded-[8px]",spacing:8,children:[(0,a.jsx)(u.qE,{className:"w-[24px] h-[24px] rounded-[6px] shrink-0",src:null==r?void 0:r.icon_url}),(0,a.jsx)(u.ZT.Text,{ellipsis:{showTooltip:!0,rows:1},className:"flex-1 coz-fg-primary text-[14px] font-[500]",children:(null==r?void 0:r.space_type)===s.SpaceType.Personal?c.o.t("menu_title_personal_space",{},null==r?void 0:r.name):(null==r?void 0:r.name)||""}),(0,a.jsx)(d.Wdl,{className:"text-[12px] coz-fg-tertiary shrink-0"})]})})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.WorkspaceSubMenu,{header:_,menus:f,currentSubMenu:e}),g]})},P=r("58197"),B=e=>(0,s.useInitSpace)({spaceId:e,fetchSpacesWithSpaceId:e=>l.rY.getState().fetchSpaces(!0),isReady:!0}),R=()=>{var{space_id:e}=(0,o.useParams)(),{loading:t,spaceListLoading:r,spaceList:n}=B(e);return t||r||0!==n.length?t?null:(0,a.jsx)(o.Outlet,{}):(0,a.jsx)(u.HY,{className:"h-full justify-center w-full",image:(0,a.jsx)(P.YC,{width:"160",height:"160"}),title:c.o.t("enterprise_workspace_no_space_title"),description:c.o.t("enterprise_workspace_default_tips1_nonspace")})}},613092:function(e,t,r){r.r(t),r.d(t,{SpaceIdLayout:()=>U,SpaceType:()=>O.Sn,SpaceSwitcherDropdown:()=>W,useInitSpace:()=>V,WorkspaceSubMenu:()=>B});var n,a,o=r("151064"),i=r("664319"),s=r("721566"),l=r("674343"),c=r("808549"),d=r("120454"),u=r("455069"),v=r("157728"),m=r("252237"),g=r.n(m),p=r("581997"),f=r("707107"),h=e=>{var{icon:t,activeIcon:r,title:n,path:a,currentSubMenu:l,dataTestId:c}=e,d=(0,v.useNavigate)(),{spaceId:u}=(0,s.rY)((0,i.N)(e=>({spaceId:e.space.id})));return u?(0,o.jsxs)("div",{onClick:()=>{(0,f.Gg)(f.Kg.coze_space_sidenavi_ck,{item:(null==n?void 0:n())||"unknown-workspace-submenu",navi_type:"second",need_login:!0,have_access:!0}),p.D.setValue("workspace-subMenu",a),d("/space/".concat(u,"/").concat(a))},className:g()("flex items-center gap-[8px]","transition-colors","rounded-[8px]","h-[32px] w-full","px-[8px]","cursor-pointer","group","hover:coz-mg-secondary-hovered",{"coz-bg-primary":a===l,"coz-fg-plus":a===l,"coz-fg-primary":a!==l}),id:"workspace-submenu-".concat(a),"data-testid":c,children:[(0,o.jsx)("div",{className:"text-[14px]",children:(0,o.jsx)("div",{className:"w-[16px] h-[16px]",children:a===l?r:t})}),(0,o.jsx)("div",{className:g()("flex-1","text-[14px]","leading-[20px]","font-[500]"),children:null==n?void 0:n()})]}):null},_=e=>{var{menus:t,currentSubMenu:r}=e;return(0,o.jsx)("div",{className:"w-full mt-[16px]",children:(0,o.jsx)(l.T,{vertical:!0,spacing:4,className:"w-full",children:t.map((e,t)=>(0,u.createElement)(h,(0,d._)((0,c._)({},e),{key:t,currentSubMenu:r})))})})},x=r("825955"),y=r("974235"),b=r("664679"),S=r("297158"),C=r("628253"),j=r("28260"),w=r("336205"),E=r("727914"),k=r("382534"),I=r("915757"),T=r("117140"),M=e=>e===j.jH.Project?"project-ide":e===j.jH.Bot?"bot":"",A=e=>{var{basic_info:t={},type:r}=e,{space_id:n,id:a}=t;return"/space/".concat(n,"/").concat(M(r),"/").concat(a)},N=e=>{var t,{basic_info:r={},type:n}=e;var a=(t=(0,x._)(function*(){try{var e=yield k.yF.PublicFavoriteProduct({entity_type:n===j.jH.Project?T._J.Project:T._J.Bot,is_cancel:!0,entity_id:d});if(0===e.code)b.k.emit("refreshFavList",{id:d,numDelta:-1,emitPosition:"favorites-list-item"});else throw Error(e.message)}catch(e){S.E7.errorEvent({eventName:"sub_menu_unfavorite_error",error:new E.sH("sub_menu_unfavorite_error",e.message)})}}),function(){return t.apply(this,arguments)}),{icon_url:i,name:s,space_id:c,id:d}=r;return(0,o.jsx)("div",{className:g()("group","h-[32px] w-full rounded-[8px] cursor-pointer hover:coz-mg-secondary-hovered active:coz-mg-secondary-pressed"),onClick:()=>{if(!!c&&!!d)(0,f.Gg)(f.Kg.coze_space_sidenavi_ck,{item:d,category:"space_favourite",navi_type:"second",need_login:!0,have_access:!0}),window.open(A({basic_info:r,type:n}),"_blank")},"data-testid":"workspace.favorites.list.item",children:(0,o.jsxs)(l.T,{className:"h-[32px] px-[8px] w-full",spacing:8,children:[(0,o.jsx)(l.qE,{className:"h-[16px] w-[16px] rounded-[4px] shrink-0",shape:"square",src:i}),(0,o.jsx)(l.ZT.Text,{className:"flex-1",ellipsis:{showTooltip:!0,rows:1},children:s}),(0,o.jsx)("div",{onClick:e=>{e.stopPropagation()},className:g()("invisible opacity-0 group-hover:visible group-hover:opacity-100","h-[16px] w-[16px]"),children:(0,o.jsx)(l.J2,{className:"rounded-[8px]",position:"bottomRight",mouseLeaveDelay:200,stopPropagation:!0,content:(0,o.jsx)("div",{"data-testid":"workspace.favorites.list.item.popover",className:"w-[112px] h-[32px] pl-[8px] rounded-[8px] flex items-center overflow-hidden relative cursor-pointer hover:coz-mg-secondary-hovered",onClick:a,children:w.o.t("navigation_workspace_favourites_cancle")}),children:(0,o.jsx)(l.zx,{"data-testid":"workspace.favorites.list.item.popover.button",className:g()("h-full w-full !flex"),size:"mini",color:"secondary",icon:(0,o.jsx)(I.NsR,{})})})})]})})},L={list:[],total:0,hasMore:!1,cursorId:void 0};var Z=(n=(0,x._)(function*(e){var{spaceId:t,spaceType:r,cursorId:n,pageSize:a=20}=e;try{if(!t)return L;var o,i=yield k.sD.GetDraftIntelligenceList({space_id:t,order_by:C.d$.UpdateTime,is_fav:!0,status:[j.Gr.Using,j.Gr.Banned,j.Gr.MoveFailed],size:a,cursor_id:n,search_scope:C.$0.All}),s=null==i?void 0:i.data;return{list:(null==s?void 0:s.intelligences)||[],total:null!==(o=null==s?void 0:s.total)&&void 0!==o?o:0,hasMore:!!(null==s?void 0:s.has_more),cursorId:null==s?void 0:s.next_cursor_id}}catch(e){return S.E7.errorEvent({eventName:"get_favorites_list_error",error:new E.sH("get_favorites_list_error",e.message)}),L}}),function(e){return n.apply(this,arguments)}),G=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=(0,y.Z)(...t);return Object.assign((0,u.useMemo)(()=>(0,c._)({},n),[]),n)},P=()=>{var e,t,r,n,{spaceId:a,spaceType:d}=(0,s.rY)((0,i.N)(e=>({spaceId:e.space.id,spaceType:e.space.space_type}))),v=(0,u.useRef)(null);var m=G((e=(0,x._)(function*(e){var t;return yield Z({spaceId:a,spaceType:d,cursorId:null!==(t=null==e?void 0:e.cursorId)&&void 0!==t?t:void 0})}),function(t){return e.apply(this,arguments)}),{target:v,reloadDeps:[a,d],isNoMore:e=>!(null==e?void 0:e.hasMore)}),{loading:p,data:f,loadingMore:h}=m;return(0,u.useEffect)(()=>{var e,t=(e=(0,x._)(function*(e){if(m.loading||m.loadingMore)return;var t,r,n=null===(r=m.data)||void 0===r?void 0:null===(t=r.list)||void 0===t?void 0:t.length,o=yield Z({spaceId:a,spaceType:d,pageSize:Math.max(n?n+e.numDelta:20,20)});if(!m.loading&&!m.loadingMore)m.mutate(o)}),function(t){return e.apply(this,arguments)});return b.k.on("refreshFavList",t),()=>b.k.off("refreshFavList",t)},[a,d]),(0,o.jsx)("div",{className:g()("w-full h-full flex flex-col"),children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.T,{className:"h-[24px] pl-[8px] w-full mb-[4px] flex-none",spacing:4,children:(0,o.jsx)("div",{className:"coz-fg-secondary text-[14px] font-[500] leading-[20px]",children:w.o.t("navigation_workspace_favourites",{},"Favourites")})}),(0,o.jsx)("div",{ref:v,className:"w-full flex-grow max-h-full overflow-y-auto styled-scrollbar-hidden",children:p?(0,o.jsx)("div",{className:"flex items-center justify-center h-[200px] w-full",children:(0,o.jsx)(l.gb,{loading:!0,size:"mini"})}):(0,o.jsxs)(l.T,{vertical:!0,spacing:4,className:"w-full",children:[(null==f?void 0:null===(t=f.list)||void 0===t?void 0:t.length)&&(null==f?void 0:null===(r=f.list)||void 0===r?void 0:r.length)>0?null==f?void 0:null===(n=f.list)||void 0===n?void 0:n.map(e=>{var t;return(0,o.jsx)(N,(0,c._)({},e),null===(t=e.basic_info)||void 0===t?void 0:t.id)}):(0,o.jsxs)("div",{className:"coz-fg-dim pl-[8px] text-[14px] font-[500] leading-[20px]",children:[(0,o.jsx)("div",{children:w.o.t("home_favor_desc1")}),(0,o.jsx)("div",{children:w.o.t("home_favor_desc2")})]}),h?(0,o.jsx)(l.gb,{loading:!0,size:"mini"}):null]})})]})})};r("162720");var B=e=>{var{header:t,menus:r,currentSubMenu:n}=e,{spaceList:a,loading:c}=(0,s.rY)((0,i.N)(e=>({currentSpace:e.space,spaceList:e.spaceList,loading:!!e.loading||!e.inited}))),d=a.length>0;return(0,o.jsx)(l.Od,{loading:c,active:!0,placeholder:(0,o.jsx)(l.Od.Paragraph,{}),children:(0,o.jsxs)(l.T,{spacing:4,vertical:!0,className:"w-full h-full",children:[(0,o.jsx)("div",{className:"flex-none w-full",children:t}),d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"flex-none w-full",children:(0,o.jsx)(_,{menus:r,currentSubMenu:n})}),(0,o.jsx)("div",{className:"flex-grow max-h-full overflow-y-auto w-full mt-[24px]",children:(0,o.jsx)(P,{})})]}):null]})})},R=r("244470"),D=r("942185"),F=e=>{var{spaceId:t}=e;return(0,D.Bc)(t),(0,R.o)(t)?(0,o.jsx)(v.Outlet,{}):null},U=()=>{var{space_id:e}=(0,v.useParams)();return e?(0,o.jsx)(F,{spaceId:e},e):null},O=r("178385"),z=e=>{var{searchValue:t,searchPlaceholder:r,onSearchChange:n,personalSpace:a,teamSpaces:i,currentSpace:s,onSpaceClick:c,addSpaceText:d,onAddSpaceClick:u}=e;return(0,o.jsxs)("div",{className:"w-[280px] max-h-[400px] flex flex-col overflow-hidden rounded-[12px]",children:[(0,o.jsx)("div",{className:"px-[12px] py-[8px] border-b coz-stroke-primary",children:(0,o.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),placeholder:r,className:"w-full h-[32px] px-[12px] rounded-[6px] coz-bg-secondary coz-fg-primary text-[14px] outline-none border-none",onClick:e=>e.stopPropagation()})}),(0,o.jsxs)("div",{className:"flex-1 overflow-y-auto px-[8px] py-[8px]",children:[a?(0,o.jsxs)("div",{className:g()("flex items-center gap-[8px] px-[8px] py-[6px] rounded-[6px] cursor-pointer","hover:coz-mg-secondary-hovered",s.id===a.id&&"coz-bg-primary"),onClick:()=>a.id&&c(a.id),children:[(0,o.jsx)(l.qE,{className:"w-[24px] h-[24px] rounded-[6px] shrink-0",src:a.icon_url}),(0,o.jsx)(l.ZT.Text,{ellipsis:{showTooltip:!0,rows:1},className:"flex-1 text-[14px] font-[500] coz-fg-primary",children:w.o.t("menu_title_personal_space",{},a.name)}),s.id===a.id&&(0,o.jsx)("div",{className:"w-[4px] h-[4px] rounded-full coz-bg-brand"})]}):null,i.length>0&&(0,o.jsx)("div",{className:"mt-[4px]",children:i.map(e=>(0,o.jsxs)("div",{className:g()("flex items-center gap-[8px] px-[8px] py-[6px] rounded-[6px] cursor-pointer","hover:coz-mg-secondary-hovered",s.id===e.id&&"coz-bg-primary"),onClick:()=>e.id&&c(e.id),children:[(0,o.jsx)(l.qE,{className:"w-[24px] h-[24px] rounded-[6px] shrink-0",src:e.icon_url}),(0,o.jsx)(l.ZT.Text,{ellipsis:{showTooltip:!0,rows:1},className:"flex-1 text-[14px] font-[500] coz-fg-primary",children:e.name}),s.id===e.id&&(0,o.jsx)("div",{className:"w-[4px] h-[4px] rounded-full coz-bg-brand"})]},e.id))}),!a&&0===i.length&&(0,o.jsx)("div",{className:"py-[24px] text-center",children:(0,o.jsx)(l.ZT.Text,{className:"text-[14px] coz-fg-tertiary",children:w.o.t("app_publish_connector_space_mcp_config_dialog_no_results_found",{},"No results found")})})]}),u?(0,o.jsx)("div",{className:"px-[12px] py-[8px] border-t coz-stroke-primary",children:(0,o.jsx)(l.zx,{className:"w-full",color:"secondary",icon:(0,o.jsx)(I.PwN,{}),onClick:e=>{e.stopPropagation(),u()},children:d})}):null]})},W=e=>{var{currentSpace:t,spaceList:r,onSpaceClick:n,onAddSpaceClick:a,children:i,searchPlaceholder:s,addSpaceText:c}=e,[d,v]=(0,u.useState)(""),[m,g]=(0,u.useState)(!1),p=(0,u.useMemo)(()=>null!=s?s:w.o.t("workspace_search_placeholder",{},"Search your workspace"),[s]),f=(0,u.useMemo)(()=>null!=c?c:w.o.t("add",{},"Add"),[c]),{personalSpace:h,teamSpaces:_}=(0,u.useMemo)(()=>{var e=r.filter(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase())});return{personalSpace:e.find(e=>e.space_type===O.Sn.Personal),teamSpaces:e.filter(e=>e.space_type===O.Sn.Team)}},[r,d]),x=(0,u.useCallback)(e=>{g(!1),n(e)},[n]),y=(0,u.useCallback)(()=>{g(!1),null==a||a()},[a]),b=(0,u.useCallback)(e=>{v(e)},[]),S=(0,u.useMemo)(()=>m?(0,o.jsx)(z,{searchValue:d,searchPlaceholder:p,onSearchChange:b,personalSpace:h,teamSpaces:_,currentSpace:t,onSpaceClick:x,addSpaceText:f,onAddSpaceClick:a?y:void 0}):null,[m,d,p,b,h,_,t,x,f,a,y]);return(0,o.jsx)(l.Lt,{trigger:"custom",position:"bottomLeft",visible:m,onVisibleChange:g,onClickOutSide:()=>{g(!1)},render:S,children:(0,o.jsx)("div",{onClick:()=>g(!m),children:i})})},H=r("458620");var K=(a=(0,x._)(function*(e,t,r){var n,a,o=null!==(n=yield p.D.getValueSync("workspace-spaceId"))&&void 0!==n?n:e,i=null!==(a=yield p.D.getValueSync("workspace-subMenu"))&&void 0!==a?a:t;return o&&r(o)?"/space/".concat(o,"/").concat(i):"/space/".concat(e,"/").concat(i)}),function(e,t,r){return a.apply(this,arguments)}),V=function(){var{spaceId:e,fetchSpacesWithSpaceId:t,isReady:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n,a]=(0,u.useState)(!1),o=(0,v.useNavigate)(),c=(0,S.UQ)(),{space:d,spaceListLoading:m,spaceList:g}=(0,s.rY)((0,i.N)(e=>({space:e.space,spaceListLoading:e.loading,spaceList:e.spaceList})));return(0,u.useEffect)(()=>{var n;(n=(0,x._)(function*(e){try{if(!r)return;if(e)yield null==t?void 0:t(e),s.rY.getState().checkSpaceID(e)?s.rY.getState().setSpace(e):c(new E.sH(H.b.errorPath,"space id error",{customGlobalErrorConfig:{title:w.o.t("workspace_no_permission_access"),subtitle:"You do not have permission to access this space or the space ID does not exist"}}));else{yield s.rY.getState().fetchSpaces(!0);var n,i,d=s.rY.getState().getPersonalSpaceID(),u=null===(n=s.rY.getState().spaceList[0])||void 0===n?void 0:n.id,v=null!==(i=null!=d?d:u)&&void 0!==i?i:"",{checkSpaceID:m}=s.rY.getState();if(v){var g=yield K(v,"develop",m);o(g)}else l.FN.warning(w.o.t("enterprise_workspace_default_tips2_toast"))}}catch(e){S.E7.error({message:"init_space_error",error:e}),a(!0),c(new E.sH(H.b.errorPath,"space id error",{customGlobalErrorConfig:{title:w.o.t("workspace_no_permission_access"),subtitle:e.message}}))}}),function(e){return n.apply(this,arguments)})(e)},[e,r]),{loading:!d.id,isError:n,spaceListLoading:m,spaceList:g}}},947578:function(e,t,r){r.d(t,{u:()=>c});var n=r("151064"),a=r("626389"),o=r.n(a),i=r("297158"),s=r("336205"),l=r("674343"),c=e=>(0,n.jsxs)("div",{className:"flex flex-row justify-center items-center",children:[e,(0,n.jsx)(l.zx,{className:"ml-[8px]",onClick:()=>{var e,t,r=null===(t=(0,i.f5)())||void 0===t?void 0:null===(e=t.config())||void 0===e?void 0:e.sessionId;o()(null!=r?r:""),l.FN.success(s.o.t("error_id_copy_success"))},size:"small",color:"primary",children:s.o.t("copy_session_id")})]})},372707:function(e,t,r){r.d(t,{W:function(){return a}});var n,a=((n={}).PDF="pdf",n.DOCX="docx",n.EXCEL="excel",n.CSV="csv",n.IMAGE="image",n.AUDIO="audio",n.VIDEO="video",n.ARCHIVE="archive",n.CODE="code",n.TXT="txt",n.PPT="ppt",n.DEFAULT_UNKNOWN="default_unknown",n)},187151:function(e,t,r){r.d(t,{Wz:()=>n.W,hr:()=>o,Co:()=>a});var n=r("372707"),a=[{fileType:n.W.IMAGE,accept:["image/*"],judge:e=>e.type.startsWith("image/")},{fileType:n.W.AUDIO,accept:[".mp3",".wav",".aac",".flac",".ogg",".wma",".alac",".mid",".midi",".ac3",".dsd"],judge:e=>e.type.startsWith("audio/")},{fileType:n.W.PDF,accept:[".pdf"]},{fileType:n.W.DOCX,accept:[".docx",".doc"]},{fileType:n.W.EXCEL,accept:[".xls",".xlsx"]},{fileType:n.W.CSV,accept:[".csv"]},{fileType:n.W.VIDEO,accept:[".mp4",".avi",".mov",".wmv",".flv",".mkv"],judge:e=>e.type.startsWith("video/")},{fileType:n.W.ARCHIVE,accept:[".zip",".rar",".7z",".tar",".gz",".bz2"]},{fileType:n.W.CODE,accept:[".py",".java",".c",".cpp",".js",".html",".css"]},{fileType:n.W.TXT,accept:[".txt"]},{fileType:n.W.PPT,accept:[".ppt",".pptx"]},{fileType:n.W.DEFAULT_UNKNOWN,judge:()=>!0,accept:["*"]}],o=e=>{var t=a.find(t=>{var{judge:r,accept:n}=t;return r?r(e):n.some(t=>e.name.endsWith(t))});return t?t:null}},24445:function(e,t,r){r.d(t,{e:()=>C});var n=r("151064");r("455069");var a=r("252237"),o=r.n(a),i=r("44172"),s=r("157728"),l=r("407821"),c=r.n(l),d=r("472772"),u=r.n(d),v=r("395245"),m=r.n(v),g=r("297998"),p=r.n(g),f=r("646576"),h=r.n(f),_=r("606121"),x=r.n(_),y=r("562172"),b={};b.styleTagTransform=x(),b.setAttributes=p(),b.insert=m().bind(null,"head"),b.domAPI=u(),b.insertStyleElement=h(),c()(y.Z,b);var S=y.Z&&y.Z.locals?y.Z.locals:void 0;function C(e){var{isOversea:t,isWhite:r,className:a,style:l}=e,c=(0,s.useNavigate)(),d=()=>{c("/")};return t?(0,n.jsx)(i.D6Z,{onClick:d,className:o()(S["coze-brand"],a),style:l}):r?(0,n.jsx)(i.JhV,{onClick:d,className:o()(S["coze-brand"],a),style:l}):(0,n.jsx)(i.Hub,{onClick:d,className:o()(S["coze-brand"],a),style:l})}},474872:function(e,t,r){r.d(t,{bK:()=>e3,sN:()=>e1,kU:()=>eV,gj:()=>eT,uO:()=>e5,g3:()=>K,hE:()=>eh,yk:()=>J,B6:()=>eP,g7:()=>ei,br:()=>eS,Nt:()=>e6,sI:()=>R,nX:()=>e8,Ke:()=>E,yO:()=>V});var n,a=r("151064"),o=r("252237"),i=r.n(o),s=r("163600"),l=r("336205"),c=r("915757"),d=r("674343"),u=r("407821"),v=r.n(u),m=r("472772"),g=r.n(m),p=r("395245"),f=r.n(p),h=r("297998"),_=r.n(h),x=r("646576"),y=r.n(x),b=r("606121"),S=r.n(b),C=r("49805"),j={};j.styleTagTransform=S(),j.setAttributes=_(),j.insert=f().bind(null,"head"),j.domAPI=g(),j.insertStyleElement=y(),v()(C.Z,j);var w=C.Z&&C.Z.locals?C.Z.locals:void 0,E=e=>{var{status:t}=e;if(t===s.Tn.None||t===s.Tn.Cancel)return null;var r={[s.Tn.Generating]:(0,a.jsx)(d.u,{content:l.o.t("profilepicture_hover_generating"),children:(0,a.jsx)(c.j2n,{className:i()(w.icon,w["icon-generating"]),spin:!0})}),[s.Tn.Success]:(0,a.jsx)(d.u,{content:l.o.t("profilepicture_hover_generated"),children:(0,a.jsx)(c.Lz_,{className:i()(w.icon,w["icon-success"])})}),[s.Tn.Fail]:(0,a.jsx)(d.u,{content:l.o.t("profilepicture_hover_failed"),children:(0,a.jsx)(c.U6C,{className:i()(w.icon,w["icon-fail"])})})};return(0,a.jsx)("div",{className:i()(w.ctn,t===s.Tn.Generating?w.loading:void 0),children:r[t]})},k=r("192903"),I={};I.styleTagTransform=S(),I.setAttributes=_(),I.insert=f().bind(null,"head"),I.domAPI=g(),I.insertStyleElement=y(),v()(k.Z,I),k.Z&&k.Z.locals&&k.Z.locals;var T=r("455069"),M=r("382534"),A=r("455309"),N={};N.styleTagTransform=S(),N.setAttributes=_(),N.insert=f().bind(null,"head"),N.domAPI=g(),N.insertStyleElement=y(),v()(A.Z,N),A.Z&&A.Z.locals&&A.Z.locals;var L=r("808549"),Z=r("120454"),G=r("775699");r("94347");var P=r("778122"),B=e=>{var{maxLen:t,len:r}=e;return(0,a.jsxs)("span",{className:P.Z["limit-count"],children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{children:"/"}),(0,a.jsx)("span",{children:t})]})},R=(0,G.Q2)(e=>{var{value:t,maxLength:r,getValueLength:n}=e,o=(0,T.useMemo)(()=>n?n(t):t?t.toString().length:0,[t,n]);return(0,a.jsx)(G.u3,(0,Z._)((0,L._)({},e),{suffix:!!r&&(0,a.jsx)(B,{maxLen:null!=r?r:0,len:o})}))}),D=r("473980"),F=r("157728"),U=r("22985"),O=r("214942"),z=r("30961"),W=r("721566"),H=r("796917"),K=e=>{var{botInfo:t,datasetInfo:r,documentinfo:n,pluginInfo:o,pluginToolInfo:i,mockSetInfo:s,isPublish:u}=e,v=(0,D._)(e,["botInfo","datasetInfo","documentinfo","pluginInfo","pluginToolInfo","mockSetInfo","isPublish"]),{menuKey:m}=(0,z.A1)(),g=(0,W._)(),p=(0,O.rY)(e=>e.space.id),f=(0,F.useNavigate)(),h=(0,F.useParams)(),_=()=>{m===U.el.Explore?f("/explore"):f("/space/".concat(p,"/library"))},x=()=>{f("/space/".concat(p,"/").concat(g,"/").concat(h.dataset_id))},y=()=>{f("/space/".concat(p,"/").concat(g,"/").concat(h.plugin_id))},b=()=>{f("/space/".concat(p,"/").concat(g,"/").concat(h.bot_id))},S=()=>{f("/space/".concat(p,"/").concat(g,"/").concat(h.plugin_id,"/tool/").concat(h.tool_id,"?mode=preview"))},C=()=>{f("/space/".concat(p,"/").concat(g,"/").concat(h.plugin_id,"/tool/").concat(h.tool_id,"/plugin-mock-set"))},j=()=>{var e,t=[];return(null==o?void 0:o.name)&&(e=_),(null==i?void 0:i.name)&&(e=y),s&&(e=S,(null==s?void 0:s.name)&&(e=C)),t=[(0,a.jsx)(d.zx,{color:"secondary",icon:(0,a.jsx)(c.$1i,{}),onClick:()=>{e()},children:l.o.t("library_resource_detail_back")})]};return(0,a.jsx)("div",{className:H.Z["bot-breadcrumb"],children:(0,a.jsx)(d.aG,(0,Z._)((0,L._)({},v),{children:(()=>{if(m===U.el.Explore)return[(0,a.jsx)(d.aG.Item,{onClick:_,children:(0,a.jsx)(d.ZT.Title,{weight:700,className:H.Z["bread-title"],children:"Explore"})},"bots"),(0,a.jsx)(d.aG.Item,{children:(0,a.jsxs)("div",{className:H.Z["bot-info-item"],children:[(0,a.jsx)(d.qE,{className:H.Z["bot-avatar"],src:null==t?void 0:t.icon_url,size:"extra-small",shape:"square"}),(0,a.jsx)("div",{className:H.Z["bot-name"],children:null==t?void 0:t.name})]})},"bots info")];switch(g){case U.Yi.BOT:if(u)return[(0,a.jsx)(d.aG.Item,{onClick:_,children:(0,a.jsx)(d.ZT.Title,{weight:700,className:H.Z["bread-title"],children:l.o.t("menu_bots")})},"bots"),(0,a.jsx)(d.aG.Item,{onClick:b,children:(0,a.jsxs)("div",{className:H.Z["bot-info-item"],children:[(0,a.jsx)(d.qE,{className:H.Z["bot-avatar"],src:null==t?void 0:t.icon_url,size:"extra-small",shape:"square"}),(0,a.jsx)(d.ZT.Title,{weight:700,className:H.Z["bread-title"],children:null==t?void 0:t.name})]})},"bots info"),(0,a.jsx)(d.aG.Item,{children:(0,a.jsx)("div",{className:H.Z["bot-info-item"],children:(0,a.jsx)("div",{className:H.Z["bot-name"],children:l.o.t("Publish")})})},"bots publish")];return[(0,a.jsx)(d.aG.Item,{onClick:_,children:(0,a.jsx)(d.ZT.Title,{weight:700,className:H.Z["bread-title"],children:l.o.t("menu_bots")})},"bots"),(0,a.jsx)(d.aG.Item,{children:(0,a.jsxs)("div",{className:H.Z["bot-info-item"],children:[(0,a.jsx)(d.qE,{className:H.Z["bot-avatar"],src:null==t?void 0:t.icon_url,size:"extra-small",shape:"square"}),(0,a.jsx)(d.ZT.Text,{className:H.Z["bot-name"],ellipsis:{showTooltip:{opts:{content:null==t?void 0:t.name,style:{wordWrap:"break-word"}}}},children:null==t?void 0:t.name})]})},"bots info")];case U.Yi.KNOWLEDGE:if(!h.doc_id)return[(0,a.jsx)(d.aG.Item,{onClick:()=>{_()},children:l.o.t("datasets_title")},"dataset"),(0,a.jsx)(d.aG.Item,{noLink:!0,children:null==r?void 0:r.name},"doc")];return[(0,a.jsx)(d.aG.Item,{onClick:()=>{_()},children:l.o.t("datasets_title")},"dataset"),(0,a.jsx)(d.aG.Item,{onClick:x,children:null==r?void 0:r.name},"doc"),(0,a.jsx)(d.aG.Item,{noLink:!0,children:null==n?void 0:n.name},"slice")];case U.Yi.PLUGIN:return j();default:return null}})()}))})},V=(0,T.forwardRef)((e,t)=>(0,a.jsx)(G.yO,(0,L._)({ref:t,placeholder:l.o.t("Search")},e))),q=r("192551"),Y=(0,T.lazy)(()=>r.e("3785").then(r.bind(r,20311))),X=e=>(0,a.jsx)(T.Suspense,{fallback:null,children:(0,a.jsx)(Y,(0,L._)({},e))}),J=e=>{var{children:t,className:r,style:n}=e;return(0,a.jsx)("div",{className:i()(q.Z["tip-content"],r),style:n,children:"string"==typeof t?(0,a.jsx)(X,{skipHtml:!0,className:q.Z.markdown,children:t}):t})},Q=r("825955"),$=r("227733"),ee=r("178385"),et=r("552938"),er=r("277194"),en=r("44172"),ea=r("58118"),eo=r("411481"),ei=e=>{var t,{visible:r,botName:n,onCancel:o,onConfirm:s}=e,{pageFrom:c}=(0,et.K)(e=>({pageFrom:e.pageFrom})),{hasWorkflow:d}=(0,er.Ee)(e=>({hasWorkflow:!!e.workflows.length})),{space:{id:u,hide_operation:v}}=(0,O.rY)(),{spaces:m=[]}=(0,O.B3)(!0),[g,p]=(0,T.useState)(!1),f=(0,T.useRef)(null);(0,T.useEffect)(()=>{if(p(!1),r){var e,t,n;null===(e=f.current)||void 0===e||e.formApi.setValue("spaceId",v?null!==(t=null==m?void 0:m[0].id)&&void 0!==t?t:"":null!==(n=null!=u?u:O.rY.getState().getPersonalSpaceID())&&void 0!==n?n:"")}},[r,m]);var h="(".concat(l.o.t("duplicate_rename_copy"),")"),_=ea.p.getInputLengthLimit("botName"),x=_-h.length;return(0,a.jsx)(G.M5,{type:"action-small",title:"".concat(l.o.t("binding_duplicate_card")," Bot"),visible:r,onCancel:()=>null==o?void 0:o(),onOk:(0,Q._)(function*(){try{yield null===(e=f.current)||void 0===e?void 0:e.formApi.validate(),p(!0);var e,t,r,n=null===(t=f.current)||void 0===t?void 0:t.formApi.getValues();yield null==s?void 0:s(null!==(r=null==n?void 0:n.spaceId)&&void 0!==r?r:"",null==n?void 0:n.name)}catch(e){p(!1)}}),okButtonProps:{loading:g},children:(0,a.jsxs)("div",{children:[c===$.J.Store&&d?(0,a.jsx)(G.jL,{fullMode:!1,type:"warning",description:l.o.t("mkpl_bot_duplicate_tips"),icon:(0,a.jsx)(en.O5N,{}),closeIcon:null}):null,(0,a.jsxs)(G.l0,{ref:f,children:[n?(0,a.jsx)(R,{initValue:"".concat((()=>{if(!n)return n;var e=x-3;return n.length>_?"".concat(n.slice(0,e)).concat("..."):n})()).concat(h),field:"name",label:l.o.t("bot_create_name"),noErrorMessage:!0,maxLength:_,rules:[{required:!0},{validator:(e,t)=>(null==t?void 0:t.trim())!==""}],placeholder:l.o.t("bot_create_name_placeholder"),getValueLength:e=>"number"==typeof e?e.toString().length:ea.p.getValueLength(e)}):null,(0,a.jsx)(G.N5,{label:l.o.t("duplicate_select_workspace"),noLabel:!n,field:"spaceId",placeholder:l.o.t("select_team"),noErrorMessage:!0,className:i()(eo.Z.select),rules:[{required:!0}],renderSelectedItem:e=>e.id?(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(G.qE,{src:e.icon_url,size:"extra-extra-small",style:{flexShrink:0},children:e.name}),(0,a.jsx)("span",{className:i()(eo.Z["select-name"]),children:e.name})]}):null,children:null==m?void 0:null===(t=m.filter(e=>!e.hide_operation))||void 0===t?void 0:t.map(e=>(0,T.createElement)(G.N5.Option,(0,Z._)((0,L._)({value:e.id},e),{key:e.id,children:[e.icon_url?(0,a.jsx)(G.qE,{size:"extra-small",src:e.icon_url}):(0,a.jsx)(en.vl3,{className:i()(eo.Z["select-item-icon"])}),(0,a.jsx)("div",{className:i()(eo.Z["select-item-name"]),children:e.name}),e.space_type===ee.Sn.Team&&(0,a.jsx)(G.fS,{color:"violet",children:l.o.t("develop_team_team")})]})))})]})]})})},es=r("664319"),el=r("735114"),ec=r("388993"),ed=r("458620"),eu=r("298203"),ev=r("707107"),em=r("670898"),eg=r("727914"),ep=r("117140"),ef=(0,ed.z)({eventName:ed.b.botDuplicate}),eh=e=>{var t,{storeCategory:r,botName:n,botID:o,isDisabled:i,btnTxt:s,pageFrom:c,version:u,buttonSize:v,enableCozeDesign:m,isBlock:g,eventCallbacks:p}=e,{space:{hide_operation:f,id:h},getPersonalSpaceID:_}=(0,O.rY)(),{spaces:x=[]}=(0,O.B3)(),{pageFromFromStore:y}=(0,et.K)((0,es.N)(e=>({pageFromFromStore:e.pageFrom}))),{botIdFromStore:b,botNameFromStore:S}=(0,ec.G)((0,es.N)(e=>({botIdFromStore:e.botId,botNameFromStore:e.name}))),[C,j]=(0,T.useState)(!1);var{runAsync:w}=(0,el.Z)((t=(0,Q._)(function*(e,t){if(ef.start(),(c===$.J.Store||c===$.J.Template)&&o&&u&&e){if(c===$.J.Template){var r,a,i,s,d,{code:v,message:m,data:{new_entity_id:g}={}}=yield M.yF.PublicDuplicateProduct({product_id:o,entity_type:ep._J.BotTemplate,space_id:e,name:null!=t?t:""});i={code:v,msg:m,data:{bot_id:g}}}else i=yield M.pr.DuplicateBotVersionToSpace({bot_id:o,version:u,target_space_id:e,name:null!=t?t:""});j(!1)}else y===$.J.Explore?(i=yield M.nA.DuplicateBotToSpace({draft_bot_id:b,target_space_id:e||"",name:t}),j(!1)):i=yield em.C.DuplicateDraftBot({bot_id:b});null==p||null===(a=p.duplicateFinished)||void 0===a||a.call(p,{newBotId:null!==(s=null===(r=i.data)||void 0===r?void 0:r.bot_id)&&void 0!==s?s:""});var f={bot_type:y===$.J.Explore||y===$.J.Store?"store_bot":"team_bot",bot_id:null!=o?o:b,workspace_type:y===$.J.Store?"store_workspace":_()===e?"personal_workspace":"team_workspace",bot_name:null!==(d=null!=n?n:S)&&void 0!==d?d:""};0===i.code?(0,ev.Gg)(ev.Kg.bot_duplicate_result,(0,Z._)((0,L._)({},f),{result:"success"})):(0,ev.Gg)(ev.Kg.bot_duplicate_result,(0,Z._)((0,L._)({},f),{result:"failed",error_code:i.code,error_message:i.msg}));var x=i.data;if(!x)throw new eg.sH(ed.b.botDuplicate,l.o.t("bot_copy_info_error"));var{bot_id:C}=x;if(!o&&!b)throw new eg.sH(ed.b.botDuplicate,l.o.t("bot_copy_id_error"));return"".concat(location.origin,"/space/").concat(e||h,"/bot/").concat(C,"?from=copy")}),function(e,r){return t.apply(this,arguments)}),{manual:!0,onSuccess:()=>{ef.success()},onError:e=>{ef.error({error:e,reason:e.message}),j(!1)}}),E=()=>{var e;if(null==p||null===(e=p.clickButton)||void 0===e||e.call(p),(0,ev.Gg)(ev.Kg.bot_duplicate_click,{bot_type:y===$.J.Bot?"team_bot":"store_bot"}),c===$.J.Store)(0,ev.Gg)(ev.Kg.bot_duplicate_click_front,{bot_type:"store_bot",bot_id:o,bot_name:n,category_id:null==r?void 0:r.id,category_name:null==r?void 0:r.name,source:"bots_store",from:(0,eu.zx)({key:"from"})}),j(!0);else if(y===$.J.Explore)(0,ev.Gg)(ev.Kg.bot_duplicate_click_front,{bot_type:"store_bot",bot_id:S,bot_name:S,source:"explore_bot_detailpage",from:"explore_card"}),(0,ev.Gg)(ev.Kg.click_bot_duplicate,{bot_id:b,bot_name:S,from:"explore_card",source:"explore_bot_detailpage"}),1===x.length?(0,eu.xg)(()=>w(null==x?void 0:x[0].id)):j(!0);else if(c===$.J.Template)1===x.length?(0,eu.xg)(()=>w(null==x?void 0:x[0].id)):j(!0);else{if((0,ev.Gg)(ev.Kg.bot_duplicate_click_front,{bot_type:"team_bot",bot_id:b,bot_name:S,source:"bots_detailpage",from:"bots_card"}),f){G.FN.warning("Bot in public space cannot duplicate");return}(0,eu.xg)(w)}};return(0,a.jsxs)(a.Fragment,{children:[m?(0,a.jsx)(d.zx,{type:"primary",theme:"solid",size:v,onClick:E,disabled:i,block:g,children:s||l.o.t("duplicate")}):(0,a.jsx)(G.y3,{type:"primary",theme:"solid",size:v,onClick:E,disabled:i,children:s||l.o.t("duplicate")}),(0,a.jsx)(ei,{botName:null!=n?n:S,visible:C,onCancel:()=>{j(!1)},onConfirm:(e,t)=>{(0,ev.Gg)(ev.Kg.click_create_bot_confirm,{click:"success",create_type:"duplicate",from:"explore_card",source:"explore_bot_detailpage"}),(0,eu.xg)(()=>w(e,t))}})]})};r("24445");var e_=r("962289"),ex=r("426614"),ey={};ey.styleTagTransform=S(),ey.setAttributes=_(),ey.insert=f().bind(null,"head"),ey.domAPI=g(),ey.insertStyleElement=y(),v()(ex.Z,ey);var eb=ex.Z&&ex.Z.locals?ex.Z.locals:void 0,eS=e=>{var{children:t,url:r,title:n="",className:o,imgProps:s}=e,l=(0,D._)(e,["children","url","title","className","imgProps"]),c=(0,T.useRef)(),d=(0,T.useCallback)(()=>{var e=(0,e_.Z)(c.current,"tooltipRef.current.foundation.calcPosition");"function"==typeof e&&(null==e||e())},[]);return(0,a.jsx)(G.J2,(0,Z._)((0,L._)({position:"top",showArrow:!0,ref:c,content:(0,a.jsxs)("div",{className:eb["popover-content"],children:[(0,a.jsx)("div",{className:eb["popover-card-title"],children:n}),r&&(0,a.jsx)("div",{className:eb["popover-card-img"],children:(0,a.jsx)(G.Ee,(0,Z._)((0,L._)({src:r},s),{onLoad:d}))})]})},l),{children:t||(0,a.jsx)(en.mSE,{className:i()(o,eb["popover-card-icon"])})}))};r("496115");var eC=r("767927"),ej=r("904844"),ew={};ew.styleTagTransform=S(),ew.setAttributes=_(),ew.insert=f().bind(null,"head"),ew.domAPI=g(),ew.insertStyleElement=y(),v()(ej.Z,ew);var eE=ej.Z&&ej.Z.locals?ej.Z.locals:void 0,{Text:ek}=d.ZT,eI={small:12,default:14,large:16},eT=e=>{var{avatar:t,username:r,name:n,label:o,theme:s,className:l,nameMaxWidth:c,size:u="default",renderCenterSlot:v=null}=e;return(0,a.jsxs)(d.T,{spacing:4,className:i()(eE.container,s&&eE[s],{[eE.large]:"large"===u},l),children:[(0,a.jsx)(G.Ee,{width:eI[u],height:eI[u],src:t||eC,fallback:(0,a.jsx)("img",{src:eC,width:"100%",height:"100%"}),preview:!1,className:eE.avatar}),(0,a.jsxs)(d.T,{spacing:2,children:[(0,a.jsx)(ek,{className:i()(eE.txt,eE.name),ellipsis:{showTooltip:!1,rows:1},style:"number"==typeof c?{maxWidth:c}:{},children:n}),(null==o?void 0:o.icon)?(0,a.jsx)(d.u,{showArrow:!0,content:null==o?void 0:o.name,position:"top",trigger:(null==o?void 0:o.name)?"hover":"custom",children:(0,a.jsx)("img",{src:null==o?void 0:o.icon,className:eE["label-icon"],tabIndex:-1,onMouseDown:e=>{(null==o?void 0:o.href)&&(null==e||e.preventDefault(),null==e||e.stopPropagation(),window.open(o.href,"_blank"))}})}):null]}),v,r?(0,a.jsxs)(ek,{className:i()(eE.txt,eE.username),ellipsis:{showTooltip:!1,rows:1},children:["@",r]}):null]})};r("793357"),r("441213");var eM=r("587325"),eA={};eA.styleTagTransform=S(),eA.setAttributes=_(),eA.insert=f().bind(null,"head"),eA.domAPI=g(),eA.insertStyleElement=y(),v()(eM.Z,eA),eM.Z&&eM.Z.locals&&eM.Z.locals;var eN=r("370971"),eL={};eL.styleTagTransform=S(),eL.setAttributes=_(),eL.insert=f().bind(null,"head"),eL.domAPI=g(),eL.insertStyleElement=y(),v()(eN.Z,eL),eN.Z&&eN.Z.locals&&eN.Z.locals;var eZ=r("233620"),eG={};eG.styleTagTransform=S(),eG.setAttributes=_(),eG.insert=f().bind(null,"head"),eG.domAPI=g(),eG.insertStyleElement=y(),v()(eZ.Z,eG),eZ.Z&&eZ.Z.locals&&eZ.Z.locals;var eP=((n={}).Static="static",n.Gif="gif",n);/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent);var eB=r("508540"),eR={};eR.styleTagTransform=S(),eR.setAttributes=_(),eR.insert=f().bind(null,"head"),eR.domAPI=g(),eR.insertStyleElement=y(),v()(eB.Z,eR),eB.Z&&eB.Z.locals&&eB.Z.locals,(0,eu.mk)(),r("149403");var eD=r("489566"),eF=r("416290"),eU=r("523830"),eO=r("541933"),ez=i()(eO.Z["hot-zone"],"flex items-stretch justify-center","cursor-col-resize","z-10","w-[8px] mx-[-3.5px]","bg-transparent"),eW=i()("transition-width duration-300 ease-in-out"),eH=e=>{var{className:t,hotZoneClassName:r,onMove:n,onMoveStart:o,onMoveEnd:s}=e,[l,c]=(0,T.useState)(!1),d=(0,T.useRef)({startX:0,moving:!1}),u=(0,T.useRef)({onMove:n,onMoveStart:o,onMoveEnd:s});u.current={onMove:n,onMoveStart:o,onMoveEnd:s};var v=(0,T.useCallback)(()=>{c(!1),d.current={startX:0,moving:!1},g(),u.current.onMoveEnd()},[]),m=(0,T.useCallback)(e=>{d.current.moving&&u.current.onMove(e.clientX-d.current.startX)},[]),g=()=>{window.removeEventListener("pointermove",m,!1),window.removeEventListener("pointerdown",v,!1),window.removeEventListener("pointerup",v,!1),window.removeEventListener("pointercancel",v,!1)};return(0,a.jsx)("div",{className:i()(ez,r),onMouseDown:e=>{d.current={moving:!0,startX:e.pageX},c(!0),u.current.onMoveStart(),window.addEventListener("pointermove",m,!1),window.addEventListener("pointerdown",v,!1),window.addEventListener("pointerup",v,!1),window.addEventListener("pointercancel",v,!1)},children:(0,a.jsx)("div",{className:i()(t,eO.Z.handle,l&&eO.Z["handle-moving"],eW)})})};eH.displayName="ResizableLayoutHandle";var eK=()=>({moving:!1,itemWidth:[]}),eV=e=>{var{className:t,children:r,handleClassName:n,hotZoneClassName:o}=e,[s,l]=(0,T.useState)(eK()),c=(0,T.useRef)(null),d=(0,T.useRef)([]),u=(0,eF.Z)(c);return(0,eU.Z)(()=>{if(!(null==u?void 0:u.width))return;var e=(0,eD.Z)(s.itemWidth);if(!(e<=0)){var t=u.width/e,r=s.itemWidth.map(e=>e*t);d.current.forEach((e,t)=>e.style.width="".concat(r[t],"px")),l((0,Z._)((0,L._)({},s),{itemWidth:r}))}},[null==u?void 0:u.width],{wait:20,maxWait:100}),(0,a.jsx)("div",{className:i()("flex w-full items-stretch",t,s.moving&&"cursor-col-resize select-none"),ref:c,children:T.Children.map(r,(e,t)=>{var r;return r=(0,T.isValidElement)(e)?(0,T.cloneElement)(e,Object.assign({},e.props,{ref:r=>{if(r instanceof HTMLElement)d.current[t]=r;else if(r)throw Error("children of ResizableLayout need a ref of HTMLElement");var{ref:n}=e;"function"==typeof n?n(r):n&&"object"==typeof n&&(n.current=r)}})):(0,a.jsx)("div",{ref:e=>{e&&(d.current[t]=e)},children:e}),(0,a.jsxs)(a.Fragment,{children:[t>0&&(0,a.jsx)(eH,{className:n,hotZoneClassName:o,onMoveStart:()=>{l({moving:!0,itemWidth:d.current.map(e=>{var t;return null!==(t=e.clientWidth)&&void 0!==t?t:0})})},onMove:e=>{var r=t-1;d.current[r].style.width="".concat(s.itemWidth[r]+e,"px"),d.current[t].style.width="".concat(s.itemWidth[t]-e,"px")},onMoveEnd:()=>{l({itemWidth:d.current.map(e=>{var t;return null!==(t=e.clientWidth)&&void 0!==t?t:0}),moving:!1})}}),r]})})})},eq=r("801815"),eY=r("346707"),eX=r("344879"),eJ=r("966140"),eQ=r("573026"),e$=(e,t,r)=>{if((0,eY.Z)(r))return e.toString();var n=Number(e),a=e.toString();if(Number.isNaN(n))return"".concat(e);if(0===r&&!(0,eX.Z)(Number(e))&&t)return"".concat(t);var o=a.indexOf(".");if(o<0)return a;var i=a.substring(0,o+1+r);return i.endsWith(".")&&0===r?i.substring(0,i.length-1):i},e0=(e,t,r)=>{if((0,eY.Z)(r))return e;if(0===r&&!(0,eX.Z)(e)&&t)return t;var n=Math.pow(10,r);return Math.round(e*n)/n},e1=e=>{var{value:t,onChange:r,max:n=1,min:o=0,step:s=1,disabled:l,decimalPlaces:c=0,className:u}=e,v=(0,T.useRef)(null),m=(0,eJ.Z)(v),g=(0,T.useMemo)(()=>(0,eq.x0)(),[n,o,m]),[p,f]=(0,T.useState)(!1),[h,_]=(0,T.useState)((0,eq.x0)()),x=()=>{if(!p)_((0,eq.x0)())},y=Object.is(t,-0)?0:t;return(0,T.useEffect)(()=>{x()},[p]),(0,a.jsxs)("div",{ref:v,className:i()(eQ.Z["input-slider"],u),children:[(0,a.jsx)(G.iR,{className:eQ.Z.slider,disabled:l,value:y,max:n,min:o,step:s,showBoundary:!0,onChange:e=>{"number"==typeof e&&(null==r||r(e))}},g),(0,a.jsx)(d.Rn,{onFocus:()=>f(!0),onBlur:()=>f(!1),className:eQ.Z["input-number"],value:y,disabled:l,formatter:e=>e$(e,t),onNumberChange:e=>{if(x(),0===e){null==r||r(0);return}var n=e0(e,t,c);null==r||r(n)},max:n,min:o,step:s},h)]})};r("13026"),r("592037");var e2=r("584466");function e5(e){var{once:t,teaEvent:r,children:n}=e,o=(0,D._)(e,["once","teaEvent","children"]),i=(0,T.useRef)(null),[s]=(0,e2.Z)(()=>i.current),l=(0,T.useRef)(!1);return(0,T.useEffect)(()=>{if(!!s&&(!t||!l.current))(0,ev.Gg)(r.name,r.params),l.current=!0},[s]),(0,a.jsx)("div",(0,Z._)((0,L._)({},o),{ref:i,children:n}))}var{Text:e4}=d.ZT,e7=(0,d.Q2)((0,T.forwardRef)((e,t)=>{(0,W.pc)();var r,{currentOptionalSpace:n,list:o}=(0,W.rY)((0,es.N)(e=>{var{space:t,spaceList:r}=e;return{currentOptionalSpace:t.hide_operation?void 0:t,list:r}})),i=o.filter(e=>!e.hide_operation),s=(null==n?void 0:n.id)||(null===(r=i.at(0))||void 0===r?void 0:r.id);return(0,T.useEffect)(()=>{var t;if(!!s)null===(t=e.onChange)||void 0===t||t.call(e,s)},[s]),(0,a.jsx)(d.Ph,(0,Z._)((0,L._)({},e),{ref:t,renderSelectedItem:e=>(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(d.qE,{src:e.icon_url,size:"extra-extra-small",style:{flexShrink:0},children:e.name}),(0,a.jsx)("span",{className:"ml-[6px] font-semibold",children:e.name})]}),children:i.map(e=>(0,T.createElement)(d.Ph.Option,(0,Z._)((0,L._)({value:e.id},e),{key:e.id,children:[e.icon_url?(0,a.jsx)(d.qE,{size:"extra-small",src:e.icon_url}):(0,a.jsx)(c.p5T,{}),(0,a.jsx)("div",{className:"ml-[12px] mr-16px font-semibold",children:(0,a.jsx)(e4,{ellipsis:{showTooltip:!1},style:{maxWidth:"340px"},children:e.name})}),e.space_type===ee.Sn.Team&&(0,a.jsx)(d.Vp,{color:"brand",children:l.o.t("develop_team_team")})]})))}))})),e8=(0,T.forwardRef)((e,t)=>(0,a.jsx)(e7,(0,Z._)((0,L._)({},e),{ref:t,className:"w-full",label:l.o.t("duplicate_select_workspace"),placeholder:l.o.t("select_team"),noErrorMessage:!0,rules:[{required:!0}]}))),e6=e=>"".concat(e,"(").concat(l.o.t("duplicate_rename_copy"),")"),e9={name:"name",spaceId:"spaceId"},e3=e=>{var{isSelectSpace:t,formProps:r}=e,n=(0,D._)(e,["isSelectSpace","formProps"]);return(0,a.jsx)(d.u_,(0,Z._)((0,L._)({size:"default",okText:l.o.t("Confirm"),cancelText:l.o.t("Cancel")},n),{children:(0,a.jsxs)(d.l0,(0,Z._)((0,L._)({},r),{children:[(0,a.jsx)(d.yt,{label:l.o.t("creat_project_project_name"),rules:[{required:!0}],field:e9.name,maxLength:ea.p.getInputLengthLimit("projectName"),getValueLength:ea.p.getValueLength,noErrorMessage:!0}),t?(0,a.jsx)(e8,{field:e9.spaceId}):null]}))}))}},865558:function(e,t,r){r.d(t,{v:()=>p,X:()=>g});var n=r("455069"),a=r("151064"),o=r("388993"),i=r("75117"),s=r("336205"),l=r("674343"),c=r("214942"),d=r("178385"),u=r("827331"),v=e=>{if(!!(null==e?void 0:e.icon_url))return[{url:e.icon_url||"",uid:e.icon_uri||""}]},m=e=>{var{botInfoRef:t,onBefore:r,onSuccess:m,onError:g,mode:p,showSpace:f=!1,spaceId:h,bizCreateFrom:_}=e,[x,y]=(0,n.useState)(!1),b=(0,o.G)(e=>e.botId),{space:{id:S,hide_operation:C},spaces:{bot_space_list:j}}=(0,c.rY)(),{formRef:w,isOkButtonDisable:E,checkErr:k,errMsg:I,confirmDisabled:T,setCheckErr:M,setErrMsg:A,handleFormValuesChange:N,getValues:L,resetFormState:Z}=(0,u.gx)({initialBotInfo:null==t?void 0:t.current}),{loading:G,handleCreateBot:P,handleUpdateBot:B}=(0,u.z3)({mode:p,botId:b,currentSpaceId:S,outerSpaceId:h,getValues:L,onSuccess:m,onError:g,onBefore:r,setVisible:y,setCheckErr:M,setErrMsg:A,bizCreateFrom:_,showSpace:f});(0,n.useEffect)(()=>{x&&c.rY.getState().fetchSpaces().then(e=>{var t,r,n,a,o,i,s;!(null===(n=w.current)||void 0===n?void 0:null===(r=n.formApi)||void 0===r?void 0:null===(t=r.getValues())||void 0===t?void 0:t.spaceId)&&(null===(s=w.current)||void 0===s||null===(i=s.formApi)||void 0===i||i.setValue("spaceId",C?null==e?void 0:null===(a=e.bot_space_list)||void 0===a?void 0:a[0].id:null!=S?S:null==e?void 0:null===(o=e.bot_space_list)||void 0===o?void 0:o[0].id))}),x&&Z()},[x]);var R=(null==t?void 0:t.current)||{};return{startEdit:e=>{y(!0)},modal:(0,a.jsx)(n.Fragment,{children:(0,a.jsx)(l.u_,{"data-testid":"bot.ide.bot_creator.create_bot_modal",visible:x,maskClosable:!1,onCancel:()=>{y(!1)},title:"add"===p?s.o.t("bot_list_create"):s.o.t("bot_edit_title"),okText:s.o.t("Confirm"),cancelText:s.o.t("Cancel"),okButtonProps:{disabled:E||T,loading:G},footer:null,keepDOM:!1,icon:null,onOk:()=>{"add"===p?P():B()},children:(0,a.jsx)(u.ah,{ref:w,mode:p,showSpace:f,initialValues:R,spacesList:j||[],currentSpaceId:h||S,hideOperation:C,checkErr:k,errMsg:I,onValuesChange:N,slot:(0,a.jsx)(i.s,{accept:".jpeg,.jpg,.png,.gif",label:s.o.t("bot_edit_profile_pircture"),field:"bot_uri",initValue:v(R),rules:[{required:!0}],fileBizType:d.ym.BIZ_BOT_ICON,iconType:d.Tu.Bot})})})})}},g=e=>{var{spaceId:t,onSuccess:r,showSpace:a,onBefore:o,onError:i,bizCreateFrom:s}=e;return m({spaceId:t,botInfoRef:(0,n.useRef)({visibility:0}),onBefore:o,onSuccess:r,onError:i,mode:"add",showSpace:a,bizCreateFrom:s})},p=e=>{var{botInfoRef:t,onSuccess:r}=e;return m({botInfoRef:t,onSuccess:r,mode:"update"})}},150637:function(e,t,r){r.d(t,{Nj:()=>ep});var n,a=r("808549"),o=r("151064"),i=r("455069"),s=r("336205"),l=r("674343"),c=r("825955"),d=r("537845"),u=r("735114"),v=r("458620"),m=r("297158"),g=r("382534"),p=e=>{var{fetchCustomPatList:t}=e,[r,n]=(0,i.useState)([]),a=(0,d.Z)(()=>t?t():g.f_.ListPersonalAccessTokens({})),{loading:o,run:s}=(0,u.Z)(a,{manual:!0,onSuccess:e=>{var t;n(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.personal_access_tokens),m.E7.event({eventName:v.b.openGetPatList,meta:{level:"success",action:"ListPersonalAccessTokens"}})},onError:e=>{m.E7.errorEvent({eventName:v.b.openGetPatList,error:e,meta:{action:"ListPersonalAccessTokens"}})}});return{dataSource:r,loading:o,fetchData:s}},f=()=>{var[e,t]=(0,i.useState)(),{loading:r,run:n}=(0,u.Z)(e=>g.f_.CreatePersonalAccessTokenAndPermission(e),{manual:!0,onSuccess:e=>{t(null==e?void 0:e.data),m.E7.event({eventName:v.b.openPatAction,meta:{level:"success",action:"CreatePersonalAccessTokenAndPermission"}})},onError:e=>{m.E7.errorEvent({eventName:v.b.openPatAction,error:e,meta:{action:"CreatePersonalAccessTokenAndPermission"}})}});return{runCreate:n,loading:r,successData:e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{loading:t,run:r,data:n}=(0,u.Z)(e=>g.f_.UpdatePersonalAccessTokenAndPermission(e),{manual:!0,onSuccess:()=>{var t;null==e||null===(t=e.successHandle)||void 0===t||t.call(e),m.E7.event({eventName:v.b.openPatAction,meta:{level:"success",action:"UpdatePersonalAccessTokenAndPermission"}})},onError:e=>{m.E7.errorEvent({eventName:v.b.openPatAction,error:e,meta:{action:"UpdatePersonalAccessTokenAndPermission"}})}});return{runUpdate:r,loading:t,updateSuccessData:n}},_=e=>{var t,{successHandle:r}=e,{loading:n,runAsync:a}=(0,u.Z)(e=>g.f_.DeletePersonalAccessTokenAndPermission({id:e}),{manual:!0});return{runDelete:(t=(0,c._)(function*(e){try{yield a(e),r(),m.E7.event({eventName:v.b.openPatAction,meta:{level:"success",action:"DeletePersonalAccessTokenAndPermission"}})}catch(e){m.E7.errorEvent({eventName:v.b.openPatAction,error:e,meta:{action:"DeletePersonalAccessTokenAndPermission"}})}}),function(e){return t.apply(this,arguments)}),loading:n}},x=e=>{var{patId:t}=e,[r,n]=(0,i.useState)(),{error:a,run:o}=(0,u.Z)(e=>g.f_.GetPersonalAccessTokenAndPermission({id:e}),{manual:!0,onSuccess:e=>{n(e.data),m.E7.event({eventName:v.b.openGetPatList,meta:{level:"success",action:"GetPersonalAccessTokenAndPermission"}})},onError:e=>{m.E7.errorEvent({eventName:v.b.openGetPatList,error:e,meta:{action:"GetPersonalAccessTokenAndPermission"}})}});return(0,i.useEffect)(()=>{t?o(t):n(void 0)},[t]),{patPermission:r,detailError:a}},y=e=>{var{fetchCustomPatList:t,afterCancelPermissionModal:r}=e,{loading:n,dataSource:a,fetchData:o}=p({fetchCustomPatList:t}),{runDelete:c}=_({successHandle:()=>{l.FN.success({content:s.o.t("Delete_success"),showClose:!1}),o()}}),[d,u]=(0,i.useState)(!1),[v,m]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!0),[h,x]=(0,i.useState)(),[y,b]=(0,i.useState)();return{dataSource:a,loading:n,showDataForm:d,setShowDataForm:u,isCreate:g,editInfo:h,successData:y,onAddClick:()=>{f(!0),u(!0)},createSuccessHandle:e=>{b(e),x(void 0),m(!0)},refreshHandle:()=>{o(),u(!1),x(void 0)},editHandle:e=>{x(e),f(!1),u(!0)},runDelete:c,onCancel:()=>{u(!1),x(void 0),null==r||r(g)},setIsCreate:f,showResult:v,setShowResult:m,fetchData:o}},b=r("252237"),S=r.n(b),C=r("915757"),j=r("567061"),w=e=>{var{text:t,onClick:r}=e;return(0,o.jsx)(l.ZT.Text,{className:"text-[12px] !font-normal",link:!0,onClick:()=>{null==r||r()},children:t||s.o.t("coze_api_instru")})},E=e=>{var{onClick:t}=e;return(0,o.jsxs)("div",{className:j.Z["message-frame"],children:[(0,o.jsxs)(l.T,{spacing:0,children:[(0,o.jsx)("p",{children:s.o.t("pat_reminder_1")}),(0,o.jsx)(w,{onClick:t})]}),(0,o.jsx)("p",{children:s.o.t("pat_reminder_2")}),null]})},k=e=>{var{tips:t,className:r}=e;return(0,o.jsx)(l.u,{theme:"dark",trigger:"hover",content:t,children:(0,o.jsx)("div",{className:S()("flex items-center justify-center hover:coz-mg-secondary-hovered w-[16px] h-[16px] rounded-[4px] mr-[4px] ml-[2px] text-[12px]",r),children:(0,o.jsx)(C.L03,{className:"coz-fg-secondary"})})})},I=e=>{var{openAddModal:t}=e;return(0,o.jsxs)(l.T,{vertical:!0,spacing:20,children:[(0,o.jsxs)(l.T,{className:"w-full",children:[(0,o.jsx)("h3",{className:"flex-1 m-0",children:s.o.t("auth_tab_pat")}),(0,o.jsx)(l.zx,{onClick:t,theme:"solid",type:"primary",children:s.o.t("add_new_token_button_1")})]}),(0,o.jsx)("div",{className:"w-full",children:(0,o.jsx)(E,{onClick:()=>{window.open("https://www.coze.cn/open/docs/developer_guides/coze_api_overview")}})})]})},T=r("626389"),M=r.n(T),A=r("775699"),N=r("479886"),L=r.n(N),Z=e=>{var t=L()().startOf("day");return L()(e).isBefore(t,"day")||L()(e).isSame(t,"day")};var G=((n={}).ONE="1",n.THIRTY="30",n.CUSTOMIZE="customize",n),P=()=>[{label:"1",value:"1"},{label:"30",value:"30"},{label:s.o.t("customize_key_1"),value:"customize"}].map(e=>{var{value:t}=e;if("customize"===t)return e;var r=L()().add(Number(t),"day").format("YYYY-MM-DD");return{label:s.o.t("expired_time_days_1",{num:Number(t),date:r}),value:t}}),B=e=>L()(e).add(23,"hour").add(59,"minute").add(59,"second").unix(),R=e=>-1===e?"-":L().unix(e).format("YYYY-MM-DD HH:mm:ss"),D=e=>-1===e?s.o.t("api_status_permanent_1"):L().unix(e).format("YYYY-MM-DD"),F=e=>-1===e||e>=L()().unix(),U=r("18529"),O=e=>{var t,r,{visible:n,onOk:a,data:i}=e,l=(0,d.Z)(()=>{var e=null==i?void 0:i.token;e&&c(e)}),c=(0,d.Z)(e=>{if(!M()(e))throw Error("custom error");A.FN.success({content:s.o.t("token_copied_1"),showClose:!1})});return(0,o.jsxs)(A.M5,{className:U.Z["result-frame"],title:s.o.t("new_pat_1"),visible:n,width:560,centered:!0,onOk:a,onCancel:a,okText:s.o.t("confirm"),footer:null,children:[(0,o.jsx)("p",{className:U.Z["warn-text"],children:s.o.t("new_pat_reminder_1")}),(0,o.jsx)("p",{className:U.Z["title-text"],children:s.o.t("coze_api_list1")}),(0,o.jsx)(A.ZT.Paragraph,{className:U.Z.para,ellipsis:{rows:1},children:null!==(r=null==i?void 0:null===(t=i.personal_access_token)||void 0===t?void 0:t.name)&&void 0!==r?r:"-"}),(0,o.jsx)("p",{className:U.Z["title-text"],children:s.o.t("expire_time_1")}),(0,o.jsx)(A.ZT.Paragraph,{className:U.Z.para,ellipsis:{rows:1},children:D(null==i?void 0:i.personal_access_token.expire_at)}),(0,o.jsx)("p",{className:U.Z["title-text"],children:s.o.t("token_key_1")}),(0,o.jsxs)(A.T,{spacing:4,className:U.Z.sp,children:[(0,o.jsx)(A.ZT.Paragraph,{className:U.Z["key-text"],ellipsis:{rows:1},children:null==i?void 0:i.token}),(0,o.jsx)(A.u,{content:s.o.t("Copy"),children:(0,o.jsx)(C.UtC,{className:U.Z.icon,onClick:l})})]})]})},z=r("120454"),W=(e,t)=>(0,a._)({duration_day:e},e===G.CUSTOMIZE?{expire_at:B(t)}:{}),H=e=>!!e,K=(e,t)=>!!e&&(e!==G.CUSTOMIZE||!!t)||!1,V="auth_migrate_notice_do_not_show_again",q=e=>{(0,i.useEffect)(()=>{if(!!e)!localStorage.getItem(V)&&l.u_.info({title:s.o.t("api_permissionkey_notification_title"),content:s.o.t("api_permissionkey_notification_content"),okText:s.o.t("got_it"),onOk:()=>{localStorage.setItem(V,"true")},showCancelButton:!1,closable:!1,maskClosable:!1})},[])},Y=e=>{var{editInfo:t,isCreate:r,formApi:n,getCustomParams:o,validateCustomParams:s,afterSubmit:l,isShowAuthMigrateNotice:c}=e,{patPermission:d}=x({patId:null==t?void 0:t.id}),{loading:u,runCreate:v,successData:m}=f(),{loading:g,runUpdate:p,updateSuccessData:_}=h(),[y,b]=(0,i.useState)(!0),S=()=>{var e,{name:t,duration_day:a,expire_at:o}=(null===(e=n.current)||void 0===e?void 0:e.getValues())||{},i=H(t),l=(null==s?void 0:s())!==!1,c=!r||K(a,o);b(!(i&&l&&c))};(0,i.useEffect)(()=>{var e,t,a,o;r?null===(t=n.current)||void 0===t||t.setValue("name","Secret token"):d&&(null==d?void 0:null===(e=d.personal_access_token)||void 0===e?void 0:e.name)&&(null===(o=n.current)||void 0===o||o.setValue("name",null==d?void 0:null===(a=d.personal_access_token)||void 0===a?void 0:a.name))},[d]);var C=!!r||!!d;return q(c),{isFailToValid:y,ready:C,loading:g||u,onSubmit:()=>{var e,i,{name:s="",duration_day:c,expire_at:d}=(null===(e=n.current)||void 0===e?void 0:e.getValues())||{},u=(0,a._)({name:s},(null==o?void 0:o())||{});r?v((0,a._)({},u,W(c,d))):p((0,z._)((0,a._)({},u),{id:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:""})),null==l||l((0,z._)((0,a._)({},u),{duration_day:c,expire_at:d}))},onFormValueChange:(e,t)=>{S()},patPermission:d,validateParams:S,successData:m,updateSuccessData:_}},X=r("43276"),J=e=>{var t,r,{isCreate:n,patPermission:a}=e,[c,d]=(0,i.useState)(),u=P();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.l0.Input,{trigger:["blur","change"],field:"name",label:{text:s.o.t("coze_api_list1"),required:!0},placeholder:"",maxLength:20,rules:[{required:!0,message:""}]}),(0,o.jsx)(l.l0.Slot,{label:{text:s.o.t("expire_time_1"),required:!0,extra:(0,o.jsx)(k,{tips:s.o.t("expired_time_forbidden_1")})},children:n?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:X.Z["expiration-select"],children:[(0,o.jsx)(l.l0.Select,{noLabel:!0,field:"duration_day",style:{width:"100%"},disabled:!n,optionList:u,onChange:e=>d(e),rules:[{required:!0,message:""}],placeholder:s.o.t("select_expired_time_1")}),c===G.CUSTOMIZE&&(0,o.jsx)(l.l0.DatePicker,{noLabel:!0,field:"expire_at",style:{width:"100%"},disabled:!n,disabledDate:Z,position:"bottomRight"})]})}):(0,o.jsx)(l.II,{disabled:!0,value:(null==a?void 0:null===(t=a.personal_access_token)||void 0===t?void 0:t.expire_at)?D(null==a?void 0:null===(r=a.personal_access_token)||void 0===r?void 0:r.expire_at):""})})]})},Q=r("966405"),$=(0,i.forwardRef)(function(e,t){var{editInfo:r,isCreate:n,onRefresh:a,onCreateSuccess:c,onCancel:d,children:u,onPatPermissionChange:v,onCustomFormValueChange:m,validateCustomParams:g,getCustomParams:p,afterSubmit:f,isReady:h=!0,isShowAuthMigrateNotice:_=!1}=e,x=(0,i.useRef)(),{isFailToValid:y,ready:b,loading:S,onSubmit:C,onFormValueChange:j,patPermission:w,successData:E,updateSuccessData:k,validateParams:I}=Y({editInfo:r,isCreate:n,formApi:x,validateCustomParams:g,getCustomParams:p,afterSubmit:f,isShowAuthMigrateNotice:_}),T=h&&b;return(0,i.useEffect)(()=>{E&&(l.FN.success({content:s.o.t("Create_success"),showClose:!1}),c(E),a())},[E]),(0,i.useEffect)(()=>{k&&(l.FN.success({content:s.o.t("Edit_success"),showClose:!1}),a())},[k]),(0,i.useImperativeHandle)(t,()=>({setFormValue:(e,t)=>{var r;null===(r=x.current)||void 0===r||r.setValue(e,t)},getFormValues:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.getValues()},validateParams:I}),[I]),(0,i.useEffect)(()=>{null==v||v(w)},[w]),(0,o.jsx)(l.u_,{title:n?s.o.t("add_new_pat_1"):s.o.t("edit_pat_1"),visible:!0,width:480,centered:!0,maskClosable:!1,onCancel:d,onOk:C,okButtonProps:{disabled:y||!T,loading:S},cancelText:s.o.t("cancel"),okText:s.o.t("confirm"),children:(0,o.jsx)(l.yC,{spinning:!T,children:(0,o.jsx)("div",{className:Q.Z["permission-form-content"],children:(0,o.jsxs)(l.l0,{showValidateIcon:!1,getFormApi:e=>x.current=e,onValueChange:(e,t)=>{m?m(e,t):j(e,t)},children:[(0,o.jsx)(J,{isCreate:n,patPermission:w}),u]})})})})}),ee=e=>{var[t,r]=(0,i.useState)("calc(100vh - 360px)");return(0,i.useEffect)(()=>{if(!!e.current){var t=()=>{if(e.current){var t=e.current.getBoundingClientRect().top;r("calc(100vh - ".concat(t+80,"px)"))}};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}},[e.current]),t},et=r("473980"),er=r("113258"),en=e=>{var{wrapperClassName:t,tableProps:r,size:n="default",type:i="default"}=e,s=(0,et._)(e,["wrapperClassName","tableProps","size","type"]);return(0,o.jsx)(l.iA,(0,z._)((0,a._)({},s),{wrapperClassName:S()(er.Z["table-wrap"],t),tableProps:(0,z._)((0,a._)({},r),{className:S()(er.Z["table-content"],null==r?void 0:r.className,er.Z[n],er.Z[i])})}))},ea=()=>({title:s.o.t("api_status_1"),dataIndex:"id",width:80,render:(e,t)=>{var r=F(null==t?void 0:t.expire_at);return(0,o.jsx)(l.Vp,{size:"small",color:r?"primary":"grey",children:s.o.t(r?"api_status_active_1":"api_status_expired_1")})}}),eo=r("938332"),ei=e=>{var{record:t,isCurrentUser:r,onEdit:n,onDelete:a,afterConfirmDelete:i,afterCancelDelete:c}=e,d=F(null==t?void 0:t.expire_at);return(0,o.jsxs)(l.T,{align:"center",spacing:17,children:[(0,o.jsx)(l.u,{content:r?s.o.t(d?"Edit":"not_support_edit_1"):s.o.t("org_api_pat_edit_reminder"),children:(0,o.jsx)(A.y3,{onClick:()=>n(t),className:S()(eo.Z["btn-frame"],{[eo.Z["btn-frame-disabled"]]:!d}),theme:"borderless",icon:(0,o.jsx)(C.JAz,{className:eo.Z.icon}),disabled:!d||!r})}),(0,o.jsx)(A.gn,{style:{width:400},okType:"danger",trigger:"click",onConfirm:()=>{a("".concat(null==t?void 0:t.id)),null==i||i()},onCancel:()=>{null==c||c()},content:s.o.t("remove_token_1"),title:s.o.t("remove_token_reminder_1"),children:(0,o.jsx)("div",{children:(0,o.jsx)(l.u,{content:s.o.t("Remove"),children:(0,o.jsx)(A.y3,{className:eo.Z["btn-frame"],theme:"borderless",icon:(0,o.jsx)(C.ruq,{className:eo.Z.icon})})})})})]})},es=()=>({title:s.o.t("coze_api_list5"),width:120,render:(e,t)=>null}),el=()=>({title:s.o.t("coze_api_list1"),dataIndex:"name",width:120,render:e=>(0,o.jsx)("p",{children:e})}),ec=()=>({title:s.o.t("coze_api_list4"),dataIndex:"last_used_at",render:e=>R(e)}),ed=()=>({title:s.o.t("expire_time_1"),dataIndex:"expire_at",render:e=>D(e)}),eu=()=>({title:s.o.t("coze_api_list3"),dataIndex:"created_at",render:e=>R(e)}),ev=e=>{var{onEdit:t,onDelete:r}=e;return[el(),eu(),ec(),ed(),ea(),(0,z._)((0,a._)({},es()),{render:(e,n)=>(0,o.jsx)(ei,{record:n,isCurrentUser:!0,onEdit:t,onDelete:r})})]},em=r("400895"),eg=e=>{var{loading:t,dataSource:r,onEdit:n,onDelete:a,onAddClick:l,renderDataEmptySlot:c,getCustomDataConfig:d=ev,size:u,type:v}=e,m=(0,i.useRef)(null),g=ee(m),p=null==d?void 0:d({onEdit:n,onDelete:a}).filter(e=>!e.hidden);return(0,o.jsx)("div",{className:S()("flex-1",em.Z["table-container"]),ref:m,children:(0,o.jsx)(en,{useHoverStyle:!1,size:u,type:v,tableProps:{rowKey:"id",loading:t,dataSource:r,columns:p,scroll:{y:g}},empty:(null==c?void 0:c())||(0,o.jsx)(A.YZ,{empty:{title:s.o.t("no_api_token_1"),description:s.o.t("add_api_token_1"),btnText:s.o.t("add_new_token_button_1"),btnOnClick:l}})})})},ep=e=>{var{size:t,type:r,renderTopBodySlot:n,renderDataEmptySlot:s,getCustomDataConfig:l,fetchCustomPatList:c,renderPermissionModal:d,afterCancelPermissionModal:u}=e,{onAddClick:v,loading:m,dataSource:g,editHandle:p,runDelete:f,refreshHandle:h,showDataForm:_,isCreate:x,createSuccessHandle:b,onCancel:S,successData:C,showResult:j,setShowResult:w,editInfo:E,fetchData:k}=y({fetchCustomPatList:c,afterCancelPermissionModal:u});(0,i.useEffect)(()=>{k()},[]);var T={isCreate:x,onRefresh:h,editInfo:E,onCreateSuccess:b,onCancel:S};return(0,o.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(null==n?void 0:n({openAddModal:v}))||(0,o.jsx)(I,{openAddModal:v}),(0,o.jsx)(eg,{size:t,type:r,loading:m,dataSource:g,onEdit:p,onDelete:f,onAddClick:v,renderDataEmptySlot:s,getCustomDataConfig:l}),_?(null==d?void 0:d(T))||(0,o.jsx)($,(0,a._)({},T)):null,(0,o.jsx)(O,{data:C,visible:j,onOk:()=>w(!1)})]})}},163600:function(e,t,r){r.d(t,{ti:()=>Z,y1:()=>el.y1,LY:()=>el.LY,Bj:()=>el.Bj,e_:()=>ef,gw:()=>G.g,P0:()=>el.P0,at:()=>ev,xZ:()=>em.xZ,eW:()=>eb,On:()=>ec.O,By:()=>el.By,yw:()=>P,O8:()=>ea,vq:()=>ep,Zd:()=>el.Zd,z1:()=>M,ir:()=>$,Tn:()=>j,v1:()=>N,yN:()=>el.yN,IA:()=>X.I,J2:()=>H,jN:()=>b});var n,a,o,i,s,l,c=r("808549"),d=r("120454"),u=r("947578"),v=r("297158"),m=r("336205"),g=r("298203"),p=r("286518"),f=r("382534"),h=r("889959"),_=r("674343"),x=r("552938"),y=r("76672");function b(){var e=x.K.getState(),t=y.c2.getState();return S({editable:e.editable,isPreview:e.isPreview,editLockStatus:t.editLockStatus})}var S=e=>{var{editable:t,isPreview:r,editLockStatus:n}=e;return!t||r||n===y.bo.Lose};var C=((n={}).Static="static",n.Gif="gif",n);var j=((a={})[a.Generating=1]="Generating",a[a.Success=2]="Success",a[a.Fail=3]="Fail",a[a.Cancel=4]="Cancel",a[a.None=5]="None",a),w=r("479910"),E=r("598208"),k=r("61111"),I=()=>({visible:!1,activeKey:C.Static,selectedImage:{id:"",img_info:{}},gif:{loading:!1,dotStatus:j.None,text:"",image:{id:"",img_info:{}}},image:{loading:!1,dotStatus:j.None,text:"",textCustomizable:!1}}),T=()=>({activeKey:C.Static,selectedImage:{id:"",img_info:{}},gif:{loading:!1,dotStatus:j.None,text:"",image:{id:"",img_info:{}}},image:{loading:!1,dotStatus:j.None,promptInfo:{}}}),M=(0,E.Ue)()((0,w.mW)((0,w.XR)(e=>({imageList:[],noticeList:[],generateAvatarModal:I(),generateBackGroundModal:T(),clearGenerateImageStore:()=>{e({imageList:[],noticeList:[],generateAvatarModal:I(),generateBackGroundModal:T()})},updateImageList:t=>{e(e=>(0,d._)((0,c._)({},e),{imageList:t}))},pushImageList:t=>{e(e=>(0,d._)((0,c._)({},e),{imageList:[...e.imageList,t]}))},updateNoticeList:t=>{e(e=>(0,d._)((0,c._)({},e),{notices:t}))},setGenerateAvatarModal:t=>{e({generateAvatarModal:t})},resetGenerateAvatarModal:()=>{e({generateAvatarModal:I()})},setGenerateAvatarModalByImmer:t=>e((0,k.Uy)(e=>{var{generateAvatarModal:r}=e;return t(r)})),setGenerateBackgroundModalByImmer:t=>e((0,k.Uy)(e=>{var{generateBackGroundModal:r}=e;return t(r)}))})),{enabled:!1,name:"botStudio.botDetail.botGenerateImage"})),A=r("388993"),N=new class e{createConnection(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.connection)try{this.connection=h.ZP.createConnection({biz:this.biz,service:this.service}),this.addWSEventListener()}catch(t){e&&this.createConnection(!1)}}destroy(){if(this.connection){var e,t;null===(e=this.eventListenerList)||void 0===e||e.forEach(e=>{var t,{key:r,listener:n}=e;null===(t=this.connection)||void 0===t||t.removeEventListener(r,n)}),null===(t=this.connection)||void 0===t||t.close(),this.connection=void 0}}addWSEventListener(){var e;this.eventListenerList=[{key:"message",listener:this.onSocketMessage},{key:"error",listener:this.onSocketError}],null===(e=this.eventListenerList)||void 0===e||e.forEach(e=>{var t,{key:r,listener:n}=e;null===(t=this.connection)||void 0===t||t.addEventListener(r,n)})}constructor(e,t){this.taskSet=new Set,this.onSocketMessage=e=>{var t,r=(0,g.ru)(null==e?void 0:null===(t=e.message)||void 0===t?void 0:t.payload),n=null==r?void 0:r.pic_task,a=(null==n?void 0:n.id)||"";if(this.taskSet.has(a)){v.kg.info({message:"duplicate task",meta:{taskId:a}});return}this.taskSet.add(a);var o=A.G.getState().botId||"0";if(!("0"!==o&&b())){var i=(null==n?void 0:n.bot_id)||"0";if(n&&i===o){var{generateAvatarModal:s,generateBackGroundModal:l,setGenerateAvatarModalByImmer:h,setGenerateBackgroundModalByImmer:x,pushImageList:y}=M.getState(),{gif:{dotStatus:S},image:{dotStatus:C}}=s,{gif:{dotStatus:w},image:{dotStatus:E}}=l,{status:k}=n,I=(e,t,a)=>{var o=j.None;a===j.Generating?o=k===j.Success?j.Success:j.Fail:("0"!==i&&f.pr.MarkReadNotice({bot_id:i,pic_type:n.type}),k===j.Fail?_.FN.error({content:(0,u.u)((null==r?void 0:r.err_msg)||m.o.t("profilepicture_toast_failed"))}):k===j.Success&&_.FN.success(m.o.t("profilepicture_toast_generated"))),t(t=>{t[e]=(0,d._)((0,c._)({},t[e]),{loading:!1,dotStatus:o,generateTaskId:""}),k===j.Success&&(t.selectedImage=n)}),k===j.Success&&y(n)};switch(n.type){case p.eE.IconGif:I("gif",h,S);break;case p.eE.IconStatic:I("image",h,C);break;case p.eE.BackgroundGif:I("gif",x,w);break;case p.eE.BackgroundStatic:I("image",x,E)}}}},this.onSocketError=e=>{},this.biz=e,this.service=t}}("EditorPic",0x20000cc),L=r("664319"),Z=()=>{var{editable:e,isPreview:t}=(0,x.K)((0,L.N)(e=>({editable:e.editable,isPreview:e.isPreview})));return S({editable:e,isPreview:t,editLockStatus:(0,y.c2)(e=>e.editLockStatus)})},G=r("807787");function P(e){var{setCollaborationByImmer:t}=y.c2.getState();t(t=>{var r,n,a;t.sameWithOnline=null!==(r=e.same_with_online)&&void 0!==r&&r,e.committer&&(t.commit_time=null!==(n=e.committer.commit_time)&&void 0!==n?n:"",t.committer_name=null!==(a=e.committer.name)&&void 0!==a?a:""),e.commit_version&&(t.commit_version=e.commit_version,t.baseVersion=e.commit_version),e.branch&&(t.branch=e.branch)})}var B=r("825955"),R=r("458620"),D=r("771402"),F=r("982008"),U=r("727438"),O=r("155440"),z=r("122206"),W=()=>({isOn:!1,freeCount:0,refreshCycle:1}),H=(0,E.Ue)()((0,w.mW)((e,t)=>(0,d._)((0,c._)({},W()),{setIsOn:t=>e({isOn:t}),setFreeCount:t=>e({freeCount:t}),setRefreshCycle:t=>e({refreshCycle:t}),initStore:e=>{var r,{setIsOn:n,setFreeCount:a,setRefreshCycle:o}=t();n(!!(0,O.Z)(null==e?void 0:e.is_enable)||e.is_enable),a((0,O.Z)(null==e?void 0:e.free_chat_allowance_count)?0:e.free_chat_allowance_count),o(null!==(r=null==e?void 0:e.refresh_period)&&void 0!==r?r:z.g.Never)},reset:()=>e(W())}),{enabled:!1,name:"botStudio.monetizeConfig"})),K=r("231783"),V=r("228845"),q=()=>({audit_status:1}),Y=(0,E.Ue)()((0,w.mW)((0,w.XR)((e,t)=>(0,d._)((0,c._)({},q()),{setAuditInfo:(0,V.y)(e),setAuditInfoByImmer:t=>e((0,k.Uy)(e=>t(e))),initStore:e=>{var r,{setAuditInfo:n}=t();e&&n(null!==(r=null==e?void 0:e.latest_audit_info)&&void 0!==r?r:{})},clear:()=>{e((0,c._)({},q()))}})),{enabled:!1,name:"botStudio.botDetail.auditInfo"})),X=r("342809"),J=r("179429"),Q=r("277194"),$={getStore:()=>({usePersonaStore:F.G,useQueryCollectStore:D.E,useMultiAgentStore:U.c,useModelStore:K.V7,useBotSkillStore:Q.Ee,useBotInfoStore:A.G,useCollaborationStore:y.c2,usePageRuntimeStore:x.K,useMonetizeConfigStore:H,useManuallySwitchAgentStore:X.I,useAuditInfoStore:Y,useDiffTaskStore:J.L}),clear(){F.G.getState().clear(),D.E.getState().clear(),U.c.getState().clear(),K.V7.getState().clear(),Q.Ee.getState().clear(),A.G.getState().clear(),y.c2.getState().clear(),x.K.getState().clear(),H.getState().reset(),X.I.getState().clearAgentId(),Y.getState().clear(),J.L.getState().clear()}};var ee=(o=(0,B._)(function*(e){var t,{scene:r,botId:n,customVersion:a,botInfoVersion:o}=e;if("bot"===r){var i,[s,l]=yield et({botId:n,version:null!=a?a:""});return{botData:en(null!==(i=null==s?void 0:s.data)&&void 0!==i?i:{}),monetizeConfig:null==l?void 0:l.data}}var c=yield er({botId:n,version:o});return{botData:en(null!==(t=null==c?void 0:c.data)&&void 0!==t?t:{}),monetizeConfig:void 0}}),function(e){return o.apply(this,arguments)});var et=(i=(0,B._)(function*(e){var{botId:t,version:r}=e;return yield Promise.all([f.pr.GetDraftBotInfoAgw({bot_id:t,version:r}),Promise.resolve(void 0)])}),function(e){return i.apply(this,arguments)});var er=(s=(0,B._)(function*(e){var{botId:t,version:r}=e;return yield f.pr.GetBotVersionInfo({bot_id:t,version:null!=r?r:"",scene:p.oD.BotStore})}),function(e){return s.apply(this,arguments)}),en=e=>{var t,r,n={bot_info:{}};return"bot_info"in e&&(n=e),"bot_version_info"in e&&(n={bot_info:null!==(r=null===(t=e.bot_version_info)||void 0===t?void 0:t.common_bot_info)&&void 0!==r?r:{}}),n};function ea(e){return eo.apply(this,arguments)}function eo(){return(eo=(0,B._)(function*(e){var{version:t,scene:r="bot"}=null!=e?e:{},n=(0,R.z)({eventName:R.b.botDebugGetRecord}),{botId:a,version:o}=A.G.getState(),{setPageRuntimeBotInfo:i}=x.K.getState(),{clear:s}=$;try{i({init:!1});var l=(0,R.z)({eventName:R.b.botGetDraftBotInfo});try{var{botData:c,monetizeConfig:d={}}=yield ee({scene:r,botId:a,customVersion:t,botInfoVersion:o});"bot"===r&&ei(c,t),es(c,d),l.success()}catch(e){throw s(),l.error({reason:"get new draft bot info fail",error:e instanceof Error?e:void 0}),e}n.success()}catch(e){throw n.error({reason:"init fail",error:e instanceof Error?e:void 0}),e}})).apply(this,arguments)}var ei=(e,t)=>{var{initStore:r}=x.K.getState(),{initStore:n}=y.c2.getState();r((0,d._)((0,c._)({},e),{customVersion:t})),n(e)},es=(e,t)=>{var{initStore:r}=A.G.getState(),{initStore:n}=F.G.getState(),{initStore:a}=K.V7.getState(),{initStore:o}=Q.Ee.getState(),{initStore:i}=U.c.getState(),{initStore:s}=H.getState(),{initStore:l}=D.E.getState(),{initStore:c}=Y.getState();r(e),n(e),a(e),o(e),i(e),s(t),l(e),c(e)},el=r("620398"),ec=r("549159"),ed=r("775699"),eu=e=>/{{/g.test(e),ev=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(t&&eu(e))||(ed.O$.warning({showClose:!1,content:m.o.t("bot_prompt_bracket_error")}),!1)};r("937331");var em=r("731407"),eg=r("730274");r("16771");var ep=e=>{var{setMultiAgentByImmer:t}=U.c.getState();X.I.getState().recordAgentIdOnManuallySwitchAgent(e),t(t=>{t.currentAgentID=e,t.chatModeConfig.type===eg.P3.Host&&(t.chatModeConfig.currentHostId=e)})};r("22985");var ef=()=>{var e,t,r,n,a,o,i=(0,Q.Ee)(e=>e.backgroundImageInfoList),s=!!(null==i?void 0:null===(t=i[0])||void 0===t?void 0:null===(e=t.mobile_background_image)||void 0===e?void 0:e.origin_image_url),l=null==i?void 0:null===(n=i[0])||void 0===n?void 0:null===(r=n.web_background_image)||void 0===r?void 0:r.origin_image_url;return{showBackground:s,mobileBackGround:l,pcBackground:null==i?void 0:null===(o=i[0])||void 0===o?void 0:null===(a=o.web_background_image)||void 0===a?void 0:a.origin_image_url,backgroundModeClassName:s?"!coz-fg-images-white":""}},eh=r("839974"),e_=function(e,t){var r,{notices:n=[],tasks:a=[]}=e||{},o=a.find(e=>e.type===t);return((null==o?void 0:o.status)===j.Generating||n.some(e=>e.type===t&&e.un_read))&&null!==(r=null==o?void 0:o.status)&&void 0!==r?r:j.None},ex=(e,t)=>{var r,n,a,o,i,s,l,c,d,u,v,m,g,f,{tasks:h=[]}=e,{backgroundImageInfoList:_=[]}=Q.Ee.getState(),x=null===(n=_[0])||void 0===n?void 0:null===(r=n.mobile_background_image)||void 0===r?void 0:r.origin_image_uri,y=h.filter(e=>e.type&&[p.eE.BackgroundGif].includes(e.type)),b=h.filter(e=>e.type&&[p.eE.BackgroundStatic].includes(e.type)),S=e_(e,p.eE.BackgroundStatic),w=e_(e,p.eE.BackgroundGif);t.gif.loading=y.some(e=>e.status===p.DB.Generating),t.gif.text=null!==(c=null===(i=y.find(e=>{var t;return null==e?void 0:null===(t=e.img_info)||void 0===t?void 0:t.prompt}))||void 0===i?void 0:null===(o=i.img_info)||void 0===o?void 0:null===(a=o.prompt)||void 0===a?void 0:a.ori_prompt)&&void 0!==c?c:"",t.gif.dotStatus=w;var E=y.find(e=>{var t;return null===(t=e.img_info)||void 0===t?void 0:t.ori_url});E&&(t.gif.image={img_info:{tar_uri:null===(d=E.img_info)||void 0===d?void 0:d.ori_uri,tar_url:null===(u=E.img_info)||void 0===u?void 0:u.ori_url}}),t.image.loading=b.some(e=>e.status===p.DB.Generating),t.image.dotStatus=S,t.image.promptInfo=null!==(v=null===(l=b.find(e=>{var t,r;return null==e?void 0:null===(r=e.img_info)||void 0===r?void 0:null===(t=r.prompt)||void 0===t?void 0:t.ori_prompt}))||void 0===l?void 0:null===(s=l.img_info)||void 0===s?void 0:s.prompt)&&void 0!==v?v:{};var k=null!==(m=h.find(e=>e.type===p.eE.BackgroundStatic))&&void 0!==m?m:{},I=null!==(g=h.find(e=>e.type===p.eE.BackgroundGif))&&void 0!==g?g:{};w===j.Success?t.selectedImage=I:S===j.Success?t.selectedImage=k:t.selectedImage=null!==(f=h.find(e=>{var t;return(null===(t=e.img_info)||void 0===t?void 0:t.tar_uri)===x}))&&void 0!==f?f:{},w!==j.None&&(t.activeKey=C.Gif),(w===j.Generating||S===j.Generating)&&(t.generatingTaskId=w===j.Generating?null==I?void 0:I.id:null==k?void 0:k.id)},ey=(e,t)=>{var r,n,a,o,i,s,l,c,d,u,v,m,g,f,{tasks:h=[]}=e||{},_=h.find(e=>e.type===p.eE.IconStatic)||{id:"",img_info:{}},x=h.find(e=>e.type===p.eE.IconGif)||{id:"",img_info:{}},y=e_(e,p.eE.IconGif),b=e_(e,p.eE.IconStatic);(y===j.Success||b===j.Success)&&(t.selectedImage=y===j.Success?x:_),(y===j.Generating||b===j.Generating)&&(t.generatingTaskId=y===j.Generating?null==x?void 0:x.id:null==_?void 0:_.id),t.gif={dotStatus:y,text:null!==(u=null==x?void 0:null===(n=x.img_info)||void 0===n?void 0:null===(r=n.prompt)||void 0===r?void 0:r.ori_prompt)&&void 0!==u?u:"",loading:y===j.Generating,image:{id:null!==(v=null===(a=x.img_info)||void 0===a?void 0:a.ori_uri)&&void 0!==v?v:"",img_info:{tar_uri:null!==(m=null===(o=x.img_info)||void 0===o?void 0:o.ori_uri)&&void 0!==m?m:"",tar_url:null!==(g=null===(i=x.img_info)||void 0===i?void 0:i.ori_url)&&void 0!==g?g:""}}},t.image={dotStatus:b,text:null!==(f=null===(l=_.img_info)||void 0===l?void 0:null===(s=l.prompt)||void 0===s?void 0:s.ori_prompt)&&void 0!==f?f:"",loading:b===j.Generating,textCustomizable:!!(null===(d=_.img_info)||void 0===d?void 0:null===(c=d.prompt)||void 0===c?void 0:c.ori_prompt)}};var eb=(l=(0,B._)(function*(){try{var e,{updateImageList:t,updateNoticeList:r,setGenerateAvatarModalByImmer:n,setGenerateBackgroundModalByImmer:a,clearGenerateImageStore:o}=M.getState(),{botId:i}=A.G.getState(),s=b(),l=(0,eh.L)();if(s||!l["bot.studio.gif_avater_background"])return;o();var c=yield f.pr.GetPicTask({bot_id:i}),d=null!==(e=null==c?void 0:c.data)&&void 0!==e?e:{},{tasks:u=[],notices:m=[]}=d;t(u),r(m),n(e=>{ey(d,e)}),a(e=>{ex(d,e)}),setTimeout(()=>{var{generateAvatarModal:{gif:{dotStatus:e},image:{dotStatus:t}},generateBackGroundModal:{gif:{dotStatus:r},image:{dotStatus:n}}}=M.getState();[e,t,r,n].includes(j.Generating)&&N.createConnection()},10)}catch(e){var g=e instanceof Error?e:Error(e);v.kg.error({error:g})}}),function(){return l.apply(this,arguments)})},620398:function(e,t,r){r.d(t,{Bj:()=>em,yN:()=>ex,By:()=>M.B,Zd:()=>ev,P0:()=>ep,y1:()=>es,LY:()=>eo});var n,a,o,i,s,l,c=r("825955"),d=r("808549"),u=r("120454"),v=r("473980"),m=r("558787"),g=r("311807"),p=r("278796"),f=r("962289"),h=r("584437"),_=r.n(h),x=r("345420"),y=r("64605");function b(e){return(0,y.Z)(e)}var S=(n=(0,c._)(function*(e,t){return t?yield t(e):e}),function(e,t){return n.apply(this,arguments)});var C=((a={})[a.Immediate=0]="Immediate",a[a.Medium=500]="Medium",a[a.Long=1e3]="Long",a);class j{constructor(e){var t,r=this;this.initSubscribe=()=>{var e=this.getMemoizeSelector();this.unsubscribe=this.store.subscribe(e,this.subscribeCallback)},this.getMemoizeSelector=()=>{if("function"==typeof this.config.selector)return this.config.selector;var{deps:e,transformer:t}=this.config.selector;return(0,m.P1)(e,t)},this.subscribeCallback=(t=(0,c._)(function*(e,t){if(console.log("nextState :>> ",e),console.log("prevState :>> ",t),r.nextState=e,r.prevState=t,r.lock)return;var n,a,o=_()(t,e);if(console.log("diffChange:>>",o),!!o){null===(a=r.debouncedSaveFunc)||void 0===a||null===(n=a.cancel)||void 0===n||n.call(a),r.diff=o;var i=r.getTriggerDelayTime(t,o);if(console.log("delayTime:>>>>>",i),0===i||r.config.immediate){yield r.parsedSaveFunc();return}r.debouncedSaveFunc=(0,g.Z)(r.parsedSaveFunc,i),yield r.debouncedSaveFunc()}}),function(e,r){return t.apply(this,arguments)}),this.parsedSaveFunc=(0,c._)(function*(){var e,t,n,a=yield S(r.nextState,null===(i=r.config)||void 0===i?void 0:null===(o=i.middleware)||void 0===o?void 0:o.onBeforeSave);yield null===(c=r.config)||void 0===c?void 0:null===(l=c.eventCallBacks)||void 0===l?void 0:null===(s=l.onBeforeSave)||void 0===s?void 0:s.call(l,{key:r.config.key,data:a}),console.log("beforeSavePayload:>>",a);try{yield r.config.saveRequest(a,r.config.key,r.diff);var o,i,s,l,c,d,u,v,m,g,p=yield S(r.nextState,null===(u=r.config)||void 0===u?void 0:null===(d=u.middleware)||void 0===d?void 0:d.onAfterSave);console.log("afterSavePayload:>>",p),yield null===(g=r.config)||void 0===g?void 0:null===(m=g.eventCallBacks)||void 0===m?void 0:null===(v=m.onAfterSave)||void 0===v?void 0:v.call(m,{key:r.config.key,data:p})}catch(a){console.log("error:>>",a),null===(n=r.config)||void 0===n||null===(t=n.eventCallBacks)||void 0===t||null===(e=t.onError)||void 0===e||e.call(t,{key:r.config.key,error:a})}}),this.close=()=>{var e,t;null===(e=this.debouncedSaveFunc)||void 0===e||e.flush(),this.unsubscribe(),null===(t=this.unobserver)||void 0===t||t.call(this)},this.getTriggerDelayTime=(e,t)=>{var r=this.config.debounce;if(!r)return C.Immediate;if(l=r,(0,x.Z)(l))return r();if(c=r,!(0,y.Z)(c))return r;if(!t||0===t.length)return r.default;var n=[];for(var a of t){var o=a.path,i=this.getdebouncePath(o);if(!o||!(0,p.Z)(e,o)||"number"==typeof i){n.push(r.default);continue}var s=(0,f.Z)(r,i,r.default);if(d=s,!(0,y.Z)(d)){n.push(s);continue}if(!s.arrayType){n.push(r.default);continue}if(u=s.action,(0,y.Z)(u)){var l,c,d,u,v,m,g="A"===a.kind&&(null===(v=a.item)||void 0===v?void 0:v.kind)?null===(m=a.item)||void 0===m?void 0:m.kind:a.kind,h=s.action[g];n.push(h)}else n.push(s.action)}return Math.min(...n)},this.getdebouncePath=e=>e?e.some(e=>"number"==typeof e)?e[0]:e.join("."):"";var{store:n}=e,a=(0,v._)(e,["store"]);this.store=n,this.lock=!1,this.config=a,this.initSubscribe()}}class w{constructor(e){var t,r,n=this;this.register=e=>{this.close(),this.configList=[],e.forEach(e=>{var t=(0,u._)((0,d._)({},e),{eventCallBacks:this.eventCallBacks,saveRequest:this.saveRequest});this.configList.push(t)})},this.start=()=>{if(!(this.observerList.length>0))this.observerList=this.configList.map(e=>new j((0,d._)({store:this.store},e)))},this.close=()=>{this.observerList.forEach(e=>e.close()),this.observerList=[]},this.manualSave=(t=(0,c._)(function*(e,t){var r,a,o=n.getConfig(e);if(!!o){var{middleware:i,eventCallBacks:s,saveRequest:l}=o,c=(null==i?void 0:i.onBeforeSave)?yield null==i?void 0:i.onBeforeSave(t):t;null==s||null===(r=s.onBeforeSave)||void 0===r||r.call(s,c),yield l(c,e,[]);var d=(null==i?void 0:i.onAfterSave)?yield null==i?void 0:i.onAfterSave(t):t;null==s||null===(a=s.onAfterSave)||void 0===a||a.call(s,d)}}),function(e,r){return t.apply(this,arguments)}),this.handleWithoutAutosave=(r=(0,c._)(function*(e){var{key:t,handler:r}=e,a=n.observerList.filter(e=>e.config.key===t);a.length&&(a.forEach(e=>e.lock=!0),yield r(),a.forEach(e=>e.lock=!1))}),function(e){return r.apply(this,arguments)}),this.saveFlush=e=>{var t,r,n=this.getObserver(e);null==n||null===(r=n.debouncedSaveFunc)||void 0===r||null===(t=r.flush)||void 0===t||t.call(r)},this.saveFlushAll=()=>{this.observerList.forEach(e=>{var t,r;return null==e?void 0:null===(r=e.debouncedSaveFunc)||void 0===r?void 0:null===(t=r.flush)||void 0===t?void 0:t.call(r)})},this.getObserver=e=>this.observerList.find(t=>t.config.key===e),this.getConfig=e=>this.configList.find(t=>t.key===e),this.configList=[],this.observerList=[],this.saveRequest=e.saveRequest,this.eventCallBacks=e.eventCallBacks,this.store=e.store,this.register(e.registers)}}var E=r("982008"),k=r("382534"),I=r("937331"),T=r("388993"),M=r("343713");var A=(o=(0,c._)(function*(e,t){var{botId:r}=T.G.getState();yield(0,M.t)((0,c._)(function*(){return yield k.pr.UpdateDraftBotInfoAgw({bot_info:(0,d._)({bot_id:r},e),base_commit_version:I.tO.baseVersion})}),t)}),function(e,t){return o.apply(this,arguments)}),N=r("178385"),L={key:N.qG.SYSTEMINFO,selector:e=>e.systemMessage,debounce:()=>{var{systemMessage:e}=E.G.getState(),{isOptimize:t}=e;return(console.log("systemMessage:>>",e),console.log("isOptimize:>>",t),t)?C.Immediate:C.Long},middleware:{onBeforeSave:e=>({prompt_info:E.G.getState().transformVo2Dto(e)})}},Z=new w({store:E.G,registers:[L],saveRequest:A}),G=r("231783"),P={key:N.qG.OTHERINFO,selector:e=>e.config,debounce:{default:C.Immediate,temperature:C.Medium,max_tokens:C.Medium,"ShortMemPolicy.HistoryRound":C.Medium},middleware:{onBeforeSave:e=>({model_info:G.V7.getState().transformVo2Dto(e)})}},B=new w({store:G.V7,registers:[P],saveRequest:A}),R=r("277194"),D=r("335740"),F=r("633697"),U={key:N.qG.WORKFLOW,selector:e=>e.workflows,debounce:C.Immediate,middleware:{onBeforeSave:e=>{var t=(0,D.Z)(e),r=(0,F.Z)(t,"workflow_id").map(e=>(e.plugin_icon="",e));return{workflow_info_list:R.Ee.getState().transformVo2Dto.workflow(r)}}}},O=r("871873"),z=r("425088"),W={key:N.qG.PROFILEMEMORY,selector:e=>({voicesInfo:e.voicesInfo,tts:e.tts}),debounce:C.Immediate,middleware:{onBeforeSave:e=>({voices_info:(0,O.Z)({},z.g.tts(e.tts),z.g.voicesInfo(e.voicesInfo))})}},H=r("458620"),K=r("727914"),V=r("549159"),q=r("807787"),Y=r("552938"),X={key:N.qG.PROFILEMEMORY,selector:e=>e.variables,debounce:C.Immediate,middleware:{onBeforeSave:e=>{var{editable:t}=Y.K.getState();if(!(0,V.O)(e).filter(e=>((null==e?void 0:e.errType)||q.g.KEY_CHECK_PASS)>q.g.KEY_CHECK_PASS).length&&t)return{variable_list:R.Ee.getState().transformVo2Dto.variables(e)};throw new K.sH(H.b.parmasValidation,"botSkill.variables return nothing")}}},J={key:N.qG.TASK,selector:e=>e.taskInfo.user_task_allowed,debounce:C.Immediate,middleware:{onBeforeSave:e=>({task_info:R.Ee.getState().transformVo2Dto.task({user_task_allowed:e})})}},Q={key:N.qG.SUGGESTREPLY,selector:e=>e.suggestionConfig,debounce:{default:C.Immediate,customized_suggest_prompt:C.Long},middleware:{onBeforeSave:e=>({suggest_reply_info:R.Ee.getState().transformVo2Dto.suggestionConfig(e)})}},$={key:N.qG.APIINFO,selector:e=>e.pluginApis,debounce:C.Immediate,middleware:{onBeforeSave:e=>{var t=(0,D.Z)(e).map(e=>(delete e.autoAddCss,e));return{plugin_info_list:R.Ee.getState().transformVo2Dto.plugin(t)}}}},ee={key:N.qG.ONBOARDING,selector:{deps:[e=>e.onboardingContent],transformer:e=>R.Ee.getState().transformVo2Dto.onboarding(e)},debounce:{default:C.Immediate,prologue:C.Long,suggested_questions:{arrayType:!0,action:{N:C.Immediate,D:C.Immediate,E:C.Long}}},middleware:{onBeforeSave:e=>({onboarding_info:e})}};var et=((i={})[i.MultiAgent=1024]="MultiAgent",i[i.TTS=1025]="TTS",i[i.ConnectorType=1026]="ConnectorType",i[i.ChatBackGround=1027]="ChatBackGround",i[i.Shortcut=1028]="Shortcut",i[i.QueryCollect=1029]="QueryCollect",i[i.LayoutInfo=1030]="LayoutInfo",i[i.TaskInfo=1031]="TaskInfo",i[i.TimeCapsule=1032]="TimeCapsule",i),er={key:et.LayoutInfo,selector:e=>e.layoutInfo,debounce:C.Immediate,middleware:{onBeforeSave:e=>({layout_info:R.Ee.getState().transformVo2Dto.layoutInfo(e)})}},en={key:N.qG.DataSet,selector:e=>e.knowledge,debounce:{default:C.Immediate,"dataSetInfo.min_score":C.Medium,"dataSetInfo.top_k":C.Medium},middleware:{onBeforeSave:e=>({knowledge:R.Ee.getState().transformVo2Dto.knowledge(e)})}},ea={key:et.ChatBackGround,selector:e=>e.backgroundImageInfoList,debounce:C.Immediate,middleware:{onBeforeSave:e=>({background_image_info_list:e})}},eo=new w({store:R.Ee,registers:[$,ea,ee,en,er,Q,J,X,U,W],saveRequest:A}),ei=[Z,eo,B],es={start:()=>{console.log("start:>>"),ei.forEach(e=>{e.start()})},close:()=>{console.log("close:>>"),ei.forEach(e=>{e.close()})}},el=r("214942"),ec=r("714850"),ed={key:et.MultiAgent,selector:e=>{var t;return null===(t=e.agents)||void 0===t?void 0:t[0]},debounce:{default:C.Immediate,description:C.Long,"position.x":C.Medium,"position.y":C.Medium,"skills.knowledge.dataSetInfo.min_score":C.Medium,"skills.knowledge.dataSetInfo.top_k":C.Medium,"skills.knowledge.dataSetInfo.no_recall_reply_customize_prompt":C.Long,"model.temperature":C.Medium,"model.max_tokens":C.Medium,"model.top_p":C.Medium,"model.ShortMemPolicy.HistoryRound":C.Medium,prompt:C.Long,"suggestion.customized_suggest_prompt":C.Long,intents:{arrayType:!0,action:{E:C.Long}}}};var eu=(s=(0,c._)(function*(e){return yield(0,M.t)(()=>{var t=ec.c.getState().transformVo2Dto.agent(e);return k.pr.UpdateAgentV2((0,u._)((0,d._)({},t),{id:e.id,bot_id:T.G.getState().botId,space_id:el.rY.getState().getSpaceId(),base_commit_version:I.tO.baseVersion}))},et.MultiAgent)}),function(e){return s.apply(this,arguments)}),ev=new w({store:ec.c,registers:[ed],saveRequest:eu});function em(){return eg.apply(this,arguments)}function eg(){return(eg=(0,c._)(function*(){var{databaseList:e}=R.Ee.getState();return yield(0,M.t)(()=>(0,M.B)({database_list:R.Ee.getState().transformVo2Dto.databaseList(e)}),N.qG.TABLE)})).apply(this,arguments)}r("16771");var ep=(l=(0,c._)(function*(e){return yield(0,M.t)(()=>(0,M.B)({shortcut_sort:e}),et.Shortcut)}),function(e){return l.apply(this,arguments)}),ef=r("532267"),eh=r("771402"),e_=r("727438"),ex=()=>{var{mode:e}=T.G.getState(),t=R.Ee.getState(),r=e_.c.getState(),n=G.V7.getState(),a=E.G.getState(),o=eh.E.getState(),i=e===ef.J4.MultiMode,{knowledge:s,variables:l,workflows:c,taskInfo:d,suggestionConfig:u,onboardingContent:v,pluginApis:m,backgroundImageInfoList:g,shortcut:p,tts:f,timeCapsule:h,filebox:_,devHooks:x,voicesInfo:y}=t,{agents:b}=r,S=(0,H.z)({eventName:H.b.botDebugSaveAll});try{var C={prompt_info:a.transformVo2Dto(a.systemMessage),model_info:n.transformVo2Dto(n.config),plugin_info_list:i?void 0:t.transformVo2Dto.plugin(m),workflow_info_list:i?void 0:t.transformVo2Dto.workflow(c),knowledge:i?void 0:t.transformVo2Dto.knowledge(s),variable_list:t.transformVo2Dto.variables(l),task_info:t.transformVo2Dto.task(d),suggest_reply_info:t.transformVo2Dto.suggestionConfig(u),onboarding_info:t.transformVo2Dto.onboarding(v),background_image_info_list:g,shortcut_sort:t.transformVo2Dto.shortcut(p),voices_info:(0,O.Z)({},t.transformVo2Dto.tts(f),t.transformVo2Dto.voicesInfo(y)),bot_tag_info:t.transformVo2Dto.timeCapsule(h),filebox_info:t.transformVo2Dto.filebox(_),hook_info:i?void 0:x,user_query_collect_conf:o.transformVo2Dto(o),agents:i?b.map(e=>r.transformVo2Dto.agent(e)):void 0};return S.success(),{botSkillInfo:C}}catch(e){return S.error({reason:"bot debug save all fail",error:e instanceof Error?e:void 0}),{}}}},16771:function(e,t,r){r(214942),r(382534),r(937331),r(727438),r(388993),r(343713)},343713:function(e,t,r){r.d(t,{B:function(){return h},t:function(){return p}});var n=r(825955),a=r(808549),o=r(479886),i=r.n(o),s=r(458620),l=r(297158),c=r(227733),d=r(382534),u=r(388993),v=r(937331),m=r(552938),g=r(76672);function p(e,t){return f.apply(this,arguments)}function f(){return(f=(0,n._)(function*(e,t){var{editable:r,isPreview:n,pageFrom:a,init:o,setPageRuntimeByImmer:d}=m.K.getState(),{setCollaborationByImmer:u}=g.c2.getState();if(!!r&&!n&&a!==c.J.Explore&&!!o)try{d(e=>{e.savingInfo.saving=!0,e.savingInfo.scopeKey=t?String(t):""});var v=yield e();d(e=>{e.savingInfo={saving:!1,time:i()().format("HH:mm:ss")}}),v&&(d(e=>{var t;e.hasUnpublishChange=null!==(t=v.data.has_change)&&void 0!==t&&t}),u(e=>{var t;e.sameWithOnline=null!==(t=v.data.same_with_online)&&void 0!==t&&t,e.branch&&v.data.branch&&(e.branch=v.data.branch)})),l.E7.successEvent({eventName:s.b.AutosaveSuccess,meta:{itemType:t}})}catch(e){l.E7.errorEvent({eventName:s.b.AutosaveError,error:e,meta:{itemType:t}})}})).apply(this,arguments)}function h(e){var{botId:t}=u.G.getState();return d.pr.UpdateDraftBotInfoAgw({bot_info:(0,a._)({bot_id:t},e),base_commit_version:v.tO.baseVersion})}},388993:function(e,t,r){r.d(t,{G:function(){return v}});var n=r(808549),a=r(120454),o=r(479910),i=r(598208),s=r(61111),l=r(532267),c=r(178385),d=r(228845),u=()=>({botId:"",mode:l.J4.SingleMode,botMarketStatus:c.zC.Offline,name:"",description:"",icon_uri:"",icon_url:"",create_time:"",creator_id:"",update_time:"",connector_id:"",publisher:{},has_publish:!1,connectors:[],publish_time:"",space_id:"",version:"",raw:{}}),v=(0,i.Ue)()((0,o.mW)((0,o.XR)((e,t)=>(0,a._)((0,n._)({},u()),{setBotInfo:(0,d.y)(e),setBotInfoByImmer:t=>e((0,s.Uy)(e=>t(e))),transformVo2Dto:e=>{var t,r,n,a,o,i,s,d,u,v,m,g,p,f,h,_,x,y,b,S=null!==(t=e.bot_info)&&void 0!==t?t:{};return{botId:null!==(r=null==S?void 0:S.bot_id)&&void 0!==r?r:"",mode:null!==(n=null==S?void 0:S.bot_mode)&&void 0!==n?n:l.J4.SingleMode,botMarketStatus:null!==(a=e.bot_market_status)&&void 0!==a?a:c.zC.Offline,name:null!==(o=S.name)&&void 0!==o?o:"",description:null!==(i=S.description)&&void 0!==i?i:"",icon_uri:null!==(s=S.icon_uri)&&void 0!==s?s:"",icon_url:null!==(d=S.icon_url)&&void 0!==d?d:"",create_time:null!==(u=S.create_time)&&void 0!==u?u:"",creator_id:null!==(v=S.creator_id)&&void 0!==v?v:"",update_time:null!==(m=S.update_time)&&void 0!==m?m:"",connector_id:null!==(g=S.connector_id)&&void 0!==g?g:"",version:null!==(p=S.version)&&void 0!==p?p:"",publisher:null!==(f=e.publisher)&&void 0!==f?f:{},has_publish:null!==(h=e.has_publish)&&void 0!==h&&h,connectors:null!==(_=e.connectors)&&void 0!==_?_:[],publish_time:null!==(x=e.publish_time)&&void 0!==x?x:"",space_id:null!==(y=e.space_id)&&void 0!==y?y:"",businessType:S.business_type,appId:null!==(b=e.app_id)&&void 0!==b?b:"",raw:S}},initStore:r=>{var{transformVo2Dto:n}=t();e(n(r))},clear:()=>{e((0,n._)({},u()))}})),{enabled:!1,name:"botStudio.botDetail.botInfo"}))},334595:function(e,t,r){r.d(t,{Ky:function(){return s},PV:function(){return c},Rf:function(){return h},TA:function(){return u},X4:function(){return p},X_:function(){return l},dR:function(){return m},l4:function(){return g},u$:function(){return f},vY:function(){return v},wC:function(){return d}});var n=r(336205),a=r(33630),o=r(178385),i=r(532267),s=()=>({top_k:3,min_score:.5,auto:!0,search_strategy:0,show_source:!1}),l=()=>({suggest_reply_mode:o.nx.UseOriginBotMode,customized_suggest_prompt:""}),c=()=>n.o.t("bot_suggestion_customize_default_seed"),d=()=>({prologue:"",suggested_questions:[],suggested_questions_show_mode:i.y3.Random}),u=()=>({suggest_reply_mode:o.nx.WithDefaultPrompt,customized_suggest_prompt:""}),v=()=>[],m=()=>({tableId:"",name:"",desc:"",icon_uri:"",readAndWriteMode:a.mx.LimitedReadWrite,tableMemoryList:[]}),g=()=>({muted:!1,close_voice_call:!1,i18n_lang_voice:{},autoplay:!1,autoplay_voice:{},tag_list:[],debugVoice:[],i18n_lang_voice_str:{}}),p=()=>({time_capsule_mode:0,disable_prompt_calling:0,time_capsule_time_to_live:"0"}),f=()=>({shortcut_list:[],shortcut_sort:[]}),h=()=>({defaultUserInputType:void 0})},277194:function(e,t,r){r.d(t,{Ee:()=>f,PV:()=>g.PV});var n=r("808549"),a=r("120454"),o=r("479910"),i=r("598208"),s=r("345420"),l=r("61111"),c=r("532267"),d=r("58118"),u=r("228845"),v=r("763109"),m=r("425088"),g=r("334595"),p=()=>({pluginApis:[],workflows:[],knowledge:{dataSetList:[],dataSetInfo:(0,g.Ky)()},taskInfo:{user_task_allowed:!1,data:[],task_list:[],loading:!1},variables:[],database:(0,g.dR)(),databaseList:[],onboardingContent:(0,g.wC)(),suggestionConfig:(0,g.TA)(),tts:(0,g.l4)(),voicesInfo:(0,g.Rf)(),timeCapsule:(0,g.X4)(),filebox:{mode:c.mZ.Off},backgroundImageInfoList:(0,g.vY)(),shortcut:(0,g.u$)(),layoutInfo:{},devHooks:{}}),f=(0,i.Ue)()((0,o.mW)((0,o.XR)((e,t)=>(0,a._)((0,n._)({},p()),{setBotSkill:(0,u.y)(e),setBotSkillByImmer:t=>e((0,l.Uy)(e=>t(e))),updateSkillPluginApis:t=>{e(e=>(0,a._)((0,n._)({},e),{pluginApis:(0,v.n)(t)}))},updateSkillWorkflows:t=>e(e=>(0,a._)((0,n._)({},e),{workflows:t})),updateSkillKnowledgeDatasetList:t=>e((0,l.Uy)(e=>{e.knowledge.dataSetList=t})),updateSkillKnowledgeDatasetInfo:t=>e((0,l.Uy)(e=>{e.knowledge.dataSetInfo=t})),updateSkillTaskInfo:t=>e(e=>(0,a._)((0,n._)({},e),{taskInfo:(0,n._)({},e.taskInfo,t)})),updateSkillDatabase:t=>e(e=>(0,a._)((0,n._)({},e),{database:(0,n._)({},e.database,t)})),updateSkillDatabaseList:t=>e((0,l.Uy)(e=>{e.databaseList=t})),updateSkillOnboarding:t=>e(e=>(0,a._)((0,n._)({},e),{onboardingContent:(0,n._)({},e.onboardingContent,(0,s.Z)(t)?t(e.onboardingContent):t)})),updateSkillLayoutInfo:t=>{e(e=>(0,a._)((0,n._)({},e),{layoutInfo:t}))},setSuggestionConfig:t=>e(e=>(0,a._)((0,n._)({},e),{suggestionConfig:(0,n._)({},e.suggestionConfig,t)})),setBackgroundImageInfoList:t=>e(e=>(0,a._)((0,n._)({},e),{backgroundImageInfoList:[...t]})),setDefaultUserInputType:t=>e(e=>(0,l.Uy)(e,e=>{e.voicesInfo.defaultUserInputType=t}),!1,"setDefaultUserInputType"),transformDto2Vo:m.f,transformVo2Dto:m.g,initStore:t=>{var r,n,a,{bot_info:o,bot_option_data:i}=t;e({pluginApis:m.f.plugin(null==o?void 0:o.plugin_info_list,null==i?void 0:i.plugin_detail_map,null==i?void 0:i.plugin_api_detail_map),workflows:m.f.workflow(null==o?void 0:o.workflow_info_list,null==i?void 0:i.workflow_detail_map),knowledge:m.f.knowledge(null==o?void 0:o.knowledge,null==i?void 0:i.knowledge_detail_map),taskInfo:m.f.task(null==o?void 0:o.task_info),variables:m.f.variables(null==o?void 0:o.variable_list),databaseList:m.f.databaseList(null==o?void 0:o.database_list),timeCapsule:m.f.timeCapsule(null==o?void 0:null===(r=o.bot_tag_info)||void 0===r?void 0:r.time_capsule_info),filebox:m.f.filebox(null==o?void 0:o.filebox_info),onboardingContent:d.p.sliceWorkInfoOnboardingByMaxLength(m.f.onboarding(null==o?void 0:o.onboarding_info)),suggestionConfig:m.f.suggestionConfig(null==o?void 0:o.suggest_reply_info),tts:m.f.tts(null==o?void 0:o.voices_info),voicesInfo:m.f.voicesInfo(o.voices_info),backgroundImageInfoList:null!==(n=null==o?void 0:o.background_image_info_list)&&void 0!==n?n:[],shortcut:m.f.shortcut(null!==(a=null==o?void 0:o.shortcut_sort)&&void 0!==a?a:[],null==i?void 0:i.shortcut_command_list),devHooks:m.f.hookInfo(null==o?void 0:o.hook_info),layoutInfo:m.f.layoutInfo(null==o?void 0:o.layout_info)})},clear:()=>{e((0,n._)({},p()))}})),{enabled:!1,name:"botStudio.botDetail.botSkill"}))},425088:function(e,t,r){r.d(t,{f:function(){return v},g:function(){return m}});var n=r(808549),a=r(120454),o=r(801815),i=r(550655),s=r(25733),l=r(33630),c=r(730274),d=r(178385),u=r(334595),v={plugin:(e,t,r)=>{var o,i;return null!==(i=null==e?void 0:null===(o=e.filter(e=>e.plugin_id&&e.api_id&&(null==t?void 0:t[e.plugin_id])))||void 0===o?void 0:o.map(e=>{var o,i=null==t?void 0:t[e.plugin_id],s=null==r?void 0:r[e.api_id];return{plugin_icon:null==i?void 0:i.icon_url,name:null==s?void 0:s.name,desc:null==s?void 0:s.description,plugin_id:e.plugin_id,plugin_name:null==i?void 0:i.name,api_id:e.api_id,parameters:(null==s?void 0:null===(o=s.parameters)||void 0===o?void 0:o.map(e=>(0,a._)((0,n._)({},e),{desc:e.description,required:e.is_required})))||[],is_official:null==i?void 0:i.is_official,plugin_type:null==i?void 0:i.plugin_type,status:null==i?void 0:i.plugin_status,plugin_from:null==i?void 0:i.plugin_from}}))&&void 0!==i?i:[]},workflow:(e,t)=>{var r,o;return null!==(o=null==e?void 0:null===(r=e.filter(e=>e.workflow_id&&(null==t?void 0:t[e.workflow_id])))||void 0===r?void 0:r.map(e=>{var r,o,i,s,l,c,d,u=null==t?void 0:t[e.workflow_id];return{workflow_id:null!==(i=null==u?void 0:u.id)&&void 0!==i?i:"",plugin_id:null!==(s=null==u?void 0:u.plugin_id)&&void 0!==s?s:"",name:null!==(l=null==u?void 0:u.name)&&void 0!==l?l:"",desc:null!==(c=null==u?void 0:u.description)&&void 0!==c?c:"",plugin_icon:null!==(d=null==u?void 0:u.icon_url)&&void 0!==d?d:"",flow_mode:null==e?void 0:e.flow_mode,parameters:(null==u?void 0:null===(o=u.api_detail)||void 0===o?void 0:null===(r=o.parameters)||void 0===r?void 0:r.map(e=>(0,a._)((0,n._)({},e),{desc:e.description,required:e.is_required})))||[]}}))&&void 0!==o?o:[]},knowledge:(e,t)=>{var r,n,a,o,i;if(!e)return{dataSetList:[],dataSetInfo:(0,u.Ky)()};return{dataSetList:null!==(a=null==e?void 0:null===(n=e.knowledge_info)||void 0===n?void 0:null===(r=n.filter(e=>e.id&&(null==t?void 0:t[e.id])))||void 0===r?void 0:r.map(e=>{var r=null==t?void 0:t[e.id];return{id:null==r?void 0:r.id,name:null==r?void 0:r.name,avatar_url:null==r?void 0:r.icon_url,icon_url:null==r?void 0:r.icon_url,dataset_id:null==r?void 0:r.id}}))&&void 0!==a?a:[],dataSetInfo:{min_score:null!==(o=null==e?void 0:e.min_score)&&void 0!==o?o:0,top_k:Number(null!==(i=null==e?void 0:e.top_k)&&void 0!==i?i:0),auto:!!(null==e?void 0:e.auto),search_strategy:null==e?void 0:e.search_strategy,no_recall_reply_mode:null==e?void 0:e.no_recall_reply_mode,no_recall_reply_customize_prompt:null==e?void 0:e.no_recall_reply_customize_prompt,show_source:null==e?void 0:e.show_source,show_source_mode:null==e?void 0:e.show_source_mode,recall_strategy:e.recall_strategy}}},task:e=>({user_task_allowed:!!(null==e?void 0:e.user_task_allowed),task_list:[],loading:!1,data:[]}),variables:e=>{var t;return null!==(t=null==e?void 0:e.map(e=>{var t;return{id:(0,o.x0)(),key:null!==(t=e.key)&&void 0!==t?t:"",description:e.description,default_value:e.default_value,is_system:!!e.is_system,prompt_disabled:!!e.prompt_disabled,is_disabled:!!e.is_disabled}}))&&void 0!==t?t:[]},databaseList:e=>{var t=[];return Array.isArray(e)&&e.forEach(e=>{var r,i;(null==e?void 0:e.table_id)&&(null===(r=e.field_list)||void 0===r?void 0:r.length)&&t.push({tableId:e.table_id,name:e.table_name,desc:e.table_desc,extra_info:{prompt_disabled:String(e.prompt_disabled)},readAndWriteMode:e.rw_mode||l.mx.LimitedReadWrite,tableMemoryList:null===(i=e.field_list)||void 0===i?void 0:i.map(e=>(0,a._)((0,n._)({},e),{nanoid:(0,o.x0)(),id:Number(e.id)}))})}),t},timeCapsule:e=>{var t,r,n;return{time_capsule_mode:null!==(t=null==e?void 0:e.time_capsule_mode)&&void 0!==t?t:c.o_.Off,disable_prompt_calling:null!==(r=null==e?void 0:e.disable_prompt_calling)&&void 0!==r?r:c.kE.Off,time_capsule_time_to_live:null!==(n=null==e?void 0:e.time_capsule_time_to_live)&&void 0!==n?n:"0"}},filebox:e=>{var t;return{mode:null!==(t=null==e?void 0:e.Mode)&&void 0!==t?t:c.mZ.Off}},onboarding:e=>{var t,r,n,a;return{prologue:null!==(r=null==e?void 0:e.prologue)&&void 0!==r?r:"",suggested_questions_show_mode:null!==(n=null==e?void 0:e.suggested_questions_show_mode)&&void 0!==n?n:c.y3.Random,suggested_questions:null!==(a=null==e?void 0:null===(t=e.suggested_questions)||void 0===t?void 0:t.map(e=>({id:e,content:e})))&&void 0!==a?a:[]}},suggestionConfig:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?(0,u.X_)():(0,u.TA)(),n=(0,i.Z)(null==e?void 0:e.suggest_reply_mode)?{suggest_reply_mode:null==e?void 0:e.suggest_reply_mode,customized_suggest_prompt:null==e?void 0:e.customized_suggest_prompt}:r;return!n.customized_suggest_prompt&&n.suggest_reply_mode===d.nx.WithCustomizedPrompt&&(n.customized_suggest_prompt=(0,u.PV)()),n},tts:e=>{if(!e||"object"!=typeof e||!("muted"in e&&"i18n_lang_voice"in e))return(0,u.l4)();var t,r=e=>e&&"object"==typeof e?e:{};return{muted:!!e.muted,close_voice_call:!!e.voice_call,i18n_lang_voice:r(null==e?void 0:e.i18n_lang_voice),i18n_lang_voice_str:null!==(t=e.i18n_lang_voice_str)&&void 0!==t?t:{},autoplay:!!e.autoplay,autoplay_voice:r(null==e?void 0:e.autoplay_voice),debugVoice:[]}},voicesInfo:e=>({defaultUserInputType:null==e?void 0:e.default_user_input_type}),shortcut:(e,t)=>({shortcut_sort:e,shortcut_list:t}),hookInfo:e=>e,layoutInfo:e=>({workflow_id:null==e?void 0:e.workflow_id,plugin_id:null==e?void 0:e.plugin_id})},m={plugin:e=>e.map(e=>({api_id:e.api_id,plugin_id:e.plugin_id,api_name:e.name,plugin_from:e.plugin_from})),workflow:e=>e.map(e=>({workflow_id:e.workflow_id,plugin_id:e.plugin_id,flow_mode:e.flow_mode,workflow_name:e.name})),knowledge:e=>(0,a._)((0,n._)({},e.dataSetInfo),{knowledge_info:e.dataSetList.filter(e=>!!e.dataset_id).map(e=>({id:e.dataset_id,name:e.name}))}),task:e=>({user_task_allowed:e.user_task_allowed}),suggestionConfig:e=>({suggest_reply_mode:e.suggest_reply_mode,customized_suggest_prompt:e.customized_suggest_prompt}),variables:e=>e.map(e=>({key:e.key,description:e.description,default_value:e.default_value,is_system:e.is_system,prompt_disabled:e.prompt_disabled,is_disabled:e.is_disabled})),databaseList:e=>e.map(e=>({table_id:e.tableId,table_name:e.name,table_desc:e.desc,rw_mode:e.readAndWriteMode,field_list:e.tableMemoryList.map(e=>{var t;return{name:e.name,desc:e.desc,type:e.type,must_required:e.must_required,id:null===(t=e.id)||void 0===t?void 0:t.toString()}})})),timeCapsule:e=>({time_capsule_info:{time_capsule_mode:e.time_capsule_mode,disable_prompt_calling:e.disable_prompt_calling,time_capsule_time_to_live:e.time_capsule_time_to_live}}),filebox:e=>({Mode:e.mode}),onboarding:e=>({prologue:e.prologue,suggested_questions_show_mode:e.suggested_questions_show_mode,suggested_questions:e.suggested_questions.map(e=>{var t;return null===(t=e.content)||void 0===t?void 0:t.trim()}).filter(e=>!!e)}),tts:e=>({muted:e.muted,i18n_lang_voice:e.i18n_lang_voice,autoplay:e.autoplay,autoplay_voice:e.autoplay_voice,voice_call:e.close_voice_call,i18n_lang_voice_str:e.i18n_lang_voice_str}),voicesInfo:e=>({default_user_input_type:e.defaultUserInputType}),shortcut:e=>e.shortcut_sort,layoutInfo:e=>(0,s.Z)(e,e=>null!=e?e:"")}},76672:function(e,t,r){r.d(t,{bo:function(){return v},c2:function(){return m}});var n,a=r(808549),o=r(120454),i=r(479910),s=r(598208),l=r(61111),c=r(286518),d=r(228845),u=()=>({inCollaboration:!1,sameWithOnline:!1,committer_name:"",editLockStatus:2,collaboratorStatus:{commitable:!1,operateable:!1,manageable:!1},baseVersion:"",branch:c.I0.Base,commit_time:"",commit_version:"",openCollaboratorsEnable:!1,canUpgrade:!1,currentCollaborationBotCount:0,maxCollaborationBotCount:0,maxCollaboratorsCount:0});var v=((n={})[n.Lose=0]="Lose",n[n.Holder=1]="Holder",n[n.Offline=2]="Offline",n),m=(0,s.Ue)()((0,i.mW)((0,i.XR)((e,t)=>(0,o._)((0,a._)({},u()),{setCollaboration:(0,d.y)(e),setCollaborationByImmer:t=>e((0,l.Uy)(e=>t(e))),getBaseVersion:()=>{var{baseVersion:e,inCollaboration:r}=t();if(!!r)return e},initStore:t=>{e({collaboratorStatus:null==t?void 0:t.collaborator_status,inCollaboration:t.in_collaboration,baseVersion:t.commit_version,sameWithOnline:null==t?void 0:t.same_with_online,committer_name:null==t?void 0:t.committer_name,commit_version:null==t?void 0:t.commit_version,branch:null==t?void 0:t.branch,commit_time:null==t?void 0:t.commit_time})},clear:()=>{e((0,a._)({},u()))}})),{enabled:!1,name:"botStudio.botDetail.collaboration"}))},179429:function(e,t,r){r.d(t,{L:function(){return d}});var n=r(808549),a=r(120454),o=r(479910),i=r(598208),s=r(61111),l=r(228845),c=()=>({diffTask:"",hasContinueTask:!1,continueTask:"",promptDiffInfo:{diffPromptResourceId:"",diffMode:"draft",diffPrompt:""}}),d=(0,i.Ue)()((0,o.mW)((0,o.XR)((e,t)=>(0,a._)((0,n._)({},c()),{setDiffTask:(0,l.y)(e),setDiffTaskByImmer:t=>e((0,s.Uy)(e=>t(e))),enterDiffMode:r=>{var{diffTask:n,promptDiffInfo:a}=r;e((0,s.Uy)(e=>{e.diffTask=n}),!1,"enterDiffMode"),"prompt"===n&&a&&t().setDiffTaskByImmer(e=>{e.promptDiffInfo=a})},exitDiffMode:()=>{t().clear()},clear:()=>{e((0,n._)({},c()),!1,"clear")}})),{enabled:!1,name:"botStudio.botDetail.diffTask"}))},342809:function(e,t,r){r.d(t,{I:function(){return a}});var n=r(479910),a=(0,r(598208).Ue)()((0,n.mW)(e=>({agentId:null,recordAgentIdOnManuallySwitchAgent:t=>{e({agentId:t},!1,"recordAgentIdOnManuallySwitchAgent")},clearAgentId:()=>{e({agentId:null},!1,"clearAgentId")}}),{enabled:!1,name:"botStudio.manuallySwitchAgentStore"}))},231783:function(e,t,r){r.d(t,{V7:function(){return v}});var n=r(808549),a=r(120454),o=r(479910),i=r(598208),s=r(61111),l=r(178385),c=r(228845),d=()=>({model:"",temperature:0,max_tokens:4096,top_p:0,frequency_penalty:0,presence_penalty:0,prompt_id:0,ShortMemPolicy:{ContextContentType:l.UE.USER_RES},card_ids:[]}),u=()=>({config:{model:"",temperature:0,max_tokens:4096,top_p:0,frequency_penalty:0,presence_penalty:0,prompt_id:0,ShortMemPolicy:{ContextContentType:l.UE.USER_RES},card_ids:[]},modelList:[]}),v=(0,i.Ue)()((0,o.mW)((0,o.XR)((e,t)=>(0,a._)((0,n._)({},u()),{setModel:(0,c.y)(e),setModelByImmer:t=>e((0,s.Uy)(e=>t(e)),!1,"setModelByImmer"),transformDto2Vo:e=>{var t,r,n,a,o=e.bot_info.model_info,i=null===(t=e.bot_option_data)||void 0===t?void 0:t.model_detail_map;return{model:null==o?void 0:o.model_id,temperature:null==o?void 0:o.temperature,max_tokens:null==o?void 0:o.max_tokens,top_p:null==o?void 0:o.top_p,frequency_penalty:null==o?void 0:o.frequency_penalty,presence_penalty:null==o?void 0:o.presence_penalty,ShortMemPolicy:{ContextContentType:null==o?void 0:null===(r=o.short_memory_policy)||void 0===r?void 0:r.context_mode,HistoryRound:null==o?void 0:null===(n=o.short_memory_policy)||void 0===n?void 0:n.history_round},model_name:(null==o?void 0:o.model_id)&&i?null===(a=i[o.model_id])||void 0===a?void 0:a.model_name:"",model_style:null==o?void 0:o.model_style,response_format:null==o?void 0:o.response_format}},transformVo2Dto:e=>{var t,r;return(null==e?void 0:e.model)?{model_id:e.model,temperature:e.temperature,max_tokens:e.max_tokens,top_p:e.top_p,presence_penalty:e.presence_penalty,frequency_penalty:e.frequency_penalty,short_memory_policy:{history_round:null==e?void 0:null===(t=e.ShortMemPolicy)||void 0===t?void 0:t.HistoryRound,context_mode:null==e?void 0:null===(r=e.ShortMemPolicy)||void 0===r?void 0:r.ContextContentType},response_format:e.response_format,model_style:e.model_style}:{}},initStore:r=>{var{transformDto2Vo:n}=t(),{bot_info:a,bot_option_data:o}=r;(null==a?void 0:a.model_info)&&(null==o?void 0:o.model_detail_map)?e({config:n(r)}):e({config:d()})},clear:()=>{e((0,n._)({},u()))}})),{enabled:!1,name:"botStudio.botDetail.model"}))},71983:function(e,t,r){r.d(t,{K:function(){return a},O:function(){return o}});var n=r(336205),a=()=>({}),o=()=>n.o.t("multiagent_node_scenarios_context_default")},727438:function(e,t,r){r.d(t,{c:function(){return n.c}});var n=r(714850);r(71983)},714850:function(e,t,r){r.d(t,{c:()=>Z});var n=r("825955"),a=r("808549"),o=r("120454"),i=r("479910"),s=r("598208"),l=r("801815"),c=r("765429"),d=r("615655"),u=r("61111"),v=r("947578"),m=r("730274"),g=r("336205"),p=r("214942"),f=r("670898"),h=r("775699"),_=r("532267"),x=r("382534"),y=r("686436"),b=r("228845"),S=r("763109"),C=r("731407"),j=r("342809"),w=r("76672"),E=r("388993"),k=r("529801"),I=r("231783"),T=r("277194"),M=r("71983"),A={agent:(e,t)=>{var r,n,o,i,{transformDto2Vo:s}=T.Ee.getState(),{transformDto2Vo:c}=I.V7.getState(),d=c({bot_info:{model_info:null==t?void 0:t.model_info},bot_option_data:e}),u=null!==(o=null==t?void 0:null===(r=t.prompt_info)||void 0===r?void 0:r.prompt)&&void 0!==o?o:"",v=s.plugin(null==t?void 0:t.plugin_info_list,null==e?void 0:e.plugin_detail_map,null==e?void 0:e.plugin_api_detail_map),g=s.workflow(null==t?void 0:t.workflow_info_list,null==e?void 0:e.workflow_detail_map),p=s.knowledge(null==t?void 0:t.knowledge,null==e?void 0:e.knowledge_detail_map),f=s.hookInfo(null==t?void 0:t.hook_info);return(0,a._)({id:null!==(i=null==t?void 0:t.agent_id)&&void 0!==i?i:"",reference_id:null==t?void 0:t.reference_id,reference_info_status:null==t?void 0:t.reference_info_status,update_type:null==t?void 0:t.update_type,agent_type:null==t?void 0:t.agent_type,name:null==t?void 0:t.agent_name,position:null==t?void 0:t.agent_position,model:d,prompt:u,description:(null==t?void 0:t.description)||(0,M.O)(),bizInfo:(0,M.K)(),system_info_all:[],skills:(0,a._)({pluginApis:v,workflows:g,knowledge:p},f?{devHooks:f}:{}),current_version:null==t?void 0:t.current_version,suggestion:null==t?void 0:t.suggest_reply_info,intents:(null==t?void 0:t.intents)||[],jump_config:(null==t?void 0:t.jump_config)||{}},(null==t?void 0:t.agent_type)===m.bu.Global_Agent&&{intents:(null===(n=t.intents)||void 0===n?void 0:n.length)?t.intents:[{intent_id:(0,l.x0)()}]})},botNodeInfo:e=>{var{transformDto2Vo:t}=T.Ee.getState();return(0,o._)((0,a._)({},e),{work_info:{suggest_reply:t.suggestionConfig(e.suggest_reply,!0)}})},multiAgent:e=>{var t,{agents:r,multiInfo:n,botOpts:a}=e,o=(null==r?void 0:r.map(e=>A.agent(a,e)))||[];return{edges:null==o?void 0:o.flatMap(e=>{var t;return(null===(t=e.intents)||void 0===t?void 0:t.map(t=>({sourceNodeID:e.id,targetNodeID:t.next_agent_id||"",sourcePortID:t.intent_id})))||[]}),connector_type:null!==(t=null==n?void 0:n.connector_type)&&void 0!==t?t:y.SP.BEZIER,agents:o,botAgentInfos:[],chatModeConfig:(null==n?void 0:n.session_type)===m.P3.Host?{type:n.session_type,currentHostId:(0,C.Wm)({agents:o})||""}:{type:m.P3.Flow}}}},N={agent:e=>{var t,r,n,i,{transformVo2Dto:s}=T.Ee.getState(),{transformVo2Dto:l}=I.V7.getState();return(0,o._)((0,a._)({},(0,k.Z)(e,["skills","system_info_all","prompt","bizInfo","jump_config","model","suggestion"])),{plugin_info_list:s.plugin(null==e?void 0:null===(t=e.skills)||void 0===t?void 0:t.pluginApis),workflow_info_list:s.workflow(null==e?void 0:null===(r=e.skills)||void 0===r?void 0:r.workflows),knowledge:s.knowledge(null==e?void 0:null===(n=e.skills)||void 0===n?void 0:n.knowledge),suggest_reply_info:s.suggestionConfig(null==e?void 0:e.suggestion),hook_info:null==e?void 0:null===(i=e.skills)||void 0===i?void 0:i.devHooks,model_info:l(null==e?void 0:e.model),prompt_info:{prompt:e.prompt},jump_config:e.jump_config,current_version:e.update_type===m.ZF.AutoUpdate?"0":e.current_version})}},L=()=>({agents:[],edges:[],connector_type:y.SP.BEZIER,currentAgentID:"",botAgentInfos:[],multiSheetViewOpen:{left:!0,right:!0},chatModeConfig:{type:_.P3.Host,currentHostId:""}}),Z=(0,s.Ue)()((0,i.mW)((0,i.XR)((e,t)=>{var r,i,s;return(0,o._)((0,a._)({},L()),{setMultiAgent:(0,b.y)(e),setMultiAgentByImmer:t=>e((0,u.Uy)(e=>t(e))),setMultiSheetViewOpen:t=>{e(e=>(0,o._)((0,a._)({},e),{multiSheetViewOpen:(0,a._)({},e.multiSheetViewOpen,t)}))},updatedCurrentAgentIdWithConnectStart:()=>{var r=(0,C.UH)(t()),n=null==r?void 0:r.id;j.I.getState().clearAgentId(),n&&e((0,u.Uy)(e=>{e.currentAgentID=n}))},resetHostAgent:()=>{var r=(0,C.Wm)(t());if(!!r)e((0,u.Uy)(e=>{if(e.chatModeConfig.type===_.P3.Host)e.chatModeConfig.currentHostId=r}))},setAgentIntentNextID:(t,r,n)=>{e((0,u.Uy)(e=>{var{agents:a}=e,o=(0,C.xZ)(a,t);if(o){var i,s=null===(i=o.intents)||void 0===i?void 0:i.find(e=>e.intent_id===r);s&&n&&(s.next_agent_id=n)}}))},clearIntentNextId:(t,r,n)=>{e((0,u.Uy)(e=>{var a,o=(0,C.xZ)(e.agents,t),i=null==o?void 0:null===(a=o.intents)||void 0===a?void 0:a.find(e=>e.next_agent_id===r&&e.intent_id===n);if(!!i)i.next_agent_id=void 0}))},addAgentIntent:(t,r)=>{e((0,u.Uy)(e=>{var n,{agents:a}=e,o=(0,C.xZ)(a,t);if(!!o){var i={intent_id:(0,l.x0)(),next_agent_id:r};if(o.agent_type===_.bu.Global_Agent)(null===(n=o.intents)||void 0===n?void 0:n[0])?o.intents[0].next_agent_id=r:o.intents=[i];else o.intents?o.intents.push(i):o.intents=[i]}}))},deleteAgentIntent:(t,r)=>e((0,u.Uy)(e=>{var n,a,{agents:o}=e,i=(0,C.xZ)(o,t);if(!!i)if(i.agent_type===_.bu.Global_Agent)(null===(n=i.intents)||void 0===n?void 0:n[0])?i.intents[0].next_agent_id=void 0:i.intents=[{intent_id:(0,l.x0)()}];else i.intents=(null===(a=i.intents)||void 0===a?void 0:a.filter(e=>e.next_agent_id!==r))||[]})),clearEdgesByTargetAgentId:t=>{e((0,u.Uy)(e=>{var{agents:r}=e,n=(0,C.m)(r,t);if(n){var{intents:a}=n;null==a||a.forEach(e=>{e.next_agent_id===t&&(e.next_agent_id=void 0)})}}))},updateAgentSkillKnowledgeDatasetInfo:(t,r)=>{e((0,u.Uy)(e=>{var n=(0,C.xZ)(e.agents,t);n&&(n.skills.knowledge.dataSetInfo=r)}))},updateAgentSkillPluginApis:(t,r)=>{e((0,u.Uy)(e=>{var n=(0,C.xZ)(e.agents,t);n&&(n.skills.pluginApis=(0,S.n)(r))}))},addAgent2Store:(t,r)=>{var n=A.agent(r,t);return e((0,u.Uy)(e=>{e.agents.push(n)})),n},addAgent:(r=(0,n._)(function*(e){var{type:r=_.bu.LLM_Agent,position:n}=e,{botId:a}=E.G.getState(),{getBaseVersion:o,setCollaborationByImmer:i}=w.c2.getState(),s={agent_type:r,bot_id:a,position:n,base_commit_version:o(),version_compat:_.NQ.NewVersion},{data:l,same_with_online:c,branch:d}=yield x.pr.CreateAgentV2(s);if(!l){h.O$.error({content:(0,v.u)(g.o.t("chatflow_error_create_failed"))});return}return i(e=>{e.sameWithOnline=null!=c&&c,e.branch=d}),t().addAgent2Store(l)}),function(e){return r.apply(this,arguments)}),batchAddBotAgent:(i=(0,n._)(function*(r){var{bots:n,positions:i}=r,s=p.rY.getState().space.id,{botId:l}=E.G.getState(),{getBaseVersion:m,setCollaborationByImmer:f}=w.c2.getState(),{botAgentInfos:y}=t(),b={bot_id:l,agent_type:_.bu.Bot_Agent,position:i,references:n,agent_cnt:n.length,base_commit_version:m()},[{data:S,same_with_online:C,branch:j},{data:k}]=yield Promise.all([x.pr.BatchCreateAgentV2(b),x.pr.MGetBotByVersion({space_id:s,bot_versions:null==n?void 0:n.map(e=>({bot_id:e.ReferenceId,version:e.Version}))})]);if(!Array.isArray(S)||0===S.length||!Array.isArray(k)||0===k.length)return h.O$.error({content:(0,v.u)(g.o.t("chatflow_error_create_failed"))}),[];var I=k.map(A.botNodeInfo);return f(e=>{e.sameWithOnline=null!=C&&C,e.branch=j}),e((0,u.Uy)(e=>{e.botAgentInfos=(0,c.Z)([...y,...I],d.Z)})),S.map(e=>{var r=I.find(t=>t.id===e.reference_id);return t().addAgent2Store((0,o._)((0,a._)({},e),{agent_name:null==r?void 0:r.name,icon_uri:null==r?void 0:r.icon_url}))})}),function(e){return i.apply(this,arguments)}),copyAgent:(s=(0,n._)(function*(e){var{botId:r}=E.G.getState(),{getBaseVersion:n}=w.c2.getState(),a={space_id:p.rY.getState().getSpaceId(),bot_id:r,base_commit_version:n(),agent_id:e},{data:o,bot_option_data:i={}}=yield x.pr.CopyAgentV2(a);if(!o){h.O$.error({content:(0,v.u)(g.o.t("chatflow_error_create_failed"))});return}return t().addAgent2Store(o,i)}),function(e){return s.apply(this,arguments)}),removeAgentSkillItem:(t,r,n)=>{e((0,u.Uy)(e=>{var a=(0,C.xZ)(e.agents,t);if(null==a?void 0:a.skills)switch(r){case"pluginApis":a.skills.pluginApis=a.skills.pluginApis.filter(e=>e.api_id!==n);break;case"workflows":a.skills.workflows=a.skills.workflows.filter(e=>e.workflow_id!==n);break;case"knowledge":a.skills.knowledge.dataSetList=a.skills.knowledge.dataSetList.filter(e=>e.dataset_id!==n);break;default:console.warn("[removeAgentSkillItem]: ?")}}))},updateBotNodeInfo:e=>{var{setMultiAgentByImmer:r}=t(),n=e.filter(e=>e.agent_type===_.bu.Bot_Agent);if(Array.isArray(n)&&n.length>0)return f.K.MGetBotByVersion({bot_versions:null==n?void 0:n.map(e=>({bot_id:e.reference_id,version:e.current_version}))}).then(e=>{r(t=>{var r;t.botAgentInfos=(null!==(r=e.data)&&void 0!==r?r:[]).map(A.botNodeInfo)})})},transformDto2Vo:A,transformVo2Dto:N,initStore:r=>{var{bot_info:n}=r,{transformDto2Vo:a,updatedCurrentAgentIdWithConnectStart:o,updateBotNodeInfo:i}=t(),{bot_info:{agents:s,multi_agent_info:l},bot_option_data:c}=r;e(a.multiAgent({agents:s,multiInfo:l,botOpts:c})),(null==n?void 0:n.bot_mode)===m.J4.MultiMode&&(o(),i((null==n?void 0:n.agents)||[]))},clear:()=>{e((0,a._)({},L()))}})}),{enabled:!1,name:"botStudio.botDetail.multiAgent"}))},552938:function(e,t,r){r.d(t,{K:()=>x});var n=r("825955"),a=r("808549"),o=r("120454"),i=r("479910"),s=r("598208"),l=r("44785"),c=r("61111"),d=r("479886"),u=r.n(d),v=r("670898"),m=r("382534"),g=r("388993"),p=r("228845"),f=r("178385"),h=()=>({plugin_tab_status:f.HE.Default,workflow_tab_status:f.HE.Default,imageflow_tab_status:f.HE.Default,knowledge_tab_status:f.HE.Default,database_tab_status:f.HE.Default,variable_tab_status:f.HE.Default,opening_dialog_tab_status:f.HE.Default,scheduled_task_tab_status:f.HE.Default,suggestion_tab_status:f.HE.Default,tts_tab_status:f.HE.Default,filebox_tab_status:f.HE.Default,background_image_tab_status:f.HE.Default,shortcut_tab_status:f.HE.Default}),_=()=>({init:!1,isSelf:!1,isPreview:!1,editable:!1,savingInfo:{saving:!1,time:u()().format("HH:mm:ss"),debouncing:!1,scopeKey:"",triggerType:""},historyVisible:!1,botSkillBlockCollapsibleState:{},grabPluginId:"",hasUnpublishChange:!1}),x=(0,s.Ue)()((0,i.mW)((0,i.XR)((e,t)=>(0,o._)((0,a._)({},_()),{setPageRuntimeBotInfo:(0,p.y)(e),setPageRuntimeByImmer:t=>e((0,c.Uy)(e=>t(e))),getBotSkillBlockCollapsibleState:(0,n._)(function*(){try{var t,r,n=yield v.C.GetDraftBotDisplayInfo({bot_id:g.G.getState().botId}),i=null!==(r=null===(t=n.data)||void 0===t?void 0:t.tab_display_info)&&void 0!==r?r:h();e(e=>(0,o._)((0,a._)({},e),{botSkillBlockCollapsibleState:i}))}catch(t){throw e(e=>(0,o._)((0,a._)({},e),{botSkillBlockCollapsibleState:h()})),t}}),setBotSkillBlockCollapsibleState:(r,n)=>{if((0,l.Z)(r)>0){if(e((0,o._)((0,a._)({},t()),{botSkillBlockCollapsibleState:(0,a._)({},t().botSkillBlockCollapsibleState,r)})),!n)m.nA.UpdateDraftBotDisplayInfo({bot_id:g.G.getState().botId,display_info:{tab_display_info:r},space_id:g.G.getState().space_id})}},getIsPreview:e=>void 0!==e,initStore:r=>{var{getIsPreview:n}=t();e({init:!0,isPreview:n(null==r?void 0:r.customVersion),editable:null==r?void 0:r.editable,savingInfo:{saving:!1,time:u()().format("HH:mm:ss")},hasUnpublishChange:!!r.has_unpublished_change})},clear:()=>{e((0,a._)({},_()))}})),{enabled:!1,name:"botStudio.botDetail.pageRuntime"}))},982008:function(e,t,r){r.d(t,{G:function(){return u}});var n=r(808549),a=r(120454),o=r(479910),i=r(598208),s=r(61111),l=r(178385),c=r(228845),d=()=>({systemMessage:{data:"",prompt_type:l.jK.SYSTEM,isOptimize:!1,record_id:""},optimizePrompt:"",promptOptimizeUuid:"",promptOptimizeStatus:"waitForRespond"}),u=(0,i.Ue)()((0,o.mW)((0,o.XR)((e,t)=>(0,a._)((0,n._)({},d()),{setPersona:(0,c.y)(e),setPersonaByImmer:t=>e((0,s.Uy)(e=>t(e))),transformDto2Vo:e=>{var t,r,n;return{data:null!==(n=null===(r=e.bot_info)||void 0===r?void 0:null===(t=r.prompt_info)||void 0===t?void 0:t.prompt)&&void 0!==n?n:"",prompt_type:l.jK.SYSTEM,isOptimize:!1,record_id:""}},transformVo2Dto:e=>({prompt:(null==e?void 0:e.data)||""}),initStore:e=>{var{setPersonaByImmer:r,transformDto2Vo:n}=t();e&&r(t=>{t.systemMessage=n(e)})},clear:()=>{e((0,n._)({},d()))}})),{enabled:!1,name:"botStudio.botDetail.persona"}))},771402:function(e,t,r){r.d(t,{E:function(){return c}});var n=r(808549),a=r(120454),o=r(479910),i=r(598208),s=r(228845),l=()=>({is_collected:!1,private_policy:""}),c=(0,i.Ue)()((0,o.mW)((0,o.XR)((e,t)=>(0,a._)((0,n._)({},l()),{setQueryCollect:(0,s.y)(e),transformDto2Vo:e=>{var t,r=null===(t=e.bot_info)||void 0===t?void 0:t.user_query_collect_conf;return{is_collected:null==r?void 0:r.is_collected,private_policy:null==r?void 0:r.private_policy}},transformVo2Dto:e=>e,initStore:r=>{var{transformDto2Vo:n}=t();e(n(r))},clear:()=>{e((0,n._)({},l()))}})),{enabled:!1,name:"botStudio.botDetail.queryCollect"}))},807787:function(e,t,r){r.d(t,{g:function(){return a}});var n,a=((n={})[n.KEY_CHECK_PASS=0]="KEY_CHECK_PASS",n[n.KEY_NAME_USED=1]="KEY_NAME_USED",n[n.KEY_IS_NULL=2]="KEY_IS_NULL",n)},731407:function(e,t,r){r.d(t,{UH:function(){return s},Wm:function(){return d},m:function(){return c},xZ:function(){return l}});var n=r(947578),a=r(336205),o=r(775699),i=r(532267),s=e=>{var t,r=e.agents.find(e=>e.agent_type===i.bu.Start_Agent);if(!r){o.FN.error({content:(0,n.u)(a.o.t("chatflow_error_miss_start"))});return}var s=null===(t=e.edges.find(e=>e.sourceNodeID===r.id))||void 0===t?void 0:t.targetNodeID;if(!s){o.FN.error({content:(0,n.u)(a.o.t("chatflow_error_miss_start_agent"))});return}return l(e.agents,s)},l=(e,t)=>{if(!!t)return e.find(e=>e.id===t)},c=(e,t)=>{if(!!t)return e.find(e=>(e.intents||[]).some(e=>e.next_agent_id===t))},d=e=>{var t,r,{agents:n}=e,a=n.find(e=>e.agent_type===i.bu.Start_Agent);return null==a?void 0:null===(r=a.intents)||void 0===r?void 0:null===(t=r.at(0))||void 0===t?void 0:t.next_agent_id}},763109:function(e,t,r){r.d(t,{n:function(){return a}});var n=r(529801),a=e=>e.map(e=>(0,n.Z)(e,"debug_example"))},228845:function(e,t,r){r.d(t,{y:function(){return a}});var n=r(808549);function a(e){return(t,r)=>{(null==r?void 0:r.replace)?e(t):e(e=>(0,n._)({},e,t))}}},937331:function(e,t,r){r.d(t,{tO:function(){return o}});var n=r(76672),a=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"common_storage";return new Proxy(t,{set:(t,n,a)=>"string"==typeof a&&(e.setItem("".concat(r,".").concat(n),a),!0),get:(t,n)=>{var a;return null!==(a=e.getItem("".concat(r,".").concat(n)))&&void 0!==a?a:void 0},deleteProperty:(t,n)=>("string"==typeof n&&e.removeItem("".concat(r,".").concat(n)),!0)})}(localStorage,{}),o=new Proxy(a,{get:(e,t,r)=>"baseVersion"===t?n.c2.getState().getBaseVersion():Reflect.get(e,t,r),set(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return"baseVersion"===t?(console.error("you should use botDetailStore instead of storage to keep base_commit_version"),!1):Reflect.set(e,t,...n)}})},549159:function(e,t,r){r.d(t,{O:function(){return o}});var n=r(808549),a=r(807787);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map(r=>{var o,i=(0,n._)({},r);return 1===e.filter(e=>e.key===r.key).length&&(null===(o=t.filter(e=>e.key===r.key))||void 0===o?void 0:o.length)===0?i.errType=a.g.KEY_CHECK_PASS:i.errType=a.g.KEY_NAME_USED,!r.key&&(i.errType=a.g.KEY_IS_NULL),i})}},287487:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(378925),a={getIsSettled:n.FR,getIsLogined:n.ri,getUserInfo:n.bG,getUserAuthInfos:n.UC,useIsSettled:n.Nu,useIsLogined:n.dT,useUserInfo:n.Pc,useUserAuthInfo:n.p6,useUserLabel:n.$H,subscribeUserAuthInfos:n.d9}},900093:function(e,t,r){r.d(t,{Uy:()=>eh,wU:()=>ep,AZ:()=>e_,Z$:()=>ex});var n=r("825955"),a=r("808549"),o=r("120454"),i=r("473980"),s=r("151064"),l=r("455069"),c=r("735114"),d=r("865558"),u=r("336205"),v=r("382534"),m=e=>{var t;return!!(null===(t=e.name)||void 0===t?void 0:t.trim())},g=r("903860"),p=r("998262"),f=r("117140"),h=r("763055"),_=r("915757"),x=r("674343"),y=r("474872"),b=r("707107"),S=r("58118"),C=e=>{var{initialValues:t,getIsFormValid:r}=e,[n,a]=(0,l.useState)(!t||r(t)),[o,i]=(0,l.useState)(!1),s=e=>{a(r(e))};return{isSubmitDisabled:!n||o,checkFormValid:s,bizCallback:{onValuesChange:e=>{s(e)},onBeforeUpload:()=>{i(!0)},onAfterUpload:()=>{i(!1)}}}},j=e=>{var t,[r,d]=(0,l.useState)(!1),[g,p]=(0,l.useState)(!1),[h,_]=(0,l.useState)(),[x,j]=(0,l.useState)(),w=(0,l.useRef)(),{bizCallback:{onValuesChange:E},isSubmitDisabled:k,checkFormValid:I}=C({getIsFormValid:e=>m(e)&&!!e.spaceId}),T=()=>{p(!1),_(void 0),w.current=void 0,d(!1)};var{run:M,loading:A}=(0,c.Z)((t=(0,n._)(function*(e){var{productId:t,spaceId:r,name:n}=e;return v.yF.PublicDuplicateProduct({product_id:t,space_id:r,name:n,entity_type:f._J.ProjectTemplate})}),function(e){return t.apply(this,arguments)}),{manual:!0,onBefore:t=>{var r,n,[a]=t;null===(r=e.onBefore)||void 0===r||r.call(e,{toSpaceId:null!==(n=a.spaceId)&&void 0!==n?n:""})},onError:e.onError,onSuccess:(t,r)=>{var n,o,i,s,l,c,d,u,v,m,g,[p]=r;T(),(0,b.Gg)(b.Kg.template_action_front,(0,a._)({template_id:(null==x?void 0:x.meta_info.id)||"",template_name:(null==x?void 0:null===(n=x.meta_info)||void 0===n?void 0:n.name)||"",template_type:"project",entity_id:(null==x?void 0:x.meta_info.entity_id)||"",entity_copy_id:(null==x?void 0:null===(o=x.project_extra)||void 0===o?void 0:o.template_project_id)||"",template_tag_professional:(null==x?void 0:x.meta_info.is_professional)?"professional":"basic",action:"duplicate",after_id:null===(i=t.data)||void 0===i?void 0:i.new_entity_id,source:e.source},(null==x?void 0:null===(s=x.meta_info)||void 0===s?void 0:s.is_free)?{template_tag_prize:"free"}:{template_tag_prize:"paid",template_prize_detail:Number(null==x?void 0:null===(c=x.meta_info)||void 0===c?void 0:null===(l=c.price)||void 0===l?void 0:l.amount)||0})),null==e||null===(u=e.onSuccess)||void 0===u||u.call(e,{originProductId:null!==(v=null==p?void 0:p.productId)&&void 0!==v?v:"",newEntityId:null!==(m=null===(d=t.data)||void 0===d?void 0:d.new_entity_id)&&void 0!==m?m:"",toSpaceId:null!==(g=null==p?void 0:p.spaceId)&&void 0!==g?g:""})}});return{modalContextHolder:(0,s.jsx)(y.bK,{title:u.o.t("creat_project_use_template"),isSelectSpace:r,visible:g,okButtonProps:{disabled:k,loading:A},maskClosable:!1,onOk:()=>{var e,t=null===(e=w.current)||void 0===e?void 0:e.getValues();if(!t)throw Error("duplicate project template values not provided");M(t)},onCancel:T,formProps:{initValues:h,onValueChange:E,getFormApi:e=>{w.current=e}}}),copyProject:e=>{var{isSelectSpace:t,sourceProduct:r}=e,n=(0,i._)(e,["isSelectSpace","sourceProduct"]);d(t);var s=(0,o._)((0,a._)({},n),{name:S.p.sliceStringByMaxLength({value:(0,y.Nt)(n.name),field:"projectName"})});_(s),I(s),j(r),p(!0)}}},w=r("252237"),E=r.n(w),k=r("216250"),I=e=>{var{title:t,groupChildrenClassName:r,children:n}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-8px coz-fg-plus text-[16px] font-medium leading-[22px]",children:t}),(0,s.jsx)("div",{className:E()("grid",k.Z["template-group"],r),children:n})]})},T=()=>(0,s.jsx)(x.Od.Image,{className:"rounded-xl"}),M=()=>(0,s.jsxs)(I,{title:(0,s.jsx)(x.Od.Title,{className:"w-120px"}),groupChildrenClassName:"h-[200px]",children:[(0,s.jsx)(T,{}),(0,s.jsx)(T,{}),(0,s.jsx)(T,{})]}),A=r("966140"),N=r("298203"),L=r("196286"),Z=e=>{var t=new URL("/template/project/".concat(e),window.location.origin);(0,N.xg)(()=>t.toString())},G=e=>{var{viewSource:t,product:r,className:n,onCopyTemplate:o}=e,i=!r.meta_info.is_professional;return(0,s.jsxs)("div",{className:E()("w-full px-12px",n),children:[(0,s.jsx)("div",{className:E()("w-full h-24px",k.Z["template-card-mask"])}),(0,s.jsxs)("div",{className:"w-full flex justify-between pt-8px coz-bg-max gap-x-8px",children:[(0,s.jsx)(x.zx,{color:"highlight",className:"flex-[1]",onClick:e=>{var n;e.stopPropagation(),(0,b.Gg)(b.Kg.template_action_front,(0,a._)({action:"click",source:t},(0,L.F)(r))),Z(null!==(n=r.meta_info.id)&&void 0!==n?n:"")},children:u.o.t("creat_project_use_template_preview")}),i?(0,s.jsx)(x.zx,{color:"hgltplus",className:"flex-[1]",onClick:e=>{var t,n;e.stopPropagation(),null==o||o({name:null!==(t=r.meta_info.name)&&void 0!==t?t:"",id:null!==(n=r.meta_info.id)&&void 0!==n?n:""})},children:u.o.t("creat_project_use_template_use")}):null]})]})},P=(0,l.forwardRef)((e,t)=>{var{className:r,children:n,onClick:a}=e;return(0,s.jsx)("div",{ref:t,onClick:a,className:E()("cursor-pointer p-12px coz-bg-max coz-stroke-primary border-solid border-[1px] hover:coz-shadow-default rounded-[16px]",r),children:n})}),B=e=>{var t,r,{viewSource:n,product:i,onCopyTemplate:c,className:d,onClick:u}=e,v=(0,l.useRef)(null),m=(0,A.Z)(v);return(0,s.jsx)(P,{ref:v,className:E()("relative",d),onClick:()=>{(0,b.Gg)(b.Kg.template_action_front,(0,a._)({action:"click",source:n},(0,L.F)(i))),null==u||u()},children:(0,s.jsxs)(y.uO,{once:!0,teaEvent:{name:b.Kg.template_action_front,params:(0,o._)((0,a._)({},(0,L.F)(i)),{action:"card_view",source:n})},children:[(0,s.jsx)("div",{className:"px-4px mb-8px overflow-hidden text-ellipsis coz-fg-primary text-[14px] font-medium leading-[20px]",children:i.meta_info.name}),(0,s.jsx)(x.Ee,{preview:!1,src:null===(r=i.meta_info.covers)||void 0===r?void 0:null===(t=r.at(0))||void 0===t?void 0:t.url,className:"rounded-[16px] block w-full",imgCls:"object-cover object-center w-full",height:148}),(0,s.jsx)(G,{viewSource:n,product:i,onCopyTemplate:c,className:E()("absolute left-0 bottom-[8px]",!m&&"hidden")})]})})},R=e=>{var{onClick:t}=e;return(0,s.jsxs)(P,{onClick:t,className:"h-200px flex items-center justify-center flex-col coz-fg-primary",children:[(0,s.jsx)(_.Fiw,{}),(0,s.jsx)("div",{className:"py-6px px-8px text-[14px] leading-[20px] font-medium",children:u.o.t("creat_project_creat_new_project")})]})},D=r("63360"),F=["7439261984903938074"],U=e=>{var{spaceId:t,isSelectSpaceOnCopy:r,onCopyOk:a,onCreateProject:o,onBeforeCopy:i,onCopyError:l}=e,{data:d,error:m,loading:y,refresh:b}=(0,c.Z)((0,n._)(function*(){var e;return null===(e=(yield v.yF.PublicGetProductCategoryList({entity_type:f._J.TemplateCommon})).data)||void 0===e?void 0:e.categories})),{data:S,error:C,loading:w,refresh:E}=(0,c.Z)((0,n._)(function*(){var e;return null===(e=(yield v.yF.PublicGetProductList({entity_type:f._J.ProjectTemplate,page_num:1,page_size:50,sort_type:f.ER.Heat,source:f.QJ.Recommend,is_free:!0})).data)||void 0===e?void 0:e.products})),{copyProject:k,modalContextHolder:A}=j({onSuccess:a,source:t?"space":"navi",onBefore:i,onError:l}),N=y||w;if(!d||!S)return(0,s.jsxs)(s.Fragment,{children:[A,(0,s.jsxs)("div",{className:"px-24px flex flex-col gap-y-[20px]",children:[(0,s.jsxs)(I,{title:"",children:[(0,s.jsx)(R,{onClick:o}),N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{}),(0,s.jsx)(T,{})]}):null]}),N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M,{}),(0,s.jsx)(M,{})]}):null,!N&&(m||C)?(0,s.jsx)(x.HY,{className:D.Z["error-empty"],image:(0,s.jsx)(h.My,{className:"h-160px w-160px"}),darkModeImage:(0,s.jsx)(h.QG,{className:"h-160px w-160px"}),title:(0,s.jsx)("span",{className:"coz-fg-primary text-[14px] font-medium leading-20px",children:u.o.t("creat_project_templates_load_failed")}),children:(0,s.jsx)(x.zx,{onClick:()=>{b(),E()},icon:(0,s.jsx)(_.mxP,{}),children:u.o.t("Retry")})}):null]})]});var L=S.filter(e=>F.some(t=>t===e.meta_info.id)),G=(0,g.Z)(S,L,e=>e.meta_info.id),P=(0,p.Z)(G,e=>{var t;return null===(t=e.meta_info.category)||void 0===t?void 0:t.id}),U=e=>e.map(e=>(0,s.jsx)(B,{viewSource:t?"space":"navi",onClick:()=>{var t;Z(null!==(t=e.meta_info.id)&&void 0!==t?t:"")},onCopyTemplate:n=>{k({spaceId:t,isSelectSpace:r,productId:n.id,name:n.name,sourceProduct:e})},product:e},e.meta_info.id));return(0,s.jsxs)(s.Fragment,{children:[A,(0,s.jsxs)("div",{className:"px-24px flex flex-col gap-y-[20px]",children:[(0,s.jsxs)(I,{title:"",children:[(0,s.jsx)(R,{onClick:o}),U(L)]}),d.map(e=>{var t,r,n,a=P[null!==(t=e.id)&&void 0!==t?t:""];return(null==a?void 0:a.length)?(0,s.jsx)(I,{title:e.name,children:U(null!==(n=P[null!==(r=e.id)&&void 0!==r?r:""])&&void 0!==n?n:[])},e.id):null})]})]})},O=e=>{var{spaceId:t,isSelectSpaceOnCopy:r,onCopyOk:n,onCreateProject:l,onBeforeCopy:c,onCopyError:d}=e,v=(0,i._)(e,["spaceId","isSelectSpaceOnCopy","onCopyOk","onCreateProject","onBeforeCopy","onCopyError"]);return(0,s.jsx)(x.u_,(0,o._)((0,a._)({size:"xxl",title:u.o.t("creat_project_templates"),className:D.Z["project-template-modal"],footer:null},v),{children:(0,s.jsx)(U,{spaceId:t,isSelectSpaceOnCopy:r,onCopyOk:n,onCreateProject:l,onBeforeCopy:c,onCopyError:d})}))},z=r("75117"),W=r("178385"),H=e=>{var{children:t}=e,r=(0,i._)(e,["children"]);return(0,s.jsx)(x.l0,(0,o._)((0,a._)({},r),{children:t}))},K={name:"name",enableMonetize:"enableMonetize",description:"description",icon_uri:"icon_uri",space_id:"space_id"},V=e=>{var{showMonetizeConfig:t,onAfterUpload:r,onBeforeUpload:n,renderAutoGenerate:a}=e,o=(0,x.XQ)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.yt,{label:u.o.t("creat_project_project_name"),rules:[{required:!0}],field:K.name,maxLength:S.p.getInputLengthLimit("projectName"),getValueLength:S.p.getValueLength,noErrorMessage:!0}),t?(0,s.jsx)(q,{field:K.enableMonetize,label:u.o.t("monetization"),desc:u.o.t("monetization_des"),initValue:!0,rules:[{required:!0}]}):null,(0,s.jsx)(x.ld,{label:u.o.t("creat_project_project_describe"),field:K.description,maxCount:S.p.getInputLengthLimit("projectDescription"),maxLength:S.p.getInputLengthLimit("projectDescription"),getValueLength:S.p.getValueLength}),(0,s.jsx)(z.s,{accept:".jpeg,.jpg,.png,.gif",label:u.o.t("bot_edit_profile_pircture"),field:K.icon_uri,rules:[{required:!0}],fileBizType:W.ym.BIZ_BOT_ICON,iconType:W.Tu.Bot,maskIcon:(0,s.jsx)(_.Isu,{}),withAutoGenerate:!0,renderAutoGenerate:a,generateInfo:()=>{var e=o.getValues();return{name:null==e?void 0:e.name,desc:null==e?void 0:e.description}},beforeUploadCustom:n,afterUploadCustom:r})]})},q=(0,x.Q2)(function(e){var{value:t,onChange:r,className:n,desc:l,descClassName:c,switchClassName:d}=e,u=(0,i._)(e,["value","onChange","className","desc","descClassName","switchClassName"]);return(0,s.jsxs)("div",{className:E()("flex items-center justify-between",n),children:[(0,s.jsx)("span",{className:E()("coz-fg-primary",c),children:l}),(0,s.jsx)(x.rs,(0,o._)((0,a._)({size:"small"},u),{checked:t,onChange:r,className:E()("shrink-0",d)}))]})}),Y=(0,l.lazy)(()=>r.e("3785").then(r.bind(r,20311))),X=e=>(0,s.jsx)(l.Suspense,{fallback:null,children:(0,s.jsx)(Y,(0,a._)({},e))}),J=e=>{var t,{selectSpace:r,formProps:c={},isFormValid:d,request:v,showMonetizeConfig:m,renderAutoGenerate:g}=e,p=(0,i._)(e,["selectSpace","formProps","isFormValid","request","showMonetizeConfig","renderAutoGenerate"]),[f,h]=(0,l.useState)(!1),[_,b]=(0,l.useState)({check_not_pass:!1}),{bizCallback:{onAfterUpload:S,onBeforeUpload:j,onValuesChange:w},isSubmitDisabled:E}=C({initialValues:c.initValues,getIsFormValid:d}),k=(0,l.useRef)();var I=(t=(0,n._)(function*(){if(!!k.current)try{h(!0);var e=yield v(k.current.getValues());if(b(e),e.check_not_pass)return}finally{h(!1)}}),function(){return t.apply(this,arguments)});return(0,s.jsxs)(x.u_,(0,o._)((0,a._)({size:"default",okText:u.o.t("Confirm"),cancelText:u.o.t("Cancel"),okButtonProps:{disabled:E,loading:f},onOk:I},p),{children:[(0,s.jsxs)(H,(0,o._)((0,a._)({},c),{getFormApi:e=>{k.current=e},onValueChange:w,children:[r?(0,s.jsx)(y.nX,{field:K.space_id}):null,(0,s.jsx)(V,{showMonetizeConfig:m,onBeforeUpload:j,onAfterUpload:S,renderAutoGenerate:g})]})),_.check_not_pass?(0,s.jsx)("div",{className:"coz-fg-hglt-red mt-[-8px]",children:(0,s.jsx)(X,{skipHtml:!0,linkTarget:"_blank",children:_.check_not_pass_msg||u.o.t("publish_audit_pop7")})}):null]}))},Q=r("581997"),$="coze-project-entity-hidden-key",ee=e=>{var[t,r]=(0,l.useState)(et(e));return{isSessionHidden:t,hideSession:()=>{if(!et(e)){var t=Q.D.getValue($)||"";Q.D.setValue($,t?"".concat(t,",").concat(e):e),r(!0)}}}},et=e=>{var t=Q.D.getValue($);return null==t?void 0:t.includes(e)},er=r("707120");r("79961");var en=r("521329");r("369215");var ea=r("983941"),eo=e=>{var{onClick:t,assetSrc:r,title:n,description:a,tip:o}=e,{isSessionHidden:i,hideSession:l}=ee(o?"guideTip":""),c=!i&&!!o;return(0,s.jsxs)("div",{onClick:t,className:E()("relative cursor-pointer p-8px pb-16px hover:coz-shadow-default coz-bg-max coz-stroke-primary border-[1px] border-solid rounded-[12px] flex flex-col items-center",ea.Z["guide-button-hover"]),children:[(0,s.jsx)(x.qE,{src:r,className:E()("w-[314px] h-[240px] rounded-[8px] coz-bg-secondary",ea.Z["guide-img-bg"],ea.Z["guide-button"],{"!mb-[-28px]":c}),imgCls:"w-full h-full",bottomSlot:{render:()=>c?(0,s.jsxs)("div",{className:"z-10 px-2 coz-fg-hglt text-[12px] font-medium w-full flex justify-center items-center h-[28px] rounded-[4px] rounded-t-none bg-[#DEDBFF]",children:[(0,s.jsx)("div",{className:"mx-auto",children:o}),(0,s.jsx)(_.rmE,{className:"w-[12px] h-[12px]",onClick:e=>{e.stopPropagation(),l()}})]}):null,text:o,textColor:"",bgColor:"#DEDBFF",className:""}}),(0,s.jsx)("div",{className:"mb-[4px] mt-[20px] coz-fg-plus text-[20px] font-medium leading-[28px]",children:n}),(0,s.jsx)("div",{className:E()("mb-[8px] coz-fg-secondary text-[14px] font-normal leading-[20px] opacity-100",ea.Z["guide-desc-hover"]),children:a}),(0,s.jsx)("div",{className:E()("absolute w-full flex justify-center left-0 bottom-[12px] opacity-0",ea.Z["create-button-hover"]),children:(0,s.jsx)(x.zx,{children:u.o.t("create_title")})})]})},ei=e=>{var{onChange:t,extraButtonConfigs:r=[]}=e,n=(0,i._)(e,["onChange","extraButtonConfigs"]);return(0,s.jsx)(x.u_,(0,o._)((0,a._)({className:ea.Z["guide-modal"],size:"xl",title:u.o.t("create_title"),width:"fit-content"},n),{children:(0,s.jsxs)("div",{className:"flex justify-between pl-24px pb-24px pr-24px gap-[8px]",children:[(0,s.jsx)(eo,{onClick:()=>t("agent"),assetSrc:en,title:u.o.t("creat_project_creat_agent"),description:u.o.t("creat_project_agent_describe"),tip:null}),(0,s.jsx)(eo,{onClick:()=>t("project"),assetSrc:er,title:(0,s.jsxs)("span",{className:"flex gap-x-4px items-center",children:[u.o.t("creat_project_creat_project"),(0,s.jsx)(x.Ct,{count:"Beta",type:"alt"})]}),description:u.o.t("creat_project_describe_open")}),r.map((e,t)=>{var{onClick:r}=e,o=(0,i._)(e,["onClick"]);return(0,s.jsx)(eo,(0,a._)({onClick:()=>{n.onCancel(),r()}},o),t)})]})}))};ei.displayName="GuideModal";var es=e=>{var t,{selectSpace:r,onBeforeCreateBot:g,onCreateBotError:p,onCreateBotSuccess:f,initialSpaceId:h,onCreateProjectSuccess:_,onCopyProjectTemplateSuccess:x,onBeforeCreateProject:y,onCreateProjectError:b,onBeforeCopyProjectTemplate:S,onProjectTemplateCopyError:C,bizCreateFrom:j,renderAutoGenerate:w,extraGuideButtonConfigs:E}=e,[k,I]=(0,l.useState)(!1),[T,M]=(0,l.useState)(!1),[A,N]=(0,l.useState)(!1),{modal:L,startEdit:Z}=(0,d.X)({showSpace:r,onBefore:g,onError:p,onSuccess:f,spaceId:h,bizCreateFrom:j}),G=e=>{M(!1),null==_||_(e)};var{runAsync:P}=(0,c.Z)((t=(0,n._)(function*(e){var t,r,{icon_uri:n,enableMonetize:s}=e,l=(0,i._)(e,["icon_uri","enableMonetize"]),c=(0,o._)((0,a._)((0,o._)((0,a._)({},l),{icon_uri:null==n?void 0:null===(t=n.at(0))||void 0===t?void 0:t.uid}),!1),{create_from:j}),{project_id:d,audit_data:u}=null!==(r=(yield v.sD.DraftProjectCreate(c)).data)&&void 0!==r?r:{};return(0,o._)((0,a._)({},u),{project_id:null!=d?d:""})}),function(e){return t.apply(this,arguments)}),{manual:!0,onBefore:y,onError:b,onSuccess:(e,t)=>{var r,[n]=t;if(!e.check_not_pass)G({projectId:e.project_id,spaceId:null!==(r=n.space_id)&&void 0!==r?r:""})}});return{modalContextHolder:(0,s.jsxs)(s.Fragment,{children:[L,(0,s.jsx)(O,{maskClosable:!1,onCreateProject:()=>{M(!0),N(!1)},onBeforeCopy:S,onCopyError:C,onCopyOk:e=>{N(!1),null==x||x(e)},isSelectSpaceOnCopy:!!r,spaceId:h,visible:A,onCancel:()=>{N(!1)}}),k?(0,s.jsx)(ei,{visible:k,onChange:e=>{if(I(!1),"project"===e){M(!0);return}if("agent"===e){Z();return}},onCancel:()=>{I(!1)},extraButtonConfigs:E}):null,T?(0,s.jsx)(J,{showMonetizeConfig:!1,isFormValid:e=>m(e)&&!!e.space_id,maskClosable:!1,title:u.o.t("creat_project_title"),formProps:{initValues:{space_id:h,project_id:""}},request:P,selectSpace:r,visible:T,onCancel:()=>{M(!1)},renderAutoGenerate:w}):null]}),createProject:()=>{I(!0)}}},el=e=>{var t,r,{scene:d,onSuccess:g,renderAutoGenerate:p}=e,[f,h]=(0,l.useState)(!1),[_,x]=(0,l.useState)(),b=()=>{x(void 0),h(!1)},C=e=>{if(b(),"update"!==d)throw Error("update project error scene");null==g||g(e)},j=e=>{if(b(),"copy"!==d)throw Error("copy project error scene");null==g||g(e)};var{runAsync:w}=(0,c.Z)((t=(0,n._)(function*(e){var t,r,{icon_uri:n,description:s=""}=e,l=(0,i._)(e,["icon_uri","description"]),c=(0,o._)((0,a._)({},l),{icon_uri:null==n?void 0:null===(t=n.at(0))||void 0===t?void 0:t.uid,description:s}),{audit_data:d}=null!==(r=(yield v.sD.DraftProjectUpdate(c)).data)&&void 0!==r?r:{};return(0,a._)({},d)}),function(e){return t.apply(this,arguments)}),{manual:!0,onSuccess:(e,t)=>{var r,[n]=t;if(!e.check_not_pass)C({projectId:n.project_id,spaceId:null!==(r=n.space_id)&&void 0!==r?r:""})}});var{runAsync:E}=(0,c.Z)((r=(0,n._)(function*(e){var t,r,{icon_uri:n}=e,s=(0,i._)(e,["icon_uri"]),l=(0,o._)((0,a._)({},s),{icon_uri:null==n?void 0:null===(t=n.at(0))||void 0===t?void 0:t.uid}),{audit_data:c,basic_info:d,user_info:u}=null!==(r=(yield v.sD.DraftProjectCopy(l)).data)&&void 0!==r?r:{};return(0,o._)((0,a._)({},c),{basic_info:d,user_info:u})}),function(e){return r.apply(this,arguments)}),{manual:!0,onSuccess:(e,t)=>{var[r]=t;if(!!e.basic_info&&!e.check_not_pass)j({templateId:r.project_id,basicInfo:e.basic_info,ownerInfo:e.user_info})}});return{modalContextHolder:f?(0,s.jsx)(J,(0,o._)((0,a._)({},{formProps:{initValues:_},visible:f,onCancel:()=>{b()},maskClosable:!1}),{isFormValid:m,title:"copy"===d?u.o.t("project_ide_create_duplicate"):"update"===d?u.o.t("project_ide_edit_project"):void 0,request:"update"===d?w:E,renderAutoGenerate:p})):null,openModal:e=>{var t,{initialValue:r}=e;if(h(!0),"update"===d){x(r);return}"copy"===d&&x((0,o._)((0,a._)({},r),{name:S.p.sliceStringByMaxLength({value:(0,y.Nt)(null!==(t=r.name)&&void 0!==t?t:""),field:"projectName"})}))}}},ec=e=>{var{onSuccess:t,renderAutoGenerate:r}=e;return el({scene:"update",onSuccess:t,renderAutoGenerate:r})},ed=r("64605"),eu=e=>{var{value:t,onChange:r,placeholder:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"coz-fg-secondary leading-20px text-[14px] font-normal mb-16px",children:u.o.t("project_ide_delete_confirm_describe")}),(0,s.jsx)(x.l0.Label,{required:!0,children:u.o.t("project_ide_project_name")}),(0,s.jsx)(x.II,{value:t,onChange:r,placeholder:n})]})},ev=e=>{var{value:t,onChange:r,placeholder:n}=e,l=(0,i._)(e,["value","onChange","placeholder"]);return(0,s.jsx)(x.u_,(0,o._)((0,a._)({size:"default",header:u.o.t("project_ide_delete_confirm"),okButtonColor:"red",okText:u.o.t("project_ide_delete"),cancelText:u.o.t("Cancel")},l),{children:(0,s.jsx)(eu,{value:t,onChange:r,placeholder:n})}))},em=e=>(0,ed.Z)(e)&&"agentId"in e,eg=e=>(0,ed.Z)(e)&&"projectId"in e,ep=e=>{var t,[r,a]=(0,l.useState)(""),o=(0,l.useRef)(),[d,u]=(0,l.useState)(!1),[m,g]=(0,l.useState)(),p=()=>{u(!1),a(""),g(""),o.current=void 0};var{loading:f,runAsync:h}=(0,c.Z)((t=(0,n._)(function*(e){if(em(e)){var{spaceId:t,agentId:r}=e;yield v.nA.DeleteDraftBot({space_id:t,bot_id:r});return}if(eg(e)){var{projectId:n}=e;yield v.sD.DraftProjectDelete({project_id:n})}}),function(e){return t.apply(this,arguments)}),{manual:!0,onSuccess:(t,r)=>{var n,a,[o]=r;if(p(),em(o)){null==e||null===(n=e.onDeleteAgentSuccess)||void 0===n||n.call(e,o);return}if(eg(o)){null==e||null===(a=e.onDeleteProjectSuccess)||void 0===a||a.call(e,o);return}}});return{modalContextHolder:(0,s.jsx)(ev,{maskClosable:!1,value:m,onChange:g,placeholder:r,visible:d,onCancel:()=>{p()},onOk:()=>{if(!!o.current)return h(o.current)},okButtonProps:{disabled:r!==m,loading:f}}),deleteIntelligence:e=>{var{name:t}=e,r=(0,i._)(e,["name"]);u(!0),a(t),o.current=r}}},ef=e=>{var{onSuccess:t,renderAutoGenerate:r}=e;return el({scene:"copy",onSuccess:t,renderAutoGenerate:r})},eh=e=>es(e),e_=e=>ec(e),ex=e=>ef(e)},360743:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(397362),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},640595:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(479694),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},355776:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(830382),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},440667:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(177724),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},619026:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(869931),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},824940:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(484037),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},266842:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(595901),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},316025:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(13914),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},856137:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(843190),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},780317:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(120321),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},200076:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(882935),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},839369:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(150330),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},978028:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(654867),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},774703:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(15531),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},601692:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(415329),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},867847:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(788492),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},200618:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(810678),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},234906:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(893090),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},107693:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(3435),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},158594:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(329185),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},433072:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(458465),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},820919:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(918801),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},876008:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(592180),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},719139:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(631449),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},343595:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(990638),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},818030:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(534033),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},735438:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(413058),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},815168:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(974457),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},562737:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(305738),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},924077:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(117278),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},978261:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(606860),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},70407:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(7203),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},146304:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(739076),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},756923:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(819338),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},949110:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(793956),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},282795:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(132223),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},507549:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(212550),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},381730:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(788834),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},181111:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(266031),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},120755:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(314839),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},578106:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(443797),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},220242:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(847353),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},882886:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(780857),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},167988:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(181100),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},106751:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(395285),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},594134:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(999283),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},337072:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(551560),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},929931:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(795074),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},243437:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(774609),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},626152:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(764533),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},21580:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(954457),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},1768:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(181255),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},664894:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(348486),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},875173:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(60071),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},256303:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(178277),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},307847:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(426601),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},839142:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(631768),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},340728:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(854213),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},456661:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(152446),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},750197:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(56412),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},670785:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(110081),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals},689931:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(946118),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},725311:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(63988),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},567201:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(935025),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),t.Z=p.Z&&p.Z.locals?p.Z.locals:void 0},539988:function(e,t,r){var n=r(407821),a=r.n(n),o=r(472772),i=r.n(o),s=r(395245),l=r.n(s),c=r(297998),d=r.n(c),u=r(646576),v=r.n(u),m=r(606121),g=r.n(m),p=r(292336),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=v(),a()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals}}]);
//# sourceMappingURL=index~0.a24c0901.js.map