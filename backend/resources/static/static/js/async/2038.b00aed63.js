/*
 * Copyright 2025 coze-dev Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";(self.webpackChunk_coze_studio_app=self.webpackChunk_coze_studio_app||[]).push([["2038"],{784475:function(e,r,t){t.r(r),t.d(r,{default:()=>P});var o=t("808549"),a=t("151064"),s=t("664319"),n=t("252237"),l=t.n(n),i=t("388993"),d=t("163600"),c=t("227048"),m=t("202682"),p=t("539227"),u=t("944881"),x=t("178385"),v=t("214942"),f=t("730274"),b=t("972735"),h=t("629685"),g=t("407821"),y=t.n(g),j=t("472772"),w=t.n(j),_=t("395245"),z=t.n(_),k=t("297998"),I=t.n(k),N=t("646576"),T=t.n(N),E=t("606121"),F=t.n(E),R=t("650912"),A={};A.styleTagTransform=F(),A.setAttributes=I(),A.insert=z().bind(null,"head"),A.domAPI=w(),A.insertStyleElement=T(),y()(R.Z,A);var Z=R.Z&&R.Z.locals?R.Z.locals:void 0,P=e=>{var{editorExtensions:r}=e,{libraryList:t}=(0,b.I)(),{botId:n,space_id:g,businessType:y}=(0,i.G)((0,s.N)(e=>({botId:e.botId,space_id:e.space_id,businessType:e.businessType}))),j=(0,v.rY)(e=>e.space.space_type)===x.Sn.Personal,w=(0,h.O)(),_=(0,d.ti)(),z=(0,c.jE)(),k=null==z?void 0:z.getValue();return e.isSingle?_?(0,a.jsxs)("div",{className:Z["agent-ide-prompt-editor"],children:[(0,a.jsx)(c.gv,(0,o._)({},e)),(0,a.jsx)(u.Vv,{mode:"input"}),(0,a.jsx)(p.jy,{librarys:[],readonly:!0,onAddLibrary:w,spaceId:g})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:Z["agent-ide-prompt-editor"],style:{height:"100%"},children:(0,a.jsx)(c.gv,(0,o._)({},e))}),(0,a.jsx)(u.Vv,{mode:"input"}),(0,a.jsx)(p.jy,{librarys:t,onAddLibrary:w,spaceId:g,avatarBotId:y===f._$.DouyinAvatar?n:void 0}),(0,a.jsx)(p.Fi,{librarys:t,direction:"topLeft"}),(null==k?void 0:k.length)===0?(0,a.jsx)(m.u,{source:"bot_detail_page",tabs:["Recommended","Team"],isPersonal:j,importPromptWhenEmpty:e.defaultValue,spaceId:g,onInsertPrompt:r=>{var t;null==e||null===(t=e.onChange)||void 0===t||t.call(e,r)}}):null,r]}):(0,a.jsx)("div",{className:l()(Z["agent-ide-prompt-editor"],"overflow-y-auto coz-bg-max","h-[320px] p-[16px]"),children:(0,a.jsx)(c.gv,(0,o._)({},e))})}},202682:function(e,r,t){t.d(r,{u:()=>C});var o=t("151064"),a=t("455069"),s=t("252237"),n=t.n(s),l=t("887874"),i=t("674343"),d=t("382534"),c=t("925623"),m=t("539227"),p=t("944881"),u=t("227048"),x=t("336205"),v=t("249294");t("796106");var f=e=>{var{id:r,title:t,description:s,prompt:l,onInsertPrompt:c,spaceId:m,className:p,position:x}=e,[v,f]=(0,a.useState)(null!=l?l:""),[h,g]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!l)d.pr.GetPromptResourceInfo({prompt_resource_id:r}).then(e=>{var{data:{prompt_text:r}={}}=e;f(null!=r?r:"")})},[l,r]),(0,o.jsx)(u.hT,{children:(0,o.jsx)(i.J2,{position:x,visible:h,onVisibleChange:g,trigger:"hover",className:"rounded",showArrow:!0,autoAdjustOverflow:!0,content:h?(0,o.jsx)(b,{prompt:v,title:t,spaceId:m,onInsertPrompt:e=>{null==c||c(e),g(!1)}}):null,children:(0,o.jsxs)("div",{className:n()("flex flex-col flex-shrink-0 flex-nowrap gap-1 px-3 py-2 relative","aspect-[180/120] overflow-hidden","rounded-lg border coz-stroke-primary coz-bg-max cursor-pointer","coz-stroke-primary border-[0.5px] border-solid","hover:coz-mg-secondary-hovered",p),children:[(0,o.jsx)(i.ZT.Text,{className:"font-medium text-lg",ellipsis:{rows:1},children:t}),(0,o.jsx)(i.ZT.Text,{className:"text-base",ellipsis:{rows:3},children:null!=s?s:null==l?void 0:l.slice(0,50)})]})},r)})},b=e=>{var{prompt:r="",title:t,spaceId:s,onInsertPrompt:n}=e,d=(0,l.jE)();return(0,a.useEffect)(()=>{null==d||d.$view.dispatch({changes:{from:0,to:null==d?void 0:d.$view.state.doc.length,insert:r}})},[d,r]),(0,o.jsxs)("div",{className:"flex flex-col justify-between w-[300px] h-[300px] gap-3",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-1 overflow-y-auto styled-scrollbar hover-show-scrollbar",children:[(0,o.jsx)("div",{className:"text-sm font-medium coz-fg-primary",children:t}),(0,o.jsx)(u.gv,{defaultValue:r,readonly:!0}),(0,o.jsx)(p.Vv,{mode:"input"}),(0,o.jsx)(m.jy,{librarys:[],readonly:!0,spaceId:s}),(0,o.jsx)(c.G,{themes:[v.tk.theme({".cm-line":{paddingLeft:"0 !important"}})]})]}),(0,o.jsx)("div",{className:"coz-mg-hglt hover:!coz-mg-hglt-hovered rounded",children:(0,o.jsx)(i.zx,{color:"primary",className:"w-full font-sm font-medium !bg-transparent !coz-fg-hglt ",onClick:()=>{null==n||n(r)},children:x.o.t("prompt_resource_insert_prompt")})})]})},h=e=>{var{onClick:r,className:t}=e;return(0,o.jsx)("div",{onClick:r,className:n()("flex flex-col flex-shrink-0 flex-nowrap gap-1 px-3 py-2 items-center justify-center","aspect-[180/120]","rounded-lg border coz-stroke-primary coz-bg-max cursor-pointer text-sm","coz-stroke-primary border-[0.5px] border-solid","hover:coz-mg-secondary-hovered",t),children:(0,o.jsx)("div",{className:"coz-fg-primary font-medium",children:x.o.t("prompt_resource_view_all")})})},g=t("825955"),y=t("808549"),j=t("120454"),w=t("915757"),_=t("66418"),z=()=>(0,o.jsxs)("div",{className:"flex flex-col flex-shrink-0 flex-nowrap px-3 py-2 aspect-[180/120] rounded-lg border coz-stroke-primary coz-bg-max",children:[(0,o.jsx)(i.Od,{placeholder:(0,o.jsx)(i.Od.Title,{}),className:"mb-3 w-2/3"}),(0,o.jsx)(i.Od,{placeholder:(0,o.jsx)(i.Od.Paragraph,{rows:3}),className:"w-full"})]}),k=t("735114"),I=t("909776"),N=()=>{var{runAsync:e,loading:r,data:t}=T(),{runAsync:o,loading:a,data:s}=E();return{loading:r||a,data:{Recommended:null!=t?t:[],Team:null!=s?s:[]},runAsync:(r,t)=>"Recommended"===r?e({size:t.size}):"Team"===r?o(t):void 0}},T=()=>{var e,r=(0,a.useRef)(),[t,o]=(0,a.useState)(),{runAsync:s,loading:n}=(0,k.Z)(()=>d.pr.GetOfficialPromptResourceList(),{manual:!0,onSuccess:e=>{var t;return o(r.current?null===(t=e.data)||void 0===t?void 0:t.slice(0,r.current):e.data),e}});var l=(e=(0,g._)(function*(e){return r.current=e.size,s()}),function(r){return e.apply(this,arguments)});return{data:null==t?void 0:t.map(e=>{var{id:r="",name:t="",description:o="",prompt_text:a=""}=e;return{id:r,name:t,description:o,promptText:a}}),runAsync:l,loading:n}},E=()=>{var e,{data:r,runAsync:t,loading:o}=(0,k.Z)(e=>d.Js.LibraryResourceList((0,j._)((0,y._)({},e),{res_type_filter:[I.b0.Prompt]})),{manual:!0});return{data:null==r?void 0:null===(e=r.resource_list)||void 0===e?void 0:e.map(e=>{var{res_id:r="",name:t="",desc:o=""}=e;return{id:r,name:t,description:o}}),runAsync:t,loading:o}},F=e=>{var{activeTab:r,tabs:t,loading:o,data:s}=e,n=(0,a.useRef)([]),[l,i]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),m=e=>t.indexOf(e),p=e=>{var r=n.current[e];if(r){var{scrollLeft:t,scrollWidth:o,clientWidth:a}=r;i(t>0),c(t<o-a-10)}};return(0,a.useEffect)(()=>{var e=()=>p(m(r));return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[r]),(0,a.useEffect)(()=>{!o&&(null==s?void 0:s[r])&&setTimeout(()=>p(m(r)),0)},[o,s,r]),(0,a.useEffect)(()=>{var e=n.current[m(r)];if(!!e){var t=()=>p(m(r));return e.addEventListener("scroll",t),p(m(r)),()=>e.removeEventListener("scroll",t)}},[s,r]),{scrollRefs:n,canScrollLeft:l,canScrollRight:d,handleScroll:e=>{var t=m(r);if(n.current[t]){var o=n.current[t].scrollLeft+("left"===e?-300:300);n.current[t].scrollTo({left:o,behavior:"smooth"})}}}},R=t("710285"),A=()=>(0,o.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,o.jsx)(i.ub,{title:x.o.t("prompt_library_empty_title"),icon:(0,o.jsx)(w.nL$,{}),style:{maxWidth:"300px"}})}),Z=t("125166"),P=e=>{var{handleScroll:r}=e;return(0,o.jsx)("div",{className:"absolute bottom-0 left-0 top-0 w-8 z-10",style:{background:"linear-gradient(90deg, #F9F9F9 0%, rgba(249, 249, 249, 0.00) 100%)"},children:(0,o.jsx)("div",{onClick:r,className:"w-6 h-6 coz-bg-max flex justify-center items-center absolute left-0 top-1/2 -translate-y-1/2 z-20 cursor-pointer rounded-lg coz-stroke-primary coz-shadow-small",children:(0,o.jsx)(w.tWI,{className:"w-4 h-4"})})})},S=e=>{var{handleScroll:r}=e;return(0,o.jsx)("div",{className:"absolute bottom-0 right-0 top-0 w-8",style:{background:"linear-gradient(270deg, #F9F9F9 0%, rgba(249, 249, 249, 0.00) 100%)"},children:(0,o.jsx)("div",{onClick:r,className:"w-6 h-6 coz-bg-max flex justify-center items-center absolute right-0 top-1/2 -translate-y-1/2 z-20 cursor-pointer rounded-lg coz-stroke-primary coz-shadow-small",children:(0,o.jsx)(w.wMM,{className:"w-4 h-4"})})})},L=e=>({Recommended:x.o.t("prompt_resource_recommended"),Team:e?x.o.t("prompt_resource_personal"):x.o.t("prompt_resource_team")}),V=e=>{var r,t,s=(0,a.useRef)(null),{className:d,cardClassName:c,listContainerClassName:m,onInsertPrompt:p,tabs:u,spaceId:v,enableLibrary:b=!1,getConversationId:y,getPromptContextInfo:j,importPromptWhenEmpty:k,source:I,botId:T,projectId:E,workflowId:V,ref:C,isPersonal:O=!1,onCopyPrompt:q,onDeletePrompt:G,onUpdateSuccess:M}=e,[Y,D]=(0,a.useState)(u[0]),H=(0,l.jE)();var $=(r=(0,g._)(function*(e,r){var t=yield(0,_.fY)({editor:H,prompt:e});null==p||p(t,{id:r,category:Y})}),function(e,t){return r.apply(this,arguments)}),{loading:B,data:J,runAsync:W}=N(),K=!B&&(null==J?void 0:null===(t=J[Y])||void 0===t?void 0:t.length)===0,{open:Q,node:U}=(0,R.d)({spaceId:v,getConversationId:y,editor:H,isPersonal:O,source:I,botId:T,projectId:E,workflowId:V,getPromptContextInfo:j,importPromptWhenEmpty:k,onInsertPrompt:p,onUpdateSuccess:(e,r)=>{W(Y,{space_id:v,size:6}),null==M||M(e,r)},onCopyPrompt:q,onDeletePrompt:G});(0,a.useEffect)(()=>{if(!!v)W(Y,{space_id:v,size:6})},[v,Y]);var{scrollRefs:X,canScrollLeft:ee,canScrollRight:er,handleScroll:et}=F({activeTab:Y,tabs:u,loading:B,data:J});return(0,a.useImperativeHandle)(C,()=>({refresh:e=>{W(e,{space_id:v,size:6})}})),(0,o.jsxs)("div",{ref:e=>{"function"==typeof C&&C(null),s.current=e},className:n()(Z.Z["recommend-pannel"],"flex flex-col justify-between w-full","absolute bottom-0 left-0 right-0","py-3 px-5",d),children:[(0,o.jsx)(i.mQ,{type:"button",activeKey:Y,onChange:e=>D(e),tabBarExtraContent:b?(0,o.jsx)("div",{className:"coz-fg-primary text-sm flex items-center cursor-pointer font-medium",onClick:()=>Q({defaultActiveTab:Y}),children:(0,o.jsx)(i.zx,{icon:(0,o.jsx)(w.wMM,{className:"!coz-fg-primary"}),color:"secondary",iconPosition:"right",children:(0,o.jsx)("span",{className:"coz-fg-primary",children:x.o.t("workflow_prompt_editor_view_library")})})}):null,children:u.map((e,r)=>{var t;return(0,o.jsxs)(i.Jm,{itemKey:e,tab:L(O)[e],className:"relative",children:[ee?(0,o.jsx)(P,{handleScroll:()=>et("left")}):null,(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{ref:e=>X.current[r]=e,className:n()("relative overflow-x-auto styled-scrollbar h-[120px] box-content hover-show-scrollbar","flex-1",m),children:K?(0,o.jsx)(A,{}):(0,o.jsxs)("div",{className:"flex gap-3 flex-row flex-nowrap overflow-visible h-full min-w-min",children:[B?Array.from({length:6}).map((e,r)=>(0,o.jsx)(z,{},r)):null,null==J?void 0:null===(t=J[e])||void 0===t?void 0:t.map((e,r)=>(0,o.jsx)(f,{className:n()(c),id:e.id,position:0===r?"topLeft":"top",spaceId:v,title:e.name,description:e.description,prompt:e.promptText,onInsertPrompt:r=>$(r,e.id)},e.id)),(0,o.jsx)(h,{onClick:()=>Q({defaultActiveTab:e})})]})}),er?(0,o.jsx)(S,{handleScroll:()=>et("right")}):null]})]})})}),U]})},C=(0,a.forwardRef)((e,r)=>(0,o.jsx)(V,(0,j._)((0,y._)({},e),{ref:r})))},125166:function(e,r,t){var o=t(407821),a=t.n(o),s=t(472772),n=t.n(s),l=t(395245),i=t.n(l),d=t(297998),c=t.n(d),m=t(646576),p=t.n(m),u=t(606121),x=t.n(u),v=t(809450),f={};f.styleTagTransform=x(),f.setAttributes=c(),f.insert=i().bind(null,"head"),f.domAPI=n(),f.insertStyleElement=p(),a()(v.Z,f),r.Z=v.Z&&v.Z.locals?v.Z.locals:void 0},650912:function(e,r,t){var o=t(125161),a=t.n(o),s=t(404442),n=t.n(s)()(a());n.push([e.id,".agent-ide-prompt-editor-RMVGFw{box-sizing:content-box;padding:12px 8px 0;overflow-x:hidden}.agent-ide-prompt-editor-RMVGFw>div:first-child{height:100%}.agent-ide-prompt-editor-RMVGFw .cm-editor{height:100%}.agent-ide-prompt-editor-RMVGFw .cm-placeholder{height:100%!important}",""]),n.locals={"agent-ide-prompt-editor":"agent-ide-prompt-editor-RMVGFw",agentIdePromptEditor:"agent-ide-prompt-editor-RMVGFw"},r.Z=n},809450:function(e,r,t){var o=t(125161),a=t.n(o),s=t(404442),n=t.n(s)()(a());n.push([e.id,".recommend-pannel-Iowq5k .semi-tabs-tab-button-YaIFId.semi-tabs-tab-DknoHO{cursor:pointer;color:rgba(6,7,9,.8);font-size:14px;font-weight:500;line-height:20px}.recommend-pannel-Iowq5k .semi-tabs-tab-button{color:rgba(6,7,9,.8);justify-content:center;align-items:center;gap:4px;height:32px;padding:6px 8px;font-weight:500;display:flex}.recommend-pannel-Iowq5k .semi-tabs-tab-button.semi-tabs-tab-active{background:rgba(186,192,255,.2);border-radius:8px;color:#4e40e5!important}.recommend-pannel-Iowq5k .semi-tabs-tab-button.semi-tabs-tab:hover:not(.semi-tabs-tab-active){background:rgba(6,7,9,.08);border-radius:8px}.recommend-pannel-Iowq5k .semi-tabs-content{padding:0}.recommend-pannel-Iowq5k .semi-tabs-bar{margin-bottom:8px}.recommend-pannel-Iowq5k .semi-tabs-pane-motion-overlay{box-sizing:content-box;height:100%}.recommend-pannel-Iowq5k .semi-tabs-bar-extra{position:absolute;right:0}",""]),n.locals={"recommend-pannel":"recommend-pannel-Iowq5k",recommendPannel:"recommend-pannel-Iowq5k","semi-tabs-tab-button":"semi-tabs-tab-button-YaIFId",semiTabsTabButton:"semi-tabs-tab-button-YaIFId","semi-tabs-tab":"semi-tabs-tab-DknoHO",semiTabsTab:"semi-tabs-tab-DknoHO"},r.Z=n}}]);
//# sourceMappingURL=2038.b00aed63.js.map