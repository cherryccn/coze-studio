/*
 * Copyright 2025 coze-dev Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";(self.webpackChunk_coze_studio_app=self.webpackChunk_coze_studio_app||[]).push([["8462"],{317612:function(e,t,r){r.d(t,{q:()=>j});var n=r("808549"),o=r("473980"),i=r("151064"),l=r("455069"),a=r("550655"),s=r("120454"),d=r("664319"),c=r("252237"),u=r.n(c),p=r("277194"),m=r("336205"),v=r("775699"),_=r("30961"),f=r("458949");r("382534");var{Select:h,TextArea:x}=r("674343").l0;f.nw.NotFoundPlugin,m.o.t("plugin_feedback_modal_request_type_official_plugins_not_found"),f.nw.OfficialPlugin,m.o.t("plugin_feedback_modal_request_type_feedback_to_existing_plugin"),r("398778");var g=r("770131"),y=r("719894"),b=e=>{var{type:t,openMode:r,from:l,openModeCallback:a,showButton:c,showCopyPlugin:f,onCopyPluginCallback:h,pluginApiList:x,projectId:b,clickProjectPluginCallback:j,hideCreateBtn:w,initQuery:C}=e,k=(0,o._)(e,["type","openMode","from","openModeCallback","showButton","showCopyPlugin","onCopyPluginCallback","pluginApiList","projectId","clickProjectPluginCallback","hideCreateBtn","initQuery"]),{pluginApis:N,updateSkillPluginApis:S}=(0,p.Ee)((0,d.N)(e=>({pluginApis:e.pluginApis,updateSkillPluginApis:e.updateSkillPluginApis}))),{sider:E,filter:T,content:I}=(0,g.A)({pluginApiList:x?x:r===_.jG.OnlyOnceAdd?[]:N,onPluginApiListChange:S,openMode:r,from:l,openModeCallback:a,showButton:c,showCopyPlugin:f,onCopyPluginCallback:h,projectId:b,clickProjectPluginCallback:j,onCreateSuccess:null==k?void 0:k.onCreateSuccess,isShowStorePlugin:null==k?void 0:k.isShowStorePlugin,hideCreateBtn:w,initQuery:C});return(0,i.jsx)(v.FS,(0,s._)((0,n._)({"data-testid":"plugin-modal"},k),{header:m.o.t("bot_edit_plugin_select_title"),className:u()(y.Z["plugin-modal"],k.className),sider:E,extra:null,filter:T,content:I}))},j=e=>{var t=e||{},{closeCallback:r}=t,s=(0,o._)(t,["closeCallback"]),[d,c]=(0,l.useState)(!1),[u,p]=(0,l.useState)(1),[m,v]=(0,l.useState)();return{node:d?(0,i.jsx)(b,(0,n._)({type:u,visible:d,onCancel:()=>{c(!1),null==r||r()},initQuery:m,footer:null},s)):null,open:e=>{var t=(0,a.Z)(e)?e:null==e?void 0:e.openType,r=(0,a.Z)(e)?void 0:null==e?void 0:e.initQuery;c(!0),v(r),(0,a.Z)(t)&&p(t)},close:()=>{c(!1),v(void 0),null==r||r()}}}},770131:function(e,t,r){r.d(t,{A:()=>W});var n=r("808549"),o=r("120454"),i=r("151064"),l=r("455069"),a=r("664319"),s=r("287487"),d=r("76672"),c=r("388993"),u=r("214942"),p=r("117140"),m=r("178385"),v=r("287411"),_=r("825955"),f=r("252237"),h=r.n(f),x=r("735114"),g=r("903124"),y=r("336205"),b=r("915757"),j=r("775699"),w=r("44172"),C=r("150838"),k=e=>{var{isSearching:t,type:r,onChange:n,projectId:o,from:l,isShowStorePlugin:a=!0}=e,s=(0,u.rY)(e=>e.space.space_type),d=(0,v.ir)().id,{data:c}=(0,x.Z)((0,_._)(function*(){var e;return(null===(e=(yield g.K.PublicGetMarketPluginConfig({})).data)||void 0===e?void 0:e.enable_saas_plugin)||!1})),p=e=>{if(t){n(e);return}if(e!==r)n(e)};return(0,i.jsxs)("div",{className:C.Z["tool-tag-list"],children:[s===m.Sn.Personal&&(0,i.jsxs)("div",{"data-testid":"plugin.modal.filter.option.mine",className:h()(C.Z["tool-tag-list-cell"],{[C.Z.active]:r===v.eL.Mine}),onClick:()=>p(v.eL.Mine),children:[(0,i.jsx)(w.ckl,{className:C.Z["tool-tag-list-cell-icon"]}),y.o.t("add_resource_modal_sidebar_library_tools")]}),o&&l===v.tx.ProjectWorkflow?(0,i.jsxs)("div",{className:h()(C.Z["tool-tag-list-cell"],{[C.Z.active]:r===v.eL.Project}),onClick:()=>p(v.eL.Project),children:[(0,i.jsx)(w.Qi1,{className:C.Z["tool-tag-list-cell-icon"]}),y.o.t("add_resource_modal_sidebar_project_tools")]}):null,a?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.yh.Divider,{}),(0,i.jsx)("div",{className:C.Z["tool-content-area"],children:(0,i.jsxs)("div",{className:h()(C.Z["tool-tag-list-cell"],{[C.Z.active]:r===d}),onClick:()=>p(d),children:[(0,i.jsx)(b._Xi,{className:C.Z["tool-tag-list-cell-icon"]}),y.o.t("explore_tools")]})}),c?(0,i.jsx)("div",{className:C.Z["tool-content-area"],children:(0,i.jsxs)("div",{className:h()(C.Z["tool-tag-list-cell"],{[C.Z.active]:r===v.eL.Coze}),onClick:()=>p(v.eL.Coze),children:[(0,i.jsx)(b.Q_7,{className:C.Z["tool-tag-list-cell-icon"]}),"Coze.cn 插件"]})}):null]}):null]})},N=r("881305"),S=[{label:y.o.t("Create_time"),value:m.d$.CreateTime},{label:y.o.t("Update_time"),value:m.d$.UpdateTime}],E=e=>{var{query:t,setQuery:r}=e;return(0,i.jsx)("div",{className:N.Z["plugin-modal-filter"],children:t.type===v.eL.Mine||t.type===v.eL.Team||t.type===v.eL.Project?(0,i.jsxs)(j.Cj,{label:y.o.t("Sort"),value:t.orderBy,optionList:S,onChange:e=>{r({orderBy:e})},children:[(0,i.jsx)(j.Ph.Option,{value:m.d$.CreateTime,children:y.o.t("Create_time")}),(0,i.jsx)(j.Ph.Option,{value:m.d$.UpdateTime,children:y.o.t("Edit_time_2")})]}):null})},T=r("998600"),I=r("474872"),P=r("910376"),A=r("196163"),D=e=>{var{query:t,setQuery:r,from:n,onCreateSuccess:o,isShowStorePlugin:a,hideCreateBtn:s}=e,[d,c]=(0,l.useState)(!1),p=(0,u.rY)(e=>e.space.id),m=e=>{r({search:null!=e?e:""})},{run:_,cancel:f}=(0,T.Z)(e=>{m(e)},{wait:300});return(0,i.jsxs)(i.Fragment,{children:[s?null:(0,i.jsx)(P.rm,{projectId:t.projectId,isCreate:!0,visible:d,onSuccess:e=>{null==o||o({spaceId:p,pluginId:e})},onCancel:()=>{c(!1)}}),(0,i.jsxs)(j.yh,{style:{paddingTop:16},children:[(0,i.jsxs)(j.yh.Header,{children:[(0,i.jsx)(I.yO,{tabIndex:-1,value:t.search,maxLength:100,onSearch:e=>{e?_(e):(f(),m(e))},placeholder:y.o.t("Search"),"data-testid":"plugin.modal.search"}),s?null:(0,i.jsx)(j.y3,{"data-testid":"plugin.modal.create.plugin",className:A.Z.addbtn,theme:"solid",onClick:()=>{if(o&&(n===v.tx.ProjectIde||n===v.tx.ProjectWorkflow)){c(!0);return}window.open("/space/".concat(p,"/library?type=1"))},children:y.o.t("plugin_create")})]}),(0,i.jsx)(j.yh.Content,{children:(0,i.jsx)(k,{isSearching:""!==t.search,type:t.type,onChange:e=>{r({type:e})},from:n,projectId:t.projectId,isShowStorePlugin:a})})]})]})},L=r("322512"),O=r("136515"),Z=r("207524"),F=r("381357"),M=r("364676"),z=r("734390"),R=r("298203"),B=r("366714"),V=(e,t,r,n)=>(t||r)&&!n?{text:{emptyTitle:y.o.t("plugin_empty_desc"),emptyDesc:y.o.t("plugin_empty_description")},btn:{emptyClick:()=>{window.open("/space/".concat(e,"/library?type=1"))},emptyText:y.o.t("plugin_create")}}:{text:{emptyTitle:y.o.t("plugin_empty_desc"),emptyDesc:""},btn:{emptyClick:()=>{window.open("/store/plugin")},emptyText:y.o.t("mkl_plugin_to_plugin_gallery")}},U=e=>{var{query:t,pluginApiList:r,onPluginApiListChange:s,openMode:d,from:c,openModeCallback:p,showButton:m,showCopyPlugin:f,onCopyPluginCallback:x,clickProjectPluginCallback:g}=e,{type:y,mineActive:b,search:w,isOfficial:C,orderBy:k,orderByPublic:N,orderByFavorite:S,agentId:E,pluginType:T}=t,I=(0,u.rY)(e=>e.space.id),P=(0,l.useRef)(null),[A,D]=(0,l.useState)([]),U=(0,l.useRef)(null),{scroll2Top:H,loadData:W,isSearching:G,isFavorite:K,isTemplate:J,isProject:q,isMine:$,isTeam:X}=function(e){var t,{scrollContainer:r,query:i,triggerService:a,formatCacheKey:s,onSetScrollData:d}=e,{search:c,type:u,mineActive:p}=i,m=""!==c,f=u===v.eL.Mine,h=u===v.eL.Team,x=u===v.eL.Favorite,g=u===v.eL.Project,y=u===v.eL.Coze,b=p===v.gp.Mine,j=Number(u)>=0||"recommend"===u,w=(e,t,r)=>{var i=(0,R.lJ)(t);if(!t||!i)return!1;var{data:l}=i;if(!r)return i.data;var a=(null==e?void 0:e.nextPage)||1,{list:s,total:c}=l||{list:[],total:0},u=c>0&&a*v.L8<c;return d((0,o._)((0,n._)({},e),{hasMore:u,list:[...(null==a?void 0:a.list)||[],...s]})),!1},C=(e,t,r)=>{if(!!e)(0,R.K7)(e,t,{time:Date.now(),data:r})};var k=(t=(0,_._)(function*(e){var t=(null==e?void 0:e.nextPage)||1,r=s({query:i,isSearching:m,isTemplate:j,page:t})||"";!f&&!h&&(r="");var n=w(e,r,!j);!n&&C(r,3e5,n=yield a(i,{nextPage:t,isMine:f,isTeam:h,isCreatorMine:b,isTemplate:j,isFavorite:x,isProject:g,isCoze:y}));var{list:o,hasMore:l}=n||{list:[],total:0},d=t+1,c={};return((null==e?void 0:e.list)||[]).map(e=>{var t;c[null==e?void 0:null===(t=e.pluginInfo)||void 0===t?void 0:t.id]=!0}),{list:(o||[]).filter(e=>{var t,r=null==e?void 0:null===(t=e.pluginInfo)||void 0===t?void 0:t.id;return(!r||!c[r])&&!0})||[],hasMore:l,nextPage:d}}),function(e){return t.apply(this,arguments)});return(0,l.useEffect)(()=>{(0,R.LK)()},[]),{scroll2Top:()=>{r.current&&r.current.scrollTo({top:0})},isSearching:m,loadData:k,isFavorite:x,isTemplate:j,isMine:f,isTeam:h,isProject:g}}({query:t,formatCacheKey:v.TB,scrollContainer:P,triggerService:v.Ht,onSetScrollData:e=>{var t;null===(t=U.current)||void 0===t||t.mutate(e)}}),{nodes:Y}=(0,M.I)((0,a.N)(e=>({nodes:e.nodes})));return(0,O.Z)(()=>{H()},[]),(0,i.jsx)(j.vy,{children:(0,i.jsx)("div",{className:B.Z["plugin-content"],ref:P,children:(0,i.jsx)(j.vy.Content,{style:{minHeight:"100%",display:"flex"},children:(0,i.jsx)(j.UO,{className:B.Z["plugin-collapse"],activeKey:A,onChange:e=>{D(e)},expandIcon:(0,i.jsx)(Z.Z,{className:B.Z["collapse-icon"],"data-testid":"plugin-collapse-panel-expand"}),collapseIcon:(0,i.jsx)(F.Z,{className:B.Z["collapse-icon"],"data-testid":"plugin-collapse-panel-collapse"}),children:(0,i.jsx)(z.$r,{ref:U,itemClassName:B.Z["item-container"],renderItem:(e,t)=>{var l,a,u,_=null==e?void 0:null===(l=e.pluginInfo)||void 0===l?void 0:l.id;return(0,i.jsx)(v.WB,{agentId:E,index:t,pluginApiList:r,onPluginApiListChange:s,onCopyPluginCallback:x,showButton:m,showCopyPlugin:f,openMode:d,from:c,workflowNodes:Y,openModeCallback:p,highlightWords:[w],showCreator:!0,showMarketLink:K||J,showCreateTime:0===k||"number"==typeof y,showPublishTime:!$&&!X&&!q,activeKey:A,scrollContainerRef:P,isFromMarket:null==e?void 0:e.isFromMarket,info:(0,o._)((0,n._)({},null==e?void 0:e.pluginInfo),{id:_,listed_at:null==e?void 0:null===(a=e.productInfo)||void 0===a?void 0:a.listed_at,plugin_apis:(0,L.Z)(null==e?void 0:null===(u=e.pluginInfo)||void 0===u?void 0:u.plugin_apis,e=>e.name)}),productInfo:null==e?void 0:e.productInfo,commercialSetting:null==e?void 0:e.commercial_setting,type:String(y||""),className:h()(B.Z["plugin-collapse"],{[B.Z.activePanel]:null==A?void 0:A.includes(null!=_?_:"")}),showProjectPluginLink:q,clickProjectPluginCallback:g},_)},emptyConf:V(I,$,X,q),scrollConf:{reloadDeps:[y,b,w,C,k,N,S,T],targetRef:P,loadData:W},isSearching:G})})})})})},H=(e,t)=>e!==v.tx.ProjectWorkflow&&e===v.tx.ProjectIde&&t&&e?t===m.Sn.Personal?v.eL.Mine:t===m.Sn.Team&&e===v.tx.ProjectIde?v.eL.Team:"":"",W=e=>{var t,r,{pluginApiList:_,onPluginApiListChange:f,agentId:h,openMode:x,from:g,openModeCallback:y,showButton:b,showCopyPlugin:j,onCopyPluginCallback:w,projectId:C,clickProjectPluginCallback:k,onCreateSuccess:N,isShowStorePlugin:S,hideCreateBtn:T,initQuery:I}=e,P=s.Z.useUserInfo(),A=(0,u.rY)(e=>e.space.space_type),[L,O]=(0,l.useState)({agentId:h,projectId:C,devId:(null==P?void 0:P.user_id_str)||"",search:"",page:v.XJ,type:null!==(t=null==I?void 0:I.type)&&void 0!==t?t:H(g,A),orderBy:m.d$.CreateTime,orderByPublic:p.ER.Heat,orderByFavorite:p.ER.Newest,mineActive:v.gp.All,isOfficial:null!==(r=null==I?void 0:I.isOfficial)&&void 0!==r?r:void 0,pluginType:g===v.tx.ProjectWorkflow?p.zV.CLoudPlugin:void 0}),{botId:Z}=(0,c.G)((0,a.N)(e=>({botId:e.botId}))),{version:F}=(0,d.c2)((0,a.N)(e=>({version:e.baseVersion}))),M=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r={current_entity_type:p._J.Bot,current_entity_id:Z,current_entity_version:F};O(i=>t?(0,o._)((0,n._)({},i,e),{page:v.XJ,botInfo:r}):(0,o._)((0,n._)({},i,e),{botInfo:r}))},z=(0,i.jsx)(D,{hideCreateBtn:T,query:L,setQuery:M,from:g,onCreateSuccess:N,isShowStorePlugin:S}),R=(0,i.jsx)(E,{from:g,query:L,setQuery:M});return{sider:z,content:(0,i.jsx)(U,{query:L,setQuery:M,pluginApiList:_,onPluginApiListChange:f,openMode:x,from:g,openModeCallback:y,showButton:b,showCopyPlugin:j,onCopyPluginCallback:w,clickProjectPluginCallback:k}),filter:R}}},910376:function(e,t,r){r.d(t,{Tj:()=>er,cC:()=>ei,e2:()=>eo,rm:()=>Y,_u:()=>en});var n,o,i=r("825955"),l=r("151064"),a=r("455069"),s=r("808549"),d=r("120454"),c=r("735114"),u=r("215451"),p=r("581259"),m=r("368696"),v=r("75117"),_=r("297158"),f=r("336205"),h=r("915757"),x=r("674343"),g=r("298203"),y=r("189284"),b=r("178385"),j=r("382534"),w=r("625196"),C=r("458949"),k={name:[{required:!0,message:f.o.t("create_plugin_modal_name1_error")},{pattern:RegExp("^[\\w\\s\\u4e00-\\u9fa5]+$","u"),message:f.o.t("create_plugin_modal_nameerror_cn")}],desc:[{required:!0,message:f.o.t("create_plugin_modal_descrip1_error")},{}],url:[{required:!0,message:f.o.t("create_plugin_modal_url1_error")}],key:[{required:!0,message:f.o.t("create_plugin_modal_Parameter_error")},{pattern:/^[\x00-\x7F]+$/,message:f.o.t("plugin_Parametename_error")}],service_token:[{required:!0,message:f.o.t("create_plugin_modal_Servicetoken_error")}]},N=e=>{var t,r;if(!!e)return[{url:(null===(t=e.icon)||void 0===t?void 0:t.url)||"",uid:(null==e?void 0:null===(r=e.icon)||void 0===r?void 0:r.uri)||""}]},S=(e,t,r)=>{if((null==t?void 0:t[0])===0)return e.find(e=>0===e.value);if((null==t?void 0:t[0])===1){var n=e.find(e=>1===e.value);return null==n?void 0:n.children.find(e=>e.value===r)}if((null==t?void 0:t[0])===3){var o=e.find(e=>3===e.value);return null==o?void 0:o.children.find(e=>e.value===r)}},E=()=>{var e,[t,r]=(0,a.useState)([]),[n,o]=(0,a.useState)([]),[l,s]=(0,a.useState)("1");var d=(e=(0,i._)(function*(){var e,t,n=yield j.Js.GetOAuthSchema();r([{label:f.o.t("create_plugin_modal_Authorization_no"),value:0,key:"None"},{label:f.o.t("create_plugin_modal_Authorization_service"),value:1,key:"Service",children:[{label:f.o.t("plugin_auth_method_service_api_key"),value:0,key:"Service Token / API Key"}]},{label:f.o.t("create_plugin_modal_Authorization_oauth"),value:3,key:"OAuth",children:(0,g.dj)(n.oauth_schema)}]);var i=null===(t=(0,g.dj)(n.ide_conf,[]))||void 0===t?void 0:null===(e=t.find)||void 0===e?void 0:e.call(t,e=>"code_runtime_enum"===e.key);i&&(o(i.options.map(e=>({value:e.value,label:e.name}))),s(i.default))}),function(){return e.apply(this,arguments)});return(0,a.useEffect)(()=>{d()},[]),{authOption:t,runtimeOptions:n,defaultRuntime:l}},T=e=>{var t,r,n,o,i,{val:l,spaceId:a,headerList:c,projectId:u,creationMethod:p,defaultRuntime:m,pluginType:v,extItemsJSON:_}=e,f=null===(t=l.auth_type)||void 0===t?void 0:t.at(0),h=null===(r=l.auth_type)||void 0===r?void 0:r.at(-1),x=(0,d._)((0,s._)({},l),{icon:{uri:null==l?void 0:null===(o=l.plugin_uri)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.uid},auth_type:f,common_params:{[C.Pi.Header]:c,[C.Pi.Body]:[],[C.Pi.Path]:[],[C.Pi.Query]:[]},space_id:a,project_id:u,creation_method:p,ide_code_runtime:null!==(i=l.ide_code_runtime)&&void 0!==i?i:m,plugin_type:Number(v),private_link_id:"0"===l.private_link_id?void 0:l.private_link_id});return 1===f?(0,d._)((0,s._)({},x),{sub_auth_type:h,auth_payload:JSON.stringify(_)}):(0,d._)((0,s._)({},x),{sub_auth_type:3===f?h:void 0,oauth_info:JSON.stringify(_)})};var I=(n=(0,i._)(function*(e){var{params:t}=e;return(yield j.Js.RegisterPluginMeta((0,s._)({},t),{__disableErrorToast:!0})).plugin_id}),function(e){return n.apply(this,arguments)});var P=(o=(0,i._)(function*(e){var{params:t,editInfo:r}=e;return yield j.Js.UpdatePluginMeta((0,d._)((0,s._)({},t),{plugin_id:(null==r?void 0:r.plugin_id)||"",edit_version:null==r?void 0:r.edit_version}),{__disableErrorToast:!0}),""}),function(e){return o.apply(this,arguments)}),A=r("274038"),D=e=>e?"".concat(null==e?void 0:e.plugin_type,"-").concat(null==e?void 0:e.creation_method):"",L=(0,x.Q2)(x.vT),O=()=>[{label:f.o.t("plugin_creation_method_cloud_plugin_use_existing_services"),value:p.Qb}],Z=e=>{var t,r,n,o,C,E,T,I,P,Z,F,M,z,R,B,V,U,H,W,{pluginState:G,disabled:K,editInfo:J,isCreate:q,visible:$}=e,{formApi:X,extItems:Y,setExtItems:Q,headerList:ee,setHeaderList:et,isValidCheckResult:er,setIsValidCheckResult:en,pluginTypeCreationMethod:eo,setPluginTypeCreationMethod:ei,authOption:el}=G,[ea]=(0,y.V)(),{compareLevel:es}=(0,u.th)(),ed=(0,m.HU)(),[ec,eu]=(0,a.useState)(0),[ep,em]=(0,a.useState)(0),[ev,e_]=(0,a.useState)(!1),ef=()=>{!er&&en(!0)},eh=O(),ex=(0,p.C5)(),[eg,ey]=(0,a.useState)(),{data:eb}=(0,c.Z)((0,i._)(function*(){var e,{data:t}=yield j.Js.PrivateLinkList({enterprise_id:null==ed?void 0:ed.enterprise_id});ey(null==t?void 0:t.private_links);var r=null==t?void 0:null===(e=t.private_links)||void 0===e?void 0:e.map(e=>({label:e.name,value:e.id}));return[{label:f.o.t("vpc_plugin_create_plugin_2"),value:"0"},...null!=r?r:[]]}),{ready:es===u.aZ.Enterprise&&ea["bot.studio.plugin_vpc"]&&!1});var ej=(t=(0,i._)(function*(){try{var e,t,r,n=yield j.nA.GetIcon({icon_type:b.Tu.Plugin}),o=null===(t=n.data)||void 0===t?void 0:null===(e=t.icon_list)||void 0===e?void 0:e[0];if(!o)return;var{url:i="",uri:l=""}=o;null===(r=X.current)||void 0===r||r.setValue("plugin_uri",[{url:i,uid:l}])}catch(e){_.kg.info("getIcon error: ".concat(e))}}),function(){return t.apply(this,arguments)});(0,a.useEffect)(()=>{if(!!$)if(!q&&J){var e,t,r,n,o,i,l,a,s,d,c,p,m,v,_,f,h,x;if((null===(t=J.meta_info)||void 0===t?void 0:null===(e=t.auth_type)||void 0===e?void 0:e.at(0))===1)switch(null===(m=J.meta_info)||void 0===m?void 0:m.sub_auth_type){case 0:em(5);break;case 1:em(6);break;case 2:em(7);break;default:em(0)}else em(null!==(f=null===(_=J.meta_info)||void 0===_?void 0:null===(v=_.auth_type)||void 0===v?void 0:v.at(-1))&&void 0!==f?f:0);eu(null!==(h=null===(n=J.meta_info)||void 0===n?void 0:null===(r=n.auth_type)||void 0===r?void 0:r.at(0))&&void 0!==h?h:0),Q((null===(o=S(el,null===(i=J.meta_info)||void 0===i?void 0:i.auth_type,null!==(x=null===(a=J.meta_info)||void 0===a?void 0:null===(l=a.auth_type)||void 0===l?void 0:l[1])&&void 0!==x?x:null===(s=J.meta_info)||void 0===s?void 0:s.sub_auth_type))||void 0===o?void 0:o.items)||[]),et([...(null===(c=J.meta_info)||void 0===c?void 0:null===(d=c.common_params)||void 0===d?void 0:d[4])||[]]),ei("".concat(J.plugin_type,"-").concat(J.creation_method)),(null==J?void 0:null===(p=J.meta_info)||void 0===p?void 0:p.private_link_id)&&es===u.aZ.Enterprise&&ea["bot.studio.plugin_vpc"]&&e_(!0)}else ew()},[$]);var ew=()=>{ej(),em(0),em(0),Q([]),et([{name:"User-Agent",value:"Coze/1.0"}]),en(!0),ei(void 0)},eC=()=>{et(e=>[...e,{name:"",value:""}])},ek=e=>{et(t=>t.length<=1?[{name:"",value:""}]:t.filter((t,r)=>r!==e))},eN=(e,t)=>{et(r=>r.map((r,n)=>n===e?t:r))};return(0,l.jsxs)(x.l0,{getFormApi:e=>X.current=e,autoScrollToError:!0,showValidateIcon:!1,className:A.Z["upload-form"],onValueChange:e=>{if("auth_type"in e){if(1===e.auth_type.at(0))switch(e.auth_type.at(-1)){case 0:em(5);break;case 1:em(6);break;case 2:em(7);break;default:em(0)}else em(e.auth_type.at(-1));eu(e.auth_type.at(0))}},children:[(0,l.jsx)(v.s,{noLabel:!0,disabled:K,fieldClassName:A.Z["upload-field"],field:"plugin_uri",iconType:b.Tu.Plugin,fileBizType:b.ym.BIZ_PLUGIN_ICON,initValue:N(null==J?void 0:J.meta_info),onChange:ef}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.ld,{disabled:K,initValue:null==J?void 0:null===(U=J.meta_info)||void 0===U?void 0:U.name,field:"name",className:A.Z["textarea-single-line"],label:f.o.t("create_plugin_modal_name1"),placeholder:f.o.t("create_plugin_modal_name2"),trigger:["blur","change"],maxCount:30,maxLength:30,rows:1,onBlur:()=>{var e,t,r;null===(r=X.current)||void 0===r||r.setValue("name",null===(t=X.current)||void 0===t?void 0:null===(e=t.getValue("name"))||void 0===e?void 0:e.trim())},onChange:ef,rules:k.name}),(0,l.jsx)(x.ld,{disabled:K,initValue:null==J?void 0:null===(H=J.meta_info)||void 0===H?void 0:H.desc,field:"desc",label:f.o.t("create_plugin_modal_descrip1"),trigger:["blur","change"],placeholder:f.o.t("create_plugin_modal_descrip2"),rows:2,maxCount:600,maxLength:600,onBlur:()=>{var e,t,r;null===(r=X.current)||void 0===r||r.setValue("desc",null===(t=X.current)||void 0===t?void 0:null===(e=t.getValue("desc"))||void 0===e?void 0:e.trim())},onChange:ef,rules:k.desc}),(0,l.jsx)(x.l0.Slot,{label:{text:f.o.t("plugin_creation_method"),required:!0,extra:(0,l.jsx)(w.O,{data:ex})},children:q?(0,l.jsx)(x.l0.RadioGroup,{noLabel:!0,className:A.Z["creation-method"],direction:"vertical",rules:[{required:!0,message:f.o.t("plugin_creation_select_creation_method_warning")}],field:"creation_method",disabled:K,options:eh,initValue:J?D(J):void 0,onChange:e=>ei(e.target.value)}):(0,l.jsx)(x.ZT.Text,{fontSize:"14px",children:null===(W=eh.find(e=>e.value===eo))||void 0===W?void 0:W.label})})]}),eo===p.Qb?(V=[0],!J&&(V=[0]),(null==J?void 0:null===(n=J.meta_info)||void 0===n?void 0:null===(r=n.auth_type)||void 0===r?void 0:r.length)===2?V=null==J?void 0:null===(P=J.meta_info)||void 0===P?void 0:P.auth_type:(null==J?void 0:null===(F=J.meta_info)||void 0===F?void 0:null===(Z=F.auth_type)||void 0===Z?void 0:Z.at(0))===0?V=null==J?void 0:null===(M=J.meta_info)||void 0===M?void 0:M.auth_type:void 0!==(null==J?void 0:null===(z=J.meta_info)||void 0===z?void 0:z.sub_auth_type)&&(V=[...(null==J?void 0:null===(R=J.meta_info)||void 0===R?void 0:R.auth_type)||[],null==J?void 0:null===(B=J.meta_info)||void 0===B?void 0:B.sub_auth_type]),(0,l.jsxs)(l.Fragment,{children:[es===u.aZ.Enterprise&&ea["bot.studio.plugin_vpc"]?(0,l.jsx)(x.ih,{label:{text:f.o.t("vpc_plugin_create_plugin_1"),required:!0,extra:(0,l.jsx)(w.O,{data:p.HW.private_link_id})},field:"private_link_id",style:{width:"100%"},initValue:(null==J?void 0:null===(o=J.meta_info)||void 0===o?void 0:o.private_link_id)||"0",onChange:e=>{var t,r,n;e_("0"!==e),"0"===e?null===(t=X.current)||void 0===t||t.setValue("url",""):null===(n=X.current)||void 0===n||n.setValue("url",null==eg?void 0:null===(r=eg.find(t=>t.id===e))||void 0===r?void 0:r.plugin_access_url)},optionList:eb}):null,K?null:(0,l.jsx)(x.yt,{disabled:ev,className:A.Z["textarea-single-line"],initValue:null==J?void 0:null===(C=J.meta_info)||void 0===C?void 0:C.url,trigger:["blur","change"],field:"url",label:f.o.t("create_plugin_modal_url1"),placeholder:f.o.t("create_plugin_modal_url2"),onBlur:()=>{var e,t,r;null===(r=X.current)||void 0===r||r.setValue("url",null===(t=X.current)||void 0===t?void 0:null===(e=t.getValue("url"))||void 0===e?void 0:e.trim())},rules:ev?[]:k.url}),(0,l.jsx)(x.l0.Slot,{className:A.Z["header-list"],label:{text:f.o.t("plugin_create_header_list_title"),align:"right",extra:(0,l.jsxs)("div",{className:A.Z["header-list-extra"],children:[(0,l.jsx)(w.O,{data:p.HW.header_list}),ee.length<20&&!K&&(0,l.jsx)(x.hU,{size:"small",color:"secondary",icon:(0,l.jsx)(h.PwN,{className:"coz-fg-hglt text-[16px]"}),onClick:eC})]})},children:(0,l.jsxs)("div",{className:A.Z["header-list-box"],children:[(0,l.jsxs)(x.X2,{className:A.Z["header-row"],children:[(0,l.jsx)(x.JX,{span:9,children:(0,l.jsx)("div",{className:A.Z["header-col-content"],children:"Key"})}),(0,l.jsx)(x.JX,{span:12,children:(0,l.jsx)("div",{className:A.Z["header-col-content"],children:"Value"})}),(0,l.jsx)(x.JX,{span:3,children:(0,l.jsx)("div",{className:A.Z["header-col-content"],children:f.o.t("plugin_create_action_btn")})})]}),(0,l.jsx)("div",{children:null==ee?void 0:ee.map((e,t)=>(0,l.jsxs)(x.X2,{type:"flex",justify:"space-between",align:"middle",children:[(0,l.jsx)(x.JX,{span:9,children:(0,l.jsx)("div",{className:A.Z["col-content"],children:(0,l.jsx)(x.II,{placeholder:"Name",value:e.name,onChange:r=>{eN(t,(0,d._)((0,s._)({},e),{name:r}))},maxLength:100,disabled:K})})}),(0,l.jsx)(x.JX,{span:12,children:(0,l.jsx)("div",{className:A.Z["col-content"],children:(0,l.jsx)(x.II,{placeholder:"Value",value:e.value,onChange:r=>{eN(t,(0,d._)((0,s._)({},e),{value:r}))},maxLength:2e3,disabled:K})})}),(0,l.jsx)(x.JX,{span:3,children:(0,l.jsx)("div",{className:A.Z["col-content"],children:(0,l.jsx)(x.hU,{size:"small",color:"secondary",icon:(0,l.jsx)(h.dVD,{className:"coz-fg-secondary text-[14px]"}),disabled:K,onClick:()=>ek(t)})})})]},t))})]})}),(0,l.jsx)(L,{disabled:K,rules:[{required:!0}],style:{width:"100%"},initValue:V,field:"auth_type",label:{text:f.o.t("create_plugin_modal_auth1"),extra:(0,l.jsx)(w.O,{data:p.HW.auth})},placeholder:f.o.t("please_select_an_authorization_method"),treeData:el,displayRender:e=>"".concat(e.at(-1)),onChange:e=>{var t;Q((null===(t=S(el,[e.at(0)],e.at(-1)))||void 0===t?void 0:t.items)||[])}}),1===ec&&5===ep&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.l0.RadioGroup,{disabled:K,rules:[{required:!0}],field:"location",label:{text:f.o.t("create_plugin_modal_location"),extra:(0,l.jsx)(w.O,{data:p.HW.location})},options:p.cg,initValue:(null==J?void 0:null===(E=J.meta_info)||void 0===E?void 0:E.location)||1}),(0,l.jsx)(x.yt,{disabled:K,initValue:null==J?void 0:null===(T=J.meta_info)||void 0===T?void 0:T.key,trigger:["blur","change"],field:"key",label:{text:f.o.t("create_plugin_modal_Parameter"),extra:(0,l.jsx)(w.O,{data:p.HW.key})},placeholder:f.o.t("create_plugin_modal_Parameter_empty"),maxLength:100,rules:k.key}),(0,l.jsx)(x.yt,{disabled:K,initValue:null==J?void 0:null===(I=J.meta_info)||void 0===I?void 0:I.service_token,trigger:["blur","change"],field:"service_token",label:{text:f.o.t("create_plugin_modal_Servicetoken"),extra:(0,l.jsx)(w.O,{data:p.HW.service_token})},placeholder:f.o.t("create_plugin_modal_Servicetoken_empty"),maxLength:2e3,rules:k.service_token})]}),null==Y?void 0:Y.map((e,t)=>{var r,n,o,i,s={};return((null==J?void 0:null===(n=J.meta_info)||void 0===n?void 0:null===(r=n.auth_type)||void 0===r?void 0:r.at(0))===1&&(s=(0,g.dj)(J.meta_info.auth_payload)),(null==J?void 0:null===(i=J.meta_info)||void 0===i?void 0:null===(o=i.auth_type)||void 0===o?void 0:o.at(0))===3&&(s=(0,g.dj)(J.meta_info.oauth_info)),"select"===e.type)?(0,l.jsx)(x.ih,{disabled:K,label:(null==e?void 0:e.label)||e.key,field:e.key,optionList:p.Cx,initValue:(null==s?void 0:s[e.key])||e.default,style:{width:"100%"},rules:[{required:e.required,message:p.VF[e.key]}]},e.key+t):(0,l.jsx)(a.Fragment,{children:(0,l.jsx)(x.yt,{disabled:K,trigger:["blur","change"],field:e.key,label:{text:(null==e?void 0:e.label)||e.key,extra:p.HW[e.key]&&(0,l.jsx)(w.O,{data:p.HW[e.key]})},placeholder:p.VF[e.key],initValue:(null==s?void 0:s[e.key])||e.default,maxLength:e.max_len,rules:[{required:e.required,message:p.VF[e.key]},"url"===e.type?{pattern:/^(http|https):\/\/.+$/,message:f.o.t("create_plugin_modal_URLerror")}:{pattern:/^[\x00-\x7F]+$/,message:f.o.t("create_plugin_modal_descrip_error")},...(null==e?void 0:e.ruleList)||[]]},e.key)},e.key+t)})]})):null]})},F=()=>{var e=(0,a.useRef)(),{authOption:t,runtimeOptions:r,defaultRuntime:n}=E(),[o,i]=(0,a.useState)([]),[l,s]=(0,a.useState)([{name:"User-Agent",value:"Coze/1.0"}]),[d,c]=(0,a.useState)(!0),[u,p]=(0,a.useState)();return{formApi:e,extItems:o,setExtItems:i,headerList:l,setHeaderList:s,isValidCheckResult:d,setIsValidCheckResult:c,pluginTypeCreationMethod:u,setPluginTypeCreationMethod:p,authOption:t,runtimeOptions:r,defaultRuntime:n}},M=r("947578"),z=r("214942"),R=r("900021"),B=r("927070"),V=r("3779"),U=r("786406"),H=e=>{var{onCancel:t,onSuccess:r,projectId:n}=e,[o,i]=(0,a.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(U.iy,{projectId:n,visible:o,onSuccess:e=>{var t=null==e?void 0:e.plugin_id;t?null==r||r(t):null==r||r()},onCancel:()=>i(!1)}),(0,l.jsx)(x.zx,{color:"primary",onClick:()=>{i(!0),null==t||t()},children:f.o.t("import")})]})},W=r("44172"),G=r("252237"),K=r.n(G),J=r("775699"),q=r("512421"),$=e=>{var t,{isCreate:r=!0,onCancel:n,editInfo:o,visible:c,onSuccess:u,disabled:p=!1,actions:m,projectId:v}=e,[_,h]=(0,a.useState)(),[x,y]=(0,a.useState)(),[b,w]=(0,a.useState)(),[C,k]=(0,a.useState)(),[N,S]=(0,a.useState)();(0,a.useEffect)(()=>{if(c){var e,t,r,n,i;h(JSON.stringify((0,g.dj)(null==o?void 0:null===(e=o.code_info)||void 0===e?void 0:e.plugin_desc),null,2)||""),S((null==o?void 0:null===(t=o.code_info)||void 0===t?void 0:t.openapi_desc)||""),y(null==o?void 0:null===(r=o.code_info)||void 0===r?void 0:r.client_id),w(null==o?void 0:null===(n=o.code_info)||void 0===n?void 0:n.client_secret),k(null==o?void 0:null===(i=o.code_info)||void 0===i?void 0:i.service_token)}},[c]);var E=(t=(0,i._)(function*(){var e,t,i={ai_plugin:_,client_id:x,client_secret:b,service_token:C,openapi:N};r?t=yield j.Js.RegisterPlugin((0,d._)((0,s._)({},i),{project_id:v,space_id:z.rY.getState().getSpaceId()})):yield j.Js.UpdatePlugin((0,d._)((0,s._)({},i),{plugin_id:null==o?void 0:o.plugin_id,edit_version:null==o?void 0:o.edit_version})),J.FN.success({content:r?f.o.t("register_success"):f.o.t("Plugin_update_success"),showClose:!1}),null==u||u(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.plugin_id),null==n||n()}),function(){return t.apply(this,arguments)});return(0,l.jsx)(J.M5,{fullScreen:!0,className:"full-screen-modal",title:(0,l.jsxs)("div",{className:B.Z["bot-code-edit-title-action"],children:[(0,l.jsx)("span",{children:r?f.o.t("plugin_create"):f.o.t("plugin_Update")}),(0,l.jsx)("div",{children:m})]}),visible:c,onCancel:()=>null==n?void 0:n(),footer:p?null:(0,l.jsxs)(J.T,{children:[(0,l.jsx)(J.y3,{type:"tertiary",onClick:()=>null==n?void 0:n(),children:f.o.t("Cancel")}),(0,l.jsx)(J.y3,{type:"primary",onClick:E,children:f.o.t("Confirm")})]}),maskClosable:!1,children:(0,l.jsx)("div",{className:K()(B.Z.flex),children:(0,l.jsx)("div",{className:K()(B.Z["plugin-height"],B.Z.flex5),children:(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)("div",{style:{flex:1,borderRight:"1px solid rgb(215,218,221)"},children:[(0,l.jsx)("div",{className:B.Z.title,children:f.o.t("ai_plugin_(fill_in_json)_*")}),(0,l.jsx)(q.M,{dataTestID:"create-plugin-code-editor-json",disabled:p,theme:"tomorrow",mode:"json",height:560,value:_,useValidate:!1,onChange:e=>h(e)})]}),(0,l.jsxs)("div",{style:{flex:1},children:[(0,l.jsx)("div",{className:B.Z.title,children:f.o.t("openapi_(fill_in_yaml)_*")}),(0,l.jsx)(q.M,{dataTestID:"create-plugin-code-editor-yaml",disabled:p,theme:"tomorrow",mode:"yaml",height:560,value:N,useValidate:!1,onChange:e=>S(e)})]})]})})})})},X=e=>{var{onCancel:t,onSuccess:r,projectId:n}=e,[o,i]=(0,a.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)($,{isCreate:!0,visible:o,onSuccess:e=>{null==r||r(e)},onCancel:()=>{i(!1)},projectId:n}),(0,l.jsx)(x.zx,{"data-testid":"create-plugin-code-modal-button",color:"primary",icon:(0,l.jsx)(W.WTs,{}),onClick:()=>{i(!0),null==t||t()}})]})},Y=e=>{var t,{onCancel:r,editInfo:n,isCreate:o=!0,visible:s,onSuccess:d,disabled:c=!1,projectId:u}=e,{id:p}=(0,z.rY)(e=>e.space),m=(0,a.useMemo)(()=>o?(0,l.jsxs)("div",{className:"w-full flex justify-between items-center pr-[8px]",children:[(0,l.jsx)("div",{children:f.o.t("create_plugin_modal_title1")}),(0,l.jsxs)(x.T,{children:[(0,l.jsx)(X,{onCancel:r,onSuccess:d,projectId:u}),(0,l.jsx)(H,{onCancel:r,onSuccess:d,projectId:u}),(0,l.jsx)(x.iz,{layout:"vertical",className:"h-5"})]})]}):c?f.o.t("plugin_detail_view_modal_title"):f.o.t("plugin_detail_edit_modal_title"),[o,c]),[v,_]=(0,a.useState)(!1),g=F(),{formApi:y,extItems:b,headerList:j,isValidCheckResult:w,setIsValidCheckResult:C,pluginTypeCreationMethod:k,defaultRuntime:N}=g;(0,a.useEffect)(()=>{if(!!o)if(s){var e,t=document.querySelector(".create-plugin-modal-content .semi-modal-body");t&&(t.scrollTop=0)}else null==y||null===(e=y.current)||void 0===e||e.reset()},[s]);var S=(t=(0,i._)(function*(){yield null===(e=y.current)||void 0===e?void 0:e.validate();var e,t,i=o?"create":"edit",l=null===(t=y.current)||void 0===t?void 0:t.getValues();if(!!l&&!!k){var a={};null==b||b.forEach(e=>{e.key in l&&(a[e.key]=l[e.key])});var[s,c]=k.split("-"),m=T({val:l,spaceId:String(p),headerList:j,projectId:u,creationMethod:Number(c),defaultRuntime:N,pluginType:Number(s),extItemsJSON:a});try{_(!0);var v=yield({create:()=>I({params:m}),edit:()=>P({params:m,editInfo:n})})[i]();x.FN.success({content:o?f.o.t("Plugin_new_toast_success"):f.o.t("Plugin_update_toast_success"),showClose:!1}),null==r||r(),null==d||d(v)}catch(e){var{code:h,msg:g}=e;Number(h)===R.B.SAFE_CHECK?C(!1):x.FN.error({content:(0,M.u)(g)})}finally{_(!1)}}}),function(){return t.apply(this,arguments)});return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(x.u_,{title:m,className:"[&_.semi-modal-header]:items-center",visible:s,keepDOM:o,onCancel:()=>null==r?void 0:r(),modalContentClass:"create-plugin-modal-content",footer:!c&&(0,l.jsxs)("div",{children:[!w&&(0,l.jsx)("div",{className:B.Z["error-msg-box"],children:(0,l.jsx)("span",{className:B.Z["error-msg"],children:f.o.t("plugin_create_modal_safe_error")})}),(0,l.jsxs)(x.ZT.Paragraph,{type:"secondary",fontSize:"12px",className:"text-start mb-[16px]",children:[(0,l.jsx)(h.DIY,{className:"coz-fg-hglt text-[14px] align-sub"}),(0,l.jsx)("span",{className:"mx-[4px]",children:f.o.t("plugin_create_draft_desc")}),(0,l.jsx)(V.v,{})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(x.zx,{color:"primary",onClick:()=>{null==r||r()},children:f.o.t("create_plugin_modal_button_cancel")}),(0,l.jsx)(x.zx,{loading:v,onClick:()=>{S()},children:f.o.t("create_plugin_modal_button_confirm")})]})]}),children:(0,l.jsx)(Z,{pluginState:g,visible:s,isCreate:o,disabled:c,editInfo:n})})})},Q=r("664319"),ee=r("228962"),et=r("172742"),er=e=>{var{modalProps:t}=e,{pluginInfo:r,canEdit:n,unlockPlugin:o,wrapWithCheckLock:i}=(0,ee.RQ)((0,Q.N)(e=>({pluginInfo:e.pluginInfo,canEdit:e.canEdit,unlockPlugin:e.unlockPlugin,wrapWithCheckLock:e.wrapWithCheckLock}))),[c,u]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),v=(0,a.useMemo)(()=>n?(0,l.jsx)("div",{className:et.Z.actions,children:p?(0,l.jsx)(J.y3,{onClick:()=>{m(!1),o()},children:f.o.t("Cancel")}):(0,l.jsx)(J.y3,{theme:"solid",onClick:i(()=>m(!0)),children:f.o.t("Edit")})}):null,[p,n]);return(0,a.useEffect)(()=>{c&&m(!1)},[c]),{modal:(0,l.jsx)($,(0,d._)((0,s._)({},t),{isCreate:!1,visible:c,onCancel:()=>{u(!1),o()},disabled:!p||!n,editInfo:r,actions:v})),setShowCodePluginModel:u}},en=e=>{var t,{modalProps:r}=e,[n,o]=(0,a.useState)({}),[c,u]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),[v,_]=(0,a.useState)(!1),h=(null==n?void 0:n.plugin_id)||"",x=(0,a.useMemo)(()=>v?null:(0,l.jsx)("div",{className:et.Z.actions,children:p?(0,l.jsx)(J.y3,{onClick:()=>{m(!1),(0,ee.zO)(h)},children:f.o.t("Cancel")}):(0,l.jsx)(J.y3,{theme:"solid",onClick:(0,i._)(function*(){if(!(yield(0,ee.EA)(h)))m(!0)}),children:f.o.t("Edit")})}),[p,h,v]);(0,a.useEffect)(()=>{c&&m(!1)},[c]);var g=(0,l.jsx)($,(0,d._)((0,s._)({},r),{editInfo:n,isCreate:!1,visible:c,onCancel:()=>{u(!1),!v&&(0,ee.zO)(h)},disabled:!p,actions:x}));return{modal:g,open:(0,a.useCallback)((t=(0,i._)(function*(e,t){var r,n,i,l,a,s=yield j.Js.GetPluginInfo({plugin_id:e||""});o({plugin_id:e,code_info:{plugin_desc:null===(r=s.code_info)||void 0===r?void 0:r.plugin_desc,openapi_desc:null===(n=s.code_info)||void 0===n?void 0:n.openapi_desc,client_id:null===(i=s.code_info)||void 0===i?void 0:i.client_id,client_secret:null===(l=s.code_info)||void 0===l?void 0:l.client_secret,service_token:null===(a=s.code_info)||void 0===a?void 0:a.service_token}}),_(t),u(!0)}),function(e,r){return t.apply(this,arguments)}),[])}},eo=e=>{var{modalProps:t}=e,{pluginInfo:r,canEdit:n,unlockPlugin:o}=(0,ee.RQ)(e=>({pluginInfo:e.pluginInfo,canEdit:e.canEdit,unlockPlugin:e.unlockPlugin})),[i,c]=(0,a.useState)(!1);return{modal:(0,l.jsx)(Y,(0,d._)((0,s._)({},t),{isCreate:!1,visible:i,editInfo:r,onCancel:()=>{o(),c(!1)},disabled:!n})),setShowFormPluginModel:c}},ei=e=>{var t,r,n,{modalProps:o}=e,{pluginInfo:i,unlockPlugin:c}=(0,ee.RQ)(e=>({pluginInfo:e.pluginInfo,unlockPlugin:e.unlockPlugin})),[u,p]=(0,a.useState)(!1);return{modal:(0,l.jsx)(U.JI,(0,d._)((0,s._)({},o),{pluginInfo:{pluginID:null==i?void 0:i.plugin_id,pluginName:null==i?void 0:null===(t=i.meta_info)||void 0===t?void 0:t.name,pluginUrl:null==i?void 0:null===(r=i.meta_info)||void 0===r?void 0:r.url,pluginDesc:null==i?void 0:null===(n=i.meta_info)||void 0===n?void 0:n.desc,editVersion:null==i?void 0:i.edit_version},visible:u,onCancel:()=>{c(),p(!1)}})),setShowImportToolModal:p}}},512421:function(e,t,r){r.d(t,{M:()=>l});var n=r("151064"),o=r("455069"),i=r("966219"),l=e=>{var{mode:t,value:r,onChange:l,height:a=500,theme:s="monokai",disabled:d=!1,dataTestID:c}=e,[u,p]=(0,o.useState)(a);return(0,o.useEffect)(()=>{p(a)},[a]),(0,n.jsx)("div",{style:{position:"relative"},"data-testid":c,children:(0,n.jsx)(i.Editor,{options:{readOnly:d},language:t,theme:s,width:"100%",onChange:l,height:u,value:r})})}},786406:function(e,t,r){r.d(t,{JI:()=>eh,iy:()=>e_});var n=r("825955"),o=r("808549"),i=r("120454"),l=r("151064"),a=r("455069"),s=r("287487"),d=r("947578"),c=r("297158"),u=r("336205"),p=r("707107"),m=r("214942"),v=r("775699"),_=r("44172"),f=r("178385"),h=r("382534"),x=r("473980"),g=r("494308"),y=r("64605"),b=r("165882"),j=r("298203"),w=r("727914"),C=r("458949");function k(e){var t=e.lastIndexOf(".");return e.slice(t+1)}function N(){return(N=(0,n._)(function*(e,t){return new Promise((r,n)=>{var o=new FileReader;o.onload=e=>{var t,o=null===(t=e.target)||void 0===t?void 0:t.result;if(!o||"string"!=typeof o){n(new w.sH("normal_error","file read fail"));return}r(o)},o.onprogress=e=>{e.total&&t({total:e.total,loaded:e.loaded})},o.readAsText(e)})})).apply(this,arguments)}function S(){return(S=(0,n._)(function*(e){var t=b.Z.create({responseType:"text"});return(yield t.get(e)).data})).apply(this,arguments)}var E={none:f.Mv.None,service_http:f.Mv.Service,oauth:f.Mv.OAuth},T={Header:f.Ot.Header,Query:f.Ot.Query};function I(e){var{aiPlugin:t,openAPI:r}=e;return{aiPlugin:(0,j.dj)(t||"{}"),openAPI:(0,g.Qc)(r||"")}}function P(e,t){if(void 0!==t){for(var[r,n]of Object.entries(e))if(n===t)return r}}function A(e){switch(e){case C.wL.Curl:return"curl";case C.wL.OpenAPI:return"openapi";case C.wL.Postman:return"postman";case C.wL.Swagger:return"swagger";default:return""}}var D=e=>(0,y.Z)(e)&&"paths_duplicated"in e;function L(e){var{duplicateInfos:t=[],onCancel:r,onOk:n}=e;v.M5.warning({title:u.o.t("duplicate_tools_within_plugin"),content:null==t?void 0:t.map(e=>(0,l.jsx)("div",{children:"".concat(e.method,"  ").concat(u.o.t("path_has_duplicates",{path:e.path,num:e.count}))})),okText:u.o.t("merge_duplicate_tools"),cancelText:u.o.t("Cancel"),centered:!0,icon:(0,l.jsx)(_.O5N,{}),okButtonProps:{type:"warning"},onOk:n,onCancel:r})}var O=r("75117");function Z(){return"cn-boe"}var F={SAFE_CHECK:0x2aebbb74,DUP_PATH:0x29d916dd},M=["json","yaml"],z=M.map(e=>".".concat(e)),R={environment:Z(),workspace_id:"",workspace_type:"",status:1,create_type:"import"},B={environment:Z(),workspace_id:"",workspace_type:"",status:1,create_type:"import",plugin_id:""},V=r("3779"),U={name:[{required:!0,message:u.o.t("create_plugin_modal_name1_error")},{pattern:RegExp("^[\\w\\s\\u4e00-\\u9fa5]+$","u"),message:u.o.t("create_plugin_modal_nameerror_cn")}],desc:[{required:!0,message:u.o.t("create_plugin_modal_descrip1_error")},!1],url:[{required:!0,message:u.o.t("create_plugin_modal_url1_error")}],key:[{required:!0,message:u.o.t("create_plugin_modal_Parameter_error")},{pattern:/^[\x00-\x7F]+$/,message:u.o.t("plugin_Parametename_error")}],service_token:[{required:!0,message:u.o.t("create_plugin_modal_Servicetoken_error")}]},H=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n of e){if(n.value===r)return n;if((null===(t=n.children)||void 0===t?void 0:t.length)>0)return H(n.children,r)}},W=r("335740"),G=r("474872"),K=r("581259"),J=r("625196"),q=r("153796"),$=e=>{var{disabled:t}=e,r=(0,v.XQ)(),n=r.getValues();return t?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_name1"),required:!0},children:(0,l.jsx)("div",{children:null==n?void 0:n.name})}):(0,l.jsx)(v.P6,{field:"name",className:q.Z["textarea-single-line"],label:u.o.t("create_plugin_modal_name1"),placeholder:u.o.t("create_plugin_modal_name2"),trigger:["blur","change"],maxCount:30,maxLength:30,rows:1,onBlur:()=>{var e;r.setValue("name",null===(e=r.getValue("name"))||void 0===e?void 0:e.trim())},rules:U.name})},X=e=>{var{disabled:t}=e,r=(0,v.XQ)(),n=r.getValues();return t?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_descrip1"),required:!0},children:(0,l.jsx)("div",{children:null==n?void 0:n.desc})}):(0,l.jsx)(v.P6,{field:"desc",label:u.o.t("create_plugin_modal_descrip1"),trigger:["blur","change"],placeholder:u.o.t("create_plugin_modal_descrip2"),rows:2,maxCount:600,maxLength:600,onBlur:()=>{var e;r.setValue("desc",null==n?void 0:null===(e=n.desc)||void 0===e?void 0:e.trim())},rules:U.desc})},Y=e=>{var{disabled:t}=e,r=(0,v.XQ)(),n=r.getValues();return t?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_url1"),required:!0},children:(0,l.jsx)("div",{children:null==n?void 0:n.url})}):(0,l.jsx)(v.K9,{className:q.Z["textarea-single-line"],trigger:["blur","change"],field:"url",label:u.o.t("create_plugin_modal_url1"),placeholder:u.o.t("create_plugin_modal_url2"),onBlur:()=>{var e;r.setValue("url",null==n?void 0:null===(e=n.url)||void 0===e?void 0:e.trim())},rules:U.url})},Q=(0,v.Q2)(e=>{var{disabled:t,value:r=[],onChange:n}=e,o=e=>{var t=(0,W.Z)(r);t.splice(e,1),null==n||n(t)};return(0,l.jsx)(v.l0.Slot,{className:q.Z["header-list"],label:{text:u.o.t("plugin_create_header_list_title"),align:"right",extra:(0,l.jsxs)("div",{className:q.Z["header-list-extra"],children:[(0,l.jsx)(J.O,{data:K.HW.header_list}),r.length<20&&!t&&(0,l.jsx)(v._3,{size:"large",icon:(0,l.jsx)(_.N_R,{}),onClick:e=>{var t=[...r];t.push(e.name?e:{name:"",value:""}),null==n||n(t)}})]})},children:(0,l.jsxs)("div",{className:q.Z["herder-list-box"],children:[(0,l.jsxs)(v.X2,{className:q.Z["header-row"],gutter:8,children:[(0,l.jsx)(v.JX,{span:9,children:(0,l.jsx)("div",{className:q.Z["header-col-content"],children:"Key"})}),(0,l.jsx)(v.JX,{span:12,children:(0,l.jsx)("div",{className:q.Z["header-col-content"],children:"Value"})}),(0,l.jsx)(v.JX,{span:3,children:(0,l.jsx)("div",{className:q.Z["header-col-content"],style:{textAlign:"right"},children:u.o.t("plugin_create_action_btn")})})]}),(0,l.jsx)("div",{className:q.Z["herder-list-cotent"],children:null==r?void 0:r.map((e,i)=>(0,l.jsxs)(v.X2,{gutter:8,type:"flex",justify:"space-between",align:"middle",children:[(0,l.jsx)(v.JX,{span:9,children:(0,l.jsx)("div",{className:q.Z["col-content"],children:(0,l.jsx)(v.u3,{placeholder:"Name",value:e.name,onChange:e=>{var t=(0,W.Z)(r);t[i].name=e,null==n||n(t)},maxLength:100,disabled:t})})}),(0,l.jsx)(v.JX,{span:12,children:(0,l.jsx)("div",{className:q.Z["col-content"],children:(0,l.jsx)(v.u3,{placeholder:"Value",value:e.value,onChange:e=>{var t=(0,W.Z)(r);t[i].value=e,null==n||n(t)},maxLength:200,disabled:t})})}),(0,l.jsx)(v.JX,{span:3,children:(0,l.jsx)("div",{className:q.Z["col-content"],children:(0,l.jsx)(v._3,{icon:(0,l.jsx)(_.WDf,{}),type:"secondary",disabled:t,onClick:()=>{o(i)}})})})]},i))})]})})},{valueKey:"value",onKeyChangeFnName:"onChange"}),ee=e=>(0,l.jsx)(Q,(0,i._)((0,o._)({},e),{field:"headerList",label:{text:""}})),et=e=>{var t,r,{disabled:n,authOption:o,onChange:i}=e,a=(0,v.XQ)().getValues();return n?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_auth1"),extra:(0,l.jsx)(J.O,{data:K.HW.auth}),required:!0},children:(0,l.jsx)("div",{children:null===(t=H(o,null==a?void 0:null===(r=a.auth_type)||void 0===r?void 0:r.at(-1)))||void 0===t?void 0:t.label})}):(0,l.jsx)(v.oL.FormItem,{rules:[{required:!0}],style:{width:"100%"},initValue:(null==a?void 0:a.auth_type)||[0],field:"auth_type",label:{text:u.o.t("create_plugin_modal_auth1"),extra:(0,l.jsx)(J.O,{data:K.HW.auth})},placeholder:u.o.t("please_select_an_authorization_method"),treeData:o,displayRender:e=>"".concat(null==e?void 0:e.at(-1)),onChange:e=>{i(e)}})},er=e=>{var t,r,n,{disabled:o}=e,i=(0,v.XQ)(),a=i.getValues();return(0,l.jsxs)(l.Fragment,{children:[o?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_location"),extra:(0,l.jsx)(J.O,{data:K.HW.location}),required:!0},children:(0,l.jsx)("div",{children:null===(t=H(K.cg,null===(r=i.getValues())||void 0===r?void 0:r.location))||void 0===t?void 0:t.label})}):(0,l.jsx)(v.l0.RadioGroup,{rules:[{required:!0}],field:"location",label:{text:u.o.t("create_plugin_modal_location"),extra:(0,l.jsx)(J.O,{data:K.HW.location})},options:K.cg}),o?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_Parameter"),extra:(0,l.jsx)(J.O,{data:K.HW.key}),required:!0},children:(0,l.jsx)("div",{children:null===(n=i.getValues())||void 0===n?void 0:n.key})}):(0,l.jsx)(G.sI,{initValue:null==a?void 0:a.key,trigger:["blur","change"],field:"key",label:{text:u.o.t("create_plugin_modal_Parameter"),extra:(0,l.jsx)(J.O,{data:K.HW.key})},placeholder:u.o.t("create_plugin_modal_Parameter_empty"),maxLength:100,rules:U.key}),o?(0,l.jsx)(v.l0.Slot,{label:{text:u.o.t("create_plugin_modal_Servicetoken"),extra:(0,l.jsx)(J.O,{data:K.HW.service_token}),required:!0},children:(0,l.jsx)("div",{children:null==a?void 0:a.service_token})}):(0,l.jsx)(G.sI,{initValue:null==a?void 0:a.service_token,trigger:["blur","change"],field:"service_token",label:{text:u.o.t("create_plugin_modal_Servicetoken"),extra:(0,l.jsx)(J.O,{data:K.HW.service_token})},placeholder:u.o.t("create_plugin_modal_Servicetoken_empty"),maxLength:400,rules:U.service_token})]})},en=e=>{var{disabled:t,extItems:r}=e,n=(0,v.XQ)().getValues();return(0,l.jsx)(l.Fragment,{children:null==r?void 0:r.map(e=>(0,l.jsx)(l.Fragment,{children:t?(0,l.jsx)(v.l0.Slot,{label:{text:e.key,extra:K.HW[e.key]&&(0,l.jsx)(J.O,{data:K.HW[e.key]}),required:e.required},children:(0,l.jsx)("div",{children:(null==n?void 0:n.oauth_info)?(0,j.dj)(n.oauth_info)[e.key]:null})},e.key):(0,l.jsx)(G.sI,{trigger:["blur","change"],field:e.key,label:{text:e.key,extra:K.HW[e.key]&&(0,l.jsx)(J.O,{data:K.HW[e.key]})},placeholder:K.VF[e.key],initValue:(null==n?void 0:n.oauth_info)&&(0,j.dj)(n.oauth_info)[e.key]||e.default,maxLength:e.max_len,rules:[{required:e.required,message:K.VF[e.key]},"url"===e.type?{pattern:/^(http|https):\/\/.+$/,message:u.o.t("create_plugin_modal_URLerror")}:{pattern:/^[\x00-\x7F]+$/,message:u.o.t("create_plugin_modal_descrip_error")}]},e.key)}))})},eo={headerList:[{name:"User-Agent",value:"Coze/1.0"}]},ei=e=>{var t,r,s,c,y,{onCancel:b,importInfo:w,visible:k,onSuccess:N,disabled:S=!1,projectId:A}=e,[D,L]=(0,a.useState)([]),[Z,M]=(0,a.useState)(!0),[z,B]=(0,a.useState)([]),[U,W]=(0,a.useState)(!1),G=(null==w?void 0:null===(s=w.metaInfo)||void 0===s?void 0:null===(r=s.common_params)||void 0===r?void 0:r[4])||[],K=w?(0,i._)((0,o._)({},null==w?void 0:w.metaInfo),{headerList:G||[]}):eo,J=(0,a.useRef)(),Q=null===(y=J.current)||void 0===y?void 0:null===(c=y.getFormState())||void 0===c?void 0:c.values,ei=(0,m.rY)(e=>e.space.id);(0,a.useEffect)(()=>{(0,n._)(function*(){var e,t=yield h.nA.GetOAuthSchema();L((e=null==t?void 0:t.oauth_schema,[{label:u.o.t("create_plugin_modal_Authorization_no"),value:0,key:"None"},{label:u.o.t("create_plugin_modal_Authorization_service"),value:1,key:"Service"},{label:u.o.t("create_plugin_modal_Authorization_oauth"),value:3,key:"OAuth",children:(0,j.dj)(e)}]))})()},[]),(0,a.useEffect)(()=>{if(w){var e,t,r;B((null===(e=H(D,(null===(r=w.metaInfo)||void 0===r?void 0:null===(t=r.auth_type)||void 0===t?void 0:t.at(-1))||0))||void 0===e?void 0:e.items)||[])}else B([])},[D,w]);var el=(t=(0,n._)(function*(){yield null===(n=J.current)||void 0===n?void 0:n.validate();var e=null===(l=J.current)||void 0===l?void 0:l.getValues();if(!!e){var{openAPI:t,aiPlugin:r}=ea(e);try{W(!0);var n,l,a,{data:s}=yield h.Js.RegisterPlugin({ai_plugin:r,openapi:t,plugin_type:C.zV.PLUGIN,client_id:null==e?void 0:e.client_id,client_secret:null==e?void 0:e.client_secret,service_token:null==e?void 0:e.service_token,import_from_file:!0,space_id:ei,project_id:A},{__disableErrorToast:!0});v.O$.success(u.o.t("plugin_imported_successfully")),null==b||b(),yield null==N?void 0:N({plugin_id:null==s?void 0:s.plugin_id}),(0,p.Gg)(p.Kg.create_plugin_front,(0,i._)((0,o._)({},(null==w?void 0:null===(a=w.extra)||void 0===a?void 0:a.reportParams)||R),{status:0}))}catch(e){var c,{code:m,msg:_}=e;(0,p.Gg)(p.Kg.create_plugin_front,(0,i._)((0,o._)({},(null==w?void 0:null===(c=w.extra)||void 0===c?void 0:c.reportParams)||R),{status:1,error_message:_})),Number(m)===F.SAFE_CHECK?M(!1):v.O$.error({content:(0,d.u)(_)})}finally{W(!1)}}}),function(){return t.apply(this,arguments)}),ea=e=>{var t,{headerList:r,plugin_uri:n=[]}=e,l=(0,x._)(e,["headerList","plugin_uri"]),a={};return null==z||z.forEach(t=>{t.key in e&&(a[t.key]=e[t.key])}),function(e,t){var{aiPlugin:r,openAPI:n}=I(t),{name:l,desc:a,auth_type:s,common_params:d,location:c,key:u,service_token:p,oauth_info:m,icon:v}=e,_={name_for_human:l,name_for_model:l,description_for_human:a,description_for_model:a,logo_url:null==v?void 0:v.uri,common_params:{header:null==d?void 0:d[f.Pi.Header],body:null==d?void 0:d[f.Pi.Body],path:null==d?void 0:d[f.Pi.Path],query:null==d?void 0:d[f.Pi.Query]},auth:(0,o._)({type:P(E,null==s?void 0:s.at(0)),location:P(T,c),key:u,service_token:p},JSON.parse(m||"{}"))},h=(0,o._)({},r,_),x=(0,i._)((0,o._)({},n||{}),{info:(0,i._)((0,o._)({},(null==n?void 0:n.info)||{}),{title:l,description:a}),servers:[{url:e.url}]});return{aiPlugin:JSON.stringify(h),openAPI:(0,g.Pz)(x)}}((0,i._)((0,o._)({},l),{oauth_info:JSON.stringify(a),icon:{uri:null===(t=n[0])||void 0===t?void 0:t.uid},common_params:{[C.Pi.Header]:(null==e?void 0:e.headerList)||[],[C.Pi.Body]:[],[C.Pi.Path]:[],[C.Pi.Query]:[]}}),{openAPI:null==w?void 0:w.openAPI,aiPlugin:null==w?void 0:w.aiPlugin})};return(0,a.useEffect)(()=>{!Z&&M(!0)},[(null==Q?void 0:Q.name)||(null==Q?void 0:Q.desc)]),(0,l.jsx)(l.Fragment,{children:k?(0,l.jsx)(v.M5,{type:"action-small",title:u.o.t("confirm_plugin_information"),visible:k,onCancel:()=>null==b?void 0:b(),footer:!S&&(0,l.jsxs)("div",{children:[!Z&&(0,l.jsx)("div",{className:q.Z["error-msg-box"],children:(0,l.jsx)("span",{className:q.Z["error-msg"],children:u.o.t("plugin_create_modal_safe_error")})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.y3,{type:"tertiary",onClick:()=>{null==b||b()},children:u.o.t("create_plugin_modal_button_cancel")}),(0,l.jsx)(v.y3,{type:"primary",theme:"solid",loading:U,onClick:()=>{el()},children:u.o.t("create_plugin_modal_button_confirm")})]})]}),children:(0,l.jsx)(v.l0,{getFormApi:e=>J.current=e,showValidateIcon:!1,initValues:(0,o._)({},K||{}),className:q.Z["upload-form"],children:e=>{var{values:t}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.s,{noLabel:!0,disabled:S,fieldClassName:q.Z["upload-field"],field:"plugin_uri",iconType:f.Tu.Plugin,fileBizType:f.ym.BIZ_PLUGIN_ICON}),(0,l.jsx)($,{disabled:S}),(0,l.jsx)(X,{disabled:S}),(0,l.jsx)(Y,{disabled:!0}),(0,l.jsx)(ee,{disabled:S}),(0,l.jsx)(et,{disabled:S,authOption:D,onChange:e=>{var t;B((null===(t=H(D,null==e?void 0:e.at(-1)))||void 0===t?void 0:t.items)||[])}}),1===t.auth_type.at(-1)&&(0,l.jsx)(er,{disabled:S}),(0,l.jsx)(en,{disabled:S,extItems:z}),!S&&(0,l.jsxs)(v.T,{spacing:8,className:q.Z["footer-draft"],children:[(0,l.jsx)(_.Us8,{style:{fontSize:"16px",color:"#4D53E8"}}),(0,l.jsxs)("span",{children:[u.o.t("plugin_create_draft_desc"),(0,l.jsx)(V.v,{})]})]})]})}})}):null})},el=r("252237"),ea=r.n(el),es=r("623159"),ed=r("68344"),ec=r("468163"),eu=e=>{var t,{onUpload:r,disabled:o}=e,[i,s]=(0,a.useState)([]);var d=(t=(0,n._)(function*(e){var{onSuccess:t,file:r,onError:n,onProgress:o}=e;if("string"!=typeof r)try{var{name:i,fileInstance:l}=r;if(l){var a=k(i);if(!M.includes(a))return;var s=yield function(e,t){return N.apply(this,arguments)}(l,o);t(s)}}catch(e){c.kg.error({eventName:"fail_to_read_file",error:e}),n({status:0})}}),function(e){return t.apply(this,arguments)});return(0,l.jsx)(v.gq,{accept:z.join(","),action:"",onAcceptInvalid:()=>{v.O$.warning(u.o.t("file_format_not_supported"))},onSuccess:e=>{r(e)},disabled:o,fileList:i,onChange:e=>{var{fileList:t}=e;s(t),!t.length&&r()},className:ea()(ec.Z["upload-file-area"],i.length&&ec.Z["drag-area-disabled"]),dragMainText:u.o.t("click_upload_or_drag_files"),draggable:!0,dragSubText:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:u.o.t("supports_uploading_json_or_yaml_files")}),(0,l.jsx)("a",{href:"/open/docs/guides/import",target:"_blank",onClick:e=>e.stopPropagation(),children:u.o.t("view_detailed_information")})]}),renderFileItem:e=>{var{name:t,onRemove:r,onRetry:n,percent:i,status:a}=e;return(0,l.jsxs)("div",{className:ea()(ec.Z["upload-file-item"],o&&ec.Z.disabled),children:[(0,l.jsx)(v.Ee,{preview:!1,className:ec.Z["file-icon"],src:"yaml"===k(t)?es:ed}),(0,l.jsx)(v.ZT.Text,{className:ec.Z.text,ellipsis:{showTooltip:{opts:{content:t}}},children:t}),(0,l.jsx)("div",{className:ec.Z.progress,children:(()=>{switch(a){case"success":return(0,l.jsx)(v.ZT.Text,{className:ec.Z["upload-text"],ellipsis:!0,children:u.o.t("file_upload_success")});case"uploadFail":case"validateFail":return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(_.Ucq,{}),(0,l.jsx)(v.y3,{theme:"borderless",className:"ml-[8px]",onClick:n,children:u.o.t("retry")})]});default:return(0,l.jsx)("div",{className:ea()("w-[90px]"),children:(0,l.jsx)(v.Ex,{percent:i})})}})()}),(0,l.jsx)(v._3,{icon:(0,l.jsx)(_.WDf,{className:ec.Z["delete-icon"],onClick:r})})]})},limit:1,customRequest:d})},ep=(0,a.forwardRef)((e,t)=>{var{onChange:r}=e,n=(0,x._)(e,["onChange"]);return(0,l.jsx)(v.Kx,(0,i._)((0,o._)({placeholder:u.o.t("enter_raw_content_or_url"),rows:17},n),{ref:t,onChange:e=>{r(e.trim())},className:ec.Z["text-area"]}))}),em=r("170992"),ev=e=>{var t,{onCancel:r,visible:o,onOk:i,title:s}=e,[d,p]=(0,a.useState)("File"),[m,_]=(0,a.useState)(),[f,h]=(0,a.useState)(),[x,g]=(0,a.useState)(!1),y=(0,a.useRef)(null),b=e=>{_(e)},j=()=>{p("File"),_(void 0)};var w=(t=(0,n._)(function*(){g(!0),h(void 0);var e=m,t="Text"===d?"raw_txt":"file";if("Text"===d&&function(e){try{return!!RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*","i").test(e||"")}catch(e){return!1}}(m))try{e=yield function(e){return S.apply(this,arguments)}(m||""),t="file_url"}catch(e){return c.kg.error({error:e,eventName:"fetch_url_resource_fail"}),h(u.o.t("unable_to_access_input_url")),g(!1),Promise.reject(e)}try{var r=yield null==i?void 0:i({type:t,content:e});!(null==r?void 0:r.success)&&h(null==r?void 0:r.errMsg)}finally{g(!1)}}),function(){return t.apply(this,arguments)});return(0,a.useEffect)(()=>{f&&h(void 0)},[m]),(0,a.useEffect)(()=>{o&&j()},[o]),(0,a.useEffect)(()=>{if("Text"===d&&y.current){var e;null==y||null===(e=y.current)||void 0===e||e.focus()}},[d]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(v.M5,{afterClose:j,keepDOM:!1,type:"action-small",title:s,visible:o,onCancel:r,onOk:w,footer:(0,l.jsx)(v.y3,{theme:"solid",type:"primary",disabled:!m,onClick:w,loading:x,children:u.o.t("next")}),className:em.Z["import-modal"],children:(0,l.jsxs)("div",{className:"min-h-[472px]",children:[(0,l.jsx)("div",{className:"flex justify-center mb-[24px]",children:(0,l.jsxs)(v.FX,{onChange:e=>{p(e.target.value),_(void 0)},type:"button",buttonSize:"middle",defaultValue:d,disabled:x,className:em.Z["radio-group"],children:[(0,l.jsx)(v.Y8,{value:"File",children:u.o.t("local_file")}),(0,l.jsx)(v.Y8,{value:"Text",children:u.o.t("url_raw_data")})]})}),(0,l.jsx)("div",{children:"File"===d?(0,l.jsx)(eu,{onUpload:b,disabled:x}):(0,l.jsx)(ep,{onChange:b,disabled:x,ref:y})}),(0,l.jsxs)("div",{className:em.Z["error-msg"],children:[" ",f?(0,l.jsx)(v.ZT.Text,{ellipsis:{showTooltip:{opts:{content:f}}},children:f}):null]})]})})})},e_=e=>{var{visible:t}=e;return t?(0,l.jsx)(ef,(0,o._)({},e)):null},ef=e=>{var t,r,{onCancel:s,visible:_,onSuccess:g,projectId:y}=e,[b,j]=(0,a.useState)(),{id:w,space_type:C}=(0,m.rY)(e=>e.space),k=(0,a.useRef)(R),N=C===f.Sn.Personal;(0,a.useEffect)(()=>{k.current=(0,i._)((0,o._)({},k.current),{environment:Z(),workspace_id:w||"",workspace_type:N?"personal_workspace":"team_workspace",status:1,create_type:"import"})},[w,N]);var S=(t=(0,n._)(function*(e){try{var t,{openapi:r,ai_plugin:l,plugin_data_format:a}=yield h.Js.Convert2OpenAPI(e,{__disableErrorToast:!0}),s=I({aiPlugin:l,openAPI:r}),m=function(e){var t,r,n,o,i,l,{aiPlugin:a,openAPI:s}=e,d=(null==a?void 0:a.auth)||{},{type:c,location:u,key:p,service_token:m}=d,v=(0,x._)(d,["type","location","key","service_token"]);return{name:null==a?void 0:a.name_for_human,desc:null==a?void 0:a.description_for_human,url:null==s?void 0:null===(r=s.servers)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.url,icon:{uri:null==a?void 0:a.logo_url},auth_type:[E[c||"none"]],location:T[u||""],key:p,service_token:m,oauth_info:JSON.stringify(v),common_params:{[f.Pi.Header]:(null==a?void 0:null===(n=a.common_params)||void 0===n?void 0:n.header)||[],[f.Pi.Body]:(null==a?void 0:null===(o=a.common_params)||void 0===o?void 0:o.body)||[],[f.Pi.Path]:(null==a?void 0:null===(i=a.common_params)||void 0===i?void 0:i.path)||[],[f.Pi.Query]:(null==a?void 0:null===(l=a.common_params)||void 0===l?void 0:l.query)||[]}}}(s);return j({aiPlugin:l,openAPI:r,metaInfo:m}),k.current=(0,i._)((0,o._)({},k.current),{import_format_type:A(a),import_tools_count:Object.entries((null==s?void 0:null===(t=s.openAPI)||void 0===t?void 0:t.paths)||{}).length}),{success:!0}}catch(t){var _,g,y,{msg:b,code:w,response:C}=t;if(c.kg.error({error:t,eventName:"plugin_convert_openapi_fail"}),k.current=(0,i._)((0,o._)({},k.current),{import_format_type:A(null==C?void 0:null===(g=C.data)||void 0===g?void 0:g.plugin_data_format),import_tools_count:0}),(0,p.Gg)(p.Kg.create_plugin_front,(0,i._)((0,o._)({},k.current),{status:1,error_message:b})),!(Number(w)===F.DUP_PATH||D(null==C?void 0:C.data)))return{success:!1,errMsg:b||u.o.t("error")};return L({onOk:(_=(0,n._)(function*(){var{errMsg:t,success:r}=yield S((0,i._)((0,o._)({},e),{merge_same_paths:!0}));if(!r)return v.O$.error({content:(0,d.u)(t||u.o.t("error"))}),Promise.reject(t)}),function(){return _.apply(this,arguments)}),duplicateInfos:null==C?void 0:null===(y=C.data)||void 0===y?void 0:y.duplicate_api_infos}),{success:!1,errMsg:""}}}),function(e){return t.apply(this,arguments)});var P=(r=(0,n._)(function*(e){var{content:t,type:r}=e;return k.current=(0,i._)((0,o._)({},k.current),{import_way_type:r}),yield S({data:t||"",space_id:w,merge_same_paths:!1})}),function(e){return r.apply(this,arguments)});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ev,{title:u.o.t("import_plugin"),visible:_,onCancel:s,onOk:P}),b?(0,l.jsx)(ei,{visible:!!b,projectId:y,onCancel:()=>j(void 0),importInfo:{metaInfo:b.metaInfo,openAPI:b.openAPI,aiPlugin:b.aiPlugin,extra:{reportParams:k.current}},onSuccess:e=>{null==s||s(),null==g||g(e)}}):null]})},eh=e=>{var{visible:t}=e;return t?(0,l.jsx)(ex,(0,o._)({},e)):null},ex=e=>{var t,r,x,g,{onCancel:y,visible:b,onSuccess:j,pluginInfo:w}=e,C=(0,a.useRef)(B),{id:k,space_type:N}=(0,m.rY)(e=>e.space),S=N===f.Sn.Personal,E=s.Z.useUserInfo();(0,a.useEffect)(()=>{C.current=(0,i._)((0,o._)({},C.current),{environment:Z(),workspace_id:k||"",workspace_type:S?"personal_workspace":"team_workspace",status:1,create_type:"import",plugin_id:(null==w?void 0:w.pluginID)||""})},[null==w?void 0:w.pluginID,k,S]);var T=(t=(0,n._)(function*(e){try{var t,r,n,l=yield h.Js.BatchCreateAPI(e,{__disableErrorToast:!0}),a=(null==e?void 0:e.replace_same_paths)?null==e?void 0:null===(t=e.paths_to_replace)||void 0===t?void 0:t.length:null==l?void 0:null===(r=l.paths_created)||void 0===r?void 0:r.length;(0,p.Gg)(p.Kg.create_plugin_tool_front,(0,i._)((0,o._)({},C.current),{status:0,import_tools_count:a||0})),l&&!(null==l?void 0:null===(n=l.paths_duplicated)||void 0===n?void 0:n.length)&&(v.O$.success((null==e?void 0:e.replace_same_paths)?u.o.t("plugin_tool_replace_success"):u.o.t("plugin_tool_import_succes")),null==y||y(),null==j||j())}catch(t){var s,d,{code:c,response:m}=t;if(Number(c)!==F.DUP_PATH&&!D(null==m?void 0:m.data))return Promise.reject(t);(0,p.Gg)(p.Kg.create_plugin_tool_front,(0,i._)((0,o._)({},C.current),{status:0,import_tools_count:(null==m?void 0:null===(d=m.data)||void 0===d?void 0:null===(s=d.paths_created)||void 0===s?void 0:s.length)||0})),I(e,null==m?void 0:m.data)}}),function(e){return t.apply(this,arguments)}),I=(e,t)=>{var{paths_created:r=[],paths_duplicated:a=[]}=t||{},s=r.length,c=a.length,m=u.o.t("failed_to_import_tool",{num:c}),f=u.o.t("tools_imported_successfully",{num:s});v.M5.warning({title:s?"".concat(f,", ").concat(m):m,content:c?u.o.t("plugin_tool_exists_tips",{num:c}):null,okText:u.o.t("replace"),cancelText:u.o.t("Cancel"),centered:!0,icon:(0,l.jsx)(_.O5N,{}),okButtonProps:{type:"warning"},onOk:(0,n._)(function*(){var t=(0,i._)((0,o._)({},e),{replace_same_paths:!0,paths_to_replace:a});try{yield T(t)}catch(e){var{msg:r}=e;v.O$.error({content:(0,d.u)(r||u.o.t("error"))}),(0,p.Gg)(p.Kg.create_plugin_tool_front,(0,i._)((0,o._)({},C.current),{import_tools_count:0,status:1,error_message:r||""}))}}),onCancel:s?(0,n._)(function*(){null==y||y(),yield null==j?void 0:j()}):void 0})};var P=(r=(0,n._)(function*(e){return yield h.Js.Convert2OpenAPI((0,i._)((0,o._)({},e),{plugin_description:null==w?void 0:w.pluginDesc}),{__disableErrorToast:!0})}),function(e){return r.apply(this,arguments)});var O=(x=(0,n._)(function*(e){try{var t=yield P(e);C.current=(0,i._)((0,o._)({},C.current),{import_format_type:A(null==t?void 0:t.plugin_data_format)});var r={plugin_id:null==w?void 0:w.pluginID,ai_plugin:null==t?void 0:t.ai_plugin,openapi:null==t?void 0:t.openapi,replace_same_paths:!1,space_id:k,dev_id:null==E?void 0:E.user_id_str,edit_version:null==w?void 0:w.editVersion};return yield T(r),{success:!0}}catch(t){var l,a,s,{msg:m,code:_,response:f}=t;if(c.kg.error({error:t,eventName:"batch_create_fail"}),C.current=(0,i._)((0,o._)({},C.current),{import_format_type:A(null==f?void 0:null===(a=f.data)||void 0===a?void 0:a.plugin_data_format)}),(0,p.Gg)(p.Kg.create_plugin_tool_front,(0,i._)((0,o._)({},C.current),{import_tools_count:0,status:1,error_message:m||""})),!(Number(_)===F.DUP_PATH||D(null==f?void 0:f.data)))return{success:!1,errMsg:m||u.o.t("error")};return L({onOk:(l=(0,n._)(function*(){var{success:r,errMsg:n}=yield O((0,i._)((0,o._)({},e),{merge_same_paths:!0}));if(!r)return v.O$.error({content:(0,d.u)(n||u.o.t("error"))}),Promise.reject(t)}),function(){return l.apply(this,arguments)}),duplicateInfos:null==f?void 0:null===(s=f.data)||void 0===s?void 0:s.duplicate_api_infos}),{success:!1}}}),function(e){return x.apply(this,arguments)});var M=(g=(0,n._)(function*(e){var{content:t,type:r}=e||{};return C.current=(0,i._)((0,o._)({},C.current),{import_way_type:r}),yield O({data:t||"",plugin_name:null==w?void 0:w.pluginName,plugin_url:null==w?void 0:w.pluginUrl,merge_same_paths:!1,space_id:k})}),function(e){return g.apply(this,arguments)});return(0,l.jsx)(ev,{title:u.o.t("import_plugin_tool"),visible:b,onCancel:y,onOk:M})}},3779:function(e,t,r){r.d(t,{v:function(){return a}});var n=r(151064),o=r(455069),i=r(336205),l=r(674343),a=()=>{var e=(0,o.useMemo)(()=>({"zh-CN":"/docs/guides/plugin",en:"/docs/en_guides/en_plugin"})[i.o.language],[]);return(0,n.jsx)(l.ZT.Text,{link:{href:e,target:"_blank"},fontSize:"12px",children:i.o.t("plugin_create_guide_link")})}},737368:function(e,t,r){r.d(t,{E:()=>h});var n=r("151064"),o=r("336205"),i=r("775699"),l=r("44172"),a=r("286518"),s=r("382534"),d=r("808549"),c=r("120454"),u=r("479910"),p=r("598208"),m={pluginRiskIsRead:!0,toolHiddenModeNewbieGuideIsRead:!0},v=(0,p.Ue)()((0,u.mW)(e=>(0,c._)((0,d._)({},m),{reset:()=>{e(m)},setPluginRiskIsRead:t=>{e({pluginRiskIsRead:t})},setToolHiddenModeNewbieGuideIsRead:t=>{e({toolHiddenModeNewbieGuideIsRead:t})}}),{enabled:!1,name:"botStudio.riskWarningStore"})),_=r("551256"),f=[{icon:(0,n.jsx)(l.KBW,{}),text:o.o.t("plugin_quote_tip_1")},{icon:(0,n.jsx)(l.bu3,{}),text:o.o.t("plugin_quote_tip_2")},{icon:(0,n.jsx)(l.LGu,{}),text:o.o.t("plugin_quote_tip_3")}],h=()=>{var{pluginRiskIsRead:e,setPluginRiskIsRead:t}=v.getState(),r=()=>{s.pr.UpdateUserConfig({risk_alert_type:a.qe.Plugin})};!e&&(t(!0),i.u_.warning({icon:null,title:o.o.t("About_Plugins_tip"),content:(0,n.jsx)("div",{className:_.Z["modal-wrap"],children:f.map(e=>(0,n.jsxs)("div",{className:_.Z["modal-item"],children:[e.icon,(0,n.jsx)("span",{className:_.Z["modal-text"],children:e.text})]}))}),onOk:r,onCancel:r,hasCancel:!1,maskClosable:!1,className:_.Z["ui-modal"],okText:o.o.t("Confirm"),okButtonProps:{style:{minWidth:"96px"}}}))}},625196:function(e,t,r){r.d(t,{O:()=>a});var n=r("151064"),o=r("455069"),i=r("915757"),l=r("674343"),a=e=>{var{data:t}=e;return(0,n.jsx)(l.u,{showArrow:!0,theme:"dark",position:"right",arrowPointAtCenter:!0,className:"!max-w-[320px]",content:null==t?void 0:t.map((e,t)=>(0,n.jsxs)(o.Fragment,{children:["title"===e.type?(0,n.jsx)(l.ZT.Text,{fontSize:"14px",className:"dark coz-fg-primary",children:e.text}):null,"text"===e.type?(0,n.jsx)(l.ZT.Paragraph,{fontSize:"12px",className:"dark coz-fg-secondary",children:e.text}):null,"br"===e.type?(0,n.jsx)("div",{className:"h-[8px]"}):null,"demo"===e.type?(0,n.jsx)("div",{className:"dark mt-[4px] p-[10px] border border-solid coz-stroke-primary",children:(0,n.jsx)(l.ZT.Paragraph,{fontSize:"12px",className:"dark coz-fg-secondary",children:e.text})}):null]},"".concat(e.type).concat(t))),children:(0,n.jsx)(i.L03,{className:"coz-fg-secondary"})})}},827666:function(e,t,r){r.d(t,{Eo:function(){return y},Fc:function(){return p},Il:function(){return u},JN:function(){return L},Oz:function(){return D},RE:function(){return b},TS:function(){return h},UR:function(){return v},YA:function(){return S},Zo:function(){return I},dT:function(){return _},iq:function(){return A},lR:function(){return P},ls:function(){return f},pq:function(){return x},rN:function(){return g},sp:function(){return m},w5:function(){return C}});var n,o,i=r(808549),l=r(120454),a=r(335740),s=r(336205),d=r(458949),c=r(187151),u="sub_parameters",p="id",m="[Array Item]",v="[Root Item]",_=0,f=1,h=2,x=[{label:"Body",value:d.Pi.Body},{label:"Path",value:d.Pi.Path},{label:"Query",value:d.Pi.Query},{label:"Header",value:d.Pi.Header}];var g=((n={})[n.DEFAULT=10001]="DEFAULT",n[n.IMAGE=10002]="IMAGE",n[n.DOC=10003]="DOC",n[n.CODE=10004]="CODE",n[n.PPT=10005]="PPT",n[n.TXT=10006]="TXT",n[n.EXCEL=10007]="EXCEL",n[n.AUDIO=10008]="AUDIO",n[n.ZIP=10009]="ZIP",n[n.VIDEO=10010]="VIDEO",n),y=e=>e+1e4,b=e=>e-1e4,j=[{label:"String",value:d.rH.String},{label:"Integer",value:d.rH.Integer},{label:"Number",value:d.rH.Number},{label:"Object",value:d.rH.Object},{label:"Array",value:d.rH.Array},{label:"Boolean",value:d.rH.Bool}],w=[{label:"Array<String>",value:d.rH.String},{label:"Array<Integer>",value:d.rH.Integer},{label:"Array<Number>",value:d.rH.Number},{label:"Array<Object>",value:d.rH.Object},{label:"Array<Boolean>",value:d.rH.Bool}],C={10001:{label:"File",listLabel:"Array<File>",fileTypes:[c.Wz.DEFAULT_UNKNOWN]},10002:{label:"Image",listLabel:"Array<Image>",fileTypes:[c.Wz.IMAGE]},10003:{label:"Doc",listLabel:"Array<Doc>",fileTypes:[c.Wz.DOCX,c.Wz.PDF]},10004:{label:"Code",listLabel:"Array<Code>",fileTypes:[c.Wz.CODE]},10005:{label:"PPT",listLabel:"Array<PPT>",fileTypes:[c.Wz.PPT]},10006:{label:"TXT",listLabel:"Array<TXT>",fileTypes:[c.Wz.TXT]},10007:{label:"Excel",listLabel:"Array<Excel>",fileTypes:[c.Wz.EXCEL,c.Wz.CSV]},10008:{label:"Audio",listLabel:"Array<Audio>",fileTypes:[c.Wz.AUDIO]},10009:{label:"Zip",listLabel:"Array<Zip>",fileTypes:[c.Wz.ARCHIVE]},10010:{label:"Video",listLabel:"Array<Video>",fileTypes:[c.Wz.VIDEO]}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return j;var t=(0,a.Z)(j);return t.splice(1,0,{label:"File",value:10001,children:Object.entries(C).map(e=>{var[t,{label:r}]=e;return{label:r,value:Number(t)}})}),t},N=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return w;var t=(0,a.Z)(w);return t.splice(1,0,{label:"Array<File>",value:10001,children:Object.entries(C).map(e=>{var[t,{listLabel:r}]=e;return{label:r,value:Number(t)}})}),t},S=(e,t)=>e?N(t):k(t),E=j.reduce((e,t)=>(e[t.value]=t.label,e),(0,l._)((0,i._)({},Object.entries(C).reduce((e,t)=>{var[r,{label:n}]=t;return e[r]=n,e},{})),{10001:"File"})),T=w.reduce((e,t)=>(e[t.value]=t.label,e),(0,l._)((0,i._)({},Object.entries(C).reduce((e,t)=>{var[r,{listLabel:n}]=t;return e[r]=n,e},{})),{10001:"Array<File>"})),I=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?T[e]:E[e]},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.type;return(null==e?void 0:e.assist_type)&&(r=y(e.assist_type)),I(r,t)},A=[{type:"title",text:"Get"},{type:"text",text:s.o.t("plugin_tooltip_url")},{type:"demo",text:"GET /users?userId=123"},{type:"text",text:s.o.t("used_to_obtain_user_information_with_id_123")},{type:"br"},{type:"title",text:"Post"},{type:"text",text:s.o.t("submit_data_to_a_specified_resource__often_used_to_submit_forms_or_upload_files_")},{type:"demo",text:"POST /users"},{type:"text",text:s.o.t("attach_user_data_to_create_a_new_user_")},{type:"title",text:"Put"},{type:"text",text:s.o.t("upload_data_or_resources_to_a_specified_location__often_used_to_update_existing_")},{type:"demo",text:"PUT /users/123"},{type:"text",text:s.o.t("used_to_update_user_information_with_id_123_")},{type:"title",text:"Delete"},{type:"text",text:s.o.t("requests_the_server_to_delete_the_specified_resource__example_")},{type:"demo",text:"DELETE /users/123"},{type:"text",text:s.o.t("used_to_delete_the_user_with_id_123_")},{type:"title",text:s.o.t("Create_tool_s1_method_patch_tooltip_title")},{type:"text",text:s.o.t("Create_tool_s1_method_patch_tooltip_desp")},{type:"demo",text:s.o.t("Create_tool_s1_method_patch_tooltip_url")},{type:"text",text:s.o.t("Create_tool_s1_method_patch_tooltip_explain")}];var D=((o={})[o.NO_ERROR=0]="NO_ERROR",o[o.NAME_EMPTY=1]="NAME_EMPTY",o[o.CHINESE=2]="CHINESE",o[o.REPEAT=3]="REPEAT",o[o.ASCII=4]="ASCII",o[o.DESC_EMPTY=5]="DESC_EMPTY",o),L={0:"",1:s.o.t("Create_newtool_s2_table_name_error1"),2:s.o.t("Create_newtool_s2_table_name_error2"),3:s.o.t("plugin_Parameter_name_error"),4:s.o.t("create_plugin_modal_descrip_error"),5:s.o.t("Create_newtool_s3_table_des_empty")}},900021:function(e,t,r){r.d(t,{B:function(){return i},Q:function(){return o}});var n,o=((n={}).PASS="PASS",n.FAIL="FAIL",n.WAIT="WAIT",n),i={SAFE_CHECK:0x2aebbb74}},577413:function(e,t,r){r.d(t,{$F:function(){return C},$S:function(){return I},Hn:function(){return k},IK:function(){return x},Og:function(){return P},Rm:function(){return g},SR:function(){return w},UK:function(){return j},Vv:function(){return Z},_v:function(){return T},aE:function(){return D},aY:function(){return N},bd:function(){return m},eO:function(){return v},jd:function(){return b},lf:function(){return f},qE:function(){return O},sl:function(){return S},ub:function(){return h},w:function(){return A}});var n=r(808549),o=r(120454),i=r(801815),l=r(550655),a=r(335740),s=r(788637),d=r(278796),c=r(64605),u=r(458949),p=r(827666),m=e=>{for(var{data:t,callback:r,childrenName:n=p.Il,path:o=[]}=e,i=0;i<t.length;i++){var l=JSON.parse(JSON.stringify(o));l.push(i),r(t[i],l),t[i][n]&&t[i][n].length>0&&m({data:t[i][n],callback:r,childrenName:n,path:l})}},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global_default",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!!Array.isArray(e))for(var n of e)n.deep=r,n[t]&&(n.value=n[t]),n[p.Il]&&v(n[p.Il],t,r+1)},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!!Array.isArray(e))for(var r of e)(0,l.Z)(r.deep)&&t.push(r.deep),r[p.Il]&&_(r[p.Il],t)},f=e=>{if(!Array.isArray(e)||0===e.length)return 0;var t=[];return _(e,t),Math.max.apply(null,t)},h=function(){var{isArray:e=!1,iscChildren:t=!1,deep:r=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{[p.Fc]:(0,i.x0)(),name:e?p.sp:"",desc:"",type:u.rH.String,location:t?void 0:u.Pi.Query,is_required:!0,sub_parameters:[],deep:r}},x=(e,t)=>{for(var r=0;r<e.length;r++){if(e[r][p.Fc]===t)return e.splice(r,1),!0;if(e[r][p.Il]&&e[r][p.Il].length>0&&x(e[r][p.Il],t))return!0}return!1},g=(e,t)=>{for(var r of e){if(r[p.Fc]===t)return r[p.Il]=[],!0;if(Array.isArray(r[p.Il])&&r[p.Il].length>0&&g(r[p.Il],t))return!0}return!1},y=(e,t,r)=>{for(var n of e)n[t]=r,Array.isArray(n[p.Il])&&y(n[p.Il],t,r)},b=e=>{var{data:t,targetKey:r,field:n,value:o,inherit:i=!1}=e;for(var l of t){if(l[p.Fc]===r){l[n]=o,i&&Array.isArray(l[p.Il])&&l[p.Il].length>0&&y(l[p.Il],n,o);return}Array.isArray(l[p.Il])&&l[p.Il].length>0&&b({data:l[p.Il],targetKey:r,field:n,value:o})}},j=(e,t)=>{for(var r=(0,a.Z)(e),n=[...t],o=0;o<t.length;o++)r[t[o]]?r=r[t[o]]:(r=r[0],n[o]=0);return n},w=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return e.reduce((e,r)=>{var n=[];switch(r.type){case u.rH.String:r.value&&(e[r.name]=r.value),!t&&(e[r.name]=r.value);break;case u.rH.Integer:case u.rH.Number:r.value&&(e[r.name]=Number(r.value)),!t&&(e[r.name]=r.value);break;case u.rH.Bool:r.value&&(e[r.name]="true"===r.value),!t&&(e[r.name]=r.value);break;case u.rH.Object:if(r.sub_parameters){var o=w(r.sub_parameters,t);!(0,s.Z)(o)&&(e[r.name]=o)}break;case u.rH.Array:if(n=r.sub_parameters,[u.rH.Bool,u.rH.Integer,u.rH.Number,u.rH.String].includes(r.sub_parameters[0].type)&&(n=r.sub_parameters.filter(e=>e.value)),(0,s.Z)(n))break;e[r.name]=n.map(e=>[u.rH.Bool].includes(e.type)?t?"true"===e.value:e.value:[u.rH.Integer,u.rH.Number].includes(e.type)?t?Number(e.value):e.value:[u.rH.String].includes(e.type)?e.value:e.type===u.rH.Object?w(e.sub_parameters,t):void 0)}return e},{})},C=e=>{var t,r,n={};for(var o in e)(null===(t=e[o])||void 0===t?void 0:t.constructor)===Object?n[o]=C(e[o]):n[o]=e[o];return"sub_parameters"in n&&(n.sub_parameters=null===(r=n.sub_parameters)||void 0===r?void 0:r.map(C)),n[p.Fc]&&(n[p.Fc]=(0,i.x0)()),n.value&&(n.value=null),n},k=(e,t)=>!!e.map(e=>e[p.Fc]).includes(t)||E(e,t),N=(e,t,r)=>{for(var n of e){if(n[p.Fc]===t)return e.filter(e=>e.name===r).length>1;if(Array.isArray(n[p.Il])&&n[p.Il].length>0&&N(n[p.Il],t,r))return!0}},S=e=>{if(!Array.isArray(e))return!1;for(var t of e){if(t.type===u.rH.Array)return!0;if(Array.isArray(t[p.Il])&&t[p.Il].length>0&&S(t[p.Il]))return!0}return!1},E=(e,t)=>{for(var r of e){if(r[p.Fc]===t)return e.length>1;if(Array.isArray(r[p.Il])&&r[p.Il].length>0&&E(r[p.Il],t))return!0}},T=e=>new Promise(t=>{setTimeout(()=>{t(0)},e)}),I=e=>{var t=document.querySelector(e);t&&("function"==typeof t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView({behavior:"smooth",block:"start"}))},P=e=>{e.scrollTo({left:0,top:e.scrollHeight,behavior:"smooth"})},A=(e,t)=>{var r=(0,a.Z)(e),n=e=>{"local_default"===t&&!(0,d.Z)(e,"local_default")&&(e[t]=e.global_default),!e[t]&&(e[t]=""),e.default_param_source===u.qi.Input&&"local_default"===t&&e.is_required&&!e.local_default&&e.local_disable&&(e.local_disable=!1)},o=function(e){for(var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0,l=e.length;i<l;i++){var a=e[i];r?(a[t]=void 0,a.sub_parameters&&a.sub_parameters.length>0&&o(a.sub_parameters,!0)):a.type===u.rH.Array?(n(a),a.sub_parameters&&a.sub_parameters.length>0&&o(a.sub_parameters,!0)):(a.type===u.rH.Object?a[t]=void 0:n(a),a.sub_parameters&&a.sub_parameters.length>0&&o(a.sub_parameters))}};return o(r),r},D=(e,t)=>{var r=[];return Array.isArray(e)&&e.forEach(e=>{var n=L(e,t[0]);r.push(n)}),r},L=(e,t)=>{var r={};if(Array.isArray(e))r=(0,o._)((0,n._)({},t),{id:(0,i.x0)(),sub_parameters:[]}),e.forEach(e=>{var n,o=L(e,t.sub_parameters[0]);null===(n=r.sub_parameters)||void 0===n||n.push(o)});else if((0,c.Z)(e)){r=(0,o._)((0,n._)({},t),{id:(0,i.x0)(),sub_parameters:[]});var l={};Object.keys(e).map(a=>{if(Object.prototype.hasOwnProperty.call(e,a)){var s,d=e[a];if(Array.isArray(d)||"object"==typeof d){var c,u=L(d,t.sub_parameters.find(e=>e.name===a));null===(c=r.sub_parameters)||void 0===c||c.push(u)}else(l=(0,o._)((0,n._)({},t.sub_parameters.find(e=>e.name===a)),{id:(0,i.x0)(),sub_parameters:[]})).value=String(d),null===(s=r.sub_parameters)||void 0===s||s.push(l)}})}else(r=(0,o._)((0,n._)({},t),{id:(0,i.x0)(),sub_parameters:[]})).value=String(e);return r},O=e=>{for(var t=(0,a.Z)(e),r=0,n=t.length;r<n;r++)if(t[r].type===u.rH.Array){var o=JSON.parse(t[r].global_default||"[]");if(o.length>0){var i=D(o,t[r].sub_parameters||[]);t[r].sub_parameters=i}}else t[r].sub_parameters=O(t[r].sub_parameters||[]);return t},Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.length)return[];for(var r=(0,a.Z)(e),n=0,o=r.length;n<o;n++){var i,l=r[n];void 0===l.global_default&&(l.global_disable=void 0),l.global_default=void 0,!t&&(l.is_required=void 0),l.sub_parameters=Z(null!==(i=l.sub_parameters)&&void 0!==i?i:[],t)}return r}},834557:function(e,t,r){r.d(t,{p:function(){return m}});var n=r(825955),o=r(151064),i=r(455069),l=r(335740),a=r(336205),s=r(775699),d=r(458949),c=r(577413),u=r(849201),p=(0,i.lazy)((0,n._)(function*(){var{Debug:e}=yield r.e("6226").then(r.bind(r,364112));return{default:e}})),m=e=>{var t,[r,n]=(0,i.useState)(!1),[m,v]=(0,i.useState)();return(0,i.useEffect)(()=>{!r&&v(void 0)},[r]),{exampleNode:(0,o.jsx)(s.M5,{title:a.o.t("plugin_edit_tool_test_run_example_tip"),visible:r,width:1280,style:{height:"calc(100vh - 140px)",minWidth:"1040px"},centered:!0,onCancel:()=>{n(!1)},footer:null,getPopupContainer:null==e?void 0:e.getPopupContainer,children:m?(0,o.jsx)(i.Suspense,{fallback:null,children:(0,o.jsx)(p,{disabled:!0,pluginId:"",apiId:null!==(t=null==m?void 0:m.api_id)&&void 0!==t?t:"",apiInfo:m,pluginName:"",debugExample:null==m?void 0:m.debug_example,isViewExample:!0})}):null}),doShowExample:e=>{var{scene:t,requestParams:r,debugExample:o}=e;if(!!r&&!!(null==o?void 0:o.req_example)){var i=(0,l.Z)(r);if("workflow"===t)(0,u.$T)(i,JSON.parse(null==o?void 0:o.req_example));else{if("bot"!==t)return;(0,u.rl)(i,JSON.parse(null==o?void 0:o.req_example))}(0,c.eO)(i),v({debug_example_status:d.ji.Enable,request_params:i,debug_example:o}),n(!0)}}}}},849201:function(e,t,r){r.d(t,{$T:function(){return u},C$:function(){return a},rl:function(){return c}});var n=r(801815),o=r(962289),i=r(458949),l={string:i.rH.String,integer:i.rH.Integer,number:i.rH.Number,object:i.rH.Object,array:i.rH.Array,bool:i.rH.Bool,list:i.rH.Array,float:i.rH.Number,boolean:i.rH.Bool},a=(e,t)=>{var r=(e,t)=>{e.forEach(e=>{var n,l,a=(0,o.Z)(t,null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"");void 0!==a&&(e.type===i.rH.Object?r(null!==(l=e.sub_parameters)&&void 0!==l?l:[],a):e.type===i.rH.Array?e.global_default=JSON.stringify(a):e.global_default=a)})};r(e,t)},s=e=>{if(Array.isArray(e))e.forEach(e=>{s(e)});else{if(e.type=l[e.type],e.sub_type=l[e.sub_type],e.is_required=e.required,e.global_disable=!1,e.local_disable=!1,e.location=void 0,e.id=(0,n.x0)(),e.desc=e.description,"schema"in e){if(e.type===i.rH.Array){var t,r,o;e.sub_parameters=[{name:"[Array Item]",is_required:e.required,type:l[null===(t=e.schema)||void 0===t?void 0:t.type],global_disable:!1,local_disable:!1,location:void 0,sub_type:0,sub_parameters:null!==(o=null===(r=e.schema)||void 0===r?void 0:r.schema)&&void 0!==o?o:[]}]}else e.type===i.rH.Object?e.sub_parameters=[...e.schema]:e.sub_parameters=[]}else e.sub_parameters=[];s(e.type===i.rH.Array?e.sub_parameters[0].sub_parameters:null==e?void 0:e.sub_parameters)}},d=e=>{Array.isArray(e)?e.forEach(e=>{d(e)}):(e.type=l[e.type],e.sub_type=l[e.sub_type],e.is_required=e.required,e.global_disable=!1,e.local_disable=!1,e.location=void 0,e.id=(0,n.x0)(),!("sub_parameters"in e)&&(e.sub_parameters=[]),"sub_params"in e&&(e.sub_parameters=e.sub_params),e.type===i.rH.Array?(e.sub_parameters=[{name:"[Array Item]",is_required:e.required,type:e.sub_type,global_disable:!1,local_disable:!1,location:void 0,sub_type:0,sub_parameters:[...e.sub_parameters]}],d(e.sub_parameters[0].sub_parameters)):d(e.sub_parameters))},c=(e,t)=>{d(e),a(e,t)},u=(e,t)=>{s(e),a(e,t)}},484621:function(e,t,r){r.d(t,{ct:function(){return i},j9:function(){return a},tG:function(){return s}});var n,o=r(455069);var i=((n={}).Bot="bot",n.DouyinBot="douyin-bot",n),l=(0,o.createContext)({scene:"bot"}),a=l.Provider,s=()=>{var e=(0,o.useContext)(l);if(!e)throw Error("useBotCreatorContext must be used within a BotCreatorProvider");return e}},445:function(e,t,r){r.d(t,{g:function(){return c}});var n=r(151064),o=r(817480),i=r(775699),l=r(193893),a=r(44172),s=r(951485),d=r(531),c=e=>{var t,{label:r,popoverContent:c,children:u}=e,p=(0,o.useField)();return(0,n.jsxs)("div",{className:d.Z["form-item"],children:[(0,n.jsxs)("div",{className:d.Z["field-content"],children:[(0,n.jsxs)("label",{className:d.Z["label-content"],children:[(0,n.jsx)("span",{className:d.Z.label,children:r}),c?(0,n.jsx)(i.J2,{className:s.Z.popover,showArrow:!0,arrowPointAtCenter:!0,content:(0,n.jsx)(l.HK,{markDown:c,autoFixSyntax:{autoFixEnding:!1}}),children:(0,n.jsx)(a.aUG,{className:d.Z.icon})}):null]}),(0,n.jsx)("div",{className:d.Z["field-main"],children:u})]}),null==p?void 0:null===(t=p.feedbacks)||void 0===t?void 0:t.map((e,t)=>(0,n.jsx)("p",{className:d.Z["field-feedback"],children:e.messages},t))]})}},601372:function(e,t,r){r.d(t,{t:function(){return u}});var n=r(151064),o=r(252237),i=r.n(o),l=r(336205),a=r(775699),s=r(532267),d=r(628104),c=()=>[{label:l.o.t("model_config_generate_precise"),value:s.bF.Precise},{label:l.o.t("model_config_generate_balance"),value:s.bF.Balance},{label:l.o.t("model_config_generate_creative"),value:s.bF.Creative},{label:l.o.t("model_config_generate_customize"),value:s.bF.Custom}],u=e=>{var{onChange:t,className:r,style:o,value:l,disabled:s}=e;return(0,n.jsx)(a.FX,{disabled:s,className:i()(d.Z["button-radio"],r),style:o,options:c(),value:l,onChange:e=>{t(e.target.value)},type:"button"})}},782024:function(e,t,r){r.d(t,{C:()=>N});var n=r("474872"),o=r("674343"),i=r("775699"),l=r("495419"),a=r("808549"),s=r("151064"),d=r("455069"),c=r("801815"),u=r("252237"),p=r.n(u),m=r("163600"),v=r("336205"),_=r("915757"),f=r("193893"),h=r("44172"),x=r("532267"),g=r("601372"),y=r("951485"),b=r("482970"),j=r("347731"),w=r("843873"),C=e=>{var{formilyCore:t,formilyReact:r,title:n,children:l,disabled:a}=e,u=r.useForm(),{isGenerationDiversityOpen:m,setGenerationDiversityOpen:j,hideDiversityCollapseButton:C}=(0,b.c)(),[k,N]=(0,d.useState)(u.values.model_style);return(0,d.useEffect)(()=>{var e=(0,c.x0)();return u.addEffects(e,()=>{t.onFormValuesChange(e=>{N(e.values.model_style)})}),()=>{u.removeEffects(e)}},[u]),(0,d.useEffect)(()=>{if(!a&&k===x.bF.Custom)j(!0)},[k]),(0,s.jsxs)("div",{className:p()(w.Z.group,!m&&w.Z["group-with-collapse"]),children:[(0,s.jsxs)("div",{className:w.Z["generation-diversity-group"],children:[(0,s.jsxs)("div",{className:p()(w.Z["group-label"],w.Z["diversity-label"]),children:[(0,s.jsx)("div",{children:n}),(0,s.jsx)(i.J2,{className:y.Z.popover,showArrow:!0,arrowPointAtCenter:!0,content:(0,s.jsx)(f.HK,{markDown:v.o.t("model_config_generate_explain"),autoFixSyntax:{autoFixEnding:!1}}),children:(0,s.jsx)(h.aUG,{className:w.Z.icon})})]}),(0,s.jsx)(g.t,{className:w.Z["radio-group"],disabled:a,value:k,onChange:e=>{u.setValues({model_style:e})}}),C?null:(0,s.jsx)(o.zx,{onClick:()=>{j(!m)},iconPosition:"right",icon:(0,s.jsx)(_.Wdl,{}),className:p()(m&&w.Z.rotate,w.Z.advance),color:"secondary",children:v.o.t("model_config_generate_advance")})]}),(0,s.jsx)(o.zF,{isOpen:m,className:w.Z.collapse,children:(0,s.jsx)("div",{className:w.Z.content,children:l})})]})},k=r("445"),N={[l.C.Input]:i.u3,[l.C.RadioButton]:o.FX,[l.C.Switch]:o.rs,[l.C.SliderInputNumber]:n.sN,[l.C.ModelFormItem]:k.g,[l.v.ModelFormGroupItem]:e=>{var{title:t,children:r}=e;return(0,s.jsxs)("div",{className:w.Z.group,children:[(0,s.jsx)("div",{className:p()(w.Z["group-label"],w.Z.title),children:t}),(0,s.jsx)("div",{className:w.Z.content,children:r})]})},[l.v.ModelFormGenerationDiversityGroupItem]:e=>{var{formilyModule:{formilyReact:t,formilyCore:r}}=(0,j.u)(),n=(0,m.ti)();return t&&r?(0,s.jsx)(C,(0,a._)({formilyCore:r,formilyReact:t,disabled:n},e)):null}}},307315:function(e,t,r){r.d(t,{q2:()=>V,Zc:()=>j});var n=r("473980"),o=r("151064"),i=r("455069"),l=r("252237"),a=r.n(l),s=r("966140"),d=r("177001"),c=r("336205"),u=r("178385"),p=r("484621"),m=r("915757"),v=r("674343"),_=r("916672");function f(e){var t,r,n,{model:i}=e;return(0,o.jsx)(v.u,{trigger:(null===(t=i.model_status_details)||void 0===t?void 0:t.is_upcoming_deprecated)?"hover":"custom",content:c.o.t("model_list_model_deprecation_date",{date:null===(r=i.model_status_details)||void 0===r?void 0:r.deprecated_date}),children:(0,o.jsx)("span",{children:(0,o.jsx)(h,{model:i,bottomBanner:(null===(n=i.model_status_details)||void 0===n?void 0:n.is_upcoming_deprecated)?(0,o.jsx)("div",{className:a()("absolute bottom-0 left-0","w-full py-[1px] px-[3px] rounded-b-[6px]","flex items-center justify-center text-center","text-[10px] font-medium leading-[14px] break-all","coz-mg-mask coz-fg-hglt-plus"),children:c.o.t("model_list_willDeprecated")}):void 0})})})}function h(e){var{model:{model_status_details:t,model_icon:r},bottomBanner:n}=e;if((null==t?void 0:t.is_new_model)||!(null==t?void 0:t.model_feature))return(0,o.jsx)(v.qE,{className:"shrink-0 rounded-[6px] border border-solid coz-stroke-primary",shape:"square",bottomSlot:n?{render:()=>n}:void 0,src:r});var i=x[t.model_feature];return(0,o.jsxs)("div",{className:a()("w-[48px] h-[48px] p-[13px] relative","shrink-0 rounded-[6px] text-[22px]",i.color,i.bg),children:[i.icon,n]})}var x={[u.Nm.Flagship]:{icon:(0,o.jsx)(m.os$,{}),color:"coz-fg-color-brand",bg:"coz-mg-hglt"},[u.Nm.HighSpeed]:{icon:(0,o.jsx)(m.RS5,{}),color:"coz-fg-color-blue",bg:"coz-mg-color-blue"},[u.Nm.CostPerformance]:{icon:(0,o.jsx)(m.o8x,{}),color:"coz-fg-color-blue",bg:"coz-mg-color-blue"},[u.Nm.LongText]:{icon:(0,o.jsx)(m.jKC,{}),color:"coz-fg-color-blue",bg:"coz-mg-color-blue"},[u.Nm.RolePlaying]:{icon:(0,o.jsx)(m.CpW,{}),color:"coz-fg-color-blue",bg:"coz-mg-color-blue"},[u.Nm.ImageUnderstanding]:{icon:(0,o.jsx)(m.F3t,{}),color:"coz-fg-color-purple",bg:"coz-mg-color-purple"},[u.Nm.VideoUnderstanding]:{icon:(0,o.jsx)(m.mqV,{}),color:"coz-fg-color-purple",bg:"coz-mg-color-purple"},[u.Nm.AudioUnderstanding]:{icon:(0,o.jsx)(m.W2A,{}),color:"coz-fg-color-purple",bg:"coz-mg-color-purple"},[u.Nm.CodeSpecialization]:{icon:(0,o.jsx)(m.OXw,{}),color:"coz-fg-color-cyan",bg:"coz-mg-color-cyan"},[u.Nm.ToolInvocation]:{icon:(0,o.jsx)(m.fNZ,{}),color:"coz-fg-color-cyan",bg:"coz-mg-color-cyan"},[u.Nm.Reasoning]:{icon:(0,o.jsx)(m.tf,{}),color:"coz-fg-color-cyan",bg:"coz-mg-color-cyan"}},g=r("675632");function y(e){var t,r,l,h,x,y,j,{model:w,selected:C,disabled:k,onClick:N}=e,S=(0,n._)(e,["model","selected","disabled","onClick"]),E=(0,i.useRef)(null),T=(0,s.Z)(E),{scene:I}=(0,p.tG)(),P=null===(t=w.model_tag_list)||void 0===t?void 0:t.filter(e=>e.tag_class===u.j_.ModelFeature&&e.tag_name).map(e=>e.tag_name),A=null===(r=w.model_tag_list)||void 0===r?void 0:r.filter(e=>e.tag_class===u.j_.ModelFunction&&e.tag_name).map(e=>e.tag_name),D=(null===(l=w.model_status_details)||void 0===l?void 0:l.is_new_model)||(null===(h=w.model_status_details)||void 0===h?void 0:h.is_advanced_model),L=(0,d.CZ)({scene:d.ej.NewModel}),{node:O,open:Z}=(0,d.zv)({scene:d.ej.NewModel});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("article",{ref:E,className:a()("pl-[16px] pr-[12px] w-full relative","flex gap-[16px] items-center rounded-[12px]",C?"coz-mg-hglt hover:coz-mg-hglt-hovered":"hover:coz-mg-secondary-hovered active:coz-mg-secondary-pressed",k?"cursor-not-allowed":"cursor-pointer",g.Z["model-option"],{[g.Z["model-option_selected"]]:C}),onClick:()=>{if(!k){if(D&&!L){Z();return}N()}},children:[(0,o.jsx)(f,{model:w}),(0,o.jsxs)("div",{className:a()("h-[80px] py-[12px] w-full","flex flex-col overflow-hidden","border-0 border-b border-solid coz-stroke-primary",g.Z["model-info-border"]),style:T?{mask:function(e){var t=e.reduce((e,t)=>e+(t?1:0),0);if(0===t)return"none";var r=32*t+(t-1)*3+16;return"linear-gradient(to left, rgba(0,0,0,0), rgba(0,0,0,0) ".concat(r,"px, #fff ").concat(r+24,"px)")}([S.enableConfig,S.enableJumpDetail])}:void 0,children:[(0,o.jsxs)("div",{className:"w-full flex items-center gap-[6px] overflow-hidden",children:[(0,o.jsx)(v.ZT.Title,{fontSize:"14px",ellipsis:{showTooltip:!0},children:w.name}),(0,o.jsxs)("div",{className:"shrink-0 flex gap-[6px]",children:[(null===(x=w.model_status_details)||void 0===x?void 0:x.is_free_model)&&I!==p.ct.DouyinBot?(0,o.jsx)(v.Vp,{size:"mini",color:"primary",className:"!coz-mg-plus",children:c.o.t("model_list_free")}):null,D&&!L?(0,o.jsx)(m.sWZ,{className:"coz-fg-hglt"}):null,(null==P?void 0:P.length)?P.map(e=>(0,o.jsx)(v.Vp,{size:"mini",color:"primary",className:"!bg-transparent !border border-solid coz-stroke-plus",children:e},e)):null]})]}),(0,o.jsxs)("div",{className:"flex items-center text-[12px] leading-[16px] coz-fg-dim overflow-hidden",children:[(0,o.jsxs)(b,{isFirst:!0,children:[(((null===(y=w.model_quota)||void 0===y?void 0:y.token_limit)||0)/1024).toFixed(0),"K"]}),(0,o.jsxs)(b,{isLast:!(null==A?void 0:A.length),className:"flex items-center gap-[4px]",children:[(0,o.jsx)("span",{children:w.model_name}),(null===(j=w.model_status_details)||void 0===j?void 0:j.update_info)?(0,o.jsx)(v.u,{content:w.model_status_details.update_info,children:(0,o.jsx)(m.HqR,{className:"ml-[2px] coz-fg-hglt-green"})}):null]}),(null==A?void 0:A.length)?(0,o.jsx)(v.u,{content:A.join("、"),children:(0,o.jsx)("span",{className:"overflow-hidden",children:(0,o.jsx)(_.D,{items:A,visibleItemRenderer:(e,t)=>(0,o.jsx)(b,{isLast:t===A.length-1,children:e},t),overflowRenderer:e=>(0,o.jsx)("span",{className:"pl-[6px] flex items-center",children:"+".concat(e.length)}),collapseFrom:"end"})})}):null]}),(0,o.jsx)(v.ZT.Text,{className:"mt-[4px] text-[12px] leading-[16px] coz-fg-secondary",ellipsis:{showTooltip:!0},children:w.model_brief_desc})]}),T?(0,o.jsxs)("div",{className:"absolute right-[12px] h-full flex items-center gap-[3px]",children:[S.enableConfig?(0,o.jsx)(v.hU,{icon:(0,o.jsx)(m.qBd,{}),color:"secondary",size:"default","data-testid":"model_select_option.config_btn",onClick:e=>{if(e.stopPropagation(),D&&!L){Z();return}if(C){S.onConfigClick();return}N()&&setTimeout(()=>S.onConfigClick())}}):null,S.enableJumpDetail?(0,o.jsx)(v.hU,{icon:(0,o.jsx)(m.taB,{}),color:"secondary",size:"default","data-testid":"model_select_option.detail_btn",onClick:e=>{e.stopPropagation(),S.onDetailClick(String(w.model_type))}}):null]}):null]}),O]})}function b(e){var{isFirst:t,isLast:r,className:n,children:i}=e;return(0,o.jsxs)("div",{className:a()({"pl-[6px]":!t},"shrink-0 flex items-center gap-[6px]"),children:[(0,o.jsx)("span",{className:n,children:i}),r?null:(0,o.jsx)("span",{className:"h-[9px] border-0 border-r border-solid coz-stroke-primary"})]})}function j(e){var t,{model:r}=e;return(0,o.jsxs)("div",{className:"px-[4px] flex items-center gap-[4px]",children:[(0,o.jsx)(v.qE,{shape:"square",size:"extra-extra-small",src:r.model_icon,className:"rounded-[4px] border border-solid coz-stroke-primary"}),(0,o.jsx)("span",{className:"text-[14px] leading-[20px] coz-fg-primary",children:r.name}),(null===(t=r.model_status_details)||void 0===t?void 0:t.is_upcoming_deprecated)?(0,o.jsx)(v.Vp,{size:"mini",color:"yellow",children:c.o.t("model_list_willDeprecated")}):null]})}var w=r("156133"),C=r("44172");function k(e){var t,{hidden:r,disabled:n,selectedModelId:l,selectedModel:s,modelList:d,extraHeaderSlot:u,onModelClick:p,onDetailClick:m,onConfigClick:v,enableConfig:_,enableJumpDetail:f}=e,{modelGroups:h}=(0,i.useMemo)(()=>({modelGroups:[d]}),[d]),x=e=>(0,o.jsx)(y,{model:e,disabled:n,selected:String(e.model_type)===l,onClick:()=>p(e),enableJumpDetail:f,onDetailClick:m,enableConfig:_&&(!n||String(e.model_type)===l),onConfigClick:()=>{v(e)}},e.model_type);return(0,o.jsxs)("div",{className:a()("max-h-[inherit]","p-[8px] flex flex-col gap-[8px] overflow-auto",{hidden:r}),children:[(0,o.jsxs)("div",{className:"flex items-center justify-between pl-4 pr-2 box-content h-[32px] pb-2 pt-1",children:[(0,o.jsx)("div",{className:"text-xxl font-medium coz-fg-plus",children:c.o.t("model_selection")}),u]}),(null==s?void 0:null===(t=s.model_status_details)||void 0===t?void 0:t.is_upcoming_deprecated)?(0,o.jsxs)("section",{className:"p-[12px] pl-[16px] rounded-[8px] coz-mg-hglt-yellow",children:[(0,o.jsx)("div",{className:"text-[14px] leading-[20px] font-medium coz-fg-plus",children:c.o.t("model_list_model_deprecation_notice")}),(0,o.jsx)("div",{className:"text-[12px] leading-[16px] coz-fg-primary",children:c.o.t("model_list_model_switch_announcement",{model_deprecated:s.name,date:s.model_status_details.deprecated_date,model_up:s.model_status_details.replace_model_name})})]}):null,h.map((e,t)=>e.map(x))]})}r("998262");var N=r("808549"),S=r("529801"),E=r("363036"),T=r("727914"),I=r("782024"),P=r("579625"),A=r("911254"),D=r("385345"),L=r("347731");function O(e){var{visible:t,disabled:r,selectedModel:n,onClose:i,modelConfigProps:l}=e,s=function(){var{formilyModule:e,retryImportFormily:t}=(0,L.u)();if("loading"===e.status||"unInit"===e.status)return{success:!1,node:(0,o.jsx)(v.gb,{loading:!0})};if("error"===e.status)return{success:!1,node:(0,o.jsxs)("div",{className:"h-full flex items-center gap-y-[8px] text-[14px]",children:[(0,o.jsx)(m.wR2,{className:"text-[#FF2710]"}),(0,o.jsxs)("div",{className:"font-semibold leading-[22px]",children:[(0,o.jsx)("span",{children:c.o.t("model_form_fail_text")}),(0,o.jsx)("span",{className:"cursor-pointer text-[#4D53E8]",onClick:t,children:c.o.t("model_form_fail_retry")})]})]})};if("ready"===e.status)return{success:!0,formilyPkg:(0,S.Z)(e,["status"])};throw(0,P.A)(e.status),new T.sH("normal_error","unrecognized formilyModule.status")}();return(0,o.jsxs)("div",{className:a()("h-full p-[16px] flex flex-col gap-[12px] overflow-auto",{hidden:!t}),children:[(0,o.jsxs)("div",{className:"flex items-center gap-[6px]",children:[(0,o.jsx)(v.hU,{icon:(0,o.jsx)(m.$1i,{}),color:"secondary",onClick:e=>{i()}}),(0,o.jsx)("span",{className:"text-[16px] leading-[22px] font-medium coz-fg-plus",children:c.o.t("model_list_model_setting",{model:null==n?void 0:n.name})})]}),s.success?(0,o.jsx)(Z,(0,N._)({disabled:r,currentModelId:(null==n?void 0:n.model_type)?String(null==n?void 0:n.model_type):"",modelConfigProps:l},s.formilyPkg)):s.node]})}function Z(e){var{disabled:t,currentModelId:r,formilyCore:n,formilyReact:{createSchemaField:l,FormProvider:a},modelConfigProps:{currentConfig:s,onConfigChange:d,modelStore:c,agentType:u,hideDiversityCollapseButton:p,diffType:m}}=e,{createForm:v}=n,_=(0,E.Z)(()=>v(),[r]),f=(0,E.Z)(()=>l({components:I.C}),[]),{getSchema:h,handleFormInit:x,handleFormUnmount:g}=(0,A.$)({currentModelId:r,editable:!t,getModelRecord:()=>s,onValuesChange:e=>{var{values:t}=e;d(t)},modelStore:c}),y=(0,i.useMemo)(()=>h({currentModelId:r,isSingleAgent:"single"===u,diffType:m}),[r,u,m]);return(0,i.useEffect)(()=>(new Promise(()=>x(_,n)),g),[_]),(0,o.jsx)(D.Q,{hideDiversityCollapseButton:p,children:(0,o.jsx)(a,{form:_,children:(0,o.jsx)(f,{schema:y})})})}function F(e){var{className:t,disabled:r,enableJumpDetail:n,popoverClassName:l,selectedModelId:s,modelList:d,onModelChange:c,triggerRender:u,modelListExtraHeaderSlot:p,clickToHide:m=!1,popoverPosition:_="bottomLeft",popoverAutoAdjustOverflow:f=!0,modalSlot:h,modelConfigProps:x,zIndex:g=999,defaultOpen:y=!1}=e,b=(0,i.useRef)(null),[N,S]=(0,i.useState)(y),[E,T]=(0,i.useState)(!1),I=d.find(e=>{var{model_type:t}=e;return s===String(t)});return(0,o.jsx)(v.J2,{zIndex:g,stopPropagation:!0,autoAdjustOverflow:f,visible:N,trigger:"click",position:_,onClickOutSide:()=>{S(!1),T(!1)},className:a()("!p-0"),content:(0,o.jsxs)("div",{className:a()("w-[480px] max-h-[50vh] !p-0 overflow-hidden",l),style:b.current?{width:b.current.clientWidth}:void 0,children:[x?(0,o.jsx)(O,{disabled:r,visible:E,selectedModel:I,onClose:()=>T(!1),modelConfigProps:x}):null,(0,o.jsx)(k,{hidden:E,disabled:r,selectedModelId:s,selectedModel:I,modelList:d,extraHeaderSlot:p,onModelClick:e=>{var t=c(e),r=!(0,w.Z)(t)||t;return r&&m&&(S(!1),T(!1)),r},enableJumpDetail:!!n,onDetailClick:e=>{if(!!n)window.open("/space/".concat(n.spaceId,"/model/").concat(e),"_blank")},enableConfig:!!x,onConfigClick:()=>{if(!!x)T(!0)}}),h]}),children:u?(0,o.jsx)("span",{className:r?"cursor-not-allowed":"cursor-pointer",onClick:()=>{!r&&S(!0)},children:u(I,N)}):(0,o.jsxs)("div",{ref:b,className:a()("w-full p-[4px] flex items-center justify-between rounded-[8px]","overflow-hidden cursor-pointer border border-solid","hover:coz-mg-secondary-hovered active:coz-mg-secondary-pressed",N?"coz-stroke-hglt":"coz-stroke-primary",t),onClick:()=>{!r&&S(!0)},children:[(0,o.jsx)(j,{model:I||{name:s}}),(0,o.jsx)(C.Wdl,{className:"coz-fg-secondary"})]})})}var M=r("120454"),z=r("664319"),R=r("550540"),B=r("215451");function V(e){var{onModelChange:t,canSelectSuperiorModel:r,modalSlot:l,modelListExtraHeaderSlot:a}=e,s=(0,n._)(e,["onModelChange","canSelectSuperiorModel","modalSlot","modelListExtraHeaderSlot"]),{fetchPremiumPlan:u,fetchPremiumPlans:p}=(0,B.LZ)((0,z.N)(e=>({fetchPremiumPlans:e.fetchPremiumPlans,fetchPremiumPlan:e.fetchPremiumPlan}))),m=(0,d.CZ)({scene:d.ej.NewModel}),{isFree:_}=(0,B.D1)(),f=(0,w.Z)(r)?r:m,[h,x]=(0,i.useState)({visible:!1}),{node:g,open:y}=(0,d.I4)();return(0,R.Z)(()=>{}),(0,o.jsx)(F,(0,N._)({modelListExtraHeaderSlot:a,onModelChange:e=>{var r,n,o,i=!(null===(r=e.model_status_details)||void 0===r?void 0:r.is_new_model)&&!(null===(n=e.model_status_details)||void 0===n?void 0:n.is_advanced_model);return f||i?t(e):(x({visible:!0,type:(null===(o=e.model_status_details)||void 0===o?void 0:o.is_new_model)?"new":"advance"}),!1)},modalSlot:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.u_,{zIndex:1031,visible:h.visible,title:"new"===h.type?c.o.t("model_list_upgrade_to_pro_version"):c.o.t("model_list_upgrade_to_pro_version_advancedModel"),cancelText:c.o.t("Cancel"),okText:c.o.t("model_list_upgrade_button"),onOk:()=>{window.open("/premium","_blank"),x(e=>(0,M._)((0,N._)({},e),{visible:!1}))},onCancel:()=>x(e=>(0,M._)((0,N._)({},e),{visible:!1})),children:"new"===h.type?c.o.t("model_list_ensure_service_quality"):c.o.t("model_list_upgrade_to_pro_advanced_tips")}),l,g]})},s))}},495419:function(e,t,r){r.d(t,{C:function(){return i},v:function(){return l}});var n,o,i=((n={}).SliderInputNumber="SliderInputNumber",n.Input="Input",n.Switch="Switch",n.RadioButton="RadioButton",n.ModelFormItem="ModelFormItem",n);var l=((o={}).ModelFormGroupItem="ModelFormGroupItem",o.ModelFormGenerationDiversityGroupItem="ModelFormGenerationDiversityGroupItem",o)},347789:function(e,t,r){r.d(t,{V:function(){return a},w:function(){return l}});var n=r(825955),o=r(151064),i=r(455069),l=(0,i.createContext)({formilyModule:{status:"unInit",formilyReact:null,formilyCore:null},retryImportFormily:()=>void 0}),a=e=>{var t,{children:a}=e,[s,d]=(0,i.useState)({status:"unInit",formilyCore:null,formilyReact:null});var c=(t=(0,n._)(function*(){d({formilyCore:null,formilyReact:null,status:"loading"});try{var[e,t]=yield Promise.all([Promise.resolve().then(r.bind(r,949926)),Promise.resolve().then(r.bind(r,817480))]);d({status:"ready",formilyCore:e,formilyReact:t})}catch(e){throw d({status:"error",formilyCore:null,formilyReact:null}),e}}),function(){return t.apply(this,arguments)});return(0,i.useEffect)(()=>{c()},[]),(0,o.jsx)(l.Provider,{value:{formilyModule:s,retryImportFormily:c},children:a})}},347731:function(e,t,r){r.d(t,{u:function(){return i}});var n=r(455069),o=r(347789),i=()=>(0,n.useContext)(o.w)},385345:function(e,t,r){r.d(t,{I:function(){return l},Q:function(){return a}});var n=r(151064),o=r(455069),i=r(335740),l=(0,o.createContext)({customizeValueMap:{},isGenerationDiversityOpen:!1,setCustomizeValues:()=>0,setGenerationDiversityOpen:()=>0}),a=e=>{var{hideDiversityCollapseButton:t=!1,children:r}=e,[a,s]=(0,o.useState)(t),d=(0,o.useRef)({});return(0,n.jsx)(l.Provider,{value:{hideDiversityCollapseButton:t,isGenerationDiversityOpen:a,setCustomizeValues:(e,t)=>{d.current[e]=(0,i.Z)(t)},customizeValueMap:d.current,setGenerationDiversityOpen:s},children:r})}},482970:function(e,t,r){r.d(t,{c:function(){return i}});var n=r(455069),o=r(385345),i=()=>(0,n.useContext)(o.I)},911254:function(e,t,r){r.d(t,{$:()=>F});var n=r("455069"),o=r("801815"),i=r("64605"),l=r("871873"),a=r("997516"),s=r("363036"),d=r("998600"),c=r("532267"),u=r("642553"),p=r("335740"),m=r("336205"),v=r("495419"),_=e=>{var t=(0,p.Z)(e),{properties:r}=t;return r&&"string"!=typeof r?(Object.entries(r).forEach(e=>{var[t,r]=e;if(!!(0,i.Z)(r)&&!!r.properties&&"2"===t){var n={label:m.o.t("model_config_history_round"),popoverContent:m.o.t("model_config_history_round_explain")},o={type:"number","x-component":v.C.SliderInputNumber,"x-decorator":v.C.ModelFormItem,"x-component-props":{step:1,max:100,min:0,decimalPlaces:0},"x-decorator-props":n,"x-index":0};Object.assign(r.properties,{HistoryRound:o})}}),t):t},f=r("473980"),h=r("633697"),x=r("998262"),g=r("178385"),y=r("579625"),b=e=>e?Number("0.".concat("0".repeat(e-1),"1")):1,j=e=>{var{type:t}=e;switch(t){case g.c4.Float:case g.c4.Int:return"number";case g.c4.Boolean:return"boolean";default:return"string"}},w=e=>{var{type:t,options:r}=e;if(null==r?void 0:r.length)return v.C.RadioButton;switch(t){case g.c4.Float:case g.c4.Int:return v.C.SliderInputNumber;case g.c4.Boolean:return v.C.Switch;default:return v.C.Input}},C=(e,t)=>{var{max:r,min:n,label:o,precision:i,options:l,desc:a,type:s}=t,d=(0,f._)(t,["max","min","label","precision","options","desc","type"]);return((0,y.K)(d),e===v.C.RadioButton)?{type:"button",options:null==l?void 0:l.map(e=>{var t,r=(0,u.Fx)(null!==(t=e.value)&&void 0!==t?t:"",s);return"boolean"==typeof r?{label:e.label,value:void 0}:{label:e.label,value:r}})}:e===v.C.Input?{}:e===v.C.SliderInputNumber?{max:Number(r),min:Number(n),step:b(i),decimalPlaces:i}:e===v.C.Switch?{}:e===v.C.ModelFormItem?{label:o,popoverContent:a}:((0,y.A)(e),{})},k=e=>{var{model_params:t}=e,r=(0,h.Z)(t.map(e=>e.param_class).filter(e=>!!e),e=>e.class_id).sort((e,t)=>{var r,n;return(null!==(r=e.class_id)&&void 0!==r?r:0)-(null!==(n=t.class_id)&&void 0!==n?n:0)}),n=(0,x.Z)(t,e=>{var t;return null===(t=e.param_class)||void 0===t?void 0:t.class_id}),o={type:"object",properties:{}};return r.forEach((e,t)=>{var r,i,a={type:"void",properties:{},"x-decorator":1===e.class_id?v.v.ModelFormGenerationDiversityGroupItem:v.v.ModelFormGroupItem,"x-decorator-props":{title:e.label},"x-index":t+1},s=n[null!==(r=e.class_id)&&void 0!==r?r:""];if(!!s)s.forEach((e,t)=>{var r=e.name,n=w(e),o=C(n,e),i=C(v.C.ModelFormItem,e),s={type:j(e),"x-component":n,"x-component-props":o,"x-decorator":v.C.ModelFormItem,"x-decorator-props":i,"x-index":t+1};(0,l.Z)(a.properties,{[r]:s})}),(0,l.Z)(o.properties,{[null!==(i=e.class_id)&&void 0!==i?i:""]:a})}),o},N=()=>{var{storeSet:{useModelStore:e}}=(0,u.ni)();return t=>{var r,n,{currentModelId:o,isSingleAgent:i,diffType:l}=t,{getModelById:a}=e.getState(),s=k({model_params:null!==(n=null===(r=a(o))||void 0===r?void 0:r.model_params)&&void 0!==n?n:[]});return i&&"model-diff"!==l?_(s):s}},S=(e,t)=>{var r=(0,p.Z)(e);return Object.keys(r).forEach(e=>{var n,o,i=t.find(t=>t.name===e);if(!!i){var l=r[e],a=i.type,{options:s}=i;if(null==s?void 0:s.length){if(s.findIndex(e=>e.value===String(l))>=0)return;r[e]=(0,u.Fx)(null!==(o=null===(n=s.at(0))||void 0===n?void 0:n.value)&&void 0!==o?o:"",a)}if(a===g.c4.Float||a===g.c4.Int){if("number"!=typeof l)return;var{max:d,min:c}=i,p=Number(d),m=Number(c);d&&l>p&&(r[e]=p),c&&l<m&&(r[e]=m)}}}),r},E=(e,t)=>e===c.bF.Balance?t.balance:e===c.bF.Creative?t.creative:e===c.bF.Precise?t.precise:e===c.bF.Custom?void 0:void(0,y.A)(e),T=e=>(function e(t){return Object.keys(t).reduce((r,n)=>{var o=t[n];return"object"!=typeof o||null===o||Array.isArray(o)?Object.assign(r,{[n]:o}):Object.assign(r,e(o)),r},{})})(e),I=r("808549"),P=r("120454"),A=e=>{var{HistoryRound:t,ContextContentType:r}=e,n=(0,f._)(e,["HistoryRound","ContextContentType"]),o={};return"number"==typeof t&&(o.HistoryRound=t),"number"==typeof r&&(o.ContextContentType=r),(0,P._)((0,I._)({},n),{ShortMemPolicy:o})};class D{constructor(e,t,r){this.name=e,this.min=t,this.i18nKey=r,this.validator=(e,t)=>{var r,n;if(r=e,Object.prototype.hasOwnProperty.call(r,"value")){;e.setSelfWarnings((null!==(n=e.value)&&void 0!==n?n:0)<this.min?[m.o.t(this.i18nKey)]:void 0)}},this.execute=(e,t)=>{var{onFieldInit:r,onFieldValueChange:n}=t;e.name===this.name&&(r(this.name,this.validator),n(this.name,this.validator))}}}var L=[new class e{constructor(){this.handler=(e,t)=>t.setValues({model_style:c.bF.Custom}),this.execute=(e,t)=>{var r,{onFieldInputValueChange:n}=t;(null===(r=e.param_class)||void 0===r?void 0:r.class_id)===1&&n(e.name,this.handler)}}},new D("frequency_penalty",0,"model_setting_alert"),new D("max_tokens",100,"model_setting_alert_2")],O=r("482970"),Z=["HistoryRound","model_style"],F=e=>{var{currentModelId:t,onValuesChange:r,getModelRecord:p,editable:m,modelStore:v}=e,_=(0,s.Z)(()=>(0,o.x0)(),[]),f=(0,n.useRef)(),{onlineModelList:h,offlineModelMap:x,getModelPreset:g}=v,[b,j]=(0,n.useState)(),{customizeValueMap:w,setCustomizeValues:C}=(0,O.c)(),k=N(),I=e=>{(0,i.Z)(e)&&"model_style"in e&&"number"==typeof e.model_style&&j(e.model_style)},{run:P}=(0,d.Z)(e=>{if(!!(0,i.Z)(e)){var n=A(e);b===c.bF.Custom&&C(t,e),r({values:n})}},{wait:200}),D=e=>{var r,n=g(t);if(!n)throw Error("failed to get presetValues, modelId: ".concat(t));var o=p(),{defaultValues:i}=n,s=null!==(r=o.model_style)&&void 0!==r?r:c.bF.Custom,d=T(o),u=E(s,n),m=w[t],v=(0,l.Z)({},d,s===c.bF.Custom?m:u),_=(0,l.Z)({model_style:s},i,v);return S((0,a.Z)(_,Object.keys(i).concat(Z)),e)},F=()=>{if(void 0===b)return;var e,r,n,o=g(t);if(!!o){if(b===c.bF.Custom){var i,l=w[t];if(!l)return;null===(i=f.current)||void 0===i||i.setValues(l);return}var{balance:a,creative:s,precise:d}=o;if(b===c.bF.Balance){a&&(null===(e=f.current)||void 0===e||e.setValues(a));return}if(b===c.bF.Precise){d&&(null===(r=f.current)||void 0===r||r.setValues(d));return}if(b===c.bF.Creative){s&&(null===(n=f.current)||void 0===n||n.setValues(s));return}(0,y.A)(b)}};return(0,n.useEffect)(()=>{var e;null===(e=f.current)||void 0===e||e.setFormState({editable:m})},[m]),(0,n.useEffect)(()=>{F()},[b]),{getSchema:k,handleFormInit:(e,r)=>{var n,o=(0,u.Vc)({onlineModelList:h,offlineModelMap:x,id:t}),i=null!==(n=null==o?void 0:o.model_params)&&void 0!==n?n:[];e.addEffects(_,()=>{r.onFormValuesChange(e=>{I(e.values),P(e.values)}),i.forEach(e=>{L.forEach(t=>{t.execute(e,r)})})}),e.setValues(D(i),"overwrite"),e.setFormState({editable:m}),f.current=e},handleFormUnmount:()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.removeEffects(_)}}}},579625:function(e,t,r){r.d(t,{A:function(){return n},K:function(){return o}});var n=e=>0,o=e=>0},287411:function(e,t,r){r.d(t,{eL:()=>c,YS:()=>h,gp:()=>a,WB:()=>ep,L8:()=>d,o_:()=>x,TB:()=>D,tx:()=>p,XJ:()=>s,Ht:()=>A,ir:()=>f});var n,o,i,l,a=((n={}).All="1",n.Mine="2",n),s=1,d=10;var c=((o={}).Mine="mine",o.Team="team",o.Favorite="favorite",o.Project="project",o.Local="local",o.Coze="coze",o),u=r("30961");var p=((i={}).WorkflowAddNode="workflow_addNode",i.BotSkills="bot_skills",i.BotTrigger="bot_trigger",i.ProjectIde="project_ide",i.ProjectWorkflow="project_workflow",i),m=r("336205"),v=r("656927"),_=r("318281");r("915100"),r("789716");var f=()=>({active_icon_url:v.Z,icon_url:_.Z,id:"",name:m.o.t("All")}),h=e=>{var t,r;return(null!==(t=e.plugin_id)&&void 0!==t?t:"0")+(null!==(r=e.name)&&void 0!==r?r:"")},x=e=>{var{apiInfo:t}=e;return(null==t?void 0:t.name)&&(null==t?void 0:t.plugin_id)?"".concat(t.name,"_").concat(t.plugin_id):""},g=r("825955"),y=r("808549"),b=r("517465"),j=r.n(b),w=r("721566"),C=r("117140"),k=r("458949"),N=r("382534"),S=(e,t)=>{if(!(e in{current_entity_id:"current_entity_id",current_entity_version:"current_entity_version"}))return t;if(""!==t)return t};function E(e,t){var r,n,o,i,l,a,s,d,c,u,p,m,v,_,f,h,x,g,b,j,w,C,k,N,S,E,T,I,P,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{productInfo:(0,y._)({id:String(null==e?void 0:null===(d=e.meta_info)||void 0===d?void 0:d.id),category:null==e?void 0:null===(c=e.meta_info)||void 0===c?void 0:c.category,entity_type:null==e?void 0:null===(u=e.meta_info)||void 0===u?void 0:u.entity_type,favorite_count:null==e?void 0:null===(p=e.meta_info)||void 0===p?void 0:p.favorite_count,heat:null==e?void 0:null===(m=e.meta_info)||void 0===m?void 0:m.heat,is_favorited:null==e?void 0:null===(v=e.meta_info)||void 0===v?void 0:v.is_favorited,is_free:null==e?void 0:null===(_=e.meta_info)||void 0===_?void 0:_.is_free,favorite_time:String(A||""),status:null==e?void 0:null===(f=e.meta_info)||void 0===f?void 0:f.status,listed_at:null==e?void 0:null===(h=e.meta_info)||void 0===h?void 0:h.listed_at,user_info:e.meta_info.user_info},e.plugin_extra),pluginInfo:{name:null==e?void 0:null===(x=e.meta_info)||void 0===x?void 0:x.name,plugin_apis:(l=null==(r=e)?void 0:null===(n=r.meta_info)||void 0===n?void 0:n.name,a="".concat((null==r?void 0:null===(o=r.meta_info)||void 0===o?void 0:o.entity_id)||""),null==(s=null==r?void 0:null===(i=r.plugin_extra)||void 0===i?void 0:i.tools)?void 0:s.map(e=>{var t,r;return{api_id:"".concat((null==e?void 0:e.id)||""),desc:null==e?void 0:e.description,name:null==e?void 0:e.name,plugin_id:a,plugin_name:l,record_id:"",card_binding_info:{thumbnail:null==e?void 0:null===(t=e.card_info)||void 0===t?void 0:t.card_url},parameters:null==e?void 0:null===(r=e.parameters)||void 0===r?void 0:r.map(e=>({name:null==e?void 0:e.name,desc:null==e?void 0:e.description,required:null==e?void 0:e.required,type:null==e?void 0:e.type,sub_params:null==e?void 0:e.sub_params})),debug_example:null==e?void 0:e.example}})),id:"".concat((null==e?void 0:null===(g=e.meta_info)||void 0===g?void 0:g.entity_id)||""),plugin_icon:null==e?void 0:null===(b=e.meta_info)||void 0===b?void 0:b.icon_url,desc_for_human:null==e?void 0:null===(j=e.meta_info)||void 0===j?void 0:j.description,creator:{id:"".concat((null==e?void 0:null===(C=e.meta_info)||void 0===C?void 0:null===(w=C.user_info)||void 0===w?void 0:w.user_id)||""),name:null==e?void 0:null===(N=e.meta_info)||void 0===N?void 0:null===(k=N.user_info)||void 0===k?void 0:k.name,avatar_url:null==e?void 0:null===(E=e.meta_info)||void 0===E?void 0:null===(S=E.user_info)||void 0===S?void 0:S.avatar_url},statistic_data:{bot_quote:(null==e?void 0:null===(T=e.plugin_extra)||void 0===T?void 0:T.bots_use_count)||0},tag:null==e?void 0:null===(P=e.meta_info)||void 0===P?void 0:null===(I=P.category)||void 0===I?void 0:I.id},isFromMarket:!0,belong_page:t,commercial_setting:e.commercial_setting}}function T(){return(T=(0,g._)(function*(e,t){var r,n,{nextPage:o,isCoze:i}=t,{search:l,type:a,orderByPublic:s,botInfo:d={},isOfficial:c,pluginType:u}=e,p=yield N.yF.PublicGetProductList((0,y._)({entity_type:i?C._J.SaasPlugin:C._J.Plugin,category_id:void 0,sort_type:s,page_num:o,page_size:20,keyword:l,source:"recommend"===a?C.QJ.CustomizedRecommend:void 0,is_official:c,plugin_type:u},d),{paramsSerializer:e=>j().stringify(e,{filter:S})}),m=((null==p?void 0:null===(r=p.data)||void 0===r?void 0:r.products)||[]).map(e=>E(e,o)),v=m.length>0&&(null==p?void 0:null===(n=p.data)||void 0===n?void 0:n.has_more)||!1;return{list:m,total:-1,hasMore:v}})).apply(this,arguments)}function I(){return(I=(0,g._)(function*(e,t){var r,n,o,{nextPage:i}=t,{search:l,orderByFavorite:a}=e,s=yield N.yF.PublicGetUserFavoriteList({entity_type:C._J.Plugin,sort_type:a,page_num:i,page_size:20,key_wrod:l}),d=null===(r=(null==s?void 0:null===(n=s.data)||void 0===n?void 0:n.favorite_products)||[])||void 0===r?void 0:r.map(e=>E(e.product,i,"".concat((null==e?void 0:e.created_at)||""))),c=d.length>0&&(null==s?void 0:null===(o=s.data)||void 0===o?void 0:o.has_more)||!1;return{list:d,total:-1,hasMore:c}})).apply(this,arguments)}function P(){return(P=(0,g._)(function*(e,t){var r,{nextPage:n}=t,{search:o,projectId:i,devId:l,orderBy:a}=e,s=yield N.Js.GetDevPluginList({page:n,size:d,space_id:w.rY.getState().getSpaceId(),name:o,dev_id:l,project_id:i,order_by:a}),c=null===(r=(null==s?void 0:s.plugin_list)||[])||void 0===r?void 0:r.map(e=>({pluginInfo:e,isFromMarket:!1,belong_page:n})),u=c.length>0&&n*d<Number(null==s?void 0:s.total);return{list:c,total:-1,hasMore:u}})).apply(this,arguments)}var A=(e,t)=>{var{isMine:r,isTeam:n,isFavorite:o,isProject:i}=t;if(console.log("[div] params:",e,t),r||n)return function(e,t){var{isMine:r,isTeam:n,isCreatorMine:o,isTemplate:i,nextPage:l}=t,a=[k.zV.PLUGIN,k.zV.APP,k.zV.LOCAL],{search:s,orderByPublic:c,orderBy:u}=e,p={page:l||1,size:d,name:s||void 0,self_created:!!r||!!n&&!!o||void 0,order_by:i?c:u,plugin_types:a,space_id:w.rY.getState().getSpaceId(),channel_id:1};return N.Js.GetPlaygroundPluginList(p).then(e=>{var t,r,n,o=(null===(r=e.data)||void 0===r?void 0:null===(t=r.plugin_list)||void 0===t?void 0:t.map(e=>({pluginInfo:e,isFromMarket:!1,belong_page:l})))||[],i=o.length>0&&l*d<Number(null===(n=e.data)||void 0===n?void 0:n.total);return{list:o,total:-1,hasMore:i}})}(e,t);if(o)return function(e,t){return I.apply(this,arguments)}(e,t);if(i)return function(e,t){return P.apply(this,arguments)}(e,t);return function(e,t){return T.apply(this,arguments)}(e,t)},D=e=>{var{query:t,isSearching:r,isTemplate:n,page:o}=e,{orderBy:i,orderByPublic:l,type:a,mineActive:s}=t;return r?void 0:n?"plugin-".concat(a,"-").concat(o,"-").concat(l):"plugin-".concat(a,"-").concat(o,"-").concat(i,"-").concat(s)},L=r("151064"),O=r("455069"),Z=r("252237"),F=r.n(Z),M=r("584466"),z=r("998262"),R=r("775699"),B=r("44172"),V=r("734390"),U=r("298203"),H=r("707107"),W=r("388993"),G=r("214942"),K=r("730274"),J=r("982997"),q=r("322512"),$=r("689951"),X=r("13194"),Y=r("474872"),Q=r("674343"),ee=r("834557"),et=r("916672");var er=((l={})[l.NoAuth=0]="NoAuth",l[l.Required=1]="Required",l[l.Configured=2]="Configured",l[l.Supported=3]="Supported",l[l.NeedInstalled=9]="NeedInstalled",l),en=r("915757");r("298188");var eo=e=>{var{avgExecTime:t,callAmount:r,successRate:n,botsUseCount:o,className:i}=e;return null},ei=e=>{var{children:t,id:r,show:n=!0}=e;return n?(0,L.jsx)(Q.J2,{content:(0,L.jsxs)("div",{children:[(0,L.jsxs)(Q.T,{spacing:6,children:[(0,L.jsx)(en.sWZ,{className:"text-[16px] coz-fg-hglt"}),(0,L.jsx)("span",{className:"font-[500] ",children:"此插件需要管理员开通后使用"})]}),(0,L.jsx)("div",{className:"my-[8px] ",children:"此插件为三方付费插件，需要开通后使用。"}),(0,L.jsx)("div",{children:(0,L.jsx)(Q.mw,{className:"w-full",color:"aiplus",hideIcon:!0,onClick:()=>{window.open("https://www.coze.cn/store/plugin/".concat(r,"?from=coze-studio-open"),"_blank")},children:"去开通"})})]}),showArrow:!0,children:t}):t},el=e=>{var t,r,n,{isAdded:o,onApiToggle:i,pluginApi:l,marketStatus:a,showButton:s,from:d,workflowNodes:c,loading:u,marketPluginInfo:v,isLocalPlugin:_,connectors:f,auth_mode:h,productId:x}=e,{name:g,desc:y,parameters:b,debug_example:j}=l,{exampleNode:w,doShowExample:k}=(0,ee.p)(),[N,{setFalse:S,setTrue:E}]=(0,$.Z)(!1),[T,I]=(0,O.useState)((c||[]).length),P=d===p.WorkflowAddNode||d===p.ProjectWorkflow,A=a===(null===C.Pt||void 0===C.Pt?void 0:C.Pt.Unlisted)||h===er.NeedInstalled,D=_&&(!P&&!o||P&&0===T);return(0,L.jsxs)(L.Fragment,{children:[w,(0,L.jsxs)("div",{className:J.Z["plugin-item"],children:[(0,L.jsxs)("div",{className:J.Z["plugin-api-main"],children:[(0,L.jsxs)(R.T,{className:J.Z["plugin-api-name"],children:[(0,L.jsx)(R.ZT.Text,{ellipsis:{showTooltip:{opts:{content:g,style:{wordBreak:"break-word"}}}},children:g}),(null==l?void 0:null===(t=l.card_binding_info)||void 0===t?void 0:t.thumbnail)?(0,L.jsx)(Y.br,{url:null==l?void 0:null===(r=l.card_binding_info)||void 0===r?void 0:r.thumbnail}):null]}),(0,L.jsxs)("div",{className:J.Z["plugin-api-desc"],children:[(0,L.jsx)(R.ZT.Text,{style:{width:640},ellipsis:{showTooltip:{opts:{content:y,style:{wordBreak:"break-word",maxWidth:"560px"}}},rows:1},children:y}),!!(null==b?void 0:b.length)&&(0,L.jsxs)("div",{className:J.Z["api-params"],children:[(0,L.jsx)(et.D,{items:null===(n=(0,q.Z)(b,e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.length}))||void 0===n?void 0:n.map((e,t)=>({tagName:e.name,key:String(t)})),overflowRenderer:e=>e.length?(0,L.jsxs)(R.fS,{className:J.Z["tag-item"],size:"small",children:["+",e.length]}):null,visibleItemRenderer:e=>(0,L.jsx)(R.fS,{className:J.Z["tag-item"],size:"small",children:e.tagName},e.key),collapseFrom:"end",className:J.Z["params-tags"]}),(0,L.jsx)(X.C,{pluginApi:l,children:(0,L.jsx)("div",{className:J.Z["params-desc"],children:m.o.t("parameters")})}),j?(0,L.jsx)("div",{className:J.Z["params-desc"],style:{marginLeft:"8px"},onClick:()=>k({scene:"bot",requestParams:b,debugExample:j}),children:m.o.t("plugin_edit_tool_view_example")}):null]}),(0,L.jsx)(eo,{className:J.Z["store-plugin-tools"],callAmount:null==v?void 0:v.call_amount,avgExecTime:null==v?void 0:v.avg_exec_time,successRate:null==v?void 0:v.success_rate,botsUseCount:null==v?void 0:v.bots_use_count})]})]}),(0,L.jsx)("div",{className:J.Z["plugin-api-method"],children:s?(0,L.jsx)(Q.gn,{trigger:!A&&D?"click":"custom",position:"bottomRight",title:m.o.t("store_service_plugin_connector_only",{connector_names:null==f?void 0:f.join("、")}),okText:m.o.t("Add_1"),cancelText:m.o.t("Cancel"),onConfirm:()=>{null==i||i().then(e=>{e&&I(e=>e+1)})},children:(0,L.jsx)("div",{children:(0,L.jsx)(R.u,{content:m.o.t("mkpl_plugin_delisted_tips"),trigger:A?"hover":"custom",children:(0,L.jsx)(ei,{id:x,show:h===er.NeedInstalled,children:(0,L.jsx)(R.y3,{"data-testid":"bot.ide.plugin.plugin-panel-plugin-item-btn",className:F()(J.Z["operator-btn"],{[J.Z.added]:!A&&o,[J.Z.addedMouseIn]:!A&&o&&N}),onClick:()=>{if(!D)null==i||i().then(e=>{e&&I(e=>e+1)})},onMouseEnter:()=>{E()},disabled:A,loading:u&&P,onMouseLeave:()=>{S()},children:o&&!A?N?m.o.t("Remove"):m.o.t("Added"):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{children:m.o.t("Add_1")}),P&&0!==T?(0,L.jsx)("span",{className:J.Z.workflow_count_span,children:T}):null]})})})})})},"".concat(D)):null})]})]})},ea=(e,t)=>{var r,n,o,i=t.find(t=>t.name===e);return null!==(o=null==i?void 0:null===(n=i.input)||void 0===n?void 0:null===(r=n.value)||void 0===r?void 0:r.content)&&void 0!==o?o:""},es=r("947578"),ed=r("346707"),ec=r("156133"),eu=e=>{var{onApiToggle:t}=e;return(0,L.jsx)(R.y3,{onClick:e=>{e.stopPropagation(),null==t||t()},children:m.o.t("add_resource_modal_copy_to_project")})},ep=e=>{var t,r,n,o,i,l,a,s,d,c,v,{info:_,highlightWords:f,showCreator:x=!1,showCreateTime:b=!0,showPublishTime:j=!1,showButton:w=!0,showCopyPlugin:S=!1,className:E="",pluginApiList:T,productInfo:I,showMarketLink:P,showProjectPluginLink:A,clickProjectPluginCallback:D,isFromMarket:Z,onPluginApiListChange:q,openMode:$,from:X,workflowNodes:ee,openModeCallback:et,onCopyPluginCallback:ep,scrollContainerRef:em,type:ev,activeKey:e_,agentId:ef,index:eh=0,addonBefore:ex,addonAfter:eg}=e,{name:ey,plugin_apis:eb,id:ej,plugin_icon:ew,project_id:eC,desc_for_human:ek,create_time:eN=0,update_time:eS=0,statistic_data:eE,listed_at:eT,plugin_product_status:eI,plugin_type:eP,is_official:eA,version_name:eD,version_ts:eL}=_,eO=(0,W.G)(e=>e.botId),{id:eZ,status:eF,auth_mode:eM}=I||{},ez=(0,O.useRef)(null),eR=(0,O.useRef)(!1),eB=(0,O.useRef)(""),[eV,eU]=(0,O.useState)(!1),eH=(0,O.useMemo)(()=>(0,z.Z)(ee||[],e=>{var t,r,n,o=null!==(n=null===(r=e.data)||void 0===r?void 0:null===(t=r.inputs)||void 0===t?void 0:t.apiParam)&&void 0!==n?n:[],i=ea("pluginID",o),l=ea("apiID",o);return"".concat(i,"_").concat(l)}),[ee]),[eW]=(0,M.Z)(ez,{root:()=>null==em?void 0:em.current}),eG=(0,O.useMemo)(()=>!!ej&&(!!(e_===ej||(null==e_?void 0:e_.includes(ej)))||!1),[e_,ej]);(0,O.useEffect)(()=>{eG&&(0,H.Gg)(H.Kg.product_click_front,{plugin_id:_.id,product_id:"".concat(null==I?void 0:I.id),product_name:(null==_?void 0:_.name)||"",entity_type:"plugin",source:"add_plugin_menu",from:"add_plugin_menu",filter_tag:ev||"",action:"expand_tools",c_position:eh})},[eG,null==I?void 0:I.id]),(0,O.useEffect)(()=>{if(!!Z&&!eR.current)eW&&(eR.current=!0,(0,H.Gg)(H.Kg.product_show_front,{plugin_id:_.id,product_id:"".concat(null==I?void 0:I.id),product_name:(null==_?void 0:_.name)||"",entity_type:"plugin",source:"add_plugin_menu",from:"add_plugin_menu",filter_tag:ev||"",c_position:eh}))},[eW,I,_,ev]);var eK=j?m.o.t("mkl_plugin_publish"):b?m.o.t("mkl_plugin_created"):m.o.t("mkl_plugin_updated"),eJ=(j?Number(eT):b?Number(eN):Number(eS))||0;return(0,L.jsx)(R.UO.Panel,{"data-testid":"plugin-collapse-panel",className:F()(J.Z["plugin-panel"],E),disabled:!(null==eb?void 0:eb.length),header:(0,L.jsxs)("div",{className:J.Z["plugin-panel-header"],ref:ez,children:[(0,L.jsx)(V.vC,{size:"small",visible:null!==(v=null==I?void 0:I.is_official)&&void 0!==v&&v,children:(0,L.jsx)(R.Ee,{className:J.Z["header-icon"],src:ew,preview:!1})}),(0,L.jsxs)("div",{className:J.Z["header-main"],children:[(0,L.jsx)("div",{className:J.Z["header-name"],children:(0,L.jsxs)(R.T,{spacing:8,className:"flex-1",children:[(0,L.jsx)(R.ZT.Text,{children:(0,L.jsx)(R.y$,{sourceString:ey,searchWords:f,component:"strong"})}),(0,ed.Z)(eM)||eM===er.NoAuth?null:eM===er.NeedInstalled?(0,L.jsx)(ei,{id:eZ,children:(0,L.jsx)(Q.Vp,{color:"yellow",className:"font-medium !py-2px !px-4px !h-20px",children:"待开通"})}):eM===er.Required||eM===er.Supported?(0,L.jsx)(Q.Vp,{color:"yellow",className:"font-medium !py-2px !px-4px !h-20px",children:m.o.t("plugin_tool_config_status_unauthorized")}):(0,L.jsx)(Q.Vp,{color:"brand",className:"font-medium !py-2px !px-4px !h-20px",children:m.o.t("plugin_tool_config_status_authorized")}),A&&D?(0,L.jsx)(B.WXt,{className:J.Z["market-link-icon"],onClick:e=>{e.stopPropagation(),null==D||D((0,y._)({},_))}}):null,P&&Number(eZ)>0?(0,L.jsx)(B.WXt,{className:J.Z["market-link-icon"],onClick:e=>{e.stopPropagation(),(0,H.Gg)(H.Kg.product_click_front,{plugin_id:_.id,product_id:"".concat(null==I?void 0:I.id),product_name:(null==_?void 0:_.name)||"",entity_type:"plugin",source:"add_plugin_menu",from:"add_plugin_menu",filter_tag:ev||"",action:"enter_detailpage",c_position:eh}),window.open("/store/plugin/".concat(eZ,"?from=add_plugin_menu"))}}):null]})}),(0,L.jsxs)("div",{className:F()(J.Z["header-desc"],"flex items-center"),children:[eP===k.zV.LOCAL?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Q.Vp,{color:"cyan",size:"mini",children:m.o.t("local_plugin_label")}),(0,L.jsx)(R.iz,{layout:"vertical",margin:"4px",className:"h-[9px]"})]}):null,(0,L.jsx)(R.ZT.Text,{ellipsis:{showTooltip:{opts:{content:ek,style:{wordWrap:"break-word",maxWidth:"560px"}}},rows:1},children:ek})]}),(0,L.jsx)("div",{className:"my-[8px] leading-[16px]",children:(0,L.jsxs)(R.T,{spacing:4,children:[ex,(null==I?void 0:I.plugin_type)===C.zV.LocalPlugin?(0,L.jsx)(Q.Vp,{color:"cyan",prefixIcon:(0,L.jsx)(en.ztm,{className:"coz-fg-color-cyan text-[10px]"}),size:"mini",children:m.o.t("store_service_plugin")}):null,(0,L.jsx)(Q.Vp,{color:"primary",size:"mini",children:m.o.t("bot_edit_page_plugin_list_plugin_has_n_tools",{n:null==eb?void 0:eb.length})}),!!(null==eE?void 0:eE.bot_quote)&&(0,L.jsx)(Q.Vp,{color:"primary",size:"mini",children:m.o.t("bot_edit_page_plugin_list_plugin_n_bots_using",{n:(0,U.uf)(null==eE?void 0:eE.bot_quote)})}),(null==I?void 0:null===(t=I.connectors)||void 0===t?void 0:t.length)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(R.iz,{layout:"vertical",margin:0,className:"coz-stroke-primary"}),(0,L.jsxs)("div",{className:"ml-auto coz-fg-secondary text-base flex items-center gap-6px",children:[m.o.t("store_service_plugin_connector"),(0,L.jsx)(V.Hm,{connectors:null==I?void 0:I.connectors}),(0,L.jsx)(Q.u,{content:m.o.t("store_add_connector_tootip"),theme:"dark",children:(0,L.jsx)(en.L03,{className:"coz-fg-secondary text-lg"})})]})]}):null]})}),(0,L.jsxs)("div",{className:"flex justify-between",children:[(0,L.jsxs)(R.T,{className:J.Z["header-info"],children:[x?(0,L.jsx)("span",{className:"max-w-[260px]",children:(0,L.jsx)(Y.gj,{avatar:null==I?void 0:null===(r=I.user_info)||void 0===r?void 0:r.avatar_url,username:null==I?void 0:null===(n=I.user_info)||void 0===n?void 0:n.user_name,name:null==I?void 0:null===(o=I.user_info)||void 0===o?void 0:o.name,label:{name:null==I?void 0:null===(l=I.user_info)||void 0===l?void 0:null===(i=l.user_label)||void 0===i?void 0:i.label_name,icon:null==I?void 0:null===(s=I.user_info)||void 0===s?void 0:null===(a=s.user_label)||void 0===a?void 0:a.icon_url,href:null==I?void 0:null===(c=I.user_info)||void 0===c?void 0:null===(d=c.user_label)||void 0===d?void 0:d.jump_link},nameMaxWidth:150})}):null,x?(0,L.jsx)(R.iz,{layout:"vertical"}):null,(0,L.jsxs)("div",{className:J.Z["creator-time"],children:["".concat(eK," "),(0,U.p6)(eJ,"YYYY-MM-DD HH:mm")]}),eg]}),(0,L.jsx)(eo,{className:J.Z["plugin-total"],successRate:null==I?void 0:I.success_rate,callAmount:null==I?void 0:I.call_amount,avgExecTime:null==I?void 0:I.avg_exec_time,botsUseCount:null==I?void 0:I.bots_use_count})]})]}),S?(0,L.jsx)("div",{children:(0,L.jsx)(eu,{onApiToggle:()=>{null==ep||ep({pluginID:ej,name:ey})}})}):null]}),itemKey:"".concat(ej),children:null==eb?void 0:eb.map(e=>{var t,r,n,o,i,l,a=T.some(t=>{var r,n,o,i,l,a;return t.api_id&&t.api_id===e.api_id||(null!==(o=null===(r=t.plugin_id)||void 0===r?void 0:r.toString())&&void 0!==o?o:"0")+(null!==(i=t.name)&&void 0!==i?i:"")===(null!==(l=null===(n=e.plugin_id)||void 0===n?void 0:n.toString())&&void 0!==l?l:"0")+(null!==(a=e.name)&&void 0!==a?a:"")});return(0,L.jsx)(el,{"data-testid":"plugin-panel-item-pluginapi",isAdded:a,pluginApi:e,productId:null==I?void 0:I.id,from:X,auth_mode:eM,workflowNodes:null!==(o=eH["".concat(null==e?void 0:e.plugin_id,"_").concat(null==e?void 0:e.api_id)])&&void 0!==o?o:[],marketPluginInfo:Z?null==I?void 0:null===(t=I.tools)||void 0===t?void 0:t.find(t=>t.id===e.api_id):void 0,isLocalPlugin:(null==I?void 0:I.plugin_type)===C.zV.LocalPlugin,connectors:null==I?void 0:null===(r=I.connectors)||void 0===r?void 0:r.map(e=>{var t;return null!==(t=e.name)&&void 0!==t?t:""}),marketStatus:Z?eF:void 0,onApiToggle:(0,g._)(function*(){var t=!0;if((0,U.Kn)(U.Ij.PLUGIN_API_BLOCK_OPEN),a)q(T.filter(t=>h(t)!==h(e)&&(!(null==t?void 0:t.api_id)||(null==t?void 0:t.api_id)!==(null==e?void 0:e.api_id)))),R.FN.success({content:m.o.t("bot_edit_tool_removed_toast",{api_name:e.name}),showClose:!1}),(0,H.Gg)(H.Kg.click_tool_select,{operation:"remove",bot_id:eO,operation_type:"single",tool_id:(null==e?void 0:e.api_id)||"",tool_name:(null==e?void 0:e.name)||"",product_id:"".concat(null==I?void 0:I.id),product_name:(null==_?void 0:_.name)||"",source:"add_plugin_list",from:"bot_develop"});else{var r={plugin_icon:ew,plugin_type:eP,is_official:eA,project_id:eC,version_name:eD,version_ts:eL,plugin_from:(null==I?void 0:I.entity_type)===C._J.SaasPlugin?K.Xh.FromSaas:K.Xh.Default};if(T.map(e=>{var t;return(null!==(t=e.plugin_name)&&void 0!==t?t:"")+e.name}).includes((null!==(o=e.plugin_name)&&void 0!==o?o:"")+(null!==(i=e.name)&&void 0!==i?i:"")))R.FN.error({content:m.o.t("plugin_name_conflict_error"),showClose:!1}),t=!1;else{if(Z){if(e.plugin_id&&(null==e?void 0:e.api_id)&&(null==e?void 0:e.api_id)!=="0"){eU(!0),eB.current=e.api_id;var n,o,i,l,s,d,c,v,f,x=yield N.Js.GetPlaygroundPluginList({page:1,size:1,plugin_ids:[e.plugin_id],plugin_types:[k.zV.PLUGIN,k.zV.APP,k.zV.LOCAL,...(null==I?void 0:I.entity_type)===C._J.SaasPlugin?[C._J.SaasPlugin]:[]],space_id:G.rY.getState().getSpaceId()});eU(!1);var g=null==x?void 0:null===(c=x.data)||void 0===c?void 0:null===(d=c.plugin_list)||void 0===d?void 0:null===(s=d[0])||void 0===s?void 0:null===(l=s.plugin_apis)||void 0===l?void 0:l.find(t=>(null==t?void 0:t.api_id)===(null==e?void 0:e.api_id));g&&Object.assign(g,(0,y._)({plugin_product_status:null==x?void 0:null===(f=x.data)||void 0===f?void 0:null===(v=f.plugin_list)||void 0===v?void 0:v[0].plugin_product_status},r)),n=g}}else n=Object.assign((0,y._)({},e),(0,y._)({plugin_product_status:eI},r));if(n){if($===u.jG.OnlyOnceAdd||X&&[p.WorkflowAddNode,p.ProjectIde,p.ProjectWorkflow].includes(X)){var b=yield null==et?void 0:et((0,y._)({},n,r));return(0,ec.Z)(b)?b:t}q([...T,n]),R.FN.success({content:m.o.t("bot_edit_tool_added_toast",{api_name:e.name}),showClose:!1})}else R.FN.error({content:(0,es.u)(m.o.t("bot_edit_tool_added_toast_error",{api_name:e.name})),showClose:!1}),t=!1}(0,H.Gg)(H.Kg.click_tool_select,{operation:"add",bot_id:eO,operation_type:"single",tool_id:(null==e?void 0:e.api_id)||"",tool_name:(null==e?void 0:e.name)||"",product_id:"".concat(null==I?void 0:I.id),product_name:(null==_?void 0:_.name)||"",source:"add_plugin_list",from:"bot_develop"})}return t}),showButton:w,loading:eV&&(null==e?void 0:e.api_id)===eB.current},(null!==(i=null===(n=e.plugin_id)||void 0===n?void 0:n.toString())&&void 0!==i?i:"")+(null!==(l=e.name)&&void 0!==l?l:""))})})}},620715:function(e,t,r){r.d(t,{s:()=>C});var n=r("151064"),o=r("455069"),i=r("346707"),l=r("344879"),a=r("550655"),s=r("252237"),d=r.n(s),c=r("775699"),u=r("599841"),p=r("837745"),m=r("139654");r("634405");var v=r("808549"),_=r("120454"),f=r("473980"),h=e=>{var{value:t,children:r,visible:i,tipFormatter:l=e=>"".concat(e)}=e,a=(0,f._)(e,["value","children","visible","tipFormatter"]),s=o.useRef(null),[d,u]=o.useState("1");function p(){s.current&&window.cancelAnimationFrame(s.current)}return o.useEffect(()=>(i?s.current=window.requestAnimationFrame(()=>{u(Math.random().toString())}):p(),p),[t,i]),(0,n.jsx)(c.u,(0,_._)((0,v._)({placement:"top",content:l(t),overlayInnerStyle:{minHeight:"auto"},rePosKey:d,visible:i},a),{children:r}))},x=(e,t)=>(0,n.jsx)(h,{value:t.value,visible:t.dragging,children:e}),g=r("72792"),y=e=>{var{value:t,onChange:r,max:o=1,min:i=0,step:l=1,disabled:a,marks:s,className:d}=e;return(0,n.jsx)("div",{className:g.Z["rc-slider-wrapper"],children:(0,n.jsx)(m.Z,{className:d,disabled:a,value:t,max:o,min:i,step:l,marks:s,handleRender:x,onChange:e=>{"number"==typeof e&&(null==r||r(e))}})})},b=r("238005"),j=(e,t,r)=>{if((0,i.Z)(r))return e.toString();var n=Number(e),o=e.toString();if(Number.isNaN(n))return"".concat(e);if(0===r&&!(0,l.Z)(Number(e))&&t)return"".concat(t);var a=o.indexOf(".");if(a<0)return o;var s=o.substring(0,a+1+r);return s.endsWith(".")&&0===r?s.substring(0,s.length-1):s},w=(e,t,r)=>{if((0,i.Z)(r))return e;if(0===r&&!(0,l.Z)(e)&&t)return t;var n=Math.pow(10,r);return Math.round(e*n)/n},C=(0,c.Q2)(e=>{var{value:t,onChange:r,max:o=1,min:i=0,step:l=1,disabled:s,decimalPlaces:m,marks:v,className:_,useRcSlider:f=!1}=e,h=e=>{var n=w(e,t,m);null==r||r(n)};return(0,n.jsxs)("div",{className:d()(b.Z["input-slider"],_),children:[f?(0,n.jsx)(y,{disabled:s,value:t,max:o,min:i,step:l,marks:v,onChange:e=>{"number"==typeof e&&(null==r||r(e))}}):(0,n.jsx)(c.iR,{className:b.Z.slider,disabled:s,value:t,max:o,min:i,step:l,marks:v,onChange:e=>{"number"==typeof e&&(null==r||r(e))}}),(0,n.jsxs)("div",{style:{position:"relative",marginLeft:24},children:[(0,n.jsx)(u.Z,{className:d()(b.Z["input-btn"],s&&b.Z["input-btn-disabled"]),onClick:e=>{if(e.stopPropagation(),!(0,a.Z)(t)||!(t<=i))!s&&void 0!==t&&h(t-l)}}),(0,n.jsx)(c.Rn,{className:b.Z["input-number"],value:t,disabled:s,formatter:e=>j(e,t),hideButtons:!0,onNumberChange:h,max:o,min:i}),(0,n.jsx)(p.Z,{className:d()(b.Z["input-btn"],s&&b.Z["input-btn-disabled"]),onClick:e=>{if(!(0,a.Z)(t)||!(t>=o))e.stopPropagation(),!s&&void 0!==t&&h(t+l)}})]})]})})},189284:function(e,t,r){r.d(t,{V:function(){return l}});var n=r(455069),o=r(864114),i=r(839974),l=()=>{var e=(0,i.L)(),[,t]=(0,n.useState)(0);return(0,n.useEffect)(()=>{var e=()=>{t(Date.now())};return o.l.on("change",e),()=>{o.l.off("change",e)}},[]),[e]}},966219:function(e,t,r){r.r(t),r.d(t,{DiffEditor:()=>p,Editor:()=>u});var n=r("825955"),o=r("808549"),i=r("151064"),l=r("455069"),a={init(){return(0,n._)(function*(){return(yield this.config()).init()}).apply(this)},config(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n._)(function*(){var t=yield Promise.all([r.e("4783"),r.e("6961"),r.e("7079")]).then(r.bind(r,66557)),{loader:n}=yield r.e("38").then(r.bind(r,354428));return n.config((0,o._)({monaco:t},e)),n})()}},s=(0,l.lazy)((0,n._)(function*(){yield a.config();var{Editor:e}=yield r.e("3617").then(r.bind(r,257073));return{default:e}})),d=(0,l.lazy)((0,n._)(function*(){yield a.config();var{DiffEditor:e}=yield r.e("3617").then(r.bind(r,257073));return{default:e}})),c=(0,i.jsx)("div",{children:"Loading Editor..."}),u=e=>(0,i.jsx)(l.Suspense,{fallback:c,children:(0,i.jsx)(s,(0,o._)({},e))}),p=e=>(0,i.jsx)(l.Suspense,{fallback:c,children:(0,i.jsx)(d,(0,o._)({},e))})},749615:function(e,t,r){var n=r(455069);t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{onEnter:o,onLeave:i}=t,l=(0,n.useRef)(),[a,s]=(0,n.useState)(!1),d=(0,n.useCallback)(()=>{o&&o(),s(!0)},["function"==typeof o]),c=(0,n.useCallback)(()=>{i&&i(),s(!1)},["function"==typeof i]);return(0,n.useLayoutEffect)(()=>{var t=l.current;if(e&&(t="function"==typeof e?e():e),!!t)return t.addEventListener("mouseenter",d),t.addEventListener("mouseleave",c),()=>{null==t||t.removeEventListener("mouseenter",d),null==t||t.removeEventListener("mouseleave",c)}},[l.current,"function"==typeof e?void 0:e,...r]),[l,a]}},9734:function(e,t,r){var n=r(455069);t.Z=function(e){var t=(0,n.useRef)();return t.current=(0,n.useMemo)(()=>e,[e]),(0,n.useCallback)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=t.current;return o&&o(...r)},[t])}},969942:function(e,t,r){var n=r(808549),o=r(455069);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,[r,i]=(0,o.useState)(e),l=(0,o.useMemo)(()=>{var r=void 0===t?!e:t;return{toggle:t=>{if(void 0!==t){i(t);return}i(t=>t===e?r:e)}}},[e,t]);return(0,n._)({state:r},l)}},34817:function(e,t,r){var n=r(455069);t.Z=(e,t)=>{var r=(0,n.useRef)(!1);(0,n.useEffect)(()=>r.current?e():(r.current=!0,()=>{}),t)}},622103:function(e,t,r){r.d(t,{Nh:function(){return i},aZ:function(){return l}});var n,o,i=((n={})[n.Bot=0]="Bot",n[n.Project=1]="Project",n);var l=((o={})[o.Free=0]="Free",o[o.PremiumLite=10]="PremiumLite",o[o.Premium=15]="Premium",o[o.PremiumPlus=20]="PremiumPlus",o[o.V1ProInstance=100]="V1ProInstance",o[o.ProPersonal=110]="ProPersonal",o[o.Team=120]="Team",o[o.Enterprise=130]="Enterprise",o)},824833:function(e,t,r){r.d(t,{d$:function(){return a},re:function(){return l},zE:function(){return s}});var n,o,i,l=((n={})[n.Undefined=0]="Undefined",n[n.CozePlugin=1e4]="CozePlugin",n[n.CozeTool=10001]="CozeTool",n[n.CozeWorkflow=10002]="CozeWorkflow",n[n.CozeSubWorkflow=10003]="CozeSubWorkflow",n[n.CozeLLMNode=10004]="CozeLLMNode",n[n.CozeCodeNode=10005]="CozeCodeNode",n[n.CozeKnowledgeNode=10006]="CozeKnowledgeNode",n[n.CozeToolNode=10007]="CozeToolNode",n[n.CozeStartNode=10008]="CozeStartNode",n[n.CozeVariableNode=10009]="CozeVariableNode",n[n.CozeVariableBot=2e4]="CozeVariableBot",n[n.CozeVariableChat=20001]="CozeVariableChat",n);var a=((o={})[o.UpdateTime=1]="UpdateTime",o);var s=((i={})[i.Undefined=0]="Undefined",i[i.CozeSingleAgentDebug=1e4]="CozeSingleAgentDebug",i[i.CozeMultiAgentDebug=10001]="CozeMultiAgentDebug",i[i.CozeToolDebug=10002]="CozeToolDebug",i[i.CozeWorkflowDebug=10003]="CozeWorkflowDebug",i)},861080:function(e,t,r){r.d(t,{s7:function(){return o}});var n,o=((n={})[n.Default=0]="Default",n[n.Listed=1]="Listed",n[n.Unlisted=2]="Unlisted",n[n.Reviewing=3]="Reviewing",n)},880623:function(e,t,r){r.d(t,{U7:function(){return o}});var n,o=((n={})[n.ByAdmin=1]="ByAdmin",n[n.ByUser=2]="ByUser",n)},757208:function(e,t,r){r.d(t,{OL:function(){return o}});var n,o=((n={})[n.PendingVectoring=0]="PendingVectoring",n[n.FinishVectoring=1]="FinishVectoring",n[n.Deactive=9]="Deactive",n[n.AuditFailed=1e3]="AuditFailed",n)},602876:function(e,t,r){r.d(t,{wp:function(){return o}});var n,o=((n={})[n.Text=1]="Text",n[n.Number=2]="Number",n[n.Date=3]="Date",n[n.Float=4]="Float",n[n.Boolean=5]="Boolean",n)},672958:function(e,t,r){r.d(t,{n:function(){return o}});var n,o=((n={})[n.AllData=0]="AllData",n[n.OnlySchema=1]="OnlySchema",n[n.OnlyPreview=2]="OnlyPreview",n)},666781:function(e,t,r){r.d(t,{Qi:function(){return l},U4:function(){return a},x9:function(){return s}});var n,o,i,l=((n={})[n.Custom=1]="Custom",n[n.System=2]="System",n[n.Location=3]="Location",n[n.Feishu=4]="Feishu",n[n.APP=5]="APP",n);var a=((o={})[o.Bot=1]="Bot",o[o.Project=2]="Project",o);var s=((i={})[i.KVVariable=1]="KVVariable",i[i.ListVariable=2]="ListVariable",i)},909776:function(e,t,r){r.d(t,{K2:function(){return c},Lk:function(){return s},ai:function(){return d},b0:function(){return u},hY:function(){return p}});var n,o,i,l,a,s=((n={})[n.Rename=1]="Rename",n[n.Copy=2]="Copy",n[n.CopyToLibrary=3]="CopyToLibrary",n[n.MoveToLibrary=4]="MoveToLibrary",n[n.Delete=5]="Delete",n[n.Enable=6]="Enable",n[n.Disable=7]="Disable",n[n.SwitchToFuncflow=8]="SwitchToFuncflow",n[n.SwitchToChatflow=9]="SwitchToChatflow",n[n.UpdateDesc=10]="UpdateDesc",n);var d=((o={})[o.Workflow=1]="Workflow",o[o.Plugin=2]="Plugin",o[o.Data=3]="Data",o);var c=((i={})[i.CopyProjectResource=1]="CopyProjectResource",i[i.CopyResourceToLibrary=2]="CopyResourceToLibrary",i[i.MoveResourceToLibrary=3]="MoveResourceToLibrary",i[i.CopyResourceFromLibrary=4]="CopyResourceFromLibrary",i[i.CopyProject=5]="CopyProject",i[i.PublishProject=6]="PublishProject",i[i.CopyProjectTemplate=7]="CopyProjectTemplate",i[i.PublishProjectTemplate=8]="PublishProjectTemplate",i[i.LaunchTemplate=9]="LaunchTemplate",i[i.ArchiveProject=10]="ArchiveProject",i[i.RollbackProject=11]="RollbackProject",i[i.CrossSpaceCopy=12]="CrossSpaceCopy",i[i.CrossSpaceCopyProject=13]="CrossSpaceCopyProject",i);var u=((l={})[l.Plugin=1]="Plugin",l[l.Workflow=2]="Workflow",l[l.Imageflow=3]="Imageflow",l[l.Knowledge=4]="Knowledge",l[l.UI=5]="UI",l[l.Prompt=6]="Prompt",l[l.Database=7]="Database",l[l.Variable=8]="Variable",l[l.Voice=9]="Voice",l);var p=((a={})[a.Successed=1]="Successed",a[a.Processing=2]="Processing",a[a.Failed=3]="Failed",a[a.Canceled=4]="Canceled",a)},458949:function(e,t,r){r.d(t,{K9:function(){return k},Mv:function(){return N},OZ:function(){return A},Pi:function(){return L},Pt:function(){return R},Yz:function(){return D},ZZ:function(){return M},fM:function(){return C},gR:function(){return B},ji:function(){return E},nw:function(){return I},qJ:function(){return P},qi:function(){return T},rH:function(){return O},vF:function(){return F},vw:function(){return w},wA:function(){return V},wL:function(){return Z},x9:function(){return S},zV:function(){return z}});var n,o,i,l,a,s,d,c,u,p,m,v,_,f,h,x,g,y,b,j,w=((n={})[n.DebugWaiting=0]="DebugWaiting",n[n.DebugPassed=1]="DebugPassed",n);var C=((o={})[o.GET=1]="GET",o[o.POST=2]="POST",o[o.PUT=3]="PUT",o[o.DELETE=4]="DELETE",o[o.PATCH=5]="PATCH",o);var k=((i={})[i.DEFAULT=1]="DEFAULT",i[i.IMAGE=2]="IMAGE",i[i.DOC=3]="DOC",i[i.CODE=4]="CODE",i[i.PPT=5]="PPT",i[i.TXT=6]="TXT",i[i.EXCEL=7]="EXCEL",i[i.AUDIO=8]="AUDIO",i[i.ZIP=9]="ZIP",i[i.VIDEO=10]="VIDEO",i[i.VOICE=12]="VOICE",i);var N=((l={})[l.None=0]="None",l[l.Service=1]="Service",l[l.OAuth=3]="OAuth",l);var S=((a={})[a.COZE=0]="COZE",a[a.IDE=1]="IDE",a);var E=((s={})[s.Default=0]="Default",s[s.Enable=1]="Enable",s[s.Disable=2]="Disable",s);var T=((d={})[d.Input=0]="Input",d[d.Variable=1]="Variable",d);var I=((c={})[c.Unknown=0]="Unknown",c[c.NotFoundPlugin=1]="NotFoundPlugin",c[c.OfficialPlugin=2]="OfficialPlugin",c);var P=((u={})[u.TokenExchange=1]="TokenExchange",u[u.ClientCredential=2]="ClientCredential",u);var A=((p={})[p.Authorized=1]="Authorized",p[p.Unauthorized=2]="Unauthorized",p);var D=((m={})[m.OFFLINE=0]="OFFLINE",m[m.ONLINE=1]="ONLINE",m);var L=((v={})[v.Path=1]="Path",v[v.Query=2]="Query",v[v.Body=3]="Body",v[v.Header=4]="Header",v);var O=((_={})[_.String=1]="String",_[_.Integer=2]="Integer",_[_.Number=3]="Number",_[_.Object=4]="Object",_[_.Array=5]="Array",_[_.Bool=6]="Bool",_);var Z=((f={})[f.OpenAPI=1]="OpenAPI",f[f.Curl=2]="Curl",f[f.Postman=3]="Postman",f[f.Swagger=4]="Swagger",f);var F=((h={})[h.Draft=0]="Draft",h[h.SUBMITTED=1]="SUBMITTED",h[h.REVIEWING=2]="REVIEWING",h[h.PREPARED=3]="PREPARED",h[h.PUBLISHED=4]="PUBLISHED",h[h.OFFLINE=5]="OFFLINE",h[h.BANNED=6]="BANNED",h);var M=((x={})[x.Required=0]="Required",x[x.Supported=1]="Supported",x[x.Disable=2]="Disable",x);var z=((g={})[g.PLUGIN=1]="PLUGIN",g[g.APP=2]="APP",g[g.FUNC=3]="FUNC",g[g.WORKFLOW=4]="WORKFLOW",g[g.IMAGEFLOW=5]="IMAGEFLOW",g[g.LOCAL=6]="LOCAL",g);var R=((y={})[y.NeverListed=0]="NeverListed",y[y.Listed=1]="Listed",y[y.Unlisted=2]="Unlisted",y[y.Banned=3]="Banned",y);var B=((b={})[b.Curl=1]="Curl",b[b.Wget=2]="Wget",b[b.NodeJS=3]="NodeJS",b[b.Python=4]="Python",b[b.Golang=5]="Golang",b);var V=((j={})[j.Default=0]="Default",j[j.Owner=1]="Owner",j[j.Admin=2]="Admin",j[j.Member=3]="Member",j)},529223:function(e,t,r){r.r(t),r.d(t,{ActionKey:function(){return p},CopyStatus:function(){return m},ProjectResourceActionKey:function(){return v},ProjectResourceGroupType:function(){return _},PublishStatus:function(){return f},ResType:function(){return x},ResourceCopyScene:function(){return h},SyncOperation:function(){return g},TaskStatus:function(){return y}});var n,o,i,l,a,s,d,c,u,p=((n={})[n.Copy=1]="Copy",n[n.Delete=2]="Delete",n[n.EnableSwitch=3]="EnableSwitch",n[n.Edit=4]="Edit",n[n.SwitchToFuncflow=8]="SwitchToFuncflow",n[n.SwitchToChatflow=9]="SwitchToChatflow",n[n.CrossSpaceCopy=10]="CrossSpaceCopy",n);var m=((o={})[o.Successful=1]="Successful",o[o.Processing=2]="Processing",o[o.Failed=3]="Failed",o[o.KeepOrigin=4]="KeepOrigin",o[o.Deleted=5]="Deleted",o);var v=((i={})[i.Rename=1]="Rename",i[i.Copy=2]="Copy",i[i.CopyToLibrary=3]="CopyToLibrary",i[i.MoveToLibrary=4]="MoveToLibrary",i[i.Delete=5]="Delete",i[i.Enable=6]="Enable",i[i.Disable=7]="Disable",i[i.SwitchToFuncflow=8]="SwitchToFuncflow",i[i.SwitchToChatflow=9]="SwitchToChatflow",i[i.UpdateDesc=10]="UpdateDesc",i);var _=((l={})[l.Workflow=1]="Workflow",l[l.Plugin=2]="Plugin",l[l.Data=3]="Data",l);var f=((a={})[a.UnPublished=1]="UnPublished",a[a.Published=2]="Published",a);var h=((s={})[s.CopyProjectResource=1]="CopyProjectResource",s[s.CopyResourceToLibrary=2]="CopyResourceToLibrary",s[s.MoveResourceToLibrary=3]="MoveResourceToLibrary",s[s.CopyResourceFromLibrary=4]="CopyResourceFromLibrary",s[s.CopyProject=5]="CopyProject",s[s.PublishProject=6]="PublishProject",s[s.CopyProjectTemplate=7]="CopyProjectTemplate",s[s.PublishProjectTemplate=8]="PublishProjectTemplate",s[s.LaunchTemplate=9]="LaunchTemplate",s[s.ArchiveProject=10]="ArchiveProject",s[s.RollbackProject=11]="RollbackProject",s[s.CrossSpaceCopy=12]="CrossSpaceCopy",s[s.CrossSpaceCopyProject=13]="CrossSpaceCopyProject",s);var x=((d={})[d.Plugin=1]="Plugin",d[d.Workflow=2]="Workflow",d[d.Imageflow=3]="Imageflow",d[d.Knowledge=4]="Knowledge",d[d.UI=5]="UI",d[d.Prompt=6]="Prompt",d[d.Database=7]="Database",d[d.Variable=8]="Variable",d[d.Voice=9]="Voice",d);var g=((c={})[c.Upsert=1]="Upsert",c[c.Delete=2]="Delete",c);var y=((u={})[u.Successed=1]="Successed",u[u.Processing=2]="Processing",u[u.Failed=3]="Failed",u[u.Canceled=4]="Canceled",u)},902272:function(e,t,r){r.d(t,{GD:function(){return o}});var n,o=((n={})[n.Host=1]="Host",n[n.PresetBot=2]="PresetBot",n[n.Custom=3]="Custom",n)},609214:function(e,t,r){r.d(t,{pN:function(){return o}});var n,o=((n={})[n.Unknown=0]="Unknown",n[n.Success=1]="Success",n[n.Fail=2]="Fail",n)},454221:function(e,t,r){r.d(t,{O:function(){return o}});var n,o=((n={})[n.Disable=0]="Disable",n[n.System=1]="System",n[n.Custom=2]="Custom",n)},487377:function(e,t,r){r.d(t,{a:function(){return i}});var n=r(455069),o=r(579367),i=e=>{var{isLive:t,extra:r,scene:i=o.ik}=e;(0,n.useEffect)(()=>{t&&(0,o.WQ)(r,i)},[t])}},579367:function(e,t,r){r.d(t,{WQ:function(){return d},ik:function(){return s}});var n=r(808549),o=r(120454),i=r(297158),l="first-contentful-paint",a={name:"",reportScene:[]},s="init",d=(e,t)=>{var r=null!=t?t:s,d=performance.now(),p=performance.getEntriesByName("route_change"),m=p.at(-1);if(!((null==m?void 0:null===(f=m.detail)||void 0===f?void 0:null===(_=f.location)||void 0===_?void 0:_.pathname)&&m.detail.location.pathname===a.name&&a.reportScene.includes(r))){if("hidden"===document.visibilityState){i.E7.info({message:"page_hidden_on_tti_report",namespace:"performance"});return}if(a.name=null==m?void 0:null===(x=m.detail)||void 0===x?void 0:null===(h=x.location)||void 0===h?void 0:h.pathname,a.reportScene.push(r),p.length>1){u(d-(null!==(g=null==m?void 0:m.startTime)&&void 0!==g?g:0),e);return}var v=performance.getEntriesByName(l)[0];if(v)c(d>v.startTime?d:v.startTime,(0,o._)((0,n._)({},e),{fcpTime:"".concat(v.startTime)}));else if(window.PerformanceObserver){var _,f,h,x,g,y,b=new PerformanceObserver(t=>{var r=t.getEntriesByName(l)[0];r&&(c(r.startTime,(0,o._)((0,n._)({},e),{fcpTime:"".concat(r.startTime)})),b.disconnect())});try{b.observe({type:"paint",buffered:!0})}catch(e){if(null===(y=PerformanceObserver.supportedEntryTypes)||void 0===y?void 0:y.includes("paint"))try{b.observe({entryTypes:["paint"]})}catch(e){i.E7.info({message:e.message,namespace:"performance"})}i.E7.info({message:e.message,namespace:"performance"})}}}},c=(e,t)=>{var r;null===(r=(0,i.f5)())||void 0===r||r("sendCustomPerfMetric",{value:e,name:"coze_custom_tti",type:"perf",extra:(0,n._)({},t)}),i.kg.info({message:"coze_custom_tti",meta:{value:e,extra:t}})},u=(e,t)=>{var r;null===(r=(0,i.f5)())||void 0===r||r("sendCustomPerfMetric",{value:e,name:"coze_custom_tti_hot",type:"perf",extra:(0,n._)({},t)}),i.kg.info({message:"coze_custom_tti_hot",meta:{value:e,extra:t}})}},220607:function(e,t,r){r.d(t,{l:function(){return n}});var n=(0,r(455069).createContext)({controller:{hideActionBar:()=>{},rePosition:()=>{}},size:"small"})},818188:function(e,t,r){r.d(t,{Y:function(){return i}});var n=r(455069),o=r(220607),i=()=>{var{size:e,controller:t}=(0,n.useContext)(o.l);return{size:e,controller:t}}},936381:function(e,t,r){r.d(t,{ol:()=>v});var n=r("151064"),o=r("455069"),i=r("252237"),l=r.n(i),a=r("887874"),s=r("919658"),d=r("674343"),c=r("249294"),u=r("925623"),p=r("358477"),m=r("220607"),v=e=>{var{className:t,size:r="small",children:i,visible:v,onVisibleChange:_,trigger:f="selection"}=e,[h,x]=(0,o.useState)(!1),[g,y]=(0,o.useState)(""),[b,j]=(0,o.useState)(-1),w=(0,o.useRef)(null),C=(0,p.j)(),[k,N]=(0,o.useState)({from:0,to:0,anchor:0,head:0}),S=(0,a.jE)(),E=(0,a.G6)(),[T,I]=(0,o.useState)();return((0,o.useEffect)(()=>{I((null==k?void 0:k.head)>(null==k?void 0:k.anchor)?"bottomRight":"topLeft")},[k]),(0,o.useLayoutEffect)(()=>E.inject([(0,c.Uw)()]),[E]),(0,o.useEffect)(()=>{if(!!S)return S.$on("mousedown",e),document.addEventListener("mouseup",t),S.$on("selectionChange",r),()=>{S.$off("mousedown",e),document.removeEventListener("mouseup",t),S.$off("selectionChange",r)};function e(){null==_||_(!1),x(!1),j(-1)}function t(e){if(null===(t=w.current)||void 0===t?!void 0:!t.contains(e.target)){var t,r=S.getSelection();if(N(r),!r){null==_||_(!1),j(-1),x(!1);return}var n=r.from!==r.to;N(r),null==_||_(n),x(n),j(r.head)}}function r(){null==_||_(!1),j(-1),x(!1)}},[S]),C)?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.J2,{rePosKey:g,visible:"custom"===f?v:h,trigger:"custom",position:T,autoAdjustOverflow:!0,className:"rounded",content:(0,n.jsx)(m.l.Provider,{value:{controller:{hideActionBar:()=>{null==_||_(!1),x(!1)},rePosition:e=>{y(String(Math.random())),e&&I(e)}},size:r},children:(0,n.jsx)("div",{className:l()("flex gap-1",t),ref:w,children:i})}),children:(0,n.jsx)(s.Iq,{position:b,onChange:()=>y(String(Math.random()))})}),(0,n.jsx)(u.G,{themes:[c.tk.theme({".cm-selectionBackground":{backgroundColor:"rgba(148, 152, 247, 0.44)"}})]})]})};r("818188")},99285:function(e,t,r){r.d(t,{_i:()=>c._,aS:()=>m});var n=r("151064"),o=r("252237"),i=r.n(o),l=r("887874"),a=r("336205"),s=r("915757"),d=r("674343"),c=r("446091"),u=r("944881"),p=r("818188"),m=e=>{var t=(0,l.jE)(),{className:r}=e,{controller:o,size:m}=(0,p.Y)(),v=(0,u.tQ)(),_=(0,u.eJ)();return v||_?null:(0,n.jsx)("div",{className:i()("hover:coz-mg-secondary-hovered coz-icon-button rounded-little"),children:(0,n.jsx)(d.u,{content:a.o.t("edit_block_set_as_edit_block"),position:"bottom",children:(0,n.jsx)(d.hU,{color:"primary",icon:(0,n.jsx)(s.Ga9,{}),className:i()("!bg-transparent",r),size:m,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:e=>{if(e.preventDefault(),e.stopPropagation(),null==o||o.hideActionBar(),!!t)(0,c._)(t)}})})})}},118881:function(e,t,r){r.d(t,{XJ:function(){return l},Y:function(){return i}});var n,o,i=((n={}).Start="{",n.End="}",n.FullStart="{{",n.FullEnd="}}",n.Separator=".",n.ArrayStart="[",n.ArrayEnd="]",n);var l=((o={}).ObjectKey="object_key",o.ArrayIndex="array_index",o.EndEmpty="end_empty",o)},973432:function(e,t,r){r.d(t,{XJ:()=>l.XJ,qz:()=>i});var n,o,i,l=r("118881");var a=((n={})[n.String=1]="String",n[n.Integer=2]="Integer",n[n.Boolean=3]="Boolean",n[n.Number=4]="Number",n[n.Object=6]="Object",n[n.Image=7]="Image",n[n.File=8]="File",n[n.Doc=9]="Doc",n[n.Code=10]="Code",n[n.Ppt=11]="Ppt",n[n.Txt=12]="Txt",n[n.Excel=13]="Excel",n[n.Audio=14]="Audio",n[n.Zip=15]="Zip",n[n.Video=16]="Video",n[n.Svg=17]="Svg",n[n.Voice=18]="Voice",n[n.Time=19]="Time",n[n.ArrayString=99]="ArrayString",n[n.ArrayInteger=100]="ArrayInteger",n[n.ArrayBoolean=101]="ArrayBoolean",n[n.ArrayNumber=102]="ArrayNumber",n[n.ArrayObject=103]="ArrayObject",n[n.ArrayImage=104]="ArrayImage",n[n.ArrayFile=105]="ArrayFile",n[n.ArrayDoc=106]="ArrayDoc",n[n.ArrayCode=107]="ArrayCode",n[n.ArrayPpt=108]="ArrayPpt",n[n.ArrayTxt=109]="ArrayTxt",n[n.ArrayExcel=110]="ArrayExcel",n[n.ArrayAudio=111]="ArrayAudio",n[n.ArrayZip=112]="ArrayZip",n[n.ArrayVideo=113]="ArrayVideo",n[n.ArraySvg=114]="ArraySvg",n[n.ArrayVoice=115]="ArrayVoice",n[n.ArrayTime=116]="ArrayTime",n),s=[[1,99],[2,100],[3,101],[4,102],[6,103],[7,104],[8,105],[9,106],[10,107],[11,108],[12,109],[13,110],[14,111],[15,112],[16,113],[17,114],[18,115],[19,116]].map(e=>e[1]);function d(e){return s.includes(e)}r("397060"),(o=i||(i={})).pruning=e=>{var{tree:t,segments:r}=e;if(0===r.length)return t;var n=r[r.length-1].type===l.XJ.ArrayIndex?r.slice(0,r.length-2):r.slice(0,r.length-1),o=t;return n.forEach(e=>{if(e.type===l.XJ.ObjectKey){var t=o.filter(t=>t.label===e.objectKey);o=(null==t?void 0:t.length)?t.reduce((e,t)=>{var r;return(null===(r=t.children)||void 0===r?void 0:r.length)?[...e,...t.children]:e},[]):[]}}),o},o.concatFullPath=e=>{for(var t,{node:r,segments:n}=e,o=r,i=[];o;)(null===(t=o.variable)||void 0===t?void 0:t.type)===a.ArrayObject?i.unshift({objectKey:o.label,arrayIndex:0}):i.unshift({objectKey:o.label}),o=o.parent;var s=0;return n.find((e,t)=>{if(e.type!==l.XJ.ObjectKey)return!1;var r=i[s];if(s++,r.objectKey!==e.objectKey)return!0;var o=n[t+1];return"number"==typeof r.arrayIndex&&(null==o?void 0:o.type)===l.XJ.ArrayIndex&&(r.arrayIndex=o.arrayIndex),!1}),i.map((e,t)=>{var r=t===i.length-1;return"number"!=typeof e.arrayIndex||r?e.objectKey:"".concat(e.objectKey,"[").concat(e.arrayIndex,"]")}).join(".")},o.matchTreeBranch=e=>{var{tree:t,segments:r}=e,n=[],o=t,i=r.find((e,t)=>{var r,i=()=>(n.push(null),!0),a=e=>(n.push(e||null),!1),s=n[n.length-1];if(e.type===l.XJ.ArrayIndex&&s&&(!s.variable||!d(s.variable.type))||(null==s?void 0:null===(r=s.variable)||void 0===r?void 0:r.type)&&d(s.variable.type)&&e.type!==l.XJ.ArrayIndex)return i();if(e.type!==l.XJ.ObjectKey)return a();var c=o.find(t=>t.label===e.objectKey);return c?(o=c.children||[],a(c)):i()}),a=n.filter(Boolean),s=r.filter(e=>e.type===l.XJ.ObjectKey);if(!i&&s.length===a.length)return a}},397060:function(e,t,r){r.d(t,{N:function(){return o}});var n,o,i,l=r(808549),a=r(118881);(n=o||(o={})).tokenOffset=e=>{var{lineContent:t,lineOffset:r}=e,n=t.indexOf(a.Y.End,r);if(t.slice(n,n+2)!==a.Y.FullEnd)return;var o=t.lastIndexOf(a.Y.Start,r-1);if(t.slice(o-1,o+1)===a.Y.FullStart)return{lastStartTokenOffset:o,firstEndTokenOffset:n}},n.extractContent=e=>{var{lineContent:t,lineOffset:r,lastStartTokenOffset:n,firstEndTokenOffset:o}=e,i=t.slice(n+1,o);return{content:i,offset:r-n-1}},n.sliceReachable=e=>{var{content:t,offset:r}=e,n=t.slice(0,r);return{reachable:n,unreachable:t.slice(r,t.length)}},n.splitText=e=>{var t=e.split(a.Y.Separator),r=[];return t.forEach(e=>{if(!e.match(/\[\d+\]/)){r.push(e);return}var t=e.lastIndexOf(a.Y.ArrayStart),n=e.substring(0,t),o=e.substring(t);r.push(n),r.push(o)}),r},n.toSegments=e=>{var t=n.splitText(e),r=[];if(!!t.every((e,n)=>{if(e.startsWith(a.Y.ArrayStart)&&e.endsWith(a.Y.ArrayEnd)){var o=e.slice(1,-1),i=Number(o);if(""===o||Number.isNaN(i))return!1;var l=r[r.length-1];if(!l||l.type!==a.XJ.ObjectKey)return!1;r.push({type:a.XJ.ArrayIndex,index:n,arrayIndex:i})}else if(n===t.length-1&&""===e)r.push({type:a.XJ.EndEmpty,index:n});else{if(!e||!/^[\u4e00-\u9fa5_a-zA-Z0-9]*$/.test(e))return!1;r.push({type:a.XJ.ObjectKey,index:n,objectKey:e})}return!0}))return r},(i||(i={})).parse=e=>{var{lineContent:t,lineOffset:r}=e,n=o.tokenOffset(e);if(!n)return;var{lastStartTokenOffset:i,firstEndTokenOffset:a}=n,s=o.extractContent((0,l._)({},e,n));if(!s)return;var{content:d,offset:c}=s,u=o.sliceReachable(s);if(!u)return;var p=o.toSegments(u.reachable),m=o.toSegments(d);if(!!p)return{content:{line:t,inline:d,reachable:u.reachable,unreachable:u.unreachable},offset:{line:r,inline:c,lastStart:i,firstEnd:a},segments:{inline:m,reachable:p}}}},310904:function(e,t,r){r.d(t,{Af:()=>j,iA:()=>b,ID:()=>_});var n=r("151064"),o=r("455069"),i=r("252237"),l=r.n(i),a=r("887874"),s=r("919658"),d=r("642199"),c=r("775699"),u=r("585558"),p=r("40842"),m=r("726154"),v=r("116611");function _(e){var{getPopupContainer:t,variableTree:r,className:i,onVisibilityChange:l,customApplyNode:_,disableUpdateTrigger:x,disabled:g=!1,customInterpolationRule:y}=e,b=(0,u.I7)(r),j=(0,o.useRef)(null),w=(0,o.useRef)(null),C=(0,u.dU)(l),[k,N]=(0,o.useState)(""),S=(0,a.jE)(),E=(0,u.dU)(S),T=(0,m.cH)(S),I=(0,m.UE)(S),P=(0,m.L9)(S,null==T?void 0:T.anchor),A=(0,o.useMemo)(()=>{if(!y||(null==y?void 0:y(null==P?void 0:P.text,null==P?void 0:P.textBefore)))return P},[P,y]),D=(0,m.Fr)(x),L=null!=A?A:D,O=(0,m.$W)(S,b,L),Z=(0,m.SJ)(L,O),F=(0,m.OM)(b,O,L),M=(0,m._E)(Z);(0,m.rz)(M,j,L,()=>{var e=(0,p.zA)(w.current);if(!!e){var{elements:t}=e;(0,p.Er)(t,0)}});var z=(0,m.TW)(null==L?void 0:L.text,b),R=(0,o.useCallback)((e,t,r)=>{if(!!S&&!!L){if(_){_(r,L,S);return}(0,p.m2)(S,r,L)}},[S,L]),B=I&&(!!L&&Z.length>0||!!F),[V,U]=(0,o.useState)(!1);(0,o.useEffect)(()=>{U(!0)},[T]);var H=B&&V&&!g,{prev:W,next:G,apply:K}=(0,m.mm)(S,L,w,j);return(0,m.v5)(H,{ArrowUp:W,ArrowDown:G,Enter:K}),(0,m.v5)(H,{Escape(){U(!1)}}),(0,o.useEffect)(()=>{var e,t;!0===H?null===(e=E.current)||void 0===e||e.disableKeybindings(["ArrowUp","ArrowDown","Enter"]):null===(t=E.current)||void 0===t||t.disableKeybindings([])},[H]),(0,o.useEffect)(()=>{"function"==typeof C.current&&C.current(H)},[H]),(0,n.jsx)(c.J2,{trigger:"custom",visible:H,keepDOM:!0,rePosKey:k,getPopupContainer:t,content:(0,n.jsxs)("div",{onMouseDown:e=>e.preventDefault(),style:{display:H?"block":"none"},children:[(0,n.jsx)(f,{visible:!!F,content:F}),(0,n.jsx)(h,{ref:w,visible:!F,className:i,children:(0,n.jsx)(c.mp,{className:v.Z["expression-editor-suggestion-tree"],showFilteredOnly:!0,filterTreeNode:!0,onChangeWithObject:!0,ref:j,treeData:O,searchRender:!1,value:z,emptyContent:null,onSelect:R})})]}),children:(0,n.jsx)(s.Vj,{side:d.m6.Anchor,onChange:()=>N((0,u.lY)())})})}function f(e){var{visible:t,content:r}=e;return(0,n.jsx)("div",{className:v.Z["expression-editor-suggestion-empty"],style:{display:t?"block":"none"},children:(0,n.jsx)("p",{children:r})})}var h=(0,o.forwardRef)(function(e,t){var{visible:r,className:o,children:i}=e;return(0,n.jsx)("div",{className:l()(o,v.Z["expression-editor-suggestion"]),style:{display:r?"block":"none"},ref:t,children:i})}),x=r("249294"),g=r("397060"),y=r("973432");function b(e){var{variableTree:t}=e,r=(0,a.jE)(),n=(0,u.dU)(r),i=(0,a.G6)(),l=(0,u.dU)(t),s=(0,u.I7)(t);return(0,o.useEffect)(()=>{if(!!r)return r.$on("focus",e),()=>{r.$off("focus",e)};function e(){r.updateWholeDecorations()}},[r]),(0,o.useEffect)(()=>{if(!!n.current)n.current.updateWholeDecorations()},[s]),(0,o.useLayoutEffect)(()=>i.inject([[d.Cj.whole.of((e,t)=>{var r,n,o,i,a;if(!!l.current){if("JinjaExpression"===e.name&&(null===(r=e.node.firstChild)||void 0===r?void 0:r.name)==="JinjaExpressionStart"&&(null===(n=e.node.lastChild)||void 0===n?void 0:n.name)==="JinjaExpressionEnd"){;return(o=t.sliceDoc(e.node.firstChild.to,e.node.lastChild.from),i=l.current,(a=g.N.toSegments(o))&&a[a.length-1].type!==y.XJ.EndEmpty&&y.qz.matchTreeBranch({tree:i,segments:a}))?{type:"className",className:"cm-decoration-interpolation-valid"}:{type:"className",className:"cm-decoration-interpolation-invalid"}}}}),x.tk.theme({".cm-decoration-interpolation-valid":{color:"#6675D9",caretColor:"#6675D9"},".cm-decoration-interpolation-invalid":{color:"#060709CC"}})]])),null}function j(){var e=(0,a.G6)();return(0,o.useLayoutEffect)(()=>e.inject([[d.Cj.fromCursor.of((e,t)=>{var r,n,{anchor:o}=t.selection.main;if("JinjaExpression"===e.name&&(null===(r=e.node.firstChild)||void 0===r?void 0:r.name)==="JinjaExpressionStart"&&(null===(n=e.node.lastChild)||void 0===n?void 0:n.name)==="JinjaExpressionEnd"&&o>=e.node.firstChild.to&&o<=e.node.lastChild.from&&"}}"===t.sliceDoc(e.node.lastChild.from,e.node.lastChild.to))return{type:"background",className:"cm-decoration-interpolation-active",from:e.node.firstChild.from,to:e.node.lastChild.to}}),x.tk.theme({".cm-decoration-interpolation-active":{borderRadius:"2px",backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"}})]])),null}},726154:function(e,t,r){r.d(t,{OM:()=>x,SJ:()=>b,UE:()=>j,mm:()=>S,_E:()=>w,v5:()=>k,TW:()=>E,Fr:()=>m,$W:()=>g,cH:()=>N,L9:()=>i,rz:()=>C});var n=r("455069"),o=r("562312");function i(e,t){return(0,n.useMemo)(()=>{if(!!e&&void 0!==t)return function(e,t){var r,n,i=(0,o.qz)(e.state).cursorAt(t);do if("JinjaExpression"===i.node.type.name&&(null===(r=i.node.firstChild)||void 0===r?void 0:r.name)==="JinjaExpressionStart"&&(null===(n=i.node.lastChild)||void 0===n?void 0:n.name)==="JinjaExpressionEnd"&&t>=i.node.firstChild.to&&t<=i.node.lastChild.from&&"}}"===e.state.sliceDoc(i.node.lastChild.from,i.node.lastChild.to)||"Interpolation"===i.node.type.name&&i.node.firstChild&&i.node.lastChild&&t>=i.node.firstChild.to&&t<=i.node.lastChild.from){var l=e.state.sliceDoc(i.node.firstChild.to,i.node.lastChild.from),a=t-i.node.firstChild.to;return{from:i.node.firstChild.to,to:i.node.lastChild.from,text:l,offset:a,textBefore:l.slice(0,a)}}while(i.parent())}(e.$view,t)},[e,t])}var l=r("808549"),a=r("120454"),s=r("206644"),d=r("887874"),c=r("249294"),u=r("913693"),p=r("40842");function m(e){var[t,r]=(0,n.useState)(),i=(0,s.dU)(r),m=(0,d.G6)();return(0,n.useLayoutEffect)(()=>m.inject([c.lg.fromClass(class{update(t){var r;if(!e&&t.docChanged&&t.changes.iterChanges((e,t,n,o,i)=>{var l=i.toString();e===t&&("{"===l||"{}"===l)&&(r={from:n,to:o,content:l})}),r){var n,s,d,c=(s=(n=t.state).selection.main.from,(0,o.qz)(n).resolve(s));if(c&&"JinjaExpression"===c.name&&(null===(d=c.lastChild)||void 0===d?void 0:d.name)==="JinjaExpressionEnd"&&c.lastChild.to-c.lastChild.from==2)this.triggerContext=void 0;else{var m=r.from+1,{to:v}=t.state.selection.main;this.triggerContext={from:m,to:v,offset:0,text:"",textBefore:"",validate:e=>!r||"{"===e.sliceDoc(r.from,r.from+1)&&("{}"!==r.content||"}"===e.sliceDoc(e.selection.main.to,e.selection.main.to+1))&&!0,composeTransaction:(e,t)=>{if(!r)return[];var n="{"===t.sliceDoc(Math.max(0,r.from-1),r.from);return 1===r.content.length?[{changes:[{from:e.changes.from,to:e.changes.to,insert:"".concat(n?"":"{").concat(e.changes.insert,"}}")}],selection:u.jT.cursor(e.cursorPosition+(n?0:1)),userEvent:e.userEvent,scrollIntoView:!0}]:[{changes:[{from:e.changes.from,to:e.changes.to,insert:"{".concat(e.changes.insert,"}")}],selection:u.jT.cursor(e.cursorPosition+1),userEvent:e.userEvent,scrollIntoView:!0}]}}}}else if(t.transactions.some(e=>e.isUserEvent("select")))this.triggerContext=void 0;else if(t.transactions.some(e=>(0,p._p)(e)))this.triggerContext=void 0;else if(this.triggerContext&&t.docChanged){if(this.triggerContext.validate(t.state)){var{from:_}=this.triggerContext,{to:f}=t.state.selection.main,h=t.state.sliceDoc(_,f);this.triggerContext=(0,a._)((0,l._)({},this.triggerContext),{from:_,to:f,offset:_-f,text:h,textBefore:h})}else this.triggerContext=void 0}i.current(this.triggerContext)}constructor(){this.triggerContext=void 0}})]),[m]),t}var v=r("336205"),_=r("397060"),f=r("973432");function h(e){return!e||!Array.isArray(e)||0===e.length}function x(e,t,r){return(0,n.useMemo)(()=>{if(!!r){if(h(e))return""===r.textBefore?v.o.t("workflow_variable_refer_no_input"):void 0;if(h(t)){if(""===r.text)return v.o.t("workflow_variable_refer_no_input");var n=_.N.toSegments(r.textBefore);if(!n)return;var o=f.qz.matchTreeBranch({tree:null!=e?e:[],segments:n});if(o&&0!==o.length)return v.o.t("workflow_variable_refer_no_sub_variable")}}},[e,t,r])}function g(e,t,r){return(0,n.useMemo)(()=>{if(!e||!r)return[];var n=_.N.toSegments(r.textBefore);return n?f.qz.pruning({tree:t,segments:n}):[]},[e,t,r])}var y=r("585558");function b(e,t){return(0,n.useMemo)(()=>{if(!t)return[];if(!e)return t;var r=(0,y.SI)(e.textBefore);return t.filter(e=>e.label.startsWith(r))},[e,t])}function j(e){var[t,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!!e)return e.$on("focus",t),e.$on("blur",n),()=>{e.$off("focus",t),e.$off("blur",n)};function t(){r(!0)}function n(){r(!1)}},[e]),t}function w(e){var[t,r]=(0,n.useState)("");return(0,n.useEffect)(()=>{r((0,y.lY)())},[e]),t}function C(e,t,r,o){var i=(0,y.dU)(r);(0,n.useEffect)(()=>{if(t.current&&i.current){var e=(0,y.SI)(i.current.textBefore);t.current.search(e),o()}},[e,r])}function k(e,t){var r=(0,y.dU)(t);(0,n.useEffect)(()=>{if(!!e)return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)};function t(e){var t=r.current[e.key];"function"==typeof t&&t(e)}},[e,r])}function N(e){var[t,r]=(0,n.useState)(),o=(0,y.dU)(t);return(0,n.useEffect)(()=>{if(!!e){var t=e.$view;return e.$on("selectionChange",i),e.$on("focus",l),()=>{e.$off("selectionChange",i),e.$off("focus",l)}}function n(e){if(null==e?void 0:e.transactions.some(e=>(0,p._p)(e))){r(void 0);return}var n,i,{from:l,to:a,anchor:s,head:d}=t.state.selection.main;if(n={from:l,to:a,anchor:s,head:d},i=o.current,(!!n||!!i)&&(!n||!i||n.anchor!==i.anchor||n.head!==i.head||n.from!==i.from||n.to!==i.to))r({from:l,to:a,anchor:s,head:d})}function i(e){n(e.update)}function l(){n()}},[e]),t}function S(e,t,r,o){var i=(0,y.dU)(e),l=(0,y.dU)(t);return(0,n.useMemo)(()=>({prev:function(){var e=(0,p.zA)(r.current);if(!e)return;var{elements:t,selectedIndex:n}=e;if(1!==t.length){var o=n-1<0?t.length-1:n-1;(0,p.Er)(t,o)}},next:function(){var e=(0,p.zA)(r.current);if(!!e){var{elements:t,selectedIndex:n}=e,o=n+1>=t.length?0:n+1;(0,p.Er)(t,o)}},apply:function(){if(!l.current)return;var e,t,n,a,s=(0,p.zA)(r.current);if(!s)return;var{selectedElement:d}=s,c=null==d?void 0:d.getAttribute("data-key");if(!c)return;var u=null===(a=o.current)||void 0===a?void 0:null===(n=a.state)||void 0===n?void 0:null===(t=n.keyEntities)||void 0===t?void 0:null===(e=t[c])||void 0===e?void 0:e.data;if(!!u)(0,p.m2)(i.current,u,l.current)}}),[])}function E(e,t){return(0,n.useMemo)(()=>{if(!e)return;var r=_.N.toSegments(e);if(!r)return;var n=f.qz.matchTreeBranch({tree:t,segments:r});if(!!n)return n[n.length-1]},[e,t])}},40842:function(e,t,r){r.d(t,{Er:function(){return m},_p:function(){return _},m2:function(){return v},zA:function(){return p}});var n=r(839974),o=r(913693),i=r(397060),l=r(973432),a=r(116611),s="api.skip-selection-change",d=a.Z["expression-editor-suggestion-keyboard-selected"],c=a.Z["expression-editor-suggestion-keyboard-selected-new"],u=()=>{var e=(0,n.L)();return(null==e?void 0:e["bot.automation.llm_prompt_skills"])?c:d},p=e=>{if(!e)return;var t=e.querySelectorAll(".semi-tree-option-list .semi-tree-option");if(0!==t.length){var r=[...t],n=r.findIndex(e=>e.classList.contains(u()));return{elements:r,selectedIndex:n,selectedElement:r[n]}}};function m(e,t){var r=e[t];if(!!r)e.forEach(e=>{e.classList.contains(u())&&e.classList.remove(u())}),r.classList.add(u()),r.scrollIntoView({behavior:"smooth",block:"nearest"})}function v(e,t,r){if(!e)return;var n,{from:a,to:d,textBefore:c,composeTransaction:u}=r,p=function(e,t){var r,n=null!==(r=i.N.toSegments(t))&&void 0!==r?r:[];return l.qz.concatFullPath({node:e,segments:n})}(t,c);if(!!p){var m=(n=t).children&&0!==n.children.length?0:2,v=a+p.length+m,_={changes:{from:a,to:d,insert:p},selection:o.jT.cursor(v),userEvent:s},f=[_];"function"==typeof u&&(f=u({changes:_.changes,userEvent:_.userEvent,cursorPosition:v},e.$view.state)),e.$view.dispatch(...f)}}function _(e){return e.isUserEvent(s)}},585558:function(e,t,r){r.d(t,{I7:function(){return d},SI:function(){return u},dU:function(){return a},lY:function(){return c}});var n=r(455069),o=r(734083),i=r(397060),l=r(973432);function a(e){var t=(0,n.useRef)(e);return t.current=e,t}function s(e,t){try{return JSON.parse(JSON.stringify(e,function(e,r){return t.includes(e)?null:r}))}catch(t){return e}}function d(e){var[t,r]=(0,n.useState)(e),i=(0,n.useRef)(e);return(0,n.useLayoutEffect)(()=>{!(0,o.J)(s(e,["parent"]),s(i.current,["parent"]))&&(r(e),i.current=e)},[e]),t}function c(){return Math.floor(2e6*Math.random()).toString(36)}function u(e){var t=i.N.toSegments(e);if(!t)return"";var r=t[t.length-1].type===l.XJ.ArrayIndex?t[t.length-2]:t[t.length-1];return r&&r.type===l.XJ.ObjectKey?r.objectKey:""}},446091:function(e,t,r){r.d(t,{_:function(){return l}});var n=r(336205),o=r(913693),i=new(r(227571)).b({mark:"InputSlot"}),l=(e,t)=>{if(!!e){var{mode:r="input",placeholder:l=n.o.t("edit_block_guidance_text_placeholder")}=null!=t?t:{},{selection:a}=e.$view.state,s=e.$view.state.selection.main,d=e.$view.state.sliceDoc(s.from,s.to),c=i.extractTemplateContent(d),{open:u,template:p,textContent:m}=i.generateTemplateJson({content:c,data:{placeholder:l,mode:r}}),v=s.from+u.length,_=v+m.length;e.$view.dispatch({changes:{from:s.from,to:s.to,insert:p}}),setTimeout(()=>{e.$view.dispatch({selection:a.replaceRange(o.jT.range(v,_))})},100)}}},944881:function(e,t,r){r.d(t,{g7:()=>x,tQ:()=>g,eJ:()=>b,Vv:()=>f});var n=r("151064"),o=r("455069"),i=r("887874"),l=r("919658"),a=r("336205"),s=r("674343"),d=e=>{var[t,r]=(0,o.useState)(""),{direction:i,placeholder:d,value:c}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.J2,{rePosKey:t,visible:e.visible,trigger:"custom",position:i,autoAdjustOverflow:!0,content:(0,n.jsxs)("div",{className:"flex flex-col gap-2 pt-3 pb-4 px-4 w-[320px]",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:a.o.t("edit_block_guidance_text_when_empty")}),(0,n.jsx)(s.II,{value:d,placeholder:a.o.t("edit_block_guidance_text_placeholder"),onChange:t=>{var r;return null===(r=e.onPlaceholderChange)||void 0===r?void 0:r.call(e,t)},onBlur:()=>{if(!d){var t;null===(t=e.onPlaceholderChange)||void 0===t||t.call(e,a.o.t("edit_block_guidance_text_placeholder"))}}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:a.o.t("edit_block_prefilled_text")}),(0,n.jsx)(s.II,{value:c,placeholder:a.o.t("edit_block_default_guidance_text"),onChange:t=>{var r;return null===(r=e.onValueChange)||void 0===r?void 0:r.call(e,t)}})]})]}),children:(0,n.jsx)(l.Iq,{position:e.positon,onChange:()=>r(String(Math.random()))})})})},c=e=>{var{direction:t,templateParser:r}=e,l=(0,i.jE)(),[a,s]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[p,m]=(0,o.useState)(!1),[v,_]=(0,o.useState)(-1);return(0,o.useEffect)(()=>{if(!!l){var e=e=>{if(e.docChanged){var{state:t}=e,n=r.getCursorInMarkNodeRange(t);if(!n)return;var o=t.sliceDoc(n.open.to,n.close.from);if(o===c)return;u(o)}if(e.selectionSet){var i,{state:a}=e,d=r.getCursorInMarkNodeRange(a);if(!d){_(-1),m(!1);return}var p=r.getCursorTemplateContent(l),{placeholder:v}=null!==(i=r.getCursorTemplateData(a))&&void 0!==i?i:{};s(v),u(null!=p?p:""),_(d.open.from),m(!0)}};return l.$on("viewUpdate",e),()=>{l.$off("viewUpdate",e)}}},[l,c]),(0,n.jsx)(d,{visible:p,positon:v,direction:t,placeholder:a,value:c,onPlaceholderChange:e=>{if(!!l&&!!p)s(e),r.updateCursorTemplateData(l,{placeholder:e})},onValueChange:e=>{if(!!l&&!!p)u(e),r.updateCursorTemplateContent(l,e)}})};r("700003");var u=r("642199"),p=r("561700"),m=r("227571"),v=r("358477"),_=new m.b({mark:"InputSlot"}),f=e=>{var{mode:t,onSelectionInInputSlot:r}=e,l=(0,i.G6)(),a=(0,i.jE)(),s=(0,v.j)();return((0,o.useLayoutEffect)(()=>{var{markInfoField:e}=_;return l.inject([u.Cj.whole.of((e,t)=>{if(_.isOpenNode(e.node,t)){var r=e.node,n=_.findCloseNode(r,t);if(n){var o=t.sliceDoc(r.from,r.to),i=_.getData(o),l=r.to,a=n.from;return l===a?[{type:"replace",widget:new p.S9({className:"slot-side-left"}),atomicRange:!0,from:r.from,to:r.to},{type:"widget",widget:new p.S9({text:(null==i?void 0:i.placeholder)||"",className:"slot-placeholder"}),from:l,atomicRange:!0,side:1},{type:"replace",widget:new p.S9({className:"slot-side-right"}),atomicRange:!0,from:n.from,to:n.to}]:[{type:"replace",widget:new p.S9({className:"slot-side-left"}),atomicRange:!0,from:r.from,to:r.to},{type:"className",className:"slot-content",from:l,to:a},{type:"replace",widget:new p.S9({className:"slot-side-right"}),atomicRange:!0,from:n.from,to:n.to}]}}}),e,u.Pu.of(t=>t.field(e).contents),u._h.of(t=>t.field(e).specs),u.bi.of(t=>t.field(e).specs)])},[l]),(0,o.useEffect)(()=>{if(!!a){var e=e=>{if(!e.state.selection.main.empty){var t=_.getSelectionInMarkNodeRange(e.state.selection.main,e.state);if(t){null==r||r(t);return}null==r||r(void 0)}};return a.$on("viewUpdate",e),()=>{a.$off("viewUpdate",e)}}},[a]),"configurable"!==t||s)?null:(0,n.jsx)(c,{direction:"bottomLeft",templateParser:_})};r("446091");var h=new m.b({mark:"InputSlot"}),x=()=>{var e=(0,i.jE)(),[t,r]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!!e){var t=e=>{if(e.selectionSet){if(h.getSelectionInMarkNodeRange(e.state.selection.main,e.state)){r(!0);return}r(!1)}};return e.$on("viewUpdate",t),()=>{e.$off("viewUpdate",t)}}},[e]),t},g=()=>{var e=(0,i.jE)(),[t,r]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!!e){var t=e=>{if(!e.state.selection.main.empty){if(h.getSelectionInMarkNodeRange(e.state.selection.main,e.state)){r(!0);return}r(!1)}};return e.$on("viewUpdate",t),()=>{e.$off("viewUpdate",t)}}},[e]),t},y=r("562312"),b=()=>{var e=(0,i.jE)(),[t,r]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!!e){var t=()=>{var t=e.getSelection();if(!t){r(!1);return}var{state:n}=e.$view,o=(0,y.qz)(n).cursor(),i=!1;do if("RawText"===o.name&&o.from<=t.from&&o.to>=t.to){i=!0;break}while(o.next());r(i)};return e.$on("viewUpdate",t),t(),()=>{e.$off("viewUpdate",t)}}},[e]),t}},539227:function(e,t,r){r.d(t,{Fi:()=>el,jy:()=>Q});var n,o,i,l=r("455069"),a=r("887874"),s=r("642199"),d=r("825955"),c=r("808549"),u=r("120454"),p=r("382534"),m=r("286518"),v=e=>{switch(e){case"plugin":default:return m.ye.Plugin;case"workflow":return m.ye.Workflow;case"imageflow":return m.ye.ImageFlow;case"text":case"image":case"table":return m.ye.Knowledge}},_=(e,t)=>{var{type:r}=t,n=e.find(e=>{var{type:n,items:o}=e;return n===r&&o.some(e=>f(e,t))}),o=null==n?void 0:n.items.find(e=>f(e,t));if(!!o)return(0,u._)((0,c._)({},o),{type:r})},f=(e,t)=>{var{apiId:r,id:n}=t;return r?e.api_id===r:e.id===n},h=(e,t)=>e!==t.name;var x=(n=(0,d._)(function*(e){var{id:t,type:r,apiId:n,spaceId:o,projectId:i,avatarBotId:l}=e,{data:a}=yield p.pr.GetPromptReferenceInfo({reference_id:t,reference_type:v(r),api_id:n,space_id:null!=o?o:"",project_id:i,avatar_bot_id:l},{__disableErrorToast:!0});if(!!a)return(0,u._)((0,c._)({},a),{type:r})}),function(e){return n.apply(this,arguments)}),g=e=>{var{librarys:t,libraryBlockInfo:r,content:n}=e,o="disabled";if(!r)return{libraryStatus:"disabled"};var i=_(t,r);return i?{libraryStatus:o=h(n,i)?"outdated":"existing"}:{libraryStatus:"disabled"}},y=r("473980"),b=r("871873"),j=r("86609"),w=r("182418"),C=r("724971"),k=r("184561"),N=r("94238"),S=r("698226");r("351564");var E={plugin:{icon:j.Z},workflow:{icon:w.Z},imageflow:{icon:C.Z},table:{icon:k.Z},text:{icon:N.Z},image:{icon:S.Z}},T=e=>{var{template:t,templateParser:r}=e,n=r.getData(t);if(!n)return null;var{type:o}=n,i=(0,y._)(n,["type"]);return(0,b.Z)({},E[o],(0,c._)({type:o},i))},I=(e,t)=>{if(!e||!t)return null;var r,n,o=e.find(e=>e.type===t.type);return null!==(n=null==o?void 0:null===(r=o.items)||void 0===r?void 0:r.find(e=>f(e,t)))&&void 0!==n?n:null},P=r("227571"),A=r("151064"),D=r("131325"),L=r("252237"),O=r.n(L),Z=r("674343"),F=r("249294"),M=r("336205"),z=r("568251"),R=e=>{var{editorRef:t,library:r,range:n,onRename:o}=e;return(0,A.jsx)(Z.zx,{onClick:()=>{var e;if(!!t.current)null===(e=t.current)||void 0===e||e.$view.dispatch({changes:{from:n.left,to:n.right,insert:r.name}}),null==o||o({from:n.left,to:n.right})},color:"primary",size:"small",children:M.o.t("edit_block_api_rename")})},B=r("603141");var V=(o=(0,d._)(function*(e){var{editorRef:t,libraryStatus:r,libraryItem:n,blockDataInfo:o,onAddLibrary:i,readonly:l,spaceId:a,range:s,projectId:d,avatarBotId:c,onRename:u,disabled:p}=e;try{if(p)return W();if(l)return H();var{type:m,id:v}=null!=o?o:{};if(!o||!m||!v)return H();if("disabled"===r||!n)return yield K({blockDataInfo:o,spaceId:a,onAddLibrary:i,projectId:d,avatarBotId:c});if("outdated"===r)return G({editorRef:t,item:n,range:s,onRename:u});if("existing"===r)return U(n);return H()}catch(e){var _=e.msg;if(_)return{tooltipConfig:{content:_}};return H()}}),function(e){return o.apply(this,arguments)}),U=e=>{var t,r,n;return{tooltipConfig:{content:(0,A.jsx)(z.J,{title:null!==(t=e.name)&&void 0!==t?t:"",description:null!==(r=e.desc)&&void 0!==r?r:"",avatar:null!==(n=e.icon_url)&&void 0!==n?n:"",className:"!p-0"}),className:"library-block-tooltip !w-[310px] !p-2"}}},H=e=>({tooltipConfig:{content:null!=e?e:M.o.t("edit_block_api_disable_tooltips")}}),W=()=>({tooltipConfig:{visible:!1,trigger:"custom"}}),G=e=>{var t,r,n,{item:o,range:i,onRename:l,editorRef:a}=e;return{tooltipConfig:{content:(0,A.jsx)(z.J,{title:null!==(t=o.name)&&void 0!==t?t:"",description:null!==(r=o.desc)&&void 0!==r?r:"",avatar:null!==(n=o.icon_url)&&void 0!==n?n:"",className:"!p-0",actions:(0,A.jsx)(R,{library:o,range:i,editorRef:a,onRename:l})}),className:"library-block-tooltip !w-[310px] !p-2"}}};var K=(i=(0,d._)(function*(e){var{blockDataInfo:t,spaceId:r,onAddLibrary:n,projectId:o,avatarBotId:i}=e,{id:l,type:a}=null!=t?t:{};if(!l||!a)return H();try{var s,d,p,m=yield x((0,u._)((0,c._)({id:l,type:a},"plugin"===a&&{apiId:null==t?void 0:t.apiId}),{spaceId:r,projectId:o,avatarBotId:i}));if(!m)return H();return{tooltipConfig:{content:(0,A.jsx)(z.J,{title:null!==(s=m.name)&&void 0!==s?s:"",description:null!==(d=m.desc)&&void 0!==d?d:"",avatar:null!==(p=m.icon_url)&&void 0!==p?p:"",className:"!p-0",actions:n?(0,A.jsx)(B.H,{library:m,onClick:n}):void 0}),className:"library-block-tooltip !w-[310px] !p-2",showArrow:!1}}}catch(e){return H(e.msg)}}),function(e){return i.apply(this,arguments)});function J(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=document.createElement(e);for(var[o,i]of Object.entries(t))n.setAttribute(o,i);for(var l of r)if("string"==typeof l){var a=document.createTextNode(l);n.appendChild(a)}else n.appendChild(l);return n}class q extends F.l9{toDOM(){return this.options?(this.root&&this.destroy(),!this.mounted&&(this.renderLibraryBlock(this.options),this.renderTooltip(this.options),this.mounted=!0),this.container):this.container}renderLibraryBlock(e){var t,r=J("span",{class:O()("library-block-container leading-5",e.className,{"!coz-mg-hglt !text-[#9498F7] !text-opacity-70":!e.hightlight})},[J("img",{src:(null===(t=e.blockDataInfo)||void 0===t?void 0:t.icon)||"",class:O()("library-block-icon",{"!opacity-70":!e.hightlight})}),J("span",{class:"library-block-content"},[e.content])]);this.dom=r,this.container.appendChild(r)}renderTooltip(e){var t,r=document.createElement("span");this.root=(0,D.createRoot)(r),this.container.appendChild(r),this.root.render((0,A.jsx)($,{editorRef:e.editorRef,blockDataInfo:null==e?void 0:e.blockDataInfo,libraryItem:e.libraryItem,content:e.content,hightlight:e.hightlight,readonly:e.readonly,libraryStatus:e.libraryStatus,onAddLibrary:e.onAddLibrary,onRename:e.onRename,spaceId:null!==(t=e.spaceId)&&void 0!==t?t:"",range:e.range,beforeMount:()=>{var e=this.dom;(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)},projectId:e.projectId,avatarBotId:e.avatarBotId,disabledTooltips:e.disabledTooltips}))}destroy(){this.mounted=!1,this.root&&(setTimeout(()=>{var e;null===(e=this.root)||void 0===e||e.unmount()},0),this.root=null),this.dom&&(this.dom.remove(),this.dom=void 0),this.options=null}constructor(e){super(),this.options=e,this.container=document.createElement("span"),this.root=null,this.mounted=!1}}var $=e=>{var t,{blockDataInfo:r,libraryItem:n,content:o,hightlight:i=!0,libraryStatus:a,onAddLibrary:s,readonly:p,spaceId:m,range:v,editorRef:_,beforeMount:f,className:h,projectId:x,avatarBotId:g,onRename:y,disabledTooltips:b}=e,[j,w]=(0,l.useState)(void 0);var C=(t=(0,d._)(function*(){if(!!_.current)w((yield V({editorRef:_,libraryStatus:a,readonly:p,libraryItem:n,blockDataInfo:r,onAddLibrary:s,spaceId:m,range:v,projectId:x,avatarBotId:g,onRename:y,disabled:b})).tooltipConfig)}),function(){return t.apply(this,arguments)});(0,l.useLayoutEffect)(()=>{f()},[]);var k=(0,A.jsxs)("span",{className:O()("library-block-container leading-5",h,{"!coz-mg-hglt !text-[#9498F7] !text-opacity-70":!i}),onMouseEnter:C,children:[(0,A.jsx)("img",{src:(null==r?void 0:r.icon)||"",className:O()("library-block-icon",{"!opacity-70":!i})}),(0,A.jsx)("span",{className:"library-block-content",children:o})]});return j?(0,A.jsx)(Z.u,(0,u._)((0,c._)({position:"bottomLeft",spacing:{y:4,x:0},showArrow:!1},j),{children:k})):k};r("747555");var X=new P.b({mark:"LibraryBlock"});function Y(e){var t=(0,l.useRef)(e);return t.current=e,t}var Q=e=>{var t=Y(e),r=(0,a.jE)(),n=Y(r),o=(0,a.G6)();return(0,l.useLayoutEffect)(()=>o.inject([s.Cj.whole.of((e,r)=>{var{librarys:o,readonly:i=!1,spaceId:l,className:a,projectId:s,avatarBotId:d,onRename:c,disabledTooltips:u}=t.current;if(X.isOpenNode(e.node,r)){var p=e.node,m=X.findCloseNode(p,r);if(m){var v=r.sliceDoc(p.from,p.to),_=p.to,f=m.from,h=r.sliceDoc(_,f),x=T({template:v,templateParser:X}),{libraryStatus:y}=g({librarys:o,libraryBlockInfo:x,content:h}),b=x?I(o,x):null;return[{type:"replace",widget:new q({editorRef:n,blockDataInfo:x,libraryItem:b,readonly:i,content:h,spaceId:l,className:a,hightlight:"existing"===y,libraryStatus:y,onAddLibrary(e){"function"==typeof t.current.onAddLibrary&&t.current.onAddLibrary(e,{from:p.from,to:m.to})},range:{left:p.to,right:m.from},projectId:s,avatarBotId:d,onRename:c,disabledTooltips:u}),atomicRange:!0,from:p.from,to:m.to}]}}}),X.markInfoField]),[o]),(0,l.useEffect)(()=>{if(!!r)null==r||r.updateWholeDecorations()},[r,e.librarys]),null},ee=r("801815"),et=r("206644"),er=r("919658"),en=r("562312"),eo=r("584673"),ei=new P.b({mark:"LibraryBlock"}),el=e=>{var{librarys:t,direction:r="bottomLeft"}=e,[n,o]=(0,l.useState)(""),[i,s]=(0,l.useState)(!1),[d,u]=(0,l.useState)(-1),[p,m]=(0,l.useState)(-1),v=0===t.map(e=>e.items).flat().length,_=(0,a.jE)();return(0,et.n3)(e=>{var[t,r,n,o,i]=e.change;["{}","{"].includes(i.toString())&&"JinjaText"===(0,en.qz)(e.view.state).resolve("{}"===i.toString()?o-1:o).name?(u(n),m(o),s(!0)):s(!1)}),(0,l.useEffect)(()=>{if(!!_)return _.$on("viewUpdate",e),()=>{_.$off("viewUpdate",e)};function e(e){e.transactions.some(e=>e.isUserEvent("select"))&&s(!1)}},[_]),(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(Z.J2,{rePosKey:n,visible:i,trigger:"custom",position:v?"bottomLeft":r,onClickOutSide:()=>s(!1),autoAdjustOverflow:!0,content:v?(0,A.jsx)("div",{className:"coz-fg-primary text-sm font-medium px-3 py-2",children:M.o.t("edit_block_api_empty")}):(0,A.jsx)("div",{className:"flex flex-col p-1  w-[352px] max-h-[330px] overflow-y-auto",children:(0,A.jsx)(eo.X,{librarys:t,onInsert:e=>{var{name:t="",id:r="",type:n}=e,o=(0,ee.x0)(),i=ei.generateTemplate({content:t,data:(0,c._)({id:r,uuid:o,type:n},"plugin"===n&&{apiId:e.api_id})});ei.insertTemplateByRange(_,i,{from:d,to:p}),s(!1)}})}),children:(0,A.jsx)(er.Iq,{position:d,onChange:()=>o(String(Math.random()))})})})}},603141:function(e,t,r){r.d(t,{H:function(){return l}});var n=r(151064),o=r(336205),i=r(674343),l=e=>{var{library:t,onClick:r}=e;return(0,n.jsx)(i.zx,{onClick:()=>r(t),color:"primary",size:"small",children:o.o.t("add")})}},568251:function(e,t,r){r.d(t,{J:function(){return a}});var n=r(151064),o=r(252237),i=r.n(o),l=r(674343),a=e=>{var{title:t,description:r,avatar:o,icons:a,actions:s,className:d,searchWords:c}=e;return(0,n.jsxs)("div",{className:i()("w-full flex flex-row items-center coz-bg-max rounded-[8px]"," gap-3",d),children:[(0,n.jsxs)("div",{className:i()("flex flex-row flex-1 min-w-[0px] justify-center items-center "),children:[o?(0,n.jsx)("img",{src:o,className:i()("w-[24px] h-[24px] rounded-[5px]","overflow-hidden")}):null,(0,n.jsx)("div",{className:i()("ml-[8px]","flex flex-col flex-1 min-w-[0px] w-0"),children:(0,n.jsxs)("div",{className:"flex flex-row items-center overflow-hidden",children:[(0,n.jsx)(l.ZT.Paragraph,{ellipsis:{showTooltip:!0},className:i()("text-[14px] leading-[20px]","coz-fg-primary truncate flex-1 font-medium"),children:(0,n.jsx)(l.y$,{sourceString:t,searchWords:c,highlightStyle:{color:"var(--coz-fg-hglt-yellow, #FF7300)",backgroundColor:"transparent"}})}),(0,n.jsx)("div",{className:"justify-self-end grid grid-flow-col gap-x-[2px]",children:a})]})})]}),(0,n.jsx)("div",{className:i()("grid grid-flow-col gap-x-[2px]"),children:s})]})}},584673:function(e,t,r){r.d(t,{X:function(){return m}});var n=r(808549),o=r(120454),i=r(151064),l=r(252237),a=r.n(l),s=r(336205),d=r(674343),c=r(568251),u=r(603141),p={plugin:s.o.t("edit_block_api_plugin"),workflow:s.o.t("edit_block_api_workflow"),imageflow:s.o.t("edit_block_api_imageflow"),text:s.o.t("edit_block_api_knowledge_text"),image:s.o.t("edit_block_api_knowledge_image"),table:s.o.t("edit_block_api_knowledge_table")},m=e=>{var{librarys:t,onInsert:r,libraryItemClassName:l,searchWords:s}=e;return(0,i.jsx)("div",{className:"flex flex-col gap-2",children:Object.values(t).map(e=>{var{items:t,type:m}=e;return 0===t.length?null:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)(d.ZT.Text,{className:"coz-fg-tertiary text-xs mb-1 px-2 pt-2 pb-1",children:p[m]}),t.map(e=>{var{name:t,desc:d,icon_url:p}=e;return(0,i.jsx)(c.J,{searchWords:s,title:t||"",description:d||"",avatar:p||"",className:a()("p-[8px]",l),actions:(0,i.jsx)(u.H,{library:(0,o._)((0,n._)({},e),{type:m}),onClick:e=>{null==r||r(e)}})},t)})]},m)})})}},273757:function(e,t,r){r.d(t,{e:()=>N});var n=r("151064"),o=r("455069"),i=r("887874"),l=r("919658"),a=r("642199"),s=r("336205"),d=r("674343"),c=r("585558"),u=r("726154"),p=r("775699"),m=r("813843"),v=r("40842"),_=r("808549"),f=r("120454"),h=r("801815"),x=r("227571"),g=r("584673"),y=m.Z["library-suggestion-keyboard-selected"],b=e=>{if(!e)return;var t=e.querySelectorAll(".".concat(m.Z["library-item"]));if(0!==t.length){var r=[...t],n=r.findIndex(e=>e.classList.contains(y));return{elements:r,selectedIndex:n,selectedElement:r[n]}}},j=(e,t)=>{var r=e[t];if(!!r)e.forEach(e=>{e.classList.contains(y)&&e.classList.remove(y)}),r.classList.add(y),r.scrollIntoView({behavior:"smooth",block:"nearest"})},w=(0,o.forwardRef)((e,t)=>{var{libraries:r,onInsert:o,searchWords:i}=e;return 0===r.map(e=>e.items).flat().length?(0,n.jsx)("div",{ref:t,className:"coz-fg-primary text-sm font-medium px-3 py-2",children:s.o.t("edit_block_api_empty")}):(0,n.jsx)("div",{ref:t,className:"flex flex-col p-1  w-[352px] max-h-[330px] overflow-y-auto",children:(0,n.jsx)(g.X,{librarys:r,onInsert:o,libraryItemClassName:m.Z["library-item"],searchWords:i})})}),C=new x.b({mark:"LibraryBlock"}),k=(e,t)=>{var r=(null!=e?e:0)-1>=0?(null!=e?e:0)-1:0;return{from:r,to:(null!=t?t:r)+1}},N=e=>{var{libraries:t=[],direction:r="bottomLeft",readonly:x,onInsert:g,variableTree:y=[]}=e,[N,S]=(0,o.useState)("1"),[E,T]=(0,o.useState)(""),I=0===t.map(e=>e.items).flat().length,P=(0,i.jE)(),A=(0,c.dU)(P),D=(0,u.cH)(P),L=(0,u.L9)(P,null==D?void 0:D.anchor),O=(0,u.Fr)(),Z=null!=L?L:O,F=!!Z,{libraryListPanel:M}=function(e){var{libraries:t,editor:r,insertPosition:i,onInsert:l,enableKeyboard:a,filterText:s}=e,d=(0,o.useRef)(null),c=(0,o.useMemo)(()=>s?t.map(e=>(0,f._)((0,_._)({},e),{items:e.items.filter(e=>e.name.toLowerCase().includes(s.toLowerCase()))})).filter(e=>{var t;return null===(t=e.items)||void 0===t?void 0:t.length}):t,[t,s]),p=e=>{var{name:t="",id:n="",type:o}=e,a=(0,h.x0)(),s=C.generateTemplate({content:t,data:(0,_._)({id:n,uuid:a,type:o},"plugin"===o&&{apiId:e.api_id})});C.insertTemplateByRange(r,s,i),null==l||l({from:i.from,to:i.from+s.length})},{prev:m,next:v,apply:x}=function(e){var{rootRef:t,libraries:r,applyCallBack:n}=e;return{prev:()=>{var e=b(t.current);if(!e)return;var{elements:r,selectedIndex:n}=e;if(1!==r.length){var o=n-1<0?r.length-1:n-1;j(r,o)}},next:()=>{var e=b(t.current);if(!!e){var{elements:r,selectedIndex:n}=e,o=n+1>=r.length?0:n+1;j(r,o)}},apply:()=>{var e=b(t.current);if(!e)return;var o=r.reduce((e,t)=>[...e,...(null==t?void 0:t.items)||[]],[])[e.selectedIndex];if(!!o)null==n||n(o)}}}({rootRef:d,libraries:c,applyCallBack:p});return(0,u.v5)(a,{ArrowUp:m,ArrowDown:v,Enter:x}),{libraryListPanel:(0,n.jsx)(w,{ref:d,libraries:c,onInsert:p,searchWords:s?[s]:void 0})}}({libraries:t,editor:P,onInsert:g,insertPosition:k(null==Z?void 0:Z.from,null==Z?void 0:Z.to),enableKeyboard:F&&"2"===N,filterText:null==Z?void 0:Z.text}),{variablesTreePanel:z}=function(e){var{variableTree:t,enableKeyboard:r,completionContext:l}=e,a=(0,i.jE)(),s=(0,c.I7)(t),d=(0,o.useRef)(null),_=(0,o.useRef)(null),f=(0,u.$W)(a,s,l),h=(0,u.TW)(null==l?void 0:l.text,s),x=(0,o.useCallback)((e,t,r)=>{if(!!a&&!!l)(0,v.m2)(a,r,l),a.$view.focus()},[a,l]),g=(0,u.SJ)(l,f),y=(0,u._E)(g);(0,u.rz)(y,d,l,()=>{var e=(0,v.zA)(_.current);if(!!e){var{elements:t}=e;(0,v.Er)(t,0)}});var{prev:b,next:j,apply:w}=(0,u.mm)(a,l,_,d);return(0,u.v5)(r,{ArrowUp:b,ArrowDown:j,Enter:()=>{w(),a.$view.focus()}}),{variablesTreePanel:(0,n.jsx)("div",{className:m.Z["library-variable-insert-tree"],ref:_,children:(0,n.jsx)(p.mp,{ref:d,showFilteredOnly:!0,filterTreeNode:!0,onChangeWithObject:!0,treeData:f,searchRender:!1,value:h,onSelect:x})})}}({variableTree:y,enableKeyboard:F&&"1"===N,completionContext:Z});return(0,o.useEffect)(()=>{var e,t;F?null===(e=A.current)||void 0===e||e.disableKeybindings(["ArrowUp","ArrowDown","Enter"]):null===(t=A.current)||void 0===t||t.disableKeybindings([])},[F]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(d.J2,{style:{width:"360px",padding:"4px",minHeight:"240px",maxHeight:"400px"},rePosKey:E,visible:!x&&F,trigger:"custom",position:I?"bottomLeft":r,autoAdjustOverflow:!0,content:(0,n.jsxs)(d.mQ,{activeKey:N,onChange:e=>{S(e),setTimeout(()=>{var e;null===(e=A.current)||void 0===e||e.$view.focus()},0)},renderTabBar:e=>{var t;return(0,n.jsx)("div",{className:m.Z["tab-bar-wrapper"],children:(0,n.jsx)(d.FX,{value:e.activeKey,type:"button",buttonSize:"middle",children:null===(t=e.list)||void 0===t?void 0:t.map(t=>(0,n.jsx)("span",{onClick:r=>{var n;return null===(n=e.onTabClick)||void 0===n?void 0:n.call(e,t.itemKey,r)},children:(0,n.jsx)(d.Y8,{value:t.itemKey,children:t.tab})}))})})},children:[(0,n.jsx)(d.Jm,{tab:s.o.t("workflow_prompt_editor_variable"),itemKey:"1",children:z}),(0,n.jsx)(d.Jm,{tab:s.o.t("workflow_prompt_editor_skill"),itemKey:"2",children:M})]}),children:(0,n.jsx)(l.Vj,{side:a.m6.Anchor,onChange:()=>T((0,c.lY)())})})})}},358477:function(e,t,r){r.d(t,{j:function(){return i}});var n=r(455069),o=r(887874),i=()=>{var e=(0,o.jE)(),[t,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!!e){r(e.$view.state.readOnly);var t=e=>{e.startState.readOnly!==e.state.readOnly&&r(e.state.readOnly)};return e.$on("viewUpdate",t),()=>{e.$off("viewUpdate",t)}}},[e]),t}},227571:function(e,t,r){r.d(t,{b:function(){return l}});var n=r(808549),o=r(913693),i=r(562312);class l{getMarkInfoField(){return o.QQ.define({create:e=>this.getMarkSpecs(e),update:(e,t)=>t.docChanged?this.getMarkSpecs(t.state):e})}isOpenNode(e,t){if(!e||"JinjaComment"!==e.name)return!1;var r=t.sliceDoc(e.from,e.to);return this.openReg.test(r)}isCloseNode(e,t){if(!e||"JinjaComment"!==e.name)return!1;var r=t.sliceDoc(e.from,e.to);return this.closeReg.test(r)}getCursorInMarkNodeRange(e){var t=e.selection.main.head;return this.getPostionInMarkNodeRange(t,e)}getSelectionInMarkNodeRange(e,t){return this.getPostionInMarkNodeRange(e.from,t)&&this.getPostionInMarkNodeRange(e.to,t)}getPostionInMarkNodeRange(e,t){var r=t.field(this.markInfoField).marks.find(t=>t.from<e&&e<t.to);return r?r:null}findCloseNode(e,t){for(var r=e.nextSibling,n=null;r;){if(this.isCloseNode(r,t)){n=r;break}r=r.nextSibling}return n}getData(e){var t=RegExp("\\{#".concat(this.mark,"\\s+([^#]+)#\\}"),"g").exec(e);if(null!==t){for(var r,n=t[1].trim(),o=/(\w+)\s*=\s*"([^"]*)"/g,i={};null!==(r=o.exec(n));){;i[r[1]]=r[2]}return i}return null}getCursorTemplateData(e){var t=this.getCursorInMarkNodeRange(e);if(!!t){var{from:r,to:n}=t.open,o=e.sliceDoc(r,n);return this.getData(o)}}getAllMarksByState(e){var t=[],r=(0,i.qz)(e).cursor();do if(this.isOpenNode(r.node,e)){var n=r.node,o=this.findCloseNode(r.node,e);o&&t.push({from:n.from,to:o.to,open:{from:n.from,to:n.to},close:{from:o.from,to:o.to}})}while(r.next());return t}getMarkSpecs(e){var t=this.getAllMarksByState(e),r=[],n=[];return t.forEach(e=>{r.push({source:{from:e.open.from,to:e.open.to},target:{from:e.from,to:e.to}}),r.push({source:{from:e.close.from,to:e.close.to},target:{from:e.from,to:e.to}}),n.push({from:e.open.to,to:e.close.from})}),{specs:r,contents:n,marks:t}}updateCursorTemplateData(e,t){var{state:r}=e.$view,o=this.getCursorInMarkNodeRange(r);if(!!o){var{from:i,to:l}=o.open,a=r.sliceDoc(i,l),s=this.getData(a),d=(0,n._)({},s,t);if(!s){this.addCursorTemplateData(e,d);return}var c=this.generateOpenTemplateByData(d);e.$view.dispatch({changes:{from:i,to:l,insert:c}})}}addCursorTemplateData(e,t){var{state:r}=e.$view,o=this.getCursorInMarkNodeRange(r);if(!!o){var{from:i,to:l}=o.open,a=r.sliceDoc(i,l),s=this.getData(a),d=(0,n._)({},s,t),c=this.generateOpenTemplateByData(d);e.replaceTextByRange({from:i,to:l,text:c})}}generateOpenTemplateByData(e){var t=Object.keys(e),r=Object.values(e),n=t.map((e,t)=>"".concat(e,'="').concat(r[t],'"')).join(" ");return"{#".concat(this.mark," ").concat(n,"#}")}generateTemplate(e){var{content:t,data:r}=e,n=this.generateOpenTemplateByData(r),o="{#/".concat(this.mark,"#}");return"".concat(n).concat(t).concat(o)}generateTemplateJson(e){var{content:t,data:r}=e,n=this.generateOpenTemplateByData(r),o="{#/".concat(this.mark,"#}");return{open:n,close:o,textContent:this.extractTemplateContent(t),template:"".concat(n).concat(t).concat(o)}}updateCursorTemplateContent(e,t){var{state:r}=e.$view,n=this.getCursorInMarkNodeRange(r);if(!!n)e.replaceTextByRange({from:n.open.to,to:n.close.from,text:t})}getCursorTemplateContent(e){var{state:t}=e.$view,r=this.getCursorInMarkNodeRange(t);if(!!r)return t.sliceDoc(r.open.to,r.close.from)}insertTemplateByCursor(e,t){var{state:r}=e.$view,n=r.selection.main.head;if(!!n)e.$view.dispatch({changes:{from:n,to:n,insert:t}})}insertTemplateByRange(e,t,r){var{from:n,to:o}=r;e.$view.dispatch({changes:{from:n,to:o,insert:t}})}extractTemplateContent(e){var t=RegExp("\\{#".concat(this.mark,"\\s+[^#]+#\\}|\\{#\\/").concat(this.mark,"#\\}"),"g"),r=e.replace(t,"");return console.log("extractTemplateContent",r),r}constructor(e){if(l.instances.has(e.mark))return l.instances.get(e.mark);var{mark:t}=e;this.mark=t,this.openReg=new RegExp("^\\{#\\s*".concat(t)),this.closeReg=new RegExp("^\\{#\\s*/".concat(t)),this.markInfoField=this.getMarkInfoField(),l.instances.set(t,this)}}l.instances=new Map},925623:function(e,t,r){r.d(t,{G:()=>i});var n=r("455069"),o=r("887874"),i=e=>{var{themes:t}=e,r=(0,o.G6)();return(0,n.useLayoutEffect)(()=>r.inject(t),[r,t]),null}},816697:function(e,t,r){r.d(t,{AU:function(){return o.AU},Ae:function(){return o.Ae},BB:function(){return l.BB},BH:function(){return o.BH},BP:function(){return n.BP},Ho:function(){return l.Ho},JA:function(){return o.JA},JE:function(){return i.JE},JT:function(){return o.JT},K4:function(){return o.K4},KV:function(){return o.KV},Kn:function(){return o.Kn},Oo:function(){return o.Oo},Q5:function(){return o.Q5},Qc:function(){return o.Qc},Re:function(){return n.Re},VD:function(){return l.VD},bc:function(){return l.bc},cO:function(){return o.cO},ei:function(){return o.ei},f9:function(){return i.f9},gw:function(){return o.gw},hj:function(){return o.hj},kg:function(){return o.kg},mY:function(){return l.mY},mf:function(){return o.mf},pY:function(){return l.pY},qC:function(){return o.qC},qp:function(){return i.qp},r4:function(){return o.r4},rM:function(){return o.rM},xF:function(){return o.xF},yb:function(){return o.yb}}),r(327212);var n=r(613921),o=r(168316),i=r(107392),l=r(178635)},178626:function(e,t,r){r.r(t),r.d(t,{md2html:()=>v,ZoneDelta:()=>u,LazyEditorFullInputInner:()=>j,LazyEditorFullInput:()=>b,DEFAULT_ZONE:()=>c,DeltaSetOptions:()=>l.DeltaSetOptions,Text:()=>x,ToolbarItemEnum:()=>d,normalizeSchema:()=>h,checkAndGetMarkdown:()=>f,DeltaSet:()=>p,ToolbarButton:()=>g,delta2md:()=>_,Plugin:()=>y,IApplyMetadata:()=>l.IApplyMetadata,EditorEventType:()=>m,displayType:()=>s});var n,o,i,l={};r.r(l),r.d(l,{S2:()=>c,uN:()=>p,rp:()=>m,_l:()=>d,If:()=>u,v:()=>s});var a=r("455069");var s=((n={}).inline="inline",n.block="block",n);var d=((o={}).Bold="Bold",o.Italic="Italic",o.Underline="Underline",o.Undo="Undo",o.Redo="Redo",o.Strikethrough="Strikethrough",o.Blockquote="Blockquote",o.UnorderedList="UnorderedList",o.OrderedList="OrderedList",o.Checkbox="Checkbox",o.Indent="Indent",o.H1="H1",o.H2="H2",o.H3="H3",o.AlignCenter="AlignCenter",o.AlignLeft="AlignLeft",o.AlignRight="AlignRight",o.HorizontalLine="HorizontalLine",o.Hyperlink="Hyperlink",o.Image="Image",o.Table="Table",o.CodeBlock="CodeBlock",o.Video="Video",o.DIVIDER="DIVIDER",o.ColorPicker="ColorPicker",o.FontSizeDropdown="FontSizeDropdown",o.AlignDropdown="AlignDropdown",o.HeadingDropdown="HeadingDropdown",o.FontFamilyDropdown="FontFamilyDropdown",o),c="0",u={};class p{constructor(e){this.deltas=e,this.deltas=e}}var m=((i={}).DID_PASTE="didPaste",i.RESIZE="resize",i.RECT_CHANGE="rectchange",i.SELECTION_CHANGE="selectionchange",i.SELECTION_CHANGE_AND_DOM_UPDATE="editorUpdateDomSelection",i.CONTENT_WILL_CHANGE="contentWillChange",i.CONTENT_CHANGE="contentchange",i.EDITABLE_CHANGE="editablechange",i.PAINT="paint",i.COPY="copy",i.CUT="cut",i.PASTE="paste",i.WILL_DELETE_FROM_CUT="willDeleteFromCut",i.INPUT="input",i.BEFORE_INPUT="beforeinput",i.KEYDOWN="keydown",i.KEYPRESS="keypress",i.KEYUP="keyup",i.EXEC_COMMAND="execCommand",i.ERROR="error",i.DELETE_KEY="keyDelete",i.FOCUS="focus",i.BLUR="blur",i.SCROLL_END="scrollend",i.SCROLL="scroll",i.KEYBAORDCHANGE="keyboardchange",i.COMPOSITION_END="compositionend",i.COMPOSITION_START="compositionstart",i.COMPOSITION_UPDATE="compositionupdate",i.REACT_CONTEXT_UPDATE="reactContextUpdate",i.BEFORE_DOM_RENDERER_RECONCILE="beforeDomRendererReconcile",i.AFTER_DOM_RENDERER_RECONCILE="afterDomRendererReconcile",i.UNDO_DID_INIT="undoDidInit",i),v=e=>e,_=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],{markdown:e.insert,images:[],links:[],mentions:[],codeblocks:[]}},f=e=>{var{editor:t}=e;return{content:t.getText(),images:[],links:[]}},h=e=>{var t,r,n;return{0:{zoneType:null===(t=e[0])||void 0===t?void 0:t.zoneType,zoneId:null===(r=e[0])||void 0===r?void 0:r.zoneId,ops:null===(n=e[0])||void 0===n?void 0:n.ops}}},x=()=>null,g=()=>null;class y{}var b=(0,a.lazy)(()=>r.e("9258").then(r.bind(r,172374)).then(e=>({default:e.EditorInput}))),j=(0,a.lazy)(()=>r.e("9258").then(r.bind(r,172374)).then(e=>({default:e.EditorFullInputInner})))},753015:function(e,t,r){r.d(t,{c:()=>G});var n=r("808549"),o=r("120454"),i=r("151064"),l=r("455069"),a=r("227048"),s=r("825955"),d=r("252237"),c=r.n(d),u=r("887874"),p=r("919658"),m=r("674343"),v=r("707107"),_=r("382534"),f=r("539227"),h=r("944881"),x=r("936381"),g=r("336205"),y=(0,l.createContext)(null),b=y.Provider,j=()=>(0,l.useContext)(y),w=e=>{var{initCount:t,disabled:r,rows:a}=e,[s,d]=(0,l.useState)(t||0),c=e=>{d(e.length)};(0,l.useEffect)(()=>{d(t||0)},[t]);var u=(0,i.jsx)("div",{className:"overflow-hidden coz-fg-secondary text-sm pr-[9px]",children:"".concat(s,"/").concat(e.maxCount)});return r?(0,i.jsx)(C,(0,n._)({},e)):a&&a>1?(0,i.jsx)(m.ld,(0,o._)((0,n._)({},e),{autosize:!0,autoComplete:"off",onChange:e=>c(e)})):(0,i.jsx)(m.yt,(0,o._)((0,n._)({},e),{autoComplete:"off",suffix:u,onChange:e=>c(e)}))},C=(0,m.Q2)(e=>{var{value:t}=e;return(0,i.jsx)("div",{className:"w-full",children:(0,i.jsx)("div",{className:"coz-fg-secondary text-base break-all whitespace-pre-line",children:t})})},{valueKey:"value",onKeyChangeFnName:"onChange"}),k=r("915757"),N=e=>{var{canEdit:t,onEditIconClick:r,mode:n}=e;return"info"===n&&t?(0,i.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,i.jsx)("span",{children:g.o.t("prompt_detail_prompt_detail")}),(0,i.jsxs)("div",{className:"flex items-center ",children:[(0,i.jsx)(m.u,{content:g.o.t("prompt_library_edit"),children:(0,i.jsx)(m.hU,{color:"secondary",icon:(0,i.jsx)(k.JAz,{className:"semi-icon-default"}),onClick:r,size:"small"})}),(0,i.jsx)(m.iz,{layout:"vertical",className:"mx-[10px] coz-stroke-primary"})]})]}):"create"===n?(0,i.jsx)(i.Fragment,{children:g.o.t("creat_new_prompt")}):"edit"===n?(0,i.jsx)(i.Fragment,{children:g.o.t("edit_prompt")}):(0,i.jsx)(i.Fragment,{children:g.o.t("prompt_detail_prompt_detail")})},S=e=>{var{onCancel:t}=e;return(0,i.jsx)(m.zx,{color:"primary",onClick:t,children:g.o.t("Cancel")})},E=e=>{var{mode:t,isSubmitting:r,onSubmit:n}=e;return(0,i.jsx)(m.zx,{loading:r,onClick:n,children:"info"===t?g.o.t("prompt_detail_copy_prompt"):g.o.t("Confirm")})},T=e=>{var t,{mode:r,editor:n,spaceId:o,botId:l,projectId:a,workflowId:d,source:c,submitFun:u,editId:p,onDiff:_,onCancel:f}=e;if("info"===r)return(0,i.jsx)(m.zx,{color:"primary",onClick:e=>{var t;if(!!p)null==_||_({prompt:null!==(t=null==n?void 0:n.getValue())&&void 0!==t?t:"",libraryId:p}),(0,v.Gg)(v.Kg.compare_mode_front,{source:c,space_id:o,action:"start",compare_type:"prompts",bot_id:l,from:"prompt_resource",project_id:a,workflow_id:d}),null==f||f(e)},children:g.o.t("compare_prompt_compare_debug")});return(0,i.jsx)(m.zx,{color:"primary",onClick:(t=(0,s._)(function*(e){var t,r=yield null==u?void 0:u(e);(null==r?void 0:r.id)&&(null==_||_({prompt:null!==(t=null==n?void 0:n.getValue())&&void 0!==t?t:"",libraryId:r.id}),(0,v.Gg)(v.Kg.compare_mode_front,{source:c,space_id:o,action:"start",compare_type:"prompts",bot_id:l,from:"prompt_resource",project_id:a,workflow_id:d})),null==f||f(e)}),function(e){return t.apply(this,arguments)}),children:g.o.t("creat_prompt_button_comfirm_and_compare")})},I=r("625218"),P=[],A=(0,l.lazy)(()=>r.e("3785").then(r.bind(r,20311))),D=e=>{var t,r,{mode:d,editId:y,spaceId:j,botId:C,projectId:k,workflowId:D,canEdit:L,onUpdateSuccess:O,promptSectionConfig:Z,enableDiff:F,onDiff:M,defaultPrompt:z,source:R,containerAppendSlot:B}=e,V=(0,l.useRef)(null),U=(0,u.jE)(),[H,W]=(0,l.useState)(d),[G,K]=(0,l.useState)(""),J=(0,l.useRef)(!1),[q,$]=(0,l.useState)(!1),X=(0,l.useRef)(!1),Y="info"===H,{editorPlaceholder:Q,editorActions:ee,headerActions:et,editorActiveLinePlaceholder:er,editorExtensions:en}=null!=Z?Z:{},[eo,ei]=(0,l.useState)({name:"",description:"",prompt_text:""});var el=(t=(0,s._)(function*(e){if(!J.current&&!!(yield null===(t=V.current)||void 0===t?void 0:t.validate())){if(J.current=!0,"info"===H){ea();return}if("create"===H||"edit"===H){var t,r,n=yield es(e);return J.current=!1,(0,v.Gg)(v.Kg.prompt_library_front,{bot_id:C,project_id:k,workflow_id:D,space_id:j,prompt_id:null!==(r=null==n?void 0:n.id)&&void 0!==r?r:"",prompt_type:"workspace",action:d,source:R}),n}J.current=!1}}),function(e){return t.apply(this,arguments)}),ea=()=>{var e=null==U?void 0:U.getValue();navigator.clipboard.writeText(null!=e?e:""),m.FN.success(g.o.t("prompt_library_prompt_copied_successfully"))};var es=(r=(0,s._)(function*(t){try{var r,i,l,a=yield null===(r=V.current)||void 0===r?void 0:r.validate();if(!a)return;var s=yield _.pr.UpsertPromptResource({prompt:(0,n._)((0,o._)((0,n._)({},a),{space_id:j}),"edit"===H&&{id:y})},{__disableErrorToast:!0});null===(i=e.onCancel)||void 0===i||i.call(e,t);var c="edit"===H?y:null==s?void 0:null===(l=s.data)||void 0===l?void 0:l.id;if("create"===d&&m.FN.success(g.o.t("prompt_library_prompt_creat_successfully")),null==O||O(d,c),!c)return;return{mode:d,id:c}}catch(e){K(e.message)}}),function(e){return r.apply(this,arguments)});return(0,l.useEffect)(()=>{if(!!z&&!!U)null==U||U.$view.dispatch({changes:{from:0,to:U.$view.state.doc.length,insert:z}})},[z,U]),(0,l.useEffect)(()=>{if(!!y&&!!U)_.pr.GetPromptResourceInfo({prompt_resource_id:y}).then(e=>{var t,{data:{name:r="",description:n="",prompt_text:o=""}={}}=e;null===(t=V.current)||void 0===t||t.setValues({prompt_text:o,name:r,description:n}),null==U||U.$view.dispatch({changes:{from:0,to:U.$view.state.doc.length,insert:o}}),ei({name:r,description:n,prompt_text:o})})},[y,H,U]),(0,i.jsxs)(b,{value:{props:e,formApiRef:V,isReadOnly:Y},children:[(0,i.jsx)(m.u_,{title:(0,i.jsx)(N,{canEdit:!!L,mode:H,onEditIconClick:()=>{W("edit")}}),closeOnEsc:!1,maskClosable:!1,visible:!0,width:"640px",footer:(0,i.jsxs)("div",{className:"flex items-center justify-end",children:[F?(0,i.jsx)(T,{spaceId:j,botId:C,projectId:k,workflowId:D,source:R,mode:H,editor:U,submitFun:el,editId:y,onDiff:e=>{var{prompt:t,libraryId:r}=e;null==M||M({prompt:t,libraryId:r})},onCancel:t=>{var r;null===(r=e.onCancel)||void 0===r||r.call(e,t)}}):(0,i.jsx)(S,{onCancel:e.onCancel}),(0,i.jsx)(E,{mode:H,isSubmitting:J.current,onSubmit:el})]}),onCancel:e.onCancel,className:I.Z["prompt-configurator-modal"],children:(0,i.jsx)("div",{className:"flex flex-col gap-4",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)(m.l0,{getFormApi:e=>{V.current=e},children:[(0,i.jsx)(w,{disabled:"info"===H,label:g.o.t("creat_new_prompt_prompt_name"),placeholder:g.o.t("creat_new_prompt_name_placeholder"),maxLength:20,maxCount:20,initCount:eo.name.length,rows:1,rules:[{required:!Y,message:g.o.t("creat_new_prompt_name_placeholder")}],field:"name"}),(0,i.jsx)(w,{disabled:"info"===H,label:g.o.t("creat_new_prompt_prompt_description"),placeholder:g.o.t("creat_new_prompt_des_placeholder"),maxLength:50,maxCount:50,initCount:eo.description.length,rows:1,field:"description"}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)(m.l0.Label,{text:g.o.t("creat_new_prompt_prompt"),className:"mb-0"}),et]}),(0,i.jsxs)("div",{className:c()("rounded-lg border border-solid coz-stroke-plus h-[400px] overflow-y-auto styled-scrollbar hover-show-scrollbar"),children:[(0,i.jsx)(a.gv,{readonly:"info"===H,options:{minHeight:300},onChange:e=>{var t;null===(t=V.current)||void 0===t||t.setValue("prompt_text",e)}}),(0,i.jsx)(h.Vv,{mode:"configurable",onSelectionInInputSlot:e=>{X.current=!!e}}),(0,i.jsx)(f.jy,{librarys:P,readonly:!0,spaceId:j}),(0,i.jsx)(x.ol,{trigger:"custom",visible:q,onVisibleChange:e=>{if(!X.current)$(e)},children:ee}),(0,i.jsx)(p.Vm,{children:Q}),(0,i.jsx)(p.GH,{children:er}),en]})]})]}),G?(0,i.jsx)("div",{className:"text-red",children:(0,i.jsx)(l.Suspense,{fallback:null,children:(0,i.jsx)(A,{skipHtml:!0,linkTarget:"_blank",children:G})})}):null]})})}),B]})},L=e=>{var{CustomPromptConfiguratorModal:t=D}=e,[r,s]=(0,l.useState)(!1),[d,c]=(0,l.useState)({mode:"create",editId:"",canEdit:!0,defaultPrompt:""}),u=()=>{s(!1)};return{node:r?(0,i.jsx)(a.hT,{children:(0,i.jsx)(t,(0,o._)((0,n._)({},e,d),{onCancel:u}))}):null,close:u,open:e=>{s(!0),c(e)}}},O=()=>{var e=(0,u.jE)(),{props:t,formApiRef:r}=j()||{},{importPromptWhenEmpty:n}=t||{};return n?(0,i.jsx)("div",{className:"coz-fg-hglt text-sm cursor-pointer mt-1",onClick:()=>{var t;null==e||e.$view.dispatch({changes:{from:0,to:e.$view.state.doc.length,insert:n}}),null==r||null===(t=r.current)||void 0===t||t.setValue("prompt_text",n)},children:g.o.t("creat_new_prompt_import_link")}):null},Z=r("749518"),F=r("99285"),M=r("249294"),z=r("411534"),R=r("384313");r("497013");var B=r("249869"),V=e=>{var{className:t,disabled:r}=e,n=(0,u.jE)(),o=(0,z.j)(),a=(0,u.G6)(),[s,d]=(0,Z.Z)(U,{defaultValue:!0});return(0,l.useLayoutEffect)(()=>a.inject([M.$f.of([{key:"Cmd-k",run:()=>!!n&&!o&&!r&&((0,F._i)(n),!1)}])]),[a,n,o,r]),(0,i.jsx)("div",{className:"hover:coz-mg-secondary-hovered coz-icon-button coz-icon-button-default rounded-little",children:(0,i.jsx)(H,{showActionGuide:!!s,children:(0,i.jsx)(m.zx,{color:"primary",size:"small",disabled:o||r,icon:(0,i.jsx)(k.Ga9,{}),className:t,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:e=>{if(e.preventDefault(),e.stopPropagation(),!!n&&!o)d(!1),(0,F._i)(n)},children:g.o.t("creat_new_prompt_edit_block")})})})},U="insert_input_slot_tooltip_guide",H=e=>{var{showActionGuide:t,children:r}=e;return t?(0,i.jsx)(m.u,{content:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("img",{className:"w-full h-auto",src:R}),(0,i.jsxs)("div",{className:"flex flex-col mt-2 p-2 gap-1",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,i.jsx)("span",{className:"text-xxl font-medium",children:g.o.t("edit_block_guild_title")}),(0,i.jsx)("img",{src:B,className:"w-[33px] h-5"})]}),(0,i.jsx)("div",{className:"text-sm coz-fg-primary",children:g.o.t("edit_block_guild_describe")})]})]}),className:"!w-[301px] !max-w-[301px]",children:r}):(0,i.jsx)(m.u,{content:(0,i.jsx)("div",{className:"coz-fg-primary text-sm",style:{fontFamily:"-apple-system, SF Pro"},children:"⌘ K"}),className:"coz-fg-primary text-sm",children:r})},W=e=>{var{isReadOnly:t}=j()||{},r=(0,h.g7)();return(0,i.jsx)(D,(0,o._)((0,n._)({},e),{promptSectionConfig:{editorPlaceholder:(0,i.jsx)(O,{}),editorActions:(0,i.jsx)(V,{disabled:r}),headerActions:t?null:(0,i.jsx)("div",{className:"flex gap-2",children:(0,i.jsx)("div",{children:(0,i.jsx)(V,{disabled:r})})})}}))},G=e=>L((0,o._)((0,n._)({},e),{CustomPromptConfiguratorModal:W}))},227048:function(e,t,r){r.d(t,{hT:()=>g,jE:()=>l.jE,GH:()=>a.GH,gv:()=>x});var n=r("151064"),o=r("455069"),i=r("871873"),l=r("887874"),a=r("919658"),s=r("665917"),d=r("925623"),c=r("642199"),u=r("249294"),p="lowest",m="lowest",v=function(){var e=(0,l.G6)();return(0,o.useLayoutEffect)(()=>e.inject([c.Cj.whole.of(e=>e.name.startsWith("ATXHeading")?{type:"className",className:"markdown-heading",prec:p}:"Emphasis"===e.name?{type:"className",className:"markdown-emphasis",prec:p}:"StrongEmphasis"===e.name?{type:"className",className:"markdown-strong-emphasis",prec:p}:"ListMark"===e.name||"QuoteMark"===e.name?{type:"className",className:"markdown-mark",prec:p}:void 0),u.tk.theme({".markdown-heading":{color:"#00818C",fontWeight:"500"},".markdown-emphasis":{fontStyle:"italic"},".markdown-strong-emphasis":{fontWeight:"bold"},".markdown-mark":{color:"#4E40E5"}})]),[e]),null},_=function(){var e=(0,l.G6)();return(0,o.useLayoutEffect)(()=>e.inject([c.Cj.whole.of(e=>"JinjaStatement"===e.name||"JinjaRawOpenStatement"===e.name||"JinjaRawCloseStatement"===e.name?{type:"className",className:"jinja-statement",prec:m}:"JinjaStringLiteral"===e.name?{type:"className",className:"jinja-string",prec:m}:"JinjaComment"===e.name?{type:"className",className:"jinja-comment",prec:m}:"JinjaExpression"===e.name?{type:"className",className:"jinja-expression",prec:m}:"JinjaFilterName"===e.name||"JinjaStatementStart"===e.name||"JinjaStatementEnd"===e.name||"JinjaKeyword"===e.name||"JinjaFilterName"===e.name?{type:"className",className:"jinja-statement-keyword",prec:m}:void 0),u.tk.theme({".jinja-statement":{color:"#060709CC"},".jinja-statement-keyword":{color:"#D1009D"},".jinja-string":{color:"#060709CC"},".jinja-comment":{color:"#0607094D"},".jinja-expression":{color:"#4E40E5"}})]),[e]),null};function f(){var e=(0,l.G6)();return(0,o.useLayoutEffect)(()=>e.inject([s.Q$]),[e]),null}var h=u.tk.theme({".cm-content":{color:"rgba(6, 7, 9, 0.80)"},".cm-line":{lineHeight:"24px",paddingLeft:"12px"},".cm-cursor":{height:"20px !important"}}),x=e=>{var{readonly:t,placeholder:r,defaultValue:c,className:u,dataTestID:p,value:m,onChange:x,onFocus:g,onBlur:y,options:b,isControled:j,getEditor:w}=e,C=(0,o.useRef)(null),k=(0,l.jE)();(0,o.useEffect)(()=>{if(!!k&&!!y)return k.$on("blur",y),()=>{k.$off("blur",y)}},[k,y]),(0,o.useEffect)(()=>{if(!!k&&!!g)return k.$on("focus",g),()=>{k.$off("focus",g)}},[k,g]),(0,o.useEffect)(()=>{var e=C.current;if(!!e&&!!j&&!!k){var t=e.getValue();"string"==typeof m&&m!==t&&k.$view.dispatch({changes:{from:0,to:k.$view.state.doc.length,insert:null!=m?m:""}})}},[j,m,k]);var N=(0,o.useCallback)(e=>{"function"==typeof x&&x(e.value)},[x]),S=(0,o.useMemo)(()=>({class:null!=u?u:"","data-testid":null!=p?p:""}),[u,p]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Th,{plugins:s.ZP,defaultValue:c,options:(0,i.Z)({fontSize:14,contentAttributes:S,editable:!t,readOnly:t},b),onChange:N,didMount:e=>{C.current=e,w&&w(e)}}),(0,n.jsx)(a.Vm,{children:r}),(0,n.jsx)(d.G,{themes:[h]}),(0,n.jsx)(f,{}),(0,n.jsx)(v,{}),(0,n.jsx)(_,{})]})},g=e=>{var{children:t}=e;return(0,n.jsx)(l.KU,{children:t})}},411534:function(e,t,r){r.d(t,{j:function(){return i}});var n=r(455069),o=r(887874),i=()=>{var e=(0,o.jE)(),[t,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!!e){r(e.$view.state.readOnly);var t=e=>{e.startState.readOnly!==e.state.readOnly&&r(e.state.readOnly)};return e.$on("viewUpdate",t),()=>{e.$off("viewUpdate",t)}}},[e]),t}},66418:function(e,t,r){r.d(t,{fY:()=>i}),r("411534");var n,o=r("825955");var i=(n=(0,o._)(function*(e){var{editor:t,prompt:r}=e;if(!t)return"";var{state:n}=t.$view,o=0===n.doc.length,i=o?r:"\n".concat(r),l=o?void 0:{anchor:n.doc.length,head:n.doc.length+i.length};t.$view.dispatch({changes:{from:n.doc.length,to:n.doc.length,insert:i},selection:l,scrollIntoView:!0}),yield Promise.resolve();var a=t.$view.state.doc.toString();return t.focus(),a}),function(e){return n.apply(this,arguments)})},219263:function(e,t,r){r.d(t,{d:function(){return n.d}});var n=r(710285)},710285:function(e,t,r){r.d(t,{d:()=>Y});var n,o,i,l=r("808549"),a=r("120454"),s=r("151064"),d=r("455069"),c=r("252237"),u=r.n(c),p=r("887874"),m=r("336205"),v=r("915757"),_=r("674343"),f=r("707107"),h=r("382534"),x=r("539227"),g=r("944881"),y=r("227048"),b=r("753015"),j=r("825955"),w=r("909776");var C=(n=(0,j._)(function*(e){var t,r,n,o,i,l=yield h.Js.LibraryResourceList({space_id:e.spaceId,size:e.size,cursor:e.cursor,name:e.searchWord,search_keys:["full_text"],res_type_filter:[w.b0.Prompt]});return{list:null!==(r=null===(t=l.resource_list)||void 0===t?void 0:t.map(e=>{var t,r,n,o;return{id:null!==(t=e.res_id)&&void 0!==t?t:"",name:null!==(r=e.name)&&void 0!==r?r:"",description:null!==(n=e.desc)&&void 0!==n?n:"",actions:null!==(o=null==e?void 0:e.actions)&&void 0!==o?o:[]}}))&&void 0!==r?r:[],hasMore:null!==(n=l.has_more)&&void 0!==n&&n,cursor:null!==(o=l.cursor)&&void 0!==o?o:"",code:null!==(i=Number(l.code))&&void 0!==i?i:0}}),function(e){return n.apply(this,arguments)});var k=(o=(0,j._)(function*(e){var t,r,n,o=yield h.pr.GetOfficialPromptResourceList({keyword:e.searchWord});return{list:null!==(r=null===(t=o.data)||void 0===t?void 0:t.map(e=>{var t,r,n,o;return{id:null!==(t=e.id)&&void 0!==t?t:"",name:null!==(r=e.name)&&void 0!==r?r:"",description:null!==(n=e.description)&&void 0!==n?n:"",promptText:null!==(o=e.prompt_text)&&void 0!==o?o:""}}))&&void 0!==r?r:[],hasMore:!1,cursor:"0",code:null!==(n=Number(o.code))&&void 0!==n?n:0}}),function(e){return o.apply(this,arguments)}),N=e=>"Team"===e.category?C(e):k(e),S=r("666077");var E=((i={})[i.Copy=1]="Copy",i[i.Delete=2]="Delete",i[i.EnableSwitch=3]="EnableSwitch",i[i.Edit=4]="Edit",i[i.SwitchToFuncflow=8]="SwitchToFuncflow",i[i.SwitchToChatflow=9]="SwitchToChatflow",i[i.CrossSpaceCopy=10]="CrossSpaceCopy",i),{Text:T}=_.ZT,I={[E.Delete]:m.o.t("Delete"),[E.Edit]:m.o.t("Edit")},P=e=>{var t,{id:r,title:n,description:o,actions:i,isSelected:l,onActive:a,onDeleteAction:c,onEditAction:p}=e,[m,f]=(0,d.useState)(!1),h=e=>{if(e===E.Delete){null==c||c(r);return}e===E.Edit&&(null==p||p(r))};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:u()("w-full flex flex-row justify-between items-center overflow-hidden px-3 h-[64px]","relative",'after:content-[""] after:absolute after:left-0 after:right-0',"after:bottom-0 after:h-[1px] after:coz-mg-primary","hover:coz-mg-secondary-hovered hover:rounded hover:after:hidden","cursor-pointer",{"rounded coz-mg-primary after:hidden":l}),onClick:()=>{null==a||a(r)},onMouseEnter:()=>{f(!0)},onMouseLeave:()=>{f(!1)},children:[(0,s.jsxs)("div",{className:"flex flex-1 min-w-[0px] w-0 flex-col gap-[2px]",children:[(0,s.jsx)(T,{className:"text-lg flex-1 font-medium",ellipsis:!0,children:n}),(0,s.jsx)(T,{className:"text-base",ellipsis:{rows:1,showTooltip:{opts:{position:"right"}}},children:o})]}),(0,s.jsx)(_.u,{position:"bottom",className:"!p-1",content:(0,s.jsx)("div",{className:"flex flex-col gap-[2px] w-[120px]",children:null==i?void 0:null===(t=i.filter(e=>e.enable))||void 0===t?void 0:t.filter(e=>e.key in I).map(e=>(0,s.jsx)("div",{onClick:()=>h(e.key),className:"w-full text-sm h-[32px] p-2 flex items-center cursor-pointer hover:coz-mg-primary-hovered hover:rounded-mini",children:I[e.key]},e.key))}),children:(0,s.jsx)("div",{className:u()("w-6 h-6 rounded-little coz-mg-secondary-hovered flex items-center justify-center",{hidden:!(null==i?void 0:i.length)||!m}),onClick:e=>e.stopPropagation(),children:(0,s.jsx)(v.NsR,{})})})]})})},A=r("974235"),D=r("537845"),L=r("136515"),O=r("998600"),Z=function(e){var t,r,n,{targetRef:o,loadData:i,threshold:s,reloadDeps:c,isNeedBtnLoadMore:u,resetDataIfReload:p=!0}=e,[m,v]=(0,d.useState)(!1),_=(0,d.useRef)(0),f=(0,d.useRef)();var{loading:h,data:x,loadingMore:g,loadMore:y,noMore:b,cancel:w,mutate:C,reload:k}=(0,A.Z)((t=(0,j._)(function*(e){var t={cursor:"0",list:[]},r=_.current;f.current&&f.current((0,l._)({},t,e||{}));var n=yield new Promise((r,n)=>{f.current=r,i(e||t).then(e=>r(e)).catch(e=>n(e))});return(f.current=null,_.current!==r)?(e&&(e.list=[]),{list:[],cursor:"0"}):n}),function(e){return t.apply(this,arguments)}),{target:m||u?null:o,threshold:s,onBefore:()=>{},isNoMore:e=>(null==e?void 0:e.hasMore)!==void 0&&!(null==e?void 0:e.hasMore),onSuccess:()=>{m&&v(!1)},onError:e=>{var t,r;"0"===x.cursor&&(null!==(r=null==x?void 0:null===(t=x.list)||void 0===t?void 0:t.length)&&void 0!==r?r:0)>0&&C((0,a._)((0,l._)({},x),{list:[]})),v(!0)}});var{insertData:N,removeData:S,getDataList:E}=(r=x,n=C,{insertData:(e,t)=>{r.list.splice(t,0,e),n((0,a._)((0,l._)({},r),{list:[...r.list]}))},removeData:e=>{r.list.splice(e,1),n((0,a._)((0,l._)({},r),{list:[...r.list]}))},getDataList:()=>null==r?void 0:r.list});(0,d.useEffect)(()=>{u&&!(h||g)&&k()},[]);var T=(0,D.Z)(()=>{C({list:p?[]:x.list,hasMore:void 0,cursor:"0"}),w(),v(!1),k()});(0,L.Z)(()=>{_.current++,T()},[...c||[]]);var I=h||g||e.isLoading,{run:P}=(0,O.Z)(()=>{if(!I)!u&&y()},{wait:500});(0,d.useEffect)(()=>{var e=()=>{P()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);var{list:Z}=x||{};return{dataList:Z,isLoading:I,loadMore:()=>{!I&&y()},reload:T,noMore:b,cancel:w,isLoadingError:m,mutate:C,insertData:N,removeData:S,getDataList:E}},F=r("914805"),M=function(e){var{isLoading:t,loadRetry:r,isError:n,renderFooter:o,isNeedBtnLoadMore:i,noMore:l}=e;return(0,s.jsx)("div",{className:u()(F.Z["footer-container"],"empty:hidden"),children:(null==o?void 0:o(e))||(t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.yC,{}),(0,s.jsx)("span",{className:F.Z.loading,children:m.o.t("Loading")})]}):n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.yC,{}),(0,s.jsx)("span",{className:F.Z["error-retry"],onClick:r,children:m.o.t("inifinit_list_retry")})]}):i&&!l?(0,s.jsx)(_.zx,{onClick:r,className:F.Z["load-more-btn"],theme:"borderless",children:m.o.t("mkpl_load_btn")}):null)})},z=function(e){var{isLoading:t,loadRetry:r,isError:n,renderEmpty:o,text:i,btn:l,icon:a,className:d,size:c}=e;return(0,s.jsx)("div",{className:F.Z["height-whole-100"],children:(null==o?void 0:o(e))||(n?(0,s.jsx)("div",{className:d,children:(0,s.jsx)(_.ub,{className:F.Z["load-fail"],title:m.o.t("inifinit_list_load_fail"),icon:(0,s.jsx)(v.UoC,{}),buttonText:r&&m.o.t("inifinit_list_retry"),onButtonClick:()=>{null==r||r()}})}):t?(0,s.jsx)(_.yC,{tip:(0,s.jsx)("span",{className:F.Z["loading-text"],children:m.o.t("Loading")}),wrapperClassName:F.Z.spin,size:"middle"}):(0,s.jsx)("div",{className:d,children:(0,s.jsx)(_.ub,{title:(null==i?void 0:i.emptyTitle)||m.o.t("inifinit_list_empty_title"),size:c,description:(null==i?void 0:i.emptyDesc)||"",buttonText:null==l?void 0:l.emptyText,buttonProps:null==l?void 0:l.emptyButtonProps,onButtonClick:null==l?void 0:l.emptyClick,icon:a})}))})},R=(0,d.forwardRef)(function(e,t){var{className:r,grid:n,renderItem:o,itemClassName:i,renderFooter:c,scrollConf:p,onChangeState:m,isNeedBtnLoadMore:v=!1,retryFunc:f,containerClassName:h,emptyConf:x}=e,{dataList:g,isLoading:y,loadMore:b,noMore:j,isLoadingError:w,reload:C,getDataList:k}=Z((0,a._)((0,l._)({},p),{isNeedBtnLoadMore:v}));return(0,d.useImperativeHandle)(t,()=>({reload:C,getDataList:k}),[C,k]),(0,d.useEffect)(()=>{null==m||m(!!y,null!=g?g:[])},[g,y]),(0,s.jsx)("div",{className:u()(F.Z["height-whole-100"],h),children:(null==g?void 0:g.length)?(0,s.jsx)(_.aV,{className:r,grid:n,emptyContent:(0,s.jsx)(s.Fragment,{}),dataSource:g,split:!1,renderItem:(e,t)=>(0,s.jsx)(_.aV.Item,{className:"string"==typeof i?i:null==i?void 0:i(e),children:null==o?void 0:o(e,t)}),footer:(0,s.jsx)(M,{isError:w,noMore:j,isLoading:y,loadRetry:f||b,renderFooter:c,isNeedBtnLoadMore:v,dataNum:null==g?void 0:g.length})}):(0,s.jsx)(z,(0,l._)({isError:w,isLoading:y,loadRetry:f||b},x))})}),B=(0,d.forwardRef)((e,t)=>{var{getData:r,onActive:n,searchWord:o,category:i,targetRef:l,size:a,onChangeState:c,onDeleteAction:u,onEditAction:p,spaceId:_,onEmptyClick:f}=e,h=(0,d.useRef)(null),[x,g]=(0,d.useState)([]),[y,b]=(0,d.useState)(!1),[j,w]=(0,d.useState)("");return(0,d.useEffect)(()=>{if(!!x.length&&!y){var e=x[0].id;w(e),null==n||n(e)}},[x,y]),(0,d.useImperativeHandle)(t,()=>{var e,t,r,n;return{reload:null!==(r=null===(e=h.current)||void 0===e?void 0:e.reload)&&void 0!==r?r:()=>void 0,getDataList:null!==(n=null===(t=h.current)||void 0===t?void 0:t.getDataList)&&void 0!==n?n:()=>[]}},[]),(0,s.jsx)(R,{ref:h,isNeedBtnLoadMore:!1,onChangeState:(e,t)=>{null==c||c(e,t),g(t),b(e)},renderItem:e=>(0,s.jsx)(P,{id:e.id,title:e.name,description:e.description,actions:e.actions,isSelected:j===e.id,onActive:e=>{null==n||n(e),w(e)},onEditAction:e=>{null==p||p(e)},onDeleteAction:e=>{null==u||u(e)}},e.id),scrollConf:{reloadDeps:[o,i],targetRef:l,loadData:e=>{var t;return r({cursor:null!==(t=null==e?void 0:e.cursor)&&void 0!==t?t:"0",searchWord:null!=o?o:"",category:i,spaceId:_,size:a})}},emptyConf:{className:"flex flex-col items-center justify-center h-full",icon:(0,s.jsx)("img",{src:S.Z,alt:"empty-library"}),size:"full_screen",text:{emptyTitle:m.o.t("prompt_library_empty_title"),emptyDesc:m.o.t("prompt_library_empty_describe")},btn:{emptyText:m.o.t("prompt_library_new_prompt"),emptyButtonProps:{type:"primary",className:"!coz-mg-hglt !coz-fg-hglt hover:!coz-mg-hglt-hovered active:!coz-mg-hglt-pressed",icon:(0,s.jsx)(v.PwN,{}),onClick:()=>{null==f||f()}}}}})}),V=r("626389"),U=r.n(V),H=e=>{var{editor:t,onCopyPrompt:r}=e;return(0,s.jsx)(_.zx,{color:"primary",onClick:()=>{var e=null==t?void 0:t.$view.state.doc.toString();U()(e,{format:"text/plain"})&&_.FN.success(m.o.t("prompt_library_prompt_copied_successfully")),null==r||r()},children:m.o.t("prompt_detail_copy_prompt")})},W=r("66418"),G=e=>{var t,{outerEditor:r,prompt:n,onInsertPrompt:o,onCancel:i}=e;return(0,s.jsx)(_.zx,{disabled:!n,onClick:(t=(0,j._)(function*(e){o((yield(0,W.fY)({editor:r,prompt:n}))),null==i||i(e)}),function(e){return t.apply(this,arguments)}),children:m.o.t("prompt_resource_insert_prompt")})},K=e=>{var{onDiff:t}=e;return(0,s.jsx)(_.zx,{color:"primary",onClick:()=>{null==t||t()},children:m.o.t("compare_prompt_compare_debug")})};r("416238");var J=e=>(0,s.jsx)("div",{className:e.className,children:(0,s.jsx)(_.ub,{title:m.o.t("prompt_library_prompt_empty"),icon:(0,s.jsx)(v.nL$,{})})});r("796106");var q=r("240415"),$=e=>({Recommended:m.o.t("prompt_resource_recommended"),Team:e?m.o.t("prompt_resource_personal"):m.o.t("prompt_resource_team")}),X=e=>{var{spaceId:t,onCancel:r,defaultActiveTab:n="Recommended",getConversationId:o,getPromptContextInfo:i,editor:l,source:a,tabs:c=["Recommended","Team"],botId:j,projectId:w,workflowId:C,isPersonal:k=!1,importPromptWhenEmpty:S,enableDiff:E=!1,onInsertPrompt:T,onUpdateSuccess:I,onCopyPrompt:P,onDeletePrompt:A,onDiff:D}=e,[L,O]=(0,d.useState)(n),[Z,F]=(0,d.useState)(""),[M,z]=(0,d.useState)(!1),[R,V]=(0,d.useState)([]),[U,W]=(0,d.useState)(""),[X,Y]=(0,d.useState)(void 0),Q=(0,d.useRef)(null),ee=(0,d.useRef)(null),et=(0,p.jE)(),er=!M&&0===R.length,{open:en,node:eo}=(0,b.c)({spaceId:t,isPersonal:k,enableDiff:E,getConversationId:o,getPromptContextInfo:i,importPromptWhenEmpty:S,source:a,botId:j,projectId:w,workflowId:C,onDiff:D,onUpdateSuccess:(e,t)=>{var r;c.includes(L)&&O("Team"),null==I||I(e,{id:t||"",category:"Team"}),null===(r=ee.current)||void 0===r||r.reload()}});return(0,d.useEffect)(()=>{if(!!et)et.$view.dispatch({changes:{from:0,to:et.$view.state.doc.length,insert:Z}})},[et,Z]),(0,d.useEffect)(()=>{if(!U||M||!R.length)return;var e=R.find(e=>e.id===U);if(!!e){var{promptText:t}=e;if(t){F(t);return}h.pr.GetPromptResourceInfo({prompt_resource_id:U}).then(e=>{var{data:{prompt_text:t}={}}=e;F(null!=t?t:"")})}},[U,R,M]),(0,d.useEffect)(()=>{W(""),F("")},[L,er]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.u_,{title:m.o.t("prompt_library_prompt_library"),visible:!0,className:q.Z["prompt-library-modal"],width:"880px",closeOnEsc:!1,maskClosable:!1,footer:(0,s.jsxs)("div",{className:"flex justify-end",children:[E?(0,s.jsx)(K,{onDiff:()=>{null==D||D({prompt:Z,libraryId:U}),(0,f.Gg)(f.Kg.prompt_library_front,{source:a,prompt_id:U,space_id:t,prompt_type:"workspace",action:"compare",bot_id:j,project_id:w,workflow_id:C}),(0,f.Gg)(f.Kg.compare_mode_front,{source:a,action:"start",compare_type:"prompts",bot_id:j})}}):null,(0,s.jsx)(H,{editor:et,onCopyPrompt:()=>{null==P||P({id:U,category:L}),(0,f.Gg)(f.Kg.prompt_library_front,{source:a,prompt_id:U,space_id:t,prompt_type:"workspace",action:"copy",bot_id:j,project_id:w,workflow_id:C})}}),(0,s.jsx)(G,{outerEditor:l,prompt:Z,onInsertPrompt:e=>{null==T||T(e,{id:U,category:L}),(0,f.Gg)(f.Kg.prompt_library_front,{source:a,prompt_id:U,space_id:t,prompt_type:"workspace",action:"insert",bot_id:j,project_id:w,workflow_id:C})},onCancel:()=>{null==r||r()}})]}),onCancel:r,children:(0,s.jsxs)("div",{className:"flex flex-col gap-5 overflow-hidden h-[620px]",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{className:"flex gap-3 pl-3",children:c.map(e=>(0,s.jsx)("div",{className:u()("coz-fg-secondary text-sm cursor-pointer font-medium",{"!coz-fg-hglt":L===e}),onClick:()=>{O(e)},children:$(k)[e]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(_.ol,{className:"w-[192px]",placeholder:m.o.t("Search"),onSearch:Y}),er?null:(0,s.jsx)(_.zx,{type:"primary",className:"!coz-mg-hglt !coz-fg-hglt hover:!coz-mg-hglt-hovered active:!coz-mg-hglt-pressed",icon:(0,s.jsx)(v.PwN,{}),onClick:()=>{en({mode:"create"})},children:m.o.t("prompt_library_new_prompt")})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 overflow-hidden flex-1",children:[(0,s.jsx)("div",{className:"flex-1 basis-1/3 overflow-y-auto styled-scrollbar hover-show-scrollbar",ref:Q,children:(0,s.jsx)(B,{ref:ee,targetRef:Q,spaceId:t,category:L,size:15,searchWord:X,getData:N,onChangeState:(e,t)=>{z(e),V(t)},onActive:e=>{W(e)},onDeleteAction:e=>{h.pr.DeletePromptResource({prompt_resource_id:e}).then(()=>{var r;null==A||A({id:e,category:"Team"}),(0,f.Gg)(f.Kg.prompt_library_front,{source:a,prompt_id:e,space_id:t,prompt_type:"workspace",action:"delete",bot_id:j,project_id:w,workflow_id:C}),null===(r=ee.current)||void 0===r||r.reload()})},onEditAction:e=>{en({mode:"edit",editId:e})},onEmptyClick:()=>{en({mode:"create"})}})}),(0,s.jsx)("div",{className:"flex-1 basis-2/3 coz-bg-max rounded-normal border-solid coz-stroke-primary border-[0.5px] p-2 empty:hidden overflow-y-auto styled-scrollbar hover-show-scrollbar",children:er?null:(0,s.jsx)(s.Fragment,{children:Z?(0,s.jsxs)("div",{className:"relative ",children:[(0,s.jsx)(y.gv,{defaultValue:Z,readonly:!0}),(0,s.jsx)(g.Vv,{mode:"input"}),(0,s.jsx)(x.jy,{librarys:[],readonly:!0,spaceId:t})]}):(0,s.jsx)(J,{className:"flex justify-center items-center h-full w-full"})})})]})]})}),eo]})},Y=e=>{var[t,r]=(0,d.useState)(!1),[n,o]=(0,d.useState)({}),i=()=>{r(!1)};return{node:t?(0,s.jsx)(y.hT,{children:(0,s.jsx)(X,(0,a._)((0,l._)({},e,n),{onCancel:i}))}):null,close:i,open:e=>{r(!0),o(null!=e?e:{})}}}},202682:function(e,t,r){r.d(t,{u:()=>M});var n=r("151064"),o=r("455069"),i=r("252237"),l=r.n(i),a=r("887874"),s=r("674343"),d=r("382534"),c=r("925623"),u=r("539227"),p=r("944881"),m=r("227048"),v=r("336205"),_=r("249294");r("796106");var f=e=>{var{id:t,title:r,description:i,prompt:a,onInsertPrompt:c,spaceId:u,className:p,position:v}=e,[_,f]=(0,o.useState)(null!=a?a:""),[x,g]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!a)d.pr.GetPromptResourceInfo({prompt_resource_id:t}).then(e=>{var{data:{prompt_text:t}={}}=e;f(null!=t?t:"")})},[a,t]),(0,n.jsx)(m.hT,{children:(0,n.jsx)(s.J2,{position:v,visible:x,onVisibleChange:g,trigger:"hover",className:"rounded",showArrow:!0,autoAdjustOverflow:!0,content:x?(0,n.jsx)(h,{prompt:_,title:r,spaceId:u,onInsertPrompt:e=>{null==c||c(e),g(!1)}}):null,children:(0,n.jsxs)("div",{className:l()("flex flex-col flex-shrink-0 flex-nowrap gap-1 px-3 py-2 relative","aspect-[180/120] overflow-hidden","rounded-lg border coz-stroke-primary coz-bg-max cursor-pointer","coz-stroke-primary border-[0.5px] border-solid","hover:coz-mg-secondary-hovered",p),children:[(0,n.jsx)(s.ZT.Text,{className:"font-medium text-lg",ellipsis:{rows:1},children:r}),(0,n.jsx)(s.ZT.Text,{className:"text-base",ellipsis:{rows:3},children:null!=i?i:null==a?void 0:a.slice(0,50)})]})},t)})},h=e=>{var{prompt:t="",title:r,spaceId:i,onInsertPrompt:l}=e,d=(0,a.jE)();return(0,o.useEffect)(()=>{null==d||d.$view.dispatch({changes:{from:0,to:null==d?void 0:d.$view.state.doc.length,insert:t}})},[d,t]),(0,n.jsxs)("div",{className:"flex flex-col justify-between w-[300px] h-[300px] gap-3",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1 overflow-y-auto styled-scrollbar hover-show-scrollbar",children:[(0,n.jsx)("div",{className:"text-sm font-medium coz-fg-primary",children:r}),(0,n.jsx)(m.gv,{defaultValue:t,readonly:!0}),(0,n.jsx)(p.Vv,{mode:"input"}),(0,n.jsx)(u.jy,{librarys:[],readonly:!0,spaceId:i}),(0,n.jsx)(c.G,{themes:[_.tk.theme({".cm-line":{paddingLeft:"0 !important"}})]})]}),(0,n.jsx)("div",{className:"coz-mg-hglt hover:!coz-mg-hglt-hovered rounded",children:(0,n.jsx)(s.zx,{color:"primary",className:"w-full font-sm font-medium !bg-transparent !coz-fg-hglt ",onClick:()=>{null==l||l(t)},children:v.o.t("prompt_resource_insert_prompt")})})]})},x=e=>{var{onClick:t,className:r}=e;return(0,n.jsx)("div",{onClick:t,className:l()("flex flex-col flex-shrink-0 flex-nowrap gap-1 px-3 py-2 items-center justify-center","aspect-[180/120]","rounded-lg border coz-stroke-primary coz-bg-max cursor-pointer text-sm","coz-stroke-primary border-[0.5px] border-solid","hover:coz-mg-secondary-hovered",r),children:(0,n.jsx)("div",{className:"coz-fg-primary font-medium",children:v.o.t("prompt_resource_view_all")})})},g=r("825955"),y=r("808549"),b=r("120454"),j=r("915757"),w=r("66418"),C=()=>(0,n.jsxs)("div",{className:"flex flex-col flex-shrink-0 flex-nowrap px-3 py-2 aspect-[180/120] rounded-lg border coz-stroke-primary coz-bg-max",children:[(0,n.jsx)(s.Od,{placeholder:(0,n.jsx)(s.Od.Title,{}),className:"mb-3 w-2/3"}),(0,n.jsx)(s.Od,{placeholder:(0,n.jsx)(s.Od.Paragraph,{rows:3}),className:"w-full"})]}),k=r("735114"),N=r("909776"),S=()=>{var{runAsync:e,loading:t,data:r}=E(),{runAsync:n,loading:o,data:i}=T();return{loading:t||o,data:{Recommended:null!=r?r:[],Team:null!=i?i:[]},runAsync:(t,r)=>"Recommended"===t?e({size:r.size}):"Team"===t?n(r):void 0}},E=()=>{var e,t=(0,o.useRef)(),[r,n]=(0,o.useState)(),{runAsync:i,loading:l}=(0,k.Z)(()=>d.pr.GetOfficialPromptResourceList(),{manual:!0,onSuccess:e=>{var r;return n(t.current?null===(r=e.data)||void 0===r?void 0:r.slice(0,t.current):e.data),e}});var a=(e=(0,g._)(function*(e){return t.current=e.size,i()}),function(t){return e.apply(this,arguments)});return{data:null==r?void 0:r.map(e=>{var{id:t="",name:r="",description:n="",prompt_text:o=""}=e;return{id:t,name:r,description:n,promptText:o}}),runAsync:a,loading:l}},T=()=>{var e,{data:t,runAsync:r,loading:n}=(0,k.Z)(e=>d.Js.LibraryResourceList((0,b._)((0,y._)({},e),{res_type_filter:[N.b0.Prompt]})),{manual:!0});return{data:null==t?void 0:null===(e=t.resource_list)||void 0===e?void 0:e.map(e=>{var{res_id:t="",name:r="",desc:n=""}=e;return{id:t,name:r,description:n}}),runAsync:r,loading:n}},I=e=>{var{activeTab:t,tabs:r,loading:n,data:i}=e,l=(0,o.useRef)([]),[a,s]=(0,o.useState)(!1),[d,c]=(0,o.useState)(!1),u=e=>r.indexOf(e),p=e=>{var t=l.current[e];if(t){var{scrollLeft:r,scrollWidth:n,clientWidth:o}=t;s(r>0),c(r<n-o-10)}};return(0,o.useEffect)(()=>{var e=()=>p(u(t));return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),(0,o.useEffect)(()=>{!n&&(null==i?void 0:i[t])&&setTimeout(()=>p(u(t)),0)},[n,i,t]),(0,o.useEffect)(()=>{var e=l.current[u(t)];if(!!e){var r=()=>p(u(t));return e.addEventListener("scroll",r),p(u(t)),()=>e.removeEventListener("scroll",r)}},[i,t]),{scrollRefs:l,canScrollLeft:a,canScrollRight:d,handleScroll:e=>{var r=u(t);if(l.current[r]){var n=l.current[r].scrollLeft+("left"===e?-300:300);l.current[r].scrollTo({left:n,behavior:"smooth"})}}}},P=r("710285"),A=()=>(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)(s.ub,{title:v.o.t("prompt_library_empty_title"),icon:(0,n.jsx)(j.nL$,{}),style:{maxWidth:"300px"}})}),D=r("125166"),L=e=>{var{handleScroll:t}=e;return(0,n.jsx)("div",{className:"absolute bottom-0 left-0 top-0 w-8 z-10",style:{background:"linear-gradient(90deg, #F9F9F9 0%, rgba(249, 249, 249, 0.00) 100%)"},children:(0,n.jsx)("div",{onClick:t,className:"w-6 h-6 coz-bg-max flex justify-center items-center absolute left-0 top-1/2 -translate-y-1/2 z-20 cursor-pointer rounded-lg coz-stroke-primary coz-shadow-small",children:(0,n.jsx)(j.tWI,{className:"w-4 h-4"})})})},O=e=>{var{handleScroll:t}=e;return(0,n.jsx)("div",{className:"absolute bottom-0 right-0 top-0 w-8",style:{background:"linear-gradient(270deg, #F9F9F9 0%, rgba(249, 249, 249, 0.00) 100%)"},children:(0,n.jsx)("div",{onClick:t,className:"w-6 h-6 coz-bg-max flex justify-center items-center absolute right-0 top-1/2 -translate-y-1/2 z-20 cursor-pointer rounded-lg coz-stroke-primary coz-shadow-small",children:(0,n.jsx)(j.wMM,{className:"w-4 h-4"})})})},Z=e=>({Recommended:v.o.t("prompt_resource_recommended"),Team:e?v.o.t("prompt_resource_personal"):v.o.t("prompt_resource_team")}),F=e=>{var t,r,i=(0,o.useRef)(null),{className:d,cardClassName:c,listContainerClassName:u,onInsertPrompt:p,tabs:m,spaceId:_,enableLibrary:h=!1,getConversationId:y,getPromptContextInfo:b,importPromptWhenEmpty:k,source:N,botId:E,projectId:T,workflowId:F,ref:M,isPersonal:z=!1,onCopyPrompt:R,onDeletePrompt:B,onUpdateSuccess:V}=e,[U,H]=(0,o.useState)(m[0]),W=(0,a.jE)();var G=(t=(0,g._)(function*(e,t){var r=yield(0,w.fY)({editor:W,prompt:e});null==p||p(r,{id:t,category:U})}),function(e,r){return t.apply(this,arguments)}),{loading:K,data:J,runAsync:q}=S(),$=!K&&(null==J?void 0:null===(r=J[U])||void 0===r?void 0:r.length)===0,{open:X,node:Y}=(0,P.d)({spaceId:_,getConversationId:y,editor:W,isPersonal:z,source:N,botId:E,projectId:T,workflowId:F,getPromptContextInfo:b,importPromptWhenEmpty:k,onInsertPrompt:p,onUpdateSuccess:(e,t)=>{q(U,{space_id:_,size:6}),null==V||V(e,t)},onCopyPrompt:R,onDeletePrompt:B});(0,o.useEffect)(()=>{if(!!_)q(U,{space_id:_,size:6})},[_,U]);var{scrollRefs:Q,canScrollLeft:ee,canScrollRight:et,handleScroll:er}=I({activeTab:U,tabs:m,loading:K,data:J});return(0,o.useImperativeHandle)(M,()=>({refresh:e=>{q(e,{space_id:_,size:6})}})),(0,n.jsxs)("div",{ref:e=>{"function"==typeof M&&M(null),i.current=e},className:l()(D.Z["recommend-pannel"],"flex flex-col justify-between w-full","absolute bottom-0 left-0 right-0","py-3 px-5",d),children:[(0,n.jsx)(s.mQ,{type:"button",activeKey:U,onChange:e=>H(e),tabBarExtraContent:h?(0,n.jsx)("div",{className:"coz-fg-primary text-sm flex items-center cursor-pointer font-medium",onClick:()=>X({defaultActiveTab:U}),children:(0,n.jsx)(s.zx,{icon:(0,n.jsx)(j.wMM,{className:"!coz-fg-primary"}),color:"secondary",iconPosition:"right",children:(0,n.jsx)("span",{className:"coz-fg-primary",children:v.o.t("workflow_prompt_editor_view_library")})})}):null,children:m.map((e,t)=>{var r;return(0,n.jsxs)(s.Jm,{itemKey:e,tab:Z(z)[e],className:"relative",children:[ee?(0,n.jsx)(L,{handleScroll:()=>er("left")}):null,(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{ref:e=>Q.current[t]=e,className:l()("relative overflow-x-auto styled-scrollbar h-[120px] box-content hover-show-scrollbar","flex-1",u),children:$?(0,n.jsx)(A,{}):(0,n.jsxs)("div",{className:"flex gap-3 flex-row flex-nowrap overflow-visible h-full min-w-min",children:[K?Array.from({length:6}).map((e,t)=>(0,n.jsx)(C,{},t)):null,null==J?void 0:null===(r=J[e])||void 0===r?void 0:r.map((e,t)=>(0,n.jsx)(f,{className:l()(c),id:e.id,position:0===t?"topLeft":"top",spaceId:_,title:e.name,description:e.description,prompt:e.promptText,onInsertPrompt:t=>G(t,e.id)},e.id)),(0,n.jsx)(x,{onClick:()=>X({defaultActiveTab:e})})]})}),et?(0,n.jsx)(O,{handleScroll:()=>er("right")}):null]})]})})}),Y]})},M=(0,o.forwardRef)((e,t)=>(0,n.jsx)(F,(0,b._)((0,y._)({},e),{ref:t})))},734390:function(e,t,r){r.d(t,{iN:()=>ec,WL:()=>ev,vE:()=>G,$r:()=>A,Hm:()=>L,Mj:()=>eh.M,wh:()=>es,c:()=>ek,pw:()=>e_,vC:()=>v,N0:()=>W});var n,o,i=r("151064"),l=r("455069"),a=r("252237"),s=r.n(a),d=r("336205"),c=r("674343"),u=r("44172"),p=r("384174"),m={small:p.Z.small,default:p.Z.default,large:p.Z.large},v=e=>{var{size:t="default",children:r,visible:n,className:o}=e;return(0,i.jsxs)("div",{className:"relative w-fit h-fit",children:[(0,i.jsx)(c.u,{spacing:12,trigger:n?"hover":"custom",content:d.o.t("mkpl_plugin_tooltip_official"),children:n?(0,i.jsx)(u.mQT,{className:s()(p.Z["official-label"],m[t],o)}):null}),r]})},_=r("808549"),f=r("120454"),h=r("100282"),x=r("775699"),g=r("825955"),y=r("974235"),b=r("537845"),j=r("136515"),w=r("998600"),C=function(e){var t,r,n,{targetRef:o,loadData:i,threshold:a,reloadDeps:s,isNeedBtnLoadMore:d,resetDataIfReload:c=!0}=e,[u,p]=(0,l.useState)(!1),m=(0,l.useRef)(0),v=(0,l.useRef)();var{loading:h,data:x,loadingMore:C,loadMore:k,noMore:N,cancel:S,mutate:E,reload:T}=(0,y.Z)((t=(0,g._)(function*(e){var t=m.current;v.current&&v.current((0,f._)((0,_._)({},e||{}),{list:[]}));var r=yield new Promise((t,r)=>{v.current=t,i(e).then(e=>t(e)).catch(e=>r(e))});return(v.current=null,m.current!==t)?(e&&(e.list=[]),{list:[],nextPage:1}):r}),function(e){return t.apply(this,arguments)}),{target:u||d?null:o,threshold:a,onBefore:()=>{},isNoMore:e=>(null==e?void 0:e.hasMore)!==void 0&&!(null==e?void 0:e.hasMore),onSuccess:()=>{u&&p(!1)},onError:e=>{var t,r;1===x.nextPage&&(null!==(r=null==x?void 0:null===(t=x.list)||void 0===t?void 0:t.length)&&void 0!==r?r:0)>0&&E((0,f._)((0,_._)({},x),{list:[]})),p(!0)}});var{insertData:I,removeData:P,getDataList:A}=(r=x,n=E,{insertData:(e,t)=>{r.list.splice(t,0,e),n((0,f._)((0,_._)({},r),{list:[...(null==r?void 0:r.list)||[]]}))},removeData:e=>{r.list.splice(e,1),n((0,f._)((0,_._)({},r),{list:[...(null==r?void 0:r.list)||[]]}))},getDataList:()=>null==r?void 0:r.list});(0,l.useEffect)(()=>{d&&!(h||C)&&T()},[]);var D=(0,b.Z)(()=>{var e;E({list:c?[]:null!==(e=null==x?void 0:x.list)&&void 0!==e?e:[],hasMore:void 0,nextPage:1}),S(),p(!1),T()});(0,j.Z)(()=>{m.current++,D()},[...s||[]]);var L=h||C||e.isLoading,{run:O}=(0,w.Z)(()=>{if(!L)!d&&k()},{wait:500});(0,l.useEffect)(()=>{var e=()=>{O()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);var{list:Z}=x||{};return{dataList:Z,isLoading:L,loadMore:()=>{!L&&k()},reload:D,noMore:N,cancel:S,isLoadingError:u,mutate:E,insertData:I,removeData:P,getDataList:A}},k=r("30961"),N=r("772650"),S=function(e){var{isLoading:t,loadRetry:r,isError:n,renderFooter:o,isNeedBtnLoadMore:l,noMore:a}=e,c=(0,k.Fm)();return(0,i.jsx)("div",{className:s()(N.Z["footer-container"],{[N.Z["responsive-foot-container"]]:c}),children:(null==o?void 0:o(e))||(t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.yC,{}),(0,i.jsx)("span",{className:N.Z.loading,children:d.o.t("Loading")})]}):n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.yC,{}),(0,i.jsx)("span",{className:N.Z["error-retry"],onClick:r,children:d.o.t("inifinit_list_retry")})]}):l&&!a?(0,i.jsx)(x.y3,{onClick:r,className:N.Z["load-more-btn"],theme:"borderless",children:d.o.t("mkpl_load_btn")}):null)})},E=r("763055"),T=r("918966"),I=function(e){var{isLoading:t,isSearching:r,loadRetry:n,isError:o,renderEmpty:l,text:a,btn:s,icon:c}=e;return(0,i.jsx)("div",{className:T.Z.empty,children:(null==l?void 0:l(e))||(o?(0,i.jsx)(x.YZ,{empty:{title:d.o.t("inifinit_list_load_fail"),icon:(0,i.jsx)(E.My,{}),btnText:n&&d.o.t("inifinit_list_retry"),btnOnClick:()=>{null==n||n()}}}):t?(0,i.jsx)(x.yC,{tip:(0,i.jsx)("span",{className:T.Z["loading-text"],children:d.o.t("Loading")}),wrapperClassName:T.Z.spin,size:"middle"}):(0,i.jsx)(x.YZ,{isNotFound:!!r,empty:{title:(null==a?void 0:a.emptyTitle)||d.o.t("inifinit_list_empty_title"),description:(null==a?void 0:a.emptyTitle)?null==a?void 0:a.emptyDesc:"",btnText:null==s?void 0:s.emptyText,btnOnClick:null==s?void 0:s.emptyClick,icon:c},notFound:{title:(null==a?void 0:a.searchEmptyTitle)||d.o.t("inifinit_search_not_found")}}))})},P=r("565922"),A=(0,l.forwardRef)(function(e,t){var{isSearching:r,className:n,emptyContent:o,grid:a,renderItem:d,itemClassName:c,renderFooter:u,scrollConf:p,emptyConf:m,onChangeState:v,canShowData:g=!0,isNeedBtnLoadMore:y=!1,isResponsive:b,retryFunc:j,responsiveConf:w,containerClassName:k}=e,{dataList:N,isLoading:E,loadMore:T,noMore:A,isLoadingError:D,mutate:L,reload:O,insertData:Z,removeData:F,getDataList:M}=C((0,f._)((0,_._)({},p),{isNeedBtnLoadMore:y}));return(0,l.useImperativeHandle)(t,()=>({mutate:L,reload:O,insertData:Z,removeData:F,getDataList:M}),[L,O,Z,F,M]),(0,l.useEffect)(()=>{null==v||v(E,N)},[N,E]),(0,i.jsx)("div",{className:s()(P.Z["height-whole-100"],k),children:(null==N?void 0:N.length)&&g?b?(0,i.jsx)(h.gz,{className:n,emptyContent:E?(0,i.jsx)(i.Fragment,{}):o,dataSource:N,renderItem:(e,t)=>null==d?void 0:d(e,t),gridCols:null==w?void 0:w.gridCols,gridGapXs:{basic:4},footer:(0,i.jsx)("div",{className:"text-sm px-6 py-3",children:(0,i.jsx)(S,{isError:D,noMore:A,isLoading:E,loadRetry:j||T,renderFooter:u,isNeedBtnLoadMore:y})})}):(0,i.jsx)(x.aV,{className:n,emptyContent:o,grid:a,emptyContent:E?(0,i.jsx)(i.Fragment,{}):o,dataSource:N,split:!1,renderItem:(e,t)=>(0,i.jsx)(x.aV.Item,{className:"string"==typeof c?c:null==c?void 0:c(e),children:null==d?void 0:d(e,t)}),footer:(0,i.jsx)(S,{isError:D,noMore:A,isLoading:E,loadRetry:j||T,renderFooter:u,isNeedBtnLoadMore:y,dataNum:null==N?void 0:N.length})}):(0,i.jsx)(I,(0,_._)({isError:!!g&&D,isSearching:r,isLoading:!g||E,loadRetry:j||T},m))})}),D=r("121022"),L=e=>{var{connectors:t,className:r,visibleNum:n=3}=e,o=t.length-n;return(0,i.jsxs)("div",{className:s()("ml-auto flex gap-4px",r),children:[t.slice(0,n).map(e=>(0,i.jsx)(c.u,{content:e.name,theme:"dark",children:(0,i.jsx)(c.EZ,{className:"border coz-stroke-primary border-solid",size:"micro",src:e.icon,type:"platform"})},e.id)),o>0?(0,i.jsx)(c.u,{position:"right",content:(0,i.jsx)("div",{className:"flex flex-col gap-8px max-w-[200px] max-h-[188px] overflow-y-auto overflow-x-hidden",children:t.slice(n).map(e=>(0,i.jsxs)("div",{className:"flex gap-8px items-center max-w-full",children:[(0,i.jsx)(c.EZ,{className:"border coz-stroke-primary border-solid",size:"micro",src:e.icon,type:"platform"}),(0,i.jsx)(c.ZT.Text,{ellipsis:!0,className:"flex-1 overflow-hidden",children:e.name})]},e.id))}),children:(0,i.jsxs)(c.Vp,{className:D.Z.more,size:"mini",color:"primary",children:["+",o]})}):null]})},O=r("382534"),Z=r("664679"),F=e=>{var t,{productId:r,entityType:n,entityId:o,topicId:i,onChange:l,setIsFavorite:a}=e;return{changeFavoriteStatus:(0,b.Z)((t=(0,g._)(function*(e,t){a(!e);try{yield O.yF.PublicFavoriteProduct({product_id:r||void 0,entity_type:n,is_cancel:e,entity_id:o,topic_id:i}),null==l||l(e?-1:1),Z.k.emit("refreshFavList",{id:o,numDelta:"add"===t?1:-1,emitPosition:"favorite-icon-btn"})}catch(t){a(e)}}),function(e,r){return t.apply(this,arguments)}))}},M=e=>{var{isVisible:t}=e,[r,n]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{!t&&n(!1)},[t]),{isShowAni:r,changeAnimationStatus:(0,b.Z)(e=>{e?n(!1):n(!0)})}},z=e=>e?"cancel":"add",R=e=>{var t,r,{isFavoriteDefault:n,onReportTea:o,productId:i,entityId:a,entityType:s,onChange:d,onClickBefore:c,topicId:u,isVisible:p,onFavoriteStateChange:m}=e,[v,_]=(0,l.useState)(null!=n&&n),{isShowAni:f,changeAnimationStatus:h}=M({isVisible:p}),x=(0,l.useRef)(!1);var y=(0,b.Z)((t=(0,g._)(function*(e,t){return(yield null==c?void 0:c(e,t))!==!1}),function(e,r){return t.apply(this,arguments)})),{changeFavoriteStatus:w}=F({productId:i,entityType:s,entityId:a,topicId:u,onChange:d,setIsFavorite:_});var C=(0,l.useCallback)((r=(0,g._)(function*(e){if(x.current){null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),null==e||null===(r=e.preventDefault)||void 0===r||r.call(e);return}var t,r,n,i=z(v);x.current=!0;try{(yield y(i,e))!==!1&&(null==e||null===(n=e.stopPropagation)||void 0===n||n.call(e),null==o||o(i),h(v),yield w(v,i))}catch(e){console.error("useFavoriteChange:",e)}x.current=!1}),function(e){return r.apply(this,arguments)}),[v,o]);return(0,j.Z)(()=>{null==m||m(v)},[v]),{isFavorite:v,onClick:C,isShowAni:f}},B=e=>{var{isFavorite:t}=e;return(0,i.jsx)(i.Fragment,{children:t?(0,i.jsx)(u.Aj,{}):(0,i.jsx)(u.ubE,{})})},V=r("261008"),U=e=>{var{isFavorite:t,isShowAni:r,className:n,unCollectedIconCls:o,useButton:l}=e,a={className:s()(t?V.Z["icon-filled"]:V.Z["icon-stroked"],t?n:o,{[V.Z["show-ani"]]:t&&r,[V.Z["show-btn"]]:l})},d=t?(0,i.jsx)(u._h$,(0,_._)({},a)):(0,i.jsx)(u.q5R,(0,_._)({},a));return l?(0,i.jsx)(c.hU,{size:"default",color:"primary",icon:d}):d},H=r("420666"),W=(0,l.forwardRef)((e,t)=>{var{topicId:r,productId:n,entityType:o,entityId:a,isFavorite:s,onChange:d,isVisible:c,onReportTea:u,unCollectedIconCls:p,onClickBefore:m,onFavoriteStateChange:v,isMobile:_,className:f,useButton:h=!1,isForbiddenClick:x=!1}=e,{isFavorite:g,onClick:y,isShowAni:b}=R({isFavoriteDefault:s,onReportTea:u,productId:n,entityId:a,entityType:o,onChange:d,onClickBefore:m,topicId:r,isVisible:c,onFavoriteStateChange:v});return((0,l.useImperativeHandle)(t,()=>({favorite:y}),[y]),c)?(0,i.jsx)("div",{onClick:x?void 0:y,className:H.Z["favorite-icon-btn"],"data-testid":"bot-card-favorite-icon",children:_?(0,i.jsx)(B,{isFavorite:g}):(0,i.jsx)(U,{useButton:h,isFavorite:g,isShowAni:b,unCollectedIconCls:p,className:f})}):null});r("546410");var G=e=>{var{icon:t=null,title:r,activeIcon:n=null,isActive:o,suffix:l,onClick:a}=e;return(0,i.jsxs)("div",{onClick:a,className:s()("flex items-center gap-[8px]","transition-colors","rounded-[8px]","h-[32px] w-full","px-[8px]","cursor-pointer","hover:coz-mg-primary-hovered",o?"coz-bg-primary coz-fg-plus":"coz-fg-primary coz-bg-max"),children:[(0,i.jsx)("div",{className:"text-[16px] leading-none leading-none w-[16px] h-[16px]",children:o?n:t}),(0,i.jsx)(c.ZT.Text,{ellipsis:{showTooltip:!0,rows:1},fontSize:"14px",weight:500,className:"flex-1 text-[14px] leading-[20px] font-[500]",children:r}),l]})},K=r("903124"),J=r("721566"),q=r("915757"),$=r("117140"),X={[$._J.BotTemplate]:{icon:(0,i.jsx)(q.Cr5,{}),i18nKey:"template_agent"},[$._J.WorkflowTemplateV2]:{icon:(0,i.jsx)(q.eTH,{}),i18nKey:"template_workflow"},[$._J.ImageflowTemplateV2]:{icon:(0,i.jsx)(q.eTH,{}),i18nKey:"template_workflow"},[$._J.ProjectTemplate]:{icon:(0,i.jsx)(q.wmN,{}),i18nKey:"project_store_search"}},Y={[$._J.BotTemplate]:"primary",[$._J.WorkflowTemplateV2]:"primary",[$._J.ImageflowTemplateV2]:"primary",[$._J.ProjectTemplate]:"brand"},Q=e=>{var t,{type:r}=e,n=X[r];return n?(0,i.jsxs)(c.Vp,{color:null!==(t=Y[r])&&void 0!==t?t:"primary",className:"h-[20px] !px-[4px] !py-[2px] coz-fg-primary font-medium shrink-0",children:[n.icon,(0,i.jsx)("span",{className:"ml-[2px]",children:d.o.t(n.i18nKey)})]}):null},ee=r("474872"),et=e=>{var t,r,n,{title:o,description:l,userInfo:a,renderCardTag:d,descClassName:u,renderDescBottomSlot:p}=e;return(0,i.jsxs)("div",{className:s()("mt-[8px] px-[4px] grow","flex flex-col"),children:[(0,i.jsxs)("div",{className:"flex items-center gap-[8px] overflow-hidden",children:[(0,i.jsx)(c.ZT.Text,{className:"!font-medium text-[16px] leading-[22px] coz-fg-primary !max-w-[180px]",ellipsis:{showTooltip:!0,rows:1},children:o}),null==d?void 0:d()]}),(0,i.jsx)(ee.gj,{className:"mt-[4px]",avatar:null==a?void 0:a.avatar_url,name:null==a?void 0:a.name,username:null==a?void 0:a.user_name,label:{name:null==a?void 0:null===(t=a.user_label)||void 0===t?void 0:t.label_name,icon:null==a?void 0:null===(r=a.user_label)||void 0===r?void 0:r.icon_url,href:null==a?void 0:null===(n=a.user_label)||void 0===n?void 0:n.jump_link}}),(0,i.jsxs)("div",{className:s()("mt-[8px] flex flex-col justify-between grow",u),children:[(0,i.jsx)(c.ZT.Text,{className:"min-h-[40px] leading-[20px] coz-fg-secondary",ellipsis:{showTooltip:!0,rows:2},children:l}),null==p?void 0:p()]})]})},er=r("872457"),en=e=>{var{className:t,children:r,onClick:n,shadowMode:o}=e;return(0,i.jsx)("div",{className:s()("coz-bg-max",er.Z.container,er.Z.width100,t,er.Z["shadow-".concat(o)]),onClick:n,children:r})},eo=e=>(0,i.jsx)("div",{className:s()("coz-mg-primary",er.Z.container,er.Z.width100,er.Z.skeleton,e.className),children:null==e?void 0:e.children}),ei=r("207265"),el=e=>{var{className:t,onClick:r,children:n}=e;return(0,i.jsx)("button",{className:s()(ei.Z["card-button"],t),color:"primary",onClick:r,children:n})},ea=r("651242"),es=e=>{var t,r,n,o,a,[s,u]=(0,l.useState)(!1);return(0,i.jsxs)(en,{className:ea.Z.template,shadowMode:"default",children:[(0,i.jsxs)("div",{className:ea.Z["template-wrapper"],children:[(0,i.jsx)(eu,{title:null===(t=e.meta_info)||void 0===t?void 0:t.name,description:null===(r=e.meta_info)||void 0===r?void 0:r.description,userInfo:null===(n=e.meta_info)||void 0===n?void 0:n.user_info,entityType:e.meta_info.entity_type,imgSrc:null===(o=e.meta_info.covers)||void 0===o?void 0:o[0].url}),(0,i.jsx)(c.T,{className:ea.Z["btn-container"],children:(0,i.jsx)(el,{onClick:()=>{u(!0)},className:"w-full",children:d.o.t("copy")})})]}),s?(0,i.jsx)(ed,{productId:e.meta_info.id,entityType:e.meta_info.entity_type,defaultTitle:"".concat(null===(a=e.meta_info)||void 0===a?void 0:a.name,"(").concat(d.o.t("duplicate_rename_copy"),")"),hide:()=>u(!1)}):null]})},ed=e=>{var t,{defaultTitle:r,hide:n,productId:o,entityType:a}=e,[s,u]=(0,l.useState)(r),{spaces:p}=(0,J.B3)(),m=null==p?void 0:null===(t=p[0])||void 0===t?void 0:t.id;return(0,i.jsx)(c.u_,{type:"modal",title:d.o.t("creat_project_use_template"),visible:!0,onOk:(0,g._)(function*(){try{yield K.K.PublicDuplicateProduct({product_id:o,entity_type:a,space_id:m,name:s}),c.FN.success(d.o.t("copy_success")),n()}catch(e){console.error("PublicDuplicateProduct",e),c.FN.error(d.o.t("copy_failed"))}}),onCancel:n,cancelText:d.o.t("Cancel"),okText:d.o.t("Confirm"),children:(0,i.jsxs)(c.T,{vertical:!0,spacing:4,className:"w-full",children:[(0,i.jsxs)(c.T,{className:"w-full",children:[(0,i.jsx)("span",{className:"coz-fg-primary font-medium leading-[20px]",children:d.o.t("creat_project_project_name")}),(0,i.jsx)("span",{className:"coz-fg-hglt-red",children:"*"})]}),(0,i.jsx)(c.II,{className:"w-full",placeholder:"",defaultValue:r,onChange:e=>{u(e)}})]})})},ec=()=>(0,i.jsx)(eo,{className:s()("h-[278px]",ea.Z.template)}),eu=e=>{var{title:t,imgSrc:r,description:n,entityType:o,userInfo:l,renderImageBottomSlot:a,renderDescBottomSlot:s}=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"relative w-full h-[140px] rounded-[8px] overflow-hidden",children:[(0,i.jsx)(c.Ee,{preview:!1,src:r,className:"w-full h-full",imgCls:"w-full h-full object-cover object-center"}),null==a?void 0:a()]}),(0,i.jsx)(et,{title:t,description:n,userInfo:l,renderCardTag:()=>o?(0,i.jsx)(Q,{type:o}):null,descClassName:ea.Z.description,renderDescBottomSlot:s})]})};var ep=((n={})[n.NoAuth=0]="NoAuth",n[n.Required=1]="Required",n[n.Configured=2]="Configured",n[n.Supported=3]="Supported",n),em=r("784636"),ev=e=>(0,i.jsx)(en,{className:s()(em.Z.plugin,e.className),shadowMode:"default",onClick:()=>{var t,r=null==e?void 0:null===(t=e.plugin_extra)||void 0===t?void 0:t.jump_saas_url;r&&window.open(r,"_blank")},children:(0,i.jsxs)("div",{className:em.Z["plugin-wrapper"],children:[(0,i.jsx)(ef,(0,_._)({},e)),(0,i.jsx)(c.T,{className:s()(em.Z["btn-container"],{[em.Z["one-column-grid"]]:e.isInstalled||!e.isShowInstallButton}),children:!e.isInstalled&&e.isShowInstallButton?(0,i.jsx)(el,{onClick:()=>{c.FN.success(d.o.t("plugin_install_success"))},children:d.o.t("plugin_store_install")}):null})]})}),e_=()=>(0,i.jsx)(eo,{className:s()("h-[186px]",em.Z.plugin)}),ef=e=>{var t,r,n,o;return(0,i.jsxs)("div",{children:[(0,i.jsx)(c.qE,{className:em.Z["card-avatar"],src:null===(t=e.meta_info)||void 0===t?void 0:t.icon_url,shape:"square"}),(0,i.jsx)(et,{title:null===(r=e.meta_info)||void 0===r?void 0:r.name,description:null===(n=e.meta_info)||void 0===n?void 0:n.description,userInfo:null===(o=e.meta_info)||void 0===o?void 0:o.user_info,authMode:e.plugin_extra.auth_mode,renderCardTag:()=>e.plugin_extra.auth_mode===ep.Required||e.plugin_extra.auth_mode===ep.Supported?(0,i.jsx)(c.Vp,{color:"yellow",className:"h-[20px] !px-[4px] !py-[2px] coz-fg-primary font-medium shrink-0",children:(0,i.jsx)("span",{className:"ml-[2px]",children:d.o.t("plugin_store_unauthorized")})}):e.plugin_extra.auth_mode===ep.Configured?(0,i.jsx)(c.u,{content:d.o.t("plugin_store_contact_deployer"),children:(0,i.jsx)(c.Vp,{color:"brand",className:"h-[20px] !px-[4px] !py-[2px] coz-fg-primary font-medium shrink-0",children:(0,i.jsx)("span",{className:"ml-[2px]",children:d.o.t("plugin_store_authorized")})})}):null})]})},eh=r("494784"),ex=r("479886"),eg=r.n(ex),ey=r("735114"),eb=r("298203");var ej=((o={})[o.Free=0]="Free",o[o.PremiumLite=10]="PremiumLite",o[o.Premium=15]="Premium",o[o.PremiumPlus=20]="PremiumPlus",o[o.V1ProInstance=100]="V1ProInstance",o[o.ProPersonal=110]="ProPersonal",o[o.Team=120]="Team",o[o.Enterprise=130]="Enterprise",o),ew=e=>{if(null==e)return"-";var t="";return e>=1e4?((t=(e/1e4).toFixed(1)).endsWith(".0")&&(t=t.slice(0,-2)),t="".concat(t,"w")):t=e.toString(),t},eC=e=>{switch(e){case ej.Free:return d.o.t("coze_sidebar_free_ver");case ej.ProPersonal:return d.o.t("export_import_2_agent_flow_15");case ej.Team:return d.o.t("export_import_2_agent_flow_16");case ej.Enterprise:return d.o.t("export_import_2_agent_flow_17");default:return d.o.t("coze_sidebar_free_ver")}},ek=e=>{var t,r,n,o,a,s,d,u,p,m,v,_,f,h,x,y,b,{entity_id:j}=e,[w,C]=(0,l.useState)(!1),{data:k}=(0,ey.Z)((0,g._)(function*(){return yield K.K.PublicGetProductCallInfo({entity_type:K.K.product_common.ProductEntityType.Plugin,entity_id:j})}),{ready:w,refreshDeps:[w,j]}),N=()=>{C(!1)},S=()=>{var e,t,r,n,o,i,l,a;return(null==k?void 0:null===(t=k.data)||void 0===t?void 0:null===(e=t.call_count_limit)||void 0===e?void 0:e.used_count)&&(null==k?void 0:null===(n=k.data)||void 0===n?void 0:null===(r=n.call_count_limit)||void 0===r?void 0:r.total_count)?(null==k?void 0:null===(i=k.data)||void 0===i?void 0:null===(o=i.call_count_limit)||void 0===o?void 0:o.used_count)/(null==k?void 0:null===(a=k.data)||void 0===a?void 0:null===(l=a.call_count_limit)||void 0===l?void 0:l.total_count):0};return{node:(0,i.jsx)(c.u_,{visible:w,onCancel:N,maskClosable:!1,closeOnEsc:!0,title:"账号付费插件调用量",width:525,footer:null,children:(0,i.jsx)("div",{className:"coz-fg-primary",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:(0,i.jsxs)(c.T,{spacing:4,className:"mb-[16px]",children:[(0,i.jsx)("span",{className:"w-[110px] font-[500]",children:"账号信息"}),(0,i.jsx)(c.qE,{className:"w-[18px] h-[18px]",src:null==k?void 0:null===(r=k.data)||void 0===r?void 0:null===(t=r.user_info)||void 0===t?void 0:t.avatar_url,shape:"circle"}),(0,i.jsx)("span",{className:"coz-fg-secondary font-[500]",children:null==k?void 0:null===(o=k.data)||void 0===o?void 0:null===(n=o.user_info)||void 0===n?void 0:n.nick_name}),(0,i.jsx)("span",{className:"coz-fg-secondary",children:"@".concat(null==k?void 0:null===(s=k.data)||void 0===s?void 0:null===(a=s.user_info)||void 0===a?void 0:a.user_name)})]})}),(0,i.jsxs)(c.T,{spacing:4,className:"mb-[16px]",children:[(0,i.jsx)("span",{className:"w-[110px] font-[500]",children:"订阅版本"}),(0,i.jsx)(c.Vp,{color:"primary",children:eC(null==k?void 0:null===(d=k.data)||void 0===d?void 0:d.user_level)})]}),(0,i.jsx)("div",{className:"mb-[16px]",children:(0,i.jsxs)(c.T,{spacing:4,children:[(0,i.jsx)("span",{className:"w-[110px] font-[500]",children:"调用次数"}),(null==k?void 0:null===(p=k.data)||void 0===p?void 0:null===(u=p.call_count_limit)||void 0===u?void 0:u.is_unlimited)?(0,i.jsx)("span",{children:"无上限"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"".concat(ew(null==k?void 0:null===(v=k.data)||void 0===v?void 0:null===(m=v.call_count_limit)||void 0===m?void 0:m.used_count),"/").concat(ew(null==k?void 0:null===(f=k.data)||void 0===f?void 0:null===(_=f.call_count_limit)||void 0===_?void 0:_.total_count))}),(0,i.jsx)("span",{className:"coz-fg-secondary",children:"（".concat(eg().unix(Number(null==k?void 0:null===(x=k.data)||void 0===x?void 0:null===(h=x.call_count_limit)||void 0===h?void 0:h.reset_datetime)).format("YYYY-MM-DD")," 重置）")}),S()>.8&&(0,i.jsx)(c.Vp,{color:"yellow",size:"mini",children:(0,eb.T3)(S())})]})]})}),(0,i.jsxs)(c.T,{spacing:4,children:[(0,i.jsx)("span",{className:"w-[110px] font-[500]",children:"QPS"}),(0,i.jsx)("span",{children:ew(null==k?void 0:null===(b=k.data)||void 0===b?void 0:null===(y=b.call_rate_limit)||void 0===y?void 0:y.qps)})]})]})})}),open:()=>{C(!0)},close:N}}},591619:function(e,t,r){r.d(t,{DY:function(){return s},Gq:function(){return c},IS:function(){return i},L6:function(){return p},SF:function(){return m},YY:function(){return a},aY:function(){return d},zs:function(){return u}});var n=r(336205),o=r(117140),i=[o._J.Plugin],l=[o._J.Plugin],a=Object.fromEntries(i.map(e=>[e,0])),s=Object.fromEntries(i.map(e=>[e,null])),d={[o._J.Bot]:()=>n.o.t("project_store_search"),[o._J.Plugin]:()=>n.o.t("store_search_recommend_result2"),[o._J.TemplateCommon]:()=>n.o.t("template_name")},c={[o._J.Bot]:"bot",[o._J.Plugin]:"plugin",[o._J.TemplateCommon]:"template"},u=(e,t,r)=>{switch(e){case o._J.Plugin:case o._J.SaasPlugin:return t?"https://www.coze.cn/store/plugin/".concat(t).concat(r?"?from=".concat(r):""):"/explore/plugin";default:return"#"}},p={[o._J.Bot]:[{label:()=>n.o.t("store_search_chat"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.bot_extra)||void 0===t?void 0:t.chat_conversation_count)||0}},{label:()=>n.o.t("store_search_use"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.bot_extra)||void 0===t?void 0:t.user_count)||0}},{label:()=>n.o.t("store_search_collect"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.favorite_count)||0}}],[o._J.Project]:[{label:()=>n.o.t("store_search_use"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.project_extra)||void 0===t?void 0:t.user_count)||0}},{label:()=>n.o.t("template_run"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.project_extra)||void 0===t?void 0:t.execute_count)||0}},{label:()=>n.o.t("mkpl_num_favorites"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.favorite_count)||0}}],[o._J.Plugin]:[{label:()=>n.o.t("store_search_use"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.plugin_extra)||void 0===t?void 0:t.bots_use_count)||0}},{label:()=>n.o.t("store_search_collect"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.favorite_count)||0}},{label:()=>n.o.t("store_search_call"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.plugin_extra)||void 0===t?void 0:t.call_amount)||0}}],[o._J.TemplateCommon]:[{label:()=>n.o.t("workflowstore_card_duplicate"),getValue:e=>{var t;return(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.heat)||0}}],[o._J.BotTemplate]:[{label:()=>n.o.t("workflowstore_card_duplicate"),getValue:e=>{var t;return(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.heat)||0}},{label:()=>n.o.t("store_search_chat"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.bot_extra)||void 0===t?void 0:t.chat_conversation_count)}}],[o._J.ProjectTemplate]:[{label:()=>n.o.t("workflowstore_card_duplicate"),getValue:e=>{var t;return(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.heat)||0}},{label:()=>n.o.t("template_search_run"),getValue:e=>{var t;return(null==e?void 0:null===(t=e.project_extra)||void 0===t?void 0:t.execute_count)||0}}],[o._J.WorkflowTemplateV2]:[{label:()=>n.o.t("workflowstore_card_duplicate"),getValue:e=>{var t;return(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.heat)||0}},{label:()=>n.o.t("template_search_run"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.workflow_extra)||void 0===t?void 0:t.used_count)||0}}],[o._J.ImageflowTemplateV2]:[{label:()=>n.o.t("workflowstore_card_duplicate"),getValue:e=>{var t;return(null==e?void 0:null===(t=e.meta_info)||void 0===t?void 0:t.heat)||0}},{label:()=>n.o.t("template_search_run"),getValue:e=>{var t;return Number(null==e?void 0:null===(t=e.workflow_extra)||void 0===t?void 0:t.used_count)||0}}]},m=e=>{var{isLogin:t}=e;return t?i:l}},494784:function(e,t,r){r.d(t,{M:()=>$});var n=r("151064"),o=r("455069"),i=r("252237"),l=r.n(i),a=r("336205"),s=r("915757"),d=r("674343"),c=r("44172"),u=r("117140"),p=r("808549"),m=r("120454"),v=r("598208"),_=r("591619"),f=e=>{var{currentEntityType:t,direction:r,contentLength:n,recursionStartEntityType:o,entityList:i}=e;if(1===r){if(t===(null==i?void 0:i[i.length-1]))return null!=o?o:t;var l=i[i.indexOf(t)+1];return n[l]<=0?f({currentEntityType:l,direction:r,contentLength:n,entityList:i,recursionStartEntityType:null!=o?o:t}):l}if(t===(null==i?void 0:i[0]))return null!=o?o:t;var a=i[i.indexOf(t)-1];return n[a]<=0?f({currentEntityType:a,entityList:i,direction:r,contentLength:n,recursionStartEntityType:null!=o?o:t}):a},h=(0,v.Ue)((e,t)=>({currentEntitySort:[u._J.SaasPlugin],setCurrentEntitySort:t=>{e({currentEntitySort:t})},entityTypeIn:u._J.SaasPlugin,setEntityTypeIn:t=>{e({entityTypeIn:t})},ableKeyBoardJumpDetail:!1,setAbleKeyBoardJumpDetail:t=>{e({ableKeyBoardJumpDetail:t})},inputValue:"",setInputValue:t=>{e({inputValue:t})},contentLength:(0,p._)({},_.YY),setContentLength:(r,n)=>{e({contentLength:(0,m._)((0,p._)({},t().contentLength),{[r]:n})})},resetAllContentLength:()=>{e({contentLength:(0,p._)({},_.YY)})},currentSelectedIndex:{type:u._J.SaasPlugin,index:-1},setCurrentSelectIndex:(t,r)=>{e({currentSelectedIndex:{type:t,index:r}})},resetCurrentSelectIndex:()=>{var{currentEntitySort:r}=t();e({currentSelectedIndex:{type:r[0],index:-1}})},changeCurrentSelectIndexByDirection:r=>{var{currentSelectedIndex:n,contentLength:o,currentEntitySort:i}=t();if(1===r){if(n.index+1>=o[n.type]){var l=f({currentEntityType:n.type,direction:1,contentLength:o,entityList:[...i]});if(l===n.type)return{isBottom:!0};e({currentSelectedIndex:{type:l,index:0}})}else e({currentSelectedIndex:{type:n.type,index:n.index+1}})}else if(n.index<=0){var a=f({currentEntityType:n.type,direction:0,contentLength:o,entityList:[...i]});if(e({currentSelectedIndex:{type:a,index:a===n.type?-1:o[a]-1}}),a===n.type)return{isTop:!0}}else e({currentSelectedIndex:{type:n.type,index:n.index-1}})}})),x=r("157728"),g=r("136515"),y=r("707107"),b=r("775699"),j=r("30961"),w=r("408078"),C=e=>{var{onSearch:t}=e,r=(0,x.useNavigate)(),{inputValue:o,entityTypeIn:i}=h();return(0,n.jsxs)("div",{className:l()(w.Z.moreContainer),onMouseDown:()=>{(0,y.Gg)(y.Kg.store_search_front,{search_word:o,action:"enter_search"}),console.log("[dev] mousedown:",t,o,i),t?t("/search/".concat(encodeURIComponent(o),"?entityType=").concat(i)):r("/search/".concat(encodeURIComponent(o),"?entityType=").concat(i))},children:[(0,n.jsx)(b.ZT.Text,{className:w.Z.text,ellipsis:{rows:1},children:a.o.t("store_search_suggest_page",{query:o})}),(0,n.jsx)(s.x5d,{className:w.Z.arrow})]})},k=r("825955"),N=r("716069"),S=r("311807"),E=r("165882"),T=r("382534"),I=r("298203"),P={[u._J.Bot]:"bot_id",[u._J.Project]:"project_id",[u._J.Plugin]:"plugin_id"},A={[u._J.Bot]:"bot",[u._J.Project]:"project",[u._J.Plugin]:"plugin"},D=e=>{var t,r,n,o,i=P[null!==(t=e.entity_type)&&void 0!==t?t:u._J.Bot],l=A[null!==(r=e.entity_type)&&void 0!==r?r:u._J.Bot];return(0,m._)((0,p._)({product_id:null!==(n=e.id)&&void 0!==n?n:"",product_name:null!==(o=e.name)&&void 0!==o?o:""},i?{[i]:e.entity_id}:{}),{entity_type:null!=l?l:"bot"})},L=r("474872"),O=e=>{var t,r,o,i,l,a,s,d,c,u,p,m,v,_,f;return(0,n.jsx)(L.gj,{avatar:null==e?void 0:null===(r=e.metaInfo)||void 0===r?void 0:null===(t=r.user_info)||void 0===t?void 0:t.avatar_url,username:null==e?void 0:null===(i=e.metaInfo)||void 0===i?void 0:null===(o=i.user_info)||void 0===o?void 0:o.user_name,name:null==e?void 0:null===(a=e.metaInfo)||void 0===a?void 0:null===(l=a.user_info)||void 0===l?void 0:l.name,label:{name:null==e?void 0:null===(c=e.metaInfo)||void 0===c?void 0:null===(d=c.user_info)||void 0===d?void 0:null===(s=d.user_label)||void 0===s?void 0:s.label_name,icon:null==e?void 0:null===(m=e.metaInfo)||void 0===m?void 0:null===(p=m.user_info)||void 0===p?void 0:null===(u=p.user_label)||void 0===u?void 0:u.icon_url,href:null==e?void 0:null===(f=e.metaInfo)||void 0===f?void 0:null===(_=f.user_info)||void 0===_?void 0:null===(v=_.user_label)||void 0===v?void 0:v.jump_link},theme:e.theme,nameMaxWidth:150,size:e.size,renderCenterSlot:e.renderCenterSlot,className:e.className})},Z=e=>{var{isSelected:t,ableKeyPressJump:r,onSelectedClick:n,itemRef:i,containerRef:l}=e,{inputValue:a,ableKeyBoardJumpDetail:s}=h();(0,o.useEffect)(()=>{if(t&&r&&s){var e=e=>{"Enter"===e.code&&(null==n||n())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}},[t,a,r,s]),(0,o.useEffect)(()=>{if(t&&(null==i?void 0:i.current)&&(null==l?void 0:l.current)){var e=null==i?void 0:i.current.getBoundingClientRect(),r=null==l?void 0:l.current.getBoundingClientRect();e.bottom>r.bottom?l.current.scrollTo({top:(null==l?void 0:l.current.scrollTop)+e.bottom-r.bottom+8,behavior:"smooth"}):e.top<r.top&&l.current.scrollTo({top:(null==l?void 0:l.current.scrollTop)+e.top-r.top,behavior:"smooth"})}},[t])},F=r("686953"),M=e=>{var{type:t}=e;return({[u._J.Bot]:(0,n.jsx)(d.Vp,{size:"mini",color:"primary",children:a.o.t("community_Tagtag_bot")}),[u._J.Project]:(0,n.jsx)(d.Vp,{size:"mini",color:"brand",children:a.o.t("project_store_search")})})[t]},z=e=>{var t,{productInfo:r,entityType:i}=e;return(0,n.jsx)(n.Fragment,{children:i&&r?null===(t=_.L6[i])||void 0===t?void 0:t.map((e,t)=>(0,n.jsxs)(o.Fragment,{children:[t>0?(0,n.jsx)("div",{className:F.Z.dot}):null,(0,n.jsxs)(b.ZT.Text,{className:F.Z["statie-elc"],children:[(0,I.uf)(e.getValue(r)),e.label(r)]})]},t)):null})},R=e=>{var t,r,i,c,v,f,x,g,{isSelected:w=!1,item:C,ableKeyPressJump:k,onMouseHover:N,entityType:S,containerRef:E,index:T}=e,{inputValue:P}=h(),A=(0,o.useRef)(),L=()=>{if(!!S){var e,t,r=(0,_.zs)(null!==(t=null==C?void 0:C.meta_info.entity_type)&&void 0!==t?t:S,null==C?void 0:null===(e=C.meta_info)||void 0===e?void 0:e.id,"store_search_suggestion");window.open(r,"_blank")}};return Z((0,m._)((0,p._)({},{isSelected:w,ableKeyPressJump:k}),{onSelectedClick:()=>{var e,t,r;(0,y.Gg)(y.Kg.store_search_front,{result_type:_.Gq[S]||"",entity_id:(null==C?void 0:null===(e=C.meta_info)||void 0===e?void 0:e.id)||"",entity_name:(null==C?void 0:null===(t=C.meta_info)||void 0===t?void 0:t.name)||"",search_word:P,action:"click_results"}),window.open((0,_.zs)(S,null==C?void 0:null===(r=C.meta_info)||void 0===r?void 0:r.id),"_blank")},itemRef:A,containerRef:E})),(0,j.Hf)({target:A,options:{threshold:.5},eventName:y.Kg.product_show_front,reportParams:(0,m._)((0,p._)({},(null==C?void 0:C.meta_info)?D(null==C?void 0:C.meta_info):{bot_id:"",product_name:"",product_id:""}),{c_position:T,filter_tag:"all",source:"store_search_suggestion",from:null!==(x=(0,I.zx)({key:"from"}))&&void 0!==x?x:"store_search_suggestion"}),isReportOnce:!0}),(0,n.jsxs)("div",{className:l()(F.Z.normalItemContaienr,{[F.Z.isSelected]:w}),style:{gap:12},onMouseDown:()=>{var e,t;L(),(0,y.Gg)(y.Kg.store_search_front,{result_type:_.Gq[S]||"",entity_id:(null==C?void 0:null===(e=C.meta_info)||void 0===e?void 0:e.id)||"",entity_name:(null==C?void 0:null===(t=C.meta_info)||void 0===t?void 0:t.name)||"",search_word:P,action:"click_results"})},onMouseEnter:()=>null==N?void 0:N(),ref:A,children:[(0,n.jsx)(b.qE,{shape:"square",src:null==C?void 0:null===(t=C.meta_info)||void 0===t?void 0:t.icon_url,style:{width:32,height:32},className:F.Z.avatar}),(0,n.jsxs)(b.T,{vertical:!0,spacing:2,style:{flex:1,overflow:"hidden"},children:[(0,n.jsxs)("div",{className:"flex items-center w-full gap-[6px]",children:[(null==C?void 0:C.meta_info.entity_type)!==void 0?(0,n.jsx)(M,{type:null==C?void 0:C.meta_info.entity_type}):null,(0,n.jsx)(b.ZT.Text,{className:l()(F.Z.title,"ml-[4px]"),ellipsis:{rows:1,showTooltip:!1},children:null==C?void 0:null===(r=C.meta_info)||void 0===r?void 0:r.name}),(0,n.jsx)(O,{metaInfo:null==C?void 0:C.meta_info}),(null==C?void 0:null===(i=C.commercial_setting)||void 0===i?void 0:i.commercial_type)===u.j2.Paid?(0,n.jsx)(d.Vp,{size:"mini",color:"brand",prefixIcon:(0,n.jsx)(s.sWZ,{}),className:"font-medium",children:a.o.t((null==C?void 0:null===(c=C.commercial_setting)||void 0===c?void 0:c.business_type)===u._$.SelfOperated?"official_payment":"third_party_payment")}):null]}),(0,n.jsxs)(b.T,{spacing:6,style:{width:"100%"},children:[(0,n.jsx)(z,{entityType:null!==(g=null==C?void 0:C.meta_info.entity_type)&&void 0!==g?g:S,productInfo:C}),(null==C?void 0:null===(v=C.meta_info)||void 0===v?void 0:v.description)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:F.Z.dot}),(0,n.jsx)(b.ZT.Text,{className:F.Z.description,ellipsis:{rows:1,showTooltip:!1},children:null==C?void 0:null===(f=C.meta_info)||void 0===f?void 0:f.description})]}):null]})]})]})},B=()=>(0,n.jsxs)(b.T,{spacing:12,className:F.Z.skeletonContiner,children:[(0,n.jsx)(b.Od.Image,{className:F.Z.image}),(0,n.jsxs)(b.T,{className:F.Z.textContainer,spacing:8,vertical:!0,children:[(0,n.jsx)(b.Od.Title,{className:F.Z.title}),(0,n.jsx)(b.Od.Title,{className:F.Z.description})]})]}),V=e=>{var{isSelected:t=!1,ableKeyPressJump:r,requestList:i,onMouseHover:s,containerRef:d}=e,u=(0,o.useRef)();return Z((0,m._)((0,p._)({},{isSelected:t,ableKeyPressJump:r}),{onSelectedClick:()=>{null==i||i()},itemRef:u,containerRef:d})),(0,n.jsxs)("div",{onMouseDown:()=>{null==i||i()},className:l()(F.Z.seeMore,{[F.Z.isSelected]:t}),ref:u,onMouseEnter:()=>null==s?void 0:s(),children:[a.o.t("store_search_see_more")," ",(0,n.jsx)(c.eIx,{})]})},U=r("866014"),H=o.forwardRef((e,t)=>{var r,i,{inComposition:l,entityType:a,onResultChange:s,containerRef:d}=e,[v,f]=(0,o.useState)([]),[x,g]=(0,o.useState)(!1),[b,j]=(0,o.useState)(!1),{inputValue:w,ableKeyBoardJumpDetail:C,setContentLength:I,currentSelectedIndex:P,setCurrentSelectIndex:A}=h(),D=(0,o.useRef)(),L=(0,o.useRef)(1),O=!l;var Z=(0,o.useCallback)((0,S.Z)((r=(0,k._)(function*(e){(0,y.Gg)(y.Kg.store_search_front,{search_word:e||"",action:"type"}),D.current=E.Z.CancelToken.source();try{g(!0);var t,{data:r}=yield T.yF.PublicSearchSuggest((0,m._)((0,p._)({keyword:e},a===u._J.Bot?{entity_types:[u._J.Bot,u._J.Project]}:{entity_type:a}),{page_num:L.current++,page_size:5}),{cancelToken:D.current.token,paramsSerializer:e=>N.Z.stringify(e,{arrayFormat:"comma"})}),n=null!==(t=null==r?void 0:r.suggestion_v2)&&void 0!==t?t:[],o=(null==n?void 0:n.length)>0&&(null==r?void 0:r.has_more);j(o||!1),g(!1),f(e=>{var t,o=[...e,...n],i=(null!==(t=null==o?void 0:o.length)&&void 0!==t?t:0)+((null==r?void 0:r.has_more)?1:0);return I(a,i),o})}catch(e){console.log("[dev] 正常请求打断")}}),function(e){return r.apply(this,arguments)}),300,{leading:!1}),[a]);return((0,o.useEffect)(()=>{var e,t;null===(t=D.current)||void 0===t||null===(e=t.cancel)||void 0===e||e.call(t,"suggest request cancle by user"),g(!0),f([]),L.current=1,Z(w)},[w]),(0,o.useImperativeHandle)(t,()=>({getResultList:()=>v,isLoading:()=>x}),[x,v]),(0,o.useEffect)(()=>{null==s||s()},[v,x]),0!==v.length||x)?(0,n.jsxs)("div",{className:U.Z.popoverContainer,children:[(0,n.jsx)("div",{className:U.Z.title,children:null===(i=_.aY[a])||void 0===i?void 0:i.call(_.aY)}),x&&0===v.length?[,,,,].fill("").map((e,t)=>(0,n.jsx)(B,{},t)):(0,n.jsxs)(n.Fragment,{children:[v.map((e,t)=>(0,n.jsx)(R,{item:e,ableKeyPressJump:O&&C,isSelected:P.index===t&&P.type===a,onMouseHover:()=>A(a,t),entityType:a,containerRef:d},t)),b?(0,n.jsx)("div",{className:U.Z.loadMoreContainer,children:x?(0,n.jsx)("div",{className:U.Z.loading,children:(0,n.jsx)(c.yMZ,{className:U.Z.loadingIcon})}):(0,n.jsx)(V,{isSelected:P.index===v.length&&P.type===a,onMouseHover:()=>A(a,v.length),containerRef:d,ableKeyPressJump:O,requestList:()=>{Z(w)}})}):null]})]}):null}),W=r("874963"),{Text:G}=b.ZT,K=(e,t)=>{for(var r=e;r&&r!==document.body;){if(r===t)return!0;r=r.parentElement}return!1},J=e=>{var{focus:t,inComposition:r,onSearch:i,visible:s,setVisible:d,focusInput:c,inputContainerRef:u,onResultEmpty:v}=e,f=(0,o.useRef)(),[b,w]=(0,o.useState)(!1),k=(0,x.useNavigate)(),N=(0,o.useRef)((0,p._)({},_.DY)),{inputValue:S,ableKeyBoardJumpDetail:E,setAbleKeyBoardJumpDetail:T,resetAllContentLength:I,changeCurrentSelectIndexByDirection:P,resetCurrentSelectIndex:A,entityTypeIn:D,currentEntitySort:L,setCurrentEntitySort:O}=h(),Z=!r&&t,F=(0,j.Pk)();(0,o.useEffect)(()=>{var e=(0,_.SF)({isLogin:F}),t=e.filter(e=>e!==D);t.length!==e.length?O([D,...t]):O([...e]),A()},[D,F]),(0,o.useEffect)(()=>{var e,r;N.current=(0,p._)({},_.DY),T(!1),I(),A(),null===(r=f.current)||void 0===r||null===(e=r.scrollTo)||void 0===e||e.call(r,0,0),S.length>0&&t&&d(!0)},[S]),(0,o.useEffect)(()=>{t&&(d(!0),T(!1),A())},[t]),(0,o.useEffect)(()=>{if(s){var e=e=>{"Escape"===e.code&&d(!1)},t=e=>{K(e.target,u.current)||d(!1)};return document.addEventListener("keydown",e,!0),document.addEventListener("click",t),()=>{document.removeEventListener("keydown",e,!0),document.removeEventListener("click",t),A()}}},[s]),(0,o.useEffect)(()=>{if(s){(0,y.Gg)(y.Kg.store_search_front,{search_word:S,action:"click"});var e=e=>{if("ArrowUp"===e.code){var t,r,n=P(0);e.preventDefault(),(null==n?void 0:n.isTop)&&(null==c||c(!0),null===(r=f.current)||void 0===r||null===(t=r.scrollTo)||void 0===t||t.call(r,{top:0,behavior:"smooth"}))}"ArrowDown"===e.code&&(P(1),T(!0),e.preventDefault(),null==c||c(!1))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}},[s]),(0,o.useEffect)(()=>{if(S.length>0&&Z&&!E){var e=e=>{("Enter"===e.code||"Enter"===e.key||13===e.keyCode)&&((0,y.Gg)(y.Kg.store_search_front,{search_word:S,action:"enter_search"}),i?(i("/search/".concat(encodeURIComponent(S),"?entityType=").concat(D)),d(!1)):k("/search/".concat(encodeURIComponent(S),"?entityType=").concat(D)))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}},[S,Z,E]);var M=()=>{var e=!0;Object.keys(N.current).map(t=>{var r=N.current[t];if(!!L.includes(Number(t)))(!r||!0===r.isLoading()||r.getResultList().length>0)&&(e=!1)}),w(e),null==v||v(e)};return(0,g.Z)(()=>{!s&&T(!1);var e,t=e=>{var t,r,n,o;if(!!f.current)(null===(t=f.current)||void 0===t?void 0:t.scrollTop)+(null===(r=f.current)||void 0===r?void 0:r.offsetHeight)>=(null===(n=f.current)||void 0===n?void 0:n.scrollHeight)&&e.deltaY>0?null==e||e.preventDefault():(null===(o=f.current)||void 0===o?void 0:o.scrollTop)===0&&(null==e?void 0:e.deltaY)<0&&(null==e||e.preventDefault())};return null===(e=f.current)||void 0===e||e.addEventListener("wheel",t),()=>{var e;null===(e=f.current)||void 0===e||e.removeEventListener("wheel",t)}},[s]),(0,n.jsx)("div",{className:l()(W.Z.popoverContainer,{[W.Z.visible]:s}),children:(0,n.jsxs)("div",{className:W.Z.contentCotaniner,onClickCapture:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:W.Z.divider}),(0,n.jsxs)("div",{className:W.Z["area-container"],ref:e=>{f.current=e},children:[0===S.length?(0,n.jsx)(G,{className:W.Z.title,children:a.o.t("store_search_recently_viewed")}):null,b?(0,n.jsx)(G,{className:W.Z.nofound,children:a.o.t("store_search_suggest_no_result")}):null,L.map(t=>(0,o.createElement)(H,(0,m._)((0,p._)({},e),{key:t,entityType:t,onResultChange:M,ref:e=>N.current[t]=e,containerRef:f})))]}),S.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:W.Z.divider,style:{margin:0}}),(0,n.jsx)(C,{onSearch:i?e=>{null==i||i(e),d(!1)}:void 0})]})]})})},q=r("363258"),$=o.forwardRef((e,t)=>{var{border:r,className:i,inputClassName:p,defaultValue:m="",onSearch:v,onFocus:_,onBlur:f,entityType:x,useResponsive:g,onActiveChange:y,enableFocusStyle:b=!0}=e,[j,w]=(0,o.useState)(!1),[C,k]=(0,o.useState)(!1),[N,S]=(0,o.useState)(!1),E=(0,o.useRef)(null),{inputValue:T,setInputValue:I,setEntityTypeIn:P}=h(),[A,D]=(0,o.useState)(!1),L=(0,o.useRef)(null);(0,o.useEffect)(()=>{P(x||u._J.SaasPlugin)},[x]),(0,o.useEffect)(()=>{var e=m;try{e=decodeURIComponent(m)}catch(t){e=m}return I(e),()=>{I("")}},[]);(0,o.useImperativeHandle)(t,()=>({setInputValue:I}),[I]),(0,o.useEffect)(()=>{null==y||y(j||N)},[j,N]);var O=N&&(!A||T.length>0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:l()(i,q.Z.container,{[q.Z.focus]:b&&(j||N),[q.Z.popoverVisible]:b&&O}),ref:E,children:[(0,n.jsx)(d.II,{className:l()(p,q.Z.inputContainer,{[q.Z["has-word"]]:T.length>0,"!coz-stroke-plus":r}),onChange:e=>I(e),value:T,prefix:j||T.length>0?null:(0,n.jsx)("div",{className:q.Z["icon-search"],children:(0,n.jsx)(c.nCf,{})}),onClick:()=>{S(!0)},showClear:!0,onFocus:()=>{w(!0),null==y||y(!0),null==_||_()},onBlur:()=>{w(!1),!O&&S(!1),null==f||f()},onCompositionStart:()=>{k(!0)},onCompositionEnd:()=>{k(!1)},placeholder:a.o.t("Search"),maxLength:100,ref:L,clearIcon:(0,n.jsx)("span",{className:q.Z["clear-icon"],children:(0,n.jsx)(s.rmE,{})})}),(0,n.jsx)(J,{focus:j,inComposition:C,onSearch:v,visible:O,setVisible:S,focusInput:e=>{var t,r,n,o;e?null===(r=L.current)||void 0===r||null===(t=r.focus)||void 0===t||t.call(r):null===(o=L.current)||void 0===o||null===(n=o.blur)||void 0===n||n.call(o)},inputContainerRef:E,onResultEmpty:e=>{D(e)}})]}),(0,n.jsx)("div",{className:l()(q.Z.mask,{[q.Z.visible]:O&&g})})]})})},303781:function(e,t,r){r(151064),r(455069),r(775699)},569603:function(e,t,r){r.d(t,{CJ:()=>I,v6:()=>f,vL:()=>x,ir:()=>k,c$:()=>C});var n,o=r("151064"),i=r("455069"),l=r("252237"),a=r.n(l),s=r("336205"),d=r("915757"),c=r("775699");function u(){return(0,o.jsxs)("svg",{width:"48",height:"38",viewBox:"0 0 48 38",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("rect",{x:"1.83317",y:"1.49998",width:"44.3333",height:"35",rx:"3.5",stroke:"currentColor","stroke-opacity":"0.8","stroke-width":"2.33333"}),(0,o.jsx)("path",{d:"M14.6665 30.6667H33.3332",stroke:"currentColor","stroke-opacity":"0.8","stroke-width":"2.33333","stroke-linecap":"round"})]})}function p(){return(0,o.jsx)("svg",{width:"34",height:"52",viewBox:"0 0 34 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M30.9998 16.6666V35.3333C30.9998 37.5748 30.9948 38.4695 30.9 39.1895C30.2108 44.4247 26.0912 48.5443 20.856 49.2335C20.1361 49.3283 19.2413 49.3333 16.9998 49.3333C14.7584 49.3333 13.8636 49.3283 13.1437 49.2335C7.90847 48.5443 3.78888 44.4247 3.09965 39.1895C3.00487 38.4695 2.99984 37.5748 2.99984 35.3333V16.6666C2.99984 14.4252 3.00487 13.5304 3.09965 12.8105C3.78888 7.57528 7.90847 3.45569 13.1437 2.76646C13.7232 2.69017 14.4159 2.67202 15.8332 2.66785V9.86573C14.4738 10.3462 13.4998 11.6426 13.4998 13.1666V17.8332C13.4998 19.3571 14.4738 20.6536 15.8332 21.1341V23.6666C15.8332 24.3109 16.3555 24.8333 16.9998 24.8333C17.6442 24.8333 18.1665 24.3109 18.1665 23.6666V21.1341C19.5259 20.6536 20.4998 19.3572 20.4998 17.8332V13.1666C20.4998 11.6426 19.5259 10.3462 18.1665 9.86571V2.66785C19.5837 2.67202 20.2765 2.69017 20.856 2.76646C26.0912 3.45569 30.2108 7.57528 30.9 12.8105C30.9948 13.5304 30.9998 14.4252 30.9998 16.6666ZM0.666504 16.6666C0.666504 14.4993 0.666504 13.4157 0.786276 12.5059C1.61335 6.22368 6.55687 1.28016 12.8391 0.453085C13.7489 0.333313 14.8325 0.333313 16.9998 0.333313C19.1671 0.333313 20.2508 0.333313 21.1605 0.453085C27.4428 1.28016 32.3863 6.22368 33.2134 12.5059C33.3332 13.4157 33.3332 14.4994 33.3332 16.6666V35.3333C33.3332 37.5006 33.3332 38.5843 33.2134 39.494C32.3863 45.7763 27.4428 50.7198 21.1605 51.5469C20.2508 51.6666 19.1671 51.6666 16.9998 51.6666C14.8325 51.6666 13.7489 51.6666 12.8391 51.5469C6.55687 50.7198 1.61335 45.7763 0.786276 39.494C0.666504 38.5843 0.666504 37.5006 0.666504 35.3333V16.6666ZM15.8332 13.1666C15.8332 13.0011 15.8676 12.8437 15.9297 12.7011C15.9886 12.566 16.0722 12.4443 16.1749 12.3416C16.386 12.1305 16.6777 11.9999 16.9998 11.9999C17.6435 11.9999 18.1654 12.5212 18.1665 13.1646L18.1665 13.1666V17.8332L18.1665 17.8353C18.1665 17.8364 18.1665 17.8376 18.1665 17.8387C18.1661 17.9132 18.1588 17.986 18.1452 18.0565C18.0853 18.3656 17.9033 18.6312 17.6515 18.8011C17.4655 18.9266 17.2412 18.9999 16.9998 18.9999C16.3555 18.9999 15.8332 18.4776 15.8332 17.8332V13.1666Z",fill:"currentColor","fill-opacity":"0.8"})})}var m=r("273768"),{Title:v,Paragraph:_}=c.ZT;var f=((n={}).Mouse="MOUSE",n.Pad="PAD",n),h=e=>{var{title:t,subTitle:r,icon:n,onChange:i,value:l,selected:s}=e;return(0,o.jsxs)("div",{className:a()({[m.Z["mouse-pad-option"]]:!0,[m.Z["mouse-pad-option-selected"]]:s}),onClick:()=>i(l),children:[(0,o.jsx)("div",{className:a()({[m.Z["mouse-pad-option-icon"]]:!0,[m.Z["mouse-pad-option-icon-selected"]]:s}),children:n}),(0,o.jsx)(v,{heading:6,className:a()({[m.Z["mouse-pad-option-title"]]:!0,[m.Z["mouse-pad-option-title-selected"]]:s}),children:t}),(0,o.jsx)(_,{type:"tertiary",className:a()({[m.Z["mouse-pad-option-subTitle"]]:!0,[m.Z["mouse-pad-option-subTitle-selected"]]:s}),children:r})]})},x=i.forwardRef((e,t)=>{var{value:r,onChange:n,onPopupVisibleChange:l,containerStyle:v,iconStyle:_,arrowStyle:f}=e,[x,g]=(0,i.useState)(!1);return(0,o.jsx)(c.J2,{trigger:"custom",position:"topLeft",closeOnEsc:!0,visible:x,onVisibleChange:e=>{null==l||l(e)},onClickOutSide:()=>{g(!1)},spacing:20,content:(0,o.jsxs)("div",{className:m.Z["ui-mouse-pad-selector-popover"],children:[(0,o.jsx)(c.ZT.Title,{heading:4,children:s.o.t("workflow_interactive_mode")}),(0,o.jsxs)("div",{className:m.Z["ui-mouse-pad-selector-popover-options"],children:[(0,o.jsx)(h,{title:s.o.t("workflow_mouse_friendly"),subTitle:s.o.t("workflow_mouse_friendly_desc"),"data-testid":"workflow.detail.toolbar.interactive.mouse",value:"MOUSE",selected:"MOUSE"===r,icon:(0,o.jsx)(p,{}),onChange:n}),(0,o.jsx)(h,{title:s.o.t("workflow_pad_friendly"),subTitle:s.o.t("workflow_pad_friendly_desc"),"data-testid":"workflow.detail.toolbar.interactive.pad",value:"PAD",selected:"PAD"===r,icon:(0,o.jsx)(u,{}),onChange:n})]})]}),children:(0,o.jsxs)("div",{className:a()({[m.Z["ui-mouse-pad-selector"]]:!0,[m.Z["ui-mouse-pad-selector-active"]]:x}),ref:t,onClick:()=>{g(!x)},style:v,children:[(0,o.jsx)("div",{className:m.Z["ui-mouse-pad-selector-icon"],style:_,children:"MOUSE"===r?(0,o.jsx)(d.V3N,{}):(0,o.jsx)(d.XiX,{})}),(0,o.jsx)("div",{className:m.Z["ui-mouse-pad-selector-arrow"],style:f,children:(0,o.jsx)(d.Wdl,{})})]})})}),g=r("808549"),y=r("120454"),b="workflow_prefer_interactive_type",j="show_workflow_interactive_type_guide",w=/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent),C=()=>{var e=localStorage.getItem(b);return e&&[f.Mouse,f.Pad].includes(e)?e:w?f.Pad:f.Mouse},k=e=>{localStorage.setItem(b,e)},N=()=>{localStorage.setItem(j,"true")},S=()=>"true"!==localStorage.getItem(j),E=r("825926"),T=e=>(0,o.jsxs)("div",{className:E.Z["guiding-content"],children:[(0,o.jsx)("div",{className:E.Z["guiding-content-title"],children:(0,o.jsx)(c.ZT.Text,{children:e.mainTitle})}),(0,o.jsxs)("div",{className:E.Z["guiding-content-mouse-option"],children:[(0,o.jsx)("div",{className:E.Z["guiding-content-mouse-option-icon"],children:(0,o.jsx)(p,{})}),(0,o.jsxs)("div",{children:[(0,o.jsx)(c.ZT.Text,{className:E.Z["guiding-content-title"],children:e.mouseOptionTitle}),(0,o.jsx)(c.ZT.Paragraph,{className:E.Z["guiding-content-desc"],children:e.mouseOptionDesc})]})]}),(0,o.jsxs)("div",{className:E.Z["guiding-content-pad-option"],children:[(0,o.jsx)("div",{className:E.Z["guiding-content-pad-option-icon"],children:(0,o.jsx)(u,{})}),(0,o.jsxs)("div",{children:[(0,o.jsx)(c.ZT.Text,{className:E.Z["guiding-content-title"],children:e.padOptionTitle}),(0,o.jsx)(c.ZT.Paragraph,{className:E.Z["guiding-content-desc"],children:e.padOptionDesc})]})]}),(0,o.jsx)("div",{children:(0,o.jsx)(c.zx,{type:"primary",theme:"solid",className:E.Z["guiding-content-button"],onClick:null==e?void 0:e.onGotIt,children:e.buttonText})})]}),I=e=>{var{children:t,mainTitle:r=s.o.t("workflow_interactive_mode_popover_title"),buttonText:n=s.o.t("guidance_got_it"),mouseOptionTitle:l=s.o.t("workflow_interactive_mode_mouse_friendly"),mouseOptionDesc:a=s.o.t("workflow_interactive_mode_mouse_friendly_desc"),padOptionTitle:d=s.o.t("workflow_interactive_mode_pad_friendly"),padOptionDesc:u=s.o.t("workflow_interactive_mode_pad_friendly_desc")}=e,[p,m]=(0,i.useState)(()=>S());return(0,o.jsx)(c.J2,{content:(0,o.jsx)(T,(0,y._)((0,g._)({},{mainTitle:r,mouseOptionTitle:l,mouseOptionDesc:a,padOptionTitle:d,padOptionDesc:u,buttonText:n}),{onGotIt:()=>{N(),m(!1)}})),trigger:"custom",position:"top",style:{padding:0},visible:p,showArrow:!0,onClickOutSide:()=>m(!1),children:t})}},962622:function(e,t,r){r.d(t,{Jq:()=>k,Wp:()=>L,C6:()=>N,XK:()=>eA});var n,o,i=r("808549"),l=r("120454"),a=r("151064");r("327212");var s=r("602706"),d=r("455069"),c=r("686436"),u=r("130001"),p=r("771531"),m=r("435946");class v extends s.cvZ{getDefaultConfig(){return{version:0}}bumpVersion(){this._localVersion=this._localVersion+1,this._localVersion===Number.MAX_SAFE_INTEGER&&(this._localVersion=0)}updateVersion(){this.bumpVersion(),this.updateConfig({version:this._localVersion})}constructor(...e){super(...e),this._localVersion=0}}v.type="CustomRenderStateEntity";class _ extends s.cvZ{getDefaultConfig(){return{selectNodes:[],selectLines:[]}}get selectNodes(){return this.config.selectNodes}setSelectNodes(e){this.updateConfig({selectNodes:e})}get activatedNode(){return this.config.activatedNode}setActivatedNode(e){this.updateConfig({activatedNode:e})}get activeLines(){return this.config.selectLines}set activeLines(e){this.updateConfig({selectLines:e})}constructor(e){super(e)}}_.type="CustomRenderStateConfigEntity";var f=r("801815"),h=e=>e.replace("$blockIcon$",""),x=e=>"$blockIcon$".concat(e),g=r("952990");function y(e,t){var r,n,o=s.AeJ.createRectangleWithTwoPoints(e,t);switch(r=e.y<=t.y?e.x<=t.x?1:3:e.x<=t.x?0:2){case 1:n=[{x:o.leftTop.x,y:o.leftTop.y+o.height/2},{x:o.rightBottom.x,y:o.rightBottom.y-o.height/2}];break;case 3:n=[{x:o.rightTop.x,y:o.rightTop.y+o.height/2},{x:o.leftBottom.x,y:o.leftBottom.y-o.height/2}];break;case 0:n=[{x:o.leftBottom.x,y:o.leftBottom.y+Math.min(o.height,300)},{x:o.rightTop.x,y:o.rightTop.y-Math.min(o.height,300)}];break;case 2:n=[{x:o.rightBottom.x,y:o.rightBottom.y+Math.min(o.height,300)},{x:o.leftTop.x,y:o.leftTop.y-Math.min(o.height,300)}];break;default:n=[]}return n}var b=e=>{if(!!e)return"".concat(e.from.id).concat(e.to.id)},j=(e,t)=>{if(!t)return Number.MAX_SAFE_INTEGER;var{fromPoint:r,toPoint:n}=t,o=y(t.fromPoint,t.toPoint),i=new g.D([r,...o,n]);return s.E9j.getDistance(e,i.project(e))},w=e=>{var t=e.flowNodeType===s.SyX.BLOCK_ORDER_ICON,r=e.flowNodeType===s.SyX.BLOCK_ICON;return{node:t||r?e.parent:e,updateCurrent:!(t||r)}},C=e=>{var{node:t}=w(e);return t.getExtInfo()};var k=((n={})[n.WORKFLOW=0]="WORKFLOW",n[n.CHAT_FLOW=1]="CHAT_FLOW",n[n.KNOWLEDGE=2]="KNOWLEDGE",n[n.PLUGIN=3]="PLUGIN",n[n.DATABASE=4]="DATABASE",n);var N=((o={})[o.LIBRARY=0]="LIBRARY",o[o.APP=1]="APP",o[o.SHOP=2]="SHOP",o),S=(e,t)=>{var r=N.LIBRARY;return e&&(r=N.APP),t&&(r=N.SHOP),r},E=(e,t)=>{var r=S(!!(t.project_id&&"0"!==t.project_id),t.is_product);return{id:"".concat(t.id,"_").concat((0,f.x0)(5)),type:"custom",meta:{isNodeEnd:!0},data:{id:t.id,name:t.name,depth:e,collapsed:!1,type:k.KNOWLEDGE,from:r,version:void 0,icon:t.icon}}},T=(e,t)=>{var r=S(!!(t.project_id&&"0"!==t.project_id),t.is_product);return{id:"".concat(t.id,"_").concat((0,f.x0)(5)),type:"custom",meta:{isNodeEnd:!0},data:{id:t.id,name:t.name,depth:e,collapsed:!1,type:k.DATABASE,from:r,version:void 0,icon:t.icon}}},I=(e,t)=>{var r=S(!!(t.project_id&&"0"!==t.project_id),t.is_product);return{id:"".concat(t.id,"_").concat(t.version),type:"custom",meta:{isNodeEnd:!0},data:{id:t.id,name:t.name,depth:e,collapsed:!1,type:k.PLUGIN,from:r,version:t.version,icon:t.icon}}},P=(e,t)=>{if(!!t)return(e.node_list||[]).find(e=>(null==e?void 0:e.id)===t)},A=(e,t)=>{var r,n,o=P(t,e);return(null==o?!!void 0:null===(n=o.dependency)||void 0===n?!!void 0:null===(r=n.workflow_version)||void 0===r?!!void 0:!!r.length)&&D(e,o.dependency.workflow_version,t)},D=(e,t,r)=>!!t.some(t=>(null==t?void 0:t.id)===e)||t.some(t=>{var n,o=P(r,null==t?void 0:t.id);return D(e,(null==o?void 0:null===(n=o.dependency)||void 0===n?void 0:n.workflow_version)||[],r)}),L=e=>{if(!e)return!0;if(null===(t=e.edge_list)||void 0===t?void 0:t.length)return!1;var t,r,n,o,i,l,a,s=(null===(n=e.node_list)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.dependency)||{},d=null===(o=s.knowledge_list)||void 0===o?void 0:o.length,c=null===(i=s.plugin_version)||void 0===i?void 0:i.length,u=null===(l=s.table_list)||void 0===l?void 0:l.length,p=null===(a=s.workflow_version)||void 0===a?void 0:a.length;return!d&&!c&&!u&&!p};class O{getUnCollapsedEdges(){return this.edges.filter(e=>!e.collapsed)}traverseDFS(e,t){if(e.id===t)return e;if(!!(null===(n=e.children)||void 0===n?void 0:n.length))for(var r of e.children){var n,o=this.traverseDFS(r,t);if(o)return o}}getNodeByIdFromTree(e){return this.traverseDFS(this.root,e)}dfsCloneCollapsedOpen(e){var t,r=null===(t=e.children)||void 0===t?void 0:t.map(e=>this.dfsCloneCollapsedOpen(e));return(0,l._)((0,i._)({},e),{data:(0,l._)((0,i._)({},e.data),{collapsed:!1}),children:r})}cloneNode(e){return this.dfsCloneCollapsedOpen(e)}bindTreeParent(e,t){var r;t&&e.parent.push(t),this.edges.forEach(t=>{if(t.to===e.id){var r=this.getNodeByIdFromTree(t.from);r&&e.parent.push(r)}}),null===(r=e.children)||void 0===r||r.forEach(t=>{this.bindTreeParent(t,e)})}transformSchema(e){this.globalJson=e;var{node_list:t=[]}=e,r=t.find(e=>e.is_root);if(!!r){var n=this.dfsTransformNodeToSchema(0,r);n&&(this.root=n)}}dfsTreeJson(e){var t,r,n=[],o=this.getUnCollapsedEdges();return null==e||null===(t=e.children)||void 0===t||t.forEach(e=>{var t,r=o.filter(t=>t.to===e.id);if((null===(t=e.data)||void 0===t?void 0:t.collapsed)&&(null==r?void 0:r.length)){var n=this.cloneNode(e);r.forEach(e=>{this.addChildrenArr.push({parentId:e.from,json:this.dfsTreeJson(n)})})}}),(null==e?void 0:null===(r=e.children)||void 0===r?void 0:r.length)&&(n=e.children.filter(e=>{var t;return!(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.collapsed)}).map(e=>({id:"".concat(e.id,"_block"),type:"block",blocks:[this.dfsTreeJson(e)]}))),{id:null==e?void 0:e.id,type:null==e?void 0:e.type,data:null==e?void 0:e.data,meta:null==e?void 0:e.meta,blocks:n}}addNode(e,t){if(e.id===t.parentId){var r,n,o={id:"".concat(t.json.id,"_block"),type:"block",blocks:[t.json]};e.blocks?e.blocks.push(o):e.blocks=[o]}else null===(n=e.blocks)||void 0===n||n.forEach(e=>{this.addNode(e,t)});(null===(r=e.blocks)||void 0===r?void 0:r.length)&&("custom"===e.type&&(e.type="split"),e.meta?e.meta.isNodeEnd=!1:e.meta={isNodeEnd:!0})}treeToFlowNodeJson(){this.addChildrenArr=[];var e=this.dfsTreeJson(this.root);if(!e||!(null==e?void 0:e.id)){var t={nodes:[]};return this.document.fromJSON(t),t}var r={nodes:[e]};return this.addChildrenArr.forEach(t=>{this.addNode(e,t)}),this.document.fromJSON(r),r}constructor(){this.edges=[],this.treeHistory=[],this.getNodeDuplicateFromTree=(e,t)=>{var r=!1,n=[],o=[],i=this.treeHistory.filter(r=>"".concat(r.resourceId).concat(r.version||"")==="".concat(e).concat(t||""));return(null==i?void 0:i.length)&&(r=!0,i.forEach(e=>{n.push(e.depth),o.push(e.id)})),{depth:n,duplicate:r,dupId:o}},this.transformDuplicateInfo=(e,t,r,n,o)=>{var i,{duplicate:l,depth:a,dupId:s}=this.getNodeDuplicateFromTree(e);if(i="knowledge"===r?E(n+1,t):"plugin"===r?I(n+1,t):T(n+1,t),l){for(var[d,c]of a.entries())if(n+1===c){this.edges.push({from:o,to:s[d]});return}}return i},this.dfsTransformNodeToSchema=(e,t,r,n)=>{if(!!(null==t?void 0:t.commit_id)){var o,a=N.APP;t.is_library&&(a=N.LIBRARY),t.is_product&&(a=N.SHOP);var s=t.dependency,d=[],c="".concat(t.commit_id,"_").concat((0,f.x0)(5)),{duplicate:u,depth:p,dupId:m}=this.getNodeDuplicateFromTree(t.id,t.workflow_version);if(u){for(var[v,_]of p.entries())if(e===_){this.edges.push({from:n||"",to:m[v]});return}var h=t.id&&A(t.id,this.globalJson);return{id:c,type:"custom",data:{id:t.id,name:t.name,type:r||(t.is_chatflow?k.CHAT_FLOW:k.WORKFLOW),from:a,collapsed:!1,version:t.workflow_version,depth:e,loop:h},parent:[],meta:{isNodeEnd:!0},blocks:[]}}this.treeHistory.push({id:c,resourceId:t.id,version:t.workflow_version,depth:e}),((null==s?void 0:s.knowledge_list)||[]).map(t=>{var r,n,o,a=this.transformDuplicateInfo(t.id,t,"knowledge",e,c);a&&(this.treeHistory.push({id:a.id,resourceId:null===(r=a.data)||void 0===r?void 0:r.id,version:null===(n=a.data)||void 0===n?void 0:n.version,depth:null===(o=a.data)||void 0===o?void 0:o.depth}),d.push((0,l._)((0,i._)({},a),{data:a.data||{},type:a.type,parent:[],children:[]})))}),((null==s?void 0:s.table_list)||[]).map(t=>{var r,n,o,a=this.transformDuplicateInfo(t.id,t,"table",e,c);a&&(this.treeHistory.push({id:a.id,resourceId:null===(r=a.data)||void 0===r?void 0:r.id,version:null===(n=a.data)||void 0===n?void 0:n.version,depth:null===(o=a.data)||void 0===o?void 0:o.depth}),d.push((0,l._)((0,i._)({},a),{data:a.data||{},type:a.type,parent:[],children:[]})))}),((null==s?void 0:s.plugin_version)||[]).map(t=>{var r,n,o,a=this.transformDuplicateInfo(t.id,t,"plugin",e,c);a&&(this.treeHistory.push({id:a.id,resourceId:null===(r=a.data)||void 0===r?void 0:r.id,version:null===(n=a.data)||void 0===n?void 0:n.version,depth:null===(o=a.data)||void 0===o?void 0:o.depth}),d.push((0,l._)((0,i._)({},a),{data:a.data||{},type:a.type,parent:[],children:[]})))}),((null==s?void 0:null===(o=s.workflow_version)||void 0===o?void 0:o.filter(e=>e.id!==t.id))||[]).map(t=>{var r,n,o,i,l=null===(r=this.globalJson.node_list)||void 0===r?void 0:r.find(e=>e.id===t.id&&e.workflow_version===t.version),a=this.dfsTransformNodeToSchema(e+1,l,void 0,c);a&&(this.treeHistory.push({id:a.id,resourceId:(null===(n=a.data)||void 0===n?void 0:n.id)||"",version:null===(o=a.data)||void 0===o?void 0:o.version,depth:null==a?void 0:null===(i=a.data)||void 0===i?void 0:i.depth}),d.push(a))});var x=!d.length;return(0,l._)((0,i._)({id:c,type:x?"custom":"split",parent:[],data:{id:t.id,name:t.name,type:r||(t.is_chatflow?k.CHAT_FLOW:k.WORKFLOW),from:a,collapsed:!1,version:t.workflow_version,depth:e}},x?{meta:{isNodeEnd:!0}}:{}),{children:d})}}}}(0,u.gn)([(0,p.f)(s.pQ4),(0,u.w6)("design:type",void 0===s.pQ4?Object:s.pQ4)],O.prototype,"document",void 0),O=(0,u.gn)([(0,m.b)()],O);var Z=["block","blockIcon","root","inlineBlocks"];class F{get edges(){return this.treeService.edges}get treeNodes(){return this.filterTreeNode(this.document.getAllNodes())}get lines(){return this._lines}set lines(e){this._lines=e}filterTreeNode(e){return e.filter(e=>!Z.includes(e.flowNodeType))}getOutputFromInput(e){return{x:e.x,y:e.y+80}}bfsAddLine(e){for(var t,r=[e],n=[];r.length>0;)t=this,function(){var e=r.shift();if(e.next&&(n.push({from:e,to:e.next,fromPoint:t.getOutputFromInput(null===(i=e.getData(s.eGM))||void 0===i?void 0:i.inputPoint),toPoint:null===(l=e.next.getData(s.eGM))||void 0===l?void 0:l.inputPoint}),r.push(e.next)),null===(o=e.children)||void 0===o?void 0:o.length){if("root"===e.flowNodeType)r.push(e.children[0]);else if("split"===e.flowNodeType){var o,i,l,a,d,c=(null===(a=e.children[1])||void 0===a?void 0:a.children)||[],u=(null==c?void 0:null===(d=c.map(e=>{var t,r,n;return null==e?void 0:null===(n=e.children)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:null===(t=r.children)||void 0===t?void 0:t[0]}))||void 0===d?void 0:d.filter(Boolean))||[];u.forEach(r=>{var o,i;n.push({from:e,to:r,fromPoint:t.getOutputFromInput(null===(o=e.getData(s.eGM))||void 0===o?void 0:o.inputPoint),toPoint:null===(i=r.getData(s.eGM))||void 0===i?void 0:i.inputPoint})}),r.push(...u)}else e.children.forEach(r=>{var o,i;n.push({from:e,to:r,fromPoint:t.getOutputFromInput(null===(o=e.getData(s.eGM))||void 0===o?void 0:o.inputPoint),toPoint:null===(i=r.getData(s.eGM))||void 0===i?void 0:i.inputPoint})}),r.push(...e.children)}}();return n}initLines(){var e;if(null===(e=this._lines)||void 0===e?!void 0:!e.length)this.renderLines()}renderLines(){requestAnimationFrame(()=>{var e=this.bfsAddLine(this.document.originTree.root),t=(this.edges||[]).filter(e=>{var t=this.entityManager.getEntityById(e.from),r=this.entityManager.getEntityById(e.to);return t&&r&&!e.collapsed}).map(e=>{var t,r,n=this.entityManager.getEntityById(e.from),o=this.entityManager.getEntityById(e.to);return{from:n,to:o,fromPoint:this.getOutputFromInput(null===(t=n.getData(s.eGM))||void 0===t?void 0:t.inputPoint),toPoint:null===(r=o.getData(s.eGM))||void 0===r?void 0:r.inputPoint}});this._lines=[...e,...t];var r=this.entityManager.getEntity(v);null==r||r.updateVersion()})}constructor(){this._lines=[]}}(0,u.gn)([(0,p.f)(s.pQ4),(0,u.w6)("design:type",void 0===s.pQ4?Object:s.pQ4)],F.prototype,"document",void 0),(0,u.gn)([(0,p.f)(s.v2K),(0,u.w6)("design:type",void 0===s.v2K?Object:s.v2K)],F.prototype,"entityManager",void 0),(0,u.gn)([(0,p.f)(O),(0,u.w6)("design:type",void 0===O?Object:O)],F.prototype,"treeService",void 0),F=(0,u.gn)([(0,m.b)()],F);var M="resource-tree-custom-line";class z{get edges(){return this.treeService.getUnCollapsedEdges()}get hoveredLine(){return this._hoveredLine}getCloseInLineFromMousePos(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return((null===(t=this.linesManager)||void 0===t?void 0:t.lines)||[]).forEach(t=>{var i=j(e,t);i<=o&&(!n||n>=i)&&(n=i,r=t)}),r}updateHoverLine(e,t){!t&&this.onHoverLineEmitter.fire(void 0);var r=this.getCloseInLineFromMousePos(e);return r?(this.onHoverLineEmitter.fire(r),this._hoveredLine=r):(this.onHoverLineEmitter.fire(void 0),this._hoveredLine=void 0),r}backgroundClick(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(this.onBackgroundClickEmitter.fire(),this.renderStateEntity.setSelectNodes([]),this.renderStateEntity.setActivatedNode(void 0),this.hoveredLine){var t=b(this._hoveredLine);this.renderStateEntity.activeLines=[t]}else this.renderStateEntity.activeLines=[]}hoverCollapse(e){this.onHoverCollapseEmitter.fire(e)}getParent(e){return e?"blockIcon"!==e.flowNodeType?this.getParent(e.parent):e:e}selectNode(e){var t=this.getRelatedNodes(e);this.renderStateEntity.setSelectNodes(t),this.renderStateEntity.setActivatedNode(e);var r=[];this.linesManager.lines.map(e=>{var n=t.includes(e.from.id),o=t.includes(e.to.id);n&&o&&r.push(b(e))}),this.renderStateEntity.activeLines=r,this.linesManager.renderLines()}constructor(){this.onBackgroundClickEmitter=new s.Q5$,this.onBackgroundClick=this.onBackgroundClickEmitter.event,this.onHoverCollapseEmitter=new s.Q5$,this.onHoverCollapse=this.onHoverCollapseEmitter.event,this.onHoverLineEmitter=new s.Q5$,this.onHoverLine=this.onHoverLineEmitter.event,this.onSelectNodeEmitter=new s.Q5$,this.onSelectNode=this.onSelectNodeEmitter.event,this.traverseAncestors=e=>{var t=[];if(e.parent){var r=this.traverseAncestors(e.parent);t=t.concat(r)}return this.edges.forEach(r=>{if(r.to===h(e.id)){t.push(r.from);var n=this.document.getNode(x(r.from));if(n){var o=this.traverseAncestors(n);t.concat(o)}}}),t.push(e.id),t},this.traverseDescendants=e=>{var t,r,n=[];if((null===(t=e.children)||void 0===t?void 0:t.length)&&(null===(r=e.children)||void 0===r||r.forEach(e=>{n.push(e.id);var t=this.traverseDescendants(e);n=n.concat(t)})),e.next){var o=this.traverseDescendants(e.next);n=n.concat(o)}return n},this.getRelatedNodes=e=>[...this.traverseAncestors(e),...this.traverseDescendants(e)]}}(0,u.gn)([(0,p.f)(F),(0,u.w6)("design:type",void 0===F?Object:F)],z.prototype,"linesManager",void 0),(0,u.gn)([(0,p.f)(s.pQ4),(0,u.w6)("design:type",void 0===s.pQ4?Object:s.pQ4)],z.prototype,"document",void 0),(0,u.gn)([(0,p.f)(O),(0,u.w6)("design:type",void 0===O?Object:O)],z.prototype,"treeService",void 0),(0,u.gn)([(0,p.f)(s.v2K),(0,u.w6)("design:type",void 0===s.v2K?Object:s.v2K)],z.prototype,"entityManager",void 0),(0,u.gn)([(0,p.f)(_),(0,u.w6)("design:type",_)],z.prototype,"renderStateEntity",void 0),z=(0,u.gn)([(0,m.b)()],z);var R=(0,s.M1y)({onBind:e=>{var{bind:t}=e;t(F).toSelf().inSingletonScope(),t(z).toSelf().inSingletonScope(),t(O).toSelf().inSingletonScope(),(0,s.c$u)(t,_)}}),B={type:"split",extend:"dynamicSplit",onBlockChildCreate(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{document:n}=e,o=n.getNode("$inlineBlocks$".concat(e.id)),a=n.addNode({id:"$block$".concat(t.id),type:s.SyX.BLOCK,originParent:e,parent:o}),d=n.addNode((0,l._)((0,i._)({},t),{type:t.type||s.SyX.BLOCK,parent:a}),r);return r.push(a,d),a}},V=r("252237"),U=r.n(V),H=r("336205"),W=r("674343");function G(e){var{color:t}=e;return(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:"rotate(-90deg)"},children:[(0,a.jsx)("circle",{cx:"8",cy:"8",r:"7",fill:"transparent",stroke:t,strokeWidth:1.6}),(0,a.jsx)("path",{fill:t,d:"M10.8281 9.4715C11.0883 9.21131 11.0885 8.78909 10.8291 8.52804C10.6413 8.33892 10.4536 8.14952 10.266 7.9601C9.66706 7.35551 9.06799 6.75079 8.46068 6.15496C8.20439 5.90352 7.7947 5.90352 7.53841 6.15496C6.93103 6.75085 6.33191 7.35564 5.73291 7.96029C5.5454 8.14957 5.3579 8.33884 5.17017 8.52782C4.91075 8.78895 4.91096 9.21099 5.17124 9.47127C5.43152 9.73155 5.85355 9.73176 6.11383 9.47148L7.99955 7.58576L9.88548 9.4717C10.1457 9.73189 10.5679 9.73169 10.8281 9.4715Z"}),(0,a.jsx)("path",{fill:t,d:"M0.888672 7.99997C0.888672 4.07261 4.07242 0.888855 7.99978 0.888855C11.9271 0.888855 15.1109 4.07261 15.1109 7.99997C15.1109 11.9273 11.9271 15.1111 7.99978 15.1111C4.07242 15.1111 0.888672 11.9273 0.888672 7.99997ZM13.818 7.99997C13.818 4.78667 11.2131 2.18178 7.99978 2.18178C4.78649 2.18178 2.1816 4.78667 2.1816 7.99997C2.1816 11.2133 4.78649 13.8181 7.99978 13.8181C11.2131 13.8181 13.818 11.2133 13.818 7.99997Z"})]})}var K=r("761832");function J(e){var{collapseNode:t,hoverActivated:r}=e,n=(0,s.G2Z)(z),o=(0,s.G2Z)(O),i=(0,s.G2Z)(F),l=(0,s.G2Z)(s.v2K),c=(0,s.JAk)(),u=o.getNodeByIdFromTree(h(t.id)),{edges:p}=o,m=o.getUnCollapsedEdges(),v=!(null==t?void 0:null===(x=t.children)||void 0===x?void 0:x.length)&&!t.next&&!m.some(e=>e.from===t.id),{baseActivatedColor:_}=(0,s.XDS)(),f=()=>{setTimeout(()=>{i.renderLines()},50)};if((0,d.useEffect)(()=>{var e=l.onEntityChange(()=>{c()});return()=>{e.dispose()}},[]),v){var x,g,y=0;return u&&(y=(null===(g=u.children)||void 0===g?void 0:g.length)||0),(null==p?void 0:p.length)&&(y+=p.reduce((e,r)=>r.from===t.id?e+1:e,0)),(0,a.jsx)("div",{className:K.Z.container,onClick:e=>{if(e.stopPropagation(),u){var t;p.filter(e=>e.from===u.id&&e.collapsed).forEach(e=>e.collapsed=!1),null===(t=u.children)||void 0===t||t.forEach(e=>{"blockIcon"!==e.type&&(e.data.collapsed=!1)})}o.treeToFlowNodeJson(),f()},style:{background:r?"#82A7FC":"#BBBFC4"},"aria-hidden":"true",children:(0,a.jsx)("span",{style:{transform:"rotate(-90deg)"},children:y})})}return(0,a.jsx)("div",{className:K.Z.container,onClick:e=>{if(e.stopPropagation(),u){var t;p.filter(e=>e.from===u.id&&!e.collapsed).forEach(e=>e.collapsed=!0),null===(t=u.children)||void 0===t||t.forEach(e=>{"blockIcon"!==e.type&&(e.data.collapsed=!0)})}o.treeToFlowNodeJson(),f()},onMouseEnter:()=>{n.hoverCollapse(t)},onMouseLeave:()=>{n.hoverCollapse(void 0)},"aria-hidden":"true",onMouseMove:e=>e.stopPropagation(),children:(0,a.jsx)(G,{color:_})})}var q=d.createContext({}),$=r("915757"),X={[k.WORKFLOW]:"linear-gradient(#ebf9f0 0%, var(--coz-bg-plus) 100%)",[k.CHAT_FLOW]:"linear-gradient(#ebf9f0 0%, var(--coz-bg-plus) 100%)",[k.PLUGIN]:"linear-gradient(#fbf2ff 0%, var(--coz-bg-plus) 100%)",[k.KNOWLEDGE]:"linear-gradient(#fff5ed 0%, var(--coz-bg-plus) 100%)",[k.DATABASE]:"linear-gradient(#fef9eb 0%, var(--coz-bg-plus) 100%)"},Y={[k.WORKFLOW]:"edit_block_api_workflow",[k.CHAT_FLOW]:"wf_chatflow_76",[k.PLUGIN]:"edit_block_api_plugin",[k.KNOWLEDGE]:"datasets_title",[k.DATABASE]:"bot_database"},Q={[N.APP]:"",[N.LIBRARY]:"workflow_version_origin_text",[N.SHOP]:"navigation_store"},ee=r("351223"),et=e=>{var{type:t,from:r,loop:n,version:o}=e,i=Y[t],l=Q[r];return(0,a.jsxs)("div",{className:ee.Z["tag-container"],children:[(0,a.jsx)(W.Vp,{className:ee.Z.tag,color:"primary",children:H.o.t(i)}),l?(0,a.jsx)(W.Vp,{className:ee.Z.tag,color:"primary",children:H.o.t(l)}):null,o?(0,a.jsx)(W.Vp,{className:ee.Z.tag,color:"primary",children:o}):null,n?(0,a.jsx)(W.u,{content:H.o.t("reference_graph_node_loop_tip"),theme:"dark",children:(0,a.jsx)(W.Vp,{className:ee.Z.tag,color:"primary",children:(0,a.jsx)($.jrf,{style:{fill:"var(--coz-fg-hglt)"}})})}):null]})},er=r("968391"),en=r("708629"),eo=r("20424"),ei=r("998305"),el=r("114221"),ea=e=>{var{type:t,icon:r}=e,[n,o]=(0,d.useState)(!1);return r&&!n?(0,a.jsx)(W.EZ,{size:"small",type:"bot",src:r,onError:()=>o(!0)}):t===k.CHAT_FLOW?(0,a.jsx)(el.r,{}):t===k.WORKFLOW?(0,a.jsx)(er.r,{}):t===k.KNOWLEDGE?(0,a.jsx)(eo.r,{}):t===k.DATABASE?(0,a.jsx)(ei.r,{}):t===k.PLUGIN?(0,a.jsx)(en.r,{}):null},{Text:es}=W.ZT,ed=e=>{var t,r,n,{node:o}=e,c=function(e){var t=(0,d.useContext)(s.rQR),r=e||t,n=r.getData(s.LzJ),{node:o}=w(r),{expanded:a,activated:c}=n,u=(0,s.Dcz)(),p=(0,d.useCallback)(()=>{n.toggleMouseEnter()},[n]),m=(0,d.useCallback)(()=>{n.toggleMouseLeave()},[n]),v=(0,d.useCallback)(()=>{n.toggleExpand()},[n]),_=(0,d.useCallback)(()=>o.getExtInfo(),[o]),f=(0,d.useCallback)(e=>{o.updateExtInfo(e)},[o]),h=(0,d.useMemo)(()=>(0,s.CMu)(o),[o]),x=(0,ex.Re)(null==h?void 0:h.state),{readonly:g}=u.config;return(0,d.useMemo)(()=>({node:o,activated:c,readonly:g,expanded:a,onMouseEnter:p,onMouseLeave:m,getExtInfo:_,updateExtInfo:f,toggleExpand:v,get form(){if(!h)return;return(0,l._)((0,i._)({},h),{get values(){return h.values},get state(){return x}})}}),[o,c,g,a,p,m,_,f,v,h,x])}(),u=(0,s.G2Z)(O),p=c.getExtInfo(),[m,v]=(0,d.useState)(!1),{renderLinkNode:f}=(0,d.useContext)(q),{edges:x}=u,g=(0,d.useCallback)(()=>o.renderData.node||document.body,[]),[y,b]=(0,d.useState)(!1),j=(0,s.bPQ)(_,!0),k=h(o.id),N=j.selectNodes.includes(k),S=j.activatedNode?C(j.activatedNode).id:"",E=j.activatedNode?C(j.activatedNode).version:"",T=S===p.id,I=(null===(t=j.activatedNode)||void 0===t?void 0:t.id)===o.id,P=(0,s.G2Z)(z);(0,d.useEffect)(()=>{var e=P.onHoverLine(e=>{var t,r,n;(null==e?void 0:null===(t=e.from)||void 0===t?void 0:t.id)&&(null==o?void 0:null===(n=o.id)||void 0===n?void 0:n.includes(null==e?void 0:null===(r=e.from)||void 0===r?void 0:r.id))?b(!0):b(!1)});return()=>null==e?void 0:e.dispose()},[]);var A="blockIcon"===o.flowNodeType&&!(null==o?void 0:null===(r=o.children)||void 0===r?void 0:r.length)&&!o.next||(null===(n=x.find(e=>e.from===o.id))||void 0===n?void 0:n.collapsed),{loop:D}=p;return(0,a.jsx)(W.iV,{getPopupContainer:g,children:(0,a.jsxs)("div",{className:U()(ee.Z.nodeContainer,{[ee.Z.activated]:I||T,[ee.Z.highlight]:T||N}),style:{background:X[p.type]},onMouseEnter:()=>{v(!0),("custom"!==o.flowNodeType||x.some(e=>e.from===o.id))&&b(!0)},onMouseLeave:()=>{v(!1),b(!1)},onClick:e=>{P.backgroundClick(),P.selectNode(o),e.stopPropagation()},children:[(0,a.jsxs)("div",{className:ee.Z.header,children:[(0,a.jsx)("div",{className:ee.Z["icon-container"],children:(0,a.jsx)(ea,{type:p.type,icon:p.icon})}),(0,a.jsx)(es,{className:ee.Z.title,ellipsis:{showTooltip:{type:"tooltip",opts:{theme:"dark"}}},children:p.name}),m&&(null==f?void 0:f(p))||null]}),(0,a.jsx)(et,{type:p.type,from:p.from,loop:D,version:p.version}),y||A?(0,a.jsx)("div",{style:{position:"absolute",left:93,top:82,rotate:"90deg"},children:(0,a.jsx)(J,{node:o,collapseNode:o,collapsed:A,hoverActivated:m})}):null,T&&!I?(0,a.jsx)("div",{className:ee.Z["diff-tag"],children:E===p.version?H.o.t("reference_graph_tag_different_version_same_resource"):H.o.t("reference_graph_tag_different_version_of_same_resource")}):null]})})},ec=()=>{var e=(0,s.erw)(),t=(0,s.Dcz)(),[r,n]=(0,d.useState)(!1),o=(0,d.useMemo)(()=>(100*e.zoom).toFixed(0),[e.zoom]),i={padding:"8px",lineHeight:"16px"};return(0,a.jsx)(W.Lt,{clickToHide:!0,position:"top",trigger:"custom",visible:r,onClickOutSide:()=>n(!1),onVisibleChange:n,render:(0,a.jsxs)(W.Lt.Menu,{children:[(0,a.jsx)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.out",style:i,onClick:()=>e.zoomout(),children:H.o.t("workflow_toolbar_zoom_out")}),(0,a.jsx)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.in",style:i,onClick:()=>e.zoomin(),children:H.o.t("workflow_toolbar_zoom_in")}),(0,a.jsx)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.fit",style:i,onClick:()=>e.fitView(),children:H.o.t("workflow_toolbar_zoom_fit")}),(0,a.jsx)(W.iz,{className:"m-[4px] w-[108px]"}),(0,a.jsxs)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.50",style:i,onClick:()=>{t.config.updateZoom(.5)},children:[H.o.t("workflow_toolbar_zoom_to")," 50%"]}),(0,a.jsxs)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.100",style:i,onClick:()=>{t.config.updateZoom(1)},children:[H.o.t("workflow_toolbar_zoom_to")," 100%"]}),(0,a.jsxs)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.150",style:i,onClick:()=>{t.config.updateZoom(1.5)},children:[H.o.t("workflow_toolbar_zoom_to")," 150%"]}),(0,a.jsxs)(W.Lt.Item,{"data-testid":"workflow.detail.toolbar.zoom.200",style:i,onClick:()=>{t.config.updateZoom(2)},children:[H.o.t("workflow_toolbar_zoom_to")," 200%"]})]}),children:(0,a.jsxs)("div",{className:"workflow-toolbar-zoom flex justify-start items-center w-[70px] h-[24px] p-[2px] rounded-small border border-solid border-[var(--coz-stroke-plus)] cursor-pointer select-none","data-testid":"workflow.detail.toolbar.zoom",onClick:()=>n(!r),style:{borderColor:r?"var(--coz-stroke-hglt)":"var(--coz-stroke-plus)"},children:[(0,a.jsxs)("p",{className:"text-[12px] flex items-center mx-[4px] w-[40px] h-[20px]",children:[o,"%"]}),(0,a.jsx)("div",{className:"flex items-center justify-center pr-[2px] color-[var(--coz-fg-secondary)]",style:{color:"var(--coz-fg-secondary)"},children:(0,a.jsx)($.Wdl,{})})]})})},eu=e=>{var{minimapVisible:t,setMinimapVisible:r}=e;return(0,a.jsx)(W.u,{content:H.o.t("workflow_toolbar_minimap_tooltips"),children:(0,a.jsx)(W.hU,{icon:(0,a.jsx)($.Kky,{className:t?void 0:"coz-fg-primary"}),color:t?"highlight":"secondary",onClick:()=>r(!t)})})},ep=e=>{var{visible:t}=e,r=(0,s.G2Z)(c.I5);return t?(0,a.jsx)("div",{style:{position:"absolute",bottom:"60px",width:"198px",zIndex:99},children:(0,a.jsx)(c.Zd,{service:r,panelStyles:{},containerStyles:{pointerEvents:"auto",position:"relative",top:"unset",right:"unset",bottom:"unset",left:"unset"},inactiveStyle:{opacity:1,scale:1,translateX:0,translateY:0}})}):(0,a.jsx)(a.Fragment,{})},em=r("569603"),ev=()=>{var e=(0,s.Dcz)(),[t,r]=(0,d.useState)(()=>(0,em.c$)()),[n,o]=(0,d.useState)(!1),i=H.o.t(t===em.v6.Mouse?"workflow_mouse_friendly":"workflow_pad_friendly");function l(t){t===em.v6.Mouse?e.editorState.changeState(s.yyW.STATE_MOUSE_FRIENDLY_SELECT.id):t===em.v6.Pad&&e.editorState.changeState(s.yyW.STATE_SELECT.id),r(t)}return(0,d.useEffect)(()=>{var t;t=e=>e/20,e.config.updateConfig({mouseScrollDelta:t}),l((0,em.c$)())},[]),(0,a.jsx)(em.CJ,{children:(0,a.jsx)(W.u,{content:i,style:{display:n?"none":"block"},children:(0,a.jsx)("div",{className:"workflow-toolbar-interactive",children:(0,a.jsx)(em.vL,{value:t,onChange:e=>{r(e),l(e)},onPopupVisibleChange:o,containerStyle:{border:"none",height:"24px",width:"38px",justifyContent:"center",alignItems:"center",gap:"2px",padding:"4px",paddingTop:"1px",borderRadius:"var(--small, 6px)"},iconStyle:{margin:"0",width:"16px",height:"16px"},arrowStyle:{width:"12px",height:"12px",lineHeight:0}})})})})},e_=r("190764"),ef=()=>{var[e,t]=(0,d.useState)(!1);return(0,a.jsxs)("div",{className:e_.Z.tools,children:[(0,a.jsx)(ev,{}),(0,a.jsx)(eu,{minimapVisible:e,setMinimapVisible:t}),(0,a.jsx)(ep,{visible:e}),(0,a.jsx)(W.iz,{className:e_.Z.divider,layout:"vertical"}),(0,a.jsx)(ec,{})]})},eh=(e,t)=>(0,d.useMemo)(()=>({background:!0,readonly:!1,initialData:e,onDispose(){console.log("---- Playground Dispose ----")},nodeRegistries:[B],constants:{[s.cc3.BASE_ACTIVATED_COLOR]:"#5147ff",[s.cc3.INLINE_BLOCKS_PADDING_TOP]:44,[s.cc3.NODE_SPACING]:64},materials:{renderNodes:{[s.kDE.ADDER]:()=>null,[s.kDE.COLLAPSE]:J,[s.kDE.BRANCH_ADDER]:()=>null,[s.kDE.DRAG_NODE]:()=>null},renderDefaultNode:ed},onReady(e){var r=e.get(O);r.transformSchema(t),r.treeToFlowNodeJson(),setTimeout(()=>{e.playground.resize()},100)},onAllLayersRendered(e){e.get(F).initLines()},plugins:()=>[R({}),(0,c.qP)({disableLayer:!0,enableDisplayAllNodes:!0,canvasStyle:{canvasWidth:182,canvasHeight:102,canvasPadding:50,canvasBackground:"rgba(245, 245, 245, 1)",canvasBorderRadius:10,viewportBackground:"rgba(235, 235, 235, 1)",viewportBorderRadius:4,viewportBorderColor:"rgba(201, 201, 201, 1)",viewportBorderWidth:1,viewportBorderDashLength:2,nodeColor:"rgba(255, 255, 255, 1)",nodeBorderRadius:2,nodeBorderWidth:.145,nodeBorderColor:"rgba(6, 7, 9, 0.10)",overlayColor:"rgba(255, 255, 255, 0)"},inactiveDebounceTime:1})]}),[]),ex=r("816697"),eg=r("473980"),ey=s.nYJ.DEFAULT,eb=r("702570"),ej=r("643095"),ew="rgba(216, 219, 232, 1)",eC="#5147FF",ek=e=>{var{line:t,path:r,fromEntity:n,toPos:o,activated:i,hovered:l,setHovered:c}=e,u=(0,s.G2Z)(z);return((0,d.useEffect)(()=>{var e=u.onHoverCollapse(e=>{(null==e?void 0:e.id)&&(null==e?void 0:e.id.includes(n.id))?c(!0):c(!1)}),r=u.onHoverLine(e=>{b(e)===b(t)?c(!0):c(!1)});return()=>{e.dispose(),null==r||r.dispose()}},[]),n.collapsed)?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{className:M,d:r,stroke:i||l?eC:ew,strokeWidth:2,fill:"none"}),(0,a.jsx)("polygon",{className:M,points:"".concat(o.x,",").concat(o.y," ").concat(o.x-4.5,",").concat(o.y-7," ").concat(o.x+4.5,",").concat(o.y-7),fill:i||l?eC:ew})]})};function eN(e){var{activated:t,line:r}=e,[n,o]=(0,d.useState)(!1),{from:i}=r,l=y(r.fromPoint,r.toPoint),s=function(e){var t,r,{fromPos:n}=e,o={x:e.toPos.x,y:e.toPos.y-7},{controls:i}=e,l={x:o.x,y:o.y};return t=i.map(e=>"".concat(e.x," ").concat(e.y)).join(","),r=1===i.length?"S":"C","M".concat(n.x," ").concat(n.y," ").concat(r," ").concat(t,", ").concat(l.x," ").concat(l.y)}({fromPos:r.fromPoint,toPos:r.toPoint,controls:l});return(0,a.jsx)(ek,{line:r,path:s,fromEntity:i,toPos:r.toPoint,activated:t,hovered:n,setHovered:o})}var eS=e=>{var{viewBox:t,lines:r,isViewportVisible:n,version:o}=e,[i,l]=(0,d.useState)([]),c=(0,s.bPQ)(_,!0);(0,d.useEffect)(()=>{l(c.activeLines)},[c.activeLines]);var u=r.filter(e=>n(s.AeJ.createRectangleWithTwoPoints(e.fromPoint,e.toPoint).pad(10))),p=u.filter(e=>i.some(t=>t===b(e))),m=[...u.filter(e=>!i.some(t=>t===b(e))),...p];return(0,a.jsx)("svg",{className:"flow-lines-container",width:"1000",height:"1000",overflow:"visible",viewBox:t,xmlns:"http://www.w3.org/2000/svg",children:m.map(e=>{var t=i.some(t=>t===b(e));return(0,a.jsx)(eN,{line:e,activated:t},"".concat(b(e)).concat(o))})},(0,f.x0)(5))};class eE extends s.mh4{onZoom(){var e,t=this.node.querySelector("svg.flow-lines-container");null==t||null===(e=t.setAttribute)||void 0===e||e.call(t,"viewBox",this.viewBox)}onReady(){this.node.style.zIndex="1",this.toDispose.pushAll([this.listenPlaygroundEvent("click",()=>{this.hoverService.backgroundClick()}),this.listenPlaygroundEvent("mousemove",e=>{var t=[...this.playgroundNode.querySelectorAll(".".concat(M))].some(t=>t.contains(e.target)),r=this.config.getPosFromMouseEvent(e);this.hoverService.updateHoverLine(r,t)})])}get viewBox(){var e=1e3/this.config.finalScale;return"0 0 ".concat(e," ").concat(e)}render(){var e,t,r,n=this.config.isViewportVisible.bind(this.config);return(null===(e=this.documentTransformer)||void 0===e?void 0:e.loading)?(0,a.jsx)(a.Fragment,{}):(null===(r=this.documentTransformer)||void 0===r||null===(t=r.refresh)||void 0===t||t.call(r),(0,a.jsx)(eS,{viewBox:this.viewBox,isViewportVisible:n,lines:this.linesManager.lines,version:this.renderState.config.version}))}constructor(...e){super(...e),this.node=s.xFV.createDivWithClass("gedit-flow-lines-layer"),this.onViewportChange=(0,ej.Z)(()=>{this.render()},100)}}(0,u.gn)([(0,p.f)(s.pQ4),(0,u.w6)("design:type",void 0===s.pQ4?Object:s.pQ4)],eE.prototype,"document",void 0),(0,u.gn)([(0,p.f)(F),(0,u.w6)("design:type",void 0===F?Object:F)],eE.prototype,"linesManager",void 0),(0,u.gn)([(0,p.f)(z),(0,u.w6)("design:type",void 0===z?Object:z)],eE.prototype,"hoverService",void 0),(0,u.gn)([(0,s.O06)(s.Vlw),(0,u.w6)("design:type",void 0===s.Vlw?Object:s.Vlw)],eE.prototype,"documentTransformer",void 0),(0,u.gn)([(0,s.O06)(v),(0,u.w6)("design:type",v)],eE.prototype,"renderState",void 0),eE=(0,u.gn)([(0,m.b)()],eE);class eT{registerDocument(e){e.registerFlowNodes(s.t9U.RootRegistry,s.t9U.StartRegistry,s.t9U.DynamicSplitRegistry,s.t9U.BlockRegistry,s.t9U.InlineBlocksRegistry,s.t9U.BlockIconRegistry,s.t9U.EmptyRegistry),e.registerNodeDatas(s.LzJ,s.Xr5,s.eGM)}registerRenderer(e){e.registerLayers(s.V7e,s.Emw,eE,s.wYF,s.qq0,s.lVg)}}eT=(0,u.gn)([(0,m.b)()],eT);var eI=new eb.n(e=>{(0,s.KVE)(e,eT,[s.Lwd,s.OKI])}),eP=(0,d.forwardRef)(function(e,t){var{parentContainer:r,children:n}=e,o=(0,eg._)(e,["parentContainer","children"]),c=(0,d.useMemo)(()=>{var e;return e=o,t=>{e=(0,i._)({},ey,e);var r=[(0,s.f_u)(e)];return(r=(0,s.Fu1)(e,r)(t)).push((0,s.d3V)({containerModules:[eI],onBind(t){!t.isBound(s.h3M)&&t.bind(s.h3M).toConstantValue((0,l._)((0,i._)({},s.XsM),{jsonAsV2:!0,defaultLayout:e.defaultLayout,toNodeJSON:e.toNodeJSON,fromNodeJSON:e.fromNodeJSON,allNodesDefaultExpanded:e.allNodesDefaultExpanded}))},onInit:t=>{var r,n;t.playground.registerLayers(s.Emw,s.V7e),!(null===(r=e.scroll)||void 0===r?void 0:r.disableScrollLimit)&&t.playground.registerLayer(s.qq0),!(null===(n=e.scroll)||void 0===n?void 0:n.disableScrollBar)&&t.playground.registerLayer(s.lVg),e.nodeRegistries&&t.document.registerFlowNodes(...e.nodeRegistries)}})),(0,s.esp)(e,r)(t)}},[]),u=(0,d.useCallback)(e=>(0,l._)((0,i._)({},(0,s.FwO)(e)),{get document(){return e.get(s.pQ4)}}),[]);return(0,a.jsx)(s.W6u,{ref:t,plugins:c,customPluginContext:u,parentContainer:r,children:n})});r("913292");var eA=e=>{var{className:t,data:r,renderLinkNode:n}=e,o=eh({nodes:[]},r);return(0,a.jsx)(eP,(0,l._)((0,i._)({},o),{children:(0,a.jsx)(q.Provider,{value:{renderLinkNode:n},children:(0,a.jsxs)("div",{className:t,children:[(0,a.jsx)(s.R6T,{}),(0,a.jsx)(ef,{})]})})}))}},304194:function(e,t,r){r.d(t,{j:()=>c});var n=r("825955"),o=r("808549"),i=r("120454"),l=r("61111"),a=r("297158"),s=r("921463");class d{constructor(){this._listeners=new Set,this._produce=e=>{var t=(0,l.Uy)(this._state,e);t!==this._state&&(this._state=t,this._dispatch())},this._dispatch=()=>{if(!!this._listeners.size)(0,s.unstable_batchedUpdates)(()=>{this._listeners.forEach(e=>e())})},this.subscribe=e=>(this._listeners.add(e),()=>{this._listeners.delete(e)}),this.getSnapshot=()=>this._state,(0,l.MD)()}}new class e extends d{add(e){this._produce(t=>{t.add(e)})}delete(e){this._produce(t=>{t.delete(e)})}constructor(...e){super(...e),this._state=new Set}};class c extends d{get featureMap(){return this._state.featureMap}getFeature(e){var t=this.getFeatureKey(e),r=this.featureMap.get(t);if(!r){a.kg.error({error:Error("[Message Feature]: ".concat(this.name," get feature not exist ").concat(e))});return}return r}getFeatureKey(e){return"feature_".concat(this.name,"_").concat(e)}getName(){return this.name}_register(e,t){var{defaultFeature:r}=this,{type:n}=t,o=this.getFeatureKey(n);if(r&&n===r.type){a.kg.error({error:Error("[Message Feature]: ".concat(this.name," register type is default feature ").concat(n))});return}this._state.featureMap.get(o)&&a.kg.warning("[Message Feature]: ".concat(this.name," register feature already registered ").concat(n)),e.featureMap.set(o,(0,l.cA)(t))}register(e){return this._produce(t=>{this._register(t,e)}),()=>{this._produce(t=>{this._deregister(t,e.type)})}}registerSome(e){return this._produce(t=>{e.map(e=>this._register(t,e))}),()=>{this._produce(t=>{e.forEach(e=>{this._deregister(t,e.type)})})}}_deregister(e,t){var{defaultFeature:r}=this,n=this.getFeatureKey(t);if(r&&t===r.type){a.kg.error({error:Error("[Message Feature]: ".concat(this.name," deregister type is default feature ").concat(t))});return}if(!this._state.featureMap.get(n)){a.kg.error({error:Error("[Message Feature]: ".concat(this.name," deregister invalid feature ").concat(t))});return}e.featureMap.delete(n)}deregister(e){this._produce(t=>{this._deregister(t,e)})}deregisterSome(e){this._produce(t=>{e.forEach(e=>{this._deregister(t,e)})})}deregisterAll(){this._produce(e=>{e.featureMap=new Map})}load(e){var t=this;return(0,n._)(function*(){var r=t.getFeature(e);if(!r){a.kg.error({error:Error("[Message Feature]: ".concat(t.name," load unknown feature ").concat(e))});return}if(!r.loader){a.kg.error({error:Error("[Message Feature]: ".concat(t.name," load feature loader unset ").concat(e))});return}var n=yield r.loader();t._produce(r=>{var o=r.featureMap.get(t.getFeatureKey(e));o&&(o.module=(0,l.cA)(n.default))})})()}isLoaded(e){var t=this.getFeature(e);return t?!!t.module||!1:(a.kg.error({error:Error("[Message Feature]: ".concat(this.name," isLoaded unknown feature ").concat(e))}),!1)}has(e){return!!this.getFeature(e)}getModule(e){var t=this.getFeature(e);if(!t){a.kg.error({error:Error("[Message Feature][getModule]: ".concat(this.name," get feature not exist ").concat(e))});return}if(!t.module){a.kg.error({error:Error("[Message Feature][getModule]: ".concat(this.name," get feature module unset ").concat(e))});return}return t.module}get(e){var t=this.getFeature(e);if(!t){a.kg.error({error:Error("[Message Feature][get]: ".concat(this.name," get feature not exist ").concat(e))});return}if(!t.module){a.kg.error({error:Error("[Message Feature][get]: ".concat(this.name," get feature module unset ").concat(e))});return}return(0,i._)((0,o._)({},t.module),{type:e})}getAsync(e){var t=this;return(0,n._)(function*(){var r=t.getFeature(e);if(!r){a.kg.error({error:Error("[Message Feature]: ".concat(t.name," getAsync unknown feature ").concat(e))});return}return!r.module&&(yield t.load(e)),t.get(e)})()}entries(){var{featureMap:e}=this;return[...e.values()].filter(e=>(!e.module&&a.kg.warning("[Message Feature][entries]: ".concat(this.name," entries module unloaded feature.type=").concat(e.type)),null!==e.module&&void 0!==e.module)).map(e=>[e.type,e.module])}getAllAsync(){var e=this;return(0,n._)(function*(){var{featureMap:t}=e,r=[...t.values()];return(yield Promise.all(r.map(t=>e.getAsync(t.type)))).filter(e=>!!e)})()}getTypeByContext(e){var t,r,{featureTypeParser:n}=this;if(!n)return a.kg.error({error:Error("[Message Feature]: ".concat(this.name," getTypeByContext featureTypeParser unset"))}),null!==(t=this.getDefaultType())&&void 0!==t?t:"";try{return n(e)}catch(e){return a.kg.error({error:Error("[Message Feature]: ".concat(this.name," getTypeByContext featureTypeParser error ").concat(e))}),null!==(r=this.getDefaultType())&&void 0!==r?r:""}}getByContext(e){var t=this.getTypeByContext(e);return this.get(t)}getByContextAsync(e){var t=this;return(0,n._)(function*(){var r=t.getTypeByContext(e);return t.getAsync(r)})()}getDefault(){if(!!this.defaultFeature)return(0,o._)({type:this.defaultFeature.type},this.defaultFeature.module)}getDefaultType(){var e;return null===(e=this.defaultFeature)||void 0===e?void 0:e.type}setDefaultFeature(e){var{type:t}=e,r=this.getFeatureKey(t);this.defaultFeature=e,this._produce(t=>{t.featureMap.set(r,(0,l.cA)(e))})}setFeatureTypeParser(e){this.featureTypeParser=e.bind({internalHas:e=>{try{var t=this.getFeatureKey(e);return!!this.featureMap.get(t)}catch(e){return a.kg.error({error:Error("[Message Feature]: ".concat(this.name," featureTypeParser internalHas error ").concat(e))}),!1}}})}deregisterByTag(e){var{featureMap:t}=this,r=[...t.values()].filter(t=>{var r;return null===(r=t.tags)||void 0===r?void 0:r.includes(e)});this._produce(e=>{r.forEach(t=>{this._deregister(e,t.type)})})}getByTag(e){var{featureMap:t}=this,r=[...t.values()].filter(t=>{var r;return null===(r=t.tags)||void 0===r?void 0:r.includes(e)});return r.length?r.map(e=>this.get(e.type)).filter((e,t)=>(!e&&a.kg.warning("[Message Feature]: ".concat(this.name," getByTag module unloaded features[index].type=").concat(r[t].type)),!!e)):(a.kg.warning("[Message Feature]: ".concat(this.name," getByTag no feature include tag ").concat(e)),[])}getByTagAsync(e){var t=this;return(0,n._)(function*(){var{featureMap:r}=t,n=[...r.values()].filter(t=>{var r;return null===(r=t.tags)||void 0===r?void 0:r.includes(e)});return n.length?(yield Promise.all(n.map(e=>t.getAsync(e.type)))).filter(e=>!!e):(a.kg.warning("[Message Feature]: ".concat(t.name," getByTagAsync no feature include tag ").concat(e)),[])})()}constructor(e){super();var{name:t,defaultFeature:r,features:n,featureTypeParser:o}=e;this.name=t,this._state={featureMap:new Map},r&&this.setDefaultFeature(r),n&&this.registerSome(n),o&&this.setFeatureTypeParser(o)}}},420998:function(e,t,r){r.d(t,{SA:()=>a,Tn:()=>s,yt:()=>M,Is:()=>f});var n=r("825955"),o=r("151064"),i=r("455069"),l=r("674343"),a=e=>{var{fileUrl:t}=e,[r,a]=(0,i.useState)(""),[s,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{fetch(t).then(e=>e.text()).then(e=>{d(!1),a(e)})},[t]);var c=(0,i.useRef)(null);return(0,i.useEffect)(()=>{function e(){return(e=(0,n._)(function*(){if(c.current){for(var e=0,t=r.length;e<Math.ceil(t/5e4);e++)yield new Promise(e=>setTimeout(e,10)),c.current.textContent+=r.slice(5e4*e,(e+1)*5e4);c.current.textContent=r}})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[r]),(0,o.jsx)("div",{className:"flex flex-col items-center w-full h-full flex-1 py-2 px-4",children:(0,o.jsx)(l.yC,{wrapperClassName:"w-full h-full grow",spinning:s,childStyle:{width:"100%",height:"100%",flexGrow:1},children:r?(0,o.jsx)("div",{children:(0,o.jsx)("pre",{className:"max-w-full overflow-auto whitespace-pre-wrap break-all text-[14px] leading-[22px]",ref:c})}):null})})},s=e=>{var{fileUrl:t}=e,[r,a]=(0,i.useState)(""),[s,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{fetch(t).then(e=>e.text()).then(e=>{d(!1),a(e)})},[t]);var c=(0,i.useRef)(null);return(0,i.useEffect)(()=>{function e(){return(e=(0,n._)(function*(){if(c.current){for(var e=0,t=r.length;e<Math.ceil(t/5e4);e++)yield new Promise(e=>setTimeout(e,10)),c.current&&(c.current.textContent+=r.slice(5e4*e,(e+1)*5e4));c.current&&(c.current.textContent=r)}})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[r]),(0,o.jsx)("div",{className:"flex flex-col items-center w-full h-full flex-1 py-2 px-4",children:(0,o.jsx)(l.yC,{wrapperClassName:"w-full h-full grow",spinning:s,childStyle:{width:"100%",height:"100%",flexGrow:1},children:(0,o.jsx)("pre",{className:"max-w-full overflow-auto whitespace-pre-wrap break-all text-[14px] leading-[22px]",ref:c})})})},d=r("262941"),c=r("876945"),u=r("90265"),p=r("252237"),m=r.n(p),v=r("910656");r("107440"),r("887869"),d.GlobalWorkerOptions.workerSrc="//lf-cdn.coze.cn/obj/unpkg/pdfjs-dist/".concat(d.version,"/build/pdf.worker.min.mjs");var _={cMapUrl:"//lf-cdn.coze.cn/obj/unpkg/pdfjs-dist/".concat(d.version,"/cmaps/"),cMapPacked:!0},f=e=>{var t,r,{fileUrl:n}=e,[a,s]=(0,i.useState)(!0),[d,p]=(0,i.useState)(0),[f,h]=(0,i.useState)(0),x=(0,i.useRef)(null),g=(0,i.useRef)(null),[y,b]=(0,i.useState)(null===(t=x.current)||void 0===t?void 0:t.clientHeight),j=Math.floor((null!=y?y:500)+20),w=e=>{var{scrollOffset:t}=e;h(Math.floor(t/j))},[C,k]=(0,i.useState)(1),N=(0,i.useMemo)(()=>a?null:(0,o.jsx)(v.qj,{children:e=>{var{height:t,width:r}=e;return(0,o.jsx)(v.t7,{height:null!=t?t:0,itemCount:d,itemSize:j,width:null!=r?r:0,onScroll:w,ref:g,children:e=>{var t,{index:n,style:i}=e;return(0,o.jsx)("div",{style:i,children:(0,o.jsx)(c.Z,{pageNumber:n+1,className:m()("flex items-center justify-center !coz-bg-primary"),width:(null!=r?r:100)-32,scale:C,onLoadSuccess:e=>{b(e.height)},loading:(0,o.jsx)("div",{style:{height:null===(t=x.current)||void 0===t?void 0:t.clientHeight}})})},"page_".concat(n+1))}})}}),[a,d,y,C,j]);return{pdfNode:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"flex flex-col items-center w-full h-full relative coz-bg-primary",children:[(0,o.jsx)("div",{className:m()("absolute top-0 left-0 right-0 bot-0 flex items-center justify-center h-full","z-10",!a&&"invisible"),children:(0,o.jsx)(l.yC,{})}),(0,o.jsx)("div",{className:m()("flex absolute top-0 left-0 right-0 overflow-auto px-5 w-full h-full justify-center",a&&"invisible"),ref:x,children:(0,o.jsx)(u.Z,{file:n,onLoadSuccess:e=>{var{numPages:t}=e;s(!1),p(t)},options:_,className:m()("flex w-full h-full"),loading:(0,o.jsx)(l.yC,{wrapperClassName:"w-full h-full",childStyle:{width:null===(r=x.current)||void 0===r?void 0:r.clientWidth,height:"100%"}}),children:x.current?N:null},n)})]})}),numPages:d,currentPage:f+1,onNext:()=>{if(f<d-1){var e,t=f+1;h(t),null===(e=g.current)||void 0===e||e.scrollToItem(t,"start")}},onBack:()=>{if(f>0){var e,t=f-1;h(t),null===(e=g.current)||void 0===e||e.scrollToItem(t,"start")}},scale:C,increaseScale:()=>{k(e=>Math.min(e+.1,2))},decreaseScale:()=>{k(e=>Math.max(e-.1,.5))}}},h=r("336205"),x=r("915757"),g=r("728901");r("615739");var y=r("127139"),b=r("193604");r("541269");var j=r("808549"),w=r("602042"),C=r("675210"),k=r("120454"),N=r("628949"),S=r("335740"),E=e=>{var t,r,n=e.find(e=>-1===e.parent&&"title"===e.type);return n?[(0,k._)((0,j._)({},n),{id:null===(t=n.id)||void 0===t?void 0:t.toString(),parent:null===(r=n.parent)||void 0===r?void 0:r.toString(),children:T(n,e)})]:e.map(e=>{var t;return(0,k._)((0,j._)({},e),{id:e.id.toString(),parent:null===(t=e.parent)||void 0===t?void 0:t.toString(),children:[]})})},T=(e,t)=>{var r;return(null!==(r=e.children)&&void 0!==r?r:[]).reduce((e,r)=>{var n,o,i=t.find(e=>e.id===r);return i?[...e,(0,k._)((0,j._)({},i),{id:null===(n=i.id)||void 0===n?void 0:n.toString(),parent:null===(o=i.parent)||void 0===o?void 0:o.toString(),children:T(i,t)})]:[...e]},[])},I=e=>{var t=new Set,r=e=>{if(!!e&&!!e.id){var{children:n}=e;n&&n.length&&n.forEach(e=>{e&&e.id&&(t.add(e.id),r(e))})}};return r(e),t},P=(e,t)=>{var r=function(t){var r=n.findIndex(e=>e.id.toString()===t);if(-1===r)return"continue";var o=n[r],i=n.find(t=>t.id.toString()===e.parentID);if(!i)return{v:{segments:null,errMsg:h.o.t("knowledge_hierarchies_categories_02")}};var l=i.children.indexOf(o.id)<e.dropIndex&&o.parent===i.id?e.dropIndex-1:e.dropIndex;if(o.parent!==i.id){var a=n.find(e=>e.id===o.parent);null==a||a.children.splice(a.children.indexOf(o.id),1),o.parent=i.id}i.children=i.children.filter(e=>e!==o.id),i.children.splice(l,0,o.id)};if(null===e.parentID)return{segments:null,errMsg:h.o.t("knowledge_hierarchies_categories_01")};var n=(0,S.Z)(t);for(var o of e.dragIDs){var i=r(o);if("object"===(0,N._)(i))return i.v}return{segments:n,errMsg:null}},A=(e,t)=>{var r=function(e){var t=n.findIndex(t=>t.id.toString()===e),r=n.find(e=>e.id===n[t].parent);r&&(r.children=r.children.filter(e=>e!==n[t].id)),n.splice(t,1)},n=(0,S.Z)(t);for(var o of e)r(o);return n},D=(e,t,r)=>{var n=function(e){var t,r=o.find(t=>t.id.toString()===e);if(!r)return{v:{segments:null,errMsg:h.o.t("knowledge_hierarchies_categories_04")}};var n=o.find(e=>e.id===r.parent);if(n&&(n.children=n.children.filter(e=>e!==r.id)),["table","image","title"].includes(null!==(t=null==r?void 0:r.type)&&void 0!==t?t:""))r.parent=i.id,i.children.push(r.id);else{i.text+=r.text;var l=o.findIndex(e=>e.id===r.id);-1!==l&&o.splice(l,1)}},o=(0,S.Z)(r),i=o.find(t=>t.id.toString()===e);if(!i||-1===i.parent&&"title"===i.type)return{segments:null,errMsg:h.o.t("knowledge_hierarchies_categories_03")};for(var l of(i.children=[],i.type="section-text",t)){var a=n(l);if("object"===(0,N._)(a))return a.v}return{segments:o,errMsg:null}},L=r("22916"),O=e=>{var{segments:t,setLevelSegments:r,setSelectionIDs:n,disabled:a}=e,[s,d]=(0,i.useState)(new Set),[c,u]=(0,i.useState)(new Set),{ref:p,width:v,height:_}=(0,C.Z)(),f=e=>{d(new Set([e.id])),u(I(e)),null==n||n([e.id,...I(e)])},{popoverNode:g,onContextMenu:y}=function(e){var t,r,{onDelete:n,onMerge:a}=e,[s,d]=(0,i.useState)(),[c,u]=(0,i.useState)(!1),[p,m]=(0,i.useState)({top:0,left:0}),v=(0,L.kF)();return{popoverNode:(0,o.jsx)(l.v2,{visible:c,onVisibleChange:u,onClickOutSide:()=>{u(!1),d(null)},trigger:"custom",position:"bottomLeft",render:(0,o.jsxs)(l.oU,{mode:"menu",children:[!s||(null===(t=s.children)||void 0===t?void 0:t.length)?null:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(l.v2.Item,{isMenu:!0,onClick:()=>{n(s.data),u(!1)},children:h.o.t("knowledge_level_028")})}),s&&(null===(r=s.children)||void 0===r?void 0:r.length)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.v2.Item,{isMenu:!0,onClick:()=>{a(s.data),u(!1)},children:h.o.t("knowledge_level_029")}),(0,o.jsx)(l.v2.Item,{isMenu:!0,onClick:()=>{n(s.data),u(!1)},children:h.o.t("knowledge_level_028")})]}):null]}),children:(0,o.jsx)("div",{style:{height:0,width:0,position:"fixed",top:p.top,left:p.left}})}),onContainerScroll:()=>{c&&u(!1)},onContextMenu:(e,t)=>{e.preventDefault(),d(t);var r=e.pageX,n=e.pageY,o=document.getElementById("coze-project:///knowledge/".concat(v.datasetID));if(o){var{left:i,top:l}=o.getBoundingClientRect();r-=i,n-=l}m({left:r,top:n}),u(!0)}}}({onMerge:e=>{var{segments:n,errMsg:o}=D(e.id,Array.from(I(e)),t);o&&l.FN.error(o),(null==n?void 0:n.length)&&(null==r||r(n))},onDelete:e=>{var n=A([e.id,...I(e)],t);null==r||r(n)}});return(0,o.jsxs)("div",{ref:p,className:"w-full h-full relative translate-z-0",children:[(0,o.jsx)(w.m,{data:E(t),disableDrag:a,disableDrop:a,onMove:e=>{var{dragIds:n,parentId:o,index:i}=e,{segments:a,errMsg:s}=P({dragIDs:n,parentID:o,dropIndex:i},t);s&&l.FN.error(s),(null==a?void 0:a.length)&&(null==r||r(a))},rowHeight:34,paddingTop:4,paddingBottom:4,width:v,height:_,renderCursor:Z,children:e=>{var t,{node:r,style:n,dragHandle:i}=e,{isOpen:d,data:u}=r,p=!(null===(t=u.children)||void 0===t?void 0:t.length),v=(0,o.jsx)(l.hU,{size:"small",color:"secondary",icon:(0,o.jsx)(x.x5d,{className:m()(d&&"rotate-90","transition duration-150 ease-in-out")}),onClick:e=>{e.stopPropagation(),r.toggle()},className:m()("bg-transparent ml-[4px] shrink-0")});return(0,o.jsxs)("div",{className:m()("flex items-center gap-[4px]","h-[32px] py-[4px] pr-[8px] mb-[2px]","hover:coz-mg-primary cursor-pointer","transition duration-150 ease-in-out","rounded-[8px]",(s.has(u.id)||c.has(u.id))&&"coz-mg-primary"),onClick:()=>{f(u)},onContextMenu:e=>{if(!a)y(e,r)},style:n,ref:i,children:[p?(0,o.jsx)("span",{className:"w-6 ml-[4px] shrink-0"}):v,(0,o.jsx)("span",{className:m()("text-[14px] leading-[20px] coz-fg-primary truncate"),children:"image"!==u.type?u.text.slice(0,50):h.o.t("knowledge_level_110")})]})}}),g]})},Z=e=>{var{top:t,left:r,indent:n}=e;return(0,o.jsx)("div",{style:(0,j._)({},{display:"flex",alignItems:"center",zIndex:1},{position:"absolute",pointerEvents:"none",top:"".concat(t-2,"px"),left:"".concat(r,"px"),right:"".concat(n,"px")}),children:(0,o.jsx)("div",{className:m()("flex-1 h-[2px] coz-mg-hglt-plus")})})},F=e=>{var{id:t,onClick:r,title:n,selected:i,tag:a,label:s}=e;return(0,o.jsx)("div",{className:m()("w-full h-8 px-2 py-[6px] rounded-[8px] hover:coz-mg-primary cursor-pointer","flex items-center",i&&"coz-mg-primary"),onClick:()=>null==r?void 0:r(t),children:s?(0,o.jsx)("div",{className:"w-full",children:s}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.ZT.Text,{ellipsis:{showTooltip:!0},className:"w-full coz-fg-primary text-[14px] leading-[20px] grow truncate",children:n}),(0,o.jsx)("div",{className:"flex items-center shrink-0",children:a})]})})},M=e=>{var{isSearchable:t,list:r,onClick:n,selectedID:a,levelSegments:s,setLevelSegments:d,setSelectionIDs:c,treeDisabled:u,treeVisible:p}=e,[v,_]=(0,i.useState)("");return(0,o.jsxs)("div",{className:"flex flex-col grow w-full h-full",children:[t?(0,o.jsx)(l.ol,{value:v,placeholder:h.o.t("datasets_placeholder_search"),onChange:_}):null,(0,o.jsx)("div",{className:"pl-2 h-6 mt-4 mb-1 flex items-center",children:(0,o.jsx)("div",{className:"coz-fg-secondary text-[12px] font-[400] leading-4 shrink-0",children:h.o.t("knowledge_level_012")})}),(0,o.jsxs)("div",{className:"flex flex-col grow w-full",children:[(0,o.jsx)("div",{className:"flex flex-col gap-1 h-[150px] grow !overflow-auto shrink-0",children:r.filter(e=>e.title.includes(v)).map(e=>""!==e.id?(0,o.jsx)(F,{id:e.id,selected:e.id===a,onClick:n,title:e.title,tag:e.tag,label:e.label},e.id):null)}),(null==s?void 0:s.length)&&p?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"h-4 flex justify-center items-center px-[8px] mb-[8px]",children:(0,o.jsx)("div",{className:m()("border border-solid border-[0.5px] transition w-full","coz-stroke-primary")})}),(0,o.jsxs)("div",{className:"flex flex-col gap-1 !overflow-auto",children:[(0,o.jsxs)("div",{className:"w-full pl-2 h-6 items-center flex gap-[4px]",children:[(0,o.jsx)("div",{className:"coz-fg-secondary text-[12px] font-[400] leading-4 shrink-0",children:h.o.t("knowledge_level_adjust")}),u?null:(0,o.jsx)(l.u,{style:{maxWidth:602},position:"left",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"coz-fg-plus text-[14px] font-[500] leading-[20px] mb-3",children:h.o.t("knowledge_hierarchies_categories")}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-1 justify-between w-[182px]",children:[(0,o.jsx)("span",{className:"coz-fg-primary text-[12px] leading-[16px] font-[400]",children:h.o.t("level_999")}),(0,o.jsx)("img",{src:y,className:"w-[182px]"})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-1 justify-between w-[182px]",children:[(0,o.jsx)("span",{className:"coz-fg-primary text-[12px] leading-[16px] font-[400]",children:h.o.t("level_998")}),(0,o.jsx)("img",{src:g,className:"w-[182px]"})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-1 justify-between w-[182px]",children:[(0,o.jsx)("span",{className:"coz-fg-primary text-[12px] leading-[16px] font-[400]",children:h.o.t("level_997")}),(0,o.jsx)("img",{src:b,className:"w-[182px]"})]})]})]}),children:(0,o.jsx)(x.L03,{className:"coz-fg-secondary"})})]}),(0,o.jsx)("div",{className:"h-[360px]",children:(0,o.jsx)(O,{segments:s,setLevelSegments:d,setSelectionIDs:c,disabled:u})})]})]}):null]})]})};r("461654"),r("136710"),r("347852"),r("601142")},788911:function(e,t,r){r.d(t,{OR:function(){return l},YB:function(){return i}});var n=r(455069),o=r(917085),i=(0,o.Z)(),l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,n.useEffect)(()=>(i.on(e,t),()=>{i.off(e,t)}),r)}},272661:function(e,t,r){r.d(t,{L:function(){return o}});var n=r(304194),o=e=>new n.j({name:e})},836511:function(e,t,r){r.d(t,{IF:()=>w,E1:()=>N});var n,o=r("151064"),i=r("455069"),l=r("336205"),a=r("674343"),s=r("825955"),d=r("745474"),c=r("458620"),u=r("727914"),p=r("178385"),m=r("382534"),v=e=>0x1400000>e,_=e=>new Promise((t,r)=>{var n=new FileReader;n.onload=e=>{var n,o=null===(n=e.target)||void 0===n?void 0:n.result;if(!o||"string"!=typeof o){r(new u.sH("getBase64","file read invalid"));return}t(o.replace(/^.*?,/,""))},n.onerror=()=>{a.FN.error(l.o.t("read_file_failed_please_retry")),r(new u.sH("getBase64","file read fail"))},n.onabort=()=>{r(new u.sH("getBase64","file read abort"))},n.readAsDataURL(e)}),f=e=>{var t=e.lastIndexOf(".");return e.slice(t+1)},h=e=>{var{customRequest:t,children:r}=e;return(0,o.jsx)(a.gq,{accept:"image/*",maxSize:20480,fileList:[],customRequest:t,onChange:e=>{var t,{currentFile:r}=e;if(r){;!v((null==r?void 0:null===(t=r.fileInstance)||void 0===t?void 0:t.size)||0)&&a.FN.error(l.o.t("knowledge_insert_img_013"))}},children:r})};var x=(n=(0,s._)(function*(e){var{object:t,options:r}=e,{onSuccess:n,onProgress:o,file:i}=t,{onFinish:l,onFinally:a,onBeforeUpload:s}=r;if("string"!=typeof i)try{null==s||s();var{name:v,fileInstance:h}=i;if(h){var x=f(v),g=yield _(h),y=yield m.nA.UploadFile({file_head:{file_type:x,biz_type:p.ym.BIZ_BOT_DATASET},data:g},{onUploadProgress:e=>{var t;o({total:null!==(t=e.total)&&void 0!==t?t:h.size,loaded:e.loaded})}});n(y.data),y.data&&(null==l||l({url:y.data.upload_url,tosKey:y.data.upload_uri}))}else d.s5.errorEvent(d.xW.KNOWLEDGE,{eventName:c.b.KnowledgeUploadFile,error:new u.sH(c.b.KnowledgeUploadFile,"".concat(c.b.KnowledgeUploadFile,": Failed to upload image"))})}catch(e){d.s5.errorEvent(d.xW.KNOWLEDGE,{eventName:c.b.KnowledgeUploadFile,error:e})}finally{null==a||a()}}),function(e){return n.apply(this,arguments)}),g=e=>{var{editor:t,disabled:r,showTooltip:n,renderUI:s}=e,d=n?a.u:i.Fragment;return(0,o.jsx)(h,{customRequest:e=>{if(!t)return;var{fileInstance:r}=e;if(!!r)return x({object:e,options:{onFinish:e=>{if(e.url&&t){var r;t.chain().focus().setImageWithTosKey({src:e.url,dataTosKey:null!==(r=e.tosKey)&&void 0!==r?r:null}).run()}}}})},children:(0,o.jsx)(d,{content:l.o.t("knowledge_insert_img_002"),clickToHide:!0,autoAdjustOverflow:!0,children:s({disabled:r,showTooltip:n})})})},y=r("808549"),b=r("120454"),j=r("915757"),w=e=>(0,o.jsx)(g,(0,b._)((0,y._)({},e),{renderUI:e=>{var{disabled:t}=e;return(0,o.jsx)(a.zx,{disabled:t,color:"primary",className:"coz-fg-primary leading-none",icon:(0,o.jsx)(j.Q2$,{className:"text-[14px]"}),children:l.o.t("knowledge_insert_img_002")})}})),C=r("252237"),k=r.n(C),N=e=>(0,o.jsx)(g,(0,b._)((0,y._)({},e),{renderUI:e=>{var{disabled:t}=e;return(0,o.jsx)(a.v2.Item,{disabled:t,icon:(0,o.jsx)(j.Q2$,{className:k()("w-3.5 h-3.5",{"opacity-30":t})}),className:k()("h-8 p-2 text-xs rounded-lg",{"cursor-not-allowed":t}),children:l.o.t("knowledge_insert_img_002")})}}))},461654:function(e,t,r){r.d(t,{R:()=>f});var n=r("151064"),o=r("455069"),i=r("252237"),l=r.n(i),a=r("707291"),s=r("819195"),d=r("636436"),c=r("373025"),u=r("17236"),p=e=>{var{editorRef:t,exclude:r,onExitEditMode:n}=e;(0,o.useEffect)(()=>{var e=e=>{t.current&&!t.current.contains(e.target)&&!(null==r?void 0:r.some(t=>{var r;return null===(r=t.current)||void 0===r?void 0:r.contains(e.target)}))&&(null==n||n())};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[t,r,n])},m=r("542284"),v=r("674343"),_=e=>{var{editorActionRegistry:t,readonly:r,contextMenuRef:o,x:i,y:a,editor:s}=e;return r?null:(0,n.jsx)("div",{ref:o,className:"absolute bg-white shadow-lg rounded-md py-1 z-50",style:{top:"".concat(a,"px"),left:"".concat(i,"px")},children:(0,n.jsx)(v.v2,{visible:!0,clickToHide:!0,keepDOM:!0,position:"bottomLeft",spacing:-4,trigger:"custom",getPopupContainer:()=>{var e;return null!==(e=o.current)&&void 0!==e?e:document.body},className:l()("coz-shadow-large"),render:(0,n.jsx)(v.v2.SubMenu,{className:l()("p-1"),mode:"menu",children:t.entries().map(e=>{var[t,{Component:r}]=e;return(0,n.jsx)(r,{editor:s},t)})})})})},f=e=>{var{editor:t,placeholder:r,editorContextMenuItemsRegistry:i,editorBottomSlot:v,onBlur:f}=e,h=(0,o.useRef)(null),x=(0,o.useRef)(null),{contextMenuPosition:g,openContextMenu:y}=(0,m.H)({contextMenuRef:x});return(p({editorRef:h,exclude:[x],onExitEditMode:()=>{var e=(0,s.k)(t);null==f||f(e)}}),t)?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{ref:h,className:l()("relative","mb-2 p-2","text-sm leading-5","coz-fg-primary coz-bg-max","border border-solid coz-stroke-hglt rounded-lg"),onContextMenu:y,children:(0,n.jsxs)("div",{className:l()((0,c.X)(),(0,u.X)(),(0,d.I)()),children:[(0,n.jsx)(a.kg,{editor:t,placeholder:r}),v]})}),g&&i?(0,n.jsx)(_,{x:g.x,y:g.y,contextMenuRef:x,editor:t,editorActionRegistry:i}):null]}):null}},398412:function(e,t,r){r.d(t,{y:function(){return c}});var n=r(151064);r(455069);var o=r(385038),i=r(336205),l=r(915757),a=r(674343),s=r(95196),d=r(788911),c=e=>{var{chunk:t,chunks:r,disabled:c}=e,{addEmptyChunkAfter:u}=(0,s.i)({chunks:r||[],onChunksChange:e=>{var{newChunk:r,chunks:n}=e;d.YB.emit("hoverEditBarAction",{type:"add-after",targetChunk:t,chunks:n,newChunk:r})}});return(0,n.jsx)(a.u,{content:i.o.t("knowledge_optimize_016"),clickToHide:!0,autoAdjustOverflow:!0,children:(0,n.jsx)(a.hU,{"data-dtestid":"".concat(o.w.SegmentDetailContentItemAddBottomIcon,".").concat(t.text_knowledge_editor_chunk_uuid),size:"small",color:"secondary",disabled:c,icon:(0,n.jsx)(l.BPm,{className:"text-[14px]"}),iconPosition:"left",className:"coz-fg-secondary leading-none !w-6 !h-6",onClick:()=>u(t)})})}},179231:function(e,t,r){r.d(t,{$:function(){return c}});var n=r(151064);r(455069);var o=r(385038),i=r(336205),l=r(915757),a=r(674343),s=r(95196),d=r(788911),c=e=>{var{chunk:t,chunks:r=[],disabled:c}=e,{addEmptyChunkBefore:u}=(0,s.i)({chunks:r,onChunksChange:e=>{var{newChunk:r,chunks:n}=e;d.YB.emit("hoverEditBarAction",{type:"add-before",targetChunk:t,chunks:n,newChunk:r})}});return(0,n.jsx)(a.u,{content:i.o.t("knowledge_optimize_017"),clickToHide:!0,autoAdjustOverflow:!0,children:(0,n.jsx)(a.hU,{"data-dtestid":"".concat(o.w.SegmentDetailContentItemAddTopIcon,".").concat(t.text_knowledge_editor_chunk_uuid),size:"small",color:"secondary",disabled:c,icon:(0,n.jsx)(l.wu0,{className:"text-[14px]"}),iconPosition:"left",className:"coz-fg-secondary leading-none !w-6 !h-6",onClick:()=>u(t)})})}},876143:function(e,t,r){r.d(t,{s:function(){return d}});var n=r(151064);r(455069);var o=r(336205),i=r(915757),l=r(674343),a=r(95196),s=r(788911),d=e=>{var{chunk:t,chunks:r=[],disabled:d}=e,{deleteChunk:c}=(0,a.S)({chunks:r,onChunksChange:e=>{var{chunks:r}=e;s.YB.emit("hoverEditBarAction",{type:"delete",targetChunk:t,chunks:r})}});return(0,n.jsx)(l.u,{content:o.o.t("knowledge_level_028"),clickToHide:!0,autoAdjustOverflow:!0,children:(0,n.jsx)(l.hU,{size:"small",color:"secondary",disabled:d,icon:(0,n.jsx)(i.dVD,{className:"text-[14px]"}),iconPosition:"left",className:"coz-fg-secondary leading-none !w-6 !h-6",onClick:()=>c(t)})})}},476350:function(e,t,r){r.d(t,{i:function(){return d}});var n=r(151064);r(455069);var o=r(385038),i=r(336205),l=r(915757),a=r(674343),s=r(788911),d=e=>{var{chunk:t,disabled:r}=e;return(0,n.jsx)(a.u,{content:i.o.t("datasets_segment_edit"),clickToHide:!0,autoAdjustOverflow:!0,children:(0,n.jsx)(a.hU,{"data-dtestid":"".concat(o.w.SegmentDetailContentItemEditIcon,".").concat(t.text_knowledge_editor_chunk_uuid),size:"small",color:"secondary",disabled:r,icon:(0,n.jsx)(l.JAz,{className:"text-[14px]"}),iconPosition:"left",className:"coz-fg-secondary leading-none !w-6 !h-6",onClick:()=>{s.YB.emit("hoverEditBarAction",{type:"edit",targetChunk:t})}})})}},144416:function(e,t,r){r.d(t,{H:function(){return o}});var n=r(304194),o=e=>new n.j({name:e})},642158:function(e,t,r){r.d(t,{o:function(){return c}});var n=r(151064);r(455069);var o=r(252237),i=r.n(o),l=r(336205),a=r(915757),s=r(674343),d=r(757208),c=e=>{var{chunk:t,chunks:r,disabled:o,hoverEditBarActionsRegistry:c,onChunksChange:u}=e,p=t.status===d.OL.AuditFailed;return c?(0,n.jsxs)("div",{className:"absolute top-[2px] right-[2px] flex z-10",children:[o?null:(0,n.jsx)("div",{className:i()("p-1 coz-bg-plus rounded-lg","coz-shadow-default"),children:(0,n.jsx)(s.T,{spacing:3,children:c.entries().map(e=>{var[o,{Component:i}]=e;return(0,n.jsx)(i,{chunk:t,chunks:r,onChunksChange:u},o)})})}),p?(0,n.jsx)("div",{className:i()("p-1 coz-bg-plus rounded-lg","coz-shadow-default","ml-1"),children:(0,n.jsx)(s.u,{content:l.o.t("community_This_is_a_toast_Machine_review_failed"),clickToHide:!0,autoAdjustOverflow:!0,children:(0,n.jsx)(s.hU,{icon:(0,n.jsx)(a.L03,{className:"text-[14px] coz-fg-hglt-red"}),size:"small",color:"secondary",className:"coz-fg-secondary leading-none !w-6 !h-6"})})}):null]}):null}},202147:function(e,t,r){r.d(t,{s:function(){return u}});var n=r(151064);r(455069);var o=r(252237),i=r.n(o),l=r(336205),a=r(915757),s=r(674343),d=r(95196),c=r(788911),u=e=>{let t,r;var{chunk:o,chunks:u=[],disabled:p}=e,{deleteChunk:m}=(0,d.S)({chunks:u,onChunksChange:e=>{var{chunks:t}=e;c.YB.emit("previewContextMenuItemAction",{type:"delete",targetChunk:o,chunks:t})}});return(0,n.jsx)(s.v2.Item,{disabled:p,icon:(0,n.jsx)(a.dVD,{className:(t=!!p,i()("w-3.5 h-3.5",{"opacity-30":t}))}),onClick:()=>m(o),className:(r=!!p,i()("h-8 px-2 py-2 text-xs rounded-lg",{"cursor-not-allowed":r})),children:l.o.t("Delete")})}},71132:function(e,t,r){r.d(t,{i:function(){return c}});var n=r(151064);r(455069);var o=r(252237),i=r.n(o),l=r(336205),a=r(915757),s=r(674343),d=r(788911),c=e=>{let t,r;var{chunk:o,disabled:c}=e;return(0,n.jsx)(s.v2.Item,{disabled:c,icon:(0,n.jsx)(a.JAz,{className:(t=!!c,i()("w-3.5 h-3.5",{"opacity-30":t}))}),onClick:()=>{d.YB.emit("previewContextMenuItemAction",{type:"edit",targetChunk:o})},className:(r=!!c,i()("h-8 px-2 py-2 text-xs rounded-lg",{"cursor-not-allowed":r})),children:l.o.t("Edit")})}},577487:function(e,t,r){r.d(t,{C:function(){return o}});var n=r(304194),o=e=>new n.j({name:e})},136710:function(e,t,r){r.d(t,{i:()=>g});var n=r("151064"),o=r("455069"),i=r("252237"),l=r.n(i),a=()=>{var[e,t]=(0,o.useState)(null);return{hoveredChunk:e,handleMouseEnter:e=>{t(e)},handleMouseLeave:()=>{t(null)}}},s=r("542284"),d=r("472891"),c=r.n(d),u=r("976482"),p=r("636436"),m=r("373025"),v=r("17236"),_=e=>{var t,r,{chunk:o,locateId:i}=e;return(0,n.jsx)("div",{id:i,className:l()("relative","mb-2 p-2","text-sm leading-5","coz-fg-primary hover:coz-mg-hglt-secondary-hovered coz-mg-secondary","border border-solid coz-stroke-primary rounded-lg",(0,m.X)(),(0,v.X)(),(0,p.I)()),children:(0,n.jsx)("p",{dangerouslySetInnerHTML:{__html:null!==(r=c().sanitize((0,u.F)(null!==(t=o.content)&&void 0!==t?t:""),{FORBID_TAGS:["style"]}))&&void 0!==r?r:""}})})},f=r("674343"),h=e=>{var{previewContextMenuItemsRegistry:t,chunk:r,chunks:o,readonly:i,contextMenuRef:a,x:s,y:d}=e;return i?null:(0,n.jsx)("div",{ref:a,className:"absolute bg-white shadow-lg rounded-md py-1 z-50",style:{top:"".concat(d,"px"),left:"".concat(s,"px")},children:(0,n.jsx)(f.v2,{visible:!0,position:"bottomLeft",spacing:-4,trigger:"custom",getPopupContainer:()=>{var e;return null!==(e=a.current)&&void 0!==e?e:document.body},className:l()("rounded-lg"),render:(0,n.jsx)(f.v2.SubMenu,{className:l()("w-40 p-1"),mode:"menu",children:t.entries().map(e=>{var[t,{Component:i}]=e;return(0,n.jsx)(i,{chunk:r,chunks:o},t)})})})})},x=r("642158"),g=o.memo(e=>{var{chunk:t,chunks:r,readonly:i=!1,locateId:d,onActivateEditMode:c,hoverEditBarActionsRegistry:u,previewContextMenuItemsRegistry:p}=e,m=(0,o.useRef)(null),{hoveredChunk:v,handleMouseEnter:f,handleMouseLeave:g}=a(),{contextMenuPosition:y,openContextMenu:b}=(0,s.H)({contextMenuRef:m});return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("div",{className:l()("relative overflow-hidden"),onContextMenu:i?void 0:e=>b(e),onMouseEnter:i?void 0:()=>f(t.text_knowledge_editor_chunk_uuid),onMouseLeave:i?void 0:g,onDoubleClick:i?void 0:()=>null==c?void 0:c(t),children:[v!==t.text_knowledge_editor_chunk_uuid||i?null:(0,n.jsx)(x.o,{chunk:t,chunks:r,hoverEditBarActionsRegistry:u}),(0,n.jsx)(_,{chunk:t,locateId:d||""})]}),y?(0,n.jsx)(h,{previewContextMenuItemsRegistry:p,x:y.x,y:y.y,chunk:t,chunks:r,readonly:i,contextMenuRef:m}):null]})},(e,t)=>e.chunk.content===t.chunk.content&&!0)},542284:function(e,t,r){r.d(t,{H:function(){return o}});var n=r(455069),o=e=>{var{contextMenuRef:t}=e,[r,o]=(0,n.useState)(null),i=()=>{o(null)};return(0,n.useEffect)(()=>{var e=e=>{t.current&&!t.current.contains(e.target)&&i()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[]),{contextMenuPosition:r,openContextMenu:e=>{e.preventDefault();var t=e.currentTarget.getBoundingClientRect();o({x:e.clientX-t.left,y:e.clientY-t.top})},closeContextMenu:i}}},195523:function(e,t,r){r.d(t,{z:function(){return a}});var n=r(825955),o=r(735114),i=r(727914),l=r(382534),a=()=>{var e,{runAsync:t}=(0,o.Z)((e=(0,n._)(function*(e){if(!e)throw new i.sH("normal_error","missing slice_id");yield l.MJ.DeleteSlice({slice_ids:[e]})}),function(t){return e.apply(this,arguments)}),{manual:!0});return{deleteSlice:t}}},95196:function(e,t,r){r.d(t,{S:()=>a,i:()=>i});var n=r("455069"),o=r("68851"),i=e=>{var{chunks:t,onChunksChange:r}=e,i=(0,n.useRef)(t);return(0,n.useEffect)(()=>{i.current=t},[t]),{addEmptyChunkAfter:e=>{var t,n,l=i.current,a=l.findIndex(t=>t.text_knowledge_editor_chunk_uuid===e.text_knowledge_editor_chunk_uuid);if(-1!==a){var s=null!==(n=null===(t=l.find(t=>t.text_knowledge_editor_chunk_uuid===e.text_knowledge_editor_chunk_uuid))||void 0===t?void 0:t.sequence)&&void 0!==n?n:"1",d=(0,o.k8)({sequence:String(Number(s)+1)}),c=[...l.slice(0,a+1),d,...l.slice(a+1)];null==r||r({newChunk:d,chunks:c})}},addEmptyChunkBefore:e=>{var t,n,l=i.current,a=l.findIndex(t=>t.text_knowledge_editor_chunk_uuid===e.text_knowledge_editor_chunk_uuid),s=null!==(n=null===(t=l.find(t=>t.text_knowledge_editor_chunk_uuid===e.text_knowledge_editor_chunk_uuid))||void 0===t?void 0:t.sequence)&&void 0!==n?n:"1";if(-1!==a){var d=(0,o.k8)({sequence:s}),c=[...l.slice(0,a),d,...l.slice(a)];null==r||r({newChunk:d,chunks:c})}}}},l=r("195523"),a=e=>{var{chunks:t,onChunksChange:r}=e,o=(0,n.useRef)(t),{deleteSlice:i}=(0,l.z)();return(0,n.useEffect)(()=>{o.current=t},[t]),{deleteChunk:(0,n.useCallback)(e=>{var t=o.current.filter(t=>t.text_knowledge_editor_chunk_uuid!==e.text_knowledge_editor_chunk_uuid);if(!!e.slice_id)i(e.slice_id).then(()=>{null==r||r({chunks:t,targetChunk:e})})},[r,i])}}},93877:function(e,t,r){r.d(t,{n:()=>_});var n=r("808549"),o=r("120454"),i=r("455069"),l=r("724830"),a=r("707291"),s=r("76049"),d=r("357962"),c=r("778681"),u=r("481265"),p=r("976482"),m=r("819195"),v=r("550745").ZP.extend({addAttributes(){var e,t=(null===(e=this.parent)||void 0===e?void 0:e.call(this))||{};return(0,o._)((0,n._)({},t),{dataTosKey:{default:null,parseHTML:e=>e.getAttribute("data-tos-key"),renderHTML:e=>e.dataTosKey?{"data-tos-key":e.dataTosKey}:{}}})},addCommands(){return{setImageWithTosKey:e=>t=>{var r,{commands:n}=t;return n.insertContent({type:this.name,attrs:{src:e.src,alt:e.alt,title:e.title,dataTosKey:null!==(r=e.dataTosKey)&&void 0!==r?r:null}})}}}}),_=e=>{var{chunk:t,editorProps:r,onChange:_}=e,f=(0,a.jE)({extensions:[l.Z.configure({hardBreak:{keepMarks:!1},paragraph:{HTMLAttributes:{class:"text-knowledge-tiptap-editor-paragraph"}}}),u.ZP.configure({resizable:!0}),s.Z,c.Z,d.Z,v.configure({inline:!1,allowBase64:!0})],content:(0,p.F)((null==t?void 0:t.content)||""),parseOptions:{preserveWhitespace:"full"},onUpdate:e=>{var{editor:r}=e;if(!!t&&!!r){var i=(0,m.k)(r);null==_||_((0,o._)((0,n._)({},t),{content:i}))}},editorProps:(0,o._)((0,n._)({},r),{handlePaste(e,t,r){if(!f)return!1;var n,o=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/plain");if(null==o?void 0:o.includes("\n")){t.preventDefault();var i=(0,p.F)(o);return f.chain().focus().insertContent(i).run(),!0}return!1}})});return(0,i.useEffect)(()=>{if(!!f&&!!t){var e=(0,p.F)(t.content||"");f.commands.setContent(e||"",!1,{preserveWhitespace:"full"})}},[t,f]),{editor:f}}},149951:function(e,t,r){r.d(t,{B:()=>y});var n=r("825955"),o=r("674343"),i=r("987633"),l=(e,t)=>{var r,n;return(0,i.PJ)(null!==(n=t.content)&&void 0!==n?n:"")!==(null===(r=e.find(e=>e.slice_id===t.slice_id))||void 0===r?void 0:r.content)},a=r("68851"),s=r("735114"),d=r("727914"),c=r("382534"),u=()=>{var e,{runAsync:t,loading:r}=(0,s.Z)((e=(0,n._)(function*(e,t){if(!e)throw new d.sH("normal_error","missing slice_id");return yield c.MJ.UpdateSlice({slice_id:e,raw_text:t}),t}),function(t,r){return e.apply(this,arguments)}),{manual:!0});return{updateSlice:t,updateLoading:r}},p=e=>{var t,{chunks:r,onChunksChange:i,onUpdateChunk:s}=e,{updateSlice:d}=u();return{updateRemoteChunk:(t=(0,n._)(function*(e){if(!e.slice_id){o.FN.error("The slice ID does not exist. Please refresh the page");return}if(!l(r,e)){null==i||i(r);return}yield d(e.slice_id,null!==(t=e.content)&&void 0!==t?t:"");var t,n=(0,a.PU)(r,e);null==s||s(e),null==i||i(n)}),function(e){return t.apply(this,arguments)})}},m=r("195523"),v=e=>{var t,{chunks:r,onChunksChange:o,onDeleteChunk:i}=e,{deleteSlice:l}=(0,m.z)();return{deleteRemoteChunk:(t=(0,n._)(function*(e){if(!!e.slice_id){yield l(e.slice_id);var t=(0,a.Qe)(r,e.slice_id);null==o||o(t),null==i||i(e)}}),function(e){return t.apply(this,arguments)})}},_=e=>{var{chunks:t,onChunksChange:r}=e;return{deleteLocalChunk:e=>{if(!!e.local_slice_id){var n=(0,a.wL)(t,e.local_slice_id);null==r||r(n)}}}},f=r("745474"),h=r("458620"),x=e=>{var t,{documentId:r}=e;var{runAsync:o}=(0,s.Z)((t=(0,n._)(function*(e){var t,{content:n,sequence:o}=e;if(!r)throw new d.sH("normal_error","missing doc_id");var i=yield c.MJ.CreateSlice({document_id:r,raw_text:n,sequence:o});return(0,a.bc)({slice_id:null!==(t=null==i?void 0:i.slice_id)&&void 0!==t?t:"",sequence:o,content:n})}),function(e){return t.apply(this,arguments)}),{manual:!0,onError:e=>{f.s5.errorEvent(f.xW.KNOWLEDGE,{eventName:h.b.KnowledgeCreateSlice,error:e})}});return{createChunk:o}},g=e=>{var t,{chunks:r,documentId:o,onChunksChange:i,onAddChunk:l}=e,{createChunk:s}=x({documentId:o});return{createLocalChunk:(t=(0,n._)(function*(e){if(!!e.local_slice_id){var t,n,o=yield s({content:null!==(t=e.content)&&void 0!==t?t:"",sequence:null!==(n=e.sequence)&&void 0!==n?n:"1"}),d=(0,a.Gf)({chunks:r,localChunkSliceId:e.local_slice_id,newChunk:o});null==l||l(o),null==i||i(d)}}),function(e){return t.apply(this,arguments)})}},y=e=>{var t,r,o,{chunks:i,documentId:l,onAddChunk:a,onUpdateChunk:s,onChunksChange:d,onDeleteChunk:c}=e,{createLocalChunk:u}=g({chunks:i,documentId:l,onChunksChange:d,onAddChunk:a}),{updateRemoteChunk:m}=p({chunks:i,onChunksChange:d,onUpdateChunk:s}),{deleteLocalChunk:f}=_({chunks:i,onChunksChange:d}),{deleteRemoteChunk:h}=v({chunks:i,onChunksChange:d,onDeleteChunk:c});var x=(t=(0,n._)(function*(e){if(""===e.content){yield h(e);return}yield m(e)}),function(e){return t.apply(this,arguments)});var y=(r=(0,n._)(function*(e){""===e.content?f(e):yield u(e)}),function(e){return r.apply(this,arguments)});return{saveChunk:(o=(0,n._)(function*(e){if(!e.local_slice_id){yield x(e);return}yield y(e)}),function(e){return o.apply(this,arguments)})}}},523652:function(e,t,r){r.d(t,{R_:()=>n.R,go:()=>l,pR:()=>a.p,UF:()=>s.U,nR:()=>o.n});var n=r("461654");r("136710"),r("149951");var o=r("93877"),i=r("151064"),l=e=>{var{editor:t,actionRegistry:r}=e;return(0,i.jsx)("div",{className:"h-[32px] box-content px-2 pt-2",children:r.entries().map(e=>{var[r,{Component:n}]=e;return(0,i.jsx)(n,{editor:t},r)})})},a=r("347852"),s=r("601142");r("642158"),r("476350"),r("876143"),r("179231"),r("398412"),r("144416"),r("788911")},789662:function(e,t,r){r.d(t,{p:function(){return l}});var n,o=r(836511),i=r(272661);var l=((n=(0,i.L)("editor-context-actions")).registerSome([{type:"upload-image",module:{Component:o.E1}}]),n)},601142:function(e,t,r){r.d(t,{U:()=>D});var n,o,i=r("808549"),l=r("120454"),a=r("151064"),s=r("455069"),d=r("149951"),c=r("93877"),u=r("788911"),p=r("136710"),m=r("461654"),v=r("577487"),_=r("71132"),f=r("202147"),h=r("252237"),x=r.n(h),g=r("336205"),y=r("915757"),b=r("674343"),j=r("95196"),w=e=>{let t,r;var{chunk:n,chunks:o=[],disabled:i}=e,{addEmptyChunkBefore:l}=(0,j.i)({chunks:o,onChunksChange:e=>{var{newChunk:t,chunks:r}=e;u.YB.emit("previewContextMenuItemAction",{type:"add-before",targetChunk:n,newChunk:t,chunks:r})}});return(0,a.jsx)(b.v2.Item,{disabled:i,icon:(0,a.jsx)(y.wu0,{className:(t=!!i,x()("w-3.5 h-3.5",{"opacity-30":t}))}),onClick:()=>l(n),className:(r=!!i,x()("h-8 px-2 py-2 text-xs rounded-lg",{"cursor-not-allowed":r})),children:g.o.t("knowledge_optimize_017")})},C=e=>{let t,r;var{chunk:n,chunks:o=[],disabled:i}=e,{addEmptyChunkAfter:l}=(0,j.i)({chunks:o,onChunksChange:e=>{var{newChunk:t,chunks:r}=e;u.YB.emit("previewContextMenuItemAction",{type:"add-after",newChunk:t,targetChunk:n,chunks:r})}});return(0,a.jsx)(b.v2.Item,{disabled:i,icon:(0,a.jsx)(y.BPm,{className:(t=!!i,x()("w-3.5 h-3.5",{"opacity-30":t}))}),onClick:()=>l(n),className:(r=!!i,x()("h-8 px-2 py-2 text-xs rounded-lg",{"cursor-not-allowed":r})),children:g.o.t("knowledge_optimize_016")})};var k=((n=(0,v.C)("preview-context-menu-items")).registerSome([{type:"edit",module:{Component:_.i}},{type:"add-before",module:{Component:w}},{type:"add-after",module:{Component:C}},{type:"delete",module:{Component:f.s}}]),n),N=r("144416"),S=r("476350"),E=r("876143"),T=r("179231"),I=r("398412");var P=((o=(0,N.H)("hover-edit-bar-actions")).registerSome([{type:"edit",module:{Component:S.i}},{type:"add-before",module:{Component:T.$}},{type:"add-after",module:{Component:I.y}},{type:"delete",module:{Component:E.s}}]),o),A=r("789662"),D=e=>{var{chunks:t,documentId:r,readonly:n=!1,onChange:o,onAddChunk:v,onDeleteChunk:_}=e,[f,h]=(0,s.useState)(t),[x,g]=(0,s.useState)(null),{editor:y}=(0,c.n)({chunk:x}),{saveChunk:b}=(0,d.B)({chunks:f,documentId:r,onChunksChange:e=>{null==o||o(e),g(null)},onAddChunk:v,onDeleteChunk:_});return(0,u.OR)("previewContextMenuItemAction",(0,s.useCallback)(e=>{var{type:t,newChunk:r,chunks:n,targetChunk:i}=e;"add-after"===t&&(r&&g(r),n&&h(n)),"add-before"===t&&(r&&g(r),n&&h(n)),"delete"===t&&(null==_||_(i),n&&(null==o||o(n))),"edit"===t&&g(i)},[_,o])),(0,u.OR)("hoverEditBarAction",(0,s.useCallback)(e=>{var{type:t,targetChunk:r,chunks:n,newChunk:i}=e;"add-after"===t&&(i&&g(i),n&&h(n)),"add-before"===t&&(i&&g(i),n&&h(n)),"delete"===t&&(null==_||_(r),n&&(null==o||o(n))),"edit"===t&&g(r)},[_,o])),(0,s.useEffect)(()=>{h(t)},[t]),(0,a.jsx)(a.Fragment,{children:f.map(e=>(0,a.jsx)("div",{children:e.text_knowledge_editor_chunk_uuid===(null==x?void 0:x.text_knowledge_editor_chunk_uuid)&&x?(0,a.jsx)(m.R,{editor:y,editorContextMenuItemsRegistry:A.p,onBlur:e=>{b((0,l._)((0,i._)({},x),{content:e}))}}):(0,a.jsx)(p.i,{chunk:e,chunks:f,readonly:n,onActivateEditMode:g,hoverEditBarActionsRegistry:P,previewContextMenuItemsRegistry:k})},e.text_knowledge_editor_chunk_uuid))})}},347852:function(e,t,r){r.d(t,{p:()=>Z,D:()=>k});var n,o,i=r("151064"),l=r("455069"),a=r("987633"),s=r("149951"),d=r("93877"),c=r("788911"),u=r("252237"),p=r.n(u),m=e=>{var{title:t,id:r}=e;return(0,i.jsx)("div",{id:r,className:p()("w-full text-[14px] font-[500] leading-[20px] coz-fg-plus"),children:t})},v=r("472891"),_=r.n(v),f=e=>{var{base64:t,htmlText:r,link:n,caption:o,locateId:l,selected:a}=e;return(0,i.jsxs)("div",{id:l,className:p()("flex items-center flex-col gap-2","w-full p-2 coz-mg-secondary","border border-solid coz-stroke-primary rounded-[8px]",a&&"!coz-mg-hglt"),children:[t?(0,i.jsx)("img",{src:"data:image/jpeg;base64, ".concat(t),className:"w-full h-full"}):null,r?(0,i.jsx)("div",{className:"w-full h-full overflow-auto [&>*]:w-full [&>*]:h-full",dangerouslySetInnerHTML:{__html:_().sanitize(r)}}):null,n?(0,i.jsx)("div",{className:"coz-fg-primary text-[14px] leading-[20px] font-[400] break-all",children:n}):null,o?(0,i.jsx)("div",{className:"coz-fg-primary text-[14px] leading-[20px] font-[400] break-all",children:o}):null]})},h=r("789662"),x=r("136710"),g=r("461654"),y=e=>"segment-".concat(e),b=r("808549"),j=r("120454"),w=e=>{var t,r,n=e.find(e=>-1===e.parent&&"title"===e.type);return n?[(0,j._)((0,b._)({},n),{text:null!==(r=n.content)&&void 0!==r?r:"",parent:null===(t=n.parent)||void 0===t?void 0:t.toString(),children:C(n,e,"root"),renderLevel:"root-".concat(n.text_knowledge_editor_chunk_uuid)})]:e.map(e=>{var t,r;return(0,j._)((0,b._)({},e),{text:null!==(r=e.content)&&void 0!==r?r:"",parent:null===(t=e.parent)||void 0===t?void 0:t.toString(),children:[],renderLevel:"root-".concat(e.text_knowledge_editor_chunk_uuid)})})},C=(e,t,r)=>{var n;return(null!==(n=e.children)&&void 0!==n?n:[]).reduce((e,n,o)=>{var i=t.find(e=>e.id.toString()===n.toString());if(!i)return[...e];var l,a,s="".concat(r,"-").concat(o),d="".concat(s,"-").concat(i.text_knowledge_editor_chunk_uuid);return[...e,(0,j._)((0,b._)({},i),{parent:null===(l=i.parent)||void 0===l?void 0:l.toString(),text:null!==(a=i.content)&&void 0!==a?a:"",children:C(i,t,s),renderLevel:d})]},[])},k=(e,t)=>e.map(e=>-1!==e.parent||"title"!==e.type||e.text?e:(0,j._)((0,b._)({},e),{text:null!=t?t:""})),N=r("577487"),S=r("71132"),E=r("202147");var T=((n=(0,N.C)("preview-context-menu-items")).registerSome([{type:"edit",module:{Component:S.i}},{type:"delete",module:{Component:E.s}}]),n),I=r("144416"),P=r("476350"),A=r("876143");var D=((o=(0,I.H)("hover-edit-bar-actions")).registerSome([{type:"edit",module:{Component:P.i}},{type:"delete",module:{Component:A.s}}]),o),L=e=>{(0,l.useEffect)(()=>{if(null==e?void 0:e.length){var t=e[0],r=document.getElementById(y(t));null==r||r.scrollIntoView({behavior:"smooth",block:"start"})}},[e])},O=()=>{var[e,t]=(0,l.useState)({chunk:null,renderLevel:null});return{activeChunkInfo:e,clearActiveChunk:()=>{t({chunk:null,renderLevel:null})},setActiveChunkWithLevel:e=>{if(!e.renderLevel){console.warn("Chunk does not have renderLevel field",e);return}t({chunk:e,renderLevel:e.renderLevel})},isActiveChunk:t=>!!t&&t===e.renderLevel}},Z=e=>{var{readonly:t,chunks:r,documentId:n,selectionIDs:o,onChange:a,onDeleteChunk:u}=e,[p,m]=(0,l.useState)(r),v=(0,l.useMemo)(()=>w(p),[p]),{activeChunkInfo:_,clearActiveChunk:f,setActiveChunkWithLevel:h,isActiveChunk:x}=O(),{editor:g}=(0,d.n)({chunk:_.chunk}),{saveChunk:y}=(0,s.B)({chunks:r,documentId:n,onChunksChange:e=>{null==a||a(e),f()},onDeleteChunk:e=>{null==u||u(e)}});return(L(o),(0,c.OR)("previewContextMenuItemAction",(0,l.useCallback)(e=>{var{type:t,targetChunk:r,chunks:n}=e;"delete"===t&&(null==u||u(r),n&&(null==a||a(n))),"edit"===t&&h(r)},[])),(0,c.OR)("hoverEditBarAction",(0,l.useCallback)(e=>{var{type:t,targetChunk:r,chunks:n}=e;"delete"===t&&(null==u||u(r),n&&(null==a||a(n))),"edit"===t&&h(r)},[])),(0,l.useEffect)(()=>{m(r)},[r]),v)?(0,i.jsx)("div",{className:"flex flex-col gap-2 w-full h-full",children:v.map(e=>(0,i.jsx)(F,{editor:g,chunks:p,levelDocumentTree:e,activeChunkInfo:_,isActiveChunk:x,setActiveChunkWithLevel:h,selectionIDs:o,readonly:t,saveChunk:y,setChunks:m},e.text_knowledge_editor_chunk_uuid))}):null},F=e=>{var t,r,n,o,l,{levelDocumentTree:s,selectionIDs:d,chunks:c,activeChunkInfo:u,isActiveChunk:p,setActiveChunkWithLevel:v,readonly:_,editor:b,saveChunk:j,setChunks:w}=e,C=(null==s?void 0:null===(t=s.children)||void 0===t?void 0:t.length)?(0,i.jsxs)("div",{className:"flex w-full",children:[(0,i.jsx)("div",{className:"w-6 shrink-0"}),(0,i.jsx)("div",{className:"flex flex-col w-[calc(100%-24px)] gap-2",children:s.children.map(e=>(0,i.jsx)(F,{editor:b,chunks:c,saveChunk:j,levelDocumentTree:e,selectionIDs:d,activeChunkInfo:u,isActiveChunk:p,setActiveChunkWithLevel:v,readonly:_,setChunks:w},e.text_knowledge_editor_chunk_uuid))})]}):null;return s?(0,i.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[["title","section-title","page-title"].includes(s.type)?(0,i.jsx)(m,{title:s.text,id:y(s.id)}):null,["section-text","text","header-footer","caption","header","footer","formula","footnote","toc","code","table"].includes(s.type)?(0,i.jsx)("div",{children:p(s.renderLevel)?(0,i.jsx)(g.R,{editor:b,editorContextMenuItemsRegistry:h.p,onBlur:e=>{null==j||j((0,a.Pd)(s,e))}}):(0,i.jsx)(x.i,{chunk:s,readonly:_,chunks:c,locateId:y(s.id),hoverEditBarActionsRegistry:D,previewContextMenuItemsRegistry:T,onActivateEditMode:e=>{v(e)}})},s.text_knowledge_editor_chunk_uuid):null,["image"].includes(s.type)?(0,i.jsx)(f,{base64:null!==(n=s.image_detail.base64)&&void 0!==n?n:"",htmlText:s.html_text||s.text,link:null!==(o=null===(r=s.image_detail.links)||void 0===r?void 0:r[0])&&void 0!==o?o:"",caption:null!==(l=s.image_detail.caption)&&void 0!==l?l:"",locateId:y(s.id),selected:null==d?void 0:d.includes(s.id.toString())}):null,C]},s.text_knowledge_editor_chunk_uuid):null}},68851:function(e,t,r){r.d(t,{Gf:function(){return l},PU:function(){return d},Qe:function(){return s},bc:function(){return c},k8:function(){return i},wL:function(){return a}});var n=r(801815),o=r(757208),i=e=>{var t=(0,n.x0)();return{text_knowledge_editor_chunk_uuid:(0,n.x0)(),local_slice_id:t,slice_id:t,sequence:e.sequence,content:""}},l=e=>{var{chunks:t,localChunkSliceId:r,newChunk:n}=e;return t.map(e=>e.local_slice_id===r?n:e)},a=(e,t)=>e.filter(e=>e.local_slice_id!==t),s=(e,t)=>e.filter(e=>e.slice_id!==t),d=(e,t)=>e.map(e=>e.slice_id===t.slice_id?t:e),c=e=>{var t;return{text_knowledge_editor_chunk_uuid:(0,n.x0)(),status:o.OL.FinishVectoring,content:e.content,sequence:e.sequence,slice_id:null!==(t=e.slice_id)&&void 0!==t?t:""}}},987633:function(e,t,r){r.d(t,{PJ:function(){return l},Pd:function(){return i}});var n=r(808549),o=r(120454),i=(e,t)=>(0,o._)((0,n._)({},e),{content:t}),l=e=>{if(!e)return"";var t=e.match(RegExp("^<p>(.*?)<\\/p>$","s"));return t?t[1]:e}},17236:function(e,t,r){r.d(t,{X:function(){return i}});var n=r(252237),o=r.n(n),i=()=>o()("[&_img]:relative [&_img]:block","[&_img]:my-3 [&_img]:bg-white [&_img]:rounded-md","[&_img]:max-w-[610px] [&_img]:max-h-[367px] [&_img]:w-auto","[&_img.ProseMirror-selectednode]:outline-2 [&_img.ProseMirror-selectednode]:outline [&_img.ProseMirror-selectednode]:outline-blue-500","[&_img.ProseMirror-selectednode]:shadow-md")},373025:function(e,t,r){r.d(t,{X:function(){return i}});var n=r(252237),o=r.n(n),i=()=>o()("[&_table]:border-collapse [&_table]:m-0 [&_table]:w-full [&_table]:table-fixed [&_table]:overflow-hidden [&_table]:text-[0.9em]","[&_table_td]:border [&_table_th]:border [&_table_td]:border-[#ddd] [&_table_th]:border-[#ddd]","[&_table_td]:p-2 [&_table_th]:p-2","[&_table_td]:relative [&_table_th]:relative","[&_table_td]:align-top [&_table_th]:align-top","[&_table_td]:box-border [&_table_th]:box-border","[&_table_td]:border-solid [&_table_th]:border-solid","[&_table_td]:min-w-[100px] [&_table_th]:min-w-[100px]")},636436:function(e,t,r){r.d(t,{I:function(){return i}});var n=r(252237),o=r.n(n),i=()=>o()("[&_p]:break-words [&_p]:whitespace-pre-wrap","[&_.ProseMirror_*]:break-words [&_.ProseMirror_*]:whitespace-pre-wrap","[&_.editor-paragraph]:min-h-[1.5em] [&_.editor-paragraph]:leading-normal","[&_.editor-paragraph:empty]:min-h-[1.5em] [&_.editor-paragraph:empty]:block")},819195:function(e,t,r){r.d(t,{k:function(){return n}});var n=e=>e?o(e.isEmpty?"":e.getHTML()):"",o=e=>{if(!e)return"";var t=new DOMParser().parseFromString(e,"text/html");return t.querySelectorAll("p.text-knowledge-tiptap-editor-paragraph").forEach(e=>{var t=e.parentNode;if(t){for(var r=document.createDocumentFragment();e.firstChild;)r.appendChild(e.firstChild);t.replaceChild(r,e)}}),t.body.innerHTML}},976482:function(e,t,r){r.d(t,{F:()=>o});var n=["img","table","colgroup","col","tbody","thead","tfoot","tr","td","th","br","p"],o=e=>""===e?"":(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;if(!e)return"";var r=t.join("|"),o=RegExp("<(?!(".concat(r,")\\b[^>]*>|\\/(?:").concat(r,")>)"),"g");return e.replace(o,"&lt;")})(e).replace(/\n/g,"<br />")},431282:function(e,t,r){r.d(t,{zd:()=>i}),r("69258");var n=r("825955"),o=r("735114"),i=e=>{var{data:t,loading:r,error:i}=(0,o.Z)((0,n._)(function*(){if(!e)return null;var t=yield fetch(e,{cache:"no-cache"});if(!t.ok)throw Error("Failed to fetch content");return t.json()}),{refreshDeps:[e]});return{content:t,loading:r,error:i}}},616426:function(e,t,r){r.d(t,{ZK:()=>n.Z,mm:()=>s});var n=r("69258"),o=r("808549"),i=r("120454"),l=r("157728"),a=r("937393"),s=()=>{var e=(0,l.useNavigate)(),t=(0,a.S)();return(r,n)=>{if("string"==typeof r){var l=new URL(r.startsWith("/")?r:"".concat(location.pathname,"/").concat(r),window.location.origin);Object.entries(t).forEach(e=>{var[t,r]=e;r&&!l.searchParams.has(t)&&l.searchParams.set(t,r)});var{pathname:a,search:s}=l;return e("".concat(a).concat(s),n)}if(d(r)){var{search:u}=r,p=new URLSearchParams(u);return Object.entries(t).forEach(e=>{var[t,r]=e;r&&!p.has(t)&&p.set(t,r)}),e((0,i._)((0,o._)({},r),{search:p.toString()}),n)}return c(r)?e(r):e(r,n)}},d=e=>"object"==typeof e,c=e=>"number"==typeof e},69258:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(825955),o=r(735114),i=r(214942),l=r(297158),a=r(336205),s=r(727914),d=r(382534),c=r(674343),u=e=>{var t=(0,i.rY)(e=>e.space.id),r="dataset-".concat(e.datasetID),u=(0,l.UQ)();return(0,o.Z)((0,n._)(function*(){if(!e.datasetID)throw new s.sH("useListDataSetReq_error","datasetid cannot be empty");var r,n=yield d.MJ.ListDataset({filter:{dataset_ids:[e.datasetID]},space_id:t});if(null==n?void 0:n.total)return null==n?void 0:null===(r=n.dataset_list)||void 0===r?void 0:r.find(t=>t.dataset_id===e.datasetID);(null==n?void 0:n.total)!==0&&u(new s.sH("useListDataSetReq_error",n.msg||""))}),{cacheKey:r,setCache:e=>sessionStorage.setItem(r,JSON.stringify(e)),getCache:()=>JSON.parse(sessionStorage.getItem(r)||"{}"),onError:e=>{c.FN.error({content:a.o.t("Network_error"),showClose:!1}),u(e)}})}},937393:function(e,t,r){r.d(t,{S:function(){return n}});var n=()=>{var e=new URLSearchParams(location.search);return Object.fromEntries(Object.entries({biz:e.get("biz"),bot_id:e.get("bot_id"),workflow_id:e.get("workflow_id"),agent_id:e.get("agent_id"),page_mode:e.get("page_mode")}).filter(e=>!!e[1]))}},153696:function(e,t,r){r.d(t,{BZ:()=>rh,f5:()=>r_,PD:()=>rp,Y5:()=>rm,b6:()=>rx});var n,o,i,l,a,s,d,c,u,p=r("808549"),m=r("151064"),v=r("455069"),_=r("664319"),f=r("22916"),h=r("825955"),x=r("735114"),g=r("458620"),y=r("297158"),b=r("336205"),j=r("214942"),w=r("382534"),C=r("745474"),k=r("727914"),N=r("674343"),S=(e,t)=>{var r,n=(0,y.UQ)(),o=(0,j.rY)(e=>e.space.id);var{data:i,run:l,loading:a,mutate:s}=(0,x.Z)((r=(0,h._)(function*(t){var{datasetID:r}=t;if(!r)throw new k.sH("useDataSetDetailReq_error","datasetid cannot be empty");try{var n,i=yield w.MJ.DatasetDetail({dataset_ids:[r],space_id:o}),l=null==i?void 0:null===(n=i.dataset_details)||void 0===n?void 0:n[r];if(l)return null==e||e(l),l}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeGetDataSetDeatil,error:e})}}),function(e){return r.apply(this,arguments)}),{manual:!0,onError:e=>{N.FN.error({content:b.o.t("Network_error"),showClose:!1}),n(e)}});return{data:i,run:l,loading:a,mutate:s}},E=()=>{var{datasetID:e=""}=(0,f.kF)(),{data:t,run:r}=S(),{setDataSetDetail:n,dataSetDetail:o}=(0,f.PR)((0,_.N)(e=>({setDataSetDetail:e.setDataSetDetail,dataSetDetail:e.dataSetDetail})));return(0,v.useEffect)(()=>{if(!o.dataset_id)r({datasetID:e})},[]),(0,v.useEffect)(()=>(n(t||{}),()=>{n({})}),[t]),{dataSetDetail:t}},T=r("274971"),I=r("771242"),P=r("695673"),A=r("653598"),D=r("537714");D.Cm.TABLE_GOOGLE_DRIVE,D.Cm.TABLE_FEISHU,D.Cm.TEXT_FEISHU,D.Cm.TEXT_LARK,D.Cm.TABLE_LARK,D.Cm.TEXT_GOOGLE_DRIVE,D.Cm.TEXT_DOC,D.Cm.TEXT_URL,D.Cm.TEXT_NOTION,D.Cm.TEXT_CUSTOM,A.a5.Text,b.o.t("content_view_001"),b.o.t("content_view_002");var L={[A.f3.NoUpdate]:b.o.t("datasets_segment_tag_updateNo"),[A.f3.Cover]:b.o.t("datasets_segment_tag_overwrite"),[A.f3.Append]:b.o.t("datasets_segment_tag_overwriteNo")},O=(e,t)=>{var r,n=(0,y.UQ)();var{data:o,run:i,loading:l,mutate:a}=(0,x.Z)((r=(0,h._)(function*(t){var{datasetID:r,page:o,size:i}=t;if(!r)throw new k.sH("useListDocumentReq_error","datasetid cannot be empty");try{var l=yield w.MJ.ListDocument({dataset_id:r,page:null!=o?o:0,size:null!=i?i:P.by});if(l.document_infos)return null==e||e(l.document_infos),l.document_infos;n(new k.sH("useListDataSetReq_error",l.msg||""))}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeGetDataSetDeatil,error:e})}}),function(e){return r.apply(this,arguments)}),{manual:!0,onError:e=>{N.FN.error({content:b.o.t("Network_error"),showClose:!1}),n(e)}});return{data:o,run:i,loading:l,mutate:a}},Z=()=>{var e=(0,v.useRef)();return(0,v.useEffect)(()=>()=>{(0,I.uA)(e)},[]),(t,r)=>{e.current&&(0,I.uA)(e);var n,o=(n=(0,h._)(function*(){var n,o,{data:i=[]}=yield w.MJ.GetDocumentProgress({document_ids:t});r.isImage&&(n=null===(o=yield w.MJ.PhotoDetail({document_ids:t,dataset_id:r.dataSetId}))||void 0===o?void 0:o.photo_infos);var l=i.reduce((e,t)=>{var r=(null==n?void 0:n[t.document_id])||{};return e[t.document_id]=(0,p._)({status:t.status,progress:t.progress},r),e},{});(0,T.te)(i),r.onProgressing(l),(0,I.zP)(i)&&(r.onFinish(),(0,I.uA)(e))}),function(){return n.apply(this,arguments)});e.current=window.setInterval((o(),o),5e3)}},F=e=>{var t,{onSuccess:r}=e;var{run:n,loading:o}=(0,x.Z)((t=(0,h._)(function*(e){if(!e.document_id)throw new k.sH(g.b.KnowledgeUpdateDocumentName,"".concat(g.b.KnowledgeUpdateDocumentName,": missing doc_id"));yield w.MJ.UpdateDocument(e)}),function(e){return t.apply(this,arguments)}),{manual:!0,onSuccess:()=>{r()},onError:e=>{C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeUpdateDocumentName,error:e})}});return{run:n,loading:o}},M=()=>{var{datasetID:e=""}=(0,f.kF)(),{run:t,loading:r,data:n}=S(),{run:o,loading:i,data:l}=O(),{setDataSetDetail:a,setDocumentList:s}=(0,f.PR)((0,_.N)(e=>({setDataSetDetail:e.setDataSetDetail,setDocumentList:e.setDocumentList})));return(0,v.useEffect)(()=>{!r&&n&&a(n)},[n,r]),(0,v.useEffect)(()=>{!i&&l&&s(l)},[l,i]),{loading:r||i,reload:()=>{t({datasetID:e}),o({datasetID:e})},reset:()=>{a({}),s([])}}},z=r("280053"),R=r("487377"),B=r("298203"),V=r("120454"),U=r("974235"),H=e=>{var t,{params:r,onSuccess:n,onError:o,reloadDeps:i=[],target:l=null,dataReady:a=!0}=e;var{loading:s,data:d,loadingMore:c,mutate:u,cancel:m,reload:v,loadMore:_}=(0,U.Z)((t=(0,h._)(function*(e){if(!r.dataset_id&&!r.document_id)return{list:[],total:0,hasMore:!1,ready:!1};var t,n,o,i=!!r.dataset_id,l=(null==e?void 0:null===(t=e.list)||void 0===t?void 0:t.length)?e.list[e.list.length-1].sequence:void 0,a=i?{document_id:e&&(null==e?void 0:null===(n=e.list)||void 0===n?void 0:n.length)?e.list[e.list.length-1].document_id:void 0,sequence:l}:{sequence:l},s=yield w.MJ.ListSlice((0,p._)((0,V._)((0,p._)({},a),{page_size:String(50)}),r));return{list:(null==s?void 0:s.slices)||[],total:Number(null!==(o=null==s?void 0:s.total)&&void 0!==o?o:0),hasMore:null==s?void 0:s.hasmore,ready:!0}}),function(e){return t.apply(this,arguments)}),{isNoMore:e=>!(null==e?void 0:e.hasMore),target:l,onBefore:()=>{(c||s)&&m()},onSuccess:n,onError:o,reloadDeps:i});return{loading:s,data:d,loadingMore:c,mutate:u,cancel:m,reload:v,loadMore:_,pageSize:50}};var W=(n=(0,h._)(function*(e){if(!e||!e.length)throw new k.sH(g.b.KnowledgeDeleteSlice,"".concat(g.b.KnowledgeDeleteSlice,": missing slice_id"));return yield w.MJ.DeleteSlice({slice_ids:e}),e}),function(e){return n.apply(this,arguments)});var G=(o=(0,h._)(function*(e,t,r){if(!e)throw new k.sH("normal_error","missing slice_id");return yield w.MJ.UpdateSlice({slice_id:e,raw_text:t,table_unit_text:r}),N.FN.success(b.o.t("Update_success")),t}),function(e,t,r){return o.apply(this,arguments)}),K=e=>{var t,{onReload:r}=e;var{run:n}=(0,x.Z)((t=(0,h._)(function*(e){if(!e.document_id)throw new k.sH("normal_error","missing doc_id");var t=yield w.MJ.CreateSlice(e);return(0,p._)({},t,e)}),function(e){return t.apply(this,arguments)}),{manual:!0,onSuccess:e=>{var t;N.FN.success(b.o.t("Update_success")),r({document_id:e.document_id,slice_id:e.slice_id,sequence:"0",content:null!==(t=e.raw_text)&&void 0!==t?t:{}})},onError:e=>{C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeCreateSlice,error:e})}});return{createSlice:n}},J=e=>{var{keepDocTitle:t,className:r,renderNavBar:n,renderContent:o}=e,{onUpdateDisplayName:i,onStatusChange:l}=(0,f.kJ)(),{setDataSetDetail:a,dataSetDetail:s,setDocumentList:d,documentList:c}=(0,f.PR)((0,_.N)(e=>({setDataSetDetail:e.setDataSetDetail,dataSetDetail:e.dataSetDetail,setDocumentList:e.setDocumentList,documentList:e.documentList}))),[u,p]=(0,v.useState)({}),h=Z(),{reload:x,loading:g,reset:y}=M();(0,v.useEffect)(()=>(x(),()=>{y()}),[]),(0,v.useEffect)(()=>{(null==s?void 0:s.name)&&(null==i||i(s.name),null==l||l("normal"))},[null==s?void 0:s.name]),(0,R.a)({isLive:!!(null==c?void 0:c.length)}),(0,v.useEffect)(()=>{var e=null==s?void 0:s.processing_file_id_list;e&&e.length&&h(e,{onProgressing:e=>{p(e)},onFinish:()=>{x()},dataSetId:null==s?void 0:s.dataset_id,isImage:(null==s?void 0:s.format_type)===z.a5.Image})},[s]);var j={layoutProps:{keepDocTitle:t,renderContent:o,renderNavBar:n},dataInfo:{dataSetDetail:s,documentList:c},statusInfo:{isReloading:g,progressMap:u},dataActions:{refreshData:x,updateDataSetDetail:e=>a(e||{}),updateDocumentList:e=>d(e||[])}};return(0,m.jsx)(C.xV,{namespace:C.xW.KNOWLEDGE,children:(0,m.jsxs)(N.Ar,{className:r||"flex flex-col p-[24px] pt-[16px] gap-[16px] !bg-transparent ",title:(0,B.Z$)("".concat(null==s?void 0:s.name," - ").concat(b.o.t("tab_dataset_list"))),keepDocTitle:t,children:[null==n?void 0:n(j),null==o?void 0:o(j)]})})},q=r("252237"),$=r.n(q),X=r("420998"),Y=r("801815"),Q=r("915757"),ee=()=>({[D.Cm.IMAGE_FILE]:{unitType:D.Cm.IMAGE_FILE,name:b.o.t("knowledge_photo_002"),icon:(0,m.jsx)(Q.da8,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TABLE_DOC]:{unitType:D.Cm.TABLE_DOC,name:b.o.t("datasets_createFileModel_step1_TabLocalTitle"),icon:(0,m.jsx)(Q.da8,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TABLE_API]:{unitType:D.Cm.TABLE_API,name:b.o.t("datasets_createFileModel_step1_apiTitle"),icon:(0,m.jsx)(Q.a4,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TABLE_CUSTOM]:{unitType:D.Cm.TABLE_CUSTOM,name:b.o.t("dataset_detail_source_custom"),icon:(0,m.jsx)(Q.YRi,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TABLE_FEISHU]:{unitType:D.Cm.TABLE_FEISHU,name:b.o.t("knowledge-3rd-party-feishu"),icon:(0,m.jsx)(Q.Ahw,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TABLE_LARK]:{unitType:D.Cm.TABLE_LARK,name:b.o.t("Lark_00001"),icon:(0,m.jsx)(Q.Ahw,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TABLE_GOOGLE_DRIVE]:{unitType:D.Cm.TABLE_GOOGLE_DRIVE,name:b.o.t("knowledge-3rd-party-google-drive"),icon:(0,m.jsx)(Q.Q4r,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_DOC]:{unitType:D.Cm.TEXT_DOC,name:b.o.t("datasets_createFileModel_step1_TabLocalTitle"),icon:(0,m.jsx)(Q.da8,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_URL]:{unitType:D.Cm.TEXT_URL,name:b.o.t("datasets_createFileModel_step1_urlTitle"),icon:(0,m.jsx)(Q.KQ3,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_EXTENSION]:{unitType:D.Cm.TEXT_EXTENSION,name:b.o.t("datasets_createFileModel_step1_urlTitle"),icon:(0,m.jsx)(Q.KQ3,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_NOTION]:{unitType:D.Cm.TEXT_NOTION,name:b.o.t("knowledge-3rd-party-notion"),icon:(0,m.jsx)(Q.S6N,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_FEISHU]:{unitType:D.Cm.TEXT_FEISHU,node:"item",name:b.o.t("knowledge-3rd-party-feishu"),icon:(0,m.jsx)(Q.Ahw,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_LARK]:{unitType:D.Cm.TEXT_LARK,name:b.o.t("Lark_00001"),icon:(0,m.jsx)(Q.Ahw,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_GOOGLE_DRIVE]:{unitType:D.Cm.TEXT_GOOGLE_DRIVE,name:b.o.t("knowledge-3rd-party-google-drive"),icon:(0,m.jsx)(Q.Q4r,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_CUSTOM]:{unitType:D.Cm.TEXT_CUSTOM,name:b.o.t("dataset_detail_source_custom"),icon:(0,m.jsx)(Q.YRi,{className:"w-4 h-4 [&>path]:fill-current"})},[D.Cm.TEXT_WECHAT]:{unitType:D.Cm.TEXT_WECHAT,name:b.o.t("公众号"),icon:(0,m.jsx)(Q.yrb,{className:"w-4 h-4 [&>path]:fill-current"})}}),et=e=>{if(e.format_type===z.a5.Text){if(e.source_type===z.NZ.Document)return D.Cm.TEXT_DOC;if(e.source_type===z.NZ.Web)return D.Cm.TEXT_URL;if(e.source_type===z.NZ.Custom)return D.Cm.TEXT_CUSTOM;if(e.source_type===z.NZ.FrontCrawl)return D.Cm.TEXT_EXTENSION;if(e.source_type===z.NZ.Notion)return D.Cm.TEXT_NOTION;if(e.source_type===z.NZ.GoogleDrive)return D.Cm.TEXT_GOOGLE_DRIVE;if(e.source_type===z.NZ.FeishuWeb)return D.Cm.TEXT_FEISHU;if(e.source_type===z.NZ.LarkWeb)return D.Cm.TEXT_LARK;if(e.source_type===z.NZ.WeChat)return D.Cm.TEXT_WECHAT}if(e.format_type===z.a5.Table){if(e.source_type===z.NZ.Document)return D.Cm.TABLE_DOC;if(e.source_type===z.NZ.Web)return D.Cm.TABLE_API;if(e.source_type===z.NZ.Custom)return D.Cm.TABLE_CUSTOM;if(e.source_type===z.NZ.GoogleDrive)return D.Cm.TABLE_GOOGLE_DRIVE;if(e.source_type===z.NZ.FeishuWeb)return D.Cm.TABLE_FEISHU;if(e.source_type===z.NZ.LarkWeb)return D.Cm.TABLE_LARK}return D.Cm.TEXT_URL},er={[z.NZ.Document]:b.o.t("dataset_detail_source_local"),[z.NZ.Web]:b.o.t("dataset_detail_source_online"),[z.NZ.Custom]:b.o.t("dataset_detail_source_custom"),[z.NZ.ThirdParty]:"",[z.NZ.FrontCrawl]:b.o.t("dataset_detail_source_online"),[z.NZ.GoogleDrive]:b.o.t("knowledge-3rd-party-google-drive"),[z.NZ.Notion]:b.o.t("knowledge-3rd-party-notion"),[z.NZ.FeishuWeb]:b.o.t("knowledge-3rd-party-feishu"),[z.NZ.LarkWeb]:b.o.t("Lark_00001"),[z.NZ.OpenApi]:b.o.t("dataset_detail_source_custom"),[z.NZ.WeChat]:b.o.t("knowledge_weixin_001")},en=e=>{var{format_type:t,source_type:r}=e||{};return t===z.a5.Table&&r===z.NZ.Web?"Api":er[r||0]||"-"},eo=e=>{switch(e){case D.Cm.TABLE:case D.Cm.TABLE_API:case D.Cm.TABLE_DOC:case D.Cm.TABLE_CUSTOM:case D.Cm.TABLE_FEISHU:case D.Cm.TABLE_GOOGLE_DRIVE:return z.a5.Table;case D.Cm.IMAGE:return z.a5.Image;default:return z.a5.Text}},ei=e=>{var{spaceID:t,datasetID:r,type:n,docID:o,formatType:i,pageMode:l,botId:a,actionType:s,isDouyinBot:d}=e,c="/space/".concat(t,"/knowledge/").concat(r,"/upload"),u={type:null!=n?n:""};i===z.a5.Table&&o&&(u.opt=D.VP.INCREMENTAL,u.doc_id=o),l&&(u.page_mode=l),a&&(u.bot_id=a),s&&(u.action_type=s),d&&(u.is_douyin="true");var p=new URLSearchParams(u);return"".concat(c,"?").concat(p.toString())},el=e=>(0,p._)({text_knowledge_editor_chunk_uuid:(0,Y.x0)()},e),ea=e=>{var t;return(0,p._)({text_knowledge_editor_chunk_uuid:(0,Y.x0)(),sequence:null===(t=e.slice_sequence)||void 0===t?void 0:t.toString(),content:e.text},e)},es=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ee();return e.map(e=>{var n,o,i,l,a,s=r[et({format_type:null==e?void 0:e.format_type,source_type:null==e?void 0:e.source_type})];return{value:e.document_id,text:e.name,label:(0,m.jsxs)("div",{className:"flex flex-row items-center justify-center max-w-[603px] coz-fg-primary",children:[(0,m.jsx)("div",{className:"flex text-[16px]",children:null==s?void 0:s.icon}),(0,m.jsx)(N.ZT.Text,{ellipsis:{showTooltip:{opts:{theme:"dark"}}},fontSize:"14px",className:"w-full grow truncate ml-[8px]",children:e.name}),(0,m.jsxs)("div",{className:"flex items-center shrink-0 ml-[4px]",children:[Object.keys(t).includes(null!==(i=null==e?void 0:e.document_id)&&void 0!==i?i:"")&&(null==t?void 0:null===(n=t[null!==(l=null==e?void 0:e.document_id)&&void 0!==l?l:""])||void 0===n?void 0:n.progress)<100?(0,m.jsxs)(N.Vp,{color:"blue",size:"mini",className:"font-medium",children:[b.o.t("datasets_segment_tag_processing")," ".concat(null===(o=t[null!==(a=null==e?void 0:e.document_id)&&void 0!==a?a:""])||void 0===o?void 0:o.progress,"%")]}):null,(null==e?void 0:e.status)===z._m.Failed?(0,m.jsx)(N.u,{theme:"dark",content:null==e?void 0:e.status_descript,children:(0,m.jsx)(Q.L03,{className:"coz-fg-hglt-red"})}):null]})]},null==e?void 0:e.document_id)}})},ed=e=>{var{docId:t,documentType:r,documentSource:n,onDelete:o,onUpdateFrequency:i}=e,{node:l,delete:a}=(0,P.mp)({docId:t,onDel:()=>{null==o||o()}}),{node:s,edit:d}=(0,P.yI)({docId:t,onFinish:e=>{null==i||i(e)},type:r,documentSource:n});return{deleteModalNode:l,showDeleteModal:a,updateFrequencyModalNode:s,showUpdateFrequencyModal:d}},ec=e=>{var{curDocId:t,setCurDocId:r,documentList:n}=(0,f.PR)((0,_.N)(e=>({curDocId:e.curDocId,setCurDocId:e.setCurDocId,documentList:e.documentList}))),o=(0,v.useRef)(null),{run:i}=F({onSuccess:()=>{var t;N.FN.success(b.o.t("Update_success")),null==e||null===(t=e.reloadDataset)||void 0===t||t.call(e)}});return{prevDocIdRef:o,updateDocument:i,handleSelectDocument:e=>{o.current=t||null,r(e)},handleRenameDocument:(e,t)=>{i({document_id:e,document_name:t})},handleUpdateDocumentFrequency:(e,t)=>{if(!!n)return n.map(r=>r.document_id===e?(0,V._)((0,p._)({},r),{update_interval:null==t?void 0:t.updateInterval,update_type:t.updateInterval?z.$o.Cover:z.$o.NoUpdate}):r)},rollbackDocumentSelection:()=>{o.current&&r(o.current)}}},eu=()=>{var e=(0,f.PR)(e=>e.documentList),{handleSelectDocument:t}=ec();(0,v.useEffect)(()=>{if(null==e?void 0:e.length){var r,n;t(null!==(n=null===(r=e[0])||void 0===r?void 0:r.document_id)&&void 0!==n?n:"")}},[e])},ep=e=>{var[t,r]=(0,v.useState)(!1);return(0,v.useEffect)(()=>{t&&r(!1)},[e]),{showOriginalFile:t,handleToggleOriginalFile:e=>{r(e)}}},em=e=>{var t,r,{documentList:n,dataSetDetail:o,curDocId:i}=(0,f.PR)((0,_.N)(e=>({curDocId:e.curDocId,documentList:e.documentList,dataSetDetail:e.dataSetDetail}))),l=null==n?void 0:n.find(e=>e.document_id===i),a=(null==l?void 0:l.status)===z._m.Processing,s=!!i&&(null===(t=e[i])||void 0===t?void 0:t.status)===z._m.Enable;return{curDoc:l,curDocId:i,isProcessing:a,processFinished:s,datasetId:null!==(r=null==o?void 0:o.dataset_id)&&void 0!==r?r:""}},ev=e=>{var{curDocId:t,datasetId:r,curChunkType:n,processFinished:o,target:i,rollbackDocumentSelection:l}=e,{searchValue:a}=(0,f.PR)((0,_.N)(e=>({searchValue:e.searchValue}))),{loading:s,data:d,mutate:c,reload:u}=H({target:i,params:{keyword:a,document_id:n!==z.x2.LevelChunk?t:""},reloadDeps:[a,t,r,o],onError:e=>{C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeGetSliceList,error:e}),N.FN.error(b.o.t("knowledge_document_view")),l()}}),m=(0,v.useMemo)(()=>{var e;return null!==(e=null==d?void 0:d.list.map(e=>el(e)))&&void 0!==e?e:[]},[null==d?void 0:d.list]);return{loading:s,sliceData:d,renderData:m,handleContentChange:e=>{var t;c((0,V._)((0,p._)({},d),{list:e,total:Number(null!==(t=null==d?void 0:d.total)&&void 0!==t?t:"0")}))},reload:u}},e_=r("431282"),ef=r("347852"),eh=e=>{var t,{curDoc:r}=e,[n,o]=(0,v.useState)([]),{levelSegments:i,setLevelSegments:l}=(0,f.PR)((0,_.N)(e=>({levelSegments:e.levelSegments,setLevelSegments:e.setLevelSegments}))),{content:a,loading:s}=(0,e_.zd)((null==r?void 0:null===(t=r.chunk_strategy)||void 0===t?void 0:t.chunk_type)===z.x2.LevelChunk?null==r?void 0:r.doc_tree_tos_url:void 0),d=(0,v.useMemo)(()=>i.map(e=>ea(e)),[i]);return(0,v.useEffect)(()=>{var e,t;l((0,ef.D)(null!==(e=null==a?void 0:a.chunks)&&void 0!==e?e:[],null!==(t=null==r?void 0:r.name)&&void 0!==t?t:""))},[a]),{levelSegments:i,renderLevelSegmentsData:d,selectionIDs:n,setSelectionIDs:o,tosLoading:s,handleLevelSegmentsChange:e=>{l(e)},handleLevelSegmentDelete:e=>{l(i.filter(t=>t.slice_id!==e.slice_id))}}},ex=()=>{var{dataSetDetail:e,setDataSetDetail:t}=(0,f.PR)((0,_.N)(e=>({dataSetDetail:e.dataSetDetail,setDataSetDetail:e.setDataSetDetail})));return{handleIncreaseSliceCount:()=>{if(!!e)t((0,V._)((0,p._)({},e),{slice_count:e.slice_count>-1?e.slice_count+1:0}))},handleDecreaseSliceCount:()=>{if(!!e)t((0,V._)((0,p._)({},e),{slice_count:e.slice_count>-1?e.slice_count-1:0}))}}},eg=r("263825"),ey=r("385038"),eb=r("523865"),ej=e=>{var{documentInfo:t}=e,r=(0,v.useMemo)(()=>{var e,r=L[null!==(e=null==t?void 0:t.update_type)&&void 0!==e?e:""];return(null==t?void 0:t.update_interval)&&(r="".concat(b.o.t("datasets_segment_tag_updateFrequency",{num:t.update_interval}))),r},[t]);return t?(0,m.jsxs)(N.T,{className:eb.Z["doc-tag-wrapper"],spacing:4,children:[(0,m.jsx)(N.Vp,{color:"primary",size:"mini",children:en(t)}),t.source_type===z.NZ.Web&&(0,m.jsx)(N.Vp,{color:"primary",size:"mini",children:r}),(()=>{var{format_type:e,chunk_strategy:r}=t;return e===z.a5.Text&&r?r.chunk_type===z.x2.CustomChunk?(0,m.jsx)(N.Vp,{color:"primary",size:"mini",children:b.o.t("datasets_segment_tag_custom")}):r.chunk_type===z.x2.LevelChunk?(0,m.jsx)(N.Vp,{color:"primary",size:"mini",children:b.o.t("knowledge_level_016")}):(0,m.jsx)(N.Vp,{color:"primary",size:"mini",children:b.o.t("datasets_segment_tag_auto")}):null})()]}):null},ew=r("998600"),eC=e=>{var{type:t,options:r,value:n,onChange:o,canEdit:i,onRename:l}=e,[a,s]=(0,v.useState)(""),[d,c]=(0,v.useState)(""),[u,p]=(0,v.useState)(""),[_,f]=(0,v.useState)(!1),[h,x]=(0,v.useState)(!1),g=(0,ew.Z)(e=>{c(e||"")},{wait:300}),j=r.filter(e=>{if(!d)return!0;try{var t,r=new RegExp(d);return"all"!==e.value&&e.value===n||(null==e?void 0:null===(t=e.text)||void 0===t?void 0:t.match(r))}catch(e){return!0}}),w=()=>{var e,t=null===(e=r.find(e=>e.value===n))||void 0===e?void 0:e.text;t&&p(t)},C=e=>{e.stopPropagation(),f(!0)},k=()=>{if(!!u){x(!0);try{l(n,u),f(!1)}finally{x(!1)}}};return(0,m.jsx)(N.Ph,{clickToHide:!0,maxHeight:670,disabled:!0,className:$()(eb.Z["doc-selector"]),dropdownClassName:eb.Z["doc-selector-dropdown"],optionList:j,value:n,onChange:o,getPopupContainer:()=>document.body,triggerRender:e=>{var{value:t}=e;return(0,m.jsx)(N.J2,{clickToHide:!0,visible:_,onClickOutSide:()=>f(!1),trigger:"custom",style:{padding:16,width:320},onVisibleChange:e=>{e&&w()},content:(0,m.jsxs)("div",{className:eb.Z["edit-doc-name-container"],onClick:e=>e.stopPropagation(),children:[(0,m.jsx)("div",{className:eb.Z["edit-doc-name-container-title"],children:b.o.t("knowledge_detail_doc_rename")}),(0,m.jsxs)("div",{className:eb.Z["edit-doc-name-container-input"],children:[(0,m.jsx)(N.Kx,{value:u,maxLength:100,maxCount:100,validateStatus:u?"default":"error",placeholder:b.o.t("knowledge_upload_text_custom_doc_name_tips"),onChange:e=>p(e)}),!u&&(0,m.jsx)("div",{className:eb.Z["edit-doc-name-container-input-error"],children:b.o.t("knowledge_upload_text_custom_doc_name_tips")})]}),(0,m.jsx)("div",{className:"text-right",children:(0,m.jsx)(N.zx,{disabled:!u,onClick:k,size:"small",loading:h,children:b.o.t("Save")})})]}),position:"bottomLeft",children:(0,m.jsxs)("div",{onClick:()=>{f(!1)},className:eb.Z["doc-selector-trigger"],"data-testid":ey.w.SegmentDetailContentSelectTrigger,children:[(0,m.jsx)("div",{className:eb.Z["doc-selector-trigger-label"],children:t.map(e=>(0,m.jsx)("div",{children:e.label},e.value))}),i&&n?(0,m.jsx)("div",{children:(0,m.jsx)(N.u,{clickToHide:!0,theme:"dark",content:b.o.t("knowledge_detail_doc_rename"),children:(0,m.jsx)("div",{className:eb.Z["doc-selector-trigger-icon"],onClick:C,"data-testid":ey.w.SegmentDetailContentSelectTriggerEditIcon,children:(0,m.jsx)(Q.JAz,{className:"text-[14px]"})})})}):null]})})},innerTopSlot:(0,m.jsx)(N.ol,{value:a,placeholder:b.o.t("datasets_placeholder_search"),onChange:e=>{s(e)},onSearch:e=>{y.kg.info({message:"onSearch",meta:{v:e}}),g.run(e)}})})},ek=e=>{var{documentData:{curDoc:t,curDocId:r,curFormatType:n,docOptions:o},filePreviewData:{showOriginalFile:i,fileUrl:l},documentActions:{onChangeDoc:a,onRenameDoc:s,onToggleOriginalFile:d,onResegment:c,onUpdateFrequency:u,onDelete:p},customUIElements:{linkOriginUrlButton:v,fetchSliceButton:_}}=e,h=(0,f.PR)(e=>e.canEdit),x=h&&t&&(t.source_type===z.NZ.Web||(0,eg.$6)(null==t?void 0:t.source_type)),g=t&&h,y=(null==t?void 0:t.format_type)===z.a5.Text,j=h&&t&&![z.NZ.Custom,z.NZ.Document].includes(t.source_type);return(0,m.jsxs)("div",{className:$()("w-full flex items-center justify-between py-[12px] px-[16px]","border border-solid coz-stroke-primary border-l-0 border-t-0 border-r-0"),children:[(0,m.jsxs)("div",{className:$()("flex items-center"),children:[(0,m.jsx)(eC,{type:n,options:o,canEdit:h,value:r,onChange:a,onRename:s}),(0,m.jsx)(ej,{documentInfo:t})]}),(0,m.jsxs)(N.T,{spacing:8,children:[l?(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("span",{className:"coz-fg-secondary text-[12px] leading-[16px]",children:b.o.t("knowledge_level_030")}),(0,m.jsx)(N.rs,{size:"mini",checked:i,onChange:d})]}):null,y&&h?(0,m.jsx)(N.u,{theme:"dark",content:b.o.t("knowledge_new_001"),children:(0,m.jsx)(N.hU,{"data-testid":ey.w.SegmentDetailUpdateBtn,iconPosition:"left",color:"secondary",size:"small",icon:(0,m.jsx)(Q.CW,{}),onClick:c})}):null,x?(0,m.jsx)(N.u,{theme:"dark",content:b.o.t("datasets_unit_upload_field_update_frequency"),children:(0,m.jsx)(N.hU,{"data-dtestid":"".concat(ey.w.SegmentDetailContentItemFrequencyIcon,".").concat(null==t?void 0:t.document_id),icon:(0,m.jsx)(Q.VjM,{className:"text-[14px]"}),iconPosition:"left",color:"secondary",size:"small",onClick:u})}):null,j?_:null,v,g?(0,m.jsx)(N.u,{theme:"dark",content:b.o.t("kl2_006"),children:(0,m.jsx)(N.hU,{"data-testid":ey.w.SegmentDetailContentDeleteIcon,icon:(0,m.jsx)(Q.dVD,{className:"text-[14px]"}),color:"secondary",iconPosition:"left",size:"small",onClick:p})}):null]})]})},eN=r("763055"),eS=r("523652"),eE=r("44172"),eT=e=>{var{isProcessing:t,documentId:r,levelSegments:n,selectionIDs:o,onLevelSegmentsChange:i,onLevelSegmentDelete:l}=e,a=(0,f.PR)(e=>e.canEdit),s=(0,f.PR)(e=>e.searchValue),d=n.map(e=>ea(e));return 0===n.length?(0,m.jsx)("div",{className:$()(eb.Z["empty-content"]),children:(0,m.jsx)(N.ub,{size:"large",icon:s?(0,m.jsx)(eN.xs,{style:{width:150,height:"100%"}}):(0,m.jsx)(eE.s9d,{style:{width:150,height:"100%"}}),title:t?b.o.t("content_view_003"):s?b.o.t("knowledge_no_result"):b.o.t("dataset_segment_empty_desc")})}):(0,m.jsx)(eS.pR,{chunks:d,selectionIDs:o,documentId:r,readonly:!a,onChange:i,onDeleteChunk:l})},eI=e=>{var{fileType:t,fileUrl:r,visible:n}=e,{pdfNode:o,numPages:i,currentPage:l,onNext:a,onBack:s,scale:d,increaseScale:c,decreaseScale:u}=(0,X.Is)({fileUrl:r});return(0,m.jsx)("div",{className:$()("w-full h-full","border border-solid coz-stroke-primary border-t-0 border-b-0 border-l-0","flex flex-col items-center overflow-auto",!n&&"hidden"),children:"md"===t?(0,m.jsx)(X.SA,{fileUrl:r}):"txt"===t?(0,m.jsx)(X.Tn,{fileUrl:r}):["docx","pdf","doc"].includes(null!=t?t:"")?(0,m.jsxs)("div",{className:"grow w-full relative",children:[i>=1?(0,m.jsxs)("div",{className:$()("flex w-fit h-[32px] items-center justify-center gap-[3px] absolute top-[8px] right-[8px]","coz-bg-max rounded-[8px] coz-shadow-default","z-10","px-[8px]"),children:[(0,m.jsx)(N.hU,{icon:(0,m.jsx)(Q.$1i,{}),size:"small",color:"secondary",onClick:s}),(0,m.jsxs)("div",{className:"coz-fg-secondary text-[12px] font-[400] leading-[24px]",children:[l," / ",i]}),(0,m.jsx)(N.hU,{icon:(0,m.jsx)(Q.x5d,{}),size:"small",color:"secondary",onClick:a}),(0,m.jsx)("div",{className:"w-[1px] h-[12px] coz-mg-primary"}),(0,m.jsx)(N.hU,{icon:(0,m.jsx)(Q.ozt,{}),size:"small",color:"secondary",onClick:u}),(0,m.jsxs)("div",{className:"coz-fg-secondary text-[12px] font-[400] leading-[16px]",children:[Math.round(100*d),"%"]}),(0,m.jsx)(N.hU,{icon:(0,m.jsx)(Q.PwN,{}),size:"small",color:"secondary",onClick:c})]}):null,o]}):null})},eP=e=>{var{loading:t,isProcessing:r,documentId:n,renderData:o,onContentChange:i,onAddChunk:l,onDeleteChunk:a}=e,s=(0,f.PR)(e=>e.canEdit),d=(0,f.PR)(e=>e.searchValue);return(null==o?void 0:o.length)!==0||t?(0,m.jsx)("div",{className:eb.Z["slice-article-content"],children:(0,m.jsx)(eS.UF,{chunks:o,documentId:n,readonly:!s,onChange:i,onAddChunk:l,onDeleteChunk:a})}):(0,m.jsx)("div",{className:$()(eb.Z["empty-content"]),children:(0,m.jsx)(N.ub,{size:"large",icon:d?(0,m.jsx)(eN.xs,{style:{width:150,height:"100%"}}):(0,m.jsx)(eE.s9d,{style:{width:150,height:"100%"}}),title:r?b.o.t("content_view_003"):d?b.o.t("knowledge_no_result"):b.o.t("dataset_segment_empty_desc")})})},eA=e=>{var t,r,n,{onChangeDocList:o,reload:i,progressMap:l,linkOriginUrlButton:a,fetchSliceButton:s}=e,d=(0,v.useRef)(null),c=(0,f.kF)(),u=(0,f.PR)(e=>e.documentList),p=(0,f.EV)();eu();var{handleSelectDocument:_,handleRenameDocument:h,handleUpdateDocumentFrequency:x,rollbackDocumentSelection:g}=ec({reloadDataset:i}),{curDoc:y,curDocId:b,isProcessing:j,processFinished:w,datasetId:C}=em(l),{showOriginalFile:k,handleToggleOriginalFile:S}=ep(b),{loading:E,renderData:T,handleContentChange:I,reload:P}=ev({curDocId:b,datasetId:C,curChunkType:null==y?void 0:null===(t=y.chunk_strategy)||void 0===t?void 0:t.chunk_type,processFinished:w,target:d,rollbackDocumentSelection:g}),{levelSegments:A,selectionIDs:L,setSelectionIDs:O,tosLoading:Z,handleLevelSegmentsChange:F,handleLevelSegmentDelete:M}=eh({curDoc:y}),{handleIncreaseSliceCount:R,handleDecreaseSliceCount:B}=ex(),{deleteModalNode:V,showDeleteModal:U,updateFrequencyModalNode:H,showUpdateFrequencyModal:W}=ed({docId:null==y?void 0:y.document_id,documentType:null==y?void 0:y.format_type,documentSource:null==y?void 0:y.source_type,onDelete:()=>{null==i||i(),_("")},onUpdateFrequency:e=>{if(!!o&&!!y){var t,r=x(null!==(t=y.document_id)&&void 0!==t?t:"",e);r&&o(r)}}}),G=es(u,l),K="project"===c.biz;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:$()("flex grow border-solid coz-stroke-primary coz-bg-max",K?"h-[calc(100%-64px)] border-0 border-t":"h-[calc(100%-112px)] border rounded-[8px]"),children:[(0,m.jsx)("div",{className:$()("w-[300px] h-full shrink-0 overflow-auto p-[12px]","border-0 border-r border-solid coz-stroke-primary"),children:(0,m.jsx)(X.yt,{isSearchable:!0,list:(null!=u?u:[]).map(e=>{var t,r,n;return{id:null!==(r=e.document_id)&&void 0!==r?r:"",title:null!==(n=e.name)&&void 0!==n?n:"",label:null===(t=G.find(t=>t.value===e.document_id))||void 0===t?void 0:t.label}}),selectedID:b,onClick:e=>{e!==b&&_(e)},levelSegments:A,setSelectionIDs:O,treeDisabled:!0,treeVisible:(null==y?void 0:null===(r=y.chunk_strategy)||void 0===r?void 0:r.chunk_type)===z.x2.LevelChunk})}),(0,m.jsxs)(N.yC,{spinning:E||Z,size:"large",wrapperClassName:"h-full !w-full grow rounded-r-[8px] overflow-hidden",childStyle:{height:"100%",flexGrow:1,width:"100%"},children:[(0,m.jsx)(ek,{documentData:{curDoc:y,curDocId:b,curFormatType:null==y?void 0:y.format_type,docOptions:G},filePreviewData:{showOriginalFile:k,fileUrl:null==y?void 0:y.preview_tos_url},documentActions:{onChangeDoc:_,onRenameDoc:h,onToggleOriginalFile:S,onResegment:()=>{var e,t,r,n=(null==y?void 0:y.source_type)===z.NZ.Document;null===(e=p.upload)||void 0===e||e.call(p,{type:n?D.Cm.TEXT_DOC:D.Cm.TEXT,opt:D.VP.RESEGMENT,doc_id:null!=b?b:"",page_mode:null!==(t=c.pageMode)&&void 0!==t?t:"",bot_id:null!==(r=c.botID)&&void 0!==r?r:""})},onUpdateFrequency:()=>W({updateInterval:null==y?void 0:y.update_interval,updateType:null==y?void 0:y.update_type}),onDelete:U,reloadDataset:i},customUIElements:{linkOriginUrlButton:a,fetchSliceButton:s}}),(0,m.jsxs)("div",{className:"flex h-[calc(100%-56px)] grow w-full",children:[(0,m.jsx)(eI,{fileType:null==y?void 0:y.type,fileUrl:(null==y?void 0:y.preview_tos_url)||"",visible:k}),(0,m.jsx)("div",{ref:d,className:$()("w-full grow h-full overflow-auto","px-[16px] pt-[16px]"),children:(null==y?void 0:null===(n=y.chunk_strategy)||void 0===n?void 0:n.chunk_type)===z.x2.LevelChunk?(0,m.jsx)(eT,{isProcessing:j,documentId:b,levelSegments:A,selectionIDs:L,onLevelSegmentsChange:F,onLevelSegmentDelete:M}):(0,m.jsx)(eP,{loading:E,isProcessing:j,documentId:b,renderData:T,onContentChange:I,onAddChunk:()=>{P(),R()},onDeleteChunk:()=>{B()}})})]})]})]}),V,H]})},eD=r("937393"),eL=(0,v.createContext)({importKnowledgeMenuSourceFeatureRegistry:void 0}),eO=()=>(0,v.useContext)(eL),eZ=r("522426"),eF=e=>{var{triggerComponent:t,onVisibleChange:r,children:n}=e;return(0,m.jsx)(N.v2,{clickToHide:!0,trigger:"click",position:"bottomRight",onVisibleChange:r,render:(0,m.jsx)(N.v2.SubMenu,{mode:"menu",className:eZ.Z["create-opt-select-down"],children:n}),children:t})},eM=e=>{var{triggerComponent:t,onVisibleChange:r,onChange:n}=e,{importKnowledgeMenuSourceFeatureRegistry:o}=eO();return(0,m.jsx)(eF,{triggerComponent:t,onVisibleChange:r,children:null==o?void 0:o.entries().map(e=>{var[t,{Component:r}]=e;return(0,m.jsx)(r,{onClick:e=>null==n?void 0:n(e)},t)})})},ez=e=>{var t=null==e?void 0:e[0];return t?t.status===z._m.Processing?b.o.t("knowledge_add_content_processing_tips"):(null==t?void 0:t.slice_count)>=P.fj?b.o.t("kl2_002"):"":""},eR=e=>{var t;return(null==e?void 0:e.doc_count)>=P.by?b.o.t("kl2_003"):(null==e?void 0:null===(t=e.processing_file_id_list)||void 0===t?void 0:t.length)?b.o.t("knowledge_add_content_processing_tips"):""},eB=(e,t)=>{var r=null==e?void 0:e.format_type,n={[z.a5.Table]:()=>ez(t),default:()=>eR(e)};return r?(n[r]||n.default)():n.default()},eV=e=>{var{disabledTooltip:t,onSourceChange:r}=e,n=(0,f.PR)(e=>e.documentList),o=(0,f.PR)(e=>e.dataSetDetail),[i,l]=(0,v.useState)(!1),a=(0,f.EV)(),s=null!=t?t:eB(o,n),d=(0,eD.S)();return s?(0,m.jsx)(N.u,{content:s,arrowPointAtCenter:!1,position:"top",children:(0,m.jsx)(N.zx,{"data-testid":ey.w.SegmentDetailAddBtn,color:"hgltplus",disabled:!0,iconPosition:"right",icon:(0,m.jsx)(eE.Wdl,{className:"text-[12px]"}),children:b.o.t("knowledg_unit_add_segments")})}):(0,m.jsx)(eM,{onVisibleChange:e=>{l(e)},onChange:e=>{if(r){r(e);return}var t,i,l=null==o?void 0:o.format_type,s=null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.document_id,c=(0,p._)({type:e},d);l===z.a5.Table&&s&&(c.opt=D.VP.INCREMENTAL,c.doc_id=s),null===(i=a.upload)||void 0===i||i.call(a,c)},triggerComponent:(0,m.jsx)(N.zx,{"data-testid":ey.w.SegmentDetailAddBtn,iconPosition:"right",icon:i?(0,m.jsx)(Q.uDC,{className:"text-[12px]"}):(0,m.jsx)(eE.Wdl,{className:"text-[12px]"}),children:b.o.t("knowledg_unit_add_segments")})})},eU=r("157728"),eH=r("328591"),eW=r("189284"),eG=r("379361"),eK={[z.a5.Table]:{icon:(0,m.jsx)(eE.J_i,{}),bgColor:"#35C566",suffixIcon:(0,m.jsx)(eE.plM,{}),suffixBgColor:"rgba(255,150,0,1)"},[z.a5.Text]:{icon:(0,m.jsx)(eE.rwS,{}),bgColor:"rgba(34, 136, 255, 1)",suffixIcon:(0,m.jsx)(eE.plM,{}),suffixBgColor:"rgba(255,150,0,1)"}},eJ=e=>{var t,r,n,o,{formatType:i=z.a5.Text,hasSuffix:l,className:a}=e;return(0,m.jsxs)("div",{className:$()(eG.Z["icon-with-suffix"],a),children:[(0,m.jsx)("div",{className:$()("icon-with-suffix-common","icon"),style:{backgroundColor:"".concat(null==eK?void 0:null===(t=eK[i])||void 0===t?void 0:t.bgColor)},children:null==eK?void 0:null===(r=eK[i])||void 0===r?void 0:r.icon}),l?(0,m.jsx)("div",{className:$()("icon-with-suffix-common","suffix"),style:{backgroundColor:"".concat(null==eK?void 0:null===(n=eK[i])||void 0===n?void 0:n.suffixBgColor)},children:null==eK?void 0:null===(o=eK[i])||void 0===o?void 0:o.suffixIcon}):null]})},eq=e=>{var{formatType:t,sourceType:r,isDisconnect:n,className:o,iconSuffixClassName:i}=e;return r&&([z.NZ.Notion,z.NZ.GoogleDrive].includes(r)||(0,eg.$6)(r))?(0,m.jsx)(eJ,{hasSuffix:!!n,formatType:t,className:i}):t===z.a5.Table?(0,m.jsx)(eE.Ov0,{className:o}):(0,m.jsx)(eE.r90,{className:o})},e$=r("848032"),eX=r("286144"),eY=()=>{var e=(0,f.PR)(e=>e.photoFilterValue),t=(0,f.PR)(e=>e.setPhotoFilterValue);return(0,m.jsxs)("div",{className:eX.Z["photo-filter-tab"],children:[(0,m.jsx)("div",{"data-testid":ey.w.ImageAnnotationAllTab,onClick:()=>t(e$.X.All),className:e===e$.X.All?eX.Z["photo-filter-tab-item-active"]:eX.Z["photo-filter-tab-item"],children:b.o.t("knowledge-dataset-type-all")},e$.X.All),(0,m.jsx)(N.iz,{layout:"vertical",margin:"12px"}),(0,m.jsx)("div",{"data-testid":ey.w.ImageAnnotationAnnotationedTab,onClick:()=>t(e$.X.HasCaption),className:e===e$.X.HasCaption?eX.Z["photo-filter-tab-item-active"]:eX.Z["photo-filter-tab-item"],children:b.o.t("knowledge_photo_013")},e$.X.HasCaption),(0,m.jsx)(N.iz,{layout:"vertical",margin:"12px"}),(0,m.jsx)("div",{"data-testid":ey.w.ImageAnnotationUnAnnotationTab,onClick:()=>t(e$.X.NoCaption),className:e===e$.X.NoCaption?eX.Z["photo-filter-tab-item-active"]:eX.Z["photo-filter-tab-item"],children:b.o.t("knowledge_photo_014")},e$.X.NoCaption)]})},eQ=e=>{var t,r,n,o,{dataSetDetail:i,docInfo:l,progressMap:a={}}=e,s=null==i?void 0:i.format_type,d=(0,v.useMemo)(()=>{if(!l)return"";var e=L[null==l?void 0:l.update_type];return l.update_interval&&(e="".concat(b.o.t("datasets_segment_tag_updateFrequency",{num:l.update_interval}))),e},[l]);return(0,m.jsx)("div",{className:"flex pb-[4px]","data-testid":ey.w.UnitDetailTags,children:(0,m.jsxs)(N.T,{spacing:4,className:"[&_.semi-tag-content]:font-medium",children:[(null==i?void 0:i.all_file_size)?(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:(0,B.td)(parseInt(String(i.all_file_size)))}):null,s===z.a5.Table&&!!l&&(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:en(l)}),s===z.a5.Table&&l&&(null==l?void 0:l.source_type)===z.NZ.Web?(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:d}):null,s===z.a5.Text&&!!(null==i?void 0:i.doc_count)&&(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:b.o.t("kl2_009",{num:null!==(n=null==i?void 0:i.doc_count)&&void 0!==n?n:0})}),s===z.a5.Image&&(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:b.o.t("dataset_detail_source_local")}),s===z.a5.Image&&!!(null==i?void 0:i.doc_count)&&(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:b.o.t("knowledge_photo_015",{num:(null==i?void 0:i.doc_count)||0})}),s!==z.a5.Image&&!!(null==i?void 0:i.doc_count)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:b.o.t("datasets_segment_tag_segments",{num:null!==(o=null==i?void 0:i.slice_count)&&void 0!==o?o:0})}),(0,m.jsx)(N.Vp,{size:"mini",color:"primary",children:b.o.t("datasets_segment_card_hit",{num:null==i?void 0:i.hit_count})})]}),(null==i?void 0:i.storage_location)===z.Ac.OpenSearch?(0,m.jsx)(N.Vp,{size:"mini",color:"cyan",children:b.o.t("knowledge_es_001")}):null,!!(null==i?void 0:i.processing_file_id_list)&&!!(null==i?void 0:null===(t=i.processing_file_id_list)||void 0===t?void 0:t.length)&&(0,m.jsxs)(N.Vp,{size:"mini",color:"blue","data-testid":ey.w.UnitDetailTagsProcessing,children:[b.o.t("datasets_segment_tag_processing"),(null==l?void 0:l.format_type)===z.a5.Table&&(null==a?void 0:a[null==l?void 0:l.document_id])?"".concat(null==a?void 0:null===(r=a[null==l?void 0:l.document_id])||void 0===r?void 0:r.progress,"%"):""]}),s===z.a5.Table&&(null==l?void 0:l.status)===z._m.Failed&&(0,m.jsx)(N.Vp,{size:"mini",color:"red","data-testid":ey.w.UnitDetailTagsFailed,children:(null==l?void 0:l.status_descript)||b.o.t("dataset_process_fail")})]})})},e0=r("552639"),e1=e=>{var{datasetId:t,style:r,classNameItem:n}=e,{loading:o,data:i,run:l,error:a}=(0,x.Z)((0,h._)(function*(){return(yield w.MJ.GetDatasetRefBots({dataset_id:t})).ref_bots}),{onError:e=>{C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeGetDatasetRefDetail,error:e})},manual:!0});return((0,v.useEffect)(()=>{l()},[t]),a)?(0,m.jsx)("div",{children:b.o.t("knowledge_optimize_020")}):o?(0,m.jsx)(N.gb,{loading:o}):(0,m.jsx)("div",{className:e0.Z["related-bots-list"],children:null==i?void 0:i.map(e=>(0,m.jsxs)("div",{className:n||e0.Z["related-bots-list-item"],style:r,children:[(0,m.jsx)("div",{className:"related-bots-circle",children:"."}),(0,m.jsx)("div",{children:e.name})]},e.name))})};r("852497"),A.a5.Table,eE.J_i,eE.plM,A.a5.Text,eE.rwS,eE.plM,r("474872"),r("941415");var e2=r("427286"),e4=e=>{var t,{title:r,actionButtons:n,datasetDetail:o,docInfo:i,onBack:l,beforeBack:a,importKnowledgeSourceButton:s}=e,d=(0,f.PR)(e=>e.setSearchValue),c=(0,f.PR)(e=>e.dataSetDetail),u=(0,f.PR)(e=>e.canEdit),p=(0,f.kF)();(0,v.useEffect)(()=>()=>{d("")},[]);var _=(null==c?void 0:c.format_type)===z.a5.Image;return(0,m.jsxs)("div",{className:$()("flex items-center justify-between shrink-0 h-[56px]",e2.Z.navbar),"data-testid":ey.w.KnowledgeAddContentNavBar,children:[(0,m.jsxs)("div",{className:e2.Z.brief,children:[(0,m.jsx)(N.hU,{color:"secondary",icon:(0,m.jsx)(Q.rmE,{className:"text-[16px]"}),iconPosition:"left",className:"".concat(e2.Z["back-icon"]," mr-[8px]"),onClick:()=>{null==a||a(),null==l||l()}}),(null==o?void 0:o.icon_url)?(0,m.jsx)(N.qE,{src:null==o?void 0:o.icon_url,shape:"square"}):(0,m.jsx)(eq,{formatType:eo(null!==(t=p.type)&&void 0!==t?t:D.Cm.TEXT),className:e2.Z["doc-icon-note"],iconSuffixClassName:"icon-with-suffix-overlay"}),(0,m.jsxs)("div",{className:"ml-[12px]",children:[(0,m.jsx)("p",{className:"text-[18px] font-medium",children:r}),!!o&&(0,m.jsx)(eQ,{dataSetDetail:o,docInfo:i})]})]}),(0,m.jsx)("div",{className:e2.Z.toolbar,children:(0,m.jsxs)(N.T,{spacing:12,children:[_?(0,m.jsx)(eY,{}):null,u?s:null,n]})})]})},e5=r("399639"),e6=e=>{var t,r,n,o,{onChangeDataset:i,progressMap:l,hideBackButton:a,textConfigButton:s,tableConfigButton:d,importKnowledgeSourceButton:c,onBack:u}=e,_=(0,f.PR)(e=>e.dataSetDetail),x=(0,f.PR)(e=>e.canEdit),g=(0,f.PR)(e=>e.documentList),y=(0,eU.useNavigate)(),j=(0,f.kF)(),[C]=(0,eW.V)();var{node:k,edit:S}=(0,eH.Ej)({onOk:(t=(0,h._)(function*(e){var t,r,n,o,l;yield w.MJ.UpdateDataset({dataset_id:e.id,name:e.name,icon_uri:null===(t=e.icon_uri)||void 0===t?void 0:t[0].uid,description:e.description}),i((0,V._)((0,p._)({},_),{name:(null==e?void 0:e.name)||(null==_?void 0:_.name),description:(null==e?void 0:e.description)||(null==_?void 0:_.description),icon_uri:(null===(n=e.icon_uri)||void 0===n?void 0:null===(r=n.at(0))||void 0===r?void 0:r.uid)||(null==_?void 0:_.icon_uri),icon_url:(null===(l=e.icon_uri)||void 0===l?void 0:null===(o=l.at(0))||void 0===o?void 0:o.url)||(null==_?void 0:_.icon_url)}))}),function(e){return t.apply(this,arguments)})}),E=(null==_?void 0:_.format_type)===z.a5.Table,T=(null==_?void 0:_.format_type)===z.a5.Image,I=x&&!E&&!!(null==_?void 0:_.doc_count)&&!(null==_?void 0:null===(r=_.processing_file_id_list)||void 0===r?void 0:r.length)&&!T,P=null==g?void 0:g[0],A=(0,v.useMemo)(()=>P?et({format_type:z.a5.Table,source_type:null==P?void 0:P.source_type}):D.Cm.TABLE_API,[P]),L=((0,v.useMemo)(()=>A&&[D.Cm.TABLE_API,D.Cm.TABLE_GOOGLE_DRIVE,D.Cm.TABLE_FEISHU,D.Cm.TABLE_LARK].includes(A),[A])||x)&&E&&(null==g?void 0:g.length),O="project"===j.biz;return(0,m.jsxs)("div",{className:$()("flex items-center justify-between shrink-0",O?"px-[16px] py-[12px]":"h-[56px]",e5.Z.brief),children:[(0,m.jsxs)("div",{className:e5.Z.info,children:[a?null:(0,m.jsx)(N.hU,{color:"secondary",icon:(0,m.jsx)(Q.$1i,{className:"text-[16px]"}),iconPosition:"left",onClick:()=>{null==u||u(),y("/space/".concat(j.spaceID,"/library"))},className:"mr-[4px]"}),(0,m.jsx)("div",{className:e5.Z.icon,children:(null==_?void 0:_.icon_url)?(0,m.jsx)(N.qE,{src:null==_?void 0:_.icon_url,shape:"square",size:"default"}):(0,m.jsx)(eq,{formatType:(null==_?void 0:_.format_type)||z.a5.Text,className:e5.Z["doc-icon-note"],iconSuffixClassName:"icon-with-suffix-overlay"})}),(0,m.jsxs)("div",{className:e5.Z.content,children:[(0,m.jsxs)("div",{className:"flex items-center gap-[3px]",children:[(0,m.jsx)(N.ZT.Text,{"data-testid":ey.w.SegmentDetailTitle,className:e5.Z.title,weight:500,ellipsis:{showTooltip:{opts:{content:null==_?void 0:_.name}}},children:null==_?void 0:_.name}),x?(0,m.jsx)(N.u,{content:b.o.t("datasets_segment_edit"),children:(0,m.jsx)(N.hU,{"data-testid":ey.w.SegmentDetailTitleEditIcon,size:"mini",color:"secondary",icon:(0,m.jsx)(Q.JAz,{className:"text-[14px]"}),iconPosition:"left",wrapperClass:"text-[0] leading-none",className:"coz-fg-secondary",onClick:()=>{S({id:_.dataset_id||"",name:null==_?void 0:_.name,description:null==_?void 0:_.description,icon_uri:[{url:(null==_?void 0:_.icon_url)||"",uid:(null==_?void 0:_.icon_uri)||""}]})}})}):null,C["bot.data.knowledge_bots_count"]?(0,m.jsxs)("div",{className:e5.Z["bot-count"],children:[(0,m.jsx)("div",{className:e5.Z["bot-count-text"],children:b.o.t("knowledge_optimize_019",{n:null!==(n=null==_?void 0:_.bot_used_count)&&void 0!==n?n:0})}),!!(null==_?void 0:_.bot_used_count)&&(0,m.jsx)(N.u,{autoAdjustOverflow:!0,position:(null==_?void 0:_.bot_used_count)>2?"bottom":"top",content:(0,m.jsx)(e1,{datasetId:null!==(o=null==_?void 0:_.dataset_id)&&void 0!==o?o:"",classNameItem:e5.Z["bot-used-count"]}),children:(0,m.jsx)(Q.L03,{className:e5.Z["bot-count-icon"]})})]}):null]}),(0,m.jsx)(eQ,{dataSetDetail:_,docInfo:null==g?void 0:g[0],progressMap:l})]})]}),(0,m.jsx)("div",{children:(0,m.jsxs)(N.T,{spacing:10,children:[T?(0,m.jsx)(eY,{}):null,I?s:null,L?d:null,x?c:null]})}),k]})},e3=e=>{var{progressMap:t,hideBackButton:r,importKnowledgeSourceButton:n}=e,{setDataSetDetail:o}=(0,f.PR)((0,_.N)(e=>({setDataSetDetail:e.setDataSetDetail})));return(0,m.jsx)(e6,(0,V._)((0,p._)({},e),{importKnowledgeSourceButton:null!=n?n:(0,m.jsx)(eV,{}),onChangeDataset:o,progressMap:t,hideBackButton:r}))},e8=e=>{var{title:t,icon:r,testId:n,value:o,onClick:i}=e;return(0,m.jsx)(N.v2.Item,{icon:null!=r?r:null,onClick:()=>{o&&i&&i.call(void 0,o)},"data-testid":n,children:t},o)},e9={Component:e=>{var{onClick:t}=e;return(0,m.jsx)(e8,{title:b.o.t("datasets_createFileModel_step1_LocalTitle"),icon:(0,m.jsx)(Q.da8,{className:"w-4 h-4"}),testId:"".concat(ey.w.SegmentDetailDropdownItem,".").concat(D.Cm.TEXT_DOC),value:D.Cm.TEXT_DOC,onClick:()=>t(D.Cm.TEXT_DOC)})}},e7={Component:e=>{var{onClick:t}=e;return(0,m.jsx)(e8,{title:b.o.t("datasets_createFileModel_step1_CustomTitle"),icon:(0,m.jsx)(Q.YRi,{className:"w-4 h-4"}),testId:"".concat(ey.w.SegmentDetailDropdownItem,".").concat(D.Cm.TEXT_CUSTOM),value:D.Cm.TEXT_CUSTOM,onClick:()=>t(D.Cm.TEXT_CUSTOM)})}},te={Component:e=>{var{onClick:t}=e;return(0,m.jsx)(e8,{title:b.o.t("datasets_createFileModel_step1_TabCustomTitle"),icon:(0,m.jsx)(Q.YRi,{className:"w-4 h-4"}),testId:"".concat(ey.w.SegmentDetailDropdownItem,".").concat(D.Cm.TABLE_CUSTOM),value:D.Cm.TABLE_CUSTOM,onClick:()=>t(D.Cm.TABLE_CUSTOM)})}},tt={Component:e=>{var{onClick:t}=e;return(0,m.jsx)(e8,{title:b.o.t("datasets_createFileModel_step1_TabLocalTitle"),icon:(0,m.jsx)(Q.da8,{className:"w-4 h-4"}),testId:"".concat(ey.w.SegmentDetailDropdownItem,".").concat(D.Cm.TABLE_DOC),value:D.Cm.TABLE_DOC,onClick:()=>t(D.Cm.TABLE_DOC)})}},tr={Component:e=>{var{onClick:t}=e;return(0,m.jsx)(e8,{title:b.o.t("knowledge_photo_002"),icon:(0,m.jsx)(Q.da8,{className:"w-4 h-4"}),testId:"".concat(ey.w.SegmentDetailDropdownItem,".").concat(D.Cm.IMAGE_FILE),value:D.Cm.IMAGE_FILE,onClick:()=>t(D.Cm.IMAGE_FILE)})}},tn=r("304194"),to=e=>new tn.j({name:e});var ti={importKnowledgeMenuSourceFeatureRegistry:((i=to("import-knowledge-source-text-menu")).registerSome([{type:"text-local",module:e9},{type:"text-custom",module:e7}]),i)},tl=e=>(0,m.jsx)(eL.Provider,{value:ti,children:(0,m.jsx)(J,(0,p._)({renderNavBar:t=>{var{statusInfo:r}=t;return(0,m.jsx)(e3,(0,p._)({progressMap:r.progressMap},e.navBarProps))},renderContent:t=>{var r,n,{dataActions:o,statusInfo:i}=t;return(0,m.jsx)(eA,{progressMap:i.progressMap,reload:o.refreshData,onChangeDocList:o.updateDocumentList,linkOriginUrlButton:null===(r=e.contentProps)||void 0===r?void 0:r.linkOriginUrlButton,fetchSliceButton:null===(n=e.contentProps)||void 0===n?void 0:n.fetchSliceButton})}},e.layoutProps))}),ta=r("512946"),ts=()=>{var e,t=(0,f.PR)(e=>e.documentList),r=null==t?void 0:null===(e=t[0])||void 0===e?void 0:e.document_id,{data:n,mutate:o,reload:i,loadMore:l,loading:a,loadingMore:s}=H({params:{document_id:r},reloadDeps:[r],target:null,onError:e=>{C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeGetSliceList,error:e}),N.FN.error(b.o.t("knowledge_document_view"))}});return{sliceListData:n,mutateSliceListData:o,reloadSliceList:i,loadMoreSliceList:l,isLoadingMoreSliceList:s,isLoadingSliceList:a}},td=(0,v.createContext)(null),tc=()=>{var e=(0,v.useContext)(td);if(!e)throw Error("useTableUI must be used within a TableUIProvider");return e},tu=(0,v.createContext)(null),tp=()=>{var e=(0,v.useContext)(tu);if(!e)throw Error("useTableData must be used within a TableDataProvider");return e},tm=(0,v.createContext)(null),tv=()=>{var e=(0,v.useContext)(tm);if(!e)throw Error("useTableActions must be used within a TableActionsProvider");return e},t_=r("461190"),tf=r("962289"),th=r("594022"),tx=r("757208"),tg=e=>(0,m.jsx)(N.Vp,{color:"primary",className:"ml-[6px] text-xs",size:"mini",children:(0,eg.y8)(e.columnType)}),ty=e=>{try{var t;return null!==(t=t_._N.getTableWidthMap(e))&&void 0!==t?t:{}}catch(e){return console.log("getTableCacheWidthMap error",e),{}}},tb=e=>{var{sliceList:t,metaData:r=[],onEdit:n,onUpdate:o,onDelete:i,canEdit:l,tableKey:a}=e;try{var s=document.getElementsByClassName("knowledge-ide-base-slice-list-ui-content")[0],d=ty(a),c=s?s.offsetWidth-(l?397:259):1400,u=t.map(e=>{var{char_count:t,hit_count:r,status:n}=e,o={char_count:t,hit_count:r,status:n},i=(0,B.dj)(e.content);return Array.isArray(i)&&i.forEach(e=>{o[e.column_id]=e.value}),o}),v=c/r.length>200?c/r.length:200,_=r.map((e,r)=>{var n;return{dataIndex:e.id,title:(0,m.jsxs)("div",{className:"flex flex-row items-center",children:[(0,m.jsx)(N.ZT.Text,{className:"cursor-pointer",ellipsis:{showTooltip:{opts:{content:e.column_name}}},children:e.column_name}),e.is_semantic?(0,m.jsx)(N.Vp,{size:"mini",color:"green",className:"ml-2","data-testid":ey.w.TableLocalPreviewSemantic,children:b.o.t("knowledge_1226_001")}):null,e.column_type?(0,m.jsx)(tg,{columnType:e.column_type}):null]}),width:null!==(n=(0,tf.Z)(d,e.id||""))&&void 0!==n?n:v,render:(n,i,a)=>{var s=0===r&&a===t.length-1&&!!t[a].addId;if(e.column_type===th.QD.Image){var d=(0,P.bp)(n);return(0,m.jsx)(t_.e0,{srcList:d,onChange:(t,r)=>{var n="";(t||r)&&(n='<img src="'.concat(null!=t?t:"",'" ').concat(r?'data-tos-key="'.concat(r,'"'):"",">"));var l=(0,V._)((0,p._)({},i),{[null==e?void 0:e.id]:n});null==o||o(l,a)}})}var c=(null==i?void 0:i.status)===tx.OL.AuditFailed,u=()=>{var t;return(0,m.jsx)("div",{className:"w-full ".concat(c?"text-red-500":""),children:(0,m.jsx)(t_.EY,{dataIndex:e.id,value:n,record:i,index:a,isEditing:s,editable:l,validator:{validate:t=>!!e.is_semantic&&(!t||""===t),errorMsg:b.o.t("datasets_url_empty")},onBlur:(t=(0,h._)(function*(e,t){return yield null==o?void 0:o(t,a,e)}),function(e,r){return t.apply(this,arguments)})})})};return c?(0,m.jsx)(N.u,{content:b.o.t("knowledge_content_illegal_error_msg"),trigger:"hover",position:"top",getPopupContainer:()=>document.body,children:u()}):u()}}});return _.push({title:"",className:"not-resize-handle data-tags",resize:!1,render:(e,t,r)=>{var{char_count:n,hit_count:o}=t;return(0,m.jsxs)("div",{className:"flex gap-3",children:[(0,m.jsx)(t_.wn,{value:"".concat(null!=n?n:0," ").concat(b.o.t("datasets_segment_card_bit",{num:null!=n?n:0}))}),(0,m.jsx)(t_.wn,{value:b.o.t("datasets_segment_card_hit",{num:null!=o?o:0})})]})}}),l&&_.push({title:"",width:100,className:"not-resize-handle",resize:!1,render:(e,t,r)=>(0,m.jsx)(t_.E2,{record:t,index:r,editProps:{disabled:!1,onEdit:()=>{null==n||n(t,r)}},deleteProps:{disabled:!1,onDelete:()=>{null==i||i([r])}}})}),_.unshift({title:"",width:68,fixed:!0,resize:!1,className:"pl-0 text-sm not-resize-handle",render:(e,t,r)=>(0,m.jsx)("div",{className:"text-xs coz-fg-secondary",children:r+1})}),{data:u,columns:_}}catch(e){return console.log("transSliceList handler error",e),{data:[],columns:[]}}},tj=r("335740"),tw=()=>{var e=(0,f.PR)(e=>e.dataSetDetail),t=(0,f.PR)(e=>e.setDataSetDetail),{sliceListData:r}=tp(),{mutateSliceListData:n}=tv(),o=(0,f.PR)(e=>e.documentList),i=null==o?void 0:o[0],{createSlice:l}=K({onReload:o=>{var l,a,s,d,c,u,m=null!==(a=(null!==(l=null==r?void 0:r.list)&&void 0!==l?l:[]).filter(e=>!e.addId))&&void 0!==a?a:[],v=JSON.parse(null!==(s=o.content)&&void 0!==s?s:"{}"),_=(null!==(d=null==i?void 0:i.table_meta)&&void 0!==d?d:[]).reduce((e,t)=>{var r,n;return e.push({column_name:null!==(r=null==t?void 0:t.column_name)&&void 0!==r?r:"",column_id:null!==(n=null==t?void 0:t.id)&&void 0!==n?n:"",value:t.id?v[t.id]:""}),e},[]);m.push((0,V._)((0,p._)({},o),{content:JSON.stringify(_)})),n((0,V._)((0,p._)({},r),{total:Number(null!==(c=null==r?void 0:r.total)&&void 0!==c?c:"0"),list:m})),e&&t((0,V._)((0,p._)({},e),{slice_count:null!==(u=null==m?void 0:m.length)&&void 0!==u?u:0}))}});return{createSlice:l}},tC=e=>{var t,{openDeleteSliceModal:r,openTableSegmentModal:n}=e,o=(0,f.PR)(e=>e.documentList),{mutateSliceListData:i,setDelSliceIds:l,setCurIndex:a,setCurSliceId:s}=tv(),{createSlice:d}=tw(),{sliceListData:c}=tp(),{tableViewRef:u}=tc(),m=null==o?void 0:o[0],v=null==c?void 0:c.list,_=e=>{if(!!(null==m?void 0:m.document_id))try{return{document_id:m.document_id,raw_text:e}}catch(e){return console.log("error",e),null}};var x=(t=(0,h._)(function*(e,t,r){if(!!v){var n=(0,tj.Z)(c);try{var o,l=v[t].slice_id,a=Object.fromEntries(Object.entries(e).filter(e=>{var[t]=e;return!["tableViewKey","char_count","hit_count"].includes(t)})),s=[];null==m||null===(o=m.table_meta)||void 0===o||o.forEach(e=>{e.column_type===th.QD.Image&&s.push(e.id)});var u=Object.fromEntries(Object.entries(a).map(e=>{var[t,r]=e;return s.includes(t)?[t,(0,P.Yw)(r)]:[t,r]})),f=(0,p._)({},u);delete f.status;var h=JSON.stringify(f);if(l)yield G(l,h,r);else if((yield _(h))&&d&&(null==m?void 0:m.document_id))try{yield d({document_id:m.document_id,raw_text:h})}catch(e){console.log("createSlice error:",e)}if(v)return!0}catch(e){throw console.log(e),i(n),Error(e)}}}),function(e,r,n){return t.apply(this,arguments)});return{deleteSlice:e=>{if(!!v){var t,n,o=e.filter(e=>!v[e].slice_id),a=o.map(e=>{var t;return null===(t=v[e])||void 0===t?void 0:t.addId}),s=e.filter(e=>!o.includes(e)).map(e=>v[e].slice_id).filter(Boolean);a.length&&s.length<=0&&(i((0,V._)((0,p._)({},c),{total:Number(null!==(n=null==c?void 0:c.total)&&void 0!==n?n:"0"),list:v.filter(e=>!a.includes(null==e?void 0:e.addId))})),null==u||null===(t=u.current)||void 0===t||t.resetSelected()),s.length&&(l(s),r())}},createSlice:_,modalEditSlice:(e,t)=>{var r,o;if(!!v&&!(t<0)&&!(t>=v.length))a(t),s((null===(r=v[t])||void 0===r?void 0:r.slice_id)||""),n((null===(o=v[t])||void 0===o?void 0:o.content)||"")},rowUpdateSliceData:x}},tk=()=>{var e,t=(0,f.PR)(e=>e.documentList),{sliceListData:r,curIndex:n,curSliceId:o}=tp(),{mutateSliceListData:i}=tv(),l=null==t?void 0:t[0];var{node:a,edit:s,fetchCreateTableSegment:d,fetchUpdateTableSegment:c}=(0,P.nV)({title:n>-1?(0,m.jsx)("div",{className:"slice-modal-title",children:b.o.t("datasets_segment_detailModel_title",{num:n+1})}):b.o.t("dataset_segment_content"),meta:(null==l?void 0:l.table_meta)||[],canEdit:!0,onSubmit:(e=(0,h._)(function*(e,t){e===P.wO.Create&&(null==l?void 0:l.document_id)?yield d(null==l?void 0:l.document_id,t):e===P.wO.Edit&&o&&(yield c(o,t))}),function(t,r){return e.apply(this,arguments)}),onFinish:(e,t)=>{if(e===P.wO.Create)N.FN.success({content:b.o.t("knowledge_tableview_03"),showClose:!1});else if(e===P.wO.Edit&&r){var o=JSON.stringify(t),l=r.list;l[n].content=o,l[n].status=tx.OL.FinishVectoring,i((0,V._)((0,p._)({},r),{list:l}))}}});return{tableSegmentModalNode:a,openTableSegmentModal:s,fetchCreateTableSegment:d,fetchUpdateTableSegment:c}},tN=()=>{var e=(0,f.PR)(e=>e.dataSetDetail),t=(0,f.PR)(e=>e.setDataSetDetail),r=(0,f.PR)(e=>e.documentList),{sliceListData:n,delSliceIds:o}=tp(),{tableViewRef:i}=tc(),{mutateSliceListData:l}=tv(),a=null==r?void 0:r[0],s=null==n?void 0:n.list,{node:d,delete:c}=(0,P.qS)({onDel:(0,h._)(function*(){try{if(yield W(o),!a)return;N.FN.success({content:b.o.t("Delete_success"),showClose:!1}),console.log("oldList",s);var r,d=(s||[]).filter(e=>{var t,r;return!o.includes(null!==(t=e.slice_id)&&void 0!==t?t:"")&&!o.includes(null!==(r=e.addId)&&void 0!==r?r:"")});l((0,V._)((0,p._)({},n),{list:d})),console.log("newList",d),null==i||null===(r=i.current)||void 0===r||r.resetSelected(),e&&"number"==typeof e.slice_count&&t((0,V._)((0,p._)({},e),{slice_count:e.slice_count>-1?Math.max(0,e.slice_count-((null==o?void 0:o.length)||0)):0}))}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeDeleteSlice,error:e})}})});return{deleteSliceModalNode:d,openDeleteSliceModal:c}},tS=e=>{var{increaseTableHeight:t,scrollTableBodyToBottom:r}=e,{sliceListData:n}=tp(),{mutateSliceListData:o}=tv();return{handleAddRow:()=>{t(56);var e,i,l,a=JSON.parse(null!==(i=null==n?void 0:null===(e=n.list[0])||void 0===e?void 0:e.content)&&void 0!==i?i:"[]"),s=null==a?void 0:a.map(e=>(0,V._)((0,p._)({},e),{value:"",char_count:0,hit_count:0}));o((0,V._)((0,p._)({},n),{total:Number(null!==(l=null==n?void 0:n.total)&&void 0!==l?l:"0"),list:null==n?void 0:n.list.concat([{content:JSON.stringify(s),addId:(0,Y.x0)()}])})),r()}}},tE=()=>{var{tableViewRef:e,isShowAddBtn:t}=tc(),{sliceListData:r}=tp(),[n,o]=(0,v.useState)(0);return(0,v.useEffect)(()=>{var r,n=null==e?void 0:null===(r=e.current)||void 0===r?void 0:r.getTableHeight();n&&o(t?n:"100%")},[r,t,e]),{tableH:n,increaseTableHeight:e=>{o(Number(null!=n?n:"0")+e)}}},tT=()=>{var{sliceListData:e}=tp();return{scrollTableBodyToBottom:()=>{var t=document.querySelector(".table-view-box .semi-table-container>.semi-table-body");t&&(null==e?void 0:e.list.length)&&(t.scrollTop=(null==e?void 0:e.list.length)*56)}}},tI=()=>{var e=(0,f.DY)(e=>e.params.biz),t=(0,f.PR)(e=>e.documentList),r=null==t?void 0:t[0],{tableViewRef:n,isLoadingMoreSliceList:o,isLoadingSliceList:i}=tc(),{sliceListData:l}=tp(),a=null==l?void 0:l.list,{loadMoreSliceList:s}=tv(),d=!!(0,f.PR)(e=>e.canEdit),{deleteSliceModalNode:c,openDeleteSliceModal:u}=tN(),{tableSegmentModalNode:p,openTableSegmentModal:v}=tk(),{deleteSlice:_,rowUpdateSliceData:h,modalEditSlice:x}=tC({openDeleteSliceModal:u,openTableSegmentModal:v}),{tableH:g}=tE();if(!(null==a?void 0:a.length))return null;var y=null==r?void 0:r.document_id,{data:b,columns:j}=tb({sliceList:a,metaData:null==r?void 0:r.table_meta,onEdit:x,onDelete:_,onUpdate:h,canEdit:d,tableKey:y||""});return(0,m.jsxs)("div",{className:$()(ta.Z["table-view-container-box"],"table-view-box"),style:{height:g},children:[(0,m.jsx)(t_.HA,{tableKey:y,ref:n,className:$()("".concat(ta.Z["unit-table-view"]," ").concat(o?ta.Z["table-view-loading"]:""),"project"===e?ta.Z["table-preview-max"]:ta.Z["table-preview-secondary"]),resizable:!0,dataSource:b,loading:i,columns:j,rowSelect:d,isVirtualized:!0,rowOperation:d,scrollToBottom:()=>{!i&&!o&&s()},editProps:{onDelete:e=>_(e),onEdit:(e,t)=>{x(e,t)}}}),c,p]})},tP=()=>{var{isShowAddBtn:e}=tc(),t=(0,f.PR)(e=>e.documentList),r=null==t?void 0:t[0],{increaseTableHeight:n}=tE(),{scrollTableBodyToBottom:o}=tT(),{handleAddRow:i}=tS({increaseTableHeight:n,scrollTableBodyToBottom:o});return e?(0,m.jsx)("div",{className:ta.Z["add-row-btn"],children:(0,m.jsx)(N.zx,{disabled:(null==r?void 0:r.status)===z._m.Processing,"data-testid":ey.w.SegmentDetailContentAddRowBtn,color:"primary",size:"default",icon:(0,m.jsx)(Q.PwN,{}),onClick:i,children:b.o.t("knowledge_optimize_0010")})}):null},tA=()=>{var{sliceListData:e}=tp(),t=null==e?void 0:e.list;return(null==t?void 0:t.length)?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(tI,{}),(0,m.jsx)(tP,{})]}):(0,m.jsx)(tP,{})},tD=e=>{var t,{isReloading:r}=e,n=(0,v.useRef)(null),o=(0,v.useRef)(null),i=(0,v.useRef)(null),l=(0,f.PR)(e=>e.canEdit),a=null===(t=(0,f.PR)(e=>e.documentList))||void 0===t?void 0:t.filter(e=>e.document_id),[s,d]=(0,v.useState)(0),[c,u]=(0,v.useState)(""),[p,_]=(0,v.useState)([]),{sliceListData:h,mutateSliceListData:x,loadMoreSliceList:g,isLoadingSliceList:y,isLoadingMoreSliceList:j}=ts(),w=null==h?void 0:h.list,C=(0,v.useMemo)(()=>!!(l&&!(null==h?void 0:h.hasMore)&&(null==h?void 0:h.total)&&(null==h?void 0:h.total)<1e3),[l,h]),k=(0,v.useMemo)(()=>(null==a?!void 0:!a.length)&&!r||(null==h?void 0:h.ready)&&!(null==w?void 0:w.length)&&!(j||y),[h,a,r,j,y,w]);return(0,m.jsx)(td.Provider,{value:{tableViewRef:i,isLoadingMoreSliceList:j,isLoadingSliceList:y,isShowAddBtn:C},children:(0,m.jsx)(tu.Provider,{value:{sliceListData:h||{list:[],total:0},curIndex:s,curSliceId:c,delSliceIds:p},children:(0,m.jsx)(tm.Provider,{value:{setCurIndex:d,setCurSliceId:u,setDelSliceIds:_,loadMoreSliceList:g,mutateSliceListData:x},children:(0,m.jsx)(N.Ar.Content,{ref:n,className:$()(ta.Z["slice-list-ui-content"],"knowledge-ide-base-slice-list-ui-content"),children:(0,m.jsxs)(N.yC,{spinning:y,wrapperClassName:ta.Z.spin,size:"large",style:{width:"100%",height:"100%"},children:[(null==w?void 0:w.length)?(0,m.jsx)("div",{ref:o,className:ta.Z["slice-list-table"],children:(0,m.jsx)(tA,{})}):null,k&&!y?(0,m.jsx)("div",{className:ta.Z["empty-content"],children:(0,m.jsx)(N.ub,{size:"large",icon:(0,m.jsx)(eE.s9d,{style:{width:150,height:"100%"}}),title:b.o.t("dataset_segment_empty_desc")})}):null]})})})})})},tL=r("704794"),tO=e=>{var{children:t}=e,[r,n]=(0,v.useState)(!1);return(0,m.jsx)(N.v2,{clickToHide:!0,keepDOM:!0,trigger:"click",position:"bottomRight",onVisibleChange:n,render:(0,m.jsx)(N.v2.SubMenu,{mode:"menu",className:tL.Z["table-config-menu-down"],children:t}),children:(0,m.jsx)(N.zx,{className:tL.Z["action-btn"],"data-testid":ey.w.SegmentDetailSystemBtn,icon:r?(0,m.jsx)(Q.uDC,{className:"text-[12px]"}):(0,m.jsx)(Q.Wdl,{className:"text-[12px]"}),iconPosition:"right",color:"primary",style:{minWidth:"45px",padding:"6px 6px 6px 8px"},children:(0,m.jsx)(Q.qBd,{})})})},tZ=e=>{var{knowledgeTableConfigMenuContributes:t,onChangeDocList:r}=e,n=(0,f.PR)(e=>e.documentList),o=null==n?void 0:n[0],i=(0,f.PR)(e=>e.canEdit),{reload:l}=M();return t?(0,m.jsx)(tO,{children:i?null==t?void 0:t.entries().map(e=>{var[t,{Component:n}]=e;return(0,m.jsx)(n,{documentInfo:o,onChangeDocList:r,reload:l},t)}):null}):null},tF=e=>new tn.j({name:e}),tM={Component:e=>{var{documentInfo:t}=e,r=(0,f.EV)();return void 0!==t.update_type&&t.update_type!==z.$o.NoUpdate?null:(0,m.jsx)(N.v2.Item,{onClick:()=>{var e,n;null===(e=r.upload)||void 0===e||e.call(r,{type:"table",opt:D.VP.RESEGMENT,doc_id:null!==(n=null==t?void 0:t.document_id)&&void 0!==n?n:""})},children:b.o.t("knowledge_segment_config_table")})}};var tz=((l=tF("knowledge-ide-table-local-config-menu")).registerSome([{type:"configuration-table-structure",module:tM}]),l),tR=e=>(0,m.jsx)(tZ,(0,V._)((0,p._)({},e),{knowledgeTableConfigMenuContributes:tz}));var tB=((a=tF("knowledge-ide-table-custom-config-menu")).registerSome([{type:"configuration-table-structure",module:tM}]),a),tV=e=>(0,m.jsx)(tZ,(0,V._)((0,p._)({},e),{knowledgeTableConfigMenuContributes:tB})),tU=e=>{var t=(0,f.PR)(e=>{var t;return null===(t=e.documentList)||void 0===t?void 0:t[0]}),r=(0,v.useMemo)(()=>t?et({format_type:z.a5.Table,source_type:null==t?void 0:t.source_type}):D.Cm.TABLE_API,[t]);return r===D.Cm.TABLE_CUSTOM?(0,m.jsx)(tV,(0,p._)({},e)):r===D.Cm.TABLE_DOC?(0,m.jsx)(tR,(0,p._)({},e)):null};var tH={importKnowledgeMenuSourceFeatureRegistry:((s=to("import-knowledge-source-table-menu")).registerSome([{type:"table-local",module:tt},{type:"table-custom",module:te}]),s)},tW=e=>(0,m.jsx)(eL.Provider,{value:tH,children:(0,m.jsx)(J,(0,p._)({renderNavBar:t=>{var{statusInfo:r,dataActions:n}=t;return(0,m.jsx)(e3,(0,p._)({progressMap:r.progressMap,tableConfigButton:(0,m.jsx)(tU,{onChangeDocList:n.updateDocumentList})},e.navBarProps))},renderContent:t=>{var{dataActions:r,statusInfo:n}=t;return(0,m.jsx)(tD,(0,p._)({reload:r.refreshData,onChangeDocList:r.updateDocumentList,isReloading:n.isReloading},e.contentProps))}},e.layoutProps))}),tG=r("479886"),tK=r.n(tG),tJ=r("775699"),tq=r("997700"),t$=r("815605"),tX=r("34018"),tY=e=>{var t,{currentValue:r,document_id:n,disable:o,onChange:i,onProgress:l}=e;var a=(t=(0,h._)(function*(){var e,t=(e=(0,h._)(function*(){l(!0);try{var e=yield w.MJ.ExtractPhotoCaption({document_id:n});e.caption&&i(e.caption)}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeGeneratePhotoCaption,error:e})}finally{l(!1)}}),function(){return e.apply(this,arguments)});if(!r){yield t();return}tJ.M5.warning({className:tX.Z["confirm-modal"],closeIcon:(0,m.jsx)(eE.bho,{}),title:b.o.t("knowledge_photo_021"),content:b.o.t("knowledge_photo_022"),icon:(0,m.jsx)(eE.xAI,{}),cancelText:b.o.t("Cancel"),okText:b.o.t("Confirm"),okButtonProps:{theme:"solid",type:"warning"},onOk:()=>{t()}})}),function(){return t.apply(this,arguments)});return(0,m.jsx)(tJ.u,{content:b.o.t("knowledge_photo_020"),children:(0,m.jsx)(tJ._3,{icon:(0,m.jsx)(tJ.JO,{svg:(0,m.jsx)(t$.r,{color:o?"rgba(28, 31, 35, 0.35)":"#4D53E8"})}),className:"absolute !bottom-[8px] !left-[12px]",onClick:a,disabled:o})})},tQ=r("888122"),t0=e=>{var t,r,{photo:n={},photoList:o=[],canEdit:i=!1,setCurrentPhotoId:l,reload:a,progressMap:s,onCancel:d,onSubmit:c}=e,[u,p]=(0,v.useState)(!1),[_,f]=(0,v.useState)(!1),[x,y]=(0,v.useState)(!1),[j,k]=(0,v.useState)(""),{document_id:N,status:S}=n,E=o.findIndex(e=>e.document_id===N),T=(null===(r=s[N||""])||void 0===r?void 0:r.status)||S,I=T===z._m.Processing||T===z._m.Failed||!i;(0,v.useEffect)(()=>{u&&k(n.caption)},[u,N]);var P=(t=(0,h._)(function*(){if(I){p(!1);return}null==c||c(),y(!0);try{yield w.MJ.UpdatePhotoCaption({document_id:N,caption:j}),a(),y(!1),p(!1)}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeUpdatePhotoCaption,error:e}),y(!1)}}),function(){return t.apply(this,arguments)});return{node:(0,m.jsx)(tJ.M5,{visible:u,onCancel:()=>{p(!1),null==d||d()},centered:!0,title:b.o.t("knowledge_photo_019"),width:792,onOk:P,okButtonProps:{disabled:I,loading:x},children:(0,m.jsxs)("div",{className:tQ.Z["modal-content"],children:[(0,m.jsxs)("div",{className:tQ.Z["photo-large"],children:[(0,m.jsx)(tJ.Ee,{height:300,src:n.url}),E<1?null:(0,m.jsx)(tJ.hU,{icon:(0,m.jsx)(tJ.JO,{svg:(0,m.jsx)(tq.r,{})}),className:tQ.Z["arrow-button"],style:{left:"24px"},onClick:()=>{var{document_id:e}=o[E-1];l(e)}}),-1===E||E===o.length-1?null:(0,m.jsx)(tJ.hU,{icon:(0,m.jsx)(tJ.JO,{rotate:180,svg:(0,m.jsx)(tq.r,{})}),className:tQ.Z["arrow-button"],style:{right:"24px"},onClick:()=>{var{document_id:e}=o[E+1];l(e)}})]}),(0,m.jsxs)("div",{className:tQ.Z["photo-caption-textarea"],children:[(0,m.jsx)(tJ.yC,{spinning:_,children:(0,m.jsx)(tJ.Kx,{maxCount:2e3,maxLength:2e3,placeholder:b.o.t("knowledge_photo_026"),value:j,onChange:e=>k(e),disabled:I})}),(0,m.jsx)(tY,{currentValue:j,document_id:N||"",disable:I,onChange:k,onProgress:f})]})]})}),open:()=>{p(!0)}}},t1=(e,t)=>{var r,n,{datasetID:o,searchValue:i,filterPhotoType:l}=e;var a=(r=(0,h._)(function*(e,t){try{var r=yield w.MJ.ListPhoto({page:null!=e?e:1,size:null!=t?t:P.by,dataset_id:o,filter:{keyword:i,has_caption:l===e$.X.HasCaption||l!==e$.X.NoCaption&&void 0}});return{list:r.photo_infos||[],total:r.total||0}}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgePhotoList,error:e})}}),function(e,t){return r.apply(this,arguments)});return(0,U.Z)((n=(0,h._)(function*(e){return a(e?Math.ceil(e.list.length/20)+1:1,20)}),function(e){return n.apply(this,arguments)}),(0,p._)({manual:!0},t))},t2=r("99057"),t4=e=>{var{progressMap:t}=e,[r,n]=(0,eU.useSearchParams)(),o=(0,f.kF)().first_auto_open_edit_document_id,[i,l]=(0,v.useState)(""),[a,s]=(0,v.useState)(""),d=(0,f.PR)(e=>e.dataSetDetail),c=(0,f.PR)(e=>e.canEdit),u=(0,f.PR)(e=>e.searchValue),p=(0,f.PR)(e=>e.photoFilterValue),_=(0,v.useRef)(null),{data:x,loading:y,loadingMore:j,reloadAsync:k,noMore:N}=t1({datasetID:null==d?void 0:d.dataset_id,filterPhotoType:p,searchValue:u},{isNoMore:e=>(null==e?void 0:e.list.length)>=(null==e?void 0:e.total),target:_}),S=null==x?void 0:x.list,E=null==S?void 0:S.find(e=>e.document_id===o),T=null==S?void 0:S.filter(e=>e.status!==z._m.AuditFailed),I=null==T?void 0:T.find(e=>e.document_id===i),P=()=>{n(e=>(e.delete("action_type"),e))},{node:A,open:D}=t0({photo:I,progressMap:t,photoList:T,canEdit:!!c,setCurrentPhotoId:l,reload:k,onCancel:()=>{P()},onSubmit:()=>{P()}});return(0,v.useEffect)(()=>{if(null==d?void 0:d.dataset_id){var e,t;k(),null===(t=_.current)||void 0===t||null===(e=t.scrollTo)||void 0===e||e.call(t,{top:0,behavior:"smooth"})}},[u,p,null==d?void 0:d.dataset_id]),(0,v.useEffect)(()=>{E&&(o&&l(o),D())},[o,E]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:t2.Z["photo-list"],ref:_,children:[(0,m.jsx)(tJ.yC,{spinning:y,wrapperClassName:t2.Z["photo-list-spin"],childStyle:{height:"100%",width:"100%"},children:(null==S?void 0:S.length)<=0?(0,m.jsx)(tJ.YZ,{empty:{icon:(0,m.jsx)(eE.s9d,{}),title:b.o.t("query_data_empty")}}):(0,m.jsx)(tJ.um,{spacing:12,className:t2.Z["card-group"],children:null==S?void 0:S.map(e=>{var r,n,{url:o,document_id:i,name:d,update_time:u,caption:p,status:v}=e,_=(null===(r=t[i])||void 0===r?void 0:r.status)||v,f=(null===(n=t[i])||void 0===n?void 0:n.caption)||p,x="string"==typeof f&&!!f,y=()=>{l(i),D()},j=a===i,N=v===z._m.AuditFailed;return(0,m.jsx)(tJ.Zb,{cover:N?(0,m.jsxs)("div",{className:t2.Z["prohibit-cover"],children:[(0,m.jsx)(eE.qy1,{size:"extra-small"}),(0,m.jsx)("p",{children:b.o.t("knowledge_photo_illegal_error_msg")})]}):(0,m.jsx)(tJ.Ee,{src:o,width:222,preview:!1,onClick:y,className:t2.Z["card-cover"]}),headerLine:!1,bodyStyle:{padding:"12px 16px"},className:$()(t2.Z.card,N?t2.Z["card-disabled"]:""),children:(0,m.jsxs)("div",{onMouseEnter:()=>{s(i)},onMouseLeave:()=>{s("")},className:t2.Z["card-content"],children:[(0,m.jsx)(tJ.ZT.Text,{className:t2.Z["photo-name"],ellipsis:{showTooltip:!0},children:d}),(0,m.jsx)(tJ.ZT.Paragraph,{className:t2.Z["photo-description"],ellipsis:{showTooltip:!0,rows:2},style:{color:x?"rgba(29, 28, 35, 0.6)":"rgba(255, 178, 51, 1)"},children:N?(0,m.jsx)("span",{children:b.o.t("knowledge_content_illegal_error_msg")}):_===z._m.Failed?(0,m.jsx)("span",{className:t2.Z["failed-tag"],children:b.o.t("dataset_process_fail")}):_===z._m.Processing?(0,m.jsx)("span",{className:t2.Z["processing-tag"],children:b.o.t("datasets_segment_tag_processing")}):x?f:b.o.t("knowledge_photo_016")}),(0,m.jsxs)("div",{className:t2.Z["card-footer"],children:[(0,m.jsx)(tJ.ZT.Text,{className:t2.Z["create-time"],children:tK().unix(u).format("YYYY-MM-DD HH:mm")}),j&&c?(0,m.jsxs)(tJ.T,{spacing:12,children:[(0,m.jsx)(tJ.u,{content:b.o.t("Edit"),children:(0,m.jsx)(tJ._3,{icon:(0,m.jsx)(eE.yl5,{}),disabled:N,onClick:y})}),(0,m.jsx)(tJ.u,{content:b.o.t("Delete"),children:(0,m.jsx)(tJ._3,{icon:(0,m.jsx)(eE.WDf,{}),onClick:()=>{tJ.M5.error({className:t2.Z["confirm-modal"],closeIcon:(0,m.jsx)(eE.bho,{}),title:b.o.t("kl2_007"),content:b.o.t("dataset_detail_table_deleteModel_description"),icon:(0,m.jsx)(eE.rPP,{}),cancelText:b.o.t("Cancel"),okText:b.o.t("Delete"),okButtonProps:{type:"danger"},onOk:(0,h._)(function*(){try{yield w.MJ.DeleteDocument({document_ids:[i]}),yield k()}catch(e){C.s5.errorEvent(C.xW.KNOWLEDGE,{eventName:g.b.KnowledgeDeleteDocument,error:e})}})})}})})]}):null]})]})},i)})})}),(0,m.jsx)("div",{className:t2.Z.footer,children:!N&&(0,m.jsx)(tJ.yC,{spinning:j,tip:b.o.t("loading"),wrapperClassName:t2.Z.spin})})]}),A]})};var t5={importKnowledgeMenuSourceFeatureRegistry:((d=to("import-knowledge-source-image-menu")).register({type:"image-local",module:tr}),d)},t6=e=>(0,m.jsx)(eL.Provider,{value:t5,children:(0,m.jsx)(J,(0,p._)({renderNavBar:t=>{var{statusInfo:r}=t;return(0,m.jsx)(e3,(0,p._)({progressMap:r.progressMap},e.navBarProps))},renderContent:t=>{var{statusInfo:r}=t;return(0,m.jsx)(t4,(0,p._)({progressMap:r.progressMap},e.contentProps))}},e.layoutProps))}),t3=e=>{var{dataSetDetail:{format_type:t}={}}=E();return t===z.a5.Text?(0,m.jsx)(tl,(0,p._)({},e)):t===z.a5.Table?(0,m.jsx)(tW,(0,p._)({},e)):t===z.a5.Image?(0,m.jsx)(t6,(0,p._)({},e)):null},t8=r("207729"),t9=e=>{var{biz:t,renderKnowledgeIDE:r}=e,[n,o]=(0,v.useState)(""),{modal:i,open:l,close:a}=(0,eg.od)({hideOkButton:!0,hideCancelButton:!0,showCloseIcon:!1,closable:!1,fullScreen:!0,footer:null,className:t8.Z["knowledge-preview-modal"]});return{node:i((0,m.jsx)("div",{className:t8.Z["knowledge-preview-modal-content"],children:(0,m.jsx)(f.S9,{params:{datasetID:n,biz:t},resourceNavigate:{},children:r({onClose:a})})})),open:e=>{o(e),l()},close:a}},t7=r("30961"),re=r("730274"),rt=r("402635"),rr=(e,t)=>{var r,[n,o]=(0,v.useState)();var i=(r=(0,h._)(function*(){try{var{data:e}=yield w.pr.GetDraftBotInfoAgw({bot_id:t});o(null!=e?e:{})}catch(e){console.error(e)}}),function(){return r.apply(this,arguments)});return(0,v.useEffect)(()=>{e&&t&&i()},[e,t]),n};var rn=(c=(0,h._)(function*(e){var{botId:t,agentId:r,dataset:n,botInfo:o,updatedDatasetList:i,spaceId:l}=e;if((null==o?void 0:o.bot_info.bot_mode)===re.J4.SingleMode)yield w.pr.UpdateDraftBotInfoAgw({bot_info:{bot_id:t,knowledge:(0,V._)((0,p._)({},n),{knowledge_info:i})}});else{var a,s,d=null==o?void 0:null===(s=o.bot_info)||void 0===s?void 0:null===(a=s.agents)||void 0===a?void 0:a.find(e=>e.agent_id===r);(null==d?void 0:d.agent_id)&&(yield w.pr.UpdateAgentV2((0,V._)((0,p._)({},d),{current_version:d.update_type===re.ZF.AutoUpdate?"0":d.current_version,id:null==d?void 0:d.agent_id,space_id:l,bot_id:t,knowledge:(0,V._)((0,p._)({},n),{knowledge_info:i})})))}}),function(e){return c.apply(this,arguments)}),ro=(e,t,r)=>{var n,o,i=[],l=[];return l="dataset"in e?null!==(n=null==e?void 0:e.dataset)&&void 0!==n?n:[]:null!==(o=null==e?void 0:e.knowledge_info)&&void 0!==o?o:[],i=t===e$.U.REMOVE?null==l?void 0:l.filter(e=>e.id!==r.dataset_id):[...l,{name:r.name,id:r.dataset_id}]};var ri=(u=(0,h._)(function*(e){var{botInfo:t,botId:r,agentId:n,dataSetDetail:o={},dataset:i,actionType:l,spaceId:a,updateSuccess:s}=e,d=ro(i,l,o);yield rn((0,V._)((0,p._)({},{spaceId:a,botId:r,agentId:n,updatedDatasetList:d,dataset:i}),{botInfo:t})),s()}),function(e){return u.apply(this,arguments)}),rl=(e,t)=>{var r,n,o,i,l,a;return t?null!==(l=null==e?void 0:null===(i=e.bot_info)||void 0===i?void 0:null===(o=i.agents)||void 0===o?void 0:null===(n=o.find(e=>e.agent_id===t))||void 0===n?void 0:n.knowledge)&&void 0!==l?l:{}:null!==(a=null==e?void 0:null===(r=e.bot_info)||void 0===r?void 0:r.knowledge)&&void 0!==a?a:{}},ra=e=>{var t,{dataSetDetail:r}=e,[n,o]=(0,v.useState)(!1),{jump:i}=(0,t7.oB)(),{spaceID:l,botID:a,agentID:s,actionType:d}=(0,f.kF)(),c=rr(l,a),u=rl(c,null!=s?s:""),p=()=>{N.FN.success(b.o.t(d===e$.U.REMOVE?"bot_edit_dataset_removed_toast":"bot_edit_dataset_added_toast",{dataset_name:r.name})),i(t7.cJ.KNOWLEDGE__BACK__BOT,{spaceID:l,botID:a,mode:r.storage_location===z.Ac.Douyin?"douyin":"bot"})};var _=(t=(0,h._)(function*(){o(!0);try{yield ri({botInfo:c,botId:null!=a?a:"",agentId:null!=s?s:"",dataSetDetail:r,dataset:u,actionType:null!=d?d:e$.U.ADD,spaceId:null!=l?l:"",updateSuccess:p})}catch(e){console.error(e)}finally{o(!1)}}),function(){return t.apply(this,arguments)});return(0,m.jsxs)(N.zx,{loading:n,disabled:(null==r?void 0:r.status)===rt._z.DatasetForbid,onClick:_,children:[d===e$.U.REMOVE&&(null==r?void 0:r.storage_location)===z.Ac.Douyin?b.o.t("dy_avatar_resource_delete"):null,d===e$.U.REMOVE&&(null==r?void 0:r.storage_location)!==z.Ac.Douyin?b.o.t("kl2_014"):null,d!==e$.U.REMOVE&&(null==r?void 0:r.storage_location)===z.Ac.Douyin?b.o.t("dy_avatar_resource_add"):null,d!==e$.U.REMOVE&&(null==r?void 0:r.storage_location)!==z.Ac.Douyin?b.o.t("kl2_013"):null]})},rs=r("616426"),rd=e=>{var{disabledTooltip:t}=e,r=(0,rs.mm)(),{documentList:n,dataSetDetail:o}=(0,f.PR)((0,_.N)(e=>({documentList:e.documentList,dataSetDetail:e.dataSetDetail}))),i=(0,f.kF)(),l=(0,j.rY)(e=>e.space.id);return(0,m.jsx)(eV,{disabledTooltip:t,onSourceChange:e=>{var t;r(ei({spaceID:l,datasetID:null==o?void 0:o.dataset_id,docID:null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.document_id,formatType:null==o?void 0:o.format_type,type:e,pageMode:"modal",botId:i.botID,actionType:e$.U.ADD}))}})},rc=e=>{var{onBack:t}=e,[r,n]=(0,v.useState)(!1),{spaceID:o,agentID:i,botID:l,actionType:a}=(0,f.kF)(),{dataSetDetail:s}=(0,f.PR)((0,_.N)(e=>({dataSetDetail:e.dataSetDetail}))),{jump:d}=(0,t7.oB)(),c=rr(o,l),u=rl(c,null!=i?i:""),p=(0,v.useMemo)(()=>{var e=[];return"dataset"in u&&(e=((null==u?void 0:u.dataset)||[]).map(e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""})),"knowledge_info"in u&&(e=((null==u?void 0:u.knowledge_info)||[]).map(e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""})),!e.includes((null==s?void 0:s.dataset_id)||"")},[u,null==s?void 0:s.dataset_id]),m=()=>{d(t7.cJ.KNOWLEDGE__BACK__BOT,{spaceID:o,botID:l,mode:(null==s?void 0:s.storage_location)===z.Ac.Douyin?"douyin":"bot"})},x=()=>{t?null==t||t():m()},g=()=>{N.FN.success(b.o.t(a===e$.U.REMOVE?"bot_edit_dataset_removed_toast":"bot_edit_dataset_added_toast",{dataset_name:null==s?void 0:s.name})),m()};return()=>{p?N.u_.confirm({title:b.o.t("bot_ide_knowledge_confirm_title"),content:(null==s?void 0:s.storage_location)===z.Ac.Douyin?b.o.t("dy_avatar_resource_add_tip"):b.o.t("bot_ide_knowledge_confirm_content"),okText:b.o.t("bot_ide_knowledge_confirm_ok"),cancelText:b.o.t("bot_ide_knowledge_confirm_cancel"),confirmLoading:r,onOk:(0,h._)(function*(){n(!0);try{yield ri({botInfo:c,botId:null!=l?l:"",agentId:null!=i?i:"",dataSetDetail:s,dataset:u,actionType:null!=a?a:e$.U.ADD,spaceId:null!=o?o:"",updateSuccess:g})}catch(e){console.error(e)}finally{n(!1),x()}}),onCancel:()=>{x()}}):x()}},ru=e=>{var{onBack:t,importKnowledgeSourceButton:r}=e,{dataSetDetail:n,documentList:o}=(0,f.PR)((0,_.N)(e=>({dataSetDetail:e.dataSetDetail,documentList:e.documentList}))),i=rc({onBack:t});return(0,m.jsx)(e4,{title:null==n?void 0:n.name,onBack:t,datasetDetail:n,docInfo:null==o?void 0:o[0],actionButtons:(0,m.jsx)(ra,{dataSetDetail:n},null==n?void 0:n.dataset_id),importKnowledgeSourceButton:null!=r?r:(0,m.jsx)(rd,{}),beforeBack:i})},rp=e=>(0,m.jsx)(t3,(0,V._)((0,p._)({},e),{layoutProps:{renderNavBar:t=>{var{statusInfo:r}=t;return(0,m.jsx)(ru,(0,p._)({progressMap:r.progressMap},e.navBarProps))}}})),rm=e=>(0,m.jsx)(t3,(0,p._)({},e)),rv=e=>(0,m.jsx)(e3,(0,V._)((0,p._)({},e),{hideBackButton:!0})),r_=e=>(0,m.jsx)(t3,(0,V._)((0,p._)({},e),{layoutProps:{className:"coz-bg-max border border-solid coz-stroke-primary",renderNavBar:t=>{var{statusInfo:r}=t;return(0,m.jsx)(rv,(0,p._)({progressMap:r.progressMap},e.navBarProps))}}})),rf=e=>{var{onBack:t,actionButtons:r}=e,{dataSetDetail:n,documentList:o}=(0,f.PR)((0,_.N)(e=>({dataSetDetail:e.dataSetDetail,documentList:e.documentList})));return(0,m.jsx)(e4,{title:null==n?void 0:n.name,onBack:t,datasetDetail:n,docInfo:null==o?void 0:o[0],actionButtons:r})},rh=e=>(0,m.jsx)(t3,(0,V._)((0,p._)({},e),{layoutProps:{renderNavBar:t=>{var{statusInfo:r}=t;return(0,m.jsx)(rf,(0,p._)({progressMap:r.progressMap},e.navBarProps))}}})),rx=e=>t9((0,V._)((0,p._)({},e),{renderKnowledgeIDE:t=>{var{onClose:r}=t;return(0,m.jsx)(rh,(0,V._)((0,p._)({},e),{navBarProps:(0,V._)((0,p._)({},e.navBarProps),{onBack:r})}))}}))},936731:function(e,t,r){r.d(t,{v:function(){return n.v}});var n=r(888461)},888461:function(e,t,r){r.d(t,{v:function(){return u}});var n=r(151064),o=r(455069),i=r(252237),l=r.n(i),a=r(385038),s=r(674343),d=r(561119),c=r(105452),u=e=>{var{className:t,style:r,mainText:i,subText:u,percent:p=10,percentFormat:m,avatar:v,status:_,actions:f,tipText:h=""}=e;return(0,n.jsxs)("div",{className:l()(c.Z["progress-wrap"],"flex justify-between relative mb-[8px]",_===d.N.Failed?c.Z["processing-failed"]:"",_===d.N.Processing?c.Z.processing:"",t),style:r,children:[(0,n.jsx)("div",{className:l()(c.Z.content,"process-progress-item-content","max-w-[calc(100%-100px)]"),children:(0,n.jsxs)("div",{className:l()("flex items-center",c.Z.info),children:[v,(0,n.jsxs)("div",{className:l()("pl-[10px] max-w-full"),children:[(0,n.jsx)("div",{className:c.Z["main-text"],children:(0,n.jsx)(s.ZT.Text,{"data-dtestid":"".concat(a.w.CreateUnitListProgressName,".").concat(i),className:"coz-fg-primary text-14px",ellipsis:{showTooltip:{opts:{content:i}}},children:i})}),(0,n.jsxs)("div",{className:c.Z["sub-text"],children:[(0,n.jsx)("div",{className:c.Z.desc,children:u}),h?(0,n.jsx)("div",{className:c.Z["tip-desc"],children:h}):null]})]})]})}),(0,n.jsx)("div",{className:l()(c.Z.right,"process-progress-item-right"),children:_===d.N.Processing?(0,n.jsx)("span",{className:c.Z.percent,children:m||"".concat(p,"%")}):(0,n.jsx)("div",{className:l()(c.Z.actions,"process-progress-item-actions"),children:Array.isArray(f)?(0,n.jsx)(s.T,{spacing:"tight",children:f.map((e,t)=>(0,n.jsx)(o.Fragment,{children:e},t))}):null})}),_===d.N.Processing?(0,n.jsx)("div",{className:c.Z.progress,style:{width:"".concat(p,"%")}}):null]},i)}},392902:function(e,t,r){r.d(t,{u3:()=>B,zx:()=>V,IO:()=>E,tM:()=>g});var n=r("808549"),o=r("120454"),i=r("473980"),l=r("151064"),a=r("455069"),s=r("962289"),d=r("550655"),c=r("252237"),u=r.n(c),p=r("385038"),m=r("336205"),v=r("775699"),_=r("674343"),f=r("528751"),h=(e,t)=>{for(var r=e>50?50:e,n=[],o=t;o<r;o++)n.push({label:m.o.t("datasets_createFileModel_tab_dataStarRow_value",{LineNumber:o+1}),value:o});return n},x=r("151359"),g=e=>{var{className:t="",data:r={},tableSettings:c,setTableSettings:g}=e,{preview_data:y,sheet_list:b}=r;if(!y||!b||!b.length)return(0,l.jsx)(l.Fragment,{});var j=(0,a.useRef)(),w=(0,a.useMemo)(()=>(0,s.Z)(b,c[f.hD.SHEET]),[b,c]),C=(0,a.useMemo)(()=>c,[b]),k=(0,a.useMemo)(()=>{var e=w.id||0===w.id?h(Number(null==w?void 0:w.total_row)>1?Number(w.total_row):2,0):[];return[{e2e:p.w.TableLocalTableConfigurationDataSheet,field:f.hD.SHEET,label:m.o.t("datasets_createFileModel_tab_DataSheet"),options:b.map(e=>({value:e.id,label:e.sheet_name}))},{e2e:p.w.TableLocalTableConfigurationSheetHeader,field:f.hD.KEY_START_ROW,label:m.o.t("datasets_createFileModel_tab_header"),options:e.slice(0,e.length-1)},{e2e:p.w.TableLocalTableConfigurationStarRow,field:f.hD.DATA_START_ROW,label:m.o.t("datasets_createFileModel_tab_dataStarRow"),options:e.slice(Number(c[f.hD.KEY_START_ROW])+1)}]},[r,w]),N=(e,t)=>{g&&g((0,n._)({},e));var r=(0,s.Z)(t,f.hD.SHEET),o=(0,s.Z)(t,f.hD.KEY_START_ROW);(0,d.Z)(r)&&j.current&&(j.current.setValue(f.hD.KEY_START_ROW,0),j.current.setValue(f.hD.DATA_START_ROW,1)),o&&j.current&&!(o<(0,s.Z)(e,f.hD.DATA_START_ROW))&&j.current.setValue(f.hD.DATA_START_ROW,o+1)};return(0,l.jsx)("div",{className:u()(x.Z["table-setting-bar"],t),children:(0,l.jsx)(v.l0,{layout:"horizontal",initValues:C,getFormApi:e=>j.current=e,onValueChange:(e,t)=>{N(e,t)},children:k.map(e=>{var{options:t}=e,r=(0,i._)(e,["options"]);return(0,l.jsx)(_.ih,(0,o._)((0,n._)({"data-testid":e.e2e,optionList:t},r),{onChange:t=>{if(!!t)N((0,o._)((0,n._)({},c),{[e.field]:t}),{[e.field]:t})}}),e.field)})})})},y=r("763055"),b=r("263825"),j=r("461190"),w=r("594022"),C=r("690612"),k=r("210208"),N=e=>(0,l.jsx)(_.Vp,{color:"primary",className:k.Z["column-type"],size:"mini",children:(0,b.y8)(e.columnType)}),S="table-preview",E=e=>{var{data:t,settings:r}=e,{sheet_list:n=[],table_meta:o={},preview_data:i={}}=t,s=Number(r[f.hD.DATA_START_ROW])||0,d=(0,a.useMemo)(()=>r[f.hD.SHEET]||0,[r]),c=(0,a.useMemo)(()=>{var e;return null===(e=(n||[]).find(e=>(null==e?void 0:e.id)===d))||void 0===e?void 0:e.sheet_name},[n,d]),u=(0,a.useMemo)(()=>{var e;return Number((null===(e=(n||[]).find(e=>(null==e?void 0:e.id)===d))||void 0===e?void 0:e.total_row)||0)-s||0},[n,d]),v=(o[d]||[]).map(e=>{var{sequence:t,column_name:r,is_semantic:n,column_type:o=w.QD.Unknown}=e;return o===w.QD.Image?{title:(0,l.jsxs)("div",{className:k.Z["td-title"],children:[(0,l.jsx)("div",{children:r}),(0,l.jsx)(N,{columnType:o})]}),dataIndex:t,render:(e,t)=>{var r=(0,C.bp)(e);return(0,l.jsx)(j.e0,{srcList:r,editable:!1})}}:{title:n?(0,l.jsxs)("div",{className:k.Z["td-title"],children:[r,n?(0,l.jsx)(_.Vp,{size:"mini",color:"green",className:k.Z["semantic-tag"],"data-testid":p.w.TableLocalPreviewSemantic,children:m.o.t("knowledge_1226_001")}):null,(0,l.jsx)(N,{columnType:o})]}):(0,l.jsxs)("div",{className:k.Z["td-title"],children:[r,(0,l.jsx)(N,{columnType:o})]}),width:180,dataIndex:t,ellipsis:{showTitle:!1},render:e=>(0,l.jsx)(_.ZT.Text,{ellipsis:{showTooltip:!0},children:e})}}),h=(0,a.useMemo)(()=>(i[d]||[]).slice(0,10).sort((e,t)=>JSON.stringify(e)>JSON.stringify(t)?1:-1),[i,d]);return(0,l.jsx)("div",{className:k.Z[S],children:h.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:k.Z["".concat(S,"-title")],"data-testid":p.w.TableLocalPreviewTitle,children:c}),(0,l.jsx)("div",{className:k.Z["".concat(S,"-content")],children:(0,l.jsx)(_.iA,{tableProps:{dataSource:h,columns:v}})}),(0,l.jsx)("div",{className:k.Z["preview-tips"],"data-testid":p.w.TableLocalPreviewFooterTotal,children:m.o.t("datasets_unit_tableformat_tips1",{TotalRows:u,ShowRows:Number(u)>10?10:u})})]}):(0,l.jsxs)("div",{className:k.Z["no-result"],children:[(0,l.jsx)(y.xs,{}),(0,l.jsx)("div",{className:k.Z["no-result-tips"],children:m.o.t("knowledge_1221_02")})]})})},T=r("745304"),I=r("306785"),P=r("481655"),A=r("410517"),D=r("537714"),L=r("915757"),O=r("44172"),Z=r("274971"),F=r("391757"),M="table-structure",z=e=>{var{children:t,tooltip:r,dataTestId:n}=e;return(0,l.jsxs)("div",{className:F.Z["".concat(M,"-required-container")],"data-testid":n,children:[t,(0,l.jsx)("span",{className:F.Z["".concat(M,"-col-required")],children:" *"}),r]})},R=e=>{var{onChange:t,record:r,value:n,autofocus:o=!1,isBlurValid:i=!1,initValid:s,validate:d,isPreview:c,placeholder:u,maxStrLen:p}=e,v=e=>{var t=null==d?void 0:d(e,m.o.t("datasets_segment_tableStructure_field_errEmpty"));return{valid:!s||!!(d?null==t?void 0:t.valid:e&&""!==e),errorMsg:(null==t?void 0:t.errorMsg)||m.o.t("datasets_segment_tableStructure_field_errEmpty")}},[f,h]=(0,a.useState)(n),[x,g]=(0,a.useState)(()=>{var e=v(n);return{valid:!!i||e.valid,errorMsg:e.errorMsg}}),y=e=>{g(v(e))},b=(null==r?void 0:r.errMsg)||"",j=(0,a.useMemo)(()=>b?"error":x.valid?"default":"error",[x,b]),w=(0,a.useCallback)(()=>b?(0,l.jsx)("div",{className:F.Z["input-error-msg"],children:b}):(0,l.jsx)(l.Fragment,{children:!x.valid&&(0,l.jsx)("div",{className:F.Z["input-error-msg"],children:x.errorMsg})}),[b,x]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(_.II,{autoFocus:o,value:f,maxLength:p,onChange:e=>{h(e.substring(0,p)),i||y(e)},disabled:c,validateStatus:j,suffix:(0,l.jsxs)("span",{className:F.Z["input-suffix"],children:[(f||"").length,"/",p]}),onBlur:()=>{t((null==f?void 0:f.substring(0,p))||""),y(f)},placeholder:u}),w()]})},B=e=>{var{data:t=[],setData:r,verifyMap:a={},initValid:s=!1,isBlurValid:d=!1,isPreview:c=!1,baseKey:f,showTitle:h=!1,children:x,tipsNode:g,isDragTable:y=!1}=e,j=(0,i._)(e,["data","setData","verifyMap","initValid","isBlurValid","isPreview","baseKey","showTitle","children","tipsNode","isDragTable"]),C=(0,Z.l$)()===D.VP.RESEGMENT,k=[{title:()=>(0,l.jsx)(z,{dataTestId:p.w.TableLocalTableConfigurationIndex,tooltip:(0,l.jsx)(_.u,{className:"whitespace-pre-line",content:m.o.t("knowledge_multi_index"),children:(0,l.jsx)(v.y3,{size:"small",theme:"borderless",type:"tertiary",style:{marginLeft:4},icon:(0,l.jsx)(L.L03,{className:"coz-fg-secondary"})})}),children:(0,l.jsx)("div",{className:F.Z["table-header-tooltip"],"data-testid":p.w.TableLocalTableConfigurationIndex,children:(0,l.jsx)("span",{children:m.o.t("knowledge_table_structure_semantic")})})}),dataIndex:"is_semantic",width:90,align:"left",render:(e,n,o)=>{var i,{sequence:s}=n;var d=!!Object.keys(a).length&&!(null===(i=a[s||o])||void 0===i?void 0:i.valid)||c;return(0,l.jsxs)("div",{className:F.Z["semantic-radio"],children:[y?(0,l.jsx)(O.lls,{className:"structure-table-drag-icon"}):null,(0,l.jsx)(e=>{var t,r,{children:n}=e;return d&&(null===(t=a[s||o])||void 0===t?void 0:t.msg)?(0,l.jsx)(_.u,{trigger:"hover",content:null===(r=a[s||o])||void 0===r?void 0:r.msg,children:n}):n},{children:(0,l.jsx)(_.XZ,{checked:e,disabled:d,onChange:e=>{var n=[...t];n[o].is_semantic=!!e.target.checked,r(n)},"data-testid":p.w.TableStructureIndexCheckbox})})]})}},{title:()=>(0,l.jsx)(z,{dataTestId:p.w.TableLocalTableConfigurationColumnName,children:m.o.t("knowledge_table_structure_column_name")}),dataIndex:"column_name",align:"left",render:(e,n,o)=>{var{autofocus:i=!1}=n;return(0,l.jsx)("div",{className:F.Z["column-item"],children:(0,l.jsx)(R,{initValid:s,isBlurValid:d,onChange:e=>{var n=[...t];n[o].column_name=e,r(n)},record:n,value:e,validate:(e,r)=>(null==t?void 0:t.filter(t=>t.column_name===e).length)>=2?{valid:!1,errorMsg:m.o.t("Manual_crawling_040")}:(0,Z.OP)(e,r),autofocus:i,isPreview:c,maxStrLen:30},"".concat(f).concat(null==n?void 0:n.sequence))})}},{title:()=>(0,l.jsx)("div",{"data-testid":p.w.TableLocalTableConfigurationDesc,children:m.o.t("knowledge_table_structure_desc")}),dataIndex:"desc",align:"left",render:(e,n,o)=>(0,l.jsx)("div",{className:F.Z["column-item"],children:(0,l.jsx)(R,{initValid:!1,isBlurValid:!1,placeholder:m.o.t("knowledge_variable_description_placeholder"),onChange:e=>{var n=[...t];n[o].desc=e,r(n)},record:n,value:e,autofocus:!1,isPreview:c,maxStrLen:2e3},"column-desc.".concat(f).concat(null==n?void 0:n.sequence))})},{title:()=>(0,l.jsx)(z,{dataTestId:p.w.TableLocalTableConfigurationType,children:m.o.t("knowledge_table_structure_data_type")}),dataIndex:"column_type",align:"left",render:(e,i,a)=>{var s=!!d||!!e;return(0,l.jsx)("div",{className:"pr-[16px] ".concat(F.Z["column-item"]),children:c?(0,l.jsx)(v.ZT.Text,{className:F.Z["column-item-value"],children:(0,b.y8)(e)}):(0,l.jsx)(b.L5,{value:e||"",selectProps:{disabled:!i.is_new_column&&C,optionList:(0,b.iQ)().map(e=>e.value===w.QD.Image?(0,o._)((0,n._)({},e),{disabled:i.is_semantic}):e),placeholder:m.o.t("db_table_save_exception_fieldtype")},errorMsg:s?void 0:m.o.t("datasets_segment_tableStructure_field_type_errEmpty"),handleChange:e=>{var n=[...t];n[a].column_type=e,r(n)}})},i.sequence)}},{title:(0,l.jsx)("div",{"data-testid":p.w.TableLocalTableConfigurationAction,children:m.o.t("datasets_unit_upload_field_action")}),dataIndex:"operate",width:82,align:"left",render:(e,n,o)=>(0,l.jsx)("div",{className:F.Z["column-item-action"],onClick:()=>{r(t.filter((e,t)=>o!==t))},children:(0,l.jsx)(_.u,{content:m.o.t(n.is_semantic?"datasets_segment_tableStructure_delTips":"datasets_table_title_actions_delete"),children:(0,l.jsx)(L.dVD,{"aria-disabled":!!n.is_semantic,className:F.Z["column-item-action-delete"]})})})}];c&&k.pop();var N=(0,A.Dy)((0,A.VT)(A.we,{activationConstraint:{distance:1}})),S=e=>{var{active:n,over:o}=e;if(n&&o&&n.id!==o.id){var i=Array.from(t),l=i.findIndex(e=>e.key===n.id),a=i.findIndex(e=>e.key===o.id);r((0,I.Rp)(i,l,a))}},E=e=>{var{attributes:t,listeners:r,setNodeRef:i,transform:a,transition:s,isDragging:d}=(0,I.nB)({id:e["data-row-key"]}),c=(0,n._)((0,o._)((0,n._)({},e.style),{transform:T.ux.Transform.toString(a),transition:s,cursor:d?"grabbing":"grab"}),d?{zIndex:999,position:"relative",background:"rgba(217, 220, 250, 1)"}:{});return(0,l.jsx)("tr",(0,n._)((0,o._)((0,n._)({},e),{ref:i,style:c}),t,r))};return(0,l.jsxs)("div",{className:F.Z["structure-wrapper"],children:[h?(0,l.jsx)(V,{}):null,g||null,y?(0,l.jsx)(A.LB,{autoScroll:!0,sensors:N,modifiers:[P.DL],onDragEnd:S,children:(0,l.jsx)(I.Fo,{items:t.map(e=>e.key||""),strategy:I.qw,children:(0,l.jsx)(_.iA,{wrapperClassName:u()(F.Z["".concat(M,"-wrapper")],F.Z["drag-table"]),tableProps:(0,n._)({sticky:!0,dataSource:t,columns:k,pagination:!1,className:F.Z[M],components:{body:{row:E}}},j)},f)})}):(0,l.jsx)(_.iA,{wrapperClassName:F.Z["".concat(M,"-wrapper")],tableProps:(0,n._)({sticky:!0,dataSource:t,columns:k,pagination:!1,className:F.Z[M]},j)},f),x]})},V=()=>(0,l.jsxs)("div",{className:F.Z["table-structure-bar-title"],"data-testid":p.w.TableLocalTableStructureTitle,children:[(0,l.jsx)("span",{children:m.o.t("datasets_segment_tableStructure_title")}),(0,l.jsx)(_.u,{content:m.o.t("knowledge_table_structure_column_tooltip"),children:(0,l.jsx)(L.L03,{className:u()(F.Z.icon,"coz-fg-secondary")})})]})},270917:function(e,t,r){r.d(t,{p:()=>R});var n,o=r("808549"),i=r("120454"),l=r("473980"),a=r("151064"),s=r("455069"),d=r("252237"),c=r.n(d),u=r("763055"),p=r("263825"),m=r("385038"),v=r("336205"),_=r("915757"),f=r("674343"),h=r("528751"),x=r("537714"),g=r("695673"),y=r("900539"),b=e=>e.substring(0,e.lastIndexOf(".")),j=(e,t)=>{var r;return null==e?void 0:null===(r=e[t])||void 0===r?void 0:r.name},w=e=>e.reduce((e,t)=>(e[t.uid||""]=t,e),{}),C=(e,t)=>e.filter(e=>null==t?void 0:t.find(t=>{var r;return t.uri===(null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.upload_uri)})),k=(e,t)=>{var r,n,o,i;return{type:(0,y.mD)((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.upload_uri)||e.name),uri:null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.upload_uri,url:null==e?void 0:null===(o=e.response)||void 0===o?void 0:o.upload_url,name:(null!==(i=null==t?void 0:t.filename)&&void 0!==i?i:b(e.name)).slice(0,g.I1),size:e.size,status:e.status,percent:e.percent||0,fileInstance:e.fileInstance,uid:e.uid,validateMessage:e.validateMessage||""}},N=e=>e.filter(e=>!(!e.shouldUpload&&e.status===x.Dm.VALIDATE_FAIL)).map((t,r)=>k(t,{filename:j(e,r)})),S=(e,t)=>{var r=w(t);return e.filter(e=>{var t=r[e.uid||""];return!!t.shouldUpload||t.status!==x.Dm.VALIDATE_FAIL||!1}).map((e,n)=>{var i=r[e.uid||""],l=j(t,n);return(0,o._)({},e,k(i,{filename:l}))})},E=r("44172"),T=e=>{var t=(0,y.mD)(e.name)||"unknown",r={unknown:E.dd3,pdf:E.t1r,text:E.mBV,docx:E.yA0}[t]||E.dd3;return(0,a.jsx)(r,{})},I=r("825955"),P=r("745474"),A=r("458620"),D=r("727914"),L=r("178385"),O=r("382534"),Z=r("274971");var F=(n=(0,I._)(function*(e){var{onSuccess:t,onError:r,onProgress:n,file:o}=e;try{var{name:i,fileInstance:l}=o;if(l){var a=(0,Z.mD)(i),s=yield(0,Z.y3)(l),d=yield O.nA.UploadFile({file_head:{file_type:a,biz_type:L.ym.BIZ_BOT_DATASET},data:s},{onUploadProgress:e=>{var t,r=null==o?void 0:o.status,i=null==o?void 0:o.response;if(r!==x.Dm.SUCCESS&&r!==x.Dm.UPLOAD_FAIL&&r!==x.Dm.VALIDATE_FAIL&&(null==i?!void 0:!i.upload_url)){var{total:a,loaded:s}=e;void 0!==a&&s<a&&n({total:null!==(t=e.total)&&void 0!==t?t:l.size,loaded:e.loaded})}}});t(d.data)}else r({status:0}),P.s5.errorEvent(P.xW.KNOWLEDGE,{eventName:A.b.KnowledgeUploadFile,error:new D.sH(A.b.KnowledgeUploadFile,"".concat(A.b.KnowledgeUploadFile,": Failed to upload file"))})}catch(e){r({status:0}),P.s5.errorEvent(P.xW.KNOWLEDGE,{eventName:A.b.KnowledgeUploadFile,error:e})}}),function(e){return n.apply(this,arguments)}),M=e=>{var t,{maxSizeMB:n}=e;return t=(0,I._)(function*(e){var t={fileInstance:e.file.fileInstance,status:e.file.status,validateMessage:e.file.validateMessage,shouldUpload:!0,autoRemove:!1},{fileInstance:l}=e.file;if(!l)return(0,i._)((0,o._)({},t),{status:x.Dm.UPLOAD_FAIL,shouldUpload:!1});var a=n||h.G2;if(l.size>1048576*a)return f.FN.warning({showClose:!1,content:v.o.t("file_too_large",{max_size:"".concat(a,"MB")})}),(0,i._)((0,o._)({},t),{shouldUpload:!1,status:x.Dm.VALIDATE_FAIL,validateMessage:v.o.t("file_too_large",{max_size:"".concat(a,"MB")})});if("pdf"===(0,Z.mD)(l.name).toLowerCase())try{var{getDocument:s,initPdfJsWorker:d}=yield r.e("7841").then(r.bind(r,187394));d();var c=yield(0,Z.JD)(l);if((yield s({data:c}).promise).numPages>h.XC)return f.FN.warning({showClose:!1,content:v.o.t("atasets_createpdf_over250")}),{shouldUpload:!1,status:x.Dm.VALIDATE_FAIL}}catch(e){if(P.s5.errorEvent(P.xW.KNOWLEDGE,{eventName:A.b.KnowledgeParseFile,error:e}),(null==e?void 0:e.name)==="PasswordException")return f.FN.error({showClose:!1,content:v.o.t("pdf_encrypted")}),{shouldUpload:!1,status:x.Dm.VALIDATE_FAIL}}return t}),function(e){return t.apply(this,arguments)}},z=r("928589"),R=e=>{var{unitList:t,onFinish:r,setUnitList:n,showIllustration:d=!0,multiple:x=!0,maxSizeMB:g=h.G2}=e,y=(0,l._)(e,["unitList","onFinish","setUnitList","showIllustration","multiple","maxSizeMB"]),{limit:b}=y,[j,w]=(0,s.useState)([]);(0,s.useEffect)(()=>{t.length<j.length&&w(C(j,t))},[t.length]);var k=(0,s.useCallback)(()=>{f.FN.warning({showClose:!1,content:v.o.t("knowledge_upload_format_error")})},[]),E=(0,p.hJ)(),I=(0,p.S2)(e=>{w(e.fileList),n(N(e.fileList))},E),P=(0,p.S2)(()=>{r(S(t,j))},E),A=(0,s.useMemo)(()=>t.length>=b,[t,b]),D=M({maxSizeMB:g});return(0,a.jsx)(f.gq,(0,i._)((0,o._)({draggable:!0,"data-testid":m.w.UploadUnitFile,multiple:x,fileList:j,disabled:A,previewFile:T,onAcceptInvalid:k,beforeUpload:D,customRequest:F,onChange:I,onSuccess:P,dragIcon:(0,a.jsx)(_.Isu,{className:z.Z["upload-icon"]})},y),{className:c()(z.Z.upload,y.className),children:t.length>=b&&d?(0,a.jsxs)("div",{className:z.Z["create-enough-file"],onClick:e=>e.stopPropagation(),children:[(0,a.jsx)(u.ns,{className:z.Z.picture}),(0,a.jsx)("div",{className:z.Z.text,children:v.o.t("knowledge_1218_001",{MaxDocs:b})})]}):null}))}},47522:function(e,t,r){r.d(t,{vL:()=>m,k1:()=>p,Zq:()=>u,nC:()=>n.n,G8:()=>c});var n=r("735997"),o=r("151064"),i=r("695673"),l=r("385038"),a=r("336205"),s=r("915757"),d=r("674343");function c(e){return(0,o.jsx)("div",{"data-dtestid":"".concat(l.w.LocalUploadListFileSize,".").concat(e.name),className:"coz-fg-secondary text-12px",children:null==e?void 0:e.size})}function u(e){var{index:t,record:r,params:n}=e,{onChange:i,unitList:l,onDelete:c}=n;return(0,o.jsx)(d.u,{spacing:12,content:a.o.t("Delete"),position:"top",children:(0,o.jsx)(d.hU,{color:"secondary",icon:(0,o.jsx)(s.dVD,{className:"text-14px"}),iconPosition:"left",size:"small",onClick:()=>{i(l.filter((e,r)=>t!==r)),"function"==typeof c&&(null==c||c(r,t))}})})}function p(e){var t,{index:r,record:n,params:l}=e,{onChange:c,unitList:u}=l,{node:p,open:m}=(0,i.i0)({name:null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"",onOk:e=>{var t=[...u];t[r].name=e,c(t)}});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.u,{spacing:12,content:a.o.t("Edit"),position:"top",children:(0,o.jsx)(d.hU,{color:"secondary",icon:(0,o.jsx)(s.JAz,{className:"text-14px"}),iconPosition:"left",size:"small",onClick:()=>m()})}),p]})}function m(e){var{index:t,record:r,params:n}=e;if(n.disableRetry)return null;var{onRetry:i}=n;return(0,o.jsx)(d.u,{spacing:12,content:a.o.t("datasets_unit_update_retry"),position:"top",children:(0,o.jsx)(d.hU,{color:"secondary",icon:(0,o.jsx)(s.mxP,{className:"text-14px"}),iconPosition:"left",size:"small",onClick:()=>{null==i||i(r,t)}})})}r("274971"),r("237365")},735997:function(e,t,r){r.d(t,{n:function(){return p}});var n=r(808549),o=r(120454),i=r(151064);r(455069);var l=r(385038),a=r(336205),s=r(888461),d=r(561119),c=r(237365),u=(e,t,r)=>e===d.N.Failed?(0,i.jsx)("div",{"data-dtestid":"".concat(l.w.CreateUnitListProgressName,".","subText"),className:"text-12px",children:t||a.o.t("datasets_unit_upload_fail")}):r,p=e=>{var{unitList:t=[],getColumns:r}=e;return 0===t.length?null:(0,i.jsx)("div",{className:"upload-container",children:t.map((e,t)=>{var p=(0,c.Z)(null==e?void 0:e.status),m=(null==e?void 0:e.statusDescript)||"",{subText:v,actions:_,formatType:f}=r?r(e,t):{};return(0,i.jsx)(s.v,{mainText:e.name||"--",subText:u(p,m,v),tipText:(0,i.jsx)("span",{"data-dtestid":"".concat(l.w.LocalUploadListStatus,".").concat(e.name),children:p===d.N.Failed?m||a.o.t("datasets_unit_upload_fail"):a.o.t("datasets_unit_upload_success")}),status:p,avatar:(0,c.a)((0,o._)((0,n._)({},e),{formatType:f})),actions:_,percent:e.percent||10},e.uid)})})}},237365:function(e,t,r){r.d(t,{Z:function(){return c},a:function(){return d}});var n=r(151064),o=r(537714),i=r(280053),l=r(775699),a=r(44172),s=r(561119),d=e=>{var{type:t,formatType:r,url:o}=e;return r===i.a5.Image&&["jpg","jpeg","png","webp"].includes(t)?(0,n.jsx)(l.Ee,{src:o,width:24,height:24,style:{borderRadius:"4px",marginRight:"12px",flexShrink:0}}):"md"===t?(0,n.jsx)(a.s7F,{}):"pdf"===t?(0,n.jsx)(a.I2v,{}):"docx"===t?(0,n.jsx)(a.KHq,{}):"txt"===t?(0,n.jsx)(a.KNN,{}):"xlsx"===t||"xltx"===t||"xls"===t?(0,n.jsx)(a.$lV,{}):"csv"===t?(0,n.jsx)(a.tsT,{}):r===i.a5.Table?(0,n.jsx)(a.LAr,{}):(0,n.jsx)(a.Hnk,{})},c=e=>e===o.Dm.UPLOADING||e===o.Dm.VALIDATING||e===o.Dm.WAIT||e===i.Vq.Handling||e===o.Ao.EntityStatusProcess?s.N.Processing:e===o.Dm.SUCCESS||e===i.Vq.Finish||e===o.Ao.EntityStatusSuccess?s.N.Complete:e===o.Dm.VALIDATE_FAIL||e===o.Dm.UPLOAD_FAIL||e===i.Vq.Failed||e===o.Ao.EntityStatusFail?s.N.Failed:s.N.Processing},861445:function(e,t,r){r.d(t,{O7:function(){return n},WT:function(){return a},Yg:function(){return o},xT:function(){return i}});var n=100,o=3e3,i=[".xls",".xlsx",".csv"],l={DOUYIN:{acceptFileTypes:[".pdf",".txt",".doc",".docx"],fileFormatString:"PDF、TXT、DOC、DOCX",addUnitMaxLimit:100},DEFAULT:{acceptFileTypes:[".pdf",".txt",".docx",".md"],fileFormatString:"PDF、TXT、DOCX、MD",addUnitMaxLimit:300}},a=e=>e&&l[e]||l.DEFAULT},116497:function(e,t,r){r.d(t,{G2:function(){return i},XC:function(){return l},ge:function(){return o}});var n,o=((n={})[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.THREE=3]="THREE",n[n.SEVEN=7]="SEVEN",n[n.THIRTY=30]="THIRTY",n),i=100,l=500},528751:function(e,t,r){r.d(t,{pL:()=>a,O7:()=>i.O7,Q:()=>c,ge:()=>m.ge,hD:()=>d,XC:()=>m.XC,z2:()=>u,DU:()=>s,c3:()=>l,v1:()=>p.v,Px:()=>p.P,G2:()=>m.G2,Yg:()=>i.Yg});var n,o,i=r("861445");var l=((n={}).ERROR="error",n.LOADING="loading",n.NORMAL="normal",n),a=50,s=30;var d=((o={}).SHEET="sheet_id",o.KEY_START_ROW="header_line_idx",o.DATA_START_ROW="start_line_idx",o),c={sheet_id:0,header_line_idx:0,start_line_idx:1},u={sheet_id:0,header_line_idx:0,start_line_idx:0},p=r("461334"),m=r("116497")},461334:function(e,t,r){r.d(t,{P:function(){return l},v:function(){return a}});var n=r(336205),o=r(288391),i=()=>({[o.IB.LINE_BREAK]:n.o.t("datasets_Custom_segmentID_linebreak"),[o.IB.LINE_BREAK2]:n.o.t("datasets_Custom_segmentID_2linebreak"),[o.IB.CN_PERIOD]:n.o.t("datasets_Custom_segmentID_cnperiod"),[o.IB.CN_EXCLAMATION]:n.o.t("datasets_Custom_segmentID_cn_exclamation"),[o.IB.EN_PERIOD]:n.o.t("datasets_Custom_segmentID_enperiod"),[o.IB.EN_EXCLAMATION]:n.o.t("datasets_Custom_segmentID_en_exclamation"),[o.IB.CN_QUESTION]:n.o.t("datasets_Custom_segmentID_cn_question"),[o.IB.EN_QUESTION]:n.o.t("datasets_Custom_segmentID_en_question"),[o.IB.CUSTOM]:n.o.t("datasets_Custom_segmentID_custom")}),l=()=>Object.entries(i()).map(e=>{var[t,r]=e;return{value:t,label:r}}),a={separator:{type:o.IB.LINE_BREAK,customValue:"###"},maxTokens:800,preProcessRules:[],overlap:10}},771242:function(e,t,r){r.d(t,{nC:function(){return i.nC},p:function(){return o.p},uA:function(){return n.uA},vS:function(){return l.v},zP:function(){return n.zP}}),r(528751);var n=r(274971),o=r(270917),i=r(47522),l=r(936731);r(237365)},561119:function(e,t,r){r.d(t,{N:function(){return o}});var n,o=((n={})[n.Processing=0]="Processing",n[n.Complete=1]="Complete",n[n.Failed=2]="Failed",n)},288391:function(e,t,r){r.d(t,{IB:function(){return s},OX:function(){return l},dV:function(){return a}});var n,o,i,l=((n={})[n.AUTO=0]="AUTO",n[n.CUSTOM=1]="CUSTOM",n[n.LEVEL=2]="LEVEL",n);var a=((o={}).REMOVE_SPACES="remove_extra_spaces",o.REMOVE_EMAILS="remove_urls_emails",o);var s=((i={}).LINE_BREAK="\n",i.LINE_BREAK2="\n\n",i.CN_PERIOD="。",i.CN_EXCLAMATION="！",i.EN_PERIOD=".",i.EN_EXCLAMATION="!",i.CN_QUESTION="？",i.EN_QUESTION="?",i.CUSTOM="custom",i)},900539:function(e,t,r){r.d(t,{As:function(){return C},BD:function(){return S},JD:function(){return w},V1:function(){return N},l$:function(){return g},mD:function(){return b},mZ:function(){return k},td:function(){return y},te:function(){return f},uA:function(){return x},wV:function(){return _},y3:function(){return j},zP:function(){return h}});var n=r(808549),o=r(120454),i=r(962289),l=r(22916),a=r(745474),s=r(537714),d=r(458620),c=r(336205),u=r(727914),p=r(280053),m=r(674343),v=r(528751),_=e=>{var{unitList:t,data:r,fileInstance:i,index:l}=e;return r?t.map((e,t)=>l===t?(0,o._)((0,n._)({},e),{uri:r.upload_uri||"",status:s.Dm.SUCCESS,percent:100,fileInstance:i}):e):t};function f(e){var t=e.filter(e=>e.status===p._m.Failed);t.length&&a.s5.errorEvent(a.xW.KNOWLEDGE,{eventName:d.b.KnowledgeGetTaskProgress,error:new u.sH(d.b.KnowledgeGetTaskProgress,"".concat(d.b.KnowledgeGetTaskProgress,": get progress fail. ").concat(JSON.stringify(t))),meta:{failIds:t}})}function h(e){return e.length>0&&e.every(e=>e.progress===v.O7||e.status===p._m.Failed)}var x=e=>{e.current&&(clearTimeout(e.current),e.current=void 0)};function g(){var e=(0,l.kF)();return(0,i.Z)(e,"opt",s.VP.ADD)}function y(){var e=(0,l.kF)();return(0,i.Z)(e,"docID",void 0)}var b=e=>{var t=e.lastIndexOf(".");return e.slice(t+1).toLowerCase()},j=e=>new Promise((t,r)=>{var n=new FileReader;n.onload=e=>{var n,o=null===(n=e.target)||void 0===n?void 0:n.result;if(!o||"string"!=typeof o){r(new u.sH("getBase64","file read invalid"));return}t(o.replace(/^.*?,/,""))},n.onerror=()=>{m.FN.error(c.o.t("read_file_failed_please_retry")),r(new u.sH("getBase64","file read fail"))},n.onabort=()=>{r(new u.sH("getBase64","file read abort"))},n.readAsDataURL(e)}),w=e=>new Promise((t,r)=>{var n=new FileReader;n.onload=e=>{var n;(null===(n=e.target)||void 0===n?void 0:n.result)?t(new Uint8Array(e.target.result)):r(new u.sH("getUint8Array","file read invalid"))},n.readAsArrayBuffer(e)});function C(e,t){var r=e.filter(e=>e.status===p._m.Failed);r.length>0&&a.s5.errorEvent(a.xW.KNOWLEDGE,{eventName:t,error:new u.sH(t,"".concat(t,": fail document_ids are ").concat(JSON.stringify(r))),meta:{failDocumentIds:r}})}var k=e=>c.o.t("knowledge_add_unit_process_notice"),N=(e,t)=>e===s.VP.RESEGMENT&&t&&[s.Cm.TABLE_GOOGLE_DRIVE,s.Cm.TABLE_FEISHU].includes(t),S=e=>e===s.VP.INCREMENTAL},274971:function(e,t,r){r.d(t,{wO:()=>n.wO,hd:()=>n.hd,l$:()=>o.l$,VR:()=>i.VR,V1:()=>o.V1,y3:()=>o.y3,mZ:()=>o.mZ,mD:()=>o.mD,zP:()=>o.zP,JD:()=>o.JD,td:()=>o.td,As:()=>o.As,UQ:()=>l,te:()=>o.te,wV:()=>o.wV,BD:()=>o.BD,OP:()=>n.OP,uA:()=>o.uA});var n=r("690612"),o=r("900539"),i=r("417062");function l(e){return!1}r("888711")},690612:function(e,t,r){r.d(t,{OP:function(){return a},bp:function(){return s},hd:function(){return l},wO:function(){return c}});var n=r(962289),o=r(336205),i=r(528751),l=e=>({[i.ge.ZERO]:o.o.t("datasets_frequencyModal_frequency_noUpdate"),[i.ge.ONE]:o.o.t("datasets_frequencyModal_frequency_day",{num:1}),[i.ge.THREE]:o.o.t("datasets_frequencyModal_frequency_day",{num:3}),[i.ge.SEVEN]:o.o.t("datasets_frequencyModal_frequency_day",{num:7}),[i.ge.THIRTY]:o.o.t("datasets_frequencyModal_frequency_day",{num:30})})[e],a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=!0,n="";return e?(/["'`\\]+/g.test(e)&&(r=!1,n=o.o.t("knowledge_tableStructure_field_errLegally")),["_knowledge_slice_id"].includes(e)&&(r=!1,n=o.o.t("knowledge_tableStructure_errSystemField")),{valid:r,errorMsg:n}):{valid:!1,errorMsg:t}},s=e=>{if(!e)return[];var t=e.match(/<img[^>]+src\s*=\s*['"]([^'"]+)['"][^>]*>/g),r=[];if(t)for(var n=0;n<t.length;n++){var o,i=null===(o=t[n].match(/src\s*=\s*['"]([^'"]+)['"]/))||void 0===o?void 0:o[1];i&&r.push(i)}return r},d=e=>Object.values(i.hD).includes(e),c=e=>{var t={sheet_id:"",header_line_idx:"",start_line_idx:""};return Object.keys(e).reduce((t,r)=>(d(r)&&(t[r]=String((0,n.Z)(e,r))),t),t),t}},417062:function(e,t,r){r.d(t,{VR:function(){return a}});var n=r(280053),o=r(461334),i=r(288391),l=e=>e.chunk_type===n.x2.CustomChunk?i.OX.CUSTOM:e.chunk_type===n.x2.LevelChunk?i.OX.LEVEL:i.OX.AUTO,a=e=>{if(e&&Object.keys(e)&&(null==e?void 0:e.chunk_strategy))try{var t=(null==e?void 0:e.chunk_strategy)||{},r=[];return t.remove_extra_spaces&&r.push(i.dV.REMOVE_SPACES),t.remove_urls_emails&&r.push(i.dV.REMOVE_EMAILS),{docInfo:e,segmentMode:l(null==e?void 0:e.chunk_strategy),segmentRule:{separator:t.separator?s(t.separator):o.v.separator,maxTokens:t.max_tokens?Number(t.max_tokens):o.v.maxTokens,preProcessRules:r,overlap:t.overlap?Number(t.overlap):o.v.overlap}}}catch(e){}},s=e=>(function(e){var t=[];for(var[,r]of Object.entries(e))r!==e.CUSTOM&&t.push(r);return t})(i.IB).indexOf(e)>-1?{type:e}:{type:i.IB.CUSTOM,customValue:e}},888711:function(e,t,r){r.d(t,{Y:function(){return i}});var n=r(537714),o=r(288391),i=(e,t)=>{if(e===o.OX.CUSTOM){var r=(null==t?void 0:t.maxTokens)||0,i=null==t?void 0:t.separator,l=(null==i?void 0:i.type)===o.IB.CUSTOM&&!(null==i?void 0:i.customValue);if(0===r||l||"number"!=typeof t.overlap||Number.isNaN(t.overlap))return n.xZ.DISABLE}return n.xZ.ENABLE}},299464:function(e,t,r){r.d(t,{q9:()=>tx,Gx:()=>eg,a8:()=>eP,it:()=>ty,hP:()=>eA});var n,o,i,l,a,s=r("151064"),d=r("455069"),c=r("287487"),u=r("22916"),p=r("825955"),m=r("808549"),v=r("120454"),_=r("263825"),f=r("75117"),h=r("336205"),x=r("674343"),g=r("653598"),y=r("178385"),b=r("382534"),j=r("658665");var w=((n={}).CREATE="create",n.EDIT="edit",n),C=e=>{var{onSubmit:t,onClose:r,initValues:n,mode:o="create",renderAutoGenerate:i}=e,[l,a]=(0,d.useState)(!1),c=()=>{a(!1),null==r||r()};return{visible:l,open:()=>{a(!0)},close:c,modal:(0,s.jsx)(k,{visible:l,onClose:c,onSubmit:t,initValues:n,mode:o,renderAutoGenerate:i})}},k=e=>{var t,r,n,o,i,l,a,c,u,w,{visible:C,initValues:k,onClose:N,onSubmit:S,mode:E,renderAutoGenerate:T}=e,I=(0,d.useRef)(null);var P=(t=(0,p._)(function*(){if(!!I.current){var e,t,r,n,o,i,l=yield I.current.validate();S((0,v._)((0,m._)({},l),{icon_uri:[{url:null!==(o=null==l?void 0:null===(t=l.icon_uri)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.url)&&void 0!==o?o:"",uri:null!==(i=null==l?void 0:null===(n=l.icon_uri)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.uid)&&void 0!==i?i:""}]}))}}),function(){return t.apply(this,arguments)}),[A,D]=(0,d.useState)({uri:null!==(a=null==k?void 0:null===(o=k.icon_uri)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.uri)&&void 0!==a?a:"",url:null!==(c=null==k?void 0:null===(l=k.icon_uri)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:i.url)&&void 0!==c?c:""}),[L,O]=(0,d.useState)({name:null!==(u=null==k?void 0:k.name)&&void 0!==u?u:"",desc:null!==(w=null==k?void 0:k.description)&&void 0!==w?w:""});var Z=(r=(0,p._)(function*(){var e,t,r,n,o,i,{icon:l}=yield b.MJ.GetIcon({format_type:g.a5.Database});D({uri:null!==(t=null==l?void 0:l.uri)&&void 0!==t?t:"",url:null!==(r=null==l?void 0:l.url)&&void 0!==r?r:""}),null===(e=I.current)||void 0===e||e.setValue("icon_uri",[{url:null!==(n=null==l?void 0:l.url)&&void 0!==n?n:"",uri:null!==(o=null==l?void 0:l.uri)&&void 0!==o?o:"",uid:null!==(i=null==l?void 0:l.uri)&&void 0!==i?i:"",isDefault:!0}])}),function(){return r.apply(this,arguments)}),F=(0,d.useCallback)(e=>{var{name:t,description:r,icon_uri:n}=e;if(!!I.current){if(I.current.setValue("name",t),I.current.setValue("description",r),O({name:null!=t?t:"",desc:null!=r?r:""}),!n||!n[0].url){Z();return}I.current.setValue("icon_uri",[{url:n[0].url,uri:n[0].uri,uid:n[0].uri,isDefault:!0}])}},[I]);return(0,d.useEffect)(()=>{if(!!C&&!!k)F(k)},[C,k,F]),(0,s.jsx)(x.u_,{title:"create"===E?h.o.t("db_add_table_title"):h.o.t("db_edit_title"),closable:!0,visible:C,onCancel:()=>{if(I.current){var e;null===(e=I.current)||void 0===e||e.reset(["name","description","icon_uri"])}null==N||N()},className:"w-[480px]",okText:h.o.t("db2_004"),okButtonProps:{"data-testid":"database.info_modal.button.confirm"},cancelText:h.o.t("db_del_field_confirm_no"),onOk:P,maskClosable:!1,children:(0,s.jsx)(x.l0,{className:j.Z["database-model-content"],getFormApi:e=>{I.current=e},initValues:k,children:e=>{var{formState:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.NB,{"data-testid":"database.info_modal.input.name",field:"name",label:h.o.t("db_add_table_name"),placeholder:h.o.t("db_add_table_name_tips"),required:!0,maxLength:50,disabled:"edit"===E,onChange:e=>{O(t=>(0,v._)((0,m._)({},t),{name:(null==e?void 0:e.trim())||""}))},rules:[{required:!0,message:h.o.t("db2_005")},{pattern:/^[a-z][a-z0-9_]{0,63}$/,message:h.o.t("db_new_0004")}]}),(0,s.jsx)(_.eI,{"data-testid":"database.info_modal.input.description",field:"description",label:h.o.t("db_add_table_desc"),placeholder:h.o.t("db_add_table_desc_tips"),maxCount:100,maxlength:100,onChange:e=>{O(t=>(0,v._)((0,m._)({},t),{desc:(null==e?void 0:e.trim())||""}))}}),(0,s.jsx)(f.s,{label:h.o.t("datasets_model_create_avatar"),field:"icon_uri",fileBizType:y.ym.BIZ_DATASET_ICON,iconType:y.Tu.Dataset,uploadClassName:"w-auto",generateInfo:L,withAutoGenerate:!!T,renderAutoGenerate:T,initValue:[{url:null==A?void 0:A.url,uid:null==A?void 0:A.uri,isDefault:!0}]})]})}})})},N=r("177198"),S=r("915757"),E=r("252237"),T=r.n(E),I={info:"bg-[rgba(var(--coze-brand-1),var(--coze-brand-1-alpha))]",warning:"bg-[rgba(var(--coze-yellow-1),var(--coze-yellow-1-alpha))]",danger:"bg-[rgba(var(--coze-red-1),var(--coze-red-1-alpha))]",success:"bg-[rgba(var(--coze-green-1),var(--coze-green-1-alpha))]"};function P(e){var{type:t,persistentKey:r,className:n,children:o}=e,[i,l]=(0,d.useState)(!!localStorage.getItem(r)),[a,c]=(0,d.useState)(!1);return i||a?null:(0,s.jsxs)("div",{className:T()("p-[8px] flex justify-center",I[null!=t?t:"info"],n),children:[(0,s.jsx)("div",{className:"flex grow justify-center text-[14px] leading-[20px]",children:o}),(0,s.jsxs)("div",{className:"flex items-center gap-[10px] leading-none",children:[(0,s.jsx)(x.ZT.Text,{type:"secondary",fontSize:"12px",className:"cursor-pointer",onClick:()=>{localStorage.setItem(r,"1"),l(!0)},children:h.o.t("not_show_again")}),(0,s.jsx)(x.hU,{color:"secondary",size:"mini",className:"!h-[unset]",icon:(0,s.jsx)(S.rmE,{className:"w-[16px] h-[16px]"}),onClick:()=>c(!0)})]})]})}var A=r("801815"),D=r("392300"),L=r("689951"),O=r("745474"),Z=r("458620"),F=r("707107"),M=r("775699"),z=r("44172"),R=r("499283"),B=r("33630"),V=r("826256"),U=e=>{var{errorMsg:t,errorMsgFloat:r}=e;return(0,s.jsxs)("div",{className:T()({[V.Z["select-wrapper"]]:!0,[V.Z["error-wrapper"]]:!!t}),children:[(0,s.jsx)(x.Ph,(0,v._)((0,m._)({},e.selectProps),{style:{width:"100%"},value:e.value,onChange:t=>{var r;null==e||null===(r=e.handleChange)||void 0===r||r.call(e,t)},dropdownClassName:V.Z["selected-option"]})),t?(0,s.jsx)("div",{className:T()({[V.Z["error-content"]]:!0,[V.Z["error-float"]]:!!r}),children:(0,s.jsx)("div",{className:V.Z["error-text"],children:t})}):null]})},H=r("550655"),W=r("626862"),G=r("125915"),K=e=>{var t,r,n,o,{ellipsis:i=!0,maxCount:l,errorMsgFloat:a}=e,c=(0,H.Z)(l)&&l>0;(0,d.useImperativeHandle)(e.onRef,()=>({triggerFocus:_}));var u=(0,W.Z)({value:e.value,inputOnFocus:!1,inputEle:!1}),p=(0,d.useRef)(null),_=()=>{var e;u.inputEle=!0,null==p||null===(e=p.current)||void 0===e||e.focus()},f=(0,d.useMemo)(()=>{var e,t;return((null===(e=p.current)||void 0===e?void 0:e.clientWidth)||0)<((null===(t=p.current)||void 0===t?void 0:t.scrollWidth)||0)-1},[i,u.inputOnFocus,u.value,null===(t=p.current)||void 0===t?void 0:t.clientWidth,null===(r=p.current)||void 0===r?void 0:r.scrollWidth,u.inputEle]);(0,d.useEffect)(()=>{u.value=e.value},[e.value]);var h=(0,s.jsxs)("span",{className:G.Z["limit-count"],children:[(null===(n=u.value)||void 0===n?void 0:n.length)||0,"/",l]});return(0,s.jsxs)("div",{className:T()(G.Z["input-wrapper"],e.className),style:e.style,children:[!u.inputEle&&f?(0,s.jsx)(x.u,(0,v._)((0,m._)({content:(0,s.jsx)("article",{style:{maxWidth:200,wordWrap:"break-word",wordBreak:"normal"},children:u.value}),position:"top",showArrow:!0,mouseEnterDelay:300},e.tooltipProps),{children:(0,s.jsx)("div",{className:T()((null==e?void 0:e.errorMsg)?G.Z["error-wrapper"]:null),onClick:()=>{!u.inputEle&&setTimeout(()=>{var e;null==p||null===(e=p.current)||void 0===e||e.focus()},10),u.inputEle=!0},children:(0,s.jsx)(x.II,(0,v._)((0,m._)({},e.inputProps),{ref:p,value:u.value,className:i?G.Z.input:"",suffix:c?h:void 0}))})})):(0,s.jsx)("div",{className:T()((null==e?void 0:e.errorMsg)?G.Z["error-wrapper"]:null),children:(0,s.jsx)(x.J2,(0,v._)((0,m._)({},e.onFocusPopoverProps),{trigger:"custom",visible:!!(null===(o=e.onFocusPopoverProps)||void 0===o?void 0:o.content)&&u.inputOnFocus,showArrow:!0,children:(0,s.jsx)(x.II,(0,v._)((0,m._)({},e.inputProps),{ref:p,value:u.value,className:i?G.Z.input:"",onChange:t=>{var r;u.value=t,null==e||null===(r=e.handleChange)||void 0===r||r.call(e,t)},onFocus:()=>{var t;u.inputOnFocus=!0,u.inputEle=!0,null==e||null===(t=e.handleFocus)||void 0===t||t.call(e,u.value||"")},onBlur:t=>{var r,n;u.inputOnFocus=!1,null==e||null===(r=e.handleBlur)||void 0===r||r.call(e,u.value||""),null==e||null===(n=e.onBlur)||void 0===n||n.call(e,t),u.inputEle=!1},suffix:c?h:void 0}))}))}),(null==e?void 0:e.errorMsg)?(0,s.jsx)("div",{className:T()({[G.Z["error-content"]]:!0,[G.Z["error-float"]]:!!a}),children:(0,s.jsx)("div",{className:G.Z["error-text"],children:null==e?void 0:e.errorMsg})}):null]})},J=(0,x.Q2)(K,{valueKey:"value",onKeyChangeFnName:"handleChange"}),q=r("602876"),$=[{value:q.wp.Text,label:h.o.t("db_add_table_field_type_txt")},{value:q.wp.Number,label:h.o.t("db_add_table_field_type_int")},{value:q.wp.Date,label:h.o.t("db_add_table_field_type_time")},{value:q.wp.Float,label:h.o.t("db_add_table_field_type_number")},{value:q.wp.Boolean,label:h.o.t("db_add_table_field_type_bool")}];h.o.t("db_add_table_temp_desc"),B.mx.LimitedReadWrite,(0,A.x0)(),h.o.t("db_add_table_temp_field_desc1"),q.wp.Text,(0,A.x0)(),h.o.t("db_add_table_temp_field_desc2"),q.wp.Number,(0,A.x0)(),h.o.t("db_add_table_temp_field_desc3"),q.wp.Text,B.mx.LimitedReadWrite,h.o.t("db_table_0129_005"),h.o.t("db_table_0129_002"),B.mx.ReadOnly,h.o.t("db_table_0129_006"),h.o.t("db_table_0129_003"),B.mx.UnlimitedReadWrite,h.o.t("db_table_0129_007"),h.o.t("db_table_0129_004"),B.mx.RWModeMax;var X={excel:[B.mx.LimitedReadWrite],normal:[B.mx.LimitedReadWrite],expert:[B.mx.LimitedReadWrite,B.mx.UnlimitedReadWrite]},Y={name:"uuid",desc:h.o.t("workflow_240221_01"),type:q.wp.Text,must_required:!0,nanoid:(0,A.x0)(),isSystemField:!0},Q={name:"id",desc:h.o.t("database_240520_01"),type:q.wp.Number,must_required:!0,nanoid:(0,A.x0)(),isSystemField:!0},ee={name:"sys_platform",desc:h.o.t("db_optimize_002"),type:q.wp.Text,must_required:!0,nanoid:(0,A.x0)(),isSystemField:!0},et=[Q,ee,Y,{name:"bstudio_create_time",desc:h.o.t("db_optimize_003"),type:q.wp.Date,must_required:!0,nanoid:(0,A.x0)(),isSystemField:!0}],er={id:"bstudio_id",sys_platform:"bstudio_connector_id",uuid:"bstudio_connector_uid",bstudio_create_time:"bstudio_create_time"};function en(e){var t,r,{field:n,textType:o="secondary",type:i,tip:l,required:a}=e;return(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[(0,s.jsx)(x.ZT.Text,{type:o,weight:500,fontSize:"12px",ellipsis:!0,children:n}),a?(0,s.jsx)("span",{className:"coz-fg-hglt-red text-[12px] leading-[16px]",children:"*"}):null,l?(0,s.jsx)(x.u,{content:l,style:{maxWidth:"unset"},children:(0,s.jsx)(S.L03,{className:"w-[12px] h-[12px] ml-[3px] coz-fg-secondary"})}):null,"number"==typeof i?(0,s.jsx)(x.Vp,{color:"primary",size:"mini",className:"ml-[4px]",children:null!==(r=null===(t=$.find(e=>e.value===i))||void 0===t?void 0:t.label)&&void 0!==r?r:i}):null]})}var eo=r("736351");var ei=((o={}).custom="custom",o.template="template",o.excel="excel",o.recommend="recommend",o.naturalLanguage="naturalLanguage",o);var el=((i={})[i.Required=1]="Required",i[i.Unique=2]="Unique",i[i.Naming=3]="Naming",i),ea=[{type:1,regex:/[^a-z0-9_]/,errorMsg:h.o.t("db_add_table_field_name_tips2")},{type:2,regex:/^[^a-z]/,errorMsg:h.o.t("db_add_table_field_name_tips3")},{type:3,regex:/[\s\S]{64,}/,errorMsg:h.o.t("db_add_table_field_name_tips4")}],es=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[...t];return ea.forEach(t=>{r=r.filter(e=>e!==t.errorMsg),t.regex.test(e||"")&&r.push(t.errorMsg)}),r},ed=[{label:h.o.t("db_add_table_field_name"),key:"name",validator:[{type:el.Naming,message:""},{type:el.Required,message:h.o.t("db_table_save_exception_nofieldname")},{type:el.Unique,message:h.o.t("db_table_save_exception_fieldname")}],defaultValue:"",require:!0},{label:h.o.t("db_add_table_field_desc"),key:"desc",require:!1,validator:[],defaultValue:""},{label:h.o.t("db_add_table_field_type"),key:"type",require:!0,validator:[{type:el.Required,message:h.o.t("db_table_save_exception_fieldtype")}],defaultValue:""},{label:h.o.t("db_add_table_field_necessary"),key:"must_required",require:!1,validator:[],defaultValue:!0}],ec=(e,t)=>e.map(r=>{var n=(0,m._)({},r);return ed.forEach(r=>{var o=r.key;r.validator.forEach(r=>{!(null==n?void 0:n.errorMapper)&&(n.errorMapper={});var i,l=null==n?void 0:null===(i=n.errorMapper)||void 0===i?void 0:i[o],a=n[o];!l&&(n.errorMapper[o]=[],l=[]);var s=r.message;switch(r.type){case el.Required:"save"===t&&!a&&ed.find(e=>!!n[e.key]&&!e.defaultValue)&&n.errorMapper[o].push(s),"change"===t&&a&&(n.errorMapper[o]=l.filter(e=>e!==s));break;case el.Unique:"save"===t&&a&&1!==e.filter(e=>e[o]===n[o]).length&&n.errorMapper[o].push(s),"change"===t&&a&&1===e.filter(e=>e[o]===n[o]).length&&(n.errorMapper[o]=l.filter(e=>e!==s));break;case el.Naming:("save"===t||"blur"===t||"change"===t&&l.length)&&(n.errorMapper[o]=es(a,l))}n.errorMapper[o]=Array.from(new Set(n.errorMapper[o]))})}),n}),eu=r("474872"),ep=r("606526"),em=()=>(0,s.jsx)(eu.yk,{className:ep.Z["modal-key-tip"],children:"- ".concat(h.o.t("db_add_table_field_name_tips1"),"\n- ").concat(h.o.t("db_add_table_field_name_tips2"),"\n- ").concat(h.o.t("db_add_table_field_name_tips3"),"\n- ").concat(h.o.t("db_add_table_field_name_tips4"))}),ev=r("777432"),e_=(0,d.forwardRef)((e,t)=>{var r,n,o,{data:i,botId:l="",spaceId:a="",creatorId:c="",onSave:u,onCancel:_,onDeleteField:f,forceEdit:g=!1,maxColumnNum:y=20,useComputingEnableGoToNextStep:j,readAndWriteModeOptions:w,onlyShowDatabaseInfoRWMode:C,enableAdd:k=!0,loading:S=!1,setContentCheckErrorMsg:E=D.Z,createType:I,showDatabaseBaseInfo:P,hiddenTableBorder:V,isReadonlyMode:H,projectID:W,renderModeSelect:G}=e,[q,Y]=(0,d.useState)([]),Q=(0,d.useRef)(null),ee=(0,d.useRef)(null),er=(0,d.useRef)(),ei=!!i.tableId,[el,{setTrue:ea,setFalse:ed}]=(0,L.Z)(!1),eu=q.filter(e=>!e.isSystemField),ep=eu.length>=y,e_=eu.length>y,ef=eu.filter(e=>e.name||e.desc||e.type).length<=0,eh=[0x2a339708,0x2a3851f8],ex=e=>{(0,R.k0)(e)&&eh.includes(Number(null==e?void 0:e.code))&&E((null==e?void 0:e.msg)||h.o.t("knowledge_bot_update_databse_tnserr_msg"))},eg=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!el)Y([...q,{nanoid:(0,A.x0)(),name:"",desc:"",type:void 0,must_required:!1}]),e&&setTimeout(()=>{var e,t,r;null===(t=Q.current)||void 0===t||null===(e=t.triggerFocus)||void 0===e||e.call(t),null===(r=ee.current)||void 0===r||r.scrollIntoView({block:"end",behavior:"smooth"})},100)},ey=e=>{Y(t=>ec(t,e))};var eb=(r=(0,p._)(function*(){var e=ec(q,"save");if(Y(e),P)try{yield er.current.formApi.validate(["name"])}catch(e){return!1}return!e.find(e=>Object.keys(e.errorMapper||{}).find(t=>{var r,n;return!!(null==e?void 0:null===(n=e.errorMapper)||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r.length)}))&&!ef&&!0}),function(){return r.apply(this,arguments)});var ej=(n=(0,p._)(function*(){var e,t,r={};r=er.current?er.current.formApi.getValues():{name:i.name,desc:i.desc,readAndWriteMode:i.readAndWriteMode,prompt_disabled:(null===(e=i.extra_info)||void 0===e?void 0:e.prompt_disabled)==="true"},ei?(0,F.Gg)(F.Kg.edit_table_click,{need_login:!0,have_access:!0,bot_id:l,table_name:r.name}):(0,F.Gg)(F.Kg.create_table_click,{need_login:!0,have_access:!0,bot_id:l,table_name:r.name,database_create_type:I});var n={table_name:C?i.name:r.name,table_desc:C?i.desc:r.desc,icon_uri:i.icon_uri,prompt_disabled:!!r.prompt_disabled,field_list:q.filter(e=>!!e.name&&!e.isSystemField).map(e=>({name:e.name,desc:e.desc||"",type:e.type,must_required:e.must_required,id:null==e?void 0:e.id,alterId:null==e?void 0:e.alterId})),rw_mode:r.readAndWriteMode};if(ei)try{t=yield b.v6.UpdateDatabase((0,v._)((0,m._)({},n),{id:i.tableId}))}catch(e){O.s5.errorEvent(O.xW.DATABASE,{eventName:Z.b.DatabaseAlterTable,error:e}),ex(e);return}else try{t=yield b.v6.AddDatabase((0,v._)((0,m._)({},n),{space_id:a,creator_id:c,project_id:W}))}catch(e){O.s5.errorEvent(O.xW.DATABASE,{eventName:Z.b.DatabaseAddTable,error:e}),ex(e);return}u&&(yield u({response:t})),null==_||_()}),function(){return n.apply(this,arguments)});var ew=(o=(0,p._)(function*(){try{if(ea(),!(yield eb()))return;yield ej()}finally{ed()}}),function(){return o.apply(this,arguments)}),eC=e=>{if(!e)return h.o.t("db_add_table_name_tips");var t=es(e);return t.length>0?t.join("; "):""};(0,d.useImperativeHandle)(t,()=>({submit:()=>(0,p._)(function*(){return yield ew()})(),validate:()=>(0,p._)(function*(){return yield eb()})(),setTableFieldsList:Y,isReadonly:el,tableBasicInfoFormRef:er,tableFieldsList:q}),[el,q,er]),null==j||j(q,ef);var ek=k?[...q,{operate:"add"}]:q,eN=()=>{E("")};return(0,d.useEffect)(()=>{if(Y([...et,...i.tableMemoryList]),er.current&&!S){var e;er.current.formApi.setValues({name:(null==i?void 0:i.name)||"",desc:(null==i?void 0:i.desc)||"",prompt_disabled:!!ei&&(null===(e=i.extra_info)||void 0===e?void 0:e.prompt_disabled)==="true",readAndWriteMode:(null==i?void 0:i.readAndWriteMode)||B.mx.LimitedReadWrite})}},[i,S]),(0,s.jsxs)("div",{className:T()(ev.Z["table-structure-wrapper"],{[ev.Z["hidden-form-border"]]:V}),children:[P?(0,s.jsxs)(x.l0,{ref:er,layout:"vertical",className:ev.Z["table-structure-form"],onValueChange:(e,t)=>{("name"in t||"desc"in t)&&eN()},children:[C?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(J,{field:"name",label:{text:h.o.t("db_add_table_name"),required:!0},validate:e=>eC(e),trigger:["change","blur"],fieldClassName:ev.Z["table-name-form-field"],disabled:H,inputProps:{"data-testid":N.A.BotDatabaseAddModalTableNameInput,disabled:!g&&(el||ei),placeholder:h.o.t("db_add_table_name_tips")},onFocusPopoverProps:{style:{padding:"2px 12px"},position:"left",content:(0,s.jsx)(em,{})}}),(0,s.jsx)(x.l0.TextArea,{"data-testid":N.A.BotDatabaseAddModalTableDescInput,field:"desc",label:h.o.t("db_add_table_desc"),disabled:el||H,rows:2,placeholder:h.o.t("db_add_table_desc_tips"),fieldClassName:ev.Z["table-desc-form-field"]})]}),G&&w?G({dataTestId:N.A.BotDatabaseAddModalTableQueryModeSelect,field:"readAndWriteMode",label:h.o.t("db_table_0129_001"),type:"select",options:X[w]}):null]}):null,e_?(0,s.jsx)(M.jL,{type:"warning",description:h.o.t("db_table_0126_027",{ColumNum:y}),className:ev.Z["max-row-banner"]}):null,(0,s.jsx)(M.$,{tableProps:{loading:S,columns:[{dataIndex:"name",title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_name"),required:!0,tip:(0,s.jsxs)("div",{className:ev.Z["th-tip-name"],children:[(0,s.jsx)("span",{style:{width:494,marginBottom:8},children:h.o.t("db_add_table_field_name_tips")}),(0,s.jsx)(M.Ee,{preview:!1,width:494,height:163,src:eo})]})}),render:(e,t,r)=>{var n,o,i;return"add"!==t.operate?(0,s.jsx)(K,{style:{position:"static"},onRef:Q,value:t.name,inputProps:{"data-testid":N.A.BotDatabaseAddModalFieldNameInput,"data-dtestid":N.A.BotDatabaseAddModalFieldNameInput,disabled:el||t.isSystemField||H,placeholder:"Enter Name"},errorMsgFloat:!0,onFocusPopoverProps:{style:{padding:"2px 12px"},position:"left",content:(0,s.jsx)(em,{})},errorMsg:null===(i=q[r])||void 0===i?void 0:null===(o=i.errorMapper)||void 0===o?void 0:null===(n=o.name)||void 0===n?void 0:n.join("; "),handleChange:e=>{var t=[...q];t[r].name=e,Y(t),ey("change"),eN()},handleBlur:()=>{ey("blur")}}):(0,s.jsx)("div",{ref:ee,"data-testid":N.A.BotDatabaseAddModalAddBtn,children:ep?(0,s.jsx)("div",{style:{paddingRight:10},children:(0,s.jsx)(M.u,{position:"top",content:h.o.t("bot_database_add_field",{number:y}),children:(0,s.jsx)(x.zx,{color:"secondary",disabled:!0,icon:(0,s.jsx)(z.N_R,{}),children:h.o.t("bot_userProfile_add")})})}):(0,s.jsx)(x.zx,{color:"primary",disabled:el,onClick:()=>eg(!0),icon:(0,s.jsx)(z.N_R,{}),children:h.o.t("bot_userProfile_add")})})},width:261},{dataIndex:"desc",title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_desc"),tip:(0,s.jsx)("article",{style:{width:327},children:h.o.t("db_add_table_field_desc_tips")})}),render:(e,t,r)=>"add"!==t.operate?(0,s.jsx)(K,{value:t.desc,maxCount:300,inputProps:{"data-testid":"".concat(N.A.BotDatabaseAddModalFieldDescInput,".").concat(r,".").concat(t.name),"data-dtestid":"".concat(N.A.BotDatabaseAddModalFieldDescInput,".").concat(r,".").concat(t.name),maxLength:300,disabled:el||t.isSystemField||H,placeholder:h.o.t("bot_edit_variable_description_placeholder")},errorMsgFloat:!0,handleChange:e=>{var t=[...q];t[r].desc=e,Y(t),eN()}}):null,width:369},{dataIndex:"type",title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_type"),required:!0,tip:(0,s.jsx)("article",{style:{width:327},children:h.o.t("db_add_table_field_type_tips")})}),render:(e,t,r)=>{var n,o,i;return"add"!==t.operate?(0,s.jsx)(U,{value:t.type,selectProps:{"data-testid":"".concat(N.A.BotDatabaseAddModalFieldTypeSelect,".").concat(r,".").concat(t.name),"data-dtestid":"".concat(N.A.BotDatabaseAddModalFieldTypeSelect,".").concat(r,".").concat(t.name),disabled:el||ei&&!!t.id||t.isSystemField||H,placeholder:h.o.t("db_table_save_exception_fieldtype"),optionList:$},errorMsgFloat:!0,errorMsg:null===(i=q[r])||void 0===i?void 0:null===(o=i.errorMapper)||void 0===o?void 0:null===(n=o.type)||void 0===n?void 0:n.join("; "),handleChange:e=>{var t=[...q];t[r].type=e,Y(t),ey("change")}}):null},width:214},{dataIndex:"must_required",title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_necessary"),tip:(0,s.jsxs)("article",{style:{width:327},children:[(0,s.jsx)("p",{className:ev.Z["th-tip-dot"],children:h.o.t("db_add_table_field_necessary_tips1")}),(0,s.jsx)("p",{className:ev.Z["th-tip-dot"],children:h.o.t("db_add_table_field_necessary_tips2")})]})}),render:(e,t,r)=>"add"!==t.operate?(0,s.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,s.jsx)(x.rs,{"data-testid":"".concat(N.A.BotDatabaseAddModalFieldRequiredSwitch,".").concat(r,".").concat(t.name),"data-dtestid":"".concat(N.A.BotDatabaseAddModalFieldRequiredSwitch,".").concat(r,".").concat(t.name),disabled:el||t.disableMustRequired||t.isSystemField||H,checked:t.must_required,onChange:e=>{var t=[...q];t[r].must_required=e,Y(t)},size:"small","aria-label":"a switch for semi demo"})}):null,width:108},{dataIndex:"operate",title:(0,s.jsx)(en,{field:h.o.t("db_table_0126_021")}),render:(e,t,r)=>"add"!==t.operate?(0,s.jsx)(M.gl,{deleteProps:{handleClick:()=>{if(!el){var e=[...q.slice(0,r),...q.slice(r+1)];Y(e),ey("change"),null==f||f(e)}},popconfirm:{defaultVisible:!1,visible:!1},tooltip:{content:h.o.t("datasets_table_title_actions_delete")},disabled:t.isSystemField||H},editProps:{hide:!0}}):null,width:85}],dataSource:ek,pagination:!1,className:ev.Z["table-structure-table"],rowKey:"nanoid"},wrapperClassName:ev.Z["table-structure-table-wrapper"]}),ef&&!S?(0,s.jsx)("div",{className:ev.Z["table-empty-tips"],children:h.o.t("db_table_save_exception_nofield")}):null]})}),ef=e=>{var{onReturn:t,onSubmit:r,initValue:n,showDatabaseBaseInfo:o,extraParams:i,onlyShowDatabaseInfoRWMode:l,projectID:a,renderGenerate:c,renderModeSelect:u}=e,[p,m]=(0,d.useState)(!1),v=()=>{m(!1)};return{visible:p,open:()=>{m(!0)},close:v,modal:(0,s.jsx)(eh,{visible:p,onClose:v,onReturn:t,onSubmit:r,initValue:n,showDatabaseBaseInfo:o,extraParams:i,onlyShowDatabaseInfoRWMode:l,projectID:a,renderGenerate:c,renderModeSelect:u})}};function eh(e){var t,r,{visible:n,onClose:o,onReturn:i,onSubmit:l,initValue:a,showDatabaseBaseInfo:c,onlyShowDatabaseInfoRWMode:u,extraParams:{botId:_="",spaceId:f="",creatorId:g=""}={},projectID:y,renderGenerate:b,renderModeSelect:j}=e,[w,C]=(0,d.useState)(!1),[k,E]=(0,d.useState)(!1),[T,I]=(0,d.useState)(!1),[A,D]=(0,d.useState)(a),L=(0,d.useRef)(null),O=(0,d.useMemo)(()=>!!a.tableId,[a]);var Z=(t=(0,p._)(function*(e){var{response:t}=e;yield null==l?void 0:l(t)}),function(e){return t.apply(this,arguments)});var F=(r=(0,p._)(function*(){if(L.current)try{E(!0),yield L.current.submit()}finally{E(!1)}}),function(){return r.apply(this,arguments)});return(0,d.useEffect)(()=>{D(a)},[a]),(0,s.jsx)(x.u_,{closable:!0,maskClosable:!1,visible:n,onCancel:void 0,onOk:F,size:"xxl",header:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[(0,s.jsx)("div",{className:"flex-1 text-[20px] font-medium coz-fg-plus",children:O?h.o.t("db_edit_title"):h.o.t("db_add_table_title")}),O?null:null==b?void 0:b({tableStructureRef:L,onGenerateChange:e=>{D((0,v._)((0,m._)({},A),{tableMemoryList:e}))},onGenerating:C,botId:_}),(0,s.jsx)("div",{children:(0,s.jsx)(x.hU,{color:"secondary",icon:(0,s.jsx)(S.rmE,{className:"text-[20px] coz-fg-secondary"}),onClick:o})})]}),O?(0,s.jsx)(P,{type:"warning",persistentKey:"_coze_database_edit_warning",className:"mx-[-24px]",children:h.o.t("db_edit_tips1")}):null]}),footer:(0,s.jsxs)("div",{className:"coz-modal-footer",children:[(0,s.jsx)(x.zx,{color:"primary",onClick:()=>{if(i){i();return}},children:O?h.o.t("db_del_field_confirm_no"):h.o.t("db2_003")}),(0,s.jsx)(x.zx,{"data-testid":N.A.BotDatabaseAddModalSubmitBtn,loading:k,onClick:F,disabled:T,children:h.o.t("db_edit_save")})]}),children:(0,s.jsx)("div",{children:(0,s.jsx)(e_,{data:A,ref:L,loading:w,loadingTips:h.o.t("bot_database_ai_waiting"),botId:_,spaceId:f,creatorId:g,maxColumnNum:20,useComputingEnableGoToNextStep:(e,t)=>{if(t||e.filter(e=>!e.isSystemField).length>20){I(!0);return}I(!e.every(e=>{var t,r;if(!(null==e?void 0:e.errorMapper))return!0;return!((null===(t=e.errorMapper.name)||void 0===t?void 0:t.length)>0)&&!((null===(r=e.errorMapper.type)||void 0===r?void 0:r.length)>0)&&!0}))},createType:ei.custom,hiddenTableBorder:!0,readAndWriteModeOptions:"expert",showDatabaseBaseInfo:c,onlyShowDatabaseInfoRWMode:u,onSave:Z,onCancel:o,projectID:y,renderModeSelect:j})})})}var ex=r("214942"),eg=e=>{var t,{projectID:r,onFinish:n}=e,o=(0,d.useRef)(0),i=(0,u.EV)(),l=(0,ex.rY)(e=>e.getSpaceId()),a=null===(t=c.Z.useUserInfo())||void 0===t?void 0:t.user_id_str,[p,m]=(0,d.useState)({name:"",description:"",icon_uri:[{uri:"",url:"",uid:""}]}),v=(0,d.useMemo)(()=>{var e,t;return{tableId:"",name:null==p?void 0:p.name,desc:null==p?void 0:p.description,icon_uri:null===(t=p.icon_uri)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.uri,readAndWriteMode:B.mx.LimitedReadWrite,tableMemoryList:[]}},[p]),_=()=>{x(),b(),o.current=0},{modal:f,open:h,close:x}=C({onSubmit:e=>{m(e),o.current=1,x(),j()},initValues:p,mode:w.CREATE}),{modal:g,open:y,close:b}=ef({onClose:()=>{console.log("open"),o.current=0,j()},onReturn:()=>{o.current=0,j(),b()},onSubmit:e=>{var t,r,{id:o,draft_id:l}=null!==(t=e.database_info)&&void 0!==t?t:{};if(o&&l){if(n){n(o,l);return}null===(r=i.toResource)||void 0===r||r.call(i,"database",o,{page_modal:"normal",from:"create"}),_()}},initValue:v,showDatabaseBaseInfo:!0,onlyShowDatabaseInfoRWMode:!0,extraParams:{spaceId:l,creatorId:a},projectID:r}),j=()=>{0===o.current?h():y()};return{modal:(0,s.jsxs)(s.Fragment,{children:[f,g]}),open:j,close:_}},ey=r("311807"),eb=r("974235"),ej=r("763055"),ew=r("382174"),eC=r("280053"),ek=r("951003"),eN=r("75991"),eS=e=>{var{label:t,onClick:r,selected:n}=e;return(0,s.jsxs)("div",{onClick:r,className:T()(["flex items-center gap-[8px] px-[12px]","px-[12px] py-[6px] rounded-[8px]","cursor-pointer","hover:text-[var(--light-usage-text-color-text-0,#1c1f23)]","hover:bg-[var(--light-usage-fill-color-fill-0,rgba(46,50,56,5%))]",n&&"text-[var(--light-usage-text-color-text-0,#1c1d23)] bg-[var(--light-usage-fill-color-fill-0,rgba(46,47,56,5%))]"]),children:[(0,s.jsx)(S.Iqn,{}),t]})},eE=r("367275"),eT=e=>{var[t,{setFalse:r,setTrue:n}]=(0,L.Z)(!1);return(0,s.jsx)(M.zx,(0,v._)((0,m._)({onMouseEnter:()=>{n()},onMouseLeave:()=>{r()}},e),{className:T()(eE.Z["database-added"],{[eE.Z["added-mousein"]]:t}),children:t?h.o.t("Remove"):h.o.t("Added")}))},eI=e=>{var{icon:t,title:r,description:n,isAdd:o,onClick:i,onAdd:l,onRemove:a}=e,d=()=>{if(o){null==a||a();return}null==l||l()};return(0,s.jsxs)("div",{onClick:i,className:"flex flex-row items-center p-[16px] border-t-0 border-l-0 border-r-0 border-b-[1px] border-solid coz-stroke-primary last:border-b-0 cursor-pointer",children:[(0,s.jsx)("img",{src:t,className:"w-[36px] h-[36px] rounded-[8px]"}),(0,s.jsxs)("div",{className:"flex flex-col ml-[12px] min-w-0 flex-grow",children:[(0,s.jsx)("p",{className:"text-[14px] font-medium leading-[20px] coz-fg-primary mb-[4px]",children:r}),(0,s.jsx)(M.ZT.Text,{ellipsis:{showTooltip:{opts:{content:n}}},className:"text-[12px] leading-[16px] coz-fg-secondary truncate !max-w-[680px]",children:n})]}),(0,s.jsx)("div",{className:"ml-[16px]",children:o?(0,s.jsx)(eT,{onClick:e=>{e.stopPropagation(),d()}}):(0,s.jsx)(M.zx,{"data-testid":"bot.database.add.modal.add.button",className:T()("w-[53px] flex justify-center items-center",eE.Z["database-add"]),onClick:e=>{e.stopPropagation(),d()},children:h.o.t("Add_2")})})]})},eP=e=>{var t,r,{visible:n,onClose:o,onAddDatabase:i,onRemoveDatabase:l,onClickDatabase:a,onCreateDatabase:u,enterFrom:_,botId:f,spaceId:g,workflowAddList:y=[],projectID:j,tips:w}=e,C=(0,h.D)(),k=c.Z.useUserInfo(),N=(0,d.useRef)(null),[S,E]=(0,d.useState)(j?"project":"library"),[I,P]=(0,d.useState)(!1),[A,D]=(0,d.useState)(!0),[L,O]=(0,d.useState)("all"),[Z,F]=(0,d.useState)("create_time"),[R,V]=(0,d.useState)(""),[U,H]=(0,d.useState)({tableId:"",name:"",desc:"",icon_uri:"",readAndWriteMode:B.mx.LimitedReadWrite,tableMemoryList:[]}),[W,G]=(0,d.useState)(!1);var K=(t=(0,p._)(function*(e){var{key_word:t,filter_creator:r,page_offset:n,sort_by:o}=e,i=yield b.v6.ListDatabase((0,v._)((0,m._)({},"project"===S?{project_id:j}:{}),{bot_id:"bot"===_?f:"0",space_id:g,table_type:"bot"===_?B.Nd.DraftTable:B.Nd.OnlineTable,table_name:t,creator_id:"all"===r?"0":r,limit:50,offset:n,order_by:[{field:o,direction:B.Sr.Desc}]}));return{list:i.database_info_list||[],nextOffset:n+1,total:i.total_count,hasMore:i.has_more}}),function(e){return t.apply(this,arguments)}),{loading:J,data:q,loadingMore:$,reload:X}=(0,eb.Z)(e=>K({key_word:R,filter_creator:L,page_offset:(null==e?void 0:e.nextOffset)||0,sort_by:Z}),{manual:!0,isNoMore:e=>!!(!(null==e?void 0:e.total)||!e.hasMore),reloadDeps:[R,L,Z,S,j],target:N}),Y=()=>{if(!!N.current){var{scrollTop:e,scrollHeight:t,clientHeight:r}=N.current;t-(e+r)<1?D(!1):D(!0)}},Q=e=>{i&&e.id&&(null==i||i(e.id,X))},ee=e=>{l&&e.id&&(null==l||l(e.id,X))},et=e=>{a&&e.id&&(null==a||a(e.id))},er=e=>{"template"===e?H((0,v._)((0,m._)({},U),{name:"reading_notes",desc:"for saving reading notes",readAndWriteMode:B.mx.LimitedReadWrite,extra_info:{prompt_disabled:"true"},tableMemoryList:[{name:"name",desc:"",type:1,must_required:!0},{name:"section",desc:"",type:2,must_required:!0},{name:"note",desc:"",type:1,must_required:!0}]})):H({tableId:"",name:"",desc:"",readAndWriteMode:B.mx.LimitedReadWrite,tableMemoryList:[]}),G(!0)},en=()=>(0,s.jsxs)("div",{className:eE.Z["tips-wrapper"],children:[(0,s.jsxs)("div",{className:eE.Z["tip-title"],children:[h.o.t("db2_018"),":"]}),(0,s.jsxs)("p",{className:"my-[8px]",children:["\uD83D\uDCA1 ",(0,s.jsxs)("em",{className:eE.Z["tip-desc"],children:[h.o.t("db2_019"),":"]})]}),(0,s.jsx)(M.Ee,{height:136,src:"zh-CN"===C?eN:ek}),(0,s.jsxs)("div",{className:eE.Z["tip-title"],children:[h.o.t("db2_020"),":"]}),(0,s.jsxs)("div",{className:eE.Z["bot-bg"],children:[(0,s.jsxs)("div",{className:T()(eE.Z["bot-item"],"mb-[12px]"),children:[(0,s.jsx)("div",{className:T()(eE.Z["bot-img"],eE.Z["img-user"]),children:h.o.t("db2_021")}),(0,s.jsx)("div",{className:T()(eE.Z["bot-content"],eE.Z["content-user"]),children:h.o.t("db2_022")})]}),(0,s.jsxs)("div",{className:eE.Z["bot-item"],children:[(0,s.jsx)("div",{className:T()(eE.Z["bot-img"],eE.Z["img-bot"]),children:h.o.t("db2_023")}),(0,s.jsx)("div",{className:T()(eE.Z["bot-content"],eE.Z["content-bot"]),children:h.o.t("db2_024")})]})]})]}),eo=()=>(0,s.jsx)(x.II,{placeholder:h.o.t("db2_014"),className:"w-full",value:R,onChange:(0,ey.Z)(e=>{V(e)},500)}),ei=()=>(0,s.jsx)("div",{className:"flex flex-row items-center w-full justify-between pr-[12px]",children:(0,s.jsxs)("div",{className:T()(eE.Z.select,"flex flex-row flex-1"),children:[(0,s.jsx)("div",{className:"flex flex-row items-center",children:(0,s.jsxs)(x.Ph,{showArrow:!0,size:"default",className:"border-none ml-[4px] hover:border-none bg-transparent outline-none",value:L,onChange:e=>O(e),insetLabel:(0,s.jsx)("p",{className:eE.Z.label,children:h.o.t("db2_009")}),children:[(0,s.jsx)(x.Ph.Option,{value:"all",label:h.o.t("db2_010")}),k?(0,s.jsx)(x.Ph.Option,{value:k.user_id_str,label:k.name},k.user_id_str):null]})}),(0,s.jsx)("div",{className:"flex flex-row items-center ml-[12px]",children:(0,s.jsxs)(x.Ph,{showArrow:!0,size:"default",className:"border-none ml-[4px] hover:border-none bg-transparent outline-none",value:Z,onChange:e=>F(e),insetLabel:(0,s.jsx)("p",{className:eE.Z.label,children:h.o.t("db2_011")}),children:[(0,s.jsx)(x.Ph.Option,{value:"create_time",label:h.o.t("db2_012")}),(0,s.jsx)(x.Ph.Option,{value:"update_time",label:h.o.t("db2_013")})]})})]})}),el=()=>(0,s.jsxs)("div",{className:"overflow-y-auto relative h-full",ref:N,onScroll:Y,children:[null==q?void 0:q.list.map((e,t)=>(0,s.jsx)(eI,{icon:e.icon_url,title:e.table_name,description:e.table_desc,isAdd:"workflow"===_?!!(e.id&&(null==y?void 0:y.length)&&(null==y?void 0:y.includes(e.id))):!!e.is_added_to_bot,onClick:()=>et(e),onAdd:()=>Q(e),onRemove:()=>ee(e)},t)),$?(0,s.jsxs)("div",{className:eE.Z["loading-more"],children:[(0,s.jsx)(ew.Z,{spin:!0,style:{marginRight:"4px"}}),(0,s.jsx)("div",{children:h.o.t("Loading")})]}):null]}),ea=()=>(0,s.jsx)("div",{className:"overflow-y-auto relative w-full h-full flex justify-center items-center",children:(0,s.jsx)(x.HY,{image:(0,s.jsx)(ej.ts,{style:{width:150,height:150}})})}),es=()=>{o()},ed=e=>{es();var t,{id:r,draft_id:n}=null!==(t=e.database_info)&&void 0!==t?t:{};r&&n&&(null==u||u(r,n))};var ec=(r=(0,p._)(function*(){var e,t,r=yield b.MJ.GetIcon({format_type:eC.a5.Database});(null===(e=r.icon)||void 0===e?void 0:e.uri)&&H((0,v._)((0,m._)({},U),{icon_uri:null===(t=r.icon)||void 0===t?void 0:t.uri}))}),function(){return r.apply(this,arguments)});(0,d.useEffect)(()=>{n&&(X(),ec())},[n]);var{modal:eu,open:ep,close:em}=eg({projectID:j,enterFrom:"library",onFinish:(e,t)=>{em(),null==u||u(e,t)}}),ev=()=>(0,s.jsxs)(s.Fragment,{children:[w,(0,s.jsx)(x.yC,{spinning:J,wrapperClassName:T()(["overflow-hidden",eE.Z.list]),children:(null==q?void 0:q.list.length)!==0?el():ea()}),A?(0,s.jsx)("div",{className:T()(eE.Z["bottom-shadow"],"w-full h-[80px] absolute left-0 bottom-0","pointer-events-none")}):null]});return{renderDatabase:()=>(0,s.jsxs)(d.Fragment,{children:[eu,(0,s.jsx)(M.FS,{closable:!0,visible:n,onCancel:es,header:h.o.t("db2_025"),filter:ei(),sider:(0,s.jsxs)(M.yh,{className:"!pt-[16px]",children:[(0,s.jsxs)(M.yh.Header,{className:"mb-[16px] gap-[12px]",children:[eo(),(0,s.jsx)(x.Lt,{trigger:"custom",visible:I,render:(0,s.jsxs)(x.Lt.Menu,{className:"w-[196px]",children:[(0,s.jsx)(x.Lt.Item,{className:"!pl-[8px]",onClick:()=>{P(!1),ep()},children:h.o.t("db2_015")}),(0,s.jsx)(x.Lt.Item,{className:"!pl-[8px] [&_.coz-item-text]:w-full",onClick:()=>{P(!1),er("template")},children:(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:h.o.t("db2_016")}),(0,s.jsx)(x.J2,{style:{maxWidth:"460px",backgroundColor:"var(--Bg-COZ-bg-max, #363D4D)",boxShadow:"0 4px 12px 0 rgba(0, 0, 0, 8%), 0 8px 24px 0 rgba(0, 0, 0, 4%)"},trigger:"hover",content:en(),zIndex:9999,showArrow:!0,children:(0,s.jsx)(x.Vp,{color:"primary",size:"small",className:"ml-[8px]",children:h.o.t("db2_017")})})]})})]}),onClickOutSide:()=>{P(!1)},children:(0,s.jsx)(x.zx,{color:"brand",iconPosition:"right",icon:(0,s.jsx)(z.Wdl,{}),onClick:()=>P(!0),children:h.o.t("db_add_table_title")})})]}),(0,s.jsxs)(M.yh.Content,{className:"flex flex-col gap-[4px]",children:[(0,s.jsx)(eS,{label:h.o.t("project_resource_modal_library_resources",{resource:h.o.t("resource_type_database")}),onClick:()=>{E("library")},selected:"library"===S}),j?(0,s.jsx)(eS,{label:h.o.t("project_resource_modal_project_resources",{resource:h.o.t("resource_type_database")}),onClick:()=>{E("project")},selected:"project"===S}):null]})]}),content:(0,s.jsx)(M.vy,{className:"relative px-[12px] gap-[16px]",children:ev()})}),(0,s.jsx)(eh,{visible:W,onClose:()=>G(!1),onReturn:()=>G(!1),onSubmit:ed,showDatabaseBaseInfo:!0,onlyShowDatabaseInfoRWMode:!1,initValue:U,extraParams:{botId:f,spaceId:g,creatorId:null==k?void 0:k.user_id_str}})]}),renderContent:ev,renderInput:eo,renderFilter:ei}},eA=e=>{var{renderDatabase:t}=eP(e);return(0,s.jsx)(s.Fragment,{children:t()})},eD=r("157728"),eL=r("997516");var eO=((l={}).Structure="structure",l.Draft="draft",l.Online="online",l),eZ=()=>(0,s.jsx)(s.Fragment,{});(0,x.Q2)(eZ,{valueKey:"value",onKeyChangeFnName:"onChange"});var eF=()=>(0,s.jsx)(s.Fragment,{}),eM=r("40009"),ez=r("955751");function eR(e){var{loading:t,fieldList:r}=e,n=[{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_name"),tip:(0,s.jsxs)("article",{className:"w-[494px]",children:[(0,s.jsx)("p",{className:"mb-[8px]",children:h.o.t("db_add_table_field_name_tips")}),(0,s.jsx)(x.Ee,{preview:!1,width:494,height:163,src:eM})]})}),dataIndex:"name",width:261},{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_desc"),tip:(0,s.jsx)("article",{className:"w-[327px]",children:h.o.t("db_add_table_field_desc_tips")})}),dataIndex:"desc"},{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_type"),tip:(0,s.jsx)("article",{className:"w-[327px]",children:h.o.t("db_add_table_field_type_tips")})}),dataIndex:"type",width:214,render:(e,t)=>{var r,n;return null!==(n=null===(r=$.find(e=>e.value===t.type))||void 0===r?void 0:r.label)&&void 0!==n?n:t.type}},{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_necessary"),tip:(0,s.jsxs)("article",{className:"w-[327px]",children:[(0,s.jsx)("p",{children:h.o.t("db_add_table_field_necessary_tips1")}),(0,s.jsx)("p",{children:h.o.t("db_add_table_field_necessary_tips2")})]})}),dataIndex:"must_required",width:108,render:(e,t)=>h.o.t(t.must_required?"db_optimize_037":"db_optimize_038")}],o=et.concat(r),[i,l]=(0,d.useState)(0),a=(0,d.useRef)(null);return(0,d.useEffect)(()=>{var e=new ResizeObserver(e=>{for(var t of e)t.target===a.current&&l(t.contentRect.height)});return a.current&&e.observe(a.current),()=>e.disconnect()},[]),(0,s.jsx)("div",{className:"h-full mt-[8px]",ref:a,children:(0,s.jsx)(x.iA,{tableProps:{loading:t,columns:n,dataSource:o,scroll:{y:i>40?i-40:"auto"}},className:ez.Z["table-structure-wrapper"]})})}var eB=r("735114"),eV=r("479886"),eU=r.n(eV),eH=BigInt("9223372036854775807"),eW=BigInt("-9223372036854775808"),eG=e=>{if(""===e||null==e||Number.isNaN(e))return!1;try{var t=BigInt(e);if(t>eH||t<eW)return!1;return!0}catch(e){return!1}},eK={0x9896f2:"10000120",0x9896f3:"10000121"};function eJ(){var e,t,{includeMigrated:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{space_id:n}=(0,eD.useParams)(),[o]=(0,eD.useSearchParams)(),i=null!==(e=null!=n?n:o.get("space_id"))&&void 0!==e?e:"",{data:l}=(0,eB.Z)((0,p._)(function*(){var e=(yield b.v6.GetConnectorName({SpaceId:i,Version:"inhouse",ListAll:!0})).ConnectorList;return null==e?void 0:e.map(t=>{var r,n,o,i=null!==(n=null===(r=t.ConnectorID)||void 0===r?void 0:r.toString())&&void 0!==n?n:"";if(eK[i]){var l=e.find(e=>{var t;return(null===(t=e.ConnectorID)||void 0===t?void 0:t.toString())===eK[i]});if(null==l?void 0:l.ConnectorName)return{label:l.ConnectorName,value:i,migrated:!0}}return{label:null!==(o=t.ConnectorName)&&void 0!==o?o:"",value:i}})}),{refreshDeps:[i],cacheKey:"db_connector_name_".concat(i)});return null!==(t=r?l:null==l?void 0:l.filter(e=>!e.migrated))&&void 0!==t?t:[]}var eq=(0,x.Q2)(x.Kx),e$=(0,x.Q2)(x.k7),eX=(0,x.Q2)(e=>(0,s.jsx)(x.Mt,(0,v._)((0,m._)({},e),{type:"dateTime",format:"yyyy-MM-dd HH:mm:ss",onChange:t=>{var r;return null===(r=e.onChange)||void 0===r?void 0:r.call(e,eU()(t).format("YYYY-MM-DD HH:mm:ss"))}}))),eY=(0,x.Q2)(x.Ph);function eQ(e){return Object.fromEntries(Object.values(e).map(e=>{var t,r;return[e.fieldName,null!==(r=null===(t=e.value)||void 0===t?void 0:t.toString())&&void 0!==r?r:""]}))}function e0(e){var{visible:t,fields:r,tableType:n,initialValues:o,onSubmit:i,onCancel:l}=e,a="object"!=typeof o,[c,u]=(0,d.useState)(!1),_=(0,d.useRef)(null);(0,d.useEffect)(()=>{if(t&&o){var e,r;null===(r=_.current)||void 0===r||null===(e=r.formApi)||void 0===e||e.setValues(eQ(o))}},[t,o]);var f=eJ();return(0,s.jsx)(x.u_,{visible:t,title:h.o.t(a?"db_optimize_022":"db_optimize_023"),okText:h.o.t(a?"db_optimize_025":"db_edit_save"),okButtonProps:{loading:c},onOk:(0,p._)(function*(){u(!0);try{var e,t,r,n,l=yield null===(r=_.current)||void 0===r?void 0:null===(t=r.formApi)||void 0===t?void 0:t.validate();if(l){;yield i(Object.assign(o?eQ(o):{},(e=l,Object.fromEntries(Object.entries(e).map(e=>{var t,[r,n]=e;return[r,null!==(t=null==n?void 0:n.toString())&&void 0!==t?t:""]})))),null==o?void 0:null===(n=o.bstudio_connector_id)||void 0===n?void 0:n.value)}}finally{u(!1)}}),cancelText:h.o.t("db_optimize_024"),onCancel:()=>{var e,t;l(),null===(t=_.current)||void 0===t||null===(e=t.formApi)||void 0===e||e.reset()},children:(0,s.jsxs)(x.l0,{allowEmpty:!0,ref:_,children:[n===B.Nd.OnlineTable?(0,s.jsx)(eY,(0,v._)((0,m._)({},function(e){var t,r;return{key:e.name,field:null!==(r=er[null!==(t=e.name)&&void 0!==t?t:""])&&void 0!==r?r:"",label:(0,s.jsx)(en,{field:e.name,textType:"primary",type:e.type,tip:e.desc,required:!0})}}(ee)),{optionList:f,className:"w-full"})):null,r.map(e=>{var t=function(e){return{key:e.fieldName,field:e.fieldName,rules:[{required:e.required}],label:{text:(0,s.jsx)(en,{field:e.fieldName,textType:"primary",type:e.type,tip:e.fieldDescription,required:e.required}),required:!1}}}(e);switch(e.type){case q.wp.Text:return(0,s.jsx)(eq,(0,v._)((0,m._)({},t),{autosize:{minRows:1,maxRows:5}}));case q.wp.Number:return(0,s.jsx)(x.l0.Input,(0,v._)((0,m._)({},t),{className:T()("w-full","[&_.semi-input-wrapper]:coz-stroke-plus","focus-within:[&_.semi-input-wrapper]:coz-stroke-hglt","[&_.semi-input-wrapper.semi-input-wrapper-error]:coz-stroke-hglt-red"),validate:e=>{var t;return eG(null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:"")?"":"invalid Integer"}}));case q.wp.Date:return(0,s.jsx)(eX,(0,v._)((0,m._)({},t),{className:T()("w-full","[&_.semi-datepicker-input]:w-full","[&_.coz-date-picker-select]:w-full","[&[aria-invalid]_.coz-date-picker-select]:coz-stroke-hglt-red")}));case q.wp.Float:return(0,s.jsx)(e$,(0,v._)((0,m._)({},t),{className:T()("w-full","[&_.semi-input-wrapper]:coz-stroke-plus","focus-within:[&_.semi-input-wrapper]:coz-stroke-hglt","[&_.semi-input-wrapper.semi-input-wrapper-error]:coz-stroke-hglt-red"),validate:e=>Number.isNaN(e)||Math.abs(e)===1/0?"invalid Float":""}));case q.wp.Boolean:return(0,s.jsx)(eY,(0,v._)((0,m._)({},t),{optionList:[{value:"true",label:"true"},{value:"false",label:"false"}],className:"w-full"}));default:return null}})]})})}var e1=e=>"column-selection"===e.key?(0,v._)((0,m._)({},e),{resizable:!1,width:60}):e.fixed?(0,v._)((0,m._)({},e),{resizable:!1}):(0,v._)((0,m._)({},e),{width:100>Number(e.width)?100:Number(e.width)}),e2=r("537714"),e4=r("47522"),e5=r("771242");function e6(e){var t,{databaseId:r,tableType:n,unitList:o,onUnitListChange:i}=e;(0,d.useEffect)(()=>{i(o)},[i,o]);var l=(t=(0,p._)(function*(){var e=yield b.v6.GetDatabaseTemplate({database_id:r,table_type:n});e.TosUrl&&window.open(e.TosUrl,"_blank")}),function(){return t.apply(this,arguments)});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e5.p,{unitList:o,setUnitList:i,onFinish:i,limit:1,multiple:!1,accept:".csv,.xlsx",maxSizeMB:20,showRetry:!1,dragMainText:h.o.t("datasets_createFileModel_step2_UploadDoc"),dragSubText:h.o.t("datasets_unit_update_exception_tips3"),action:"",className:T()("[&_.semi-upload-drag-area]:!h-[290px]",{hidden:o.length>0}),showIllustration:!1}),(0,s.jsxs)(x.ZT.Paragraph,{type:"secondary",className:T()("mt-[8px]",{hidden:o.length>0}),children:[h.o.t("db_optimize_018"),(0,s.jsx)(x.ZT.Text,{link:!0,className:"ml-[8px]",onClick:l,children:h.o.t("db_optimize_019")})]}),(0,s.jsx)(e5.nC,{edit:!1,type:e2.Cm.TABLE_DOC,unitList:o,onChange:i,disableRetry:!0,getColumns:(e,t)=>({actions:[(0,s.jsx)(e4.Zq,{record:e,index:t,params:{unitList:o,onChange:i,type:e2.Cm.TABLE_DOC,edit:!1}})]})})]})}var e3=r("561119"),e8=r("298203"),e9={[e3.N.Processing]:"datasets_createFileModel_step4_processing",[e3.N.Complete]:"datasets_createFileModel_step4_Finish",[e3.N.Failed]:"datasets_createFileModel_step4_failed"};function e7(e){var{databaseId:t,tableType:r,fileItem:n,tableSheet:o,connectorId:i}=e,l=(0,d.useMemo)(()=>{var e,t;return(0,e8.td)(null!==(t=null===(e=n.fileInstance)||void 0===e?void 0:e.size)&&void 0!==t?t:0)},[n]),[a,c]=(0,d.useState)({mainText:n.name,subText:l,tipText:l,percent:10,status:e3.N.Processing}),{run:u,cancel:p}=(0,eB.Z)(()=>b.v6.DatabaseFileProgressData({database_id:t,table_type:r}),{manual:!0,pollingInterval:3e3,onSuccess:e=>{var{data:t}=e;if(t){if(t.status_descript){var r=t.status_descript;c(e=>(0,v._)((0,m._)({},e),{subText:r,tipText:r,status:e3.N.Failed})),p()}else c(e=>{var r;return(0,v._)((0,m._)({},e),{percent:null!==(r=t.progress)&&void 0!==r?r:0})}),100===t.progress&&(c(e=>(0,v._)((0,m._)({},e),{status:e3.N.Complete,actions:[h.o.t("datasets_unit_process_success")]})),p())}}});return(0,d.useEffect)(()=>{b.v6.SubmitDatabaseInsertTask({database_id:t,table_type:r,file_uri:n.uri,table_sheet:o,connector_id:i}).finally(()=>{u()})},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-[32px] leading-[32px] mb-[8px]",children:(0,s.jsx)(x.ZT.Text,{fontSize:"14px",weight:500,children:h.o.t(e9[a.status])})}),(0,s.jsx)(e5.vS,(0,v._)((0,m._)({avatar:(0,s.jsx)(z.$lV,{})},a),{className:"[&_.process-progress-item-actions]:!block"}))]})}var te=r("392902"),tt=r("672958"),tr=r("594022"),tn=r("532267");function to(e){var t,r,n,o,{databaseId:i,tableFields:l,fileUri:a,tableSheet:c}=e,[u,p]=(0,d.useState)(),m=(0,d.useMemo)(()=>l.map((e,t)=>({column_name:e.fieldName,column_type:function(e){switch(e){case tn.wp.Text:return tr.QD.Text;case tn.wp.Number:return tr.QD.Number;case tn.wp.Date:return tr.QD.Date;case tn.wp.Float:return tr.QD.Float;case tn.wp.Boolean:return tr.QD.Boolean;default:return tr.QD.Text}}(e.type),desc:e.fieldDescription,sequence:"".concat(t),is_semantic:!1,id:"".concat(t)})),[l]),{loading:v}=(0,eB.Z)(()=>b.v6.GetTableSchema({database_id:i,source_file:{tos_uri:a},table_data_type:tt.n.OnlyPreview,table_sheet:c}),{onSuccess:e=>{var t,r=null==c?void 0:c.sheet_id;r&&p({sheet_list:e.sheet_list,table_meta:{[r]:m},preview_data:{[r]:null!==(t=e.preview_data)&&void 0!==t?t:[]}})}});return!v&&u&&c?(0,s.jsx)(te.IO,{data:u,settings:{sheet_id:Number.parseInt(null!==(r=null==(t=c)?void 0:t.sheet_id)&&void 0!==r?r:"0"),header_line_idx:Number.parseInt(null!==(n=null==t?void 0:t.header_line_idx)&&void 0!==n?n:"0"),start_line_idx:Number.parseInt(null!==(o=null==t?void 0:t.start_line_idx)&&void 0!==o?o:"0")}}):(0,s.jsx)(x.yC,{size:"large",wrapperClassName:"w-full h-[288px]"})}function ti(e){var t,r,n,o,i,l;return{sheet_id:null!==(o=null==e?void 0:null===(t=e.sheet_id)||void 0===t?void 0:t.toString())&&void 0!==o?o:"",header_line_idx:null!==(i=null==e?void 0:null===(r=e.header_line_idx)||void 0===r?void 0:r.toString())&&void 0!==i?i:"",start_line_idx:null!==(l=null==e?void 0:null===(n=e.start_line_idx)||void 0===n?void 0:n.toString())&&void 0!==l?l:""}}function tl(e){var{databaseId:t,tableType:r,tableFields:n,fileUri:o,onTableSheetChange:i}=e,[l,a]=(0,d.useState)(),[c,u]=(0,d.useState)({sheet_id:0,header_line_idx:0,start_line_idx:1}),[p,m]=(0,d.useState)([]),{loading:v}=(0,eB.Z)(()=>b.v6.GetTableSchema({database_id:t,source_file:{tos_uri:o},table_data_type:tt.n.OnlySchema,table_sheet:ti(c)}),{refreshDeps:[o,c],onSuccess:e=>{a({sheet_list:e.sheet_list,preview_data:{}}),e.table_meta&&m(e.table_meta.map(e=>{var t,r,o=n.find(t=>t.fieldName===e.column_name);return null!=o?o:{fieldName:null!==(t=e.column_name)&&void 0!==t?t:"-",fieldDescription:null!==(r=e.desc)&&void 0!==r?r:"-",type:function(e){switch(e){case g.QD.Text:return q.wp.Text;case g.QD.Number:return q.wp.Number;case g.QD.Date:return q.wp.Date;case g.QD.Float:return q.wp.Float;case g.QD.Boolean:return q.wp.Boolean;default:return q.wp.Text}}(e.column_type),required:!1}}))}});return(0,d.useEffect)(()=>{b.v6.ValidateTableSchema({database_id:t,source_file:{tos_uri:o},table_type:r,table_sheet:ti(c)}).then(e=>{e.schema_valid_result?i():i(ti(c))}).catch(()=>{i()})},[c]),l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(te.tM,{data:l,tableSettings:c,setTableSettings:u}),(0,s.jsx)(x.iA,{tableProps:{loading:v,columns:function(){return[{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_name")}),render:(e,t)=>t.fieldName},{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_desc")}),render:(e,t)=>t.fieldDescription},{title:(0,s.jsx)(en,{field:h.o.t("db_add_table_field_type")}),render:(e,t)=>{var r,n;return null!==(n=null===(r=$.find(e=>e.value===t.type))||void 0===r?void 0:r.label)&&void 0!==n?n:"-"}}]}(),dataSource:p},className:T()("[&_.semi-table-row-head]:!border-b-[1px]","[&_.semi-table-row-cell]:!h-[56px]","[&_.semi-table-row-cell]:!border-b-0","[&_.semi-table-row-cell]:!bg-none","[&_.semi-table-row-cell]:!bg-transparent")})]}):(0,s.jsx)(x.yC,{size:"large",wrapperClassName:"w-full h-[288px]"})}var ta=((a={})[a.Upload=0]="Upload",a[a.Config=1]="Config",a[a.Preview=2]="Preview",a[a.Process=3]="Process",a);function ts(e){var{step:t}=e;return(0,s.jsxs)(x.Rg,{type:"basic",hasLine:!1,current:t,className:T()("my-[24px] justify-center","[&_.semi-steps-item]:flex-none","[&_.semi-steps-item-title]:!max-w-[unset]"),children:[(0,s.jsx)(x.Rg.Step,{title:h.o.t("db_optimize_014")}),(0,s.jsx)(x.Rg.Step,{title:h.o.t("db_optimize_015")}),(0,s.jsx)(x.Rg.Step,{title:h.o.t("db_optimize_016")}),(0,s.jsx)(x.Rg.Step,{title:h.o.t("db_optimize_017")})]})}function td(e){var{visible:t,databaseId:r,tableFields:n,tableType:o,connectorId:i,onClose:l,onComplete:a}=e,[c,u]=(0,d.useState)(ta.Upload),[p,m]=(0,d.useState)([]),[v,_]=(0,d.useState)(),f=()=>{u(ta.Upload),m([]),_(void 0)};return(0,s.jsxs)(x.u_,{visible:t,title:h.o.t("db_optimize_013"),onCancel:l,width:1120,className:"[&_.semi-modal-content]:min-h-[520px]",footer:(0,s.jsx)(s.Fragment,{children:c!==ta.Process?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.zx,{color:"primary",disabled:c===ta.Upload,onClick:()=>u(c-1),children:h.o.t("db_optimize_020")}),(0,s.jsx)(x.zx,{disabled:(()=>{switch(c){case ta.Upload:return p.length<=0||p.some(e=>e.status!==e2.Dm.SUCCESS);case ta.Config:return!v;case ta.Preview:case ta.Process:default:return!1}})(),onClick:()=>u(c+1),children:h.o.t("db_optimize_021")})]}):(0,s.jsx)(x.zx,{onClick:()=>{null==l||l(),null==a||a(),f()},children:h.o.t("db2_004")})}),children:[(0,s.jsx)(ts,{step:c}),c===ta.Upload?(0,s.jsx)(e6,{databaseId:r,tableType:o,unitList:p,onUnitListChange:m}):null,c===ta.Config?(0,s.jsx)(tl,{databaseId:r,tableFields:n,tableType:o,fileUri:p[0].uri,onTableSheetChange:_}):null,c===ta.Preview?(0,s.jsx)(to,{databaseId:r,tableFields:n,fileUri:p[0].uri,tableSheet:v}):null,c===ta.Process?(0,s.jsx)(e7,{databaseId:r,tableType:o,fileItem:p[0],tableSheet:v,connectorId:i}):null]})}function tc(e){var{readonly:t,databaseId:r,tableType:n,tableFields:o,onNewRow:i,onRefresh:l}=e,[a,c]=(0,d.useState)(!1),[u,m]=(0,d.useState)(!1),[v,_]=(0,d.useState)(),f=eJ(),g=e=>{c(!1),m(!0),_(e)};return(0,s.jsxs)("div",{className:"flex gap-[8px] mt-[8px] mb-[12px]",children:[(0,s.jsx)(x.zx,{color:"secondary",icon:(0,s.jsx)(S.PwN,{className:t?"":"coz-fg-hglt"}),disabled:t,onClick:i,children:(0,s.jsx)("span",{className:t?"":"coz-fg-hglt",children:h.o.t("db_optimize_022")})}),n===B.Nd.DraftTable?(0,s.jsx)(x.zx,{color:"secondary",icon:(0,s.jsx)(S.nBN,{}),disabled:t,onClick:()=>g(),children:h.o.t("db_optimize_013")}):(0,s.jsx)(x.Lt,{trigger:"custom",visible:a,onClickOutSide:()=>c(!1),position:"bottomLeft",render:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.Lt.Title,{className:"pl-[32px] border-0 border-b border-solid coz-stroke-primary",children:h.o.t("database_optimize_100")}),(0,s.jsx)("div",{className:"min-w-[170px] max-h-[220px] overflow-auto",children:(0,s.jsx)(x.Lt.Menu,{children:f.map(e=>(0,s.jsx)(x.Lt.Item,{onClick:()=>g(e.value),children:e.label},e.value))})})]}),children:(0,s.jsxs)(x.zx,{color:"secondary",icon:(0,s.jsx)(S.nBN,{}),disabled:t,onClick:()=>c(!0),children:[(0,s.jsx)("span",{children:h.o.t("db_optimize_013")}),(0,s.jsx)(S.Wdl,{className:"ml-[4px]"})]})}),(0,s.jsx)("div",{className:"ml-auto"}),n===B.Nd.DraftTable?(0,s.jsx)(x.zx,{color:"secondary",icon:(0,s.jsx)(S.dVD,{}),disabled:t,onClick:()=>x.u_.confirm({title:h.o.t("dialog_240305_01"),content:h.o.t("dialog_240305_02"),okText:h.o.t("dialog_240305_03"),okButtonColor:"red",cancelText:h.o.t("dialog_240305_04"),onOk:(0,p._)(function*(){yield b.v6.ResetBotTable({database_info_id:r,table_type:n}),l()})}),children:h.o.t("db_optimize_011")}):null,(0,s.jsx)(x.zx,{color:"secondary",icon:(0,s.jsx)(S.mxP,{}),onClick:l,children:h.o.t("db_optimize_012")}),(0,s.jsx)(td,{visible:u,databaseId:r,tableFields:o,tableType:n,connectorId:v,onClose:()=>m(!1),onComplete:l})]})}var tu={id:200,sys_platform:180,uuid:260,bstudio_create_time:200};function tp(e){var t,{value:r}=e,n=null!==(t=null==r?void 0:r.toString())&&void 0!==t?t:"";return(0,s.jsx)(x.ZT.Text,{ellipsis:{showTooltip:{opts:{className:T()("[&_.semi-tooltip-content]:max-h-[110px]","[&_.semi-tooltip-content]:line-clamp-5")}}},children:n})}var tm=e=>{var{fieldList:t,connectorNames:r,isReadonlyMode:n,handleEditRow:o,handleDeleteRow:i}=e,l=[];return l.push(...et.map(e=>{var t,n,o;return{title:()=>(0,s.jsx)(en,{field:e.name,type:e.type,tip:e.desc,required:!0}),dataIndex:er[null!==(t=e.name)&&void 0!==t?t:""],width:null!==(o=tu[null!==(n=e.name)&&void 0!==n?n:""])&&void 0!==o?o:260,render:e=>{var t;return"bstudio_connector_id"===e.fieldName?(0,s.jsx)(x.ZT.Text,{ellipsis:!0,children:null!==(t=r[e.value])&&void 0!==t?t:e.value}):(0,s.jsx)(tp,{value:e.value})}}})),l.push(...t.map(e=>({title:()=>(0,s.jsx)(en,{field:e.fieldName,type:e.type,tip:e.fieldDescription,required:e.required}),dataIndex:e.fieldName,width:260,render:e=>(0,s.jsx)(tp,{value:null==e?void 0:e.value})}))),l.push({title:h.o.t("db_table_0126_021"),width:100,resize:!1,fixed:"right",render:(e,t,r)=>n?(0,s.jsxs)(x.T,{children:[(0,s.jsx)(x.hU,{disabled:!0,icon:(0,s.jsx)(S.JAz,{}),size:"small",color:"secondary"}),(0,s.jsx)(x.hU,{disabled:!0,icon:(0,s.jsx)(S.dVD,{}),size:"small",color:"secondary"})]}):(0,s.jsxs)(x.T,{children:[(0,s.jsx)(x.hU,{icon:(0,s.jsx)(S.JAz,{}),size:"default",color:"secondary",onClick:()=>o(t)}),(0,s.jsx)(x.gn,{title:h.o.t("db_optimize_026"),content:h.o.t("db_optimize_027"),okText:h.o.t("db_optimize_028"),okButtonColor:"red",cancelText:h.o.t("db_optimize_029"),onConfirm:()=>i(t),children:(0,s.jsx)(x.hU,{icon:(0,s.jsx)(S.dVD,{}),size:"default",color:"secondary"})})]})}),l};function tv(e){var{selectedCount:t=0,onDelete:r,onCancel:n}=e;return(0,s.jsxs)("div",{className:T()("flex items-center p-[8px] gap-[8px] rounded-[12px]","coz-bg-max border-solid coz-stroke-primary coz-shadow-default","fixed bottom-[8px] left-[50%] translate-x-[-50%] z-10",{hidden:t<=0}),children:[(0,s.jsx)(x.ZT.Text,{type:"secondary",children:h.o.t("db_optimize_031",{n:t})}),(0,s.jsx)(x.iz,{layout:"vertical"}),(0,s.jsx)(x.zx,{color:"red",icon:(0,s.jsx)(S.dVD,{}),onClick:r,children:h.o.t("db_optimize_030")}),(0,s.jsx)(x.iz,{layout:"vertical"}),(0,s.jsx)(x.hU,{color:"secondary",icon:(0,s.jsx)(S.rmE,{}),onClick:n})]})}var t_=r("873688");function tf(e){var t,r,{databaseId:n,tableType:o,tableFields:i,isReadonlyMode:l,enterFrom:a,onAfterEditRecords:c}=e,u=(0,d.useMemo)(()=>i.map(e=>{var t,r,n,o;return{fieldName:null!==(t=e.name)&&void 0!==t?t:"",fieldDescription:null!==(r=e.desc)&&void 0!==r?r:"",required:null!==(n=e.must_required)&&void 0!==n&&n,type:null!==(o=e.type)&&void 0!==o?o:q.wp.Text}}),[i]),[v,_]=(0,d.useState)(20),[f,g]=(0,d.useState)(1),[y,j]=(0,d.useState)(0),[w,C]=(0,d.useState)([]),{loading:k,refresh:N}=(0,eB.Z)(()=>b.v6.ListDatabaseRecords({database_id:n,table_type:o,offset:(f-1)*v,limit:v}),{onSuccess:e=>{j(e.TotalNum),C(e.data)},refreshDeps:[n,o,v,f]}),S=(0,d.useMemo)(()=>{var e;return e=u,w.map(t=>{var r=Object.keys(t),n={};return r.forEach(r=>{var o=e.find(e=>e.fieldName===r);if(!o){n[r]={fieldName:r,type:q.wp.Text,required:!0,value:t[r]};return}switch(o.type){case q.wp.Boolean:n[r]={fieldName:r,value:t[r],type:q.wp.Boolean,required:o.required};break;case q.wp.Number:n[r]={fieldName:r,value:t[r],type:q.wp.Number,required:o.required};break;case q.wp.Date:n[r]={fieldName:r,value:t[r],type:q.wp.Date,required:o.required};break;case q.wp.Float:n[r]={fieldName:r,value:t[r],type:q.wp.Float,required:o.required};break;case q.wp.Text:n[r]={fieldName:r,value:t[r],type:q.wp.Text,required:o.required}}}),n})},[u,w]),E=()=>{N(),null==c||c()},I=eJ({includeMigrated:!0}),P=(0,d.useMemo)(()=>Object.fromEntries(I.map(e=>[e.value,e.label])),[I]),[A,D]=(0,d.useState)([]),[L,O]=(0,d.useState)(!1),[Z,F]=(0,d.useState)(),M=e=>{F(e),O(!0)};var z=(t=(0,p._)(function*(e,t){t?yield b.v6.UpdateDatabaseRecords({database_id:n,table_type:o,record_data_alter:[e],ori_connector_id:t}):yield b.v6.UpdateDatabaseRecords({database_id:n,table_type:o,record_data_add:[e]}),O(!1),F(void 0),E()}),function(e,r){return t.apply(this,arguments)});var R=(r=(0,p._)(function*(e){yield b.v6.UpdateDatabaseRecords({database_id:n,table_type:o,record_data_delete:[{bstudio_id:e.bstudio_id.value}]}),E()}),function(e){return r.apply(this,arguments)}),B=(0,d.useMemo)(()=>tm({fieldList:u,isReadonlyMode:l,connectorNames:P,handleDeleteRow:R,handleEditRow:M}),[u,l,P]),[V,U]=(0,d.useState)(0),H=(0,d.useRef)(null);return(0,d.useEffect)(()=>{var e=new ResizeObserver(e=>{for(var t of e)t.target===H.current&&U(t.contentRect.height)});return H.current&&e.observe(H.current),()=>e.disconnect()},[]),(0,s.jsxs)("div",{className:t_.Z.table,ref:H,children:[(0,s.jsx)(tc,{readonly:l,databaseId:n,tableType:o,tableFields:u,onNewRow:()=>M(),onRefresh:N}),(0,s.jsx)(x.iA,{tableProps:{loading:k,columns:B,dataSource:S,rowSelection:{fixed:!0,selectedRowKeys:A.map(e=>{var t;return null===(t=e.bstudio_id)||void 0===t?void 0:t.value}),onChange:(e,t)=>D(null!=t?t:[])},resizable:{onResize:e1},rowKey:e=>{var t;return null==e?void 0:null===(t=e.bstudio_id)||void 0===t?void 0:t.value},scroll:{y:V>128?V-128:"auto"},pagination:{total:y,currentPage:f,pageSize:v,onChange:(e,t)=>{g(e),_(t),D([])}},renderPagination:e=>(0,s.jsxs)("div",{className:"w-full flex gap-[8px] items-center justify-end",children:[(0,s.jsx)(x.ZT.Text,{type:"secondary",fontSize:"12px",children:h.o.t("db_optimize_032",{n:y})}),(0,s.jsx)(x.iz,{layout:"vertical",className:"h-[16px]"}),(0,s.jsx)(x.U8,(0,m._)({size:"small",showSizeChanger:!0,pageSizeOpts:[20,50,100]},e))]})},wrapperClassName:T()(t_.Z["table-wrapper"],{[t_.Z["table-wrapper-project"]]:"project"===a}),empty:(0,s.jsx)(x.HY,{image:(0,s.jsx)(ej.ts,{className:"w-[140px] h-[140px]"}),title:h.o.t("timecapsule_0108_003")}),indexRowSelection:!0}),(0,s.jsx)(tv,{selectedCount:A.length,onDelete:()=>x.u_.confirm({title:h.o.t("db_optimize_026"),content:h.o.t("db_optimize_027"),okText:h.o.t("dialog_240305_03"),okButtonColor:"red",cancelText:h.o.t("dialog_240305_04"),onOk:(0,p._)(function*(){yield b.v6.UpdateDatabaseRecords({database_id:n,table_type:o,record_data_delete:A.map(e=>({bstudio_id:e.bstudio_id.value}))}),D([]),E()})}),onCancel:()=>D([])}),(0,s.jsx)(e0,{fields:u,visible:L,tableType:o,initialValues:Z,onSubmit:z,onCancel:()=>O(!1)})]})}var th=r("175706"),tx=e=>{var t,r,n,o,i,l,a,u,{version:_,enterFrom:f,initialTab:g,needHideCloseIcon:y=!1,addRemoveButtonText:j,onClose:C,onClickAddRemoveButton:E,onIDECallback:I,onAfterEditBasicInfo:A,onAfterEditRecords:D,databaseId:L}=e,O=null===(i=c.Z.useUserInfo())||void 0===i?void 0:i.user_id_str,[Z,F]=(0,d.useState)(!1),[M,z]=(0,d.useState)(!1),[R,V]=(0,d.useState)({}),[U,H]=(0,d.useState)(_?eO.Structure:null!=g?g:eO.Structure),[W,G]=(0,d.useState)(!1),[K,J]=(0,d.useState)(!0);var q=(t=(0,p._)(function*(){try{J(!0);var e,t,r,n,o=yield b.v6.GetDatabaseByID((0,m._)({id:L},_?{version:_}:{}));o.database_info?(V(o.database_info),o.database_info.table_name&&(null==I||null===(t=I.onUpdateDisplayName)||void 0===t||t.call(I,o.database_info.table_name),null==I||null===(r=I.onStatusChange)||void 0===r||r.call(I,"normal"))):null==I||null===(n=I.onStatusChange)||void 0===n||n.call(I,"error")}catch(t){null==I||null===(e=I.onStatusChange)||void 0===e||e.call(I,"error")}finally{J(!1)}}),function(){return t.apply(this,arguments)}),$=R.creator_id!==O||!!_,X=(0,d.useMemo)(()=>({tableId:R.id||"",name:R.table_name||"",desc:R.table_desc||"",icon_uri:R.icon_uri||"",readAndWriteMode:R.rw_mode||B.mx.LimitedReadWrite,tableMemoryList:R.field_list||[]}),[R]),Y=(0,d.useMemo)(()=>({name:R.table_name||"",description:R.table_desc||"",icon_uri:[{url:R.icon_url||"",uri:R.icon_uri||"",uid:R.icon_uri||"",isDefault:!0}]}),[R]);var Q=(r=(0,p._)(function*(e){var t,r=yield b.v6.UpdateDatabase((0,m._)({},(0,eL.Z)(R,["id","icon_uri","table_name","table_desc","field_list","rw_mode","prompt_disabled","extra_info"]),e));(null==r?void 0:null===(t=r.database_info)||void 0===t?void 0:t.id)?(yield q(),A&&A(),Z&&F(!1)):x.FN.error("Update database failed")}),function(e){return r.apply(this,arguments)});var ee=(n=(0,p._)(function*(e){var t,r=yield b.v6.UpdateDatabase((0,v._)((0,m._)({},R),{rw_mode:e}));(null==r?void 0:null===(t=r.database_info)||void 0===t?void 0:t.id)&&(yield q(),A&&A())}),function(e){return n.apply(this,arguments)});var et=(o=(0,p._)(function*(){yield q(),A&&A()}),function(){return o.apply(this,arguments)});(0,d.useEffect)(()=>{q()},[]);var er=["create","library"].includes(f);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:T()("h-full w-full max-w-[100vw] flex flex-col overflow-hidden","project"===f?"coz-bg-max rounded-b-[8px] border-solid coz-stroke-primary":"coz-bg-plus"),children:[(0,s.jsxs)("div",{className:T()("flex flex-row items-center justify-between shrink-0",er?"h-[40px] m-[24px]":"h-[64px] px-[16px] py-[12px] border-0 border-b border-solid coz-stroke-primary"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-[8px]",children:[y?null:(0,s.jsx)(x.hU,{color:"secondary",icon:er?(0,s.jsx)(S.$1i,{}):(0,s.jsx)(S.rmE,{}),onClick:C}),(0,s.jsx)(x.EZ,{type:"bot",color:"grey",src:null===(a=Y.icon_uri)||void 0===a?void 0:null===(l=a[0])||void 0===l?void 0:l.url}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-[2px] leading-none",children:[(0,s.jsx)(x.ZT.Text,{weight:500,fontSize:"14px",children:Y.name}),$?null:(0,s.jsx)(x.hU,{size:"mini",color:"secondary",icon:(0,s.jsx)(S.JAz,{className:"coz-fg-secondary"}),onClick:()=>F(!0)})]}),(0,s.jsx)(x.ZT.Text,{fontSize:"12px",children:Y.description})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-[8px]",children:[(0,s.jsx)(eZ,{disabled:$,value:R.rw_mode,onChange:ee}),f.includes("bot")||"workflow"===f?(0,s.jsx)(x.zx,{disabled:$,loading:W,onClick:()=>{if(E)try{G(!0),E("workflow"===f?L:null==R?void 0:R.draft_id)}finally{G(!1)}},children:j}):null]})]}),(0,s.jsx)("div",{className:T()("grow overflow-hidden",er?"mx-[24px]":"mx-[16px]"),children:(0,s.jsxs)(x.nj,{className:th.Z.tab,type:"text",align:"left",tabBarExtraContent:(0,s.jsxs)(x.T,{spacing:16,children:[(0,s.jsx)(eF,{}),U===eO.Structure?(0,s.jsx)(x.zx,{"data-testid":N.A.BotDatabaseEditTableStructureBtn,onClick:()=>z(!0),icon:(0,s.jsx)(S.JAz,{}),color:"highlight",disabled:$,children:h.o.t("db_new_0003")}):null]}),tabBarClassName:"flex flex-row items-center w-full",activeKey:U,onChange:e=>H(e),lazyRender:!0,children:[(0,s.jsx)(x.nj.TabPanel,{tab:h.o.t("db_new_0001"),itemKey:eO.Structure,children:(0,s.jsx)(eR,{loading:K,fieldList:null!==(u=R.field_list)&&void 0!==u?u:[]})}),(0,s.jsxs)(x.nj.TabPanel,{tab:h.o.t("db_optimize_009"),itemKey:eO.Draft,disabled:!!_,children:[(0,s.jsx)(P,{type:"info",persistentKey:"_coze_database_draft_data_warning",children:h.o.t("db_optimize_010")}),(0,s.jsx)(tf,{databaseId:L,tableType:B.Nd.DraftTable,tableFields:R.field_list||[],isReadonlyMode:!1,enterFrom:f,onAfterEditRecords:D})]}),(0,s.jsxs)(x.nj.TabPanel,{tab:h.o.t("db_new_0002"),itemKey:eO.Online,disabled:!!_,children:[(0,s.jsx)(P,{type:"info",persistentKey:"_coze_database_online_data_warning",children:h.o.t("database_optimize_200")}),(0,s.jsx)(tf,{databaseId:L,tableType:B.Nd.OnlineTable,tableFields:R.field_list||[],isReadonlyMode:$,enterFrom:f,onAfterEditRecords:D})]})]})})]}),(0,s.jsx)(k,{visible:Z,onSubmit:e=>{var t,r;return Q({table_name:e.name,icon_uri:null===(r=e.icon_uri)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.uri,table_desc:e.description})},initValues:Y,mode:w.EDIT,onClose:()=>F(!1)}),(0,s.jsx)(eh,{visible:M,initValue:X,onSubmit:et,showDatabaseBaseInfo:!1,onlyShowDatabaseInfoRWMode:!0,onReturn:()=>z(!1),onClose:()=>z(!1)})]})},tg=e=>{var t,r,{version:n,botId:o,spaceId:i,databaseId:l,enterFrom:a,needHideCloseIcon:c,initialTab:m}=e,{onStatusChange:v,onUpdateDisplayName:_}=(0,u.kJ)(),f=(0,eD.useNavigate)(),[g,y]=(0,d.useState)("bot_add"===a?"Add":"Remove");var j=(t=(0,p._)(function*(e){var t=yield b.v6.BindDatabase({database_id:e,bot_id:o});0===t.code?(x.FN.success("Add database success"),y("Remove")):x.FN.error(t.msg)}),function(e){return t.apply(this,arguments)});var w=(r=(0,p._)(function*(e){var t=yield b.v6.UnBindDatabase({database_id:e,bot_id:o});0===t.code?(x.FN.success("Remove database success"),y("Add")):x.FN.error(t.msg)}),function(e){return r.apply(this,arguments)}),C=(0,d.useMemo)(()=>"Add"===g?h.o.t("db2_030"):"Remove"===g?h.o.t("db2_031"):"",[g]);return(0,s.jsx)(tx,{version:n,enterFrom:a,databaseId:l,initialTab:m,addRemoveButtonText:C,onIDECallback:{onStatusChange:v,onUpdateDisplayName:_},onClickAddRemoveButton:e=>{if(!!e)if("Add"===g)j(e);else{if("Remove"!==g)return;w(e)}},needHideCloseIcon:c,onClose:()=>{1===window.history.length&&f("/space/".concat(i,"/library")),f(-1)}})},ty=e=>{var{version:t,needHideCloseIcon:r,initialTab:n}=e,o=(0,u.kF)(),{botID:i,tableID:l,biz:a}=o,d=(0,ex.rY)(e=>e.getSpaceId());return l?(0,s.jsx)(tg,{version:t,botId:null!=i?i:"",databaseId:l,needHideCloseIcon:r,enterFrom:null!=a?a:"",spaceId:null!=d?d:"",initialTab:null!=n?n:o.initialTab}):(0,s.jsx)("div",{children:"no database id!"})}},563026:function(e,t,r){r.d(t,{G6:()=>ep});var n,o,i=r("336205"),l={id:"0",name:i.o.t("real_data")},a=[l],s={name:[{required:!0,message:i.o.t("please_enter_mockset_name")},{pattern:RegExp("^[\\w\\s\\u4e00-\\u9fa5]+$","u"),message:i.o.t("create_plugin_modal_nameerror_cn")}],desc:[]},d={REPEAT_NAME:0x23c7e5fc};var c=((n={})[n.DISABLE=0]="DISABLE",n[n.ENABLE=1]="ENABLE",n),u=r("825955"),p=r("808549"),m=r("120454"),v=r("473980"),_=r("151064"),f=r("455069"),h=r("252237"),x=r.n(h),g=r("584466"),y=r("735114"),b=r("974235"),j=r("606947"),w=r("287487"),C=r("297158"),k=r("707107"),N=r("214942"),S=r("775699"),E=r("44172"),T=r("30961"),I=r("178385"),P=r("824833"),A=r("382534"),D=r("557003"),L=r("660545"),O=r("499283"),Z=r("189284"),F="mockset_auto_generate_latest_choice",M=k.eM.MANUAL;function z(){return(z=(0,u._)(function*(){var e=yield localStorage.getItem(F);return M=Number(e)===k.eM.LLM?k.eM.LLM:k.eM.RANDOM,(!e||Number.isNaN(Number(e)))&&localStorage.setItem(F,String(k.eM.RANDOM)),M})).apply(this,arguments)}var R=r("333422");function B(e){var t,{showLabel:r,enableMulti:n,defaultCount:o,onChange:l,onInit:a}=e,[s,d]=(0,f.useState)({generateMode:k.eM.MANUAL,generateCount:o||1});var c=(t=(0,u._)(function*(){var e=yield M===k.eM.MANUAL?function(){return z.apply(this,arguments)}():M,t=(0,m._)((0,p._)({},s),{generateMode:e});d(t),null==a||a(t)}),function(){return t.apply(this,arguments)});return(0,f.useEffect)(()=>{c()},[]),(0,_.jsxs)("div",{className:R.Z["auto-generate-select"],children:[r?(0,_.jsx)("h4",{className:R.Z["auto-generate-label"],children:i.o.t("plugin_creation_method")}):null,(0,_.jsxs)(S.FX,{type:"card",value:s.generateMode,onChange:e=>{var t,r=(0,m._)((0,p._)({},s),{generateMode:e.target.value});M=t=e.target.value,localStorage.setItem(F,String(t)),d(r),null==l||l(r)},children:[(0,_.jsx)(S.Y8,{className:R.Z["auto-generate-radio"],value:k.eM.RANDOM,extra:i.o.t("generate_randomly_based_on_data_type_name"),children:i.o.t("randomlymode")}),(0,_.jsx)(S.Y8,{className:R.Z["auto-generate-radio"],value:k.eM.LLM,extra:i.o.t("intelligently_generated_by_large_language_model"),children:i.o.t("llm_mode")})]}),n&&r?(0,_.jsx)("h4",{className:R.Z["auto-generate-label"],children:i.o.t("mock_data_quantity")}):null,n?(0,_.jsx)(S.Rn,{value:s.generateCount,max:5,min:1,onChange:e=>{if(!Number.isNaN(Number(e))){var t=(0,m._)((0,p._)({},s),{generateCount:Number(e)});d(t),null==l||l(t)}}}):null]})}var V=r("615655"),U=r("298203");function H(e,t){var{bindSubjectInfo:r,bizCtx:n}=e,{bindSubjectInfo:o,bizCtx:i}=t,l=(0,V.Z)(r,o),a=n||{},{ext:s}=a,d=(0,v._)(a,["ext"]),c=i||{},{ext:u}=c,p=W(d,(0,v._)(c,["ext"])),m=(null==n?void 0:n.trafficScene)!==P.zE.CozeWorkflowDebug||function(e,t){var r=(0,U.dj)(e||"{}"),n=(0,U.dj)(t||"{}");return(0,V.Z)(r,n)}((null==s?void 0:s.mockSubjectInfo)||"",(null==u?void 0:u.mockSubjectInfo)||"");return l&&p&&m}function W(e,t){return e.bizSpaceID===t.bizSpaceID&&e.trafficScene===t.trafficScene&&e.trafficCallerID===t.trafficCallerID}function G(e,t){var{bizSpaceID:r,ext:n,trafficScene:o}=e||{},i=(0,U.dj)((null==n?void 0:n.mockSubjectInfo)||"{}"),{componentID:l,parentComponentID:a}=t;switch(o){case P.zE.CozeWorkflowDebug:return{spaceID:r,toolID:null==i?void 0:i.componentID,pluginID:null==i?void 0:i.parentComponentID};case P.zE.CozeSingleAgentDebug:case P.zE.CozeMultiAgentDebug:case P.zE.CozeToolDebug:default:return{spaceID:r,toolID:l,pluginID:a}}}function K(e,t){var{ext:r,trafficScene:n}=e||{},o=(0,U.dj)((null==r?void 0:r.mockSubjectInfo)||"{}");switch(n){case P.zE.CozeWorkflowDebug:return o;case P.zE.CozeSingleAgentDebug:case P.zE.CozeMultiAgentDebug:case P.zE.CozeToolDebug:default:return t}}function J(){return"cn-boe"}var q=r("625626"),$=e=>{var t,r,{visible:n,zIndex:o,disabled:l,initialInfo:a,onSuccess:c,onCancel:v,needResetPopoverContainer:h}=e,x=(0,f.useRef)(),[g]=(0,Z.V)(),y=!a.id,b=(0,N.rY)(e=>e.space.space_type)===I.Sn.Personal,j=e=>{var t,r,n,o;null===(r=x.current)||void 0===r||null===(t=r.setValue)||void 0===t||t.call(r,"generateMode",String(e.generateMode)),null===(o=x.current)||void 0===o||null===(n=o.setValue)||void 0===n||n.call(o,"generateCount",String(e.generateCount))};var w=(t=(0,u._)(function*(e){var{id:t,name:r,desc:n,bindSubjectInfo:o,bizCtx:l,autoGenerate:a,generateMode:s,generateCount:u}=e,{toolID:v,spaceID:_}=G(l,o),f={environment:J(),workspace_id:_||"",workspace_type:b?"personal_workspace":"team_workspace",tool_id:v||"",status:1,mock_set_id:"",auto_gen_mode:a?Number(s)||k.eM.RANDOM:k.eM.MANUAL,mock_counts:1};try{var{id:h}=yield A.xd.SaveMockSet({name:r,description:n,mockSubject:K(l,o),bizCtx:l,id:t||"0"},{__disableErrorToast:!0});null==c||c({id:h,name:r,description:n},a?{generateMode:Number(s),generateCount:Number(u)}:void 0),(0,k.Gg)(k.Kg.create_mockset_front,(0,m._)((0,p._)({},f),{status:0,mock_set_id:String(h)||""}))}catch(e){var{message:g}=e||{},y=(0,m._)((0,p._)({},f),{status:1,error:g,error_type:"unknown"});if((0,O.k0)(e)){var j,{code:w}=e||{};if(Number(w)===d.REPEAT_NAME){null===(j=x.current)||void 0===j||j.setError("name",i.o.t("name_already_taken")),(0,k.Gg)(k.Kg.create_mockset_front,(0,m._)((0,p._)({},y),{error_type:"repeat_name"}));return}}g&&S.O$.error(g),(0,k.Gg)(k.Kg.create_mockset_front,(0,m._)((0,p._)({},y),{error_type:"unknown"}))}}),function(e){return t.apply(this,arguments)});var C=(r=(0,u._)(function*(){var e;yield null===(e=x.current)||void 0===e?void 0:e.submitForm()}),function(){return r.apply(this,arguments)});return(0,_.jsx)(S.M5,{type:"action-small",zIndex:o,title:"".concat(y?i.o.t("create_mockset"):i.o.t("edit_mockset")),visible:n,getPopupContainer:h?()=>document.body:void 0,onCancel:v,okButtonProps:{onClick:C,disabled:l},children:(0,_.jsx)(S.l0,{getFormApi:e=>x.current=e,showValidateIcon:!1,initValues:y?(0,m._)((0,p._)({},a),{name:function(e){if(!!e){var t=Math.floor(90*Math.random()+10);return"".concat(e," mockset").concat(t)}}(a.name)}):a,onSubmit:e=>w(e),className:q.Z["mockset-create-form"],children:e=>{var{formState:t}=e;return(0,_.jsxs)(_.Fragment,{children:[l?(0,_.jsx)(S.l0.Slot,{label:{text:i.o.t("mockset_name"),required:!0},children:(0,_.jsx)("div",{children:null==a?void 0:a.name})}):(0,_.jsx)(S.P6,{field:"name",label:i.o.t("mockset_name"),placeholder:i.o.t("good_mockset_name_descriptive_concise"),trigger:["blur","change"],maxCount:50,maxLength:50,rows:1,onBlur:()=>{var e,t,r;null===(r=x.current)||void 0===r||r.setValue("name",null===(t=x.current)||void 0===t?void 0:null===(e=t.getValue("name"))||void 0===e?void 0:e.trim())},rules:s.name}),l?(0,_.jsx)(S.l0.Slot,{label:{text:i.o.t("mockset_description")},children:(0,_.jsx)("div",{children:null==a?void 0:a.desc})}):(0,_.jsx)(S.P6,{field:"desc",label:{text:i.o.t("mockset_description")},trigger:["blur","change"],placeholder:i.o.t("describe_use_scenarios_of_mockset"),rows:2,maxCount:2e3,maxLength:2e3,rules:s.desc,onBlur:()=>{var e,t,r;null===(r=x.current)||void 0===r||r.setValue("desc",null===(t=x.current)||void 0===t?void 0:null===(e=t.getValue("desc"))||void 0===e?void 0:e.trim())}}),y&&g["bot.devops.mockset_auto_generate"]?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S.l0.Checkbox,{field:"autoGenerate",noLabel:!0,disabled:l,className:q.Z["auto-generate-checkbox"],children:i.o.t("auto_generate")}),t.values.autoGenerate?(0,_.jsx)(B,{onInit:j,onChange:j}):null]}):null]})}})})},X=r("790426"),Y=e=>{var t,{visible:r,mockSetInfo:n,onSuccess:o,onCancel:l,zIndex:a,needResetPopoverContainer:s}=e,{detail:{id:d},ctx:c}=n||{},[v,h]=(0,f.useState)(-1),x=(0,N.rY)(e=>e.space.space_type)===I.Sn.Personal,{run:g}=(0,y.Z)((0,u._)(function*(){var{spaceID:e}=G((null==c?void 0:c.bizCtx)||{},(null==c?void 0:c.mockSubjectInfo)||{});try{var{usersUsageCount:t}=yield A.xd.GetMockSetUsageInfo({mockSetID:d,spaceID:e});h(Number(null!=t?t:0))}catch(e){C.kg.error({error:e,eventName:"fetch_mockset_ref_fail"}),h(0)}}),{manual:!0});(0,f.useEffect)(()=>{g()},[n]);var b=v>0?i.o.t("people_using_mockset_delete",{num:v}):i.o.t("delete_the_mockset");var j=(t=(0,u._)(function*(){var{toolID:e,spaceID:t}=G((null==c?void 0:c.bizCtx)||{},(null==c?void 0:c.mockSubjectInfo)||{}),r={environment:J(),workspace_id:t||"",workspace_type:x?"personal_workspace":"team_workspace",tool_id:e||"",mock_set_id:String(d)||"",status:1};try{d&&(yield A.xd.DeleteMockSet({id:d,bizCtx:null==c?void 0:c.bizCtx})),null==o||o(),(0,k.Gg)(k.Kg.del_mockset_front,(0,m._)((0,p._)({},r),{status:0}))}catch(e){(0,k.Gg)(k.Kg.del_mockset_front,(0,m._)((0,p._)({},r),{status:1,error:null==e?void 0:e.message}))}}),function(){return t.apply(this,arguments)});return(0,_.jsx)(S.M5,{type:"info",zIndex:a,icon:(0,_.jsx)(X.Z,{size:"extra-large",className:"inline-flex text-[#FF2710]"}),title:b,visible:v>=0&&r,onCancel:l,onOk:j,getPopupContainer:s?()=>document.body:void 0,okType:"danger",children:i.o.t("operation_cannot_be_reversed")})};var Q=((o={}).Incompatible="Incompatible",o.Normal="Normal",o),ee=r("801815"),et=r("165882"),er=r("598208"),en=r("61111"),eo=(0,er.Ue)((e,t)=>({bizCtx:{},enabledMockSetInfo:[],isPolling:!1,isLoading:!1,currentMockComp:[],setPolling:t=>{e({isPolling:t})},setLoading:t=>{e({isLoading:t})},setCurrentBizCtx:t=>{e({bizCtx:t})},setEnabledMockSetInfo:t=>{e({enabledMockSetInfo:t})},addMockComp:r=>(e((0,en.Uy)(e=>{-1>=e.currentMockComp.findIndex(e=>H(e,r))&&e.currentMockComp.push(r)})),t().currentMockComp.length),removeMockComp:r=>(e((0,en.Uy)(e=>{var t=e.currentMockComp.findIndex(e=>H(e,r));t>-1&&e.currentMockComp.splice(t,1)})),t().currentMockComp.length),setTimer:t=>{e({timer:t})},setRestartTimer:t=>{e({timer:t})}})),ei=e=>{var t,r,n,{bizCtx:o,pollingInterval:i}=e,{enabledMockSetInfo:l,setPolling:a,setEnabledMockSetInfo:s,bizCtx:d,setCurrentBizCtx:p,addMockComp:m,removeMockComp:v,isPolling:_,setTimer:h,timer:x,currentMockComp:g,setLoading:y,isLoading:b,restartTimer:j,setRestartTimer:w}=eo(),k=(0,f.useRef)(!1),N=(0,f.useRef)(0),S=(0,f.useRef)(),E=(0,f.useRef)();var T=(t=(0,u._)(function*(e){var t=++N.current,r=S.current;try{var n,o,{mockSetBindings:i=[],mockSetDetails:l={}}=yield A.xd.MGetMockSetBinding({bizCtx:e,needMockSetDetail:!0},{headers:{"rpc-persist-mock-traffic-enable":c.ENABLE},cancelToken:new et.Z.CancelToken(function(e){E.current=e})});if(t>1&&t!==N.current||!S.current||S.current!==r)return;return null==s||s((n=i,o=l,n.map(e=>{var{mockSetID:t}=e;return{mockSetBinding:e,mockSetDetail:t?o[t]:{}}}))),{mockSetBindings:i,mockSetDetails:l}}catch(e){et.Z.isCancel(e)?C.kg.info("poll_scene_mockset_canceled"):C.kg.error({error:e,eventName:"poll_scene_mockset_fail"})}}),function(e){return t.apply(this,arguments)});var I=(r=(0,u._)(function*(){try{var{trafficCallerID:e,connectorID:t,connectorUID:r,bizSpaceID:n,trafficScene:l}=o;if(k.current||(k.current=!0),y(!0),k.current&&i){a(!0);var s=setTimeout(()=>{k.current&&I()},i);h(s)}yield T({trafficCallerID:e,connectorID:t,connectorUID:r,bizSpaceID:n,trafficScene:l})}finally{y(!1)}}),function(){return r.apply(this,arguments)}),P=()=>{var e;S.current=void 0,null===(e=E.current)||void 0===e||e.call(E),N.current=0,D(),x&&(clearTimeout(x),a(!1),h(void 0),k.current&&(k.current=!1))},D=()=>{j&&(clearTimeout(j),w(void 0))};var L=(n=(0,u._)(function*(){P(),S.current=(0,ee.x0)(),yield I()}),function(){return n.apply(this,arguments)});return(0,f.useEffect)(()=>{if(!(d&&W(o,d)))p(o)},[o]),{start:L,cancel:P,isLoading:b,data:l,addMockComp:m,removeMockComp:v,currentMockComp:g,isPolling:_,setRestartTimer:w,restartTimer:j}},el=r("162058"),ea=r("936931"),es=e=>{var{name:t,onDelete:r,onView:n,status:o=Q.Normal,creatorName:i,viewOnly:l,disableCreator:a,className:s,style:d}=e,[c,u]=(0,f.useState)(!1);return(0,_.jsxs)("div",{className:x()(ea.Z["mock-select-item"],s),style:d,onMouseEnter:()=>{u(!0)},onMouseLeave:()=>u(!1),children:[(0,_.jsxs)("span",{className:ea.Z["mock-main-info"],children:[o!==Q.Normal&&(0,_.jsx)(D.Z,{className:ea.Z["status-icon"]}),(0,_.jsx)(S.ZT.Text,{ellipsis:{},className:ea.Z["mock-name"],children:t})]}),(0,_.jsx)("div",{className:ea.Z["mock-extra-info"],children:c?(0,_.jsx)("div",{className:ea.Z["operation-icon"],onClick:e=>e.stopPropagation(),children:l?(0,_.jsx)(S._3,{onClick:n,icon:(0,_.jsx)(el.Z,{})}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S._3,{onClick:n,icon:(0,_.jsx)(E.yl5,{}),wrapperClass:"mr-[4px]"}),(0,_.jsx)(S._3,{onClick:r,icon:(0,_.jsx)(E.WDf,{})})]})}):a?null:(0,_.jsx)(S.ZT.Text,{ellipsis:{showTooltip:{opts:{content:i}}},className:ea.Z["creator-name"],children:i})})]})},ed=r("303662");function ec(e){var t=e.id!==l.id&&((null==e?void 0:e.schemaIncompatible)||!(null==e?void 0:e.mockRuleQuantity));return{value:(null==e?void 0:e.id)||"",label:(0,_.jsx)(S.u,{content:i.o.t("mockset_invaild_tip",{MockSetName:e.name}),style:{display:t?"block":"none"},children:(0,_.jsxs)("span",{className:x()("flex items-center w-[100%] min-w-0",ed.Z["select-label"]),children:[t?(0,_.jsx)(D.Z,{style:{verticalAlign:"middle",marginRight:2,color:"#FF8500"}}):null,(0,_.jsx)("span",{className:x()("flex-1 min-w-0 overflow-hidden text-ellipsis",t?"text-[#1D1C2359]":"text-[#1D1C23CC]"),children:(null==e?void 0:e.name)||""})]})},null==e?void 0:e.id),disabled:t,detail:e}}function eu(e){return e.map(e=>ec(e))}var ep=(0,f.forwardRef)((e,t)=>{var r,n,o,s,d,c,{bindSubjectInfo:h,bizCtx:D,className:O,style:Z,readonly:F}=e,{detail:M}=h,z=(0,v._)(h,["detail"]),{spaceID:R,toolID:B,pluginID:V}=G(D,z),U=null===(c=w.Z.useUserInfo())||void 0===c?void 0:c.user_id_str,W=(0,N.rY)(e=>e.space.space_type)===I.Sn.Personal,q=(0,m._)((0,p._)({},D),{connectorUID:U,connectorID:"10000010"}),{jump:X}=(0,T.oB)(),[ee,et]=(0,f.useState)(l),er=ec(ee),[en,eo]=(0,f.useState)(eu(a)),[el,ea]=(0,f.useState)(!1),[ep,em]=(0,f.useState)(),ev=(0,f.useRef)(l),e_=(0,f.useRef)(null),ef=(0,f.useRef)(null),[eh]=(0,g.Z)(e_),{data:ex,addMockComp:eg,removeMockComp:ey,start:eb,cancel:ej,setRestartTimer:ew}=ei({bizCtx:q,pollingInterval:1e4});var{runAsync:eC,loading:ek}=(0,y.Z)((r=(0,u._)(function*(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r={environment:J(),workspace_id:R||"",workspace_type:W?"personal_workspace":"team_workspace",tool_id:B||"",status:1,mock_set_id:e.id||"",where:function(e){switch(e){case P.zE.CozeSingleAgentDebug:return"bot";case P.zE.CozeMultiAgentDebug:return"agent";case P.zE.CozeWorkflowDebug:return"flow";case P.zE.CozeToolDebug:default:return"bot"}}(q.trafficScene)};try{yield A.xd.BindMockSet({mockSetID:t?e.id:"0",bizCtx:q,mockSubject:z}),t&&(0,k.Gg)(k.Kg.use_mockset_front,(0,m._)((0,p._)({},r),{status:0}))}catch(e){et(ev.current),C.kg.error({error:e,eventName:"change_mockset_fail"}),t&&(0,k.Gg)(k.Kg.use_mockset_front,(0,m._)((0,p._)({},r),{status:1,error:null==e?void 0:e.message}))}}),function(e){return r.apply(this,arguments)}),{manual:!0});var eN=(n=(0,u._)(function*(e){ej(),ev.current=ee,et((null==e?void 0:e.detail)||{}),yield eC((null==e?void 0:e.detail)||{}),ew(setTimeout(()=>{eb()},2e3))}),function(e){return n.apply(this,arguments)});var{reload:eS,loadMore:eE,loading:eT,loadingMore:eI,data:eP}=(0,b.Z)((o=(0,u._)(function*(e){try{var t,r=yield A.xd.MGetMockSet({bizCtx:q,mockSubject:K(q,h),pageToken:null==e?void 0:e.pageToken,orderBy:P.d$.UpdateTime,desc:!0});return{list:eu((null==r?void 0:r.mockSets)||[])||[],pageToken:null==r?void 0:r.pageToken,hasMore:null===(t=null==r?void 0:r.hasMore)||void 0===t||t,schema:null==r?void 0:r.schema,count:null==r?void 0:r.count}}catch(t){return C.kg.error({error:t,eventName:"mockset_list_fetch_fail"}),{list:[],pageToken:null==e?void 0:e.pageToken,hasMore:null==e?void 0:e.hasMore}}}),function(e){return o.apply(this,arguments)}),{manual:!0});(0,f.useImperativeHandle)(t,()=>({handleParentNodeDelete:()=>{eC(ee,!1)}})),(0,f.useEffect)(()=>{eo([ec(l),...(null==eP?void 0:eP.list)||[]])},[eP]),(0,f.useEffect)(()=>{var e=ex.find(e=>{var t,r;return H({bizCtx:(null==e?void 0:null===(t=e.mockSetBinding)||void 0===t?void 0:t.bizCtx)||{},bindSubjectInfo:(null==e?void 0:null===(r=e.mockSetBinding)||void 0===r?void 0:r.mockSubject)||{}},{bizCtx:q,bindSubjectInfo:z})});if(!ek)(null==e?void 0:e.mockSetDetail)?et(null==e?void 0:e.mockSetDetail):et(l)},[ex]),(0,j.Z)(()=>{!ey({bizCtx:q,bindSubjectInfo:z})&&ej()}),(0,f.useEffect)(()=>{eh?1===eg({bizCtx:q,bindSubjectInfo:z})&&eb():!ey({bizCtx:q,bindSubjectInfo:z})&&ej()},[eh]);var eA=()=>{var e;null==ef||null===(e=ef.current)||void 0===e||e.close()},eD=(e,t)=>{var{trafficScene:r}=q||{},{id:n}=e||{};R&&V&&B&&n&&X(r===P.zE.CozeWorkflowDebug?T.cJ.WORKFLOW__TO__PLUGIN_MOCK_DATA:T.cJ.BOT__TO__PLUGIN_MOCK_DATA,{spaceId:R,pluginId:V,toolId:B,toolName:null==M?void 0:M.name,mockSetId:String(n),mockSetName:null==e?void 0:e.name,bizCtx:JSON.stringify(q),bindSubjectInfo:JSON.stringify(z),generationMode:null==t?void 0:t.generateMode})};return(0,_.jsxs)("div",{ref:e_,style:Z,className:O,children:[(0,_.jsx)(S.Cj,{stopPropagation:!0,disabled:F||ek,className:x()(ed.Z["select-container"],ek&&ed.Z["switch-disabled"]),ref:ef,selectedClassname:ed.Z["item-selected"],optionList:en,dropdownClassName:ed.Z["option-list"],outerBottomSlot:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:ed.Z.divider}),(0,_.jsxs)("div",{onClick:()=>{ea(!0),eA()},className:ed.Z["create-container"],children:[(0,_.jsx)(E.N_R,{className:"mr-[10px]",style:{fontSize:14,color:"#4D53E8"}}),(0,_.jsx)("span",{children:i.o.t("create_mockset")})]})]}),innerBottomSlot:eT||((null==eP?void 0:null===(s=eP.list)||void 0===s?void 0:s.length)||0)>=((null==eP?void 0:eP.count)||0)?null:(0,_.jsx)("div",{className:x()(ed.Z["select-option-container"],ed.Z["load-more"]),children:eI?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S.yC,{wrapperClassName:ed.Z["spin-icon"]}),(0,_.jsx)("span",{children:i.o.t("Loading")})]}):(0,_.jsx)(S.y3,{onClick:eE,theme:"borderless",style:{fontSize:12},children:i.o.t("Load More")})}),onDropdownVisibleChange:e=>{e?eS():eo([ec(l)])},loading:eT,renderOptionItem:e=>{var t,r,{disabled:n,selected:o,value:l,focused:a,style:s,onMouseEnter:d,onClick:c,detail:u}=e;return(0,_.jsx)(S.u,{zIndex:110,content:(null==u?void 0:u.schemaIncompatible)?i.o.t("tool_updated_check_mockset_compatibility"):0>=((null==u?void 0:u.mockRuleQuantity)||0)?i.o.t("mockset_is_empty_add_data_before_use"):"",visible:n&&a,position:"left",style:{display:n?"block":"none"},children:(0,_.jsxs)("div",{style:s,className:x()(ed.Z["select-option-container"],a&&ed.Z["custom-option-render-focused"],n&&ed.Z["custom-option-render-disabled"],o&&ed.Z["custom-option-render-selected"]),onClick:c,onMouseEnter:d,children:[(0,_.jsx)("div",{className:"w-[16px] h-[16px] mr-[8px]",children:o?(0,_.jsx)(L.Z,{style:{fontSize:14},className:"text-[#4D53E8]"}):(0,_.jsx)("div",{className:"w-[16px]"})}),"0"===l?(0,_.jsx)("span",{children:i.o.t("real_data")}):(0,_.jsx)(es,{status:(null==u?void 0:u.schemaIncompatible)?Q.Incompatible:Q.Normal,name:(null==u?void 0:u.name)||"",onDelete:()=>{eA(),em(u)},onView:()=>{eD(u)},disableCreator:W,viewOnly:U!==(null==u?void 0:null===(t=u.creator)||void 0===t?void 0:t.ID),creatorName:null==u?void 0:null===(r=u.creator)||void 0===r?void 0:r.name,className:"flex-1 min-w-0"})]})})},value:er,onChangeWithObject:!0,onChange:(d=(0,u._)(function*(e){yield eN(e)}),function(e){return d.apply(this,arguments)})}),el?(0,_.jsx)($,{zIndex:9999,visible:el,onCancel:()=>ea(!1),onSuccess:(e,t)=>{var{id:r}=e||{};ea(!1);var n={[k.eM.LLM]:i.o.t("created_mockset_please_add_mock_data_llm_generation"),[k.eM.RANDOM]:i.o.t("created_mockset_please_add_mock_data_random_generation"),[k.eM.MANUAL]:i.o.t("created_mockset_please_add_mock_data")};S.O$.success(n[(null==t?void 0:t.generateMode)||k.eM.MANUAL]),eD({id:r},t)},initialInfo:{bizCtx:q,bindSubjectInfo:z,name:null==M?void 0:M.name},needResetPopoverContainer:q.trafficScene===P.zE.CozeWorkflowDebug}):null,ep?(0,_.jsx)(Y,{zIndex:9999,visible:!!ep,mockSetInfo:{detail:ep,ctx:{bizCtx:q,mockSubjectInfo:z}},onSuccess:()=>{ep.id===ee.id&&et(l),em(void 0),ej(),eb()},onCancel:()=>em(void 0),needResetPopoverContainer:q.trafficScene===P.zE.CozeWorkflowDebug}):null]})})},13194:function(e,t,r){r.d(t,{C:function(){return h}});var n=r(808549),o=r(120454),i=r(473980),l=r(151064),a=r(322512),s=r(252237),d=r.n(s),c=r(336205),u=r(775699),p=r(178385),m=r(573049),v={1:"File",2:"Image",3:"Doc",4:"Code",5:"PPT",6:"Txt",7:"Excel",8:"Audio",9:"Zip",10:"Video",11:"Svg"},_=e=>{var{type:t,format:r}=e,{assist_type:n}=e,o=t;return"string"===t&&r===p.vG.ImageUrl?o="image":"string"===t&&n&&(o=v[n]),o},f=e=>{var{parameter:t}=e,{name:r,desc:n,required:o}=t;return(0,l.jsxs)("div",{className:m.Z["parameter-item"],children:[(0,l.jsxs)(u.T,{className:m.Z["parameter-text"],wrap:!0,children:[(0,l.jsx)("span",{className:m.Z["parameter-name"],children:r}),(0,l.jsx)("span",{className:m.Z["parameter-type"],children:_(t)}),o?(0,l.jsx)("span",{className:m.Z["parameter-required"],children:c.o.t("tool_para_required")}):null]}),(0,l.jsx)("div",{className:m.Z["parameter-desc"],children:n})]})},h=e=>{var t,{children:r,pluginApi:s,callback:c,onVisibleChange:p}=e,v=(0,i._)(e,["children","pluginApi","callback","onVisibleChange"]);return(0,l.jsx)(u.J2,(0,o._)((0,n._)({trigger:(null==v?void 0:v.trigger)||"hover",position:"right",showArrow:!0,onVisibleChange:p,content:(0,l.jsxs)("div",{className:d()("max-h-[400px] overflow-x-hidden overflow-y-auto",m.Z["popover-content"]),onClick:e=>{null==c||c(e)},children:[s.name?(0,l.jsx)("div",{className:m.Z["popover-api-name"],children:s.name}):null,s.desc?(0,l.jsx)("div",{className:m.Z["popover-api-desc"],children:s.desc}):null,null===(t=(0,a.Z)(s.parameters||[],e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.length}))||void 0===t?void 0:t.map(e=>e?(0,l.jsx)(f,{parameter:e},e.name):null)]})},v),{children:(0,l.jsx)("div",{children:r})}))}},531464:function(e,t,r){r.d(t,{y:()=>L});var n=r("151064");r("455069");var o=r("252237"),i=r.n(o),l=r("674343");function a(e){var{theme:t,components:r,className:o}=e,i="light"===t?r.light:r.dark;return(0,n.jsx)("div",{className:o,children:i})}function s(e){return(0,n.jsxs)("svg",{width:"576",height:"288",viewBox:"0 0 576 288",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsxs)("g",{opacity:"0.2",children:[(0,n.jsx)("mask",{id:"mask0_4513_102601",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"576",height:"288",children:(0,n.jsx)("rect",{width:"576",height:"288",fill:"url(#paint0_linear_4513_102601)"})}),(0,n.jsxs)("g",{mask:"url(#mask0_4513_102601)",children:[(0,n.jsx)("mask",{id:"mask1_4513_102601",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"576",height:"288",children:(0,n.jsx)("rect",{width:"576",height:"288",fill:"url(#paint1_linear_4513_102601)"})}),(0,n.jsxs)("g",{mask:"url(#mask1_4513_102601)",children:[(0,n.jsx)("rect",{width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",width:"48",height:"48",fill:"url(#paint2_linear_4513_102601)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"48",width:"48",height:"48",fill:"url(#paint3_linear_4513_102601)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"96",width:"48",height:"48",fill:"url(#paint4_linear_4513_102601)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"192",width:"48",height:"48",fill:"url(#paint5_linear_4513_102601)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"240",width:"48",height:"48",fill:"url(#paint6_linear_4513_102601)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"240",width:"48",height:"48",stroke:"#3C445C"})]})]})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"paint0_linear_4513_102601",x1:"576",y1:"144",x2:"-3.75509e-06",y2:"144",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#D9D9D9",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"0.500048",stopColor:"#D9D9D9"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#D9D9D9",stopOpacity:"0"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4513_102601",x1:"288",y1:"0",x2:"288",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#D9D9D9",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"0.493585",stopColor:"#D9D9D9"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#D9D9D9",stopOpacity:"0"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear_4513_102601",x1:"72",y1:"0",x2:"72",y2:"48",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint3_linear_4513_102601",x1:"216",y1:"48",x2:"216",y2:"96",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint4_linear_4513_102601",x1:"360",y1:"96",x2:"360",y2:"144",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint5_linear_4513_102601",x1:"264",y1:"192",x2:"264",y2:"240",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint6_linear_4513_102601",x1:"504",y1:"240",x2:"504",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]})]})]})}function d(e){return(0,n.jsxs)("svg",{width:"576",height:"288",viewBox:"0 0 576 288",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsxs)("g",{opacity:"0.4",children:[(0,n.jsx)("mask",{id:"mask0_4513_103145",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"576",height:"288",children:(0,n.jsx)("rect",{width:"576",height:"288",fill:"url(#paint0_linear_4513_103145)"})}),(0,n.jsxs)("g",{mask:"url(#mask0_4513_103145)",children:[(0,n.jsx)("mask",{id:"mask1_4513_103145",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"576",height:"288",children:(0,n.jsx)("rect",{width:"576",height:"288",fill:"url(#paint1_linear_4513_103145)"})}),(0,n.jsxs)("g",{mask:"url(#mask1_4513_103145)",children:[(0,n.jsx)("rect",{width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",width:"48",height:"48",fill:"url(#paint2_linear_4513_103145)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"48",width:"48",height:"48",fill:"url(#paint3_linear_4513_103145)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"48",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"96",width:"48",height:"48",fill:"url(#paint4_linear_4513_103145)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"96",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"144",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"192",width:"48",height:"48",fill:"url(#paint5_linear_4513_103145)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"192",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"48",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"96",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"144",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"192",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"240",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"288",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"336",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"384",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"432",y:"240",width:"48",height:"48",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"480",y:"240",width:"48",height:"48",fill:"url(#paint6_linear_4513_103145)",stroke:"#3C445C"}),(0,n.jsx)("rect",{x:"528",y:"240",width:"48",height:"48",stroke:"#3C445C"})]})]})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"paint0_linear_4513_103145",x1:"576",y1:"144",x2:"-3.75509e-06",y2:"144",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#D9D9D9",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"0.500048",stopColor:"#D9D9D9"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#D9D9D9",stopOpacity:"0"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4513_103145",x1:"288",y1:"0",x2:"288",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#D9D9D9",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"0.493585",stopColor:"#D9D9D9"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#D9D9D9",stopOpacity:"0"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear_4513_103145",x1:"72",y1:"0",x2:"72",y2:"48",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint3_linear_4513_103145",x1:"216",y1:"48",x2:"216",y2:"96",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint4_linear_4513_103145",x1:"360",y1:"96",x2:"360",y2:"144",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint5_linear_4513_103145",x1:"264",y1:"192",x2:"264",y2:"240",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]}),(0,n.jsxs)("linearGradient",{id:"paint6_linear_4513_103145",x1:"504",y1:"240",x2:"504",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3C445C",stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3C445C"})]})]})]})}var c=r("60378");function u(e){var{theme:t}=e;return(0,n.jsx)(a,{className:c.Z["search-no-mask"],theme:t,components:{dark:(0,n.jsx)(d,{}),light:(0,n.jsx)(s,{})}})}function p(e){return(0,n.jsxs)("svg",{width:"280",height:"184",viewBox:"0 0 280 184",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{y:"148",width:"280",height:"14",rx:"7",fill:"#1C2333"}),(0,n.jsx)("rect",{y:"170",width:"192",height:"14",rx:"7",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"200",y:"170",width:"80",height:"14",rx:"7",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"279",height:"135",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"279",height:"135",rx:"7.5",stroke:"url(#paint0_linear_116_6085)"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_116_6085)",children:[(0,n.jsx)("path",{d:"M16 28.8C16 24.3196 16 22.0794 16.8719 20.3681C17.6389 18.8628 18.8628 17.6389 20.3681 16.8719C22.0794 16 24.3196 16 28.8 16H251.2C255.68 16 257.921 16 259.632 16.8719C261.137 17.6389 262.361 18.8628 263.128 20.3681C264 22.0794 264 24.3196 264 28.8V51.2C264 55.6804 264 57.9206 263.128 59.6319C262.361 61.1372 261.137 62.3611 259.632 63.1281C257.921 64 255.68 64 251.2 64H28.8C24.3196 64 22.0794 64 20.3681 63.1281C18.8628 62.3611 17.6389 61.1372 16.8719 59.6319C16 57.9206 16 55.6804 16 51.2V28.8Z",fill:"url(#paint1_linear_116_6085)"}),(0,n.jsx)("path",{d:"M16.1 28.8C16.1 26.5581 16.1001 24.8828 16.2087 23.5538C16.3171 22.2259 16.5335 21.2527 16.961 20.4135C17.7184 18.927 18.927 17.7184 20.4135 16.961C21.2527 16.5335 22.2259 16.3171 23.5538 16.2087C24.8828 16.1001 26.5581 16.1 28.8 16.1H251.2C253.442 16.1 255.117 16.1001 256.446 16.2087C257.774 16.3171 258.747 16.5335 259.587 16.961C261.073 17.7184 262.282 18.927 263.039 20.4135C263.467 21.2527 263.683 22.2259 263.791 23.5538C263.9 24.8828 263.9 26.5581 263.9 28.8V51.2C263.9 53.4419 263.9 55.1172 263.791 56.4462C263.683 57.7741 263.467 58.7473 263.039 59.5865C262.282 61.073 261.073 62.2816 259.587 63.039C258.747 63.4665 257.774 63.6828 256.446 63.7913C255.117 63.8999 253.442 63.9 251.2 63.9H28.8C26.5581 63.9 24.8828 63.8999 23.5538 63.7913C22.2259 63.6828 21.2527 63.4665 20.4135 63.039C18.927 62.2816 17.7184 61.073 16.961 59.5865C16.5335 58.7473 16.3171 57.7741 16.2087 56.4462C16.1001 55.1172 16.1 53.4419 16.1 51.2V28.8Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_116_6085",x:"7.42857",y:"10.2857",width:"265.143",height:"65.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_116_6085"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_116_6085",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_116_6085",x1:"140",y1:"0",x2:"140",y2:"136",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_116_6085",x1:"140",y1:"16",x2:"140",y2:"64",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3D8DF3"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#133BFE"})]})]})]})}function m(e){return(0,n.jsxs)("svg",{width:"280",height:"184",viewBox:"0 0 280 184",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{y:"148",width:"280",height:"14",rx:"7",fill:"white"}),(0,n.jsx)("rect",{y:"170",width:"192",height:"14",rx:"7",fill:"white"}),(0,n.jsx)("rect",{x:"200",y:"170",width:"80",height:"14",rx:"7",fill:"white"}),(0,n.jsx)("rect",{width:"280",height:"136",rx:"8",fill:"white"}),(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"279",height:"135",rx:"7.5",stroke:"url(#paint0_linear_4434_146978)",strokeOpacity:"0.24"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_4434_146978)",children:[(0,n.jsx)("path",{d:"M16 28.8C16 24.3196 16 22.0794 16.8719 20.3681C17.6389 18.8628 18.8628 17.6389 20.3681 16.8719C22.0794 16 24.3196 16 28.8 16H251.2C255.68 16 257.921 16 259.632 16.8719C261.137 17.6389 262.361 18.8628 263.128 20.3681C264 22.0794 264 24.3196 264 28.8V51.2C264 55.6804 264 57.9206 263.128 59.6319C262.361 61.1372 261.137 62.3611 259.632 63.1281C257.921 64 255.68 64 251.2 64H28.8C24.3196 64 22.0794 64 20.3681 63.1281C18.8628 62.3611 17.6389 61.1372 16.8719 59.6319C16 57.9206 16 55.6804 16 51.2V28.8Z",fill:"url(#paint1_linear_4434_146978)"}),(0,n.jsx)("path",{d:"M16.1 28.8C16.1 26.5581 16.1001 24.8828 16.2087 23.5538C16.3171 22.2259 16.5335 21.2527 16.961 20.4135C17.7184 18.927 18.927 17.7184 20.4135 16.961C21.2527 16.5335 22.2259 16.3171 23.5538 16.2087C24.8828 16.1001 26.5581 16.1 28.8 16.1H251.2C253.442 16.1 255.117 16.1001 256.446 16.2087C257.774 16.3171 258.747 16.5335 259.587 16.961C261.073 17.7184 262.282 18.927 263.039 20.4135C263.467 21.2527 263.683 22.2259 263.791 23.5538C263.9 24.8828 263.9 26.5581 263.9 28.8V51.2C263.9 53.4419 263.9 55.1172 263.791 56.4462C263.683 57.7741 263.467 58.7473 263.039 59.5865C262.282 61.073 261.073 62.2816 259.587 63.039C258.747 63.4665 257.774 63.6828 256.446 63.7913C255.117 63.8999 253.442 63.9 251.2 63.9H28.8C26.5581 63.9 24.8828 63.8999 23.5538 63.7913C22.2259 63.6828 21.2527 63.4665 20.4135 63.039C18.927 62.2816 17.7184 61.073 16.961 59.5865C16.5335 58.7473 16.3171 57.7741 16.2087 56.4462C16.1001 55.1172 16.1 53.4419 16.1 51.2V28.8Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_4434_146978",x:"7.42857",y:"10.2857",width:"265.143",height:"65.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4434_146978"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4434_146978",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_4434_146978",x1:"140",y1:"0",x2:"140",y2:"136",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4434_146978",x1:"140",y1:"16",x2:"140",y2:"64",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3D8DF3"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#133BFE"})]})]})]})}function v(e){var{theme:t}=e;return(0,n.jsx)(a,{theme:t,components:{dark:(0,n.jsx)(p,{}),light:(0,n.jsx)(m,{})}})}function _(e){return(0,n.jsxs)("svg",{width:"178",height:"66",viewBox:"0 0 178 66",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"0.261719",y:"0.61499",width:"177.474",height:"64.6513",rx:"5.07069",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"0.578637",y:"0.931908",width:"176.84",height:"64.0175",rx:"4.75377",stroke:"#060709",strokeOpacity:"0.1",strokeWidth:"0.633837"}),(0,n.jsx)("rect",{x:"10.4023",y:"12.0239",width:"65.919",height:"8.87371",rx:"4.43686",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"10.4023",y:"25.9683",width:"111.555",height:"8.87371",rx:"4.43686",fill:"#2B3245"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_3854_22323)",children:[(0,n.jsx)("path",{d:"M129.564 23.4331C129.564 16.4319 135.24 10.7563 142.241 10.7563H154.918C161.919 10.7563 167.595 16.4319 167.595 23.4331C167.595 30.4342 161.919 36.1098 154.918 36.1098H142.241C135.24 36.1098 129.564 30.4342 129.564 23.4331Z",fill:"url(#paint0_linear_3854_22323)"}),(0,n.jsx)("path",{d:"M129.628 23.4331C129.628 16.4669 135.275 10.8197 142.241 10.8197H154.918C161.884 10.8197 167.531 16.4669 167.531 23.4331C167.531 30.3992 161.884 36.0464 154.918 36.0464H142.241C135.275 36.0464 129.628 30.3992 129.628 23.4331Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.126767"})]}),(0,n.jsx)("rect",{x:"10.4023",y:"46.2512",width:"157.191",height:"8.87371",rx:"4.43686",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_3854_22323",x:"124.132",y:"7.13442",width:"48.8951",height:"36.2193",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"1.81096"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"2.71644"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3854_22323"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3854_22323",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_3854_22323",x1:"148.58",y1:"10.7563",x2:"148.58",y2:"36.1098",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]})]})]})}function f(e){return(0,n.jsxs)("svg",{width:"178",height:"66",viewBox:"0 0 178 66",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"0.261719",y:"0.61499",width:"177.474",height:"64.6513",rx:"5.07069",fill:"white"}),(0,n.jsx)("rect",{x:"0.578637",y:"0.931908",width:"176.84",height:"64.0175",rx:"4.75377",stroke:"#060709",strokeOpacity:"0.1",strokeWidth:"0.633837"}),(0,n.jsx)("rect",{x:"10.4023",y:"12.0239",width:"65.919",height:"8.87371",rx:"4.43686",fill:"#060709",fillOpacity:"0.3"}),(0,n.jsx)("rect",{x:"10.4023",y:"25.9683",width:"111.555",height:"8.87371",rx:"4.43686",fill:"#060709",fillOpacity:"0.3"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_3854_22323)",children:[(0,n.jsx)("path",{d:"M129.564 23.4331C129.564 16.4319 135.24 10.7563 142.241 10.7563H154.918C161.919 10.7563 167.595 16.4319 167.595 23.4331C167.595 30.4342 161.919 36.1098 154.918 36.1098H142.241C135.24 36.1098 129.564 30.4342 129.564 23.4331Z",fill:"url(#paint0_linear_3854_22323)"}),(0,n.jsx)("path",{d:"M129.628 23.4331C129.628 16.4669 135.275 10.8197 142.241 10.8197H154.918C161.884 10.8197 167.531 16.4669 167.531 23.4331C167.531 30.3992 161.884 36.0464 154.918 36.0464H142.241C135.275 36.0464 129.628 30.3992 129.628 23.4331Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.126767"})]}),(0,n.jsx)("rect",{x:"10.4023",y:"46.2512",width:"157.191",height:"8.87371",rx:"4.43686",fill:"#060709",fillOpacity:"0.3"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_3854_22323",x:"124.132",y:"7.13442",width:"48.8951",height:"36.2193",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"1.81096"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"2.71644"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3854_22323"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3854_22323",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_3854_22323",x1:"148.58",y1:"10.7563",x2:"148.58",y2:"36.1098",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]})]})]})}function h(e){var{theme:t}=e;return(0,n.jsx)(a,{theme:t,components:{dark:(0,n.jsx)(_,{}),light:(0,n.jsx)(f,{})}})}function x(e){return(0,n.jsxs)("svg",{width:"576",height:"288",viewBox:"0 0 576 288",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"208.5",y:"88.5",width:"159",height:"199",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"208.5",y:"88.5",width:"159",height:"199",rx:"7.5",stroke:"url(#paint0_linear_4453_179036)"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_4453_179036)",children:[(0,n.jsx)("path",{d:"M248 116.8C248 112.32 248 110.079 248.872 108.368C249.639 106.863 250.863 105.639 252.368 104.872C254.079 104 256.32 104 260.8 104H315.2C319.68 104 321.921 104 323.632 104.872C325.137 105.639 326.361 106.863 327.128 108.368C328 110.079 328 112.32 328 116.8V187.2C328 191.68 328 193.921 327.128 195.632C326.361 197.137 325.137 198.361 323.632 199.128C321.921 200 319.68 200 315.2 200H260.8C256.32 200 254.079 200 252.368 199.128C250.863 198.361 249.639 197.137 248.872 195.632C248 193.921 248 191.68 248 187.2V116.8Z",fill:"url(#paint1_linear_4453_179036)"}),(0,n.jsx)("path",{d:"M248.1 116.8C248.1 114.558 248.1 112.883 248.209 111.554C248.317 110.226 248.533 109.253 248.961 108.413C249.718 106.927 250.927 105.718 252.413 104.961C253.253 104.533 254.226 104.317 255.554 104.209C256.883 104.1 258.558 104.1 260.8 104.1H315.2C317.442 104.1 319.117 104.1 320.446 104.209C321.774 104.317 322.747 104.533 323.587 104.961C325.073 105.718 326.282 106.927 327.039 108.413C327.467 109.253 327.683 110.226 327.791 111.554C327.9 112.883 327.9 114.558 327.9 116.8V187.2C327.9 189.442 327.9 191.117 327.791 192.446C327.683 193.774 327.467 194.747 327.039 195.587C326.282 197.073 325.073 198.282 323.587 199.039C322.747 199.467 321.774 199.683 320.446 199.791C319.117 199.9 317.442 199.9 315.2 199.9H260.8C258.558 199.9 256.883 199.9 255.554 199.791C254.226 199.683 253.253 199.467 252.413 199.039C250.927 198.282 249.718 197.073 248.961 195.587C248.533 194.747 248.317 193.774 248.209 192.446C248.1 191.117 248.1 189.442 248.1 187.2V116.8Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{x:"248",y:"226",width:"80",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"224",y:"248",width:"128",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_4453_179036",x:"239.429",y:"98.2857",width:"97.1429",height:"113.143",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4453_179036"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4453_179036",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_4453_179036",x1:"288",y1:"88",x2:"288",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4453_179036",x1:"288",y1:"104",x2:"288",y2:"200",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FAC818"})]})]})]})}function g(e){return(0,n.jsxs)("svg",{width:"576",height:"288",viewBox:"0 0 576 288",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"208",y:"88",width:"160",height:"200",rx:"8",fill:"white"}),(0,n.jsx)("rect",{x:"208.5",y:"88.5",width:"159",height:"199",rx:"7.5",stroke:"url(#paint0_linear_6466_153347)",strokeOpacity:"0.24"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_6466_153347)",children:[(0,n.jsx)("path",{d:"M248 116.8C248 112.32 248 110.079 248.872 108.368C249.639 106.863 250.863 105.639 252.368 104.872C254.079 104 256.32 104 260.8 104H315.2C319.68 104 321.921 104 323.632 104.872C325.137 105.639 326.361 106.863 327.128 108.368C328 110.079 328 112.32 328 116.8V187.2C328 191.68 328 193.921 327.128 195.632C326.361 197.137 325.137 198.361 323.632 199.128C321.921 200 319.68 200 315.2 200H260.8C256.32 200 254.079 200 252.368 199.128C250.863 198.361 249.639 197.137 248.872 195.632C248 193.921 248 191.68 248 187.2V116.8Z",fill:"url(#paint1_linear_6466_153347)"}),(0,n.jsx)("path",{d:"M315.2 199.9H260.8C258.558 199.9 256.883 199.9 255.554 199.791C254.226 199.683 253.253 199.467 252.413 199.039C250.927 198.282 249.718 197.073 248.961 195.587C248.533 194.747 248.317 193.774 248.209 192.446C248.1 191.117 248.1 189.442 248.1 187.2V116.8C248.1 114.558 248.1 112.883 248.209 111.554C248.317 110.226 248.533 109.253 248.961 108.413C249.718 106.927 250.927 105.718 252.413 104.961C253.253 104.533 254.226 104.317 255.554 104.209C256.883 104.1 258.558 104.1 260.8 104.1H315.2C317.442 104.1 319.117 104.1 320.446 104.209C321.774 104.317 322.747 104.533 323.587 104.961C325.073 105.718 326.282 106.927 327.039 108.413C327.467 109.253 327.683 110.226 327.791 111.554C327.9 112.883 327.9 114.558 327.9 116.8V187.2C327.9 189.442 327.9 191.117 327.791 192.446C327.683 193.774 327.467 194.747 327.039 195.587C326.282 197.073 325.073 198.282 323.587 199.039C322.747 199.467 321.774 199.683 320.446 199.791C319.117 199.9 317.442 199.9 315.2 199.9Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{opacity:"0.12",x:"244",y:"226",width:"88",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"224",y:"248",width:"128",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_6466_153347",x:"239.429",y:"98.2857",width:"97.1429",height:"113.143",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_6466_153347"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_6466_153347",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_6466_153347",x1:"288",y1:"88",x2:"288",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_6466_153347",x1:"288",y1:"104",x2:"288",y2:"200",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FAC818"})]})]})]})}function y(e){var{theme:t}=e;return(0,n.jsx)(a,{theme:t,components:{dark:(0,n.jsx)(x,{}),light:(0,n.jsx)(g,{})}})}function b(e){return(0,n.jsxs)("svg",{width:"576",height:"288",viewBox:"0 0 576 288",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"148.5",y:"136.5",width:"279",height:"151",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"148.5",y:"136.5",width:"279",height:"151",rx:"7.5",stroke:"url(#paint0_linear_7238_218933)"}),(0,n.jsx)("rect",{x:"164",y:"152",width:"104",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"164",y:"174",width:"248",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"164",y:"196",width:"248",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"164",y:"226",width:"120",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_7238_218933)",children:[(0,n.jsx)("path",{d:"M164 262.4C164 260.16 164 259.04 164.436 258.184C164.819 257.431 165.431 256.819 166.184 256.436C167.04 256 168.16 256 170.4 256H173.6C175.84 256 176.96 256 177.816 256.436C178.569 256.819 179.181 257.431 179.564 258.184C180 259.04 180 260.16 180 262.4V265.6C180 267.84 180 268.96 179.564 269.816C179.181 270.569 178.569 271.181 177.816 271.564C176.96 272 175.84 272 173.6 272H170.4C168.16 272 167.04 272 166.184 271.564C165.431 271.181 164.819 270.569 164.436 269.816C164 268.96 164 267.84 164 265.6V262.4Z",fill:"url(#paint1_linear_7238_218933)"}),(0,n.jsx)("path",{d:"M170.4 272.5H173.6H173.623C174.724 272.5 175.581 272.5 176.268 272.444C176.966 272.387 177.533 272.269 178.043 272.01C178.89 271.578 179.578 270.89 180.01 270.043C180.269 269.533 180.387 268.966 180.444 268.268C180.5 267.581 180.5 266.724 180.5 265.623V265.6V262.4V262.377C180.5 261.276 180.5 260.419 180.444 259.732C180.387 259.034 180.269 258.467 180.01 257.957C179.578 257.11 178.89 256.422 178.043 255.99C177.533 255.731 176.966 255.613 176.268 255.556C175.581 255.5 174.724 255.5 173.623 255.5H173.6H170.4H170.377C169.276 255.5 168.419 255.5 167.732 255.556C167.034 255.613 166.467 255.731 165.957 255.99C165.11 256.422 164.422 257.11 163.99 257.957C163.731 258.467 163.613 259.034 163.556 259.732C163.5 260.419 163.5 261.276 163.5 262.377V262.4V265.6V265.623C163.5 266.724 163.5 267.581 163.556 268.268C163.613 268.966 163.731 269.533 163.99 270.043C164.422 270.89 165.11 271.578 165.957 272.01C166.467 272.269 167.034 272.387 167.732 272.444C168.419 272.5 169.276 272.5 170.377 272.5H170.4Z",stroke:"white"})]}),(0,n.jsxs)("g",{filter:"url(#filter1_d_7238_218933)",children:[(0,n.jsx)("path",{d:"M176 262.4C176 260.16 176 259.04 176.436 258.184C176.819 257.431 177.431 256.819 178.184 256.436C179.04 256 180.16 256 182.4 256H185.6C187.84 256 188.96 256 189.816 256.436C190.569 256.819 191.181 257.431 191.564 258.184C192 259.04 192 260.16 192 262.4V265.6C192 267.84 192 268.96 191.564 269.816C191.181 270.569 190.569 271.181 189.816 271.564C188.96 272 187.84 272 185.6 272H182.4C180.16 272 179.04 272 178.184 271.564C177.431 271.181 176.819 270.569 176.436 269.816C176 268.96 176 267.84 176 265.6V262.4Z",fill:"url(#paint2_linear_7238_218933)"}),(0,n.jsx)("path",{d:"M182.4 272.5H185.6H185.623C186.724 272.5 187.581 272.5 188.268 272.444C188.966 272.387 189.533 272.269 190.043 272.01C190.89 271.578 191.578 270.89 192.01 270.043C192.269 269.533 192.387 268.966 192.444 268.268C192.5 267.581 192.5 266.724 192.5 265.623V265.6V262.4V262.377C192.5 261.276 192.5 260.419 192.444 259.732C192.387 259.034 192.269 258.467 192.01 257.957C191.578 257.11 190.89 256.422 190.043 255.99C189.533 255.731 188.966 255.613 188.268 255.556C187.581 255.5 186.724 255.5 185.623 255.5H185.6H182.4H182.377C181.276 255.5 180.419 255.5 179.732 255.556C179.034 255.613 178.467 255.731 177.957 255.99C177.11 256.422 176.422 257.11 175.99 257.957C175.731 258.467 175.613 259.034 175.556 259.732C175.5 260.419 175.5 261.276 175.5 262.377V262.4V265.6V265.623C175.5 266.724 175.5 267.581 175.556 268.268C175.613 268.966 175.731 269.533 175.99 270.043C176.422 270.89 177.11 271.578 177.957 272.01C178.467 272.269 179.034 272.387 179.732 272.444C180.419 272.5 181.276 272.5 182.377 272.5H182.4Z",stroke:"white"})]}),(0,n.jsxs)("g",{filter:"url(#filter2_d_7238_218933)",children:[(0,n.jsx)("path",{d:"M188 262.4C188 260.16 188 259.04 188.436 258.184C188.819 257.431 189.431 256.819 190.184 256.436C191.04 256 192.16 256 194.4 256H197.6C199.84 256 200.96 256 201.816 256.436C202.569 256.819 203.181 257.431 203.564 258.184C204 259.04 204 260.16 204 262.4V265.6C204 267.84 204 268.96 203.564 269.816C203.181 270.569 202.569 271.181 201.816 271.564C200.96 272 199.84 272 197.6 272H194.4C192.16 272 191.04 272 190.184 271.564C189.431 271.181 188.819 270.569 188.436 269.816C188 268.96 188 267.84 188 265.6V262.4Z",fill:"url(#paint3_linear_7238_218933)"}),(0,n.jsx)("path",{d:"M194.4 272.5H197.6H197.623C198.724 272.5 199.581 272.5 200.268 272.444C200.966 272.387 201.533 272.269 202.043 272.01C202.89 271.578 203.578 270.89 204.01 270.043C204.269 269.533 204.387 268.966 204.444 268.268C204.5 267.581 204.5 266.724 204.5 265.623V265.6V262.4V262.377C204.5 261.276 204.5 260.419 204.444 259.732C204.387 259.034 204.269 258.467 204.01 257.957C203.578 257.11 202.89 256.422 202.043 255.99C201.533 255.731 200.966 255.613 200.268 255.556C199.581 255.5 198.724 255.5 197.623 255.5H197.6H194.4H194.377C193.276 255.5 192.419 255.5 191.732 255.556C191.034 255.613 190.467 255.731 189.957 255.99C189.11 256.422 188.422 257.11 187.99 257.957C187.731 258.467 187.613 259.034 187.556 259.732C187.5 260.419 187.5 261.276 187.5 262.377V262.4V265.6V265.623C187.5 266.724 187.5 267.581 187.556 268.268C187.613 268.966 187.731 269.533 187.99 270.043C188.422 270.89 189.11 271.578 189.957 272.01C190.467 272.269 191.034 272.387 191.732 272.444C192.419 272.5 193.276 272.5 194.377 272.5H194.4Z",stroke:"white"})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_7238_218933",x:"154.429",y:"249.286",width:"35.1429",height:"35.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_7238_218933"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_7238_218933",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter1_d_7238_218933",x:"166.429",y:"249.286",width:"35.1429",height:"35.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_7238_218933"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_7238_218933",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter2_d_7238_218933",x:"178.429",y:"249.286",width:"35.1429",height:"35.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_7238_218933"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_7238_218933",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_7238_218933",x1:"288",y1:"136",x2:"288",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_7238_218933",x1:"172",y1:"256",x2:"172",y2:"272",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear_7238_218933",x1:"184",y1:"256",x2:"184",y2:"272",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FAC818"})]}),(0,n.jsxs)("linearGradient",{id:"paint3_linear_7238_218933",x1:"196",y1:"256",x2:"196",y2:"272",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#133BFE"})]})]})]})}function j(e){return(0,n.jsxs)("svg",{width:"576",height:"288",viewBox:"0 0 576 288",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"148",y:"136",width:"280",height:"152",rx:"8",fill:"#F9F9F9"}),(0,n.jsx)("rect",{x:"148.5",y:"136.5",width:"279",height:"151",rx:"7.5",stroke:"url(#paint0_linear_7238_190934)",strokeOpacity:"0.24"}),(0,n.jsx)("rect",{opacity:"0.12",x:"164",y:"152",width:"104",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"164",y:"174",width:"248",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"164",y:"196",width:"248",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"164",y:"226",width:"120",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_7238_190934)",children:[(0,n.jsx)("path",{d:"M164 262.4C164 260.16 164 259.04 164.436 258.184C164.819 257.431 165.431 256.819 166.184 256.436C167.04 256 168.16 256 170.4 256H173.6C175.84 256 176.96 256 177.816 256.436C178.569 256.819 179.181 257.431 179.564 258.184C180 259.04 180 260.16 180 262.4V265.6C180 267.84 180 268.96 179.564 269.816C179.181 270.569 178.569 271.181 177.816 271.564C176.96 272 175.84 272 173.6 272H170.4C168.16 272 167.04 272 166.184 271.564C165.431 271.181 164.819 270.569 164.436 269.816C164 268.96 164 267.84 164 265.6V262.4Z",fill:"url(#paint1_linear_7238_190934)"}),(0,n.jsx)("path",{d:"M170.4 272.5H173.6H173.623C174.724 272.5 175.581 272.5 176.268 272.444C176.966 272.387 177.533 272.269 178.043 272.01C178.89 271.578 179.578 270.89 180.01 270.043C180.269 269.533 180.387 268.966 180.444 268.268C180.5 267.581 180.5 266.724 180.5 265.623V265.6V262.4V262.377C180.5 261.276 180.5 260.419 180.444 259.732C180.387 259.034 180.269 258.467 180.01 257.957C179.578 257.11 178.89 256.422 178.043 255.99C177.533 255.731 176.966 255.613 176.268 255.556C175.581 255.5 174.724 255.5 173.623 255.5H173.6H170.4H170.377C169.276 255.5 168.419 255.5 167.732 255.556C167.034 255.613 166.467 255.731 165.957 255.99C165.11 256.422 164.422 257.11 163.99 257.957C163.731 258.467 163.613 259.034 163.556 259.732C163.5 260.419 163.5 261.276 163.5 262.377V262.4V265.6V265.623C163.5 266.724 163.5 267.581 163.556 268.268C163.613 268.966 163.731 269.533 163.99 270.043C164.422 270.89 165.11 271.578 165.957 272.01C166.467 272.269 167.034 272.387 167.732 272.444C168.419 272.5 169.276 272.5 170.377 272.5H170.4Z",stroke:"white"})]}),(0,n.jsxs)("g",{filter:"url(#filter1_d_7238_190934)",children:[(0,n.jsx)("path",{d:"M176 262.4C176 260.16 176 259.04 176.436 258.184C176.819 257.431 177.431 256.819 178.184 256.436C179.04 256 180.16 256 182.4 256H185.6C187.84 256 188.96 256 189.816 256.436C190.569 256.819 191.181 257.431 191.564 258.184C192 259.04 192 260.16 192 262.4V265.6C192 267.84 192 268.96 191.564 269.816C191.181 270.569 190.569 271.181 189.816 271.564C188.96 272 187.84 272 185.6 272H182.4C180.16 272 179.04 272 178.184 271.564C177.431 271.181 176.819 270.569 176.436 269.816C176 268.96 176 267.84 176 265.6V262.4Z",fill:"url(#paint2_linear_7238_190934)"}),(0,n.jsx)("path",{d:"M182.4 272.5H185.6H185.623C186.724 272.5 187.581 272.5 188.268 272.444C188.966 272.387 189.533 272.269 190.043 272.01C190.89 271.578 191.578 270.89 192.01 270.043C192.269 269.533 192.387 268.966 192.444 268.268C192.5 267.581 192.5 266.724 192.5 265.623V265.6V262.4V262.377C192.5 261.276 192.5 260.419 192.444 259.732C192.387 259.034 192.269 258.467 192.01 257.957C191.578 257.11 190.89 256.422 190.043 255.99C189.533 255.731 188.966 255.613 188.268 255.556C187.581 255.5 186.724 255.5 185.623 255.5H185.6H182.4H182.377C181.276 255.5 180.419 255.5 179.732 255.556C179.034 255.613 178.467 255.731 177.957 255.99C177.11 256.422 176.422 257.11 175.99 257.957C175.731 258.467 175.613 259.034 175.556 259.732C175.5 260.419 175.5 261.276 175.5 262.377V262.4V265.6V265.623C175.5 266.724 175.5 267.581 175.556 268.268C175.613 268.966 175.731 269.533 175.99 270.043C176.422 270.89 177.11 271.578 177.957 272.01C178.467 272.269 179.034 272.387 179.732 272.444C180.419 272.5 181.276 272.5 182.377 272.5H182.4Z",stroke:"white"})]}),(0,n.jsxs)("g",{filter:"url(#filter2_d_7238_190934)",children:[(0,n.jsx)("path",{d:"M188 262.4C188 260.16 188 259.04 188.436 258.184C188.819 257.431 189.431 256.819 190.184 256.436C191.04 256 192.16 256 194.4 256H197.6C199.84 256 200.96 256 201.816 256.436C202.569 256.819 203.181 257.431 203.564 258.184C204 259.04 204 260.16 204 262.4V265.6C204 267.84 204 268.96 203.564 269.816C203.181 270.569 202.569 271.181 201.816 271.564C200.96 272 199.84 272 197.6 272H194.4C192.16 272 191.04 272 190.184 271.564C189.431 271.181 188.819 270.569 188.436 269.816C188 268.96 188 267.84 188 265.6V262.4Z",fill:"url(#paint3_linear_7238_190934)"}),(0,n.jsx)("path",{d:"M194.4 272.5H197.6H197.623C198.724 272.5 199.581 272.5 200.268 272.444C200.966 272.387 201.533 272.269 202.043 272.01C202.89 271.578 203.578 270.89 204.01 270.043C204.269 269.533 204.387 268.966 204.444 268.268C204.5 267.581 204.5 266.724 204.5 265.623V265.6V262.4V262.377C204.5 261.276 204.5 260.419 204.444 259.732C204.387 259.034 204.269 258.467 204.01 257.957C203.578 257.11 202.89 256.422 202.043 255.99C201.533 255.731 200.966 255.613 200.268 255.556C199.581 255.5 198.724 255.5 197.623 255.5H197.6H194.4H194.377C193.276 255.5 192.419 255.5 191.732 255.556C191.034 255.613 190.467 255.731 189.957 255.99C189.11 256.422 188.422 257.11 187.99 257.957C187.731 258.467 187.613 259.034 187.556 259.732C187.5 260.419 187.5 261.276 187.5 262.377V262.4V265.6V265.623C187.5 266.724 187.5 267.581 187.556 268.268C187.613 268.966 187.731 269.533 187.99 270.043C188.422 270.89 189.11 271.578 189.957 272.01C190.467 272.269 191.034 272.387 191.732 272.444C192.419 272.5 193.276 272.5 194.377 272.5H194.4Z",stroke:"white"})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_7238_190934",x:"154.429",y:"249.286",width:"35.1429",height:"35.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_7238_190934"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_7238_190934",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter1_d_7238_190934",x:"166.429",y:"249.286",width:"35.1429",height:"35.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_7238_190934"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_7238_190934",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter2_d_7238_190934",x:"178.429",y:"249.286",width:"35.1429",height:"35.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_7238_190934"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_7238_190934",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_7238_190934",x1:"288",y1:"136",x2:"288",y2:"288",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_7238_190934",x1:"172",y1:"256",x2:"172",y2:"272",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear_7238_190934",x1:"184",y1:"256",x2:"184",y2:"272",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FAC818"})]}),(0,n.jsxs)("linearGradient",{id:"paint3_linear_7238_190934",x1:"196",y1:"256",x2:"196",y2:"272",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#133BFE"})]})]})]})}function w(e){var{theme:t}=e;return(0,n.jsx)(a,{theme:t,components:{dark:(0,n.jsx)(b,{}),light:(0,n.jsx)(j,{})}})}function C(e){return(0,n.jsxs)("svg",{width:"360",height:"248",viewBox:"0 0 360 248",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"80.5",y:"0.5",width:"279",height:"71",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"80.5",y:"0.5",width:"279",height:"71",rx:"7.5",stroke:"url(#paint0_linear_116_6085)"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_116_6085)",children:[(0,n.jsx)("path",{d:"M96 28.8C96 24.3196 96 22.0794 96.8719 20.3681C97.6389 18.8628 98.8628 17.6389 100.368 16.8719C102.079 16 104.32 16 108.8 16H123.2C127.68 16 129.921 16 131.632 16.8719C133.137 17.6389 134.361 18.8628 135.128 20.3681C136 22.0794 136 24.3196 136 28.8V43.2C136 47.6804 136 49.9206 135.128 51.6319C134.361 53.1372 133.137 54.3611 131.632 55.1281C129.921 56 127.68 56 123.2 56H108.8C104.32 56 102.079 56 100.368 55.1281C98.8628 54.3611 97.6389 53.1372 96.8719 51.6319C96 49.9206 96 47.6804 96 43.2V28.8Z",fill:"url(#paint1_linear_116_6085)"}),(0,n.jsx)("path",{d:"M96.1 28.8C96.1 26.5581 96.1001 24.8828 96.2087 23.5538C96.3171 22.2259 96.5335 21.2527 96.961 20.4135C97.7184 18.927 98.927 17.7184 100.413 16.961C101.253 16.5335 102.226 16.3171 103.554 16.2087C104.883 16.1001 106.558 16.1 108.8 16.1H123.2C125.442 16.1 127.117 16.1001 128.446 16.2087C129.774 16.3171 130.747 16.5335 131.587 16.961C133.073 17.7184 134.282 18.927 135.039 20.4135C135.467 21.2527 135.683 22.2259 135.791 23.5538C135.9 24.8828 135.9 26.5581 135.9 28.8V43.2C135.9 45.4419 135.9 47.1172 135.791 48.4462C135.683 49.7741 135.467 50.7473 135.039 51.5865C134.282 53.073 133.073 54.2816 131.587 55.039C130.747 55.4665 129.774 55.6828 128.446 55.7913C127.117 55.8999 125.442 55.9 123.2 55.9H108.8C106.558 55.9 104.883 55.8999 103.554 55.7913C102.226 55.6828 101.253 55.4665 100.413 55.039C98.927 54.2816 97.7184 53.073 96.961 51.5865C96.5335 50.7473 96.3171 49.7741 96.2087 48.4462C96.1001 47.1172 96.1 45.4419 96.1 43.2V28.8Z",stroke:"black",stopOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{x:"148",y:"18",width:"120",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"148",y:"40",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"0.5",y:"88.5",width:"279",height:"71",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"0.5",y:"88.5",width:"279",height:"71",rx:"7.5",stroke:"url(#paint2_linear_116_6085)"}),(0,n.jsxs)("g",{filter:"url(#filter1_d_116_6085)",children:[(0,n.jsx)("path",{d:"M16 116.8C16 112.32 16 110.079 16.8719 108.368C17.6389 106.863 18.8628 105.639 20.3681 104.872C22.0794 104 24.3196 104 28.8 104H43.2C47.6804 104 49.9206 104 51.6319 104.872C53.1372 105.639 54.3611 106.863 55.1281 108.368C56 110.079 56 112.32 56 116.8V131.2C56 135.68 56 137.921 55.1281 139.632C54.3611 141.137 53.1372 142.361 51.6319 143.128C49.9206 144 47.6804 144 43.2 144H28.8C24.3196 144 22.0794 144 20.3681 143.128C18.8628 142.361 17.6389 141.137 16.8719 139.632C16 137.921 16 135.68 16 131.2V116.8Z",fill:"url(#paint3_linear_116_6085)"}),(0,n.jsx)("path",{d:"M16.1 116.8C16.1 114.558 16.1001 112.883 16.2087 111.554C16.3171 110.226 16.5335 109.253 16.961 108.413C17.7184 106.927 18.927 105.718 20.4135 104.961C21.2527 104.533 22.2259 104.317 23.5538 104.209C24.8828 104.1 26.5581 104.1 28.8 104.1H43.2C45.4419 104.1 47.1172 104.1 48.4462 104.209C49.7741 104.317 50.7473 104.533 51.5865 104.961C53.073 105.718 54.2816 106.927 55.039 108.413C55.4665 109.253 55.6828 110.226 55.7913 111.554C55.8999 112.883 55.9 114.558 55.9 116.8V131.2C55.9 133.442 55.8999 135.117 55.7913 136.446C55.6828 137.774 55.4665 138.747 55.039 139.587C54.2816 141.073 53.073 142.282 51.5865 143.039C50.7473 143.467 49.7741 143.683 48.4462 143.791C47.1172 143.9 45.4419 143.9 43.2 143.9H28.8C26.5581 143.9 24.8828 143.9 23.5538 143.791C22.2259 143.683 21.2527 143.467 20.4135 143.039C18.927 142.282 17.7184 141.073 16.961 139.587C16.5335 138.747 16.3171 137.774 16.2087 136.446C16.1001 135.117 16.1 133.442 16.1 131.2V116.8Z",stroke:"black",stopOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{x:"68",y:"106",width:"120",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"68",y:"128",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"80.5",y:"176.5",width:"279",height:"71",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"80.5",y:"176.5",width:"279",height:"71",rx:"7.5",stroke:"url(#paint4_linear_116_6085)"}),(0,n.jsxs)("g",{filter:"url(#filter2_d_116_6085)",children:[(0,n.jsx)("path",{d:"M96 204.8C96 200.32 96 198.079 96.8719 196.368C97.6389 194.863 98.8628 193.639 100.368 192.872C102.079 192 104.32 192 108.8 192H123.2C127.68 192 129.921 192 131.632 192.872C133.137 193.639 134.361 194.863 135.128 196.368C136 198.079 136 200.32 136 204.8V219.2C136 223.68 136 225.921 135.128 227.632C134.361 229.137 133.137 230.361 131.632 231.128C129.921 232 127.68 232 123.2 232H108.8C104.32 232 102.079 232 100.368 231.128C98.8628 230.361 97.6389 229.137 96.8719 227.632C96 225.921 96 223.68 96 219.2V204.8Z",fill:"url(#paint5_linear_116_6085)"}),(0,n.jsx)("path",{d:"M96.1 204.8C96.1 202.558 96.1001 200.883 96.2087 199.554C96.3171 198.226 96.5335 197.253 96.961 196.413C97.7184 194.927 98.927 193.718 100.413 192.961C101.253 192.533 102.226 192.317 103.554 192.209C104.883 192.1 106.558 192.1 108.8 192.1H123.2C125.442 192.1 127.117 192.1 128.446 192.209C129.774 192.317 130.747 192.533 131.587 192.961C133.073 193.718 134.282 194.927 135.039 196.413C135.467 197.253 135.683 198.226 135.791 199.554C135.9 200.883 135.9 202.558 135.9 204.8V219.2C135.9 221.442 135.9 223.117 135.791 224.446C135.683 225.774 135.467 226.747 135.039 227.587C134.282 229.073 133.073 230.282 131.587 231.039C130.747 231.467 129.774 231.683 128.446 231.791C127.117 231.9 125.442 231.9 123.2 231.9H108.8C106.558 231.9 104.883 231.9 103.554 231.791C102.226 231.683 101.253 231.467 100.413 231.039C98.927 230.282 97.7184 229.073 96.961 227.587C96.5335 226.747 96.3171 225.774 96.2087 224.446C96.1001 223.117 96.1 221.442 96.1 219.2V204.8Z",stroke:"black",stopOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{x:"148",y:"193",width:"120",height:"16",rx:"8",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"148",y:"217",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_116_6085",x:"87.4286",y:"10.2857",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_116_6085"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_116_6085",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter1_d_116_6085",x:"7.42857",y:"98.2857",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[(0,n.jsx)("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_116_6085"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_116_6085",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter2_d_116_6085",x:"87.4286",y:"186.286",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_116_6085"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_116_6085",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_116_6085",x1:"220",y1:"0",x2:"220",y2:"72",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_116_6085",x1:"116",y1:"16",x2:"116",y2:"56",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear_116_6085",x1:"140",y1:"88",x2:"140",y2:"160",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint3_linear_116_6085",x1:"36",y1:"104",x2:"36",y2:"144",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FAC818"})]}),(0,n.jsxs)("linearGradient",{id:"paint4_linear_116_6085",x1:"220",y1:"176",x2:"220",y2:"248",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint5_linear_116_6085",x1:"116",y1:"192",x2:"116",y2:"232",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3D8DF3"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#133BFE"})]})]})]})}function k(e){return(0,n.jsxs)("svg",{width:"360",height:"248",viewBox:"0 0 360 248",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"80",width:"280",height:"72",rx:"8",fill:"white"}),(0,n.jsx)("rect",{x:"80.5",y:"0.5",width:"279",height:"71",rx:"7.5",stroke:"url(#paint0_linear_4434_146978)",stopOpacity:"0.24"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_4434_146978)",children:[(0,n.jsx)("path",{d:"M96 28.8C96 24.3196 96 22.0794 96.8719 20.3681C97.6389 18.8628 98.8628 17.6389 100.368 16.8719C102.079 16 104.32 16 108.8 16H123.2C127.68 16 129.921 16 131.632 16.8719C133.137 17.6389 134.361 18.8628 135.128 20.3681C136 22.0794 136 24.3196 136 28.8V43.2C136 47.6804 136 49.9206 135.128 51.6319C134.361 53.1372 133.137 54.3611 131.632 55.1281C129.921 56 127.68 56 123.2 56H108.8C104.32 56 102.079 56 100.368 55.1281C98.8628 54.3611 97.6389 53.1372 96.8719 51.6319C96 49.9206 96 47.6804 96 43.2V28.8Z",fill:"url(#paint1_linear_4434_146978)"}),(0,n.jsx)("path",{d:"M96.1 28.8C96.1 26.5581 96.1001 24.8828 96.2087 23.5538C96.3171 22.2259 96.5335 21.2527 96.961 20.4135C97.7184 18.927 98.927 17.7184 100.413 16.961C101.253 16.5335 102.226 16.3171 103.554 16.2087C104.883 16.1001 106.558 16.1 108.8 16.1H123.2C125.442 16.1 127.117 16.1001 128.446 16.2087C129.774 16.3171 130.747 16.5335 131.587 16.961C133.073 17.7184 134.282 18.927 135.039 20.4135C135.467 21.2527 135.683 22.2259 135.791 23.5538C135.9 24.8828 135.9 26.5581 135.9 28.8V43.2C135.9 45.4419 135.9 47.1172 135.791 48.4462C135.683 49.7741 135.467 50.7473 135.039 51.5865C134.282 53.073 133.073 54.2816 131.587 55.039C130.747 55.4665 129.774 55.6828 128.446 55.7913C127.117 55.8999 125.442 55.9 123.2 55.9H108.8C106.558 55.9 104.883 55.8999 103.554 55.7913C102.226 55.6828 101.253 55.4665 100.413 55.039C98.927 54.2816 97.7184 53.073 96.961 51.5865C96.5335 50.7473 96.3171 49.7741 96.2087 48.4462C96.1001 47.1172 96.1 45.4419 96.1 43.2V28.8Z",stopOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{opacity:"0.12",x:"148",y:"18",width:"120",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"148",y:"40",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{y:"88",width:"280",height:"72",rx:"8",fill:"white"}),(0,n.jsx)("rect",{x:"0.5",y:"88.5",width:"279",height:"71",rx:"7.5",stroke:"url(#paint2_linear_4434_146978)",stopOpacity:"0.24"}),(0,n.jsxs)("g",{filter:"url(#filter1_d_4434_146978)",children:[(0,n.jsx)("path",{d:"M16 116.8C16 112.32 16 110.079 16.8719 108.368C17.6389 106.863 18.8628 105.639 20.3681 104.872C22.0794 104 24.3196 104 28.8 104H43.2C47.6804 104 49.9206 104 51.6319 104.872C53.1372 105.639 54.3611 106.863 55.1281 108.368C56 110.079 56 112.32 56 116.8V131.2C56 135.68 56 137.921 55.1281 139.632C54.3611 141.137 53.1372 142.361 51.6319 143.128C49.9206 144 47.6804 144 43.2 144H28.8C24.3196 144 22.0794 144 20.3681 143.128C18.8628 142.361 17.6389 141.137 16.8719 139.632C16 137.921 16 135.68 16 131.2V116.8Z",fill:"url(#paint3_linear_4434_146978)"}),(0,n.jsx)("path",{d:"M16.1 116.8C16.1 114.558 16.1001 112.883 16.2087 111.554C16.3171 110.226 16.5335 109.253 16.961 108.413C17.7184 106.927 18.927 105.718 20.4135 104.961C21.2527 104.533 22.2259 104.317 23.5538 104.209C24.8828 104.1 26.5581 104.1 28.8 104.1H43.2C45.4419 104.1 47.1172 104.1 48.4462 104.209C49.7741 104.317 50.7473 104.533 51.5865 104.961C53.073 105.718 54.2816 106.927 55.039 108.413C55.4665 109.253 55.6828 110.226 55.7913 111.554C55.8999 112.883 55.9 114.558 55.9 116.8V131.2C55.9 133.442 55.8999 135.117 55.7913 136.446C55.6828 137.774 55.4665 138.747 55.039 139.587C54.2816 141.073 53.073 142.282 51.5865 143.039C50.7473 143.467 49.7741 143.683 48.4462 143.791C47.1172 143.9 45.4419 143.9 43.2 143.9H28.8C26.5581 143.9 24.8828 143.9 23.5538 143.791C22.2259 143.683 21.2527 143.467 20.4135 143.039C18.927 142.282 17.7184 141.073 16.961 139.587C16.5335 138.747 16.3171 137.774 16.2087 136.446C16.1001 135.117 16.1 133.442 16.1 131.2V116.8Z",stopOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{opacity:"0.12",x:"68",y:"106",width:"120",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"68",y:"128",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"80",y:"176",width:"280",height:"72",rx:"8",fill:"white"}),(0,n.jsx)("rect",{x:"80.5",y:"176.5",width:"279",height:"71",rx:"7.5",stroke:"url(#paint4_linear_4434_146978)",stopOpacity:"0.24"}),(0,n.jsxs)("g",{filter:"url(#filter2_d_4434_146978)",children:[(0,n.jsx)("path",{d:"M96 204.8C96 200.32 96 198.079 96.8719 196.368C97.6389 194.863 98.8628 193.639 100.368 192.872C102.079 192 104.32 192 108.8 192H123.2C127.68 192 129.921 192 131.632 192.872C133.137 193.639 134.361 194.863 135.128 196.368C136 198.079 136 200.32 136 204.8V219.2C136 223.68 136 225.921 135.128 227.632C134.361 229.137 133.137 230.361 131.632 231.128C129.921 232 127.68 232 123.2 232H108.8C104.32 232 102.079 232 100.368 231.128C98.8628 230.361 97.6389 229.137 96.8719 227.632C96 225.921 96 223.68 96 219.2V204.8Z",fill:"url(#paint5_linear_4434_146978)"}),(0,n.jsx)("path",{d:"M96.1 204.8C96.1 202.558 96.1001 200.883 96.2087 199.554C96.3171 198.226 96.5335 197.253 96.961 196.413C97.7184 194.927 98.927 193.718 100.413 192.961C101.253 192.533 102.226 192.317 103.554 192.209C104.883 192.1 106.558 192.1 108.8 192.1H123.2C125.442 192.1 127.117 192.1 128.446 192.209C129.774 192.317 130.747 192.533 131.587 192.961C133.073 193.718 134.282 194.927 135.039 196.413C135.467 197.253 135.683 198.226 135.791 199.554C135.9 200.883 135.9 202.558 135.9 204.8V219.2C135.9 221.442 135.9 223.117 135.791 224.446C135.683 225.774 135.467 226.747 135.039 227.587C134.282 229.073 133.073 230.282 131.587 231.039C130.747 231.467 129.774 231.683 128.446 231.791C127.117 231.9 125.442 231.9 123.2 231.9H108.8C106.558 231.9 104.883 231.9 103.554 231.791C102.226 231.683 101.253 231.467 100.413 231.039C98.927 230.282 97.7184 229.073 96.961 227.587C96.5335 226.747 96.3171 225.774 96.2087 224.446C96.1001 223.117 96.1 221.442 96.1 219.2V204.8Z",stopOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{opacity:"0.12",x:"148",y:"193",width:"120",height:"16",rx:"8",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"148",y:"217",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_4434_146978",x:"87.4286",y:"10.2857",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4434_146978"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4434_146978",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter1_d_4434_146978",x:"7.42857",y:"98.2857",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[(0,n.jsx)("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4434_146978"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4434_146978",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter2_d_4434_146978",x:"87.4286",y:"186.286",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4434_146978"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4434_146978",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_4434_146978",x1:"220",y1:"0",x2:"220",y2:"72",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#EBEBED"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#CFDBD7",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4434_146978",x1:"116",y1:"16",x2:"116",y2:"56",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear_4434_146978",x1:"140",y1:"88",x2:"140",y2:"160",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#EBEBED"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#CFDBD7",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint3_linear_4434_146978",x1:"36",y1:"104",x2:"36",y2:"144",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FAC818"})]}),(0,n.jsxs)("linearGradient",{id:"paint4_linear_4434_146978",x1:"220",y1:"176",x2:"220",y2:"248",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#EBEBED"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#CFDBD7",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint5_linear_4434_146978",x1:"116",y1:"192",x2:"116",y2:"232",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#3D8DF3"}),(0,n.jsx)("stop",{offset:"0.0001",stopColor:"#5CBCB0"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#133BFE"})]})]})]})}function N(e){var{theme:t}=e;return(0,n.jsx)(a,{theme:t,components:{dark:(0,n.jsx)(C,{}),light:(0,n.jsx)(k,{})}})}function S(e){return(0,n.jsxs)("svg",{width:"280",height:"102",viewBox:"0 0 280 102",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"279",height:"101",rx:"7.5",fill:"#1C2333"}),(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"279",height:"101",rx:"7.5",stroke:"url(#paint0_linear_4513_103137)"}),(0,n.jsx)("rect",{x:"16",y:"18",width:"104",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{x:"16",y:"40",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_4513_103137)",children:[(0,n.jsx)("path",{d:"M224 22.4C224 20.1598 224 19.0397 224.436 18.184C224.819 17.4314 225.431 16.8195 226.184 16.436C227.04 16 228.16 16 230.4 16H257.6C259.84 16 260.96 16 261.816 16.436C262.569 16.8195 263.181 17.4314 263.564 18.184C264 19.0397 264 20.1598 264 22.4V49.6C264 51.8402 264 52.9603 263.564 53.816C263.181 54.5686 262.569 55.1805 261.816 55.564C260.96 56 259.84 56 257.6 56H230.4C228.16 56 227.04 56 226.184 55.564C225.431 55.1805 224.819 54.5686 224.436 53.816C224 52.9603 224 51.8402 224 49.6V22.4Z",fill:"url(#paint1_linear_4513_103137)"}),(0,n.jsx)("path",{d:"M224.1 22.4C224.1 21.2782 224.1 20.4429 224.154 19.781C224.208 19.1201 224.315 18.6408 224.525 18.2294C224.899 17.4956 225.496 16.899 226.229 16.5251C226.641 16.3155 227.12 16.2082 227.781 16.1542C228.443 16.1001 229.278 16.1 230.4 16.1H257.6C258.722 16.1 259.557 16.1001 260.219 16.1542C260.88 16.2082 261.359 16.3155 261.771 16.5251C262.504 16.899 263.101 17.4956 263.475 18.2294C263.685 18.6408 263.792 19.1201 263.846 19.781C263.9 20.4429 263.9 21.2782 263.9 22.4V49.6C263.9 50.7218 263.9 51.5571 263.846 52.219C263.792 52.8799 263.685 53.3592 263.475 53.7706C263.101 54.5044 262.504 55.101 261.771 55.4749C261.359 55.6845 260.88 55.7918 260.219 55.8458C259.557 55.8999 258.722 55.9 257.6 55.9H230.4C229.278 55.9 228.443 55.8999 227.781 55.8458C227.12 55.7918 226.641 55.6845 226.229 55.4749C225.496 55.101 224.899 54.5044 224.525 53.7706C224.315 53.3592 224.208 52.8799 224.154 52.219C224.1 51.5571 224.1 50.7218 224.1 49.6V22.4Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{x:"16",y:"72",width:"248",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_4513_103137",x:"215.429",y:"10.2857",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4513_103137"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4513_103137",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_4513_103137",x1:"140",y1:"0",x2:"140",y2:"102",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4513_103137",x1:"244",y1:"16",x2:"244",y2:"56",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]})]})]})}function E(e){return(0,n.jsxs)("svg",{width:"280",height:"102",viewBox:"0 0 280 102",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{width:"280",height:"102",rx:"8",fill:"#F9F9F9"}),(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"279",height:"101",rx:"7.5",stroke:"url(#paint0_linear_4513_102766)",strokeOpacity:"0.24"}),(0,n.jsx)("rect",{opacity:"0.12",x:"16",y:"18",width:"104",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsx)("rect",{opacity:"0.12",x:"16",y:"40",width:"196",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("g",{filter:"url(#filter0_d_4513_102766)",children:[(0,n.jsx)("path",{d:"M224 22.4C224 20.1598 224 19.0397 224.436 18.184C224.819 17.4314 225.431 16.8195 226.184 16.436C227.04 16 228.16 16 230.4 16H257.6C259.84 16 260.96 16 261.816 16.436C262.569 16.8195 263.181 17.4314 263.564 18.184C264 19.0397 264 20.1598 264 22.4V49.6C264 51.8402 264 52.9603 263.564 53.816C263.181 54.5686 262.569 55.1805 261.816 55.564C260.96 56 259.84 56 257.6 56H230.4C228.16 56 227.04 56 226.184 55.564C225.431 55.1805 224.819 54.5686 224.436 53.816C224 52.9603 224 51.8402 224 49.6V22.4Z",fill:"url(#paint1_linear_4513_102766)"}),(0,n.jsx)("path",{d:"M224.1 22.4C224.1 21.2782 224.1 20.4429 224.154 19.781C224.208 19.1201 224.315 18.6408 224.525 18.2294C224.899 17.4956 225.496 16.899 226.229 16.5251C226.641 16.3155 227.12 16.2082 227.781 16.1542C228.443 16.1001 229.278 16.1 230.4 16.1H257.6C258.722 16.1 259.557 16.1001 260.219 16.1542C260.88 16.2082 261.359 16.3155 261.771 16.5251C262.504 16.899 263.101 17.4956 263.475 18.2294C263.685 18.6408 263.792 19.1201 263.846 19.781C263.9 20.4429 263.9 21.2782 263.9 22.4V49.6C263.9 50.7218 263.9 51.5571 263.846 52.219C263.792 52.8799 263.685 53.3592 263.475 53.7706C263.101 54.5044 262.504 55.101 261.771 55.4749C261.359 55.6845 260.88 55.7918 260.219 55.8458C259.557 55.8999 258.722 55.9 257.6 55.9H230.4C229.278 55.9 228.443 55.8999 227.781 55.8458C227.12 55.7918 226.641 55.6845 226.229 55.4749C225.496 55.101 224.899 54.5044 224.525 53.7706C224.315 53.3592 224.208 52.8799 224.154 52.219C224.1 51.5571 224.1 50.7218 224.1 49.6V22.4Z",stroke:"black",strokeOpacity:"0.08",strokeWidth:"0.2"})]}),(0,n.jsx)("rect",{opacity:"0.12",x:"16",y:"72",width:"248",height:"14",rx:"7",fill:"#2B3245"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_d_4513_102766",x:"215.429",y:"10.2857",width:"57.1429",height:"57.1429",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"2.85714"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"4.28571"}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4513_102766"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4513_102766",result:"shape"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_4513_102766",x1:"140",y1:"0",x2:"140",y2:"102",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#38415A"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#2B3245",stopOpacity:"0.4"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_4513_102766",x1:"244",y1:"16",x2:"244",y2:"56",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#F45D68"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#FFCA00"})]})]})]})}function T(e){var{theme:t}=e;return(0,n.jsx)(a,{theme:t,components:{dark:(0,n.jsx)(S,{}),light:(0,n.jsx)(E,{})}})}var I=r("50558"),P=(e,t)=>{switch(e){case"bot":return(0,n.jsx)(T,{theme:t});case"common":return(0,n.jsx)(N,{theme:t});case"widget":return(0,n.jsx)(v,{theme:t});case"social":return(0,n.jsx)(y,{theme:t});case"recommend":return(0,n.jsx)(w,{theme:t});case"social-scene-flow":return(0,n.jsx)(h,{theme:t});default:return null}};function A(e){var{type:t,theme:r,position:o}=e;return(0,n.jsx)("div",{className:i()(I.Z["search-no-card"],{"items-start":"top"===o,"items-center":"center"===o,"items-end":"bottom"===o}),children:(0,n.jsx)("div",{className:I.Z["".concat(t,"-no-card")],children:P(t,r)})})}var D=r("431169");function L(e){var{title:t,description:r="",className:o,type:a,button:s,notFound:d="",isNotFound:c=!0,cardPosition:p="bottom",cardClassName:m,textClassName:v}=e,{theme:_}=(0,l.Fg)();return(0,n.jsxs)("div",{className:i()(D.Z["search-no-result"],o),children:[(0,n.jsxs)("div",{className:i()(D.Z["search-no-wrapper"],m),children:[(0,n.jsx)(u,{theme:_}),(0,n.jsx)(A,{theme:_,position:p,type:a})]}),(0,n.jsxs)("div",{className:i()(D.Z["search-no-tips"],v),children:[(0,n.jsx)("div",{className:i()(D.Z["search-no-title"],"coz-fg-plus text-center font-normal"),children:""!==d?d:t}),(0,n.jsx)("div",{className:i()(D.Z["search-no-desc"],"coz-fg-dim text-center font-normal",{hidden:c}),children:r}),(0,n.jsx)("div",{children:!c&&s})]})]})}},581259:function(e,t,r){r.d(t,{cg:()=>l,VF:()=>s,_5:()=>m,HW:()=>a,jG:()=>v,Qb:()=>d,C5:()=>c,Cx:()=>u,CG:()=>p});var n,o=r("336205"),i=r("458949");o.o.t("form_mode"),o.o.t("code_mode");var l=[{label:o.o.t("create_plugin_modal_header"),value:1},{label:o.o.t("create_plugin_modal_query"),value:2}],a={header_list:[{type:"title",text:o.o.t("create_plugin_modal_header_list")},{type:"text",text:o.o.t("create_plugin_modal_header_list1")}],auth:[{type:"title",text:o.o.t("create_plugin_modal_info_all")},{type:"br"},{type:"title",text:o.o.t("create_plugin_modal_info_None1")},{type:"text",text:o.o.t("create_plugin_modal_info_None2")},{type:"br"},{type:"title",text:o.o.t("create_plugin_modal_info_Service1")},{type:"text",text:o.o.t("create_plugin_modal_info_Service2")},{type:"br"},{type:"title",text:o.o.t("create_plugin_modal_info_Oauth1")},{type:"text",text:o.o.t("create_plugin_modal_info_Oauth2")}],location:[{type:"title",text:o.o.t("plugin_location_info_all")},{type:"br"},{type:"title",text:o.o.t("plugin_location_info_query")},{type:"text",text:o.o.t("plugin_location_info_query1")},{type:"demo",text:o.o.t("plugin_location_info_query2")},{type:"br"},{type:"title",text:o.o.t("plugin_location_header")},{type:"text",text:o.o.t("plugin_location_header1")},{type:"demo",text:o.o.t("plugin_location_header2")}],service_token:[{type:"title",text:o.o.t("create_plugin_modal_Servicetoken_info1")},{type:"text",text:o.o.t("create_plugin_modal_Servicetoken_info2")}],key:[{type:"title",text:o.o.t("create_plugin_modal_Parameter_info1")},{type:"text",text:o.o.t("create_plugin_modal_Parameter_info2")}],client_id:[{type:"text",text:o.o.t("create_plugin_modal_client_id4")},{type:"demo",text:o.o.t("create_plugin_modal_client_id5")}],client_secret:[{type:"text",text:o.o.t("create_plugin_modal_client_secret4")}],client_url:[{type:"text",text:o.o.t("create_plugin_modal_client_url_info1")},{type:"demo",text:o.o.t("create_plugin_modal_client_url_info2")}],scope:[{type:"text",text:o.o.t("create_plugin_modal_scope_info1")},{type:"demo",text:o.o.t("create_plugin_modal_scope_info2")}],authorization_url:[{type:"text",text:o.o.t("create_plugin_modal_authorization_url_info1")},{type:"demo",text:o.o.t("create_plugin_modal_authorization_url_info2")}],authorization_content_type:[{type:"text",text:o.o.t("create_plugin_modal_authorization_content_type_info1")},{type:"demo",text:o.o.t("create_plugin_modal_authorization_content_type_info2")}],creation_method:[{type:"title",text:o.o.t("plugin_creation_method_hover_tip_using_existing_services_title")},{type:"text",text:o.o.t("plugin_creation_method_hover_tip_using_existing_services_desc")}],private_link_id:[{type:"title",text:o.o.t("vpc_plugin_create_plugin_1")},{type:"text",text:o.o.t("vpc_plugin_tooltips")}]},s={client_id:o.o.t("create_plugin_modal_client_id2"),client_secret:o.o.t("create_plugin_modal_client_secret2"),client_url:o.o.t("create_plugin_modal_client_url_empty"),scope:o.o.t("create_plugin_modal_scope_empty"),authorization_url:o.o.t("create_plugin_modal_authorization_url_empty"),authorization_content_type:o.o.t("create_plugin_modal_authorization_content_type_empty"),service_token:o.o.t("create_plugin_modal_Servicetoken_empty"),key:o.o.t("create_plugin_modal_Parameter_empty")},d="".concat(i.zV.PLUGIN,"-").concat(i.x9.COZE);"".concat(i.zV.PLUGIN,"-").concat(i.x9.IDE),"".concat(i.zV.LOCAL,"-").concat(i.x9.COZE);var c=()=>a.creation_method,u=[{label:"TokenExchange",value:i.qJ.TokenExchange},{label:"ClientCredential",value:i.qJ.ClientCredential}],p=new Map([[i.vw.DebugWaiting,{label:o.o.t("plugin_api_type_fail"),color:"red"}],[i.vw.DebugPassed,{label:o.o.t("plugin_api_type_pass"),color:"green"}]]),m=new Map([[i.Yz.ONLINE,{label:o.o.t("plugin_service_status_online"),color:"var(--plugin-unpublished-color)"}],[i.Yz.OFFLINE,{label:o.o.t("plugin_service_status_offline"),color:"var(--plugin-published-color)"}]]);var v=((n={}).DEFAULT="default",n.CREATE_TOOL="create_tool",n.SELECT_TOOL="select_tool",n.PUHSLISH="publish",n)},177001:function(e,t,r){r.d(t,{oK:()=>m,CZ:()=>d,I4:()=>a,Qv:()=>p,zv:()=>u,ej:()=>s});var n,o,i=r("151064"),l=()=>{console.log("unImplement void func")};function a(e){return{node:(0,i.jsx)(i.Fragment,{}),open:l,close:l}}var s=((n={})[n.AddSpace=0]="AddSpace",n[n.NewModel=1]="NewModel",n[n.ProTemplate=2]="ProTemplate",n[n.AddSpaceMember=3]="AddSpaceMember",n[n.Collaborate=4]="Collaborate",n[n.CopyResourceCrossSpace=5]="CopyResourceCrossSpace",n[n.API=6]="API",n[n.AddVoice=7]="AddVoice",n[n.RTC=8]="RTC",n[n.ExportLog=9]="ExportLog",n[n.FilterLog=10]="FilterLog",n);function d(e){return!0}var c=()=>{console.log("unImplement void func")};function u(e){return{node:(0,i.jsx)(i.Fragment,{}),open:c,close:c}}var p=((o={})[o.Knowledge=0]="Knowledge",o[o.Token=1]="Token",o);function m(e){return(0,i.jsx)(i.Fragment,{})}r("193177"),r("873291")},215451:function(e,t,r){r.d(t,{LZ:()=>u,th:()=>m,aZ:()=>f.aZ,D1:()=>_});var n,o=r("825955"),i=r("808549"),l=r("120454"),a=r("479910"),s=r("598208");var d=((n={})[n.Free=0]="Free",n[n.PremiumLite=10]="PremiumLite",n[n.Premium=15]="Premium",n[n.PremiumPlus=20]="PremiumPlus",n[n.V1ProInstance=100]="V1ProInstance",n[n.ProPersonal=110]="ProPersonal",n[n.Team=120]="Team",n[n.Enterprise=130]="Enterprise",n),c={polling:!1,plans:[],subs:{},currentPlan:{},hasTrial:!1,connections:[],benefit:{user_basic_info:{user_level:d.Free}},plansCN:[],volcanoInfo:{}},u=(0,s.Ue)()((0,a.mW)((e,t)=>(0,l._)((0,i._)({},c),{reset:()=>{console.log("unImplement usePremiumStore reset ")},setPolling:e=>{console.log("unImplement usePremiumStore setPolling ")},fetchPremiumPlans:(0,o._)(function*(){var{plans:e,subs:r,hasTrial:n}=t();return yield 0,{plans:e,subs:r,hasTrial:n}}),setPremiumPlansCN:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e({plansCN:t})},fetchPremiumPlan:(0,o._)(function*(){return yield 0,t().currentPlan}),cancelCurrentPlan:()=>{console.log("unImplement usePremiumStore cancelCurrentPlan ")},renewCurrentPlan:e=>{console.log("unImplement usePremiumStore renewCurrentPlan ")},fetchConnections:(0,o._)(function*(){yield 0,console.log("unImplement usePremiumStore fetchConnections ")}),disconnectUser:e=>{console.log("unImplement usePremiumStore disconnectUser ")},setUserBenefit:e=>{console.log("unImplement usePremiumStore setUserBenefit ")},setVolcanoInfo:e=>{console.log("unImplement usePremiumStore setVolcanoInfo ")}}),{enabled:!1,name:"botStudio.premiumStore"})),p={name:"",level:d.Free,compareLevel:d.Free,currPlan:{},nextPlan:{},accountPlan:{},instanceStatus:1,isOverdue:!1,isExpired:!1,isTerminated:!1,maxMember:-1};function m(){return p}var v={isFree:!1,isPremiumPlus:!1,hasLowLevelActive:!1,hasHighLevelActive:!1,sub:{},activeSub:{}};function _(){return v}var f=r("622103")},228962:function(e,t,r){r.d(t,{ob:()=>I,pn:()=>E,A2:()=>O,Np:()=>D,RQ:()=>T,EA:()=>Z,zO:()=>F,sF:()=>P,av:()=>A});var n,o,i=r("151064"),l=r("455069"),a=r("716894"),s=r("992499"),d=r("363036"),c=r("458620"),u=r("727914"),p=r("479910"),m=r("598208"),v=()=>(0,m.Ue)()((0,p.mW)((e,t)=>({isVisible:!1,setVisible:r=>e({isVisible:"boolean"==typeof r?r:r(t().isVisible)},!1,"setVisible")}),{enabled:!1,name:"botStudio.plugin-history-panel-ui"})),_=r("825955"),f=r("808549"),h=r("120454"),x=r("61111"),g=r("336205"),y=r("775699"),b=r("382534"),j=e=>"[PluginStore.Error]: ".concat(e),w=r("458949"),C={[w.wA.Owner]:g.o.t("team_management_role_owner",{},"Owner"),[w.wA.Admin]:g.o.t("team_management_role_admin",{},"Admin"),[w.wA.Member]:g.o.t("team_management_role_member",{},"Member"),[w.wA.Default]:"-"},k=e=>{var{pluginID:t,spaceID:r,projectID:n,version:o}=e;return(0,m.Ue)()((0,p.mW)((0,p.XR)((e,i)=>({version:o,canEdit:!o,isUnlocking:!1,pluginId:t,spaceID:r,projectID:n,pluginInfo:{},initSuccessed:!1,getIsIdePlugin:()=>{var{pluginInfo:e}=i();return(null==e?void 0:e.creation_method)===w.x9.IDE},setInitSuccessed:t=>e((0,x.Uy)(e=>{e.initSuccessed=t}),!1,"setInitSuccessed"),setPluginInfo:t=>e((0,x.Uy)(e=>{e.pluginInfo=t}),!1,"setPluginInfo"),setUpdatedInfo:t=>e((0,x.Uy)(e=>{e.updatedInfo=t}),!1,"setUpdatedInfo"),initUserPluginAuth:(0,_._)(function*(){var r,{setCanEdit:l}=i(),a=yield b.Js.GetUserAuthority({project_id:n,plugin_id:t,creation_method:w.x9.COZE});if(0!==a.code)throw new u.sH(c.b.normalError,j("auth init"));e((0,x.Uy)(e=>{e.auth=a.data}),!1,"initUserPluginAuth"),l(!!(null===(r=a.data)||void 0===r?void 0:r.can_edit)&&!o)}),setCanEdit(t){e((0,x.Uy)(e=>{e.canEdit=t}),!1,"setCanEdit")},wrapWithCheckLock:e=>(0,_._)(function*(){var{checkPluginIsLockedByOthers:t}=i();if(!(yield t()))e()}),initPlugin:(0,_._)(function*(){var{pluginId:e,setPluginInfo:t}=i(),r=yield b.Js.GetPluginInfo({plugin_id:e||"",preview_version_ts:o});if((null==r?void 0:r.code)!==0)throw new u.sH(c.b.normalError,j("getPluginInfo error"));t((0,h._)((0,f._)({},r),{plugin_id:e||""}))}),initTool:(0,_._)(function*(){var{pluginId:e,setUpdatedInfo:t}=i(),r=yield b.Js.GetUpdatedAPIs({plugin_id:e||""},{__disableErrorToast:!0});if((null==r?void 0:r.code)!==0)throw new u.sH(c.b.normalError,j("getToolInfo error"));t({updated_api_names:(null==r?void 0:r.updated_api_names)||[],created_api_names:(null==r?void 0:r.created_api_names)||[]})}),init:(0,_._)(function*(){var{initPlugin:e,initTool:t,initUserPluginAuth:r,setInitSuccessed:n}=i();yield Promise.all([e(),t(),r()]),n(!0)}),checkPluginIsLockedByOthers:(0,_._)(function*(){var{pluginId:e,getIsIdePlugin:t}=i();if(t())return!1;var r=yield b.Js.CheckAndLockPluginEdit({plugin_id:e});if(0!==r.code)return!1;var{data:n}=r,o=null==n?void 0:n.user;return(null==n?!!void 0:!!n.Occupied)&&!!o&&!o.self&&(y.M5.info({okText:g.o.t("guidance_got_it"),title:g.o.t("plugin_team_edit_tip_unable_to_edit"),content:"".concat(o.name,"(").concat(C[o.space_roly_type],") ").concat(g.o.t("plugin_team_edit_tip_another_user_is_editing")),hasCancel:!1}),!0)}),unlockPlugin:(0,_._)(function*(){var{pluginId:t,canEdit:r,isUnlocking:n,getIsIdePlugin:o}=i();if(!o()&&!!r&&!n)try{e((0,x.Uy)(e=>{e.isUnlocking=!0}),!1,"unlocking-true");var l=yield b.Js.UnlockPluginEdit({plugin_id:t});if(0!==l.code)throw new u.sH(c.b.normalError,j("unlock"))}finally{e((0,x.Uy)(e=>{e.isUnlocking=!1}),!1,"unlocking-false")}}),updatePluginInfoByImmer:t=>e((0,x.Uy)(e=>{t(e.pluginInfo)}),!1,"updatePluginInfoByImmer")})),{enabled:!1,name:"botStudio.botPlugin"}))},N=(0,l.createContext)({storeRef:{plugin:void 0},callbacks:{},resourceNavigate:{},memorizedStoreSet:null}),S=(0,l.createContext)({pluginHistoryController:{current:null},registryPluginHistoryController:()=>0}),E=e=>{var t,{pluginID:r,spaceID:n,projectID:o,version:a,children:s,onUpdateDisplayName:c,onStatusChange:u,resourceNavigate:p}=e,m=(0,l.useRef)({}),_=(0,d.Z)(()=>v(),[]),f=(0,l.useRef)(null);return!(null===(t=m.current)||void 0===t?void 0:t.plugin)&&(m.current.plugin=k({pluginID:r,spaceID:n,projectID:o,version:a})),(0,i.jsx)(N.Provider,{value:{storeRef:m.current,memorizedStoreSet:{usePluginHistoryPanelUIStore:_},callbacks:{onUpdateDisplayName:c,onStatusChange:u},resourceNavigate:p},children:(0,i.jsx)(S.Provider,{value:{pluginHistoryController:f,registryPluginHistoryController:e=>{f.current=e}},children:s})})},T=e=>{var t=(0,l.useContext)(N);if(!t.storeRef.plugin)throw new u.sH(c.b.normalError,"plugin store context");return(0,a.s)(t.storeRef.plugin,e,s.X)},I=()=>{var e=(0,l.useContext)(N);if(!e.storeRef.plugin)throw new u.sH(c.b.normalError,"plugin store context");return e.storeRef.plugin},P=()=>{var{callbacks:{onStatusChange:e,onUpdateDisplayName:t}}=(0,l.useContext)(N);return{onStatusChange:e,onUpdateDisplayName:t}},A=()=>{var{resourceNavigate:e}=(0,l.useContext)(N);return e},D=()=>{var{pluginHistoryController:e}=(0,l.useContext)(S);return e},L=e=>fetch("/api/plugin_api/unlock_plugin_edit",{keepalive:!0,method:"POST",body:JSON.stringify({plugin_id:e}),headers:{"Content-Type":"application/json"}}),O=e=>{(0,l.useEffect)(()=>{var t=()=>L(e);return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[])};var Z=(n=(0,_._)(function*(e){var t=yield b.Js.CheckAndLockPluginEdit({plugin_id:e});if(0!==t.code)return!1;var{data:r}=t,n=null==r?void 0:r.user;return(null==r?!!void 0:!!r.Occupied)&&!!n&&!n.self&&(y.M5.info({okText:g.o.t("guidance_got_it"),title:g.o.t("plugin_team_edit_tip_unable_to_edit"),content:"".concat(n.name,"(").concat(C[n.space_roly_type],") ").concat(g.o.t("plugin_team_edit_tip_another_user_is_editing")),hasCancel:!1}),!0)}),function(e){return n.apply(this,arguments)});var F=(o=(0,_._)(function*(e){if(0!==(yield b.Js.UnlockPluginEdit({plugin_id:e})).code)throw new u.sH(c.b.normalError,j("unlock out"))}),function(e){return o.apply(this,arguments)})},474523:function(e,t,r){r.d(t,{q9:()=>i,Hz:()=>l,OW:()=>o});var n=r("450562"),o=e=>{var{loopSelected:t}=e,r={[n.nyy.LLM]:!0,[n.nyy.Api]:!0,[n.nyy.Code]:!0,[n.nyy.Dataset]:!0,[n.nyy.If]:!0,[n.nyy.SubWorkflow]:!0,[n.nyy.Database]:!0,[n.nyy.Output]:!0,[n.nyy.Text]:!0,[n.nyy.Question]:!0,[n.nyy.Break]:t,[n.nyy.SetVariable]:t,[n.nyy.Continue]:t,[n.nyy.Loop]:!0,[n.nyy.Intent]:!0,[n.nyy.DatasetWrite]:!0,[n.nyy.Batch]:!0,[n.nyy.Input]:!0,[n.nyy.Comment]:!0,[n.nyy.VariableMerge]:!0,[n.nyy.QueryMessageList]:!0,[n.nyy.ClearContext]:!0,[n.nyy.CreateConversation]:!0,[n.nyy.VariableAssign]:!0,[n.nyy.Http]:!0,[n.nyy.DatabaseUpdate]:!0,[n.nyy.DatabaseQuery]:!0,[n.nyy.DatabaseDelete]:!0,[n.nyy.DatabaseCreate]:!0,[n.nyy.JsonStringify]:!0,[n.nyy.UpdateConversation]:!0,[n.nyy.DeleteConversation]:!0,[n.nyy.QueryConversationList]:!0,[n.nyy.QueryConversationHistory]:!0,[n.nyy.CreateMessage]:!0,[n.nyy.UpdateMessage]:!0,[n.nyy.DeleteMessage]:!0};return Object.keys(r).filter(e=>r[e]).map(e=>e)};function i(e){throw Error("The UPLOAD_CDN environment variable is not configured")}function l(){return{isSupportImageflowNodes:!0,isLoading:!1}}},362416:function(e,t,r){r.r(t),r.d(t,{convertSchema:()=>function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(n>r)throw Error("Max depth exceeded");var o=[];return Object.keys(t).forEach(i=>{var l=t[i];switch(typeof l){case"string":o.push({name:i,type:1});break;case"number":Number.isInteger(l)?o.push({name:i,type:2}):o.push({name:i,type:4});break;case"boolean":o.push({name:i,type:3});break;case"object":if(null===l)break;if(Array.isArray(l)){if(l.length>0)switch(typeof l[0]){case"string":default:o.push({name:i,type:99});break;case"number":Number.isInteger(l[0])?o.push({name:i,type:100}):o.push({name:i,type:102});break;case"boolean":o.push({name:i,type:101});break;case"object":o.push({name:i,type:103,children:e(l[0],r,n+1)})}else o.push({name:i,type:99})}else o.push({name:i,type:6,children:e(l,r,n+1)});break;default:throw console.log("value,to default",l),Error("ContainsInvalidValue")}}),o},Editor:()=>j,Previewer:()=>w});var n=r("526900"),o="#151B27",i=r("151064"),l=r("455069"),a=r("825955"),s=r("808549"),d=(0,l.lazy)((0,a._)(function*(){var{PythonEditor:e}=yield r.e("8672").then(r.bind(r,32630));return{default:e}})),c=e=>(0,i.jsx)(l.Suspense,{children:(0,i.jsx)(d,(0,s._)({},e))}),u=(0,l.lazy)((0,a._)(function*(){var{TypescriptEditor:e}=yield Promise.all([r.e("4900"),r.e("9567")]).then(r.bind(r,147837));return{default:e}})),p=e=>(0,i.jsx)(l.Suspense,{children:(0,i.jsx)(u,(0,s._)({},e))}),m=e=>"python"===(0,l.useMemo)(()=>e.language||e.defaultLanguage,[e.defaultLanguage,e.language])?(0,i.jsx)(c,(0,s._)({},e)):(0,i.jsx)(p,(0,s._)({},e)),v=r("120454"),_=r("336205"),f=r("915757"),h=r("674343"),x=r("450562"),g=r("426998"),{Text:y}=h.ZT,b=e=>{var{children:t,title:r,language:n,onClose:o,onTestRun:a,testRunIcon:s,onLanguageSelect:d,languageTemplates:c}=e,u=(0,l.useMemo)(()=>null==c?void 0:c.map(e=>({value:e.language,label:e.displayName})),[c]),{getNodeSetterId:p}=(0,x.FCD)(),m=p("biz-editor-layout");return(0,i.jsxs)("div",{className:g.Z.container,children:[(0,i.jsxs)("div",{className:g.Z.header,children:[(0,i.jsxs)("div",{className:g.Z.title,children:[(0,i.jsx)("div",{className:g.Z["title-icon"],children:(0,i.jsx)(f.OXw,{})}),(0,i.jsx)("div",{className:g.Z["title-content"],children:r}),(0,i.jsx)(h.u,{content:(0,i.jsxs)("div",{children:[_.o.t("code_node_more_info"),(0,i.jsx)(y,{link:{href:"/docs/guides/code_node",target:"_blank"},children:_.o.t("code_node_help_doc")})]}),theme:"dark",children:(0,i.jsx)(h.Ph,{onChange:e=>null==d?void 0:d(e),value:n,"data-testid":(0,x.xtp)(m,"language-select"),renderSelectedItem:e=>(0,i.jsxs)("span",{style:{fontSize:12,color:"var(--coz-fg-secondary)"},children:[_.o.t("code_node_language")," ",e.label]}),size:"small",optionList:u})})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)(h.zx,{color:"highlight","data-testid":(0,x.xtp)(m,"test-run"),icon:s?(0,i.jsx)("span",{style:{fontSize:14,display:"flex",alignItems:"center"},children:s}):(0,i.jsx)(f.Y6z,{style:{fontSize:14}}),size:"small",onClick:a,children:_.o.t("code_node_test_code")}),(0,i.jsx)(h.hU,{onClick:o,color:"secondary",size:"small",icon:(0,i.jsx)(f.R$P,{style:{fontSize:18}}),"data-testid":(0,x.xtp)(m,"expand-button")})]})]}),t]})},j=e=>{var t=(0,l.useRef)(void 0),[r,n]=(0,l.useState)(e.defaultLanguage),[o,a]=(0,l.useState)(e.defaultContent);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(b,(0,v._)((0,s._)({},e),{language:r,onLanguageSelect:o=>{var l,s,d,c,u,p=null===(l=e.languageTemplates)||void 0===l?void 0:l.find(e=>e.language===o),m=null===(s=e.languageTemplates)||void 0===s?void 0:s.find(e=>e.language===r);if((null==m?void 0:m.template)===(null===(c=t.current)||void 0===c?void 0:null===(d=c.getValue)||void 0===d?void 0:d.call(c))){n(o),a(null==p?void 0:p.template),null===(u=e.onChange)||void 0===u||u.call(e,(null==p?void 0:p.template)||"",o);return}h.u_.warning({icon:(0,i.jsx)(f.wR2,{style:{color:"rgba(var(--coze-yellow-5), 1)"}}),title:_.o.t("code_node_switch_language"),content:_.o.t("code_node_switch_language_description"),okType:"warning",okText:_.o.t("Confirm"),cancelText:_.o.t("Cancel"),closable:!0,width:448,height:160,onOk:()=>{var t;n(o),a(null==p?void 0:p.template),null===(t=e.onChange)||void 0===t||t.call(e,(null==p?void 0:p.template)||"",o)}})},children:(0,i.jsx)(m,(0,v._)((0,s._)({},e),{defaultContent:o,language:r,didMount:e=>{t.current=e}}))}))})},w=e=>{var t=(0,l.useRef)();return(0,l.useEffect)(()=>{if(!!t.current)e.content!==t.current.getValue()&&t.current.forceSetValue(e.content)},[e.content]),(0,i.jsx)(m,{uuid:"previewer_".concat(new Date().getTime()),height:"".concat(e.height,"px"),defaultLanguage:e.language,defaultContent:e.content,readonly:!0,didMount:e=>{t.current=e}})};n.np.register("code-editor-dark",(0,n.jG)({variant:"dark",settings:{background:o,foreground:"#fff",caret:"#AEAFAD",selection:"#d9d9d942",gutterBackground:o,gutterForeground:"#FFFFFF63",gutterBorderColor:"transparent",gutterBorderWidth:0,lineHighlight:"#272e3d36",bracketColors:["#FFEF61","#DD99FF","#78B0FF"],tooltip:{backgroundColor:"#363D4D",color:"#fff",border:"none"},completionItemHover:{backgroundColor:"#FFFFFF0F"},completionItemSelected:{backgroundColor:"#FFFFFF17"},completionItemIcon:{color:"#FFFFFFC9"},completionItemLabel:{color:"#FFFFFFC9"},completionItemDetail:{color:"#FFFFFF63"}},styles:[]}))},724847:function(e,t,r){r.d(t,{Ys:()=>v,LA:()=>x,xm:()=>i,rZ:()=>f,YN:()=>_,lR:()=>g,nz:()=>s,fP:()=>m,T7:()=>c,ad:()=>p,WC:()=>d,AK:()=>h,PF:()=>l});var n,o=r("455069"),i=function(e){var{autoPlay:t,loop:r,onEnded:n,onLoad:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[l,a]=(0,o.useState)(!1),[s,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(!0),[p,m]=(0,o.useState)(0),[v,_]=(0,o.useState)(0),f=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!!e){var o=e instanceof Blob?URL.createObjectURL(e):e,l=new Audio(o);f.current=l,l.loop=null!=r&&r;var s=()=>{m(l.currentTime)},d=()=>{_(l.duration),m(0),null==i||i(),t&&l.play(),e instanceof Blob&&URL.revokeObjectURL(o)},c=()=>{a(!1),u(!0),m(l.duration),null==n||n()};return l.addEventListener("loadedmetadata",d),l.addEventListener("timeupdate",s),l.addEventListener("ended",c),()=>{l.removeEventListener("loadedmetadata",d),l.removeEventListener("timeupdate",s),l.removeEventListener("ended",c),l.pause(),l.src="",f.current=null}}},[e,t,r,n,i]);var h=(0,o.useCallback)(()=>{f.current&&(f.current.play(),a(!0),d(!1),u(!1))},[]),x=(0,o.useCallback)(()=>{f.current&&(f.current.pause(),a(!1),d(!0))},[]),g=(0,o.useCallback)(()=>{f.current&&(f.current.pause(),f.current.currentTime=0,a(!1),d(!1),u(!0))},[]),y=(0,o.useCallback)(()=>{l?x():h()},[l,h,x]);return{isPlaying:l,isPaused:s,isStopped:c,currentTime:p,duration:v,play:h,pause:x,stop:g,togglePlayPause:y,seek:(0,o.useCallback)(e=>{f.current&&(f.current.currentTime=e,m(e))},[])}};function l(e){return{open:()=>{},modal:null}}var a=r("598208"),s=e=>!1,d=(0,a.Ue)(()=>({rightsInfo:{},getRights:e=>Promise.resolve({})})),c=e=>null,u=r("151064"),p=e=>null,m=e=>null,v=e=>null,_=e=>null,f=e=>{var{children:t}=e;return(0,u.jsx)(u.Fragment,{children:t})};var h=((n={}).PUBLISH_RESULT="publishResult",n.WORKFLOW="workflow",n.WORKFLOW_INFO="workflowDetail",n.WORKFLOW_CASE="workflowCase",n),x=e=>({ModalComponent:null,showModal:e=>null,setSpace:e=>null}),g=()=>({enablePublishEntry:!1})},408487:function(e,t,r){r.d(t,{ztP:()=>o.ztP,OHc:()=>u,fB_:()=>d,zV6:()=>o.zV6,Up9:()=>o.Up9,KNf:()=>o.KNf,vGB:()=>o.vGB,lcl:()=>o.lcl,TvD:()=>o.TvD,GdW:()=>o.GdW,VBX:()=>o.VBX,CPf:()=>o.CPf,MZY:()=>o.MZY,uql:()=>o.uql,n$I:()=>o.n$I,eLL:()=>o.eLL,k5N:()=>o.k5N,KN6:()=>o.KN6,B5l:()=>o.B5l,twY:()=>o.twY,Lo5:()=>o.Lo5,x5o:()=>o.x5o,_Uw:()=>c,BSe:()=>o.BSe,d$J:()=>o.d$J,wz8:()=>o.wz8,XG2:()=>o.XG2,z7A:()=>o.z7A,XQ3:()=>o.XQ3,gfc:()=>o.gfc,Vp9:()=>o.Vp9,MZx:()=>o.MZx,nBi:()=>o.nBi,Xpx:()=>o.Xpx,sL0:()=>o.sL0});var n=r("382534"),o=r("892989"),i=r("808549"),l=r("151064");r("455069");var a=r("178621"),s=r("527116"),d=new a.S;function c(e){return function(t){return(0,l.jsx)(s.aH,{client:d,children:(0,l.jsx)(e,(0,i._)({},t))})}}var u=new Proxy({},{get:(e,t)=>n.OH[t].bind(n.OH)})},267334:function(e,t,r){r.d(t,{Ne:function(){return i},Pz:function(){return d},RV:function(){return o},aW:function(){return c},d9:function(){return a},hh:function(){return s},pj:function(){return l},wl:function(){return n}});var n=()=>{},o="999999",i="BOT_USER_INPUT",l="USER_INPUT",a="CONVERSATION_NAME",s=30,d=/^[a-zA-Z][a-zA-Z0-9_]{0,63}$/,c="playground.node"},450562:function(e,t,r){r.d(t,{sL0:()=>A.sL0,hhB:()=>k.hh,OHc:()=>A.OHc,Iyz:()=>P,d9h:()=>k.d9,nZF:()=>p.nZ,zV6:()=>A.zV6,KNf:()=>A.KNf,Tbq:()=>Z,agJ:()=>S,E7u:()=>O,fB_:()=>A.fB_,lcl:()=>A.lcl,XmD:()=>p.Xm,tnn:()=>p.tn,FCD:()=>q,Gu0:()=>p.Gu,VNC:()=>M,pju:()=>k.pj,VKi:()=>p.VK,YX3:()=>p.YX,CPf:()=>A.CPf,nyy:()=>p.ny,Huc:()=>K,GQ8:()=>V,fwJ:()=>H,IuB:()=>p.Iu,KN6:()=>A.KN6,SMH:()=>p.SM,B5l:()=>A.B5l,m_1:()=>Q,Pz_:()=>k.Pz,xtp:()=>N,ycG:()=>p.yc,Lo5:()=>A.Lo5,Rkg:()=>p.Rk,owu:()=>p.ow,ikd:()=>B,BSe:()=>A.BSe,sSN:()=>p.sS,iBO:()=>X,_Uw:()=>A._Uw,wz8:()=>A.wz8,z7A:()=>A.z7A,$dM:()=>p.$d,XQ3:()=>A.XQ3,vHX:()=>p.vH,vTH:()=>p.vT,kOP:()=>p.kO,nBi:()=>A.nBi,QJG:()=>U,lZh:()=>p.lZ,rsR:()=>Y,Psf:()=>p.Ps,RV6:()=>k.RV,ztP:()=>A.ztP});var n,o,i,l,a,s,d,c,u,p=r("569502"),m=r("335740");var v=((n={}).DEFAULT="default",n.INPUT_PARAMETERS="inputParameters",n.OUTPUTS="outputs",n.DATASET_PARAM="datasetParam",n.LLM_PARAM="llmParam",n.INTENTS="intents",n.CONCAT_RESULT="concatResult",n.CUSTOM_ARRAY_CONCAT_CHAR="customArrayConcatChar",n.CUSTOM_SPLIT_CHAR="customSplitChar",n.REF_INPUT_PARAMETER="refInputParameter",n.VARIABLE_ASSIGN="variableAssign",n.JSON_STRING_PARSER="jsonStringParser",n.IMAGE_REFERENCE_PARSER="imageReferenceParser",n.EXPRESSION_PARSER="expressionParser",n.VARIABLE_MERGE_GROUPS_PARSER="variableMergeGroupsParser",n.DB_FIELDS_PARSER="dbFieldsParser",n.DB_CONDITIONS_PARSER="dbConditionsParser",n),_=["\n","	",".","。",",","，",";","；"," "],f=r("962289");function h(e){var t,r,n,o,i;try{o=new URL(e)}catch(e){return!1}return!!(["image","jpg","jpeg","png"].includes((null===(n=o.searchParams)||void 0===n?void 0:null===(r=n.get("x-wf-file_name"))||void 0===r?void 0:null===(t=r.split("."))||void 0===t?void 0:t.pop())||o.pathname.split(".").pop())&&["cC1ib3Qtd29ya2Zsb3ctc2lnbi5ieXRlZGFuY2UubmV0","cC1ib3Qtd29ya2Zsb3cuYnl0ZWQub3Jn","cC1ib3Qtd29ya2Zsb3cuYnl0ZWRhbmNlLm5ldA==","cDI2LWJvdC13b3JrZmxvdy1zaWduLmJ5dGVpbWcuY29t","cDMtYm90LXdvcmtmbG93LXNpZ24uYnl0ZWltZy5jb20=","cDktYm90LXdvcmtmbG93LXNpZ24uYnl0ZWltZy5jb20="].includes(btoa(null!==(i=o.hostname)&&void 0!==i?i:"")))||!1}var x=e=>{if(!e)return null;var t,r=(0,f.Z)(e,"value.content");if(!r)return null;if("string"==typeof r)return{value:r,isImage:h(r)};if("block-output"===r.source&&(r.name,1))return{value:r.name,isImage:!1};else if("string"==typeof r.source&&r.source.startsWith("global_variable"))return{value:null==r?void 0:null===(t=r.path)||void 0===t?void 0:t.join("."),isImage:!1}},g=e=>[].concat(e).filter(Boolean).map(x).filter(Boolean),y=e=>{var t,r,n=null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.content;if(!!n){if("string"==typeof n)return n;if("object"==typeof n){if("block-output"===n.source&&"string"==typeof n.name)return n.name;if("string"==typeof n.source&&n.source.startsWith("global_variable"))return null==n?void 0:null===(r=n.path)||void 0===r?void 0:r.join(".")}}},b=r("710705"),j=r("391963"),w=r("808549"),C=e=>{var t=[];return Array.isArray(e)?t=e:"object"==typeof e&&Object.keys(e||{}).forEach(r=>{t.push({name:r,input:e[r]})}),t.map(e=>{var t=x((0,f.Z)(e,"input"));return t?(0,w._)({name:e.name},t):null}).filter(Boolean)};v.DEFAULT,v.INPUT_PARAMETERS,v.OUTPUTS,v.DATASET_PARAM,v.LLM_PARAM,v.INTENTS,v.CONCAT_RESULT,v.CUSTOM_ARRAY_CONCAT_CHAR,v.CUSTOM_SPLIT_CHAR,v.REF_INPUT_PARAMETER,v.VARIABLE_ASSIGN,v.JSON_STRING_PARSER,v.IMAGE_REFERENCE_PARSER,v.EXPRESSION_PARSER,v.VARIABLE_MERGE_GROUPS_PARSER,v.DB_FIELDS_PARSER,v.DB_CONDITIONS_PARSER;var k=r("267334"),N=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(e=>!!e).join(".")},S=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return N((null==e?void 0:e.id)?N(k.aW,e.id):"",...r)};r("896335"),r("298203");var E=r("120454"),T=r("813864"),I=e=>{if((null==e?void 0:e.type)===p.Rk.image||(null==e?void 0:e.type)===p.Rk.string&&[p.$d.image,p.$d.svg].includes(null==e?void 0:e.assistType))return!0};function P(e){var t,r,n,{outputData:o,nodeSchema:i,excludeNodeTypes:l=[]}=e;if(!i||!o||l.includes(null==i?void 0:i.type))return[];var a=[];return(a=(null==i?void 0:i.type)===p.ny.End||(null==i?void 0:i.type)===p.ny.Output?null==i?void 0:null===(r=i.data)||void 0===r?void 0:null===(t=r.inputs)||void 0===t?void 0:t.inputParameters:null==i?void 0:null===(n=i.data)||void 0===n?void 0:n.outputs)?(0,T.Z)(a.map(e=>(function e(t,r){var n=[];if(I(r)&&"string"==typeof t&&n.push(t),(null==r?void 0:r.type)===p.Rk.list&&Array.isArray(t)){var o=t.map(t=>e(t,r.schema));n=n.concat(...o)}if((null==r?void 0:r.type)===p.Rk.object){var i=Object.entries(t||{}).map(t=>{var[n,o]=t;return e(o,(r.schema||[]).find(e=>e.name===n))});n=n.concat(...i)}return n})((0,f.Z)(o,null==e?void 0:e.name),(null==e?void 0:e.input)?(0,E._)((0,w._)({},e.input),{name:e.name}):e))).filter(e=>!!e):[]}var A=r("408487"),D=r("297158"),L="workflow",O=D.E7.createReporterWithPreset({namespace:L});function Z(e){var t;null===(t=D.E7.slardarInstance)||void 0===t||t.call(D.E7,"captureException",e,{isErrorBoundary:"false",namespace:L})}var F=r("686436");function M(e,t){return(0,F.vo)(e)?function(e,t){var r=e.getData(F.Ps).formModel.getFormItemValueByPath("/");if(!!r&&"object"==typeof r){var n=z(r,t);return(0,m.Z)(n)}}(e,t):function(e,t){var r=e.getData(F.Ps).formModel,n=[...r.formItemPathMap.keys()].find(e=>e.endsWith(t));if(!!n)return(0,m.Z)(r.getFormItemValueByPath(n))}(e,t)}var z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!!e){if(r.endsWith(t))return e;if("object"==typeof e&&!Array.isArray(e)){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=r?"".concat(r,"/").concat(n):"/".concat(n);if(o.endsWith(t))return e[n];var i=z(e[n],t,o);if(void 0!==i)return i}}if(Array.isArray(e))for(var l=0;l<e.length;l++){var a="".concat(r,"/").concat(l);if(a.endsWith(t))return e[l];var s=z(e[l],t,a);if(void 0!==s)return s}}},R=r("567282"),B=e=>e===R.wz.Workflow||e===R.wz.ChatFlow,V=e=>[k.Ne,k.pj,k.d9].includes(null!=e?e:""),U=e=>[k.Ne,k.pj].includes(null!=e?e:""),H=(e,t)=>{var r=Array.isArray(t)?e=>{t.forEach(t=>t(e))}:t;return u.traverseNodes({value:e},r),e};(o=u||(u={})).traverseNodes=(e,t)=>{var{value:r}=e;if(!!r){if("[object Object]"===Object.prototype.toString.call(r))Object.entries(r).forEach(n=>{var[i,l]=n;return o.traverseNodes({value:l,container:r,key:i,parent:e},t)});else if(Array.isArray(r))for(var n=r.length-1;n>=0;n--){var l=r[n];o.traverseNodes({value:l,container:r,index:n,parent:e},t)}t(i({node:e}))}},i=e=>{var{node:t}=e;return{node:t,setValue:e=>l(t,e),getParents:()=>a(t),getPath:()=>s(t),getStringifyPath:()=>d(t),deleteSelf:()=>c(t)}},l=(e,t)=>{if(!!t&&!!e){e.value=t;var{container:r,key:n,index:o}=e;n&&r?r[n]=t:"number"==typeof o&&(r[o]=t)}},a=e=>{for(var t=[],r=e;r;)t.unshift(r),r=r.parent;return t},s=e=>{var t=[];return a(e).forEach(e=>{e.key?t.unshift(e.key):e.index&&t.unshift(e.index)}),t},d=e=>s(e).reduce((e,t)=>"string"!=typeof t?"".concat(e,"[").concat(t,"]"):/\W/g.test(t)?"".concat(e,'["').concat(t,'"]'):"".concat(e,".").concat(t),""),c=e=>{var{container:t,key:r,index:n}=e;r&&t?delete t[r]:"number"==typeof n&&t.splice(n,1)};var W=r("139454"),G={[W.ow.Image]:["image/*"],[W.ow.Doc]:[".docx",".doc",".pdf"],[W.ow.Audio]:[".mp3",".wav",".aac",".flac",".ogg",".wma",".alac",".mid",".midi",".ac3",".dsd"],[W.ow.Excel]:[".xls",".xlsx",".csv"],[W.ow.Video]:[".mp4",".avi",".mov",".wmv",".flv",".mkv"],[W.ow.Zip]:[".zip",".rar",".7z",".tar",".gz",".bz2"],[W.ow.Code]:[".py",".java",".c",".cpp",".js",".css"],[W.ow.Txt]:[".txt"],[W.ow.Ppt]:[".ppt",".pptx"],[W.ow.Svg]:[".svg"]},K=(e,t)=>{var r,n=W.ow.isArrayType(e)?W.ow.getArraySubType(e):e;return r=n===W.ow.File?(null==t?void 0:t.length)?t.map(e=>{var t;return null===(t=G[e])||void 0===t?void 0:t.join(",")}).join(","):Object.values(G).map(e=>e.join(",")).join(","):(G[n]||[]).join(",")};r("364676");var J=r("727914"),q=()=>{var e=(0,F.PF)();if(!(null==e?void 0:e.id))throw new J.sH("useNodeTestId must be called in a workflow node","");var t=()=>N(k.aW,e.id);return{getNodeTestId:t,getNodeSetterId:e=>N(t(),e),concatTestId:N}},$=r("455069"),X=(0,$.createContext)(void 0);function Y(){return(0,$.useContext)(X)}class Q{get registry(){return this.node.getNodeRegistry()}get inputParameters(){var e,t;return this.registry.getNodeInputParameters?this.registry.getNodeInputParameters(this.node):(null===(e=this.node.getNodeMeta())||void 0===e?void 0:e.inputParametersPath)?this.node.getData(F.Ps).formModel.getFormItemValueByPath(null===(t=this.node.getNodeMeta())||void 0===t?void 0:t.inputParametersPath):this.getFormValueByPathEnds("/inputParameters")}get outputs(){var e;if(this.registry.getNodeOutputs)return this.registry.getNodeOutputs(this.node);return null===(e=this.data)||void 0===e?void 0:e.outputs}getFormValueByPathEnds(e){return M(this.node,e)}get type(){return this.node.flowNodeType}get isError(){return!!this.error}get error(){return this.node.getData(F.fu).getError()}setError(e){this.node.getData(F.fu).setError(e)}get isInitialized(){return this.form.initialized}get data(){return this.form.getFormItemValueByPath("/")}setData(e){if(void 0!==e){var{form:t}=this;if((0,F.vo)(this.node))Object.keys(e).forEach(r=>{t.setValueIn(r,e[r])});else{var r=t.getFormItemByPath("/");r&&(r.value=e)}}}get icon(){var e,t;return null===this||void 0===this?void 0:null===(t=this.data)||void 0===t?void 0:null===(e=t.nodeMeta)||void 0===e?void 0:e.icon}get title(){var e,t;return null===this||void 0===this?void 0:null===(t=this.data)||void 0===t?void 0:null===(e=t.nodeMeta)||void 0===e?void 0:e.title}get description(){var e,t;return null===this||void 0===this?void 0:null===(t=this.data)||void 0===t?void 0:null===(e=t.nodeMeta)||void 0===e?void 0:e.description}get form(){return this.node.getData(F.Ps).formModel}getValueByPath(e){return this.form.getValueIn(e)}constructor(e){this.node=e,this.setData=this.setData.bind(this),this.setError=this.setError.bind(this)}}},220192:function(e,t,r){r.d(t,{RJ:()=>o,Lt:()=>l,c2:()=>i});var n=r("686436"),o=Symbol("ValidationService"),i=()=>(0,n.G2)(o),l=e=>i().store(e)},364676:function(e,t,r){r.d(t,{I:()=>s});var n=r("808549"),o=r("120454"),i=r("479910"),l=r("598208"),a={nodes:[],edges:[],isCreatingWorkflow:!1},s=(0,l.Ue)()((0,i.mW)(e=>(0,o._)((0,n._)({},a),{setNodes:t=>e({nodes:null!=t?t:[]}),setEdges:t=>e({edges:null!=t?t:[]}),setIsCreatingWorkflow:t=>e({isCreatingWorkflow:t})})))},391963:function(e,t,r){r.d(t,{$d:function(){return a},Rk:function(){return l},_T:function(){return i}}),(i||(i={})).createEmpty=function(){return{type:"string",value:{type:"ref",content:{source:"block-output",blockID:"",name:""}}}};var n,o,i,l=((o={}).object="object",o.list="list",o.string="string",o.integer="integer",o.float="float",o.boolean="boolean",o.image="image",o.time="time",o);var a=((n={})[n.file=1]="file",n[n.image=2]="image",n[n.doc=3]="doc",n[n.code=4]="code",n[n.ppt=5]="ppt",n[n.txt=6]="txt",n[n.excel=7]="excel",n[n.audio=8]="audio",n[n.zip=9]="zip",n[n.video=10]="video",n[n.svg=11]="svg",n[n.voice=12]="voice",n[n.time=1e4]="time",n)},569502:function(e,t,r){r.d(t,{vT:()=>I,lZ:()=>k,ow:()=>_.ow,YX:()=>g,Tg:()=>A,SM:()=>E,Ps:()=>y,Iu:()=>_.Iu,Gu:()=>S,kO:()=>C,Xm:()=>w,sS:()=>T,_T:()=>f._T,Rk:()=>f.Rk,tn:()=>D,ny:()=>b,yc:()=>p,VK:()=>v,fw:()=>P,nZ:()=>m,vH:()=>_.vH,_C:()=>j,$d:()=>f.$d});var n,o,i,l,a,s,d,c,u,p,m,v,_=r("139454");(n=u||(u={})).getVariableTreeNodeByPath=function(e,t){t=t.slice();for(var r=e,n=t.shift();n&&r;)if((n=t.shift())&&!(r=(r.children||[]).find(e=>e.key===n)))return;return r},n.keyPathToNameString=function(e,t){var r=[];t=t.slice();for(var n=e,o=t.shift();o&&n;)if(r.push(n.name),(o=t.shift())&&!(n=(n.children||[]).find(e=>e.key===o)))return"";return r.join(".")},n.nameStringToKeyPath=function(e,t){for(var r=[],n=t.split("."),o=e,i=n.shift();i&&o;)if(r.push(o.key),(i=n.shift())&&!(o=(o.children||[]).find(e=>e.name===i)))return[];return r};var f=r("391963");!function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"string",n={name:e,input:{type:r,value:{type:"literal",content:String(t)}}},o=_.ow.String;switch(r){case"string":o=_.ow.String;break;case"integer":o=_.ow.Integer;break;case"float":o=_.ow.Number;break;case"boolean":o=_.ow.Boolean}return n.input.value.rawMeta={type:o},n}e.create=t;e.createString=function(e,r){return t(e,r,"string")};e.createInteger=function(e,r){return t(e,r,"integer")};e.createFloat=function(e,r){return t(e,r,"float")};e.createArray=function(e,t,r){return{name:e,input:{type:"list",schema:r,value:{type:"literal",content:t}}}};e.createBoolean=function(e,r){var n=t(e,r,"boolean");return n.input.value.content=r,n};e.toLiteral=function(e){return e.input.value.content};e.isBlockInput=function(e){var t,r;return!!(null==e?void 0:e.name)&&(null==e||null===(r=e.input)||void 0===r||null===(t=r.value)||void 0===t||t.content,!0)}}(p||(p={}));var h=r("346707"),x=r("155440");var g=((o={}).LITERAL="literal",o.REF="ref",o.OBJECT_REF="object_ref",o);!function(e){function t(e){return"ref"===e.type}function r(e){return"literal"===e.type}e.isRef=t,e.isLiteral=r;e.isObjectRef=function(e){return(null==e?void 0:e.type)==="object_ref"};e.isExpression=function(e){return!(0,h.Z)(e)&&(t(e)||r(e))};e.isEmpty=function(e){if((null==e?void 0:e.type)==="object_ref")return!1;if(null===e)return!0;if("object"!=typeof e&&"function"!=typeof e)return(0,x.Z)(e);if((null==e?void 0:e.content)===""||(0,x.Z)(null==e?void 0:e.content))return!0;if(Array.isArray(null==e?void 0:e.content))return(null==e?void 0:e.content.length)===0;if((null==e?void 0:e.type)==="ref"){var t,r;return!(null==e?void 0:null===(r=e.content)||void 0===r?void 0:null===(t=r.keyPath)||void 0===t?void 0:t.length)}return!1}}(m||(m={}));var y=((i={}).Single="single",i.Batch="batch",i);var b=((l={}).Start="1",l.End="2",l.LLM="3",l.Api="4",l.Code="5",l.Dataset="6",l.If="8",l.SubWorkflow="9",l.Variable="11",l.Database="12",l.Output="13",l.Imageflow="14",l.Text="15",l.ImageGenerate="16",l.ImageReference="17",l.Question="18",l.Break="19",l.SetVariable="20",l.Loop="21",l.Intent="22",l.ImageCanvas="23",l.SceneChat="25",l.SceneVariable="24",l.LTM="26",l.DatasetWrite="27",l.Batch="28",l.Continue="29",l.Input="30",l.Comment="31",l.VariableMerge="32",l.QueryMessageList="37",l.ClearContext="38",l.CreateConversation="39",l.TriggerUpsert="34",l.TriggerDelete="35",l.TriggerRead="36",l.VariableAssign="40",l.Http="45",l.DatabaseUpdate="42",l.DatabaseQuery="43",l.DatabaseDelete="44",l.DatabaseCreate="46",l.UpdateConversation="51",l.DeleteConversation="52",l.QueryConversationList="53",l.QueryConversationHistory="54",l.CreateMessage="55",l.UpdateMessage="56",l.DeleteMessage="57",l.JsonStringify="58",l.JsonParser="59",l),j={1:1,2:2,4:3,3:4,5:5,6:6,9:7,14:8,8:9,21:10,22:11,15:12,13:13,18:14,11:15,12:16,26:17,28:18,30:19,20:20,19:21,29:22,25:23,24:24,34:26,36:27,35:28},w=["39","51","52","53"],C=["55","56","57","37"],k=["54","38"],N=r("178385");(v||(v={})).DEFAULT={outputsPathList:["outputs"],inputsPathList:["inputs.inputParameters"],batchInputListPath:"inputs.batch.inputLists"};var S=((a={}).Customize="default_val",a.Creative="creative",a.Balance="balance",a.Precise="precise",a),E="response_format";var T=((s={})[s.OR=1]="OR",s[s.AND=2]="AND",s);var I=((d={}).OR="OR",d.AND="AND",d),P={[N.n$.String]:"String",[N.n$.Integer]:"Integer",[N.n$.Boolean]:"Boolean",[N.n$.Double]:"Double",[N.n$.List]:"List",[N.n$.Object]:"Object"},A={[f.$d.file]:_.Iu[_.ow.File],[f.$d.image]:_.Iu[_.ow.Image],[f.$d.doc]:_.Iu[_.ow.Doc],[f.$d.code]:_.Iu[_.ow.Code],[f.$d.ppt]:_.Iu[_.ow.Ppt],[f.$d.txt]:_.Iu[_.ow.Txt],[f.$d.excel]:_.Iu[_.ow.Excel],[f.$d.audio]:_.Iu[_.ow.Audio],[f.$d.zip]:_.Iu[_.ow.Zip],[f.$d.video]:_.Iu[_.ow.Video],[f.$d.svg]:_.Iu[_.ow.Svg]};var D=((c={}).DEFAULT="default",c.EXECUTING="executing",c.DONE="done",c)},139454:function(e,t,r){r.d(t,{Iu:function(){return s},ow:function(){return o},vH:function(){return l}});var n,o=((n={})[n.String=1]="String",n[n.Integer=2]="Integer",n[n.Boolean=3]="Boolean",n[n.Number=4]="Number",n[n.Object=6]="Object",n[n.Image=7]="Image",n[n.File=8]="File",n[n.Doc=9]="Doc",n[n.Code=10]="Code",n[n.Ppt=11]="Ppt",n[n.Txt=12]="Txt",n[n.Excel=13]="Excel",n[n.Audio=14]="Audio",n[n.Zip=15]="Zip",n[n.Video=16]="Video",n[n.Svg=17]="Svg",n[n.Voice=18]="Voice",n[n.Time=19]="Time",n[n.ArrayString=99]="ArrayString",n[n.ArrayInteger=100]="ArrayInteger",n[n.ArrayBoolean=101]="ArrayBoolean",n[n.ArrayNumber=102]="ArrayNumber",n[n.ArrayObject=103]="ArrayObject",n[n.ArrayImage=104]="ArrayImage",n[n.ArrayFile=105]="ArrayFile",n[n.ArrayDoc=106]="ArrayDoc",n[n.ArrayCode=107]="ArrayCode",n[n.ArrayPpt=108]="ArrayPpt",n[n.ArrayTxt=109]="ArrayTxt",n[n.ArrayExcel=110]="ArrayExcel",n[n.ArrayAudio=111]="ArrayAudio",n[n.ArrayZip=112]="ArrayZip",n[n.ArrayVideo=113]="ArrayVideo",n[n.ArraySvg=114]="ArraySvg",n[n.ArrayVoice=115]="ArrayVoice",n[n.ArrayTime=116]="ArrayTime",n),i=[6,99,100,101,102,103,116],l=[8,7,9,10,11,12,13,14,15,16,17,18,104,105,106,107,108,109,110,111,112,113,114,115],a=[[1,99],[2,100],[3,101],[4,102],[6,103],[7,104],[8,105],[9,106],[10,107],[11,108],[12,109],[13,110],[14,111],[15,112],[16,113],[17,114],[18,115],[19,116]],s={1:"String",2:"Integer",3:"Boolean",4:"Number",6:"Object",7:"Image",8:"File",9:"Doc",10:"Code",11:"PPT",12:"Txt",13:"Excel",14:"Audio",15:"Zip",16:"Video",17:"Svg",18:"Voice",19:"Time",99:"Array<String>",100:"Array<Integer>",101:"Array<Boolean>",102:"Array<Number>",103:"Array<Object>",104:"Array<Image>",105:"Array<File>",106:"Array<Doc>",107:"Array<Code>",108:"Array<PPT>",109:"Array<Txt>",110:"Array<Excel>",111:"Array<Audio>",112:"Array<Zip>",113:"Array<Video>",114:"Array<Svg>",115:"Array<Voice>",116:"Array<Time>"};!function(e){e.LabelMap=s,e.ArrayTypes=a.map(e=>e[1]);e.getLabel=function(t){return e.LabelMap[t]};e.getComplement=function(e){return[...a.map(e=>e[0]),...a.map(e=>e[1])].filter(t=>!e.includes(t))};function t(e){return a.map(e=>e[1]).includes(e)}e.canDrilldown=function(e){return[6,103].includes(e)},e.isArrayType=t;e.isFileType=function(e){return l.includes(e)};e.isVoiceType=function(e){return[18].includes(e)};e.isJSONInputType=function(e){return i.includes(e)};e.getArraySubType=function(e){var t,r=null===(t=a.find(t=>t[1]===e))||void 0===t?void 0:t[0];if(!r)throw Error("WorkflowVariableEntity Error: Unknown Variable Type");return r};e.wrapToArrayType=function(e){var t,r=null===(t=a.find(t=>t[0]===e))||void 0===t?void 0:t[1];if(!r)throw Error("WorkflowVariableEntity Error: Unknown Variable Type");return r};e.getAllArrayType=function(){return[...a.map(e=>e[0]),...a.map(e=>e[1])].filter(t)}}(o||(o={}))},527021:function(e,t,r){r.d(t,{d:function(){return o}});var n=r(157728),o=()=>{var{bot_id:e}=(0,n.useParams)();return t=>{var{workflowId:r,spaceId:n,projectId:o,ideNavigate:i}=t;if(o&&i)i("/workflow/".concat(r,"?from=createSuccess"));else{var l=new URLSearchParams;e&&l.append("bot_id",e),l.append("space_id",null!=n?n:""),l.append("workflow_id",r),l.append("from","createSuccess"),window.open("/work_flow?".concat(l.toString()),"_blank")}}}},731870:function(e,t,r){r.d(t,{S:function(){return _}});var n=r(825955),o=r(808549),i=r(120454),l=r(455069),a=r(529801),s=r(268935),d=r(408487),c=r(336205),u=r(727914),p=r(674343),m=r(104313),v=r(891052);function _(){var e,t,r,{pageSize:_=20,enabled:f=!1,from:h,fetchWorkflowListApi:x=d.OHc.GetWorkFlowList.bind(d.OHc)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[g,y]=(0,l.useState)(d.wz8.All),[b,j]=(0,l.useState)(d.uql.User),[w,C]=(0,l.useState)(""),[k,N]=(0,l.useState)(),[S,E]=(0,l.useState)(),[T,I]=(0,l.useState)(),[P,A]=(0,l.useState)(),[D,L]=(0,l.useState)(),[O,Z]=(0,l.useState)(),[F,M]=(0,l.useState)(),[z,R]=(0,l.useState)(""),B=(0,l.useMemo)(()=>({page:1,size:_,type:b,name:k,space_id:w,status:S,tags:P,order_by:T,login_user_create:F,flow_mode:g,bind_biz_id:D,bind_biz_type:O,project_id:z}),[b,S,k,g,T,w,F,P,D,O,z]),V=(0,l.useCallback)(e=>{[{key:"type",func:j,defaultValue:d.uql.User},{key:"name",func:N},{key:"space_id",func:C,defaultValue:""},{key:"status",func:E},{key:"tags",func:A},{key:"order_by",func:I},{key:"login_user_create",func:M},{key:"flow_mode",func:y,defaultValue:d.wz8.All},{key:"bind_biz_id",func:L},{key:"bind_biz_type",func:Z},{key:"project_id",func:R}].filter(t=>{var{key:r}=t;return r in e}).forEach(t=>{var r,{key:n,defaultValue:o,func:i}=t;return null==i?void 0:i(null!==(r=e[n])&&void 0!==r?r:o)})},[]);var U=(e=(0,n._)(function*(e){try{m.E7.info({message:"workflow_list_get_list"});var t={total:0,workflow_list:[]};if(e.bind_biz_type===d.k5N.Scene&&e.bind_biz_id){var r,n,l=yield d.OHc.WorkflowListByBindBiz(e);t.total=null!==(r=l.data.total)&&void 0!==r?r:0,t.workflow_list=(null!==(n=l.data.workflow_list)&&void 0!==n?n:[]).map(e=>{var t,r={can_edit:!0,can_copy:!0,can_delete:!!(null==e?void 0:null===(t=e.creator)||void 0===t?void 0:t.self)};return(0,i._)((0,o._)({},e),{authInfo:r})})}else{Object.assign(e,{schema_type_list:[d.XQ3.FDL],checker:h===v.w.WorkflowAgent?[d.gfc.BotAgent]:void 0});var s,c,u=e.bind_biz_type===d.k5N.DouYinBot?e:(0,a.Z)(e,["bind_biz_id"]),p=yield x(u);t.total=null!==(s=p.data.total)&&void 0!==s?s:0,t.workflow_list=(null!==(c=p.data.workflow_list)&&void 0!==c?c:[]).map(e=>{var t,r,n={can_edit:!0,can_copy:!0,can_delete:!!(null==e?void 0:null===(t=e.creator)||void 0===t?void 0:t.self)},l=(null!==(r=p.data.auth_list)&&void 0!==r?r:[]).find(t=>t.workflow_id===e.workflow_id);return l&&(n=(0,o._)({},n,l.auth)),(0,i._)((0,o._)({},e),{authInfo:n})})}return m.E7.info({message:"workflow_list_get_list_success",meta:{currentPage:e.page,pageSize:e.size,order_by:e.order_by,name:e.name,total:t.total}}),t}catch(e){throw m.E7.error({message:"workflow_list_get_list_fail",error:e}),e}}),function(t){return e.apply(this,arguments)}),{data:H,error:W,fetchNextPage:G,hasNextPage:K,isFetching:J,isFetchingNextPage:q,status:$,refetch:X}=(0,s.N)({enabled:f&&!!w,queryKey:["space_workflow_list","vcs",JSON.stringify(B)],queryFn:e=>{var{pageParam:t}=e;return U(t)},initialPageParam:B,getNextPageParam:(e,t,r)=>{var n,l;return(null!==(n=r.page)&&void 0!==n?n:1)*_>e.total?null:(0,i._)((0,o._)({},r),{page:(null!==(l=r.page)&&void 0!==l?l:1)+1})}}),Y=(0,l.useMemo)(()=>{var e=[],t={};return null==H||H.pages.forEach(r=>{r.workflow_list.forEach(r=>{if(!!r.workflow_id)!t[r.workflow_id]&&e.push(r),t[r.workflow_id]=!0})}),e},[H]),Q=(0,l.useMemo)(()=>{var e;return(null==H?void 0:H.pages)&&Array.isArray(H.pages)&&0!==H.pages.length?null!==(e=H.pages[H.pages.length-1].total)&&void 0!==e?e:0:0},[H]);var ee=(t=(0,n._)(function*(e){if(!e.workflow_id||!w)throw new u.sH("normal_error","miss workflowId or spaceID");if(!e.authInfo.can_copy)throw new u.sH("normal_error","no copy permission");m.E7.info({message:"workflow_list_copy_row",meta:{workflowId:e.workflow_id}});try{var t=!1,{data:r}=yield d.OHc.CopyWorkflow({space_id:w,workflow_id:e.workflow_id});if(t=!(null==r?void 0:r.workflow_id)){p.FN.error(c.o.t("workflow_detail_toast_createcopy_failed")),m.E7.error({message:"workflow_list_copy_row_fail",error:new u.sH("normal_error","result no workflow")});return}p.FN.success({content:g===d.wz8.Imageflow?c.o.t("imageflow_detail_toast_createcopy_succeed"):c.o.t("workflow_detail_toast_createcopy_succeed"),showClose:!1}),m.E7.info({message:"workflow_list_copy_row_success",meta:{workflowId:e.workflow_id}}),yield(0,m.Dc)(300),X()}catch(e){m.E7.error({message:"workflow_list_copy_row_fail",error:e}),p.FN.error(c.o.t("workflow_detail_toast_createcopy_failed"))}}),function(e){return t.apply(this,arguments)});var et=(r=(0,n._)(function*(e){if(!e.workflow_id||!w)throw new u.sH("normal_error","miss workflowId or spaceID");if(!e.authInfo.can_delete)throw new u.sH("normal_error","no delete permission");m.E7.info({message:"workflow_list_delete_row",meta:{workflowId:e.workflow_id}});var t,r=d.KN6.CanDelete;r=(yield d.OHc.GetDeleteStrategy({space_id:w,workflow_id:e.workflow_id})).data;var o=[d.KN6.CanDelete,d.KN6.RejectProductDraft].includes(r);var i=(t=(0,n._)(function*(t){var r=(null==t?void 0:t.needDeleteBlockwise)?d.sL0.BlockwiseDelete:d.sL0.BlockwiseUnbind;if(!e.workflow_id||!w)throw new u.sH("normal_error","miss workflowId or spaceID");try{yield d.OHc.DeleteWorkflow({space_id:w,workflow_id:e.workflow_id,action:r}),p.FN.success({content:c.o.t("workflow_add_delete_success"),showClose:!1}),m.E7.info({message:"workflow_list_delete_row_success"}),yield(0,m.Dc)(300),X()}catch(e){m.E7.error({message:"workflow_list_delete_row_fail",error:e}),p.FN.error({content:c.o.t("workflow_add_delete_fail"),showClose:!1})}}),function(e){return t.apply(this,arguments)});return{canDelete:o,deleteType:r,handleDelete:o?i:void 0}}),function(e){return r.apply(this,arguments)});return{flowType:b,setFlowType:j,flowMode:g,setFlowMode:y,spaceId:w,setSpaceId:C,status:S,setStatus:E,name:k,setName:N,tags:P,setTags:A,orderBy:T,setOrderBy:I,loginUserCreate:F,setLoginUserCreate:M,updatePageParam:V,workflowList:Y,total:Q,queryError:W,fetchNextPage:G,hasNextPage:K,isFetching:J,isFetchingNextPage:q,loadingStatus:$,refetch:X,handleCopy:ee,handleDelete:et}}},614904:function(e,t,r){r.d(t,{Ax:()=>ed,oh:()=>t_,dn:()=>j.d,qz:()=>h,tk:()=>tb,HA:()=>ev,R0:()=>eg,AC:()=>ef,Zv:()=>ew,pJ:()=>N.pJ,U8:()=>em,md:()=>ej.md,wj:()=>eO,Do:()=>ej.Do,ds:()=>tf.d,UF:()=>Q,A2:()=>e8,Mz:()=>eC.Z,wL:()=>ej.wL,tf:()=>J,BD:()=>ej.BD,tF:()=>eo,ub:()=>tv,Zo:()=>e_,ye:()=>ej.ye,CA:()=>eF,xv:()=>eM});var n,o,i,l,a,s,d,c,u,p,m,v,_,f,h,x,g,y,b,j=r("419034"),w=r("151064"),C=r("455069"),k=r("336205");r("569603");var N=r("104313");/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent),r("414616"),(0,N.mk)();var S=r("252237"),E=r.n(S),T=r("584466"),I=r("136515"),P=r("450562"),A=r("915757"),D=r("674343"),L=r("825955"),O=r("808549"),Z=r("120454"),F=r("268935"),M=r("408487"),z=r("851954"),R=r.n(z),B=r("479886"),V=r.n(B),{Text:U}=D.ZT,H=e=>{var t,r,{className:n,data:o,readonly:i,isActive:l,hiddenActionMenu:a,enablePublishPPE:s,onClick:d,onPublishPPE:c,onResetToCommit:u,onShowCommit:p,hideCommitId:m}=e,v=a?null:(0,w.jsx)(D.v2,{className:"min-w-[96px] mb-2px flex-shrink-0",trigger:"hover",stopPropagation:!0,position:"bottomRight",render:(0,w.jsxs)(D.v2.SubMenu,{mode:"menu",children:[(0,w.jsx)(D.v2.Item,{onClick:(e,t)=>{t.stopPropagation(),null==p||p(o)},children:k.o.t("bmv_view_version")}),(0,w.jsx)(D.v2.Item,{onClick:(e,t)=>{t.stopPropagation(),null==u||u(o)},children:k.o.t("bmv_load_to_draft")}),s?(0,w.jsx)(D.v2.Item,{onClick:(e,t)=>{t.stopPropagation(),null==c||c(o)},children:k.o.t("bmv_pre_release_to_lane")}):null]}),children:(0,w.jsx)(D.hU,{color:"secondary",iconSize:"small",icon:(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(A.NsR,{className:"rotate-90"})})})}),_=(0,C.useMemo)(()=>o.create_time?V()(o.create_time).format("YYYY-MM-DD HH:mm:ss"):"",[o]);return(0,w.jsxs)("div",{className:E()("commit-item",l&&"active","p-2 rounded-mini",l&&"coz-mg-hglt",!i&&!l&&"hover:coz-mg-secondary",!i&&"cursor-pointer",n),onClick:()=>null==d?void 0:d(o),children:[(0,w.jsxs)("div",{className:"mb-2",children:[o.type===M.lcl.SubmitOperate&&(0,w.jsx)(D.Vp,{size:"small",children:k.o.t("workflow_publish_multibranch_submitted_title")}),o.type===M.lcl.PubPPEOperate&&(0,w.jsx)(D.Vp,{size:"small",color:o.offline?"primary":"green",children:o.env}),o.type===M.lcl.PublishOperate&&(0,w.jsx)(D.Vp,{size:"small",color:o.offline?"primary":"green",children:R().valid(o.version)?o.version:k.o.t("bmv_official_version")})]}),!m&&(0,w.jsxs)(D.T,{className:"w-full items-start",vertical:!0,spacing:4,children:[(0,w.jsxs)(U,{ellipsis:{showTooltip:{opts:{content:o.submit_commit_id||o.commit_id}}},children:[(0,w.jsxs)("span",{className:"font-bold mr-2",children:[k.o.t("bmv_submit_id"),":"]}),o.submit_commit_id||o.commit_id]}),o.type!==M.lcl.SubmitOperate&&o.offline&&o.update_time?(0,w.jsxs)(U,{ellipsis:{showTooltip:{opts:{content:V()(o.update_time).format("YYYY-MM-DD HH:mm")}}},children:[(0,w.jsxs)("span",{className:"font-bold mr-2",children:[k.o.t("bmv_offline_time"),":"]}),V()(o.update_time).format("YYYY-MM-DD HH:mm")]}):null]}),o.type===M.lcl.PublishOperate&&o.desc?(0,w.jsx)("div",{children:(0,w.jsx)(U,{ellipsis:{rows:4,showTooltip:!0},children:o.desc})}):null,(0,w.jsxs)("div",{className:"flex items-end mt-2",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"min-w-0 flex items-center mb-1",children:[(0,w.jsx)(D.qE,{className:"mr-2 flex-shrink-0",size:"extra-extra-small",src:null===(t=o.user)||void 0===t?void 0:t.user_avatar,alt:"avatar"}),(0,w.jsx)(U,{ellipsis:!0,fontSize:"12px",children:null===(r=o.user)||void 0===r?void 0:r.user_name})]}),(0,w.jsx)(U,{type:"secondary",fontSize:"12px",children:_})]}),(0,w.jsx)("div",{className:"flex-1"}),v]})]})},W=r("8616"),{Text:G}=D.ZT,K="current";Object.assign((0,P._Uw)(e=>{var{className:t,spaceId:r,value:n,workflowId:o,readonly:i,type:l,enablePublishPPE:a,showCurrent:s,onItemClick:d,onPublishPPE:c,onResetToCommit:u,onShowCommit:p,onCurrentClick:m,hideCommitId:v}=e,{queryParams:_,updatePageParam:f,list:h,loadingStatus:x,fetchNextPage:g,isFetching:y,hasNextPage:b}=function(e){var t,{spaceId:r,workflowId:n,type:o,pageSize:i=10,enabled:l=!1}=e,[a,s]=(0,C.useState)({space_id:r,workflow_id:n,type:o}),d=(0,C.useMemo)(()=>(0,Z._)((0,O._)({},a),{limit:i,last_commit_id:""}),[a,i]),c=(0,C.useCallback)(e=>{s(t=>(0,O._)({},t,e))},[]),u=(0,C.useMemo)(()=>["workflowApi_OperateList",JSON.stringify(d)],[d]);var p=(t=(0,L._)(function*(e){return(yield M.OHc.VersionHistoryList(e)).data}),function(e){return t.apply(this,arguments)}),{data:m,error:v,fetchNextPage:_,hasNextPage:f,isFetching:h,isFetchingNextPage:x,status:g,refetch:y}=(0,F.N)({enabled:!!(r&&n&&l),queryKey:u,queryFn:e=>{var{pageParam:t}=e;return p(t)},initialPageParam:d,getNextPageParam:(e,t,r)=>(null==e?void 0:e.has_more)?(0,Z._)((0,O._)({},r),{cursor:e.cursor||""}):null});return{queryParams:a,updatePageParam:c,list:(0,C.useMemo)(()=>{var e=[],t={};return null==m||m.pages.forEach(r=>{var n;null==r||null===(n=r.version_list)||void 0===n||n.forEach(r=>{var n=r.commit_id||"";!t[n]&&e.push(r),t[n]=!0})}),e},[m]),queryError:v,loadingStatus:g,refetch:y,fetchNextPage:_,isFetching:h,isFetchingNextPage:x,hasNextPage:f}}({spaceId:r,workflowId:o,type:l,enabled:!0}),j=(0,C.useRef)(null),N=(0,C.useRef)(null),[S]=(0,T.Z)(N,{root:()=>j.current,threshold:.8});if((0,C.useEffect)(()=>{f({type:l})},[l,f]),(0,I.Z)(()=>{j.current&&j.current.scrollTo({top:0})},[_]),(0,C.useEffect)(()=>{if(!!S&&"success"===x&&!y&&!!b)g()},[S,x,y,b]),"error"===x)return(0,w.jsx)("div",{className:"flex justify-center items-center min-h-[300px] w-full",children:(0,w.jsx)(D.ub,{title:"An error occurred",description:"Please try again later"})});if("pending"===x)return(0,w.jsx)(D.yC,{wrapperClassName:"flex justify-center items-center min-h-[300px] w-full"});if("success"===x&&!h.length&&!s)return(0,w.jsx)("div",{className:"flex justify-center items-center min-h-[300px] w-full",children:(0,w.jsx)(D.ub,{title:k.o.t("query_data_empty"),description:k.o.t("bwc_no_version_record")})});var z=(e,t)=>l===P.lcl.PubPPEOperate?e.offline?"default":"ongoing":0===t?"ongoing":"default";return(0,w.jsxs)("div",{ref:j,className:t,children:[(0,w.jsxs)(D.TY,{children:[s?(0,w.jsx)(D.TY.Item,{className:W.Z["history-item"],type:"warning",dot:n===K?(0,w.jsx)(A.Ph$,{}):void 0,children:(0,w.jsx)("div",{className:E()("relative top-[-8px] p-2 rounded-mini",n===K?"coz-mg-hglt":"hover:coz-mg-secondary",!i&&"cursor-pointer"),onClick:()=>null==m?void 0:m(K),children:(0,w.jsx)(G,{className:"font-bold",children:k.o.t("devops_publish_multibranch_Current")})})}):null,h.map((e,t)=>(0,w.jsx)(D.TY.Item,{className:W.Z["history-item"],type:z(e,t),dot:n===e.commit_id?(0,w.jsx)(A.Ph$,{}):void 0,children:(0,w.jsx)(H,{className:"relative top-[-8px]",data:e,readonly:i,isActive:n===e.commit_id,enablePublishPPE:a,onClick:i?void 0:d,onPublishPPE:c,onResetToCommit:u,onShowCommit:p,hideCommitId:v})},e.commit_id))]}),b?(0,w.jsxs)("div",{className:"flex justify-center py-1",ref:N,children:[(0,w.jsx)(D.yC,{spinning:!0,wrapperClassName:"mr-2"}),(0,w.jsx)("div",{className:"coz-fg-primary",children:k.o.t("Loading")})]}):null]})}),{Item:H});var J=((n={}).Change="change",n.Select="select",n.Dispose="dispose",n.CompositionStart="compositionStart",n);var q=((o={}).Start="{",o.End="}",o.FullStart="{{",o.FullEnd="}}",o.Separator=".",o.ArrayStart="[",o.ArrayEnd="]",o);var $=((i={}).ObjectKey="object_key",i.ArrayIndex="array_index",i.EndEmpty="end_empty",i);var X=((l={}).Line="paragraph",l.Valid="valid",l.Invalid="invalid",l.SelectedValid="selectedValid",l.SelectedInvalid="selectedInvalid",l),Y=r("84840"),Q=e=>{var{className:t,model:r,maxLength:n,disabled:o,isError:i}=e,{visible:l,count:a,max:s}=(0,C.useMemo)(()=>"number"!=typeof r.value.length||"number"!=typeof n?{visible:!1}:{visible:!0,count:r.value.length,max:n},[r.value.length,n]);return o||!l?(0,w.jsx)(w.Fragment,{}):(0,w.jsx)("div",{className:E()(Y.Z["expression-editor-counter"],t,{[Y.Z["expression-editor-counter-error"]]:i}),children:(0,w.jsxs)("p",{children:[a," / ",s]})})},ee={[X.Valid]:{color:"#6675D9"},[X.Invalid]:{color:"inherit"},[X.SelectedValid]:{color:"#6675D9",borderRadius:2,backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"},[X.SelectedInvalid]:{color:"inherit",borderRadius:2,backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"}},et=e=>{var{type:t}=e.leaf;return(0,w.jsx)("span",(0,Z._)((0,O._)({style:t&&ee[t]},e.attributes),{children:e.children}))},er=r("566906"),en=r("205873"),eo=e=>{var{model:t,className:r,placeholder:n,onFocus:o,onBlur:i,readonly:l=!1,dataTestID:a}=e;return(0,w.jsx)("div",{className:r,children:(0,w.jsx)(er.mH,{editor:t.editor,initialValue:t.lines,onChange:e=>{var r;(r=(0,L._)(function*(){t.change(e),t.select(e)}),function(){return r.apply(this,arguments)})()},children:(0,w.jsx)(er.CX,{"data-testid":a,className:E()(en.Z.slateEditable,"flow-canvas-not-draggable"),"data-flow-editor-selectable":"false",readOnly:l,onFocus:o,onBlur:i,placeholder:n,renderLeaf:et,decorate:t.decorate,onKeyDown:e=>t.keydown(e),onCompositionStart:e=>t.compositionStart(e)})})})},ei=r("775699");var el=((a={}).SetInitialized="set_initialized",a.Refresh="refresh",a.SetParseDataAndEditorPath="set_parse_data_and_editor_path",a.ClearParseDataAndEditorPath="clear_parse_data_and_editor_path",a.SetVariableTree="set_variable_tree",a.SetVisible="set_visible",a.SetAllowVisibleChange="set_allow_visible_change",a.SetHiddenDOM="set_hidden_dom",a.SetRect="set_rect",a.SetSelected="set_selected",a.SetEmptyContent="set_empty_content",a.SetMatchTreeBranch="set_match_tree_branch",a.SearchEffectStart="search_effect_start",a.SearchEffectEnd="search_effect_end",a.FilteredEffectStart="filtered_effect_start",a.FilteredEffectEnd="filtered_effect_end",a),ea=(e,t)=>(0,O._)((0,Z._)((0,O._)({},e),{version:e.version+1}),t),es=(e,t)=>{if(t.type===el.SetInitialized)return ea(e,{initialized:!0});if(t.type===el.Refresh)return ea(e,{key:e.key+1});if(t.type===el.SetParseDataAndEditorPath){var{parseData:r,editorPath:n}=t.payload||{};return ea(e,{parseData:r,editorPath:n})}if(t.type===el.ClearParseDataAndEditorPath)return ea(e,{parseData:void 0,editorPath:void 0});if(t.type===el.SetVariableTree)return ea(e,{variableTree:t.payload});if(t.type===el.SetAllowVisibleChange)return ea(e,{allowVisibleChange:t.payload});if(t.type===el.SetVisible&&e.allowVisibleChange){var o=t.payload;return e.entities.selectorBoxConfig&&(o&&(e.entities.selectorBoxConfig.disabled=!0),!o&&(e.entities.selectorBoxConfig.disabled=!1)),ea(e,{visible:o})}return t.type===el.SetHiddenDOM?ea(e,{hiddenDOM:t.payload}):t.type===el.SetRect?ea(e,{rect:t.payload}):t.type===el.SetSelected?ea(e,{selected:t.payload}):t.type===el.SetEmptyContent?ea(e,{emptyContent:t.payload}):t.type===el.SetMatchTreeBranch?ea(e,{matchTreeBranch:t.payload}):t.type===el.SearchEffectStart?ea(e,{renderEffect:(0,Z._)((0,O._)({},e.renderEffect),{search:!0})}):t.type===el.SearchEffectEnd?ea(e,{renderEffect:(0,Z._)((0,O._)({},e.renderEffect),{search:!1})}):t.type===el.FilteredEffectStart?ea(e,{renderEffect:(0,Z._)((0,O._)({},e.renderEffect),{filtered:!0})}):t.type===el.FilteredEffectEnd?ea(e,{renderEffect:(0,Z._)((0,O._)({},e.renderEffect),{filtered:!1})}):e},ed=e=>{var[t,r]=(0,C.useReducer)(es,(0,Z._)((0,O._)({},e),{initialized:!1,version:0,key:0,variableTree:[],visible:!0,hiddenDOM:!0,allowVisibleChange:!0,renderEffect:{search:!1,filtered:!1}}));return[t,r]},ec=r("878011"),eu=r("569502");s=h||(h={}),d=e=>{var t,{variables:r,input:n}=e;if(!n.keyPath)return{name:n.name};var o=n.keyPath.shift(),i=n.keyPath,l=r.filter(e=>e.nodeId===o);return(i.reduce((e,r,n)=>{var o=e.find(e=>e.key===r);return(n===i.length-1&&(t=o),o&&o.children)?o.children:[]},l),t)?{name:n.name,keyPath:n.keyPath,variable:t}:{name:n.name}},s.findAvailableVariables=e=>{var{variables:t,inputs:r}=e;return r.map(e=>{var r,n=d({input:e,variables:t});return(null===(r=e.children)||void 0===r?void 0:r.length)&&(n.children=s.findAvailableVariables({variables:t,inputs:e.children||[]})),n})},c=(e,t)=>e.map(e=>{var r={label:e.name,value:"".concat(t.value,".").concat(e.key),key:"".concat(t.value,".").concat(e.key),variable:e,parent:t};return r.children=c(e.children||[],r),r}),s.createVariableTree=(e,t)=>e.map(e=>{var r,n,o,i=t?"".concat(t.key,".").concat(e.name):e.name,l={label:e.name,value:(null===(r=e.keyPath)||void 0===r?void 0:r.join("."))||i,key:i,keyPath:e.keyPath,variable:e.variable,parent:t};return(null===(n=e.children)||void 0===n?void 0:n.length)?l.children=s.createVariableTree(e.children,l):l.children=c((null===(o=e.variable)||void 0===o?void 0:o.children)||[],l),l}),s.pruning=e=>{var{tree:t,segments:r}=e;if(0===r.length)return t;var n=r[r.length-1].type===$.ArrayIndex?r.slice(0,r.length-2):r.slice(0,r.length-1),o=t;return n.forEach(e=>{if(e.type===$.ObjectKey){var t=o.find(t=>t.label===e.objectKey);o=t&&t.children||[]}}),o},s.concatFullPath=e=>{for(var t,{node:r,segments:n}=e,o=r,i=[];o;)(null===(t=o.variable)||void 0===t?void 0:t.type)===eu.ow.ArrayObject?i.unshift({objectKey:o.label,arrayIndex:0}):i.unshift({objectKey:o.label}),o=o.parent;var l=0;return n.find((e,t)=>{if(e.type!==$.ObjectKey)return!1;var r=i[l];if(l++,r.objectKey!==e.objectKey)return!0;var o=n[t+1];return"number"==typeof r.arrayIndex&&(null==o?void 0:o.type)===$.ArrayIndex&&(r.arrayIndex=o.arrayIndex),!1}),i.map((e,t)=>{var r=t===i.length-1;return"number"!=typeof e.arrayIndex||r?e.objectKey:"".concat(e.objectKey,"[").concat(e.arrayIndex,"]")}).join(".")},s.matchTreeBranch=e=>{var{tree:t,segments:r}=e,n=[],o=t,i=r.find((e,t)=>{var r,i=()=>(n.push(null),!0),l=e=>(n.push(e||null),!1),a=n[n.length-1];if(e.type===$.ArrayIndex&&a&&(!a.variable||!eu.ow.isArrayType(a.variable.type))||(null==a?void 0:null===(r=a.variable)||void 0===r?void 0:r.type)&&eu.ow.isArrayType(a.variable.type)&&e.type!==$.ArrayIndex)return i();if(e.type!==$.ObjectKey)return l();var s=o.find(t=>t.label===e.objectKey);return s?(o=s.children||[],l(s)):i()}),l=n.filter(Boolean),a=r.filter(e=>e.type===$.ObjectKey);if(!i&&a.length===l.length)return l},(u=x||(x={})).tokenOffset=e=>{var{lineContent:t,lineOffset:r}=e,n=t.indexOf(q.End,r);if(t.slice(n,n+2)!==q.FullEnd)return;var o=t.lastIndexOf(q.Start,r-1);if(t.slice(o-1,o+1)===q.FullStart)return{lastStartTokenOffset:o,firstEndTokenOffset:n}},u.extractContent=e=>{var{lineContent:t,lineOffset:r,lastStartTokenOffset:n,firstEndTokenOffset:o}=e,i=t.slice(n+1,o);return{content:i,offset:r-n-1}},u.sliceReachable=e=>{var{content:t,offset:r}=e,n=t.slice(0,r);return{reachable:n,unreachable:t.slice(r,t.length)}},u.splitText=e=>{var t=e.split(q.Separator),r=[];return t.forEach(e=>{if(!e.match(/\[\d+\]/)){r.push(e);return}var t=e.lastIndexOf(q.ArrayStart),n=e.substring(0,t),o=e.substring(t);r.push(n),r.push(o)}),r},u.toSegments=e=>{var t=u.splitText(e),r=[];if(!!t.every((e,n)=>{if(e.startsWith(q.ArrayStart)&&e.endsWith(q.ArrayEnd)){var o=e.slice(1,-1),i=Number(o);if(""===o||Number.isNaN(i))return!1;var l=r[r.length-1];if(!l||l.type!==$.ObjectKey)return!1;r.push({type:$.ArrayIndex,index:n,arrayIndex:i})}else if(n===t.length-1&&""===e)r.push({type:$.EndEmpty,index:n});else{if(!e||!/^[\u4e00-\u9fa5_a-zA-Z0-9]*$/.test(e))return!1;r.push({type:$.ObjectKey,index:n,objectKey:e})}return!0}))return r},(p=g||(g={})).serialize=e=>e.map(e=>ec.NB.string(e)).join("\n"),p.deserialize=e=>e.split("\n").map(e=>({type:X.Line,children:[{text:e||""}]})),p.parse=e=>{var{lineContent:t,lineOffset:r}=e,n=x.tokenOffset(e);if(!n)return;var{lastStartTokenOffset:o,firstEndTokenOffset:i}=n,l=x.extractContent((0,O._)({},e,n));if(!l)return;var{content:a,offset:s}=l,d=x.sliceReachable(l);if(!d)return;var c=x.toSegments(d.reachable),u=x.toSegments(a);if(!!c)return{content:{line:t,inline:a,reachable:d.reachable,unreachable:d.unreachable},offset:{line:r,inline:s,lastStart:o,firstEnd:i},segments:{inline:u,reachable:c}}};var ep=r("202635");(m=y||(y={})).editorSelectHandler=e=>{var{reducer:t,payload:r}=e,[n,o]=t,i=g.parse({lineContent:r.content,lineOffset:r.offset});if(!i){o({type:el.ClearParseDataAndEditorPath}),o({type:el.SetVisible,payload:!1}),o({type:el.SetRect,payload:void 0});return}o({type:el.SetParseDataAndEditorPath,payload:{parseData:i,editorPath:r.path}}),""===i.content.reachable&&o({type:el.Refresh});var l=m.computeSelected({model:n.model,parseData:i});o({type:el.SetSelected,payload:l});var a=m.computeVariableTree({model:n.model,parseData:i});o({type:el.SetVariableTree,payload:a});var s=h.matchTreeBranch({tree:n.model.variableTree,segments:i.segments.reachable});o({type:el.SetMatchTreeBranch,payload:s});var d=m.computeEmptyContent({parseData:i,fullVariableTree:n.model.variableTree,variableTree:a,matchTreeBranch:s});o({type:el.SetEmptyContent,payload:d});var c=m.computeRect(n);if(o({type:el.SetRect,payload:c}),!c){o({type:el.ClearParseDataAndEditorPath});return}!n.ref.tree.current&&o({type:el.SetVisible,payload:!0}),o({type:el.SearchEffectStart})},m.getFinalScale=e=>e.entities.playgroundConfig?e.entities.playgroundConfig.finalScale:1,m.computeRect=e=>{var t,r=null===(t=e.ref.container.current)||void 0===t?void 0:t.getBoundingClientRect();if(!!e.model.editor.selection&&!!r)try{var n=er.F3.toDOMRange(e.model.editor,e.model.editor.selection).getBoundingClientRect();return{top:(n.top-r.top)/m.getFinalScale(e)+5,left:(n.left-r.left)/m.getFinalScale(e)}}catch(e){return}},m.computeSelected=e=>{var{model:t,parseData:r}=e;if(!(null==r?void 0:r.segments.inline))return;var n=h.matchTreeBranch({tree:t.variableTree,segments:r.segments.inline});if(!!n)return n[n.length-1]},m.computeSearch=e=>{if(!e)return"";var t=e.segments.reachable,r=t[t.length-1].type===$.ArrayIndex?t[t.length-2]:t[t.length-1];return r&&r.type===$.ObjectKey?r.objectKey:""},m.computeVariableTree=e=>{var{model:t,parseData:r}=e;return(null==r?void 0:r.segments.reachable)?h.pruning({tree:t.variableTree,segments:r.segments.reachable}):[]},m.computeEmptyContent=e=>{var{parseData:t,fullVariableTree:r,variableTree:n,matchTreeBranch:o}=e;if(!r||!Array.isArray(r)||0===r.length)return""===t.content.reachable?k.o.t("workflow_variable_refer_no_input"):void 0;if(!n||!Array.isArray(n)||0===n.length){if(""===t.content.inline)return k.o.t("workflow_variable_refer_no_input");if(o&&0!==o.length)return k.o.t("workflow_variable_refer_no_sub_variable")}},m.keyboardSelectedClassName=()=>ep.Z["expression-editor-suggestion-keyboard-selected"],m.setUIOptionSelected=e=>{var t,r;if(!(!(null==e?void 0:null===(t=e.classList)||void 0===t?void 0:t.add)||!(null==e?void 0:null===(r=e.classList)||void 0===r?void 0:r.contains)||e.classList.contains("semi-tree-option-empty")))e.classList.add(m.keyboardSelectedClassName())},m.computeUIOptions=e=>{var t,r,n,o,i,l=null===(i=e.ref.suggestion.current)||void 0===i?void 0:null===(o=i.children)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:null===(r=n.children)||void 0===r?void 0:null===(t=r[1])||void 0===t?void 0:t.children;if(!!l){var a=Array.from(l),s=a.findIndex(e=>e.classList.contains(m.keyboardSelectedClassName()));return{optionList:a,selectedIndex:s,selectedOption:a[s]}}},m.preventVisibleJitter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150,[r,n]=e;if(!!r.allowVisibleChange)n({type:el.SetAllowVisibleChange,payload:!1}),setTimeout(()=>{n({type:el.SetAllowVisibleChange,payload:!0})},t)},m.clearSelectedUIOption=e=>{var t=m.computeUIOptions(e);(null==t?void 0:t.selectedOption)&&t.selectedOption.classList.remove(m.keyboardSelectedClassName())},m.selectFirstUIOption=e=>{var t,r,n,o=m.computeUIOptions(e);if(!(null==o?void 0:o.optionList))return;if(m.clearSelectedUIOption(e),!!(null==o?void 0:null===(n=o.optionList)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:null===(t=r.classList)||void 0===t?void 0:t.add))m.setUIOptionSelected(o.optionList[0])};var em=e=>{var[t]=e;return(0,C.useCallback)(e=>{var r,n,o=h.concatFullPath({node:e,segments:null!==(n=null===(r=t.parseData)||void 0===r?void 0:r.segments.reachable)&&void 0!==n?n:[]});if(!!t.parseData&&!!t.editorPath){var i={anchor:{path:t.editorPath,offset:t.parseData.offset.lastStart-1},focus:{path:t.editorPath,offset:t.parseData.offset.firstEnd+2}},l="".concat(q.FullStart).concat(o).concat(q.FullEnd);ec.YR.insertText(t.model.editor,l,{at:i})}},[t])},ev=e=>{var[t,r]=e;(0,C.useEffect)(()=>{var e=e=>{var n;if(!(!t.visible||!t.ref.suggestion.current||(null===(n=t.ref.suggestion.current)||void 0===n?void 0:n.contains(e.target))))r({type:el.SetVisible,payload:!1}),r({type:el.SetRect,payload:void 0})};window.addEventListener("mousedown",e);var n=()=>{window.removeEventListener("mousedown",e)};return()=>{n()}},[t]),(0,C.useEffect)(()=>{var r=t.model.on(J.Select,t=>y.editorSelectHandler({reducer:e,payload:t}));return()=>{r()}},[]),(0,C.useEffect)(()=>{var e=t.model.on(J.CompositionStart,e=>r({type:el.SetVisible,payload:!1}));return()=>{e()}},[]),(0,C.useEffect)(()=>{if(!t.initialized)r({type:el.SetVisible,payload:!1})},[]),(0,C.useEffect)(()=>{if(!t.initialized&&!t.visible)r({type:el.SetHiddenDOM,payload:!1}),r({type:el.SetInitialized})},[t])},e_=(e,t)=>{var[r,n]=e;(0,C.useEffect)(()=>{var e=e=>{if(!r.visible||!r.ref.suggestion.current||!["ArrowDown","ArrowUp"].includes(e.key))return;var t=y.computeUIOptions(r);if(!t)return;var{optionList:n,selectedIndex:o}=t;if(1!==n.length){e.preventDefault();var i=o;"ArrowDown"===e.key?i=-1===o||o===n.length-1?0:o+1:"ArrowUp"===e.key&&(i=o<=0?n.length-1:o-1);var l=n[i];-1!==o&&n[o].classList.remove(y.keyboardSelectedClassName()),y.setUIOptionSelected(l),l.scrollIntoView({behavior:"smooth",block:"nearest"})}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[r]),(0,C.useEffect)(()=>{var o=o=>{if(!r.visible||!r.ref.suggestion.current||"Enter"!==o.key)return;var i,l,a,s,d,c,u=y.computeUIOptions(r);if(!(null==u?void 0:u.selectedOption))return;var{selectedOption:p}=u,m=p.getAttribute("data-key");if(!m)return;var v=null===(s=r.ref.tree.current)||void 0===s?void 0:null===(a=s.state)||void 0===a?void 0:null===(l=a.keyEntities)||void 0===l?void 0:null===(i=l[m])||void 0===i?void 0:i.data;if(!v)return;if(o.preventDefault(),n({type:el.SetVisible,payload:!1}),t(v),!!(null===(d=v.variable)||void 0===d?void 0:d.children)&&(null===(c=v.variable)||void 0===c?void 0:c.children.length)!==0){var{selection:_}=r.model.editor;_&&ec.e6.isCollapsed(_)&&ec.YR.move(r.model.editor,{distance:2,reverse:!0}),y.preventVisibleJitter(e)}};return document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[r]),(0,C.useEffect)(()=>{var e=e=>{if(!!r.visible&&!!r.ref.suggestion.current&&"Escape"===e.key)e.preventDefault(),n({type:el.SetVisible,payload:!1})};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[r]),(0,C.useEffect)(()=>{y.selectFirstUIOption(r)},[r])},ef=e=>{var[t,r]=e;(0,C.useEffect)(()=>{if(!!t.renderEffect.search&&!!t.parseData){r({type:el.SearchEffectEnd});var e,n=y.computeSearch(t.parseData);if(null===(e=t.ref.tree.current)||void 0===e||e.search(n),!n&&t.matchTreeBranch){r({type:el.SetVisible,payload:!0});return}r({type:el.FilteredEffectStart})}},[t]),(0,C.useEffect)(()=>{if(!!t.renderEffect.filtered){r({type:el.FilteredEffectEnd});var e,n=Array.from((null===(e=t.ref.tree.current)||void 0===e?void 0:e.state.filteredKeys)||[]);if(!t.emptyContent&&0===n.length){r({type:el.SetVisible,payload:!1});return}r({type:el.SetVisible,payload:!0})}},[t])},eh=r("62257"),ex=r("732562");(v=b||(b={})).findPatterns=e=>{for(var t,r=[],n=/{{(.*?)}}/g;null!==(t=n.exec(e));){var o=t.index,i=n.lastIndex,l=t[1];r.push({start:o,end:i,content:l})}return r},_=e=>{var{pattern:t,tree:r}=e,n=x.toSegments(t.content);return n?n[n.length-1].type===$.EndEmpty?{start:t.start,end:t.end,valid:!1,message:"empty with empty"}:h.matchTreeBranch({tree:r,segments:n})?{start:t.start,end:t.end,valid:!0}:{start:t.start,end:t.end,valid:!1,message:"no match variable path"}:{start:t.start,end:t.end,valid:!1,message:"invalid variable path"}},v.lineTextValidate=e=>{var{lineText:t,tree:r}=e;return v.findPatterns(t).map(e=>_({pattern:e,tree:r}))},v.validate=e=>{var{lines:t,tree:r}=e;return t.map(e=>ec.NB.string(e)).map((e,t)=>v.lineTextValidate({lineText:e,tree:r})).flat()};class eg{setVariableTree(e){this.innerVariableTree=e}get variableTree(){return this.innerVariableTree}get lines(){return this.innerLines}get value(){return this.innerValue}setValue(e){if(e!==this.innerValue)this.innerValue=e,this.innerLines=g.deserialize(e),this.syncEditorValue()}setFocus(e){if(this.innerFocus!==e)this.innerFocus=e,e?this.select(this.lines):""!==this.innerValue&&0!==this.editor.children.length&&ec.YR.select(this.editor,ec.ML.start(this.editor,[]))}on(e,t){return this.emitter.on(e,t),()=>{this.emitter.off(e,t)}}change(e){if(!!this.editor.operations.some(e=>"set_selection"!==e.type))this.innerLines=e,this.innerValue=g.serialize(e),this.emitter.emit(J.Change,{lines:e,value:this.innerValue})}select(e){var{selection:t}=this.editor;if(!t||!ec.e6.isCollapsed(t))return;if(t.anchor.offset!==t.focus.offset||t.anchor.path[0]!==t.focus.path[0]||t.anchor.path[1]!==t.focus.path[1]){this.emitter.emit(J.Select,{content:"",offset:-1});return}var r=t.anchor.offset,n=t.anchor.path[0],o=t.anchor.path[1],i=e[n];if(!i)return;var l=i.children[o],a=null==l?void 0:l.text;if("string"==typeof a)this.emitter.emit(J.Select,{content:a,offset:r,path:t.anchor.path})}keydown(e){if(e.key===q.Start&&(e.preventDefault(),ec.YR.insertText(this.editor,q.FullStart+q.FullEnd),ec.YR.move(this.editor,{distance:2,reverse:!0}),setTimeout(()=>{this.select(this.innerLines)},0)),e.ctrlKey||e.metaKey){if("a"===e.key){e.preventDefault(),ec.YR.select(this.editor,{anchor:ec.ML.start(this.editor,[]),focus:ec.ML.end(this.editor,[])});}return}}compositionStart(e){this.emitter.emit(J.CompositionStart,{event:e})}get decorate(){var e=this;return t=>{var[r,n]=t,o=[];if(!ec.xv.isText(r))return o;var i=b.lineTextValidate({lineText:r.text,tree:e.innerVariableTree});if(i.forEach(e=>{var{start:t,end:r,valid:i}=e,l={anchor:{path:n,offset:t},focus:{path:n,offset:r}};i?o.push((0,O._)({type:X.Valid},l)):o.push((0,O._)({type:X.Invalid},l))}),!this.innerFocus)return o;var l=e.isValidateSelectPath([r,n]),a=i.find(e=>e.valid&&e.start===(null==l?void 0:l.start)&&e.end===(null==l?void 0:l.end));return l&&a?o.push({type:X.SelectedValid,anchor:{path:n,offset:l.start},focus:{path:n,offset:l.end}}):l&&!a&&o.push({type:X.SelectedInvalid,anchor:{path:n,offset:l.start},focus:{path:n,offset:l.end}}),o}}syncEditorValue(){this.editor.children.forEach((e,t)=>{ec.YR.removeNodes(this.editor,{at:[t]})}),this.lines.forEach((e,t)=>{ec.YR.insertNodes(this.editor,e,{at:[this.editor.children.length]})})}isValidateSelectPath(e){var[t,r]=e;if(!ec.xv.isText(t))return;var{selection:n}=this.editor;if(!n)return;var o=n.anchor.offset,i=n.anchor.path[0],l=n.anchor.path[1];if(i!==r[0]||l!==r[1])return;var a=t.text,s=g.parse({lineContent:a,lineOffset:o});if(!!s)return{start:s.offset.lastStart-1,end:s.offset.firstEnd+2,valid:!0}}constructor(e){this.emitter=new ex.Z,this.editor=(0,er.BU)((0,eh.VC)((0,ec.Jh)())),this.innerValue=e,this.innerLines=g.deserialize(e)}}var ey=r("473980"),eb=r("689951"),ej=r("39823"),ew=e=>{var t=e||{},{onClose:r}=t,n=(0,ey._)(t,["onClose"]),[o,{setTrue:i,setFalse:l}]=(0,eb.Z)(!1),a=()=>{null==r||r(),l()};return{node:o?(0,w.jsx)(ej.ZP,(0,O._)({visible:!0,onClose:a},n)):null,close:a,open:i}};r("731870");var eC=r("242505"),ek=r("606947"),eN=r("458620"),eS=r("298203"),eE=r("727914"),eT=r("178385"),eI=r("382534");var eP=((f={})[f.Success=0]="Success",f[f.NoFile=1]="NoFile",f[f.UploadFail=2]="UploadFail",f[f.UploadTimeout=3]="UploadTimeout",f[f.GetUrlFail=4]="GetUrlFail",f[f.ValidateError=5]="ValidateError",f[f.MaxSizeError=6]="MaxSizeError",f[f.SuffixError=7]="SuffixError",f[f.MaxWidthError=8]="MaxWidthError",f[f.MaxHeightError=9]="MaxHeightError",f[f.MinWidthError=10]="MinWidthError",f[f.MinHeightError=11]="MinHeightError",f[f.AspectRatioError=12]="AspectRatioError",f),eA=class e{select(e){var t=this;return(0,L._)(function*(){if(!e)throw new eE.sH("normal_error","选择文件为空");t.reset(),t.file=e,t.displayUrl=URL.createObjectURL(t.file),yield t.validate().catch(()=>{t.validateResult={isSuccess:!1,errNo:5,msg:k.o.t("imageflow_upload_error")}})})()}upload(){var e=this;return(0,L._)(function*(){if(!e.file||!(null===(t=e.validateResult)||void 0===t?void 0:t.isSuccess)||e.isUploading)return;e.isUploading=!0,e.taskId+=1;var t,r,n=e.taskId;if("api"===e.mode)r=yield e.uploadByApi(e.file);else if("uploader"===e.mode)r=yield e.uploadByUploader(e.file);else throw new eE.sH("normal_error","ImageUploader mode error");if(n===e.taskId)e.uploadResult=r,e.isUploading=!1})()}uploadByUploader(e){return new Promise(t=>{var r,n=this.timeout&&setTimeout(()=>t({isSuccess:!1,errNo:3,msg:k.o.t("imageflow_upload_error7")}),this.timeout);(r=(0,L._)(function*(){var r=yield(0,eS.fr)({biz:"workflow",file:e,fileType:"image"}).then(e=>{if(!e)throw new eE.sH("normal_error","no uri");return e}).catch(()=>(t({isSuccess:!1,errNo:2,msg:k.o.t("imageflow_upload_error")}),""));if(!!r){var n=yield M.OHc.SignImageURL({uri:r},{__disableErrorToast:!0}).catch(()=>null),o=(null==n?void 0:n.url)||"";o?t({isSuccess:!0,errNo:0,uri:r,url:o}):t({isSuccess:!1,errNo:4,msg:k.o.t("imageflow_upload_error")})}}),function(){return r.apply(this,arguments)})().finally(()=>{clearTimeout(n)})})}uploadByApi(e){return new Promise(t=>{var r,n=this.timeout&&setTimeout(()=>t({isSuccess:!1,errNo:3,msg:k.o.t("imageflow_upload_error7")}),this.timeout);(r=(0,L._)(function*(){var r=yield(function(e){return new Promise((t,r)=>{var n=new FileReader;n.onload=e=>{var n,o=null===(n=e.target)||void 0===n?void 0:n.result;if(!o||"string"!=typeof o){r(new eE.sH(eN.b.parmasValidation,"file read fail"));return}t(o.replace(/^.*?,/,""))},n.readAsDataURL(e)})})(e).catch(()=>"");if(!r){t({isSuccess:!1,errNo:2,msg:k.o.t("imageflow_upload_error")});return}yield eI.nA.UploadFile({file_head:{file_type:eD(e.name),biz_type:eT.ym.BIZ_BOT_WORKFLOW},data:r}).then(e=>{var r,n;t({isSuccess:!0,errNo:0,uri:(null===(r=e.data)||void 0===r?void 0:r.upload_uri)||"",url:(null===(n=e.data)||void 0===n?void 0:n.upload_url)||""})}).catch(()=>{t({isSuccess:!1,errNo:2,msg:k.o.t("imageflow_upload_error")})})}),function(){return r.apply(this,arguments)})().finally(()=>{clearTimeout(n)})})}reset(){this.file=void 0,this.displayUrl&&(URL.revokeObjectURL(this.displayUrl),this.displayUrl=void 0),this.isUploading=!1,this.uploadResult=void 0,this.validateResult=void 0,this.taskId+=1}validate(){var e=this;return(0,L._)(function*(){if(!!e.file&&!!e.displayUrl){var t=e.rules||{};if(t.maxSize&&e.file.size>t.maxSize){e.validateResult={isSuccess:!1,errNo:6,msg:k.o.t("imageflow_upload_exceed",{size:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var r=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,r)).toFixed(t))).concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])}(t.maxSize)})};return}if(Array.isArray(t.suffix)&&t.suffix.length>0){var r=eD(e.file.name);if(!t.suffix.includes(r)){e.validateResult={isSuccess:!1,errNo:7,msg:k.o.t("imageflow_upload_error_type",{type:"".concat(t.suffix.filter(Boolean).join("/"))})};return}}var{width:n,height:o}=yield function(e){return new Promise((t,r)=>{var n=new window.Image;n.onload=()=>t({width:n.naturalWidth,height:n.naturalHeight}),n.onerror=e=>r(e),n.src=e})}(e.displayUrl);if(!n||!o){e.validateResult={isSuccess:!1,errNo:5,msg:k.o.t("imageflow_upload_error6")};return}if(t.maxWidth&&n>t.maxWidth){e.validateResult={isSuccess:!1,errNo:8,msg:k.o.t("imageflow_upload_error5",{value:"".concat(t.maxWidth,"px")})};return}if(t.maxHeight&&o>t.maxHeight){e.validateResult={isSuccess:!1,errNo:9,msg:k.o.t("imageflow_upload_error4",{value:"".concat(t.maxHeight,"px")})};return}if(t.minWidth&&n<t.minWidth){e.validateResult={isSuccess:!1,errNo:10,msg:k.o.t("imageflow_upload_error3",{value:"".concat(t.minWidth,"px")})};return}if(t.minHeight&&o<t.minHeight){e.validateResult={isSuccess:!1,errNo:11,msg:k.o.t("imageflow_upload_error2",{value:"".concat(t.minHeight,"px")})};return}if(t.aspectRatio&&n/o-t.aspectRatio>Number.MIN_VALUE){e.validateResult={isSuccess:!1,errNo:12,msg:k.o.t("imageflow_upload_error1")};return}e.validateResult={isSuccess:!0,errNo:0,msg:"success"}}})()}constructor(e){var t,r,n;this.taskId=0,this.mode="uploader",this.isUploading=!1,this.rules=null!==(t=null==e?void 0:e.rules)&&void 0!==t?t:this.rules,this.mode=null!==(r=null==e?void 0:e.mode)&&void 0!==r?r:this.mode,this.timeout=null!==(n=null==e?void 0:e.timeout)&&void 0!==n?n:this.timeout}};function eD(e){var t=e.lastIndexOf(".");return e.slice(t+1).toLowerCase()}var eL=Object.create(null);function eO(e){var t,{rules:r,mode:n,timeout:o}=e||{},i=(0,C.useRef)(new eA({rules:r,mode:n,timeout:o})),[l,a]=(0,C.useState)(!1),[s,d]=(0,C.useState)(!1),[c,u]=(0,C.useState)(""),[p,m]=(0,C.useState)(""),[v,_]=(0,C.useState)("");(0,ek.Z)(()=>{var e;null===(e=i.current)||void 0===e||e.reset()}),(0,C.useEffect)(()=>{i.current.rules=r,i.current.mode=null!=n?n:i.current.mode},[r,n]);var f=(0,C.useCallback)(function(e){var t,{url:r,uri:n,fileName:o}=e,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0!==n&&u(n),void 0!==r&&m(r),void 0!==o&&_(o),!l&&(m(null!=r?r:""),u(null!=n?n:""),_(null!=o?o:"")),!o&&(n&&eL[n]?_(eL[n]):!n&&_("")),(void 0!==n||!l)&&(a(!1),d(!1),null===(t=i.current)||void 0===t||t.reset())},[]);var h=(0,C.useCallback)((t=(0,L._)(function*(e){if(yield i.current.select(e),!(null===(t=i.current.validateResult)||void 0===t?void 0:t.isSuccess))return D.FN.error((null===(r=i.current.validateResult)||void 0===r?void 0:r.msg)||"图片不符合要求"),i.current.validateResult;d(!1),a(!0),m(i.current.displayUrl||""),_(e.name||""),yield i.current.upload(),a(!1);var t,r,{uploadResult:n}=i.current;if(!!n)return d(!n.isSuccess),n.isSuccess?(D.FN.success(k.o.t("file_upload_success")),u(n.uri),eL[n.url]="".concat(e.name)):D.FN.error(n.msg),n}),function(e){return t.apply(this,arguments)}),[]),x=(0,C.useCallback)((0,L._)(function*(){if(!(null===(e=i.current)||void 0===e?void 0:e.file)||!(null===(r=i.current)||void 0===r?void 0:null===(t=r.validateResult)||void 0===t?void 0:t.isSuccess))return D.FN.error(k.o.t("imageflow_upload_action")),{isSuccess:!1,errNo:eP.NoFile,msg:"请选择文件"};a(!0),d(!1),yield i.current.upload(),a(!1);var e,t,r,n=i.current.uploadResult||{isSuccess:!1,errNo:eP.UploadFail,msg:"无上传结果"};return d(!n.isSuccess),n.isSuccess?(D.FN.success(k.o.t("file_upload_success")),u(n.uri),eL[n.url]=i.current.file.name):D.FN.error(n.msg),n}),[]);return{uri:c,url:p,fileName:v,loading:l,isError:s,uploadImg:h,clearImg:(0,C.useCallback)(()=>{var e;u(""),m(""),_(""),a(!1),d(!1),null===(e=i.current)||void 0===e||e.reset()},[]),retryUploadImg:x,setImgValue:f}}function eZ(e){return"number"==typeof e&&!isNaN(e)}r("657868");var eF=e=>{var t,r,n,o,{options:i=[],value:l,defaultValue:a,minWidth:s=0,maxWidth:d=1/0,minHeight:c=0,maxHeight:u=1/0,onChange:p,readonly:m,selectClassName:v="",layoutStyle:_="horizontal"}=e,f=null!==(r=null!==(t=null==l?void 0:l.width)&&void 0!==t?t:null==a?void 0:a.width)&&void 0!==r?r:0,h=null!==(o=null!==(n=null==l?void 0:l.height)&&void 0!==n?n:null==a?void 0:a.height)&&void 0!==o?o:0,[x,g]=(0,C.useState)([]),[y,b]=(0,C.useState)(),j=e=>({width:Number(e.split("x")[0]),height:Number(e.split("x")[1])}),N=e=>"".concat(e.width,"x").concat(e.height);return(0,C.useEffect)(()=>{var e,t=N({width:f,height:h}),r=i.map(e=>(0,Z._)((0,O._)({},e),{originValue:e.value,value:N(e.value)})),n=r.find(e=>e.value===t);!n&&r.push({label:k.o.t("customize_key_1"),value:"custom"}),b(null!==(e=null==n?void 0:n.value)&&void 0!==e?e:"custom"),g(r)},[f,h,i]),(0,w.jsxs)("div",{className:"flex flex-wrap gap-[12px]",children:[(0,w.jsx)(D.Ph,{onChange:e=>{if("custom"!==e)p(j(e))},disabled:m,className:"".concat(v," ").concat("horizontal"===_?"":"w-full"),value:y,optionList:x,size:"small"}),(0,w.jsx)("div",{className:"flex-1 flex items-center",children:(0,w.jsx)(D.k7,{size:"small",prefix:k.o.t("imageflow_canvas_width"),hideButtons:!0,onNumberChange:e=>{if(!isNaN(e))p({width:Number(e),height:h})},onBlur:e=>{""===e.target.value||eZ(s)&&Number(e.target.value)<s?p({width:null!=s?s:0,height:h}):Number(e.target.value)>d&&p({width:d,height:h})},value:f,disabled:m,min:s,max:d,className:"flex-1"})}),(0,w.jsx)("div",{className:"flex-1 flex items-center",children:(0,w.jsx)(D.k7,{prefix:k.o.t("imageflow_canvas_height"),size:"small",hideButtons:!0,onNumberChange:e=>{if(!isNaN(e))p({height:Number(e),width:f})},onBlur:e=>{""===e.target.value||eZ(c)&&Number(e.target.value)<c?p({width:f,height:null!=c?c:0}):eZ(u)&&Number(e.target.value)>u&&p({width:f,height:u})},value:h,disabled:m,min:c,max:u,className:"flex-1"})})]})},eM=e=>{var{text:t="",rows:r=1,className:n,tooltipPosition:o}=e;return(0,w.jsx)(D.ZT.Paragraph,{ellipsis:{rows:r,showTooltip:{type:"tooltip",opts:{style:{width:"100%",wordBreak:"break-word"},position:o}}},className:n,children:t})},ez=r("887874"),eR=r("740835"),eB=r("734083");function eV(e){var t=(0,C.useRef)(e);return t.current=e,t}function eU(e,t){try{return JSON.parse(JSON.stringify(e,function(e,r){return t.includes(e)?null:r}))}catch(t){return e}}function eH(e){var[t,r]=(0,C.useState)(e),n=(0,C.useRef)(e);return(0,C.useLayoutEffect)(()=>{!(0,eB.J)(eU(e,["parent"]),eU(n.current,["parent"]))&&(r(e),n.current=e)},[e]),t}function eW(){return Math.floor(2e6*Math.random()).toString(36)}function eG(e){var t=x.toSegments(e);if(!t)return"";var r=t[t.length-1].type===$.ArrayIndex?t[t.length-2]:t[t.length-1];return r&&r.type===$.ObjectKey?r.objectKey:""}var eK=r("642199"),eJ=r("249294"),eq=r("919658"),e$=r("347278"),eX="api.skip-selection-change",eY=e$.Z["expression-editor-suggestion-keyboard-selected"],eQ=e=>{if(!e)return;var t=e.querySelectorAll(".semi-tree-option-list .semi-tree-option");if(0!==t.length){var r=[...t],n=r.findIndex(e=>e.classList.contains(eY));return{elements:r,selectedIndex:n,selectedElement:r[n]}}};function e0(e,t){var r=e[t];if(!!r)e.forEach(e=>{e.classList.contains(eY)&&e.classList.remove(eY)}),r.classList.add(eY),r.scrollIntoView({behavior:"smooth",block:"nearest"})}function e1(e,t,r){if(!e)return;var n,o,{from:i,to:l,textBefore:a}=r,s=function(e,t){var r,n=null!==(r=x.toSegments(t))&&void 0!==r?r:[];return h.concatFullPath({node:e,segments:n})}(t,a);if(!!s)e.replaceTextByRange({from:i,to:l,text:s,cursorOffset:(null===(o=(n=t).variable)||void 0===o?void 0:o.children)&&0!==n.variable.children.length?0:2,userEvent:eX})}var e2=r("562312");function e4(e){return!e||!Array.isArray(e)||0===e.length}function e5(e,t){var r=eV(t);(0,C.useEffect)(()=>{if(!!e)return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)};function t(e){var t=r.current[e.key];"function"==typeof t&&t(e)}},[e])}function e6(e){var{visible:t,content:r}=e;return(0,w.jsx)("div",{className:e$.Z["expression-editor-suggestion-empty"],style:{display:t?"block":"none"},children:(0,w.jsx)("p",{children:r})})}var e3=(0,C.forwardRef)(function(e,t){var{visible:r,className:n,children:o}=e;return(0,w.jsx)("div",{className:E()(n,e$.Z["expression-editor-suggestion"]),style:{display:r?"block":"none"},ref:t,children:o})}),e8={Renderer:function(e){var t,r,{value:n,variableTree:o,className:i,readonly:l,placeholder:a,dataTestID:s,onChange:d}=e,c=(0,C.useRef)(null),u=eV(o),p=eH(o);var m=(t=c,(0,C.useMemo)(()=>[{type:"character",triggerCharacter:"{",handler(e){var r,{from:n,to:o}=e;return null===(r=t.current)||void 0===r||r.replaceTextByRange({from:n,to:o,text:"{{}}",cursorOffset:-2}),!0}}],[]));var v=(r=u,(0,C.useMemo)(()=>[(0,eK.ut)({}),eJ.tk.baseTheme({"& .cm-line":{padding:0},"& .cm-placeholder":{color:"inherit",opacity:.333},"& .cm-content":{wordBreak:"break-all"}}),[eK.Cj.whole.of((e,t)=>{var n,o,i,l,a;if(!!r.current){if("Interpolation"===e.node.type.name&&(null===(n=e.node.firstChild)||void 0===n?void 0:n.type.name)==="{{"&&(null===(o=e.node.lastChild)||void 0===o?void 0:o.type.name)==="}}"){;return(i=t.sliceDoc(e.node.firstChild.to,e.node.lastChild.from),l=r.current,(a=x.toSegments(i))&&a[a.length-1].type!==$.EndEmpty&&h.matchTreeBranch({tree:l,segments:a}))?{type:"className",className:"cm-decoration-interpolation-valid"}:{type:"className",className:"cm-decoration-interpolation-invalid"}}}}),eJ.tk.baseTheme({"& .cm-decoration-interpolation-valid":{color:"#6675D9",caretColor:"#6675D9"}})],[eK.Cj.fromCursor.of((e,t)=>{var{anchor:r}=t.selection.main;if("Interpolation"===e.node.type.name&&e.node.firstChild&&e.node.lastChild&&r>=e.node.firstChild.to&&r<=e.node.lastChild.from)return{type:"background",className:"cm-decoration-interpolation-active",from:e.node.firstChild.from,to:e.node.lastChild.to}}),eJ.tk.baseTheme({"& .cm-decoration-interpolation-active":{borderRadius:"2px",backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"}})]],[])),_=(0,C.useMemo)(()=>({class:"".concat(null!=i?i:""," flow-canvas-not-draggable"),"data-testid":null!=s?s:"","data-flow-editor-selectable":"false"}),[i,s]),f=(0,C.useCallback)(e=>{"function"==typeof d&&d(e.value)},[d]);return(0,C.useEffect)(()=>{var e=c.current;if(!!e)e.updateWholeDecorations()},[p]),(0,C.useEffect)(()=>{var e=c.current;if(!!e)"string"==typeof n&&n!==e.getValue()&&e.setValue(n)},[n]),(0,w.jsx)(ez.Th,{plugins:eR.Z,defaultValue:null!=n?n:"",options:{fontSize:14,inputRules:m,readOnly:l,placeholder:a,contentAttributes:_},onFocus:function(){var e=c.current;if(!!e)e.updateWholeDecorations()},onChange:f,extensions:v,didMount:e=>c.current=e})},Popover:function(e){var t,r,n,o,i,l,a,s,d,c,u,p,m,v,_,f,g,y,b,j,N,S,E,{getPopupContainer:T,variableTree:I,className:P,onVisibilityChange:A}=e,D=eH(I),L=(0,C.useRef)(null),O=(0,C.useRef)(null),Z=eV(A),[F,M]=(0,C.useState)(""),z=(0,ez.jE)(),R=eV(z),B=function(e){var[t,r]=(0,C.useState)(),n=eV(t);return(0,C.useEffect)(()=>{if(!!e){var t=e.$view;return e.$on("selectionChange",i),e.$on("focus",l),()=>{e.$off("selectionChange",i),e.$off("focus",l)}}function o(e){if(null==e?void 0:e.transactions.some(e=>e.isUserEvent(eX))){r(void 0);return}var o,i,{from:l,to:a,anchor:s,head:d}=t.state.selection.main;if(o={from:l,to:a,anchor:s,head:d},i=n.current,(!!o||!!i)&&(!o||!i||o.anchor!==i.anchor||o.head!==i.head||o.from!==i.from||o.to!==i.to))r({from:l,to:a,anchor:s,head:d})}function i(e){o(e.update)}function l(){o()}},[e]),t}(z),V=function(e){var[t,r]=(0,C.useState)(!1);return(0,C.useEffect)(()=>{if(!!e)return e.$on("focus",t),e.$on("blur",n),()=>{e.$off("focus",t),e.$off("blur",n)};function t(){r(!0)}function n(){r(!1)}},[e]),t}(z);var U=(t=z,r=null==B?void 0:B.anchor,(0,C.useMemo)(()=>{if(!!t&&void 0!==r)return function(e,t){var r=(0,e2.qz)(e.state).cursorAt(t);do if("Interpolation"===r.node.type.name&&r.node.firstChild&&r.node.lastChild&&t>=r.node.firstChild.to&&t<=r.node.lastChild.from){var n=e.state.sliceDoc(r.node.firstChild.to,r.node.lastChild.from),o=t-r.node.firstChild.to;return{from:r.node.firstChild.to,to:r.node.lastChild.from,text:n,offset:o,textBefore:n.slice(0,o)}}while(r.parent())}(t.$view,r)},[t,r]));var H=(n=z,o=D,i=U,(0,C.useMemo)(()=>{if(!n||!i)return[];var e=x.toSegments(i.textBefore);return e?h.pruning({tree:o,segments:e}):[]},[n,o,i]));var W=(l=U,a=H,(0,C.useMemo)(()=>{if(!a)return[];if(!l)return a;var e=eG(l.textBefore);return a.filter(t=>t.label.startsWith(e))},[l,a]));var G=(s=D,d=H,c=U,(0,C.useMemo)(()=>{if(!!c){if(e4(s))return""===c.textBefore?k.o.t("workflow_variable_refer_no_input"):void 0;if(e4(d)){if(""===c.text)return k.o.t("workflow_variable_refer_no_input");var e=x.toSegments(c.textBefore);if(!e)return;var t=h.matchTreeBranch({tree:null!=s?s:[],segments:e});if(t&&0!==t.length)return k.o.t("workflow_variable_refer_no_sub_variable")}}},[s,d,c]));u=function(e){var[t,r]=(0,C.useState)("");return(0,C.useEffect)(()=>{r(eW())},[e]),t}(W),p=L,m=U,v=()=>{var e=eQ(O.current);if(!!e){var{elements:t}=e;e0(t,0)}},_=eV(m),(0,C.useEffect)(()=>{if(p.current&&_.current){var e=eG(_.current.textBefore);p.current.search(e),v()}},[u,m]);var K=(f=null==U?void 0:U.text,g=D,(0,C.useMemo)(()=>{if(!f)return;var e=x.toSegments(f);if(!e)return;var t=h.matchTreeBranch({tree:g,segments:e});if(!!t)return t[t.length-1]},[f,g])),J=(0,C.useCallback)((e,t,r)=>{if(!!z&&!!U)e1(z,r,U)},[z,U]),q=V&&(!!U&&W.length>0||!!G),[$,X]=(0,C.useState)(!1);(0,C.useEffect)(()=>{X(!0)},[B]);var Y=q&&$;var{prev:Q,next:ee,apply:et}=(y=z,b=U,j=O,N=L,S=eV(y),E=eV(b),(0,C.useMemo)(()=>({prev:function(){var e=eQ(j.current);if(!e)return;var{elements:t,selectedIndex:r}=e;if(1!==t.length){var n=r-1<0?t.length-1:r-1;e0(t,n)}},next:function(){var e=eQ(j.current);if(!!e){var{elements:t,selectedIndex:r}=e,n=r+1>=t.length?0:r+1;e0(t,n)}},apply:function(){if(!E.current)return;var e,t,r,n,o=eQ(j.current);if(!o)return;var{selectedElement:i}=o,l=null==i?void 0:i.getAttribute("data-key");if(!l)return;var a=null===(n=N.current)||void 0===n?void 0:null===(r=n.state)||void 0===r?void 0:null===(t=r.keyEntities)||void 0===t?void 0:null===(e=t[l])||void 0===e?void 0:e.data;if(!!a)e1(S.current,a,E.current)}}),[]));return e5(Y,{ArrowUp:Q,ArrowDown:ee,Enter:et}),e5(Y,{Escape(){X(!1)}}),(0,C.useEffect)(()=>{var e,t;!0===Y?null===(e=R.current)||void 0===e||e.disableKeybindings(["ArrowUp","ArrowDown","Enter"]):null===(t=R.current)||void 0===t||t.disableKeybindings([])},[Y]),(0,C.useEffect)(()=>{"function"==typeof Z.current&&Z.current(Y)},[Y]),(0,w.jsx)(ei.J2,{trigger:"custom",visible:Y,keepDOM:!0,rePosKey:F,getPopupContainer:T,content:(0,w.jsxs)("div",{onMouseDown:e=>e.preventDefault(),style:{display:Y?"block":"none"},"data-expression-popover":!0,children:[(0,w.jsx)(e6,{visible:!!G,content:G}),(0,w.jsx)(e3,{ref:O,visible:!G,className:P,children:(0,w.jsx)(ei.mp,{className:e$.Z["expression-editor-suggestion-tree"],showFilteredOnly:!0,filterTreeNode:!0,onChangeWithObject:!0,ref:L,treeData:H,searchRender:!1,value:K,emptyContent:null,onSelect:J})})]}),children:(0,w.jsx)(eq.Vj,{side:eK.m6.Anchor,onChange:()=>M(eW())})})},EditorProvider:ez.KU},e9=r("189284"),e7=r("529223"),te=r("909776"),tt=e=>{if(!!e)return{product_draft_status:void 0!==e.product_draft_status?parseInt(e.product_draft_status||"0"):P.Lo5.Default,external_flow_info:e.external_flow_info,schema_type:void 0!==e.schema_type?parseInt(e.schema_type||"0"):P.XQ3.DAG,plugin_id:e.plugin_id,icon_uri:e.icon_uri,url:e.url}},tr=e=>{var t=tt(e.biz_extend);return{workflow_id:e.res_id,url:null==t?void 0:t.url,icon_uri:null==t?void 0:t.icon_uri,name:e.name,desc:e.desc,schema_type:null==t?void 0:t.schema_type,external_flow_info:null==t?void 0:t.external_flow_info,space_id:e.space_id}},tn=r("724847"),to=r("707107"),ti=e=>{var{spaceId:t="",refreshPage:r}=e,[n,o]=(0,C.useState)(P.wz8.Workflow),i=(0,tn.LA)({onPublishSuccess:()=>{null==r||r()},fromSpace:!0,flowMode:n});return{actionHandler:e=>{o(e.res_type===te.b0.Imageflow?P.wz8.Imageflow:P.wz8.Workflow),i.setSpace(t),i.showModal({type:tn.AK.WORKFLOW_INFO,product:{meta_info:{entity_id:e.res_id,name:e.name}},source:to.MU.WORKFLOW_PERSONAL_LIST})},publishModal:i.ModalComponent}},tl=e=>{var t,r,n,o,{spaceId:i,userId:l,refreshPage:a}=e,[s,d]=(0,C.useState)(!1),[c,u]=(0,C.useState)();var p=(t=(0,L._)(function*(e){if(!e.res_id||!i)throw new eE.sH("normal_error","miss workflowId or spaceID");N.E7.info({message:"workflow_list_delete_row",meta:{workflowId:e.res_id}});var t,r=P.KN6.CanDelete;r=(yield P.OHc.GetDeleteStrategy({space_id:i,workflow_id:e.res_id})).data;var n=[P.KN6.CanDelete,P.KN6.RejectProductDraft].includes(r);var o=(t=(0,L._)(function*(t){var r=(null==t?void 0:t.needDeleteBlockwise)?P.sL0.BlockwiseDelete:P.sL0.BlockwiseUnbind;if(!e.res_id||!i)throw new eE.sH("normal_error","miss workflowId or spaceID");try{yield P.OHc.DeleteWorkflow({space_id:i,workflow_id:e.res_id,action:r}),D.FN.success({content:k.o.t("workflow_add_delete_success"),showClose:!1}),N.E7.info({message:"workflow_list_delete_row_success"}),yield(0,N.Dc)(300),null==a||a()}catch(e){N.E7.error({message:"workflow_list_delete_row_fail",error:e}),D.FN.error({content:k.o.t("workflow_add_delete_fail"),showClose:!1})}}),function(e){return t.apply(this,arguments)});return{canDelete:n,deleteType:r,handleDelete:n?o:void 0}}),function(e){return t.apply(this,arguments)});var m=(r=(0,L._)(function*(e){var t=e.creator_id===l,r=yield p(e),n=k.o.t("delete_title");r.deleteType===P.KN6.UnListProduct&&(n=k.o.t("workflowstore_unable_to_delete_workflow"));var o=k.o.t("library_delete_desc");r.deleteType===P.KN6.UnListProduct&&(o=t?k.o.t("workflowstore_the_workflow_has_been"):k.o.t("workflowstore_delete_permission"));var i=r.canDelete?k.o.t("confirm"):k.o.t("workflowstore_remove_wf");r.deleteType===P.KN6.UnListProduct&&!t&&(i="");var a=k.o.t("cancel");r.deleteType===P.KN6.UnListProduct&&!t&&(a=k.o.t("confirm")),u({title:n,desc:o,cancelText:a,okText:i,okHandle:()=>{if(r.canDelete){var n;null==r||null===(n=r.handleDelete)||void 0===n||n.call(r,{needDeleteBlockwise:!1})}else r.deleteType===P.KN6.UnListProduct&&t&&window.open("/store/".concat(e.res_type===te.b0.Workflow?"workflow":"imageflow","/").concat(e.res_id,"?entity_id=true"),"_blank")}}),d(!0)}),function(e){return r.apply(this,arguments)});return{deleteModal:(0,w.jsx)(D.u_,{maskClosable:!1,centered:!0,visible:s,title:null!==(n=null==c?void 0:c.title)&&void 0!==n?n:"",onOk:()=>{d(!1),null==c||c.okHandle()},onCancel:()=>{d(!1)},closeOnEsc:!0,cancelText:null==c?void 0:c.cancelText,okText:null==c?void 0:c.okText,okButtonColor:"red",children:(0,w.jsx)("div",{className:"coz-common-content",children:null!==(o=null==c?void 0:c.desc)&&void 0!==o?o:""})}),actionHandler:m}},ta=r("157728"),ts=e=>{var t,{spaceId:r}=e,n=(0,ta.useNavigate)();return{actionHandler:(t=(0,L._)(function*(e){if(!e.res_id||!r)throw new eE.sH("normal_error","miss workflowId or spaceID");N.E7.info({message:"workflow_list_copy_row",meta:{workflowId:e.res_id}});try{var t=!1,{data:o}=yield P.OHc.CopyWorkflow({space_id:r,workflow_id:e.res_id});if(t=!(null==o?void 0:o.workflow_id)){D.FN.error(k.o.t("workflow_detail_toast_createcopy_failed")),N.E7.error({message:"workflow_list_copy_row_fail",error:new eE.sH("normal_error","result no workflow")});return}D.FN.success({content:e.res_type===te.b0.Imageflow?k.o.t("imageflow_detail_toast_createcopy_succeed"):k.o.t("workflow_detail_toast_createcopy_succeed"),showClose:!1}),N.E7.info({message:"workflow_list_copy_row_success",meta:{workflowId:e.res_id}}),yield(0,N.Dc)(300),n("/work_flow?workflow_id=".concat(o.workflow_id,"&space_id=").concat(r))}catch(e){N.E7.error({message:"workflow_list_copy_row_fail",error:e}),D.FN.error(k.o.t("workflow_detail_toast_createcopy_failed"))}}),function(e){return t.apply(this,arguments)})}},td=r("567282"),tc=e=>{var t,r,n,{spaceId:o,refreshPage:i}=e;var l=(t=(0,L._)(function*(e,t){yield P.OHc.UpdateWorkflowMeta({space_id:o,workflow_id:t,flow_mode:e}),D.FN.success(k.o.t("wf_chatflow_123",{Chatflow:k.o.t(e===td.wz.ChatFlow?"wf_chatflow_76":"Workflow")})),yield new Promise(e=>setTimeout(e,300)),null==i||i()}),function(e,r){return t.apply(this,arguments)});var a=(r=(0,L._)(function*(e){var t;return l(td.wz.Workflow,null!==(t=e.res_id)&&void 0!==t?t:"")}),function(e){return r.apply(this,arguments)});return{switchToWorkflow:a,switchToChatflow:(n=(0,L._)(function*(e){var t;return l(td.wz.ChatFlow,null!==(t=e.res_id)&&void 0!==t?t:"")}),function(e){return n.apply(this,arguments)})}},{ActionKey:tu}=e7,tp=e=>{var t,[r]=(0,e9.V)(),{userId:n,onEditWorkflowInfo:o,getCommonActions:i}=e,{actionHandler:l,deleteModal:a}=tl(e),{actionHandler:s}=ts(e),{actionHandler:d,publishModal:c}=ti(e),{switchToChatflow:u,switchToWorkflow:p}=tc({spaceId:null!==(t=e.spaceId)&&void 0!==t?t:"",refreshPage:e.refreshPage}),m={[tu.Copy]:s,[tu.Delete]:l,[tu.Edit]:e=>{o(tr(e))},[tu.SwitchToFuncflow]:p,[tu.SwitchToChatflow]:u},{enablePublishEntry:v}=(0,tn.lR)();return{renderWorkflowResourceActions:e=>{var t,o=tt(e.biz_extend),l=null==o?void 0:o.product_draft_status,a=e.res_type===te.b0.Imageflow,{actions:s}=e,c=null==s?void 0:s.find(e=>e.key===tu.Delete),u=null==s?void 0:s.find(e=>e.key===tu.Copy),p=null==s?void 0:s.find(e=>e.key===tu.Edit),_=null==s?void 0:s.find(e=>e.key===tu.SwitchToChatflow),f=null==s?void 0:s.find(e=>e.key===tu.SwitchToFuncflow),h=e.creator_id===n,x=[{hide:!p,disabled:(null==p?void 0:p.enable)===!1,actionKey:"edit",actionText:k.o.t("Edit"),handler:()=>{var t;return null==m?void 0:null===(t=m[tu.Edit])||void 0===t?void 0:t.call(m,e)}},{hide:!_,disabled:(null==_?void 0:_.enable)===!1,actionKey:"switchChatflow",actionText:k.o.t("wf_chatflow_121",{flowMode:k.o.t("wf_chatflow_76")}),handler:()=>{var t;return null==m?void 0:null===(t=m[tu.SwitchToChatflow])||void 0===t?void 0:t.call(m,e)}},{hide:!f,disabled:(null==f?void 0:f.enable)===!1,actionKey:"switchWorkflow",actionText:k.o.t("wf_chatflow_121",{flowMode:k.o.t("Workflow")}),handler:()=>{var t;return null==m?void 0:null===(t=m[tu.SwitchToFuncflow])||void 0===t?void 0:t.call(m,e)}},...null!==(t=null==i?void 0:i(e))&&void 0!==t?t:[],{hide:!v||!r["bot.community.store_imageflow"]&&a||!h||(null==o?void 0:o.plugin_id)==="0",actionKey:"publishWorkflowProduct",actionText:l===P.Lo5.Default?k.o.t("workflowstore_submit"):k.o.t("workflowstore_submit_update"),handler:()=>{null==d||d(e)}}];return(0,w.jsx)(D.iA.TableAction,{deleteProps:{hide:!c,disabled:(null==c?void 0:c.enable)===!1,disableConfirm:!0,handler:()=>{var t;return null===(t=m[tu.Delete])||void 0===t?void 0:t.call(m,e)}},copyProps:{hide:!u,disabled:(null==u?void 0:u.enable)===!1,handler:()=>{var t;return null===(t=m[tu.Copy])||void 0===t?void 0:t.call(m,e)}},actionList:x})},modals:[a,c]}},tm=e=>{var t=(0,ta.useNavigate)(),r=t=>{N.E7.info({message:"workflow_list_edit_row",meta:{workflowId:t}}),n(t,e)},n=(e,r)=>{if(!!e&&!!r)N.E7.info({message:"workflow_list_navigate_to_detail",meta:{workflowId:e}}),t("/work_flow?workflow_id=".concat(e,"&space_id=").concat(r))};return{handleWorkflowResourceClick:e=>{N.E7.info({message:"workflow_list_click_row"}),r(null==e?void 0:e.res_id)},goWorkflowDetail:n}},tv=e=>{var{from:t=ej.wL.SpaceWorkflowList,bindBizType:r,bindBizId:n,refreshPage:o,spaceId:i,goWorkflowDetail:l,projectId:a,onCreateSuccess:s,hiddenTemplateEntry:d,nameValidators:c}=e,[u,p]=(0,C.useState)(),[m,v]=(0,C.useState)("add"),[_,f]=(0,C.useState)(P.wz8.Workflow),[h,{setTrue:x,setFalse:g}]=(0,eb.Z)(!1),[y]=(0,e9.V)(),b=()=>{v("update"),N.E7.info({message:"workflow_list_open_create_modal"}),x()},S=(0,C.useMemo)(()=>T||y["bot.community.store_imageflow"]?{productCategory:"all",isSpaceWorkflow:!1,dataSourceType:ej.ye.Product}:{workflowTag:1,isSpaceWorkflow:!1,dataSource:ej.ye.Workflow},[y,_]),{node:E}=ew({from:t,flowMode:_,dupText:k.o.t("Copy"),hiddenCreate:!0,hiddenSpaceList:!0,initState:S,projectId:a,onAdd:()=>{null==o||o()},onDupSuccess:e=>{window.open("/work_flow?space_id=".concat(i,"&workflow_id=").concat(e.workflow_id,"&from=dupSuccess"))}}),T=(0,C.useMemo)(()=>(0,P.ikd)(_),[_]);return{openCreateModal:e=>{v("add"),f(e||P.wz8.Workflow),N.E7.info({message:"workflow_list_open_create_modal"}),x()},handleEditWorkflow:e=>{p(e),f(e.flow_mode||P.wz8.Workflow),b()},workflowModal:E,createWorkflowModal:(0,w.jsx)(j.d,{initConfirmDisabled:!0,mode:m,flowMode:_,projectId:a,visible:h,onCancel:g,bindBizType:r,bindBizId:n,workFlow:"update"===m?u:void 0,getLatestWorkflowJson:void 0,customTitleRender:void 0,onSuccess:e=>{var{workflowId:t}=e;if(g(),!t)throw new eE.sH("[Workflow] create failed","create workflow failed, no workflow id");if(s&&"add"===m){s({workflowId:t});return}if("update"===m){null==o||o();return}setTimeout(()=>{null==l||l(t,i)},500)},spaceID:i,nameValidators:c})}},t_=e=>{var{spaceId:t,userId:r,getCommonActions:n}=e,{handleWorkflowResourceClick:o,goWorkflowDetail:i}=tm(t),{openCreateModal:l,workflowModal:a,createWorkflowModal:s,handleEditWorkflow:d}=tv((0,Z._)((0,O._)({},e),{goWorkflowDetail:i})),{renderWorkflowResourceActions:c,modals:u}=tp((0,Z._)((0,O._)({},e),{userId:r,onEditWorkflowInfo:d,getCommonActions:n}));return{workflowResourceModals:[s,a,...u],openCreateModal:l,handleWorkflowResourceClick:o,renderWorkflowResourceActions:c}};r("184827"),r("649213");var tf=r("527021"),th=r("735114"),tx=r("214942"),tg=e=>{var{voice:t,onDelete:r,disabled:n}=e,{isPlaying:o,togglePlayPause:i}=(0,tn.xm)(null==t?void 0:t.preview_audio);return t?(0,w.jsxs)("div",{style:{backgroundColor:"var(--coz-mg-card-hovered)",display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",height:"44px",border:"1px solid var(--coz-stroke-primary)",padding:"6px",borderRadius:"var(--coze-8)",cursor:"pointer"},children:[(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,w.jsx)(D.qE,{shape:"square",size:"small",src:t.icon_url}),(0,w.jsx)("span",{style:{marginLeft:"8px",marginRight:"2px"},children:t.voice_name}),o?(0,w.jsx)(D.hU,{theme:"borderless",disabled:n,onClick:i,size:"small",color:"secondary",icon:(0,w.jsx)(A.T0r,{color:"#4E40E5"})}):(0,w.jsx)(D.hU,{theme:"borderless",disabled:n,onClick:i,size:"small",color:"secondary",icon:(0,w.jsx)(A.JE7,{color:"#4E40E5"})})]}),(0,w.jsx)(D.hU,{disabled:n,onClick:r,size:"small",color:"secondary",icon:(0,w.jsx)(A.dVD,{})})]}):null},ty=e=>{var[t,r]=(0,C.useState)(null),{loading:n}=(0,th.Z)(()=>e?eI.lv.APIMGetVoice({voice_ids:[e]}).then(e=>{var t,n,o,i,l=null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(t=n.voices)||void 0===t?void 0:t[0];return r(null==e?void 0:null===(i=e.data)||void 0===i?void 0:null===(o=i.voices)||void 0===o?void 0:o[0]),l}).catch(()=>(r(null),null)):Promise.resolve(null).then(()=>(r(null),null)),{refreshDeps:[e]});return{voice:t,setVoice:r,loading:n}},tb=e=>{var{value:t,onChange:r,disabled:n}=e,[o,i]=(0,C.useState)(t),l=(0,tx.rY)(e=>e.space.id)||"",{voice:a,setVoice:s}=ty(o);(0,C.useEffect)(()=>{i(t)},[t]);var{open:d,modal:c}=(0,tn.PF)({spaceId:l,onSelectVoice:e=>{s(e),null==r||r(e.voice_id)}});return(0,w.jsxs)(w.Fragment,{children:[(null==a?void 0:a.voice_id)?(0,w.jsx)(tg,{disabled:n,voice:a,onDelete:()=>{s(null),null==r||r(void 0)}}):(0,w.jsx)(D.zx,{disabled:n,style:{width:"100%",fontWeight:"500"},size:"small",icon:(0,w.jsx)(A.PwN,{}),color:"primary",onClick:d,children:k.o.t("workflow_variable_select_voice")}),c]})}},891052:function(e,t,r){r.d(t,{w:function(){return o}});var n,o=((n={}).WorkflowAddNode="workflow_addNode",n.BotSkills="bot_skills",n.BotSkillsDouyin="bot_skills_douyin_ide",n.BotMultiSkills="bot_multi_skills",n.BotTrigger="bot_trigger",n.BotShortcut="bot_shortcut",n.SpaceWorkflowList="space_workflow_list",n.WorkflowAgent="workflow_agent",n.SocialSceneHost="social_scene_host",n.ProjectImportLibrary="project_import_library",n.ProjectWorkflowAddNode="project_workflow_addNode",n.ProjectAddWorkflowResource="project_add_workflow_resource",n)},104313:function(e,t,r){r.d(t,{Dc:()=>l,pJ:()=>m,E7:()=>a,mk:()=>i}),r("479886");var n,o=r("297158"),i=()=>{if(void 0===n){var{userAgent:e}=navigator,t=/iPad/.test(e),r=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;n=t||r}return n},l=e=>new Promise(t=>{setTimeout(t,e)}),a=o.E7.createReporterWithPreset({namespace:"workflow"}),s=r("174558"),d=r.n(s),c=r("336205"),u={"zh-CN":"zh_CN",zh:"zh-CN",zh_TW:"zh_TW","en-US":"en",en:"en","ja-JP":"ja",ja:"ja","ko-KR":"ko",ko:"ko","fr-FR":"fr",fr:"fr","de-DE":"de",de:"de","it-IT":"it",it:"it","es-ES":"es",es:"es"},p=e=>{var t=null==e?void 0:e.split(" ");if((null==t?void 0:t.length)!==6)return!1;try{var r=d().toString(e,{locale:u["zh-CN"],throwExceptionOnParseError:!0});if(r.includes("null")||r.includes("undefined"))return!1;return!0}catch(e){return!1}},m=(e,t)=>{if(!e)return"";var r,n=c.o.getLanguages();return p(e)?d().toString(e,{locale:null!==(r=u[n[0]])&&void 0!==r?r:u["zh-CN"],use24HourTimeFormat:!0}):null!=t?t:c.o.t("workflow_trigger_param_unvalid_cron",{},"参数为非法 cron 表达式")}},419034:function(e,t,r){r.d(t,{d:function(){return N}});var n=r(825955),o=r(808549),i=r(120454),l=r(151064),a=r(455069),s=r(345420),d=r(408487),c=r(450562),u=r(75117),p=r(458620),m=r(297158),v=r(336205),_=r(378925),f=r(915757),h=r(674343),x=r(214942),g=r(775699),y=r(727914),b=r(178385),j=r(308418),w=["702095075","702095081"],{Checkbox:C}=g.l0,k=e=>{if(!!e)return[{url:e.url||"",uid:e.icon_uri||""}]};function N(e){var t,r,N,S,E,{flowMode:T=d.wz8.Workflow,mode:I,bindBizId:P,bindBizType:A,projectId:D,visible:L,workFlow:O,initConfirmDisabled:Z=!1,customTitleRender:F,onSuccess:M,onCancel:z,nameValidators:R=[]}=e,B=(0,a.useRef)(null),[V,U]=(0,a.useState)(Z),[H,W]=(0,a.useState)(),G=(0,_.Pc)(),K=null!==(E=null!==(S=null==G?void 0:G.locale)&&void 0!==S?S:navigator.language)&&void 0!==E?E:"en-US";var J=(t=(0,n._)(function*(){var e,t=null===(e=B.current)||void 0===e?void 0:e.formApi;return yield null==t?void 0:t.validate(["name"]),null==t?void 0:t.getValues()}),function(){return t.apply(this,arguments)}),q=()=>{m.E7.info({message:"workflow_info_modal_cancel",namespace:"workflow"}),W(void 0),null==z||z()},$=e=>{if(w.includes(e.code||"")){U(!0),W(e.msg);return}throw q(),e};var X=(r=(0,n._)(function*(){var e,t=null==O?void 0:O.workflow_id;if(m.E7.info({message:"workflow_info_modal_confirm_update",namespace:"workflow",meta:{workflowId:t}}),!t){var r=v.o.t("workflow_list_create_modal_workflow_id_empty");throw new y.sH(p.b.parmasValidation,r)}var n=yield J(),o={workflow_id:t,icon_uri:(null==n?void 0:null===(e=n.icon_uri)||void 0===e?void 0:e[0].uid)||"",name:null==n?void 0:n.name,desc:(null==n?void 0:n.target)?n.target:"",space_id:O.space_id||"",ignore_status_transfer:!0,schema_type:(null==n?void 0:n.schema_type)||(null==O?void 0:O.schema_type)};try{yield d.OHc.UpdateWorkflowMeta(o),m.E7.info({message:"workflow_info_modal_update_success",namespace:"workflow"}),h.FN.success({content:v.o.t("workflow_list_update_success"),showClose:!1}),yield null==M?void 0:M({workflowId:t,flowMode:T})}catch(e){m.E7.error({message:"workflow_info_modal_update_fail",namespace:"workflow",error:e}),$(e)}}),function(){return r.apply(this,arguments)});var Y=(N=(0,n._)(function*(){m.E7.info({message:"workflow_info_modal_confirm_create",namespace:"workflow"});var e=yield J();try{var t,r,n,l=(0,i._)((0,o._)({},e),{space_id:x.rY.getState().getSpaceId(),name:(null==e?void 0:e.name)||"",desc:(null==e?void 0:e.target)||"",icon_uri:(null==e?void 0:null===(r=e.icon_uri)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.uid)||"",flow_mode:T,bind_biz_id:P,bind_biz_type:A,project_id:D,create_conversation:D?null==e?void 0:e.create_conversation:void 0}),a=yield d.OHc.CreateWorkflow(l,{headers:{"x-locale":K}}),s=T===d.wz8.Imageflow?v.o.t("imageflow_create_toast_success"):T===d.wz8.ChatFlow?v.o.t("wf_chatflow_95"):v.o.t("workflow_list_create_success");h.FN.success({content:s,showClose:!1}),yield null==M?void 0:M({workflowId:null===(n=a.data)||void 0===n?void 0:n.workflow_id,flowMode:T}),m.E7.info({message:"workflow_info_modal_create_success",namespace:"workflow"})}catch(e){m.E7.error({message:"workflow_info_modal_create_fail",namespace:"workflow",error:e}),$(e)}}),function(){return N.apply(this,arguments)}),Q=(0,a.useMemo)(()=>{var e=function(e,t){switch(t){case d.wz8.Imageflow:return"add"===e?v.o.t("imageflow_create"):v.o.t("imageflow_edit");case d.wz8.Workflow:return"add"===e?v.o.t("workflow_list_create_modal_title"):v.o.t("workflow_list_edit_modal_title");case d.wz8.ChatFlow:return"add"===e?v.o.t("wf_chatflow_81"):v.o.t("wf_chatflow_84");default:return"add"===e?v.o.t("workflow_list_create_modal_title"):v.o.t("workflow_list_edit_modal_title")}}(I,T);return F&&(0,s.Z)(F)?F(e):e},[I,T,F]),ee=(0,a.useMemo)(()=>T===d.wz8.Imageflow?{nameLabel:v.o.t("imageflow_create_name"),namePlaceholder:v.o.t("imageflow_create_name_placeholder"),descLabel:v.o.t("imageflow_create_description"),descPlaceholder:v.o.t("imageflow_create_description_placeholder"),nameRequiredLabel:v.o.t("imageflow_create_name_placeholder"),nameFormatRuleLabel:v.o.t("imageflow_create_name_wrong_format"),descRequiredLabel:v.o.t("imageflow_create_description_placeholder")}:T===d.wz8.ChatFlow?{nameLabel:v.o.t("wf_chatflow_85"),namePlaceholder:v.o.t("wf_chatflow_91"),descLabel:v.o.t("wf_chatflow_86"),descPlaceholder:v.o.t("wf_chatflow_92"),nameRequiredLabel:v.o.t("wf_chatflow_93"),nameFormatRuleLabel:v.o.t("wf_chatflow_94"),descRequiredLabel:v.o.t("wf_chatflow_122")}:{nameLabel:v.o.t("workflow_list_create_modal_name_label"),namePlaceholder:v.o.t("workflow_list_create_modal_name_placeholder"),descLabel:v.o.t("workflow_list_create_modal_description_label"),descPlaceholder:v.o.t("workflow_list_create_modal_description_placeholder"),nameRequiredLabel:v.o.t("workflow_list_create_modal_name_rule_required"),nameFormatRuleLabel:v.o.t("workflow_list_create_modal_name_rule_reg"),descRequiredLabel:v.o.t("workflow_list_create_modal_description_rule_required")},[T]),et=(0,a.useMemo)(()=>{switch(T){case d.wz8.Imageflow:return b.Tu.Imageflow;case d.wz8.Workflow:return b.Tu.Workflow;case d.wz8.ChatFlow:return b.Tu.ChatFlow;default:return b.Tu.Workflow}},[T]);return(0,l.jsx)(g.M5,{type:"action-small",keepDOM:!1,icon:null,visible:L,onCancel:q,title:Q,footer:(0,l.jsxs)(h.T,{children:[(0,l.jsx)(h.zx,{className:"min-w-[96px]",color:"primary",onClick:q,"data-testid":"workflow.list.create.cancel",children:v.o.t("workflow_list_create_modal_footer_cancel")}),(0,l.jsx)(h.fl,{className:"min-w-[96px]",color:"hgltplus",disabled:V,onClick:"add"===I?Y:X,"data-testid":"workflow.list.create.submit",children:v.o.t("workflow_list_create_modal_footer_confirm")})]}),children:(0,l.jsxs)(g.l0,{ref:B,showValidateIcon:!1,className:j.Z["upload-form"],onValueChange:e=>{var{name:t,target:r}=e;W(void 0),U(!(null==t?void 0:t.trim())||!(null==r?void 0:r.trim()))},children:[(0,l.jsx)(u.s,{noLabel:!0,fieldClassName:j.Z["upload-field"],field:"icon_uri",initValue:k(O),iconType:et,fileBizType:b.ym.BIZ_BOT_WORKFLOW}),(0,l.jsx)(g.P6,{stopValidateWithError:!0,className:j.Z["textarea-single-line"],field:"name",placeholder:ee.namePlaceholder,label:ee.nameLabel,initValue:null==O?void 0:O.name,rows:1,maxCount:c.hhB,maxLength:c.hhB,rules:[{required:!0,message:ee.nameRequiredLabel},{validator(e,t){if(!c.Pz_.test(t)){var r;return new y.sH(p.b.formValidation,null!==(r=ee.nameFormatRuleLabel)&&void 0!==r?r:"")}return!0}},...R],"data-testid":"workflow.list.create.name.input"}),"add"===I&&D&&T===d.wz8.ChatFlow?(0,l.jsxs)(C,{fieldClassName:j.Z["conversation-field"],noLabel:!0,initValue:!0,field:"create_conversation",children:[(0,l.jsx)(g.ZT.Text,{className:"coz-fg-primary",children:v.o.t("wf_chatflow_87")}),(0,l.jsx)(h.u,{position:"top",theme:"dark",style:{width:278},content:v.o.t("wf_chatflow_82"),children:(0,l.jsx)(f.L03,{className:"text-[16px] ml-1.5 coz-fg-dim"})})]}):null,(0,l.jsx)(g.P6,{field:"target",className:j.Z["textarea-multi-line"],label:ee.descLabel,placeholder:ee.descPlaceholder,initValue:null==O?void 0:O.desc,maxCount:600,maxLength:600,rules:[{required:!0,message:ee.descRequiredLabel}],"data-testid":"workflow.list.create.desc.input"}),"string"==typeof H?(0,l.jsx)(g.l0.ErrorMessage,{error:H}):null]})})}},716421:function(e,t,r){r.d(t,{hm:function(){return l}});var n=r(408487),o=r(336205),i=r(518175);o.o.t("workflow_list_scope_all"),o.o.t("workflow_list_scope_mine");var l=[{label:o.o.t("workflow_list_status_all"),value:i.aJ},{label:o.o.t("workflow_list_status_published"),value:n.VBX.HadPublished},{label:o.o.t("workflow_list_status_unpublished"),value:n.VBX.UnPublished}];o.o.t("workflow_list_sort_create_time"),n.d$J.CreateTime,o.o.t("workflow_list_sort_edit_time"),n.d$J.UpdateTime},706188:function(e,t,r){r.d(t,{h:()=>er});var n=r("808549"),o=r("151064"),i=r("455069"),l=r("664319"),a=r("998262"),s=r("584466"),d=r("136515"),c=r("569502"),u=r("364676"),p=r("408487"),m=r("450562"),v=r("531464"),_=r("336205"),f=r("915757"),h=r("674343"),x=r("775699"),g=r("117140"),y=r("731870"),b=r("242505"),j=r("398420"),w=r("518175"),C=r("891052"),k=r("184827"),N=r("101094"),S=r("825955"),E=r("120454"),T=r("155440"),I=r("479886"),P=r("252237"),A=r.n(P),D=r("567282"),L=r("178385"),O=e=>{var{data:t,onImport:r}=e,n=(null==t?void 0:t.plugin_id)&&(null==t?void 0:t.plugin_id)!=="0",i=(0,o.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,o.jsx)(h.zx,{disabled:!n,color:"primary","data-testid":"workflow.modal.add",onClick:e=>{e.stopPropagation(),(null==t?void 0:t.workflow_id)&&(null==r||r({workflow_id:t.workflow_id,name:t.name||""}))},children:_.o.t("project_resource_modal_copy_to_project")})});return n?i:(0,o.jsx)(h.u,{position:"top",content:_.o.t("project_toast_only_published_resources_can_be_imported"),children:i})},Z=r("649213"),F=r("189454"),{Paragraph:M,Text:z}=h.ZT,R=e=>{var{type:t,format:r,assist_type:n}=e,o="";return t&&(o=t===p.n$I.String&&r===p.vGB.ImageUrl?"Image":t===p.n$I.String&&n?c.Tg[n]:c.fw[t]),o},B=e=>{var{children:t,items:r}=e;return(0,o.jsx)(x.J2,{stopPropagation:!0,position:"top",spacing:0,content:(0,o.jsx)("div",{className:F.Z.popover,children:r.map((e,t)=>(0,o.jsxs)("div",{className:F.Z.item,children:[(0,o.jsxs)("div",{className:F.Z.header,children:[(0,o.jsx)(z,{ellipsis:{showTooltip:{opts:{content:e.name||"",position:"top",style:{wordBreak:"break-word"}}}},children:(0,o.jsx)("span",{className:F.Z.name,children:e.name||"-"})}),(0,o.jsx)("span",{className:F.Z.type,children:e.type||"-"}),!!e.required&&(0,o.jsx)("span",{className:F.Z.required,children:_.o.t("workflow_add_parameter_required")})]}),(0,o.jsx)("div",{className:F.Z.footer,children:(0,o.jsx)(M,{ellipsis:{rows:2,showTooltip:{opts:{content:e.desc||"",position:"top",style:{wordBreak:"break-word"}}}},children:(0,o.jsx)("span",{className:F.Z.footer,children:e.desc||"-"})})})]},"item".concat(t)))}),children:t})},V=e=>{var t,r,l,a,s,d,c,u,{data:p,style:m,className:v}=e,_=(0,i.useContext)(b.Z);var f=(u=0,(null==_?void 0:_.modalState.dataSourceType)===w.ye.Workflow)?(null===(c=p.start_node)||void 0===c?void 0:null===(d=c.node_param)||void 0===d?void 0:null===(s=d.input_parameters)||void 0===s?void 0:s.map(e=>{var t=R(e);return{name:e.name,desc:e.desc,required:e.required,type:t}}))||[]:(null==p?void 0:null===(a=p.workflow_extra)||void 0===a?void 0:null===(l=a.start_node)||void 0===l?void 0:null===(r=l.node_param)||void 0===r?void 0:null===(t=r.input_parameters)||void 0===t?void 0:t.map(e=>{var t=R((0,E._)((0,n._)({},e),{type:e.input_type}));return{name:e.name,desc:e.desc,required:e.is_required,type:t}}))||[];return(0,o.jsx)("div",{className:A()(F.Z.container,v),style:m,children:(0,o.jsx)("div",{className:F.Z.wrapper,children:(0,o.jsx)(x.Dj,{items:f,overflowRenderer:e=>{var t=e.slice(-1*e.length);return t.length?(0,o.jsx)(B,{items:f,children:(0,o.jsx)("div",{children:(0,o.jsxs)(h.Vp,{style:{flex:"0 0 auto"},size:"mini",color:"primary",children:["+",t.length]})})}):null},visibleItemRenderer:e=>(0,o.jsx)(B,{items:f,children:(0,o.jsx)("div",{style:{marginRight:8},children:(0,o.jsx)(h.Vp,{size:"mini",color:"primary",children:e.name})})})})})})},U=r("297158"),H=e=>{var{className:t,onDelete:r}=e,[n,l]=(0,i.useState)(!1),a=()=>l(!1);return(0,o.jsx)("div",{className:t,onClick:e=>e.stopPropagation(),children:(0,o.jsx)(h.gn,{visible:n,title:_.o.t("scene_workflow_popup_delete_confirm_title"),content:_.o.t("scene_workflow_popup_delete_confirm_subtitle"),okText:_.o.t("shortcut_modal_confirm"),cancelText:_.o.t("shortcut_modal_cancel"),trigger:"click",position:"bottomRight",onConfirm:()=>new Promise((e,t)=>{null==r||r().then(()=>{a(),e(!0)}).catch(e=>{U.kg.error({error:e,eventName:"delete workflow error"}),t(e)})}),onCancel:a,okButtonColor:"red",children:(0,o.jsx)(h.hU,{icon:(0,o.jsx)(f.dVD,{}),type:"primary",onClick:e=>{e.stopPropagation(),l(!0)}})})})},W=r("689951"),G=r("374864"),K=e=>{var[t,{setFalse:r,setTrue:i}]=(0,W.Z)(!1),{i18nText:l,ModalI18nKey:a}=(0,N.v0)();return(0,o.jsx)(h.zx,(0,E._)((0,n._)({},e),{color:t?"red":"primary",className:A()({[G.Z.button]:!0,[G.Z.moreLevel]:!0}),onMouseEnter:()=>{i()},onMouseLeave:()=>{r()},"data-testid":"workflow.modal.button.added",children:t?l(a.ListItemRemove):_.o.t("workflow_add_list_added")}))},J=r("230119"),q=e=>{var{data:t,style:r,isAdded:n,onAdd:l,onRemove:a,className:s,from:d,workflowNodes:c,loading:u}=e,{plugin_id:p}=t||{},m=d===C.w.WorkflowAddNode||d===C.w.ProjectWorkflowAddNode,v=(0,i.useContext)(b.Z),f=(0,j.D)(null==v?void 0:v.modalState),g="0"!==p||f,y=d===C.w.SocialSceneHost,[w,k]=(0,i.useState)((c||[]).length),E=d===C.w.WorkflowAgent,T=(0,i.useMemo)(()=>{var e;return null==t?void 0:null===(e=t.check_result)||void 0===e?void 0:e.find(e=>e.type===D.gf.BotAgent)},[t]),{i18nText:I,ModalI18nKey:P}=(0,N.v0)();return(0,o.jsx)("div",{className:A()(J.Z.container,s),style:r,onClick:e=>e.stopPropagation(),children:(()=>{if(E&&T&&!T.is_pass)return(0,o.jsx)(x.u,{position:"top",className:J.Z.not_publish_tooltip,content:(0,o.jsx)("span",{className:J.Z.content,children:T.reason}),children:(0,o.jsx)(h.fl,{disabled:!0,color:"primary",className:J.Z.button,"data-testid":"workflow.modal.add",children:_.o.t("workflow_add_list_add")})});if(n)return(0,o.jsx)(x.gn,{title:I(P.ListItemRemoveConfirmTitle),content:I(P.ListItemRemoveConfirmDescription),okType:"danger",position:"topRight",onConfirm:a,zIndex:9999,okText:_.o.t("neutral_age_gate_confirm",{},"Confirm"),cancelText:_.o.t("workflow_240218_17",{},"Cancel"),children:(0,o.jsx)("div",{children:(0,o.jsx)(K,{})})});if(!g){var e="workflow_add_not_allow_before_publish";return m?e="wf_node_add_wf_modal_tip_must_publish_to_add":y&&(e="scene_workflow_popup_add_forbidden"),(0,o.jsx)(x.u,{position:"top",className:J.Z.not_publish_tooltip,content:(0,o.jsx)("span",{className:J.Z.content,children:_.o.t(e)}),children:(0,o.jsx)(h.fl,{disabled:!0,color:"primary",className:J.Z.button,"data-testid":"workflow.modal.add",children:_.o.t("workflow_add_list_add")})})}return n?null:(0,o.jsxs)(h.fl,{onClick:(0,S._)(function*(){(yield null==l?void 0:l())&&k(e=>e+1)}),color:"primary",className:J.Z.button,"data-testid":"workflow.modal.add",children:[_.o.t("workflow_add_list_add"),m&&0!==w?(0,o.jsx)("span",{className:J.Z.workflow_count_span,children:w}):null]})})()})},$=r("744420"),{Text:X}=h.ZT,Y=e=>(0,I.unix)(Number(e)).format("YYYY-MM-DD"),Q=[],ee=e=>{var t,{data:r,workFlowList:l=Q,from:a,workflowNodes:s,dupText:d,itemShowDelete:c}=e,u=(0,i.useContext)(b.Z),m=null==r?void 0:null===(t=r.meta_info)||void 0===t?void 0:t.is_professional,{dupWorkflowTpl:v,addWorkflow:g,removeWorkflow:y,deleteWorkflow:k,itemClick:N}=(0,Z.u)((0,E._)((0,n._)({},e),{isProfessionalTemplate:m}));if(!u)return null;var I={unpublished:{label:_.o.t("workflow_add_status_unpublished"),icon:(0,o.jsx)(f.gO2,{className:"coz-fg-dim text-xs"})},published:{label:_.o.t("workflow_add_status_published"),icon:(0,o.jsx)(f.nAC,{className:"text-xs coz-fg-hglt-green"})}},{orderBy:P,spaceType:F}=u,{creator:M,status:z,isSpaceWorkflow:R,workflowCategory:B}=u.modalState,U=F===L.Sn.Team;function W(e){return(null==u?void 0:u.modalState.dataSourceType)===w.ye.Workflow}var G=W(r)?r.plugin_id:"",K=!(0,T.Z)(G)&&R?I["0"===G?"unpublished":"published"]:void 0;return(0,o.jsxs)("div",{className:$.Z.container,onClick:()=>{N()},children:[(0,o.jsx)("div",{className:$.Z.left,children:(0,o.jsx)("div",{className:$.Z.icon,children:(0,o.jsx)(x.Ee,{preview:!1,src:W(r)?r.url:r.meta_info.icon_url})})}),(0,o.jsxs)("div",{className:$.Z.center,children:[(0,o.jsx)("div",{className:$.Z.header,children:(0,o.jsxs)("div",{className:$.Z.title_wrapper,children:[(0,o.jsx)(X,{ellipsis:{showTooltip:!0},className:$.Z.title,children:W(r)?r.name:r.meta_info.name}),(0,j.D)(null==u?void 0:u.modalState)||B===w.BD.Example?null:K?(0,o.jsxs)("div",{className:A()($.Z.status),children:[K.icon,(0,o.jsx)("span",{className:$.Z.text,children:K.label})]}):null]})}),(0,o.jsx)("div",{className:$.Z.content,children:(0,o.jsx)(X,{ellipsis:{showTooltip:{opts:{style:{maxWidth:600,wordBreak:"break-word"}}}},className:$.Z.desc,children:(W(r)?r.desc:r.meta_info.description)||""})}),(0,o.jsxs)("div",{className:$.Z.footer,children:[(0,o.jsx)(V,{data:r}),(()=>{if(!W(r)){var e,t,n,i,l,s="".concat(_.o.t("workflow_add_list_updated")," ").concat(Y(r.meta_info.listed_at));return(0,o.jsxs)("div",{className:$.Z.info,children:[(0,o.jsxs)("div",{className:$.Z.creator,children:[(0,o.jsx)(x.qE,{className:$.Z["creator-avatar"],src:null===(e=r.meta_info.user_info)||void 0===e?void 0:e.avatar_url}),(0,o.jsx)(X,{ellipsis:{showTooltip:!0},className:$.Z["creator-name"],children:null!==(l=null===(t=r.meta_info.user_info)||void 0===t?void 0:t.name)&&void 0!==l?l:_.o.t("workflow_add_list_unknown")}),(0,o.jsx)("span",{className:$.Z.symbol,children:"|"})]}),(0,o.jsx)("span",{className:$.Z.date,children:s}),(Number(null==r?void 0:null===(n=r.workflow_extra)||void 0===n?void 0:n.duplicate_count)||0)>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:$.Z.symbol,children:"|"}),(0,o.jsxs)(X,{className:$.Z.date,children:[Number(null==r?void 0:null===(i=r.workflow_extra)||void 0===i?void 0:i.duplicate_count)||0," ",_.o.t("workflowstore_card_duplicate")]})]}):null]})}if(R||B===w.BD.Example){var d,c,u,m=M!==w.gp.Mine&&U||a===C.w.ProjectImportLibrary,v=P===p.d$J.CreateTime?"".concat(_.o.t("workflow_add_list_created")," ").concat(Y(r.create_time)):z===p.VBX.HadPublished?"".concat(_.o.t("workflow_add_list_publised")," ").concat(Y(r.update_time)):"".concat(_.o.t("workflow_add_list_updated")," ").concat(Y(r.update_time));return(0,o.jsxs)("div",{className:$.Z.info,children:[m?(0,o.jsxs)("div",{className:$.Z.creator,children:[(0,o.jsx)(x.qE,{className:$.Z["creator-avatar"],src:null===(d=r.creator)||void 0===d?void 0:d.avatar_url}),(0,o.jsx)(X,{ellipsis:{showTooltip:!0},className:$.Z["creator-name"],children:null!==(u=null===(c=r.creator)||void 0===c?void 0:c.name)&&void 0!==u?u:_.o.t("workflow_add_list_unknown")}),(0,o.jsx)("span",{className:$.Z.symbol,children:"|"})]}):null,(0,o.jsx)("span",{className:$.Z.date,children:v})]})}return R?null:(0,o.jsxs)("div",{className:$.Z.creator,children:[(0,o.jsx)(x.Ee,{preview:!1,src:r.template_author_picture_url,className:$.Z.avatar}),(0,o.jsx)(X,{ellipsis:{showTooltip:!0},className:$.Z.name,children:r.template_author_name||"-"})]})})()]})]}),(0,o.jsx)("div",{className:$.Z.right,children:(0,o.jsx)("div",{className:$.Z.buttons,children:(()=>{if(B===w.BD.Example&&W(r)){var t,n,i=null==r?void 0:null===(n=r.check_result)||void 0===n?void 0:n.find(e=>e.type===D.gf.BotAgent);var u=(0,o.jsx)(h.fl,{color:"primary","data-testid":"workflow.modal.add",disabled:i&&!(null==i?void 0:i.is_pass),onClick:(t=(0,S._)(function*(e){e.stopPropagation(),yield v()}),function(e){return t.apply(this,arguments)}),children:d||_.o.t("workflowstore_duplicate_and_add")});return i&&!i.is_pass&&i.reason?(0,o.jsx)(x.u,{content:i.reason,children:u}):u}return a===C.w.ProjectImportLibrary?(0,o.jsx)(O,{data:r,onImport:e.onImport}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(q,{isAdded:l.some(e=>e.workflow_id===(null==r?void 0:r.workflow_id)),workflowNodes:s,from:a,data:r,onAdd:()=>g(),onRemove:()=>{y()}}),c?(0,o.jsx)(H,{className:"ml-[4px]",onDelete:k}):null]})})()})})]})},et=r("934910"),er=e=>{var t,r,{excludedWorkflowIds:S,from:E,projectId:T}=e,I=(0,i.useContext)(b.Z),{i18nText:P,ModalI18nKey:A}=(0,N.v0)(),{updatePageParam:D,isFetching:L,workflowList:O,fetchNextPage:Z,loadingStatus:F,refetch:M,hasNextPage:z,handleDelete:R}=(0,y.S)({pageSize:10,enabled:(null==I?void 0:I.modalState.dataSourceType)===w.ye.Workflow,from:E,fetchWorkflowListApi:(null==I?void 0:null===(r=I.modalState)||void 0===r?void 0:r.workflowCategory)!==w.BD.Example?m.OHc.GetWorkFlowList.bind(m.OHc):m.OHc.GetExampleWorkFlowList.bind(m.OHc)}),{workflowProductList:B,updatePageParam:V,fetchNextPage:U,isFetching:H,loadingStatus:W,hasNextPage:G,copyProduct:K}=(0,k.e)({pageSize:10,enabled:(null==I?void 0:I.modalState.dataSourceType)===w.ye.Product});(0,i.useEffect)(()=>{if(!!I){var{modalState:e,flowMode:t}=I;if(e.dataSourceType===w.ye.Workflow){var r,n,o=(0,j.D)(e);!e.isSpaceWorkflow&&(r=e.query?1:e.workflowTag),e.workflowCategory===w.BD.Example?(r=p.Vp9.All,n=p.uql.GuanFang):n=e.isSpaceWorkflow?p.uql.User:p.uql.GuanFang;var i=void 0;e.isSpaceWorkflow&&(i=e.status===w.aJ||o?void 0:e.status),D({space_id:I.spaceId,flow_mode:e.listFlowMode,name:e.query,order_by:e.isSpaceWorkflow?I.orderBy:void 0,status:i,type:n,project_id:(0,j.D)(e)?T:void 0,login_user_create:e.isSpaceWorkflow?e.creator===w.gp.Mine:void 0,tags:r,bind_biz_type:I.bindBizType,bind_biz_id:I.bindBizId})}else"recommend"===e.productCategory?V({keyword:e.query,sort_type:e.sortType,category_id:void 0,source:g.QJ.Recommend,entity_type:(0,m.ikd)(t)?g._J.WorkflowTemplateV2:g._J.ImageflowTemplateV2}):"all"===e.productCategory?V({keyword:e.query,sort_type:e.sortType,category_id:void 0,source:void 0,entity_type:(0,m.ikd)(t)?g._J.WorkflowTemplateV2:g._J.ImageflowTemplateV2}):V({keyword:e.query,sort_type:e.sortType,category_id:e.productCategory,source:void 0,entity_type:(0,m.ikd)(t)?g._J.WorkflowTemplateV2:g._J.ImageflowTemplateV2})}},[I]);var{nodes:J}=(0,u.I)((0,l.N)(e=>({nodes:e.nodes}))),q=(0,i.useMemo)(()=>{var e=J.filter(e=>e.type===c.ny.SubWorkflow);return(0,a.Z)(e,e=>{var t,r;return null==e?void 0:null===(r=e.data)||void 0===r?void 0:null===(t=r.inputs)||void 0===t?void 0:t.workflowId})},[J]),$=(0,i.useMemo)(()=>S?O.filter(e=>!S.includes(e.workflow_id||"")):O,[S,O]),X=(0,i.useRef)(null),Y=(0,i.useRef)(null),[Q]=(0,s.Z)(Y,{root:()=>X.current,threshold:.8});if((0,d.Z)(()=>{X.current&&X.current.scrollTo({top:0})},[null==I?void 0:I.modalState]),(0,i.useEffect)(()=>{if(!!Q)if(ei===w.ye.Workflow){if("success"!==F||L||!z)return;Z()}else{if("success"!==W||H||!G)return;U()}},[Q,F,L,z,W,H,G]),(0,i.useEffect)(()=>{if(!!(null==I?void 0:I.modalState.isSpaceWorkflow)){var e=()=>{"visible"===document.visibilityState&&M()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}},[null==I?void 0:I.modalState.isSpaceWorkflow,M]),!I)return null;function er(e){return(null==I?void 0:I.modalState.dataSourceType)===w.ye.Workflow}var{modalState:en,flowMode:eo}=I,{dataSourceType:ei}=I.modalState,el=ei===w.ye.Workflow?F:W,ea=ei===w.ye.Workflow?z:G,es=ei===w.ye.Workflow?$:B,ed=E===C.w.WorkflowAgent;return(0,o.jsx)(x.vy,{children:(0,o.jsx)(h.yC,{spinning:"pending"===el,wrapperClassName:et.Z.spin,style:{height:"100%",width:"100%"},children:(0,o.jsxs)("div",{className:"".concat(et.Z["workflow-content"]," new-workflow-modal-content"),ref:X,children:["pending"!==el&&es.length>0&&(0,o.jsxs)(x.vy.Content,{style:{minHeight:"100%",paddingBottom:ed?"60px":0},children:[(0,o.jsx)(o.Fragment,{children:es.map(t=>{var r;return(0,o.jsx)(ee,(0,n._)({data:t,itemShowDelete:(null==I?void 0:I.bindBizType)===p.k5N.DouYinBot,workflowNodes:er(t)&&null!==(r=q[t.workflow_id||""])&&void 0!==r?r:[],handleDeleteWorkflow:R,copyProductHandle:K},e),er(t)?t.workflow_id:t.meta_info.entity_id)})}),ea?(0,o.jsx)("div",{ref:Y,children:(0,o.jsxs)("div",{className:et.Z["loading-more"],children:[(0,o.jsx)(f.j2n,{className:"animate-spin coz-fg-dim mr-[4px]"}),(0,o.jsx)("div",{children:_.o.t("Loading")})]})}):null]}),"success"===el&&0===es.length&&(t=!!en.query,eo===p.wz8.SceneFlow?(0,o.jsx)(v.y,{title:P(A.CreatedListEmptyTitle),type:"social-scene-flow",isNotFound:t,notFound:t?P(A.ListEmptyTitle):""}):(0,o.jsx)(x.YZ,{isNotFound:t,notFound:{title:P(A.ListEmptyTitle)},empty:{title:P(A.CreatedListEmptyTitle),description:P(A.CreatedListEmptyDescription)}}))]})})})}},647045:function(e,t,r){r.d(t,{M:function(){return _}});var n=r(151064),o=r(455069),i=r(336205),l=r(674343),a=r(242505),s=r(518175),d=r(187724),c=r(442078),u=r(561326),p=r(101094),m=r(716421),v=e=>e?m.hm:m.hm.filter(e=>e.value!==s.aJ),_=e=>{var t,r=(0,o.useContext)(a.Z),s=(0,u.d)();if(!r)return null;var{updateModalState:m,flowMode:_}=r,{status:f}=r.modalState,{filterOptionShowAll:h=!1}=e,x=i.o.t(null===(t=p.fw[_])||void 0===t?void 0:t[p.sD.Title]);return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex items-center w-full justify-between mt-[-4px]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-[24px]",children:[(0,n.jsx)("div",{className:c.Z.titleForAvatar,children:x}),(0,n.jsx)(l.Ph,{insetLabel:i.o.t("publish_list_header_status"),showClear:!1,value:f,optionList:v(h),onChange:e=>{m({status:e})}})]}),(0,n.jsxs)("div",{className:"flex items-center gap-[12px] mr-[12px]",children:[(0,n.jsx)("div",{className:"w-[208px]",children:s}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(d.y,{onCreateSuccess:e.onCreateSuccess,nameValidators:e.nameValidators})})]})]}),(0,n.jsx)(l.jL,{type:"info",className:"mt-[16px] pt-[7px] pb-[7px] rounded-lg",description:i.o.t("dy_avatar_add_workflow_limit"),closeIcon:null})]})}},361408:function(e,t,r){r.d(t,{A:()=>j});var n=r("151064"),o=r("455069"),i=r("336205"),l=r("775699"),a=r("567282"),s=r("286518"),d=r("242505"),c=r("398420"),u=r("518175"),p=r("187724"),m=r("101094"),v=r("716421"),_=r("117140"),f=[{label:i.o.t("Popular",{},"最受欢迎"),value:_.ER.Heat},{label:i.o.t("mkpl_published",{},"最近发布"),value:_.ER.Newest}],h=[{label:i.o.t("store_search_rank_default",{},"相关性"),value:_.ER.Relative}].concat(f),x=()=>{var e=(0,o.useContext)(d.Z),{updateModalState:t}=e,{query:r,sortType:a}=(null==e?void 0:e.modalState)||{};return(0,n.jsx)(l.Cj,{label:i.o.t("Sort"),value:a,optionList:r?h:f,onChange:e=>{t({sortType:e})}})},g=r("954552"),y=e=>e?v.hm:v.hm.filter(e=>e.value!==u.aJ),b=[{label:i.o.t("filter_all"),value:a.wz.All},{label:i.o.t("library_resource_type_workflow"),value:a.wz.Workflow},{label:i.o.t("wf_chatflow_76"),value:a.wz.ChatFlow}],j=e=>{var t=(0,o.useContext)(d.Z),{i18nText:r,ModalI18nKey:a}=(0,m.v0)(),v=(0,o.useMemo)(()=>t?[{label:r(a.TabAll),value:u.gp.All},{label:r(a.TabMine),value:u.gp.Mine}]:[],[]);if(!t)return null;var{spaceType:_,updateModalState:f,modalState:h}=t,{dataSourceType:j,isSpaceWorkflow:w,status:C,creator:k,listFlowMode:N,workflowCategory:S}=t.modalState,{hideSider:E,hiddenCreate:T,filterOptionShowAll:I=!1,hideCreatorSelect:P=!1,hiddenListFlowModeFilter:A=!1}=e,D=S===u.BD.Example,L=(0,c.D)(h);return(0,n.jsxs)("div",{className:"".concat(g.Z.header," ").concat(E?"w-full justify-between":""),children:[(w||D)&&j===u.ye.Workflow?(0,n.jsxs)(n.Fragment,{children:[A?null:(0,n.jsx)(l.Cj,{label:i.o.t("Type"),showClear:!1,value:N,optionList:b,onChange:e=>{f({listFlowMode:e})}}),L||D?null:(0,n.jsx)(l.Cj,{label:i.o.t("publish_list_header_status"),showClear:!1,value:C,optionList:y(I),onChange:e=>{f({status:e})}}),_===s.Sn.Team&&!P&&!D&&(0,n.jsx)(l.Cj,{label:i.o.t("Creator"),showClear:!1,value:k,onChange:e=>{f({creator:e})},optionList:v})]}):null,E?(0,n.jsx)("div",{className:"flex items-center mr-[-24px]",children:!T&&(0,n.jsx)(p.y,{className:"ml-12px",onCreateSuccess:e.onCreateSuccess,nameValidators:e.nameValidators})}):null,j===u.ye.Product?(0,n.jsx)(x,{}):null]})}},101094:function(e,t,r){r.d(t,{fw:function(){return d},sD:function(){return s},v0:function(){return c}});var n,o=r(455069),i=r(408487),l=r(336205),a=r(242505);var s=((n={}).Title="title",n.NavigationMy="navigation_my",n.NavigationTeam="navigation_team",n.NavigationExplore="navigation_explore",n.TabAll="tab_all",n.TabMine="tab_mine",n.ListEmptyTitle="list_empty_title",n.CreatedListEmptyTitle="created_list_empty_title",n.CreatedListEmptyDescription="created_list_empty_description",n.NavigationCreate="navigation_create",n.ListError="list_error",n.ListItemRemove="list_item_remove",n.ListItemRemoveConfirmTitle="list_item_remove_confirm_title",n.ListItemRemoveConfirmDescription="list_item_remove_confirm_description",n),d={[i.wz8.Workflow]:{title:"workflow_add_title",navigation_my:"workflow_add_navigation_my",navigation_team:"workflow_add_navigation_team",navigation_explore:"workflow_add_navigation_explore",tab_all:"workflow_add_created_tab_all",tab_mine:"workflow_add_created_tab_mine",list_empty_title:"workflow_add_list_empty_title",created_list_empty_title:"workflow_add_created_list_empty_title",created_list_empty_description:"workflow_add_created_list_empty_description",navigation_create:"workflow_add_create_library",list_error:"workflow_add_list_added_id_empty",list_item_remove:"workflow_add_list_remove",list_item_remove_confirm_title:"workflow_add_remove_confirm_title",list_item_remove_confirm_description:"workflow_add_remove_confirm_content"},[i.wz8.Imageflow]:{title:"imageflow_add",navigation_my:"workflow_add_navigation_my",navigation_team:"imageflow_workspace2",navigation_explore:"imageflow_explore",tab_all:"workflow_add_created_tab_all",tab_mine:"workflow_add_created_tab_mine",list_empty_title:"imageflow_detail_no_search_result",created_list_empty_title:"imageflow_title",created_list_empty_description:"imageflow_title_description",navigation_create:"imageflow_create",list_error:"imageflow_add_toast_error",list_item_remove:"workflow_add_list_remove",list_item_remove_confirm_title:"workflow_add_remove_confirm_title",list_item_remove_confirm_description:"workflow_add_remove_confirm_content"},[i.wz8.SceneFlow]:{title:"scene_workflow_popup_title",navigation_my:"workflow_add_navigation_my",navigation_team:"workflow_add_navigation_team",navigation_explore:"workflow_add_navigation_explore",tab_all:"workflow_add_created_tab_all",tab_mine:"workflow_add_created_tab_mine",list_empty_title:"scene_workflow_popup_search_empty",created_list_empty_title:"scene_workflow_popup_list_empty",created_list_empty_description:"",navigation_create:"workflow_add_navigation_create",list_error:"workflow_add_list_added_id_empty",list_item_remove:{key:"scene_workflow_delete_workflow_button",options:{source:l.o.t("scene_mkpl_search_title")}},list_item_remove_confirm_title:{key:"scene_workflow_delete_workflow_popup_title",options:{source:l.o.t("scene_mkpl_search_title")}},list_item_remove_confirm_description:{key:"scene_workflow_delete_workflow_popup_subtitle",options:{source:l.o.t("scene_mkpl_search_title")}}}};function c(){var e,t=(0,o.useContext)(a.Z),r=null!==(e=null==t?void 0:t.flowMode)&&void 0!==e?e:i.wz8.Workflow;return{i18nText:e=>{var n,o,a,s=(null==t?void 0:null===(n=t.i18nMap)||void 0===n?void 0:n[e])||(null===(o=d[r])||void 0===o?void 0:o[e])||(null===(a=d[i.wz8.Workflow])||void 0===a?void 0:a[e]),c="string"==typeof s?s:s.key;return l.o.t(c||"",null==s?void 0:s.options)},ModalI18nKey:s}}}}]);
//# sourceMappingURL=8462.e7ea19fe.js.map