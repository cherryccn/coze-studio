{"version":3,"file":"static/js/async/8462.e7ea19fe.js","sources":["webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/plugin-feat-modal/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/entry/src/components/plugin-apis/plugin-modal.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/entry/src/components/plugin-apis/use-plugin-apis-modal.tsx","webpack://@coze-studio/app/../../packages/agent-ide/plugin-modal-adapter/src/components/plugin-modal/plugin-filter/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/plugin-modal-adapter/src/components/plugin-modal/filter/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/agent-skill-plugin-modal/sider/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/agent-skill-plugin-modal/content/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/agent-skill-plugin-modal/use-request-cache.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/agent-skill-plugin-modal/hooks.tsx","webpack://@coze-studio/app/../../packages/studio/plugin-form-adapter/src/components/plugin-form-content/utils.tsx","webpack://@coze-studio/app/../../packages/studio/plugin-form-adapter/src/components/plugin-form-content/index.tsx","webpack://@coze-studio/app/../../packages/studio/plugin-form-adapter/src/components/plugin-form-content/hooks.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/bot_edit/bot-form-edit/import-modal.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/bot_edit/bot-code-edit.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/bot_edit/bot-form-edit/code-modal.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/bot_edit/bot-form-edit/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/bot_edit/plugin-edit/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/editor/editor.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/utils.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/show-merge-tool.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/const.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/plugin-info-confirm/utils.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/plugin-info-confirm/fields.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/plugin-info-confirm/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/import-content.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/import-modal.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/file-import/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/export/src/component/plugin-docs/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/plugin-risk-warning/src/store.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/plugin-risk-warning/src/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/tools/src/components/info_popover/info-popover.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/tools/src/components/plugin_modal/config.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/tools/src/components/plugin_modal/types/modal.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/tools/src/components/plugin_modal/utils.ts","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/tools/src/hooks/example/use-view-example.tsx","webpack://@coze-studio/app/../../packages/agent-ide/bot-plugin/tools/src/hooks/example/utils.ts","webpack://@coze-studio/app/../../packages/agent-ide/context/src/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-form/form-item/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-form/preset-radio-group/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-form/group-item/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-form/type.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/model-option-avatar/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/model-option/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/model-option-thumb/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/popover-model-list-view/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/popover-model-config-view/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/model-select-ui/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/components/model-select-v2/model-select/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/constant/model-form-component.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/context/formily-context/context.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/context/formily-context/index.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/context/model-form-context/context.tsx","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/context/model-form-context/index.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/model/get-fixed-single-agent-schema.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/model/convert-model-params-to-schema.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/hooks/model/use-get-schema.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/model/get-fixed-model-form-values.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/model/get-diversity-preset-value-by-style.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/model/convert-model-info-to-flat-object.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/flatten-object.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/model/convert-form-value-to-model-info.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/field-init-strategy.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/hooks/model-form/use-handle-model-form.ts","webpack://@coze-studio/app/../../packages/agent-ide/model-manager/src/utils/exhaustive-check.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/constants/plugin-modal-constants.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/types/plugin-modal-types.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/types/auth-mode.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/utils/index.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/utils/get-api-unique-id.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/service/fetch-plugin.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/components/plugin-panel/plugin-perf-statics/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/components/plugin-panel/activate-popover/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/components/plugin-panel/item.tsx","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/components/plugin-panel/helper.ts","webpack://@coze-studio/app/../../packages/agent-ide/plugin-shared/src/components/plugin-panel/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/space-bot/src/component/rc-slider-wrapper/handle-render.tsx","webpack://@coze-studio/app/../../packages/agent-ide/space-bot/src/component/rc-slider-wrapper/index.tsx","webpack://@coze-studio/app/../../packages/agent-ide/space-bot/src/component/input-slider/input-slider.tsx","webpack://@coze-studio/app/../../packages/arch/bot-flags/src/use-flags.ts","webpack://@coze-studio/app/../../packages/arch/bot-monaco-editor/src/loader.ts","webpack://@coze-studio/app/../../packages/arch/bot-monaco-editor/src/index.tsx","webpack://@coze-studio/app/../../packages/arch/hooks/src/use-hover/index.ts","webpack://@coze-studio/app/../../packages/arch/hooks/src/use-persist-callback/index.ts","webpack://@coze-studio/app/../../packages/arch/hooks/src/use-toggle/index.ts","webpack://@coze-studio/app/../../packages/arch/hooks/src/use-update-effect/index.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/benefit/namespaces/benefit_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/debugger_api/namespaces/infra.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/developer_api/namespaces/plugin_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/developer_api/namespaces/product_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/knowledge/namespaces/slice.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/memory/namespaces/bot_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/memory/namespaces/document.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/memory/namespaces/project_memory.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/plugin_develop/namespaces/card_resource_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/plugin_develop/namespaces/plugin_develop_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/plugin_develop/namespaces/resource_resource_common.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/social_api/namespaces/society.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/workflow_api/namespaces/trace.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/workflow_api/namespaces/wf_openapi.ts","webpack://@coze-studio/app/../../packages/arch/report-tti/src/index.ts","webpack://@coze-studio/app/../../packages/arch/report-tti/src/utils/custom-perf-metric.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/action-bar/context/index.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/action-bar/hooks/use-action-bar-perference.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/action-bar/ui-component.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/actions/insert-input-slot/component.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/core/constant.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/variable-types.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/core/tree-helper/index.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/core/parser/index.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/popover.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/validation/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/validation/validate.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/highlight/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-interpolation-content.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-character-trigger-context.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-empty-content.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-drill-variable-tree.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-filtered-variable-tree.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-focused.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-tree.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-keyboard.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-selection.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-options-operations.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/hooks/use-selected-value.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/popover/shared.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/expression/shared.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/input-slot/action/insert-input-slot-action.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/input-slot/input-config-popover/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/input-slot/input-slot-widget/config-mode-popover.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/input-slot/input-slot-widget/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/input-slot/hooks/use-in-input-slot.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/input-slot/hooks/use-in-jinja-raw.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/types.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/utils/library-validate.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/utils/get-library-status.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/utils/get-library-info.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-search-popover/actions/rename-library-action.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/utils/get-library-tooltip.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-block-widget/library-block-widget-type.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-block-widget/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-search-popover/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-search-popover/actions/add-library-action.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-search-popover/library-item.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-insert/library-search-popover/library-list.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-variable-insert/content-search-popover/library/use-options-operations.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-variable-insert/content-search-popover/library/use-library-list.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-variable-insert/content-search-popover/index.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/library-variable-insert/content-search-popover/variable/use-variables-tree.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/shared/hooks/use-editor-readonly.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/shared/utils/template-parser.ts","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/theme/theme-extension.tsx","webpack://@coze-studio/app/../../packages/common/md-editor-adapter/src/types.ts","webpack://@coze-studio/app/../../packages/common/md-editor-adapter/src/utils.ts","webpack://@coze-studio/app/../../packages/common/md-editor-adapter/src/index.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/context/index.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/prompt-info-input.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/header.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/footer-actions/close-modal.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/footer-actions/save-prompt.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/footer-actions/prompt-diff.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/prompt-configurator-modal.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/use-modal.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/placeholder/import-prompt-when-empty.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/create-prompt/components/insert-input-slot.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/adapter/src/create-prompt/prompt-configurator-modal.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/adapter/src/create-prompt/use-modal.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/syntax-highlight/markdown.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/syntax-highlight/jinja.tsx","webpack://@coze-studio/app/../../packages/common/editor-plugins/src/language-support/index.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/theme/default.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/editor/render.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/editor/context/index.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/shared/hooks/use-editor-readonly.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/base/src/shared/utils/insert-to-newline.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/resource/namespaces/resource_common.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/library-request.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/library-item.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/infinite-list/use-scroll.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/infinite-list/footer.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/infinite-list/empty.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/infinite-list/index.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/library-list.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/footer-actions/copy-prompt.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/footer-actions/insert-to-editor.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/footer-actions/prompt-diff.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/empty.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-library/index.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/recommend-card/index.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/recommend-card/card-loading.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/hooks/use-get-librarys.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/hooks/use-case/use-scroll-control.ts","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/recommend-pannel/empty.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/recommend-pannel/scroll-button.tsx","webpack://@coze-studio/app/../../packages/common/prompt-kit/main/src/prompt-recommend/recommend-pannel/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/type.ts","webpack://@coze-studio/app/../../packages/arch/idl/src/auto-generated/trade/namespaces/common.ts","webpack://@coze-studio/app/../../packages/community/component/src/official-label/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/infinite-list/hooks/use-scroll.ts","webpack://@coze-studio/app/../../packages/community/component/src/infinite-list/components/footer/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/infinite-list/components/empty/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/infinite-list/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/connector-list/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/favorite-icon-btn/hooks/use-farvorite-request.ts","webpack://@coze-studio/app/../../packages/community/component/src/favorite-icon-btn/hooks/use-animation-change.ts","webpack://@coze-studio/app/../../packages/community/component/src/favorite-icon-btn/hooks/use-favorite-change.ts","webpack://@coze-studio/app/../../packages/community/component/src/favorite-icon-btn/components/favorite-icon-mobile/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/favorite-icon-btn/components/favorite-icon/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/favorite-icon-btn/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/sub-menu-item/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/components/tag/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/components/info/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/components/container/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/components/button/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/template/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/card/plugin/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/usage-invoke/format-number.ts","webpack://@coze-studio/app/../../packages/community/component/src/usage-invoke/use-usage-modal.tsx","webpack://@coze-studio/app/../../packages/community/component/src/search-input/config.ts","webpack://@coze-studio/app/../../packages/community/component/src/search-input/search-input-store.ts","webpack://@coze-studio/app/../../packages/community/component/src/search-input/components/recommend-more/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/utils/tea/product/index.ts","webpack://@coze-studio/app/../../packages/community/component/src/avatar-name/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/search-input/hooks/use-item-select.ts","webpack://@coze-studio/app/../../packages/community/component/src/search-input/components/recommend-item/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/search-input/components/recommend-area/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/search-input/components/recommend-popover/index.tsx","webpack://@coze-studio/app/../../packages/community/component/src/search-input/index.tsx","webpack://@coze-studio/app/../../packages/components/mouse-pad-selector/src/mouse-pad-selector.tsx","webpack://@coze-studio/app/../../packages/components/mouse-pad-selector/src/icons/pad.tsx","webpack://@coze-studio/app/../../packages/components/mouse-pad-selector/src/icons/mouse.tsx","webpack://@coze-studio/app/../../packages/components/mouse-pad-selector/src/constants.ts","webpack://@coze-studio/app/../../packages/components/mouse-pad-selector/src/utils.ts","webpack://@coze-studio/app/../../packages/components/mouse-pad-selector/src/with-guiding-popover.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/typings/line.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/entities/render-state-entity.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/entities/custom-render-state.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/utils/node.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/lines-render/utils.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/utils/line.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/utils/ext-info.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/utils/transform-tree.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/constants/id.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/utils/status.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/services/tree-service.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/services/custom-lines-manager.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/constants/node.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/constants/line.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/services/custom-hover-service.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/plugins/custom-line-plugin.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/node-registries.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/collapse/arrow.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/collapse/index.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/contexts/tree-context.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/base-node/constants.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/base-node/tags.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/base-node/icon.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/base-node/index.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/hooks/use-custom-node-render.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/tools/zoom-select.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/tools/minimap-switch.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/tools/minimap.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/tools/interactive.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/tools/index.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/hooks/use-editor-props.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/fixed-layout-editor-provider/preset/fixed-layout-props.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/lines-render/line-svg.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/lines-render/render-line.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/components/lines-render/index.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/layers/flow-lines-layer.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/fixed-layout-editor-provider/preset/flow-registers.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/fixed-layout-editor-provider/preset/container-module.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/fixed-layout-editor-provider/index.tsx","webpack://@coze-studio/app/../../packages/components/resource-tree/src/fixed-layout-editor-provider/preset/fixed-layout-preset.ts","webpack://@coze-studio/app/../../packages/components/resource-tree/src/index.tsx","webpack://@coze-studio/app/../../packages/data/common/feature-register/src/external-store.ts","webpack://@coze-studio/app/../../packages/data/common/feature-register/src/feature-registry-manager.ts","webpack://@coze-studio/app/../../packages/data/common/feature-register/src/index.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/doc-preview/preview-md.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/doc-preview/preview-txt.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/doc-preview/use-preview-pdf/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/segment-menu/utils/level-tree-op.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/segment-menu/segment-tree.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/segment-menu/use-context-menu.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/segment-menu/document-item.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/segment-menu/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/event/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-actions/registry.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/utils/upload.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-actions/upload-image/custom-upload.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-actions/upload-image/base.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-actions/upload-image/button-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-actions/upload-image/menu-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/inner/use-out-editor-mode.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-context-menu/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor/editor.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/hover-edit-bar-actions/add-after-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/hover-edit-bar-actions/add-before-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/hover-edit-bar-actions/delete-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/hover-edit-bar-actions/edit-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/hover-edit-bar-actions/registry.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/hover-edit-bar/hover-edit-bar.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview-context-menu-items/delete-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview-context-menu-items/edit-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview-context-menu-items/registry.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/inner/use-hover-effect.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/components/preview-chunk/document/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview-context-menu/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview/preview.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/inner/use-control-context-menu.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/inner/use-delete-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/chunk-actions/use-add-empty-chunk-action.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/chunk-actions/use-delete-action.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/extensions/image-with-tos-key.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/use-init-editor.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/use-case/is-editor-content-change.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/inner/use-update-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/use-update-remote-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/use-delete-remote-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/use-delete-local-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/inner/use-create-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/use-create-local-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/hooks/use-case/use-save-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/editor-toolbar/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/base/editor-context-actions-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/base/preview-context-menu-items-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/base/hover-edit-bar-actions-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview-context-menu-items/add-before-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/features/preview-context-menu-items/add-after-action.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/base/main.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/preview-context-menu-items-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/hover-edit-bar-actions-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/components/preview-chunk/title/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/components/preview-chunk/image/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/services/locate-segment.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/services/chunk-op.service.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/hooks/use-case/use-scroll-to-selection.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/hooks/inner/use-active-chunk.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/scenes/level/main.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/inner/chunk-op.service.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/inner/document-editor.service.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/inner/get-editor-img-cls.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/inner/get-editor-table-cls.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/inner/get-editor-words-cls.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/use-case/get-editor-content.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/utils/escape-html.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/components/src/text-knowledge-editor/services/use-case/get-render-editor-content.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/hooks/src/use-case/use-tos-content.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/common/hooks/src/use-case/use-knowledge-navigate.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/hooks/src/use-case/use-get-knowledge-list-info.ts","webpack://@coze-studio/app/../../packages/data/knowledge/common/services/src/use-case/get-knowledge-ide-query.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/text-ide/import-knowledge-source-menu-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config/table-local/knowledge-ide-table-config-menu-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config/table-custom/knowledge-ide-table-config-menu-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/table-ide/import-knowledge-source-menu-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/img-ide/import-knowledge-source-menu-contributes.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/service/dataset.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/hooks/use-case/use-get-knowledge-type.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/constant/index.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/service/document.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/constant/polling.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/hooks/use-case/use-reload-knowledge-ide.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/service/slice.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/layout/base/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/utils/preview.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/utils/index.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/utils/document-utils.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/use-case/use-modals.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/use-case/use-document-management.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/use-case/use-init-select-first-doc.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/use-case/use-file-preview.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/life-cycle/use-document-info.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/life-cycle/use-slice-data.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/use-case/use-level-segments.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/hooks/use-case/use-slice-counter.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/doc-tag.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/doc-selector.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/text-toolbar.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/level-content.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/file-preview.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/base-content.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/text-knowledge-workspace/components/main.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/context/knowledge-ide-registry-context/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/knowledge-source-menu/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-source-menu/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-source-button/base/services/use-case/disabled-tooltip.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-source-button/base/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/render-document-icon/suffix.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/render-document-icon/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/photo-filter/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/header-tags/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/related-bots-list/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/Icon-with-suffix/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/knowledge-modal-nav-bar/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/knowledge-nav-bar/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/nav-bar/base/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/knowledge-source-menu-item/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-sources/menu/text-local/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-sources/menu/text-custom/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-sources/menu/table-custom/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-sources/menu/table-local/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-sources/menu/image-local/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-sources/menu/registry.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/text-ide/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/inner/use-get-slice-list-data.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/context/table-ui-context.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/context/table-data-context.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/context/table-actions-context.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/service/use-case/get-table-render-columns-data.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/inner/use-create-slice.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/use-case/use-table-slice-operations.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/use-case/use-table-segment-modal.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/use-case/use-delete-slice-modal.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/use-case/use-add-row.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/inner/use-table-height.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/hooks/inner/use-scroll.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/components/table-data-view.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/table-knowledge-workspace/components/main.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/knowledge-config-menu/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config/base/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config-menus/registry.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config-menus/configuration-table-structure/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config/table-local/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config/table-custom/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/knowledge-ide-table-config/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/table-ide/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/auto-generate-photo-detail-button/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/components/photo-detail-modal/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/image-knowledge-workspace/use-photo-list.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/image-knowledge-workspace/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/img-ide/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/base/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/layout/base/modal/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/nav-bar-action-button/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/import-knowledge-source-button/biz-agent-ide/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/nav-bar/biz-agent-ide/hooks/use-case/use-before-knowledgeide-close.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/nav-bar/biz-agent-ide/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/biz-agent-ide/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/biz-library/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/nav-bar/biz-project/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/biz-project/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-base/src/features/nav-bar/biz-workflow/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/biz-workflow/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-ide-adapter/src/scenes/biz-workflow/modal/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/process-progress-item/process-progress-item.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/table-format/components/table-setting-bar/utils.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/table-format/components/table-setting-bar/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/table-format/components/table-preview/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/table-format/components/table-structure/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-file/utils.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-file/preview-file.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-file/custom-request.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-file/before-upload.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-file/upload-unit-file.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-table/actions/index.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-table/upload-unit-table.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/components/upload-unit-table/utils.tsx","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/constants/common.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/constants/components.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/constants/table.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/constants/text.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/types/process.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/types/text.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/utils/common.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/utils/get-storage-strategy-enabled.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/utils/table.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/utils/text.ts","webpack://@coze-studio/app/../../packages/data/knowledge/knowledge-resource-processor-base/src/utils/validate-common-doc-next-step.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/base-info-modal/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/types/database-field.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/types/database-tabs.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/batch-import-modal/import-steps.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/dismissible-banner/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/singleline-select/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/singleline-input/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/constants/database-field.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/database-field-title/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/database-table-structure/helpers/validate.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/database-table-structure/components/KeyTipsNode/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/database-table-structure/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/components/create-table-modal/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/hooks/use-library-create-database-modal.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/select-database-modal/sider-category.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/select-database-modal/items.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/select-database-modal/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-adapter/src/components/database-mode-select/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-base/src/features/database-detail-waring/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/database-table-structure-readonly/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/utils/is-in-int64-range.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/hooks/use-connector-options.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/row-edit-modal/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/utils/table.ts","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/batch-import-modal/steps/upload.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/batch-import-modal/steps/process.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/batch-import-modal/steps/preview.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/batch-import-modal/steps/config.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/batch-import-modal/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/database-table-data/tool-buttons-bar.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/database-table-data/formatter.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/database-table-data/batch-delete-toolbar.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/database-table-data/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/components/database-detail/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/pages/library/index.tsx","webpack://@coze-studio/app/../../packages/data/memory/database-v2-main/src/pages/database/index.tsx","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/const.ts","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/interface.ts","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/utils/auto-generate-storage.ts","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/components/auto-generate-select/index.tsx","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/utils/index.ts","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/components/mockset-edit-modal/index.tsx","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/components/mockset-delete-modal/index.tsx","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/hooks/store.ts","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/hooks/use-get-mockset.ts","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/components/mock-select/option-item.tsx","webpack://@coze-studio/app/../../packages/devops/mockset-manage/src/components/mock-select/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/plugins/parameters-popover/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/factory/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/mask/SearchNoResultLight.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/mask/SearchNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/mask/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/widget/WidgetNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/widget/WidgetNoResult.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/widget/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/social-scene-flow/SocialSceneFlowNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/social-scene-flow/SocialSceneFlowNoResult.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/social-scene-flow/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/social/SocialNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/social/SocialNoResult.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/social/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/recommend/RecommendNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/recommend/RecommendNoResult.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/recommend/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/common/CommonNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/common/CommonNoResult.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/common/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/bot/BotNoResultDark.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/bot/BotNoResult.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/bot/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/card/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/search-no-result/index.tsx","webpack://@coze-studio/app/../../packages/studio/plugin-shared/src/types/index.ts","webpack://@coze-studio/app/../../packages/studio/plugin-shared/src/constants/index.ts","webpack://@coze-studio/app/../../packages/studio/premium/premium-components-adapter/src/components/premium-paywall/index.tsx","webpack://@coze-studio/app/../../packages/studio/premium/premium-components-adapter/src/components/premium-paywall-banner/index.tsx","webpack://@coze-studio/app/../../packages/studio/premium/premium-components-adapter/src/components/premium-manage/use-premium-manage-modal.tsx","webpack://@coze-studio/app/../../packages/studio/premium/premium-store-adapter/src/types/index.ts","webpack://@coze-studio/app/../../packages/studio/premium/premium-store-adapter/src/stores/premium.ts","webpack://@coze-studio/app/../../packages/studio/premium/premium-store-adapter/src/hooks/use-benefit-basic.ts","webpack://@coze-studio/app/../../packages/studio/premium/premium-store-adapter/src/hooks/use-premium-type.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/store/plugin-history-panel-ui.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/utils/error.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/types/auth.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/store/plugin.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/context.tsx","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/utils/fetch.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/hook/unlock.ts","webpack://@coze-studio/app/../../packages/studio/stores/bot-plugin/src/utils/api.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/base/src/utils/get-enabled-node-types.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/base/src/utils/get-upload-cdn-asset.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/base/src/hooks/use-support-imageflow-nodes-query.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/utils/convert-schema.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/components/theme.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/components/editor/editor.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/components/layout/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/components/editor/biz-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/components/previewer/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/code-editor/src/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/store/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/audio/index.ts","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/voice/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/auth/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/knowledge/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/prompt/index.tsx","webpack://@coze-studio/app/../../packages/workflow/adapter/resources/src/market/use-workflow-publish-entry.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/api/with-query-client.tsx","webpack://@coze-studio/app/../../packages/workflow/base/src/api/index.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/constants/index.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/schema-extractor/constant.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/traverse.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/schema-extractor/utils.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/schema-extractor/parsers/expression-parser.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/schema-extractor/parsers/variable-assign.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/schema-extractor/parsers/input-parameters.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/schema-extractor/parsers/index.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/concat-test-id.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/output-image-parser.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/slardar-reporter.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/form-helpers.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/is-general-workflow.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/start-params.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/utils/get-file-accept.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/hooks/use-node-test-id.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/contexts/workflow-node-context.tsx","webpack://@coze-studio/app/../../packages/workflow/base/src/hooks/use-workflow-node.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/entities/workflow-node.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/services/validation-service.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/store/workflow/index.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/dto.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/view-variable-tree.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/vo.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/node-type.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/llm.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/condition.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/index.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/block-input-dto.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/registry.ts","webpack://@coze-studio/app/../../packages/workflow/base/src/types/view-variable-type.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-open-workflow-detail.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-list.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/constant.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/components/suggestion/type.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/tree-helper/index.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/parser/index.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/components/suggestion/hooks.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/validator/index.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/image-uploader/image-uploader.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/flow-shortcuts-help/constants.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/flow-shortcuts-help/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-commit-list/commit-item.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-commit-list/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-commit-list/use-version-history.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/components/counter/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/components/leaf/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/components/render/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/components/suggestion/state.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor/model/index.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-modal.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/image-uploader/use-image-uploader.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/size-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/text/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/shared.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/shared.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-empty-content.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-keyboard.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/popover.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/index.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/renderer/renderer.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/renderer/hooks.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/renderer/validate.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-interpolation-content.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-pruned-variable-tree.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-filtered-variable-tree.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-tree.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-selected-value.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-options-operations.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-selection.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/expression-editor-next/popover/hooks/use-focused.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/utils.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-publish-action.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-delete-action.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-copy-action.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-chatflow-switch.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-workflow-resource-menu-actions.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-workflow-resource-click.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/use-create-workflow-modal.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/hooks/use-workflow-resource-action/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/voice-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/types/workflow-list.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/utils/utils.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/utils/cronjob-translator.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-edit/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/constants.ts","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/card/lib-button.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/card/parameters/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/card/delete-button/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/card/bot-button/added-button/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/card/bot-button/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/card/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/content/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/filter-douyin/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/filter/sort-type-select.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/filter/index.tsx","webpack://@coze-studio/app/../../packages/workflow/components/src/workflow-modal/hooks/use-i18n-text.ts"],"sourcesContent":["/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useCallback, useEffect, useRef, useState } from 'react';\n\nimport { debounce } from 'lodash-es';\nimport { useRequest } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { SortType, ProductEntityType } from '@coze-arch/bot-api/product_api';\nimport { FeedbackType } from '@coze-arch/bot-api/plugin_develop';\nimport { ProductApi, PluginDevelopApi } from '@coze-arch/bot-api';\nimport {\n  Modal,\n  Form,\n  type FormApi,\n  Button as CozeButton,\n  type SelectProps,\n  type CommonFieldProps,\n  type ButtonProps,\n  Toast,\n  Tooltip,\n  Avatar,\n} from '@coze-arch/coze-design';\n\nconst { Select, TextArea } = Form;\n\ninterface FormType {\n  feedback_type: FeedbackType;\n  plugin_id?: string;\n  feedback: string;\n}\n\nconst options = [\n  {\n    value: FeedbackType.NotFoundPlugin,\n    label: I18n.t(\n      'plugin_feedback_modal_request_type_official_plugins_not_found',\n    ),\n  },\n  {\n    value: FeedbackType.OfficialPlugin,\n    label: I18n.t(\n      'plugin_feedback_modal_request_type_feedback_to_existing_plugin',\n    ),\n  },\n];\n\nconst PluginSelect: FC<SelectProps & CommonFieldProps> = props => {\n  const [inputValue, setInputValue] = useState('');\n\n  const { data, loading } = useRequest(\n    async () => {\n      const res = await ProductApi.PublicGetProductList({\n        keyword: inputValue,\n        page_num: 1,\n        page_size: 50,\n        sort_type: SortType.Heat,\n        entity_type: ProductEntityType.Plugin,\n        is_official: true,\n        need_extra: false,\n      });\n      const products = res?.data?.products;\n\n      return products?.length ? products : [];\n    },\n    {\n      refreshDeps: [inputValue],\n    },\n  );\n\n  const pluginOptions = data\n    ?.filter(p => p.meta_info)\n    .map(plugin => {\n      const meta = plugin.meta_info;\n      return {\n        value: meta.entity_id,\n        label: (\n          <>\n            {meta.icon_url ? (\n              <Avatar\n                size=\"extra-extra-small\"\n                src={meta.icon_url}\n                shape=\"square\"\n                className=\"mr-[5px]\"\n              />\n            ) : null}\n            {meta.name}\n          </>\n        ),\n      };\n    });\n\n  return (\n    <Select\n      onSearch={debounce((val, event) => {\n        if (event.type === 'change') {\n          setInputValue(val);\n        }\n      }, 800)}\n      loading={loading}\n      optionList={pluginOptions}\n      filter\n      remote\n      {...props}\n    />\n  );\n};\n\nexport const usePluginFeatModal = () => {\n  const [visible, setVisible] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const formApi = useRef<FormApi<FormType>>();\n\n  const onSubmit = async () => {\n    try {\n      setSubmitting(true);\n      const vals = await formApi.current?.validate();\n\n      const res = await PluginDevelopApi.CreatePluginFeedback(vals);\n\n      if (res?.code !== 0) {\n        return;\n      }\n\n      Toast.success(I18n.t('plugin_feedback_modal_tip_submission_success'));\n      setVisible(false);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const reset = () => {\n    formApi.current?.setValues({\n      feedback_type: FeedbackType.NotFoundPlugin,\n      plugin_id: undefined,\n      feedback: '',\n    });\n  };\n\n  useEffect(() => {\n    if (!visible) {\n      return;\n    }\n\n    reset();\n  }, [visible]);\n\n  const modal = (\n    <Modal\n      title={I18n.t('plugin_feedback_modal_title')}\n      visible={visible}\n      onCancel={() => setVisible(false)}\n      width={562}\n      footer={\n        <>\n          <CozeButton\n            color=\"secondary\"\n            onClick={() => setVisible(false)}\n            className=\"mr-[12px]\"\n          >\n            {I18n.t('coze_home_delete_modal_btn_cancel')}\n          </CozeButton>\n          <CozeButton onClick={onSubmit} loading={submitting}>\n            {I18n.t('feedback_submit')}\n          </CozeButton>\n        </>\n      }\n    >\n      <Form<FormType>\n        getFormApi={api => (formApi.current = api)}\n        render={({ formState, values }) => (\n          <>\n            <Select\n              field=\"feedback_type\"\n              rules={[\n                {\n                  required: true,\n                },\n              ]}\n              label={I18n.t('plugin_feedback_modal_request_type')}\n              optionList={options}\n              className=\"w-full\"\n            />\n            {values?.feedback_type === FeedbackType.OfficialPlugin && (\n              <PluginSelect\n                field=\"plugin_id\"\n                rules={[\n                  {\n                    required: true,\n                    message: I18n.t(\n                      'plugin_feedback_error_tip_no_official_plugin_choosen',\n                    ),\n                  },\n                ]}\n                label={I18n.t('plugin_feedback_modal_choose_official_plugin')}\n                className=\"w-full\"\n              />\n            )}\n            <TextArea\n              field=\"feedback\"\n              rules={[\n                {\n                  required: true,\n                  message: I18n.t('plugin_feedback_error_tip_empty_content'),\n                },\n              ]}\n              label={I18n.t('plugin_feedback_modal_feedback_content')}\n              placeholder={I18n.t(\n                'plugin_feedback_modal_feedback_content_placeholder',\n              )}\n              maxCount={2000}\n              maxLength={2000}\n            />\n          </>\n        )}\n      />\n    </Modal>\n  );\n  const open = () => setVisible(true);\n\n  const EntryButton = useCallback<FC<ButtonProps>>(\n    props => (\n      <Tooltip content={I18n.t('plugin_feedback_entry_tip')}>\n        <CozeButton onClick={open} size=\"large\" color=\"primary\" {...props}>\n          {I18n.t('plugin_feedback_entry_button')}\n        </CozeButton>\n      </Tooltip>\n    ),\n    [],\n  );\n\n  return {\n    open,\n    EntryButton,\n    modal,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport classNames from 'classnames';\nimport { useBotSkillStore } from '@coze-studio/bot-detail-store/bot-skill';\nimport { I18n } from '@coze-arch/i18n';\nimport { UICompositionModal, type Modal } from '@coze-arch/bot-semi';\nimport { OpenModeType } from '@coze-arch/bot-hooks';\nimport { type PluginModalModeProps } from '@coze-agent-ide/plugin-shared';\nimport { PluginFeatButton } from '@coze-agent-ide/bot-plugin-export/pluginFeatModal/featButton';\nimport { usePluginModalParts } from '@coze-agent-ide/bot-plugin-export/agentSkillPluginModal/hooks';\n\nimport s from './index.module.less';\n\nexport type PluginModalProps = ComponentProps<typeof Modal> &\n  PluginModalModeProps & {\n    type: number;\n  };\n\nexport const PluginModal: React.FC<PluginModalProps> = ({\n  type,\n  openMode,\n  from,\n  openModeCallback,\n  showButton,\n  showCopyPlugin,\n  onCopyPluginCallback,\n  pluginApiList,\n  projectId,\n  clickProjectPluginCallback,\n  hideCreateBtn,\n  initQuery,\n  ...props\n}) => {\n  const { pluginApis, updateSkillPluginApis } = useBotSkillStore(\n    useShallow(store => ({\n      pluginApis: store.pluginApis,\n      updateSkillPluginApis: store.updateSkillPluginApis,\n    })),\n  );\n  const getPluginApiList = () => {\n    if (pluginApiList) {\n      return pluginApiList;\n    }\n    return openMode === OpenModeType.OnlyOnceAdd ? [] : pluginApis;\n  };\n  const { sider, filter, content } = usePluginModalParts({\n    // If it is added only once, clear the default selection.\n    pluginApiList: getPluginApiList(),\n    onPluginApiListChange: updateSkillPluginApis,\n    openMode,\n    from,\n    openModeCallback,\n    showButton,\n    showCopyPlugin,\n    onCopyPluginCallback,\n    projectId,\n    clickProjectPluginCallback,\n    onCreateSuccess: props?.onCreateSuccess,\n    isShowStorePlugin: props?.isShowStorePlugin,\n    hideCreateBtn,\n    initQuery,\n  });\n\n  return (\n    <UICompositionModal\n      data-testid=\"plugin-modal\"\n      {...props}\n      header={I18n.t('bot_edit_plugin_select_title')}\n      className={classNames(s['plugin-modal'], props.className)}\n      sider={sider}\n      extra={!IS_OPEN_SOURCE ? <PluginFeatButton /> : null}\n      filter={filter}\n      content={content}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { isNumber } from 'lodash-es';\nimport {\n  type PluginModalModeProps,\n  type PluginQuery,\n} from '@coze-agent-ide/plugin-shared';\n\nimport { PluginModal } from './plugin-modal';\n\nexport const usePluginApisModal = (props?: PluginModalModeProps) => {\n  const { closeCallback, ...restProps } = props || {};\n  const [visible, setVisible] = useState(false);\n  const [type, setType] = useState(1);\n  const [initQuery, setInitQuery] = useState<Partial<PluginQuery>>();\n  const open = (\n    params?: number | { openType?: number; initQuery?: Partial<PluginQuery> },\n  ) => {\n    const openType = isNumber(params) ? params : params?.openType;\n    const _initQuery = isNumber(params) ? undefined : params?.initQuery;\n    setVisible(true);\n    setInitQuery(_initQuery);\n    // 0 is also valid\n    if (isNumber(openType)) {\n      setType(openType);\n    }\n  };\n  const close = () => {\n    setVisible(false);\n    setInitQuery(undefined);\n    closeCallback?.();\n  };\n  const node = visible ? (\n    <PluginModal\n      type={type}\n      visible={visible}\n      onCancel={() => {\n        setVisible(false);\n        closeCallback?.();\n      }}\n      initQuery={initQuery}\n      footer={null}\n      {...restProps}\n    />\n  ) : null;\n  return {\n    node,\n    open,\n    close,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport classNames from 'classnames';\nimport { useRequest } from 'ahooks';\nimport { explore } from '@coze-studio/api-schema';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDesktopFill, IconCozCoze } from '@coze-arch/coze-design/icons';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { UICompositionModalSider } from '@coze-arch/bot-semi';\nimport { IconMyTools, IconTeamTools } from '@coze-arch/bot-icons';\nimport { type Int64, SpaceType } from '@coze-arch/bot-api/developer_api';\nimport {\n  PluginFilterType,\n  From,\n  getDefaultPluginCategory,\n} from '@coze-agent-ide/plugin-shared';\n\nimport s from './plugin-filter.module.less';\n\nexport interface PluginFilterProps {\n  isSearching: boolean;\n  type: Int64;\n  onChange: (type: Int64) => void;\n  projectId?: string;\n  from?: From;\n  isShowStorePlugin?: boolean;\n}\n\nexport const PluginFilter: React.FC<PluginFilterProps> = ({\n  isSearching,\n  type,\n  onChange,\n  projectId,\n  from,\n  isShowStorePlugin = true,\n}) => {\n  const spaceType = useSpaceStore(store => store.space.space_type);\n  const defaultId = getDefaultPluginCategory().id;\n\n  const { data: enableSaaSPlugin } = useRequest(async () => {\n    const res = await explore.PublicGetMarketPluginConfig({});\n    return res.data?.enable_saas_plugin || false;\n  });\n\n  const onChangeAfterDiff = (freshType: typeof type) => {\n    // If you are searching, leave the search blank\n    if (isSearching) {\n      onChange(freshType);\n      return;\n    }\n    if (freshType === type) {\n      return;\n    }\n    onChange(freshType);\n  };\n\n  return (\n    <div className={s['tool-tag-list']}>\n      {spaceType === SpaceType.Personal && (\n        <div\n          data-testid=\"plugin.modal.filter.option.mine\"\n          className={classNames(s['tool-tag-list-cell'], {\n            [s.active]: type === PluginFilterType.Mine,\n          })}\n          onClick={() => onChangeAfterDiff(PluginFilterType.Mine)}\n        >\n          <IconMyTools className={s['tool-tag-list-cell-icon']} />\n          {I18n.t('add_resource_modal_sidebar_library_tools')}\n        </div>\n      )}\n\n      {projectId && from === From.ProjectWorkflow ? (\n        <div\n          className={classNames(s['tool-tag-list-cell'], {\n            [s.active]: type === PluginFilterType.Project,\n          })}\n          onClick={() => onChangeAfterDiff(PluginFilterType.Project)}\n        >\n          <IconTeamTools className={s['tool-tag-list-cell-icon']} />\n          {I18n.t('add_resource_modal_sidebar_project_tools')}\n        </div>\n      ) : null}\n\n      {isShowStorePlugin ? (\n        <>\n          <UICompositionModalSider.Divider />\n\n          <div className={s['tool-content-area']}>\n            <div\n              className={classNames(s['tool-tag-list-cell'], {\n                [s.active]: type === defaultId,\n              })}\n              onClick={() => onChangeAfterDiff(defaultId)}\n            >\n              <IconCozDesktopFill className={s['tool-tag-list-cell-icon']} />\n              {I18n.t('explore_tools')}\n            </div>\n          </div>\n\n          {enableSaaSPlugin ? (\n            <div className={s['tool-content-area']}>\n              <div\n                className={classNames(s['tool-tag-list-cell'], {\n                  [s.active]: type === PluginFilterType.Coze,\n                })}\n                onClick={() => onChangeAfterDiff(PluginFilterType.Coze)}\n              >\n                <IconCozCoze className={s['tool-tag-list-cell-icon']} />\n                Coze.cn \n              </div>\n            </div>\n          ) : null}\n        </>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { UISelect, Select } from '@coze-arch/bot-semi';\nimport { OrderBy } from '@coze-arch/bot-api/developer_api';\nimport { PluginFilterType } from '@coze-agent-ide/plugin-shared';\nimport { type From, type PluginQuery } from '@coze-agent-ide/plugin-shared';\n\nimport s from './index.module.less';\n\nexport interface PluginModalFilterProp {\n  query: PluginQuery;\n  setQuery: (value: Partial<PluginQuery>, refreshPage?: boolean) => void;\n  from?: From;\n}\n\nconst timeOptions = [\n  {\n    label: I18n.t('Create_time'),\n    value: OrderBy.CreateTime,\n  },\n  {\n    label: I18n.t('Update_time'),\n    value: OrderBy.UpdateTime,\n  },\n];\n\nexport const PluginModalFilter: FC<PluginModalFilterProp> = ({\n  query,\n  setQuery,\n}) => {\n  /**\n   * Space Plugin: Create and Edit Time Sorting\n   * Public plugins: popularity, release time ranking\n   * */\n  const getFilterItem = () => {\n    if (\n      query.type === PluginFilterType.Mine ||\n      query.type === PluginFilterType.Team ||\n      query.type === PluginFilterType.Project\n    ) {\n      return (\n        <UISelect\n          label={I18n.t('Sort')}\n          value={query.orderBy}\n          optionList={timeOptions}\n          onChange={v => {\n            setQuery({\n              orderBy: v as OrderBy,\n            });\n          }}\n        >\n          <Select.Option value={OrderBy.CreateTime}>\n            {I18n.t('Create_time')}\n          </Select.Option>\n          <Select.Option value={OrderBy.UpdateTime}>\n            {I18n.t('Edit_time_2')}\n          </Select.Option>\n        </UISelect>\n      );\n    }\n\n    return null;\n  };\n\n  return <div className={s['plugin-modal-filter']}>{getFilterItem()}</div>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type FC } from 'react';\n\nimport { useDebounceFn } from 'ahooks';\nimport { UISearch } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { UIButton, UICompositionModalSider } from '@coze-arch/bot-semi';\nimport { From, type PluginQuery } from '@coze-agent-ide/plugin-shared';\nimport { PluginFilter } from '@coze-agent-ide/plugin-modal-adapter';\n\nimport { CreateFormPluginModal } from '../../bot_edit';\n\nimport s from './index.module.less';\n\nexport interface PluginModalSiderProp {\n  query: PluginQuery;\n  setQuery: (value: Partial<PluginQuery>, refreshPage?: boolean) => void;\n  from?: From;\n  onCreateSuccess?: (val?: { spaceId?: string; pluginId?: string }) => void;\n  isShowStorePlugin?: boolean;\n  hideCreateBtn?: boolean;\n}\nconst MAX_SEARCH_LENGTH = 100;\n\nexport const PluginModalSider: FC<PluginModalSiderProp> = ({\n  query,\n  setQuery,\n  from,\n  onCreateSuccess,\n  isShowStorePlugin,\n  hideCreateBtn,\n}) => {\n  const [showFormPluginModel, setShowFormPluginModel] = useState(false);\n  const id = useSpaceStore(item => item.space.id);\n  const updateSearchQuery = (search?: string) => {\n    setQuery({\n      search: search ?? '',\n    });\n  };\n  const { run: debounceChangeSearch, cancel } = useDebounceFn(\n    (search: string) => {\n      updateSearchQuery(search);\n    },\n    { wait: 300 },\n  );\n  return (\n    <>\n      {hideCreateBtn ? null : (\n        <CreateFormPluginModal\n          projectId={query.projectId}\n          isCreate={true}\n          visible={showFormPluginModel}\n          onSuccess={pluginID => {\n            onCreateSuccess?.({\n              spaceId: id,\n              pluginId: pluginID,\n            });\n          }}\n          onCancel={() => {\n            setShowFormPluginModel(false);\n          }}\n        />\n      )}\n      <UICompositionModalSider style={{ paddingTop: 16 }}>\n        <UICompositionModalSider.Header>\n          <UISearch\n            tabIndex={-1}\n            value={query.search}\n            maxLength={MAX_SEARCH_LENGTH}\n            onSearch={search => {\n              if (!search) {\n                // If the search is empty, update the query immediately\n                cancel();\n                updateSearchQuery(search);\n              } else {\n                // If search has a value, then anti-shake update\n                debounceChangeSearch(search);\n              }\n            }}\n            placeholder={I18n.t('Search')}\n            data-testid=\"plugin.modal.search\"\n          />\n          {hideCreateBtn ? null : (\n            <UIButton\n              data-testid=\"plugin.modal.create.plugin\"\n              className={s.addbtn}\n              theme=\"solid\"\n              onClick={() => {\n                // TODO: Other scenes should also be created in a unified way. If the creation success callback exists, open the plugin modal, otherwise open a new tab.\n                if (\n                  onCreateSuccess &&\n                  (from === From.ProjectIde || from === From.ProjectWorkflow)\n                ) {\n                  setShowFormPluginModel(true);\n                  return;\n                }\n                window.open(`/space/${id}/library?type=1`);\n              }}\n            >\n              {I18n.t('plugin_create')}\n            </UIButton>\n          )}\n        </UICompositionModalSider.Header>\n        <UICompositionModalSider.Content>\n          <PluginFilter\n            isSearching={query.search !== ''}\n            type={query.type}\n            onChange={type => {\n              setQuery({ type });\n            }}\n            from={from}\n            projectId={query.projectId}\n            isShowStorePlugin={isShowStorePlugin}\n          />\n        </UICompositionModalSider.Content>\n      </UICompositionModalSider>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport { type FC, useRef, useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { sortBy } from 'lodash-es';\nimport classNames from 'classnames';\nimport { useUpdateEffect } from 'ahooks';\nimport { IconChevronDown, IconChevronRight } from '@douyinfe/semi-icons';\nimport { useWorkflowStore } from '@coze-workflow/base/store';\nimport { InfiniteList, type InfiniteListRef } from '@coze-community/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { UICompositionModalMain, Collapse } from '@coze-arch/bot-semi';\nimport {\n  type PluginApi,\n  type PluginInfoForPlayground,\n} from '@coze-arch/bot-api/plugin_develop';\nimport {\n  fetchPlugin,\n  formatCacheKey,\n  type PluginContentListItem,\n  type PluginQuery,\n  type PluginModalModeProps,\n} from '@coze-agent-ide/plugin-shared';\nimport { PluginPanel } from '@coze-agent-ide/plugin-modal-adapter';\n\nimport { useInfiniteScrollCacheLoad } from '../use-request-cache';\n\nimport s from './index.module.less';\n\nexport interface PluginModalContentProps extends PluginModalModeProps {\n  query: PluginQuery;\n  pluginApiList: PluginApi[];\n  onPluginApiListChange: (list: PluginApi[]) => void;\n  setQuery: (value: Partial<PluginQuery>, refreshPage?: boolean) => void;\n}\nexport type PluginModalContentListItem = PluginInfoForPlayground & {\n  // The current data belongs to the page of the list\n  belong_page?: number;\n};\n\n// @ts-expect-error -- linter-disable-autofix\n// eslint-disable-next-line max-params\nconst getEmptyConf = (spaceId, isMine, isTeam, isProject) => {\n  if ((isMine || isTeam) && !isProject) {\n    return {\n      text: {\n        emptyTitle: I18n.t('plugin_empty_desc'),\n        emptyDesc: I18n.t('plugin_empty_description'),\n      },\n      btn: {\n        emptyClick: () => {\n          window.open(`/space/${spaceId}/library?type=1`);\n        },\n        emptyText: I18n.t('plugin_create'),\n      },\n    };\n  }\n  return {\n    text: {\n      emptyTitle: I18n.t('plugin_empty_desc'),\n      emptyDesc: '',\n    },\n    btn: {\n      emptyClick: () => {\n        window.open('/store/plugin');\n      },\n      emptyText: I18n.t('mkl_plugin_to_plugin_gallery'),\n    },\n  };\n};\n\n/* eslint-disable @coze-arch/max-line-per-function */\nexport const PluginModalContent: FC<PluginModalContentProps> = ({\n  query,\n  pluginApiList,\n  onPluginApiListChange,\n  openMode,\n  from,\n  openModeCallback,\n  showButton,\n  showCopyPlugin,\n  onCopyPluginCallback,\n  clickProjectPluginCallback,\n}) => {\n  // Status hook\n  const {\n    type,\n    mineActive,\n    search,\n    isOfficial,\n    orderBy,\n    orderByPublic,\n    orderByFavorite,\n    agentId,\n    pluginType,\n  } = query;\n  const id = useSpaceStore(store => store.space.id);\n  // Scroll container\n  const scrollContainerRef = useRef<HTMLDivElement | null>(null);\n  // Currently active key\n  const [activeKey, setActivekey] = useState<string | string[] | undefined>([]);\n  const refInfiniteScroll = useRef<InfiniteListRef>(null);\n  const {\n    scroll2Top,\n    loadData,\n    isSearching,\n    isFavorite,\n    isTemplate,\n    isProject,\n    isMine,\n    isTeam,\n  } = useInfiniteScrollCacheLoad<PluginContentListItem, PluginQuery>({\n    query,\n    formatCacheKey,\n    scrollContainer: scrollContainerRef,\n    triggerService: fetchPlugin,\n    onSetScrollData: scrollData => {\n      refInfiniteScroll.current?.mutate(scrollData);\n    },\n  });\n  const { nodes: workflowNodes } = useWorkflowStore(\n    useShallow(state => ({\n      nodes: state.nodes,\n    })),\n  );\n  // The first effect is not executed, this is the effect of switching the state\n  useUpdateEffect(() => {\n    scroll2Top(); // When the filter item changes, return to the top\n    // Perform this effect whenever a non-page change is made in the query\n  }, []);\n  return (\n    <UICompositionModalMain>\n      <div className={s['plugin-content']} ref={scrollContainerRef}>\n        <UICompositionModalMain.Content\n          style={{ minHeight: '100%', display: 'flex' }}\n        >\n          <Collapse\n            className={s['plugin-collapse']}\n            activeKey={activeKey}\n            onChange={value => {\n              setActivekey(value);\n            }}\n            expandIcon={\n              <IconChevronRight\n                className={s['collapse-icon']}\n                data-testid=\"plugin-collapse-panel-expand\"\n              />\n            }\n            collapseIcon={\n              <IconChevronDown\n                className={s['collapse-icon']}\n                data-testid=\"plugin-collapse-panel-collapse\"\n              />\n            }\n          >\n            <InfiniteList<PluginContentListItem>\n              ref={refInfiniteScroll}\n              itemClassName={s['item-container']}\n              renderItem={(item, index) => {\n                const pluginId = item?.pluginInfo?.id;\n                return (\n                  <PluginPanel\n                    agentId={agentId}\n                    index={index}\n                    pluginApiList={pluginApiList}\n                    onPluginApiListChange={onPluginApiListChange}\n                    onCopyPluginCallback={onCopyPluginCallback}\n                    showButton={showButton}\n                    showCopyPlugin={showCopyPlugin}\n                    openMode={openMode}\n                    from={from}\n                    workflowNodes={workflowNodes}\n                    openModeCallback={openModeCallback}\n                    highlightWords={[search]}\n                    showCreator={true}\n                    showMarketLink={isFavorite || isTemplate}\n                    showCreateTime={orderBy === 0 || typeof type === 'number'}\n                    showPublishTime={!isMine && !isTeam && !isProject}\n                    activeKey={activeKey}\n                    scrollContainerRef={scrollContainerRef}\n                    isFromMarket={item?.isFromMarket}\n                    info={{\n                      ...item?.pluginInfo,\n                      id: pluginId,\n                      listed_at: item?.productInfo?.listed_at,\n                      plugin_apis: sortBy(\n                        item?.pluginInfo?.plugin_apis,\n                        p => p.name,\n                      ),\n                    }}\n                    productInfo={item?.productInfo}\n                    commercialSetting={item?.commercial_setting}\n                    key={pluginId}\n                    type={String(type || '')}\n                    className={classNames(s['plugin-collapse'], {\n                      [s.activePanel]: activeKey?.includes(pluginId ?? ''),\n                    })}\n                    showProjectPluginLink={isProject}\n                    clickProjectPluginCallback={clickProjectPluginCallback}\n                  />\n                );\n              }}\n              emptyConf={getEmptyConf(id, isMine, isTeam, isProject)}\n              scrollConf={{\n                reloadDeps: [\n                  type,\n                  mineActive,\n                  search,\n                  isOfficial,\n                  orderBy,\n                  orderByPublic,\n                  orderByFavorite,\n                  pluginType,\n                ],\n                targetRef: scrollContainerRef,\n                loadData,\n              }}\n              isSearching={isSearching}\n            />\n          </Collapse>\n        </UICompositionModalMain.Content>\n      </div>\n    </UICompositionModalMain>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MutableRefObject, useEffect } from 'react';\n\nimport { type InfiniteListDataProps } from '@coze-community/components';\nimport { setCache, getCache, clearCache } from '@coze-arch/bot-utils';\nimport {\n  DEFAULT_PAGE_SIZE,\n  MineActiveEnum,\n  PluginFilterType,\n  type CommonQuery,\n  type ListItemCommon,\n  type RequestServiceResp,\n} from '@coze-agent-ide/plugin-shared';\n\ninterface Data {\n  list: object[];\n  total: number;\n  hasMore?: boolean;\n}\nexport interface InfiniteScrollViewportOptions<\n  ListItem extends ListItemCommon,\n  Query extends CommonQuery,\n> {\n  scrollContainer: MutableRefObject<HTMLDivElement | null>;\n  query: Query;\n  triggerService: (\n    query: Query,\n    commonParam: {\n      nextPage: number;\n      isMine: boolean;\n      isTeam: boolean;\n      isCreatorMine: boolean;\n      isTemplate: boolean;\n      isFavorite: boolean;\n      isProject: boolean;\n      isCoze: boolean;\n    },\n  ) => Promise<RequestServiceResp<ListItem> | undefined>;\n  // @ts-expect-error -- linter-disable-autofix\n  onSetScrollData: (scrollData) => void;\n  formatCacheKey: (query: {\n    query: Query;\n    isSearching: boolean;\n    isTemplate: boolean;\n    page: number;\n  }) => string | undefined;\n}\n\nconst DEFAULT_CACHE_TIME = 300000;\n\nexport function useInfiniteScrollCacheLoad<\n  ListItem extends ListItemCommon,\n  Query extends CommonQuery,\n>({\n  scrollContainer,\n  query,\n  triggerService,\n  formatCacheKey,\n  onSetScrollData,\n}: InfiniteScrollViewportOptions<ListItem, Query>) {\n  const { search, type, mineActive } = query;\n  const isSearching = search !== '';\n  // my tools\n  const isMine = type === PluginFilterType.Mine;\n  // team tools\n  const isTeam = type === PluginFilterType.Team;\n  const isFavorite = type === PluginFilterType.Favorite;\n  const isProject = type === PluginFilterType.Project;\n  const isCoze = type === PluginFilterType.Coze;\n\n  // team tools -> my creator\n  const isCreatorMine = mineActive === MineActiveEnum.Mine;\n  const isTemplate = Number(type) >= 0 || type === 'recommend';\n\n  const scroll2Top = () => {\n    if (scrollContainer.current) {\n      scrollContainer.current.scrollTo({\n        top: 0,\n      });\n    }\n  };\n\n  const onBeforeLoadData = (\n    // @ts-expect-error -- linter-disable-autofix\n    current,\n    cachedKey: string,\n    isImmediateUpdate: boolean,\n  ) => {\n    const res = getCache(cachedKey);\n    if (!cachedKey || !res) {\n      return false;\n    }\n    const { data } = res;\n    if (!isImmediateUpdate) {\n      return res.data;\n    }\n\n    const currentPage = current?.nextPage || 1;\n    const { list, total } = (data as Data) || { list: [], total: 0 };\n    const hasMore = total > 0 && currentPage * DEFAULT_PAGE_SIZE < total;\n    onSetScrollData({\n      ...current,\n      hasMore,\n      list: [...(currentPage?.list || []), ...list],\n    });\n    return false;\n  };\n\n  const setCacheData = <TData,>(\n    cachedKey: string,\n    cacheTime: number,\n    res: TData,\n  ) => {\n    if (!cachedKey) {\n      return;\n    }\n    setCache(cachedKey, cacheTime, {\n      time: Date.now(),\n      data: res,\n    });\n  };\n\n  const loadData = async (current: InfiniteListDataProps<ListItem>) => {\n    const currentPage = current?.nextPage || 1;\n    let cachedKey =\n      formatCacheKey({ query, isSearching, isTemplate, page: currentPage }) ||\n      '';\n    if (!isMine && !isTeam) {\n      cachedKey = '';\n    }\n    let res = onBeforeLoadData(current, cachedKey, !isTemplate);\n\n    if (!res) {\n      res = await triggerService(query, {\n        nextPage: currentPage,\n        isMine,\n        isTeam,\n        isCreatorMine,\n        isTemplate,\n        isFavorite,\n        isProject,\n        isCoze,\n      });\n      setCacheData(cachedKey, DEFAULT_CACHE_TIME, res);\n    }\n\n    const { list, hasMore } = (res as InfiniteListDataProps<ListItem>) || {\n      list: [],\n      total: 0,\n    };\n    const nextPage = currentPage + 1;\n    const refIdList = {};\n    (current?.list || []).map(item => {\n      // @ts-expect-error -- linter-disable-autofix\n      refIdList[\n        (item as unknown as { pluginInfo: { id: string } })?.pluginInfo?.id\n      ] = true;\n    });\n\n    //Data deduplicated\n    const uniqList = (list || []).filter(item => {\n      const pluginId = (item as unknown as { pluginInfo: { id: string } })\n        ?.pluginInfo?.id;\n      if (pluginId) {\n        // @ts-expect-error -- linter-disable-autofix\n        if (refIdList[pluginId]) {\n          return false;\n        }\n      }\n      return true;\n    });\n\n    return {\n      list: uniqList || [],\n      hasMore,\n      nextPage,\n    };\n  };\n\n  useEffect(() => {\n    clearCache();\n  }, []);\n  return {\n    scroll2Top,\n    isSearching,\n    loadData,\n    isFavorite,\n    isTemplate,\n    isMine,\n    isTeam,\n    isProject,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { useCollaborationStore } from '@coze-studio/bot-detail-store/collaboration';\nimport { useBotInfoStore } from '@coze-studio/bot-detail-store/bot-info';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport {\n  PluginType,\n  ProductEntityType,\n  SortType,\n} from '@coze-arch/bot-api/product_api';\nimport {\n  OrderBy,\n  SpaceType,\n  type PluginApi,\n} from '@coze-arch/bot-api/developer_api';\nimport {\n  DEFAULT_PAGE,\n  MineActiveEnum,\n  PluginFilterType,\n  type PluginQuery,\n  type PluginModalModeProps,\n  From,\n} from '@coze-agent-ide/plugin-shared';\nimport { PluginModalFilter } from '@coze-agent-ide/plugin-modal-adapter';\n\nimport { PluginModalSider } from './sider';\nimport { PluginModalContent } from './content';\n\nexport interface UsePluginModalPartsProp extends PluginModalModeProps {\n  pluginApiList: PluginApi[];\n  onPluginApiListChange: (list: PluginApi[]) => void;\n  agentId?: string;\n  projectId?: string;\n  isShowStorePlugin?: boolean;\n}\n\n/**\n * Get initialization type\n * @Param from source\n * @param spaceType\n * @Returns initialization type\n */\nconst getInitType = (from?: From, spaceType?: SpaceType) => {\n  // Project workflow reference plug-in, the project plug-in is selected by default\n  if (from === From.ProjectWorkflow) {\n    return '';\n  }\n  if (from !== From.ProjectIde || !spaceType || !from) {\n    return '';\n  }\n  // Under projectIDE, and it is personal space, select Mine.\n  if (spaceType === SpaceType.Personal) {\n    return PluginFilterType.Mine;\n  }\n  // Under projectIDE, and is a team space, select Team\n  if (spaceType === SpaceType.Team && from === From.ProjectIde) {\n    return PluginFilterType.Team;\n  }\n  return '';\n};\n\nexport const usePluginModalParts = ({\n  pluginApiList,\n  onPluginApiListChange,\n  agentId,\n  openMode,\n  from,\n  openModeCallback,\n  showButton,\n  showCopyPlugin,\n  onCopyPluginCallback,\n  projectId,\n  clickProjectPluginCallback,\n  onCreateSuccess,\n  isShowStorePlugin,\n  hideCreateBtn,\n  initQuery,\n}: UsePluginModalPartsProp) => {\n  // Get devId\n  const userInfo = userStoreService.useUserInfo();\n  const spaceType = useSpaceStore(store => store.space.space_type);\n  const [query, setQuery] = useState<PluginQuery>({\n    agentId,\n    projectId,\n    devId: userInfo?.user_id_str || '',\n    search: '',\n    page: DEFAULT_PAGE,\n    // Project IDE plugins only show my plugins\n    type: initQuery?.type ?? getInitType(from, spaceType),\n    orderBy: OrderBy.CreateTime,\n    orderByPublic: SortType.Heat,\n    orderByFavorite: SortType.Newest,\n    mineActive: MineActiveEnum.All,\n    isOfficial: initQuery?.isOfficial ?? undefined,\n    // Add plugins to project workflow, only show cloud plugins\n    pluginType:\n      from === From.ProjectWorkflow ? PluginType.CLoudPlugin : undefined,\n  });\n  const { botId } = useBotInfoStore(\n    useShallow(state => ({\n      botId: state.botId,\n    })),\n  );\n  const { version } = useCollaborationStore(\n    useShallow(state => ({\n      version: state.baseVersion,\n    })),\n  );\n  const updateQuery = (value: Partial<PluginQuery>, refreshPage = true) => {\n    const botInfo = {\n      current_entity_type: ProductEntityType.Bot,\n      current_entity_id: botId,\n      current_entity_version: version,\n    };\n    setQuery(prev => {\n      if (refreshPage) {\n        return {\n          ...prev,\n          ...value,\n          page: DEFAULT_PAGE,\n          botInfo,\n        };\n      }\n      return {\n        ...prev,\n        ...value,\n        botInfo,\n      };\n    });\n  };\n\n  const sider = (\n    <PluginModalSider\n      hideCreateBtn={hideCreateBtn}\n      query={query}\n      setQuery={updateQuery}\n      from={from}\n      onCreateSuccess={onCreateSuccess}\n      isShowStorePlugin={isShowStorePlugin}\n    />\n  );\n  const filter = (\n    <PluginModalFilter from={from} query={query} setQuery={updateQuery} />\n  );\n  const content = (\n    <PluginModalContent\n      query={query}\n      setQuery={updateQuery}\n      pluginApiList={pluginApiList}\n      onPluginApiListChange={onPluginApiListChange}\n      openMode={openMode}\n      from={from}\n      openModeCallback={openModeCallback}\n      showButton={showButton}\n      showCopyPlugin={showCopyPlugin}\n      onCopyPluginCallback={onCopyPluginCallback}\n      clickProjectPluginCallback={clickProjectPluginCallback}\n    />\n  );\n\n  return {\n    sider,\n    content,\n    filter,\n  } as const;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { type PluginInfoProps } from '@coze-studio/plugin-shared';\nimport { type UploadValue } from '@coze-common/biz-components';\nimport { I18n } from '@coze-arch/i18n';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport {\n  type commonParamSchema,\n  type CreationMethod,\n  ParameterLocation,\n  type PluginType,\n  type PluginMetaInfo,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\n\nimport { type FormState } from './hooks';\n\nexport const formRuleList = {\n  name: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_name1_error'),\n    },\n    IS_OVERSEA || IS_BOE\n      ? {\n          pattern: /^[\\w\\s]+$/,\n          message: I18n.t('create_plugin_modal_nameerror'),\n        }\n      : {\n          pattern: /^[\\w\\s\\u4e00-\\u9fa5]+$/u, // Increased domestic support for Chinese\n          message: I18n.t('create_plugin_modal_nameerror_cn'),\n        },\n  ],\n  desc: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_descrip1_error'),\n    },\n    // Only cn online supports Chinese.\n    IS_OVERSEA || IS_BOE\n      ? {\n          // eslint-disable-next-line no-control-regex -- regex\n          pattern: /^[\\x00-\\x7F]+$/,\n          message: I18n.t('create_plugin_modal_descrip_error'),\n        }\n      : {},\n  ],\n  url: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_url1_error'),\n    },\n  ],\n  key: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_Parameter_error'),\n    },\n    {\n      // eslint-disable-next-line no-control-regex -- regex\n      pattern: /^[\\x00-\\x7F]+$/,\n      message: I18n.t('plugin_Parametename_error'),\n    },\n  ],\n  service_token: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_Servicetoken_error'),\n    },\n  ],\n};\n\nexport const getPictureUploadInitValue = (\n  info?: PluginMetaInfo,\n): UploadValue | undefined => {\n  if (!info) {\n    return;\n  }\n  return [\n    {\n      url: info.icon?.url || '',\n      uid: info?.icon?.uri || '',\n    },\n  ];\n};\n\nexport interface AuthOption {\n  label: string;\n  value: number;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- any\n  [key: string]: any;\n}\n/** Recursively find the input under the auth option */\nexport const findAuthTypeItem = (data: AuthOption[], targetKey = 0) => {\n  for (const item of data) {\n    if (item.value === targetKey) {\n      return item;\n    } else if (item.children?.length > 0) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any -- any\n      const res: any = findAuthTypeItem(item.children, targetKey);\n      if (res) {\n        return res;\n      }\n    }\n  }\n  return undefined;\n};\n\nexport const findAuthTypeItemV2 = (\n  opts: AuthOption[],\n  authType?: number[],\n  subAuthType?: number,\n) => {\n  if (authType?.[0] === 0) {\n    return opts.find(item => item.value === 0);\n  } else if (authType?.[0] === 1) {\n    const optsItem = opts.find(item => item.value === 1);\n    return optsItem?.children.find(\n      (item: AuthOption) => item.value === subAuthType,\n    );\n  } else if (authType?.[0] === 3) {\n    const optsItem = opts.find(item => item.value === 3);\n\n    return optsItem?.children.find(\n      (item: AuthOption) => item.value === subAuthType,\n    );\n  }\n};\n\ninterface RuntimeOptionsType {\n  label: string;\n  value: string;\n}\n\ninterface IdeConfType {\n  key: string;\n  type: string;\n  default: string;\n  options: {\n    value: string;\n    name: string;\n  }[];\n}\n\nexport interface UsePluginSchameReturnValue {\n  authOption: AuthOption[];\n  runtimeOptions: RuntimeOptionsType[];\n  defaultRuntime: string;\n}\n\n// Get schame and runtime options\nexport const usePluginSchame = (): UsePluginSchameReturnValue => {\n  const [authOption, setAuthOption] = useState<AuthOption[]>([]);\n  const [runtimeOptions, setRuntimeOptions] = useState<RuntimeOptionsType[]>(\n    [],\n  );\n  const [defaultRuntime, setDefaultRuntime] = useState('1');\n\n  const getOption = async () => {\n    const res = await PluginDevelopApi.GetOAuthSchema();\n    const authOptions = [\n      {\n        label: I18n.t('create_plugin_modal_Authorization_no'),\n        value: 0,\n        key: 'None',\n      },\n      {\n        label: I18n.t('create_plugin_modal_Authorization_service'),\n        value: 1,\n        key: 'Service',\n        children: [\n          {\n            label: I18n.t('plugin_auth_method_service_api_key'),\n            value: 0,\n            key: 'Service Token / API Key',\n          },\n        ],\n      },\n      {\n        label: I18n.t('create_plugin_modal_Authorization_oauth'),\n        value: 3,\n        key: 'OAuth',\n        children: safeJSONParse(res.oauth_schema),\n      },\n    ];\n    setAuthOption(authOptions);\n    const runtimeInfo = (\n      safeJSONParse(res.ide_conf, []) as IdeConfType[]\n    )?.find?.(item => item.key === 'code_runtime_enum');\n    if (runtimeInfo) {\n      const runtimeList = runtimeInfo.options.map(item => ({\n        value: item.value,\n        label: item.name,\n      }));\n      setRuntimeOptions(runtimeList);\n      setDefaultRuntime(runtimeInfo.default);\n    }\n  };\n  useEffect(() => {\n    getOption();\n  }, []);\n\n  return { authOption, runtimeOptions, defaultRuntime };\n};\n\nexport const convertPluginMetaParams = ({\n  val,\n  spaceId,\n  headerList,\n  projectId,\n  creationMethod,\n  defaultRuntime,\n  pluginType,\n  extItemsJSON,\n}: {\n  val: FormState;\n  spaceId: string;\n  headerList: commonParamSchema[];\n  projectId: string | undefined;\n  creationMethod: CreationMethod;\n  defaultRuntime: string;\n  pluginType: PluginType;\n  extItemsJSON: Record<string, string>;\n}) => {\n  const mainAuthType = val.auth_type?.at(0);\n  const serviceSubAuthType = val.auth_type?.at(-1);\n  const initParams = {\n    ...val,\n    icon: { uri: val?.plugin_uri?.[0]?.uid },\n    auth_type: mainAuthType,\n    common_params: {\n      [ParameterLocation.Header]: headerList,\n      [ParameterLocation.Body]: [],\n      [ParameterLocation.Path]: [],\n      [ParameterLocation.Query]: [],\n    },\n    space_id: spaceId,\n    project_id: projectId,\n    creation_method: creationMethod,\n    ide_code_runtime: val.ide_code_runtime ?? defaultRuntime,\n    plugin_type: Number(pluginType) as unknown as PluginType,\n    private_link_id:\n      val.private_link_id === '0' ? undefined : val.private_link_id,\n  };\n  const params =\n    mainAuthType === 1\n      ? {\n          ...initParams,\n          sub_auth_type: serviceSubAuthType,\n          auth_payload: JSON.stringify(extItemsJSON),\n        }\n      : {\n          ...initParams,\n          sub_auth_type: mainAuthType === 3 ? serviceSubAuthType : undefined,\n          oauth_info: JSON.stringify(extItemsJSON),\n        };\n  return params;\n};\n\nexport const registerPluginMeta = async ({\n  params,\n}: {\n  params: ReturnType<typeof convertPluginMetaParams>;\n}) => {\n  const res = await PluginDevelopApi.RegisterPluginMeta(\n    {\n      ...params,\n    },\n    {\n      __disableErrorToast: true,\n    },\n  );\n  return res.plugin_id;\n};\n\nexport const updatePluginMeta = async ({\n  params,\n  editInfo,\n}: {\n  params: ReturnType<typeof convertPluginMetaParams>;\n  editInfo: PluginInfoProps | undefined;\n}) => {\n  await PluginDevelopApi.UpdatePluginMeta(\n    {\n      ...params,\n      plugin_id: editInfo?.plugin_id || '',\n      edit_version: editInfo?.edit_version,\n    },\n    {\n      __disableErrorToast: true,\n    },\n  );\n  return '';\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-lines */\n/* eslint-disable max-lines-per-function */\n/* eslint-disable complexity */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { type FC, useEffect, useState, Fragment } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport { useBenefitBasic, UserLevel } from '@coze-studio/premium-store-adapter';\nimport {\n  CLOUD_PLUGIN_COZE,\n  doGetCreationMethodTips,\n  extInfoText,\n  locationOption,\n  authOptionsPlaceholder,\n  grantTypeOptions,\n  type PluginInfoProps,\n} from '@coze-studio/plugin-shared';\nimport { useCurrentEnterpriseInfo } from '@coze-foundation/enterprise-store-adapter';\nimport { PictureUpload } from '@coze-common/biz-components/picture-upload';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus, IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport {\n  Cascader,\n  Col,\n  Form,\n  FormInput,\n  FormSelect,\n  FormTextArea,\n  IconButton,\n  Input,\n  Row,\n  Typography,\n  withField,\n} from '@coze-arch/coze-design';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport { useFlags } from '@coze-arch/bot-flags';\nimport {\n  type PrivateLink,\n  type commonParamSchema,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { FileBizType, IconType } from '@coze-arch/bot-api/developer_api';\nimport { DeveloperApi, PluginDevelopApi } from '@coze-arch/bot-api';\nimport { InfoPopover } from '@coze-agent-ide/bot-plugin-tools/infoPopover';\n\nimport {\n  findAuthTypeItemV2,\n  formRuleList,\n  getPictureUploadInitValue,\n} from './utils';\nimport { type UsePluginFormStateReturn, type FormState } from './hooks';\n\nimport s from './index.module.less';\n\nconst HEADER_LIST_LENGTH_MAX = 20;\n\nconst doFormatTypeAndCreation = (info?: PluginInfoProps) =>\n  info ? `${info?.plugin_type}-${info?.creation_method}` : '';\n\nconst FormCascader = withField(Cascader);\n\nconst getOptionList = () => [\n  {\n    label: I18n.t('plugin_creation_method_cloud_plugin_use_existing_services'),\n    value: CLOUD_PLUGIN_COZE,\n  },\n];\n\nexport const PluginForm: FC<{\n  pluginState: UsePluginFormStateReturn;\n  visible: boolean;\n  isCreate?: boolean;\n  disabled?: boolean;\n  editInfo?: PluginInfoProps;\n}> = ({ pluginState, disabled, editInfo, isCreate, visible }) => {\n  const {\n    formApi,\n    extItems,\n    setExtItems,\n    headerList,\n    setHeaderList,\n    isValidCheckResult,\n    setIsValidCheckResult,\n    pluginTypeCreationMethod,\n    setPluginTypeCreationMethod,\n    authOption,\n  } = pluginState;\n\n  const [FLAGS] = useFlags();\n  const { compareLevel } = useBenefitBasic();\n  const enterpriseInfo = useCurrentEnterpriseInfo();\n  const [mainAuthType, setMainAuthType] = useState<number>(0);\n  const [authType, setAuthType] = useState<number>(0);\n  const [disableEditUrl, setDisableEditUrl] = useState<boolean>(false);\n  // Compliance audit results\n  const changeVal = () => {\n    if (!isValidCheckResult) {\n      setIsValidCheckResult(true);\n    }\n  };\n  const creationMethodOption = getOptionList();\n  const creationMethodTip = doGetCreationMethodTips();\n\n  const [privateLinkMap, setPrivateLinkMap] = useState<Array<PrivateLink>>();\n  const { data: privateNetworkListOptions } = useRequest(\n    async () => {\n      const { data } = await PluginDevelopApi.PrivateLinkList({\n        enterprise_id: enterpriseInfo?.enterprise_id,\n      });\n      setPrivateLinkMap(data?.private_links);\n      const list = data?.private_links?.map(item => ({\n        label: item.name,\n        value: item.id,\n      }));\n\n      return [\n        {\n          label: I18n.t('vpc_plugin_create_plugin_2'),\n          value: '0',\n        },\n        ...(list ?? []),\n      ];\n    },\n    {\n      ready:\n        compareLevel === UserLevel.Enterprise &&\n        FLAGS['bot.studio.plugin_vpc'] &&\n        !IS_OPEN_SOURCE,\n    },\n  );\n  /**\n   * Get the default icon, and set it to the form\n   */\n  const getIcon = async () => {\n    try {\n      const res = await DeveloperApi.GetIcon({\n        icon_type: IconType.Plugin,\n      });\n      const iconData = res.data?.icon_list?.[0];\n      if (!iconData) {\n        return;\n      }\n      const { url = '', uri = '' } = iconData;\n      formApi.current?.setValue('plugin_uri', [\n        {\n          url,\n          uid: uri,\n        },\n      ]);\n    } catch (e) {\n      logger.info(`getIcon error: ${e}`);\n    }\n  };\n  useEffect(() => {\n    if (!visible) {\n      return;\n    }\n    if (!isCreate && editInfo) {\n      /**\n       * The following useStates are all update plugins\n       */\n      /**\n       * Service has been expanded to the secondary menu in this demand. The primary menu of service is 1, and the secondary menu is 0, 1, 2.\n       * In order not to change the history logic, the backend adds a sub_auth_type field to record the value of the secondary menu under the service, but the authType is still an array of length 1 and the value is 1.\n       * Therefore, when the front end needs to manually determine that the auth_type is 1, the sub_auth_type is stuffed in to form an array of length 2, so that the casdar menu can backfill the content of editInfo\n       * 5, 6, and 7 are for the front end to determine which one is selected. 5 is apiKey, 6 is zero, and 7 is oicd.\n       * Good question. AuthType is an array, but the length is not fixed:\n       * When the length of the auth_type is 1, it means that it is a service, and the content has and only 1. At this time, the sub_auth_type is one of 0, 1, and 2\n       * 2. When the auth_type length is 2, it means oAuth, and the content is [3,4]. There is no sub_auth_type at this time\n       */\n      if (editInfo.meta_info?.auth_type?.at(0) === 1) {\n        switch (editInfo.meta_info?.sub_auth_type) {\n          case 0:\n            setAuthType(5);\n            break;\n          case 1:\n            setAuthType(6);\n            break;\n          case 2:\n            setAuthType(7);\n            break;\n          default:\n            setAuthType(0);\n            break;\n        }\n      } else {\n        setAuthType(editInfo.meta_info?.auth_type?.at(-1) ?? 0);\n      }\n      setMainAuthType(editInfo.meta_info?.auth_type?.at(0) ?? 0);\n      setExtItems(\n        findAuthTypeItemV2(\n          authOption,\n          editInfo.meta_info?.auth_type,\n          editInfo.meta_info?.auth_type?.[1] ??\n            editInfo.meta_info?.sub_auth_type,\n        )?.items || [],\n      );\n\n      const header = editInfo.meta_info?.common_params?.[4] || [];\n      setHeaderList([...header]);\n      setPluginTypeCreationMethod(\n        `${editInfo.plugin_type}-${editInfo.creation_method}`,\n      );\n\n      // Disable editing URLs if there is a private network connection\n      if (\n        editInfo?.meta_info?.private_link_id &&\n        compareLevel === UserLevel.Enterprise &&\n        FLAGS['bot.studio.plugin_vpc']\n      ) {\n        setDisableEditUrl(true);\n      }\n    } else {\n      reset();\n    }\n  }, [visible]);\n\n  const reset = () => {\n    //Reset plugin\n    getIcon();\n    setAuthType(0);\n    setAuthType(0);\n    setExtItems([]);\n    setHeaderList([{ name: 'User-Agent', value: 'Coze/1.0' }]);\n    setIsValidCheckResult(true);\n    setPluginTypeCreationMethod(undefined);\n  };\n\n  /** Add header */\n  const addHeader = () => {\n    setHeaderList(list => [...list, { name: '', value: '' }]);\n  };\n  /** Delete header */\n  const deleteHeader = (index: number) => {\n    // If it is the last header, only empty the content, not delete it\n    setHeaderList(list =>\n      list.length <= 1\n        ? [{ name: '', value: '' }]\n        : list.filter((_, i) => i !== index),\n    );\n  };\n  /** Edit header */\n  const editHeader = (index: number, header: commonParamSchema) => {\n    setHeaderList(list => list.map((item, i) => (i === index ? header : item)));\n  };\n\n  const renderPluginCoze = () => {\n    let authTypeInitValue = [0];\n    if (!editInfo) {\n      authTypeInitValue = [0];\n    }\n    // It's OAuth's case\n    if (editInfo?.meta_info?.auth_type?.length === 2) {\n      authTypeInitValue = editInfo?.meta_info?.auth_type;\n    }\n    // service & no auth\n    else {\n      // No authorization required, naturally no sub_auth_type\n      if (editInfo?.meta_info?.auth_type?.at(0) === 0) {\n        authTypeInitValue = editInfo?.meta_info?.auth_type;\n      }\n      // Service, with sub_auth_type\n      else {\n        if (typeof editInfo?.meta_info?.sub_auth_type !== 'undefined') {\n          authTypeInitValue = [\n            ...(editInfo?.meta_info?.auth_type || []),\n            editInfo?.meta_info?.sub_auth_type,\n          ];\n        }\n      }\n    }\n    return (\n      <>\n        {compareLevel === UserLevel.Enterprise &&\n        FLAGS['bot.studio.plugin_vpc'] ? (\n          <FormSelect\n            label={{\n              text: I18n.t('vpc_plugin_create_plugin_1'),\n              required: true,\n              extra: <InfoPopover data={extInfoText.private_link_id} />,\n            }}\n            field=\"private_link_id\"\n            style={{ width: '100%' }}\n            initValue={editInfo?.meta_info?.private_link_id || '0'}\n            onChange={value => {\n              setDisableEditUrl(value !== '0');\n              if (value === '0') {\n                formApi.current?.setValue('url', '');\n              } else {\n                formApi.current?.setValue(\n                  'url',\n                  privateLinkMap?.find(item => item.id === value)\n                    ?.plugin_access_url,\n                );\n              }\n            }}\n            optionList={privateNetworkListOptions}\n          />\n        ) : null}\n\n        {/* plugin URL */}\n        {!disabled ? (\n          <FormInput\n            disabled={disableEditUrl}\n            className={s['textarea-single-line']}\n            initValue={editInfo?.meta_info?.url}\n            trigger={['blur', 'change']}\n            field=\"url\"\n            label={I18n.t('create_plugin_modal_url1')}\n            placeholder={I18n.t('create_plugin_modal_url2')}\n            onBlur={() => {\n              formApi.current?.setValue(\n                'url',\n                formApi.current?.getValue('url')?.trim(),\n              );\n            }}\n            rules={disableEditUrl ? [] : formRuleList.url}\n          />\n        ) : null}\n        {/* Plugin Header */}\n        <Form.Slot\n          className={s['header-list']}\n          label={{\n            text: I18n.t('plugin_create_header_list_title'),\n            align: 'right',\n            extra: (\n              <div className={s['header-list-extra']}>\n                <InfoPopover data={extInfoText.header_list} />\n                {headerList.length < HEADER_LIST_LENGTH_MAX && !disabled && (\n                  <IconButton\n                    size=\"small\"\n                    color=\"secondary\"\n                    icon={<IconCozPlus className=\"coz-fg-hglt text-[16px]\" />}\n                    onClick={addHeader}\n                  />\n                )}\n              </div>\n            ),\n          }}\n        >\n          <div className={s['header-list-box']}>\n            <Row className={s['header-row']}>\n              <Col span={9}>\n                <div className={s['header-col-content']}>Key</div>\n              </Col>\n              <Col span={12}>\n                <div className={s['header-col-content']}>Value</div>\n              </Col>\n              <Col span={3}>\n                <div className={s['header-col-content']}>\n                  {I18n.t('plugin_create_action_btn')}\n                </div>\n              </Col>\n            </Row>\n\n            <div>\n              {headerList?.map((item, index) => (\n                <Row\n                  type=\"flex\"\n                  justify=\"space-between\"\n                  align=\"middle\"\n                  key={index}\n                >\n                  <Col span={9}>\n                    <div className={s['col-content']}>\n                      <Input\n                        placeholder={'Name'}\n                        value={item.name}\n                        onChange={name => {\n                          editHeader(index, { ...item, name });\n                        }}\n                        maxLength={100}\n                        disabled={disabled}\n                      />\n                    </div>\n                  </Col>\n                  <Col span={12}>\n                    <div className={s['col-content']}>\n                      <Input\n                        placeholder={'Value'}\n                        value={item.value}\n                        onChange={value => {\n                          editHeader(index, { ...item, value });\n                        }}\n                        maxLength={2000}\n                        disabled={disabled}\n                      />\n                    </div>\n                  </Col>\n                  <Col span={3}>\n                    <div className={s['col-content']}>\n                      <IconButton\n                        size=\"small\"\n                        color=\"secondary\"\n                        icon={\n                          <IconCozTrashCan className=\"coz-fg-secondary text-[14px]\" />\n                        }\n                        disabled={disabled}\n                        onClick={() => deleteHeader(index)}\n                      />\n                    </div>\n                  </Col>\n                </Row>\n              ))}\n            </div>\n          </div>\n        </Form.Slot>\n\n        {/* Authorization method */}\n\n        <FormCascader\n          disabled={disabled}\n          rules={[{ required: true }]}\n          style={{ width: '100%' }}\n          initValue={authTypeInitValue}\n          field=\"auth_type\"\n          label={{\n            text: I18n.t('create_plugin_modal_auth1'),\n            extra: <InfoPopover data={extInfoText.auth} />,\n          }}\n          placeholder={I18n.t('please_select_an_authorization_method')}\n          treeData={authOption}\n          displayRender={(list: any) => {\n            if (IS_RELEASE_VERSION) {\n              const value = formApi.current?.getValue('auth_type');\n              if (value?.[0] === 1 && value?.[1] === 1) {\n                return I18n.t('plugin_auth_method_service_zti');\n              }\n            }\n            return `${list.at(-1)}`;\n          }}\n          onChange={(value: any) => {\n            setExtItems(\n              findAuthTypeItemV2(authOption, [value.at(0)], value.at(-1))\n                ?.items || [],\n            );\n          }}\n        />\n\n        {/* Authorization - Service - Service Token/API Key */}\n        {mainAuthType === 1 && authType === 5 && (\n          <>\n            <Form.RadioGroup\n              disabled={disabled}\n              rules={[{ required: true }]}\n              field=\"location\"\n              label={{\n                text: I18n.t('create_plugin_modal_location'),\n                extra: <InfoPopover data={extInfoText.location} />,\n              }}\n              options={locationOption}\n              initValue={editInfo?.meta_info?.location || 1}\n            />\n\n            <FormInput\n              disabled={disabled}\n              initValue={editInfo?.meta_info?.key}\n              trigger={['blur', 'change']}\n              field=\"key\"\n              label={{\n                text: I18n.t('create_plugin_modal_Parameter'),\n                extra: <InfoPopover data={extInfoText.key} />,\n              }}\n              placeholder={I18n.t('create_plugin_modal_Parameter_empty')}\n              maxLength={100}\n              rules={formRuleList.key}\n            />\n\n            <FormInput\n              disabled={disabled}\n              initValue={editInfo?.meta_info?.service_token}\n              trigger={['blur', 'change']}\n              field=\"service_token\"\n              label={{\n                text: I18n.t('create_plugin_modal_Servicetoken'),\n                extra: <InfoPopover data={extInfoText.service_token} />,\n              }}\n              placeholder={I18n.t('create_plugin_modal_Servicetoken_empty')}\n              maxLength={2000}\n              rules={formRuleList.service_token}\n            />\n          </>\n        )}\n\n        {/* Server level dynamic return authorization */}\n        {/* Service - OIDC & OAuth - Standard Mode */}\n        {extItems?.map((item, index) => {\n          let formInfo: Record<string, any> = {};\n          // Service - OIDC\n          if (editInfo?.meta_info?.auth_type?.at(0) === 1) {\n            formInfo = safeJSONParse(editInfo.meta_info.auth_payload);\n          }\n          // OAuth - Standard Mode\n          if (editInfo?.meta_info?.auth_type?.at(0) === 3) {\n            formInfo = safeJSONParse(editInfo.meta_info.oauth_info);\n          }\n\n          if (item.type === 'select') {\n            return (\n              <FormSelect\n                disabled={disabled}\n                key={item.key + index}\n                label={item?.label || item.key}\n                field={item.key}\n                optionList={grantTypeOptions}\n                initValue={formInfo?.[item.key] || item.default}\n                style={{ width: '100%' }}\n                rules={[\n                  {\n                    required: item.required,\n                    // @ts-expect-error -- linter-disable-autofix\n                    message: authOptionsPlaceholder[item.key],\n                  },\n                ]}\n              />\n            );\n          }\n          return (\n            <Fragment key={item.key + index}>\n              <FormInput\n                disabled={disabled}\n                key={item.key}\n                trigger={['blur', 'change']}\n                field={item.key}\n                label={{\n                  text: item?.label || item.key,\n                  extra: extInfoText[item.key] && (\n                    <InfoPopover data={extInfoText[item.key]} />\n                  ),\n                }}\n                // @ts-expect-error -- linter-disable-autofix\n                placeholder={authOptionsPlaceholder[item.key]}\n                initValue={formInfo?.[item.key] || item.default}\n                maxLength={item.max_len}\n                rules={[\n                  {\n                    required: item.required,\n                    // @ts-expect-error -- linter-disable-autofix\n                    message: authOptionsPlaceholder[item.key],\n                  },\n                  item.type === 'url'\n                    ? {\n                        pattern: /^(http|https):\\/\\/.+$/,\n                        message: I18n.t('create_plugin_modal_URLerror'),\n                      }\n                    : {\n                        // eslint-disable-next-line no-control-regex -- regex\n                        pattern: /^[\\x00-\\x7F]+$/,\n                        message: I18n.t('create_plugin_modal_descrip_error'),\n                      },\n                  ...(item?.ruleList || []),\n                ]}\n              />\n            </Fragment>\n          );\n        })}\n      </>\n    );\n  };\n\n  return (\n    <Form<FormState>\n      getFormApi={api => (formApi.current = api)}\n      autoScrollToError\n      showValidateIcon={false}\n      className={s['upload-form']}\n      onValueChange={values => {\n        if ('auth_type' in values) {\n          if (values.auth_type.at(0) === 1) {\n            switch (values.auth_type.at(-1)) {\n              case 0:\n                setAuthType(5);\n                break;\n              case 1:\n                setAuthType(6);\n                break;\n              // @ts-expect-error Authorization type compatible\n              case 2:\n                setAuthType(7);\n                break;\n              default:\n                setAuthType(0);\n                break;\n            }\n          } else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            setAuthType(values.auth_type.at(-1)!);\n          }\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          setMainAuthType(values.auth_type.at(0)!);\n        }\n      }}\n    >\n      {/* plugin avatar */}\n      <PictureUpload\n        noLabel\n        disabled={disabled}\n        fieldClassName={s['upload-field']}\n        field=\"plugin_uri\"\n        iconType={IconType.Plugin}\n        fileBizType={FileBizType.BIZ_PLUGIN_ICON}\n        initValue={getPictureUploadInitValue(editInfo?.meta_info)}\n        onChange={changeVal}\n      />\n\n      {/* Plugin name/plugin description/url/plugin type */}\n      <>\n        <FormTextArea\n          disabled={disabled}\n          initValue={editInfo?.meta_info?.name}\n          field=\"name\"\n          className={s['textarea-single-line']}\n          label={I18n.t('create_plugin_modal_name1')}\n          placeholder={I18n.t('create_plugin_modal_name2')}\n          trigger={['blur', 'change']}\n          maxCount={30}\n          maxLength={30}\n          rows={1}\n          onBlur={() => {\n            formApi.current?.setValue(\n              'name',\n              formApi.current?.getValue('name')?.trim(),\n            );\n          }}\n          onChange={changeVal}\n          rules={formRuleList.name}\n        />\n        <FormTextArea\n          disabled={disabled}\n          initValue={editInfo?.meta_info?.desc}\n          field=\"desc\"\n          label={I18n.t('create_plugin_modal_descrip1')}\n          trigger={['blur', 'change']}\n          placeholder={I18n.t('create_plugin_modal_descrip2')}\n          rows={2}\n          maxCount={600}\n          maxLength={600}\n          onBlur={() => {\n            formApi.current?.setValue(\n              'desc',\n              formApi.current?.getValue('desc')?.trim(),\n            );\n          }}\n          onChange={changeVal}\n          rules={formRuleList.desc}\n        />\n        {/* plugin type */}\n        <Form.Slot\n          label={{\n            text: I18n.t('plugin_creation_method'),\n            required: true,\n            extra: <InfoPopover data={creationMethodTip} />,\n          }}\n        >\n          {isCreate ? (\n            <Form.RadioGroup\n              noLabel\n              className={s['creation-method']}\n              direction=\"vertical\"\n              rules={[\n                {\n                  required: true,\n                  message: I18n.t(\n                    'plugin_creation_select_creation_method_warning',\n                  ),\n                },\n              ]}\n              field=\"creation_method\"\n              disabled={disabled}\n              options={creationMethodOption}\n              initValue={\n                editInfo ? doFormatTypeAndCreation(editInfo) : undefined\n              }\n              onChange={v => setPluginTypeCreationMethod(v.target.value)}\n            />\n          ) : (\n            <Typography.Text fontSize=\"14px\">\n              {\n                creationMethodOption.find(\n                  option => option.value === pluginTypeCreationMethod,\n                )?.label\n              }\n            </Typography.Text>\n          )}\n        </Form.Slot>\n      </>\n\n      {pluginTypeCreationMethod === CLOUD_PLUGIN_COZE\n        ? renderPluginCoze()\n        : null}\n    </Form>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useState } from 'react';\n\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport {\n  type AuthorizationType,\n  type RegisterPluginMetaRequest,\n  type commonParamSchema,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { type UploadValue } from '@coze-common/biz-components';\nimport { type OauthTccOpt } from '@coze-studio/plugin-shared';\n\nimport { type UsePluginSchameReturnValue, usePluginSchame } from './utils';\n\nexport type FormState = RegisterPluginMetaRequest & {\n  plugin_uri: UploadValue;\n  auth_type: AuthorizationType[];\n} & Record<string, string>;\n\nexport interface UsePluginFormStateReturn extends UsePluginSchameReturnValue {\n  formApi: React.MutableRefObject<FormApi<FormState> | undefined>;\n  extItems: OauthTccOpt[];\n  setExtItems: React.Dispatch<React.SetStateAction<OauthTccOpt[]>>;\n  headerList: commonParamSchema[];\n  setHeaderList: React.Dispatch<React.SetStateAction<commonParamSchema[]>>;\n  isValidCheckResult: boolean;\n  setIsValidCheckResult: React.Dispatch<React.SetStateAction<boolean>>;\n  pluginTypeCreationMethod?: string;\n  setPluginTypeCreationMethod: React.Dispatch<\n    React.SetStateAction<string | undefined>\n  >;\n}\n\nexport const usePluginFormState = (): UsePluginFormStateReturn => {\n  const formApi = useRef<\n    FormApi<\n      RegisterPluginMetaRequest & {\n        plugin_uri: UploadValue;\n        auth_type: Array<AuthorizationType>;\n      } & Record<string, string>\n    >\n  >();\n  const { authOption, runtimeOptions, defaultRuntime } = usePluginSchame();\n  const [extItems, setExtItems] = useState<OauthTccOpt[]>([]);\n  const [headerList, setHeaderList] = useState<commonParamSchema[]>([\n    { name: 'User-Agent', value: 'Coze/1.0' },\n  ]);\n  // Compliance audit results\n  const [isValidCheckResult, setIsValidCheckResult] = useState(true);\n  const [pluginTypeCreationMethod, setPluginTypeCreationMethod] =\n    useState<string>();\n\n  return {\n    formApi,\n    extItems,\n    setExtItems,\n    headerList,\n    setHeaderList,\n    isValidCheckResult,\n    setIsValidCheckResult,\n    pluginTypeCreationMethod,\n    setPluginTypeCreationMethod,\n    authOption,\n    runtimeOptions,\n    defaultRuntime,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\n\nimport { ImportPluginModal } from '../../file-import';\n\nexport const ImportModal: FC<{\n  onCancel?: () => void;\n  onSuccess?: (pluginID?: string) => void;\n  projectId?: string;\n}> = ({ onCancel, onSuccess, projectId }) => {\n  const [showFileImportPluginModel, setShowFileImportPluginModel] =\n    useState(false);\n\n  return (\n    <>\n      <ImportPluginModal\n        projectId={projectId}\n        visible={showFileImportPluginModel}\n        onSuccess={d => {\n          const pluginId = d?.plugin_id;\n          if (pluginId) {\n            onSuccess?.(pluginId);\n          } else {\n            onSuccess?.();\n          }\n        }}\n        onCancel={() => setShowFileImportPluginModel(false)}\n      />\n      <Button\n        color=\"primary\"\n        onClick={() => {\n          setShowFileImportPluginModel(true);\n          onCancel?.();\n        }}\n      >\n        {I18n.t('import')}\n      </Button>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, type ReactNode } from 'react';\n\nimport classNames from 'classnames';\nimport { type PluginInfoProps } from '@coze-studio/plugin-shared';\nimport { I18n } from '@coze-arch/i18n';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { UIButton, UIModal, Toast, Space } from '@coze-arch/bot-semi';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\n\nimport { Editor } from '../editor';\n\nimport s from './index.module.less';\n\nexport interface CreatePluginProps {\n  visible: boolean;\n  isCreate?: boolean;\n  editInfo?: PluginInfoProps;\n  disabled?: boolean;\n  onCancel?: () => void;\n  onSuccess?: (pluginId?: string) => void;\n  actions?: ReactNode;\n  projectId?: string;\n}\n\nconst INDENTATION_SPACES = 2;\nconst EDITOR_HEIGHT_MAX = 560;\n\nexport const CreateCodePluginModal: React.FC<CreatePluginProps> = props => {\n  const {\n    isCreate = true,\n    onCancel,\n    editInfo,\n    visible,\n    onSuccess,\n    disabled = false,\n    actions,\n    projectId,\n  } = props;\n\n  const [aiPlugin, setAiPlugin] = useState<string | undefined>();\n  const [clientId, setClientId] = useState<string | undefined>();\n  const [clientSecret, setClientSecret] = useState<string | undefined>();\n  const [serviceToken, setServiceToken] = useState<string | undefined>();\n  const [openApi, setOpenApi] = useState<string | undefined>();\n\n  useEffect(() => {\n    /** Reset pop-up data every time you open it */\n    if (visible) {\n      //Format json\n      const desc = JSON.stringify(\n        safeJSONParse(editInfo?.code_info?.plugin_desc),\n        null,\n        INDENTATION_SPACES,\n      );\n      setAiPlugin(desc || '');\n      setOpenApi(editInfo?.code_info?.openapi_desc || '');\n      setClientId(editInfo?.code_info?.client_id);\n      setClientSecret(editInfo?.code_info?.client_secret);\n      setServiceToken(editInfo?.code_info?.service_token);\n    }\n  }, [visible]);\n\n  const registerPlugin = async () => {\n    const params = {\n      ai_plugin: aiPlugin,\n      client_id: clientId,\n      client_secret: clientSecret,\n      service_token: serviceToken,\n      openapi: openApi,\n    };\n    let res;\n    if (isCreate) {\n      res = await PluginDevelopApi.RegisterPlugin({\n        ...params,\n        project_id: projectId,\n        space_id: useSpaceStore.getState().getSpaceId(),\n      });\n    } else {\n      await PluginDevelopApi.UpdatePlugin({\n        ...params,\n        plugin_id: editInfo?.plugin_id,\n        edit_version: editInfo?.edit_version,\n      });\n    }\n\n    Toast.success({\n      content: isCreate\n        ? I18n.t('register_success')\n        : I18n.t('Plugin_update_success'),\n      showClose: false,\n    });\n    onSuccess?.(res?.data?.plugin_id);\n    onCancel?.();\n  };\n\n  return (\n    <UIModal\n      fullScreen\n      className=\"full-screen-modal\"\n      title={\n        <div className={s['bot-code-edit-title-action']}>\n          <span>\n            {isCreate ? I18n.t('plugin_create') : I18n.t('plugin_Update')}\n          </span>\n          <div>{actions}</div>\n        </div>\n      }\n      visible={visible}\n      onCancel={() => onCancel?.()}\n      footer={\n        !disabled ? (\n          <Space>\n            <UIButton type=\"tertiary\" onClick={() => onCancel?.()}>\n              {I18n.t('Cancel')}\n            </UIButton>\n            <UIButton type=\"primary\" onClick={registerPlugin}>\n              {I18n.t('Confirm')}\n            </UIButton>\n          </Space>\n        ) : null\n      }\n      maskClosable={false}\n    >\n      <div className={classNames(s.flex)}>\n        <div className={classNames(s['plugin-height'], s.flex5)}>\n          <div style={{ display: 'flex' }}>\n            <div style={{ flex: 1, borderRight: '1px solid rgb(215,218,221)' }}>\n              <div className={s.title}>\n                {I18n.t('ai_plugin_(fill_in_json)_*')}\n              </div>\n              <Editor\n                dataTestID=\"create-plugin-code-editor-json\"\n                disabled={disabled}\n                theme=\"tomorrow\"\n                mode=\"json\"\n                height={EDITOR_HEIGHT_MAX}\n                value={aiPlugin}\n                useValidate={false}\n                onChange={e => setAiPlugin(e)}\n              />\n            </div>\n            <div style={{ flex: 1 }}>\n              <div className={s.title}>\n                {I18n.t('openapi_(fill_in_yaml)_*')}\n              </div>\n              <Editor\n                dataTestID=\"create-plugin-code-editor-yaml\"\n                disabled={disabled}\n                theme=\"tomorrow\"\n                mode=\"yaml\"\n                height={EDITOR_HEIGHT_MAX}\n                value={openApi}\n                useValidate={false}\n                onChange={e => setOpenApi(e)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </UIModal>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { Button } from '@coze-arch/coze-design';\nimport { IconCodeOutlined } from '@coze-arch/bot-icons';\n\nimport { CreateCodePluginModal } from '../bot-code-edit';\n\nexport const CodeModal: FC<{\n  onCancel?: () => void;\n  onSuccess?: (pluginId?: string) => void;\n  projectId?: string;\n}> = ({ onCancel, onSuccess, projectId }) => {\n  const [showCodePluginModel, setShowCodePluginModel] = useState(false);\n  return (\n    <>\n      <CreateCodePluginModal\n        isCreate={true}\n        visible={showCodePluginModel}\n        onSuccess={pluginId => {\n          onSuccess?.(pluginId);\n        }}\n        onCancel={() => {\n          setShowCodePluginModel(false);\n        }}\n        projectId={projectId}\n      />\n      <Button\n        data-testid=\"create-plugin-code-modal-button\"\n        color=\"primary\"\n        icon={<IconCodeOutlined />}\n        onClick={() => {\n          setShowCodePluginModel(true);\n          onCancel?.();\n        }}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { type FC, useMemo, useState, useEffect } from 'react';\n\nimport { type PluginInfoProps } from '@coze-studio/plugin-shared';\nimport {\n  PluginForm,\n  usePluginFormState,\n  convertPluginMetaParams,\n  registerPluginMeta,\n  updatePluginMeta,\n} from '@coze-studio/plugin-form-adapter';\nimport { withSlardarIdButton } from '@coze-studio/bot-utils';\nimport { I18n } from '@coze-arch/i18n';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport {\n  type CreationMethod,\n  type PluginType,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { ERROR_CODE } from '@coze-agent-ide/bot-plugin-tools/pluginModal/types';\nimport { IconCozInfoCircleFill } from '@coze-arch/coze-design/icons';\nimport {\n  Button,\n  Divider,\n  Modal,\n  Space,\n  Toast,\n  Typography,\n} from '@coze-arch/coze-design';\n\nimport s from '../index.module.less';\nimport { PluginDocs } from '../../plugin-docs';\nimport { ImportModal } from './import-modal';\nimport { CodeModal } from './code-modal';\n\nexport interface CreatePluginFormProps {\n  visible: boolean;\n  isCreate?: boolean;\n  editInfo?: PluginInfoProps;\n  disabled?: boolean;\n  onCancel?: () => void;\n  onSuccess?: (pluginID?: string) => Promise<void> | void;\n  projectId?: string;\n}\n\nexport const CreateFormPluginModal: FC<CreatePluginFormProps> = props => {\n  const {\n    onCancel,\n    editInfo,\n    isCreate = true,\n    visible,\n    onSuccess,\n    disabled = false,\n    projectId,\n  } = props;\n\n  const { id } = useSpaceStore(store => store.space);\n  const modalTitle = useMemo(() => {\n    if (isCreate) {\n      return (\n        <div className=\"w-full flex justify-between items-center pr-[8px]\">\n          <div>{I18n.t('create_plugin_modal_title1')}</div>\n          <Space>\n            <CodeModal\n              onCancel={onCancel}\n              onSuccess={onSuccess}\n              projectId={projectId}\n            />\n            <ImportModal\n              onCancel={onCancel}\n              onSuccess={onSuccess}\n              projectId={projectId}\n            />\n            <Divider layout=\"vertical\" className=\"h-5\" />\n          </Space>\n        </div>\n      );\n    }\n    if (disabled) {\n      return I18n.t('plugin_detail_view_modal_title');\n    }\n    return I18n.t('plugin_detail_edit_modal_title');\n  }, [isCreate, disabled]);\n  const [loading, setLoading] = useState(false);\n  const pluginState = usePluginFormState();\n\n  const {\n    formApi,\n    extItems,\n    headerList,\n    isValidCheckResult,\n    setIsValidCheckResult,\n    pluginTypeCreationMethod,\n    defaultRuntime,\n  } = pluginState;\n\n  useEffect(() => {\n    if (!isCreate) {\n      return;\n    }\n    if (visible) {\n      // Scroll bar after display to top\n      const modalContent = document.querySelector(\n        '.create-plugin-modal-content .semi-modal-body',\n      );\n      if (modalContent) {\n        modalContent.scrollTop = 0;\n      }\n    } else {\n      // Reset form after hiding\n      formApi?.current?.reset();\n    }\n  }, [visible]);\n\n  const confirmBtn = async () => {\n    await formApi.current?.validate();\n    const type = isCreate ? 'create' : 'edit';\n    const val = formApi.current?.getValues();\n    if (!val || !pluginTypeCreationMethod) {\n      return;\n    }\n\n    const json: Record<string, string> = {};\n    extItems?.forEach(item => {\n      if (item.key in val) {\n        json[item.key] = val[item.key];\n      }\n    });\n\n    const [pluginType, creationMethod] = pluginTypeCreationMethod.split('-');\n\n    const params = convertPluginMetaParams({\n      val,\n      spaceId: String(id),\n      headerList,\n      projectId,\n      creationMethod: Number(creationMethod) as unknown as CreationMethod,\n      defaultRuntime,\n      pluginType: Number(pluginType) as unknown as PluginType,\n      extItemsJSON: json,\n    });\n    const action = {\n      create: () => registerPluginMeta({ params }),\n      edit: () => updatePluginMeta({ params, editInfo }),\n    };\n\n    try {\n      setLoading(true);\n      const pluginID = await action[type]();\n      Toast.success({\n        content: isCreate\n          ? I18n.t('Plugin_new_toast_success')\n          : I18n.t('Plugin_update_toast_success'),\n        showClose: false,\n      });\n      onCancel?.();\n      onSuccess?.(pluginID);\n    } catch (error) {\n      // @ts-expect-error -- linter-disable-autofix\n      const { code, msg } = error;\n      if (Number(code) === ERROR_CODE.SAFE_CHECK) {\n        setIsValidCheckResult(false);\n      } else {\n        Toast.error({\n          content: withSlardarIdButton(msg),\n        });\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <>\n      <Modal\n        title={modalTitle}\n        className=\"[&_.semi-modal-header]:items-center\"\n        visible={visible}\n        keepDOM={isCreate}\n        onCancel={() => onCancel?.()}\n        modalContentClass=\"create-plugin-modal-content\"\n        footer={\n          !disabled && (\n            <div>\n              {!isValidCheckResult && (\n                <div className={s['error-msg-box']}>\n                  <span className={s['error-msg']}>\n                    {I18n.t('plugin_create_modal_safe_error')}\n                  </span>\n                </div>\n              )}\n              <Typography.Paragraph\n                type=\"secondary\"\n                fontSize=\"12px\"\n                className=\"text-start mb-[16px]\"\n              >\n                <IconCozInfoCircleFill className=\"coz-fg-hglt text-[14px] align-sub\" />\n                <span className=\"mx-[4px]\">\n                  {I18n.t('plugin_create_draft_desc')}\n                </span>\n                <PluginDocs />\n              </Typography.Paragraph>\n              <div>\n                <Button\n                  color=\"primary\"\n                  onClick={() => {\n                    onCancel?.();\n                  }}\n                >\n                  {I18n.t('create_plugin_modal_button_cancel')}\n                </Button>\n                <Button\n                  loading={loading}\n                  onClick={() => {\n                    confirmBtn();\n                  }}\n                >\n                  {I18n.t('create_plugin_modal_button_confirm')}\n                </Button>\n              </div>\n            </div>\n          )\n        }\n      >\n        <PluginForm\n          pluginState={pluginState}\n          visible={visible}\n          isCreate={isCreate}\n          disabled={disabled}\n          editInfo={editInfo}\n        />\n      </Modal>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIButton } from '@coze-arch/bot-semi';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\nimport { type PluginInfoProps } from '@coze-studio/plugin-shared';\nimport {\n  checkOutPluginContext,\n  unlockOutPluginContext,\n  usePluginStore,\n} from '@coze-studio/bot-plugin-store';\n\nimport {\n  CreateFormPluginModal,\n  type CreatePluginFormProps,\n} from '../bot-form-edit';\nimport {\n  CreateCodePluginModal,\n  type CreatePluginProps,\n} from '../bot-code-edit';\nimport { ImportToolModal, type ImportToolModalProps } from '../../file-import';\n\nimport styles from './index.module.less';\n\nexport const useBotCodeEditInPlugin = ({\n  modalProps,\n}: {\n  modalProps: Pick<CreatePluginProps, 'onSuccess'>;\n}) => {\n  const { pluginInfo, canEdit, unlockPlugin, wrapWithCheckLock } =\n    usePluginStore(\n      useShallow(store => ({\n        pluginInfo: store.pluginInfo,\n        canEdit: store.canEdit,\n        unlockPlugin: store.unlockPlugin,\n        wrapWithCheckLock: store.wrapWithCheckLock,\n      })),\n    );\n  const [showCodePluginModel, setShowCodePluginModel] = useState(false);\n  const [editable, setEditable] = useState(false);\n\n  const action = useMemo(() => {\n    if (!canEdit) {\n      return null;\n    }\n\n    return (\n      <div className={styles.actions}>\n        {editable ? (\n          <UIButton\n            onClick={() => {\n              setEditable(false);\n              unlockPlugin();\n            }}\n          >\n            {I18n.t('Cancel')}\n          </UIButton>\n        ) : (\n          <UIButton\n            theme=\"solid\"\n            onClick={wrapWithCheckLock(() => setEditable(true))}\n          >\n            {I18n.t('Edit')}\n          </UIButton>\n        )}\n      </div>\n    );\n  }, [editable, canEdit]);\n\n  useEffect(() => {\n    if (showCodePluginModel) {\n      setEditable(false);\n    }\n  }, [showCodePluginModel]);\n\n  const modal = (\n    <CreateCodePluginModal\n      {...modalProps}\n      isCreate={false}\n      visible={showCodePluginModel}\n      onCancel={() => {\n        setShowCodePluginModel(false);\n        unlockPlugin();\n      }}\n      disabled={!editable || !canEdit}\n      editInfo={pluginInfo}\n      actions={action}\n    />\n  );\n\n  return { modal, setShowCodePluginModel };\n};\n\nexport const useBotCodeEditOutPlugin = ({\n  modalProps,\n}: {\n  modalProps: Pick<CreatePluginProps, 'onSuccess'>;\n}) => {\n  const [pluginInfo, setPluginInfo] = useState<PluginInfoProps>({});\n  const [modalVisible, setModalVisible] = useState(false);\n  const [editable, setEditable] = useState(false);\n  const [disableEdit, setDisableEdit] = useState(false);\n  const pluginId = pluginInfo?.plugin_id || '';\n\n  const action = useMemo(() => {\n    if (disableEdit) {\n      return null;\n    }\n\n    return (\n      <div className={styles.actions}>\n        {editable ? (\n          <UIButton\n            onClick={() => {\n              setEditable(false);\n              unlockOutPluginContext(pluginId);\n            }}\n          >\n            {I18n.t('Cancel')}\n          </UIButton>\n        ) : (\n          <UIButton\n            theme=\"solid\"\n            onClick={async () => {\n              const isLocked = await checkOutPluginContext(pluginId);\n\n              if (isLocked) {\n                return;\n              }\n\n              setEditable(true);\n            }}\n          >\n            {I18n.t('Edit')}\n          </UIButton>\n        )}\n      </div>\n    );\n  }, [editable, pluginId, disableEdit]);\n\n  useEffect(() => {\n    if (modalVisible) {\n      setEditable(false);\n    }\n  }, [modalVisible]);\n\n  const modal = (\n    <CreateCodePluginModal\n      {...modalProps}\n      editInfo={pluginInfo}\n      isCreate={false}\n      visible={modalVisible}\n      onCancel={() => {\n        setModalVisible(false);\n        if (!disableEdit) {\n          unlockOutPluginContext(pluginId);\n        }\n      }}\n      disabled={!editable}\n      actions={action}\n    />\n  );\n\n  const open = useCallback(async (id: string, disable: boolean) => {\n    const res = await PluginDevelopApi.GetPluginInfo({\n      plugin_id: id || '',\n    });\n    setPluginInfo({\n      plugin_id: id,\n      code_info: {\n        plugin_desc: res.code_info?.plugin_desc,\n        /** yaml */\n        openapi_desc: res.code_info?.openapi_desc,\n        client_id: res.code_info?.client_id,\n        client_secret: res.code_info?.client_secret,\n        service_token: res.code_info?.service_token,\n      },\n    });\n    setDisableEdit(disable);\n    setModalVisible(true);\n  }, []);\n\n  return { modal, open };\n};\n\nexport const useBotFormEditInPlugin = ({\n  modalProps,\n}: {\n  modalProps: Pick<CreatePluginFormProps, 'onSuccess'>;\n}) => {\n  const { pluginInfo, canEdit, unlockPlugin } = usePluginStore(store => ({\n    pluginInfo: store.pluginInfo,\n    canEdit: store.canEdit,\n    unlockPlugin: store.unlockPlugin,\n  }));\n  const [showFormPluginModel, setShowFormPluginModel] = useState(false);\n\n  const modal = (\n    <CreateFormPluginModal\n      {...modalProps}\n      isCreate={false}\n      visible={showFormPluginModel}\n      editInfo={pluginInfo}\n      onCancel={() => {\n        unlockPlugin();\n        setShowFormPluginModel(false);\n      }}\n      disabled={!canEdit}\n    />\n  );\n\n  return {\n    modal,\n    setShowFormPluginModel,\n  };\n};\n\nexport const useImportToolInPlugin = ({\n  modalProps,\n}: {\n  modalProps: Pick<ImportToolModalProps, 'onSuccess'>;\n}) => {\n  const { pluginInfo, unlockPlugin } = usePluginStore(store => ({\n    pluginInfo: store.pluginInfo,\n    unlockPlugin: store.unlockPlugin,\n  }));\n  const [showImportToolModal, setShowImportToolModal] = useState(false);\n\n  const modal = (\n    <ImportToolModal\n      {...modalProps}\n      pluginInfo={{\n        pluginID: pluginInfo?.plugin_id,\n        pluginName: pluginInfo?.meta_info?.name,\n        pluginUrl: pluginInfo?.meta_info?.url,\n        pluginDesc: pluginInfo?.meta_info?.desc,\n        editVersion: pluginInfo?.edit_version,\n      }}\n      visible={showImportToolModal}\n      onCancel={() => {\n        unlockPlugin();\n        setShowImportToolModal(false);\n      }}\n    />\n  );\n\n  return {\n    modal,\n    setShowImportToolModal,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { Editor as MonacoEditor } from '@coze-arch/bot-monaco-editor';\n\ninterface EditorPros {\n  mode: 'yaml' | 'json' | 'javascript';\n  value?: string;\n  onChange?: (v: string | undefined) => void;\n  height?: number | string;\n  useValidate?: boolean;\n  theme?: string;\n  disabled?: boolean;\n  dataTestID?: string;\n}\n\nexport const Editor: React.FC<EditorPros> = ({\n  mode,\n  value,\n  onChange,\n  height = 500,\n  theme = 'monokai',\n  disabled = false,\n  dataTestID,\n}) => {\n  const [heightVal, setHeightVal] = useState(height);\n  useEffect(() => {\n    setHeightVal(height);\n  }, [height]);\n  return (\n    <div style={{ position: 'relative' }} data-testid={dataTestID}>\n      <MonacoEditor\n        options={{ readOnly: disabled }}\n        language={mode}\n        theme={theme}\n        width=\"100%\"\n        onChange={onChange}\n        height={heightVal}\n        value={value}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { parse as yamlParse, stringify as yamlStringify } from 'yaml';\nimport { isObject } from 'lodash-es';\nimport axios from 'axios';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { PluginDataFormat } from '@coze-arch/bot-api/plugin_develop';\nimport {\n  AuthorizationServiceLocation,\n  AuthorizationType,\n  ParameterLocation,\n  type commonParamSchema,\n  type PluginMetaInfo,\n} from '@coze-arch/bot-api/developer_api';\n\ninterface PluginInfo {\n  aiPlugin?: string;\n  openAPI?: string;\n}\n\ninterface AIPluginMetaInfo {\n  name_for_human?: string;\n  name_for_model?: string;\n  description_for_human?: string;\n  description_for_model?: string;\n  auth: {\n    type?: AIPluginAuthType;\n    client_url?: string;\n    authorization_url?: string;\n    authorization_content_type?: string;\n    platform?: string;\n    client_id?: string;\n    client_secret?: string;\n    location?: string;\n    key?: string;\n    service_token?: string;\n    scope?: string;\n  };\n  logo_url?: string;\n  common_params?: {\n    header?: Array<commonParamSchema>;\n    body?: Array<commonParamSchema>;\n    query?: Array<commonParamSchema>;\n    path?: Array<commonParamSchema>;\n  };\n}\n\ninterface PluginInfoObject {\n  aiPlugin?: AIPluginMetaInfo;\n  openAPI?: {\n    info?: { description?: string; title?: string; version?: string };\n    servers?: Array<{ url?: string }>;\n    paths?: Array<unknown>;\n    [key: string]: unknown;\n  };\n}\n\nexport enum AIPluginAuthType {\n  None = 'none',\n  Service = 'service_http',\n  OAuth = 'oauth',\n}\n\nexport enum AIPluginAuthServiceLocation {\n  Header = 'Header',\n  Query = 'Query',\n}\n\nenum ImportFormatType {\n  Curl = 'curl',\n  OpenApi = 'openapi',\n  Postman = 'postman',\n  Unknown = '',\n  Swagger = 'swagger',\n}\n\nexport function getFileExtension(name: string) {\n  const index = name.lastIndexOf('.');\n  return name.slice(index + 1);\n}\n\n// @ts-expect-error -- linter-disable-autofix\nexport async function getContent(file: Blob, onProgress): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = event => {\n      const result = event.target?.result;\n\n      if (!result || typeof result !== 'string') {\n        reject(new CustomError('normal_error', 'file read fail'));\n        return;\n      }\n      resolve(result);\n    };\n    fileReader.onprogress = event => {\n      if (event.total) {\n        onProgress({\n          total: event.total,\n          loaded: event.loaded,\n        });\n      }\n    };\n    fileReader.readAsText(file);\n  });\n}\n\nexport function isValidURL(str?: string): boolean {\n  // abbreviated version\n  try {\n    const objExp = new RegExp(\n      '^(https?:\\\\/\\\\/)?' + // protocol\n        '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|' + // domain name and extension\n        '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))' + // OR ip (v4) address\n        '(\\\\:\\\\d+)?' + // port\n        '(\\\\/[-a-z\\\\d%_.~+]*)*',\n      'i',\n    );\n    return Boolean(objExp.test(str || ''));\n  } catch (e) {\n    return false;\n  }\n}\n\nexport async function customService(url: string) {\n  // Custom requests are required here, and axios needs to be introduced.\n  const axiosInstance = axios.create({ responseType: 'text' });\n\n  const response = await axiosInstance.get(url);\n  return response.data;\n}\n\nconst AUTH_TYPE_MAP: Record<AIPluginAuthType, AuthorizationType> = {\n  [AIPluginAuthType.None]: AuthorizationType.None,\n  [AIPluginAuthType.Service]: AuthorizationType.Service,\n  [AIPluginAuthType.OAuth]: AuthorizationType.OAuth,\n};\n\nconst AUTH_LOCATION_MAP: Record<\n  AIPluginAuthServiceLocation,\n  AuthorizationServiceLocation\n> = {\n  [AIPluginAuthServiceLocation.Header]: AuthorizationServiceLocation.Header,\n  [AIPluginAuthServiceLocation.Query]: AuthorizationServiceLocation.Query,\n};\n\nexport function parsePluginInfo(data: PluginInfo): PluginInfoObject {\n  const { aiPlugin, openAPI } = data;\n  const aiPluginObj = safeJSONParse(aiPlugin || '{}');\n  const openAPIObj = yamlParse(openAPI || '');\n\n  return {\n    aiPlugin: aiPluginObj,\n    openAPI: openAPIObj,\n  };\n}\n\nexport function getInitialPluginMetaInfo(\n  data: PluginInfoObject,\n): PluginMetaInfo {\n  const { aiPlugin, openAPI } = data;\n  const { type, location, key, service_token, ...oauthInfo } =\n    aiPlugin?.auth || {};\n  return {\n    name: aiPlugin?.name_for_human,\n    desc: aiPlugin?.description_for_human,\n    url: openAPI?.servers?.[0]?.url,\n    icon: { uri: aiPlugin?.logo_url },\n    auth_type: [AUTH_TYPE_MAP[type || AIPluginAuthType.None]],\n    // @ts-expect-error -- linter-disable-autofix\n    location: AUTH_LOCATION_MAP[location || ''],\n    key,\n    service_token,\n    oauth_info: JSON.stringify(oauthInfo),\n    common_params: {\n      [ParameterLocation.Header]: aiPlugin?.common_params?.header || [],\n      [ParameterLocation.Body]: aiPlugin?.common_params?.body || [],\n      [ParameterLocation.Path]: aiPlugin?.common_params?.path || [],\n      [ParameterLocation.Query]: aiPlugin?.common_params?.query || [],\n    },\n  };\n}\n\nfunction getKeyByValue<V>(\n  map: Record<string, V>,\n  value?: V,\n): string | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  for (const [key, val] of Object.entries(map)) {\n    if (val === value) {\n      return key;\n    }\n  }\n}\n\nexport function getRegisterInfo(\n  pluginMetaInfo: PluginMetaInfo,\n  data: PluginInfo,\n): PluginInfo {\n  const { aiPlugin: oriAIPluginInfo, openAPI: oriOpenAPIInfo } =\n    parsePluginInfo(data);\n  const {\n    name,\n    desc,\n    auth_type,\n    common_params,\n    location,\n    key,\n    service_token,\n    oauth_info,\n    icon,\n  } = pluginMetaInfo;\n  const newAIPlugin: AIPluginMetaInfo = {\n    name_for_human: name,\n    name_for_model: name,\n    description_for_human: desc,\n    description_for_model: desc,\n    logo_url: icon?.uri,\n    common_params: {\n      header: common_params?.[ParameterLocation.Header],\n      body: common_params?.[ParameterLocation.Body],\n      path: common_params?.[ParameterLocation.Path],\n      query: common_params?.[ParameterLocation.Query],\n    },\n    auth: {\n      type: getKeyByValue<AuthorizationType>(AUTH_TYPE_MAP, auth_type?.at(0)),\n      location: getKeyByValue<AuthorizationServiceLocation>(\n        AUTH_LOCATION_MAP,\n        location,\n      ),\n      key,\n      service_token,\n      ...JSON.parse(oauth_info || '{}'),\n    },\n  };\n  const mergedAIPluginInfo = { ...oriAIPluginInfo, ...newAIPlugin };\n  const mergedOpenAPIInfo = {\n    ...(oriOpenAPIInfo || {}),\n    info: { ...(oriOpenAPIInfo?.info || {}), title: name, description: desc },\n    servers: [{ url: pluginMetaInfo.url }],\n  };\n  return {\n    aiPlugin: JSON.stringify(mergedAIPluginInfo),\n    openAPI: yamlStringify(mergedOpenAPIInfo),\n  };\n}\n\nexport function getImportFormatType(\n  format?: PluginDataFormat,\n): ImportFormatType {\n  switch (format) {\n    case PluginDataFormat.Curl:\n      return ImportFormatType.Curl;\n    case PluginDataFormat.OpenAPI:\n      return ImportFormatType.OpenApi;\n    case PluginDataFormat.Postman:\n      return ImportFormatType.Postman;\n    case PluginDataFormat.Swagger:\n      return ImportFormatType.Swagger;\n    default:\n      return ImportFormatType.Unknown;\n  }\n}\n\nexport const isDuplicatePathErrorResponseData = (value: unknown): boolean =>\n  isObject(value) && 'paths_duplicated' in value;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { UIModal } from '@coze-arch/bot-semi';\nimport { IconWarningInfo } from '@coze-arch/bot-icons';\nimport { type DuplicateAPIInfo } from '@coze-arch/bot-api/plugin_develop';\n\ninterface MergeToolInfoProps {\n  onOk?: () => void;\n  onCancel?: () => void;\n  duplicateInfos?: DuplicateAPIInfo[];\n}\n\nexport function showMergeTool({\n  duplicateInfos = [],\n  onCancel,\n  onOk,\n}: MergeToolInfoProps) {\n  UIModal.warning({\n    title: I18n.t('duplicate_tools_within_plugin'),\n    content: duplicateInfos?.map(item => (\n      <div>{`${item.method}  ${I18n.t('path_has_duplicates', {\n        path: item.path,\n        num: item.count,\n      })}`}</div>\n    )),\n    okText: I18n.t('merge_duplicate_tools'),\n    cancelText: I18n.t('Cancel'),\n    centered: true,\n    icon: <IconWarningInfo />,\n    okButtonProps: {\n      type: 'warning',\n    },\n    onOk,\n    onCancel,\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function getEnv(): string {\n  if (!IS_PROD) {\n    return 'cn-boe';\n  }\n\n  const regionPart = IS_OVERSEA ? 'oversea' : 'cn';\n  const inhousePart = IS_RELEASE_VERSION ? 'release' : 'inhouse';\n  return [regionPart, inhousePart].join('-');\n}\n\n// error code\nexport const ERROR_CODE = {\n  SAFE_CHECK: 720092020,\n  DUP_NAME_URL: 702093022,\n  DUP_NAME: 702092010,\n  DUP_PATH: 702093021,\n};\n\nexport const ACCEPT_FORMAT = ['json', 'yaml'];\n\nexport const ACCEPT_EXT = ACCEPT_FORMAT.map(item => `.${item}`);\n\nexport const INITIAL_PLUGIN_REPORT_PARAMS = {\n  environment: getEnv(),\n  workspace_id: '',\n  workspace_type: '',\n  status: 1,\n  create_type: 'import',\n};\n\nexport const INITIAL_TOOL_REPORT_PARAMS = {\n  environment: getEnv(),\n  workspace_id: '',\n  workspace_type: '',\n  status: 1,\n  create_type: 'import',\n  plugin_id: '',\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type UploadValue } from '@coze-common/biz-components';\nimport { I18n } from '@coze-arch/i18n';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport { type PluginMetaInfo } from '@coze-arch/bot-api/developer_api';\n\nexport const formRuleList = {\n  name: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_name1_error'),\n    },\n    IS_OVERSEA\n      ? {\n          pattern: /^[\\w\\s]+$/,\n          message: I18n.t('create_plugin_modal_nameerror'),\n        }\n      : {\n          pattern: /^[\\w\\s\\u4e00-\\u9fa5]+$/u, // Increased domestic support for Chinese\n          message: I18n.t('create_plugin_modal_nameerror_cn'),\n        },\n  ],\n  desc: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_descrip1_error'),\n    },\n    IS_OVERSEA && {\n      // eslint-disable-next-line no-control-regex -- regex\n      pattern: /^[\\x00-\\x7F]+$/,\n      message: I18n.t('create_plugin_modal_descrip_error'),\n    },\n  ],\n  url: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_url1_error'),\n    },\n  ],\n  key: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_Parameter_error'),\n    },\n    {\n      // eslint-disable-next-line no-control-regex -- regex\n      pattern: /^[\\x00-\\x7F]+$/,\n      message: I18n.t('plugin_Parametename_error'),\n    },\n  ],\n  service_token: [\n    {\n      required: true,\n      message: I18n.t('create_plugin_modal_Servicetoken_error'),\n    },\n  ],\n};\n\nexport const getPictureUploadInitValue = (\n  info?: PluginMetaInfo,\n): UploadValue | undefined => {\n  if (!info) {\n    return;\n  }\n  return [\n    {\n      url: info.icon?.url || '',\n      uid: info?.icon?.uri || '',\n    },\n  ];\n};\n\nexport interface AuthOption {\n  label: string;\n  value: number;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- any\n  [key: string]: any;\n}\n/** Recursively find the input under the auth option */\n// @ts-expect-error -- linter-disable-autofix\nexport const findAuthTypeItem = (data: AuthOption[], targetKey = 0) => {\n  for (const item of data) {\n    if (item.value === targetKey) {\n      return item;\n    } else if (item.children?.length > 0) {\n      return findAuthTypeItem(item.children, targetKey);\n    }\n  }\n};\n\nexport function getAuthOptions(authSchema?: string): Array<AuthOption> {\n  const authOptions: AuthOption[] = [\n    {\n      label: I18n.t('create_plugin_modal_Authorization_no'),\n      value: 0,\n      key: 'None',\n    },\n    {\n      label: I18n.t('create_plugin_modal_Authorization_service'),\n      value: 1,\n      key: 'Service',\n    },\n    {\n      label: I18n.t('create_plugin_modal_Authorization_oauth'),\n      value: 3,\n      key: 'OAuth',\n      children: safeJSONParse(authSchema),\n    },\n  ];\n  return authOptions;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport { InputWithCountField } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport {\n  Col,\n  Form,\n  Row,\n  UICascader,\n  UIFormInput,\n  UIFormTextArea,\n  UIIconButton,\n  UIInput,\n  useFormApi,\n  withField,\n} from '@coze-arch/bot-semi';\nimport { type commonParamSchema } from '@coze-arch/bot-api/developer_api';\nimport {\n  type OauthTccOpt,\n  authOptionsPlaceholder,\n  extInfoText,\n  locationOption,\n} from '@coze-studio/plugin-shared';\nimport { IconAdd, IconDeleteOutline } from '@coze-arch/bot-icons';\nimport { InfoPopover } from '@coze-agent-ide/bot-plugin-tools/infoPopover';\n\nimport { type AuthOption, findAuthTypeItem, formRuleList } from './utils';\nimport { type ConfirmFormProps } from './interface';\n\nimport s from './index.module.less';\n\ninterface PluginInfoFormFieldProps {\n  disabled?: boolean;\n}\n\nconst HEADER_LIST_LENGTH_MAX = 20;\n\nexport const PluginNameField = ({ disabled }: PluginInfoFormFieldProps) => {\n  const formApi = useFormApi<ConfirmFormProps>();\n  const formValues = formApi.getValues();\n  return disabled ? (\n    <Form.Slot\n      label={{\n        text: I18n.t('create_plugin_modal_name1'),\n        required: true,\n      }}\n    >\n      <div>{formValues?.name}</div>\n    </Form.Slot>\n  ) : (\n    <UIFormTextArea\n      field=\"name\"\n      className={s['textarea-single-line']}\n      label={I18n.t('create_plugin_modal_name1')}\n      placeholder={I18n.t('create_plugin_modal_name2')}\n      trigger={['blur', 'change']}\n      maxCount={30}\n      maxLength={30}\n      rows={1}\n      onBlur={() => {\n        formApi.setValue('name', formApi.getValue('name')?.trim());\n      }}\n      rules={formRuleList.name}\n    />\n  );\n};\n\nexport const PluginDescField = ({ disabled }: PluginInfoFormFieldProps) => {\n  const formApi = useFormApi<ConfirmFormProps>();\n  const formValues = formApi.getValues();\n\n  return disabled ? (\n    <Form.Slot\n      label={{\n        text: I18n.t('create_plugin_modal_descrip1'),\n        required: true,\n      }}\n    >\n      <div>{formValues?.desc}</div>\n    </Form.Slot>\n  ) : (\n    <UIFormTextArea\n      field=\"desc\"\n      label={I18n.t('create_plugin_modal_descrip1')}\n      trigger={['blur', 'change']}\n      placeholder={I18n.t('create_plugin_modal_descrip2')}\n      rows={2}\n      maxCount={600}\n      maxLength={600}\n      onBlur={() => {\n        formApi.setValue('desc', formValues?.desc?.trim());\n      }}\n      rules={formRuleList.desc}\n    />\n  );\n};\n\nexport const PluginUrlField = ({ disabled }: PluginInfoFormFieldProps) => {\n  const formApi = useFormApi<ConfirmFormProps>();\n  const formValues = formApi.getValues();\n  return disabled ? (\n    <Form.Slot\n      label={{\n        text: I18n.t('create_plugin_modal_url1'),\n        required: true,\n      }}\n    >\n      <div>{formValues?.url}</div>\n    </Form.Slot>\n  ) : (\n    <UIFormInput\n      className={s['textarea-single-line']}\n      trigger={['blur', 'change']}\n      field=\"url\"\n      label={I18n.t('create_plugin_modal_url1')}\n      placeholder={I18n.t('create_plugin_modal_url2')}\n      onBlur={() => {\n        formApi.setValue('url', formValues?.url?.trim());\n      }}\n      rules={formRuleList.url}\n    />\n  );\n};\n\nconst HeaderList = ({\n  disabled,\n  value: headerList = [],\n  onChange: setHeaderList,\n}: PluginInfoFormFieldProps & {\n  value?: commonParamSchema[];\n  onChange?: (val?: commonParamSchema[]) => void;\n}) => {\n  /** Add header */\n  // @ts-expect-error -- linter-disable-autofix\n  const addHeader = data => {\n    const h = [...headerList];\n    h.push(data.name ? data : { name: '', value: '' });\n    setHeaderList?.(h);\n  };\n  /** Delete header */\n  // @ts-expect-error -- linter-disable-autofix\n  const deleteHeader = index => {\n    // If it is the last header, only empty the content, not delete it\n    const filterList = cloneDeep(headerList);\n    filterList.splice(index, 1);\n    setHeaderList?.(filterList);\n  };\n\n  return (\n    <Form.Slot\n      className={s['header-list']}\n      label={{\n        text: I18n.t('plugin_create_header_list_title'),\n        align: 'right',\n        extra: (\n          <div className={s['header-list-extra']}>\n            <InfoPopover data={extInfoText.header_list} />\n            {headerList.length < HEADER_LIST_LENGTH_MAX && !disabled && (\n              <UIIconButton\n                size=\"large\"\n                icon={<IconAdd />}\n                onClick={addHeader}\n              />\n            )}\n          </div>\n        ),\n      }}\n    >\n      <div className={s['herder-list-box']}>\n        <Row className={s['header-row']} gutter={8}>\n          <Col span={9}>\n            <div className={s['header-col-content']}>Key</div>\n          </Col>\n          <Col span={12}>\n            <div className={s['header-col-content']}>Value</div>\n          </Col>\n          <Col span={3}>\n            <div\n              className={s['header-col-content']}\n              style={{ textAlign: 'right' }}\n            >\n              {I18n.t('plugin_create_action_btn')}\n            </div>\n          </Col>\n        </Row>\n\n        <div className={s['herder-list-cotent']}>\n          {headerList?.map((item, index) => (\n            <Row\n              gutter={8}\n              type=\"flex\"\n              justify=\"space-between\"\n              align=\"middle\"\n              key={index}\n            >\n              <Col span={9}>\n                <div className={s['col-content']}>\n                  <UIInput\n                    placeholder={'Name'}\n                    value={item.name}\n                    onChange={val => {\n                      const list = cloneDeep(headerList);\n                      list[index].name = val;\n                      setHeaderList?.(list);\n                    }}\n                    maxLength={100}\n                    disabled={disabled}\n                  />\n                </div>\n              </Col>\n              <Col span={12}>\n                <div className={s['col-content']}>\n                  <UIInput\n                    placeholder={'Value'}\n                    value={item.value}\n                    onChange={val => {\n                      const list = cloneDeep(headerList);\n                      list[index].value = val;\n                      setHeaderList?.(list);\n                    }}\n                    maxLength={200}\n                    disabled={disabled}\n                  />\n                </div>\n              </Col>\n              <Col span={3}>\n                <div className={s['col-content']}>\n                  <UIIconButton\n                    icon={<IconDeleteOutline />}\n                    type=\"secondary\"\n                    disabled={disabled}\n                    onClick={() => {\n                      deleteHeader(index);\n                    }}\n                  />\n                </div>\n              </Col>\n            </Row>\n          ))}\n        </div>\n      </div>\n    </Form.Slot>\n  );\n};\n\nconst HeaderListInnerField = withField(HeaderList, {\n  valueKey: 'value',\n  onKeyChangeFnName: 'onChange',\n});\n\nexport const HeaderListField = (props: PluginInfoFormFieldProps) => (\n  <HeaderListInnerField\n    {...props}\n    field=\"headerList\"\n    label={{ text: '' }}\n  ></HeaderListInnerField>\n);\n\nexport const AuthTypeField = ({\n  disabled,\n  authOption,\n  onChange,\n}: PluginInfoFormFieldProps & {\n  authOption: Array<AuthOption>;\n  onChange: (val?: Array<number>) => void;\n}) => {\n  const formApi = useFormApi<ConfirmFormProps>();\n  const formValues = formApi.getValues();\n  return disabled ? (\n    <Form.Slot\n      label={{\n        text: I18n.t('create_plugin_modal_auth1'),\n        extra: <InfoPopover data={extInfoText.auth} />,\n        required: true,\n      }}\n    >\n      <div>\n        {findAuthTypeItem(authOption, formValues?.auth_type?.at(-1))?.label}\n      </div>\n    </Form.Slot>\n  ) : (\n    <UICascader.FormItem\n      rules={[{ required: true }]}\n      style={{ width: '100%' }}\n      initValue={formValues?.auth_type || [0]}\n      field=\"auth_type\"\n      label={{\n        text: I18n.t('create_plugin_modal_auth1'),\n        extra: <InfoPopover data={extInfoText.auth} />,\n      }}\n      placeholder={I18n.t('please_select_an_authorization_method')}\n      treeData={authOption}\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      displayRender={(list: any) => `${(list as string[])?.at(-1)}`}\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      onChange={(val: any) => {\n        onChange(val as Array<number>);\n      }}\n    />\n  );\n};\n\nexport const ServiceField = ({ disabled }: PluginInfoFormFieldProps) => {\n  const formApi = useFormApi<ConfirmFormProps>();\n  const formValues = formApi.getValues();\n  return (\n    <>\n      {disabled ? (\n        <Form.Slot\n          label={{\n            text: I18n.t('create_plugin_modal_location'),\n            extra: <InfoPopover data={extInfoText.location} />,\n            required: true,\n          }}\n        >\n          <div>\n            {\n              findAuthTypeItem(locationOption, formApi.getValues()?.location)\n                ?.label\n            }\n          </div>\n        </Form.Slot>\n      ) : (\n        <Form.RadioGroup\n          rules={[{ required: true }]}\n          field=\"location\"\n          label={{\n            text: I18n.t('create_plugin_modal_location'),\n            extra: <InfoPopover data={extInfoText.location} />,\n          }}\n          options={locationOption}\n        />\n      )}\n\n      {disabled ? (\n        <Form.Slot\n          label={{\n            text: I18n.t('create_plugin_modal_Parameter'),\n            extra: <InfoPopover data={extInfoText.key} />,\n            required: true,\n          }}\n        >\n          <div>{formApi.getValues()?.key}</div>\n        </Form.Slot>\n      ) : (\n        <InputWithCountField\n          initValue={formValues?.key}\n          trigger={['blur', 'change']}\n          field=\"key\"\n          label={{\n            text: I18n.t('create_plugin_modal_Parameter'),\n            extra: <InfoPopover data={extInfoText.key} />,\n          }}\n          placeholder={I18n.t('create_plugin_modal_Parameter_empty')}\n          maxLength={100}\n          rules={formRuleList.key}\n        />\n      )}\n\n      {disabled ? (\n        <Form.Slot\n          label={{\n            text: I18n.t('create_plugin_modal_Servicetoken'),\n            extra: <InfoPopover data={extInfoText.service_token} />,\n            required: true,\n          }}\n        >\n          <div>{formValues?.service_token}</div>\n        </Form.Slot>\n      ) : (\n        <InputWithCountField\n          initValue={formValues?.service_token}\n          trigger={['blur', 'change']}\n          field=\"service_token\"\n          label={{\n            text: I18n.t('create_plugin_modal_Servicetoken'),\n            extra: <InfoPopover data={extInfoText.service_token} />,\n          }}\n          placeholder={I18n.t('create_plugin_modal_Servicetoken_empty')}\n          maxLength={400}\n          rules={formRuleList.service_token}\n        />\n      )}\n    </>\n  );\n};\n\n// extItems dynamic delivery\nexport const ExtItems = ({\n  disabled,\n  extItems,\n}: PluginInfoFormFieldProps & { extItems: OauthTccOpt[] }) => {\n  const formApi = useFormApi<ConfirmFormProps>();\n  const formValues = formApi.getValues();\n  return (\n    <>\n      {/* Server level dynamic return authorization */}\n      {extItems?.map(item => (\n        <>\n          {disabled ? (\n            <Form.Slot\n              key={item.key}\n              label={{\n                text: item.key,\n                extra: extInfoText[item.key] && (\n                  <InfoPopover data={extInfoText[item.key]} />\n                ),\n                required: item.required,\n              }}\n            >\n              <div>\n                {formValues?.oauth_info\n                  ? safeJSONParse(formValues.oauth_info)[item.key]\n                  : null}\n              </div>\n            </Form.Slot>\n          ) : (\n            <InputWithCountField\n              key={item.key}\n              trigger={['blur', 'change']}\n              field={item.key}\n              label={{\n                text: item.key,\n                extra: extInfoText[item.key] && (\n                  <InfoPopover data={extInfoText[item.key]} />\n                ),\n              }}\n              // @ts-expect-error -- linter-disable-autofix\n              placeholder={authOptionsPlaceholder[item.key]}\n              initValue={\n                (formValues?.oauth_info &&\n                  safeJSONParse(formValues.oauth_info)[item.key]) ||\n                item.default\n              }\n              maxLength={item.max_len}\n              rules={[\n                {\n                  required: item.required,\n                  // @ts-expect-error -- linter-disable-autofix\n                  message: authOptionsPlaceholder[item.key],\n                },\n                item.type === 'url'\n                  ? {\n                      pattern: /^(http|https):\\/\\/.+$/,\n                      message: I18n.t('create_plugin_modal_URLerror'),\n                    }\n                  : {\n                      // eslint-disable-next-line no-control-regex -- regex\n                      pattern: /^[\\x00-\\x7F]+$/,\n                      message: I18n.t('create_plugin_modal_descrip_error'),\n                    },\n              ]}\n            />\n          )}\n        </>\n      ))}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { useEffect, useRef, useState } from 'react';\n\nimport { withSlardarIdButton } from '@coze-studio/bot-utils';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  EVENT_NAMES,\n  sendTeaEvent,\n  type ParamsTypeDefine,\n} from '@coze-arch/bot-tea';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport { UIModal, UIButton, Space, Form, UIToast } from '@coze-arch/bot-semi';\nimport { IconInfoCircle } from '@coze-arch/bot-icons';\nimport {\n  ParameterLocation,\n  PluginType,\n  type PluginMetaInfo,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { FileBizType, IconType } from '@coze-arch/bot-api/developer_api';\nimport { DeveloperApi, PluginDevelopApi } from '@coze-arch/bot-api';\nimport { PictureUpload } from '@coze-common/biz-components/picture-upload';\nimport { type OauthTccOpt } from '@coze-studio/plugin-shared';\n\nimport { getRegisterInfo } from '../utils';\nimport { ERROR_CODE, INITIAL_PLUGIN_REPORT_PARAMS } from '../const';\nimport { PluginDocs } from '../../plugin-docs';\nimport { type AuthOption, findAuthTypeItem, getAuthOptions } from './utils';\nimport { type ConfirmFormProps } from './interface';\nimport {\n  AuthTypeField,\n  ExtItems,\n  HeaderListField,\n  PluginDescField,\n  PluginNameField,\n  PluginUrlField,\n  ServiceField,\n} from './fields';\n\nimport s from './index.module.less';\n\ninterface PluginInfoConfirmProps {\n  visible: boolean;\n  importInfo?: {\n    metaInfo?: PluginMetaInfo;\n    aiPlugin?: string;\n    openAPI?: string;\n    extra?: {\n      reportParams?: ParamsTypeDefine[EVENT_NAMES.create_plugin_front];\n    };\n  };\n  disabled?: boolean;\n  onCancel?: () => void;\n  onSuccess?: (pluginInfo?: { plugin_id?: string }) => void;\n  onError?: () => void;\n  projectId?: string;\n}\n\nconst INITIAL_FORM_VALUES = {\n  headerList: [{ name: 'User-Agent', value: 'Coze/1.0' }],\n};\n\n/**\nFile import plugin confirmation information pop-up window, currently very similar to ordinary creation and import, the call interface is different.\nAt present, I feel that this confirmation form is not very friendly, and I am not sure about the optimization form in the future, so a new separate file is created to prevent contamination of bot-form-edit.\n*/\n\n// eslint-disable-next-line complexity\nexport const PluginInfoConfirm: React.FC<PluginInfoConfirmProps> = props => {\n  const {\n    onCancel,\n    importInfo,\n    visible,\n    onSuccess,\n    disabled = false,\n    projectId,\n  } = props;\n\n  const [authOption, setAuthOption] = useState<AuthOption[]>([]);\n  // Compliance audit results\n  const [isValidCheckResult, setIsValidCheckResult] = useState(true);\n\n  const [extItems, setExtItems] = useState<OauthTccOpt[]>([]);\n\n  const [submitting, setSubmitting] = useState(false);\n\n  const header = importInfo?.metaInfo?.common_params?.[4] || [];\n  const initialFormValues = importInfo\n    ? { ...importInfo?.metaInfo, headerList: header || [] }\n    : INITIAL_FORM_VALUES;\n\n  const formApi = useRef<FormApi<ConfirmFormProps>>();\n\n  const formStateValues = formApi.current?.getFormState()?.values;\n\n  const spaceId = useSpaceStore(store => store.space.id);\n\n  useEffect(() => {\n    (async () => {\n      const res = await DeveloperApi.GetOAuthSchema();\n      const authOptions = getAuthOptions(res?.oauth_schema);\n      setAuthOption(authOptions);\n    })();\n  }, []);\n\n  useEffect(() => {\n    if (importInfo) {\n      //update plugin\n      setExtItems(\n        findAuthTypeItem(\n          authOption,\n          importInfo.metaInfo?.auth_type?.at(-1) || 0,\n        )?.items || [],\n      );\n    } else {\n      setExtItems([]);\n    }\n  }, [authOption, importInfo]);\n\n  // eslint-disable-next-line complexity\n  const confirmBtn = async () => {\n    await formApi.current?.validate();\n    const formValues = formApi.current?.getValues();\n\n    if (!formValues) {\n      return;\n    }\n\n    const { openAPI, aiPlugin } = getEditRegisterInfo(formValues);\n\n    try {\n      setSubmitting(true);\n      const { data } = await PluginDevelopApi.RegisterPlugin(\n        {\n          ai_plugin: aiPlugin,\n          openapi: openAPI,\n          plugin_type: PluginType.PLUGIN,\n          client_id: formValues?.client_id,\n          client_secret: formValues?.client_secret,\n          service_token: formValues?.service_token,\n          import_from_file: true,\n          space_id: spaceId,\n          project_id: projectId,\n        },\n        {\n          __disableErrorToast: true,\n        },\n      );\n\n      UIToast.success(I18n.t('plugin_imported_successfully'));\n\n      onCancel?.();\n      await onSuccess?.({ plugin_id: data?.plugin_id });\n\n      sendTeaEvent(EVENT_NAMES.create_plugin_front, {\n        ...(importInfo?.extra?.reportParams || INITIAL_PLUGIN_REPORT_PARAMS),\n        status: 0,\n      });\n    } catch (error) {\n      // @ts-expect-error -- linter-disable-autofix\n      const { code, msg } = error;\n      sendTeaEvent(EVENT_NAMES.create_plugin_front, {\n        ...(importInfo?.extra?.reportParams || INITIAL_PLUGIN_REPORT_PARAMS),\n        status: 1,\n        error_message: msg,\n      });\n      if (Number(code) === ERROR_CODE.SAFE_CHECK) {\n        setIsValidCheckResult(false);\n      } else {\n        UIToast.error({\n          content: withSlardarIdButton(msg),\n        });\n      }\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const getEditRegisterInfo = (formValues: ConfirmFormProps) => {\n    const { headerList, plugin_uri = [], ...extraValues } = formValues;\n    const json: Record<string, string> = {};\n    extItems?.forEach(item => {\n      if (item.key in formValues) {\n        // @ts-expect-error -- linter-disable-autofix\n        json[item.key] = formValues[item.key];\n      }\n    });\n\n    const metaParams: PluginMetaInfo = {\n      ...extraValues,\n      oauth_info: JSON.stringify(json),\n      icon: { uri: plugin_uri[0]?.uid },\n      common_params: {\n        [ParameterLocation.Header]: formValues?.headerList || [],\n        [ParameterLocation.Body]: [],\n        [ParameterLocation.Path]: [],\n        [ParameterLocation.Query]: [],\n      },\n    };\n\n    const params = getRegisterInfo(metaParams, {\n      openAPI: importInfo?.openAPI,\n      aiPlugin: importInfo?.aiPlugin,\n    });\n\n    return params;\n  };\n\n  useEffect(() => {\n    if (!isValidCheckResult) {\n      setIsValidCheckResult(true);\n    }\n  }, [formStateValues?.name || formStateValues?.desc]);\n\n  return (\n    <>\n      {visible ? (\n        <UIModal\n          type=\"action-small\"\n          title={I18n.t('confirm_plugin_information')}\n          visible={visible}\n          onCancel={() => onCancel?.()}\n          footer={\n            !disabled && (\n              <div>\n                {!isValidCheckResult && (\n                  <div className={s['error-msg-box']}>\n                    <span className={s['error-msg']}>\n                      {I18n.t('plugin_create_modal_safe_error')}\n                    </span>\n                  </div>\n                )}\n                <div>\n                  <UIButton\n                    type=\"tertiary\"\n                    onClick={() => {\n                      onCancel?.();\n                    }}\n                  >\n                    {I18n.t('create_plugin_modal_button_cancel')}\n                  </UIButton>\n                  <UIButton\n                    type=\"primary\"\n                    theme=\"solid\"\n                    loading={submitting}\n                    onClick={() => {\n                      confirmBtn();\n                    }}\n                  >\n                    {I18n.t('create_plugin_modal_button_confirm')}\n                  </UIButton>\n                </div>\n              </div>\n            )\n          }\n        >\n          <Form<typeof initialFormValues>\n            // @ts-expect-error -- linter-disable-autofix\n            getFormApi={api => (formApi.current = api)}\n            showValidateIcon={false}\n            initValues={{ ...(initialFormValues || {}) }}\n            className={s['upload-form']}\n          >\n            {({ values }) => (\n              <>\n                {/* plugin avatar */}\n                <PictureUpload\n                  noLabel\n                  disabled={disabled}\n                  fieldClassName={s['upload-field']}\n                  field=\"plugin_uri\"\n                  iconType={IconType.Plugin}\n                  fileBizType={FileBizType.BIZ_PLUGIN_ICON}\n                />\n                {/* Plugin Name/Plugin Description/Plugin URL */}\n                <PluginNameField disabled={disabled} />\n                <PluginDescField disabled={disabled} />\n                <PluginUrlField disabled={true} />\n                {/* Plugin Header */}\n                <HeaderListField disabled={disabled} />\n                {/* Authorization method */}\n                <AuthTypeField\n                  disabled={disabled}\n                  authOption={authOption}\n                  onChange={val => {\n                    setExtItems(\n                      findAuthTypeItem(authOption, val?.at(-1))?.items || [],\n                    );\n                  }}\n                />\n                {/* Authorization method-Service */}\n                {values.auth_type.at(-1) === 1 && (\n                  <ServiceField disabled={disabled} />\n                )}\n                <ExtItems disabled={disabled} extItems={extItems} />\n                {/* agreement */}\n                {!disabled && (\n                  <Space spacing={8} className={s['footer-draft']}>\n                    <IconInfoCircle\n                      style={{\n                        fontSize: '16px',\n                        color: '#4D53E8',\n                      }}\n                    />\n                    <span>\n                      {I18n.t('plugin_create_draft_desc')}\n                      <PluginDocs />\n                    </span>\n                  </Space>\n                )}\n              </>\n            )}\n          </Form>\n        </UIModal>\n      ) : null}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { forwardRef, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  type RenderFileItemProps,\n  type FileItem,\n  type UploadProps,\n} from '@coze-arch/bot-semi/Upload';\nimport { type TextAreaProps } from '@coze-arch/bot-semi/Input';\nimport {\n  Progress,\n  TextArea,\n  Typography,\n  UIButton,\n  UIIconButton,\n  UIToast,\n  Upload,\n  Image,\n} from '@coze-arch/bot-semi';\nimport { IconDeleteOutline, IconError } from '@coze-arch/bot-icons';\n\nimport YAMLImg from '@/assets/yaml.png';\nimport JsonImg from '@/assets/json-file.png';\n\nimport { getContent, getFileExtension } from './utils';\nimport { ACCEPT_EXT, ACCEPT_FORMAT } from './const';\n\nimport styles from './import-content.module.less';\nexport interface FileUploadProps {\n  onUpload: (content?: string) => void;\n  disabled?: boolean;\n}\n\ntype SemiTextAreaProps = Omit<TextAreaProps, 'forwardRef'>;\ninterface RawTextProps extends SemiTextAreaProps {\n  onChange: (val?: string) => void;\n}\n\nexport const FileUpload = ({ onUpload, disabled }: FileUploadProps) => {\n  const [fileList, setFileList] = useState<FileItem[]>([]);\n\n  const customRequest: UploadProps['customRequest'] = async options => {\n    const { onSuccess, file, onError, onProgress } = options;\n\n    if (typeof file === 'string') {\n      return;\n    }\n\n    try {\n      const { name, fileInstance } = file;\n\n      if (fileInstance) {\n        const extension = getFileExtension(name);\n        if (!ACCEPT_FORMAT.includes(extension)) {\n          return;\n        }\n        const result = await getContent(fileInstance, onProgress);\n        onSuccess(result);\n      }\n    } catch (error) {\n      logger.error({\n        eventName: 'fail_to_read_file',\n        // @ts-expect-error -- linter-disable-autofix\n        error,\n      });\n      onError({ status: 0 });\n    }\n  };\n\n  const renderFileItem = (renderFileItemProps: RenderFileItemProps) => {\n    const { name, onRemove, onRetry, percent, status } = renderFileItemProps;\n    const renderProgress = () => {\n      switch (status) {\n        case 'success':\n          return (\n            <Typography.Text className={styles['upload-text']} ellipsis>\n              {I18n.t('file_upload_success')}\n            </Typography.Text>\n          );\n        case 'uploadFail':\n        case 'validateFail':\n          return (\n            <>\n              <IconError />\n              <UIButton\n                theme=\"borderless\"\n                className=\"ml-[8px]\"\n                onClick={onRetry}\n              >\n                {I18n.t('retry')}\n              </UIButton>\n            </>\n          );\n        case 'uploading':\n        case 'wait':\n        case 'validating':\n        default:\n          return (\n            <div className={classNames('w-[90px]')}>\n              <Progress percent={percent} />\n            </div>\n          );\n      }\n    };\n\n    return (\n      <div\n        className={classNames(\n          styles['upload-file-item'],\n          disabled && styles.disabled,\n        )}\n      >\n        <Image\n          preview={false}\n          className={styles['file-icon']}\n          src={getFileExtension(name) === 'yaml' ? YAMLImg : JsonImg}\n        />\n        <Typography.Text\n          className={styles.text}\n          ellipsis={{ showTooltip: { opts: { content: name } } }}\n        >\n          {name}\n        </Typography.Text>\n        {<div className={styles.progress}>{renderProgress()}</div>}\n        <UIIconButton\n          icon={\n            <IconDeleteOutline\n              className={styles['delete-icon']}\n              onClick={onRemove}\n            />\n          }\n        />\n      </div>\n    );\n  };\n\n  return (\n    <Upload\n      accept={ACCEPT_EXT.join(',')}\n      action=\"\"\n      onAcceptInvalid={() => {\n        UIToast.warning(I18n.t('file_format_not_supported'));\n      }}\n      onSuccess={res => {\n        onUpload(res);\n      }}\n      disabled={disabled}\n      fileList={fileList}\n      onChange={({ fileList: list }) => {\n        setFileList(list);\n        if (!list.length) {\n          // Clear content\n          onUpload();\n        }\n      }}\n      className={classNames(\n        styles['upload-file-area'],\n        fileList.length && styles['drag-area-disabled'],\n      )}\n      dragMainText={I18n.t('click_upload_or_drag_files')}\n      draggable={true}\n      dragSubText={\n        <>\n          <span>{I18n.t('supports_uploading_json_or_yaml_files')}</span>\n          <a\n            href={\n              IS_OVERSEA\n                ? '/open/docs/guides/plugin_import'\n                : '/open/docs/guides/import'\n            }\n            target=\"_blank\"\n            onClick={e => e.stopPropagation()}\n          >\n            {I18n.t('view_detailed_information')}\n          </a>\n        </>\n      }\n      renderFileItem={renderFileItem}\n      limit={1}\n      customRequest={customRequest}\n    />\n  );\n};\n\nexport const RawText = forwardRef<HTMLTextAreaElement | null, RawTextProps>(\n  (props, ref) => {\n    const { onChange, ...extraProps } = props;\n    return (\n      <TextArea\n        placeholder={I18n.t('enter_raw_content_or_url')}\n        rows={17}\n        {...extraProps}\n        ref={ref}\n        onChange={value => {\n          onChange(value.trim());\n        }}\n        className={styles['text-area']}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, useRef } from 'react';\n\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  UIButton,\n  UIModal,\n  RadioGroup,\n  Radio,\n  Typography,\n} from '@coze-arch/bot-semi';\n\nimport { isValidURL, customService } from './utils';\nimport { FileUpload, RawText } from './import-content';\n\nimport styles from './import-modal.module.less';\n\nexport enum ImportType {\n  File = 'File',\n  Text = 'Text',\n}\n\nenum ImportDetailType {\n  File = 'file',\n  FileUrl = 'file_url',\n  Text = 'raw_txt',\n}\nexport interface ImportData {\n  type?: ImportDetailType;\n  content?: string;\n}\n\nexport interface ImportModalProps {\n  visible: boolean;\n  title?: React.ReactNode;\n  onCancel?: () => void;\n  onOk?: (\n    data: ImportData,\n  ) => Promise<{ success?: boolean; result?: unknown; errMsg?: string }>;\n}\n\nexport const ImportModal: React.FC<ImportModalProps> = props => {\n  const { onCancel, visible, onOk, title } = props;\n  const [importType, setImportType] = useState(ImportType.File);\n  const [content, setContent] = useState<string>();\n  const [errMsg, setErrMsg] = useState<string>();\n  const [loading, setLoading] = useState(false);\n\n  const textAreaRef = useRef<HTMLTextAreaElement | null>(null);\n\n  const handleContent = (text?: string) => {\n    setContent(text);\n  };\n\n  const reset = () => {\n    setImportType(ImportType.File);\n    setContent(undefined);\n  };\n\n  const handleParse = async () => {\n    setLoading(true);\n    setErrMsg(undefined);\n    let originContent = content;\n    let type: ImportDetailType =\n      importType === ImportType.Text\n        ? ImportDetailType.Text\n        : ImportDetailType.File;\n    if (importType === ImportType.Text && isValidURL(content)) {\n      try {\n        const res = await customService(content || '');\n        originContent = res as unknown as string;\n        type = ImportDetailType.FileUrl;\n      } catch (e) {\n        // @ts-expect-error -- linter-disable-autofix\n        logger.error({ error: e, eventName: 'fetch_url_resource_fail' });\n        setErrMsg(I18n.t('unable_to_access_input_url'));\n        setLoading(false);\n        return Promise.reject(e);\n      }\n    }\n    try {\n      const res = await onOk?.({ type, content: originContent });\n      if (!res?.success) {\n        setErrMsg(res?.errMsg);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderFooter = () => (\n    <UIButton\n      theme=\"solid\"\n      type=\"primary\"\n      disabled={!content}\n      onClick={handleParse}\n      loading={loading}\n    >\n      {I18n.t('next')}\n    </UIButton>\n  );\n\n  const renderErrMsg = () =>\n    errMsg ? (\n      <Typography.Text\n        ellipsis={{\n          showTooltip: {\n            opts: { content: errMsg },\n          },\n        }}\n      >\n        {errMsg}\n      </Typography.Text>\n    ) : null;\n\n  useEffect(() => {\n    errMsg && setErrMsg(undefined);\n  }, [content]);\n\n  useEffect(() => {\n    if (visible) {\n      reset();\n    }\n  }, [visible]);\n\n  useEffect(() => {\n    if (importType === ImportType.Text && textAreaRef.current) {\n      textAreaRef?.current?.focus();\n    }\n  }, [importType]);\n\n  return (\n    <>\n      <UIModal\n        afterClose={reset}\n        keepDOM={false}\n        type=\"action-small\"\n        title={title}\n        visible={visible}\n        onCancel={onCancel}\n        onOk={handleParse}\n        footer={renderFooter()}\n        className={styles['import-modal']}\n      >\n        <div className=\"min-h-[472px]\">\n          <div className=\"flex justify-center mb-[24px]\">\n            <RadioGroup\n              onChange={e => {\n                setImportType(e.target.value);\n                setContent(undefined);\n              }}\n              type=\"button\"\n              buttonSize=\"middle\"\n              defaultValue={importType}\n              disabled={loading}\n              className={styles['radio-group']}\n            >\n              <Radio value={ImportType.File}>{I18n.t('local_file')}</Radio>\n              <Radio value={ImportType.Text}>{I18n.t('url_raw_data')}</Radio>\n            </RadioGroup>\n          </div>\n          <div>\n            {importType === ImportType.File ? (\n              <FileUpload onUpload={handleContent} disabled={loading} />\n            ) : (\n              <RawText\n                onChange={handleContent}\n                disabled={loading}\n                ref={textAreaRef}\n              />\n            )}\n          </div>\n          <div className={styles['error-msg']}> {renderErrMsg()}</div>\n        </div>\n      </UIModal>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { useEffect, useRef, useState } from 'react';\n\nimport { type AxiosResponse } from 'axios';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { withSlardarIdButton } from '@coze-studio/bot-utils';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  EVENT_NAMES,\n  sendTeaEvent,\n  type ParamsTypeDefine,\n} from '@coze-arch/bot-tea';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { UIToast, UIModal } from '@coze-arch/bot-semi';\nimport { IconWarningInfo } from '@coze-arch/bot-icons';\nimport { type ApiError } from '@coze-arch/bot-http';\nimport {\n  type Convert2OpenAPIRequest,\n  type BatchCreateAPIRequest,\n  type BatchCreateAPIResponse,\n  type Convert2OpenAPIResponse,\n} from '@coze-arch/bot-api/plugin_develop';\nimport {\n  SpaceType,\n  type PluginMetaInfo,\n} from '@coze-arch/bot-api/developer_api';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\n\nimport {\n  getImportFormatType,\n  getInitialPluginMetaInfo,\n  isDuplicatePathErrorResponseData,\n  parsePluginInfo,\n} from './utils';\nimport { showMergeTool } from './show-merge-tool';\nimport { PluginInfoConfirm } from './plugin-info-confirm';\nimport { type ImportData, ImportModal } from './import-modal';\nimport {\n  ERROR_CODE,\n  INITIAL_PLUGIN_REPORT_PARAMS,\n  INITIAL_TOOL_REPORT_PARAMS,\n  getEnv,\n} from './const';\ninterface ImportModalProps {\n  visible: boolean;\n  onCancel?: () => void;\n  onSuccess?: (pluginInfo?: { plugin_id?: string }) => void;\n  projectId?: string;\n}\n\nexport type ImportPluginModalProps = ImportModalProps;\nexport interface ImportToolModalProps extends ImportModalProps {\n  pluginInfo?: {\n    pluginName?: string;\n    pluginUrl?: string;\n    pluginID?: string;\n    pluginDesc?: string;\n    editVersion?: number;\n  };\n}\n\ninterface ImportPluginInfo {\n  aiPlugin?: string;\n  openAPI?: string;\n  metaInfo?: PluginMetaInfo;\n}\n\nexport const ImportPluginModal: React.FC<ImportPluginModalProps> = props => {\n  const { visible } = props;\n  return visible ? <ImportPluginModalContent {...props} /> : null;\n};\n\nexport const ImportPluginModalContent: React.FC<\n  ImportPluginModalProps\n> = props => {\n  const { onCancel, visible, onSuccess, projectId } = props;\n  const [importPluginInfo, setImportPluginInfo] = useState<ImportPluginInfo>();\n\n  const { id: spaceId, space_type } = useSpaceStore(store => store.space);\n\n  const reportParams = useRef<\n    ParamsTypeDefine[EVENT_NAMES.create_plugin_front]\n  >(INITIAL_PLUGIN_REPORT_PARAMS);\n\n  const isPersonal = space_type === SpaceType.Personal;\n\n  useEffect(() => {\n    reportParams.current = {\n      ...reportParams.current,\n      environment: getEnv(),\n      workspace_id: spaceId || '',\n      workspace_type: isPersonal ? 'personal_workspace' : 'team_workspace',\n      status: 1,\n      create_type: 'import',\n    };\n  }, [spaceId, isPersonal]);\n\n  const convert2OpenAPI = async (\n    req: Convert2OpenAPIRequest,\n  ): Promise<{ success: boolean; errMsg?: string }> => {\n    try {\n      const { openapi, ai_plugin, plugin_data_format } =\n        await PluginDevelopApi.Convert2OpenAPI(req, {\n          __disableErrorToast: true,\n        });\n\n      // Parse string\n      const result = parsePluginInfo({\n        aiPlugin: ai_plugin,\n        openAPI: openapi,\n      });\n      const metaImportPluginInfo = getInitialPluginMetaInfo(result);\n\n      setImportPluginInfo({\n        aiPlugin: ai_plugin,\n        openAPI: openapi,\n        metaInfo: metaImportPluginInfo,\n      });\n\n      reportParams.current = {\n        ...reportParams.current,\n        import_format_type: getImportFormatType(plugin_data_format),\n        import_tools_count: Object.entries(result?.openAPI?.paths || {}).length,\n      };\n\n      return {\n        success: true,\n      };\n    } catch (e) {\n      const { msg, code, response } = e as ApiError;\n      // @ts-expect-error -- linter-disable-autofix\n      logger.error({ error: e, eventName: 'plugin_convert_openapi_fail' });\n      reportParams.current = {\n        ...reportParams.current,\n        import_format_type: getImportFormatType(\n          (response as unknown as AxiosResponse<Convert2OpenAPIResponse>)?.data\n            ?.plugin_data_format,\n        ),\n        import_tools_count: 0,\n      };\n      sendTeaEvent(EVENT_NAMES.create_plugin_front, {\n        ...reportParams.current,\n        status: 1,\n        error_message: msg,\n      });\n      if (\n        Number(code) === ERROR_CODE.DUP_PATH ||\n        isDuplicatePathErrorResponseData(response?.data)\n      ) {\n        const handleMerge = async () => {\n          const { errMsg, success } = await convert2OpenAPI({\n            ...req,\n            merge_same_paths: true,\n          });\n          if (!success) {\n            UIToast.error({\n              content: withSlardarIdButton(errMsg || I18n.t('error')),\n            });\n            return Promise.reject(errMsg);\n          }\n        };\n        showMergeTool({\n          onOk: handleMerge,\n          duplicateInfos: (\n            response as unknown as AxiosResponse<Convert2OpenAPIResponse>\n          )?.data?.duplicate_api_infos,\n        });\n        return { success: false, errMsg: '' };\n      } else {\n        return {\n          success: false,\n          errMsg: msg || I18n.t('error'),\n        };\n      }\n    }\n  };\n\n  const handleConvertOpenAPI = async ({ content, type }: ImportData) => {\n    reportParams.current = {\n      ...reportParams.current,\n      import_way_type: type,\n    };\n    return await convert2OpenAPI({\n      data: content || '',\n      space_id: spaceId,\n      merge_same_paths: false,\n    });\n  };\n\n  return (\n    <>\n      <ImportModal\n        title={I18n.t('import_plugin')}\n        visible={visible}\n        onCancel={onCancel}\n        onOk={handleConvertOpenAPI}\n      />\n      {importPluginInfo ? (\n        <PluginInfoConfirm\n          visible={!!importPluginInfo}\n          projectId={projectId}\n          onCancel={() => setImportPluginInfo(undefined)}\n          importInfo={{\n            metaInfo: importPluginInfo.metaInfo,\n            openAPI: importPluginInfo.openAPI,\n            aiPlugin: importPluginInfo.aiPlugin,\n            extra: { reportParams: reportParams.current },\n          }}\n          onSuccess={data => {\n            onCancel?.();\n            onSuccess?.(data);\n          }}\n        />\n      ) : null}\n    </>\n  );\n};\n\nexport const ImportToolModal: React.FC<ImportToolModalProps> = props => {\n  const { visible } = props;\n  return visible ? <ImportToolModalContent {...props} /> : null;\n};\n\nexport const ImportToolModalContent: React.FC<ImportToolModalProps> = props => {\n  const { onCancel, visible, onSuccess, pluginInfo } = props;\n\n  const reportParams = useRef<\n    ParamsTypeDefine[EVENT_NAMES.create_plugin_tool_front]\n  >(INITIAL_TOOL_REPORT_PARAMS);\n\n  const { id: spaceId, space_type } = useSpaceStore(store => store.space);\n  const isPersonal = space_type === SpaceType.Personal;\n\n  const userInfo = userStoreService.useUserInfo();\n\n  useEffect(() => {\n    reportParams.current = {\n      ...reportParams.current,\n      environment: getEnv(),\n      workspace_id: spaceId || '',\n      workspace_type: isPersonal ? 'personal_workspace' : 'team_workspace',\n      status: 1,\n      create_type: 'import',\n      plugin_id: pluginInfo?.pluginID || '',\n    };\n  }, [pluginInfo?.pluginID, spaceId, isPersonal]);\n\n  const handleBatchImportTool = async (req?: BatchCreateAPIRequest) => {\n    try {\n      const resp = await PluginDevelopApi.BatchCreateAPI(req, {\n        __disableErrorToast: true,\n      });\n      const toolsCount = req?.replace_same_paths\n        ? req?.paths_to_replace?.length\n        : resp?.paths_created?.length;\n      sendTeaEvent(EVENT_NAMES.create_plugin_tool_front, {\n        ...reportParams.current,\n        status: 0,\n        import_tools_count: toolsCount || 0,\n      });\n      if (resp && !resp?.paths_duplicated?.length) {\n        UIToast.success(\n          req?.replace_same_paths\n            ? I18n.t('plugin_tool_replace_success')\n            : I18n.t('plugin_tool_import_succes'),\n        );\n        onCancel?.();\n        onSuccess?.();\n      }\n    } catch (e) {\n      const { code, response } = e as ApiError;\n\n      if (\n        Number(code) !== ERROR_CODE.DUP_PATH &&\n        !isDuplicatePathErrorResponseData(response?.data)\n      ) {\n        return Promise.reject(e);\n      }\n\n      sendTeaEvent(EVENT_NAMES.create_plugin_tool_front, {\n        ...reportParams.current,\n        status: 0,\n        import_tools_count:\n          (response as unknown as AxiosResponse<BatchCreateAPIResponse>)?.data\n            ?.paths_created?.length || 0,\n      });\n      handleDupPath(\n        req,\n        (response as unknown as AxiosResponse<BatchCreateAPIResponse>)?.data,\n      );\n    }\n  };\n\n  const handleDupPath = (\n    req?: BatchCreateAPIRequest,\n    resp?: BatchCreateAPIResponse,\n  ) => {\n    const { paths_created = [], paths_duplicated = [] } = resp || {};\n    const importedLength = paths_created.length;\n    const duplicatedLength = paths_duplicated.length;\n    const failedContent = I18n.t('failed_to_import_tool', {\n      num: duplicatedLength,\n    });\n    const successContent = I18n.t('tools_imported_successfully', {\n      num: importedLength,\n    });\n    UIModal.warning({\n      title: importedLength\n        ? `${successContent}, ${failedContent}`\n        : failedContent,\n      content: duplicatedLength\n        ? I18n.t('plugin_tool_exists_tips', { num: duplicatedLength })\n        : null,\n      okText: I18n.t('replace'),\n      cancelText: I18n.t('Cancel'),\n      centered: true,\n      icon: <IconWarningInfo />,\n      okButtonProps: {\n        type: 'warning',\n      },\n      onOk: async () => {\n        const batchCreateReq: BatchCreateAPIRequest = {\n          ...req,\n          replace_same_paths: true,\n          paths_to_replace: paths_duplicated,\n        };\n        try {\n          await handleBatchImportTool(batchCreateReq);\n        } catch (err) {\n          const { msg: errMsg } = err as ApiError;\n          UIToast.error({\n            content: withSlardarIdButton(errMsg || I18n.t('error')),\n          });\n          sendTeaEvent(EVENT_NAMES.create_plugin_tool_front, {\n            ...reportParams.current,\n            import_tools_count: 0,\n            status: 1,\n            error_message: errMsg || '',\n          });\n        }\n      },\n      onCancel: importedLength\n        ? async () => {\n            onCancel?.();\n            await onSuccess?.();\n          }\n        : undefined,\n    });\n  };\n\n  const convertOpenAPI = async (req: Convert2OpenAPIRequest) =>\n    await PluginDevelopApi.Convert2OpenAPI(\n      { ...req, plugin_description: pluginInfo?.pluginDesc },\n      {\n        __disableErrorToast: true,\n      },\n    );\n\n  const batchImport = async (req: Convert2OpenAPIRequest) => {\n    try {\n      const resp = await convertOpenAPI(req);\n\n      reportParams.current = {\n        ...reportParams.current,\n        import_format_type: getImportFormatType(resp?.plugin_data_format),\n      };\n      const batchCreateReq: BatchCreateAPIRequest = {\n        plugin_id: pluginInfo?.pluginID,\n        ai_plugin: resp?.ai_plugin,\n        openapi: resp?.openapi,\n        replace_same_paths: false,\n        space_id: spaceId,\n        dev_id: userInfo?.user_id_str,\n        edit_version: pluginInfo?.editVersion,\n      };\n\n      await handleBatchImportTool(batchCreateReq);\n      return { success: true };\n    } catch (e) {\n      const { msg, code, response } = e as ApiError;\n      // @ts-expect-error -- linter-disable-autofix\n      logger.error({ error: e, eventName: 'batch_create_fail' });\n\n      reportParams.current = {\n        ...reportParams.current,\n        import_format_type: getImportFormatType(\n          (response as unknown as AxiosResponse<Convert2OpenAPIResponse>)?.data\n            ?.plugin_data_format,\n        ),\n      };\n      sendTeaEvent(EVENT_NAMES.create_plugin_tool_front, {\n        ...reportParams.current,\n        import_tools_count: 0,\n        status: 1,\n        error_message: msg || '',\n      });\n\n      if (\n        Number(code) === ERROR_CODE.DUP_PATH ||\n        isDuplicatePathErrorResponseData(response?.data)\n      ) {\n        const handleMerge = async () => {\n          const { success, errMsg } = await batchImport({\n            ...req,\n            merge_same_paths: true,\n          });\n\n          if (!success) {\n            UIToast.error({\n              content: withSlardarIdButton(errMsg || I18n.t('error')),\n            });\n            return Promise.reject(e);\n          }\n        };\n\n        showMergeTool({\n          onOk: handleMerge,\n          duplicateInfos: (\n            response as unknown as AxiosResponse<Convert2OpenAPIResponse>\n          )?.data?.duplicate_api_infos,\n        });\n        return { success: false };\n      } else {\n        return {\n          success: false,\n          errMsg: msg || I18n.t('error'),\n        };\n      }\n    }\n  };\n\n  const handleImport = async (importData?: ImportData) => {\n    const { content, type } = importData || {};\n    reportParams.current = {\n      ...reportParams.current,\n      import_way_type: type,\n    };\n    const res = await batchImport({\n      data: content || '',\n      plugin_name: pluginInfo?.pluginName,\n      plugin_url: pluginInfo?.pluginUrl,\n      merge_same_paths: false,\n      space_id: spaceId,\n    });\n\n    return res;\n  };\n\n  return (\n    <ImportModal\n      title={I18n.t('import_plugin_tool')}\n      visible={visible}\n      onCancel={onCancel}\n      onOk={handleImport}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/coze-design';\n\nexport const PluginDocs = () => {\n  const docsHref = useMemo(() => {\n    const DRAFT_CN = {\n      'zh-CN': '/docs/guides/plugin',\n      en: '/docs/en_guides/en_plugin',\n    };\n    const DRAFT_OVERSEA = {\n      'zh-CN': '',\n      en: '',\n    };\n    // @ts-expect-error -- linter-disable-autofix\n    return IS_OVERSEA ? DRAFT_OVERSEA[I18n.language] : DRAFT_CN[I18n.language];\n  }, []);\n\n  return !IS_OVERSEA ? (\n    <Typography.Text\n      link={{\n        href: docsHref,\n        target: '_blank',\n      }}\n      fontSize=\"12px\"\n    >\n      {I18n.t('plugin_create_guide_link')}\n    </Typography.Text>\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\n\ninterface RiskStore {\n  pluginRiskIsRead: boolean;\n  toolHiddenModeNewbieGuideIsRead: boolean;\n}\n\ninterface RiskAction {\n  reset: () => void;\n  setPluginRiskIsRead: (flag: boolean) => void;\n  setToolHiddenModeNewbieGuideIsRead: (flag: boolean) => void;\n}\n\nconst initialStore: RiskStore = {\n  pluginRiskIsRead: true,\n  toolHiddenModeNewbieGuideIsRead: true,\n  // Support for expanding other risk alerts...\n};\n\nexport const useRiskWarningStore = create<RiskStore & RiskAction>()(\n  devtools(\n    set => ({\n      ...initialStore,\n      reset: () => {\n        set(initialStore);\n      },\n      setPluginRiskIsRead: flag => {\n        set({ pluginRiskIsRead: flag });\n      },\n      setToolHiddenModeNewbieGuideIsRead: flag => {\n        set({\n          toolHiddenModeNewbieGuideIsRead: flag,\n        });\n      },\n    }),\n    {\n      enabled: IS_DEV_MODE,\n      name: 'botStudio.riskWarningStore',\n    },\n  ),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Modal } from '@coze-arch/bot-semi';\nimport {\n  IconApiOutlined,\n  IconCommunityTabOutlined,\n  IconDiscussOutlined,\n} from '@coze-arch/bot-icons';\nimport { RiskAlertType } from '@coze-arch/bot-api/playground_api';\nimport { PlaygroundApi } from '@coze-arch/bot-api';\n\nimport { useRiskWarningStore } from './store';\n\nimport styles from './index.module.less';\nexport interface UsePluginRiskReturnValue {\n  node: JSX.Element;\n  open: () => void;\n  close: () => void;\n}\nconst ContentMap = [\n  {\n    icon: <IconCommunityTabOutlined />,\n    text: I18n.t('plugin_quote_tip_1'),\n  },\n  {\n    icon: <IconDiscussOutlined />,\n    text: I18n.t('plugin_quote_tip_2'),\n  },\n  {\n    icon: <IconApiOutlined />,\n    text: I18n.t('plugin_quote_tip_3'),\n  },\n];\n\nexport const handlePluginRiskWarning = () => {\n  const { pluginRiskIsRead, setPluginRiskIsRead } =\n    useRiskWarningStore.getState();\n\n  const handleClose = () => {\n    PlaygroundApi.UpdateUserConfig({\n      risk_alert_type: RiskAlertType.Plugin,\n    });\n  };\n\n  if (!pluginRiskIsRead) {\n    setPluginRiskIsRead(true);\n\n    Modal.warning({\n      icon: null,\n      title: I18n.t('About_Plugins_tip'),\n      content: (\n        <div className={styles['modal-wrap']}>\n          {ContentMap.map(item => (\n            <div className={styles['modal-item']}>\n              {item.icon}\n              <span className={styles['modal-text']}>{item.text}</span>\n            </div>\n          ))}\n        </div>\n      ),\n      onOk: handleClose,\n      onCancel: handleClose,\n      hasCancel: false,\n      maskClosable: false,\n      className: styles['ui-modal'],\n      okText: I18n.t('Confirm'),\n      okButtonProps: {\n        style: {\n          minWidth: '96px',\n        },\n      },\n    });\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Fragment } from 'react';\n\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tooltip, Typography } from '@coze-arch/coze-design';\nimport { type ExtInfoText } from '@coze-studio/plugin-shared';\n\ninterface InfoPopoverProps {\n  data: ExtInfoText[];\n}\n\nexport const InfoPopover: React.FC<InfoPopoverProps> = props => {\n  const { data } = props;\n\n  return (\n    <Tooltip\n      showArrow\n      theme=\"dark\"\n      position=\"right\"\n      arrowPointAtCenter\n      className=\"!max-w-[320px]\"\n      content={data?.map((item, index) => (\n        <Fragment key={`${item.type}${index}`}>\n          {/* bold title */}\n          {item.type === 'title' ? (\n            <Typography.Text fontSize=\"14px\" className=\"dark coz-fg-primary\">\n              {item.text}\n            </Typography.Text>\n          ) : null}\n          {/* Text */}\n          {item.type === 'text' ? (\n            <Typography.Paragraph\n              fontSize=\"12px\"\n              className=\"dark coz-fg-secondary\"\n            >\n              {item.text}\n            </Typography.Paragraph>\n          ) : null}\n          {/* line feed */}\n          {item.type === 'br' ? <div className=\"h-[8px]\" /> : null}\n          {/* Example, display inside the border */}\n          {item.type === 'demo' ? (\n            <div className=\"dark mt-[4px] p-[10px] border border-solid coz-stroke-primary\">\n              <Typography.Paragraph\n                fontSize=\"12px\"\n                className=\"dark coz-fg-secondary\"\n              >\n                {item.text}\n              </Typography.Paragraph>\n            </div>\n          ) : null}\n        </Fragment>\n      ))}\n    >\n      <IconCozInfoCircle className=\"coz-fg-secondary\" />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  type AssistParameterType,\n  ParameterLocation,\n  ParameterType,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { type ExtInfoText } from '@coze-studio/plugin-shared';\nimport { FileTypeEnum } from '@coze-studio/file-kit/logic';\n\nimport { type APIParameterRecord } from './types/params';\n\nexport const childrenRecordName = 'sub_parameters'; // sub-node name\nexport const ROWKEY = 'id'; // unique device identifier\nexport const ARRAYTAG = '[Array Item]'; // Array element identifier\nexport const ROOTTAG = '[Root Item]'; // Root is the identifier of the array\nexport const STARTNODE = 0;\nexport const REQUESTNODE = 1;\nexport const RESPONSENODE = 2;\nexport const DEBUGNODE = 3;\nexport const ENDSTEP = 4;\n// Incoming method options\nexport const parameterLocationOptions = [\n  {\n    label: 'Body',\n    value: ParameterLocation.Body,\n  },\n  {\n    label: 'Path',\n    value: ParameterLocation.Path,\n  },\n  {\n    label: 'Query',\n    value: ParameterLocation.Query,\n  },\n  {\n    label: 'Header',\n    value: ParameterLocation.Header,\n  },\n];\n\nexport enum ParameterTypeExtend {\n  /**\n   * extension type\n   * One-to-one correspondence with AssistParameterType\n   */\n  DEFAULT = 10001,\n  IMAGE,\n  DOC,\n  CODE,\n  PPT,\n  TXT,\n  EXCEL,\n  AUDIO,\n  ZIP,\n  VIDEO,\n}\n\nconst enumDomain = 10000;\nexport const assistToExtend = (\n  type: AssistParameterType,\n): ParameterTypeExtend => type + enumDomain;\n\nexport const extendToAssist = (\n  type: ParameterTypeExtend,\n): AssistParameterType => type - enumDomain;\n\nexport type PluginParameterType = ParameterType | ParameterTypeExtend;\n\ninterface ParameterTypeOption {\n  label: string;\n  value: ParameterType | ParameterTypeExtend;\n  children?: Array<{\n    label: string;\n    value: ParameterTypeExtend;\n  }>;\n}\n\n/**\n * The basic type before the unextended File type is used in many places, and start needs to be reserved.\n */\nexport const parameterTypeOptions: Array<ParameterTypeOption> = [\n  {\n    label: 'String',\n    value: ParameterType.String,\n  },\n  {\n    label: 'Integer',\n    value: ParameterType.Integer,\n  },\n  {\n    label: 'Number',\n    value: ParameterType.Number,\n  },\n  {\n    label: 'Object',\n    value: ParameterType.Object,\n  },\n  {\n    label: 'Array',\n    value: ParameterType.Array,\n  },\n  {\n    label: 'Boolean',\n    value: ParameterType.Bool,\n  },\n];\n\nexport const parameterTypeOptionsSub: Array<ParameterTypeOption> = [\n  {\n    label: 'Array<String>',\n    value: ParameterType.String,\n  },\n  {\n    label: 'Array<Integer>',\n    value: ParameterType.Integer,\n  },\n  {\n    label: 'Array<Number>',\n    value: ParameterType.Number,\n  },\n  {\n    label: 'Array<Object>',\n    value: ParameterType.Object,\n  },\n  {\n    label: 'Array<Boolean>',\n    value: ParameterType.Bool,\n  },\n];\n/**\n * Unexpanded File type, base type, used in many places, need to keep end\n */\n\nexport const parameterTypeExtendMap: Record<\n  ParameterTypeExtend,\n  {\n    label: string;\n    listLabel: string;\n    fileTypes: FileTypeEnum[];\n  }\n> = {\n  [ParameterTypeExtend.DEFAULT]: {\n    label: 'File',\n    listLabel: 'Array<File>',\n    fileTypes: [FileTypeEnum.DEFAULT_UNKNOWN],\n  },\n  [ParameterTypeExtend.IMAGE]: {\n    label: 'Image',\n    listLabel: 'Array<Image>',\n    fileTypes: [FileTypeEnum.IMAGE],\n  },\n  [ParameterTypeExtend.DOC]: {\n    label: 'Doc',\n    listLabel: 'Array<Doc>',\n    fileTypes: [FileTypeEnum.DOCX, FileTypeEnum.PDF],\n  },\n  [ParameterTypeExtend.CODE]: {\n    label: 'Code',\n    listLabel: 'Array<Code>',\n    fileTypes: [FileTypeEnum.CODE],\n  },\n  [ParameterTypeExtend.PPT]: {\n    label: 'PPT',\n    listLabel: 'Array<PPT>',\n    fileTypes: [FileTypeEnum.PPT],\n  },\n  [ParameterTypeExtend.TXT]: {\n    label: 'TXT',\n    listLabel: 'Array<TXT>',\n    fileTypes: [FileTypeEnum.TXT],\n  },\n  [ParameterTypeExtend.EXCEL]: {\n    label: 'Excel',\n    listLabel: 'Array<Excel>',\n    fileTypes: [FileTypeEnum.EXCEL, FileTypeEnum.CSV],\n  },\n  [ParameterTypeExtend.AUDIO]: {\n    label: 'Audio',\n    listLabel: 'Array<Audio>',\n    fileTypes: [FileTypeEnum.AUDIO],\n  },\n  [ParameterTypeExtend.ZIP]: {\n    label: 'Zip',\n    listLabel: 'Array<Zip>',\n    fileTypes: [FileTypeEnum.ARCHIVE],\n  },\n  [ParameterTypeExtend.VIDEO]: {\n    label: 'Video',\n    listLabel: 'Array<Video>',\n    fileTypes: [FileTypeEnum.VIDEO],\n  },\n};\n\nconst getParameterTypeOptionsWithCustom = (enableFileType = false) => {\n  if (!enableFileType) {\n    return parameterTypeOptions;\n  }\n\n  const parameterTypeOptionsWithCustom = cloneDeep(parameterTypeOptions);\n  parameterTypeOptionsWithCustom.splice(1, 0, {\n    label: 'File',\n    value: ParameterTypeExtend.DEFAULT,\n    children: Object.entries(parameterTypeExtendMap).map(\n      ([type, { label }]) => ({\n        label,\n        value: Number(type) as ParameterTypeExtend,\n      }),\n    ),\n  });\n\n  return parameterTypeOptionsWithCustom;\n};\n\nconst getParameterTypeOptionsSubWithCustom = (enableFileType = false) => {\n  if (!enableFileType) {\n    return parameterTypeOptionsSub;\n  }\n\n  const parameterTypeOptionsSubWithCustom = cloneDeep(parameterTypeOptionsSub);\n  parameterTypeOptionsSubWithCustom.splice(1, 0, {\n    label: 'Array<File>',\n    value: ParameterTypeExtend.DEFAULT,\n    children: Object.entries(parameterTypeExtendMap).map(\n      ([type, { listLabel }]) => ({\n        label: listLabel,\n        value: Number(type) as ParameterTypeExtend,\n      }),\n    ),\n  });\n\n  return parameterTypeOptionsSubWithCustom;\n};\n\nexport const getPluginParameterTypeOptions = (\n  isArrayType: boolean,\n  enableFileType: boolean,\n) =>\n  isArrayType\n    ? getParameterTypeOptionsSubWithCustom(enableFileType)\n    : getParameterTypeOptionsWithCustom(enableFileType);\n\nconst parameterTypeOptionsMap = parameterTypeOptions.reduce(\n  (prev: Partial<Record<PluginParameterType, string>>, curr) => {\n    prev[curr.value] = curr.label;\n    return prev;\n  },\n  {\n    ...Object.entries(parameterTypeExtendMap).reduce(\n      (prev, [type, { label }]) => {\n        // @ts-expect-error -- linter-disable-autofix\n        prev[type] = label;\n        return prev;\n      },\n      {},\n    ),\n    [ParameterTypeExtend.DEFAULT]: 'File',\n  },\n);\n\nconst parameterTypeOptionsSubMap = parameterTypeOptionsSub.reduce(\n  (prev: Partial<Record<PluginParameterType, string>>, curr) => {\n    prev[curr.value] = curr.label;\n    return prev;\n  },\n  {\n    ...Object.entries(parameterTypeExtendMap).reduce(\n      (prev, [type, { listLabel }]) => {\n        // @ts-expect-error -- linter-disable-autofix\n        prev[type] = listLabel;\n        return prev;\n      },\n      {},\n    ),\n    [ParameterTypeExtend.DEFAULT]: 'Array<File>',\n  },\n);\n\nexport const getParameterTypeLabel = (\n  type: PluginParameterType,\n  isArrayType = false,\n) =>\n  isArrayType\n    ? parameterTypeOptionsSubMap[type]\n    : parameterTypeOptionsMap[type];\n\nexport const getParameterTypeLabelFromRecord = (\n  record: APIParameterRecord,\n  isArrayType = false,\n) => {\n  let type: PluginParameterType = record.type as PluginParameterType;\n  if (record?.assist_type) {\n    type = assistToExtend(record.assist_type);\n  }\n  return getParameterTypeLabel(type, isArrayType);\n};\n\nexport const methodType: ExtInfoText[] = [\n  {\n    type: 'title',\n    text: 'Get',\n  },\n  {\n    type: 'text',\n    text: I18n.t('plugin_tooltip_url'),\n  },\n  {\n    type: 'demo',\n    text: 'GET /users?userId=123',\n  },\n  {\n    type: 'text',\n    text: I18n.t('used_to_obtain_user_information_with_id_123'),\n  },\n  {\n    type: 'br',\n  },\n  {\n    type: 'title',\n    text: 'Post',\n  },\n  {\n    type: 'text',\n    text: I18n.t(\n      'submit_data_to_a_specified_resource__often_used_to_submit_forms_or_upload_files_',\n    ),\n  },\n  {\n    type: 'demo',\n    text: 'POST /users',\n  },\n  {\n    type: 'text',\n    text: I18n.t('attach_user_data_to_create_a_new_user_'),\n  },\n  {\n    type: 'title',\n    text: 'Put',\n  },\n  {\n    type: 'text',\n    text: I18n.t(\n      'upload_data_or_resources_to_a_specified_location__often_used_to_update_existing_',\n    ),\n  },\n  {\n    type: 'demo',\n    text: 'PUT /users/123',\n  },\n  {\n    type: 'text',\n    text: I18n.t('used_to_update_user_information_with_id_123_'),\n  },\n  {\n    type: 'title',\n    text: 'Delete',\n  },\n  {\n    type: 'text',\n    text: I18n.t(\n      'requests_the_server_to_delete_the_specified_resource__example_',\n    ),\n  },\n  {\n    type: 'demo',\n    text: 'DELETE /users/123',\n  },\n  {\n    type: 'text',\n    text: I18n.t('used_to_delete_the_user_with_id_123_'),\n  },\n  {\n    type: 'title',\n    text: I18n.t('Create_tool_s1_method_patch_tooltip_title'),\n  },\n  {\n    type: 'text',\n    text: I18n.t('Create_tool_s1_method_patch_tooltip_desp'),\n  },\n  {\n    type: 'demo',\n    text: I18n.t('Create_tool_s1_method_patch_tooltip_url'),\n  },\n  {\n    type: 'text',\n    text: I18n.t('Create_tool_s1_method_patch_tooltip_explain'),\n  },\n];\n\nexport enum ParamsFormErrorStatus {\n  NO_ERROR = 0,\n  NAME_EMPTY = 1,\n  // Chinese\n  CHINESE = 2,\n  // repeat\n  REPEAT = 3,\n  ASCII = 4,\n  // not filled in\n  DESC_EMPTY = 5,\n}\n\nexport const paramsFormErrorStatusText = {\n  [ParamsFormErrorStatus.NO_ERROR]: '',\n  [ParamsFormErrorStatus.NAME_EMPTY]: I18n.t(\n    'Create_newtool_s2_table_name_error1',\n  ),\n  [ParamsFormErrorStatus.CHINESE]: I18n.t(\n    'Create_newtool_s2_table_name_error2',\n  ),\n  [ParamsFormErrorStatus.REPEAT]: I18n.t('plugin_Parameter_name_error'),\n  [ParamsFormErrorStatus.ASCII]: I18n.t('create_plugin_modal_descrip_error'),\n  [ParamsFormErrorStatus.DESC_EMPTY]: I18n.t(\n    'Create_newtool_s3_table_des_empty',\n  ),\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type APIParameter } from '@coze-arch/bot-api/plugin_develop';\n\nexport enum STATUS {\n  PASS = 'PASS',\n  FAIL = 'FAIL',\n  WAIT = 'WAIT',\n}\nexport interface CheckParamsProps {\n  status?: STATUS;\n  request?: string;\n  response?: string;\n  failReason?: string;\n  response_params?: Array<APIParameter>;\n  rawResp?: string;\n}\n\nexport interface StepUpdateApiRes {\n  code: string | number;\n  msg: string;\n}\n\nexport const ERROR_CODE = {\n  SAFE_CHECK: 720092020,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/no-explicit-any -- some history can't be changed */\nimport { nanoid } from 'nanoid';\nimport { cloneDeep, has, isEmpty, isNumber, isObject } from 'lodash-es';\nimport {\n  type APIParameter,\n  ParameterLocation,\n  ParameterType,\n  DefaultParamSource,\n} from '@coze-arch/bot-api/plugin_develop';\n\nimport { ARRAYTAG, ROWKEY, childrenRecordName } from './config';\n\n// Traverse the tree and return the target ID path\nexport const findPathById = ({\n  data,\n  callback,\n  childrenName = childrenRecordName,\n  path = [],\n}: {\n  data: any;\n  callback: (item: APIParameter, path: Array<number>) => void;\n  childrenName?: string;\n  path?: Array<number>;\n}) => {\n  for (let i = 0; i < data.length; i++) {\n    const clonePath = JSON.parse(JSON.stringify(path));\n    clonePath.push(i);\n    callback(data[i], clonePath);\n    if (data[i][childrenName] && data[i][childrenName].length > 0) {\n      findPathById({\n        data: data[i][childrenName],\n        callback,\n        childrenName,\n        path: clonePath,\n      });\n    }\n  }\n};\n\n// Add layer depth markers to each layer of objects\nexport const addDepthAndValue = (\n  tree: any,\n  valKey: 'global_default' | 'local_default' = 'global_default',\n  depth = 1,\n) => {\n  if (!Array.isArray(tree)) {\n    return;\n  }\n  // Traverse each node in the tree\n  for (const node of tree) {\n    // Add a depth identifier to the current node\n    node.deep = depth;\n    if (node[valKey]) {\n      node.value = node[valKey];\n    }\n    // If the current node has a sub-node, add a depth identifier to the sub-node recursively\n    if (node[childrenRecordName]) {\n      addDepthAndValue(node[childrenRecordName], valKey, depth + 1);\n    }\n  }\n};\n\n// Push the depth information into an array, and finally take the maximum value\nexport const handleDeepArr = (tree: any, deepArr: Array<number> = []) => {\n  if (!Array.isArray(tree)) {\n    return;\n  }\n  // Traverse each node in the tree\n  for (const node of tree) {\n    // Add a depth identifier to the current node\n    if (isNumber(node.deep)) {\n      deepArr.push(node.deep);\n    }\n\n    if (node[childrenRecordName]) {\n      handleDeepArr(node[childrenRecordName], deepArr);\n    }\n  }\n};\n\n// Return to maximum depth\nexport const maxDeep = (tree: any) => {\n  if (!Array.isArray(tree) || tree.length === 0) {\n    return 0;\n  }\n  const arr: Array<number> = [];\n  handleDeepArr(tree, arr);\n  return Math.max.apply(null, arr);\n};\n\ninterface DefaultNode {\n  isArray?: boolean;\n  iscChildren?: boolean;\n  deep?: number;\n}\n\n// Default sub-node\nexport const defaultNode = ({\n  isArray = false,\n  iscChildren = false,\n  deep = 1,\n}: DefaultNode = {}) => ({\n  [ROWKEY]: nanoid(),\n  name: isArray ? ARRAYTAG : '',\n  desc: '',\n  type: ParameterType.String,\n  location: iscChildren ? undefined : ParameterLocation.Query,\n  is_required: true,\n  sub_parameters: [],\n  deep,\n});\n\n// Delete the current node\nexport const deleteNode = (data: any, targetKey: string) => {\n  for (let i = 0; i < data.length; i++) {\n    if (data[i][ROWKEY] === targetKey) {\n      data.splice(i, 1);\n      return true;\n    } else if (\n      data[i][childrenRecordName] &&\n      data[i][childrenRecordName].length > 0\n    ) {\n      if (deleteNode(data[i][childrenRecordName], targetKey)) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n// Delete all sub-nodes\nexport const deleteAllChildNode = (data: any, targetKey: string) => {\n  for (const item of data) {\n    if (item[ROWKEY] === targetKey) {\n      item[childrenRecordName] = [];\n      return true;\n    } else if (\n      Array.isArray(item[childrenRecordName]) &&\n      item[childrenRecordName].length > 0\n    ) {\n      if (deleteAllChildNode(item[childrenRecordName], targetKey)) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\ninterface UpdateNodeById {\n  data: APIParameter[];\n  targetKey: string;\n  field: string;\n  value: any;\n  /** Whether the sub-node of the array needs to inherit the field values of the parent node, currently only the visibility switch needs to inherit */\n  inherit?: boolean;\n}\n\nconst updateNodeByVal = (data: any, field: any, val: any) => {\n  for (const item of data) {\n    item[field] = val;\n    if (Array.isArray(item[childrenRecordName])) {\n      updateNodeByVal(item[childrenRecordName], field, val);\n    }\n  }\n};\n\n// Update node information\nexport const updateNodeById = ({\n  data,\n  targetKey,\n  field,\n  value,\n  inherit = false,\n}: UpdateNodeById) => {\n  for (const item of data) {\n    if (item[ROWKEY] === targetKey) {\n      // @ts-expect-error -- linter-disable-autofix\n      item[field] = value;\n      if (\n        inherit &&\n        Array.isArray(item[childrenRecordName]) &&\n        item[childrenRecordName].length > 0\n      ) {\n        updateNodeByVal(item[childrenRecordName], field, value);\n      }\n      return;\n    } else if (\n      Array.isArray(item[childrenRecordName]) &&\n      item[childrenRecordName].length > 0\n    ) {\n      updateNodeById({\n        data: item[childrenRecordName],\n        targetKey,\n        field,\n        value,\n      });\n    }\n  }\n};\n\n// Find the corresponding template value according to the path\nexport const findTemplateNodeByPath = (\n  dsl: any,\n  path: Array<string | number>,\n) => {\n  let node = cloneDeep(dsl);\n  const newPath = [...path]; //Create a new path to avoid modifying the original path\n  for (let i = 0; i < path.length; i++) {\n    // If there is a node, it means that a sub-node is added to the source data node.\n    if (node[path[i]]) {\n      node = node[path[i]];\n    } else {\n      // If it doesn't exist, it means that the newly added node adds a sub-node. At this time, you need to point the path to the original node (the first node).\n      node = node[0];\n      newPath[i] = 0;\n    }\n  }\n  return newPath;\n};\n\n// Converting trees to objects\nexport const transformTreeToObj = (tree: any, checkType = true): any =>\n  // Each level of the tree represents a set of properties of an object\n\n  tree.reduce((acc: any, item: any) => {\n    let arrTemp = [];\n    switch (item.type) {\n      case ParameterType.String:\n        if (item.value) {\n          acc[item.name] = item.value;\n        }\n        if (!checkType) {\n          acc[item.name] = item.value;\n        }\n        break;\n      case ParameterType.Integer:\n      case ParameterType.Number:\n        if (item.value) {\n          acc[item.name] = Number(item.value);\n        }\n        if (!checkType) {\n          acc[item.name] = item.value;\n        }\n        break;\n      case ParameterType.Bool:\n        if (item.value) {\n          acc[item.name] = item.value === 'true';\n        }\n        if (!checkType) {\n          acc[item.name] = item.value;\n        }\n        break;\n      case ParameterType.Object:\n        if (item.sub_parameters) {\n          const obj = transformTreeToObj(item.sub_parameters, checkType);\n          if (!isEmpty(obj)) {\n            acc[item.name] = obj;\n          }\n        }\n        break;\n      case ParameterType.Array:\n        /**\n         * If it is an array, you need to filter out empty items (and the children of the array are not object and array).\n         * Here, use temp to receive the filtered sub-items to avoid directly modifying the original array (because the original array and page data are bound, empty items cannot be directly deleted)\n         */\n        arrTemp = item.sub_parameters;\n        if (\n          [\n            ParameterType.Bool,\n            ParameterType.Integer,\n            ParameterType.Number,\n            ParameterType.String,\n          ].includes(item.sub_parameters[0].type)\n        ) {\n          arrTemp = item.sub_parameters.filter((subItem: any) => subItem.value);\n        }\n        if (isEmpty(arrTemp)) {\n          break;\n        }\n        acc[item.name] = arrTemp.map((subItem: any) => {\n          // Boolean type matching string true/false\n          if ([ParameterType.Bool].includes(subItem.type)) {\n            return checkType ? subItem.value === 'true' : subItem.value;\n          }\n          // Number type to number\n          if (\n            [ParameterType.Integer, ParameterType.Number].includes(subItem.type)\n          ) {\n            return checkType ? Number(subItem.value) : subItem.value;\n          }\n          // The string type is returned directly (the array entered here is already an array of filtered null values)\n          if ([ParameterType.String].includes(subItem.type)) {\n            return subItem.value;\n          }\n          // If it is an object, recursive traversal\n          if (subItem.type === ParameterType.Object) {\n            return transformTreeToObj(subItem.sub_parameters, checkType);\n          }\n        });\n        break;\n      default:\n        break;\n    }\n    return acc;\n  }, {});\n\n// Clone the node, modify the key and clear the value\nexport const cloneWithRandomKey = (obj: any) => {\n  // Create a new object stored value\n  const clone: any = {};\n\n  // Iterate through all properties of the original object\n  for (const prop in obj) {\n    // If this property of the original object is an object, recursively call the cloneWithRandomKey function\n    if (obj[prop]?.constructor === Object) {\n      clone[prop] = cloneWithRandomKey(obj[prop]);\n    } else {\n      // Otherwise, copy this property directly\n      clone[prop] = obj[prop];\n    }\n  }\n\n  // If this object has sub_parameters properties, you need to iterate over it\n  if ('sub_parameters' in clone) {\n    clone.sub_parameters = clone.sub_parameters?.map(cloneWithRandomKey);\n  }\n\n  // Generate a new random key\n  if (clone[ROWKEY]) {\n    clone[ROWKEY] = nanoid();\n  }\n  if (clone.value) {\n    clone.value = null;\n  }\n\n  // Returns the cloned object\n  return clone;\n};\n// To determine whether the parameter shows the delete button, first determine whether it is the root node, and the root node allows deletion.\nexport const handleIsShowDelete = (\n  data: any,\n  targetKey: string | undefined,\n) => {\n  const rootIds = data.map((d: any) => d[ROWKEY]);\n  if (rootIds.includes(targetKey)) {\n    return true;\n  }\n  return isShowDelete(data, targetKey);\n};\n\n// Check if the same name exists\nexport const checkSameName = (\n  data: Array<APIParameter>,\n  targetKey: string,\n  val: string,\n): boolean | undefined => {\n  for (const item of data) {\n    if (item[ROWKEY] === targetKey) {\n      const items = data.filter(\n        (dataItem: APIParameter) => dataItem.name === val,\n      );\n      return items.length > 1;\n    } else if (\n      Array.isArray(item[childrenRecordName]) &&\n      item[childrenRecordName].length > 0\n    ) {\n      if (checkSameName(item[childrenRecordName], targetKey, val)) {\n        return true;\n      }\n    }\n  }\n};\n\n// Check if there is an array type (used to determine whether the response requires an operation column)\nexport const checkHasArray = (data: unknown) => {\n  if (!Array.isArray(data)) {\n    return false;\n  }\n  for (const item of data) {\n    if (item.type === ParameterType.Array) {\n      return true;\n    } else if (\n      Array.isArray(item[childrenRecordName]) &&\n      item[childrenRecordName].length > 0\n    ) {\n      // Adjustment, loop exit timing\n      if (checkHasArray(item[childrenRecordName])) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n// Determine whether the parameter shows the delete button (the last one of the object type is not allowed to be deleted)\nexport const isShowDelete = (data: any, targetKey: string | undefined) => {\n  for (const item of data) {\n    if (item[ROWKEY] === targetKey) {\n      return data.length > 1;\n    } else if (\n      Array.isArray(item[childrenRecordName]) &&\n      item[childrenRecordName].length > 0\n    ) {\n      if (isShowDelete(item[childrenRecordName], targetKey)) {\n        return true;\n      }\n    }\n  }\n};\n\nexport const sleep = (time: number) =>\n  new Promise(resolve => {\n    setTimeout(() => {\n      resolve(0);\n    }, time);\n  });\n\n// This method is compatible with Chrome, Arch, Safari and iPad, and is compatible with Firefox.\nexport const scrollToErrorElement = (className: string) => {\n  const errorElement = document.querySelector(className);\n  if (errorElement) {\n    if (typeof (errorElement as any).scrollIntoViewIfNeeded === 'function') {\n      (errorElement as any).scrollIntoViewIfNeeded();\n    } else {\n      // Compatibility handling, such as Firefox\n      errorElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n    }\n  }\n};\n\nexport const scrollToBottom = (ele: Element) => {\n  const scrollEle = ele;\n  scrollEle.scrollTo({\n    left: 0,\n    top: scrollEle.scrollHeight,\n    behavior: 'smooth',\n  });\n};\n\nexport const initParamsDefault = (\n  data: Array<APIParameter>,\n  keyDefault: 'global_default' | 'local_default',\n) => {\n  const result = cloneDeep(data);\n  const init = (obj: APIParameter) => {\n    if (keyDefault === 'local_default' && !has(obj, 'local_default')) {\n      obj[keyDefault] = obj.global_default;\n    }\n    if (!obj[keyDefault]) {\n      obj[keyDefault] = '';\n    }\n    // bot non-reference + required + local default value is empty + invisible, it is an abnormal scene and needs to be manually dialed\n    const isUnusual =\n      obj.default_param_source === DefaultParamSource.Input &&\n      keyDefault === 'local_default' &&\n      obj.is_required &&\n      !obj.local_default &&\n      obj.local_disable;\n\n    if (isUnusual) {\n      obj.local_disable = false;\n    }\n  };\n\n  const addDefault = (res: Array<APIParameter>, isArray = false) => {\n    for (let i = 0, len = res.length; i < len; i++) {\n      const obj = res[i];\n      if (isArray) {\n        obj[keyDefault] = undefined;\n        if (obj.sub_parameters && obj.sub_parameters.length > 0) {\n          addDefault(obj.sub_parameters, true);\n        }\n      } else if (obj.type === ParameterType.Array) {\n        init(obj);\n        if (obj.sub_parameters && obj.sub_parameters.length > 0) {\n          addDefault(obj.sub_parameters, true);\n        }\n      } else {\n        if (obj.type === ParameterType.Object) {\n          obj[keyDefault] = undefined;\n        } else {\n          init(obj);\n        }\n        if (obj.sub_parameters && obj.sub_parameters.length > 0) {\n          addDefault(obj.sub_parameters);\n        }\n      }\n    }\n  };\n  addDefault(result);\n  return result;\n};\n\n// @ts-expect-error -- linter-disable-autofix\nexport const transformArrayToTree = (array, template: Array<APIParameter>) => {\n  const arrObj = array;\n  const tree: Array<APIParameter> = [];\n\n  if (Array.isArray(arrObj)) {\n    arrObj.forEach(item => {\n      const subTree = createSubTree(item, template[0]);\n      tree.push(subTree);\n    });\n  }\n\n  return tree;\n};\n\nconst createSubTree = (arrItem: any, tem: any) => {\n  let subTree: APIParameter & { value?: unknown } = {};\n  // array\n  if (Array.isArray(arrItem)) {\n    subTree = {\n      ...tem,\n      id: nanoid(),\n      sub_parameters: [],\n    };\n    arrItem.forEach(item => {\n      const arrItemSubTree = createSubTree(item, tem.sub_parameters[0]);\n      subTree.sub_parameters?.push(arrItemSubTree);\n    });\n  } else if (isObject(arrItem)) {\n    subTree = {\n      ...tem,\n      id: nanoid(),\n      sub_parameters: [],\n    };\n    let childTree: APIParameter & { value?: unknown } = {};\n    Object.keys(arrItem).map(key => {\n      if (Object.prototype.hasOwnProperty.call(arrItem, key)) {\n        // @ts-expect-error -- linter-disable-autofix\n        const value = arrItem[key];\n\n        if (Array.isArray(value) || typeof value === 'object') {\n          const nestedSubTree = createSubTree(\n            value,\n            // @ts-expect-error -- linter-disable-autofix\n            tem.sub_parameters.find(item => item.name === key),\n          );\n          subTree.sub_parameters?.push(nestedSubTree);\n        } else {\n          childTree = {\n            // @ts-expect-error -- linter-disable-autofix\n            ...tem.sub_parameters.find(item => item.name === key),\n            id: nanoid(),\n            sub_parameters: [],\n          };\n          childTree.value = String(value);\n          subTree.sub_parameters?.push(childTree);\n        }\n      }\n    });\n  } else {\n    subTree = {\n      ...tem,\n      id: nanoid(),\n      sub_parameters: [],\n    };\n    subTree.value = String(arrItem);\n  }\n\n  return subTree;\n};\n\nexport const transformParamsToTree = (params: Array<APIParameter>) => {\n  const result = cloneDeep(params);\n  for (let i = 0, len = result.length; i < len; i++) {\n    if (result[i].type === ParameterType.Array) {\n      const arr = JSON.parse(result[i].global_default || '[]');\n      if (arr.length > 0) {\n        const tree = transformArrayToTree(arr, result[i].sub_parameters || []);\n        result[i].sub_parameters = tree;\n      }\n    } else {\n      // There is a problem with the object embedded array, it is overwritten and needs to be reset.\n      result[i].sub_parameters = transformParamsToTree(\n        result[i].sub_parameters || [],\n      );\n    }\n  }\n  return result;\n};\n// Data extra processing/If there is no global_default === undefined, set global_disable is also undefined, and finally set all global_default to undefined\nexport const doRemoveDefaultFromResponseParams = (\n  data: APIParameter[],\n  hasRequired = false,\n) => {\n  if (!data.length) {\n    return [];\n  }\n  const returnData = cloneDeep(data);\n\n  for (let i = 0, len = returnData.length; i < len; i++) {\n    const current = returnData[i];\n\n    if (current.global_default === undefined) {\n      current.global_disable = undefined;\n    }\n\n    current.global_default = undefined;\n    if (!hasRequired) {\n      current.is_required = undefined;\n    }\n    current.sub_parameters = doRemoveDefaultFromResponseParams(\n      current.sub_parameters ?? [],\n      hasRequired,\n    );\n  }\n\n  return returnData;\n};\n\n// @ts-expect-error -- linter-disable-autofix\nexport const doValidParams = (\n  params: APIParameter[],\n  targetKey: keyof APIParameter,\n) => {\n  if (!params?.length || !targetKey) {\n    return !!0;\n  }\n\n  for (let i = 0, j = params.length; i < j; i++) {\n    const target = params[i];\n\n    if (!target[targetKey]) {\n      return !!0;\n    }\n\n    // @ts-expect-error -- linter-disable-autofix\n    if (target.sub_parameters.length > 0) {\n      // @ts-expect-error -- linter-disable-autofix\n      const sub = doValidParams(target.sub_parameters, targetKey);\n\n      if (sub === !!0) {\n        return sub;\n      }\n    }\n  }\n\n  return !0;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState, Suspense, lazy } from 'react';\n\nimport { cloneDeep } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIModal } from '@coze-arch/bot-semi';\nimport {\n  type PluginParameter,\n  type DebugExample,\n  type PluginAPIInfo,\n  DebugExampleStatus,\n} from '@coze-arch/bot-api/plugin_develop';\n\nimport { addDepthAndValue } from '../../components/plugin_modal/utils';\nimport { setStoreExampleValue, setWorkflowExampleValue } from './utils';\n\nconst LazyDebug = lazy(async () => {\n  const { Debug } = await import('../../components/plugin_modal/debug');\n  return {\n    default: Debug,\n  };\n});\ninterface ShowExampleParams {\n  scene: 'workflow' | 'bot';\n  requestParams: PluginParameter[];\n  debugExample: DebugExample;\n}\n\ninterface ViewExampleProps {\n  getPopupContainer?: () => HTMLElement;\n}\n\nexport const useViewExample = (props?: ViewExampleProps) => {\n  const [visible, setVisible] = useState(false);\n  const [apiInfo, setApiInfo] = useState<PluginAPIInfo>();\n\n  const doShowExample = ({\n    scene,\n    requestParams,\n    debugExample,\n  }: ShowExampleParams) => {\n    if (!requestParams || !debugExample?.req_example) {\n      return;\n    }\n    const requestParamsData = cloneDeep(requestParams);\n    if (scene === 'workflow') {\n      setWorkflowExampleValue(\n        requestParamsData,\n        JSON.parse(debugExample?.req_example),\n      );\n    } else if (scene === 'bot') {\n      setStoreExampleValue(\n        requestParamsData,\n        JSON.parse(debugExample?.req_example),\n      );\n    } else {\n      return;\n    }\n\n    addDepthAndValue(requestParamsData);\n    setApiInfo({\n      debug_example_status: DebugExampleStatus.Enable,\n      request_params:\n        requestParamsData as unknown as PluginAPIInfo['request_params'],\n      debug_example: debugExample,\n    });\n    setVisible(true);\n  };\n\n  const closeExample = () => {\n    setVisible(false);\n  };\n\n  useEffect(() => {\n    if (!visible) {\n      setApiInfo(undefined);\n    }\n  }, [visible]);\n  return {\n    exampleNode: (\n      <UIModal\n        title={I18n.t('plugin_edit_tool_test_run_example_tip')}\n        visible={visible}\n        width={1280}\n        style={{ height: 'calc(100vh - 140px)', minWidth: '1040px' }}\n        centered\n        onCancel={closeExample}\n        footer={null}\n        getPopupContainer={props?.getPopupContainer}\n      >\n        {apiInfo ? (\n          <Suspense fallback={null}>\n            <LazyDebug\n              disabled={true}\n              pluginId={''}\n              apiId={apiInfo?.api_id ?? ''}\n              apiInfo={apiInfo as PluginAPIInfo}\n              pluginName={''}\n              debugExample={apiInfo?.debug_example}\n              isViewExample={true}\n            />\n          </Suspense>\n        ) : null}\n      </UIModal>\n    ),\n    doShowExample,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { get } from 'lodash-es';\nimport {\n  ParameterType,\n  type APIParameter,\n} from '@coze-arch/bot-api/plugin_develop';\n\nexport const typesConfig = {\n  string: ParameterType.String,\n  integer: ParameterType.Integer,\n  number: ParameterType.Number,\n  object: ParameterType.Object,\n  array: ParameterType.Array,\n  bool: ParameterType.Bool,\n  list: ParameterType.Array,\n  float: ParameterType.Number,\n  boolean: ParameterType.Bool,\n};\n\n// Tool data recall\ninterface ExampleReqParamsType {\n  [key: string]: string | number | null | object | boolean;\n}\nexport const setEditToolExampleValue = (\n  requestParams: APIParameter[],\n  exampleReqParams: ExampleReqParamsType[],\n) => {\n  // @ts-expect-error -- linter-disable-autofix\n  const setDefault = (originData: APIParameter[], currentJsonData) => {\n    originData.forEach((paramItem: APIParameter) => {\n      const currentPathValue = get(currentJsonData, paramItem?.name ?? '');\n      if (currentPathValue !== undefined) {\n        if (paramItem.type === ParameterType.Object) {\n          setDefault(paramItem.sub_parameters ?? [], currentPathValue);\n        } else if (paramItem.type === ParameterType.Array) {\n          paramItem.global_default = JSON.stringify(currentPathValue);\n        } else {\n          paramItem.global_default = currentPathValue;\n        }\n      }\n    });\n  };\n  setDefault(requestParams, exampleReqParams);\n};\n\n// Resettype is_required sub_parameters\n// @ts-expect-error -- linter-disable-autofix\nexport const resetWorkflowKey = currentTarget => {\n  if (Array.isArray(currentTarget)) {\n    currentTarget.forEach(obj => {\n      resetWorkflowKey(obj);\n    });\n  } else {\n    // @ts-expect-error -- linter-disable-autofix\n    currentTarget.type = typesConfig[currentTarget.type];\n    // @ts-expect-error -- linter-disable-autofix\n    currentTarget.sub_type = typesConfig[currentTarget.sub_type];\n    currentTarget.is_required = currentTarget.required;\n    currentTarget.global_disable = false;\n    currentTarget.local_disable = false;\n    currentTarget.location = undefined;\n    currentTarget.id = nanoid();\n    currentTarget.desc = currentTarget.description;\n\n    if ('schema' in currentTarget) {\n      if (currentTarget.type === ParameterType.Array) {\n        currentTarget.sub_parameters = [\n          {\n            name: '[Array Item]',\n            is_required: currentTarget.required,\n            // @ts-expect-error -- linter-disable-autofix\n            type: typesConfig[currentTarget.schema?.type],\n            global_disable: false,\n            local_disable: false,\n            location: undefined,\n            sub_type: 0,\n            sub_parameters: currentTarget.schema?.schema ?? [],\n          },\n        ];\n      } else if (currentTarget.type === ParameterType.Object) {\n        currentTarget.sub_parameters = [...currentTarget.schema];\n      } else {\n        currentTarget.sub_parameters = [];\n      }\n    } else {\n      currentTarget.sub_parameters = [];\n    }\n    resetWorkflowKey(\n      currentTarget.type === ParameterType.Array\n        ? currentTarget.sub_parameters[0].sub_parameters\n        : currentTarget?.sub_parameters,\n    );\n  }\n};\n\n// @ts-expect-error -- linter-disable-autofix\nexport const resetStoreKey = currentTarget => {\n  if (Array.isArray(currentTarget)) {\n    currentTarget.forEach(obj => {\n      resetStoreKey(obj);\n    });\n  } else {\n    // @ts-expect-error -- linter-disable-autofix\n    currentTarget.type = typesConfig[currentTarget.type];\n    // @ts-expect-error -- linter-disable-autofix\n    currentTarget.sub_type = typesConfig[currentTarget.sub_type];\n    currentTarget.is_required = currentTarget.required;\n    currentTarget.global_disable = false;\n    currentTarget.local_disable = false;\n    currentTarget.location = undefined;\n    currentTarget.id = nanoid();\n    // The store over there is sub_params field, personal, sub_parameters\n    if (!('sub_parameters' in currentTarget)) {\n      currentTarget.sub_parameters = [];\n    }\n    if ('sub_params' in currentTarget) {\n      currentTarget.sub_parameters = currentTarget.sub_params;\n    }\n    if (currentTarget.type === ParameterType.Array) {\n      currentTarget.sub_parameters = [\n        {\n          name: '[Array Item]',\n          is_required: currentTarget.required,\n          type: currentTarget.sub_type,\n          global_disable: false,\n          local_disable: false,\n          location: undefined,\n          sub_type: 0,\n          sub_parameters: [...currentTarget.sub_parameters],\n        },\n      ];\n      resetStoreKey(currentTarget.sub_parameters[0].sub_parameters);\n    } else {\n      resetStoreKey(currentTarget.sub_parameters);\n    }\n  }\n};\n\nexport const setStoreExampleValue = (\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  requestParams: any,\n  exampleReqParams: ExampleReqParamsType[],\n) => {\n  resetStoreKey(requestParams);\n  setEditToolExampleValue(requestParams, exampleReqParams);\n};\n\nexport const setWorkflowExampleValue = (\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  requestParams: any,\n  exampleReqParams: ExampleReqParamsType[],\n) => {\n  resetWorkflowKey(requestParams);\n  setEditToolExampleValue(requestParams, exampleReqParams);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nexport enum BotCreatorScene {\n  Bot = 'bot',\n  DouyinBot = 'douyin-bot',\n}\n\nconst BotCreatorContext = createContext<{ scene: BotCreatorScene | undefined }>(\n  {\n    scene: BotCreatorScene.Bot,\n  },\n);\n\nexport const BotCreatorProvider = BotCreatorContext.Provider;\n\nexport const useBotCreatorContext = () => {\n  const context = useContext(BotCreatorContext);\n\n  if (!context) {\n    throw new Error(\n      'useBotCreatorContext must be used within a BotCreatorProvider',\n    );\n  }\n\n  return context;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren, type ReactNode } from 'react';\n\nimport { useField } from '@formily/react';\nimport { type Field } from '@formily/core';\nimport { Popover } from '@coze-arch/bot-semi';\nimport { MdBoxLazy } from '@coze-arch/bot-md-box-adapter/lazy';\nimport { IconInfo } from '@coze-arch/bot-icons';\n\nimport commonStyles from '../index.module.less';\n\nimport styles from './index.module.less';\n\nexport interface ModelFormItemProps {\n  label: ReactNode | undefined;\n  popoverContent: string | undefined;\n}\n\nexport const ModelFormItem: React.FC<PropsWithChildren<ModelFormItemProps>> = ({\n  label,\n  popoverContent,\n  children,\n}) => {\n  const field = useField<Field>();\n\n  return (\n    <div className={styles['form-item']}>\n      <div className={styles['field-content']}>\n        <label className={styles['label-content']}>\n          <span className={styles.label}>{label}</span>\n          {popoverContent ? (\n            <Popover\n              className={commonStyles.popover}\n              showArrow\n              arrowPointAtCenter\n              content={\n                <MdBoxLazy\n                  markDown={popoverContent}\n                  autoFixSyntax={{ autoFixEnding: false }}\n                />\n              }\n            >\n              <IconInfo className={styles.icon} />\n            </Popover>\n          ) : null}\n        </label>\n        <div className={styles['field-main']}>{children}</div>\n      </div>\n      {field?.feedbacks?.map((feedback, index) => (\n        <p key={index} className={styles['field-feedback']}>\n          {feedback.messages}\n        </p>\n      ))}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type CSSProperties } from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { RadioGroup } from '@coze-arch/bot-semi';\nimport { ModelStyle } from '@coze-arch/bot-api/developer_api';\n\nimport styles from './index.module.less';\nexport interface PresetRadioOption {\n  label: string;\n  value: ModelStyle;\n}\n\nconst getOptions: () => PresetRadioOption[] = () => [\n  { label: I18n.t('model_config_generate_precise'), value: ModelStyle.Precise },\n  { label: I18n.t('model_config_generate_balance'), value: ModelStyle.Balance },\n  {\n    label: I18n.t('model_config_generate_creative'),\n    value: ModelStyle.Creative,\n  },\n  {\n    label: I18n.t('model_config_generate_customize'),\n    value: ModelStyle.Custom,\n  },\n];\n\nexport interface PresetRadioGroupProps {\n  onChange: (value: ModelStyle) => void;\n  value: ModelStyle;\n  className?: string;\n  style?: CSSProperties;\n  disabled?: boolean;\n}\n\nexport const PresetRadioGroup: React.FC<PresetRadioGroupProps> = ({\n  onChange,\n  className,\n  style,\n  value,\n  disabled,\n}) => (\n  <RadioGroup\n    disabled={disabled}\n    className={classNames(styles['button-radio'], className)}\n    style={style}\n    options={getOptions()}\n    value={value}\n    onChange={e => {\n      onChange(e.target.value);\n    }}\n    type=\"button\"\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useEffect,\n  useState,\n  type PropsWithChildren,\n  type ReactNode,\n} from 'react';\n\nimport { nanoid } from 'nanoid';\nimport classNames from 'classnames';\nimport { useBotDetailIsReadonly } from '@coze-studio/bot-detail-store';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowDown } from '@coze-arch/coze-design/icons';\nimport { Button, Collapsible } from '@coze-arch/coze-design';\nimport { Popover } from '@coze-arch/bot-semi';\nimport { MdBoxLazy } from '@coze-arch/bot-md-box-adapter/lazy';\nimport { IconInfo } from '@coze-arch/bot-icons';\nimport { ModelStyle } from '@coze-arch/bot-api/developer_api';\n\nimport { PresetRadioGroup } from '../preset-radio-group';\nimport commonStyles from '../index.module.less';\nimport { useModelForm } from '../../../context/model-form-context';\nimport {\n  type FormilyCoreType,\n  type FormilyReactType,\n} from '../../../context/formily-context/type';\nimport { useFormily } from '../../../context/formily-context';\n\nimport styles from './index.module.less';\n\nexport interface ModelFormGroupItemProps {\n  title: ReactNode | undefined;\n}\n\nexport const ModelFormGroupItem: React.FC<\n  PropsWithChildren<ModelFormGroupItemProps>\n> = ({ title, children }) => (\n  <div className={styles.group}>\n    <div className={classNames(styles['group-label'], styles.title)}>\n      {title}\n    </div>\n    <div className={styles.content}>{children}</div>\n  </div>\n);\n\ntype DiversityGroupItemImplProps = ModelFormGroupItemProps & {\n  disabled: boolean;\n  formilyReact: FormilyReactType;\n  formilyCore: FormilyCoreType;\n};\n\nconst DiversityGroupItemImpl: React.FC<\n  PropsWithChildren<DiversityGroupItemImplProps>\n> = ({ formilyCore, formilyReact, title, children, disabled }) => {\n  const form = formilyReact.useForm();\n  const {\n    isGenerationDiversityOpen,\n    setGenerationDiversityOpen,\n    hideDiversityCollapseButton,\n  } = useModelForm();\n\n  const [modelStyle, setModelStyle] = useState<ModelStyle>(\n    form.values.model_style,\n  );\n\n  const toggleOpen = () => {\n    setGenerationDiversityOpen(!isGenerationDiversityOpen);\n  };\n\n  const handleValuesChange = (changedValue: ModelStyle) => {\n    form.setValues({ model_style: changedValue });\n  };\n\n  useEffect(() => {\n    const effectId = nanoid();\n\n    form.addEffects(effectId, () => {\n      formilyCore.onFormValuesChange(localeForm => {\n        setModelStyle(localeForm.values.model_style);\n      });\n    });\n\n    return () => {\n      form.removeEffects(effectId);\n    };\n  }, [form]);\n\n  /**\n   * Here is a distinction between initialization and subsequent operations\n   * In the read-only state, customize is also stowed by default, otherwise it is expanded by default\n   * Of course, read-only state cannot be modified model_style\n   */\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n\n    if (modelStyle !== ModelStyle.Custom) {\n      return;\n    }\n    setGenerationDiversityOpen(true);\n  }, [modelStyle]);\n\n  return (\n    <div\n      className={classNames(\n        styles.group,\n        !isGenerationDiversityOpen && styles['group-with-collapse'],\n      )}\n    >\n      <div className={styles['generation-diversity-group']}>\n        <div\n          className={classNames(\n            styles['group-label'],\n            styles['diversity-label'],\n          )}\n        >\n          <div>{title}</div>\n          <Popover\n            className={commonStyles.popover}\n            showArrow\n            arrowPointAtCenter\n            content={\n              <MdBoxLazy\n                markDown={I18n.t('model_config_generate_explain')}\n                autoFixSyntax={{ autoFixEnding: false }}\n              />\n            }\n          >\n            <IconInfo className={styles.icon} />\n          </Popover>\n        </div>\n\n        <PresetRadioGroup\n          className={styles['radio-group']}\n          disabled={disabled}\n          value={modelStyle}\n          onChange={handleValuesChange}\n        />\n        {hideDiversityCollapseButton ? null : (\n          <Button\n            onClick={toggleOpen}\n            iconPosition=\"right\"\n            icon={<IconCozArrowDown />}\n            className={classNames(\n              isGenerationDiversityOpen && styles.rotate,\n              styles.advance,\n            )}\n            color=\"secondary\"\n          >\n            {I18n.t('model_config_generate_advance')}\n          </Button>\n        )}\n      </div>\n      <Collapsible\n        isOpen={isGenerationDiversityOpen}\n        className={styles.collapse}\n      >\n        <div className={styles.content}>{children}</div>\n      </Collapsible>\n    </div>\n  );\n};\n\nexport const ModelFormGenerationDiversityGroupItem: React.FC<\n  PropsWithChildren<ModelFormGroupItemProps>\n> = props => {\n  const {\n    formilyModule: { formilyReact, formilyCore },\n  } = useFormily();\n\n  const isReadonly = useBotDetailIsReadonly();\n\n  if (!formilyReact || !formilyCore) {\n    return null;\n  }\n\n  return (\n    <DiversityGroupItemImpl\n      formilyCore={formilyCore}\n      formilyReact={formilyReact}\n      disabled={isReadonly}\n      {...props}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type JSXComponent } from '@formily/react';\nimport { InputSlider, type InputSliderProps } from '@coze-studio/components';\nimport {\n  Switch,\n  RadioGroup,\n  type RadioGroupProps,\n} from '@coze-arch/coze-design';\nimport { UIInput } from '@coze-arch/bot-semi';\n\nimport {\n  ModelFormComponent,\n  ModelFormVoidFieldComponent,\n} from '../../constant/model-form-component';\nimport {\n  ModelFormGenerationDiversityGroupItem,\n  ModelFormGroupItem,\n} from './group-item';\nimport { ModelFormItem, type ModelFormItemProps } from './form-item';\n\nexport const modelFormComponentMap: Record<\n  ModelFormComponent | ModelFormVoidFieldComponent,\n  JSXComponent\n> = {\n  [ModelFormComponent.Input]: UIInput,\n  [ModelFormComponent.RadioButton]: RadioGroup,\n  [ModelFormComponent.Switch]: Switch,\n  [ModelFormComponent.SliderInputNumber]: InputSlider,\n  [ModelFormComponent.ModelFormItem]: ModelFormItem,\n  [ModelFormVoidFieldComponent.ModelFormGroupItem]: ModelFormGroupItem,\n  [ModelFormVoidFieldComponent.ModelFormGenerationDiversityGroupItem]:\n    ModelFormGenerationDiversityGroupItem,\n};\n\nexport interface ModelFormComponentPropsMap {\n  [ModelFormComponent.Input]: Record<string, never>;\n  [ModelFormComponent.RadioButton]: Pick<RadioGroupProps, 'options' | 'type'>;\n  [ModelFormComponent.Switch]: Record<string, never>;\n  [ModelFormComponent.SliderInputNumber]: Pick<\n    InputSliderProps,\n    'min' | 'max' | 'step' | 'decimalPlaces'\n  >;\n  [ModelFormComponent.ModelFormItem]: ModelFormItemProps;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozRoleFill,\n  IconCozLightbulbFill,\n  IconCozChatFill,\n  IconCozCodeFill,\n  IconCozDocumentFill,\n  IconCozImageFill,\n  IconCozLightningFill,\n  IconCozMusic,\n  IconCozStarFill,\n  IconCozVideoFill,\n  IconCozWrenchFill,\n} from '@coze-arch/coze-design/icons';\nimport { Avatar, Tooltip } from '@coze-arch/coze-design';\nimport { type Model, ModelTagValue } from '@coze-arch/bot-api/developer_api';\n\nexport function ModelOptionAvatar({ model }: { model: Model }) {\n  return (\n    <Tooltip\n      trigger={\n        model.model_status_details?.is_upcoming_deprecated ? 'hover' : 'custom'\n      }\n      content={I18n.t('model_list_model_deprecation_date', {\n        date: model.model_status_details?.deprecated_date,\n      })}\n    >\n      <span>\n        <InnerImg\n          model={model}\n          bottomBanner={\n            model.model_status_details?.is_upcoming_deprecated ? (\n              <div\n                className={cls(\n                  'absolute bottom-0 left-0',\n                  'w-full py-[1px] px-[3px] rounded-b-[6px]',\n                  'flex items-center justify-center text-center',\n                  'text-[10px] font-medium leading-[14px] break-all',\n                  'coz-mg-mask coz-fg-hglt-plus',\n                )}\n              >\n                {I18n.t('model_list_willDeprecated')}\n              </div>\n            ) : undefined\n          }\n        />\n      </span>\n    </Tooltip>\n  );\n}\n\nfunction InnerImg({\n  model: { model_status_details, model_icon },\n  bottomBanner,\n}: {\n  model: Model;\n  bottomBanner?: ReactNode;\n}) {\n  if (\n    model_status_details?.is_new_model ||\n    !model_status_details?.model_feature\n  ) {\n    return (\n      <Avatar\n        className=\"shrink-0 rounded-[6px] border border-solid coz-stroke-primary\"\n        shape=\"square\"\n        // @ts-expect-error -- there is a problem with the semi type definition\n        bottomSlot={\n          bottomBanner\n            ? {\n                render: () => bottomBanner,\n              }\n            : undefined\n        }\n        src={model_icon}\n      />\n    );\n  }\n\n  const featureIcon = FEATURE_ICON_MAP[model_status_details.model_feature];\n\n  return (\n    <div\n      className={cls(\n        'w-[48px] h-[48px] p-[13px] relative',\n        'shrink-0 rounded-[6px] text-[22px]',\n        featureIcon.color,\n        featureIcon.bg,\n      )}\n    >\n      {featureIcon.icon}\n      {bottomBanner}\n    </div>\n  );\n}\n\nconst FEATURE_ICON_MAP: Record<\n  ModelTagValue,\n  { color: string; bg: string; icon: ReactNode }\n> = {\n  [ModelTagValue.Flagship]: {\n    icon: <IconCozStarFill />, //flagship\n    color: 'coz-fg-color-brand',\n    bg: 'coz-mg-hglt',\n  },\n  [ModelTagValue.HighSpeed]: {\n    icon: <IconCozLightningFill />, //high speed\n    color: 'coz-fg-color-blue',\n    bg: 'coz-mg-color-blue',\n  },\n  [ModelTagValue.CostPerformance]: {\n    icon: <IconCozChatFill />, //price/performance ratio\n    color: 'coz-fg-color-blue',\n    bg: 'coz-mg-color-blue',\n  },\n  [ModelTagValue.LongText]: {\n    icon: <IconCozDocumentFill />, //long text\n    color: 'coz-fg-color-blue',\n    bg: 'coz-mg-color-blue',\n  },\n  [ModelTagValue.RolePlaying]: {\n    icon: <IconCozRoleFill />, //Role Playing\n    color: 'coz-fg-color-blue',\n    bg: 'coz-mg-color-blue',\n  },\n  [ModelTagValue.ImageUnderstanding]: {\n    icon: <IconCozImageFill />, //image\n    color: 'coz-fg-color-purple',\n    bg: 'coz-mg-color-purple',\n  },\n  [ModelTagValue.VideoUnderstanding]: {\n    icon: <IconCozVideoFill />, //video\n    color: 'coz-fg-color-purple',\n    bg: 'coz-mg-color-purple',\n  },\n  [ModelTagValue.AudioUnderstanding]: {\n    icon: <IconCozMusic />, //Audio\n    color: 'coz-fg-color-purple',\n    bg: 'coz-mg-color-purple',\n  },\n  [ModelTagValue.CodeSpecialization]: {\n    icon: <IconCozCodeFill />, //Code Specialization\n    color: 'coz-fg-color-cyan',\n    bg: 'coz-mg-color-cyan',\n  },\n  [ModelTagValue.ToolInvocation]: {\n    icon: <IconCozWrenchFill />, //tool call\n    color: 'coz-fg-color-cyan',\n    bg: 'coz-mg-color-cyan',\n  },\n  [ModelTagValue.Reasoning]: {\n    icon: <IconCozLightbulbFill />, //inference\n    color: 'coz-fg-color-cyan',\n    bg: 'coz-mg-color-cyan',\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity -- ignore */\nimport { type PropsWithChildren, useRef } from 'react';\n\nimport cls from 'classnames';\nimport { useHover } from 'ahooks';\nimport {\n  useBenefitAvailable,\n  PremiumPaywallScene,\n  usePremiumPaywallModal,\n} from '@coze-studio/premium-components-adapter';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Model, ModelTagClass } from '@coze-arch/bot-api/developer_api';\nimport {\n  useBotCreatorContext,\n  BotCreatorScene,\n} from '@coze-agent-ide/bot-creator-context';\nimport {\n  IconCozLongArrowTopRight,\n  IconCozSetting,\n  IconCozLongArrowUpCircle,\n  IconCozDiamondFill,\n} from '@coze-arch/coze-design/icons';\nimport { IconButton, Tag, Tooltip, Typography } from '@coze-arch/coze-design';\nimport { OverflowList } from '@blueprintjs/core';\n\nimport { ModelOptionAvatar } from '../model-option-avatar';\n\nimport styles from './index.module.less';\n\nexport type ModelOptionProps = {\n  model: Model;\n  selected?: boolean;\n  disabled?: boolean;\n  /** Return whether the switch was successful */\n  onClick: () => boolean;\n} & (\n  | {\n      enableConfig?: false;\n    }\n  | {\n      enableConfig: true;\n      onConfigClick: () => void;\n    }\n) &\n  (\n    | {\n        enableJumpDetail?: false;\n      }\n    | {\n        enableJumpDetail: true;\n        /**\n         * Click to jump to the model management page\n         *\n         * Because the component positioning is a pure UI component, and the way to obtain the space id of different modules is different, the splicing of jump behavior and url is not built-in\n         */\n        onDetailClick: (modelId: string) => void;\n      }\n  );\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function ModelOption({\n  model,\n  selected,\n  disabled,\n  onClick,\n  ...props\n}: ModelOptionProps) {\n  /** This ref is purely for judging whether to hover or not. */\n  const ref = useRef<HTMLElement>(null);\n  const isHovering = useHover(ref);\n  const { scene } = useBotCreatorContext();\n\n  const featureTags = model.model_tag_list\n    ?.filter(t => t.tag_class === ModelTagClass.ModelFeature && t.tag_name)\n    .map(t => t.tag_name);\n  const functionTags = model.model_tag_list\n    ?.filter(t => t.tag_class === ModelTagClass.ModelFunction && t.tag_name)\n    .map(t => t.tag_name);\n\n  // Paywall, open source version does not support this feature\n  const isProModel =\n    model.model_status_details?.is_new_model ||\n    model.model_status_details?.is_advanced_model;\n  const isNewModelAvailable = useBenefitAvailable({\n    scene: PremiumPaywallScene.NewModel,\n  });\n  const { node: premiumPaywallModal, open: openPremiumPaywallModal } =\n    usePremiumPaywallModal({ scene: PremiumPaywallScene.NewModel });\n\n  return (\n    <>\n      <article\n        ref={ref}\n        className={cls(\n          'pl-[16px] pr-[12px] w-full relative',\n          'flex gap-[16px] items-center rounded-[12px]',\n          selected\n            ? 'coz-mg-hglt hover:coz-mg-hglt-hovered'\n            : 'hover:coz-mg-secondary-hovered active:coz-mg-secondary-pressed',\n          disabled ? 'cursor-not-allowed' : 'cursor-pointer',\n          // The following cls only hide the upper and lower dividing lines when implementing hover, active, and last (note that the dividing lines are in model-info-border, the designer's careful thought)\n          styles['model-option'],\n          // @ts-expect-error -- I don't know why the error is reported.\n          { [styles['model-option_selected']]: selected },\n        )}\n        onClick={() => {\n          if (disabled) {\n            return;\n          }\n          if (isProModel && !isNewModelAvailable) {\n            openPremiumPaywallModal();\n            return;\n          }\n          onClick();\n        }}\n      >\n        <ModelOptionAvatar model={model} />\n        <div\n          className={cls(\n            'h-[80px] py-[12px] w-full',\n            'flex flex-col overflow-hidden',\n            'border-0 border-b border-solid coz-stroke-primary',\n            styles['model-info-border'],\n          )}\n          style={\n            isHovering\n              ? {\n                  mask: calcMaskStyle([\n                    props.enableConfig,\n                    props.enableJumpDetail,\n                  ]),\n                }\n              : undefined\n          }\n        >\n          <div className=\"w-full flex items-center gap-[6px] overflow-hidden\">\n            <Typography.Title fontSize=\"14px\" ellipsis={{ showTooltip: true }}>\n              {model.name}\n            </Typography.Title>\n            <div className=\"shrink-0 flex gap-[6px]\">\n              {model.model_status_details?.is_free_model &&\n              scene !== BotCreatorScene.DouyinBot ? (\n                <Tag size=\"mini\" color=\"primary\" className=\"!coz-mg-plus\">\n                  {I18n.t('model_list_free')}\n                </Tag>\n              ) : null}\n              {isProModel && !isNewModelAvailable ? (\n                <IconCozDiamondFill className=\"coz-fg-hglt\" />\n              ) : null}\n              {featureTags?.length\n                ? featureTags.map(feature => (\n                    <Tag\n                      key={feature}\n                      size=\"mini\"\n                      color=\"primary\"\n                      className=\"!bg-transparent !border border-solid coz-stroke-plus\"\n                    >\n                      {feature}\n                    </Tag>\n                  ))\n                : null}\n            </div>\n          </div>\n          <div className=\"flex items-center text-[12px] leading-[16px] coz-fg-dim overflow-hidden\">\n            <ModelTag isFirst>\n              {((model.model_quota?.token_limit || 0) / 1024).toFixed(0)}K\n            </ModelTag>\n            <ModelTag\n              isLast={!functionTags?.length}\n              className=\"flex items-center gap-[4px]\"\n            >\n              <span>{model.model_name}</span>\n              {model.model_status_details?.update_info ? (\n                <Tooltip content={model.model_status_details.update_info}>\n                  <IconCozLongArrowUpCircle className=\"ml-[2px] coz-fg-hglt-green\" />\n                </Tooltip>\n              ) : null}\n            </ModelTag>\n            {functionTags?.length ? (\n              <Tooltip content={functionTags.join(IS_OVERSEA ? ', ' : '')}>\n                <span className=\"overflow-hidden\">\n                  <OverflowList\n                    items={functionTags}\n                    visibleItemRenderer={(item, idx) => (\n                      <ModelTag\n                        key={idx}\n                        isLast={idx === functionTags.length - 1}\n                      >\n                        {item}\n                      </ModelTag>\n                    )}\n                    overflowRenderer={restItems => (\n                      <span className=\"pl-[6px] flex items-center\">{`+${restItems.length}`}</span>\n                    )}\n                    collapseFrom=\"end\"\n                  />\n                </span>\n              </Tooltip>\n            ) : null}\n          </div>\n          <Typography.Text\n            className=\"mt-[4px] text-[12px] leading-[16px] coz-fg-secondary\"\n            ellipsis={{ showTooltip: true }}\n          >\n            {model.model_brief_desc}\n          </Typography.Text>\n        </div>\n        {isHovering ? (\n          <div className=\"absolute right-[12px] h-full flex items-center gap-[3px]\">\n            {props.enableConfig ? (\n              <IconButton\n                icon={<IconCozSetting />}\n                color=\"secondary\"\n                size=\"default\"\n                data-testid=\"model_select_option.config_btn\"\n                onClick={e => {\n                  e.stopPropagation();\n\n                  // paywall blocking\n                  if (isProModel && !isNewModelAvailable) {\n                    openPremiumPaywallModal();\n                    return;\n                  }\n\n                  if (selected) {\n                    props.onConfigClick();\n                    return;\n                  }\n                  const success = onClick();\n                  if (success) {\n                    setTimeout(() => props.onConfigClick());\n                  }\n                }}\n              />\n            ) : null}\n            {props.enableJumpDetail ? (\n              <IconButton\n                icon={<IconCozLongArrowTopRight />}\n                color=\"secondary\"\n                size=\"default\"\n                data-testid=\"model_select_option.detail_btn\"\n                onClick={e => {\n                  e.stopPropagation();\n                  props.onDetailClick(String(model.model_type));\n                }}\n              />\n            ) : null}\n          </div>\n        ) : null}\n      </article>\n      {premiumPaywallModal}\n    </>\n  );\n}\n\nfunction ModelTag({\n  isFirst,\n  isLast,\n  className,\n  children,\n}: PropsWithChildren<{\n  isFirst?: boolean;\n  isLast?: boolean;\n  className?: string;\n}>) {\n  return (\n    <div\n      className={cls(\n        { 'pl-[6px]': !isFirst },\n        'shrink-0 flex items-center gap-[6px]',\n      )}\n    >\n      <span className={className}>{children}</span>\n      {isLast ? null : (\n        <span className=\"h-[9px] border-0 border-r border-solid coz-stroke-primary\" />\n      )}\n    </div>\n  );\n}\n\n/**\n * When hovering to display several icons (such as jumping to the model details page and detailed configuration), there should be a gradual change mask effect on the content under the icon\n * This method is used to calculate the mask style\n */\nfunction calcMaskStyle(buttonVisible: Array<boolean | undefined>) {\n  const btnNum = buttonVisible.reduce(\n    (prevNum, showBtn) => prevNum + (showBtn ? 1 : 0),\n    0,\n  );\n  if (btnNum === 0) {\n    return 'none';\n  }\n\n  const BTN_WIDTH = 32;\n  const BTN_GAP = 3;\n  /** Fixed width of mask that does not vary with the number of buttons */\n  const PRESET_PADDING = 16;\n  /** A gradual change in the width of the mask */\n  const MASK_WIDTH = 24;\n\n  const gradientStart =\n    btnNum * BTN_WIDTH + (btnNum - 1) * BTN_GAP + PRESET_PADDING;\n  const gradientEnd = gradientStart + MASK_WIDTH;\n  return `linear-gradient(to left, rgba(0,0,0,0), rgba(0,0,0,0) ${gradientStart}px, #fff ${gradientEnd}px)`;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Avatar, Tag } from '@coze-arch/coze-design';\nimport { type Model } from '@coze-arch/bot-api/developer_api';\n\n/** Minimalist ModelOption for Button Display or Select Selected Bar */\nexport function ModelOptionThumb({ model }: { model: Model }) {\n  return (\n    <div className=\"px-[4px] flex items-center gap-[4px]\">\n      <Avatar\n        shape=\"square\"\n        size=\"extra-extra-small\"\n        src={model.model_icon}\n        className=\"rounded-[4px] border border-solid coz-stroke-primary\"\n      />\n      <span className=\"text-[14px] leading-[20px] coz-fg-primary\">\n        {model.name}\n      </span>\n      {model.model_status_details?.is_upcoming_deprecated ? (\n        <Tag size=\"mini\" color=\"yellow\">\n          {I18n.t('model_list_willDeprecated')}\n        </Tag>\n      ) : null}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode, useMemo } from 'react';\n\nimport { groupBy } from 'lodash-es';\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Model } from '@coze-arch/bot-api/developer_api';\n\nimport { ModelOptionGroup } from '../model-option-group';\nimport { ModelOption } from '../model-option';\n\n/** Popover's model list state corresponds to the detailed configuration state. Splitting purely to avoid oversized components */\nexport function PopoverModelListView({\n  hidden,\n  disabled,\n  selectedModelId,\n  selectedModel,\n  modelList,\n  extraHeaderSlot,\n  onModelClick,\n  onDetailClick,\n  onConfigClick,\n  enableConfig,\n  enableJumpDetail,\n}: {\n  /** Whether to set the list to display: none (to preserve scrollTop information) */\n  hidden: boolean;\n  disabled?: boolean;\n  selectedModelId: string;\n  selectedModel: Model | undefined;\n  modelList: Model[];\n  /** Extra head slot */\n  extraHeaderSlot?: ReactNode;\n  /** Return whether the switch was successful */\n  onModelClick: (model: Model) => boolean;\n  onDetailClick: (modelId: string) => void;\n  onConfigClick: (model: Model) => void;\n  enableConfig?: boolean;\n  enableJumpDetail?: boolean;\n}) {\n  const { modelGroups } = useMemo(() => {\n    /** The open-source version is not classified, but tiled */\n    if (IS_OPEN_SOURCE) {\n      return { modelGroups: [modelList] };\n    }\n    const modelSeriesGroups = groupBy(\n      modelList,\n      model => model.model_series?.series_name,\n    );\n    return {\n      modelGroups: Object.values(modelSeriesGroups).filter(\n        (group): group is Model[] => !!group?.length,\n      ),\n    };\n  }, [modelList]);\n\n  const renderModelOption = (model: Model) => (\n    <ModelOption\n      key={model.model_type}\n      model={model}\n      disabled={disabled}\n      selected={String(model.model_type) === selectedModelId}\n      onClick={() => onModelClick(model)}\n      enableJumpDetail={enableJumpDetail}\n      onDetailClick={onDetailClick}\n      enableConfig={\n        enableConfig &&\n        // In the disabled state, you can only view the detailed configuration of the selected model\n        (!disabled || String(model.model_type) === selectedModelId)\n      }\n      onConfigClick={() => {\n        onConfigClick(model);\n      }}\n    />\n  );\n\n  return (\n    <div\n      className={cls(\n        'max-h-[inherit]', // https://stackoverflow.com/questions/14262938/child-with-max-height-100-overflows-parent\n        'p-[8px] flex flex-col gap-[8px] overflow-auto',\n        {\n          hidden,\n        },\n      )}\n    >\n      <div className=\"flex items-center justify-between pl-4 pr-2 box-content h-[32px] pb-2 pt-1\">\n        <div className=\"text-xxl font-medium coz-fg-plus\">\n          {I18n.t('model_selection')}\n        </div>\n        {extraHeaderSlot}\n      </div>\n      {selectedModel?.model_status_details?.is_upcoming_deprecated ? (\n        <section className=\"p-[12px] pl-[16px] rounded-[8px] coz-mg-hglt-yellow\">\n          <div className=\"text-[14px] leading-[20px] font-medium coz-fg-plus\">\n            {I18n.t('model_list_model_deprecation_notice')}\n          </div>\n          <div className=\"text-[12px] leading-[16px] coz-fg-primary\">\n            {I18n.t('model_list_model_switch_announcement', {\n              model_deprecated: selectedModel.name,\n              date: selectedModel.model_status_details.deprecated_date,\n              model_up: selectedModel.model_status_details.replace_model_name,\n            })}\n          </div>\n        </section>\n      ) : null}\n\n      {modelGroups.map((group, idx) => {\n        if (IS_OPEN_SOURCE) {\n          return group.map(renderModelOption);\n        }\n        return (\n          <ModelOptionGroup\n            key={group[0]?.model_series?.series_name ?? idx}\n            type={\n              group[0]?.model_status_details?.is_new_model ? 'new' : 'normal'\n            }\n            icon={group[0]?.model_series?.icon_url || ''}\n            name={group[0]?.model_series?.series_name || ''}\n            desc={I18n.t('model_list_model_company', {\n              company: group[0]?.model_series?.model_vendor || '',\n            })}\n            tips={group[0]?.model_series?.model_tips || ''}\n          >\n            {group.map(renderModelOption)}\n          </ModelOptionGroup>\n        );\n      })}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode, useEffect, useMemo } from 'react';\n\nimport { omit } from 'lodash-es';\nimport cls from 'classnames';\nimport { useCreation } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozArrowLeft,\n  IconCozWarningCircleFill,\n} from '@coze-arch/coze-design/icons';\nimport { IconButton, Loading } from '@coze-arch/coze-design';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { type Model, type ModelInfo } from '@coze-arch/bot-api/developer_api';\n\nimport { modelFormComponentMap } from '../../model-form/type';\nimport { primitiveExhaustiveCheck } from '../../../utils/exhaustive-check';\nimport {\n  useHandleModelForm,\n  type UseHandleModelFormProps,\n} from '../../../hooks/model-form/use-handle-model-form';\nimport { type ModelFormContextProps } from '../../../context/model-form-context/type';\nimport { ModelFormProvider } from '../../../context/model-form-context/context';\nimport {\n  type FormilyCoreType,\n  type FormilyReactType,\n} from '../../../context/formily-context/type';\nimport { useFormily } from '../../../context/formily-context';\n\nexport interface ModelConfigProps\n  extends Pick<ModelFormContextProps, 'hideDiversityCollapseButton'> {\n  modelStore: UseHandleModelFormProps['modelStore'];\n  /**\n   * model configuration update\n   *\n   * It should be noted that when switching models, onModelChange will be triggered first, and the updated selectedModelId will be passed externally. After that, the new model's config will be calculated internally and onConfigChange will be triggered.\n   *\n   * The ideal data flow is when the switch model triggers onModelChange, and the new selectedModelId and currentConfig are passed externally. Or onModelChange throws a new modelId and config at the same time.\n   * Although the current situation is a bit frustrating, due to historical design reasons, the cost of transforming it into the above method is slightly higher, and the status quo is maintained for the time being.\n   */\n  onConfigChange: (value: ModelInfo) => void;\n  currentConfig: ModelInfo;\n  /** Is the current agent single or mulit? */\n  agentType: 'single' | 'multi';\n  /** Clarify the diff type and pass it through to getSchema. In the case of model-diff, the number of rounds carrying the context is not displayed */\n  diffType?: 'prompt-diff' | 'model-diff';\n}\n\ninterface PopoverModelConfigViewProps {\n  /**\n   * You need to keep the form instance continuously in order to reuse the extremely complex \"initialize detailed configuration when switching models\" logic\n   *\n   * The ideal approach is to reset the config value when onModelChange occurs on the outer business side\n   * But firstly, the logic is too complicated to extract the initialization method independently.\n   * Second, useHandleModelForm is very expensive to use and is not suitable for being called on the outermost business side\n   */\n  visible: boolean;\n  disabled?: boolean;\n  selectedModel?: Model;\n  onClose: () => void;\n  modelConfigProps: ModelConfigProps;\n}\n\n/** Popover's model configuration state corresponds to the list state. Splitting purely to avoid components being too large */\nexport function PopoverModelConfigView({\n  visible,\n  disabled,\n  selectedModel,\n  onClose,\n  modelConfigProps,\n}: PopoverModelConfigViewProps) {\n  const formilyInitState = useInitFormily();\n  return (\n    <div\n      className={cls('h-full p-[16px] flex flex-col gap-[12px] overflow-auto', {\n        hidden: !visible,\n      })}\n    >\n      <div className=\"flex items-center gap-[6px]\">\n        <IconButton\n          icon={<IconCozArrowLeft />}\n          color=\"secondary\"\n          //   size=\"small\"\n          onClick={e => {\n            onClose();\n          }}\n        />\n        <span className=\"text-[16px] leading-[22px] font-medium coz-fg-plus\">\n          {I18n.t('model_list_model_setting', { model: selectedModel?.name })}\n        </span>\n      </div>\n      {formilyInitState.success ? (\n        <ModelForm\n          disabled={disabled}\n          currentModelId={\n            selectedModel?.model_type ? String(selectedModel?.model_type) : ''\n          }\n          modelConfigProps={modelConfigProps}\n          {...formilyInitState.formilyPkg}\n        />\n      ) : (\n        formilyInitState.node\n      )}\n    </div>\n  );\n}\n\ninterface ModelFormProps {\n  disabled?: boolean;\n  currentModelId: string;\n  formilyCore: FormilyCoreType;\n  formilyReact: FormilyReactType;\n  modelConfigProps: ModelConfigProps;\n}\nfunction ModelForm({\n  disabled,\n  currentModelId,\n  formilyCore,\n  // eslint-disable-next-line @typescript-eslint/naming-convention -- FormProvider is not suitable for other formats\n  formilyReact: { createSchemaField, FormProvider },\n  modelConfigProps: {\n    currentConfig,\n    onConfigChange,\n    modelStore,\n    agentType,\n    hideDiversityCollapseButton,\n    diffType,\n  },\n}: ModelFormProps) {\n  const { createForm } = formilyCore;\n  const form = useCreation(() => createForm(), [currentModelId]);\n  const SchemaField = useCreation(\n    () => createSchemaField({ components: modelFormComponentMap }),\n    [],\n  );\n\n  const { getSchema, handleFormInit, handleFormUnmount } = useHandleModelForm({\n    currentModelId,\n    editable: !disabled,\n    getModelRecord: () => currentConfig,\n    onValuesChange: ({ values }) => {\n      onConfigChange(values);\n    },\n    modelStore,\n  });\n\n  const schema = useMemo(\n    () =>\n      getSchema({\n        currentModelId,\n        isSingleAgent: agentType === 'single',\n        diffType,\n      }),\n    [currentModelId, agentType, diffType],\n  );\n\n  useEffect(() => {\n    // Execute a callback in a promise executor where an error causes a promise rejection asynchronously instead of a white screen\n    new Promise(() => handleFormInit(form, formilyCore));\n\n    return handleFormUnmount;\n  }, [form]);\n\n  return (\n    <ModelFormProvider\n      hideDiversityCollapseButton={hideDiversityCollapseButton}\n    >\n      <FormProvider form={form}>\n        <SchemaField schema={schema} />\n      </FormProvider>\n    </ModelFormProvider>\n  );\n}\n\nfunction useInitFormily():\n  | {\n      success: true;\n      formilyPkg: {\n        formilyCore: FormilyCoreType;\n        formilyReact: FormilyReactType;\n      };\n    }\n  | {\n      success: false;\n      node: ReactNode;\n    } {\n  const { formilyModule, retryImportFormily } = useFormily();\n\n  if (formilyModule.status === 'loading' || formilyModule.status === 'unInit') {\n    return { success: false, node: <Loading loading /> };\n  }\n\n  if (formilyModule.status === 'error') {\n    return {\n      success: false,\n      node: (\n        <div className=\"h-full flex items-center gap-y-[8px] text-[14px]\">\n          <IconCozWarningCircleFill\n            // The value is migrated from src/components/model-form/index.tsx\n            className=\"text-[#FF2710]\"\n          />\n          <div className=\"font-semibold leading-[22px]\">\n            <span>{I18n.t('model_form_fail_text')}</span>\n            <span\n              // The value is migrated from src/components/model-form/index.tsx\n              className=\"cursor-pointer text-[#4D53E8]\"\n              onClick={retryImportFormily}\n            >\n              {I18n.t('model_form_fail_retry')}\n            </span>\n          </div>\n        </div>\n      ),\n    };\n  }\n\n  if (formilyModule.status === 'ready') {\n    return {\n      success: true,\n      formilyPkg: omit(formilyModule, ['status']),\n    };\n  }\n\n  primitiveExhaustiveCheck(formilyModule.status);\n  throw new CustomError('normal_error', 'unrecognized formilyModule.status');\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode, useRef, useState } from 'react';\n\nimport { isBoolean } from 'lodash-es';\nimport cls from 'classnames';\nimport { Popover, type PopoverProps } from '@coze-arch/coze-design';\nimport { IconCozArrowDown } from '@coze-arch/bot-icons';\nimport { type Model } from '@coze-arch/bot-api/developer_api';\n\nimport { PopoverModelListView } from '../popover-model-list-view';\nimport {\n  type ModelConfigProps,\n  PopoverModelConfigView,\n} from '../popover-model-config-view';\nimport { ModelOptionThumb } from '../model-option-thumb';\n\nexport interface ModelSelectUIProps {\n  /**\n   * Whether to ban popovers\n   *\n   * The current internal implementation supports both disabled and directly does not allow popovers (consistent with historical logic).\n   * Also supports allowing popovers and viewing detailed configuration but prohibiting editing\n   * Flexible modification when requirements change\n   */\n  disabled?: boolean;\n  /** The currently selected model */\n  selectedModelId: string;\n  /**\n   * Whether to display the jump to model details page (/space/: space_id/model/: model_id) button\n   * @default false\n   */\n  enableJumpDetail?:\n    | {\n        spaceId: string;\n      }\n    | false;\n  /**\n   * Model-selected change events\n   *\n   * The return value indicates whether the switch was successful, which will affect some subsequent events, such as automatically closing the popover.\n   * No explicit return is considered true\n   */\n  // eslint-disable-next-line @typescript-eslint/no-invalid-void-type -- there is no other way to implement [either do not return, or must return boolean]\n  onModelChange: (model: Model) => boolean | void;\n  modelList: Model[];\n  /**\n   * Allows business side custom trigger display, named alignment semi selected components\n   *\n   * @Param model - when selectedModelId cannot find the corresponding model, this will pass undefined\n   */\n  triggerRender?: (model?: Model, popoverVisible?: boolean) => ReactNode;\n  /**\n   * Businesses such as workflow that do not allow detailed configuration will have clickToHide demands.\n   * @default false\n   */\n  clickToHide?: boolean;\n  /** @default bottomLeft */\n  popoverPosition?: PopoverProps['position'];\n  /** @default true */\n  popoverAutoAdjustOverflow?: boolean;\n  /** The className of the trigger. If you pass in triggerRender, triggerRender takes over the rendering completely. This parameter no longer has any effect */\n  className?: string;\n  popoverClassName?: string;\n  /**\n   * If the business side inserts a Modal outside the component by itself, clicking Modal will also trigger onClickOutSide and cause the popover to close.\n   * If you don't want the popover to close unexpectedly, you need to pass Modal through modalSlot\n   *\n   * (You don't even need to set getPopupContainer, the mount layer of Modal and the mount layer of ModelSelect's Popover are still different, but mysteriously no longer trigger onClickOutSide, semi awesome)\n   */\n  modalSlot?: ReactNode;\n\n  /** The detailed configuration information of the model will be hidden if the button entrance of the detailed configuration is not passed. */\n  modelConfigProps?: ModelConfigProps;\n\n  /** The pop-up window has a variety of rendering scenarios, providing options to customize the rendering hierarchy to avoid overwriting */\n  zIndex?: number;\n\n  /** Model List Extra Head Slots */\n  modelListExtraHeaderSlot?: ReactNode;\n\n  /** Whether to expand the model list by default */\n  defaultOpen?: boolean;\n}\n\nexport function ModelSelectUI({\n  className,\n  disabled,\n  enableJumpDetail,\n  popoverClassName,\n  selectedModelId,\n  modelList,\n  onModelChange,\n  triggerRender,\n  modelListExtraHeaderSlot,\n  clickToHide = false,\n  popoverPosition = 'bottomLeft',\n  popoverAutoAdjustOverflow = true,\n  modalSlot,\n  modelConfigProps,\n  zIndex = 999,\n  defaultOpen = false,\n}: ModelSelectUIProps) {\n  /** In order to achieve the same width as Select for Popover, get the Select width through this ref (if you pass in triggerRender, you no longer need to keep it consistent) */\n  const selectRef = useRef<HTMLDivElement>(null);\n  const [popoverVisible, setPopoverVisible] = useState(defaultOpen);\n  const [detailConfigVisible, setDetailConfigVisible] = useState(false);\n\n  const selectedModel = modelList.find(\n    ({ model_type }) => selectedModelId === String(model_type),\n  );\n\n  // Need to implement group + custom option effect, Select component compatibility is not good, have to implement Popover\n  return (\n    <Popover\n      zIndex={zIndex}\n      stopPropagation\n      autoAdjustOverflow={popoverAutoAdjustOverflow}\n      visible={popoverVisible}\n      trigger=\"click\"\n      position={popoverPosition}\n      onClickOutSide={() => {\n        setPopoverVisible(false);\n        setDetailConfigVisible(false);\n      }}\n      className={cls('!p-0')}\n      content={\n        <div\n          className={cls(\n            'w-[480px] max-h-[50vh] !p-0 overflow-hidden',\n            popoverClassName,\n          )}\n          style={\n            selectRef.current\n              ? { width: selectRef.current.clientWidth }\n              : undefined\n          }\n        >\n          {modelConfigProps ? (\n            <PopoverModelConfigView\n              disabled={disabled}\n              visible={detailConfigVisible}\n              selectedModel={selectedModel}\n              onClose={() => setDetailConfigVisible(false)}\n              modelConfigProps={modelConfigProps}\n            />\n          ) : null}\n\n          <PopoverModelListView\n            // Use hidden instead of direct conditional mount to preserve scrollTop, designer's care\n            hidden={detailConfigVisible}\n            disabled={disabled}\n            selectedModelId={selectedModelId}\n            selectedModel={selectedModel}\n            modelList={modelList}\n            extraHeaderSlot={modelListExtraHeaderSlot}\n            onModelClick={(m: Model) => {\n              const res = onModelChange(m);\n              const success = isBoolean(res) ? res : true;\n              if (success && clickToHide) {\n                setPopoverVisible(false);\n                setDetailConfigVisible(false);\n              }\n              return success;\n            }}\n            enableJumpDetail={!!enableJumpDetail}\n            onDetailClick={modelId => {\n              if (!enableJumpDetail) {\n                return;\n              }\n              window.open(\n                `/space/${enableJumpDetail.spaceId}/model/${modelId}`,\n                '_blank',\n              );\n            }}\n            enableConfig={!!modelConfigProps}\n            onConfigClick={() => {\n              if (!modelConfigProps) {\n                return;\n              }\n              setDetailConfigVisible(true);\n            }}\n          />\n\n          {modalSlot}\n        </div>\n      }\n    >\n      {triggerRender ? (\n        <span\n          className={disabled ? 'cursor-not-allowed' : 'cursor-pointer'}\n          onClick={() => {\n            if (!disabled) {\n              setPopoverVisible(true);\n            }\n          }}\n        >\n          {triggerRender(selectedModel, popoverVisible)}\n        </span>\n      ) : (\n        <div\n          ref={selectRef}\n          className={cls(\n            'w-full p-[4px] flex items-center justify-between rounded-[8px]',\n            'overflow-hidden cursor-pointer border border-solid',\n            'hover:coz-mg-secondary-hovered active:coz-mg-secondary-pressed',\n            popoverVisible ? 'coz-stroke-hglt' : 'coz-stroke-primary',\n            className,\n          )}\n          onClick={() => {\n            if (!disabled) {\n              setPopoverVisible(true);\n            }\n          }}\n        >\n          <ModelOptionThumb\n            model={selectedModel || { name: selectedModelId }}\n          />\n          <IconCozArrowDown className=\"coz-fg-secondary\" />\n        </div>\n      )}\n    </Popover>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { isBoolean } from 'lodash-es';\nimport { useMount } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { Modal } from '@coze-arch/coze-design';\nimport {\n  usePremiumStore,\n  usePremiumType,\n} from '@coze-studio/premium-store-adapter';\nimport {\n  useBenefitAvailable,\n  usePremiumManageModal,\n  PremiumPaywallScene,\n} from '@coze-studio/premium-components-adapter';\n\nimport { ModelSelectUI, type ModelSelectUIProps } from '../model-select-ui';\n\nexport interface ModelSelectProps extends ModelSelectUIProps {\n  /**\n   * Whether to allow selection of advanced models/new models, otherwise built-in pop-up blocking\n   * When not passing or setting to auto, the built-in component determines whether the user is a paying user (domestic professional version, overseas premium)\n   * @default auto\n   */\n  canSelectSuperiorModel?: boolean | 'auto';\n}\n\n/**\n * This component has more paid interception functions than ModelSelectUI\n */\nexport function ModelSelect({\n  onModelChange,\n  canSelectSuperiorModel: canSelectSuperiorModelProps,\n  modalSlot,\n  modelListExtraHeaderSlot,\n  ...restProps\n}: ModelSelectProps) {\n  const { fetchPremiumPlan, fetchPremiumPlans } = usePremiumStore(\n    useShallow(s => ({\n      fetchPremiumPlans: s.fetchPremiumPlans,\n      fetchPremiumPlan: s.fetchPremiumPlan,\n    })),\n  );\n  // Domestic: Whether to allow the use of new models/advanced models\n  const isBenefitAvailable = useBenefitAvailable({\n    scene: PremiumPaywallScene.NewModel,\n  });\n\n  /** Is it premium overseas? */\n  const { isFree } = usePremiumType();\n\n  const canSelectSuperiorModel = isBoolean(canSelectSuperiorModelProps)\n    ? canSelectSuperiorModelProps\n    : IS_OVERSEA\n    ? !isFree\n    : isBenefitAvailable;\n  const [upgradeModalState, setUpgradeModalState] = useState<{\n    type?: 'new' | 'advance';\n    visible: boolean;\n  }>({ visible: false });\n\n  const { node: premiumManageModal, open: openPremiumModal } =\n    usePremiumManageModal();\n\n  useMount(() => {\n    if (IS_OVERSEA) {\n      fetchPremiumPlans().then(fetchPremiumPlan);\n    }\n  });\n\n  return (\n    <ModelSelectUI\n      modelListExtraHeaderSlot={modelListExtraHeaderSlot}\n      onModelChange={m => {\n        const isFreeModel =\n          !m.model_status_details?.is_new_model &&\n          !m.model_status_details?.is_advanced_model;\n        if (canSelectSuperiorModel || isFreeModel) {\n          return onModelChange(m);\n        }\n\n        setUpgradeModalState({\n          visible: true,\n          type: m.model_status_details?.is_new_model ? 'new' : 'advance',\n        });\n        return false;\n      }}\n      modalSlot={\n        <>\n          <Modal\n            // The default z-index of the Popover component elastic layer used by ModelSelect is 1030.\n            zIndex={1031}\n            visible={upgradeModalState.visible}\n            title={\n              upgradeModalState.type === 'new'\n                ? I18n.t('model_list_upgrade_to_pro_version')\n                : I18n.t('model_list_upgrade_to_pro_version_advancedModel')\n            }\n            cancelText={I18n.t('Cancel')}\n            okText={I18n.t('model_list_upgrade_button')}\n            onOk={() => {\n              if (IS_CN_REGION) {\n                openPremiumModal();\n                // This is done to prevent the modal content from jumping during the closed animation\n                setUpgradeModalState(s => ({ ...s, visible: false }));\n              } else {\n                window.open('/premium', '_blank');\n              }\n              setUpgradeModalState(s => ({ ...s, visible: false }));\n            }}\n            onCancel={() =>\n              setUpgradeModalState(s => ({ ...s, visible: false }))\n            }\n          >\n            {upgradeModalState.type === 'new'\n              ? I18n.t('model_list_ensure_service_quality')\n              : I18n.t('model_list_upgrade_to_pro_advanced_tips')}\n          </Modal>\n          {modalSlot}\n          {premiumManageModal}\n        </>\n      }\n      {...restProps}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ModelFormComponent {\n  SliderInputNumber = 'SliderInputNumber',\n  Input = 'Input',\n\n  Switch = 'Switch',\n\n  RadioButton = 'RadioButton',\n\n  ModelFormItem = 'ModelFormItem',\n}\n\nexport enum ModelFormVoidFieldComponent {\n  ModelFormGroupItem = 'ModelFormGroupItem',\n\n  ModelFormGenerationDiversityGroupItem = 'ModelFormGenerationDiversityGroupItem',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type PropsWithChildren,\n  createContext,\n  useState,\n  useEffect,\n} from 'react';\n\nimport { type FormilyModule, type FormilyContextProps } from './type';\n\nexport const FormilyContext = createContext<FormilyContextProps>({\n  formilyModule: { status: 'unInit', formilyReact: null, formilyCore: null },\n  retryImportFormily: () => void 0,\n});\n\nexport const FormilyProvider: React.FC<PropsWithChildren> = ({ children }) => {\n  const [formilyModule, setFormilyModule] = useState<FormilyModule>({\n    status: 'unInit',\n    formilyCore: null,\n    formilyReact: null,\n  });\n\n  const importFormily = async () => {\n    setFormilyModule({\n      formilyCore: null,\n      formilyReact: null,\n      status: 'loading',\n    });\n    try {\n      const [formilyCore, formilyReact] = await Promise.all([\n        import('@formily/core'),\n        import('@formily/react'),\n      ]);\n      setFormilyModule({\n        status: 'ready',\n        formilyCore,\n        formilyReact,\n      });\n    } catch (error) {\n      setFormilyModule({\n        status: 'error',\n        formilyCore: null,\n        formilyReact: null,\n      });\n      throw error;\n    }\n  };\n\n  useEffect(() => {\n    importFormily();\n  }, []);\n\n  return (\n    <FormilyContext.Provider\n      value={{\n        formilyModule,\n        retryImportFormily: importFormily,\n      }}\n    >\n      {children}\n    </FormilyContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { FormilyContext } from './context';\n\nexport const useFormily = () => {\n  const context = useContext(FormilyContext);\n  return context;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren, createContext, useState, useRef } from 'react';\n\nimport { cloneDeep } from 'lodash-es';\n\nimport { type ModelFormContextProps } from './type';\n\nexport const ModelFromContext = createContext<ModelFormContextProps>({\n  customizeValueMap: {},\n  isGenerationDiversityOpen: false,\n  setCustomizeValues: () => 0,\n  setGenerationDiversityOpen: () => 0,\n});\n\nexport const ModelFormProvider: React.FC<\n  PropsWithChildren<Pick<ModelFormContextProps, 'hideDiversityCollapseButton'>>\n> = ({ hideDiversityCollapseButton = false, children }) => {\n  const [isGenerationDiversityOpen, setGenerationDiversityOpen] = useState(\n    hideDiversityCollapseButton,\n  ); // Always expand when hiding the expand hide button\n  const customizeValueMapRef = useRef<\n    ModelFormContextProps['customizeValueMap']\n  >({});\n  const setCustomizeValues: ModelFormContextProps['setCustomizeValues'] = (\n    modelId,\n    customizeValues,\n  ) => {\n    customizeValueMapRef.current[modelId] = cloneDeep(customizeValues);\n  };\n  return (\n    <ModelFromContext.Provider\n      value={{\n        hideDiversityCollapseButton,\n        isGenerationDiversityOpen,\n        setCustomizeValues,\n        customizeValueMap: customizeValueMapRef.current,\n        setGenerationDiversityOpen,\n      }}\n    >\n      {children}\n    </ModelFromContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { ModelFromContext, ModelFormProvider } from './context';\n\nexport { ModelFormProvider };\nexport const useModelForm = () => useContext(ModelFromContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep, isObject } from 'lodash-es';\nimport { type ISchema } from '@formily/react';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ModelFormComponent } from '../../constant/model-form-component';\nimport { type ModelFormComponentPropsMap } from '../../components/model-form/type';\n\nexport const getFixedSingleAgentSchema = (schema: ISchema): ISchema => {\n  const clonedSchema = cloneDeep(schema);\n  const { properties } = clonedSchema;\n  if (!properties || typeof properties === 'string') {\n    return clonedSchema;\n  }\n  Object.entries(properties).forEach(([classId, voidField]) => {\n    if (!isObject(voidField)) {\n      return;\n    }\n\n    if (!voidField.properties) {\n      return;\n    }\n    if (classId !== '2') {\n      return;\n    }\n\n    const decoratorProps: ModelFormComponentPropsMap[ModelFormComponent.ModelFormItem] =\n      {\n        label: I18n.t('model_config_history_round'),\n        popoverContent: I18n.t('model_config_history_round_explain'),\n      };\n    const componentProps: ModelFormComponentPropsMap[ModelFormComponent.SliderInputNumber] =\n      {\n        step: 1,\n        max: 100,\n        min: 0,\n        decimalPlaces: 0,\n      };\n    const historyRoundFiled: ISchema = {\n      type: 'number',\n      'x-component': ModelFormComponent.SliderInputNumber,\n      'x-decorator': ModelFormComponent.ModelFormItem,\n      'x-component-props': componentProps,\n      'x-decorator-props': decoratorProps,\n      'x-index': 0,\n    };\n    Object.assign(voidField.properties, {\n      HistoryRound: historyRoundFiled,\n    });\n  });\n  return clonedSchema;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { groupBy, merge, uniqBy } from 'lodash-es';\nimport { type SchemaTypes, type ISchema } from '@formily/react';\nimport {\n  type Model,\n  ModelParamType,\n  type ModelParameter,\n  type ModelParamClass,\n} from '@coze-arch/bot-api/developer_api';\nimport { convertModelValueType } from '@coze-agent-ide/bot-editor-context-store';\n\nimport {\n  primitiveExhaustiveCheck,\n  recordExhaustiveCheck,\n} from '../exhaustive-check';\nimport {\n  ModelFormComponent,\n  ModelFormVoidFieldComponent,\n} from '../../constant/model-form-component';\nimport { type ModelFormComponentPropsMap } from '../../components/model-form/type';\n\nconst precisionToStep = (precision: number | undefined) => {\n  if (!precision) {\n    return 1;\n  }\n  return Number(`0.${'0'.repeat(precision - 1)}1`);\n};\n\nconst getParamType = ({ type }: Pick<ModelParameter, 'type'>): SchemaTypes => {\n  switch (type) {\n    case ModelParamType.Float:\n    case ModelParamType.Int: {\n      return 'number';\n    }\n    case ModelParamType.Boolean: {\n      return 'boolean';\n    }\n    default: {\n      return 'string';\n    }\n  }\n};\n\nconst getParamComponent = ({\n  type,\n  options,\n}: Pick<ModelParameter, 'type' | 'options'>): ModelFormComponent => {\n  if (options?.length) {\n    return ModelFormComponent.RadioButton;\n  }\n\n  switch (type) {\n    case ModelParamType.Float:\n    case ModelParamType.Int: {\n      return ModelFormComponent.SliderInputNumber;\n    }\n    case ModelParamType.Boolean: {\n      return ModelFormComponent.Switch;\n    }\n    default: {\n      return ModelFormComponent.Input;\n    }\n  }\n};\n\nconst getComponentProps = (\n  component: ModelFormComponent,\n  {\n    max,\n    min,\n    label,\n    precision,\n    options,\n    desc,\n    type,\n    ...rest\n  }: Pick<\n    ModelParameter,\n    'max' | 'min' | 'label' | 'precision' | 'options' | 'desc' | 'type'\n  >,\n): ModelFormComponentPropsMap[ModelFormComponent] => {\n  recordExhaustiveCheck(rest);\n  if (component === ModelFormComponent.RadioButton) {\n    return {\n      type: 'button',\n      options: options?.map(item => {\n        const convertedValue = convertModelValueType(item.value ?? '', type);\n        if (typeof convertedValue === 'boolean') {\n          return {\n            label: item.label,\n            value: undefined,\n          };\n        }\n\n        return {\n          label: item.label,\n          value: convertedValue,\n        };\n      }),\n    };\n  }\n  if (component === ModelFormComponent.Input) {\n    return {};\n  }\n  if (component === ModelFormComponent.SliderInputNumber) {\n    const numberedMax = Number(max);\n    const numberedMin = Number(min);\n    return {\n      max: numberedMax,\n      min: numberedMin,\n      step: precisionToStep(precision),\n      decimalPlaces: precision,\n    };\n  }\n  if (component === ModelFormComponent.Switch) {\n    return {};\n  }\n  if (component === ModelFormComponent.ModelFormItem) {\n    return {\n      label,\n      popoverContent: desc,\n    };\n  }\n\n  primitiveExhaustiveCheck(component);\n  return {};\n};\n\nexport const convertModelParamsToSchema = ({\n  model_params: modelParams,\n}: Required<Pick<Model, 'model_params'>>): ISchema => {\n  const paramClassList = uniqBy(\n    modelParams\n      .map(param => param.param_class)\n      .filter((paramClass): paramClass is ModelParamClass =>\n        Boolean(paramClass),\n      ),\n    paramClass => paramClass.class_id,\n  ).sort((a, b) => (a.class_id ?? 0) - (b.class_id ?? 0));\n\n  const paramDictionary = groupBy(\n    modelParams,\n    param => param.param_class?.class_id,\n  );\n\n  const schema: ISchema = {\n    type: 'object',\n    properties: {},\n  };\n\n  paramClassList.forEach((paramClass, index) => {\n    const voidField: ISchema = {\n      type: 'void',\n      properties: {},\n      'x-decorator':\n        paramClass.class_id === 1\n          ? ModelFormVoidFieldComponent.ModelFormGenerationDiversityGroupItem\n          : ModelFormVoidFieldComponent.ModelFormGroupItem,\n      'x-decorator-props': {\n        title: paramClass.label,\n      },\n      'x-index': index + 1,\n    };\n    const parameterList = paramDictionary[paramClass.class_id ?? ''];\n    if (!parameterList) {\n      return;\n    }\n    parameterList.forEach((modelParam, paramIndex) => {\n      const paramField = modelParam.name;\n      const component = getParamComponent(modelParam);\n      const componentProps = getComponentProps(component, modelParam);\n      const decoratorProps = getComponentProps(\n        ModelFormComponent.ModelFormItem,\n        modelParam,\n      );\n      const paramSchema: ISchema = {\n        type: getParamType(modelParam),\n        'x-component': component,\n        'x-component-props': componentProps,\n        'x-decorator': ModelFormComponent.ModelFormItem,\n        'x-decorator-props': decoratorProps,\n        'x-index': paramIndex + 1,\n      };\n\n      merge(voidField.properties, { [paramField]: paramSchema });\n    });\n    merge(schema.properties, { [paramClass.class_id ?? '']: voidField });\n  });\n\n  return schema;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useBotEditor } from '@coze-agent-ide/bot-editor-context-store';\n\nimport { getFixedSingleAgentSchema } from '../../utils/model/get-fixed-single-agent-schema';\nimport { convertModelParamsToSchema } from '../../utils/model/convert-model-params-to-schema';\n\nexport const useGetSchema = () => {\n  const {\n    storeSet: { useModelStore },\n  } = useBotEditor();\n\n  return ({\n    currentModelId,\n    isSingleAgent,\n    diffType,\n  }: {\n    currentModelId: string;\n    isSingleAgent: boolean;\n    diffType?: 'prompt-diff' | 'model-diff';\n  }) => {\n    const { getModelById } = useModelStore.getState();\n\n    const modelParams = getModelById(currentModelId)?.model_params ?? [];\n\n    const schema = convertModelParamsToSchema({ model_params: modelParams });\n\n    if (!isSingleAgent || diffType === 'model-diff') {\n      return schema;\n    }\n\n    return getFixedSingleAgentSchema(schema);\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport {\n  ModelParamType,\n  type ModelParameter,\n} from '@coze-arch/bot-api/developer_api';\nimport { convertModelValueType } from '@coze-agent-ide/bot-editor-context-store';\n\nexport const getFixedModelFormValues = (\n  values: Record<string, unknown>,\n  modelParameterList: ModelParameter[],\n) => {\n  const draft = cloneDeep(values);\n\n  Object.keys(draft).forEach(key => {\n    const targetParameter = modelParameterList.find(\n      parameter => parameter.name === key,\n    );\n    if (!targetParameter) {\n      return;\n    }\n    const value = draft[key];\n    const parameterType = targetParameter.type;\n    const { options } = targetParameter;\n\n    // Fixed that parameters of type enumeration are not in the scope of enumeration\n    // IDL cannot write paradigm, converted to string comparison\n    if (options?.length) {\n      if (options.findIndex(option => option.value === String(value)) >= 0) {\n        return;\n      }\n      draft[key] = convertModelValueType(\n        options.at(0)?.value ?? '',\n        parameterType,\n      );\n    }\n\n    // Fixed number type parameters exceeding maximum and minimum values\n    if (\n      parameterType === ModelParamType.Float ||\n      parameterType === ModelParamType.Int\n    ) {\n      if (typeof value !== 'number') {\n        return;\n      }\n\n      const { max, min } = targetParameter;\n\n      const numberedMax = Number(max);\n      const numberedMin = Number(min);\n      if (max && value > numberedMax) {\n        draft[key] = numberedMax;\n      }\n      if (min && value < numberedMin) {\n        draft[key] = numberedMin;\n      }\n    }\n  });\n  return draft;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ModelStyle } from '@coze-arch/bot-api/developer_api';\nimport { type ModelPresetValues } from '@coze-agent-ide/bot-editor-context-store';\n\nimport { primitiveExhaustiveCheck } from '../exhaustive-check';\n\nexport const getDiversityPresetValueByStyle = (\n  style: ModelStyle,\n  presetValues: ModelPresetValues,\n) => {\n  if (style === ModelStyle.Balance) {\n    return presetValues.balance;\n  }\n  if (style === ModelStyle.Creative) {\n    return presetValues.creative;\n  }\n  if (style === ModelStyle.Precise) {\n    return presetValues.precise;\n  }\n  if (style === ModelStyle.Custom) {\n    return;\n  }\n  primitiveExhaustiveCheck(style);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ModelInfo } from '@coze-arch/bot-api/developer_api';\n\nimport { type NestedObject, flattenObject } from '../flatten-object';\n\nexport const convertModelInfoToFlatObject = (modelInfo: ModelInfo) =>\n  flattenObject(modelInfo as NestedObject);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport type NestedObject = Record<string, never>;\n\nexport function flattenObject(obj: NestedObject): NestedObject {\n  const flatten = Object.keys(obj).reduce((acc: NestedObject, key: string) => {\n    const target = obj[key];\n    if (\n      typeof target === 'object' &&\n      target !== null &&\n      !Array.isArray(target)\n    ) {\n      Object.assign(acc, flattenObject(target));\n    } else {\n      Object.assign(acc, { [key]: target });\n    }\n    return acc;\n  }, {});\n\n  return flatten;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ShortMemPolicy,\n  type ModelInfo,\n} from '@coze-arch/bot-api/developer_api';\n\nexport const convertFormValueToModelInfo = (\n  values: Record<string, unknown>,\n): ModelInfo => {\n  const { HistoryRound, ContextContentType, ...rest } = values;\n  // eslint-disable-next-line @typescript-eslint/naming-convention -- not applicable to this case\n  const ShortMemPolicy: ShortMemPolicy = {};\n\n  if (typeof HistoryRound === 'number') {\n    ShortMemPolicy.HistoryRound = HistoryRound;\n  }\n\n  if (typeof ContextContentType === 'number') {\n    ShortMemPolicy.ContextContentType = ContextContentType;\n  }\n\n  return {\n    ...rest,\n    ShortMemPolicy,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DataField, Form, GeneralField } from '@formily/core';\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport {\n  ModelStyle,\n  type ModelParameter,\n} from '@coze-arch/bot-api/developer_api';\n\nimport { type FormilyCoreType } from '../context/formily-context/type';\n\ninterface FieldInitStrategy {\n  execute: (parameter: ModelParameter, formilyCore: FormilyCoreType) => void;\n}\n\n/**\n * Switch to \"Custom\" mode when the user modifies the model \"Generate Diversity\" parameter\n */\nclass CustomModelStyleStrategy implements FieldInitStrategy {\n  handler: (_field: DataField, form: Form) => void = (_field, form) =>\n    form.setValues({ model_style: ModelStyle.Custom });\n\n  execute: FieldInitStrategy['execute'] = (\n    param,\n    { onFieldInputValueChange },\n  ) => {\n    if (param.param_class?.class_id === 1) {\n      onFieldInputValueChange(param.name, this.handler);\n    }\n  };\n}\n\nfunction isDataField(field: GeneralField): field is DataField {\n  return Object.prototype.hasOwnProperty.call(field, 'value');\n}\n\n/**\n * When a field value is less than the threshold, use field.feedbacks to display prompt text\n * https://core.formilyjs.org/zh-CN/api/models/field#ifieldfeedback\n */\nclass MinimumValueStrategy implements FieldInitStrategy {\n  constructor(\n    private name: string,\n    private min: number,\n    private i18nKey: I18nKeysNoOptionsType,\n  ) {}\n\n  validator: (field: GeneralField, _form: Form) => void = (field, _form) => {\n    if (isDataField(field)) {\n      field.setSelfWarnings(\n        (field.value ?? 0) < this.min ? [I18n.t(this.i18nKey)] : undefined,\n      );\n    }\n  };\n\n  execute: FieldInitStrategy['execute'] = (\n    param,\n    { onFieldInit, onFieldValueChange },\n  ) => {\n    if (param.name === this.name) {\n      onFieldInit(this.name, this.validator);\n      onFieldValueChange(this.name, this.validator);\n    }\n  };\n}\n\nexport const fieldInitStrategies = [\n  new CustomModelStyleStrategy(),\n  // When the repeated sentence penalty is < 0, the prompt copy is displayed\n  new MinimumValueStrategy('frequency_penalty', 0, 'model_setting_alert'),\n  // When the maximum reply length is < 100, the prompt copy is displayed\n  new MinimumValueStrategy('max_tokens', 100, 'model_setting_alert_2'),\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { isObject, merge, pick } from 'lodash-es';\nimport { useCreation, useDebounceFn } from 'ahooks';\nimport {\n  type ModelInfo,\n  ModelStyle,\n  type ModelParameter,\n} from '@coze-arch/bot-api/developer_api';\nimport {\n  getModelById,\n  type ModelAction,\n  type ModelState,\n} from '@coze-agent-ide/bot-editor-context-store';\n\nimport { useGetSchema } from '../model/use-get-schema';\nimport { getFixedModelFormValues } from '../../utils/model/get-fixed-model-form-values';\nimport { getDiversityPresetValueByStyle } from '../../utils/model/get-diversity-preset-value-by-style';\nimport { convertModelInfoToFlatObject } from '../../utils/model/convert-model-info-to-flat-object';\nimport { convertFormValueToModelInfo } from '../../utils/model/convert-form-value-to-model-info';\nimport { fieldInitStrategies } from '../../utils/field-init-strategy';\nimport { primitiveExhaustiveCheck } from '../../utils/exhaustive-check';\nimport { useModelForm } from '../../context/model-form-context';\nimport { type ModelFormProps } from '../../components/model-form';\n\nconst specialFieldKeyList = [\n  // This field is a nested structure and requires special conversion\n  'HistoryRound',\n  // This field needs to be brought to the form for change. There are components in the form that will listen to this data, but it is not part of the model_parameter\n  'model_style',\n];\n\nexport interface UseHandleModelFormProps {\n  currentModelId: string;\n  onValuesChange: (props: { values: ModelInfo }) => void;\n  getModelRecord: () => ModelInfo;\n  editable: boolean;\n  /**\n   * Originally, useBotEditor was called inside the hook to get the modelStore, but this issue was violently moved out for the time being\n   * The ideal form of @todo is to completely decouple from the store, pass in get_type_list interface return value, or provide a way to convert the interface return value into the desired structure\n   */\n  modelStore: Pick<\n    ModelState & ModelAction,\n    'onlineModelList' | 'offlineModelMap' | 'getModelPreset'\n  >;\n}\n\n/**\n * The flow of data here does not allow the top-level model to set the data to fully control the form data for several reasons:\n * 1. Temporary changes in requirements, and user settings need to be recorded only according to the model\n * 2. The design of the top-level data source is singleton, and only one copy of the most recent model can be stored\n *\n * The final design is that the data is recorded by the single layer in the middle, and the top-level data source is updated by the onChange of the form\n * So the form data and the top-level data source are not necessarily the same\n *\n * Every time I switch the model, the form is initialized. During the initialization process, I smooth out the inconsistencies between the top-level data source and the form data\n * And update the top-level data uniformly through the onChange of the form\n */\n// eslint-disable-next-line max-lines-per-function, @coze-arch/max-line-per-function -- q\nexport const useHandleModelForm = ({\n  currentModelId,\n  onValuesChange,\n  getModelRecord,\n  editable,\n  modelStore,\n}: UseHandleModelFormProps) => {\n  const effectId = useCreation(() => nanoid(), []);\n  const formRef = useRef<Parameters<ModelFormProps['onFormInit']>[0]>();\n  const { onlineModelList, offlineModelMap, getModelPreset } = modelStore;\n\n  const [currentModelStyle, setCurrentModelStyle] = useState<ModelStyle>();\n  const { customizeValueMap, setCustomizeValues } = useModelForm();\n\n  const getSchema = useGetSchema();\n\n  const handleValuesChange = (inputValues: unknown) => {\n    if (!isObject(inputValues)) {\n      return;\n    }\n\n    const values = inputValues as Record<string, unknown>;\n    const formModelInfo = convertFormValueToModelInfo(values);\n\n    if (currentModelStyle === ModelStyle.Custom) {\n      setCustomizeValues(currentModelId, values);\n    }\n\n    onValuesChange({ values: formModelInfo });\n  };\n  const handleStyleChange = (values: unknown) => {\n    if (\n      isObject(values) &&\n      'model_style' in values &&\n      typeof values.model_style === 'number'\n    ) {\n      setCurrentModelStyle(values.model_style);\n    }\n  };\n  const { run: debouncedHandleValuesChange } = useDebounceFn(\n    handleValuesChange,\n    { wait: 200 },\n  );\n\n  const convertFormValuesOnInit = (modelParameterList: ModelParameter[]) => {\n    const presetValues = getModelPreset(currentModelId);\n    if (!presetValues) {\n      throw new Error(`failed to get presetValues, modelId: ${currentModelId}`);\n    }\n\n    const modelRecord = getModelRecord();\n    const { defaultValues } = presetValues;\n\n    // The server level flushes the data for the newly created bot, and the old data has no corresponding field fallback to custom.\n    const configModelStyle: ModelStyle =\n      modelRecord.model_style ?? ModelStyle.Custom;\n    const flattedModelValues = convertModelInfoToFlatObject(modelRecord);\n\n    const presetDiversityValue = getDiversityPresetValueByStyle(\n      configModelStyle,\n      presetValues,\n    );\n\n    const customizeValue = customizeValueMap[currentModelId];\n\n    /**\n     * Front-end memory level Save user's custom settings according to Record < ModelId, Values >\n     * If the user's settings are not found, the model setting data of the current bot/agent is used\n     */\n    const expectValue = merge(\n      {},\n      flattedModelValues,\n      configModelStyle === ModelStyle.Custom\n        ? customizeValue\n        : presetDiversityValue,\n    );\n\n    const mergeValues = merge(\n      {\n        model_style: configModelStyle,\n      },\n      defaultValues,\n      expectValue,\n    );\n\n    const fixedValues = getFixedModelFormValues(\n      pick(mergeValues, Object.keys(defaultValues).concat(specialFieldKeyList)),\n      modelParameterList,\n    );\n\n    return fixedValues;\n  };\n  const handleModelStyleChange = () => {\n    if (typeof currentModelStyle === 'undefined') {\n      return;\n    }\n    const modelPresetValues = getModelPreset(currentModelId);\n    if (!modelPresetValues) {\n      return;\n    }\n    if (currentModelStyle === ModelStyle.Custom) {\n      const customizeValue = customizeValueMap[currentModelId];\n      if (!customizeValue) {\n        return;\n      }\n      formRef.current?.setValues(customizeValue);\n      return;\n    }\n    const { balance, creative, precise } = modelPresetValues;\n    if (currentModelStyle === ModelStyle.Balance) {\n      balance && formRef.current?.setValues(balance);\n      return;\n    }\n    if (currentModelStyle === ModelStyle.Precise) {\n      precise && formRef.current?.setValues(precise);\n      return;\n    }\n    if (currentModelStyle === ModelStyle.Creative) {\n      creative && formRef.current?.setValues(creative);\n      return;\n    }\n\n    primitiveExhaustiveCheck(currentModelStyle);\n  };\n\n  useEffect(() => {\n    formRef.current?.setFormState({ editable });\n  }, [editable]);\n\n  useEffect(() => {\n    handleModelStyleChange();\n  }, [currentModelStyle]);\n\n  const handleFormInit: ModelFormProps['onFormInit'] = (form, formilyCore) => {\n    const localeModel = getModelById({\n      onlineModelList,\n      offlineModelMap,\n      id: currentModelId,\n    });\n    const parameterList = localeModel?.model_params ?? [];\n\n    form.addEffects(effectId, () => {\n      formilyCore.onFormValuesChange(localeForm => {\n        handleStyleChange(localeForm.values);\n        debouncedHandleValuesChange(localeForm.values);\n      });\n      parameterList.forEach(param => {\n        fieldInitStrategies.forEach(strategy => {\n          strategy.execute(param, formilyCore);\n        });\n      });\n    });\n\n    form.setValues(convertFormValuesOnInit(parameterList), 'overwrite');\n    form.setFormState({ editable });\n    formRef.current = form;\n  };\n  const handleFormUnmount = () => formRef.current?.removeEffects(effectId);\n  return {\n    getSchema,\n    handleFormInit,\n    handleFormUnmount,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const primitiveExhaustiveCheck = (_: never) => 0;\nexport const recordExhaustiveCheck = (_: Record<string, never>) => 0;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum MineActiveEnum {\n  All = '1',\n  Mine = '2',\n}\nexport const DEFAULT_PAGE = 1;\nexport const DEFAULT_PAGE_SIZE = 10;\n\nexport enum PluginFilterType {\n  Mine = 'mine',\n  Team = 'team',\n  Favorite = 'favorite',\n  Project = 'project',\n  Local = 'local',\n  Coze = 'coze',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { OpenModeType } from '@coze-arch/bot-hooks';\nimport {\n  type PluginType,\n  type Int64,\n  type product_common,\n  type SortType,\n} from '@coze-arch/bot-api/product_api';\nimport { type PluginInfoForPlayground } from '@coze-arch/bot-api/plugin_develop';\nimport { type PluginFrom } from '@coze-arch/bot-api/playground_api';\nimport { type OrderBy, type PluginApi } from '@coze-arch/bot-api/developer_api';\n\nimport { type MineActiveEnum } from '../constants/plugin-modal-constants';\n\nexport interface CommonQuery {\n  search: string;\n  type: string | number;\n  page: number;\n  orderBy: OrderBy;\n  mineActive: MineActiveEnum;\n}\nexport interface ListItemCommon {\n  belong_page?: number;\n}\nexport interface RequestServiceResp<ListItem extends ListItemCommon> {\n  list: Array<ListItem>;\n  total: number;\n  hasMore?: boolean;\n}\n\nexport interface PluginQuery {\n  projectId?: string;\n  devId?: string;\n  page: number;\n  search: string;\n  type: string | number;\n  orderBy: OrderBy;\n  orderByPublic: SortType | OrderBy;\n  mineActive: MineActiveEnum;\n  orderByFavorite: SortType;\n  // The backend stipulates that passing undefined does not spell query.\n  isOfficial: undefined | true;\n  // Transfer in multiAgent mode\n  agentId?: string;\n  // Recommend plugins according to bot\n  botInfo?: {\n    current_entity_type?: product_common.ProductEntityType;\n    current_entity_id?: Int64;\n    current_entity_version?: Int64;\n  };\n  pluginType?: PluginType;\n}\n\n/** Plugin pop-up window open source */\nexport enum From {\n  /** Open in workflow */\n  WorkflowAddNode = 'workflow_addNode',\n\n  /** Open in bot skills */\n  BotSkills = 'bot_skills',\n\n  /** Open in bot triggers  */\n  BotTrigger = 'bot_trigger',\n\n  /** Open in project ide */\n  ProjectIde = 'project_ide',\n\n  /** Open in project workflow */\n  ProjectWorkflow = 'project_workflow',\n}\n\nexport { OpenModeType };\nexport interface PluginModalModeProps {\n  /** Open pop-up mode:\n   * Do not pass by default\n   * only_once_add: close after adding only once and return the callback function\n   */\n  openMode?: OpenModeType;\n  from?: From;\n  openModeCallback?: (\n    val?: PluginApi & {\n      plugin_icon?: string;\n      project_id?: string;\n      version_name?: string;\n      version_ts?: string;\n      plugin_from?: PluginFrom;\n    },\n  ) => void;\n  showButton?: boolean;\n  showCopyPlugin?: boolean;\n  onCopyPluginCallback?: (val: { pluginID?: string; name?: string }) => void;\n  // In the project ide scenario, you need to pass the selected plug-in, which is used inversely\n  pluginApiList?: PluginApi[];\n  // Pass projectId in the project ide scene\n  projectId?: string;\n  // Close pop-up callback\n  closeCallback?: () => void;\n  // Click on the plugin callback in the project scene\n  clickProjectPluginCallback?: (\n    val?: PluginInfoForPlayground & {\n      listed_at?: Int64;\n    },\n  ) => void;\n  // Create a successful callback\n  onCreateSuccess?: (val?: { spaceId?: string; pluginId?: string }) => void;\n  // Whether to display store plugins\n  isShowStorePlugin?: boolean;\n  // Hide create button\n  hideCreateBtn?: boolean;\n  initQuery?: Partial<PluginQuery>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** for open coze */\nexport enum PluginAuthMode {\n  /** No authorization required */\n  NoAuth = 0,\n  /** Authorization is required, but not configured */\n  Required = 1,\n  /** Authorization is required and has been configured */\n  Configured = 2,\n  /** Authorization is required, but the configuration can be empty */\n  Supported = 3,\n  /** Authorization is required, but the configuration can be empty */\n  NeedInstalled = 9,\n}\n\nexport interface AuthMode {\n  /** for open coze */\n  auth_mode?: PluginAuthMode;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type PluginApi } from '@coze-arch/bot-api/developer_api';\nimport IconAllActive from '@coze-common/assets/svg/icon_all_active.svg';\nimport IconAll from '@coze-common/assets/svg/icon_all.svg';\nimport IconAIActive from '@coze-common/assets/svg/icon_ai_active.svg';\nimport IconAI from '@coze-common/assets/svg/icon_ai.svg';\n\nexport const getDefaultPluginCategory = () => ({\n  active_icon_url: IconAllActive,\n  icon_url: IconAll,\n  id: '',\n  name: I18n.t('All'),\n});\n\nexport const getRecommendPluginCategory = () => ({\n  active_icon_url: IconAIActive,\n  icon_url: IconAI,\n  id: 'recommend',\n  name: I18n.t('plugin_category_auto_suggestion'),\n});\n\nexport const getPluginApiKey = (api: Pick<PluginApi, 'plugin_id' | 'name'>) =>\n  (api.plugin_id ?? '0') + (api.name ?? '');\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PluginApi } from '@coze-arch/bot-api/developer_api';\n\nexport const getApiUniqueId = ({\n  apiInfo,\n}: {\n  apiInfo?: Pick<PluginApi, 'plugin_id' | 'name'>;\n}): string =>\n  apiInfo?.name && apiInfo?.plugin_id\n    ? `${apiInfo.name}_${apiInfo.plugin_id}`\n    : '';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport qs from 'qs';\nimport { useSpaceStore } from '@coze-foundation/space-store';\nimport {\n  type Int64,\n  ProductEntityType,\n  type ProductInfo,\n  type public_api,\n  ProductListSource,\n  type CommercialSetting,\n} from '@coze-arch/bot-api/product_api';\nimport {\n  type PluginInfoForPlayground,\n  PluginType,\n} from '@coze-arch/bot-api/plugin_develop';\n// import { type PluginInfoForPlayground } from '@coze-arch/bot-api/developer_api';\nimport { ProductApi, PluginDevelopApi } from '@coze-arch/bot-api';\n\nimport { type RequestServiceResp } from '../types/plugin-modal-types';\nimport { type AuthMode } from '../types/auth-mode';\nimport { DEFAULT_PAGE_SIZE } from '../constants/plugin-modal-constants';\n\ntype ProductMetaInfo = public_api.ProductMetaInfo;\ntype PluginExtraInfo = public_api.PluginExtraInfo;\n\nexport type SimplifyProductInfo = Pick<\n  ProductMetaInfo,\n  | 'id'\n  | 'category'\n  | 'entity_type'\n  | 'favorite_count'\n  | 'heat'\n  | 'is_favorited'\n  | 'is_free'\n  | 'status'\n  | 'listed_at'\n  | 'user_info'\n> & { favorite_time: string; version_name?: string } & PluginExtraInfo &\n  AuthMode;\n\nexport interface PluginContentListItem {\n  productInfo?: SimplifyProductInfo;\n  pluginInfo: PluginInfoForPlayground;\n  belong_page?: number;\n  isFromMarket?: boolean; //Where is the data obtained from?\n  commercial_setting?: CommercialSetting;\n}\n\nconst filterProductListParams = (key: string, value: unknown) => {\n  const keyMap: {\n    [K in keyof Pick<\n      Required<public_api.GetProductListRequest>,\n      'current_entity_id' | 'current_entity_version'\n    >]: K;\n  } = {\n    current_entity_id: 'current_entity_id',\n    current_entity_version: 'current_entity_version',\n  };\n  if (!(key in keyMap)) {\n    return value;\n  }\n  // The keyMap key corresponds to the value stringifyNumber to filter out illegal values \"'\n  if (value === '') {\n    return;\n  }\n  return value;\n};\n\nfunction formatPluginApiProductInfo(productInfo: ProductInfo) {\n  const name = productInfo?.meta_info?.name;\n  const pluginId = `${productInfo?.meta_info?.entity_id || ''}`;\n  const apiList = productInfo?.plugin_extra?.tools;\n  return apiList?.map(item => ({\n    api_id: `${item?.id || ''}`,\n    desc: item?.description,\n    name: item?.name,\n    plugin_id: pluginId,\n    plugin_name: name,\n    record_id: '',\n    // Plugin preset card information\n    card_binding_info: {\n      thumbnail: item?.card_info?.card_url,\n    },\n    parameters: item?.parameters?.map(param => ({\n      name: param?.name,\n      desc: param?.description,\n      required: param?.required,\n      type: param?.type,\n      sub_params: param?.sub_params,\n    })),\n    debug_example: item?.example,\n  }));\n}\n\nfunction formatPluginProductInfo(\n  item: ProductInfo,\n  currentPage: number,\n  favoriteTime: Int64 = '',\n): PluginContentListItem {\n  return {\n    productInfo: {\n      id: String(item?.meta_info?.id),\n      category: item?.meta_info?.category,\n      entity_type: item?.meta_info?.entity_type,\n      favorite_count: item?.meta_info?.favorite_count,\n      heat: item?.meta_info?.heat,\n      is_favorited: item?.meta_info?.is_favorited,\n      is_free: item?.meta_info?.is_free,\n      favorite_time: String(favoriteTime || ''),\n      status: item?.meta_info?.status,\n      listed_at: item?.meta_info?.listed_at,\n      user_info: item.meta_info.user_info,\n      ...item.plugin_extra,\n    },\n    pluginInfo: {\n      name: item?.meta_info?.name,\n      plugin_apis: formatPluginApiProductInfo(item),\n      id: `${item?.meta_info?.entity_id || ''}`,\n      plugin_icon: item?.meta_info?.icon_url,\n      desc_for_human: item?.meta_info?.description,\n      creator: {\n        id: `${item?.meta_info?.user_info?.user_id || ''}`,\n        name: item?.meta_info?.user_info?.name,\n        avatar_url: item?.meta_info?.user_info?.avatar_url,\n      },\n      statistic_data: {\n        bot_quote: item?.plugin_extra?.bots_use_count || 0,\n      },\n      tag: item?.meta_info?.category?.id,\n    },\n    isFromMarket: true,\n    belong_page: currentPage,\n\n    commercial_setting: item.commercial_setting,\n  };\n}\n\n// Pull, Plugin Market, Plugin Product List\nasync function getPluginFromMarket(\n  // @ts-expect-error -- linter-disable-autofix\n  queryParams,\n  // @ts-expect-error -- linter-disable-autofix\n  commParams,\n): Promise<RequestServiceResp<PluginContentListItem> | undefined> {\n  const { nextPage, isCoze } = commParams;\n\n  const {\n    search,\n    type,\n    orderByPublic,\n    botInfo = {},\n    isOfficial,\n    pluginType,\n  } = queryParams;\n\n  const res = await ProductApi.PublicGetProductList(\n    {\n      entity_type: isCoze\n        ? ProductEntityType.SaasPlugin\n        : ProductEntityType.Plugin,\n      category_id: type === 'recommend' || IS_OPEN_SOURCE ? undefined : type,\n      sort_type: orderByPublic,\n      page_num: nextPage,\n      page_size: 20,\n      keyword: search,\n      source:\n        type === 'recommend'\n          ? ProductListSource.CustomizedRecommend\n          : undefined,\n      is_official: isOfficial,\n      plugin_type: pluginType,\n      ...botInfo,\n    },\n    {\n      paramsSerializer: p =>\n        qs.stringify(p, {\n          filter: filterProductListParams,\n        }),\n    },\n  );\n  const list = (res?.data?.products || []).map(item =>\n    formatPluginProductInfo(item, nextPage),\n  );\n  const hasMore = (list.length > 0 && res?.data?.has_more) || false;\n  return {\n    list,\n    total: -1,\n    hasMore,\n  };\n}\n\nasync function getPluginFromFavorite(\n  // @ts-expect-error -- linter-disable-autofix\n  queryParams,\n  // @ts-expect-error -- linter-disable-autofix\n  commParams,\n): Promise<RequestServiceResp<PluginContentListItem> | undefined> {\n  const { nextPage } = commParams;\n\n  const { search, orderByFavorite } = queryParams;\n  const res = await ProductApi.PublicGetUserFavoriteList({\n    entity_type: ProductEntityType.Plugin,\n    sort_type: orderByFavorite,\n    page_num: nextPage,\n    page_size: 20,\n    key_wrod: search,\n  });\n  const list = (res?.data?.favorite_products || [])?.map(item =>\n    formatPluginProductInfo(\n      item.product,\n      nextPage,\n      `${item?.created_at || ''}`,\n    ),\n  );\n  const hasMore = (list.length > 0 && res?.data?.has_more) || false;\n  return {\n    list,\n    total: -1,\n    hasMore,\n  };\n}\nfunction getPluginFromMinOrTeam(\n  // @ts-expect-error -- linter-disable-autofix\n  queryParams,\n  // @ts-expect-error -- linter-disable-autofix\n  commParams,\n): Promise<RequestServiceResp<PluginContentListItem> | undefined> {\n  const { isMine, isTeam, isCreatorMine, isTemplate, nextPage } = commParams;\n  const pluginTypes = [PluginType.PLUGIN, PluginType.APP, PluginType.LOCAL];\n\n  const { search, orderByPublic, orderBy } = queryParams;\n  const params = {\n    page: nextPage || 1,\n    size: DEFAULT_PAGE_SIZE,\n    name: search || void 0,\n    self_created: isMine || (isTeam && isCreatorMine) ? true : undefined,\n    order_by: isTemplate ? orderByPublic : orderBy,\n    plugin_types: pluginTypes,\n    space_id: useSpaceStore.getState().getSpaceId(),\n    channel_id: 1,\n  };\n\n  return PluginDevelopApi.GetPlaygroundPluginList(params).then(res => {\n    const list =\n      res.data?.plugin_list?.map(item => ({\n        pluginInfo: item,\n        isFromMarket: false,\n        // The current data belongs to the data of the page, which is used for page data replacement\n        // If you replace page + size with id + count later, you can remove this logic.\n        belong_page: nextPage,\n      })) || [];\n    const hasMore =\n      list.length > 0 && nextPage * DEFAULT_PAGE_SIZE < Number(res.data?.total);\n    return {\n      list,\n      total: -1,\n      hasMore,\n    };\n  });\n}\n\nasync function getPluginFromProject(\n  // @ts-expect-error -- linter-disable-autofix\n  queryParams,\n  // @ts-expect-error -- linter-disable-autofix\n  commParams,\n): Promise<RequestServiceResp<PluginContentListItem> | undefined> {\n  const { nextPage } = commParams;\n  const { search, projectId, devId, orderBy } = queryParams;\n  const res = await PluginDevelopApi.GetDevPluginList({\n    page: nextPage,\n    size: DEFAULT_PAGE_SIZE,\n    space_id: useSpaceStore.getState().getSpaceId(),\n    name: search,\n    dev_id: devId,\n    project_id: projectId,\n    order_by: orderBy,\n  });\n  const list = (res?.plugin_list || [])?.map(item => ({\n    pluginInfo: item,\n    isFromMarket: false,\n    belong_page: nextPage,\n  }));\n  const hasMore =\n    list.length > 0 && nextPage * DEFAULT_PAGE_SIZE < Number(res?.total);\n  return {\n    list,\n    total: -1,\n    hasMore,\n  };\n}\n\n// @ts-expect-error -- linter-disable-autofix\nexport const fetchPlugin = (queryParams, commParams) => {\n  const { isMine, isTeam, isFavorite, isProject } = commParams;\n  console.log('[div] params:', queryParams, commParams);\n  if (isMine || isTeam) {\n    return getPluginFromMinOrTeam(queryParams, commParams);\n  } else if (isFavorite) {\n    return getPluginFromFavorite(queryParams, commParams);\n  } else if (isProject) {\n    return getPluginFromProject(queryParams, commParams);\n  }\n  return getPluginFromMarket(queryParams, commParams);\n};\n\n// @ts-expect-error -- linter-disable-autofix\nexport const formatCacheKey = ({ query, isSearching, isTemplate, page }) => {\n  const { orderBy, orderByPublic, type, mineActive } = query;\n  if (isSearching) {\n    return;\n  }\n  if (isTemplate) {\n    return `plugin-${type}-${page}-${orderByPublic}`;\n  }\n  return `plugin-${type}-${page}-${orderBy}-${mineActive}`;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozPluginCitation,\n  IconCozBot,\n  IconCozClock,\n  IconCozSuccessRate,\n} from '@coze-arch/coze-design/icons';\nimport { Tooltip } from '@coze-arch/coze-design';\nimport { formatNumber, formatPercent, formatTime } from '@coze-arch/bot-utils';\n\nimport s from './index.module.less';\n\nexport interface PluginPerfStaticsProps {\n  avgExecTime?: number;\n  callAmount?: number;\n  successRate?: number;\n  botsUseCount?: number;\n  className?: string;\n}\n\nexport const PluginPerfStatics = (props: PluginPerfStaticsProps) => {\n  const { avgExecTime, callAmount, successRate, botsUseCount, className } =\n    props;\n\n  if (IS_OPEN_SOURCE) {\n    return null;\n  }\n\n  if (\n    [avgExecTime, callAmount, successRate, botsUseCount].every(\n      r => r === undefined,\n    )\n  ) {\n    return null;\n  }\n\n  return (\n    <div className={cls(className, s['plugin-perf-statics'])}>\n      <Tooltip content={I18n.t('plugin_metric_usage_count')}>\n        <div className={s['statics-metrics']}>\n          <IconCozPluginCitation />\n          {formatNumber(callAmount || 0)}\n        </div>\n      </Tooltip>\n      <Tooltip content={I18n.t('plugin_metric_bots_using')}>\n        <div className={s['statics-metrics']}>\n          <IconCozBot />\n          {formatNumber(botsUseCount || 0)}\n        </div>\n      </Tooltip>\n      <Tooltip content={I18n.t('plugin_metric_average_time')}>\n        <div className={s['statics-metrics']}>\n          <IconCozClock />\n          {formatTime(avgExecTime || 0)}\n        </div>\n      </Tooltip>\n      <Tooltip content={I18n.t('plugin_metric_success_rate')}>\n        <div className={s['statics-metrics']}>\n          <IconCozSuccessRate />\n          {formatPercent(successRate)}\n        </div>\n      </Tooltip>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type PropsWithChildren } from 'react';\n\n// import { I18n } from '@coze-arch/i18n';\nimport { IconCozDiamondFill } from '@coze-arch/coze-design/icons';\nimport { AIButton, Popover, Space } from '@coze-arch/coze-design';\n\nexport interface ActivatePopoverProps {\n  id?: string;\n  show?: boolean;\n}\n\n// popover\nexport const ActivatePopover: FC<PropsWithChildren<ActivatePopoverProps>> = ({\n  children,\n  id,\n  show = true,\n}) =>\n  !show ? (\n    children\n  ) : (\n    <Popover\n      content={\n        <div>\n          <Space spacing={6}>\n            <IconCozDiamondFill className=\"text-[16px] coz-fg-hglt\" />\n            <span className=\"font-[500] \"></span>\n          </Space>\n\n          <div className=\"my-[8px] \">\n            \n          </div>\n\n          <div>\n            <AIButton\n              className=\"w-full\"\n              color=\"aiplus\"\n              hideIcon={true}\n              onClick={() => {\n                window.open(\n                  `https://www.coze.cn/store/plugin/${id}?from=coze-studio-open`,\n                  '_blank',\n                );\n              }}\n            >\n              \n            </AIButton>\n          </div>\n        </div>\n      }\n      showArrow\n    >\n      {children}\n    </Popover>\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n\nimport { useState } from 'react';\n\nimport { sortBy } from 'lodash-es';\nimport classNames from 'classnames';\nimport { useBoolean } from 'ahooks';\nimport { type WorkflowNodeJSON } from '@flowgram-adapter/free-layout-editor';\nimport { ParametersPopover } from '@coze-studio/components/parameters-popover';\nimport { CardThumbnailPopover } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { Popconfirm } from '@coze-arch/coze-design';\nimport {\n  Space,\n  Tooltip,\n  Typography,\n  UIButton,\n  UITag,\n} from '@coze-arch/bot-semi';\nimport { ProductStatus, type public_api } from '@coze-arch/bot-api/product_api';\nimport { type PluginApi } from '@coze-arch/bot-api/plugin_develop';\nimport { useViewExample } from '@coze-agent-ide/bot-plugin-tools/useViewExample';\nimport { OverflowList } from '@blueprintjs/core';\n\nimport { From } from '../../types/plugin-modal-types';\nimport { PluginAuthMode } from '../../types/auth-mode';\nimport { PluginPerfStatics } from './plugin-perf-statics';\nimport { ActivatePopover } from './activate-popover';\n\nimport s from './index.module.less';\n\ntype PluginToolInfo = public_api.PluginToolInfo;\n\nexport interface PluginItemProps {\n  isAdded?: boolean;\n  onApiToggle: () => Promise<boolean>;\n  pluginApi: PluginApi;\n  showButton?: boolean;\n  marketStatus?: ProductStatus;\n  from?: From;\n  workflowNodes?: WorkflowNodeJSON[];\n  loading?: boolean;\n  marketPluginInfo?: PluginToolInfo;\n  isLocalPlugin?: boolean;\n  connectors?: string[];\n  auth_mode?: PluginAuthMode;\n  productId?: string;\n}\n\ninterface OverflowTagItem {\n  tagName?: string;\n  key?: string;\n}\n\n// eslint-disable-next-line complexity\nexport const PluginItem: React.FC<PluginItemProps> = ({\n  isAdded,\n  onApiToggle,\n  pluginApi,\n  marketStatus,\n  showButton,\n  from,\n  workflowNodes,\n  loading,\n  marketPluginInfo,\n  isLocalPlugin,\n  connectors,\n  auth_mode,\n  productId,\n}) => {\n  const { name, desc, parameters, debug_example } = pluginApi;\n  const { exampleNode, doShowExample } = useViewExample();\n  const [isMouseIn, { setFalse, setTrue }] = useBoolean(false);\n\n  const onMouseEnter = () => {\n    setTrue();\n  };\n  const onMouseLeave = () => {\n    setFalse();\n  };\n\n  const [count, setCount] = useState((workflowNodes || []).length);\n  const isFromWorkflow =\n    from === From.WorkflowAddNode || from === From.ProjectWorkflow;\n\n  const renderOverflow = (items: OverflowTagItem[]) =>\n    items.length ? (\n      <UITag className={s['tag-item']} size=\"small\">\n        +{items.length}\n      </UITag>\n    ) : null;\n\n  const renderItem = (item: OverflowTagItem) => (\n    <UITag className={s['tag-item']} size=\"small\" key={item.key}>\n      {item.tagName}\n    </UITag>\n  );\n  const isDisabled =\n    marketStatus === ProductStatus?.Unlisted ||\n    auth_mode === PluginAuthMode.NeedInstalled;\n  // The end plug-in has not been added, and the applicable channel is prompted.\n  const showAddConfirm =\n    isLocalPlugin &&\n    ((!isFromWorkflow && !isAdded) || (isFromWorkflow && count === 0));\n  return (\n    <>\n      {exampleNode}\n      <div className={s['plugin-item']}>\n        <div className={s['plugin-api-main']}>\n          <Space className={s['plugin-api-name']}>\n            <Typography.Text\n              ellipsis={{\n                showTooltip: {\n                  opts: {\n                    content: name,\n                    style: { wordBreak: 'break-word' },\n                  },\n                },\n              }}\n            >\n              {name}\n            </Typography.Text>\n            {/* Preview preview card */}\n            {pluginApi?.card_binding_info?.thumbnail ? (\n              <CardThumbnailPopover\n                url={pluginApi?.card_binding_info?.thumbnail}\n              />\n            ) : null}\n          </Space>\n          <div className={s['plugin-api-desc']}>\n            <Typography.Text\n              style={{ width: 640 }}\n              ellipsis={{\n                showTooltip: {\n                  opts: {\n                    content: desc,\n                    style: { wordBreak: 'break-word', maxWidth: '560px' },\n                  },\n                },\n                rows: 1,\n              }}\n            >\n              {desc}\n            </Typography.Text>\n            {!!parameters?.length && (\n              <div className={s['api-params']}>\n                <OverflowList\n                  items={sortBy(\n                    parameters,\n                    item => item.name?.length,\n                  )?.map<OverflowTagItem>((tag, index) => ({\n                    tagName: tag.name,\n                    key: String(index),\n                  }))}\n                  overflowRenderer={renderOverflow}\n                  visibleItemRenderer={renderItem}\n                  collapseFrom=\"end\"\n                  className={s['params-tags']}\n                />\n                <ParametersPopover pluginApi={pluginApi}>\n                  <div className={s['params-desc']}>{I18n.t('parameters')}</div>\n                </ParametersPopover>\n                {debug_example ? (\n                  <div\n                    className={s['params-desc']}\n                    style={{ marginLeft: '8px' }}\n                    onClick={() =>\n                      doShowExample({\n                        scene: 'bot',\n                        requestParams: parameters,\n                        debugExample: debug_example,\n                      })\n                    }\n                  >\n                    {I18n.t('plugin_edit_tool_view_example')}\n                  </div>\n                ) : null}\n              </div>\n            )}\n            <PluginPerfStatics\n              className={s['store-plugin-tools']}\n              callAmount={marketPluginInfo?.call_amount}\n              avgExecTime={marketPluginInfo?.avg_exec_time}\n              successRate={marketPluginInfo?.success_rate}\n              botsUseCount={marketPluginInfo?.bots_use_count}\n            />\n          </div>\n        </div>\n        <div className={s['plugin-api-method']}>\n          {showButton ? (\n            <Popconfirm\n              key={`${showAddConfirm}`}\n              trigger={!isDisabled && showAddConfirm ? 'click' : 'custom'}\n              position=\"bottomRight\"\n              title={I18n.t('store_service_plugin_connector_only', {\n                connector_names: connectors?.join(''),\n              })}\n              okText={I18n.t('Add_1')}\n              cancelText={I18n.t('Cancel')}\n              onConfirm={() => {\n                onApiToggle?.().then(isSuccess => {\n                  if (isSuccess) {\n                    setCount(prev => prev + 1);\n                  }\n                });\n              }}\n            >\n              <div>\n                <Tooltip\n                  content={I18n.t('mkpl_plugin_delisted_tips')}\n                  trigger={isDisabled ? 'hover' : 'custom'}\n                >\n                  <ActivatePopover\n                    id={productId}\n                    show={auth_mode === PluginAuthMode.NeedInstalled}\n                  >\n                    <UIButton\n                      data-testid=\"bot.ide.plugin.plugin-panel-plugin-item-btn\"\n                      className={classNames(s['operator-btn'], {\n                        [s.added]: !isDisabled && isAdded,\n                        [s.addedMouseIn]: !isDisabled && isAdded && isMouseIn,\n                      })}\n                      onClick={() => {\n                        if (showAddConfirm) {\n                          return;\n                        }\n                        onApiToggle?.().then(isSuccess => {\n                          if (isSuccess) {\n                            setCount(prev => prev + 1);\n                          }\n                        });\n                      }}\n                      onMouseEnter={onMouseEnter}\n                      disabled={isDisabled}\n                      loading={loading && isFromWorkflow}\n                      onMouseLeave={onMouseLeave}\n                    >\n                      {isAdded && !isDisabled ? (\n                        isMouseIn ? (\n                          I18n.t('Remove')\n                        ) : (\n                          I18n.t('Added')\n                        )\n                      ) : (\n                        <>\n                          <span>{I18n.t('Add_1')}</span>\n                          {isFromWorkflow && count !== 0 ? (\n                            <span className={s.workflow_count_span}>\n                              {count}\n                            </span>\n                          ) : null}\n                        </>\n                      )}\n                    </UIButton>\n                  </ActivatePopover>\n                </Tooltip>\n              </div>\n            </Popconfirm>\n          ) : null}\n        </div>\n        {/* <Switch\n        disabled={isReadonly}\n        checked={Boolean(\n          $enabledPluginApiList.apiList.find(\n            api =>\n              (api.plugin_id?.toString() ?? '0') + (api.name ?? '') ===\n              (plugin_id?.toString() ?? '0') + (name ?? ''),\n          ),\n        )}\n        onChange={checked => {\n          if (!checked) {\n            const index = $enabledPluginApiList.apiList.findIndex(\n              api =>\n                (api.plugin_id?.toString() ?? '0') + (api.name ?? '') ===\n                (plugin_id?.toString() ?? '0') + (name ?? ''),\n            );\n\n            if (index >= 0) {\n              $enabledPluginApiList.apiList.splice(index, 1);\n            }\n            return;\n          }\n          $enabledPluginApiList.apiList.push(pluginApi);\n        }}\n      /> */}\n      </div>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface ApiParam {\n  name: string;\n  input: {\n    type: string;\n    value: {\n      type: string;\n      content: string;\n    };\n  };\n}\n\nexport const extractApiParams = (paramName: string, apiParams: ApiParam[]) => {\n  const param = apiParams.find(item => item.name === paramName);\n  return param?.input?.value?.content ?? '';\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\n/* eslint-disable @coze-arch/max-line-per-function */\n\n/* eslint-disable max-lines-per-function, complexity -- onApiToggle of PluginItem can be extracted and optimized later */\n/* eslint-disable import/order */\nimport {\n  type MutableRefObject,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { type WorkflowNodeJSON } from '@flowgram-adapter/free-layout-editor';\n\nimport classNames from 'classnames';\nimport { useInViewport } from 'ahooks';\nimport groupBy from 'lodash-es/groupBy';\n\nimport {\n  Collapse,\n  Divider,\n  Highlight,\n  Image,\n  Space,\n  Toast,\n  Typography,\n  UIButton,\n} from '@coze-arch/bot-semi';\nimport { IconViewinchatOutlined } from '@coze-arch/bot-icons';\nimport { ConnectorList, OfficialLabel } from '@coze-community/components';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  emitEvent,\n  OpenBlockEvent,\n  formatDate,\n  formatNumber,\n} from '@coze-arch/bot-utils';\n\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\nimport { useBotInfoStore } from '@coze-studio/bot-detail-store/bot-info';\n\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { OpenModeType } from '@coze-arch/bot-hooks';\nimport {\n  From,\n  type PluginModalModeProps,\n} from '../../types/plugin-modal-types';\nimport { getPluginApiKey } from '../../utils';\nimport {\n  type PluginApi,\n  type PluginInfoForPlayground,\n  PluginType,\n} from '@coze-arch/bot-api/plugin_develop';\nimport { type Int64 } from '@coze-arch/bot-api/developer_api';\nimport { ProductEntityType } from '@coze-arch/bot-api/product_api';\nimport { PluginFrom } from '@coze-arch/bot-api/playground_api';\n\nimport s from './index.module.less';\nimport { type SimplifyProductInfo } from '../../service/fetch-plugin';\nimport { PluginItem } from './item';\nimport { extractApiParams } from './helper';\nimport { AvatarName } from '@coze-studio/components';\n\nimport { PluginPerfStatics } from './plugin-perf-statics';\nimport { withSlardarIdButton } from '@coze-studio/bot-utils';\nimport { Tag, Tooltip } from '@coze-arch/coze-design';\n\nimport {\n  IconCozDesktop,\n  IconCozInfoCircle,\n} from '@coze-arch/coze-design/icons';\nimport { ActivatePopover } from './activate-popover';\nimport { isBoolean, isUndefined } from 'lodash-es';\nimport {\n  type CommercialSetting,\n  PluginType as ProductPluginType,\n} from '@coze-arch/bot-api/product_api';\nimport { PluginAuthMode } from '../../types/auth-mode';\nexport interface PluginPanelProps extends PluginModalModeProps {\n  info: PluginInfoForPlayground & {\n    listed_at?: Int64;\n    version_name?: string;\n    version_ts?: string;\n  };\n  highlightWords?: string[];\n  showButton?: boolean;\n  showCreator?: boolean;\n  showCreateTime?: boolean;\n  showMarketLink?: boolean;\n  showProjectPluginLink?: boolean;\n  showPublishTime?: boolean;\n  className?: string;\n  pluginApiList: PluginApi[];\n  onPluginApiListChange: (list: PluginApi[]) => void;\n  productInfo?: SimplifyProductInfo;\n  commercialSetting?: CommercialSetting;\n  isFromMarket?: boolean;\n  type?: string;\n  scrollContainerRef?: MutableRefObject<HTMLDivElement | null>;\n  activeKey?: string | string[] | undefined;\n  agentId?: string;\n  workflowNodes?: WorkflowNodeJSON[];\n  index?: number;\n  addonBefore?: React.ReactNode;\n  addonAfter?: React.ReactNode;\n}\n\nconst CopyPlugin = ({ onApiToggle }: { onApiToggle: () => void }) => (\n  <UIButton\n    onClick={e => {\n      e.stopPropagation();\n      onApiToggle?.();\n    }}\n  >\n    {I18n.t('add_resource_modal_copy_to_project')}\n  </UIButton>\n);\n\nexport const PluginPanel: React.FC<PluginPanelProps> = ({\n  info,\n  highlightWords,\n  showCreator = false,\n  showCreateTime = true,\n  showPublishTime = false,\n  showButton = true,\n  showCopyPlugin = false,\n  className = '',\n  pluginApiList,\n  productInfo,\n  showMarketLink,\n  showProjectPluginLink,\n  clickProjectPluginCallback,\n  isFromMarket,\n  onPluginApiListChange,\n  openMode,\n  from,\n  workflowNodes,\n  openModeCallback,\n  onCopyPluginCallback,\n  scrollContainerRef,\n  type,\n  activeKey,\n  agentId,\n  index = 0,\n  addonBefore,\n  addonAfter,\n}) => {\n  const {\n    name,\n    plugin_apis,\n    id,\n    plugin_icon,\n    project_id,\n    desc_for_human,\n    create_time = 0,\n    update_time = 0,\n    statistic_data,\n    listed_at,\n    plugin_product_status,\n    plugin_type,\n    is_official,\n    version_name,\n    version_ts,\n  } = info;\n  const botId = useBotInfoStore(state => state.botId);\n  const { id: productId, status: marketStatus, auth_mode } = productInfo || {};\n  const refTarget = useRef(null);\n  const refHasReport = useRef(false);\n\n  // Record the apiId of the currently clicked plugin\n  const currentApiId = useRef('');\n\n  // Record whether the latest plug-in data of the store is currently being pulled\n  const [isFetching, setIsFetching] = useState(false);\n\n  // For example {'pluginID_apiID': [node1, node2, node3,...]}\n  const pluginApiNodesMap = useMemo(\n    () =>\n      groupBy(workflowNodes || [], item => {\n        const apiParams = item.data?.inputs?.apiParam ?? [];\n        const pluginID = extractApiParams('pluginID', apiParams);\n        const apiID = extractApiParams('apiID', apiParams);\n        return `${pluginID}_${apiID}`;\n      }),\n    [workflowNodes],\n  );\n\n  const [isInView] = useInViewport(refTarget, {\n    root: () => scrollContainerRef?.current,\n  });\n  const isCheckNow = useMemo(() => {\n    if (!id) {\n      return false;\n    }\n    if (activeKey === id || activeKey?.includes(id)) {\n      return true;\n    }\n    return false;\n  }, [activeKey, id]);\n  useEffect(() => {\n    if (isCheckNow) {\n      sendTeaEvent(EVENT_NAMES.product_click_front, {\n        plugin_id: info.id,\n        product_id: `${productInfo?.id}`,\n        product_name: info?.name || '',\n        entity_type: 'plugin',\n        source: 'add_plugin_menu',\n        from: 'add_plugin_menu',\n        filter_tag: type || '',\n        action: 'expand_tools',\n        c_position: index,\n      });\n    }\n  }, [isCheckNow, productInfo?.id]);\n  useEffect(() => {\n    if (!isFromMarket || refHasReport.current) {\n      return;\n    }\n    if (isInView) {\n      refHasReport.current = true;\n      sendTeaEvent(EVENT_NAMES.product_show_front, {\n        plugin_id: info.id,\n        product_id: `${productInfo?.id}`,\n        product_name: info?.name || '',\n        entity_type: 'plugin',\n        source: 'add_plugin_menu',\n        from: 'add_plugin_menu',\n        filter_tag: type || '',\n        c_position: index,\n      });\n    }\n  }, [isInView, productInfo, info, type]);\n\n  const timePrefixText = showPublishTime\n    ? I18n.t('mkl_plugin_publish')\n    : showCreateTime\n      ? I18n.t('mkl_plugin_created')\n      : I18n.t('mkl_plugin_updated');\n  const timeToShow =\n    (showPublishTime\n      ? Number(listed_at)\n      : showCreateTime\n        ? Number(create_time)\n        : Number(update_time)) || 0;\n\n  const renderAuthStatus = () => {\n    if (isUndefined(auth_mode) || auth_mode === PluginAuthMode.NoAuth) {\n      return null;\n    }\n    if (auth_mode === PluginAuthMode.NeedInstalled) {\n      return (\n        <ActivatePopover id={productId}>\n          <Tag color=\"yellow\" className=\"font-medium !py-2px !px-4px !h-20px\">\n            \n          </Tag>\n        </ActivatePopover>\n      );\n    }\n\n    if (\n      auth_mode === PluginAuthMode.Required ||\n      auth_mode === PluginAuthMode.Supported\n    ) {\n      return (\n        <Tag color=\"yellow\" className=\"font-medium !py-2px !px-4px !h-20px\">\n          {I18n.t('plugin_tool_config_status_unauthorized')}\n        </Tag>\n      );\n    }\n    return (\n      <Tag color=\"brand\" className=\"font-medium !py-2px !px-4px !h-20px\">\n        {I18n.t('plugin_tool_config_status_authorized')}\n      </Tag>\n    );\n  };\n\n  return (\n    <Collapse.Panel\n      data-testid=\"plugin-collapse-panel\"\n      className={classNames(s['plugin-panel'], className)}\n      disabled={!plugin_apis?.length}\n      header={\n        <div className={s['plugin-panel-header']} ref={refTarget}>\n          <OfficialLabel\n            size=\"small\"\n            visible={productInfo?.is_official ?? false}\n          >\n            <Image\n              className={s['header-icon']}\n              src={plugin_icon}\n              preview={false}\n            />\n          </OfficialLabel>\n\n          <div className={s['header-main']}>\n            <div className={s['header-name']}>\n              <Space spacing={8} className=\"flex-1\">\n                {/* Plugin name up to 30 characters, no ellipsis required */}\n                <Typography.Text>\n                  <Highlight\n                    sourceString={name}\n                    searchWords={highlightWords}\n                    component=\"strong\"\n                  />\n                </Typography.Text>\n                {renderAuthStatus()}\n                {showProjectPluginLink && clickProjectPluginCallback ? (\n                  <IconViewinchatOutlined\n                    className={s['market-link-icon']}\n                    onClick={event => {\n                      event.stopPropagation();\n                      clickProjectPluginCallback?.({\n                        ...info,\n                      });\n                    }}\n                  />\n                ) : null}\n                {showMarketLink && Number(productId) > 0 ? (\n                  <IconViewinchatOutlined\n                    className={s['market-link-icon']}\n                    onClick={event => {\n                      event.stopPropagation();\n                      sendTeaEvent(EVENT_NAMES.product_click_front, {\n                        plugin_id: info.id,\n                        product_id: `${productInfo?.id}`,\n                        product_name: info?.name || '',\n                        entity_type: 'plugin',\n                        source: 'add_plugin_menu',\n                        from: 'add_plugin_menu',\n                        filter_tag: type || '',\n                        action: 'enter_detailpage',\n                        c_position: index,\n                      });\n                      window.open(\n                        `/store/plugin/${productId}?from=add_plugin_menu`,\n                      );\n                    }}\n                  />\n                ) : null}\n              </Space>\n            </div>\n            <div className={classNames(s['header-desc'], 'flex items-center')}>\n              {plugin_type === PluginType.LOCAL ? (\n                <>\n                  <Tag color=\"cyan\" size=\"mini\">\n                    {I18n.t('local_plugin_label')}\n                  </Tag>\n                  <Divider layout=\"vertical\" margin=\"4px\" className=\"h-[9px]\" />\n                </>\n              ) : null}\n              <Typography.Text\n                ellipsis={{\n                  showTooltip: {\n                    opts: {\n                      content: desc_for_human,\n                      style: { wordWrap: 'break-word', maxWidth: '560px' },\n                    },\n                  },\n                  rows: 1,\n                }}\n              >\n                {desc_for_human}\n              </Typography.Text>\n            </div>\n\n            <div className=\"my-[8px] leading-[16px]\">\n              <Space spacing={4}>\n                {/* condition */}\n\n                {addonBefore}\n                {productInfo?.plugin_type === ProductPluginType.LocalPlugin ? (\n                  <Tag\n                    color=\"cyan\"\n                    prefixIcon={\n                      <IconCozDesktop className=\"coz-fg-color-cyan text-[10px]\" />\n                    }\n                    size=\"mini\"\n                  >\n                    {I18n.t('store_service_plugin')}\n                  </Tag>\n                ) : null}\n                <Tag color=\"primary\" size=\"mini\">\n                  {I18n.t('bot_edit_page_plugin_list_plugin_has_n_tools', {\n                    n: plugin_apis?.length,\n                  })}\n                </Tag>\n                {!!statistic_data?.bot_quote && (\n                  <Tag color=\"primary\" size=\"mini\">\n                    {I18n.t('bot_edit_page_plugin_list_plugin_n_bots_using', {\n                      n: formatNumber(statistic_data?.bot_quote),\n                    })}\n                  </Tag>\n                )}\n                {productInfo?.connectors?.length ? (\n                  <>\n                    <Divider\n                      layout=\"vertical\"\n                      margin={0}\n                      className=\"coz-stroke-primary\"\n                    />\n                    <div className=\"ml-auto coz-fg-secondary text-base flex items-center gap-6px\">\n                      {I18n.t('store_service_plugin_connector')}\n                      <ConnectorList connectors={productInfo?.connectors} />\n                      <Tooltip\n                        content={I18n.t('store_add_connector_tootip')}\n                        theme=\"dark\"\n                      >\n                        <IconCozInfoCircle className=\"coz-fg-secondary text-lg\" />\n                      </Tooltip>\n                    </div>\n                  </>\n                ) : null}\n              </Space>\n            </div>\n\n            <div className={'flex justify-between'}>\n              <Space className={s['header-info']}>\n                {showCreator ? (\n                  <span className={'max-w-[260px]'}>\n                    <AvatarName\n                      avatar={productInfo?.user_info?.avatar_url}\n                      username={productInfo?.user_info?.user_name}\n                      name={productInfo?.user_info?.name}\n                      label={{\n                        name: productInfo?.user_info?.user_label?.label_name,\n                        icon: productInfo?.user_info?.user_label?.icon_url,\n                        href: productInfo?.user_info?.user_label?.jump_link,\n                      }}\n                      nameMaxWidth={150}\n                    />\n                  </span>\n                ) : null}\n                {showCreator ? <Divider layout=\"vertical\" /> : null}\n                <div className={s['creator-time']}>\n                  {`${timePrefixText} `}\n                  {formatDate(timeToShow, 'YYYY-MM-DD HH:mm')}\n                </div>\n                {addonAfter}\n              </Space>\n              <PluginPerfStatics\n                className={s['plugin-total']}\n                successRate={productInfo?.success_rate}\n                callAmount={productInfo?.call_amount}\n                avgExecTime={productInfo?.avg_exec_time}\n                botsUseCount={productInfo?.bots_use_count}\n              />\n            </div>\n          </div>\n          {showCopyPlugin ? (\n            <div>\n              <CopyPlugin\n                onApiToggle={() => {\n                  onCopyPluginCallback?.({\n                    pluginID: id,\n                    name,\n                  });\n                }}\n              />\n            </div>\n          ) : null}\n        </div>\n      }\n      itemKey={`${id}`}\n    >\n      {plugin_apis?.map(api => {\n        const isAdded = pluginApiList.some(\n          addedApi =>\n            (addedApi.api_id && addedApi.api_id === api.api_id) ||\n            (addedApi.plugin_id?.toString() ?? '0') + (addedApi.name ?? '') ===\n              (api.plugin_id?.toString() ?? '0') + (api.name ?? ''),\n        );\n        return (\n          <PluginItem\n            data-testid=\"plugin-panel-item-pluginapi\"\n            isAdded={isAdded}\n            pluginApi={api}\n            productId={productInfo?.id}\n            from={from}\n            auth_mode={auth_mode}\n            workflowNodes={\n              pluginApiNodesMap[`${api?.plugin_id}_${api?.api_id}`] ?? []\n            }\n            marketPluginInfo={\n              isFromMarket\n                ? productInfo?.tools?.find(item => item.id === api.api_id)\n                : undefined\n            }\n            isLocalPlugin={\n              productInfo?.plugin_type === ProductPluginType.LocalPlugin\n            }\n            connectors={productInfo?.connectors?.map(item => item.name ?? '')}\n            marketStatus={isFromMarket ? marketStatus : undefined}\n            onApiToggle={async () => {\n              let isSuccess = true;\n              emitEvent(OpenBlockEvent.PLUGIN_API_BLOCK_OPEN);\n              if (isAdded) {\n                onPluginApiListChange(\n                  pluginApiList.filter(\n                    item =>\n                      getPluginApiKey(item) !== getPluginApiKey(api) &&\n                      (!item?.api_id || item?.api_id !== api?.api_id),\n                  ),\n                );\n                Toast.success({\n                  content: I18n.t('bot_edit_tool_removed_toast', {\n                    api_name: api.name,\n                  }),\n                  showClose: false,\n                });\n                sendTeaEvent(EVENT_NAMES.click_tool_select, {\n                  operation: 'remove',\n                  bot_id: botId,\n                  operation_type: 'single',\n                  tool_id: api?.api_id || '',\n                  tool_name: api?.name || '',\n                  product_id: `${productInfo?.id}`,\n                  product_name: info?.name || '',\n                  source: 'add_plugin_list',\n                  from: 'bot_develop',\n                });\n              } else {\n                let apiToSend: PluginApi | undefined;\n                // The information of the plugin where the api is located is added and stored in the store to avoid GetPlaygroundPluginList multiple requests\n                const pluginInfo = {\n                  plugin_icon,\n                  plugin_type,\n                  is_official,\n                  project_id,\n                  version_name,\n                  version_ts,\n                  plugin_from:\n                    productInfo?.entity_type === ProductEntityType.SaasPlugin\n                      ? PluginFrom.FromSaas\n                      : PluginFrom.Default,\n                };\n                // Check whether the name of the Plugins currently to be added has a duplicate name in the added list (the model does not support it, so this is added)\n                if (\n                  pluginApiList\n                    .map(i => (i.plugin_name ?? '') + i.name)\n                    .includes((api.plugin_name ?? '') + (api.name ?? ''))\n                ) {\n                  Toast.error({\n                    content: I18n.t('plugin_name_conflict_error'),\n                    showClose: false,\n                  });\n                  isSuccess = false;\n                } else {\n                  if (isFromMarket) {\n                    if (api.plugin_id && api?.api_id && api?.api_id !== '0') {\n                      setIsFetching(true);\n                      currentApiId.current = api.api_id;\n\n                      // Data from the market needs to be re-pulled to the latest data.\n                      const result =\n                        await PluginDevelopApi.GetPlaygroundPluginList({\n                          page: 1,\n                          size: 1,\n                          plugin_ids: [api.plugin_id],\n                          plugin_types: [\n                            PluginType.PLUGIN,\n                            PluginType.APP,\n                            PluginType.LOCAL,\n                            ...(productInfo?.entity_type ===\n                            ProductEntityType.SaasPlugin\n                              ? [ProductEntityType.SaasPlugin]\n                              : []),\n                          ],\n                          space_id: useSpaceStore.getState().getSpaceId(),\n                        });\n\n                      setIsFetching(false);\n                      const targetApi =\n                        result?.data?.plugin_list?.[0]?.plugin_apis?.find(\n                          item => item?.api_id === api?.api_id,\n                        );\n                      if (targetApi) {\n                        Object.assign(targetApi, {\n                          plugin_product_status:\n                            result?.data?.plugin_list?.[0]\n                              .plugin_product_status,\n                          ...pluginInfo,\n                        });\n                      }\n                      apiToSend = targetApi;\n                    }\n                  } else {\n                    apiToSend = Object.assign(\n                      { ...api },\n                      { plugin_product_status, ...pluginInfo },\n                    );\n                  }\n                  if (apiToSend) {\n                    // If it can only be added once, call callback after adding and close the pop-up window\n                    if (\n                      openMode === OpenModeType.OnlyOnceAdd ||\n                      (from &&\n                        [\n                          From.WorkflowAddNode,\n                          From.ProjectIde,\n                          From.ProjectWorkflow,\n                        ].includes(from))\n                    ) {\n                      const cbResult = await openModeCallback?.({\n                        ...apiToSend,\n                        ...pluginInfo,\n                      });\n                      /** Allow to add failed scenarios  */\n                      if (isBoolean(cbResult)) {\n                        return cbResult;\n                      }\n                      return isSuccess;\n                    }\n                    if (!IS_OPEN_SOURCE) {\n                      // After successfully adding the plugin, quickly bind the preset card information\n                      await PluginDevelopApi.QuickBindPluginPresetCard({\n                        plugin_id: apiToSend.plugin_id,\n                        api_name: apiToSend.name,\n                        bot_id: botId,\n                        agent_id: agentId,\n                        space_id: useSpaceStore.getState().getSpaceId(),\n                      });\n                    }\n                    onPluginApiListChange([...pluginApiList, apiToSend]);\n                    Toast.success({\n                      content: I18n.t('bot_edit_tool_added_toast', {\n                        api_name: api.name,\n                      }),\n                      showClose: false,\n                    });\n                  } else {\n                    Toast.error({\n                      content: withSlardarIdButton(\n                        I18n.t('bot_edit_tool_added_toast_error', {\n                          api_name: api.name,\n                        }),\n                      ),\n                      showClose: false,\n                    });\n                    isSuccess = false;\n                  }\n                }\n\n                sendTeaEvent(EVENT_NAMES.click_tool_select, {\n                  operation: 'add',\n                  bot_id: botId,\n                  operation_type: 'single',\n                  tool_id: api?.api_id || '',\n                  tool_name: api?.name || '',\n                  product_id: `${productInfo?.id}`,\n                  product_name: info?.name || '',\n                  source: 'add_plugin_list',\n                  from: 'bot_develop',\n                });\n              }\n\n              return isSuccess;\n            }}\n            key={(api.plugin_id?.toString() ?? '') + (api.name ?? '')}\n            showButton={showButton}\n            loading={isFetching && api?.api_id === currentApiId.current}\n          />\n        );\n      })}\n    </Collapse.Panel>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { type SliderProps } from 'rc-slider';\nimport { Tooltip } from '@coze-arch/bot-semi';\n\ninterface HandleTooltipProps {\n  value: number;\n  children: React.ReactElement;\n  visible: boolean;\n  tipFormatter?: (value: number) => React.ReactNode;\n}\n\nexport const HandleTooltip: React.FC<HandleTooltipProps> = props => {\n  const {\n    value,\n    children,\n    visible,\n    tipFormatter = val => `${val}`,\n    ...restProps\n  } = props;\n\n  const rafRef = React.useRef<number | null>(null);\n\n  // To update the location of Tooltip\n  const [refreshKey, setRefreshKey] = React.useState('1');\n\n  function cancelKeepAlign() {\n    if (rafRef.current) {\n      window.cancelAnimationFrame(rafRef.current);\n    }\n  }\n\n  function keepAlign() {\n    rafRef.current = window.requestAnimationFrame(() => {\n      setRefreshKey(Math.random().toString());\n    });\n  }\n\n  React.useEffect(() => {\n    if (visible) {\n      keepAlign();\n    } else {\n      cancelKeepAlign();\n    }\n\n    return cancelKeepAlign;\n  }, [value, visible]);\n\n  return (\n    <Tooltip\n      placement=\"top\"\n      content={tipFormatter(value)}\n      overlayInnerStyle={{ minHeight: 'auto' }}\n      rePosKey={refreshKey}\n      visible={visible}\n      {...restProps}\n    >\n      {children}\n    </Tooltip>\n  );\n};\n\nexport const handleRender: SliderProps['handleRender'] = (node, props) => (\n  <HandleTooltip\n    value={props.value as number}\n    visible={props.dragging as boolean}\n  >\n    {node}\n  </HandleTooltip>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport RcSlider, { type SliderProps } from 'rc-slider';\n\nimport 'rc-slider/assets/index.css';\nimport { handleRender } from './handle-render';\n\nimport styles from './index.module.less';\n\ninterface InputSliderProps {\n  value?: number;\n  onChange?: (v: number) => void;\n  max?: number;\n  min?: number;\n  step?: number;\n  disabled?: boolean;\n  className?: string;\n  useRcSlider?: boolean;\n  marks?: SliderProps['marks'];\n  tipFormatter?: (\n    value: string | number | boolean | (string | number | boolean)[],\n  ) => string;\n  handleRender?: SliderProps['handleRender'];\n}\n\nexport type RCSliderProps = SliderProps;\n\nexport const RCSliderWrapper: React.FC<InputSliderProps> = props => {\n  const {\n    value,\n    onChange,\n    max = 1,\n    min = 0,\n    step = 1,\n    disabled,\n    marks,\n    className,\n  } = props;\n\n  return (\n    <div className={styles['rc-slider-wrapper']}>\n      <RcSlider\n        className={className}\n        disabled={disabled}\n        value={value}\n        max={max}\n        min={min}\n        step={step}\n        marks={marks}\n        handleRender={handleRender}\n        onChange={v => {\n          if (typeof v === 'number') {\n            onChange?.(v);\n          }\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { isInteger, isNumber, isUndefined } from 'lodash-es';\nimport classNames from 'classnames';\nimport { type SliderProps } from '@coze-arch/bot-semi/Slider';\nimport { type CommonFieldProps } from '@coze-arch/bot-semi/Form';\nimport { withField, InputNumber, Slider } from '@coze-arch/bot-semi';\nimport { IconMinus, IconPlus } from '@douyinfe/semi-icons';\n\nimport { RCSliderWrapper, type RCSliderProps } from '../rc-slider-wrapper';\n\nimport s from './index.module.less';\n\ninterface InputSliderProps {\n  value?: number;\n  onChange?: (v: number) => void;\n  max?: number;\n  min?: number;\n  step?: number;\n  disabled?: boolean;\n  decimalPlaces?: number;\n  marks?: SliderProps['marks'];\n  className?: string;\n\n  /** Whether to use rc-slider to replace semi-slider? At present, there is an obvious bug in semi-slider. In the zoom scene, there is a problem with drag and drop positioning, which has been fed back and is waiting to be fixed. */\n  useRcSlider?: boolean;\n}\n\nconst POWVAL = 10;\nconst formateDecimalPlacesString = (\n  value: string | number,\n  prevValue?: number,\n  decimalPlaces?: number,\n) => {\n  if (isUndefined(decimalPlaces)) {\n    return value.toString();\n  }\n  const numberValue = Number(value);\n  const stringValue = value.toString();\n  if (Number.isNaN(numberValue)) {\n    return `${value}`;\n  }\n  if (decimalPlaces === 0 && !isInteger(Number(value)) && prevValue) {\n    return `${prevValue}`;\n  }\n  const decimalPointIndex = stringValue.indexOf('.');\n\n  if (decimalPointIndex < 0) {\n    return stringValue;\n  }\n  const formattedValue = stringValue.substring(\n    0,\n    decimalPointIndex + 1 + decimalPlaces,\n  );\n\n  if (formattedValue.endsWith('.') && decimalPlaces === 0) {\n    return formattedValue.substring(0, formattedValue.length - 1);\n  }\n  return formattedValue;\n};\n\nconst formateDecimalPlacesNumber = (\n  value: number,\n  prevValue?: number,\n  decimalPlaces?: number,\n) => {\n  if (isUndefined(decimalPlaces)) {\n    return value;\n  }\n  if (decimalPlaces === 0 && !isInteger(value) && prevValue) {\n    return prevValue;\n  }\n  const pow = Math.pow(POWVAL, decimalPlaces);\n  return Math.round(value * pow) / pow;\n};\n\nconst BaseInputSlider: React.FC<InputSliderProps> = ({\n  value,\n  onChange,\n  max = 1,\n  min = 0,\n  step = 1,\n  disabled,\n  decimalPlaces,\n  marks,\n  className,\n  useRcSlider = false,\n}) => {\n  const onNumberChange = (numberValue: number) => {\n    const formattedValue = formateDecimalPlacesNumber(\n      numberValue,\n      value,\n      decimalPlaces,\n    );\n    onChange?.(formattedValue);\n  };\n\n  return (\n    <div className={classNames(s['input-slider'], className)}>\n      {useRcSlider ? (\n        <RCSliderWrapper\n          disabled={disabled}\n          value={value}\n          max={max}\n          min={min}\n          step={step}\n          marks={marks as RCSliderProps['marks']}\n          onChange={v => {\n            if (typeof v === 'number') {\n              onChange?.(v);\n            }\n          }}\n        />\n      ) : (\n        <Slider\n          className={s.slider}\n          disabled={disabled}\n          value={value}\n          max={max}\n          min={min}\n          step={step}\n          marks={marks}\n          onChange={v => {\n            if (typeof v === 'number') {\n              onChange?.(v);\n            }\n          }}\n        />\n      )}\n      <div style={{ position: 'relative', marginLeft: 24 }}>\n        <IconMinus\n          className={classNames(\n            s['input-btn'],\n            disabled && s['input-btn-disabled'],\n          )}\n          onClick={e => {\n            e.stopPropagation();\n            if (isNumber(value) && value <= min) {\n              return;\n            }\n            if (!disabled && value !== undefined) {\n              onNumberChange(value - step);\n            }\n          }}\n        />\n        <InputNumber\n          className={s['input-number']}\n          value={value}\n          disabled={disabled}\n          formatter={inputValue =>\n            formateDecimalPlacesString(inputValue, value)\n          }\n          hideButtons\n          onNumberChange={onNumberChange}\n          max={max}\n          min={min}\n        />\n        <IconPlus\n          className={classNames(\n            s['input-btn'],\n            disabled && s['input-btn-disabled'],\n          )}\n          onClick={e => {\n            if (isNumber(value) && value >= max) {\n              return;\n            }\n            e.stopPropagation();\n            if (!disabled && value !== undefined) {\n              onNumberChange(value + step);\n            }\n          }}\n        />\n      </div>\n    </div>\n  );\n};\nexport const InputSlider: FC<CommonFieldProps & InputSliderProps> =\n  withField(BaseInputSlider);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { featureFlagStorage } from './utils/storage';\nimport { type FEATURE_FLAGS } from './types';\nimport { getFlags } from './get-flags';\n\nexport const useFlags = (): [FEATURE_FLAGS] => {\n  const plainFlags = getFlags();\n  // Listens to the fg store event and triggers the react component to respond to changes\n  const [, setTick] = useState<number>(0);\n\n  useEffect(() => {\n    const cb = () => {\n      setTick(Date.now());\n    };\n    featureFlagStorage.on('change', cb);\n    return () => {\n      featureFlagStorage.off('change', cb);\n    };\n  }, []);\n\n  return [plainFlags];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport const loader = {\n  async init(): Promise<any> {\n    const load = await this.config();\n    return load.init();\n  },\n\n  async config(config = {}): Promise<any> {\n    const monaco = await import('monaco-editor');\n    const { loader: load } = await import('@monaco-editor/react');\n    load.config({\n      monaco,\n      ...config,\n    });\n    return load;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Suspense, lazy } from 'react';\n\nimport { type EditorProps, type DiffEditorProps } from '@monaco-editor/react';\n\nimport { loader } from './loader';\n\nconst LazyEditor = lazy(async () => {\n  await loader.config();\n  const { Editor } = await import('./monaco-editor');\n  return {\n    default: Editor,\n  };\n});\nconst LazyDiffEditor = lazy(async () => {\n  await loader.config();\n  const { DiffEditor } = await import('./monaco-editor');\n  return {\n    default: DiffEditor,\n  };\n});\n\nconst FallbackComponent = <div>Loading Editor...</div>;\nexport const Editor = (props: EditorProps) => (\n  <Suspense fallback={FallbackComponent}>\n    <LazyEditor {...props} />\n  </Suspense>\n);\n\nexport const DiffEditor = (props: DiffEditorProps) => (\n  <Suspense fallback={FallbackComponent}>\n    <LazyDiffEditor {...props} />\n  </Suspense>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DependencyList } from 'react';\nimport type React from 'react';\nimport { useState, useCallback, useRef, useLayoutEffect } from 'react';\n\ninterface Options {\n  onEnter?: () => void;\n  onLeave?: () => void;\n}\n\nconst useHover = <T extends HTMLElement = any>(\n  el?: T | (() => T),\n  options: Options = {},\n  deps: DependencyList = [],\n): [React.MutableRefObject<T>, boolean] => {\n  const { onEnter, onLeave } = options;\n  const ref = useRef<T>();\n  const [isHovered, setIsHovered] = useState(false);\n\n  const handleMouseEnter = useCallback(() => {\n    if (onEnter) {\n      onEnter();\n    }\n    setIsHovered(true);\n  }, [typeof onEnter === 'function']);\n  const handleMouseLeave = useCallback(() => {\n    if (onLeave) {\n      onLeave();\n    }\n    setIsHovered(false);\n  }, [typeof onLeave === 'function']);\n\n  useLayoutEffect(() => {\n    let target = ref.current;\n    if (el) {\n      target = typeof el === 'function' ? el() : el;\n    }\n    if (!target) {\n      return;\n    }\n    target.addEventListener('mouseenter', handleMouseEnter);\n    target.addEventListener('mouseleave', handleMouseLeave);\n    return () => {\n      target?.removeEventListener('mouseenter', handleMouseEnter);\n      target?.removeEventListener('mouseleave', handleMouseLeave);\n    };\n  }, [ref.current, typeof el === 'function' ? undefined : el, ...deps]);\n\n  return [ref as React.MutableRefObject<T>, isHovered];\n};\n\nexport default useHover;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useCallback, useMemo } from 'react';\n\nfunction usePersistCallback<T extends (...args: any[]) => any>(fn?: T) {\n  const ref = useRef<T>();\n\n  ref.current = useMemo(() => fn, [fn]);\n\n  return useCallback<T>(\n    // @ts-expect-error ignore\n    (...args) => {\n      const f = ref.current;\n      return f && f(...args);\n    },\n    [ref],\n  );\n}\nexport default usePersistCallback;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useMemo } from 'react';\n\ntype State = any;\n\nexport interface ReturnValue<T = State> {\n  state: T;\n  toggle: (value?: T) => void;\n}\n\nfunction useToggle<T = boolean>(): ReturnValue<T>;\n\nfunction useToggle<T = State>(defaultValue: T): ReturnValue<T>;\n\nfunction useToggle<T = State, U = State>(\n  defaultValue: T,\n  reverseValue: U,\n): ReturnValue<T | U>;\n\nfunction useToggle<D extends State = State, R extends State = State>(\n  defaultValue: D = false as D,\n  reverseValue?: R,\n) {\n  const [state, setState] = useState<D | R>(defaultValue);\n\n  const actions = useMemo(() => {\n    const reverseValueOrigin = (\n      reverseValue === undefined ? !defaultValue : reverseValue\n    ) as D | R;\n\n    const toggle = (value?: D | R) => {\n      if (value !== undefined) {\n        setState(value);\n        return;\n      }\n      setState(s => (s === defaultValue ? reverseValueOrigin : defaultValue));\n    };\n    return {\n      toggle,\n    };\n  }, [defaultValue, reverseValue]);\n\n  return {\n    state,\n    ...actions,\n  };\n}\n\nexport default useToggle;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef } from 'react';\n\nconst useUpdateEffect: typeof useEffect = (effect, deps) => {\n  const isMounted = useRef(false);\n\n  useEffect(() => {\n    if (!isMounted.current) {\n      isMounted.current = true;\n    } else {\n      return effect();\n    }\n    return () => {};\n  }, deps);\n};\n\nexport default useUpdateEffect;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nimport * as copilot_common from './copilot_common';\n\nexport type Int64 = string | number;\n\nexport enum AccountStatus {\n  Available = 1,\n  /**  */\n  Unavailable = 2,\n}\n\n/**  */\nexport enum BenefitCostStatus {\n  /**  */\n  Reverted = 0,\n  /**  */\n  Succeed = 1,\n}\n\n/** Benefit  */\nexport enum BenefitEntityType {\n  /**  */\n  EnterpriseAllDevices = 1,\n  /**  */\n  EnterpriseAllCustomConsumer = 2,\n  /**  */\n  EnterpriseSingleDevice = 11,\n  /**  */\n  EnterpriseSingleCustomConsumer = 12,\n  /** API */\n  API = 13,\n  /** Plugin */\n  Plugin = 14,\n  /** Voice */\n  Voice = 15,\n  /** Workflow */\n  Workflow = 16,\n  /** \n */\n  EnterpriseConfConfidenceUsing = 51,\n}\n\n/**  */\nexport enum BenefitHistoryType {\n  /** bot  */\n  ChatWithBot = 1,\n  TopUpCredit = 2,\n  BounsCredit = 3,\n  ChargeBack = 4,\n  ChargeBackReverse = 5,\n  WorkflowConsume = 6,\n  /**  */\n  IntelligentVoice = 11,\n  /**  */\n  Fornax = 12,\n  EvaluateConsume = 41,\n  EvaluateModelConsume = 42,\n  /**  */\n  ProjectConsume = 61,\n}\n\n/**  */\nexport enum BenefitRootHistoryType {\n  /** bot  */\n  BotConsume = 1,\n  /** workflow  */\n  WorkflowConsume = 2,\n  /**  */\n  ProjectConsume = 3,\n  /**  */\n  IntelligentVoiceConsume = 4,\n  /**  */\n  FornaxConsume = 5,\n  /**  */\n  EvaluateModelConsume = 6,\n}\n\n/** \n 40 -59 \n 60 - 99 \n 100-109 \n 110-129 Fornax\n 130-149 WorkSpace\n 150-169 \n 170-179 \n 180-199 \n 200-219 \n 220-229  */\nexport enum BenefitType {\n  /**  */\n  MessageCredit = 1,\n  UserFreeChat = 2,\n  TopUpMessageCredit = 3,\n  BonusMessageCredit = 4,\n  /** 40 -59  */\n  Freetimes = 40,\n  /**  */\n  EvaluateFree = 41,\n  /** Workflow  */\n  WorkflowTestRunFree = 42,\n  /** App  */\n  AppTestRunFree = 43,\n  /** Plugin  */\n  PluginRunFree = 44,\n  /** API  */\n  APIRunFree = 45,\n  /** SDK  */\n  SDKRunFree = 46,\n  /** 60 - 99 \n RPM  */\n  RateLimitModelRPM = 60,\n  /**  Input TPM  */\n  RateLimitModelInputTPM = 61,\n  /**  Output TPM  */\n  RateLimitModelOutputTPM = 62,\n  /**  Input TPM  */\n  RateLimitModelInputTPMBasic = 63,\n  /**  Output TPM  */\n  RateLimitModelOutputTPMBasic = 64,\n  /** Plugin  QPS  */\n  PluginRunQPS = 65,\n  /** Plugin  */\n  PluginRunParallel = 66,\n  /** \nWorkflow  QPS  */\n  WorkflowRunQPS = 67,\n  /** Workflow  */\n  WorkflowRunParallel = 68,\n  /** API  QPS  */\n  APIRunQPS = 70,\n  /**  QPS  */\n  VoiceQPS = 71,\n  /**  */\n  VoiceParallel = 72,\n  /** 100-109 \n */\n  ResourcePoint = 100,\n  /**  */\n  FreeResourcePoint = 101,\n  /**  */\n  VolcProResourcePoint = 102,\n  /**  */\n  PeriodicResourcePoint = 103,\n  /**  */\n  ChannelResourcePoint = 104,\n  /**  */\n  CutAndTryResourcePoint = 109,\n  /** 110-129 Fornax\nTrace  */\n  TraceAmount = 111,\n  /** Trace  */\n  TraceStorageDuration = 112,\n  /** 130-149 WorkSpace\nSpace  */\n  SpaceAmount = 131,\n  /** Space  */\n  SpacePeopleNumber = 132,\n  /** Space  */\n  SpaceCollaboratorNumber = 133,\n  /** 150-169 \n */\n  LogStorageDuration = 151,\n  /**  */\n  LogExport = 152,\n  /** 170-179 \n */\n  Capacity = 170,\n  /** 180-199 \n */\n  VoiceCloneNumber = 180,\n  /**  */\n  VoiceCloneNumberBasic = 181,\n  /** 200-219 \n */\n  SeatNumberLimit = 200,\n  /**  */\n  SeatNumberBasic = 201,\n  /**  */\n  RemoveWatermark = 220,\n  /** 240-269 \n */\n  ConfidenceUsing = 240,\n}\n\n/**  */\nexport enum BenefitUseMode {\n  /**  */\n  ByQuota = 1,\n  /**  */\n  Unlimited = 2,\n  /**  */\n  UnAvailable = 10,\n}\n\nexport enum BotMode {\n  SingleMode = 0,\n  MutiAgent = 1,\n  WorkflowMode = 2,\n}\n\nexport enum ChargeItemType {\n  /** 1-99  */\n  ModelInputTPM = 1,\n  ModelOutputTPM = 2,\n  /** 100-199  */\n  VoiceClone = 100,\n  VoiceStorage = 101,\n  /** 200- */\n  PluginRunQPS = 200,\n  PluginRunParallel = 201,\n}\n\nexport enum ChargeResourceType {\n  Model = 1,\n  Plugin = 2,\n}\n\n/** BenefitType */\nexport enum CheckResultType {\n  Pass = 1,\n  /**  */\n  OutOfLimitation = 2,\n  /** / */\n  InsufficientBalance = 3,\n}\n\n/**  */\nexport enum CheckType {\n  /**  */\n  CheckCommon = 0,\n  /** Chatflow */\n  ChatStart = 1,\n  /** Chatflow ErrCode */\n  ChatFinish = 2,\n  /** chat_engine/runtime */\n  ModelCallBefore = 6,\n  /** model_agent/llm_gateway */\n  ModelExecDone = 7,\n  /** workflowworkflow */\n  WorkflowRunStart = 11,\n  /** workflowworkflow */\n  WorkflowRunFinish = 12,\n  /** workflow */\n  WorkflowRunResume = 13,\n  /**  */\n  PluginCallBefore = 16,\n  /**  */\n  PluginExecFinish = 17,\n  /** Fornax */\n  EvaluateBefore = 41,\n  /**  */\n  EvaluateJudge = 42,\n  /**  */\n  VoiceUseFinish = 51,\n  /** Trace */\n  FornaxTraceBefore = 61,\n}\n\n/**  */\nexport enum ConsumeResourceType {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Model = 1,\n  /**  */\n  Plugin = 2,\n  /** ASR/TTS */\n  Voice = 3,\n  /** RTC */\n  RTC = 4,\n  /**  */\n  Dateset = 5,\n}\n\n/**  */\nexport enum CostUserType {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Enterprise = 1,\n  /**  */\n  User = 2,\n}\n\nexport enum CozeAccountType {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Organization = 1,\n  /**  */\n  Personal = 2,\n}\n\n/**  */\nexport enum CozeInstanceStaus {\n  /**  */\n  Running = 1,\n  /**  */\n  Unsubs = 2,\n  /**  */\n  Expired = 3,\n  /**  */\n  Overdue = 4,\n}\n\nexport enum DurationType {\n  Day = 1,\n  Month = 2,\n  Year = 3,\n}\n\nexport enum EntityBenefitStatus {\n  /**  */\n  Valid = 1,\n  /**  */\n  Frozen = 3,\n  /**  */\n  Cancel = 5,\n  /**  */\n  Pending = 6,\n}\n\nexport enum EntityPeriodType {\n  /**  */\n  AbsoluteTime = 1,\n  /**  */\n  RelativeTime = 2,\n}\n\nexport enum ExecutionMode {\n  /** / */\n  Release = 0,\n  /** // */\n  Draft = 1,\n}\n\nexport enum InstanceLimitStatus {\n  /**  */\n  UnLimited = 1,\n  /**  */\n  Limited = 2,\n}\n\nexport enum InstanceStatus {\n  /** ,  */\n  InstanceStatusCreating = 0,\n  /**  */\n  Running = 1,\n  /** ,  */\n  InstanceStatusFailed = 2,\n  /**  */\n  UnsubsRecycled = 3,\n  /**  */\n  ExpiredClosed = 4,\n  /**  */\n  ExpiredRecycled = 5,\n  /**  */\n  InstanceStatusOverdueShutdown = 6,\n  /**  */\n  InstanceStatusOverdueRecycled = 7,\n  /**  */\n  InstanceStatusTerminatedShutdown = 8,\n}\n\nexport enum LimitationTriggerUnit {\n  Never = 0,\n  Minute = 1,\n  Hour = 2,\n  Day = 3,\n  Month = 4,\n  Second = 5,\n}\n\nexport enum MonetizationEntityType {\n  Bot = 0,\n  Project = 1,\n}\n\n/**  */\nexport enum OpenBenefitType {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Free = 1,\n  /**  */\n  ResourcePoint = 2,\n}\n\nexport enum OperateType {\n  AddBenefit = 1,\n  RefundSubscription = 2,\n  RefundTopUp = 3,\n  SubscriptionChargeBack = 4,\n  TopUpChargeBack = 5,\n  SubscriptionChargeBackReverse = 6,\n  TopUpChargeBackReverse = 7,\n}\n\nexport enum PluginBillType {\n  /**  */\n  ByCallTime = 0,\n  /** S */\n  ByDuration = 1,\n  /** token */\n  ByTotalTokens = 2,\n  /**  */\n  NoneButByDownstream = 11,\n}\n\n/**  */\nexport enum ResBelongsToEntityType {\n  /**  */\n  Unknown = 0,\n  /** bot */\n  Bot = 1,\n  /** workflow */\n  Workflow = 2,\n  /** plugin */\n  Plugin = 3,\n  /** Project */\n  Application = 4,\n  /**  */\n  Model = 5,\n  /** ASR/TTS */\n  Voice = 6,\n}\n\nexport enum ResourceUsageStrategy {\n  /**  */\n  UnLimit = 1,\n  /**  */\n  Forbidden = 2,\n  /**  */\n  ByQuota = 3,\n}\n\n/**  */\nexport enum SceneType {\n  /**  */\n  Chat = 1,\n  /** workflow testrun */\n  WorkflowTest = 2,\n  /** bot */\n  EvaluateBot = 41,\n  /**  */\n  EvaluateModel = 42,\n}\n\nexport enum UserLevel {\n  /**  */\n  Free = 0,\n  /** \nPremiumLite */\n  PremiumLite = 10,\n  /** Premium */\n  Premium = 15,\n  PremiumPlus = 20,\n  /** \nV1 */\n  V1ProInstance = 100,\n  /**  */\n  ProPersonal = 110,\n  /**  */\n  Team = 120,\n  /**  */\n  Enterprise = 130,\n}\n\nexport enum VoiceResType {\n  /**  */\n  VoiceClone = 1,\n  /** - */\n  TTSCustom = 2,\n  /** - */\n  TTSSystem = 3,\n  /**  -  */\n  ASRStream = 4,\n  /**  -  */\n  ASRFile = 5,\n  /**  -  */\n  ASRStreamSmall = 6,\n  /**  -  */\n  ASRFileSmall = 7,\n  /**   */\n  RTCVoice = 8,\n  /** AI  */\n  RTCDialogAI = 9,\n  /** -4k */\n  RTCVideoCall4K = 10,\n  /** -2k */\n  RTCVideoCall2K = 11,\n  /** -1080P */\n  RTCVideoCall1080P = 12,\n  /** -720P */\n  RTCVideoCall720P = 13,\n  /** -360P */\n  RTCVideoCall360P = 14,\n  /** TTS  20-40)\n -  */\n  TTSSmall = 20,\n}\n\nexport enum VolcanoUserType {\n  Unknown = 0,\n  RootUser = 1,\n  BasicUser = 2,\n}\n\nexport enum VolcInstanceType {\n  /**  */\n  Normal = 1,\n  /**  */\n  Channel = 2,\n}\n\nexport enum WorkflowMode {\n  Unknown = 0,\n  TestRun = 1,\n  Released = 2,\n}\n\nexport interface BenefitRecord {\n  ID: string;\n  IdempotencyKey: string;\n  BizScene: string;\n  ConsumeTime: Int64;\n  CheckType: Int64;\n  RecordRootID: Int64;\n  AccountID: Int64;\n  CozeUserID: Int64;\n  EnterpriseID: string;\n  CozeAccountType: Int64;\n  ConnectorID: Int64;\n  ConnectorUID: string;\n  DeviceID: string;\n  SpaceID: Int64;\n  RootEntityType: Int64;\n  RootEntityID: Int64;\n  ChangeBalance: string;\n  BalanceType: Int64;\n  BizDetail?: BizDetail;\n  ResourceType: Int64;\n  ResourceID: string;\n  ResModelContent?: ResModelContent;\n  ResPluginContent?: ResPluginContent;\n  ResVoiceContent?: ResVoiceContent;\n  CostConnectorID: Int64;\n  CostConnectorUID: string;\n  CostAccountID: Int64;\n  CostUserType: Int64;\n  CostEnterpriseID: string;\n  Status: Int64;\n  CreatedAt: Int64;\n  UpdatedAt: Int64;\n}\n\nexport interface BizDetail {\n  APIID?: Int64;\n  APIOwnerID?: Int64;\n  ByteTreeID?: string;\n  LogID?: string;\n  Caller?: string;\n  Ftf?: string;\n  Env?: string;\n  OriPath?: string;\n  OriHost?: string;\n  OriConsumeTime?: Int64;\n}\n\nexport interface CommonCounter {\n  /**  Strategy == ByQuota , ,  0 */\n  used?: number;\n  /**  Strategy == ByQuota ,  */\n  total?: number;\n  /**  */\n  strategy?: ResourceUsageStrategy;\n  /**  */\n  start_at?: Int64;\n  /**  */\n  end_at?: Int64;\n}\n\nexport interface DenyReason {\n  Code: number;\n  Message: string;\n}\n\n/**  */\nexport interface ModeleResInfo {\n  model_id?: Int64;\n  /** model family */\n  model_family?: copilot_common.ModelFamily;\n  /** token */\n  input_tokens?: Int64;\n  /** token */\n  output_tokens?: Int64;\n  /** AK */\n  ak_catalog?: string;\n  /** AK */\n  model_ak?: string;\n}\n\nexport interface PluginRelationInfo {\n  /**  */\n  bill_type?: PluginBillType;\n  /**  */\n  feature_name?: string;\n}\n\nexport interface PluginResInfo {\n  plugin_id?: Int64;\n  plugin_api_id?: Int64;\n  /**  */\n  is_image_flow?: boolean;\n  /** ID */\n  tool_id?: Int64;\n  /**  */\n  tool_name?: string;\n  /**  */\n  relation_info?: PluginRelationInfo;\n  /**  */\n  duration?: Int64;\n  /** tokentoken */\n  total_tokens?: Int64;\n}\n\nexport interface PublicUserBasicInfo {\n  user_level?: UserLevel;\n  /** CN */\n  volc_account_info?: VolcAccountInfo;\n}\n\n/**  */\nexport interface ResBelongsToEntity {\n  /** bot id */\n  root_bot_id?: Int64;\n  /** botCoze UserID */\n  bot_creator_id?: Int64;\n  /** botAccountID */\n  bot_creator_account_id?: Int64;\n  /** ProjectID */\n  application_id?: Int64;\n  /** ProjectCoze UserID */\n  application_creator_id?: Int64;\n  /** ProjectAccountID */\n  application_account_id?: Int64;\n  /** workflow id */\n  workflow_id?: Int64;\n  /**  */\n  is_async_workflow?: boolean;\n  /** Workflow ID */\n  workflow_execute_id?: Int64;\n  /** Workflow */\n  is_reload_workflow?: boolean;\n}\n\nexport interface ResModelContent {\n  ModelID?: Int64;\n  ModelFamily?: copilot_common.ModelFamily;\n  ModelMetaID?: Int64;\n  ModelInputTokens?: Int64;\n  ModelOutputTokens?: Int64;\n  AKCatalog?: string;\n  LLMScene?: string;\n  APICatalog?: string;\n  ModelAK?: string;\n}\n\nexport interface ResPluginContent {\n  PluginID?: Int64;\n  PluginAPIID?: Int64;\n  IsImageFlow?: boolean;\n}\n\n/**  */\nexport interface ResRelationBaiscInfo {\n  /** ID */\n  space_id?: Int64;\n  /** Coze UserID */\n  space_owner_id?: Int64;\n  /** AccountID */\n  space_owner_account_id?: Int64;\n  /** APIAPIKey OwnerCoze UserID */\n  api_key_owner_id?: Int64;\n  /** APIAPIKey OwnerAccountID */\n  api_key_owner_account_id?: Int64;\n  /** botCoze UserID */\n  bind_coze_uid?: Int64;\n  /** botAccountID */\n  bind_coze_account_id?: Int64;\n  /** botByteTreeID */\n  byte_tree_id?: string;\n}\n\nexport interface ResVoiceContent {\n  VoiceResType?: VoiceResType;\n  VoiceID?: string;\n  CharNum?: number;\n  AudioLength?: number;\n  RTCDuration?: number;\n  BeginTime?: Int64;\n  EndTime?: Int64;\n}\n\nexport interface UserBasicInfo {\n  UserLevel?: UserLevel;\n  /** CN */\n  VolcAccountInfo?: VolcAccountInfo;\n  /** CN */\n  VolcUserInfo?: VolcUserInfo;\n}\n\nexport interface VoiceResInfo {\n  /**  */\n  voice_type: VoiceResType;\n  /**  */\n  char_num?: number;\n  /**  */\n  audio_length?: number;\n  /**  */\n  rtc_duration?: number;\n  /**  */\n  begin_time?: Int64;\n  /**  */\n  end_time?: Int64;\n  /** coze_id */\n  coze_id?: string;\n  /**  */\n  count?: number;\n}\n\nexport interface VolcAccountInfo {\n  /** ID */\n  account_id?: Int64;\n  /** UserLevel in (100,110,120,130)truetrue */\n  is_volcano_pro_account?: boolean;\n  /** ID */\n  instance_id?: string;\n  /**  */\n  coze_instance_status?: AccountStatus;\n  /**  */\n  instance_status?: InstanceStatus;\n  /**  */\n  limit_status?: InstanceLimitStatus;\n  /**  */\n  volcano_user_type?: VolcanoUserType;\n  /**  */\n  instance_begin_time?: Int64;\n  /**  */\n  instance_end_time?: Int64;\n  /** Id, */\n  period_pack_instance_id?: string;\n}\n\nexport interface VolcUserInfo {\n  /** ID */\n  VolcAuthInstanceID?: string;\n  /**  */\n  VolcUserLevel?: UserLevel;\n  /**  */\n  VolcInstanceType?: VolcInstanceType;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\n/** ComponentMappingType  */\nexport enum ComponentMappingType {\n  Undefined = 0,\n  MockSet = 1,\n}\n\n/** ComponentType  */\nexport enum ComponentType {\n  Undefined = 0,\n  /** Coze Plugin */\n  CozePlugin = 10000,\n  /** Coze Tool */\n  CozeTool = 10001,\n  /** Coze Workflow */\n  CozeWorkflow = 10002,\n  /** Coze SubWorkflowWorkflowWorkflow */\n  CozeSubWorkflow = 10003,\n  /** Coze workflowLLM */\n  CozeLLMNode = 10004,\n  /** Coze workflowCode */\n  CozeCodeNode = 10005,\n  /** Coze workflowKnowledge */\n  CozeKnowledgeNode = 10006,\n  /** Coze workflowTool */\n  CozeToolNode = 10007,\n  /** Coze workflowstart */\n  CozeStartNode = 10008,\n  /** Coze workflowvariable */\n  CozeVariableNode = 10009,\n  /** Coze varibalebot */\n  CozeVariableBot = 20000,\n  /** Coze varibalechat */\n  CozeVariableChat = 20001,\n}\n\nexport enum CozeChannel {\n  /** Coze,  */\n  Coze = 0,\n}\n\nexport enum DebugScene {\n  /** play ground Debug */\n  Debug = 0,\n}\n\nexport enum OrderBy {\n  UpdateTime = 1,\n}\n\n/** TrafficScene  */\nexport enum TrafficScene {\n  Undefined = 0,\n  /** Agent */\n  CozeSingleAgentDebug = 10000,\n  /** Agent */\n  CozeMultiAgentDebug = 10001,\n  /** Tool */\n  CozeToolDebug = 10002,\n  /** Workflow */\n  CozeWorkflowDebug = 10003,\n}\n\n/** BizCtx  */\nexport interface BizCtx {\n  /** connectorID */\n  connectorID?: string;\n  /** connectorID */\n  connectorUID?: string;\n  /**  */\n  trafficScene?: TrafficScene;\n  /** IDBottrafficSceneIDBotID */\n  trafficCallerID?: string;\n  /** SpaceID */\n  bizSpaceID?: string;\n  /**  */\n  ext?: Record<string, string>;\n}\n\n/** ComponentSubject  */\nexport interface ComponentSubject {\n  /** IDTool IDNode ID */\n  componentID?: string;\n  /**  */\n  componentType?: ComponentType;\n  /** IDTool->Plugin, Node->Workflow */\n  parentComponentID?: string;\n  /**  */\n  parentComponentType?: ComponentType;\n}\n\nexport interface Creator {\n  ID?: string;\n  name?: string;\n  avatarUrl?: string;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum AsyncTaskStatusForPlugin {\n  /**  */\n  Unknown = 0,\n  /**  */\n  CreateSucceed = 1,\n  /**  */\n  Executing = 2,\n  /**  */\n  Pushing = 3,\n  /**  */\n  ExecuteSucceed = 10,\n  /**  */\n  ExecuteFailed = 11,\n}\n\nexport enum AsyncTaskStatusForUser {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Executing = 1,\n  /**  */\n  ExecuteSucceed = 2,\n  /**  */\n  ExecuteFailed = 3,\n}\n\nexport enum AsyncType {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Workflow = 1,\n  /**  */\n  NativeAsyncPlugin = 2,\n  /**  */\n  SyncToAsyncPlugin = 3,\n}\n\nexport enum AttributeValueType {\n  Unknown = 0,\n  String = 1,\n  Boolean = 2,\n  StringList = 11,\n  BooleanList = 12,\n}\n\nexport enum CozeReleaseChannel {\n  Inhouse = 0,\n  Release = 1,\n}\n\nexport enum DebugExampleStatus {\n  Default = 0,\n  Enable = 1,\n  Disable = 2,\n}\n\nexport enum FeedbackType {\n  Unknown = 0,\n  /**  */\n  NotFoundPlugin = 1,\n  /**  */\n  OfficialPlugin = 2,\n}\n\nexport enum GrantType {\n  TokenExchange = 1,\n  ClientCredential = 2,\n}\n\n/**  */\nexport enum OperateType {\n  Add = 0,\n  Delete = 1,\n}\n\n/** channel id */\nexport enum PluginChannel {\n  /**  */\n  All = 0,\n  /**  */\n  Material = 1,\n  /**  */\n  Store = 2,\n}\n\n/** plugin product  */\nexport enum PluginProductStatus {\n  Default = 0,\n  Listed = 1,\n  Unlisted = 2,\n  Reviewing = 3,\n}\n\n/** plugin update  */\nexport enum PluginUpdateEventType {\n  /**  */\n  TransferSpace = 1,\n  /** owner */\n  TransferOwner = 2,\n}\n\nexport enum PrivacyAuthStatus {\n  Unauthorized = 1,\n  Authorized = 2,\n}\n\n/** plugin */\nexport enum PrivacyAuthType {\n  /**  */\n  Ask = 0,\n  /**  */\n  Once = 1,\n  /**  */\n  Always = 2,\n}\n\n/** ==================== Project IDE Begin ====================\n authz  */\nexport enum ResourceType {\n  Account = 1,\n  Workspace = 2,\n  App = 3,\n  Bot = 4,\n  Plugin = 5,\n  Workflow = 6,\n  Knowledge = 7,\n  PersonalAccessToken = 8,\n  Connector = 9,\n  Card = 10,\n  CardTemplate = 11,\n  Conversation = 12,\n  File = 13,\n  ServicePrincipal = 14,\n  Enterprise = 15,\n  MigrateTask = 16,\n  Prompt = 17,\n  UI = 18,\n  Project = 19,\n}\n\nexport enum ServiceAuthSubType {\n  ApiKey = 0,\n  BytedanceZeroTrust = 1,\n  OIDC = 2,\n}\n\nexport enum TcsAuditStatus {\n  /**  */\n  Default = 0,\n  /**  */\n  AuditPass = 1,\n  /**  */\n  AuditReject = 2,\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum ProductDraftStatus {\n  Pending = 1,\n  Approved = 2,\n  Rejected = 3,\n}\n\nexport enum ProductEntityType {\n  Bot = 1,\n  Plugin = 2,\n  CozeToken = 50,\n  Common = 99,\n}\n\nexport enum ProductStatus {\n  Listed = 1,\n  Unlisted = 2,\n}\n\nexport enum ProductUnlistType {\n  ByAdmin = 1,\n  ByUser = 2,\n}\n\nexport enum SortType {\n  Heat = 1,\n  Newest = 2,\n}\n\nexport enum VerifyStatus {\n  /**  */\n  Pending = 1,\n  /**  */\n  Succeed = 2,\n  /**  */\n  Failed = 3,\n  /**  */\n  InProgress = 4,\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nimport * as base from './base';\nimport * as common from './common';\n\nexport type Int64 = string | number;\n\nexport enum PhotoSliceType {\n  /**  */\n  Caption = 1,\n  /**  */\n  Tags = 2,\n}\n\nexport enum SliceStatus {\n  /**  */\n  PendingVectoring = 0,\n  /**  */\n  FinishVectoring = 1,\n  /**  */\n  Deactive = 9,\n  /**  */\n  AuditFailed = 1000,\n}\n\nexport enum SourceType {\n  /**  TOS  Flink  */\n  TOS = 1,\n  /**  */\n  Raw = 2,\n}\n\nexport enum VectorRuleType {\n  /**  */\n  SelectedFields = 1,\n}\n\nexport interface CreateSliceRequest {\n  /** 1: optional i64  operator_id // deprecated */\n  document_id: string;\n  /** 3: optional Source  source  // deprecated, \n4: optional VectorRule vector_rule  // deprecated, ,  */\n  raw_text?: string;\n  sequence?: string;\n  extra?: string;\n  tree_node_id?: Int64;\n  front_tree_node_id?: Int64;\n  parent_tree_node_id?: Int64;\n  /** coze */\n  dataset_id?: string;\n  /** documentdocument_id */\n  document_id_new?: string;\n  Base?: base.Base;\n}\n\nexport interface CreateSliceResponse {\n  slice_id?: string;\n  /** slice idslice_id */\n  slice_id_new?: string;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface DeleteSliceRequest {\n  slice_ids?: Array<string>;\n  Base?: base.Base;\n}\n\nexport interface DeleteSliceResponse {\n  code: Int64;\n  msg: string;\n}\n\nexport interface HitInfo {\n  /** 1: i64 operator_id */\n  document_id: Int64;\n  slice_id: Int64;\n  /**  */\n  keyword: string;\n  /**  */\n  score: number;\n}\n\nexport interface ListSliceRequest {\n  /** 1:  optional i64    operator_id                     // deprecated */\n  document_id?: string;\n  /**  */\n  sequence?: string;\n  /**  */\n  keyword?: string;\n  /**  dataset_id */\n  dataset_id?: string;\n  /** 1 */\n  page_no?: string;\n  page_size?: string;\n  sort_field?: string;\n  is_asc?: boolean;\n  Base?: base.Base;\n}\n\nexport interface ListSliceResponse {\n  slices?: Array<SliceInfo>;\n  total?: string;\n  hasmore?: boolean;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface SaveSliceOfflineElement {\n  content?: string;\n  extra?: string;\n}\n\nexport interface SliceInfo {\n  slice_id?: string;\n  content?: string;\n  status?: SliceStatus;\n  /**  */\n  hit_count?: string;\n  /**  */\n  char_count?: string;\n  /** token */\n  token_count?: string;\n  /**  */\n  sequence?: string;\n  document_id?: string;\n  /** ,  slice  extra->chunk_info  (json) */\n  chunk_info?: string;\n}\n\nexport interface TaskProgress {\n  document_id?: Int64;\n  progress?: number;\n  status?: common.DocumentType;\n  /**  */\n  status_descript?: string;\n  document_name?: string;\n}\n\nexport interface UpdateSliceRequest {\n  /** 1: optional i64  operator_id // deprecated */\n  slice_id: string;\n  /** 3: optional Source  source  // deprecated, \n4: optional VectorRule vector_rule  // , \ndeprecated */\n  document_id?: Int64;\n  /**  */\n  status?: SliceStatus;\n  /**  */\n  raw_text?: string;\n  /**  */\n  table_unit_text?: string;\n  Base?: base.Base;\n}\n\nexport interface UpdateSliceResponse {\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum AgentType {\n  Start_Agent = 0,\n  LLM_Agent = 1,\n  Task_Agent = 2,\n  Global_Agent = 3,\n  Bot_Agent = 4,\n}\n\n/** 0- 1- 2- 3-() */\nexport enum AgentVersionCompat {\n  OldVersion = 0,\n  MiddleVersion = 1,\n  NewVersion = 2,\n  MiddleVersionNotPrompt = 3,\n}\n\n/** AnswerActions */\nexport enum AnswerActionsMode {\n  Default = 1,\n  Customize = 2,\n}\n\nexport enum AnswerActionTriggerType {\n  /** Trigger action */\n  Direct = 1,\n  /** Action H5 */\n  WebView = 2,\n  /** Action  */\n  SendMessage = 3,\n}\n\nexport enum BacktrackMode {\n  Current = 1,\n  Previous = 2,\n  Start = 3,\n  MostSuitable = 4,\n}\n\nexport enum BotMode {\n  SingleMode = 0,\n  MultiMode = 1,\n}\n\nexport enum BotSpecies {\n  /** bot\nflow */\n  Default = 0,\n  /** coze */\n  Function = 1,\n}\n\n/**  */\nexport enum ContextMode {\n  Chat = 0,\n  FunctionCall_1 = 1,\n  FunctionCall_2 = 2,\n  FunctionCall_3 = 3,\n}\n\nexport enum FieldItemType {\n  /**  String */\n  Text = 1,\n  /**  Integer */\n  Number = 2,\n  /**  Time */\n  Date = 3,\n  /** float Number */\n  Float = 4,\n  /** bool Boolean */\n  Boolean = 5,\n}\n\nexport enum FileboxInfoMode {\n  Off = 0,\n  On = 1,\n}\n\nexport enum KnowledgeNoRecallReplyMode {\n  Default = 0,\n  CustomizePrompt = 1,\n}\n\nexport enum KnowledgeShowSourceMode {\n  ReplyBottom = 0,\n  CardList = 1,\n}\n\nexport enum KnowledgeType {\n  Coze = 0,\n  Volcano = 1,\n}\n\nexport enum KnowledgeTypeMode {\n  Coze = 0,\n  Volcano = 1,\n}\n\nexport enum MultiAgentConnectorType {\n  Curve = 0,\n  Straight = 1,\n}\n\nexport enum MultiAgentSessionType {\n  Flow = 1,\n  Host = 2,\n}\n\n/** onboarding */\nexport enum OnboardingMode {\n  /**  */\n  NO_NEED = 1,\n  /** LLM */\n  USE_MANUAL = 2,\n  /** LLM */\n  USE_LLM = 3,\n}\n\nexport enum RecognitionMode {\n  FunctionCall = 1,\n  Independent = 2,\n}\n\nexport enum SearchStrategy {\n  /**  */\n  SemanticSearch = 0,\n  /**  */\n  HybirdSearch = 1,\n  /**  */\n  FullTextSearch = 20,\n}\n\nexport enum SuggestReplyMode {\n  System = 0,\n  Custom = 1,\n  Disable = 2,\n  /** agentBot */\n  OriBot = 3,\n}\n\nexport enum TimeCapsuleMode {\n  /**  */\n  Off = 0,\n  /**  */\n  On = 1,\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nimport * as common from './common';\nimport * as base from './base';\nimport * as connector_common from './connector_common';\n\nexport type Int64 = string | number;\n\nexport enum SegmentAppendType {\n  /**  */\n  SegmentAppendType_None = 0,\n  /**  */\n  SegmentAppendType_Tail = 1,\n  /** \n */\n  SegmentAppendType_Head = 2,\n  /**  */\n  SegmentAppendType_Mid = 3,\n}\n\nexport enum TableDataType {\n  /** schema sheets  preview data */\n  AllData = 0,\n  /**  schema  & Sheets */\n  OnlySchema = 1,\n  /**  preview data */\n  OnlyPreview = 2,\n}\n\nexport interface AddSegmentRequest {\n  space_id: string;\n  document_id: string;\n  source_type: common.DocumentSourceType;\n  source_file: common.SourceFileInfo;\n  user_table_info: DocumentTableTaskInfo;\n  append_type: SegmentAppendType;\n  /**  */\n  append_sequence?: Int64;\n  Base?: base.Base;\n}\n\nexport interface AddSegmentResponse {\n  document_id: string;\n  /**  */\n  code: Int64;\n  msg: string;\n}\n\nexport interface CreateDocumentRequest {\n  creator_id?: string;\n  dataset_id?: string;\n  document?: common.DocumentInfo;\n  space_id?: string;\n  Base?: base.Base;\n}\n\nexport interface CreateDocumentResponse {\n  id?: string;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface DeleteUserDataSourceRequest {\n  data_source_id?: Int64;\n  /**  */\n  need_delete_document?: boolean;\n  auth_id?: string;\n  connector_id?: connector_common.ConnectorID;\n  Base?: base.Base;\n}\n\nexport interface DeleteUserDataSourceResponse {\n  code: Int64;\n  msg: string;\n}\n\nexport interface DelWebDataRequest {\n  web_id?: string;\n  creator_id?: string;\n  Base?: base.Base;\n}\n\nexport interface DelWebDataResponse {\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface DocumentFileInfo {\n  name?: string;\n  uri?: string;\n  document_id?: string;\n}\n\nexport interface DocumentTableTaskInfo {\n  /**  sheet id */\n  sheet_id: string;\n  /**  0  */\n  header_line_idx: string;\n  /**  0  */\n  start_line_idx: string;\n}\n\nexport interface DocumentTaskInfo {\n  name?: string;\n  uri?: string;\n  /**  */\n  document_id?: string;\n  /**  */\n  format_type?: common.FormatType;\n  /**  */\n  doc_table_meta?: Array<common.DocTableColumn>;\n  /**  */\n  doc_table_info?: DocumentTableTaskInfo;\n  source_file_id?: string;\n  document_source_type?: common.DocumentSourceType;\n}\n\nexport interface GetDocumentTableInfoRequest {\n  /**  url  */\n  submit_web_id?: string;\n  /**  */\n  tos_uri?: string;\n  /**  document  */\n  document_id?: string;\n  /** [http] */\n  creator_id?: Int64;\n  source_file_id?: string;\n  Base?: base.Base;\n}\n\nexport interface GetDocumentTableInfoResponse {\n  code?: number;\n  msg?: string;\n  sheet_list?: Array<common.DocTableSheet>;\n  /** key: sheet_id -> list<common.DocTableColumn> */\n  table_meta?: Record<Int64, Array<common.DocTableColumn>>;\n  /** key: sheet_id -> list_preview_data */\n  preview_data?: Record<Int64, Array<Record<Int64, string>>>;\n}\n\nexport interface GetTableSchemaInfoRequest {\n  /**  tos (SourceFile) */\n  tos_uri?: string;\n  /** , 0,0,1 */\n  doc_table_info?: DocumentTableTaskInfo;\n  /**  */\n  table_data_type?: TableDataType;\n  /**  document  schema  */\n  document_id?: string;\n  /** source file  segment /  */\n  source_file?: common.SourceFileInfo;\n  /**  */\n  origin_table_meta?: Array<common.DocTableColumn>;\n  /**  */\n  preview_table_meta?: Array<common.DocTableColumn>;\n  Base?: base.Base;\n}\n\nexport interface GetTableSchemaInfoResponse {\n  code?: number;\n  msg?: string;\n  sheet_list?: Array<common.DocTableSheet>;\n  /**  sheet  schema,  sheet */\n  table_meta?: Array<common.DocTableColumn>;\n  /** knowledge table  */\n  preview_data?: Array<Record<Int64, string>>;\n}\n\nexport interface GetTaskProgressV2Request {\n  document_id?: Array<string>;\n  creator_id?: string;\n  Base?: base.Base;\n}\n\nexport interface GetTaskProgressV2Response {\n  data?: Array<TaskProgressDataV2>;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface ListDocumentRequest {\n  dataset_id?: string;\n  /** http */\n  creator_id?: Int64;\n  document_id?: string;\n  page?: number;\n  size?: number;\n  Base?: base.Base;\n}\n\nexport interface ListDocumentResponse {\n  documentsInfo?: Array<common.DocumentInfo>;\n  total?: number;\n  code?: Int64;\n  msg?: string;\n}\n\nexport interface ProcessDocumentsTaskRequest {\n  /** http */\n  creator_id?: Int64;\n  dataset_id?: string;\n  document_infos?: Array<DocumentTaskInfo>;\n  rule?: string;\n  Base?: base.Base;\n}\n\nexport interface ProcessDocumentsTaskResponse {\n  document_infos?: Array<DocumentFileInfo>;\n  code?: Int64;\n  msg?: string;\n}\n\nexport interface ProcessWebDocumentsTaskRequest {\n  creator_id?: string;\n  dataset_id?: string;\n  document_info?: Array<WebDocumentInfo>;\n  formatType?: common.FormatType;\n  Base?: base.Base;\n}\n\nexport interface ProcessWebDocumentsTaskResponse {\n  document_infos?: Array<DocumentFileInfo>;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface QueryWebInfoRequest {\n  web_ids?: Array<string>;\n  /**  */\n  include_content?: boolean;\n  creator_id?: string;\n  Base?: base.Base;\n}\n\nexport interface QueryWebInfoResponse {\n  data?: Record<Int64, WebInfoData>;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface ResegmentRequest {\n  dataset_id: string;\n  document_id: string;\n  rule?: string;\n  /**  */\n  format_type?: common.FormatType;\n  creator_id?: string;\n  Base?: base.Base;\n}\n\nexport interface ResegmentResponse {\n  code?: Int64;\n  msg?: string;\n  document_infos?: DocumentFileInfo;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface SubmitCrawlDataRequest {\n  /** web_document */\n  web_documents?: Array<WebDocument>;\n  /** datasetID */\n  dataset_id?: string;\n  Base?: base.Base;\n}\n\nexport interface SubmitCrawlDataResponse {\n  document_infos?: Array<DocumentFileInfo>;\n  code?: Int64;\n  msg?: string;\n}\n\nexport interface SubmitWebContentV2Request {\n  web_id?: string;\n  content?: string;\n  Base?: base.Base;\n}\n\nexport interface SubmitWebContentV2Response {\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface SubmitWebUrlRequest {\n  web_url?: string;\n  /** 0  */\n  subpages_count?: number;\n  creator_id?: string;\n  /**  */\n  format_type?: common.FormatType;\n  /**  url  */\n  title?: string;\n  Base?: base.Base;\n}\n\nexport interface SubmitWebUrlResponse {\n  web_id?: string;\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface TableSchemaValidRequest {\n  space_id: string;\n  document_id: string;\n  /** source file  */\n  source_file: common.SourceFileInfo;\n  user_table_info: DocumentTableTaskInfo;\n  Base?: base.Base;\n}\n\nexport interface TableSchemaValidResponse {\n  column_valid_result?: Record<string, string>;\n  /**  */\n  code: Int64;\n  msg: string;\n}\n\nexport interface TaskProgressData {\n  document_id?: string;\n  progress?: number;\n  status?: common.DocumentStatus;\n  /**  */\n  status_descript?: string;\n}\n\nexport interface TaskProgressDataV2 {\n  document_id?: string;\n  progress?: number;\n  status?: common.DocumentStatus;\n  /**  */\n  status_descript?: string;\n  document_name?: string;\n}\n\nexport interface UpdateDocumentV2Request {\n  creator_id?: string;\n  document_id?: string;\n  status?: common.DocumentStatus;\n  document_name?: string;\n  table_meta?: Array<common.DocTableColumn>;\n  Base?: base.Base;\n}\n\nexport interface UpdateDocumentV2Response {\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface UpdateWebRuleRequest {\n  document_id?: string;\n  update_type?: common.DocumentUpdateType;\n  update_interval?: number;\n  creator_id?: string;\n  Base?: base.Base;\n}\n\nexport interface UpdateWebRuleResponse {\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface ValidateUnitNameRequest {\n  space_id: string;\n  dataset_id: string;\n  unit_name: string;\n  format_type: common.FormatType;\n  document_id?: string;\n  Base?: base.Base;\n}\n\nexport interface ValidateUnitNameResponse {\n  /**  */\n  code: Int64;\n  msg: string;\n}\n\nexport interface WebDocument {\n  /** () */\n  title?: string;\n  /**  */\n  headers?: Array<string>;\n  /**  */\n  content?: Array<Record<string, string>>;\n  /** (/) */\n  format_type?: common.FormatType;\n  /** URL */\n  url?: string;\n  /** XPATH */\n  marks?: Record<string, string>;\n}\n\nexport interface WebDocumentInfo {\n  web_id?: string;\n  update_type?: common.DocumentUpdateType;\n  /**  0 */\n  update_interval?: number;\n  sub_web_ids?: Array<string>;\n  /**  */\n  document_id?: string;\n  /**  */\n  table_meta?: Array<common.DocTableColumn>;\n  /**  deprecated  */\n  orig_table_meta?: Array<common.DocTableColumn>;\n  name?: string;\n}\n\nexport interface WebInfo {\n  id?: string;\n  url?: string;\n  content?: string;\n  title?: string;\n  subpages?: Array<WebInfo>;\n  subpages_count?: number;\n  status?: common.WebInfoStatus;\n}\n\nexport interface WebInfoData {\n  progress?: number;\n  web_info?: WebInfo;\n  status?: common.WebInfoStatus;\n  status_descript?: string;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nimport * as base from './base';\n\nexport type Int64 = string | number;\n\nexport enum AttributeValueType {\n  Unknown = 0,\n  String = 1,\n  Boolean = 2,\n  StringList = 11,\n  BooleanList = 12,\n}\n\nexport enum ResourceType {\n  Account = 1,\n  Workspace = 2,\n  App = 3,\n  Bot = 4,\n  Plugin = 5,\n  Workflow = 6,\n  Knowledge = 7,\n  PersonalAccessToken = 8,\n  Connector = 9,\n  Card = 10,\n  CardTemplate = 11,\n  Conversation = 12,\n  File = 13,\n  ServicePrincipal = 14,\n  Enterprise = 15,\n  MigrateTask = 16,\n  Prompt = 17,\n  UI = 18,\n  Project = 19,\n  Database = 23,\n}\n\nexport enum VariableChannel {\n  Custom = 1,\n  System = 2,\n  Location = 3,\n  Feishu = 4,\n  /**  */\n  APP = 5,\n}\n\nexport enum VariableConnector {\n  Bot = 1,\n  Project = 2,\n}\n\nexport enum VariableType {\n  KVVariable = 1,\n  ListVariable = 2,\n}\n\nexport interface AttributeValue {\n  Type: AttributeValueType;\n  Value: string;\n}\n\nexport interface GetMemoryVariableMetaReq {\n  ConnectorID?: string;\n  ConnectorType?: VariableConnector;\n  version?: string;\n  Base?: base.Base;\n}\n\nexport interface GetMemoryVariableMetaResp {\n  VariableMap?: Partial<Record<VariableChannel, Array<Variable>>>;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetProjectVariableListReq {\n  ProjectID?: string;\n  UserID?: Int64;\n  version?: string;\n  Base?: base.Base;\n}\n\nexport interface GetProjectVariableListResp {\n  VariableList?: Array<Variable>;\n  CanEdit?: boolean;\n  GroupConf?: Array<GroupVariableInfo>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GroupVariableInfo {\n  GroupName?: string;\n  GroupDesc?: string;\n  GroupExtDesc?: string;\n  VarInfoList?: Array<Variable>;\n  SubGroupList?: Array<GroupVariableInfo>;\n  IsReadOnly?: boolean;\n  DefaultChannel?: VariableChannel;\n}\n\nexport interface ResourceIdentifier {\n  /**  */\n  Type: ResourceType;\n  /** Id */\n  Id: string;\n}\n\nexport interface UpdateProjectVariableReq {\n  ProjectID?: string;\n  UserID?: Int64;\n  VariableList?: Array<Variable>;\n  Base?: base.Base;\n}\n\nexport interface UpdateProjectVariableResp {\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface Variable {\n  Keyword?: string;\n  DefaultValue?: string;\n  VariableType?: VariableType;\n  Channel?: VariableChannel;\n  Description?: string;\n  Enable?: boolean;\n  /**  */\n  EffectiveChannelList?: Array<string>;\n  /** schemastring */\n  Schema?: string;\n  IsReadOnly?: boolean;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum ActionKey {\n  /**  */\n  Copy = 1,\n  /**  */\n  Delete = 2,\n  /** / */\n  EnableSwitch = 3,\n  /**  */\n  Edit = 4,\n  /** funcflow */\n  SwitchToFuncflow = 8,\n  /** chatflow */\n  SwitchToChatflow = 9,\n  /**  */\n  CrossSpaceCopy = 10,\n}\n\nexport enum CopyStatus {\n  Successful = 1,\n  Processing = 2,\n  Failed = 3,\n  /** KeepOriginTarget */\n  KeepOrigin = 4,\n  /** -> */\n  Deleted = 5,\n}\n\nexport enum ProjectResourceActionKey {\n  /**  */\n  Rename = 1,\n  /** / */\n  Copy = 2,\n  /**  */\n  CopyToLibrary = 3,\n  /**  */\n  MoveToLibrary = 4,\n  /**  */\n  Delete = 5,\n  /**  */\n  Enable = 6,\n  /**  */\n  Disable = 7,\n  /** funcflow */\n  SwitchToFuncflow = 8,\n  /** chatflow */\n  SwitchToChatflow = 9,\n  /**  */\n  UpdateDesc = 10,\n}\n\nexport enum ProjectResourceGroupType {\n  Workflow = 1,\n  Plugin = 2,\n  Data = 3,\n}\n\nexport enum PublishStatus {\n  /**  */\n  UnPublished = 1,\n  /**  */\n  Published = 2,\n}\n\nexport enum ResourceCopyScene {\n  /**  */\n  CopyProjectResource = 1,\n  /** Library */\n  CopyResourceToLibrary = 2,\n  /** Library */\n  MoveResourceToLibrary = 3,\n  /** Library */\n  CopyResourceFromLibrary = 4,\n  /**  */\n  CopyProject = 5,\n  /**  */\n  PublishProject = 6,\n  /**  */\n  CopyProjectTemplate = 7,\n  /**  */\n  PublishProjectTemplate = 8,\n  /**  */\n  LaunchTemplate = 9,\n  /**  */\n  ArchiveProject = 10,\n  /**  */\n  RollbackProject = 11,\n  /**  */\n  CrossSpaceCopy = 12,\n  /**  */\n  CrossSpaceCopyProject = 13,\n}\n\nexport enum ResType {\n  Plugin = 1,\n  Workflow = 2,\n  Imageflow = 3,\n  Knowledge = 4,\n  UI = 5,\n  Prompt = 6,\n  Database = 7,\n  Variable = 8,\n  Voice = 9,\n}\n\nexport enum SyncOperation {\n  Upsert = 1,\n  Delete = 2,\n}\n\n/** struct ResourceCopyExtraInfo{\n    // \n    1 : optional string ResourceName (go.tag = \"json:\\\"resource_name\\\"\", agw.key = \"resource_name\")\n    // \n    2 : optional string VersionNum  (go.tag = \"json:\\\"version_num\\\"\", agw.key = \"version_num\")\n    // \n    3 : optional string VersionDesc  (go.tag = \"json:\\\"version_desc\\\"\", agw.key = \"version_desc\")\n    // schema\n    4 : optional string ResourceExtendInfo  (go.tag = \"json:\\\"resource_extend_info\\\"\", agw.key = \"resource_extend_info\")\n} */\nexport enum TaskStatus {\n  Successed = 1,\n  Processing = 2,\n  Failed = 3,\n  Canceled = 4,\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum APIDebugStatus {\n  DebugWaiting = 0,\n  DebugPassed = 1,\n}\n\nexport enum APIListOrderBy {\n  CreateTime = 1,\n}\n\nexport enum APIMethod {\n  GET = 1,\n  POST = 2,\n  PUT = 3,\n  DELETE = 4,\n  PATCH = 5,\n}\n\n/** File */\nexport enum AssistParameterType {\n  DEFAULT = 1,\n  IMAGE = 2,\n  DOC = 3,\n  CODE = 4,\n  PPT = 5,\n  TXT = 6,\n  EXCEL = 7,\n  AUDIO = 8,\n  ZIP = 9,\n  VIDEO = 10,\n  /**  */\n  VOICE = 12,\n}\n\nexport enum AsyncTaskExecuteStatus {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Executing = 1,\n  /**  */\n  ExecuteSucceed = 2,\n  /**  */\n  ExecuteFailed = 3,\n}\n\n/** enum OauthAuthSubType {\n     Standard = 0\n}\nenum AuthorizationSubyType {\n     Service_ApiKey = 0\n     Service_BytedanceZeroTrust   = 1,\n     Service_OIDC = 2,\n     Oauth_Standard = 3,\n} */\nexport enum AuthorizationServiceLocation {\n  Header = 1,\n  Query = 2,\n}\n\nexport enum AuthorizationType {\n  None = 0,\n  Service = 1,\n  OAuth = 3,\n}\n\nexport enum CardAuditStatus {\n  /** () */\n  Rejected = -1,\n  /**  */\n  Approved = 1,\n  /**  */\n  Pending = 100,\n}\n\nexport enum CardBizType {\n  Plugin = 1,\n  Workflow = 2,\n}\n\nexport enum CardBusinessType {\n  Plugin = 1,\n  WorkFlow = 2,\n}\n\nexport enum CardCategory {\n  Official = 1,\n  Custom = 2,\n}\n\nexport enum CardDisplayType {\n  /**  */\n  Basic = 1,\n  /**  */\n  List = 2,\n  /**  */\n  Custom = 3,\n  /**  */\n  Slide = 4,\n}\n\nexport enum CardStatus {\n  Draft = 0,\n  Published = 1,\n  UnPublish = 2,\n}\n\nexport enum CreationMethod {\n  COZE = 0,\n  IDE = 1,\n}\n\nexport enum DebugExampleStatus {\n  Default = 0,\n  Enable = 1,\n  Disable = 2,\n}\n\nexport enum DebugOperation {\n  /**  */\n  Debug = 1,\n  /**  */\n  Parse = 2,\n}\n\n/**  */\nexport enum DefaultParamSource {\n  /**  */\n  Input = 0,\n  /**  */\n  Variable = 1,\n}\n\nexport enum FeedbackType {\n  Unknown = 0,\n  /**  */\n  NotFoundPlugin = 1,\n  /**  */\n  OfficialPlugin = 2,\n}\n\nexport enum FieldType {\n  Object = 1,\n  String = 2,\n  Integer = 3,\n  Bool = 4,\n  Array = 5,\n  Number = 6,\n}\n\nexport enum GrantType {\n  TokenExchange = 1,\n  ClientCredential = 2,\n}\n\nexport enum InstallStatus {\n  USING = 1,\n  REMOVE = 2,\n  OFFLINE = 3,\n  /**  */\n  NOTINSTALL = 4,\n}\n\n/**  */\nexport enum OAuthStatus {\n  Authorized = 1,\n  Unauthorized = 2,\n}\n\nexport enum OnlineStatus {\n  OFFLINE = 0,\n  ONLINE = 1,\n}\n\nexport enum OrderBy {\n  CreateTime = 0,\n  UpdateTime = 1,\n  PublishTime = 2,\n  Hot = 3,\n}\n\nexport enum ParameterLocation {\n  Path = 1,\n  Query = 2,\n  Body = 3,\n  Header = 4,\n}\n\nexport enum ParameterType {\n  String = 1,\n  Integer = 2,\n  Number = 3,\n  Object = 4,\n  Array = 5,\n  Bool = 6,\n}\n\nexport enum PluginCardStatus {\n  Latest = 1,\n  /**  */\n  NeedUpdate = 2,\n  /**  */\n  ParamMisMatch = 3,\n}\n\nexport enum PluginCurrentInfoItemType {\n  source_code = 1,\n  input_params = 2,\n  openapi = 3,\n}\n\nexport enum PluginDataFormat {\n  OpenAPI = 1,\n  Curl = 2,\n  Postman = 3,\n  Swagger = 4,\n}\n\nexport enum PluginListPluginType {\n  /** workflow */\n  ExceptWorkflow = 0,\n  Workflow = 1,\n  API = 2,\n  /** teamplugin */\n  SpaceAPI = 3,\n}\n\n/** plugin */\nexport enum PluginParamTypeFormat {\n  FileUrl = 0,\n  ImageUrl = 1,\n  DocUrl = 2,\n  CodeUrl = 3,\n  PptUrl = 4,\n  TxtUrl = 5,\n  ExcelUrl = 6,\n  AudioUrl = 7,\n  ZipUrl = 8,\n  VideoUrl = 9,\n}\n\nexport enum PluginPricingCalculationType {\n  /**  */\n  ByTimes = 1,\n  /**  (token) */\n  ByUnit = 2,\n  /**  */\n  Unlimited = 3,\n}\n\nexport enum PluginPricingStrategy {\n  /**  */\n  Free = 0,\n  /**  */\n  Quantity = 1,\n  /**  */\n  Subscribe = 2,\n}\n\nexport enum PluginProductStatus {\n  Default = 0,\n  Listed = 1,\n  Unlisted = 2,\n  Reviewing = 3,\n}\n\nexport enum PluginReferrerScene {\n  SingleAgent = 0,\n  WorkflowLlmNode = 1,\n}\n\nexport enum PluginStatus {\n  /**  */\n  Draft = 0,\n  SUBMITTED = 1,\n  REVIEWING = 2,\n  PREPARED = 3,\n  PUBLISHED = 4,\n  OFFLINE = 5,\n  /**  */\n  BANNED = 6,\n}\n\nexport enum PluginToolAuthType {\n  /**  */\n  Required = 0,\n  /**  */\n  Supported = 1,\n  /**  */\n  Disable = 2,\n}\n\nexport enum PluginType {\n  PLUGIN = 1,\n  APP = 2,\n  FUNC = 3,\n  WORKFLOW = 4,\n  IMAGEFLOW = 5,\n  LOCAL = 6,\n}\n\nexport enum PluginTypeForFilter {\n  /** PLUGINAPP */\n  CloudPlugin = 1,\n  /** LOCAL */\n  LocalPlugin = 2,\n  /** WORKFLOWIMAGEFLOW */\n  WorkflowPlugin = 3,\n}\n\nexport enum PricingCurrencyType {\n  /**  */\n  USD = 0,\n  CNY = 1,\n}\n\n/** Begin  */\nexport enum PricingInterval {\n  /**  */\n  Second = 1,\n  Minute = 2,\n  Hour = 3,\n  Day = 4,\n  Month = 5,\n  Year = 6,\n}\n\nexport enum ProductDraftStatus {\n  Default = 0,\n  /**  */\n  Pending = 1,\n  /**  */\n  Approved = 2,\n  /**  */\n  Rejected = 3,\n  /**  */\n  Abandoned = 4,\n}\n\nexport enum ProductStatus {\n  NeverListed = 0,\n  Listed = 1,\n  Unlisted = 2,\n  Banned = 3,\n}\n\nexport enum ProductUnlistType {\n  ByAdmin = 1,\n  ByUser = 2,\n}\n\nexport enum ProgramLang {\n  Curl = 1,\n  Wget = 2,\n  NodeJS = 3,\n  Python = 4,\n  Golang = 5,\n}\n\nexport enum QueryCardStatus {\n  Published = 1,\n  UnPublish = 2,\n}\n\nexport enum RunMode {\n  DefaultToSync = 0,\n  Sync = 1,\n  Async = 2,\n  Streaming = 3,\n}\n\nexport enum ScopeType {\n  /**  */\n  All = 0,\n  /**  */\n  Self = 1,\n}\n\nexport enum ServiceAuthSubType {\n  ApiKey = 0,\n  BytedanceZeroTrust = 1,\n  OIDC = 2,\n}\n\nexport enum SpaceRoleType {\n  /**  */\n  Default = 0,\n  /** owner */\n  Owner = 1,\n  /**  */\n  Admin = 2,\n  /**  */\n  Member = 3,\n}\n\nexport enum TriggerEventType {\n  /**  */\n  Time = 1,\n  /**  */\n  Webhook = 2,\n}\n\nexport enum TriggerExecStatus {\n  /**  */\n  Default = 0,\n  /**  */\n  Succeed = 1,\n  /**  */\n  Failed = 2,\n}\n\nexport enum TriggerTaskType {\n  /**  */\n  PresetTask = 1,\n  /**  */\n  UserTask = 2,\n}\n\nexport enum WorkflowResponseMode {\n  /**  */\n  UseLLM = 0,\n  /**  */\n  SkipLLM = 1,\n}\n\nexport interface AgentTaskExecInfo {\n  /** task id */\n  task_id?: string;\n  /** id */\n  serial_id?: string;\n  /**  */\n  task_type?: TriggerTaskType;\n  /**  */\n  event_type?: TriggerEventType;\n  /** agent */\n  bot_version?: string;\n  /** id */\n  trigger_user_id?: string;\n  /**  */\n  connector_id?: string;\n  /**  true */\n  exec_status?: TriggerExecStatus;\n  /**  */\n  next_exec_duration?: number;\n  /** true */\n  valid_status?: boolean;\n  /**  */\n  config?: string;\n}\n\nexport interface AgentTaskInfo {\n  /** task id */\n  id?: string;\n  /** task name */\n  task_name?: string;\n  /**  */\n  task_type?: TriggerTaskType;\n  /**  */\n  event_type?: TriggerEventType;\n  /**  */\n  config?: string;\n  /** agent */\n  connector_ids?: Array<string>;\n  /**  */\n  connector_id?: string;\n  /**  true */\n  exec_status?: TriggerExecStatus;\n  /**  */\n  next_exec_duration?: number;\n  /** true */\n  valid_status?: boolean;\n  /** agent */\n  bot_version?: string;\n  /** id */\n  trigger_user_id?: string;\n}\n\nexport interface APIExtend {\n  /** tool */\n  auth_mode?: PluginToolAuthType;\n}\n\nexport interface APIInfo {\n  plugin_id?: string;\n  api_id?: string;\n  plugin_version?: string;\n  api_name?: string;\n}\n\nexport interface APIListOrder {\n  order_by?: APIListOrderBy;\n  desc?: boolean;\n}\n\nexport interface APIParameter {\n  /** for */\n  id?: string;\n  name?: string;\n  desc?: string;\n  type?: ParameterType;\n  sub_type?: ParameterType;\n  location?: ParameterLocation;\n  is_required?: boolean;\n  sub_parameters?: Array<APIParameter>;\n  global_default?: string;\n  global_disable?: boolean;\n  local_default?: string;\n  local_disable?: boolean;\n  /**  */\n  default_param_source?: DefaultParamSource;\n  /** variablekey */\n  variable_ref?: string;\n  assist_type?: AssistParameterType;\n}\n\nexport interface APIStruct {\n  name?: string;\n  type?: FieldType;\n  children?: Array<APIStruct>;\n}\n\nexport interface AsyncConfig {\n  /** idworkflow id */\n  plugin_id?: string;\n  /** tool */\n  api_name?: string;\n  /**  */\n  switch_status?: boolean;\n  /** 1000 */\n  message?: string;\n}\n\nexport interface AsyncPluginTask {\n  /** task id */\n  task_id?: string;\n  /**  */\n  task_name?: string;\n  /**   */\n  task_type?: PluginType;\n  /**  */\n  query_msg?: string;\n  /**  */\n  task_status?: AsyncTaskExecuteStatus;\n  /**  */\n  create_time?: Int64;\n  /** url */\n  plugin_icon?: string;\n}\n\nexport interface BindCardsStatusData {\n  bind_cards?: Array<SignleBindCardStatus>;\n  publish_time?: string;\n}\n\nexport interface CardBindInfo {\n  card_id?: string;\n  mapping_rule?: string;\n  max_display_rows?: Int64;\n  card_version_num?: string;\n  llm_text_card?: boolean;\n  category?: CardCategory;\n}\n\nexport interface CardBusinessInfo {\n  biz_type: CardBusinessType;\n  business_id: string;\n  unique_id: string;\n}\n\nexport interface CheckAndLockPluginEditData {\n  /**  */\n  Occupied?: boolean;\n  /** ID */\n  user?: Creator;\n  /**  */\n  Seized?: boolean;\n}\n\nexport interface CodeInfo {\n  /** json */\n  plugin_desc?: string;\n  /** yaml */\n  openapi_desc?: string;\n  client_id?: string;\n  client_secret?: string;\n  service_token?: string;\n}\n\nexport interface commonParamSchema {\n  name?: string;\n  value?: string;\n}\n\nexport interface CozeCardInfo {\n  card_id?: string;\n  draft_card_id?: string;\n  name?: string;\n  creator_id?: string;\n  card_category?: CardCategory;\n  card_display_type?: CardDisplayType;\n  version_num?: string;\n  version_name?: string;\n  description?: string;\n  update_time?: string;\n  creator?: Creator;\n  basic_card_id?: string;\n  list_card_id?: string;\n  properties?: string;\n  properties_hash?: string;\n  thumbnail?: string;\n  card_status?: CardStatus;\n  publish_time?: string;\n  audit_status?: CardAuditStatus;\n  audit_failure_details?: Array<number>;\n}\n\nexport interface CreateCardData {\n  card_id?: string;\n  draft_card_id?: string;\n}\n\nexport interface Creator {\n  id?: string;\n  name?: string;\n  avatar_url?: string;\n  /**  */\n  self?: boolean;\n  space_roly_type?: SpaceRoleType;\n  /**  */\n  user_unique_name?: string;\n  /**  */\n  user_label?: UserLabel;\n}\n\n/** ---- */\nexport interface DebugExample {\n  req_example?: string;\n  resp_example?: string;\n}\n\nexport interface DuplicateAPIInfo {\n  method?: string;\n  path?: string;\n  count?: Int64;\n}\n\nexport interface GetPlaygroundPluginListData {\n  plugin_list?: Array<PluginInfoForPlayground>;\n  total?: number;\n}\n\nexport interface GetPluginCardsData {\n  plugin_cards?: Array<PluginCards>;\n}\n\nexport interface GetPluginChangelogData {\n  total?: Int64;\n  change_log_list?: Array<PluginChangelogRecord>;\n}\n\nexport interface GetPluginListData {\n  plugin_infos?: Array<PluginInfo>;\n  total?: Int64;\n  page?: number;\n  size?: number;\n}\n\nexport interface GetUserAuthorityData {\n  can_edit?: boolean;\n  can_read?: boolean;\n  can_delete?: boolean;\n  can_debug?: boolean;\n  can_publish?: boolean;\n  can_read_changelog?: boolean;\n}\n\nexport interface GetWorkflowMessageNodesData {\n  id?: string;\n  plugin_id?: string;\n  name?: string;\n  message_nodes?: Array<NodeInfo>;\n}\n\nexport interface NodeInfo {\n  node_id?: string;\n  node_type?: string;\n  node_title?: string;\n}\n\nexport interface PluginApi {\n  /** operationId */\n  name?: string;\n  /** summary */\n  desc?: string;\n  parameters?: Array<PluginParameter>;\n  plugin_id?: string;\n  plugin_name?: string;\n  /** playground */\n  api_id?: string;\n  record_id?: string;\n  /** nil */\n  card_binding_info?: PresetCardBindingInfo;\n  /** api */\n  debug_example?: DebugExample;\n  function_name?: string;\n  /**  */\n  run_mode?: RunMode;\n}\n\nexport interface PluginAPIInfo {\n  plugin_id?: string;\n  api_id?: string;\n  name?: string;\n  desc?: string;\n  path?: string;\n  method?: APIMethod;\n  request_params?: Array<APIParameter>;\n  response_params?: Array<APIParameter>;\n  create_time?: string;\n  debug_status?: APIDebugStatus;\n  disabled?: boolean;\n  statistic_data?: PluginStatisticData;\n  /** idetool */\n  online_status?: OnlineStatus;\n  api_extend?: APIExtend;\n  /** nil */\n  card_binding_info?: PresetCardBindingInfo;\n  /**  */\n  debug_example?: DebugExample;\n  /**  */\n  debug_example_status?: DebugExampleStatus;\n  function_name?: string;\n}\n\nexport interface PluginCardResp {\n  type_for_model?: string;\n  return_direct?: string;\n  card_type?: string;\n  template_url?: string;\n  template_id?: string;\n  template_h5_url?: string;\n  template_h5?: TemplateH5UrlObj;\n  gravity?: string;\n  response_for_model?: string;\n  content_type?: string;\n  code?: string;\n  data?: string;\n  response_type?: string;\n  setting_response?: string;\n  dsl_content?: string;\n  /** -\n0-\n1-\n2- */\n  card_summary_mode?: string;\n  /**  */\n  info_in_card?: string;\n}\n\nexport interface PluginCards {\n  card_id?: string;\n  plugin_id?: string;\n  api_name?: string;\n  status?: PluginCardStatus;\n}\n\nexport interface PluginChangelogRecord {\n  changelog_id?: string;\n  create_time?: string;\n  creator?: Creator;\n  operation?: string;\n}\n\nexport interface PluginCurrentInfoItemInfo {\n  item_id?: string;\n  /** 1. source_code  2. input  3. api yaml  */\n  item_type?: PluginCurrentInfoItemType;\n  content?: string;\n}\n\nexport interface PluginIcon {\n  uri?: string;\n  url?: string;\n}\n\nexport interface PluginInfo {\n  id?: string;\n  /** name_for_human */\n  name?: string;\n  /** description_for_human */\n  desc_for_human?: string;\n  plugin_icon?: string;\n  plugin_type?: PluginType;\n  status?: PluginStatus;\n  /** json */\n  plugin_desc?: string;\n  /** yaml,openapi */\n  openapi_desc?: string;\n  auth?: number;\n  client_id?: string;\n  client_secret?: string;\n  service_token?: string;\n  create_time?: Int64;\n  update_time?: Int64;\n  ClientUrl?: string;\n  Scope?: string;\n  RedirectUri?: string;\n  /** \n */\n  InstallStatus?: InstallStatus;\n  /** id/ */\n  UserID?: Int64;\n  WorkFlowId?: string;\n  /** api */\n  api_names?: Array<string>;\n  /**  */\n  creator?: Creator;\n  /**  */\n  publish_status?: boolean;\n  space_id?: string;\n  /**  */\n  statistic_data?: PluginStatisticData;\n  /**  */\n  common_params?: Partial<Record<ParameterLocation, Array<commonParamSchema>>>;\n  /** plugin */\n  plugin_product_list_status?: ProductStatus;\n  /** plugin()() */\n  plugin_product_status?: PluginProductStatus;\n  /**  */\n  creation_method?: CreationMethod;\n  /** plugin */\n  plugin_product_draft_status?: ProductDraftStatus;\n  /**  */\n  cur_user_can_del?: boolean;\n}\n\nexport interface PluginInfoForPlayground {\n  id?: string;\n  /** name_for_human */\n  name?: string;\n  /** description_for_human */\n  desc_for_human?: string;\n  plugin_icon?: string;\n  plugin_type?: PluginType;\n  status?: PluginStatus;\n  auth?: number;\n  client_id?: string;\n  client_secret?: string;\n  plugin_apis?: Array<PluginApi>;\n  /**  */\n  tag?: Int64;\n  create_time?: string;\n  update_time?: string;\n  /**  */\n  creator?: Creator;\n  /** id */\n  space_id?: string;\n  /**  */\n  statistic_data?: PluginStatisticData;\n  common_params?: Partial<Record<ParameterLocation, Array<commonParamSchema>>>;\n  /** plugin */\n  plugin_product_status?: ProductStatus;\n  /** plugin */\n  plugin_product_unlist_type?: ProductUnlistType;\n  /** id */\n  material_id?: string;\n  /** id */\n  channel_id?: number;\n  /**  */\n  creation_method?: CreationMethod;\n  /**  */\n  is_official?: boolean;\n  /** id */\n  project_id?: string;\n  /**  */\n  version_ts?: string;\n  /**  */\n  version_name?: string;\n}\n\nexport interface PluginMetaInfo {\n  name?: string;\n  desc?: string;\n  url?: string;\n  icon?: PluginIcon;\n  auth_type?: Array<AuthorizationType>;\n  /** service */\n  location?: AuthorizationServiceLocation;\n  /** service */\n  key?: string;\n  /** service */\n  service_token?: string;\n  /** json */\n  oauth_info?: string;\n  common_params?: Partial<Record<ParameterLocation, Array<commonParamSchema>>>;\n  sub_auth_type?: number;\n  auth_payload?: string;\n  /** ip */\n  fixed_export_ip?: boolean;\n  /** id */\n  private_link_id?: string;\n}\n\nexport interface PluginParameter {\n  name?: string;\n  desc?: string;\n  required?: boolean;\n  type?: string;\n  sub_parameters?: Array<PluginParameter>;\n  /** Typesubtype */\n  sub_type?: string;\n  /** fromNodeId */\n  from_node_id?: string;\n  /** key */\n  from_output?: Array<string>;\n  /**   */\n  value?: string;\n  /**  */\n  format?: PluginParamTypeFormat;\n}\n\nexport interface PluginPriceInfo {\n  /** \n */\n  Price?: string;\n  /**  */\n  CurrencyType?: PricingCurrencyType;\n  /**  */\n  Interval?: PricingInterval;\n  /**  */\n  UnitsForOnce?: string;\n  /**  (token) */\n  UnitName?: string;\n}\n\nexport interface PluginPriceLimit {\n  /** \n */\n  TimesLimit?: string;\n  /**  */\n  TimesInterval?: PricingInterval;\n  /**  */\n  UnitsLimit?: string;\n  /**  */\n  UnitsInterval?: PricingInterval;\n}\n\nexport interface PluginPriceResult {\n  /** \n */\n  Price?: string;\n  /**  */\n  CurrencyType?: PricingCurrencyType;\n  /**  */\n  TokensForOnce?: string;\n}\n\nexport interface PluginPricingRule {\n  /** :plugin; :API */\n  APIName?: string;\n  /** ,  */\n  Comment?: string;\n  /**  */\n  PriceLimit?: PluginPriceLimit;\n  /**  */\n  PriceInfo?: PluginPriceInfo;\n  /**  */\n  PriceResult?: PluginPriceResult;\n  /**  */\n  PricingStrategy?: PluginPricingStrategy;\n  /**  */\n  PricingCalculationType?: PluginPricingCalculationType;\n  /** ID */\n  RuleID?: string;\n  /** 0: plugin; 0: API */\n  APIID?: string;\n  /**  */\n  PluginInfo?: PluginInfo;\n}\n\n/** End  */\nexport interface PluginPublishInfo {\n  /**  */\n  publisher_id?: Int64;\n  /**  */\n  version_ts?: Int64;\n  /**  */\n  version_name?: string;\n  /**  */\n  version_desc?: string;\n}\n\nexport interface PluginStatisticData {\n  /**  */\n  bot_quote?: number;\n}\n\n/**  */\nexport interface PresetCardBindingInfo {\n  card_id?: string;\n  card_version_num?: string;\n  status?: PluginCardStatus;\n  /**  */\n  thumbnail?: string;\n}\n\nexport interface PublishedPluginListData {\n  plugin_list?: Array<PluginInfoForPlayground>;\n  total?: Int64;\n  page?: number;\n  size?: number;\n}\n\nexport interface QueryCardDetailData {\n  card_detail?: CozeCardInfo;\n}\n\nexport interface QueryCardListData {\n  card_list?: Array<CozeCardInfo>;\n  total?: Int64;\n}\n\nexport interface RegisterPluginData {\n  plugin_id?: string;\n  openapi?: string;\n}\n\nexport interface ResponseStyle {\n  workflow_response_mode?: WorkflowResponseMode;\n}\n\nexport interface SignleBindCardStatus {\n  card_id?: string;\n  business_id?: string;\n  unique_id?: string;\n  status?: PluginCardStatus;\n  business_type?: CardBusinessType;\n  card_version?: string;\n}\n\nexport interface TemplateH5UrlObj {\n  js_url?: string;\n  css_url?: string;\n  json_url?: string;\n}\n\nexport interface UpdatePluginData {\n  res?: boolean;\n  edit_version?: number;\n}\n\nexport interface UpsertPluginData {\n  plugin_id?: string;\n}\n\nexport interface UserLabel {\n  label_id?: string;\n  label_name?: string;\n  icon_uri?: string;\n  icon_url?: string;\n  jump_link?: string;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum ActionKey {\n  /**  */\n  Copy = 1,\n  /**  */\n  Delete = 2,\n  /** / */\n  EnableSwitch = 3,\n  /**  */\n  Edit = 4,\n  /** funcflow */\n  SwitchToFuncflow = 8,\n  /** chatflow */\n  SwitchToChatflow = 9,\n  /**  */\n  CrossSpaceCopy = 10,\n}\n\nexport enum CopyStatus {\n  Successful = 1,\n  Processing = 2,\n  Failed = 3,\n  /** KeepOriginTarget */\n  KeepOrigin = 4,\n  /** -> */\n  Deleted = 5,\n}\n\nexport enum ProjectResourceActionKey {\n  /**  */\n  Rename = 1,\n  /** / */\n  Copy = 2,\n  /**  */\n  CopyToLibrary = 3,\n  /**  */\n  MoveToLibrary = 4,\n  /**  */\n  Delete = 5,\n  /**  */\n  Enable = 6,\n  /**  */\n  Disable = 7,\n  /** funcflow */\n  SwitchToFuncflow = 8,\n  /** chatflow */\n  SwitchToChatflow = 9,\n  /**  */\n  UpdateDesc = 10,\n}\n\nexport enum ProjectResourceGroupType {\n  Workflow = 1,\n  Plugin = 2,\n  Data = 3,\n}\n\nexport enum PublishStatus {\n  /**  */\n  UnPublished = 1,\n  /**  */\n  Published = 2,\n}\n\nexport enum ResourceCopyScene {\n  /**  */\n  CopyProjectResource = 1,\n  /** Library */\n  CopyResourceToLibrary = 2,\n  /** Library */\n  MoveResourceToLibrary = 3,\n  /** Library */\n  CopyResourceFromLibrary = 4,\n  /**  */\n  CopyProject = 5,\n  /**  */\n  PublishProject = 6,\n  /**  */\n  CopyProjectTemplate = 7,\n  /**  */\n  PublishProjectTemplate = 8,\n  /**  */\n  LaunchTemplate = 9,\n  /**  */\n  ArchiveProject = 10,\n  /**  */\n  RollbackProject = 11,\n  /**  */\n  CrossSpaceCopy = 12,\n  /**  */\n  CrossSpaceCopyProject = 13,\n}\n\nexport enum ResType {\n  Plugin = 1,\n  Workflow = 2,\n  Imageflow = 3,\n  Knowledge = 4,\n  UI = 5,\n  Prompt = 6,\n  Database = 7,\n  Variable = 8,\n  Voice = 9,\n}\n\nexport enum SyncOperation {\n  Upsert = 1,\n  Delete = 2,\n}\n\n/** struct ResourceCopyExtraInfo{\n    // \n    1 : optional string ResourceName (go.tag = \"json:\\\"resource_name\\\"\", agw.key = \"resource_name\")\n    // \n    2 : optional string VersionNum  (go.tag = \"json:\\\"version_num\\\"\", agw.key = \"version_num\")\n    // \n    3 : optional string VersionDesc  (go.tag = \"json:\\\"version_desc\\\"\", agw.key = \"version_desc\")\n    // schema\n    4 : optional string ResourceExtendInfo  (go.tag = \"json:\\\"resource_extend_info\\\"\", agw.key = \"resource_extend_info\")\n} */\nexport enum TaskStatus {\n  Successed = 1,\n  Processing = 2,\n  Failed = 3,\n  Canceled = 4,\n}\n\nexport interface ProjectResourceAction {\n  /** keykey */\n  key: ProjectResourceActionKey;\n  /** ture=Actionfalse= */\n  enable: boolean;\n  /** enable=falseStarling Keyspace */\n  hint?: string;\n}\n\nexport interface ProjectResourceGroup {\n  /**  */\n  group_type?: ProjectResourceGroupType;\n  resource_list?: Array<ProjectResourceInfo>;\n}\n\n/**  */\nexport interface ProjectResourceInfo {\n  /** id */\n  res_id?: string;\n  /**  */\n  name?: string;\n  /**  */\n  actions?: Array<ProjectResourceAction>;\n  /** \n4: bool ReadOnly (go.tag = \"json:\\\"read_only\\\"\", agw.key = \"read_only\")\n */\n  res_type?: ResType;\n  /** Plugin1-Http; 2-App; 6-LocalKnowledge0-text; 1-table; 2-imageUI1-Card */\n  res_sub_type?: number;\n  /** res_typeres_typeschemares_type */\n  biz_extend?: Record<string, string>;\n  /**  */\n  biz_res_status?: number;\n  /**  */\n  version_str?: string;\n  res_third_type?: number;\n}\n\n/** Library */\nexport interface ResourceAction {\n  /** keykey */\n  key: ActionKey;\n  /** ture=Actionfalse= */\n  enable: boolean;\n}\n\nexport interface ResourceCopyFailedReason {\n  res_id?: string;\n  res_type?: ResType;\n  res_name?: string;\n  reason?: string;\n  /**  */\n  publish_version?: Int64;\n  /** nilLibrary */\n  publish_version_str?: string;\n}\n\nexport interface ResourceCopyTaskDetail {\n  task_id?: string;\n  /**  */\n  status?: TaskStatus;\n  /** id */\n  res_id?: string;\n  res_type?: ResType;\n  scene?: ResourceCopyScene;\n  /**  */\n  res_name?: string;\n}\n\n/**  */\nexport interface ResourceInfo {\n  /** id */\n  res_id?: string;\n  /**  */\n  res_type?: ResType;\n  /** \nPlugin1-Http; 2-App; 6-LocalKnowledge0-text; 1-table; 2-imageUI1-Card */\n  res_sub_type?: number;\n  /**  */\n  name?: string;\n  /**  */\n  desc?: string;\n  /** Iconurl */\n  icon?: string;\n  /**  */\n  creator_id?: string;\n  /**  */\n  creator_avatar?: string;\n  /**  */\n  creator_name?: string;\n  /**  */\n  user_name?: string;\n  /** 1-2- */\n  publish_status?: PublishStatus;\n  /**  */\n  biz_res_status?: number;\n  /**  */\n  collaboration_enable?: boolean;\n  /** , unix */\n  edit_time?: Int64;\n  /** ID */\n  space_id?: string;\n  /** res_typeres_typeschemares_type */\n  biz_extend?: Record<string, string>;\n  /**  */\n  actions?: Array<ResourceAction>;\n  /**  */\n  detail_disable?: boolean;\n  /** []true--itemfalse- */\n  del_flag?: boolean;\n  res_third_type?: number;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nimport * as bot_common from './bot_common';\nimport * as base from './base';\n\nexport type Int64 = string | number;\n\nexport enum AgentStatus {\n  Deleted = 0,\n  Valid = 1,\n}\n\nexport enum CompressionType {\n  Disable = 0,\n  /**  */\n  Halve = 1,\n}\n\nexport enum EntityType {\n  SocietyMeta = 1,\n  Bot = 2,\n}\n\nexport enum EventTypeCode {\n  ON_LINE = 0,\n  OFF_LINE = 1,\n  TOUCH = 2,\n}\n\nexport enum MetaStatus {\n  Deleted = 0,\n  Valid = 1,\n}\n\nexport enum OperateProcessType {\n  Pause = 1,\n  Continue = 2,\n  Termination = 3,\n  Exit = 4,\n  Retry = 5,\n}\n\nexport enum ParticipantSource {\n  Coze = 1,\n  Store = 2,\n}\n\nexport enum ProcessMode {\n  Product = 1,\n  Debug = 2,\n}\n\nexport enum ProcessStatus {\n  Waiting = 1,\n  Running = 2,\n  Suspending = 3,\n  Suspend = 4,\n  Finished = 5,\n  Exit = 6,\n}\n\nexport enum ProductPublishMode {\n  OpenSource = 1,\n  ClosedSource = 2,\n}\n\nexport enum PublishFilter {\n  UnPublished = 0,\n  Published = 1,\n}\n\nexport enum PublishStatus {\n  Accepted = 1,\n  Publishing = 2,\n  Auditing = 3,\n  AuditNotPass = 4,\n  AuditPass = 5,\n  Success = 6,\n  Fail = 7,\n  ExternalAuditing = 8,\n}\n\nexport enum QuerySource {\n  Teamspace = 1,\n  SubmitStore = 2,\n  Publishing = 3,\n  StoreDetail = 4,\n}\n\nexport enum RoleAgentType {\n  Bot = 1,\n  User = 2,\n  Host = 3,\n}\n\nexport enum RoleStatus {\n  Deleted = 0,\n  Valid = 1,\n}\n\nexport enum RoleType {\n  Host = 1,\n  PresetBot = 2,\n  Custom = 3,\n}\n\nexport enum SocietyMetaEventType {\n  Delete = 1,\n}\n\nexport enum UserAgentType {\n  Player = 1,\n  Audience = 2,\n  Developer = 3,\n}\n\nexport interface Agent {\n  id: string;\n  agent_type: RoleAgentType;\n  process_id: string;\n  meta_id: string;\n  role_id: string;\n  participant_id: string;\n  nickname: string;\n  description: string;\n  status: AgentStatus;\n  create_time: string;\n  update_time: string;\n  icon_uri: string;\n  icon_url: string;\n  role_name: string;\n  visibility: bot_common.SocietyVisibility;\n  participant_url: string;\n  participant_source: ParticipantSource;\n}\n\nexport interface AgentItem {\n  agent_type: RoleAgentType;\n  role_id: string;\n  participant_id: string;\n  nickname: string;\n  description: string;\n  /** botstoreteamspace */\n  participant_source?: ParticipantSource;\n}\n\nexport interface AgentName2Id {\n  agent_id?: string;\n  agent_name?: string;\n}\n\nexport interface AuditEntityData {\n  entity_id: string;\n  entity_type: EntityType;\n  name: string;\n  icon_url: string;\n  audit_not_pass: boolean;\n  not_pass_reason: Array<string>;\n}\n\nexport interface BatchCreateSocietyRoleRequest {\n  meta_id: string;\n  role_list: Array<CreateRole>;\n  /**  */\n  role_visibility_config?: RoleVisibilityConfig;\n  Base?: base.Base;\n}\n\nexport interface BatchCreateSocietyRoleResponse {\n  role_list: Array<Role>;\n  role_visibility_config: RoleVisibilityConfig;\n  /** Host workinfo */\n  host_work_info?: WorkInfo;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface BatchDeleteSocietyRoleRequest {\n  meta_id: string;\n  role_id_list: Array<string>;\n  /**  */\n  role_visibility_config?: RoleVisibilityConfig;\n  /** Host workinfo */\n  host_work_info?: WorkInfo;\n  Base?: base.Base;\n}\n\nexport interface BatchDeleteSocietyRoleResponse {\n  role_visibility_config: RoleVisibilityConfig;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface BatchUpdateSocietyRoleRequest {\n  meta_id: string;\n  role_list: Array<UpdateRole>;\n  /**  */\n  role_visibility_config?: RoleVisibilityConfig;\n  /** Host workinfo */\n  host_work_info?: WorkInfo;\n  Base?: base.Base;\n}\n\nexport interface BatchUpdateSocietyRoleResponse {\n  role_list: Array<Role>;\n  role_visibility_config: RoleVisibilityConfig;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface ChatMessage {\n  role?: string;\n  type?: string;\n  content?: string;\n  content_type?: string;\n  /** message_idtask_id */\n  message_id?: string;\n  reply_id?: string;\n  section_id?: string;\n  extra_info?: ExtraInfo;\n  /**  chat */\n  status?: string;\n  /**  */\n  broken_pos?: number;\n  sender_id?: string;\n}\n\nexport interface ContextCompressionConfig {\n  compression_type: CompressionType;\n  /** , */\n  compression_point: number;\n}\n\nexport interface CreateProcessRequest {\n  process: ProcessItem;\n  agent_list?: Array<AgentItem>;\n  device_id: string;\n  Base?: base.Base;\n}\n\nexport interface CreateProcessResponse {\n  process_id: string;\n  process: Process;\n  agent_list: Array<Agent>;\n  current_agent_id: string;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface CreateRole {\n  name: string;\n  role_type: RoleType;\n  /** 3: required Visibility visibility, // \n,participant_id */\n  preset_bot_id?: string;\n  nickname?: string;\n  description?: string;\n  /** botstoreteamspace */\n  participant_source?: ParticipantSource;\n  participant_id?: string;\n}\n\nexport interface CreateSocietyMetaRequest {\n  name: string;\n  description: string;\n  space_id: string;\n  icon_uri: string;\n  Base?: base.Base;\n}\n\nexport interface CreateSocietyMetaResponse {\n  meta_id: string;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface DeleteSocietyMessageRequest {\n  process_id: string;\n  /**  */\n  round: number;\n  Base?: base.Base;\n}\n\nexport interface DeleteSocietyMessageResponse {\n  code: Int64;\n  msg: string;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface DeleteSocietyMetaRequest {\n  meta_id: string;\n  Base?: base.Base;\n}\n\nexport interface DeleteSocietyMetaResponse {\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface DuplicateSocietyMetaRequest {\n  meta_id: string;\n  meta_version?: string;\n  target_space_id?: string;\n  Base?: base.Base;\n}\n\nexport interface DuplicateSocietyMetaResponse {\n  copy_meta_id: string;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface Event {\n  ProductID?: number;\n  AppID?: number;\n  DeviceID?: Int64;\n  EventType?: EventTypeCode;\n  Extended?: Record<string, string>;\n  UserID?: Int64;\n  Header?: Record<string, Array<string>>;\n  ConnUUID?: string;\n}\n\nexport interface ExtraInfo {\n  local_message_id?: string;\n  input_tokens?: string;\n  output_tokens?: string;\n  token?: string;\n  /** \"success\" or \"fail\" */\n  plugin_status?: string;\n  time_cost?: string;\n  workflow_tokens?: string;\n  bot_state?: string;\n  plugin_request?: string;\n  tool_name?: string;\n  plugin?: string;\n  mock_hit_info?: string;\n  log_id?: string;\n  stream_id?: string;\n  message_title?: string;\n  stream_plugin_running?: string;\n  society_state?: string;\n  message_id?: string;\n  conversation_id?: string;\n}\n\nexport interface GenerateMetaStoreCategoryRequest {\n  name: string;\n  description: string;\n  prompt: string;\n  Base?: base.Base;\n}\n\nexport interface GenerateMetaStoreCategoryResponse {\n  category_id: string;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetMetaRoleListRequest {\n  meta_id: string;\n  meta_version?: string;\n  Base?: base.Base;\n}\n\nexport interface GetMetaRoleListResponse {\n  role_list: Array<Role>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetMetaVariablesRequest {\n  meta_id: string;\n  meta_version?: string;\n  Base?: base.Base;\n}\n\nexport interface GetMetaVariablesResponse {\n  variables: Array<bot_common.Variable>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetProcessDetailRequest {\n  process_id: string;\n  Base?: base.Base;\n}\n\nexport interface GetProcessDetailResponse {\n  process: Process;\n  agent_list: Array<Agent>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetProcessMemoryRequest {\n  process_id: string;\n  agent_id: string;\n  Base?: base.Base;\n}\n\nexport interface GetProcessMemoryResponse {\n  memorys?: Array<MemoryKVItem>;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetPublishEntityListRequest {\n  order_id: string;\n  Base?: base.Base;\n}\n\nexport interface GetPublishEntityListResponse {\n  entity_list: Array<PublishEntityData>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetPublishMetaResultRequest {\n  order_id: string;\n  Base?: base.Base;\n}\n\nexport interface GetPublishMetaResultResponse {\n  result_list: Array<PublishEntityResult>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetSocietyMessageListRequest {\n  process_id: string;\n  agent_id: string;\n  /** task_id */\n  before_task_id?: string;\n  /** task_id */\n  after_task_id?: string;\n  /** 20 */\n  count?: number;\n  Base?: base.Base;\n}\n\nexport interface GetSocietyMessageListResponse {\n  message_list: Array<RoundChatMessage>;\n  hasmore: boolean;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetSocietyMetaDetailRequest {\n  meta_id: string;\n  /** play */\n  process_mode: ProcessMode;\n  meta_version?: string;\n  need_process_info?: boolean;\n  query_source?: QuerySource;\n  Base?: base.Base;\n}\n\nexport interface GetSocietyMetaDetailResponse {\n  meta: Meta;\n  role_list: Array<Role>;\n  /** 3: optional ProcessDetail latest_process, //  */\n  latest_debug_process?: ProcessDetail;\n  latest_product_process?: ProcessDetail;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface GetSocietyMetaListRequest {\n  space_id: string;\n  creator_id?: string;\n  query?: string;\n  page: number;\n  size: number;\n  publish_filter?: PublishFilter;\n  query_source?: QuerySource;\n  Base?: base.Base;\n}\n\nexport interface GetSocietyMetaListResponse {\n  meta_list: Array<Meta>;\n  total: number;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface HostConfig {\n  model_id: string;\n  max_round: number;\n}\n\nexport interface MemoryKVItem {\n  keyword?: string;\n  value?: string;\n  create_time?: string;\n  update_time?: string;\n  is_system?: boolean;\n  prompt_disabled?: boolean;\n  description?: string;\n}\n\nexport interface Meta {\n  id: string;\n  name: string;\n  description: string;\n  space_id: string;\n  user_id: string;\n  icon_uri: string;\n  icon_url: string;\n  create_time: string;\n  update_time: string;\n  society_prompt: string;\n  /** host, *2 *3 */\n  role_count_list: Array<RoleCount>;\n  username: string;\n  nickname: string;\n  user_icon_url: string;\n  /**  */\n  deletable: boolean;\n  /** host, */\n  host_config?: HostConfig;\n  /**  */\n  context_compression_config?: ContextCompressionConfig;\n  /** url */\n  background_img_url: string;\n  /**  */\n  role_visibility_config: RoleVisibilityConfig;\n  has_published: boolean;\n  store_url: string;\n  host_available_model_list?: Array<ModelInfo>;\n}\n\nexport interface ModelDescGroup {\n  group_name: string;\n  desc: Array<string>;\n}\n\nexport interface ModelInfo {\n  model_id: string;\n  name: string;\n  icon_url: string;\n  token_limit: Int64;\n  model_desc: Array<ModelDescGroup>;\n}\n\nexport interface OperateProcessRequest {\n  process_id: string;\n  operate_process_type: OperateProcessType;\n  Base?: base.Base;\n}\n\nexport interface OperateProcessResponse {\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface Process {\n  id: string;\n  process_mode: ProcessMode;\n  meta_id: string;\n  user_id: string;\n  create_time: string;\n  update_time: string;\n  status: ProcessStatus;\n  wait_user_reply?: UserInputTask;\n  process_profile?: ProcessProFile;\n}\n\nexport interface ProcessDetail {\n  process: Process;\n  agent_list: Array<Agent>;\n}\n\nexport interface ProcessItem {\n  process_mode: ProcessMode;\n  meta_id: string;\n  meta_version?: string;\n}\n\nexport interface ProcessProFile {\n  code?: number;\n  message?: string;\n  extra_info?: ExtraInfo;\n}\n\nexport interface PublishConnector {\n  connector_id: string;\n  entity_settings_list: Array<PublishEntitySettings>;\n}\n\nexport interface PublishEntityChangeLog {\n  entity_id: string;\n  entity_type: EntityType;\n  change_log: string;\n}\n\nexport interface PublishEntityData {\n  entity_id: string;\n  entity_type: EntityType;\n  name: string;\n  description: string;\n  prompt: string;\n  icon_url: string;\n  product_publish_mode: ProductPublishMode;\n  category?: string;\n  allow_product_open_source: boolean;\n}\n\nexport interface PublishEntityResult {\n  entity_id: string;\n  entity_type: EntityType;\n  name: string;\n  icon_url: string;\n  publish_status: PublishStatus;\n  reason: Array<string>;\n  space_id: string;\n}\n\nexport interface PublishEntitySettings {\n  entity_id: string;\n  entity_type: EntityType;\n  product_publish_mode?: ProductPublishMode;\n  store_category?: string;\n}\n\nexport interface PublishingMetaRequest {\n  order_id: string;\n  change_log_list: Array<PublishEntityChangeLog>;\n  connector_list: Array<PublishConnector>;\n  Base?: base.Base;\n}\n\nexport interface PublishingMetaResponse {\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface PublishMetaPreCreateRequest {\n  meta_id: string;\n  Base?: base.Base;\n}\n\nexport interface PublishMetaPreCreateResponse {\n  order_id: string;\n  audit_data_list: Array<AuditEntityData>;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface Role {\n  id: string;\n  name: string;\n  role_type: RoleType;\n  /** 4: required Visibility visibility, // \n5: required i64 preset_bot_id (api.js_conv='true' agw.js_conv=\"str\"), // ,participant_id */\n  nickname: string;\n  description: string;\n  meta_id: string;\n  space_id: string;\n  user_id: string;\n  status: RoleStatus;\n  create_time: Int64;\n  update_time: Int64;\n  icon_uri: string;\n  icon_url: string;\n  persona: string;\n  bot_name: string;\n  bot_status: bot_common.BotStatus;\n  /** botstoreteamspace */\n  participant_source: ParticipantSource;\n  participant_id: string;\n  participant_creator_id?: string;\n  /**  */\n  is_cascade_publish?: boolean;\n  work_info?: WorkInfo;\n  biz_role_id?: string;\n}\n\nexport interface RoleCount {\n  name: string;\n  count: number;\n}\n\nexport interface RoleVisibilityConfig {\n  role_cfg_list: Array<RoleVisibilityItem>;\n}\n\nexport interface RoleVisibilityItem {\n  name: string;\n  visibility_type: bot_common.SocietyVisibility;\n  visibility_roles?: Array<string>;\n}\n\nexport interface RoundChatMessage {\n  message: ChatMessage;\n  is_finish: boolean;\n  round: number;\n  index_in_round: number;\n  agent_id: string;\n  seq_id: number;\n}\n\nexport interface UpdateRole {\n  id: string;\n  name?: string;\n  role_type?: RoleType;\n  visibility?: bot_common.SocietyVisibility;\n  /** 5: optional i64 preset_bot_id (api.js_conv='true' agw.js_conv=\"str\"), //,participant_id */\n  nickname?: string;\n  description?: string;\n  /** botstoreteamspace */\n  participant_source?: ParticipantSource;\n  participant_id?: string;\n}\n\nexport interface UpdateSocietyHostRequest {\n  meta_id: string;\n  name?: string;\n  persona?: string;\n  icon_uri?: string;\n  /**  */\n  role_visibility_config?: RoleVisibilityConfig;\n  /** host, */\n  host_config?: HostConfig;\n  work_info?: WorkInfo;\n  Base?: base.Base;\n}\n\nexport interface UpdateSocietyHostResponse {\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface UpdateSocietyMeta {\n  id: string;\n  name?: string;\n  description?: string;\n  icon_uri?: string;\n  society_prompt?: string;\n  /**  */\n  context_compression_config?: ContextCompressionConfig;\n  /** url */\n  background_img_uri?: string;\n  /**  */\n  role_visibility_config?: RoleVisibilityConfig;\n}\n\nexport interface UpdateSocietyMetaRequest {\n  meta: UpdateSocietyMeta;\n  Base?: base.Base;\n}\n\nexport interface UpdateSocietyMetaResponse {\n  meta_id: string;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface UpdateUserAgentRequest {\n  process_id: string;\n  /**  */\n  agent_id?: string;\n  /** frontier */\n  device_id?: string;\n  Base?: base.Base;\n}\n\nexport interface UpdateUserAgentResponse {\n  user_agent: UserAgent;\n  message_list: Array<RoundChatMessage>;\n  hasmore: boolean;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface UserAgent {\n  process_id?: string;\n  user_id?: string;\n  agent_id?: string;\n  type?: UserAgentType;\n}\n\nexport interface UserAgentReplyRequest {\n  process_id: string;\n  /**  */\n  content: string;\n  /** society_statetask_id */\n  task_id: string;\n  Base?: base.Base;\n}\n\nexport interface UserAgentReplyResponse {\n  /** true */\n  already_replied: boolean;\n  code: Int64;\n  msg: string;\n  BaseResp: base.BaseResp;\n}\n\nexport interface UserInputTask {\n  task_id?: string;\n  receivers?: Array<AgentName2Id>;\n  round?: Int64;\n  index_in_round?: Int64;\n  reply_agent_id?: string;\n}\n\n/** WorkflowDetail */\nexport interface WorkflowDetail {\n  workflow_id: string;\n  plugin_id: string;\n  name: string;\n  desc: string;\n  parameters: Array<bot_common.PluginParameter>;\n  plugin_icon: string;\n  flow_mode: bot_common.WorkflowMode;\n  node_param_data?: Record<string, Array<WorkflowNodeParamData>>;\n}\n\nexport interface WorkflowNodeParamData {\n  node_type?: string;\n  param_name?: string;\n  param_value?: string;\n}\n\nexport interface WorkInfo {\n  workflows?: Array<WorkflowDetail>;\n  variables?: Array<bot_common.Variable>;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nimport * as base from './base';\n\nexport type Int64 = string | number;\n\nexport enum FrontedTagType {\n  /**  */\n  TEXT = 0,\n  /**  */\n  TIME = 1,\n  /**  */\n  TIME_DURATION = 2,\n}\n\nexport enum InputOutputType {\n  /**  */\n  TEXT = 0,\n}\n\nexport enum QueryScene {\n  /** doubao cici  */\n  ALICE_OP = 0,\n  /** doubao cici debug  */\n  DOUBAO_CICI_DEBUG = 1,\n  /** workflow debug  */\n  WORKFLOW_DEBUG = 2,\n}\n\nexport enum QueryTypeEnum {\n  Undefined = 0,\n  Match = 1,\n  Term = 2,\n  Range = 3,\n  Exist = 4,\n  NotExist = 5,\n}\n\nexport enum SpanStatus {\n  Unknown = 0,\n  Success = 1,\n  Fail = 2,\n}\n\nexport enum TagType {\n  STRING = 0,\n  DOUBLE = 1,\n  BOOL = 2,\n  LONG = 3,\n  BYTES = 4,\n}\n\nexport enum TenantLevel {\n  Ordinary = 0,\n  AdvancedWhitelist = 1,\n}\n\nexport interface FrontendTag {\n  key: string;\n  /**  key */\n  key_alias?: string;\n  tag_type: TagType;\n  value?: Value;\n  /**  */\n  frontend_tag_type?: FrontedTagType;\n  /**  */\n  can_copy?: boolean;\n}\n\nexport interface GetTraceSDKRequest {\n  log_id?: string;\n  /**  */\n  start_at?: Int64;\n  /**  */\n  end_at?: Int64;\n  workflow_id?: Int64;\n  execute_id?: Int64;\n  Base?: base.Base;\n}\n\nexport interface GetTraceSDKResponse {\n  data?: TraceFrontend;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface ListRootSpansRequest {\n  /**  */\n  start_at: Int64;\n  /**  */\n  end_at: Int64;\n  limit?: number;\n  desc_by_start_time?: boolean;\n  offset?: number;\n  workflow_id: string;\n  input?: string;\n  status?: SpanStatus;\n  /** //Debug */\n  execute_mode?: number;\n  Base?: base.Base;\n}\n\nexport interface ListRootSpansResponse {\n  spans?: Array<Span>;\n  BaseResp?: base.BaseResp;\n}\n\nexport interface Span {\n  trace_id?: string;\n  log_id?: string;\n  psm?: string;\n  dc?: string;\n  pod_name?: string;\n  span_id?: string;\n  type?: string;\n  name?: string;\n  parent_id?: string;\n  /**  */\n  duration?: Int64;\n  /**  */\n  start_time?: Int64;\n  status_code?: number;\n  tags?: Array<TraceTag>;\n}\n\nexport interface SpanInputOutput {\n  /** TEXT */\n  type?: InputOutputType;\n  content?: string;\n}\n\nexport interface SpanSummary {\n  tags?: Array<FrontendTag>;\n}\n\nexport interface TraceFrontend {\n  spans?: Array<TraceFrontendSpan>;\n  header?: TraceHeader;\n}\n\nexport interface TraceFrontendSpan {\n  trace_id?: string;\n  log_id?: string;\n  span_id?: string;\n  type?: string;\n  name?: string;\n  alias_name?: string;\n  parent_id?: string;\n  /**  */\n  duration?: Int64;\n  /**  */\n  start_time?: Int64;\n  status_code?: number;\n  tags?: Array<TraceTag>;\n  /**  */\n  summary?: SpanSummary;\n  input?: SpanInputOutput;\n  output?: SpanInputOutput;\n  /**  */\n  is_entry?: boolean;\n  /**  */\n  product_line?: string;\n  /**  */\n  is_key_span?: boolean;\n  /** ,  */\n  owner_list?: Array<string>;\n  /**  */\n  rundown_doc_url?: string;\n}\n\nexport interface TraceHeader {\n  /**  */\n  duration?: Int64;\n  /** token */\n  tokens?: number;\n  status_code?: number;\n  tags?: Array<FrontendTag>;\n  /** ID */\n  message_id?: string;\n  /**  */\n  start_time?: Int64;\n}\n\n/** Tag */\nexport interface TraceTag {\n  key?: string;\n  tag_type?: TagType;\n  value?: Value;\n}\n\nexport interface Value {\n  v_str?: string;\n  v_double?: number;\n  v_bool?: boolean;\n  v_long?: Int64;\n  v_bytes?: Blob;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum SuggestReplyInfoMode {\n  /**  */\n  Disable = 0,\n  /**  */\n  System = 1,\n  /**  */\n  Custom = 2,\n}\n\nexport interface EnterMessage {\n  role: string;\n  /**  */\n  content?: string;\n  meta_data?: Record<string, string>;\n  /** text/card/object_string */\n  content_type?: string;\n  type?: string;\n}\n\nexport interface InsertedAdditionalMessage {\n  id: string;\n}\n\nexport interface InterruptFunction {\n  name?: string;\n  arguments?: string;\n}\n\nexport interface InterruptPlugin {\n  id?: string;\n  type?: string;\n  function?: InterruptFunction;\n  require_info?: InterruptRequireInfo;\n}\n\nexport interface InterruptRequireInfo {\n  infos?: Array<string>;\n}\n\nexport interface LastError {\n  code: number;\n  msg: string;\n}\n\nexport interface RequiredAction {\n  type?: string;\n  submit_tool_outputs?: SubmitToolOutputs;\n}\n\nexport interface SubmitToolOutputs {\n  tool_calls?: Array<InterruptPlugin>;\n}\n\n/** suggest */\nexport interface SuggestReplyInfo {\n  /**  Coze Auto-Suggestion\n */\n  suggest_reply_mode?: SuggestReplyInfoMode;\n  /**  */\n  customized_suggest_prompt?: string;\n}\n\nexport interface Usage {\n  token_count?: number;\n  output_count?: number;\n  input_count?: number;\n}\n\nexport interface WorkflowChatData {\n  /** MessageDetail */\n  id?: string;\n  conversation_id?: string;\n  bot_id?: string;\n  role?: string;\n  type?: string;\n  content?: string;\n  content_type?: string;\n  meta_data?: Record<string, string>;\n  chat_id?: string;\n  section_id?: string;\n  created_at?: number;\n  updated_at?: number;\n  /** ChatDetail */\n  completed_at?: number;\n  failed_at?: number;\n  last_error?: LastError;\n  status?: string;\n  usage?: Usage;\n  required_action?: RequiredAction;\n  execute_id?: string;\n  inserted_additional_messages?: Array<InsertedAdditionalMessage>;\n  /**  */\n  code?: number;\n  msg?: string;\n  /** Done Message\n , DONE  */\n  debug_url?: string;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport {\n  reportTti,\n  REPORT_TTI_DEFAULT_SCENE,\n} from './utils/custom-perf-metric';\n\nexport interface ReportTtiParams {\n  isLive: boolean;\n  extra?: Record<string, string>;\n  scene?: string; // A page only reports tti once by default, and different scenes can be reported multiple times.\n}\n\nexport const useReportTti = ({\n  isLive,\n  extra,\n  scene = REPORT_TTI_DEFAULT_SCENE,\n}: ReportTtiParams) => {\n  useEffect(() => {\n    if (isLive) {\n      // There will be a gap between TODO useEffect and real DOM rendering, you need to consider how to smooth the difference\n      // SetTimeout hangs in the background of the page, causing TTI to be severely inaccurate\n      reportTti(extra, scene);\n    }\n  }, [isLive]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { logger, reporter, getSlardarInstance } from '@coze-arch/logger';\n\nenum CustomPerfMarkNames {\n  RouteChange = 'route_change',\n}\n\nexport enum PerfMetricNames {\n  TTI = 'coze_custom_tti',\n  TTI_HOT = 'coze_custom_tti_hot',\n}\n\nconst fcpEntryName = 'first-contentful-paint';\n\nconst lastRouteNameRef: {\n  name: string;\n  reportScene: Array<string>;\n} = { name: '', reportScene: [] };\n\nexport const REPORT_TTI_DEFAULT_SCENE = 'init';\n\nexport const reportTti = (extra?: Record<string, string>, scene?: string) => {\n  const sceneKey = scene ?? REPORT_TTI_DEFAULT_SCENE;\n  const value = performance.now();\n  const routeChangeEntries = performance.getEntriesByName(\n    CustomPerfMarkNames.RouteChange,\n  ) as PerformanceMark[];\n  const lastRoute = routeChangeEntries.at(-1);\n  // The current page has been reported\n  if (\n    lastRoute?.detail?.location?.pathname &&\n    lastRoute.detail.location.pathname === lastRouteNameRef.name &&\n    lastRouteNameRef.reportScene.includes(sceneKey)\n  ) {\n    return;\n  }\n  if (document.visibilityState === 'hidden') {\n    // The tab is in the background, the FCP/TTI is inaccurate, and the reporting is abandoned.\n    reporter.info({\n      message: 'page_hidden_on_tti_report',\n      namespace: 'performance',\n    });\n    return;\n  }\n  lastRouteNameRef.name = lastRoute?.detail?.location?.pathname;\n  lastRouteNameRef.reportScene.push(sceneKey);\n\n  // The first route is regarded as a cold start, otherwise it is regarded as a hot start, because the expected TTI time difference will be relatively large, and it will be reported to different event tracking here.\n  if (routeChangeEntries.length > 1) {\n    // StartTime is an offset from the performance .timeOrigin\n    executeSendTtiHot(value - (lastRoute?.startTime ?? 0), extra);\n    return;\n  }\n  const fcp = performance.getEntriesByName(fcpEntryName)[0];\n  if (fcp) {\n    // FCP has occurred, compare TTI and FCP times, and take the longer one.\n    executeSendTti(value > fcp.startTime ? value : fcp.startTime, {\n      ...extra,\n      fcpTime: `${fcp.startTime}`,\n    });\n  } else if (window.PerformanceObserver) {\n    // When no FCP has occurred, monitor the FCP and report it as a TTI\n    const observer = new PerformanceObserver(list => {\n      const fcpEntry = list.getEntriesByName(fcpEntryName)[0];\n      if (fcpEntry) {\n        executeSendTti(fcpEntry.startTime, {\n          ...extra,\n          fcpTime: `${fcpEntry.startTime}`,\n        });\n        observer.disconnect();\n      }\n    });\n    try {\n      observer.observe({ type: 'paint', buffered: true });\n    } catch (error) {\n      // Handling compatibility issues Failed to execute'observe 'on'PerformanceObserver': required member entryTypes is undefined.\n      if (PerformanceObserver.supportedEntryTypes?.includes('paint')) {\n        try {\n          observer.observe({ entryTypes: ['paint'] });\n        } catch (innerError) {\n          reporter.info({\n            message: (innerError as Error).message,\n            namespace: 'performance',\n          });\n        }\n      }\n      reporter.info({\n        message: (error as Error).message,\n        namespace: 'performance',\n      });\n    }\n  }\n};\n\nconst executeSendTti = (value: number, extra?: Record<string, string>) => {\n  getSlardarInstance()?.('sendCustomPerfMetric', {\n    value,\n    name: PerfMetricNames.TTI,\n    /** Performance index type, perf = > traditional performance, spa = > SPA performance, mf = > micro frontend performance */\n    type: 'perf',\n    extra: {\n      ...extra,\n    },\n  });\n\n  logger.info({\n    message: 'coze_custom_tti',\n    meta: { value, extra },\n  });\n};\n\nconst executeSendTtiHot = (value: number, extra?: Record<string, string>) => {\n  getSlardarInstance()?.('sendCustomPerfMetric', {\n    value,\n    name: PerfMetricNames.TTI_HOT,\n    /** Performance index type, perf = > traditional performance, spa = > SPA performance, mf = > micro frontend performance */\n    type: 'perf',\n    extra: {\n      ...extra,\n    },\n  });\n\n  logger.info({\n    message: 'coze_custom_tti_hot',\n    meta: { value, extra },\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext } from 'react';\n\nimport { type ActionController, type ActionSize } from '../types';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const ActionBarContext = createContext<{\n  controller: ActionController;\n  size: ActionSize;\n}>({\n  controller: {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    hideActionBar: () => {},\n    // reposition\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    rePosition: () => {},\n  },\n  size: 'small',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { type ActionController, type ActionSize } from '../types';\nimport { ActionBarContext } from '../context';\n\ninterface ActionBarPreference {\n  size: ActionSize;\n  controller: ActionController;\n}\n\nexport const useActionBarPreference = (): ActionBarPreference => {\n  const { size, controller } = useContext(ActionBarContext);\n  return { size, controller };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type PropsWithChildren,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from 'react';\n\nimport cls from 'classnames';\nimport {\n  PositionMirror,\n  useEditor,\n  useInjector,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { Popover } from '@coze-arch/coze-design';\nimport { drawSelection, EditorView } from '@codemirror/view';\n\nimport { type SelectionInfo } from '../types';\nimport { ThemeExtension } from '../theme';\nimport { useReadonly } from '../shared/hooks/use-editor-readonly';\nimport { type ActionController } from './types';\nimport { ActionBarContext } from './context';\ninterface ActionBarProps {\n  className?: string;\n  size?: 'default' | 'small' | 'large';\n  visible?: boolean;\n  onVisibleChange?: (visible: boolean) => void;\n  trigger?: 'custom' | 'selection';\n}\nexport const ActionBar: React.FC<PropsWithChildren<ActionBarProps>> = props => {\n  const {\n    className,\n    size = 'small',\n    children,\n    visible,\n    onVisibleChange,\n    trigger = 'selection',\n  } = props;\n  const [internalVisible, setInternalVisible] = useState(false);\n  const [reposKey, setReposKey] = useState('');\n  const [popoverPosition, setPopoverPosition] = useState(-1);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const isReadOnly = useReadonly();\n  const [selection, setSelection] = useState<SelectionInfo>({\n    from: 0,\n    to: 0,\n    anchor: 0,\n    head: 0,\n  });\n  const editor = useEditor<EditorAPI>();\n  const injector = useInjector();\n  const [position, setPosition] = useState<\n    'topLeft' | 'bottomRight' | undefined\n  >();\n\n  useEffect(() => {\n    setPosition(\n      selection?.head > selection?.anchor ? 'bottomRight' : 'topLeft',\n    );\n  }, [selection]);\n\n  const controller: ActionController = {\n    hideActionBar: () => {\n      onVisibleChange?.(false);\n      setInternalVisible(false);\n    },\n    rePosition: (newPosition?: 'topLeft' | 'bottomRight') => {\n      setReposKey(String(Math.random()));\n      newPosition && setPosition(newPosition);\n    },\n  };\n\n  useLayoutEffect(() => injector.inject([drawSelection()]), [injector]);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    function handleMousedown() {\n      onVisibleChange?.(false);\n      setInternalVisible(false);\n      setPopoverPosition(-1);\n    }\n\n    function handleMouseup(e: MouseEvent) {\n      if (containerRef.current?.contains(e.target as Node)) {\n        return;\n      }\n      const selectionRange = editor.getSelection();\n      setSelection(selectionRange);\n\n      if (!selectionRange) {\n        onVisibleChange?.(false);\n        setPopoverPosition(-1);\n        setInternalVisible(false);\n        return;\n      }\n      const isSelection = selectionRange.from !== selectionRange.to;\n      setSelection(selectionRange);\n      onVisibleChange?.(isSelection);\n      setInternalVisible(isSelection);\n      setPopoverPosition(selectionRange.head);\n    }\n\n    function handleSelectionChange() {\n      onVisibleChange?.(false);\n      setPopoverPosition(-1);\n      setInternalVisible(false);\n    }\n\n    // function handleBlur() {\n    //   onVisibleChange?.(false);\n    //   setInternalVisible(false);\n    //   editor.$view.dispatch({\n    //     selection: { anchor: editor.$view.state.selection.main.head },\n    //   });\n    // }\n\n    editor.$on('mousedown', handleMousedown);\n    // Do not use editor. $on to listen for mouseup events because the mouse may not be in the editor\n    document.addEventListener('mouseup', handleMouseup);\n    editor.$on('selectionChange', handleSelectionChange);\n    // editor.$on('blur', handleBlur);\n    return () => {\n      editor.$off('mousedown', handleMousedown);\n      document.removeEventListener('mouseup', handleMouseup);\n      editor.$off('selectionChange', handleSelectionChange);\n      // editor.$off('blur', handleBlur);\n    };\n  }, [editor]);\n\n  if (isReadOnly) {\n    return null;\n  }\n  return (\n    <>\n      <Popover\n        rePosKey={reposKey}\n        visible={trigger === 'custom' ? visible : internalVisible}\n        trigger=\"custom\"\n        position={position}\n        autoAdjustOverflow\n        className=\"rounded\"\n        content={\n          <ActionBarContext.Provider value={{ controller, size }}>\n            <div className={cls('flex gap-1', className)} ref={containerRef}>\n              {children}\n            </div>\n          </ActionBarContext.Provider>\n        }\n      >\n        <PositionMirror\n          position={popoverPosition}\n          onChange={() => setReposKey(String(Math.random()))}\n        />\n      </Popover>\n      <ThemeExtension\n        themes={[\n          EditorView.theme({\n            '.cm-selectionBackground': {\n              backgroundColor: 'rgba(148, 152, 247, 0.44)',\n            },\n          }),\n        ]}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cls from 'classnames';\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInputSlot } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\nimport { type ButtonProps } from '@coze-arch/coze-design';\n\nimport { insertInputSlot } from '../../input-slot/action/insert-input-slot-action';\nimport {\n  useSelectionInInputSlot,\n  useSelectionInJinjaRaw,\n} from '../../input-slot';\nimport { useActionBarPreference } from '../../action-bar/hooks/use-action-bar-perference';\n\ntype InsertInputSlotProps = Pick<ButtonProps, 'className'>;\n\nexport const InsertInputSlotAction: React.FC<InsertInputSlotProps> = props => {\n  const editor = useEditor<EditorAPI>();\n  const { className } = props;\n  const { controller, size } = useActionBarPreference();\n  const inInputSlot = useSelectionInInputSlot();\n  const inJinjaRaw = useSelectionInJinjaRaw();\n\n  if (inInputSlot || inJinjaRaw) {\n    return null;\n  }\n\n  return (\n    <div\n      className={cls(\n        'hover:coz-mg-secondary-hovered coz-icon-button rounded-little',\n      )}\n    >\n      <Tooltip\n        content={I18n.t('edit_block_set_as_edit_block')}\n        position=\"bottom\"\n      >\n        <IconButton\n          color=\"primary\"\n          icon={<IconCozInputSlot />}\n          className={cls('!bg-transparent', className)}\n          size={size}\n          onMouseDown={e => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n          onClick={e => {\n            e.preventDefault();\n            e.stopPropagation();\n            controller?.hideActionBar();\n            if (!editor) {\n              return;\n            }\n            insertInputSlot(editor);\n          }}\n        />\n      </Tooltip>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ExpressionEditorEvent {\n  Change = 'change',\n  Select = 'select',\n  Dispose = 'dispose',\n  CompositionStart = 'compositionStart',\n}\n\nexport enum ExpressionEditorToken {\n  Start = '{',\n  End = '}',\n  FullStart = '{{',\n  FullEnd = '}}',\n  Separator = '.',\n  ArrayStart = '[',\n  ArrayEnd = ']',\n}\n\nexport enum ExpressionEditorSegmentType {\n  ObjectKey = 'object_key',\n  ArrayIndex = 'array_index',\n  EndEmpty = 'end_empty',\n}\n\nexport enum ExpressionEditorSignal {\n  Line = 'paragraph',\n  Valid = 'valid',\n  Invalid = 'invalid',\n  SelectedValid = 'selectedValid',\n  SelectedInvalid = 'selectedInvalid',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// modified from @coze-workflow/nodes\n\n/* eslint-disable @typescript-eslint/naming-convention */\n/**\n * Front-end variable type\n */\nexport enum ViewVariableType {\n  String = 1,\n  Integer,\n  Boolean,\n  Number,\n  Object = 6,\n  Image,\n  File,\n  Doc,\n  Code,\n  Ppt,\n  Txt,\n  Excel,\n  Audio,\n  Zip,\n  Video,\n  Svg,\n  Voice,\n  Time,\n  // The above is the InputType defined in the api. The following is the integrated one. Start from 99 to avoid collisions with the backend definition.\n  ArrayString = 99,\n  ArrayInteger,\n  ArrayBoolean,\n  ArrayNumber,\n  ArrayObject,\n  ArrayImage,\n  ArrayFile,\n  ArrayDoc,\n  ArrayCode,\n  ArrayPpt,\n  ArrayTxt,\n  ArrayExcel,\n  ArrayAudio,\n  ArrayZip,\n  ArrayVideo,\n  ArraySvg,\n  ArrayVoice,\n  ArrayTime,\n}\n\nconst BASE_ARRAY_PAIR: [ViewVariableType, ViewVariableType][] = [\n  [ViewVariableType.String, ViewVariableType.ArrayString],\n  [ViewVariableType.Integer, ViewVariableType.ArrayInteger],\n  [ViewVariableType.Boolean, ViewVariableType.ArrayBoolean],\n  [ViewVariableType.Number, ViewVariableType.ArrayNumber],\n  [ViewVariableType.Object, ViewVariableType.ArrayObject],\n  [ViewVariableType.Image, ViewVariableType.ArrayImage],\n  [ViewVariableType.File, ViewVariableType.ArrayFile],\n  [ViewVariableType.Doc, ViewVariableType.ArrayDoc],\n  [ViewVariableType.Code, ViewVariableType.ArrayCode],\n  [ViewVariableType.Ppt, ViewVariableType.ArrayPpt],\n  [ViewVariableType.Txt, ViewVariableType.ArrayTxt],\n  [ViewVariableType.Excel, ViewVariableType.ArrayExcel],\n  [ViewVariableType.Audio, ViewVariableType.ArrayAudio],\n  [ViewVariableType.Zip, ViewVariableType.ArrayZip],\n  [ViewVariableType.Video, ViewVariableType.ArrayVideo],\n  [ViewVariableType.Svg, ViewVariableType.ArraySvg],\n  [ViewVariableType.Voice, ViewVariableType.ArrayVoice],\n  [ViewVariableType.Time, ViewVariableType.ArrayTime],\n];\n\nconst ArrayTypes = BASE_ARRAY_PAIR.map(_pair => _pair[1]);\n\nexport function isArrayType(type: ViewVariableType): boolean {\n  return ArrayTypes.includes(type);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-magic-numbers */\n\nimport type {\n  ExpressionEditorTreeNode,\n  ExpressionEditorSegment,\n  Variable,\n} from '../type';\nimport { ExpressionEditorSegmentType } from '../constant';\nimport { ViewVariableType, isArrayType } from '../../variable-types';\n\nexport namespace ExpressionEditorTreeHelper {\n  export interface AvailableVariable {\n    name: string;\n    keyPath?: string[];\n    variable?: Variable;\n  }\n\n  export const pruning = (params: {\n    tree: ExpressionEditorTreeNode[];\n    segments: ExpressionEditorSegment[];\n  }): ExpressionEditorTreeNode[] => {\n    const { tree, segments } = params;\n    if (segments.length === 0) {\n      return tree;\n    }\n    const lastSegment = segments[segments.length - 1];\n    const segmentsRemovedLast =\n      lastSegment.type === ExpressionEditorSegmentType.ArrayIndex\n        ? segments.slice(0, segments.length - 2) // The array index belongs to the previous level, and two layers need to be removed.\n        : segments.slice(0, segments.length - 1);\n    let treeLayer = tree;\n    segmentsRemovedLast.forEach(segment => {\n      if (segment.type !== ExpressionEditorSegmentType.ObjectKey) {\n        return;\n      }\n      const treeChildren = treeLayer.filter(\n        node => node.label === segment.objectKey,\n      );\n      // Compatible variable names are duplicated, but the subfields are different\n      if (treeChildren?.length) {\n        treeLayer = treeChildren.reduce(\n          (pre: ExpressionEditorTreeNode[], cur: ExpressionEditorTreeNode) => {\n            if (cur.children?.length) {\n              return [...pre, ...cur.children];\n            }\n            return pre;\n          },\n          [],\n        );\n      } else {\n        treeLayer = [];\n      }\n    });\n    return treeLayer;\n  };\n\n  export const concatFullPath = (params: {\n    node: ExpressionEditorTreeNode;\n    segments: ExpressionEditorSegment[];\n  }): string => {\n    const { node, segments } = params;\n    let current: ExpressionEditorTreeNode | undefined = node;\n    const pathList: { objectKey: string; arrayIndex?: number }[] = [];\n    while (current) {\n      if (current.variable?.type === ViewVariableType.ArrayObject) {\n        // Default 0th\n        pathList.unshift({\n          objectKey: current.label,\n          arrayIndex: 0,\n        });\n      } else {\n        pathList.unshift({\n          objectKey: current.label,\n        });\n      }\n      current = current.parent;\n    }\n    let pathIndex = 0;\n    segments.find((segment, index) => {\n      if (segment.type !== ExpressionEditorSegmentType.ObjectKey) {\n        return false;\n      }\n      const pathItem = pathList[pathIndex];\n      pathIndex++;\n      if (pathItem.objectKey !== segment.objectKey) {\n        // exit the loop\n        return true;\n      }\n      const nextSegment = segments[index + 1];\n      if (\n        typeof pathItem.arrayIndex === 'number' &&\n        nextSegment?.type === ExpressionEditorSegmentType.ArrayIndex\n      ) {\n        pathItem.arrayIndex = nextSegment.arrayIndex;\n      }\n      return false;\n    });\n    return pathList\n      .map((pathItem, index) => {\n        const isLastPathItem = index === pathList.length - 1;\n        if (typeof pathItem.arrayIndex === 'number' && !isLastPathItem) {\n          return `${pathItem.objectKey}[${pathItem.arrayIndex}]`;\n        }\n        return pathItem.objectKey;\n      })\n      .join('.');\n  };\n\n  export const matchTreeBranch = (params: {\n    tree: ExpressionEditorTreeNode[];\n    segments: ExpressionEditorSegment[];\n  }): ExpressionEditorTreeNode[] | undefined => {\n    const { tree, segments } = params;\n    const treeBranch: (ExpressionEditorTreeNode | null)[] = [];\n    let treeLayer = tree;\n    const invalid = segments.find((segment, index) => {\n      const itemInvalid = (): boolean => {\n        treeBranch.push(null);\n        return true;\n      };\n      const itemValid = (treeNode?: ExpressionEditorTreeNode): boolean => {\n        treeBranch.push(treeNode || null);\n        return false;\n      };\n      const beforeTreeNode = treeBranch[treeBranch.length - 1];\n      // Verify Illegal Case: Whether to Use Array Indexing for Non-Array Types\n      if (\n        segment.type === ExpressionEditorSegmentType.ArrayIndex &&\n        beforeTreeNode &&\n        (!beforeTreeNode.variable || !isArrayType(beforeTreeNode.variable.type))\n      ) {\n        return itemInvalid();\n      }\n      // Confirm illegal condition: Array can only follow array subscript\n      if (\n        beforeTreeNode?.variable?.type &&\n        isArrayType(beforeTreeNode.variable.type) &&\n        segment.type !== ExpressionEditorSegmentType.ArrayIndex\n      ) {\n        return itemInvalid();\n      }\n      // ignore\n      if (segment.type !== ExpressionEditorSegmentType.ObjectKey) {\n        return itemValid();\n      }\n      const treeNode = treeLayer.find(node => node.label === segment.objectKey);\n      // Verify illegal condition: each object key must correspond to a variable node\n      if (!treeNode) {\n        return itemInvalid();\n      }\n      treeLayer = treeNode.children || [];\n      return itemValid(treeNode);\n    });\n    const filteredTreeBranch = treeBranch.filter(\n      Boolean,\n    ) as ExpressionEditorTreeNode[];\n    const filteredSegments = segments.filter(\n      segment => segment.type === ExpressionEditorSegmentType.ObjectKey,\n    );\n    if (invalid || filteredSegments.length !== filteredTreeBranch.length) {\n      return;\n    }\n    return filteredTreeBranch;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\n\nimport type {\n  ExpressionEditorParseData,\n  ExpressionEditorSegment,\n} from '../type';\nimport {\n  ExpressionEditorSegmentType,\n  ExpressionEditorToken,\n} from '../constant';\n\nexport namespace ExpressionEditorParserBuiltin {\n  /** Calculate the serial number of the start and end tags */\n  export const tokenOffset = (line: {\n    lineContent: string;\n    lineOffset: number;\n  }):\n    | {\n        lastStartTokenOffset: number;\n        firstEndTokenOffset: number;\n      }\n    | undefined => {\n    const { lineContent: content, lineOffset: offset } = line;\n\n    const firstEndTokenOffset = content.indexOf(\n      ExpressionEditorToken.End,\n      offset,\n    );\n\n    const endChars = content.slice(\n      firstEndTokenOffset,\n      // eslint-disable-next-line no-magic-numbers\n      firstEndTokenOffset + 2,\n    );\n    if (endChars !== ExpressionEditorToken.FullEnd) {\n      // End symbol \"}}\" is incomplete\n      return;\n    }\n    const lastStartTokenOffset = content.lastIndexOf(\n      ExpressionEditorToken.Start,\n      offset - 1,\n    );\n    const startChars = content.slice(\n      lastStartTokenOffset - 1,\n      lastStartTokenOffset + 1,\n    );\n    if (startChars !== ExpressionEditorToken.FullStart) {\n      // The opening symbol \"{{\" is incomplete\n      return;\n    }\n    return {\n      lastStartTokenOffset,\n      firstEndTokenOffset,\n    };\n  };\n\n  /** Extract content from line content */\n  export const extractContent = (params: {\n    lineContent: string;\n    lineOffset: number;\n    lastStartTokenOffset: number;\n    firstEndTokenOffset: number;\n  }):\n    | {\n        content: string;\n        offset: number;\n      }\n    | undefined => {\n    const {\n      lineContent,\n      lineOffset,\n      lastStartTokenOffset,\n      firstEndTokenOffset,\n    } = params;\n    const content = lineContent.slice(\n      lastStartTokenOffset + 1,\n      firstEndTokenOffset,\n    );\n    const offset = lineOffset - lastStartTokenOffset - 1;\n    return {\n      content,\n      offset,\n    };\n  };\n\n  /** Split text content into available and unavailable by offset */\n  export const sliceReachable = (params: {\n    content: string;\n    offset: number;\n  }): {\n    reachable: string;\n    unreachable: string;\n  } => {\n    const { content, offset } = params;\n    const reachable = content.slice(0, offset);\n    const unreachable = content.slice(offset, content.length);\n    return {\n      reachable,\n      unreachable,\n    };\n  };\n\n  /** Split text */\n  export const splitText = (pathString: string): string[] => {\n    // The obtained split array, initially the result of splitting the original string with \".\"\n    const segments = pathString.split(ExpressionEditorToken.Separator);\n\n    // Define the result array and handle empty strings resulting from consecutive \".\"\n    const result: string[] = [];\n\n    segments.forEach(segment => {\n      if (!segment.match(/\\[\\d+\\]/)) {\n        // If it is not an array index, add the result array directly, even if it is an empty string, to maintain the correct segmentation\n        result.push(segment);\n        return;\n      }\n      // If the current segment is an array index, add the previous string and the current array index to the result array, respectively\n      const lastSegmentIndex = segment.lastIndexOf(\n        ExpressionEditorToken.ArrayStart,\n      );\n      const key = segment.substring(0, lastSegmentIndex);\n      const index = segment.substring(lastSegmentIndex);\n      // Array in {{array [0]}}\n      result.push(key);\n      // [0] in {{array [0]}}\n      result.push(index);\n      return;\n    });\n\n    return result;\n  };\n\n  /** String parsed as path */\n  export const toSegments = (\n    text: string,\n  ): ExpressionEditorSegment[] | undefined => {\n    const textSegments = ExpressionEditorParserBuiltin.splitText(text);\n    const segments: ExpressionEditorSegment[] = [];\n    const validate = textSegments.every((textSegment, index) => {\n      // array subscript\n      if (\n        textSegment.startsWith(ExpressionEditorToken.ArrayStart) &&\n        textSegment.endsWith(ExpressionEditorToken.ArrayEnd)\n      ) {\n        const arrayIndexString = textSegment.slice(1, -1);\n        const arrayIndex = Number(arrayIndexString);\n        if (arrayIndexString === '' || Number.isNaN(arrayIndex)) {\n          // Index must be a number\n          return false;\n        }\n        const lastSegment = segments[segments.length - 1];\n        if (\n          !lastSegment ||\n          lastSegment.type !== ExpressionEditorSegmentType.ObjectKey\n        ) {\n          // The array index must be after the key\n          return false;\n        }\n        segments.push({\n          type: ExpressionEditorSegmentType.ArrayIndex,\n          index,\n          arrayIndex,\n        });\n      }\n      // The last empty line of text\n      else if (index === textSegments.length - 1 && textSegment === '') {\n        segments.push({\n          type: ExpressionEditorSegmentType.EndEmpty,\n          index,\n        });\n      } else {\n        if (!textSegment || !/^[\\u4e00-\\u9fa5_a-zA-Z0-9]*$/.test(textSegment)) {\n          return false;\n        }\n        segments.push({\n          type: ExpressionEditorSegmentType.ObjectKey,\n          index,\n          objectKey: textSegment,\n        });\n      }\n      return true;\n    });\n    if (!validate) {\n      return undefined;\n    }\n    return segments;\n  };\n}\n\nexport namespace ExpressionEditorParser {\n  export const parse = (line: {\n    lineContent: string;\n    lineOffset: number;\n  }): ExpressionEditorParseData | undefined => {\n    const { lineContent, lineOffset } = line;\n    const tokenOffsets = ExpressionEditorParserBuiltin.tokenOffset(line);\n    if (!tokenOffsets) {\n      return;\n    }\n    const { lastStartTokenOffset, firstEndTokenOffset } = tokenOffsets;\n    const extractedContent = ExpressionEditorParserBuiltin.extractContent({\n      ...line,\n      ...tokenOffsets,\n    });\n    if (!extractedContent) {\n      return;\n    }\n    const { content, offset } = extractedContent;\n    const slicedReachable =\n      ExpressionEditorParserBuiltin.sliceReachable(extractedContent);\n    if (!slicedReachable) {\n      return;\n    }\n    const reachableSegments = ExpressionEditorParserBuiltin.toSegments(\n      slicedReachable.reachable,\n    );\n    const inlineSegments = ExpressionEditorParserBuiltin.toSegments(content);\n    if (!reachableSegments) {\n      return;\n    }\n    return {\n      content: {\n        line: lineContent,\n        inline: content,\n        reachable: slicedReachable.reachable,\n        unreachable: slicedReachable.unreachable,\n      },\n      offset: {\n        line: lineOffset,\n        inline: offset,\n        lastStart: lastStartTokenOffset,\n        firstEnd: firstEndTokenOffset,\n      },\n      segments: {\n        inline: inlineSegments,\n        reachable: reachableSegments,\n      },\n    };\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  type ReactNode,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n  useMemo,\n} from 'react';\n\nimport classNames from 'classnames';\nimport {\n  CursorMirror,\n  useEditor,\n  SelectionSide,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type TreeNodeData } from '@coze-arch/bot-semi/Tree';\nimport { type PopoverProps } from '@coze-arch/bot-semi/Popover';\nimport { Popover as SemiPopover, Tree } from '@coze-arch/bot-semi';\n\nimport { generateUniqueId, useDeepEqualMemo, useLatest } from '../shared';\nimport { type ExpressionEditorTreeNode } from '../core';\nimport { applyNode, getOptionInfoFromDOM, selectNodeByIndex } from './shared';\nimport {\n  useEmptyContent,\n  useFilteredVariableTree,\n  useFocused,\n  useInterpolationContent,\n  useCharacterTriggerContext,\n  useDrillVariableTree,\n  useSelection,\n  useTreeRefresh,\n  useTreeSearch,\n  useKeyboard,\n  useOptionsOperations,\n  useSelectedValue,\n} from './hooks';\n\nimport styles from './popover.module.less';\n\ninterface Props {\n  getPopupContainer?: PopoverProps['getPopupContainer'];\n  variableTree: ExpressionEditorTreeNode[];\n  className?: string;\n  onVisibilityChange?: (visible: boolean) => void;\n  customApplyNode?: (\n    data: TreeNodeData,\n    context: {\n      from: number;\n      to: number;\n    },\n    editor: ExpressionEditorAPI,\n  ) => void;\n  disableUpdateTrigger?: boolean;\n  disabled?: boolean;\n  customInterpolationRule?: (content?: string, textBefore?: string) => boolean;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nfunction Popover({\n  getPopupContainer,\n  variableTree: vTree,\n  className,\n  onVisibilityChange,\n  customApplyNode,\n  disableUpdateTrigger,\n  disabled = false,\n  customInterpolationRule,\n}: Props) {\n  const variableTree = useDeepEqualMemo(vTree);\n  const treeRef = useRef<Tree | null>(null);\n  const treeContainerRef = useRef<HTMLDivElement | null>(null);\n  const onVisibilityChangeRef = useLatest(onVisibilityChange);\n  const [posKey, setPosKey] = useState('');\n  const editor = useEditor<ExpressionEditorAPI | undefined>();\n  const editorRef = useLatest(editor);\n  const selection = useSelection(editor);\n  const focused = useFocused(editor);\n  const baseInterpolationContent = useInterpolationContent(\n    editor,\n    selection?.anchor,\n  );\n\n  const interpolationContent = useMemo(() => {\n    if (!customInterpolationRule) {\n      return baseInterpolationContent;\n    }\n    if (\n      customInterpolationRule?.(\n        baseInterpolationContent?.text,\n        baseInterpolationContent?.textBefore,\n      )\n    ) {\n      return baseInterpolationContent;\n    }\n    return undefined;\n  }, [baseInterpolationContent, customInterpolationRule]);\n\n  const triggerContext = useCharacterTriggerContext(disableUpdateTrigger);\n\n  const completionContext = interpolationContent ?? triggerContext;\n\n  const drilledVariableTree = useDrillVariableTree(\n    editor,\n    variableTree,\n    completionContext,\n  );\n  const filteredVariableTree = useFilteredVariableTree(\n    completionContext,\n    drilledVariableTree,\n  );\n  const emptyContent = useEmptyContent(\n    variableTree,\n    drilledVariableTree,\n    completionContext,\n  );\n  const treeRefreshKey = useTreeRefresh(filteredVariableTree);\n  useTreeSearch(treeRefreshKey, treeRef, completionContext, () => {\n    const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n    if (!optionsInfo) {\n      return;\n    }\n    const { elements } = optionsInfo;\n    selectNodeByIndex(elements, 0);\n  });\n  // Selected is only used to display the blue selection effect for the corresponding item of the Tree component, and has no other purpose.\n  const selected = useSelectedValue(completionContext?.text, variableTree);\n\n  // Replace content in {{}} based on user selection\n  const handleSelect = useCallback(\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    (_: string, __: boolean, node: TreeNodeData) => {\n      if (!editor || !completionContext) {\n        return;\n      }\n\n      if (customApplyNode) {\n        customApplyNode(node, completionContext, editor);\n        return;\n      }\n      applyNode(editor, node as ExpressionEditorTreeNode, completionContext);\n    },\n    [editor, completionContext],\n  );\n\n  const internalVisible =\n    focused &&\n    ((Boolean(completionContext) && filteredVariableTree.length > 0) ||\n      Boolean(emptyContent));\n\n  const [allowVisible, setAllowVisible] = useState(false);\n  // Clear the lock effect when the selection changes\n  useEffect(() => {\n    setAllowVisible(true);\n  }, [selection]);\n\n  const visible = internalVisible && allowVisible && !disabled;\n\n  const { prev, next, apply } = useOptionsOperations(\n    editor,\n    completionContext,\n    treeContainerRef,\n    treeRef,\n  );\n\n  // Press the up and down keys to switch the recommended items, and press Enter to fill in.\n  useKeyboard(visible, {\n    ArrowUp: prev,\n    ArrowDown: next,\n    Enter: apply,\n  });\n\n  // ESC Close\n  useKeyboard(visible, {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Escape() {\n      setAllowVisible(false);\n    },\n  });\n\n  // When the recommendation panel appears, disable the default behavior of ArrowUp/ArrowDown/Enter (the behavior is changed to up and down keys to switch recommendations & enter to insert)\n  useEffect(() => {\n    if (visible === true) {\n      editorRef.current?.disableKeybindings(['ArrowUp', 'ArrowDown', 'Enter']);\n    } else {\n      editorRef.current?.disableKeybindings([]);\n    }\n  }, [visible]);\n\n  useEffect(() => {\n    if (typeof onVisibilityChangeRef.current === 'function') {\n      onVisibilityChangeRef.current(visible);\n    }\n  }, [visible]);\n\n  return (\n    <SemiPopover\n      trigger=\"custom\"\n      visible={visible}\n      keepDOM={true}\n      rePosKey={posKey}\n      getPopupContainer={getPopupContainer}\n      content={\n        <div\n          onMouseDown={e => e.preventDefault()}\n          style={{ display: visible ? 'block' : 'none' }}\n        >\n          <EmptyContent visible={!!emptyContent} content={emptyContent} />\n          <TreeContainer\n            ref={treeContainerRef}\n            visible={!emptyContent}\n            className={className}\n          >\n            <Tree\n              // key={treeRefreshKey}\n              className={styles['expression-editor-suggestion-tree']}\n              showFilteredOnly\n              filterTreeNode\n              onChangeWithObject\n              ref={treeRef}\n              treeData={drilledVariableTree}\n              searchRender={false}\n              value={selected}\n              emptyContent={null}\n              onSelect={handleSelect}\n            />\n          </TreeContainer>\n        </div>\n      }\n    >\n      <CursorMirror\n        side={SelectionSide.Anchor}\n        onChange={() => setPosKey(generateUniqueId())}\n      />\n    </SemiPopover>\n  );\n}\n\ninterface EmptyContentProps {\n  visible: boolean;\n  content?: string;\n}\n\nfunction EmptyContent({ visible, content }: EmptyContentProps) {\n  return (\n    <div\n      className={styles['expression-editor-suggestion-empty']}\n      style={{ display: visible ? 'block' : 'none' }}\n    >\n      <p>{content}</p>\n    </div>\n  );\n}\n\ninterface TreeContainerProps {\n  visible: boolean;\n  className?: string;\n  children?: ReactNode;\n}\n\nconst TreeContainer = forwardRef<HTMLDivElement, TreeContainerProps>(\n  function TreeContainer({ visible, className, children }, ref) {\n    return (\n      <div\n        className={classNames(\n          className,\n          styles['expression-editor-suggestion'],\n        )}\n        style={{ display: visible ? 'block' : 'none' }}\n        ref={ref}\n      >\n        {children}\n      </div>\n    );\n  },\n);\n\nexport { Popover, TreeContainer, EmptyContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useLayoutEffect } from 'react';\n\nimport { useEditor, useInjector } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-expression';\nimport { astDecorator } from '@coze-editor/editor';\nimport { EditorView } from '@codemirror/view';\n\nimport { useDeepEqualMemo, useLatest } from '../shared';\nimport { type ExpressionEditorTreeNode } from '../core';\nimport { validateExpression } from './validate';\n\ninterface Props {\n  variableTree: ExpressionEditorTreeNode[];\n}\n\nfunction Validation({ variableTree }: Props) {\n  const editor = useEditor<EditorAPI>();\n  const editorRef = useLatest(editor);\n  const injector = useInjector();\n  const variableTreeRef = useLatest(variableTree);\n  const changedVariableTree = useDeepEqualMemo(variableTree);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    function handleFocus() {\n      editor.updateWholeDecorations();\n    }\n\n    editor.$on('focus', handleFocus);\n\n    return () => {\n      editor.$off('focus', handleFocus);\n    };\n  }, [editor]);\n\n  useEffect(() => {\n    if (!editorRef.current) {\n      return;\n    }\n\n    editorRef.current.updateWholeDecorations();\n  }, [changedVariableTree]);\n\n  useLayoutEffect(() =>\n    injector.inject([\n      [\n        astDecorator.whole.of((cursor, state) => {\n          if (!variableTreeRef.current) {\n            return;\n          }\n\n          if (\n            cursor.name === 'JinjaExpression' &&\n            // Due to the fault tolerance of the parser\n            // It is possible that the missing right curly brace is also parsed normally as Interpolation\n            // Such as: {{variable\n            cursor.node.firstChild?.name === 'JinjaExpressionStart' &&\n            cursor.node.lastChild?.name === 'JinjaExpressionEnd'\n          ) {\n            const source = state.sliceDoc(\n              cursor.node.firstChild.to,\n              cursor.node.lastChild.from,\n            );\n\n            const isValid = validateExpression(source, variableTreeRef.current);\n\n            if (isValid) {\n              return {\n                type: 'className',\n                className: 'cm-decoration-interpolation-valid',\n              };\n            }\n\n            return {\n              type: 'className',\n              className: 'cm-decoration-interpolation-invalid',\n            };\n          }\n        }),\n        EditorView.theme({\n          '.cm-decoration-interpolation-valid': {\n            color: '#6675D9',\n            caretColor: '#6675D9',\n          },\n          '.cm-decoration-interpolation-invalid': {\n            color: '#060709CC',\n          },\n        }),\n      ],\n    ]),\n  );\n\n  return null;\n}\n\nexport { Validation };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ExpressionEditorParserBuiltin } from '../core/parser';\nimport {\n  ExpressionEditorSegmentType,\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '../core';\n\nfunction validateExpression(source: string, tree: ExpressionEditorTreeNode[]) {\n  const segments = ExpressionEditorParserBuiltin.toSegments(source);\n\n  if (!segments) {\n    return false;\n  }\n\n  if (\n    segments[segments.length - 1].type === ExpressionEditorSegmentType.EndEmpty\n  ) {\n    return false;\n  }\n\n  // 2. segments mix variable tree, match tree branch\n  const treeBranch = ExpressionEditorTreeHelper.matchTreeBranch({\n    tree,\n    segments,\n  });\n  if (!treeBranch) {\n    return false;\n  }\n\n  // 3. if full segments path could match one tree branch, the pattern is valid\n  return true;\n}\n\nexport { validateExpression };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect } from 'react';\n\nimport { useInjector } from '@coze-editor/editor/react';\nimport { astDecorator } from '@coze-editor/editor';\nimport { EditorView } from '@codemirror/view';\n\nfunction HighlightExpressionOnActive() {\n  const injector = useInjector();\n\n  useLayoutEffect(() =>\n    injector.inject([\n      [\n        astDecorator.fromCursor.of((cursor, state) => {\n          const { anchor } = state.selection.main;\n\n          const pos = anchor;\n          if (\n            cursor.name === 'JinjaExpression' &&\n            cursor.node.firstChild?.name === 'JinjaExpressionStart' &&\n            cursor.node.lastChild?.name === 'JinjaExpressionEnd' &&\n            pos >= cursor.node.firstChild.to &&\n            pos <= cursor.node.lastChild.from &&\n            state.sliceDoc(\n              cursor.node.lastChild.from,\n              cursor.node.lastChild.to,\n            ) === '}}'\n          ) {\n            return {\n              type: 'background',\n              className: 'cm-decoration-interpolation-active',\n              from: cursor.node.firstChild.from,\n              to: cursor.node.lastChild.to,\n            };\n          }\n        }),\n        EditorView.theme({\n          '.cm-decoration-interpolation-active': {\n            borderRadius: '2px',\n            backgroundColor:\n              'var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))',\n          },\n        }),\n      ],\n    ]),\n  );\n\n  return null;\n}\n\nexport { HighlightExpressionOnActive };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type EditorView } from '@codemirror/view';\nimport { syntaxTree } from '@codemirror/language';\n\nimport { type CompletionContext } from './types';\n\nfunction getInterpolationContentAtPos(view: EditorView, pos: number) {\n  const tree = syntaxTree(view.state);\n  const cursor = tree.cursorAt(pos);\n\n  do {\n    if (\n      (cursor.node.type.name === 'JinjaExpression' &&\n        cursor.node.firstChild?.name === 'JinjaExpressionStart' &&\n        cursor.node.lastChild?.name === 'JinjaExpressionEnd' &&\n        pos >= cursor.node.firstChild.to &&\n        pos <= cursor.node.lastChild.from &&\n        view.state.sliceDoc(\n          cursor.node.lastChild.from,\n          cursor.node.lastChild.to,\n        ) === '}}') ||\n      (cursor.node.type.name === 'Interpolation' &&\n        cursor.node.firstChild &&\n        cursor.node.lastChild &&\n        pos >= cursor.node.firstChild.to &&\n        pos <= cursor.node.lastChild.from)\n    ) {\n      const text = view.state.sliceDoc(\n        cursor.node.firstChild.to,\n        cursor.node.lastChild.from,\n      );\n      const offset = pos - cursor.node.firstChild.to;\n      return {\n        from: cursor.node.firstChild.to,\n        to: cursor.node.lastChild.from,\n        text,\n        offset,\n        textBefore: text.slice(0, offset),\n      };\n    }\n  } while (cursor.parent());\n}\n\nfunction useInterpolationContent(\n  editor: ExpressionEditorAPI | undefined,\n  pos: number | undefined,\n): CompletionContext | undefined {\n  return useMemo(() => {\n    if (!editor || typeof pos === 'undefined') {\n      return;\n    }\n\n    const view = editor.$view;\n    return getInterpolationContentAtPos(view, pos);\n  }, [editor, pos]);\n}\n\nexport { useInterpolationContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint @coze-arch/max-line-per-function: \"warn\" */\nimport { useLayoutEffect, useState } from 'react';\n\nimport { useInjector, useLatest } from '@coze-editor/editor/react';\nimport { ViewPlugin, type ViewUpdate } from '@codemirror/view';\nimport { EditorSelection, type EditorState } from '@codemirror/state';\nimport { syntaxTree } from '@codemirror/language';\n\nimport {\n  type ComposeTransaction,\n  isSkipSelectionChangeUserEvent,\n} from '../shared';\nimport { type CompletionContext } from './types';\n\ninterface TriggerContext extends CompletionContext {\n  validate: (state: EditorState) => boolean;\n  composeTransaction?: ComposeTransaction;\n}\n\nfunction useCharacterTriggerContext(disableUpdateTrigger?: boolean) {\n  const [triggerContext, setTriggerContext] = useState<\n    TriggerContext | undefined\n  >();\n  const setTriggerContextRef = useLatest(setTriggerContext);\n  const injector = useInjector();\n\n  useLayoutEffect(() => {\n    function getNodeAtCursor(state: EditorState) {\n      const pos = state.selection.main.from;\n      const tree = syntaxTree(state);\n      const node = tree.resolve(pos);\n      return node;\n    }\n\n    return injector.inject([\n      ViewPlugin.fromClass(\n        class {\n          triggerContext: TriggerContext | undefined = undefined;\n\n          update(update: ViewUpdate) {\n            let triggerCharacter:\n              | { content: string; from: number; to: number }\n              | undefined;\n\n            if (!disableUpdateTrigger && update.docChanged) {\n              // eslint-disable-next-line max-params\n              update.changes.iterChanges((fromA, toA, fromB, toB, inserted) => {\n                const insertString = inserted.toString();\n                if (\n                  fromA === toA &&\n                  (insertString === '{' || insertString === '{}')\n                ) {\n                  triggerCharacter = {\n                    from: fromB,\n                    to: toB,\n                    content: insertString,\n                  };\n                }\n              });\n            }\n\n            // when user input { or {}, show all available variables\n            if (triggerCharacter) {\n              const node = getNodeAtCursor(update.state);\n\n              // for case like {{<cursor>content, shall show variables\n              if (\n                node &&\n                node.name === 'JinjaExpression' &&\n                node.lastChild?.name === 'JinjaExpressionEnd' &&\n                node.lastChild.to - node.lastChild.from === 2\n              ) {\n                // {<cursor>} -> {{<cursor>}}\n                // skip here, handover to use-interpolation-content\n                this.triggerContext = undefined;\n              } else {\n                // <cursor>content -> {<cursor>content\n                // <cursor> -> {<cursor>}\n                const from = triggerCharacter.from + 1;\n                const { to } = update.state.selection.main;\n                this.triggerContext = {\n                  from,\n                  to,\n                  offset: 0,\n                  text: '',\n                  textBefore: '',\n                  validate(state) {\n                    if (!triggerCharacter) {\n                      return true;\n                    }\n\n                    // check { still exists\n                    if (\n                      state.sliceDoc(\n                        triggerCharacter.from,\n                        triggerCharacter.from + 1,\n                      ) !== '{'\n                    ) {\n                      return false;\n                    }\n\n                    // check character after cursor is still }\n                    // edge caseuser may press Delete, cause the } disappears\n                    if (\n                      triggerCharacter.content === '{}' &&\n                      state.sliceDoc(\n                        state.selection.main.to,\n                        state.selection.main.to + 1,\n                      ) !== '}'\n                    ) {\n                      return false;\n                    }\n\n                    return true;\n                  },\n                  composeTransaction: (tr, state) => {\n                    if (!triggerCharacter) {\n                      return [];\n                    }\n\n                    // already exists { before {, we shall reuse it\n                    const characterBefore = state.sliceDoc(\n                      Math.max(0, triggerCharacter.from - 1),\n                      triggerCharacter.from,\n                    );\n                    const hasExtraLeftBrace = characterBefore === '{';\n\n                    if (triggerCharacter.content.length === 1) {\n                      return [\n                        {\n                          changes: [\n                            {\n                              from: tr.changes.from,\n                              to: tr.changes.to,\n                              insert: `${hasExtraLeftBrace ? '' : '{'}${\n                                tr.changes.insert\n                              }}}`,\n                            },\n                          ],\n                          selection: EditorSelection.cursor(\n                            tr.cursorPosition + (hasExtraLeftBrace ? 0 : 1),\n                          ),\n                          userEvent: tr.userEvent,\n                          scrollIntoView: true,\n                        },\n                      ];\n                    }\n\n                    return [\n                      {\n                        changes: [\n                          {\n                            from: tr.changes.from,\n                            to: tr.changes.to,\n                            insert: `{${tr.changes.insert}}`,\n                          },\n                        ],\n                        selection: EditorSelection.cursor(\n                          tr.cursorPosition + 1,\n                        ),\n                        userEvent: tr.userEvent,\n                        scrollIntoView: true,\n                      },\n                    ];\n                  },\n                };\n              }\n            } else if (\n              update.transactions.some(tr => tr.isUserEvent('select'))\n            ) {\n              this.triggerContext = undefined;\n            } else if (\n              update.transactions.some(tr => isSkipSelectionChangeUserEvent(tr))\n            ) {\n              this.triggerContext = undefined;\n            } else if (this.triggerContext && update.docChanged) {\n              if (!this.triggerContext.validate(update.state)) {\n                this.triggerContext = undefined;\n              } else {\n                const { from } = this.triggerContext;\n                const { to } = update.state.selection.main;\n                const text = update.state.sliceDoc(from, to);\n                this.triggerContext = {\n                  ...this.triggerContext,\n                  from,\n                  to,\n                  offset: from - to,\n                  text,\n                  textBefore: text,\n                };\n              }\n            }\n\n            setTriggerContextRef.current(this.triggerContext);\n          }\n        },\n      ),\n    ]);\n  }, [injector]);\n\n  return triggerContext;\n}\n\nexport { useCharacterTriggerContext };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ExpressionEditorParserBuiltin } from '../../core/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '../../core';\nimport { type CompletionContext } from './types';\n\nfunction isEmpty(value: unknown) {\n  return !value || !Array.isArray(value) || value.length === 0;\n}\n\nfunction useEmptyContent(\n  fullVariableTree: ExpressionEditorTreeNode[] | undefined,\n  variableTree: ExpressionEditorTreeNode[] | undefined,\n  context: CompletionContext | undefined,\n) {\n  return useMemo(() => {\n    if (!context) {\n      return;\n    }\n\n    if (isEmpty(fullVariableTree)) {\n      if (context.textBefore === '') {\n        return I18n.t('workflow_variable_refer_no_input');\n      }\n      return;\n    }\n\n    if (isEmpty(variableTree)) {\n      if (context.text === '') {\n        return I18n.t('workflow_variable_refer_no_input');\n      }\n\n      const segments = ExpressionEditorParserBuiltin.toSegments(\n        context.textBefore,\n      );\n\n      if (!segments) {\n        return;\n      }\n\n      const matchTreeBranch = ExpressionEditorTreeHelper.matchTreeBranch({\n        tree: fullVariableTree ?? [],\n        segments,\n      });\n      const isMatchedButEmpty = matchTreeBranch && matchTreeBranch.length !== 0;\n\n      if (isMatchedButEmpty) {\n        return I18n.t('workflow_variable_refer_no_sub_variable');\n      }\n\n      return;\n    }\n    return;\n  }, [fullVariableTree, variableTree, context]);\n}\n\nexport { useEmptyContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\n\nimport { ExpressionEditorParserBuiltin } from '../../core/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '../../core';\nimport { type CompletionContext } from './types';\n\nfunction useDrillVariableTree(\n  editor: ExpressionEditorAPI | undefined,\n  variableTree: ExpressionEditorTreeNode[],\n  context: CompletionContext | undefined,\n): ExpressionEditorTreeNode[] {\n  return useMemo(() => {\n    if (!editor || !context) {\n      return [];\n    }\n\n    const segments = ExpressionEditorParserBuiltin.toSegments(\n      context.textBefore,\n    );\n\n    if (!segments) {\n      return [];\n    }\n\n    const prunedVariableTree = ExpressionEditorTreeHelper.pruning({\n      tree: variableTree,\n      segments,\n    });\n\n    return prunedVariableTree;\n  }, [editor, variableTree, context]);\n}\n\nexport { useDrillVariableTree };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { getSearchValue } from '../../shared';\nimport { type ExpressionEditorTreeNode } from '../../core';\nimport { type CompletionContext } from './types';\n\nfunction useFilteredVariableTree(\n  context: CompletionContext | undefined,\n  drilledVariableTree: ExpressionEditorTreeNode[],\n) {\n  return useMemo(() => {\n    if (!drilledVariableTree) {\n      return [];\n    }\n\n    if (!context) {\n      return drilledVariableTree;\n    }\n\n    const searchValue = getSearchValue(context.textBefore);\n\n    return drilledVariableTree.filter(variable =>\n      variable.label.startsWith(searchValue),\n    );\n  }, [context, drilledVariableTree]);\n}\n\nexport { useFilteredVariableTree };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-expression';\n\nfunction useFocused(editor: EditorAPI | undefined) {\n  const [focused, setFocused] = useState(false);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    function handleFocus() {\n      setFocused(true);\n    }\n\n    function handleBlur() {\n      setFocused(false);\n    }\n\n    editor.$on('focus', handleFocus);\n    editor.$on('blur', handleBlur);\n\n    return () => {\n      editor.$off('focus', handleFocus);\n      editor.$off('blur', handleBlur);\n    };\n  }, [editor]);\n\n  return focused;\n}\n\nexport { useFocused };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, type MutableRefObject } from 'react';\n\nimport { type Tree } from '@coze-arch/bot-semi';\n\nimport { generateUniqueId, getSearchValue, useLatest } from '../../shared';\nimport { type ExpressionEditorTreeNode } from '../../core';\nimport { type CompletionContext } from './types';\n\n// Force the Tree component to re-render after the data update\nfunction useTreeRefresh(filteredVariableTree: ExpressionEditorTreeNode[]) {\n  const [treeRefreshKey, setTreeRefreshKey] = useState('');\n\n  useEffect(() => {\n    setTreeRefreshKey(generateUniqueId());\n  }, [filteredVariableTree]);\n\n  return treeRefreshKey;\n}\n\n// Search after the Tree component is re-rendered\n// eslint-disable-next-line max-params\nfunction useTreeSearch(\n  treeRefreshKey: string,\n  treeRef: MutableRefObject<Tree | null>,\n  context: CompletionContext | undefined,\n  callback: () => void,\n) {\n  const contextRef = useLatest(context);\n\n  useEffect(() => {\n    if (treeRef.current && contextRef.current) {\n      const searchValue = getSearchValue(contextRef.current.textBefore);\n      treeRef.current.search(searchValue);\n      callback();\n    }\n  }, [treeRefreshKey, context]);\n}\n\nexport { useTreeRefresh, useTreeSearch };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useLatest } from '../../shared';\n\ntype Keymap = Record<string, (e: KeyboardEvent) => void>;\n\nfunction useKeyboard(enable: boolean, keymap: Keymap) {\n  const keymapRef = useLatest(keymap);\n\n  useEffect(() => {\n    if (!enable) {\n      return;\n    }\n\n    function handleKeydown(e: KeyboardEvent) {\n      const callback = keymapRef.current[e.key];\n      if (typeof callback === 'function') {\n        callback(e);\n      }\n    }\n\n    document.addEventListener('keydown', handleKeydown, false);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeydown, false);\n    };\n  }, [enable, keymapRef]);\n}\n\nexport { useKeyboard };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type ViewUpdate } from '@codemirror/view';\n\nimport { isSkipSelectionChangeUserEvent } from '../shared';\nimport { useLatest } from '../../shared';\n\ninterface Selection {\n  anchor: number;\n  head: number;\n  from: number;\n  to: number;\n}\n\nfunction isSameSelection(a?: Selection, b?: Selection) {\n  if (!a && !b) {\n    return true;\n  }\n\n  return (\n    a &&\n    b &&\n    a.anchor === b.anchor &&\n    a.head === b.head &&\n    a.from === b.from &&\n    a.to === b.to\n  );\n}\n\nfunction useSelection(editor: ExpressionEditorAPI | undefined) {\n  const [selection, setSelection] = useState<Selection | undefined>();\n\n  const selectionRef = useLatest(selection);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    const view = editor.$view;\n\n    function updateSelection(update?: ViewUpdate) {\n      // Ignore the selection change caused by replaceTextByRange (effect: no selection change is triggered, and the recommendation panel is not displayed)\n      if (update?.transactions.some(tr => isSkipSelectionChangeUserEvent(tr))) {\n        setSelection(undefined);\n        return;\n      }\n\n      const { from, to, anchor, head } = view.state.selection.main;\n      const newSelection = { from, to, anchor, head };\n      if (isSameSelection(newSelection, selectionRef.current)) {\n        return;\n      }\n\n      setSelection({ from, to, anchor, head });\n    }\n\n    function handleSelectionChange(e: { update: ViewUpdate }) {\n      updateSelection(e.update);\n    }\n\n    function handleFocus() {\n      updateSelection();\n    }\n\n    editor.$on('selectionChange', handleSelectionChange);\n    editor.$on('focus', handleFocus);\n\n    return () => {\n      editor.$off('selectionChange', handleSelectionChange);\n      editor.$off('focus', handleFocus);\n    };\n  }, [editor]);\n\n  return selection;\n}\n\nexport { useSelection };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type Tree } from '@coze-arch/bot-semi';\n\nimport { applyNode, getOptionInfoFromDOM, selectNodeByIndex } from '../shared';\nimport { useLatest } from '../../shared';\nimport { type ExpressionEditorTreeNode } from '../../core';\nimport { type CompletionContext } from './types';\n\n// eslint-disable-next-line max-params\nfunction useOptionsOperations(\n  editor: ExpressionEditorAPI | undefined,\n  context: CompletionContext | undefined,\n  treeContainerRef: React.MutableRefObject<HTMLDivElement | null>,\n  treeRef: React.MutableRefObject<Tree | null>,\n) {\n  const editorRef = useLatest(editor);\n  const contextRef = useLatest(context);\n\n  return useMemo(() => {\n    function prev() {\n      const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { elements, selectedIndex } = optionsInfo;\n\n      if (elements.length === 1) {\n        return;\n      }\n\n      const newIndex =\n        selectedIndex - 1 < 0 ? elements.length - 1 : selectedIndex - 1;\n      selectNodeByIndex(elements, newIndex);\n    }\n\n    function next() {\n      const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { elements, selectedIndex } = optionsInfo;\n\n      const newIndex =\n        selectedIndex + 1 >= elements.length ? 0 : selectedIndex + 1;\n      selectNodeByIndex(elements, newIndex);\n    }\n\n    function apply() {\n      if (!contextRef.current) {\n        return;\n      }\n\n      const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { selectedElement } = optionsInfo;\n\n      const selectedDataKey = selectedElement?.getAttribute('data-key');\n\n      if (!selectedDataKey) {\n        return;\n      }\n\n      const variableTreeNode =\n        treeRef.current?.state?.keyEntities?.[selectedDataKey]?.data;\n      if (!variableTreeNode) {\n        return;\n      }\n\n      applyNode(\n        editorRef.current,\n        variableTreeNode as ExpressionEditorTreeNode,\n        contextRef.current,\n      );\n    }\n\n    return {\n      prev,\n      next,\n      apply,\n    };\n  }, []);\n}\n\nexport { useOptionsOperations };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { ExpressionEditorParserBuiltin } from '../../core/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '../../core';\n\nfunction useSelectedValue(\n  interpolationText: string | undefined,\n  variableTree: ExpressionEditorTreeNode[],\n) {\n  return useMemo(() => {\n    if (!interpolationText) {\n      return;\n    }\n\n    const segments =\n      ExpressionEditorParserBuiltin.toSegments(interpolationText);\n\n    if (!segments) {\n      return;\n    }\n\n    const treeBrach = ExpressionEditorTreeHelper.matchTreeBranch({\n      tree: variableTree,\n      segments,\n    });\n\n    if (!treeBrach) {\n      return;\n    }\n\n    return treeBrach[treeBrach.length - 1];\n  }, [interpolationText, variableTree]);\n}\n\nexport { useSelectedValue };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { getFlags } from '@coze-arch/bot-flags';\nimport {\n  EditorSelection,\n  type EditorState,\n  type TransactionSpec,\n  type Transaction,\n} from '@codemirror/state';\n\nimport { ExpressionEditorParserBuiltin } from '../core/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '../core';\n\nimport styles from './popover.module.less';\n\nconst SKIP_SELECTION_CHANGE_USER_EVENT = 'api.skip-selection-change';\nconst SELECTED_OPTION_CLASSNAME =\n  styles['expression-editor-suggestion-keyboard-selected'];\nconst SELECTED_OPTION_CLASSNAME_NEW =\n  styles['expression-editor-suggestion-keyboard-selected-new'];\n\nconst getSelectedClassName = () => {\n  const FLAGS = getFlags();\n  const isHitLLMPromptSkills = FLAGS?.['bot.automation.llm_prompt_skills'];\n  if (isHitLLMPromptSkills) {\n    return SELECTED_OPTION_CLASSNAME_NEW;\n  }\n\n  return SELECTED_OPTION_CLASSNAME;\n};\n\n// modified from:\n// file: packages/workflow/components/src/expression-editor/components/suggestion/hooks.ts\n// method: computeUIOptions\ninterface OptionsInfo {\n  elements: Element[];\n  selectedIndex: number;\n  selectedElement?: Element;\n}\nconst getOptionInfoFromDOM = (\n  root: Element | null,\n): OptionsInfo | undefined => {\n  if (!root) {\n    return;\n  }\n\n  // Get all option elements\n  const foundNodes = root.querySelectorAll(\n    '.semi-tree-option-list .semi-tree-option',\n  );\n\n  if (foundNodes.length === 0) {\n    return;\n  }\n\n  const optionElements = [...foundNodes];\n\n  // Find the currently highlighted option\n  const selectedIndex = optionElements.findIndex(element =>\n    element.classList.contains(getSelectedClassName()),\n  );\n\n  return {\n    elements: optionElements,\n    selectedIndex,\n    selectedElement: optionElements[selectedIndex],\n  };\n};\n\nfunction selectNodeByIndex(elements: Element[], index: number) {\n  const newSelectedElement = elements[index];\n\n  if (!newSelectedElement) {\n    return;\n  }\n\n  // remove old selected class\n  elements.forEach(element => {\n    if (element.classList.contains(getSelectedClassName())) {\n      element.classList.remove(getSelectedClassName());\n    }\n  });\n\n  newSelectedElement.classList.add(getSelectedClassName());\n\n  newSelectedElement.scrollIntoView({\n    behavior: 'smooth',\n    block: 'nearest',\n  });\n}\n\nexport type ComposeTransaction = (\n  tr: {\n    changes: { from: number; to: number; insert: string };\n    cursorPosition: number;\n    userEvent: string;\n  },\n  state: EditorState,\n) => TransactionSpec[];\n\ninterface ApplyNodeOptions {\n  from: number;\n  to: number;\n  textBefore: string;\n  composeTransaction?: ComposeTransaction;\n}\n\nfunction isLeafNode(node: ExpressionEditorTreeNode) {\n  return !node.children || node.children.length === 0;\n}\n\nfunction applyNode(\n  editor: ExpressionEditorAPI | undefined,\n  node: ExpressionEditorTreeNode,\n  options: ApplyNodeOptions,\n) {\n  if (!editor) {\n    return;\n  }\n\n  const { from, to, textBefore, composeTransaction } = options;\n\n  const text = getInsertTextFromNode(node, textBefore);\n\n  if (!text) {\n    return;\n  }\n\n  const cursorOffset = isLeafNode(node) ? '}}'.length : 0;\n  const cursorPosition = from + text.length + cursorOffset;\n  const transaction = {\n    changes: {\n      from,\n      to,\n      insert: text,\n    },\n    selection: EditorSelection.cursor(cursorPosition),\n    userEvent: SKIP_SELECTION_CHANGE_USER_EVENT,\n  };\n\n  let transactions: TransactionSpec[] = [transaction];\n  if (typeof composeTransaction === 'function') {\n    transactions = composeTransaction(\n      {\n        changes: transaction.changes,\n        userEvent: transaction.userEvent,\n        cursorPosition,\n      },\n      editor.$view.state,\n    );\n  }\n\n  editor.$view.dispatch(...transactions);\n}\n\nfunction isSkipSelectionChangeUserEvent(tr: Transaction) {\n  return tr.isUserEvent(SKIP_SELECTION_CHANGE_USER_EVENT);\n}\n\nfunction getInsertTextFromNode(\n  node: ExpressionEditorTreeNode,\n  textBefore: string,\n) {\n  const segments = ExpressionEditorParserBuiltin.toSegments(textBefore) ?? [];\n  return ExpressionEditorTreeHelper.concatFullPath({\n    node,\n    segments,\n  });\n}\n\nexport {\n  getOptionInfoFromDOM,\n  applyNode,\n  selectNodeByIndex,\n  isSkipSelectionChangeUserEvent,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type MutableRefObject,\n  useRef,\n  useState,\n  useLayoutEffect,\n} from 'react';\n\nimport { dequal } from 'dequal';\n\nimport { ExpressionEditorParserBuiltin } from './core/parser';\nimport { ExpressionEditorSegmentType } from './core';\n\nfunction useLatest<T>(value: T): MutableRefObject<T> {\n  const ref = useRef(value);\n  ref.current = value;\n\n  return ref;\n}\n\n// Remove circular dependencies caused by parents (otherwise no deep comparison is possible)\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction cloneWithout(target: any, keys: string[]) {\n  // An error is thrown when target is undefined\n  try {\n    return JSON.parse(\n      JSON.stringify(target, function (key, value) {\n        if (keys.includes(key)) {\n          return null;\n        }\n\n        return value;\n      }),\n    );\n  } catch (e) {\n    return target;\n  }\n}\n\nfunction useDeepEqualMemo<T>(value: T): T {\n  const [state, setState] = useState<T>(value);\n  const lastValueRef = useRef<T>(value);\n\n  useLayoutEffect(() => {\n    if (\n      !dequal(\n        cloneWithout(value, ['parent']),\n        cloneWithout(lastValueRef.current, ['parent']),\n      )\n    ) {\n      setState(value);\n      lastValueRef.current = value;\n    }\n  }, [value]);\n\n  return state;\n}\n\nfunction generateUniqueId(): string {\n  return Math.floor(Math.random() * 2e6).toString(36);\n}\n\nfunction getSearchValue(textBefore: string) {\n  const segments = ExpressionEditorParserBuiltin.toSegments(textBefore);\n\n  if (!segments) {\n    return '';\n  }\n\n  const lastSegment =\n    segments[segments.length - 1].type ===\n    ExpressionEditorSegmentType.ArrayIndex\n      ? segments[segments.length - 2] // The array index belongs to the previous level and needs to be removed to prevent it from affecting the search value\n      : segments[segments.length - 1];\n  if (\n    !lastSegment ||\n    lastSegment.type !== ExpressionEditorSegmentType.ObjectKey\n  ) {\n    return '';\n  }\n  return lastSegment.objectKey;\n}\n\nexport { useLatest, useDeepEqualMemo, getSearchValue, generateUniqueId };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { EditorSelection } from '@codemirror/state';\n\nimport { TemplateParser } from '../../shared/utils/template-parser';\nconst templateParser = new TemplateParser({ mark: 'InputSlot' });\n\nexport const insertInputSlot = (\n  editor: EditorAPI,\n  options?: {\n    mode?: 'input' | 'configurable';\n    placeholder?: string;\n  },\n) => {\n  if (!editor) {\n    return;\n  }\n  const {\n    mode = 'input',\n    placeholder = I18n.t('edit_block_guidance_text_placeholder'),\n  } = options ?? {};\n  const { selection } = editor.$view.state;\n  const selectionRange = editor.$view.state.selection.main;\n  const content = editor.$view.state.sliceDoc(\n    selectionRange.from,\n    selectionRange.to,\n  );\n  const extractedContent = templateParser.extractTemplateContent(content);\n  const { open, template, textContent } = templateParser.generateTemplateJson({\n    content: extractedContent,\n    data: {\n      placeholder,\n      mode,\n    },\n  });\n  const from = selectionRange.from + open.length;\n  const to = from + textContent.length;\n  editor.$view.dispatch({\n    changes: {\n      from: selectionRange.from,\n      to: selectionRange.to,\n      insert: template,\n    },\n  });\n  setTimeout(() => {\n    editor.$view.dispatch({\n      selection: selection.replaceRange(EditorSelection.range(from, to)),\n    });\n  }, 100);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { PositionMirror } from '@coze-editor/editor/react';\nimport { I18n } from '@coze-arch/i18n';\nimport { Popover, Input, type PopoverProps } from '@coze-arch/coze-design';\n\ninterface InputConfigPopoverProps {\n  visible: boolean;\n  onVisibleChange?: (visible: boolean) => void;\n  positon: number;\n  direction?: PopoverProps['position'];\n  placeholder: string;\n  value: string;\n  onPlaceholderChange?: (placeholder: string) => void;\n  onValueChange?: (value: string) => void;\n}\nexport const InputConfigPopover = (props: InputConfigPopoverProps) => {\n  const [reposKey, setReposKey] = useState('');\n  const { direction, placeholder, value } = props;\n\n  return (\n    <>\n      <Popover\n        rePosKey={reposKey}\n        visible={props.visible}\n        trigger=\"custom\"\n        position={direction}\n        autoAdjustOverflow\n        content={\n          <div className=\"flex flex-col gap-2 pt-3 pb-4 px-4 w-[320px]\">\n            <div>\n              <div>{I18n.t('edit_block_guidance_text_when_empty')}</div>\n              <Input\n                value={placeholder}\n                placeholder={I18n.t('edit_block_guidance_text_placeholder')}\n                onChange={v => props.onPlaceholderChange?.(v)}\n                onBlur={() => {\n                  if (!placeholder) {\n                    props.onPlaceholderChange?.(\n                      I18n.t('edit_block_guidance_text_placeholder'),\n                    );\n                  }\n                }}\n              />\n            </div>\n            <div>\n              <div>{I18n.t('edit_block_prefilled_text')}</div>\n              <Input\n                value={value}\n                placeholder={I18n.t('edit_block_default_guidance_text')}\n                onChange={v => props.onValueChange?.(v)}\n              />\n            </div>\n          </div>\n        }\n      >\n        <PositionMirror\n          position={props.positon}\n          onChange={() => setReposKey(String(Math.random()))}\n        />\n      </Popover>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { type ViewUpdate } from '@codemirror/view';\n\nimport { InputConfigPopover } from '../input-config-popover';\nimport { type TemplateParser } from '../../shared/utils/template-parser';\n\nexport const ConfigModeWidgetPopover = (props: {\n  direction: 'bottomLeft' | 'topLeft' | 'bottomRight' | 'topRight';\n  templateParser: TemplateParser;\n}) => {\n  const { direction, templateParser } = props;\n  const editor = useEditor<EditorAPI>();\n  const [placeholder, setPlaceholder] = useState('');\n  const [value, setValue] = useState('');\n  const [configPopoverVisible, setConfigPopoverVisible] = useState(false);\n  const [popoverPosition, setPopoverPosition] = useState(-1);\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    const handleViewUpdate = (e: ViewUpdate) => {\n      if (e.docChanged) {\n        // Determine whether the current cursor is in the slot node\n        const { state } = e;\n        const range = templateParser.getCursorInMarkNodeRange(state);\n        if (!range) {\n          return;\n        }\n        const content = state.sliceDoc(range.open.to, range.close.from);\n        if (content === value) {\n          return;\n        }\n        setValue(content);\n      }\n      if (e.selectionSet) {\n        const { state } = e;\n        const range = templateParser.getCursorInMarkNodeRange(state);\n        if (!range) {\n          setPopoverPosition(-1);\n          setConfigPopoverVisible(false);\n          return;\n        }\n        const content = templateParser.getCursorTemplateContent(editor);\n        const { placeholder: configPlaceholder } =\n          templateParser.getCursorTemplateData(state) ?? {};\n        setPlaceholder(configPlaceholder);\n        setValue(content ?? '');\n        setPopoverPosition(range.open.from);\n        setConfigPopoverVisible(true);\n      }\n    };\n    editor.$on('viewUpdate', handleViewUpdate);\n\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor, value]);\n\n  const handlePlaceholderChange = (configPlaceholder: string) => {\n    if (!editor || !configPopoverVisible) {\n      return;\n    }\n    setPlaceholder(configPlaceholder);\n    templateParser.updateCursorTemplateData(editor, {\n      placeholder: configPlaceholder,\n    });\n  };\n  const handleValueChange = (configValue: string) => {\n    if (!editor || !configPopoverVisible) {\n      return;\n    }\n    setValue(configValue);\n    templateParser.updateCursorTemplateContent(editor, configValue);\n  };\n\n  return (\n    <InputConfigPopover\n      visible={configPopoverVisible}\n      positon={popoverPosition}\n      direction={direction}\n      placeholder={placeholder}\n      value={value}\n      onPlaceholderChange={handlePlaceholderChange}\n      onValueChange={handleValueChange}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ConfigModeWidgetPopover } from './config-mode-popover';\n\nimport './index.css';\nimport { useEffect, useLayoutEffect } from 'react';\n\nimport { useEditor, useInjector } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport {\n  astDecorator,\n  SpanWidget,\n  autoSelectRanges,\n  selectionEnlarger,\n  deletionEnlarger,\n} from '@coze-editor/editor';\nimport { type ViewUpdate } from '@codemirror/view';\n\nimport {\n  type MarkRangeInfo,\n  TemplateParser,\n} from '../../shared/utils/template-parser';\nimport { useReadonly } from '../../shared/hooks/use-editor-readonly';\ninterface InputSlotWidgetProps {\n  mode?: 'input' | 'configurable';\n  onSelectionInInputSlot?: (selection: MarkRangeInfo | undefined) => void;\n}\n\nconst templateParser = new TemplateParser({ mark: 'InputSlot' });\n\nexport const InputSlotWidget = (props: InputSlotWidgetProps) => {\n  const { mode, onSelectionInInputSlot } = props;\n  const injector = useInjector();\n  const editor = useEditor<EditorAPI>();\n  const readonly = useReadonly();\n\n  useLayoutEffect(() => {\n    const { markInfoField } = templateParser;\n\n    return injector.inject([\n      astDecorator.whole.of((cursor, state) => {\n        if (templateParser.isOpenNode(cursor.node, state)) {\n          const open = cursor.node;\n          const close = templateParser.findCloseNode(open, state);\n\n          if (close) {\n            const openTemplate = state.sliceDoc(open.from, open.to);\n            const data = templateParser.getData(openTemplate);\n            const from = open.to;\n            const to = close.from;\n\n            if (from === to) {\n              return [\n                {\n                  type: 'replace',\n                  widget: new SpanWidget({\n                    className: 'slot-side-left',\n                  }),\n                  atomicRange: true,\n                  from: open.from,\n                  to: open.to,\n                },\n                {\n                  type: 'widget',\n                  widget: new SpanWidget({\n                    text: data?.placeholder || '',\n                    className: 'slot-placeholder',\n                  }),\n                  from,\n                  atomicRange: true,\n                  side: 1,\n                },\n                {\n                  type: 'replace',\n                  widget: new SpanWidget({\n                    className: 'slot-side-right',\n                  }),\n                  atomicRange: true,\n                  from: close.from,\n                  to: close.to,\n                },\n              ];\n            }\n            return [\n              {\n                type: 'replace',\n                widget: new SpanWidget({\n                  className: 'slot-side-left',\n                }),\n                atomicRange: true,\n                from: open.from,\n                to: open.to,\n              },\n              {\n                type: 'className',\n                className: 'slot-content',\n                from,\n                to,\n              },\n              {\n                type: 'replace',\n                widget: new SpanWidget({ className: 'slot-side-right' }),\n                atomicRange: true,\n                from: close.from,\n                to: close.to,\n              },\n            ];\n          }\n        }\n      }),\n\n      markInfoField,\n\n      autoSelectRanges.of(state => state.field(markInfoField).contents),\n\n      selectionEnlarger.of(state => state.field(markInfoField).specs),\n\n      deletionEnlarger.of(state => state.field(markInfoField).specs),\n    ]);\n  }, [injector]);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    const handleViewUpdate = (update: ViewUpdate) => {\n      if (!update.state.selection.main.empty) {\n        const markRangeInfo = templateParser.getSelectionInMarkNodeRange(\n          update.state.selection.main,\n          update.state,\n        );\n        if (markRangeInfo) {\n          onSelectionInInputSlot?.(markRangeInfo);\n          return;\n        }\n        onSelectionInInputSlot?.(undefined);\n      }\n    };\n    editor.$on('viewUpdate', handleViewUpdate);\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor]);\n\n  if (mode === 'configurable' && !readonly) {\n    return (\n      <ConfigModeWidgetPopover\n        direction=\"bottomLeft\"\n        templateParser={templateParser}\n      />\n    );\n  }\n\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { type ViewUpdate } from '@codemirror/view';\n\nimport { TemplateParser } from '../../shared/utils/template-parser';\n\nconst templateParser = new TemplateParser({ mark: 'InputSlot' });\nexport const useCursorInInputSlot = () => {\n  const editor = useEditor<EditorAPI>();\n  const [inInputSlot, setInInputSlot] = useState(false);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    const handleViewUpdate = (update: ViewUpdate) => {\n      if (update.selectionSet) {\n        const markRangeInfo = templateParser.getSelectionInMarkNodeRange(\n          update.state.selection.main,\n          update.state,\n        );\n        if (markRangeInfo) {\n          setInInputSlot(true);\n          return;\n        }\n        setInInputSlot(false);\n      }\n    };\n    editor.$on('viewUpdate', handleViewUpdate);\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor]);\n\n  return inInputSlot;\n};\n\nexport const useSelectionInInputSlot = () => {\n  const editor = useEditor<EditorAPI>();\n  const [inInputSlot, setInInputSlot] = useState(false);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    const handleViewUpdate = (update: ViewUpdate) => {\n      if (!update.state.selection.main.empty) {\n        const markRangeInfo = templateParser.getSelectionInMarkNodeRange(\n          update.state.selection.main,\n          update.state,\n        );\n        if (markRangeInfo) {\n          setInInputSlot(true);\n          return;\n        }\n        setInInputSlot(false);\n      }\n    };\n    editor.$on('viewUpdate', handleViewUpdate);\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor]);\n  return inInputSlot;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { syntaxTree } from '@codemirror/language';\n\nexport const useSelectionInJinjaRaw = () => {\n  const editor = useEditor<EditorAPI>();\n  const [inJinjaRaw, setInJinjaRaw] = useState(false);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    const checkInJinjaRaw = () => {\n      const selection = editor.getSelection();\n      if (!selection) {\n        setInJinjaRaw(false);\n        return;\n      }\n\n      const { state } = editor.$view;\n      const tree = syntaxTree(state);\n      const cursor = tree.cursor();\n\n      let isInRaw = false;\n      do {\n        if (cursor.name === 'RawText') {\n          const isSelectionWithinNode =\n            cursor.from <= selection.from && cursor.to >= selection.to;\n          if (isSelectionWithinNode) {\n            isInRaw = true;\n            break;\n          }\n        }\n      } while (cursor.next());\n\n      setInJinjaRaw(isInRaw);\n    };\n\n    editor.$on('viewUpdate', checkInJinjaRaw);\n\n    // Initial inspection\n    checkInJinjaRaw();\n\n    return () => {\n      editor.$off('viewUpdate', checkInJinjaRaw);\n    };\n  }, [editor]);\n\n  return inJinjaRaw;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PromptReferenceType,\n  type PromptReferenceInfo,\n} from '@coze-arch/idl/playground_api';\n\nexport type LibraryType =\n  | 'plugin'\n  | 'workflow'\n  | 'imageflow'\n  | 'table'\n  | 'text'\n  | 'image';\n\nexport interface ILibraryItems {\n  type: LibraryType;\n  items: ILibraryItem[];\n}\n\nexport type ILibraryList = ILibraryItems[];\n\nexport type ILibraryItem = PromptReferenceInfo & {\n  type: LibraryType;\n  id: string;\n  icon_url: string;\n  name: string;\n  desc: string;\n};\n\nexport const getReferenceType = (type: LibraryType): PromptReferenceType => {\n  switch (type) {\n    case 'plugin':\n      return PromptReferenceType.Plugin;\n    case 'workflow':\n      return PromptReferenceType.Workflow;\n    case 'imageflow':\n      return PromptReferenceType.ImageFlow;\n    case 'text':\n      return PromptReferenceType.Knowledge;\n    case 'image':\n      return PromptReferenceType.Knowledge;\n    case 'table':\n      return PromptReferenceType.Knowledge;\n    default:\n      return PromptReferenceType.Plugin;\n  }\n};\nexport interface LibraryBlockInfo {\n  [key: string]: string | undefined;\n  icon: string;\n  type: LibraryType;\n  id: string;\n  uuid: string;\n  apiId?: string;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PlaygroundApi } from '@coze-arch/bot-api';\n\nimport {\n  type ILibraryItem,\n  type ILibraryList,\n  type LibraryBlockInfo,\n  getReferenceType,\n  type LibraryType,\n} from '../types';\n\nexport const findTargetLibrary = (\n  librarys: ILibraryList,\n  libraryCheck: LibraryBlockInfo,\n): ILibraryItem | undefined => {\n  const { type: checkType } = libraryCheck;\n  const libraryGroup = librarys.find(\n    ({ type, items }) =>\n      type === checkType &&\n      items.some(item => checkLibraryId(item, libraryCheck)),\n  );\n\n  const targetItem = libraryGroup?.items.find(item =>\n    checkLibraryId(item, libraryCheck),\n  );\n  if (!targetItem) {\n    return undefined;\n  }\n\n  return {\n    ...targetItem,\n    type: checkType,\n  };\n};\n\nexport const checkLibraryId = (\n  library: ILibraryItem,\n  libraryCheck: LibraryBlockInfo,\n) => {\n  const { apiId: checkApiId, id: checkId } = libraryCheck;\n  if (checkApiId) {\n    return library.api_id === checkApiId;\n  }\n  return library.id === checkId;\n};\n\nexport const isLibraryNameOutDate = (\n  content: string,\n  latestLibrary: ILibraryItem,\n): boolean => content !== latestLibrary.name;\n\nexport const requestLibraryInfo = async (props: {\n  id: string;\n  type: LibraryType;\n  spaceId?: string;\n  apiId?: string;\n  projectId?: string;\n  avatarBotId?: string;\n}): Promise<ILibraryItem | undefined> => {\n  const { id, type, apiId, spaceId, projectId, avatarBotId } = props;\n  const { data } = await PlaygroundApi.GetPromptReferenceInfo(\n    {\n      reference_id: id,\n      reference_type: getReferenceType(type),\n      api_id: apiId,\n      space_id: spaceId ?? '',\n      project_id: projectId,\n      avatar_bot_id: avatarBotId,\n    },\n    {\n      __disableErrorToast: true,\n    },\n  );\n  if (!data) {\n    return undefined;\n  }\n  return {\n    ...(data as ILibraryItem),\n    type,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ILibraryList, type LibraryBlockInfo } from '../types';\nimport { findTargetLibrary, isLibraryNameOutDate } from './library-validate';\ninterface LibraryBlockTooltipProps {\n  librarys: ILibraryList;\n  libraryBlockInfo: LibraryBlockInfo | null;\n  content: string;\n}\nexport type LibraryStatus = 'disabled' | 'existing' | 'outdated';\n\nexport const getLibraryStatus = ({\n  librarys,\n  libraryBlockInfo,\n  content,\n}: LibraryBlockTooltipProps): {\n  libraryStatus: LibraryStatus;\n} => {\n  let libraryStatus: LibraryStatus = 'disabled';\n\n  if (!libraryBlockInfo) {\n    return {\n      libraryStatus: 'disabled',\n    };\n  }\n  const targetLibrary = findTargetLibrary(librarys, libraryBlockInfo);\n\n  if (!targetLibrary) {\n    return {\n      libraryStatus: 'disabled',\n    };\n  }\n\n  const isOutdated = isLibraryNameOutDate(content, targetLibrary);\n\n  if (isOutdated) {\n    libraryStatus = 'outdated';\n  } else {\n    libraryStatus = 'existing';\n  }\n\n  return {\n    libraryStatus,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { merge } from 'lodash-es';\n\nimport {\n  type LibraryType,\n  type ILibraryList,\n  type ILibraryItem,\n  type LibraryBlockInfo,\n} from '../types';\nimport {\n  pluginIcon,\n  workflowIcon,\n  imageflowIcon,\n  tableIcon,\n  textIcon,\n  imageIcon,\n} from '../assets';\nimport { type TemplateParser } from '../../shared/utils/template-parser';\nimport { checkLibraryId } from './library-validate';\nconst defaultLibraryBlockInfo: Record<\n  LibraryType,\n  {\n    icon: string;\n  }\n> = {\n  plugin: {\n    icon: pluginIcon,\n  },\n  workflow: {\n    icon: workflowIcon,\n  },\n  imageflow: {\n    icon: imageflowIcon,\n  },\n  table: {\n    icon: tableIcon,\n  },\n  text: {\n    icon: textIcon,\n  },\n  image: {\n    icon: imageIcon,\n  },\n};\n// Get the corresponding information according to the resource type\nexport const getLibraryBlockInfoFromTemplate = (props: {\n  template: string;\n  templateParser: TemplateParser;\n}): LibraryBlockInfo | null => {\n  const { template, templateParser } = props;\n  const data = templateParser.getData(template);\n  if (!data) {\n    return null;\n  }\n  const { type, ...rest } = data as LibraryBlockInfo;\n  const libraryBlockInfo = merge({}, defaultLibraryBlockInfo[type], {\n    type,\n    ...rest,\n  });\n  return libraryBlockInfo;\n};\n\nexport const getLibraryInfoByBlockInfo = (\n  librarys: ILibraryList,\n  blockInfo: LibraryBlockInfo,\n): ILibraryItem | null => {\n  if (!librarys || !blockInfo) {\n    return null;\n  }\n  const libraryTypeList = librarys.find(\n    library => library.type === blockInfo.type,\n  );\n  return (\n    (libraryTypeList?.items as ILibraryItem[])?.find(item =>\n      checkLibraryId(item, blockInfo),\n    ) ?? null\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type RefObject } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\n\nimport { type ILibraryItem } from '../../types';\n\ninterface RenameLibraryActionProps {\n  editorRef: RefObject<EditorAPI>;\n  library: ILibraryItem;\n  range: {\n    left: number;\n    right: number;\n  };\n  onRename?: (pos: { from: number; to: number }) => void;\n}\nexport const RenameLibraryAction = ({\n  editorRef,\n  library,\n  range,\n  onRename,\n}: RenameLibraryActionProps) => {\n  const handleRename = () => {\n    if (!editorRef.current) {\n      return;\n    }\n    editorRef.current?.$view.dispatch({\n      changes: {\n        from: range.left,\n        to: range.right,\n        insert: library.name,\n      },\n    });\n    onRename?.({ from: range.left, to: range.right });\n  };\n  return (\n    <Button onClick={handleRename} color=\"primary\" size=\"small\">\n      {I18n.t('edit_block_api_rename')}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type RefObject } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Tooltip } from '@coze-arch/coze-design';\n\nimport { type ILibraryItem, type LibraryBlockInfo } from '../types';\nimport { LibraryItem } from '../library-search-popover/library-item';\nimport { RenameLibraryAction } from '../library-search-popover/actions/rename-library-action';\nimport { AddLibraryAction } from '../library-search-popover/actions/add-library-action';\nimport { requestLibraryInfo } from './library-validate';\nimport type { LibraryStatus } from './get-library-status';\ninterface GetLibraryTooltipProps {\n  editorRef: RefObject<EditorAPI>;\n  libraryStatus: LibraryStatus;\n  libraryItem: ILibraryItem | null;\n  readonly: boolean;\n  blockDataInfo: LibraryBlockInfo | null;\n  spaceId: string;\n  onAddLibrary?: (library: ILibraryItem) => void;\n  range: {\n    left: number;\n    right: number;\n  };\n  projectId?: string;\n  avatarBotId?: string;\n  onRename?: (pos: { from: number; to: number }) => void;\n  disabled?: boolean;\n}\n\nexport const getLibraryTooltip = async ({\n  editorRef,\n  libraryStatus,\n  libraryItem,\n  blockDataInfo,\n  onAddLibrary,\n  readonly,\n  spaceId,\n  range,\n  projectId,\n  avatarBotId,\n  onRename,\n  disabled,\n}: GetLibraryTooltipProps): Promise<{\n  tooltipConfig?: React.ComponentProps<typeof Tooltip>;\n}> => {\n  try {\n    if (disabled) {\n      return getHiddenLibraryTooltip();\n    }\n\n    if (readonly) {\n      return getDisabledLibraryTooltip();\n    }\n\n    const { type, id } = blockDataInfo ?? {};\n    if (!blockDataInfo || !type || !id) {\n      return getDisabledLibraryTooltip();\n    }\n\n    if (libraryStatus === 'disabled' || !libraryItem) {\n      return await getPublicLibraryTooltip({\n        blockDataInfo,\n        spaceId,\n        onAddLibrary,\n        projectId,\n        avatarBotId,\n      });\n    }\n\n    if (libraryStatus === 'outdated') {\n      return getOutdatedLibraryTooltip({\n        editorRef,\n        item: libraryItem,\n        range,\n        onRename,\n      });\n    }\n\n    if (libraryStatus === 'existing') {\n      return getExistingLibraryTooltip(libraryItem);\n    }\n\n    return getDisabledLibraryTooltip();\n  } catch (error) {\n    const errorMsg = (error as { msg: string }).msg;\n    if (errorMsg) {\n      return {\n        tooltipConfig: {\n          content: errorMsg,\n        },\n      };\n    }\n    return getDisabledLibraryTooltip();\n  }\n};\n\nconst getExistingLibraryTooltip = (\n  libraryItem: ILibraryItem,\n): {\n  tooltipConfig?: React.ComponentProps<typeof Tooltip>;\n} => ({\n  tooltipConfig: {\n    content: (\n      <LibraryItem\n        title={libraryItem.name ?? ''}\n        description={libraryItem.desc ?? ''}\n        avatar={libraryItem.icon_url ?? ''}\n        className=\"!p-0\"\n      />\n    ),\n    className: 'library-block-tooltip !w-[310px] !p-2',\n  },\n});\n\nconst getDisabledLibraryTooltip = (\n  msg?: string,\n): {\n  tooltipConfig?: React.ComponentProps<typeof Tooltip>;\n} => ({\n  tooltipConfig: {\n    content: msg ?? I18n.t('edit_block_api_disable_tooltips'),\n  },\n});\n\nconst getHiddenLibraryTooltip = (): {\n  tooltipConfig?: React.ComponentProps<typeof Tooltip>;\n} => ({\n  tooltipConfig: {\n    visible: false,\n    trigger: 'custom',\n  },\n});\n\nconst getOutdatedLibraryTooltip = ({\n  item,\n  range,\n  onRename,\n  editorRef,\n}: {\n  editorRef: RefObject<EditorAPI>;\n  item: ILibraryItem;\n  range: {\n    left: number;\n    right: number;\n  };\n  onRename?: (pos: { from: number; to: number }) => void;\n}): {\n  tooltipConfig?: React.ComponentProps<typeof Tooltip>;\n} => ({\n  tooltipConfig: {\n    content: (\n      <LibraryItem\n        title={item.name ?? ''}\n        description={item.desc ?? ''}\n        avatar={item.icon_url ?? ''}\n        className=\"!p-0\"\n        actions={\n          <RenameLibraryAction\n            library={item}\n            range={range}\n            editorRef={editorRef}\n            onRename={onRename}\n          />\n        }\n      />\n    ),\n    className: 'library-block-tooltip !w-[310px] !p-2',\n  },\n});\n\nconst getPublicLibraryTooltip = async ({\n  blockDataInfo,\n  spaceId,\n  onAddLibrary,\n  projectId,\n  avatarBotId,\n}: {\n  blockDataInfo: LibraryBlockInfo | null;\n  spaceId: string;\n  onAddLibrary?: (library: ILibraryItem) => void;\n  projectId?: string;\n  avatarBotId?: string;\n}): Promise<{\n  tooltipConfig?: React.ComponentProps<typeof Tooltip>;\n}> => {\n  const { id, type } = blockDataInfo ?? {};\n  if (!id || !type) {\n    return getDisabledLibraryTooltip();\n  }\n\n  try {\n    const libraryInfo = await requestLibraryInfo({\n      id,\n      type,\n      ...(type === 'plugin' && {\n        apiId: blockDataInfo?.apiId,\n      }),\n      spaceId,\n      projectId,\n      avatarBotId,\n    });\n    if (!libraryInfo) {\n      return getDisabledLibraryTooltip();\n    }\n    return {\n      tooltipConfig: {\n        content: (\n          <LibraryItem\n            title={libraryInfo.name ?? ''}\n            description={libraryInfo.desc ?? ''}\n            avatar={libraryInfo.icon_url ?? ''}\n            className=\"!p-0\"\n            actions={\n              onAddLibrary ? (\n                <AddLibraryAction\n                  library={libraryInfo}\n                  onClick={onAddLibrary}\n                />\n              ) : undefined\n            }\n          />\n        ),\n        className: 'library-block-tooltip !w-[310px] !p-2',\n        showArrow: false,\n      },\n    };\n  } catch (error) {\n    return getDisabledLibraryTooltip((error as { msg: string }).msg);\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type RefObject, useLayoutEffect, useState } from 'react';\n\nimport { type Root, createRoot } from 'react-dom/client';\nimport cls from 'classnames';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { Tooltip } from '@coze-arch/coze-design';\nimport { WidgetType } from '@codemirror/view';\n\nimport { getLibraryTooltip } from '../utils/get-library-tooltip';\nimport { type LibraryStatus } from '../utils/get-library-status';\nimport { type LibraryBlockInfo, type ILibraryItem } from '../types';\ninterface LibraryBlockWidgetOptions {\n  editorRef: RefObject<EditorAPI>;\n  blockDataInfo: LibraryBlockInfo | null;\n  libraryItem: ILibraryItem | null;\n  content: string;\n  hightlight: boolean;\n  libraryStatus: LibraryStatus;\n  readonly: boolean;\n  spaceId?: string;\n  className?: string;\n  onAddLibrary?: (library: ILibraryItem) => void;\n  range: {\n    left: number;\n    right: number;\n  };\n  projectId?: string;\n  avatarBotId?: string;\n  onRename?: (pos: { from: number; to: number }) => void;\n  disabledTooltips?: boolean;\n}\n\nfunction createElement(\n  name: string,\n  attributes: Record<string, string>,\n  children: (HTMLElement | string)[] = [],\n) {\n  const el = document.createElement(name);\n  for (const [key, value] of Object.entries(attributes)) {\n    el.setAttribute(key, value);\n  }\n  for (const child of children) {\n    if (typeof child === 'string') {\n      const text = document.createTextNode(child);\n      el.appendChild(text);\n    } else {\n      el.appendChild(child);\n    }\n  }\n  return el;\n}\n\nexport class LibraryBlockWidgetType extends WidgetType {\n  private options: LibraryBlockWidgetOptions | null;\n  private container: HTMLSpanElement;\n  private root: Root | null;\n  private dom: HTMLSpanElement | undefined;\n  private mounted: boolean;\n\n  constructor(options: LibraryBlockWidgetOptions | null) {\n    super();\n    this.options = options;\n    this.container = document.createElement('span');\n    this.root = null;\n    this.mounted = false;\n  }\n\n  toDOM() {\n    if (!this.options) {\n      return this.container;\n    }\n\n    if (this.root) {\n      this.destroy();\n    }\n\n    if (!this.mounted) {\n      // Synchronized rendering to avoid jitter\n      this.renderLibraryBlock(this.options);\n      this.renderTooltip(this.options);\n      this.mounted = true;\n    }\n\n    return this.container;\n  }\n\n  renderLibraryBlock(options: LibraryBlockWidgetOptions) {\n    const dom = createElement(\n      'span',\n      {\n        class: cls('library-block-container leading-5', options.className, {\n          '!coz-mg-hglt !text-[#9498F7] !text-opacity-70': !options.hightlight,\n        }),\n      },\n      [\n        createElement('img', {\n          src: options.blockDataInfo?.icon || '',\n          class: cls('library-block-icon', {\n            '!opacity-70': !options.hightlight,\n          }),\n        }),\n        createElement(\n          'span',\n          {\n            class: 'library-block-content',\n          },\n          [options.content],\n        ),\n      ],\n    );\n\n    this.dom = dom;\n    this.container.appendChild(dom);\n  }\n\n  renderTooltip(options: LibraryBlockWidgetOptions) {\n    const tooltipTriggerDOM = document.createElement('span');\n\n    this.root = createRoot(tooltipTriggerDOM);\n    this.container.appendChild(tooltipTriggerDOM);\n\n    this.root.render(\n      <LibraryBlockWidgetReactCom\n        editorRef={options.editorRef}\n        blockDataInfo={options?.blockDataInfo}\n        libraryItem={options.libraryItem}\n        content={options.content}\n        hightlight={options.hightlight}\n        readonly={options.readonly}\n        libraryStatus={options.libraryStatus}\n        onAddLibrary={options.onAddLibrary}\n        onRename={options.onRename}\n        spaceId={options.spaceId ?? ''}\n        range={options.range}\n        beforeMount={() => {\n          const element = this.dom;\n          if (element?.parentNode) {\n            element.parentNode.removeChild(element);\n          }\n        }}\n        projectId={options.projectId}\n        avatarBotId={options.avatarBotId}\n        disabledTooltips={options.disabledTooltips}\n      />,\n    );\n  }\n\n  destroy() {\n    this.mounted = false;\n\n    if (this.root) {\n      /**\n       * Fix React warning: Attempted to synchronously unmount a root while React was already rendering\n       * https://stackoverflow.com/questions/73043828/how-to-unmount-something-created-with-createroot-properly\n       */\n      setTimeout(() => {\n        this.root?.unmount();\n      }, 0);\n      this.root = null;\n    }\n\n    if (this.dom) {\n      this.dom.remove();\n      this.dom = undefined;\n    }\n\n    this.options = null;\n  }\n}\n\nexport const LibraryBlockWidgetReactCom = (props: {\n  editorRef: RefObject<EditorAPI>;\n  blockDataInfo: LibraryBlockInfo | null;\n  libraryItem: ILibraryItem | null;\n  content: string;\n  hightlight?: boolean;\n  readonly: boolean;\n  libraryStatus: LibraryStatus;\n  onAddLibrary?: (library: ILibraryItem) => void;\n  spaceId: string;\n  range: {\n    left: number;\n    right: number;\n  };\n  beforeMount: () => void;\n  className?: string;\n  projectId?: string;\n  avatarBotId?: string;\n  onRename?: (pos: { from: number; to: number }) => void;\n  disabledTooltips?: boolean;\n}) => {\n  const {\n    blockDataInfo,\n    libraryItem,\n    content,\n    hightlight = true,\n    libraryStatus,\n    onAddLibrary,\n    readonly,\n    spaceId,\n    range,\n    editorRef,\n    beforeMount,\n    className,\n    projectId,\n    avatarBotId,\n    onRename,\n    disabledTooltips,\n  } = props;\n\n  const [tooltipConfig, setTooltipConfig] = useState<\n    React.ComponentProps<typeof Tooltip> | undefined\n  >(undefined);\n\n  const loadTooltipConfig = async () => {\n    if (!editorRef.current) {\n      return;\n    }\n\n    const res = await getLibraryTooltip({\n      editorRef,\n      libraryStatus,\n      readonly,\n      libraryItem,\n      blockDataInfo,\n      onAddLibrary,\n      spaceId,\n      range,\n      projectId,\n      avatarBotId,\n      onRename,\n      disabled: disabledTooltips,\n    });\n    setTooltipConfig(res.tooltipConfig);\n  };\n\n  useLayoutEffect(() => {\n    beforeMount();\n  }, []);\n\n  const baseElement = (\n    <span\n      className={cls('library-block-container leading-5', className, {\n        '!coz-mg-hglt !text-[#9498F7] !text-opacity-70': !hightlight,\n      })}\n      onMouseEnter={loadTooltipConfig}\n    >\n      <img\n        src={blockDataInfo?.icon || ''}\n        className={cls('library-block-icon', {\n          '!opacity-70': !hightlight,\n        })}\n      />\n      <span className=\"library-block-content\">{content}</span>\n    </span>\n  );\n\n  // Render Tooltip only if tooltipConfig exists\n  if (!tooltipConfig) {\n    return baseElement;\n  }\n\n  return (\n    <Tooltip\n      position=\"bottomLeft\"\n      spacing={{ y: 4, x: 0 }}\n      showArrow={false}\n      {...tooltipConfig}\n    >\n      {baseElement}\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useLayoutEffect, useRef } from 'react';\n\nimport { useInjector, useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { astDecorator } from '@coze-editor/editor';\n\nimport { getLibraryStatus } from '../utils/get-library-status';\nimport {\n  getLibraryBlockInfoFromTemplate,\n  getLibraryInfoByBlockInfo,\n} from '../utils/get-library-info';\nimport type { ILibraryItem, ILibraryList } from '../types';\nimport { TemplateParser } from '../../shared/utils/template-parser';\nimport { LibraryBlockWidgetType } from './library-block-widget-type';\nimport './index.css';\n\nconst templateParser = new TemplateParser({ mark: 'LibraryBlock' });\nfunction useLatest<T>(value: T) {\n  const ref = useRef<T>(value);\n  ref.current = value;\n  return ref;\n}\ninterface LibraryBlockWidgetProps {\n  librarys: ILibraryList;\n  readonly?: boolean;\n  spaceId?: string;\n  className?: string;\n  onAddLibrary?: (\n    library: ILibraryItem,\n    pos?: { from: number; to: number },\n  ) => void;\n  projectId?: string;\n  avatarBotId?: string;\n  onRename?: (pos: { from: number; to: number }) => void;\n  disabledTooltips?: boolean;\n}\n\nexport const LibraryBlockWidget = (props: LibraryBlockWidgetProps) => {\n  const ref = useLatest(props);\n\n  const editor = useEditor<EditorAPI>();\n  const editorRef = useLatest(editor);\n  const injector = useInjector();\n  useLayoutEffect(\n    () =>\n      injector.inject([\n        astDecorator.whole.of((cursor, state) => {\n          const {\n            librarys,\n            readonly = false,\n            spaceId,\n            className,\n            projectId,\n            avatarBotId,\n            onRename,\n            disabledTooltips,\n          } = ref.current;\n          if (templateParser.isOpenNode(cursor.node, state)) {\n            const open = cursor.node;\n            const close = templateParser.findCloseNode(open, state);\n\n            if (close) {\n              const openTemplate = state.sliceDoc(open.from, open.to);\n              const contentFrom = open.to;\n              const contentTo = close.from;\n              const content = state.sliceDoc(contentFrom, contentTo);\n              const dataInfo = getLibraryBlockInfoFromTemplate({\n                template: openTemplate,\n                templateParser,\n              });\n              const { libraryStatus } = getLibraryStatus({\n                librarys,\n                libraryBlockInfo: dataInfo,\n                content,\n              });\n              const libraryInfo = dataInfo\n                ? getLibraryInfoByBlockInfo(librarys, dataInfo)\n                : null;\n              return [\n                {\n                  type: 'replace',\n                  widget: new LibraryBlockWidgetType({\n                    editorRef,\n                    blockDataInfo: dataInfo,\n                    libraryItem: libraryInfo,\n                    readonly,\n                    content,\n                    spaceId,\n                    className,\n                    hightlight: libraryStatus === 'existing',\n                    libraryStatus,\n                    onAddLibrary(library) {\n                      if (typeof ref.current.onAddLibrary === 'function') {\n                        ref.current.onAddLibrary(library, {\n                          from: open.from,\n                          to: close.to,\n                        });\n                      }\n                    },\n                    range: {\n                      left: open.to,\n                      right: close.from,\n                    },\n                    projectId,\n                    avatarBotId,\n                    onRename,\n                    disabledTooltips,\n                  }),\n                  atomicRange: true,\n                  from: open.from,\n                  to: close.to,\n                },\n              ];\n            }\n          }\n        }),\n        templateParser.markInfoField,\n      ]),\n    [injector],\n  );\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    editor?.updateWholeDecorations();\n  }, [editor, props.librarys]);\n\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport {\n  PositionMirror,\n  useChangeListener,\n  useEditor,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { Popover } from '@coze-arch/coze-design';\nimport { type ViewUpdate } from '@codemirror/view';\nimport { syntaxTree } from '@codemirror/language';\n\nimport type { ILibraryList } from '../types';\nimport { TemplateParser } from '../../shared/utils/template-parser';\nimport { LibraryList } from './library-list';\ninterface LibrarySearchPopoverProps {\n  librarys: ILibraryList;\n  direction?: React.ComponentProps<typeof Popover>['position'];\n}\nconst templateParser = new TemplateParser({ mark: 'LibraryBlock' });\nexport const LibrarySearchPopover = ({\n  librarys,\n  direction = 'bottomLeft',\n}: LibrarySearchPopoverProps) => {\n  const [reposKey, setReposKey] = useState('');\n  const [visible, setVisible] = useState(false);\n  const [position, setPosition] = useState(-1);\n  const [toPosition, setToPosition] = useState(-1);\n  const emptyLibrary = librarys.map(item => item.items).flat().length === 0;\n  const editor = useEditor<EditorAPI>();\n\n  useChangeListener(e => {\n    const [_fromA, _toA, fromB, toB, inserted] = e.change;\n    if (['{}', '{'].includes(inserted.toString())) {\n      const node = syntaxTree(e.view.state).resolve(\n        inserted.toString() === '{}' ? toB - 1 : toB,\n      );\n\n      if (node.name === 'JinjaText') {\n        setPosition(fromB);\n        setToPosition(toB);\n        setVisible(true);\n      } else {\n        // Some scene input {should not pop up the prompt panel\n        // For example, the cursor is within {{ }} , or within {% %} , or within {# #}\n        setVisible(false);\n      }\n    } else {\n      setVisible(false);\n    }\n  });\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    function handleViewUpdate(update: ViewUpdate) {\n      if (update.transactions.some(tr => tr.isUserEvent('select'))) {\n        setVisible(false);\n      }\n    }\n\n    editor.$on('viewUpdate', handleViewUpdate);\n\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor]);\n\n  return (\n    <>\n      <Popover\n        rePosKey={reposKey}\n        visible={visible}\n        trigger=\"custom\"\n        position={emptyLibrary ? 'bottomLeft' : direction}\n        onClickOutSide={() => setVisible(false)}\n        autoAdjustOverflow\n        content={\n          !emptyLibrary ? (\n            <div className=\"flex flex-col p-1  w-[352px] max-h-[330px] overflow-y-auto\">\n              <LibraryList\n                librarys={librarys}\n                onInsert={insertLibrary => {\n                  const { name = '', id = '', type } = insertLibrary;\n                  const uuid = nanoid();\n                  const template = templateParser.generateTemplate({\n                    content: name,\n                    data: {\n                      id,\n                      uuid,\n                      type,\n                      ...(type === 'plugin' && {\n                        apiId: insertLibrary.api_id,\n                      }),\n                    },\n                  });\n                  // Remove the inserted shortcut, because the original was automatically added\n                  templateParser.insertTemplateByRange(editor, template, {\n                    from: position,\n                    to: toPosition,\n                  });\n                  setVisible(false);\n                }}\n              />\n            </div>\n          ) : (\n            <div className=\"coz-fg-primary text-sm font-medium px-3 py-2\">\n              {I18n.t('edit_block_api_empty')}\n            </div>\n          )\n        }\n      >\n        <PositionMirror\n          position={position}\n          onChange={() => setReposKey(String(Math.random()))}\n        />\n      </Popover>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\n\nimport { type ILibraryItem } from '../../types';\n\ninterface AddLibraryActionProps {\n  library: ILibraryItem;\n  onClick: (library: ILibraryItem) => void;\n}\nexport const AddLibraryAction = ({\n  library,\n  onClick,\n}: AddLibraryActionProps) => (\n  <Button onClick={() => onClick(library)} color=\"primary\" size=\"small\">\n    {I18n.t('add')}\n  </Button>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type ReactNode } from 'react';\n\nimport classNames from 'classnames';\nimport { Typography, Highlight } from '@coze-arch/coze-design';\n\ninterface LibraryItemProps {\n  title: string;\n  description?: string;\n  avatar: string;\n  icons?: ReactNode;\n  actions?: ReactNode;\n  className?: string;\n  searchWords?: string[];\n}\nexport const LibraryItem: FC<LibraryItemProps> = ({\n  title,\n  description,\n  avatar,\n  icons,\n  actions,\n  className,\n  searchWords,\n}) => (\n  <div\n    className={classNames(\n      'w-full flex flex-row items-center coz-bg-max rounded-[8px]',\n      ' gap-3',\n      className,\n    )}\n  >\n    <div\n      className={classNames(\n        'flex flex-row flex-1 min-w-[0px] justify-center items-center ',\n      )}\n    >\n      {avatar ? (\n        <img\n          src={avatar}\n          className={classNames(\n            'w-[24px] h-[24px] rounded-[5px]',\n            'overflow-hidden',\n          )}\n        />\n      ) : null}\n      <div\n        className={classNames(\n          'ml-[8px]',\n          'flex flex-col flex-1 min-w-[0px] w-0',\n        )}\n      >\n        <div className=\"flex flex-row items-center overflow-hidden\">\n          <Typography.Paragraph\n            ellipsis={{\n              showTooltip: true,\n            }}\n            className={classNames(\n              'text-[14px] leading-[20px]',\n              'coz-fg-primary truncate flex-1 font-medium',\n            )}\n          >\n            <Highlight\n              sourceString={title}\n              searchWords={searchWords}\n              highlightStyle={{\n                color: 'var(--coz-fg-hglt-yellow, #FF7300)',\n                backgroundColor: 'transparent',\n              }}\n            />\n          </Typography.Paragraph>\n\n          <div className=\"justify-self-end grid grid-flow-col gap-x-[2px]\">\n            {icons}\n          </div>\n        </div>\n      </div>\n    </div>\n    <div className={classNames('grid grid-flow-col gap-x-[2px]')}>\n      {actions}\n    </div>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classnames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/coze-design';\n\nimport {\n  type ILibraryList,\n  type ILibraryItem,\n  type LibraryType,\n} from '../types';\nimport { LibraryItem } from './library-item';\nimport { AddLibraryAction } from './actions/add-library-action';\ninterface LibraryListProps {\n  librarys: ILibraryList;\n  onInsert?: (library: ILibraryItem) => void;\n  libraryItemClassName?: string;\n  searchWords?: string[];\n}\nconst LibraryTypeTextMap: Record<LibraryType, string> = {\n  plugin: I18n.t('edit_block_api_plugin'),\n  workflow: I18n.t('edit_block_api_workflow'),\n  imageflow: I18n.t('edit_block_api_imageflow'),\n  text: I18n.t('edit_block_api_knowledge_text'),\n  image: I18n.t('edit_block_api_knowledge_image'),\n  table: I18n.t('edit_block_api_knowledge_table'),\n};\nexport const LibraryList = ({\n  librarys,\n  onInsert,\n  libraryItemClassName,\n  searchWords,\n}: LibraryListProps) => (\n  <div className=\"flex flex-col gap-2\">\n    {Object.values(librarys).map(library => {\n      const { items, type } = library;\n      if (items.length === 0) {\n        return null;\n      }\n      return (\n        <div key={type} className=\"flex flex-col\">\n          <Typography.Text className=\"coz-fg-tertiary text-xs mb-1 px-2 pt-2 pb-1\">\n            {LibraryTypeTextMap[type]}\n          </Typography.Text>\n          {items.map(item => {\n            const { name, desc, icon_url } = item;\n            return (\n              <LibraryItem\n                searchWords={searchWords}\n                key={name}\n                title={name || ''}\n                description={desc || ''}\n                avatar={icon_url || ''}\n                className={classnames('p-[8px]', libraryItemClassName)}\n                actions={\n                  <AddLibraryAction\n                    library={{ ...item, type }}\n                    onClick={libraryItem => {\n                      onInsert?.(libraryItem);\n                    }}\n                  />\n                }\n              />\n            );\n          })}\n        </div>\n      );\n    })}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MutableRefObject } from 'react';\n\nimport styles from '../style.module.less';\nimport type { ILibraryItem, ILibraryList } from '../../../library-insert';\n\nconst SELECTED_OPTION_CLASSNAME =\n  styles['library-suggestion-keyboard-selected'];\n\ninterface OptionsInfo {\n  elements: Element[];\n  selectedIndex: number;\n  selectedElement?: Element;\n}\n\nconst getOptionInfoFromDOM = (\n  root: Element | null,\n): OptionsInfo | undefined => {\n  if (!root) {\n    return;\n  }\n\n  const foundNodes = root.querySelectorAll(`.${styles['library-item']}`);\n\n  if (foundNodes.length === 0) {\n    return;\n  }\n\n  const optionElements = [...foundNodes];\n\n  // Find the currently highlighted option\n  const selectedIndex = optionElements.findIndex(element =>\n    element.classList.contains(SELECTED_OPTION_CLASSNAME),\n  );\n\n  return {\n    elements: optionElements,\n    selectedIndex,\n    selectedElement: optionElements[selectedIndex],\n  };\n};\n\nconst selectNodeByIndex = (elements: Element[], index: number) => {\n  const newSelectedElement = elements[index];\n\n  if (!newSelectedElement) {\n    return;\n  }\n\n  // remove old selected class\n  elements.forEach(element => {\n    if (element.classList.contains(SELECTED_OPTION_CLASSNAME)) {\n      element.classList.remove(SELECTED_OPTION_CLASSNAME);\n    }\n  });\n\n  newSelectedElement.classList.add(SELECTED_OPTION_CLASSNAME);\n\n  newSelectedElement.scrollIntoView({\n    behavior: 'smooth',\n    block: 'nearest',\n  });\n};\n\ninterface Props {\n  rootRef: MutableRefObject<HTMLDivElement | null>;\n  libraries: ILibraryList;\n  applyCallBack?: (item: ILibraryItem) => void;\n}\n\nexport default function useOptionsOperations({\n  rootRef,\n  libraries,\n  applyCallBack,\n}: Props) {\n  const prev = () => {\n    const optionsInfo = getOptionInfoFromDOM(rootRef.current);\n\n    if (!optionsInfo) {\n      return;\n    }\n\n    const { elements, selectedIndex } = optionsInfo;\n\n    if (elements.length === 1) {\n      return;\n    }\n\n    const newIndex =\n      selectedIndex - 1 < 0 ? elements.length - 1 : selectedIndex - 1;\n    selectNodeByIndex(elements, newIndex);\n  };\n  const next = () => {\n    const optionsInfo = getOptionInfoFromDOM(rootRef.current);\n    if (!optionsInfo) {\n      return;\n    }\n\n    const { elements, selectedIndex } = optionsInfo;\n\n    const newIndex =\n      selectedIndex + 1 >= elements.length ? 0 : selectedIndex + 1;\n    selectNodeByIndex(elements, newIndex);\n  };\n\n  const apply = () => {\n    const optionsInfo = getOptionInfoFromDOM(rootRef.current);\n    if (!optionsInfo) {\n      return;\n    }\n\n    const selectedLibrary = libraries.reduce<ILibraryItem[]>(\n      (previousValue, currentValue) => [\n        ...previousValue,\n        ...(currentValue?.items || []),\n      ],\n      [],\n    )[optionsInfo.selectedIndex];\n\n    if (!selectedLibrary) {\n      return;\n    }\n\n    applyCallBack?.(selectedLibrary);\n  };\n\n  return {\n    prev,\n    next,\n    apply,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { forwardRef, useMemo, useRef } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport type { EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\n\nimport styles from '../style.module.less';\nimport { TemplateParser } from '../../../shared/utils/template-parser';\nimport { LibraryList as DefaultLibraryList } from '../../../library-insert/library-search-popover/library-list';\nimport type { ILibraryItem, ILibraryList } from '../../../library-insert';\nimport { useKeyboard } from '../../../expression/popover/hooks';\nimport useOptionsOperations from './use-options-operations';\n\ninterface LibraryListProps {\n  libraries: ILibraryList;\n  onInsert?: (library: ILibraryItem) => void;\n  searchWords?: string[];\n}\n\nconst LibraryList = forwardRef<HTMLDivElement, LibraryListProps>(\n  ({ libraries, onInsert, searchWords }, ref) => {\n    const emptyLibrary = libraries.map(item => item.items).flat().length === 0;\n\n    return !emptyLibrary ? (\n      <div\n        ref={ref}\n        className=\"flex flex-col p-1  w-[352px] max-h-[330px] overflow-y-auto\"\n      >\n        <DefaultLibraryList\n          librarys={libraries}\n          onInsert={onInsert}\n          libraryItemClassName={styles['library-item']}\n          searchWords={searchWords}\n        />\n      </div>\n    ) : (\n      <div ref={ref} className=\"coz-fg-primary text-sm font-medium px-3 py-2\">\n        {I18n.t('edit_block_api_empty')}\n      </div>\n    );\n  },\n);\n\ninterface Props {\n  editor: EditorAPI;\n  insertPosition: {\n    from: number;\n    to: number;\n  };\n  onInsert?: (insertPosition: { from: number; to: number }) => void;\n  enableKeyboard: boolean;\n  filterText?: string;\n  libraries: ILibraryList;\n}\n\nconst templateParser = new TemplateParser({ mark: 'LibraryBlock' });\n\nexport default function useLibraryList({\n  libraries,\n  editor,\n  insertPosition,\n  onInsert,\n  enableKeyboard,\n  filterText,\n}: Props) {\n  const libraryListRef = useRef<HTMLDivElement>(null);\n\n  const filterLibraries = useMemo(() => {\n    if (!filterText) {\n      return libraries;\n    }\n\n    return libraries\n      .map(item => ({\n        ...item,\n        items: item.items.filter(i =>\n          i.name.toLowerCase().includes(filterText.toLowerCase()),\n        ),\n      }))\n      .filter(item => item.items?.length);\n  }, [libraries, filterText]);\n\n  const handleLibraryInsert = (library: ILibraryItem) => {\n    const { name = '', id = '', type } = library;\n    const uuid = nanoid();\n    const template = templateParser.generateTemplate({\n      content: name,\n      data: {\n        id,\n        uuid,\n        type,\n        ...(type === 'plugin' && {\n          apiId: library.api_id,\n        }),\n      },\n    });\n\n    templateParser.insertTemplateByRange(editor, template, insertPosition);\n\n    onInsert?.({\n      from: insertPosition.from,\n      to: insertPosition.from + template.length,\n    });\n  };\n\n  const { prev, next, apply } = useOptionsOperations({\n    rootRef: libraryListRef,\n    libraries: filterLibraries,\n    applyCallBack: handleLibraryInsert,\n  });\n\n  useKeyboard(enableKeyboard, {\n    ArrowUp: prev,\n    ArrowDown: next,\n    Enter: apply,\n  });\n\n  const libraryListPanel = (\n    <LibraryList\n      ref={libraryListRef}\n      libraries={filterLibraries}\n      onInsert={handleLibraryInsert}\n      searchWords={filterText ? [filterText] : undefined}\n    />\n  );\n\n  return {\n    libraryListPanel,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\n\nimport {\n  CursorMirror,\n  SelectionSide,\n  useEditor,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  Tabs,\n  TabPane,\n  RadioGroup,\n  Radio,\n  Popover,\n} from '@coze-arch/coze-design';\n\nimport { type ContentSearchPopoverProps } from '../types';\nimport { generateUniqueId, useLatest } from '../../expression/shared';\nimport {\n  useCharacterTriggerContext,\n  useInterpolationContent,\n  useSelection,\n} from '../../expression/popover/hooks';\nimport useVariablesTree from './variable/use-variables-tree';\nimport useLibraryList from './library/use-library-list';\n\nimport styles from './style.module.less';\n\nenum TabEnum {\n  Variables = '1',\n  Skills = '2',\n}\n\nconst genLibraryInsertPosition = (from?: number, to?: number) => {\n  const _from = (from ?? 0) - 1 >= 0 ? (from ?? 0) - 1 : 0;\n\n  return {\n    from: _from,\n    to: (to ?? _from) + 1,\n  };\n};\n\nexport const ContentSearchPopover = ({\n  libraries = [],\n  direction = 'bottomLeft',\n  readonly,\n  onInsert,\n  variableTree = [],\n}: ContentSearchPopoverProps) => {\n  const [activeTab, setActiveTab] = useState<string>(TabEnum.Variables);\n  const [reposKey, setReposKey] = useState('');\n  const emptyLibrary = libraries.map(item => item.items).flat().length === 0;\n  const editor = useEditor<EditorAPI>();\n  const editorRef = useLatest(editor);\n  const selection = useSelection(editor);\n\n  const interpolationContent = useInterpolationContent(\n    editor,\n    selection?.anchor,\n  );\n\n  const triggerContext = useCharacterTriggerContext();\n\n  const completionContext = interpolationContent ?? triggerContext;\n\n  const visible = Boolean(completionContext);\n\n  const insertPosition = genLibraryInsertPosition(\n    completionContext?.from,\n    completionContext?.to,\n  );\n\n  const { libraryListPanel } = useLibraryList({\n    libraries,\n    editor,\n    onInsert,\n    insertPosition,\n    enableKeyboard: visible && activeTab === TabEnum.Skills,\n    filterText: completionContext?.text,\n  });\n\n  const { variablesTreePanel } = useVariablesTree({\n    variableTree,\n    enableKeyboard: visible && activeTab === TabEnum.Variables,\n    completionContext,\n  });\n\n  useEffect(() => {\n    if (visible) {\n      editorRef.current?.disableKeybindings(['ArrowUp', 'ArrowDown', 'Enter']);\n    } else {\n      editorRef.current?.disableKeybindings([]);\n    }\n  }, [visible]);\n\n  return (\n    <>\n      <Popover\n        style={{\n          width: '360px',\n          padding: '4px',\n          minHeight: '240px',\n          maxHeight: '400px',\n        }}\n        rePosKey={reposKey}\n        visible={!readonly && visible}\n        trigger=\"custom\"\n        position={emptyLibrary ? 'bottomLeft' : direction}\n        autoAdjustOverflow\n        content={\n          <Tabs\n            activeKey={activeTab}\n            onChange={key => {\n              setActiveTab(key);\n              // Make sure the cursor is still positioned on the editor after switching tabs\n              setTimeout(() => {\n                editorRef.current?.$view.focus();\n              }, 0);\n            }}\n            renderTabBar={tabBarProps => (\n              <div className={styles['tab-bar-wrapper']}>\n                <RadioGroup\n                  value={tabBarProps.activeKey}\n                  type=\"button\"\n                  buttonSize=\"middle\"\n                >\n                  {tabBarProps.list?.map(tab => (\n                    <span\n                      onClick={event =>\n                        tabBarProps.onTabClick?.(tab.itemKey, event)\n                      }\n                    >\n                      <Radio value={tab.itemKey}>{tab.tab}</Radio>\n                    </span>\n                  ))}\n                </RadioGroup>\n              </div>\n            )}\n          >\n            <TabPane\n              tab={I18n.t('workflow_prompt_editor_variable')}\n              itemKey={TabEnum.Variables}\n            >\n              {variablesTreePanel}\n            </TabPane>\n            <TabPane\n              tab={I18n.t('workflow_prompt_editor_skill')}\n              itemKey={TabEnum.Skills}\n            >\n              {libraryListPanel}\n            </TabPane>\n          </Tabs>\n        }\n      >\n        <CursorMirror\n          side={SelectionSide.Anchor}\n          onChange={() => setReposKey(generateUniqueId())}\n        />\n      </Popover>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention */\nimport React, { useCallback, useRef } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport type { EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport type { TreeNodeData } from '@coze-arch/bot-semi/Tree';\nimport { Tree } from '@coze-arch/bot-semi';\n\nimport styles from '../style.module.less';\nimport { useDeepEqualMemo } from '../../../expression/shared';\nimport {\n  applyNode,\n  getOptionInfoFromDOM,\n  selectNodeByIndex,\n} from '../../../expression/popover/shared';\nimport type { CompletionContext } from '../../../expression/popover/hooks/types';\nimport {\n  useDrillVariableTree,\n  useFilteredVariableTree,\n  useKeyboard,\n  useOptionsOperations,\n  useSelectedValue,\n  useTreeRefresh,\n  useTreeSearch,\n} from '../../../expression/popover/hooks';\nimport type { ExpressionEditorTreeNode } from '../../../expression/core';\n\ninterface Props {\n  variableTree: ExpressionEditorTreeNode[];\n  enableKeyboard: boolean;\n  completionContext?: CompletionContext;\n}\n\nexport default function useVariablesTree({\n  variableTree: variableTreeFromProps,\n  enableKeyboard,\n  completionContext,\n}: Props) {\n  const editor = useEditor<EditorAPI>();\n  const variableTree = useDeepEqualMemo(variableTreeFromProps);\n  const treeRef = useRef<Tree | null>(null);\n  const treeContainerRef = useRef<HTMLDivElement | null>(null);\n\n  const drilledVariableTree = useDrillVariableTree(\n    editor,\n    variableTree,\n    completionContext,\n  );\n\n  const selected = useSelectedValue(completionContext?.text, variableTree);\n\n  // Replace content in {{}} based on user selection\n  const handleSelect = useCallback(\n    (_: string, __: boolean, node: TreeNodeData) => {\n      if (!editor || !completionContext) {\n        return;\n      }\n\n      applyNode(editor, node as ExpressionEditorTreeNode, completionContext);\n\n      editor.$view.focus();\n    },\n    [editor, completionContext],\n  );\n\n  const filteredVariableTree = useFilteredVariableTree(\n    completionContext,\n    drilledVariableTree,\n  );\n\n  const treeRefreshKey = useTreeRefresh(filteredVariableTree);\n  useTreeSearch(treeRefreshKey, treeRef, completionContext, () => {\n    const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n    if (!optionsInfo) {\n      return;\n    }\n    const { elements } = optionsInfo;\n    selectNodeByIndex(elements, 0);\n  });\n\n  const { prev, next, apply } = useOptionsOperations(\n    editor,\n    completionContext,\n    treeContainerRef,\n    treeRef,\n  );\n\n  // Press the up and down keys to switch the recommended items, and press Enter to fill in.\n  useKeyboard(enableKeyboard, {\n    ArrowUp: prev,\n    ArrowDown: next,\n    Enter: () => {\n      apply();\n      editor.$view.focus();\n    },\n  });\n\n  const variablesTreePanel = (\n    <div\n      className={styles['library-variable-insert-tree']}\n      ref={treeContainerRef}\n    >\n      <Tree\n        ref={treeRef}\n        showFilteredOnly\n        filterTreeNode\n        onChangeWithObject\n        treeData={drilledVariableTree}\n        searchRender={false}\n        value={selected}\n        onSelect={handleSelect}\n      />\n    </div>\n  );\n\n  return {\n    variablesTreePanel,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { type ViewUpdate } from '@codemirror/view';\nexport const useReadonly = () => {\n  const editor = useEditor<EditorAPI>();\n  const [isReadOnly, setIsReadOnly] = useState(false);\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    setIsReadOnly(editor.$view.state.readOnly);\n    const handleViewUpdate = (update: ViewUpdate) => {\n      if (update.startState.readOnly !== update.state.readOnly) {\n        setIsReadOnly(update.state.readOnly);\n      }\n    };\n    editor.$on('viewUpdate', handleViewUpdate);\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor]);\n  return isReadOnly;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SyntaxNode } from '@lezer/common';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { type SelectionEnlargerSpec } from '@coze-editor/editor';\nimport { StateField, type EditorState } from '@codemirror/state';\nimport { syntaxTree } from '@codemirror/language';\nexport interface MarkRange {\n  from: number;\n  to: number;\n}\nexport interface MarkRangeInfo {\n  from: number;\n  to: number;\n  open: MarkRange;\n  close: MarkRange;\n}\n\n// Parse template string: {#slot name = \"slot_name\" #} xxx {#/slot #}\nexport class TemplateParser {\n  public mark!: 'LibraryBlock' | 'InputSlot';\n  private openReg!: RegExp;\n  private closeReg!: RegExp;\n  public markInfoField!: StateField<{\n    specs: SelectionEnlargerSpec[];\n    contents: MarkRange[];\n    marks: MarkRangeInfo[];\n  }>;\n  static instances = new Map<string, TemplateParser>();\n  constructor(props: { mark: 'LibraryBlock' | 'InputSlot' }) {\n    if (TemplateParser.instances.has(props.mark)) {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      return TemplateParser.instances.get(props.mark)!;\n    }\n    const { mark } = props;\n    this.mark = mark;\n    this.openReg = new RegExp(`^\\\\{#\\\\s*${mark}`);\n    this.closeReg = new RegExp(`^\\\\{#\\\\s*\\/${mark}`);\n    this.markInfoField = this.getMarkInfoField();\n    TemplateParser.instances.set(mark, this);\n  }\n\n  getMarkInfoField() {\n    return StateField.define({\n      create: state => this.getMarkSpecs(state),\n      update: (value, tr) => {\n        if (tr.docChanged) {\n          return this.getMarkSpecs(tr.state);\n        }\n        return value;\n      },\n    });\n  }\n\n  isOpenNode(node: SyntaxNode, state: EditorState) {\n    if (!node || node.name !== 'JinjaComment') {\n      return false;\n    }\n\n    const text = state.sliceDoc(node.from, node.to);\n    return this.openReg.test(text);\n  }\n\n  isCloseNode(node: SyntaxNode, state: EditorState) {\n    if (!node || node.name !== 'JinjaComment') {\n      return false;\n    }\n\n    const text = state.sliceDoc(node.from, node.to);\n    return this.closeReg.test(text);\n  }\n\n  getCursorInMarkNodeRange(state: EditorState): MarkRangeInfo | null {\n    const cursor = state.selection.main.head;\n    return this.getPostionInMarkNodeRange(cursor, state);\n  }\n\n  getSelectionInMarkNodeRange(\n    range: { from: number; to: number },\n    state: EditorState,\n  ): MarkRangeInfo | null {\n    return (\n      this.getPostionInMarkNodeRange(range.from, state) &&\n      this.getPostionInMarkNodeRange(range.to, state)\n    );\n  }\n\n  getPostionInMarkNodeRange(postion: number, state: EditorState) {\n    const markRangeInfo = state\n      .field(this.markInfoField)\n      .marks.find(\n        rangeInfo => rangeInfo.from < postion && postion < rangeInfo.to,\n      );\n    if (markRangeInfo) {\n      return markRangeInfo;\n    }\n    return null;\n  }\n\n  findCloseNode(node: SyntaxNode, state: EditorState) {\n    let next = node.nextSibling;\n    let close = null;\n    while (next) {\n      if (this.isCloseNode(next, state)) {\n        close = next;\n        break;\n      }\n      next = next.nextSibling;\n    }\n\n    return close;\n  }\n\n  // Parse template string: {#slot id = \"slot_id\" value = \"slot_value\" #}, get all properties\n  getData(templateString: string): { [key: string]: string } | null {\n    // Constructs regular expressions based on the type passed in, such as slots or blocks\n    const regex = new RegExp(`\\\\{#${this.mark}\\\\s+([^#]+)#\\\\}`, 'g');\n    const match = regex.exec(templateString);\n    if (match !== null) {\n      const attributes = match[1].trim(); // Matched attribute part\n      const attrRegex = /(\\w+)\\s*=\\s*\"([^\"]*)\"/g;\n      const obj: { [key: string]: string } = {}; // initial object\n      let attrMatch: RegExpExecArray | null;\n      while (true) {\n        attrMatch = attrRegex.exec(attributes);\n        if (attrMatch === null) {\n          break;\n        }\n        obj[attrMatch[1]] = attrMatch[2]; // Adds a matching key-value pair to the object\n      }\n\n      return obj; // Return the parsing result\n    }\n\n    return null; // Returns null if there is no match\n  }\n\n  getCursorTemplateData(state: EditorState) {\n    const markRangeInfo = this.getCursorInMarkNodeRange(state);\n    if (!markRangeInfo) {\n      return;\n    }\n    const { from, to } = markRangeInfo.open;\n    const text = state.sliceDoc(from, to);\n    return this.getData(text);\n  }\n\n  getAllMarksByState(state: EditorState): MarkRangeInfo[] {\n    const marks: MarkRangeInfo[] = [];\n    const tree = syntaxTree(state);\n    const cursor = tree.cursor();\n    do {\n      if (this.isOpenNode(cursor.node, state)) {\n        const open = cursor.node;\n        const close = this.findCloseNode(cursor.node, state);\n        if (close) {\n          marks.push({\n            from: open.from,\n            to: close.to,\n            open: { from: open.from, to: open.to },\n            close: { from: close.from, to: close.to },\n          });\n        }\n      }\n    } while (cursor.next());\n    return marks;\n  }\n\n  getMarkSpecs(state: EditorState): {\n    specs: SelectionEnlargerSpec[];\n    contents: MarkRange[];\n    marks: MarkRangeInfo[];\n  } {\n    const marks = this.getAllMarksByState(state);\n    const specs: SelectionEnlargerSpec[] = [];\n    const contents: MarkRange[] = [];\n    marks.forEach((markRangeInfo: MarkRangeInfo) => {\n      specs.push({\n        source: {\n          from: markRangeInfo.open.from,\n          to: markRangeInfo.open.to,\n        },\n        target: {\n          from: markRangeInfo.from,\n          to: markRangeInfo.to,\n        },\n      });\n      specs.push({\n        source: {\n          from: markRangeInfo.close.from,\n          to: markRangeInfo.close.to,\n        },\n        target: {\n          from: markRangeInfo.from,\n          to: markRangeInfo.to,\n        },\n      });\n      contents.push({\n        from: markRangeInfo.open.to,\n        to: markRangeInfo.close.from,\n      });\n    });\n    return { specs, contents, marks };\n  }\n\n  /**\n   * Modify the template data for the current cursor position: {#slot placeholder = \"default_placeholder\" #} Modify to {#slot placeholder = \"new_placeholder\" #}\n   * Added: {#slot placeholder = \"default_placeholder\" #} Added {#slot value = \"new_value\" placeholder = \"new_placeholder\" #}\n   */\n  updateCursorTemplateData(editor: EditorAPI, data: { [key: string]: string }) {\n    const { state } = editor.$view;\n    const markRangeInfo = this.getCursorInMarkNodeRange(state);\n    if (!markRangeInfo) {\n      return;\n    }\n    const { from, to } = markRangeInfo.open;\n    const text = state.sliceDoc(from, to);\n    const preData = this.getData(text);\n    const newData = { ...preData, ...data };\n    if (!preData) {\n      this.addCursorTemplateData(editor, newData);\n      return;\n    }\n    const newText = this.generateOpenTemplateByData(newData);\n    editor.$view.dispatch({\n      changes: {\n        from,\n        to,\n        insert: newText,\n      },\n    });\n  }\n  addCursorTemplateData(editor: EditorAPI, data: { [key: string]: string }) {\n    const { state } = editor.$view;\n    const markRangeInfo = this.getCursorInMarkNodeRange(state);\n    if (!markRangeInfo) {\n      return;\n    }\n    const { from, to } = markRangeInfo.open;\n    const text = state.sliceDoc(from, to);\n    const preData = this.getData(text);\n    const newData = { ...preData, ...data };\n    const newText = this.generateOpenTemplateByData(newData);\n    editor.replaceTextByRange({\n      from,\n      to,\n      text: newText,\n    });\n  }\n  generateOpenTemplateByData(data: { [key: string]: string }) {\n    const keys = Object.keys(data);\n    const values = Object.values(data);\n    const text = keys\n      .map((key, index) => `${key}=\"${values[index]}\"`)\n      .join(' ');\n    return `{#${this.mark} ${text}#}`;\n  }\n  generateTemplate({\n    content,\n    data,\n  }: {\n    content: string;\n    data: { [key: string]: string };\n  }) {\n    const openTemplate = this.generateOpenTemplateByData(data);\n    const closeTemplate = `{#/${this.mark}#}`;\n    return `${openTemplate}${content}${closeTemplate}`;\n  }\n  generateTemplateJson({\n    content,\n    data,\n  }: {\n    content: string;\n    data: { [key: string]: string };\n  }) {\n    const openTemplate = this.generateOpenTemplateByData(data);\n    const closeTemplate = `{#/${this.mark}#}`;\n    const textContent = this.extractTemplateContent(content);\n    return {\n      open: openTemplate,\n      close: closeTemplate,\n      textContent,\n      template: `${openTemplate}${content}${closeTemplate}`,\n    };\n  }\n  updateCursorTemplateContent(editor: EditorAPI, content: string) {\n    const { state } = editor.$view;\n    const markRangeInfo = this.getCursorInMarkNodeRange(state);\n    if (!markRangeInfo) {\n      return;\n    }\n    editor.replaceTextByRange({\n      from: markRangeInfo.open.to,\n      to: markRangeInfo.close.from,\n      text: content,\n    });\n  }\n  getCursorTemplateContent(editor: EditorAPI) {\n    const { state } = editor.$view;\n    const markRangeInfo = this.getCursorInMarkNodeRange(state);\n    if (!markRangeInfo) {\n      return;\n    }\n    return state.sliceDoc(markRangeInfo.open.to, markRangeInfo.close.from);\n  }\n\n  insertTemplateByCursor(editor: EditorAPI, template: string) {\n    const { state } = editor.$view;\n    const cursorPosition = state.selection.main.head;\n    if (!cursorPosition) {\n      return;\n    }\n    editor.$view.dispatch({\n      changes: {\n        from: cursorPosition,\n        to: cursorPosition,\n        insert: template,\n      },\n    });\n  }\n\n  insertTemplateByRange(\n    editor: EditorAPI,\n    template: string,\n    range: { from: number; to: number },\n  ) {\n    const { from, to } = range;\n    editor.$view.dispatch({\n      changes: {\n        from,\n        to,\n        insert: template,\n      },\n    });\n  }\n  // Extract the content in the template {#InputSlot placeholder = \"placeholder\" #} 123 {#/InputSlot #} xxx, all the internal content under the nested template\n  extractTemplateContent(template: string) {\n    // Use regular expressions to match parts of {#InputSlot... #}\n    const regex = new RegExp(\n      `\\\\{#${this.mark}\\\\s+[^#]+#\\\\}|\\\\{#\\\\/${this.mark}#\\\\}`,\n      'g',\n    );\n    // Use the replace method to replace the matching part\n    const result = template.replace(regex, '');\n    console.log('extractTemplateContent', result);\n    return result;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect } from 'react';\n\nimport { useInjector } from '@coze-editor/editor/react';\n\nimport { type Extension } from '../types';\n\nexport const ThemeExtension: React.FC<{\n  themes: Extension[];\n}> = ({ themes }) => {\n  const injector = useInjector();\n  useLayoutEffect(() => injector.inject(themes), [injector, themes]);\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { type CSSProperties } from 'react';\n\nimport { type CommonFieldProps } from '@coze-arch/coze-design';\n\nexport interface Delta {\n  insert: string;\n}\nexport interface Editor {\n  setHTML: (htmlContent: string) => void;\n  setContent: (content: { deltas: Delta[] }) => void;\n  getContent: () => {\n    deltas: Delta[];\n  };\n  setText: (text: string) => void;\n  getText: () => string;\n  getRootContainer: () => HTMLDivElement | null;\n  getContentState: () => any;\n  selection: any;\n  registerCommand: (command: string, callback: () => void) => void;\n  scrollModule: {\n    scrollTo: (props: any) => void;\n  };\n  on: (event: string, callback: (...args: any[]) => void) => void;\n}\nexport interface EditorHandle {\n  setDeltaContent: (delta?: any) => void;\n  getMarkdown: () => string;\n  getEditor: () => Editor;\n}\nexport interface EditorInputProps extends CommonFieldProps {\n  value?: string;\n  className?: string;\n  style?: CSSProperties;\n  onChange?: (value: string) => void;\n  onFocus?: () => void;\n  onBlur?: () => void;\n  placeholder?: string;\n  validateStatus?: 'error' | 'default';\n  /**\n   * Register custom plugins\n   * @param plugins\n   */\n  registerPlugins?: any;\n  /**\n   * Custom toolbar\n   */\n  registerToolItem?: any;\n  /** Custom schema */\n  schema?: any;\n  businessKey?: string; // To register the toolbar\n  getMentionData?: (query?: string) => Promise<any[]>;\n  maxCount?: number; // Number of characters displayed, default to -1 (unlimited)\n  disabled?: boolean; // disable\n  noToolbar?: boolean; // Hide Toolbar\n  noExpand?: boolean; // Expand icon in lower right corner\n  onExpand?: () => void; // Click expand icon\n  /**\n   * When plainText mode is enabled, the input content will not be different from the native textarea, markdown support will be removed, and toolbar will be hidden (the noToolbar property will be overridden).\n   * @default false\n   */\n  plainText?: boolean;\n  withInputTitle?: {\n    placeholder: string;\n    maxCount?: number;\n    onChange: (value: string) => void;\n  }; // With title editor (similar to Feishu, title and body together)\n\n  getUploadToken?: () => Promise<any>; // Customize to get the token of the uploaded image.\n\n  getImgURL?: (req?: any) => Promise<any>; // Customize to get the picture url according to the picture uri.\n  getEditor?: (editor: Editor) => void;\n}\n\nexport interface IRenderContext {\n  insert: string;\n  domAttributes: {\n    [key: string]: any;\n  };\n  key: string;\n  children: JSX.Element;\n  style: React.CSSProperties;\n  index: number;\n  zoneId: string;\n}\n\nexport interface IApplyMetadata {\n  id: string;\n  type: string;\n  options: any;\n}\n\nexport enum displayType {\n  inline = 'inline',\n  block = 'block',\n}\n\nexport enum ToolbarItemEnum {\n  Bold = 'Bold',\n  Italic = 'Italic',\n  Underline = 'Underline',\n  Undo = 'Undo',\n  Redo = 'Redo',\n  Strikethrough = 'Strikethrough',\n  Blockquote = 'Blockquote',\n  UnorderedList = 'UnorderedList',\n  OrderedList = 'OrderedList',\n  Checkbox = 'Checkbox',\n  Indent = 'Indent',\n  H1 = 'H1',\n  H2 = 'H2',\n  H3 = 'H3',\n  AlignCenter = 'AlignCenter',\n  AlignLeft = 'AlignLeft',\n  AlignRight = 'AlignRight',\n  HorizontalLine = 'HorizontalLine',\n  Hyperlink = 'Hyperlink',\n  Image = 'Image',\n  Table = 'Table',\n  CodeBlock = 'CodeBlock',\n  Video = 'Video',\n  DIVIDER = 'DIVIDER',\n  ColorPicker = 'ColorPicker',\n  FontSizeDropdown = 'FontSizeDropdown',\n  AlignDropdown = 'AlignDropdown',\n  HeadingDropdown = 'HeadingDropdown',\n  FontFamilyDropdown = 'FontFamilyDropdown',\n}\n\nexport const DEFAULT_ZONE = '0';\n\nexport const ZoneDelta: any = {};\n\nexport interface MentionType {\n  avatar_url: string;\n  cn_name: string;\n  en_name: string;\n  type: string;\n  id: string;\n}\n\nexport interface Delta2mdResult {\n  markdown: string;\n  images?: string[];\n  links?: string[];\n  mentions?: MentionType[];\n  codeblocks: string[];\n}\n\nexport class DeltaSet {\n  constructor(public deltas: Delta[]) {\n    this.deltas = deltas;\n  }\n}\n\nexport type DeltaSetOptions =\n  | Delta[]\n  | {\n      [zoneId: string]: {\n        zoneId: string;\n        ops: any;\n        zoneType: any;\n      };\n    };\nexport enum EditorEventType {\n  DID_PASTE = 'didPaste',\n  RESIZE = 'resize',\n  RECT_CHANGE = 'rectchange',\n  SELECTION_CHANGE = 'selectionchange',\n  SELECTION_CHANGE_AND_DOM_UPDATE = 'editorUpdateDomSelection',\n  CONTENT_WILL_CHANGE = 'contentWillChange',\n  CONTENT_CHANGE = 'contentchange',\n  EDITABLE_CHANGE = 'editablechange',\n  PAINT = 'paint',\n  COPY = 'copy',\n  CUT = 'cut',\n  PASTE = 'paste',\n  WILL_DELETE_FROM_CUT = 'willDeleteFromCut',\n  INPUT = 'input',\n  BEFORE_INPUT = 'beforeinput',\n  KEYDOWN = 'keydown',\n  KEYPRESS = 'keypress',\n  KEYUP = 'keyup',\n  EXEC_COMMAND = 'execCommand',\n  ERROR = 'error',\n  DELETE_KEY = 'keyDelete',\n  FOCUS = 'focus',\n  BLUR = 'blur',\n  SCROLL_END = 'scrollend',\n  SCROLL = 'scroll',\n  KEYBAORDCHANGE = 'keyboardchange',\n  COMPOSITION_END = 'compositionend',\n  COMPOSITION_START = 'compositionstart',\n  COMPOSITION_UPDATE = 'compositionupdate',\n  REACT_CONTEXT_UPDATE = 'reactContextUpdate',\n  BEFORE_DOM_RENDERER_RECONCILE = 'beforeDomRendererReconcile',\n  AFTER_DOM_RENDERER_RECONCILE = 'afterDomRendererReconcile',\n  UNDO_DID_INIT = 'undoDidInit',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { type Delta, type Editor } from './types';\n\n/**\n * Empty implementation for open-closed source unification\n * @param md\n * @returns\n */\nexport const md2html = (md: string) => md;\n\nexport const delta2md = (\n  delta: Delta,\n  zoneDelta: unknown,\n  ignoreAttr = false,\n) => ({\n  markdown: delta.insert,\n  images: [],\n  links: [],\n  mentions: [],\n  codeblocks: [],\n});\n\nexport const checkAndGetMarkdown = ({\n  editor,\n}: {\n  editor: Editor;\n  validate: boolean;\n  onImageUploadProgress?: any;\n}) => ({\n  content: editor.getText(),\n  images: [],\n  links: [],\n});\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport const normalizeSchema = (input: any): any => ({\n  '0': {\n    zoneType: input[0]?.zoneType,\n    zoneId: input[0]?.zoneId,\n    ops: input[0]?.ops,\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-extraneous-class */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport type React from 'react';\nimport { lazy } from 'react';\n\nimport { type EditorInputProps } from './types';\nexport {\n  DEFAULT_ZONE,\n  displayType,\n  type EditorInputProps,\n  type EditorHandle,\n  type Delta,\n  type Editor,\n  type IRenderContext,\n  ToolbarItemEnum,\n  ZoneDelta,\n  IApplyMetadata,\n  DeltaSet,\n  DeltaSetOptions,\n  EditorEventType,\n} from './types';\n\nexport const Text: React.FC<any> = () => null;\n\nexport const ToolbarButton: React.FC<any> = () => null;\n\nexport class Plugin {}\n\nexport {\n  md2html,\n  checkAndGetMarkdown,\n  delta2md,\n  normalizeSchema,\n} from './utils';\n\nconst LazyEditorFullInput: React.FC<EditorInputProps> = lazy(() =>\n  import('./editor').then(module => ({\n    default: module.EditorInput,\n  })),\n);\n\nconst LazyEditorFullInputInner: React.FC<EditorInputProps> = lazy(() =>\n  import('./editor').then(module => ({\n    default: module.EditorFullInputInner,\n  })),\n);\n\nexport { LazyEditorFullInput, LazyEditorFullInputInner };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type FormApi } from '@coze-arch/coze-design';\n\nimport { type PromptConfiguratorModalProps } from '../types';\n\nexport interface PromptConfiguratorContextType {\n  props: PromptConfiguratorModalProps;\n  formApiRef: React.RefObject<FormApi>;\n  isReadOnly: boolean;\n}\n\nexport const PromptConfiguratorContext =\n  createContext<PromptConfiguratorContextType | null>(null);\n\nexport const PromptConfiguratorProvider = PromptConfiguratorContext.Provider;\n\nexport const useCreatePromptContext = () =>\n  useContext(PromptConfiguratorContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState, type ComponentProps } from 'react';\n\nimport { withField, FormInput, FormTextArea } from '@coze-arch/coze-design';\n\ninterface PromptInfoInputProps {\n  readonly?: boolean;\n  initCount?: number;\n  value?: string;\n  disabled?: boolean;\n  rows?: number;\n  field: string;\n  label?: string;\n  placeholder?: string;\n  maxLength?: number;\n  maxCount?: number;\n  rules?: ComponentProps<typeof FormInput>['rules'];\n}\n\nexport const PromptInfoInput = (props: PromptInfoInputProps) => {\n  const { initCount, disabled, rows } = props;\n  const [count, setCount] = useState(initCount || 0);\n\n  const handleChange = (v: string) => {\n    setCount(v.length);\n  };\n\n  useEffect(() => {\n    setCount(initCount || 0);\n  }, [initCount]);\n\n  const countSuffix = (\n    <div className=\"overflow-hidden coz-fg-secondary text-sm pr-[9px]\">{`${count}/${props.maxCount}`}</div>\n  );\n\n  if (disabled) {\n    return <ReadonlyInput {...props} />;\n  }\n\n  if (rows && rows > 1) {\n    return (\n      <FormTextArea\n        {...props}\n        autosize\n        autoComplete=\"off\"\n        onChange={(value: string) => handleChange(value)}\n      />\n    );\n  }\n\n  return (\n    <FormInput\n      {...props}\n      autoComplete=\"off\"\n      suffix={countSuffix}\n      onChange={value => handleChange(value)}\n    />\n  );\n};\n\nconst ReadonlyInputCom = (props: PromptInfoInputProps) => {\n  const { value } = props;\n  return (\n    <div className=\"w-full\">\n      <div className=\"coz-fg-secondary text-base break-all whitespace-pre-line\">\n        {value}\n      </div>\n    </div>\n  );\n};\n\nconst ReadonlyInput = withField(ReadonlyInputCom, {\n  valueKey: 'value',\n  onKeyChangeFnName: 'onChange',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit } from '@coze-arch/coze-design/icons';\nimport { Tooltip, Divider, IconButton } from '@coze-arch/coze-design';\ninterface PromptHeaderProps {\n  canEdit: boolean;\n  onEditIconClick?: () => void;\n  mode: 'info' | 'edit' | 'create';\n}\nexport const PromptHeader = ({\n  canEdit,\n  onEditIconClick,\n  mode,\n}: PromptHeaderProps) => {\n  if (mode === 'info' && canEdit) {\n    return (\n      <div className=\"flex items-center justify-between w-full\">\n        <span>{I18n.t('prompt_detail_prompt_detail')}</span>\n        <div className=\"flex items-center \">\n          <Tooltip content={I18n.t('prompt_library_edit')}>\n            <IconButton\n              color=\"secondary\"\n              icon={<IconCozEdit className=\"semi-icon-default\" />}\n              onClick={onEditIconClick}\n              size=\"small\"\n            />\n          </Tooltip>\n          <Divider layout=\"vertical\" className=\"mx-[10px] coz-stroke-primary\" />\n        </div>\n      </div>\n    );\n  }\n  if (mode === 'create') {\n    return <>{I18n.t('creat_new_prompt')}</>;\n  }\n\n  if (mode === 'edit') {\n    return <>{I18n.t('edit_prompt')}</>;\n  }\n\n  return <>{I18n.t('prompt_detail_prompt_detail')}</>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\n\ninterface CloseModalProps {\n  onCancel?: (e: React.MouseEvent) => void;\n}\n\nexport const CloseModal = ({ onCancel }: CloseModalProps) => (\n  <Button color=\"primary\" onClick={onCancel}>\n    {I18n.t('Cancel')}\n  </Button>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\ninterface SavePromptProps {\n  mode: 'info' | 'edit' | 'create';\n  isSubmitting?: boolean;\n  onSubmit?: (e: React.MouseEvent) => void;\n}\n\nexport const SavePrompt = ({\n  mode,\n  isSubmitting,\n  onSubmit,\n}: SavePromptProps) => (\n  <Button loading={isSubmitting} onClick={onSubmit}>\n    {mode === 'info' ? I18n.t('prompt_detail_copy_prompt') : I18n.t('Confirm')}\n  </Button>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\nimport { sendTeaEvent, EVENT_NAMES } from '@coze-arch/bot-tea';\ninterface PromptDiffProps {\n  mode: 'info' | 'edit' | 'create';\n  editor?: EditorAPI;\n  spaceId: string;\n  botId?: string;\n  projectId?: string;\n  workflowId?: string;\n  source: string;\n  submitFun?: (\n    e: React.MouseEvent<Element, MouseEvent>,\n  ) => Promise<{ mode: string; id: string } | undefined>;\n  editId?: string;\n  onDiff?: ({\n    prompt,\n    libraryId,\n  }: {\n    prompt: string;\n    libraryId: string;\n  }) => void;\n  onCancel?: (e: React.MouseEvent<Element, MouseEvent>) => void;\n}\n\nexport const PromptDiff = ({\n  mode,\n  editor,\n  spaceId,\n  botId,\n  projectId,\n  workflowId,\n  source,\n  submitFun,\n  editId,\n  onDiff,\n  onCancel,\n}: PromptDiffProps) => {\n  if (mode === 'info') {\n    return (\n      <Button\n        color=\"primary\"\n        onClick={e => {\n          if (!editId) {\n            return;\n          }\n          onDiff?.({ prompt: editor?.getValue() ?? '', libraryId: editId });\n          sendTeaEvent(EVENT_NAMES.compare_mode_front, {\n            source,\n            space_id: spaceId,\n            action: 'start',\n            compare_type: 'prompts',\n            bot_id: botId,\n            from: 'prompt_resource',\n            project_id: projectId,\n            workflow_id: workflowId,\n          });\n          onCancel?.(e);\n        }}\n      >\n        {I18n.t('compare_prompt_compare_debug')}\n      </Button>\n    );\n  }\n\n  return (\n    <Button\n      color=\"primary\"\n      onClick={async e => {\n        const res = await submitFun?.(e);\n        if (res?.id) {\n          onDiff?.({ prompt: editor?.getValue() ?? '', libraryId: res.id });\n          sendTeaEvent(EVENT_NAMES.compare_mode_front, {\n            source,\n            space_id: spaceId,\n            action: 'start',\n            compare_type: 'prompts',\n            bot_id: botId,\n            from: 'prompt_resource',\n            project_id: projectId,\n            workflow_id: workflowId,\n          });\n        }\n        onCancel?.(e);\n      }}\n    >\n      {I18n.t('creat_prompt_button_comfirm_and_compare')}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-magic-numbers */\n/* eslint-disable max-lines-per-function */\nimport { useEffect, useRef, Suspense, lazy, useState } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useEditor,\n  ActiveLinePlaceholder,\n  Placeholder,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { Modal, Form, Toast, type FormApi } from '@coze-arch/coze-design';\nimport { sendTeaEvent, EVENT_NAMES } from '@coze-arch/bot-tea';\nimport { PlaygroundApi } from '@coze-arch/bot-api';\nimport {\n  LibraryBlockWidget,\n  type ILibraryList,\n} from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport { ActionBar } from '@coze-common/editor-plugins/action-bar';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { PromptEditorRender } from '@/editor';\n\nimport { type PromptConfiguratorModalProps } from './types';\nimport { PromptConfiguratorProvider } from './context';\nimport { PromptInfoInput } from './components/prompt-info-input';\nimport { PromptHeader } from './components/header';\nimport {\n  CloseModal,\n  PromptDiff,\n  SavePrompt,\n} from './components/footer-actions';\n\nimport styles from './index.module.less';\n\nconst MAX_NAME_LENGTH = IS_OVERSEA ? 40 : 20;\nconst MAX_DESCRIPTION_LENGTH = IS_OVERSEA ? 100 : 50;\n\nconst NAME_ROW_LENGTH = 1;\nconst DESCRIPTION_ROW_LENGTH = IS_OVERSEA ? 2 : 1;\n\ninterface PromptValues {\n  id?: string;\n  name: string;\n  description: string;\n  prompt_text?: string;\n}\nconst EMPTY_LIBRARY: ILibraryList = [];\n\nconst ReactMarkdown = lazy(() => import('react-markdown'));\n/* eslint-disable @coze-arch/max-line-per-function */\nexport const PromptConfiguratorModal = (\n  props: PromptConfiguratorModalProps,\n) => {\n  const {\n    mode,\n    editId,\n    spaceId,\n    botId,\n    projectId,\n    workflowId,\n    canEdit,\n    onUpdateSuccess,\n    promptSectionConfig,\n    enableDiff,\n    onDiff,\n    defaultPrompt,\n    source,\n    containerAppendSlot,\n  } = props;\n  const formApiRef = useRef<FormApi | null>(null);\n  const editor = useEditor<EditorAPI>();\n  const [modalMode, setModalMode] = useState<'info' | 'edit' | 'create'>(mode);\n  const [errMsg, setErrMsg] = useState('');\n  const isSubmiting = useRef(false);\n  const [actionBarVisible, setActionBarVisible] = useState(false);\n  const selectionInInputSlotRef = useRef(false);\n  const isReadOnly = modalMode === 'info';\n  const {\n    editorPlaceholder,\n    editorActions,\n    headerActions,\n    editorActiveLinePlaceholder,\n    editorExtensions,\n  } = promptSectionConfig ?? {};\n  const [formValues, setFormValues] = useState<PromptValues>({\n    name: '',\n    description: '',\n    prompt_text: '',\n  });\n  const handleSubmit = async (e: React.MouseEvent<Element, MouseEvent>) => {\n    if (isSubmiting.current) {\n      return;\n    }\n    const submitValues = await formApiRef.current?.validate();\n    if (!submitValues) {\n      return;\n    }\n    isSubmiting.current = true;\n    if (modalMode === 'info') {\n      handleInfoModeAction();\n      return;\n    }\n\n    if (modalMode === 'create' || modalMode === 'edit') {\n      const result = await handleUpdateModeAction(e);\n      isSubmiting.current = false;\n      sendTeaEvent(EVENT_NAMES.prompt_library_front, {\n        bot_id: botId,\n        project_id: projectId,\n        workflow_id: workflowId,\n        space_id: spaceId,\n        prompt_id: result?.id ?? '',\n        prompt_type: 'workspace',\n        action: mode,\n        source,\n      });\n      return result;\n    }\n    isSubmiting.current = false;\n  };\n  const handleInfoModeAction = () => {\n    const promptText = editor?.getValue();\n    navigator.clipboard.writeText(promptText ?? '');\n    Toast.success(I18n.t('prompt_library_prompt_copied_successfully'));\n  };\n  const handleUpdateModeAction = async (\n    e: React.MouseEvent<Element, MouseEvent>,\n  ) => {\n    try {\n      const submitValues = await formApiRef.current?.validate();\n      if (!submitValues) {\n        return;\n      }\n      const res = await PlaygroundApi.UpsertPromptResource(\n        {\n          prompt: {\n            ...submitValues,\n            space_id: spaceId,\n            ...(modalMode === 'edit' && { id: editId }),\n          },\n        },\n        {\n          __disableErrorToast: true,\n        },\n      );\n      props.onCancel?.(e);\n      const id = modalMode === 'edit' ? editId : res?.data?.id;\n      if (mode === 'create') {\n        Toast.success(I18n.t('prompt_library_prompt_creat_successfully'));\n      }\n      onUpdateSuccess?.(mode, id);\n      if (!id) {\n        return;\n      }\n      return {\n        mode,\n        id,\n      };\n    } catch (error) {\n      setErrMsg((error as Error).message);\n    }\n  };\n  useEffect(() => {\n    if (!defaultPrompt || !editor) {\n      return;\n    }\n    editor?.$view.dispatch({\n      changes: {\n        from: 0,\n        to: editor.$view.state.doc.length,\n        insert: defaultPrompt,\n      },\n    });\n  }, [defaultPrompt, editor]);\n\n  useEffect(() => {\n    if (!editId || !editor) {\n      return;\n    }\n    PlaygroundApi.GetPromptResourceInfo({\n      prompt_resource_id: editId,\n    }).then(\n      ({ data: { name = '', description = '', prompt_text = '' } = {} }) => {\n        formApiRef.current?.setValues({\n          prompt_text,\n          name,\n          description,\n        });\n        editor?.$view.dispatch({\n          changes: {\n            from: 0,\n            to: editor.$view.state.doc.length,\n            insert: prompt_text,\n          },\n        });\n        setFormValues({\n          name,\n          description,\n          prompt_text,\n        });\n      },\n    );\n  }, [editId, modalMode, editor]);\n\n  return (\n    <PromptConfiguratorProvider\n      value={{\n        props,\n        formApiRef,\n        isReadOnly,\n      }}\n    >\n      <Modal\n        title={\n          <PromptHeader\n            canEdit={!!canEdit}\n            mode={modalMode}\n            onEditIconClick={() => {\n              setModalMode('edit');\n            }}\n          />\n        }\n        closeOnEsc={false}\n        maskClosable={false}\n        visible\n        width=\"640px\"\n        footer={\n          <div className=\"flex items-center justify-end\">\n            {enableDiff ? (\n              <PromptDiff\n                spaceId={spaceId}\n                botId={botId}\n                projectId={projectId}\n                workflowId={workflowId}\n                source={source}\n                mode={modalMode}\n                editor={editor}\n                submitFun={handleSubmit}\n                editId={editId}\n                onDiff={({ prompt, libraryId }) => {\n                  onDiff?.({ prompt, libraryId });\n                }}\n                onCancel={e => {\n                  props.onCancel?.(e);\n                }}\n              />\n            ) : (\n              <CloseModal onCancel={props.onCancel} />\n            )}\n            <SavePrompt\n              mode={modalMode}\n              isSubmitting={isSubmiting.current}\n              onSubmit={handleSubmit}\n            />\n          </div>\n        }\n        onCancel={props.onCancel}\n        className={styles['prompt-configurator-modal']}\n      >\n        <div className=\"flex flex-col gap-4\">\n          <div>\n            <Form<PromptValues>\n              getFormApi={formApi => {\n                formApiRef.current = formApi;\n              }}\n            >\n              <PromptInfoInput\n                disabled={modalMode === 'info'}\n                label={I18n.t('creat_new_prompt_prompt_name')}\n                placeholder={I18n.t('creat_new_prompt_name_placeholder')}\n                maxLength={MAX_NAME_LENGTH}\n                maxCount={MAX_NAME_LENGTH}\n                initCount={formValues.name.length}\n                rows={NAME_ROW_LENGTH}\n                rules={[\n                  {\n                    required: !isReadOnly,\n                    message: I18n.t('creat_new_prompt_name_placeholder'),\n                  },\n                ]}\n                field=\"name\"\n              />\n              <PromptInfoInput\n                disabled={modalMode === 'info'}\n                label={I18n.t('creat_new_prompt_prompt_description')}\n                placeholder={I18n.t('creat_new_prompt_des_placeholder')}\n                maxLength={MAX_DESCRIPTION_LENGTH}\n                maxCount={MAX_DESCRIPTION_LENGTH}\n                initCount={formValues.description.length}\n                rows={DESCRIPTION_ROW_LENGTH}\n                field=\"description\"\n              />\n              <div className=\"flex flex-col gap-1\">\n                <div className=\"flex justify-between items-center\">\n                  <Form.Label\n                    text={I18n.t('creat_new_prompt_prompt')}\n                    className=\"mb-0\"\n                  />\n                  {headerActions}\n                </div>\n                <div\n                  className={classNames(\n                    'rounded-lg border border-solid coz-stroke-plus h-[400px] overflow-y-auto styled-scrollbar hover-show-scrollbar',\n                  )}\n                >\n                  <PromptEditorRender\n                    readonly={modalMode === 'info'}\n                    options={{\n                      minHeight: 300,\n                    }}\n                    onChange={value => {\n                      formApiRef.current?.setValue('prompt_text', value);\n                    }}\n                  />\n                  <InputSlotWidget\n                    mode=\"configurable\"\n                    onSelectionInInputSlot={selection => {\n                      selectionInInputSlotRef.current = !!selection;\n                    }}\n                  />\n                  <LibraryBlockWidget\n                    librarys={EMPTY_LIBRARY}\n                    readonly\n                    spaceId={spaceId}\n                  />\n                  <ActionBar\n                    trigger=\"custom\"\n                    visible={actionBarVisible}\n                    onVisibleChange={visible => {\n                      if (selectionInInputSlotRef.current) {\n                        return;\n                      }\n                      setActionBarVisible(visible);\n                    }}\n                  >\n                    {editorActions}\n                  </ActionBar>\n                  <Placeholder>{editorPlaceholder}</Placeholder>\n                  <ActiveLinePlaceholder>\n                    {editorActiveLinePlaceholder}\n                  </ActiveLinePlaceholder>\n                  {editorExtensions}\n                </div>\n              </div>\n            </Form>\n            {errMsg ? (\n              <div className=\"text-red\">\n                <Suspense fallback={null}>\n                  <ReactMarkdown skipHtml={true} linkTarget=\"_blank\">\n                    {errMsg}\n                  </ReactMarkdown>\n                </Suspense>\n              </div>\n            ) : null}\n          </div>\n        </div>\n      </Modal>\n      {containerAppendSlot}\n    </PromptConfiguratorProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { useState } from 'react';\n\nimport { PromptEditorProvider } from '@/editor';\n\nimport { type PromptConfiguratorModalProps } from './types';\nimport { PromptConfiguratorModal } from './prompt-configurator-modal';\ntype DynamicProps = Pick<\n  PromptConfiguratorModalProps,\n  'mode' | 'editId' | 'canEdit' | 'defaultPrompt'\n>;\n\nexport type UsePromptConfiguratorModalProps = Pick<\n  PromptConfiguratorModalProps,\n  | 'spaceId'\n  | 'getConversationId'\n  | 'getPromptContextInfo'\n  | 'onUpdateSuccess'\n  | 'importPromptWhenEmpty'\n  | 'onDiff'\n  | 'enableDiff'\n  | 'isPersonal'\n  | 'source'\n  | 'botId'\n  | 'projectId'\n  | 'workflowId'\n> &\n  Partial<DynamicProps> & {\n    CustomPromptConfiguratorModal?: (\n      props: PromptConfiguratorModalProps,\n    ) => React.JSX.Element;\n  };\nexport const usePromptConfiguratorModal = (\n  props: UsePromptConfiguratorModalProps,\n) => {\n  const { CustomPromptConfiguratorModal = PromptConfiguratorModal } = props;\n  const [visible, setVisible] = useState(false);\n  const [dynamicProps, setDynamicProps] = useState<DynamicProps>({\n    mode: 'create',\n    editId: '',\n    canEdit: true,\n    defaultPrompt: '',\n  });\n\n  const close = () => {\n    setVisible(false);\n  };\n  const open = (\n    options: Pick<\n      PromptConfiguratorModalProps,\n      'mode' | 'editId' | 'canEdit' | 'defaultPrompt'\n    >,\n  ) => {\n    setVisible(true);\n    setDynamicProps(options);\n  };\n  return {\n    node: visible ? (\n      <PromptEditorProvider>\n        <CustomPromptConfiguratorModal\n          {...props}\n          {...dynamicProps}\n          onCancel={close}\n        />\n      </PromptEditorProvider>\n    ) : null,\n    close,\n    open,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useCreatePromptContext } from '@/create-prompt/context';\n\nexport const ImportPromptWhenEmptyPlaceholder = () => {\n  const editor = useEditor<EditorAPI>();\n  const { props, formApiRef } = useCreatePromptContext() || {};\n  const { importPromptWhenEmpty } = props || {};\n\n  return importPromptWhenEmpty ? (\n    <div\n      className=\"coz-fg-hglt text-sm cursor-pointer mt-1\"\n      onClick={() => {\n        editor?.$view.dispatch({\n          changes: {\n            from: 0,\n            to: editor.$view.state.doc.length,\n            insert: importPromptWhenEmpty,\n          },\n        });\n        formApiRef?.current?.setValue('prompt_text', importPromptWhenEmpty);\n      }}\n    >\n      {I18n.t('creat_new_prompt_import_link')}\n    </div>\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect, type PropsWithChildren } from 'react';\n\nimport { useLocalStorageState } from 'ahooks';\nimport { useEditor, useInjector } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { insertInputSlot } from '@coze-common/editor-plugins/actions';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInputSlot } from '@coze-arch/coze-design/icons';\nimport { Button, Tooltip } from '@coze-arch/coze-design';\nimport { type ButtonProps } from '@coze-arch/coze-design';\nimport { keymap } from '@codemirror/view';\n\nimport { useReadonly } from '../../shared/hooks/use-editor-readonly';\nimport InsertBlankSlotGuideEn from '../../assets/insert-blank-slot-guide-en.png';\nimport InsertBlankSlotGuideCn from '../../assets/insert-blank-slot-guide-cn.png';\nimport BlankSlotShortCutIcon from '../../assets/blank-slot-shortcut-icon.png';\ntype NlPromptActionProps = Pick<ButtonProps, 'className'> & {\n  disabled?: boolean;\n};\nexport const InsertInputSlotButton: React.FC<NlPromptActionProps> = props => {\n  const { className, disabled } = props;\n  const editor = useEditor<EditorAPI | undefined>();\n  const readonly = useReadonly();\n  const injector = useInjector();\n  const [showActionGuide, setShowActionGuide] = useLocalStorageState(\n    insertInputSlotTooltipGuideKey,\n    {\n      defaultValue: true,\n    },\n  );\n\n  useLayoutEffect(\n    () =>\n      injector.inject([\n        keymap.of([\n          {\n            key: 'Cmd-k',\n            run() {\n              if (!editor || readonly || disabled) {\n                return false;\n              }\n              insertInputSlot(editor);\n              return false;\n            },\n          },\n        ]),\n      ]),\n    [injector, editor, readonly, disabled],\n  );\n\n  return (\n    <div className=\"hover:coz-mg-secondary-hovered coz-icon-button coz-icon-button-default rounded-little\">\n      <GuideTooltip showActionGuide={!!showActionGuide}>\n        <Button\n          color=\"primary\"\n          size=\"small\"\n          disabled={readonly || disabled}\n          icon={<IconCozInputSlot />}\n          className={className}\n          onMouseDown={e => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n          onClick={e => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (!editor || readonly) {\n              return;\n            }\n            setShowActionGuide(false);\n            insertInputSlot(editor);\n          }}\n        >\n          {I18n.t('creat_new_prompt_edit_block')}\n        </Button>\n      </GuideTooltip>\n    </div>\n  );\n};\n\nconst insertInputSlotTooltipGuideKey = 'insert_input_slot_tooltip_guide';\n\nconst GuideTooltip: React.FC<\n  PropsWithChildren<{\n    showActionGuide: boolean;\n  }>\n> = ({ showActionGuide, children }) => {\n  if (showActionGuide) {\n    return (\n      <Tooltip\n        content={\n          <div className=\"flex flex-col\">\n            <img\n              className=\"w-full h-auto\"\n              src={\n                IS_CN_REGION ? InsertBlankSlotGuideCn : InsertBlankSlotGuideEn\n              }\n            />\n            <div className=\"flex flex-col mt-2 p-2 gap-1\">\n              <div className=\"flex items-center justify-between \">\n                <span className=\"text-xxl font-medium\">\n                  {I18n.t('edit_block_guild_title')}\n                </span>\n                <img src={BlankSlotShortCutIcon} className=\"w-[33px] h-5\" />\n              </div>\n              <div className=\"text-sm coz-fg-primary\">\n                {I18n.t('edit_block_guild_describe')}\n              </div>\n            </div>\n          </div>\n        }\n        className=\"!w-[301px] !max-w-[301px]\"\n      >\n        {children}\n      </Tooltip>\n    );\n  }\n  return (\n    <Tooltip\n      content={\n        <div\n          className=\"coz-fg-primary text-sm\"\n          style={{\n            fontFamily: '-apple-system, SF Pro',\n          }}\n        >\n           K\n        </div>\n      }\n      className=\"coz-fg-primary text-sm\"\n    >\n      {children}\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCursorInInputSlot } from '@coze-common/editor-plugins/input-slot';\nimport {\n  PromptConfiguratorModal as BasePromptConfiguratorModal,\n  type PromptConfiguratorModalProps,\n  ImportPromptWhenEmptyPlaceholder,\n  useCreatePromptContext,\n  InsertInputSlotButton,\n} from '@coze-common/prompt-kit-base/create-prompt';\n\nexport { usePromptConfiguratorModal } from '@coze-common/prompt-kit-base/create-prompt';\n\nexport const PromptConfiguratorModal = (\n  props: PromptConfiguratorModalProps,\n) => {\n  const { isReadOnly } = useCreatePromptContext() || {};\n  const inInputSlot = useCursorInInputSlot();\n  return (\n    <BasePromptConfiguratorModal\n      {...props}\n      promptSectionConfig={{\n        editorPlaceholder: <ImportPromptWhenEmptyPlaceholder />,\n        editorActions: <InsertInputSlotButton disabled={inInputSlot} />,\n        headerActions: !isReadOnly ? (\n          <div className=\"flex gap-2\">\n            <div>\n              <InsertInputSlotButton disabled={inInputSlot} />\n            </div>\n          </div>\n        ) : null,\n      }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  usePromptConfiguratorModal as BaseUsePromptConfiguratorModal,\n  type UsePromptConfiguratorModalProps,\n} from '@coze-common/prompt-kit-base/create-prompt';\n\nimport { PromptConfiguratorModal } from './prompt-configurator-modal';\n\nexport const usePromptConfiguratorModal = (\n  props: UsePromptConfiguratorModalProps,\n) =>\n  BaseUsePromptConfiguratorModal({\n    ...props,\n    CustomPromptConfiguratorModal: PromptConfiguratorModal,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect } from 'react';\n\nimport { useInjector } from '@coze-editor/editor/react';\nimport { astDecorator } from '@coze-editor/editor';\nimport { EditorView } from '@codemirror/view';\n\nconst prec = 'lowest';\n\nfunction Markdown() {\n  const injector = useInjector();\n\n  useLayoutEffect(\n    () =>\n      injector.inject([\n        astDecorator.whole.of(cursor => {\n          // # heading\n          if (cursor.name.startsWith('ATXHeading')) {\n            return {\n              type: 'className',\n              className: 'markdown-heading',\n              prec,\n            };\n          }\n\n          // *italic*\n          if (cursor.name === 'Emphasis') {\n            return {\n              type: 'className',\n              className: 'markdown-emphasis',\n              prec,\n            };\n          }\n\n          // **bold**\n          if (cursor.name === 'StrongEmphasis') {\n            return {\n              type: 'className',\n              className: 'markdown-strong-emphasis',\n              prec,\n            };\n          }\n\n          // -\n          // 1.\n          // >\n          if (cursor.name === 'ListMark' || cursor.name === 'QuoteMark') {\n            return {\n              type: 'className',\n              className: 'markdown-mark',\n              prec,\n            };\n          }\n        }),\n        EditorView.theme({\n          '.markdown-heading': {\n            color: '#00818C',\n            fontWeight: '500',\n          },\n          '.markdown-emphasis': {\n            fontStyle: 'italic',\n          },\n          '.markdown-strong-emphasis': {\n            fontWeight: 'bold',\n          },\n          '.markdown-mark': {\n            color: '#4E40E5',\n          },\n        }),\n      ]),\n    [injector],\n  );\n\n  return null;\n}\n\nexport { Markdown };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect } from 'react';\n\nimport { useInjector } from '@coze-editor/editor/react';\nimport { astDecorator } from '@coze-editor/editor';\nimport { EditorView } from '@codemirror/view';\n\nconst prec = 'lowest';\n\nfunction Jinja() {\n  const injector = useInjector();\n\n  useLayoutEffect(\n    () =>\n      injector.inject([\n        astDecorator.whole.of(cursor => {\n          if (\n            cursor.name === 'JinjaStatement' ||\n            cursor.name === 'JinjaRawOpenStatement' ||\n            cursor.name === 'JinjaRawCloseStatement'\n          ) {\n            return {\n              type: 'className',\n              className: 'jinja-statement',\n              prec,\n            };\n          }\n\n          if (cursor.name === 'JinjaStringLiteral') {\n            return {\n              type: 'className',\n              className: 'jinja-string',\n              prec,\n            };\n          }\n\n          if (cursor.name === 'JinjaComment') {\n            return {\n              type: 'className',\n              className: 'jinja-comment',\n              prec,\n            };\n          }\n\n          if (cursor.name === 'JinjaExpression') {\n            return {\n              type: 'className',\n              className: 'jinja-expression',\n              prec,\n            };\n          }\n\n          if (\n            cursor.name === 'JinjaFilterName' ||\n            cursor.name === 'JinjaStatementStart' ||\n            cursor.name === 'JinjaStatementEnd' ||\n            cursor.name === 'JinjaKeyword' ||\n            cursor.name === 'JinjaFilterName'\n          ) {\n            return {\n              type: 'className',\n              className: 'jinja-statement-keyword',\n              prec,\n            };\n          }\n        }),\n        EditorView.theme({\n          '.jinja-statement': {\n            color: '#060709CC',\n          },\n          '.jinja-statement-keyword': {\n            color: '#D1009D',\n          },\n          '.jinja-string': {\n            color: '#060709CC',\n          },\n          '.jinja-comment': {\n            color: '#0607094D',\n          },\n          '.jinja-expression': {\n            color: '#4E40E5',\n          },\n        }),\n      ]),\n    [injector],\n  );\n\n  return null;\n}\n\nexport { Jinja };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect } from 'react';\n\nimport { useInjector } from '@coze-editor/editor/react';\nimport { languageSupport } from '@coze-editor/editor/preset-prompt';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction LanguageSupport() {\n  const injector = useInjector();\n\n  useLayoutEffect(() => injector.inject([languageSupport]), [injector]);\n\n  return null;\n}\n\nexport { LanguageSupport };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Extension } from '@coze-common/editor-plugins/types';\nimport { EditorView } from '@codemirror/view';\n\nexport const defaultTheme: Extension = EditorView.theme({\n  '.cm-content': {\n    color: 'rgba(6, 7, 9, 0.80)',\n  },\n  '.cm-line': {\n    lineHeight: '24px',\n    paddingLeft: '12px',\n  },\n  '.cm-cursor': {\n    height: '20px !important',\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useRef, useEffect, type ReactNode, useMemo } from 'react';\n\nimport { merge } from 'lodash-es';\nimport { Renderer, Placeholder, useEditor } from '@coze-editor/editor/react';\n// promptPreset is a collection of built-in extensions for Prompt\nimport promptPreset, {\n  type EditorAPI,\n} from '@coze-editor/editor/preset-prompt';\nimport { ThemeExtension } from '@coze-common/editor-plugins/theme';\nimport { SyntaxHighlight } from '@coze-common/editor-plugins/syntax-highlight';\nimport { LanguageSupport } from '@coze-common/editor-plugins/language-support';\n\nimport { defaultTheme } from '@/theme/default';\n\nexport interface PromptEditorRenderProps {\n  readonly?: boolean; // All insert editor related operations are disabled: action-bar\n  placeholder?: ReactNode;\n  className?: string;\n  dataTestID?: string;\n  defaultValue?: string;\n  fontSize?: number;\n  value?: string;\n  onChange?: (value: string) => void;\n  onFocus?: () => void;\n  /**\n   * Cursor focus lost\n   */\n  onBlur?: () => void;\n  options?: Record<string, string | number>;\n  isControled?: boolean; // Is it controlled\n  getEditor?: (editor: EditorAPI) => void;\n}\n\nexport const PromptEditorRender: React.FC<PromptEditorRenderProps> = props => {\n  const {\n    readonly,\n    placeholder,\n    defaultValue,\n    className,\n    dataTestID,\n    value,\n    onChange,\n    onFocus,\n    onBlur,\n    options,\n    isControled,\n    getEditor,\n  } = props;\n  const apiRef = useRef<EditorAPI | null>(null);\n  const editor = useEditor<EditorAPI>();\n\n  useEffect(() => {\n    if (!editor || !onBlur) {\n      return;\n    }\n\n    editor.$on('blur', onBlur);\n\n    return () => {\n      editor.$off('blur', onBlur);\n    };\n  }, [editor, onBlur]);\n\n  useEffect(() => {\n    if (!editor || !onFocus) {\n      return;\n    }\n\n    editor.$on('focus', onFocus);\n\n    return () => {\n      editor.$off('focus', onFocus);\n    };\n  }, [editor, onFocus]);\n\n  // value controlled\n  useEffect(() => {\n    const curEditor = apiRef.current;\n\n    if (!curEditor || !isControled || !editor) {\n      return;\n    }\n\n    const preVal = curEditor.getValue();\n    if (typeof value === 'string' && value !== preVal) {\n      editor.$view.dispatch({\n        changes: {\n          from: 0,\n          to: editor.$view.state.doc.length,\n          insert: value ?? '',\n        },\n      });\n    }\n  }, [isControled, value, editor]);\n\n  const handleChange = useCallback(\n    (e: { value: string }) => {\n      if (typeof onChange === 'function') {\n        onChange(e.value);\n      }\n    },\n    [onChange],\n  );\n\n  const contentAttributes = useMemo(\n    () => ({\n      class: className ?? '',\n      'data-testid': dataTestID ?? '',\n    }),\n    [className, dataTestID],\n  );\n\n  return (\n    <>\n      <Renderer\n        plugins={promptPreset}\n        defaultValue={defaultValue}\n        options={merge(\n          {\n            fontSize: 14,\n            contentAttributes,\n            editable: !readonly,\n            readOnly: readonly,\n          },\n          options,\n        )}\n        onChange={handleChange}\n        didMount={api => {\n          apiRef.current = api;\n          if (getEditor) {\n            getEditor(api);\n          }\n        }}\n      />\n      <Placeholder>{placeholder}</Placeholder>\n      <ThemeExtension themes={[defaultTheme]} />\n      <LanguageSupport />\n      <SyntaxHighlight.Markdown />\n      <SyntaxHighlight.Jinja />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { EditorProvider } from '@coze-editor/editor/react';\n\nexport const PromptEditorProvider: React.FC<PropsWithChildren> = ({\n  children,\n}) => <EditorProvider>{children}</EditorProvider>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { type ViewUpdate } from '@codemirror/view';\nexport const useReadonly = () => {\n  const editor = useEditor<EditorAPI>();\n  const [isReadOnly, setIsReadOnly] = useState(false);\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    setIsReadOnly(editor.$view.state.readOnly);\n    const handleViewUpdate = (update: ViewUpdate) => {\n      if (update.startState.readOnly !== update.state.readOnly) {\n        setIsReadOnly(update.state.readOnly);\n      }\n    };\n    editor.$on('viewUpdate', handleViewUpdate);\n    return () => {\n      editor.$off('viewUpdate', handleViewUpdate);\n    };\n  }, [editor]);\n  return isReadOnly;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\n\nexport const insertToNewline = async ({\n  editor,\n  prompt,\n}: {\n  editor?: EditorAPI;\n  prompt: string;\n}): Promise<string> => {\n  if (!editor) {\n    return '';\n  }\n  const { state } = editor.$view;\n  const isDocEmpty = state.doc.length === 0;\n  const insertPrompt = isDocEmpty ? prompt : `\\n${prompt}`;\n  const selection = isDocEmpty\n    ? undefined\n    : {\n        anchor: state.doc.length,\n        head: state.doc.length + insertPrompt.length,\n      };\n\n  editor.$view.dispatch({\n    changes: {\n      from: state.doc.length,\n      to: state.doc.length,\n      insert: insertPrompt,\n    },\n    selection,\n    scrollIntoView: true,\n  });\n  // Wait for the next microtask cycle to ensure that the status has been updated\n  await Promise.resolve();\n\n  // Use the updated state to get the latest document content\n  const newDoc = editor.$view.state.doc.toString();\n\n  // Insert to new line\n  // Note: This operation will trigger a chrome bug in advance, resulting in a crash\n  editor.focus();\n  return newDoc;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum ActionKey {\n  /**  */\n  Copy = 1,\n  /**  */\n  Delete = 2,\n  /** / */\n  EnableSwitch = 3,\n  /**  */\n  Edit = 4,\n  /** funcflow */\n  SwitchToFuncflow = 8,\n  /** chatflow */\n  SwitchToChatflow = 9,\n  /**  */\n  CrossSpaceCopy = 10,\n}\n\nexport enum CopyStatus {\n  Successful = 1,\n  Processing = 2,\n  Failed = 3,\n  /** KeepOriginTarget */\n  KeepOrigin = 4,\n  /** -> */\n  Deleted = 5,\n}\n\nexport enum ProjectResourceActionKey {\n  /**  */\n  Rename = 1,\n  /** / */\n  Copy = 2,\n  /**  */\n  CopyToLibrary = 3,\n  /**  */\n  MoveToLibrary = 4,\n  /**  */\n  Delete = 5,\n  /**  */\n  Enable = 6,\n  /**  */\n  Disable = 7,\n  /** funcflow */\n  SwitchToFuncflow = 8,\n  /** chatflow */\n  SwitchToChatflow = 9,\n  /**  */\n  UpdateDesc = 10,\n}\n\nexport enum ProjectResourceGroupType {\n  Workflow = 1,\n  Plugin = 2,\n  Data = 3,\n}\n\nexport enum PublishStatus {\n  /**  */\n  UnPublished = 1,\n  /**  */\n  Published = 2,\n}\n\nexport enum ResourceCopyScene {\n  /**  */\n  CopyProjectResource = 1,\n  /** Library */\n  CopyResourceToLibrary = 2,\n  /** Library */\n  MoveResourceToLibrary = 3,\n  /** Library */\n  CopyResourceFromLibrary = 4,\n  /**  */\n  CopyProject = 5,\n  /**  */\n  PublishProject = 6,\n  /**  */\n  CopyProjectTemplate = 7,\n  /**  */\n  PublishProjectTemplate = 8,\n  /**  */\n  LaunchTemplate = 9,\n  /**  */\n  ArchiveProject = 10,\n  /**  */\n  RollbackProject = 11,\n  /**  */\n  CrossSpaceCopy = 12,\n  /**  */\n  CrossSpaceCopyProject = 13,\n}\n\nexport enum ResType {\n  Plugin = 1,\n  Workflow = 2,\n  Imageflow = 3,\n  Knowledge = 4,\n  UI = 5,\n  Prompt = 6,\n  Database = 7,\n  Variable = 8,\n  Voice = 9,\n}\n\nexport enum SyncOperation {\n  Upsert = 1,\n  Delete = 2,\n}\n\n/** struct ResourceCopyExtraInfo{\n    // \n    1 : optional string ResourceName (go.tag = \"json:\\\"resource_name\\\"\", agw.key = \"resource_name\")\n    // \n    2 : optional string VersionNum  (go.tag = \"json:\\\"version_num\\\"\", agw.key = \"version_num\")\n    // \n    3 : optional string VersionDesc  (go.tag = \"json:\\\"version_desc\\\"\", agw.key = \"version_desc\")\n    // schema\n    4 : optional string ResourceExtendInfo  (go.tag = \"json:\\\"resource_extend_info\\\"\", agw.key = \"resource_extend_info\")\n} */\nexport enum TaskStatus {\n  Successed = 1,\n  Processing = 2,\n  Failed = 3,\n  Canceled = 4,\n}\n\n/**  */\nexport interface DisplayResourceInfo {\n  /** id */\n  ResID?: Int64;\n  /**  */\n  Desc?: string;\n  /** Iconurl */\n  Icon?: string;\n  /**  */\n  BizResStatus?: number;\n  /**  */\n  CollaborationEnable?: boolean;\n  /** res_typeres_typeschemares_type */\n  BizExtend?: Record<string, string>;\n  /**  */\n  Actions?: Array<ResourceAction>;\n  /**  */\n  DetailDisable?: boolean;\n  /**  */\n  Name?: string;\n  /** 1-2- */\n  PublishStatus?: PublishStatus;\n  /** , unix */\n  EditTime?: Int64;\n}\n\nexport interface ProjectResourceAction {\n  /** keykey */\n  key: ProjectResourceActionKey;\n  /** ture=Actionfalse= */\n  enable: boolean;\n  /** enable=falseStarling Keyspace */\n  hint?: string;\n}\n\nexport interface ProjectResourceGroup {\n  /**  */\n  group_type?: ProjectResourceGroupType;\n  resource_list?: Array<ProjectResourceInfo>;\n}\n\n/**  */\nexport interface ProjectResourceInfo {\n  /** id */\n  res_id?: string;\n  /**  */\n  name?: string;\n  /**  */\n  actions?: Array<ProjectResourceAction>;\n  /** \n4: bool ReadOnly (go.tag = \"json:\\\"read_only\\\"\", agw.key = \"read_only\")\n */\n  res_type?: ResType;\n  /** Plugin1-Http; 2-App; 6-LocalKnowledge0-text; 1-table; 2-imageUI1-Card */\n  res_sub_type?: number;\n  /** res_typeres_typeschemares_type */\n  biz_extend?: Record<string, string>;\n  /**  */\n  biz_res_status?: number;\n  /**  */\n  version_str?: string;\n  res_third_type?: number;\n}\n\nexport interface RefTreeNode {\n  ResourceLocator?: ResourceLocator;\n  /** A-B, A-C-B, A-D, BACChildrenNodes */\n  ChildrenNodes?: Array<RefTreeNode>;\n  /**  */\n  LatestPublishVersionStr?: string;\n}\n\n/** Library */\nexport interface ResourceAction {\n  /** keykey */\n  key: ActionKey;\n  /** ture=Actionfalse= */\n  enable: boolean;\n}\n\nexport interface ResourceCopyCheckFailedReason {\n  ResourceLocator?: ResourceLocator;\n  ResName?: string;\n  Reason?: string;\n}\n\nexport interface ResourceCopyEnv {\n  Scene?: ResourceCopyScene;\n  /** IDCopyProjectResourceCopyResourceToLibraryMoveResourceToLibraryCopyProject */\n  OriginProjectID?: Int64;\n  /** IDproject_idCopyProjectResourceCopyResourceFromLibraryCopyProject */\n  TargetProjectID?: Int64;\n  /** /IDCopyProjectResourceCopyResourceToLibraryMoveResourceToLibraryCopyResourceFromLibrary */\n  ResourceLocator?: ResourceLocator;\n  /**  */\n  TaskUniqKey?: string;\n  /** PublishProjectPublishProjectTemplate */\n  TargetProjectVersion?: Int64;\n  OriginProjectSpaceID?: Int64;\n  TargetProjectSpaceID?: Int64;\n  /** id */\n  CurrentUserID?: Int64;\n  /** or  */\n  OriginProjectVersion?: Int64;\n  /** 0/default-appappproject; 1-botagent */\n  ProjectType?: number;\n}\n\nexport interface ResourceCopyFailedReason {\n  res_id?: string;\n  res_type?: ResType;\n  res_name?: string;\n  reason?: string;\n  /**  */\n  publish_version?: Int64;\n  /** nilLibrary */\n  publish_version_str?: string;\n}\n\n/**  */\nexport interface ResourceCopyResult {\n  OriginResourceLocator?: ResourceLocator;\n  TargetResourceLocator?: ResourceLocator;\n  CopyStatus?: CopyStatus;\n  /** 0.0.1 */\n  TargetPublishVersionNum?: string;\n  /** plugintoolschema */\n  TargetResInfo?: string;\n  /**  */\n  FailedReason?: string;\n}\n\n/**  */\nexport interface ResourceInfo {\n  /** id */\n  res_id?: string;\n  /**  */\n  res_type?: ResType;\n  /** \nPlugin1-Http; 2-App; 6-LocalKnowledge0-text; 1-table; 2-imageUI1-Card */\n  res_sub_type?: number;\n  /**  */\n  name?: string;\n  /**  */\n  desc?: string;\n  /** Iconurl */\n  icon?: string;\n  /**  */\n  creator_id?: string;\n  /**  */\n  creator_avatar?: string;\n  /**  */\n  creator_name?: string;\n  /**  */\n  user_name?: string;\n  /** 1-2- */\n  publish_status?: PublishStatus;\n  /**  */\n  biz_res_status?: number;\n  /**  */\n  collaboration_enable?: boolean;\n  /** , unix */\n  edit_time?: Int64;\n  /** ID */\n  space_id?: string;\n  /** res_typeres_typeschemares_type */\n  biz_extend?: Record<string, string>;\n  /**  */\n  actions?: Array<ResourceAction>;\n  /**  */\n  detail_disable?: boolean;\n  /** []true--itemfalse- */\n  del_flag?: boolean;\n  res_third_type?: number;\n}\n\n/**  */\nexport interface ResourceLocator {\n  ResID?: Int64;\n  ResType?: ResType;\n  /**  */\n  PublishVersion?: Int64;\n  /** nilLibrary */\n  PublishVersionStr?: string;\n}\n\n/** ES */\nexport interface StaticResourceInfo {\n  /** id */\n  res_id: Int64;\n  /** 1-Plugin; 2-Workflow; 3-Imageflow; 4-Knowledge; 5-UI; 6-Prompt */\n  res_type: ResType;\n  /** Plugin1-Http; 2-App; 6-LocalKnowledge1-text; 2-table; 3-image */\n  res_sub_type?: number;\n  /**  */\n  name?: string;\n  /**  */\n  creator_id?: Int64;\n  /** 1-2- */\n  publish_status?: PublishStatus;\n  /** , unix */\n  edit_time?: Int64;\n  /** ID */\n  space_id?: Int64;\n  /**  */\n  data_version?: Int64;\n  /** -prompt  */\n  full_text?: string;\n  res_third_type?: number;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ResourceAction, ResType } from '@coze-arch/idl/plugin_develop';\nimport { PlaygroundApi, PluginDevelopApi } from '@coze-arch/bot-api';\nexport interface LibraryInfo {\n  id: string;\n  name: string;\n  description: string;\n  actions?: ResourceAction[];\n  promptText?: string;\n}\nexport interface LibraryListRequest {\n  searchWord: string;\n  cursor: string;\n  category: 'Recommended' | 'Team';\n  spaceId: string;\n  size: number;\n}\nexport interface LibraryListResponse {\n  list: LibraryInfo[];\n  hasMore: boolean;\n  cursor: string;\n  code: number;\n  [key: string]: unknown;\n}\n\nexport const getTeamLibraryRequest = async (req: LibraryListRequest) => {\n  const res = await PluginDevelopApi.LibraryResourceList({\n    space_id: req.spaceId,\n    size: req.size,\n    cursor: req.cursor,\n    name: req.searchWord,\n    search_keys: ['full_text'],\n    res_type_filter: [ResType.Prompt],\n  });\n  return {\n    list:\n      res.resource_list?.map(item => ({\n        id: item.res_id ?? '',\n        name: item.name ?? '',\n        description: item.desc ?? '',\n        actions: item?.actions ?? [],\n      })) ?? [],\n    hasMore: res.has_more ?? false,\n    cursor: res.cursor ?? '',\n    code: Number(res.code) ?? 0,\n  };\n};\n\nexport const getRecommendLibraryRequest = async (req: LibraryListRequest) => {\n  const res = await PlaygroundApi.GetOfficialPromptResourceList({\n    keyword: req.searchWord,\n  });\n  return {\n    list:\n      res.data?.map(item => ({\n        id: item.id ?? '',\n        name: item.name ?? '',\n        description: item.description ?? '',\n        promptText: item.prompt_text ?? '',\n      })) ?? [],\n    hasMore: false,\n    cursor: '0',\n    code: Number(res.code) ?? 0,\n  };\n};\n\nexport const getLibraryListByCategory = (\n  req: LibraryListRequest,\n): Promise<LibraryListResponse> => {\n  if (req.category === 'Team') {\n    return getTeamLibraryRequest(req);\n  }\n  return getRecommendLibraryRequest(req);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport cls from 'classnames';\nimport { ActionKey } from '@coze-arch/idl/resource';\nimport { type ResourceAction } from '@coze-arch/idl/plugin_develop';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozMore } from '@coze-arch/coze-design/icons';\nimport { Tooltip, Typography } from '@coze-arch/coze-design';\nconst { Text } = Typography;\n\nexport interface LibraryItemProps {\n  id: string;\n  title: string;\n  description: string;\n  isSelected?: boolean;\n  onActive?: (id: string) => void;\n  actions?: ResourceAction[];\n  onDeleteAction?: (id: string) => void;\n  onEditAction?: (id: string) => void;\n}\nconst actionsMap: {\n  [key in ActionKey.Delete | ActionKey.Edit]: string;\n} = {\n  [ActionKey.Delete]: I18n.t('Delete'),\n  [ActionKey.Edit]: I18n.t('Edit'),\n};\n\nexport const LibraryItem = ({\n  id,\n  title,\n  description,\n  actions,\n  isSelected,\n  onActive,\n  onDeleteAction,\n  onEditAction,\n}: LibraryItemProps) => {\n  const [isHover, setIsHover] = useState(false);\n  const handleActions = (action: ActionKey) => {\n    if (action === ActionKey.Delete) {\n      onDeleteAction?.(id);\n      return;\n    }\n    if (action === ActionKey.Edit) {\n      onEditAction?.(id);\n    }\n  };\n  return (\n    <>\n      <div\n        className={cls(\n          'w-full flex flex-row justify-between items-center overflow-hidden px-3 h-[64px]',\n          'relative',\n          'after:content-[\"\"] after:absolute after:left-0 after:right-0',\n          'after:bottom-0 after:h-[1px] after:coz-mg-primary',\n          'hover:coz-mg-secondary-hovered hover:rounded hover:after:hidden',\n          'cursor-pointer',\n          {\n            'rounded coz-mg-primary after:hidden': isSelected,\n          },\n        )}\n        onClick={() => {\n          onActive?.(id);\n        }}\n        onMouseEnter={() => {\n          setIsHover(true);\n        }}\n        onMouseLeave={() => {\n          setIsHover(false);\n        }}\n      >\n        <div className=\"flex flex-1 min-w-[0px] w-0 flex-col gap-[2px]\">\n          <Text className=\"text-lg flex-1 font-medium\" ellipsis>\n            {title}\n          </Text>\n          <Text\n            className=\"text-base\"\n            ellipsis={{\n              rows: 1,\n              showTooltip: {\n                opts: {\n                  position: 'right',\n                },\n              },\n            }}\n          >\n            {description}\n          </Text>\n        </div>\n        <Tooltip\n          position=\"bottom\"\n          className=\"!p-1\"\n          content={\n            <div className=\"flex flex-col gap-[2px] w-[120px]\">\n              {actions\n                ?.filter(action => action.enable)\n                ?.filter(action => action.key in actionsMap)\n                .map(action => (\n                  <div\n                    key={action.key}\n                    onClick={() => handleActions(action.key as ActionKey)}\n                    className=\"w-full text-sm h-[32px] p-2 flex items-center cursor-pointer hover:coz-mg-primary-hovered hover:rounded-mini\"\n                  >\n                    {actionsMap[action.key as keyof typeof actionsMap]}\n                  </div>\n                ))}\n            </div>\n          }\n        >\n          <div\n            className={cls(\n              'w-6 h-6 rounded-little coz-mg-secondary-hovered flex items-center justify-center',\n              {\n                hidden: !actions?.length || !isHover,\n              },\n            )}\n            onClick={e => e.stopPropagation()}\n          >\n            <IconCozMore />\n          </div>\n        </Tooltip>\n      </div>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useState,\n  useRef,\n  useEffect,\n  type Dispatch,\n  type SetStateAction,\n} from 'react';\n\nimport {\n  useInfiniteScroll,\n  useUpdateEffect,\n  useMemoizedFn,\n  useDebounceFn,\n} from 'ahooks';\n\nimport { type ScrollProps, type InfiniteListDataProps } from './type';\n\n/* Rolling Hooks */\n\nfunction useForwardFunc<T>(\n  dataInfo: InfiniteListDataProps<T>,\n  mutate: Dispatch<SetStateAction<InfiniteListDataProps<T>>>,\n) {\n  // Insert data manually, without going through the interface\n  const insertData = (item: T, index: number) => {\n    dataInfo.list.splice(index, 0, item);\n    mutate({\n      ...dataInfo,\n      list: [...dataInfo.list],\n    });\n  };\n\n  // Delete data manually, without going through the interface\n  const removeData = (index: number) => {\n    dataInfo.list.splice(index, 1);\n    mutate({\n      ...dataInfo,\n      list: [...dataInfo.list],\n    });\n  };\n\n  const getDataList = () => dataInfo?.list;\n\n  return { insertData, removeData, getDataList };\n}\n\n// eslint-disable-next-line max-lines-per-function, @coze-arch/max-line-per-function -- the number of lines of code is not very good optimization\nfunction useScroll<T>(props: ScrollProps<T>) {\n  const {\n    targetRef,\n    loadData,\n    threshold,\n    reloadDeps,\n    isNeedBtnLoadMore,\n    resetDataIfReload = true,\n  } = props;\n  const [isLoadingError, setIsLoadingError] = useState<boolean>(false);\n  const refFetchNo = useRef<number>(0);\n  const refResolve = useRef<(value: InfiniteListDataProps<T>) => void>();\n  const {\n    loading,\n    data: dataInfo,\n    loadingMore,\n    loadMore,\n    noMore,\n    cancel,\n    mutate,\n    reload,\n  } = useInfiniteScroll<InfiniteListDataProps<T>>(\n    async current => {\n      // The logic here is so complex that it solves the bug in Scroll.\n      // The cancel in useInfiniteScroll simply cancels a request, but the data is reset based on the current.\n      const defaultData = {\n        cursor: '0',\n        list: [],\n      };\n      const fetchNo = refFetchNo.current;\n      if (refResolve.current) {\n        // Guaranteed sequential execution, if there is a current method, cancel the last request to prevent data overwriting problems due to network reasons\n        // At the same time, A1, A2, and three requests were issued, but A1 arrived first, and then B1 was requested, but A1 was too slow, causing A1 to overwrite B1's request.\n        refResolve.current({\n          ...defaultData,\n          ...(current || {}),\n        });\n      }\n\n      const result = await new Promise((resolve, reject) => {\n        refResolve.current = resolve;\n        loadData(current || defaultData)\n          .then(value => resolve(value))\n          .catch(err => reject(err));\n      });\n\n      // @ts-expect-error -- linter-disable-autofix\n      refResolve.current = null;\n\n      // When switching tabs, if you are requesting at this time, prevent the residual interface display of the data\n      if (refFetchNo.current !== fetchNo) {\n        if (current) {\n          current.list = [];\n        }\n        return {\n          list: [],\n          cursor: '0',\n        };\n      }\n      return result as InfiniteListDataProps<T>;\n    },\n    {\n      target: isLoadingError || isNeedBtnLoadMore ? null : targetRef, //When it fails, scrolling loading is prohibited by removing the event binding of the target.\n      threshold,\n      onBefore: () => {\n        //setIsLoadingError(false);\n      },\n      isNoMore: data => data?.hasMore !== undefined && !data?.hasMore,\n      onSuccess: () => {\n        if (isLoadingError) {\n          setIsLoadingError(false);\n        }\n      },\n      onError: e => {\n        // If an error occurs when requesting the first page of data and the current list is not empty, reset the data\n        // This case only occurs when resetDataIfReload is set to false\n        // @ts-expect-error -- linter-disable-autofix\n        if (dataInfo.cursor === '0' && (dataInfo?.list?.length ?? 0) > 0) {\n          // @ts-expect-error -- linter-disable-autofix\n          mutate({\n            ...dataInfo,\n            list: [],\n          });\n        }\n        setIsLoadingError(true);\n      },\n    },\n  );\n\n  const { insertData, removeData, getDataList } = useForwardFunc(\n    // @ts-expect-error -- linter-disable-autofix\n    dataInfo,\n    mutate,\n  );\n\n  useEffect(() => {\n    if (isNeedBtnLoadMore && !(loading || loadingMore)) {\n      reload();\n    }\n  }, []);\n\n  const reloadData = useMemoizedFn(() => {\n    mutate({\n      // @ts-expect-error -- linter-disable-autofix\n      list: resetDataIfReload ? [] : dataInfo.list,\n      hasMore: undefined,\n      cursor: '0',\n    });\n    cancel();\n    setIsLoadingError(false);\n    reload();\n  });\n\n  useUpdateEffect(() => {\n    refFetchNo.current++;\n    reloadData();\n  }, [...(reloadDeps || [])]);\n  const isLoading = loading || loadingMore || props.isLoading;\n  const { run: loadMoreDebounce } = useDebounceFn(\n    () => {\n      if (isLoading) {\n        return;\n      }\n      if (!isNeedBtnLoadMore) {\n        loadMore();\n      }\n    },\n    { wait: 500 },\n  );\n  useEffect(() => {\n    const resize = () => {\n      loadMoreDebounce();\n    };\n    window.addEventListener('resize', resize);\n    return () => {\n      window.removeEventListener('resize', resize);\n    };\n  }, []);\n  const { list } = dataInfo || {};\n  return {\n    dataList: list,\n    isLoading,\n    loadMore: () => {\n      if (!isLoading) {\n        //If there is already data loading, you need to prohibit repeated loading.\n        loadMore();\n      }\n    },\n    reload: reloadData,\n    noMore,\n    cancel,\n    isLoadingError,\n    mutate,\n    insertData,\n    removeData,\n    getDataList,\n  };\n}\n\nexport default useScroll;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Spin, Button } from '@coze-arch/coze-design';\n\nimport { type FooterProps } from './type';\n\nimport s from './index.module.less';\n\n/* Plugin header */\n\nfunction Index(props: FooterProps) {\n  const {\n    isLoading,\n    loadRetry,\n    isError,\n    renderFooter,\n    isNeedBtnLoadMore,\n    noMore,\n  } = props;\n  return (\n    <div className={classNames(s['footer-container'], 'empty:hidden')}>\n      {renderFooter?.(props) ||\n        (isLoading ? (\n          <>\n            <Spin />\n            <span className={s.loading}>{I18n.t('Loading')}</span>\n          </>\n        ) : isError ? (\n          <>\n            <Spin />\n            <span className={s['error-retry']} onClick={loadRetry}>\n              {I18n.t('inifinit_list_retry')}\n            </span>\n          </>\n        ) : isNeedBtnLoadMore && !noMore ? (\n          <Button\n            onClick={loadRetry}\n            className={s['load-more-btn']}\n            theme=\"borderless\"\n          >\n            {I18n.t('mkpl_load_btn')}\n          </Button>\n        ) : null)}\n    </div>\n  );\n}\n\nexport default Index;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozWarningCircle } from '@coze-arch/coze-design/icons';\nimport { EmptyState, Spin } from '@coze-arch/coze-design';\n\nimport { type EmptyProps } from './type';\n\nimport s from './index.module.less';\n\n/* Plugin header */\n\nfunction Index(props: EmptyProps) {\n  const {\n    isLoading,\n    loadRetry,\n    isError,\n    renderEmpty,\n    text,\n    btn,\n    icon,\n    className,\n    size,\n  } = props;\n  return (\n    <div className={s['height-whole-100']}>\n      {renderEmpty?.(props) ||\n        (!isError ? (\n          isLoading ? (\n            <Spin\n              tip={\n                <span className={s['loading-text']}>{I18n.t('Loading')}</span>\n              }\n              wrapperClassName={s.spin}\n              size=\"middle\"\n            />\n          ) : (\n            <div className={className}>\n              <EmptyState\n                title={text?.emptyTitle || I18n.t('inifinit_list_empty_title')}\n                size={size}\n                description={text?.emptyDesc || ''}\n                buttonText={btn?.emptyText}\n                buttonProps={btn?.emptyButtonProps}\n                onButtonClick={btn?.emptyClick}\n                icon={icon}\n              />\n            </div>\n          )\n        ) : (\n          <div className={className}>\n            <EmptyState\n              className={s['load-fail']}\n              title={I18n.t('inifinit_list_load_fail')}\n              icon={<IconCozWarningCircle />}\n              buttonText={loadRetry && I18n.t('inifinit_list_retry')}\n              onButtonClick={() => {\n                loadRetry?.();\n              }}\n            />\n          </div>\n        ))}\n    </div>\n  );\n}\n\nexport default Index;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  forwardRef,\n  useImperativeHandle,\n  type RefObject,\n  useEffect,\n  type ForwardedRef,\n} from 'react';\n\nimport cls from 'classnames';\nimport { List } from '@coze-arch/coze-design';\n\nimport useScroll from './use-scroll';\nimport { type InfiniteListProps, type InfiniteListRef } from './type';\nimport Footer from './footer';\nimport Empty from './empty';\n\nimport s from './index.module.less';\nexport type { InfiniteListRef };\n\n// modify from packages/community/components/src/infinite-list/index.tsx\nfunction Index<T extends object>(\n  props: InfiniteListProps<T>,\n  ref: ForwardedRef<InfiniteListRef<T>>,\n) {\n  const {\n    className,\n    grid,\n    renderItem,\n    itemClassName,\n    renderFooter,\n    scrollConf,\n    onChangeState,\n    isNeedBtnLoadMore = false,\n    retryFunc,\n    containerClassName,\n    emptyConf,\n  } = props;\n\n  const {\n    dataList,\n    isLoading,\n    loadMore,\n    noMore,\n    isLoadingError,\n    reload,\n    getDataList,\n  } = useScroll<T>({ ...scrollConf, isNeedBtnLoadMore });\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      reload,\n      getDataList,\n    }),\n    [reload, getDataList],\n  );\n  useEffect(() => {\n    onChangeState?.(!!isLoading, dataList ?? []);\n  }, [dataList, isLoading]);\n\n  return (\n    <div className={cls(s['height-whole-100'], containerClassName)}>\n      {!dataList?.length ? (\n        /** How to display an empty page when the data is empty */\n        <Empty\n          isError={isLoadingError}\n          isLoading={isLoading}\n          loadRetry={retryFunc || loadMore}\n          {...emptyConf}\n        />\n      ) : (\n        <List\n          {...{ className, grid }}\n          emptyContent={<></>}\n          dataSource={dataList}\n          split={false}\n          renderItem={(item, number) => (\n            <List.Item\n              className={\n                typeof itemClassName === 'string'\n                  ? itemClassName\n                  : itemClassName?.(item) // Support dynamic row className\n              }\n            >\n              {renderItem?.(item, number)}\n            </List.Item>\n          )}\n          footer={\n            <Footer\n              isError={isLoadingError}\n              noMore={noMore}\n              isLoading={isLoading}\n              loadRetry={retryFunc || loadMore}\n              renderFooter={renderFooter}\n              isNeedBtnLoadMore={isNeedBtnLoadMore}\n              dataNum={dataList?.length}\n            />\n          }\n        />\n      )}\n    </div>\n  );\n}\n\nexport const InfiniteList = forwardRef(Index) as <T>(\n  props: InfiniteListProps<T> & { ref?: RefObject<InfiniteListRef<T>> },\n) => JSX.Element;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useEffect,\n  type RefObject,\n  useState,\n  useRef,\n  type ForwardedRef,\n  forwardRef,\n  useImperativeHandle,\n} from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\n\nimport EmptyLibraryIcon from '../assets/empty-library-icon.svg';\nimport {\n  type LibraryInfo,\n  type LibraryListRequest,\n  type LibraryListResponse,\n} from './library-request';\nimport { LibraryItem } from './library-item';\nimport { InfiniteList, type InfiniteListRef } from './infinite-list';\nexport type { InfiniteListRef };\ninterface LibraryListProps {\n  searchWord?: string | undefined;\n  category: 'Recommended' | 'Team';\n  spaceId: string;\n  size: number;\n  targetRef: RefObject<HTMLDivElement>;\n  onActive: (id: string) => void;\n  onEditAction: (id: string) => void;\n  onDeleteAction: (id: string) => void;\n  getData: (req: LibraryListRequest) => Promise<LibraryListResponse>;\n  onChangeState?: (isLoading: boolean, dataList: LibraryInfo[]) => void;\n  onEmptyClick?: () => void;\n}\n\nexport const Index = (\n  props: LibraryListProps,\n  ref: ForwardedRef<InfiniteListRef<LibraryInfo>>,\n) => {\n  const {\n    getData,\n    onActive,\n    searchWord,\n    category,\n    targetRef,\n    size,\n    onChangeState,\n    onDeleteAction,\n    onEditAction,\n    spaceId,\n    onEmptyClick,\n  } = props;\n  const listRef = useRef<InfiniteListRef<LibraryInfo>>(null);\n  const [dataList, setDataList] = useState<LibraryInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [selectedLibraryId, setSelectedLibraryId] = useState<string>('');\n\n  // Switch tabs, the first one is selected by default\n  useEffect(() => {\n    if (!dataList.length || isLoading) {\n      return;\n    }\n    const firstLibraryId = dataList[0].id;\n    setSelectedLibraryId(firstLibraryId);\n    onActive?.(firstLibraryId);\n  }, [dataList, isLoading]);\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      reload: listRef.current?.reload ?? (() => void 0),\n      getDataList: listRef.current?.getDataList ?? (() => []),\n    }),\n    [],\n  );\n  return (\n    <InfiniteList<LibraryInfo>\n      ref={listRef}\n      isNeedBtnLoadMore={false}\n      onChangeState={(newIsLoading, newDataList) => {\n        onChangeState?.(newIsLoading, newDataList);\n        setDataList(newDataList);\n        setIsLoading(newIsLoading);\n      }}\n      renderItem={(card: LibraryInfo) => (\n        <LibraryItem\n          key={card.id}\n          id={card.id}\n          title={card.name}\n          description={card.description}\n          actions={card.actions}\n          isSelected={selectedLibraryId === card.id}\n          onActive={id => {\n            onActive?.(id);\n            setSelectedLibraryId(id);\n          }}\n          onEditAction={id => {\n            onEditAction?.(id);\n          }}\n          onDeleteAction={id => {\n            onDeleteAction?.(id);\n          }}\n        />\n      )}\n      scrollConf={{\n        reloadDeps: [searchWord, category],\n        targetRef,\n        loadData: current =>\n          getData({\n            cursor: current?.cursor ?? '0',\n            searchWord: searchWord ?? '',\n            category,\n            spaceId,\n            size,\n          }),\n      }}\n      emptyConf={{\n        className: 'flex flex-col items-center justify-center h-full',\n        icon: <img src={EmptyLibraryIcon} alt=\"empty-library\" />,\n        size: 'full_screen',\n        text: {\n          emptyTitle: I18n.t('prompt_library_empty_title'),\n          emptyDesc: I18n.t('prompt_library_empty_describe'),\n        },\n        btn: {\n          emptyText: I18n.t('prompt_library_new_prompt'),\n          emptyButtonProps: {\n            type: 'primary',\n            className:\n              '!coz-mg-hglt !coz-fg-hglt hover:!coz-mg-hglt-hovered active:!coz-mg-hglt-pressed',\n            icon: <IconCozPlus />,\n            onClick: () => {\n              onEmptyClick?.();\n            },\n          },\n        },\n      }}\n    />\n  );\n};\nexport const LibraryList = forwardRef(Index) as <T>(\n  props: LibraryListProps & { ref?: RefObject<InfiniteListRef<T>> },\n) => JSX.Element;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport copy from 'copy-to-clipboard';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Toast } from '@coze-arch/coze-design';\n\nexport const CopyPrompt = (props: {\n  editor: EditorAPI;\n  onCopyPrompt: () => void;\n}) => {\n  const { editor, onCopyPrompt } = props;\n  return (\n    <Button\n      color=\"primary\"\n      onClick={() => {\n        const text = editor?.$view.state.doc.toString();\n        const result = copy(text, { format: 'text/plain' });\n        result &&\n          Toast.success(I18n.t('prompt_library_prompt_copied_successfully'));\n        onCopyPrompt?.();\n      }}\n    >\n      {I18n.t('prompt_detail_copy_prompt')}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { insertToNewline } from '@coze-common/prompt-kit-base/shared';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\n\nexport const InsertToEditor = (props: {\n  outerEditor: EditorAPI;\n  prompt: string;\n  onInsertPrompt: (prompt: string) => void;\n  onCancel: (e: React.MouseEvent) => void;\n}) => {\n  const { outerEditor, prompt, onInsertPrompt, onCancel } = props;\n  return (\n    <Button\n      disabled={!prompt}\n      onClick={async e => {\n        const insertPrompt = await insertToNewline({\n          editor: outerEditor,\n          prompt,\n        });\n        onInsertPrompt(insertPrompt);\n        onCancel?.(e);\n      }}\n    >\n      {I18n.t('prompt_resource_insert_prompt')}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\nexport const PromptDiff = (props: { onDiff: () => void }) => {\n  const { onDiff } = props;\n  return (\n    <Button\n      color=\"primary\"\n      onClick={() => {\n        onDiff?.();\n      }}\n    >\n      {I18n.t('compare_prompt_compare_debug')}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEmpty } from '@coze-arch/coze-design/icons';\nimport { EmptyState } from '@coze-arch/coze-design';\n\nimport EmptyPromptIcon from '../assets/empty-prompt-icon.svg';\n\nexport const UnselectedPrompt = (props: { className?: string }) => (\n  <div className={props.className}>\n    <EmptyState\n      title={I18n.t('prompt_library_unselected')}\n      icon={<img src={EmptyPromptIcon} alt=\"empty-prompt\" />}\n    />\n  </div>\n);\n\nexport const EmptyPrompt = (props: { className?: string }) => (\n  <div className={props.className}>\n    <EmptyState\n      title={I18n.t('prompt_library_prompt_empty')}\n      icon={<IconCozEmpty />}\n    />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { Modal, type ModalProps, Search, Button } from '@coze-arch/coze-design';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport { PlaygroundApi } from '@coze-arch/bot-api';\nimport { LibraryBlockWidget } from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport {\n  PromptEditorRender,\n  PromptEditorProvider,\n} from '@coze-common/prompt-kit-base/editor';\nimport { usePromptConfiguratorModal } from '@coze-common/prompt-kit-adapter/create-prompt';\n\nimport { type LibraryInfo, getLibraryListByCategory } from './library-request';\nimport { LibraryList, type InfiniteListRef } from './library-list';\nimport { CopyPrompt, InsertToEditor, PromptDiff } from './footer-actions';\nimport { EmptyPrompt } from './empty';\n\nimport '@coze-common/prompt-kit-base/shared/css';\nimport styles from './index.module.less';\n\nconst getTabLabelMap = (isPersonal: boolean) => ({\n  Recommended: I18n.t('prompt_resource_recommended'),\n  Team: isPersonal\n    ? I18n.t('prompt_resource_personal')\n    : I18n.t('prompt_resource_team'),\n});\nconst LIMIT_LIBRARY_SIZE = 15;\n\ninterface PromptContextInfo {\n  botId?: string;\n  name?: string;\n  description?: string;\n  contextHistory?: string;\n}\n\nexport interface ActionExtraInfo {\n  category: 'Recommended' | 'Team';\n  id: string;\n}\n\ninterface PromptLibraryProps extends ModalProps {\n  spaceId: string;\n  isPersonal?: boolean;\n  editor: EditorAPI;\n  getConversationId?: () => string | undefined;\n  getPromptContextInfo?: () => PromptContextInfo;\n  enableDiff?: boolean;\n  importPromptWhenEmpty?: string;\n  defaultActiveTab?: 'Recommended' | 'Team';\n  tabs?: ('Recommended' | 'Team')[];\n  /** For event tracking: page source */\n  source: string;\n  /** For event tracking: bot_id */\n  botId?: string;\n  /** For event tracking: project_id */\n  projectId?: string;\n  /** For event tracking: workflow_id */\n  workflowId?: string;\n  onInsertPrompt?: (prompt: string, selectedLibrary: ActionExtraInfo) => void;\n  onUpdateSuccess?: (\n    mode: 'create' | 'edit' | 'info',\n    selectedLibrary: ActionExtraInfo,\n  ) => void;\n  onCopyPrompt?: (selectedLibrary: ActionExtraInfo) => void;\n  onDeletePrompt?: (selectedLibrary: ActionExtraInfo) => void;\n  onDiff?: ({\n    prompt,\n    libraryId,\n  }: {\n    prompt: string;\n    libraryId: string;\n  }) => void;\n  onCancel?: () => void;\n}\n\n/* eslint-disable @coze-arch/max-line-per-function */\nexport const PromptLibrary = ({\n  spaceId,\n  onCancel,\n  defaultActiveTab = 'Recommended',\n  getConversationId,\n  getPromptContextInfo,\n  editor: outerEditor,\n  source,\n  tabs = ['Recommended', 'Team'],\n  botId,\n  projectId,\n  workflowId,\n  isPersonal = false,\n  importPromptWhenEmpty,\n  enableDiff = false,\n  onInsertPrompt,\n  onUpdateSuccess,\n  onCopyPrompt,\n  onDeletePrompt,\n  onDiff,\n}: PromptLibraryProps) => {\n  const [activeTab, setActiveTab] = useState<'Recommended' | 'Team'>(\n    defaultActiveTab,\n  );\n  const [prompt, setPrompt] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [dataList, setDataList] = useState<LibraryInfo[]>([]);\n  const [selectedLibraryId, setSelectedLibraryId] = useState<string>('');\n  const [searchWord, setSearchWord] = useState<string | undefined>(undefined);\n  const targetRef = useRef<HTMLDivElement>(null);\n  const listRef = useRef<InfiniteListRef<LibraryInfo>>(null);\n  const editor = useEditor<EditorAPI>();\n  const isEmptyList = !isLoading && dataList.length === 0;\n\n  const { open: openPromptConfiguratorModal, node: PromptConfiguratorModal } =\n    usePromptConfiguratorModal({\n      spaceId,\n      isPersonal,\n      enableDiff,\n      getConversationId,\n      getPromptContextInfo,\n      importPromptWhenEmpty,\n      source,\n      botId,\n      projectId,\n      workflowId,\n      onDiff,\n      onUpdateSuccess: (mode, id) => {\n        if (tabs.includes(activeTab)) {\n          setActiveTab('Team');\n        }\n        onUpdateSuccess?.(mode, {\n          id: id || '',\n          category: 'Team',\n        });\n        listRef.current?.reload();\n      },\n    });\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n    editor.$view.dispatch({\n      changes: {\n        from: 0,\n        to: editor.$view.state.doc.length,\n        insert: prompt,\n      },\n    });\n  }, [editor, prompt]);\n\n  useEffect(() => {\n    if (!selectedLibraryId || isLoading || !dataList.length) {\n      return;\n    }\n    const selectedLibrary = dataList.find(\n      item => item.id === selectedLibraryId,\n    );\n    if (!selectedLibrary) {\n      return;\n    }\n    const { promptText } = selectedLibrary;\n\n    if (promptText) {\n      setPrompt(promptText);\n      return;\n    }\n    PlaygroundApi.GetPromptResourceInfo({\n      prompt_resource_id: selectedLibraryId,\n    }).then(({ data: { prompt_text: newPrompt } = {} }) => {\n      setPrompt(newPrompt ?? '');\n    });\n  }, [selectedLibraryId, dataList, isLoading]);\n\n  // Switch tab, no selected prompt word, reset search term\n  useEffect(() => {\n    setSelectedLibraryId('');\n    setPrompt('');\n  }, [activeTab, isEmptyList]);\n\n  return (\n    <>\n      <Modal\n        title={I18n.t('prompt_library_prompt_library')}\n        visible\n        className={styles['prompt-library-modal']}\n        width=\"880px\"\n        closeOnEsc={false}\n        maskClosable={false}\n        footer={\n          <div className=\"flex justify-end\">\n            {enableDiff ? (\n              <PromptDiff\n                onDiff={() => {\n                  onDiff?.({ prompt, libraryId: selectedLibraryId });\n                  sendTeaEvent(EVENT_NAMES.prompt_library_front, {\n                    source,\n                    prompt_id: selectedLibraryId,\n                    space_id: spaceId,\n                    prompt_type: 'workspace',\n                    action: 'compare',\n                    bot_id: botId,\n                    project_id: projectId,\n                    workflow_id: workflowId,\n                  });\n                  sendTeaEvent(EVENT_NAMES.compare_mode_front, {\n                    source,\n                    action: 'start',\n                    compare_type: 'prompts',\n                    bot_id: botId,\n                  });\n                }}\n              />\n            ) : null}\n            <CopyPrompt\n              editor={editor}\n              onCopyPrompt={() => {\n                onCopyPrompt?.({ id: selectedLibraryId, category: activeTab });\n                sendTeaEvent(EVENT_NAMES.prompt_library_front, {\n                  source,\n                  prompt_id: selectedLibraryId,\n                  space_id: spaceId,\n                  prompt_type: 'workspace',\n                  action: 'copy',\n                  bot_id: botId,\n                  project_id: projectId,\n                  workflow_id: workflowId,\n                });\n              }}\n            />\n            <InsertToEditor\n              outerEditor={outerEditor}\n              prompt={prompt}\n              onInsertPrompt={insertPrompt => {\n                onInsertPrompt?.(insertPrompt, {\n                  id: selectedLibraryId,\n                  category: activeTab,\n                });\n                sendTeaEvent(EVENT_NAMES.prompt_library_front, {\n                  source,\n                  prompt_id: selectedLibraryId,\n                  space_id: spaceId,\n                  prompt_type: 'workspace',\n                  action: 'insert',\n                  bot_id: botId,\n                  project_id: projectId,\n                  workflow_id: workflowId,\n                });\n              }}\n              onCancel={() => {\n                onCancel?.();\n              }}\n            />\n          </div>\n        }\n        onCancel={onCancel}\n      >\n        <div className=\"flex flex-col gap-5 overflow-hidden h-[620px]\">\n          <div className=\"flex justify-between items-center\">\n            <div className=\"flex gap-3 pl-3\">\n              {tabs.map(category => (\n                <div\n                  key={category}\n                  className={classNames(\n                    'coz-fg-secondary text-sm cursor-pointer font-medium',\n                    {\n                      '!coz-fg-hglt': activeTab === category,\n                    },\n                  )}\n                  onClick={() => {\n                    setActiveTab(category);\n                  }}\n                >\n                  {getTabLabelMap(isPersonal)[category]}\n                </div>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <Search\n                className=\"w-[192px]\"\n                placeholder={I18n.t('Search')}\n                onSearch={setSearchWord}\n              />\n              {isEmptyList ? null : (\n                <Button\n                  type=\"primary\"\n                  className=\"!coz-mg-hglt !coz-fg-hglt hover:!coz-mg-hglt-hovered active:!coz-mg-hglt-pressed\"\n                  icon={<IconCozPlus />}\n                  onClick={() => {\n                    openPromptConfiguratorModal({\n                      mode: 'create',\n                    });\n                  }}\n                >\n                  {I18n.t('prompt_library_new_prompt')}\n                </Button>\n              )}\n            </div>\n          </div>\n          <div className=\"flex gap-2 overflow-hidden flex-1\">\n            <div\n              className=\"flex-1 basis-1/3 overflow-y-auto styled-scrollbar hover-show-scrollbar\"\n              ref={targetRef}\n            >\n              <LibraryList\n                ref={listRef}\n                targetRef={targetRef}\n                spaceId={spaceId}\n                category={activeTab}\n                size={LIMIT_LIBRARY_SIZE}\n                searchWord={searchWord}\n                getData={getLibraryListByCategory}\n                onChangeState={(newIsLoading, newDataList) => {\n                  setIsLoading(newIsLoading);\n                  setDataList(newDataList);\n                }}\n                onActive={id => {\n                  setSelectedLibraryId(id);\n                }}\n                onDeleteAction={id => {\n                  PlaygroundApi.DeletePromptResource({\n                    prompt_resource_id: id,\n                  }).then(() => {\n                    onDeletePrompt?.({ id, category: 'Team' });\n                    sendTeaEvent(EVENT_NAMES.prompt_library_front, {\n                      source,\n                      prompt_id: id,\n                      space_id: spaceId,\n                      prompt_type: 'workspace',\n                      action: 'delete',\n                      bot_id: botId,\n                      project_id: projectId,\n                      workflow_id: workflowId,\n                    });\n                    listRef.current?.reload();\n                  });\n                }}\n                onEditAction={id => {\n                  openPromptConfiguratorModal({\n                    mode: 'edit',\n                    editId: id,\n                  });\n                }}\n                onEmptyClick={() => {\n                  openPromptConfiguratorModal({\n                    mode: 'create',\n                  });\n                }}\n              />\n            </div>\n            <div className=\"flex-1 basis-2/3 coz-bg-max rounded-normal border-solid coz-stroke-primary border-[0.5px] p-2 empty:hidden overflow-y-auto styled-scrollbar hover-show-scrollbar\">\n              {isEmptyList ? null : (\n                <>\n                  {prompt ? (\n                    <div className=\"relative \">\n                      <PromptEditorRender defaultValue={prompt} readonly />\n                      <InputSlotWidget mode=\"input\" />\n                      <LibraryBlockWidget\n                        librarys={[]}\n                        readonly\n                        spaceId={spaceId}\n                      />\n                    </div>\n                  ) : (\n                    <EmptyPrompt className=\"flex justify-center items-center h-full w-full\" />\n                  )}\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n      </Modal>\n      {PromptConfiguratorModal}\n    </>\n  );\n};\n\nexport const usePromptLibraryModal = (\n  props: Omit<PromptLibraryProps, 'onClose'>,\n) => {\n  const [visible, setVisible] = useState(false);\n  const [dynamicProps, setDynamicProps] = useState<Partial<PromptLibraryProps>>(\n    {},\n  );\n  const close = () => {\n    setVisible(false);\n  };\n  const open = (options?: Partial<PromptLibraryProps>) => {\n    setVisible(true);\n    setDynamicProps(options ?? {});\n  };\n  return {\n    node: visible ? (\n      <PromptEditorProvider>\n        <PromptLibrary {...props} {...dynamicProps} onCancel={close} />\n      </PromptEditorProvider>\n    ) : null,\n    close,\n    open,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport cls from 'classnames';\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { Popover, Button, Typography } from '@coze-arch/coze-design';\nimport { PlaygroundApi } from '@coze-arch/bot-api';\nimport { ThemeExtension } from '@coze-common/editor-plugins/theme';\nimport { LibraryBlockWidget } from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport {\n  PromptEditorRender,\n  PromptEditorProvider,\n} from '@coze-common/prompt-kit-base/editor';\nimport { I18n } from '@coze-arch/i18n';\nimport { EditorView } from '@codemirror/view';\n\nimport '@coze-common/prompt-kit-base/shared/css';\n\ninterface RecommendCardProps {\n  id: string;\n  title: string;\n  description: string;\n  position?: 'topLeft' | 'top';\n  prompt?: string;\n  spaceId: string;\n  onInsertPrompt?: (prompt: string) => void;\n  className?: string;\n}\n\nexport const RecommendCard = (props: RecommendCardProps) => {\n  const {\n    id,\n    title,\n    description,\n    prompt,\n    onInsertPrompt,\n    spaceId,\n    className,\n    position,\n  } = props;\n  const [promptText, setPromptText] = useState(prompt ?? '');\n  const [isPopoverVisible, setIsPopoverVisible] = useState(false);\n\n  useEffect(() => {\n    if (prompt) {\n      return;\n    }\n\n    PlaygroundApi.GetPromptResourceInfo({\n      prompt_resource_id: id,\n    }).then(({ data: { prompt_text } = {} }) => {\n      setPromptText(prompt_text ?? '');\n    });\n  }, [prompt, id]);\n\n  return (\n    <PromptEditorProvider>\n      <Popover\n        position={position}\n        visible={isPopoverVisible}\n        onVisibleChange={setIsPopoverVisible}\n        trigger=\"hover\"\n        key={id}\n        className=\"rounded\"\n        showArrow\n        // mouseLeaveDelay={150}\n        // mouseEnterDelay={150}\n        autoAdjustOverflow\n        content={\n          isPopoverVisible ? (\n            <UsePromptPopoverContent\n              prompt={promptText}\n              title={title}\n              spaceId={spaceId}\n              onInsertPrompt={value => {\n                onInsertPrompt?.(value);\n                setIsPopoverVisible(false);\n              }}\n            />\n          ) : null\n        }\n      >\n        <div\n          className={cls(\n            'flex flex-col flex-shrink-0 flex-nowrap gap-1 px-3 py-2 relative',\n            'aspect-[180/120] overflow-hidden',\n            'rounded-lg border coz-stroke-primary coz-bg-max cursor-pointer',\n            'coz-stroke-primary border-[0.5px] border-solid',\n            'hover:coz-mg-secondary-hovered',\n            className,\n          )}\n        >\n          <Typography.Text\n            className=\"font-medium text-lg\"\n            ellipsis={{ rows: 1 }}\n          >\n            {title}\n          </Typography.Text>\n          <Typography.Text className=\"text-base\" ellipsis={{ rows: 3 }}>\n            {description ?? prompt?.slice(0, 50)}\n          </Typography.Text>\n        </div>\n      </Popover>\n    </PromptEditorProvider>\n  );\n};\n\nconst UsePromptPopoverContent: React.FC<{\n  prompt?: string;\n  title: string;\n  spaceId: string;\n  onInsertPrompt?: (prompt: string) => void;\n}> = ({ prompt = '', title, spaceId, onInsertPrompt }) => {\n  const editor = useEditor<EditorAPI>();\n\n  useEffect(() => {\n    editor?.$view.dispatch({\n      changes: {\n        from: 0,\n        to: editor?.$view.state.doc.length,\n        insert: prompt,\n      },\n    });\n  }, [editor, prompt]);\n\n  return (\n    <div className=\"flex flex-col justify-between w-[300px] h-[300px] gap-3\">\n      <div className=\"flex flex-col gap-1 overflow-y-auto styled-scrollbar hover-show-scrollbar\">\n        <div className=\"text-sm font-medium coz-fg-primary\">{title}</div>\n        <PromptEditorRender defaultValue={prompt} readonly />\n        <InputSlotWidget mode=\"input\" />\n        <LibraryBlockWidget librarys={[]} readonly spaceId={spaceId} />\n        <ThemeExtension\n          themes={[\n            EditorView.theme({\n              '.cm-line': {\n                paddingLeft: '0 !important',\n              },\n            }),\n          ]}\n        />\n      </div>\n      <div className=\"coz-mg-hglt hover:!coz-mg-hglt-hovered rounded\">\n        <Button\n          color=\"primary\"\n          className=\"w-full font-sm font-medium !bg-transparent !coz-fg-hglt \"\n          onClick={() => {\n            onInsertPrompt?.(prompt);\n          }}\n        >\n          {I18n.t('prompt_resource_insert_prompt')}\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport const ViewAll = ({\n  onClick,\n  className,\n}: {\n  onClick: () => void;\n  className?: string;\n}) => (\n  <div\n    onClick={onClick}\n    className={cls(\n      'flex flex-col flex-shrink-0 flex-nowrap gap-1 px-3 py-2 items-center justify-center',\n      'aspect-[180/120]',\n      'rounded-lg border coz-stroke-primary coz-bg-max cursor-pointer text-sm',\n      'coz-stroke-primary border-[0.5px] border-solid',\n      'hover:coz-mg-secondary-hovered',\n      className,\n    )}\n  >\n    <div className=\"coz-fg-primary font-medium\">\n      {I18n.t('prompt_resource_view_all')}\n    </div>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Skeleton } from '@coze-arch/coze-design';\nexport const RecommendCardLoading = () => (\n  <div className=\"flex flex-col flex-shrink-0 flex-nowrap px-3 py-2 aspect-[180/120] rounded-lg border coz-stroke-primary coz-bg-max\">\n    <Skeleton\n      placeholder={<Skeleton.Title />}\n      className=\"mb-3 w-2/3\"\n    ></Skeleton>\n    <Skeleton\n      placeholder={<Skeleton.Paragraph rows={3} />}\n      className=\"w-full\"\n    ></Skeleton>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useState } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport {\n  type LibraryResourceListResponse,\n  type LibraryResourceListRequest,\n  ResType,\n} from '@coze-arch/idl/plugin_develop';\nimport { type GetOfficialPromptResourceListResponse } from '@coze-arch/idl/playground_api';\nimport { PlaygroundApi, PluginDevelopApi } from '@coze-arch/bot-api';\n\ninterface LibraryInfo {\n  id: string;\n  name: string;\n  description: string;\n  promptText?: string;\n}\nexport const useGetLibrarys = () => {\n  const {\n    runAsync: runRecommendLibrary,\n    loading: loadingRecommendLibrary,\n    data: dataRecommendLibrary,\n  } = useGetRecommendLibrarys();\n  const {\n    runAsync: runTeamLibrary,\n    loading: loadingTeamLibrary,\n    data: dataTeamLibrary,\n  } = useGetTeamLibrarys();\n  return {\n    loading: loadingRecommendLibrary || loadingTeamLibrary,\n    data: {\n      Recommended: dataRecommendLibrary ?? [],\n      Team: dataTeamLibrary ?? [],\n    },\n    runAsync: (\n      type: 'Recommended' | 'Team',\n      options: LibraryResourceListRequest,\n    ) => {\n      if (type === 'Recommended') {\n        return runRecommendLibrary({ size: options.size });\n      }\n      if (type === 'Team') {\n        return runTeamLibrary(options);\n      }\n    },\n  };\n};\nexport const useGetRecommendLibrarys = (): {\n  data: LibraryInfo[] | undefined;\n  runAsync: (options: {\n    size?: number;\n  }) => Promise<GetOfficialPromptResourceListResponse>;\n  loading: boolean;\n} => {\n  const size = useRef<number | undefined>();\n  const [slicedData, setSlicedData] =\n    useState<GetOfficialPromptResourceListResponse['data']>();\n\n  const { runAsync, loading } = useRequest(\n    () => PlaygroundApi.GetOfficialPromptResourceList(),\n    {\n      manual: true,\n      onSuccess: res => {\n        const processedData = size.current\n          ? res.data?.slice(0, size.current)\n          : res.data;\n        setSlicedData(processedData);\n        return res;\n      },\n    },\n  );\n\n  const runAsyncHandler = async (options: { size?: number }) => {\n    size.current = options.size;\n    return runAsync();\n  };\n\n  const commonData = slicedData?.map(\n    ({\n      id = '',\n      name = '',\n      description = '',\n      prompt_text: promptText = '',\n    }) => ({\n      id,\n      name,\n      description,\n      promptText,\n    }),\n  );\n\n  return {\n    data: commonData,\n    runAsync: runAsyncHandler,\n    loading,\n  };\n};\nexport const useGetTeamLibrarys = (): {\n  data: LibraryInfo[] | undefined;\n  runAsync: (\n    options: LibraryResourceListRequest,\n  ) => Promise<LibraryResourceListResponse>;\n  loading: boolean;\n} => {\n  const { data, runAsync, loading } = useRequest(\n    (options: LibraryResourceListRequest) =>\n      PluginDevelopApi.LibraryResourceList({\n        ...options,\n        res_type_filter: [ResType.Prompt],\n      }),\n    {\n      manual: true,\n    },\n  );\n  const commonData = data?.resource_list?.map(\n    ({ res_id: id = '', name = '', desc = '' }) => ({\n      id,\n      name,\n      description: desc,\n    }),\n  );\n  return { data: commonData, runAsync, loading };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\ninterface ScrollControlProps {\n  activeTab: string;\n  tabs: string[];\n  loading?: boolean;\n  data?: Record<string, unknown>;\n}\n\nexport const useScrollControl = ({\n  activeTab,\n  tabs,\n  loading,\n  data,\n}: ScrollControlProps) => {\n  const scrollRefs = useRef<(HTMLDivElement | null)[]>([]);\n  const [canScrollLeft, setCanScrollLeft] = useState(false);\n  const [canScrollRight, setCanScrollRight] = useState(false);\n\n  const getTabIndex = (tab: string) => tabs.indexOf(tab);\n\n  const checkScrollable = (index: number) => {\n    const scrollRef = scrollRefs.current[index];\n    if (scrollRef) {\n      const { scrollLeft, scrollWidth, clientWidth } = scrollRef;\n      setCanScrollLeft(scrollLeft > 0);\n      setCanScrollRight(scrollLeft < scrollWidth - clientWidth - 10);\n    }\n  };\n\n  const handleScroll = (direction: 'left' | 'right') => {\n    const index = getTabIndex(activeTab);\n    if (scrollRefs.current[index]) {\n      const scrollAmount = 300;\n      const newScrollLeft =\n        scrollRefs.current[index].scrollLeft +\n        (direction === 'left' ? -scrollAmount : scrollAmount);\n      scrollRefs.current[index].scrollTo({\n        left: newScrollLeft,\n        behavior: 'smooth',\n      });\n    }\n  };\n\n  useEffect(() => {\n    const handleResize = () => checkScrollable(getTabIndex(activeTab));\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [activeTab]);\n\n  useEffect(() => {\n    if (!loading && data?.[activeTab]) {\n      setTimeout(() => checkScrollable(getTabIndex(activeTab)), 0);\n    }\n  }, [loading, data, activeTab]);\n\n  useEffect(() => {\n    const scrollElement = scrollRefs.current[getTabIndex(activeTab)];\n    if (!scrollElement) {\n      return;\n    }\n    const onScroll = () => checkScrollable(getTabIndex(activeTab));\n    scrollElement.addEventListener('scroll', onScroll);\n    checkScrollable(getTabIndex(activeTab));\n    return () => scrollElement.removeEventListener('scroll', onScroll);\n  }, [data, activeTab]);\n\n  return {\n    scrollRefs,\n    canScrollLeft,\n    canScrollRight,\n    handleScroll,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEmpty } from '@coze-arch/coze-design/icons';\nimport { EmptyState } from '@coze-arch/coze-design';\n\nexport const EmptyRecommend = () => (\n  <div className=\"flex h-full items-center justify-center\">\n    <EmptyState\n      title={I18n.t('prompt_library_empty_title')}\n      icon={<IconCozEmpty />}\n      style={{ maxWidth: '300px' }}\n    />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  IconCozArrowLeftFill,\n  IconCozArrowRightFill,\n} from '@coze-arch/coze-design/icons';\n\nexport const LeftScrollButton = ({\n  handleScroll,\n}: {\n  handleScroll: () => void;\n}) => (\n  <div\n    className=\"absolute bottom-0 left-0 top-0 w-8 z-10\"\n    style={{\n      background:\n        'linear-gradient(90deg, #F9F9F9 0%, rgba(249, 249, 249, 0.00) 100%)',\n    }}\n  >\n    <div\n      onClick={handleScroll}\n      className=\"w-6 h-6 coz-bg-max flex justify-center items-center absolute left-0 top-1/2 -translate-y-1/2 z-20 cursor-pointer rounded-lg coz-stroke-primary coz-shadow-small\"\n    >\n      <IconCozArrowLeftFill className=\"w-4 h-4\" />\n    </div>\n  </div>\n);\n\nexport const RightScrollButton = ({\n  handleScroll,\n}: {\n  handleScroll: () => void;\n}) => (\n  <div\n    className=\"absolute bottom-0 right-0 top-0 w-8\"\n    style={{\n      background:\n        'linear-gradient(270deg, #F9F9F9 0%, rgba(249, 249, 249, 0.00) 100%)',\n    }}\n  >\n    <div\n      onClick={handleScroll}\n      className=\"w-6 h-6 coz-bg-max flex justify-center items-center absolute right-0 top-1/2 -translate-y-1/2 z-20 cursor-pointer rounded-lg coz-stroke-primary coz-shadow-small\"\n    >\n      <IconCozArrowRightFill className=\"w-4 h-4\" />\n    </div>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ForwardedRef,\n  forwardRef,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\n\nimport cls from 'classnames';\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowRightFill } from '@coze-arch/coze-design/icons';\nimport { Tabs, TabPane, Button } from '@coze-arch/coze-design';\nimport {\n  insertToNewline,\n  type PromptContextInfo,\n} from '@coze-common/prompt-kit-base/shared';\n\nimport { RecommendCardLoading } from '../recommend-card/card-loading';\nimport { ViewAll, RecommendCard } from '../recommend-card';\nimport { useGetLibrarys } from '../hooks/use-get-librarys';\nimport { useScrollControl } from '../hooks/use-case/use-scroll-control';\nimport { usePromptLibraryModal } from '../../prompt-library';\nimport { EmptyRecommend } from './empty';\n\nimport styles from './index.module.less';\n\nimport '@coze-common/prompt-kit-base/shared/css';\nimport { LeftScrollButton, RightScrollButton } from './scroll-button';\nconst LIMIT_LIBRARY_SIZE = 6;\n\ntype TabType = 'Recommended' | 'Team';\nconst getTabLabelMap = (isPersonal: boolean) => ({\n  Recommended: I18n.t('prompt_resource_recommended'),\n  Team: isPersonal\n    ? I18n.t('prompt_resource_personal')\n    : I18n.t('prompt_resource_team'),\n});\n\ninterface ActionExtraInfo {\n  id: string;\n  category: string;\n}\n\ninterface RecommendPannelProps {\n  className?: string;\n  cardClassName?: string;\n  listContainerClassName?: string;\n  tabs: TabType[];\n  /** For event tracking: page source */\n  source: string;\n  importPromptWhenEmpty?: string;\n  spaceId: string;\n  /** For event tracking: bot_id */\n  botId?: string;\n  /** For event tracking: project_id */\n  projectId?: string;\n  /** For event tracking: workflow_id */\n  workflowId?: string;\n  isPersonal?: boolean;\n  enableLibrary?: boolean;\n  getConversationId?: () => string | undefined;\n  getPromptContextInfo?: () => PromptContextInfo;\n  onInsertPrompt?: (prompt: string, info?: ActionExtraInfo) => void;\n  onUpdateSuccess?: (\n    mode: 'create' | 'edit' | 'info',\n    info: ActionExtraInfo,\n  ) => void;\n  onCopyPrompt?: (info: ActionExtraInfo) => void;\n  onDeletePrompt?: (info: ActionExtraInfo) => void;\n  ref: ForwardedRef<RecommendPannelRef>;\n}\n/* eslint-disable @coze-arch/max-line-per-function */\nexport const Index = (props: RecommendPannelProps) => {\n  const domRef = useRef<HTMLDivElement | null>(null);\n  const {\n    className,\n    cardClassName,\n    listContainerClassName,\n    onInsertPrompt,\n    tabs,\n    spaceId,\n    enableLibrary = false,\n    getConversationId,\n    getPromptContextInfo,\n    importPromptWhenEmpty,\n    source,\n    botId,\n    projectId,\n    workflowId,\n    ref,\n    isPersonal = false,\n    onCopyPrompt,\n    onDeletePrompt,\n    onUpdateSuccess,\n  } = props;\n  const [activeTab, setActiveTab] = useState<(typeof tabs)[number]>(tabs[0]);\n  const editor = useEditor<EditorAPI>();\n\n  const handleInsertPrompt = async (prompt: string, id: string) => {\n    const insertPrompt = await insertToNewline({ editor, prompt });\n    onInsertPrompt?.(insertPrompt, { id, category: activeTab });\n  };\n\n  const { loading, data, runAsync } = useGetLibrarys();\n  const isEmpty = !loading && data?.[activeTab]?.length === 0;\n  const { open, node: PromptLibrary } = usePromptLibraryModal({\n    spaceId,\n    getConversationId,\n    editor,\n    isPersonal,\n    source,\n    botId,\n    projectId,\n    workflowId,\n    getPromptContextInfo,\n    importPromptWhenEmpty,\n    onInsertPrompt,\n    onUpdateSuccess: (mode, selectedLibrary) => {\n      runAsync(activeTab, {\n        space_id: spaceId,\n        size: LIMIT_LIBRARY_SIZE,\n      });\n      onUpdateSuccess?.(mode, selectedLibrary);\n    },\n    onCopyPrompt,\n    onDeletePrompt,\n  });\n  useEffect(() => {\n    if (!spaceId) {\n      return;\n    }\n    runAsync(activeTab, {\n      space_id: spaceId,\n      size: LIMIT_LIBRARY_SIZE,\n    });\n  }, [spaceId, activeTab]);\n\n  const { scrollRefs, canScrollLeft, canScrollRight, handleScroll } =\n    useScrollControl({\n      activeTab,\n      tabs,\n      loading,\n      data,\n    });\n\n  useImperativeHandle(ref, () => ({\n    refresh: (tab: 'Recommended' | 'Team') => {\n      runAsync(tab, {\n        space_id: spaceId,\n        size: LIMIT_LIBRARY_SIZE,\n      });\n    },\n  }));\n\n  return (\n    <div\n      ref={el => {\n        if (typeof ref === 'function') {\n          ref(null);\n        }\n        domRef.current = el;\n      }}\n      className={cls(\n        styles['recommend-pannel'],\n        'flex flex-col justify-between w-full',\n        'absolute bottom-0 left-0 right-0',\n        'py-3 px-5',\n        className,\n      )}\n    >\n      <Tabs\n        type=\"button\"\n        activeKey={activeTab}\n        onChange={key => setActiveTab(key as (typeof tabs)[number])}\n        tabBarExtraContent={\n          enableLibrary ? (\n            <div\n              className=\"coz-fg-primary text-sm flex items-center cursor-pointer font-medium\"\n              onClick={() => open({ defaultActiveTab: activeTab })}\n            >\n              <Button\n                icon={<IconCozArrowRightFill className=\"!coz-fg-primary\" />}\n                color=\"secondary\"\n                iconPosition=\"right\"\n              >\n                <span className=\"coz-fg-primary\">\n                  {I18n.t('workflow_prompt_editor_view_library')}\n                </span>\n              </Button>\n            </div>\n          ) : null\n        }\n      >\n        {tabs.map((item, index) => (\n          <TabPane\n            itemKey={item}\n            tab={getTabLabelMap(isPersonal)[item]}\n            className=\"relative\"\n          >\n            {canScrollLeft ? (\n              <LeftScrollButton handleScroll={() => handleScroll('left')} />\n            ) : null}\n            <div className=\"relative\">\n              <div\n                ref={el => (scrollRefs.current[index] = el)}\n                className={cls(\n                  'relative overflow-x-auto styled-scrollbar h-[120px] box-content hover-show-scrollbar',\n                  'flex-1',\n                  listContainerClassName,\n                )}\n              >\n                {isEmpty ? (\n                  <EmptyRecommend />\n                ) : (\n                  <div className=\"flex gap-3 flex-row flex-nowrap overflow-visible h-full min-w-min\">\n                    {loading\n                      ? Array.from({ length: LIMIT_LIBRARY_SIZE }).map(\n                          (_, _index) => <RecommendCardLoading key={_index} />,\n                        )\n                      : null}\n                    {data?.[item]?.map((card, _index) => (\n                      <RecommendCard\n                        className={cls(cardClassName)}\n                        key={card.id}\n                        id={card.id}\n                        position={_index === 0 ? 'topLeft' : 'top'}\n                        spaceId={spaceId}\n                        title={card.name}\n                        description={card.description}\n                        prompt={card.promptText}\n                        onInsertPrompt={prompt =>\n                          handleInsertPrompt(prompt, card.id)\n                        }\n                      />\n                    ))}\n                    <ViewAll onClick={() => open({ defaultActiveTab: item })} />\n                  </div>\n                )}\n              </div>\n              {canScrollRight ? (\n                <RightScrollButton handleScroll={() => handleScroll('right')} />\n              ) : null}\n            </div>\n          </TabPane>\n        ))}\n      </Tabs>\n      {PromptLibrary}\n    </div>\n  );\n};\n\ninterface RecommendPannelRef {\n  refresh: (tab: 'Recommended' | 'Team') => void;\n}\nexport const RecommendPannel = forwardRef<\n  RecommendPannelRef,\n  RecommendPannelProps\n>((props, ref) => <Index {...props} ref={ref} />);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type explore } from '@coze-studio/api-schema';\nimport { type UserInfo as ProductUserInfo } from '@coze-arch/bot-api/product_api';\ntype UserInfo = explore.product_common.UserInfo;\n\nexport interface CardInfoProps {\n  title?: string;\n  imgSrc?: string;\n  description?: string;\n  userInfo?: UserInfo | ProductUserInfo;\n}\n\n/** for open coze */\nexport enum PluginAuthMode {\n  /** No authorization required */\n  NoAuth = 0,\n  /** Authorization is required, but not configured */\n  Required = 1,\n  /** Authorization is required and has been configured */\n  Configured = 2,\n  /** Authorization is required, but the configuration can be empty */\n  Supported = 3,\n}\n\nexport interface AuthMode {\n  /** for open coze */\n  auth_mode?: PluginAuthMode;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\n\nexport type Int64 = string | number;\n\nexport enum AccountStatus {\n  Available = 1,\n  Unavailable = 2,\n}\n\n/**  */\nexport enum AgreementStatus {\n  /**  */\n  Closed = 0,\n  /**  */\n  InEffect = 1,\n}\n\nexport enum AmountType {\n  /** sku  */\n  Unknown = 0,\n  ChargeAmount = 1,\n}\n\n/**  benefit_common.thrift  */\nexport enum BenefitType {\n  /**  */\n  SubsMessageCredit = 1,\n  UserFreeChat = 2,\n  TopUpMessageCredit = 3,\n  BonusMessageCredit = 4,\n  /** 40 -59  */\n  Freetimes = 40,\n  /**  */\n  EvaluateFree = 41,\n  /** Workflow  */\n  WorkflowTestRunFree = 42,\n  /** App  */\n  AppTestRunFree = 43,\n  /** Plugin  */\n  PluginRunFree = 44,\n  /** API  */\n  APIRunFree = 45,\n  /** SDK  */\n  SDKRunFree = 46,\n  /** 60 - 99 \n RPM  */\n  RateLimitModelRPM = 60,\n  /**  Input TPM  */\n  RateLimitModelInputTPM = 61,\n  /**  Output TPM  */\n  RateLimitModelOutputTPM = 62,\n  /**  Input TPM  */\n  RateLimitModelInputTPMBasic = 63,\n  /**  Output TPM  */\n  RateLimitModelOutputTPMBasic = 64,\n  /** Plugin  QPS  */\n  PluginRunQPS = 65,\n  /** Plugin  */\n  PluginRunParallel = 66,\n  /** \nWorkflow  QPS  */\n  WorkflowRunQPS = 67,\n  /** Workflow  */\n  WorkflowRunParallel = 68,\n  /** API  QPS  */\n  APIRunQPS = 70,\n  /**  QPS  */\n  VoiceQPS = 71,\n  /**  */\n  VoiceParallel = 72,\n  /** 100-109 \n */\n  ResourcePoint = 100,\n  /**  */\n  FreeResourcePoint = 101,\n  /**  */\n  VolcProResourcePoint = 102,\n  /**  */\n  PeriodicResourcePoint = 103,\n  /**  */\n  ChannelResourcePoint = 104,\n  /**  */\n  CutAndTryResourcePoint = 109,\n  /** 110-129 Fornax\nTrace  */\n  TraceAmount = 111,\n  /** Trace  */\n  TraceStorageDuration = 112,\n  /** 130-149 WorkSpace\nSpace  */\n  SpaceAmount = 131,\n  /** Space  */\n  SpacePeopleNumber = 132,\n  /** Space  */\n  SpaceCollaboratorNumber = 133,\n  /** Space  */\n  SpaceCollabEntityNumber = 134,\n  /** 150-169 \n */\n  LogStorageDuration = 151,\n  /**  */\n  LogExport = 152,\n  /** 170-179 \n */\n  Capacity = 170,\n  /** 180-199 \n */\n  VoiceCloneNumber = 180,\n  /**  */\n  VoiceCloneNumberBasic = 181,\n  /** 200-219 \n */\n  SeatNumberLimit = 200,\n  /**  */\n  SeatNumberBasic = 201,\n  /**  */\n  RemoveWatermark = 220,\n  /** 240-269 \n */\n  ConfidenceUsing = 240,\n}\n\nexport enum BenefitUseMode {\n  /**  */\n  ByQuota = 1,\n  /**  */\n  Unlimited = 2,\n  /**  */\n  UnAvailable = 10,\n}\n\nexport enum ChargeableEntityType {\n  Unknown = 0,\n  Agent = 1,\n  Model = 10,\n  ModelTPM = 11,\n  Plugin = 20,\n  Imageflow = 21,\n  Voice = 30,\n  RealTime = 40,\n  Knowledge = 50,\n  Seat = 60,\n}\n\n/**  */\nexport enum ChargebackPayStatus {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Chargeback = 1,\n  /**  */\n  ChargebackReverse = 2,\n}\n\n/**  */\nexport enum ChargebackStatus {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Chargeback = 1,\n  /**  */\n  ChargebackReverse = 2,\n}\n\nexport enum ChargeScene {\n  Unknown = 0,\n  Token = 1,\n  Credit = 2,\n}\n\nexport enum CozeAccountType {\n  /**  */\n  Unknown = 0,\n  /**  */\n  Organization = 1,\n  /**  */\n  Personal = 2,\n}\n\nexport enum CreditChangeType {\n  TopUp = 1,\n  Bonus = 2,\n  /**  */\n  BotConsume = 3,\n  WorkflowConsume = 4,\n  EvaluateConsume = 5,\n  /**  */\n  ProjectConsume = 6,\n  /**  */\n  FornaxConsume = 7,\n  /**  */\n  IntelligentVoiceConsume = 8,\n  Expired = 20,\n}\n\nexport enum CreditType {\n  /**  */\n  Premium = 1,\n  TopUp = 2,\n  Bonus = 3,\n  /** \n */\n  FreePoint = 100,\n  /**  */\n  TopUpPonit = 101,\n}\n\nexport enum DiscountCalculationType {\n  Unknown = 0,\n  Multiplication = 1,\n  Subtraction = 2,\n}\n\nexport enum InstanceLimitStatus {\n  /**  */\n  UnLimited = 1,\n  /**  */\n  Limited = 2,\n}\n\nexport enum InstanceStatus {\n  /** ,  */\n  InstanceStatusCreating = 0,\n  /**  */\n  Running = 1,\n  /** ,  */\n  InstanceStatusFailed = 2,\n  /**  */\n  UnsubsRecycled = 3,\n  /**  */\n  ExpiredClosed = 4,\n  /**  */\n  ExpiredRecycled = 5,\n  /**  */\n  InstanceStatusOverdueShutdown = 6,\n  /**  */\n  InstanceStatusOverdueRecycled = 7,\n  /**  */\n  InstanceStatusTerminatedShutdown = 8,\n}\n\n/**  */\nexport enum OrderReverseStatus {\n  /**  */\n  Unknown = 0,\n  /**  */\n  RefundProcessing = 1,\n  /**  */\n  RefundSuccess = 2,\n  /**  */\n  RefundFailed = 3,\n  /**  */\n  Chargeback = 11,\n  /**  */\n  ChargebackReverse = 12,\n}\n\n/**  */\nexport enum OrderStatus {\n  /**  */\n  Init = 0,\n  /**  */\n  Success = 1,\n  /**  */\n  Failed = 2,\n  /**  */\n  Closed = 3,\n}\n\n/**  */\nexport enum OrderType {\n  /**  */\n  Unknown = 0,\n  /** Token */\n  TokenCharge = 1,\n  /** Token */\n  TokenAutoCharge = 2,\n  /** MessageCredit */\n  SubMessageCredit = 11,\n  /** MessageCredit */\n  MessageCredit = 12,\n  /**  */\n  PurchaseTemplate = 21,\n}\n\n/**  */\nexport enum PayStatus {\n  /**  */\n  Init = 0,\n  /**  */\n  Success = 1,\n  /**  */\n  Closed = 2,\n}\n\n/**  */\nexport enum RefundByType {\n  /**  */\n  ByBizPlatform = 0,\n  /**  */\n  ByUser = 1,\n}\n\n/**  */\nexport enum RefundPayStatus {\n  /**  */\n  Processing = 0,\n  /**  */\n  Success = 1,\n  /**  */\n  Failed = 2,\n}\n\n/**  */\nexport enum RefundStatus {\n  /**  */\n  Processing = 0,\n  /**  */\n  Success = 1,\n  /**  */\n  Failed = 2,\n}\n\nexport enum ResourcePackageType {\n  /** TPM */\n  ModelTPM = 1,\n  /**  */\n  VoiceClone = 21,\n}\n\nexport enum ResourceUsageStrategy {\n  /**  */\n  UnLimit = 1,\n  /**  */\n  Forbidden = 2,\n  /**  */\n  ByQuota = 3,\n}\n\n/**  */\nexport enum Scene {\n  /**  */\n  Unknown = 0,\n  /** Token */\n  TokenCharge = 1,\n  /** Token */\n  TokenAutoCharge = 2,\n  /** MessageCredit */\n  SubMessageCredit = 11,\n  /** MessageCredit */\n  MessageCredit = 12,\n  /**  */\n  PurchaseTemplate = 21,\n  /**  */\n  VoiceClone = 100,\n  /**  */\n  VoiceCloneStorage = 101,\n}\n\nexport enum SubscriptionRenewalType {\n  Unknown = 0,\n  /**  */\n  ManualRenewal = 1,\n  /**  */\n  AutoRenewal = 2,\n  /**  */\n  DontRenewal = 3,\n}\n\nexport enum SubscriptionStatus {\n  /**  */\n  Init = 0,\n  /**  */\n  Pending = 1,\n  /**  */\n  SUBSCRIBED = 2,\n  /**  */\n  CANCELED = 3,\n  /**  */\n  REVOKE = 4,\n  /**  */\n  Closed = 5,\n  /**  */\n  Expired = 6,\n  /**  */\n  InDebt = 7,\n}\n\nexport enum SubscriptionType {\n  MessageCredit = 0,\n}\n\n/**  SKU  */\nexport enum SubsMsgCreditLevel {\n  Free = 0,\n  PremiumLite = 10,\n  Premium = 15,\n  PremiumPlus = 20,\n}\n\nexport enum SubsSKUType {\n  /**  */\n  AutoRenew = 0,\n  /**  */\n  OneOff = 1,\n}\n\nexport enum TradeSourceType {\n  /**  */\n  Unknown = 0,\n  Bot = 1,\n}\n\nexport enum UserLevel {\n  /**  */\n  Free = 0,\n  /** \nPremiumLite */\n  PremiumLite = 10,\n  /** Premium */\n  Premium = 15,\n  PremiumPlus = 20,\n  /** \nV1 */\n  V1ProInstance = 100,\n  /**  */\n  ProPersonal = 110,\n  /**  */\n  Team = 120,\n  /**  */\n  Enterprise = 130,\n}\n\nexport enum VolcanoUserType {\n  Unknown = 0,\n  RootUser = 1,\n  BasicUser = 2,\n}\n\nexport enum VolcInstanceType {\n  /**  */\n  Normal = 1,\n  /**  */\n  Channel = 2,\n}\n\nexport interface ChannelInfo {\n  /** ID */\n  channel_id: string;\n  /**  */\n  channel_name: string;\n  /**  icon */\n  icon_url: string;\n}\n\nexport interface CommonCounter {\n  /**  Strategy == ByQuota , ,  0 */\n  used?: number;\n  /**  Strategy == ByQuota ,  */\n  total?: number;\n  /**  */\n  strategy?: ResourceUsageStrategy;\n  /**  */\n  start_at?: Int64;\n  /**  */\n  end_at?: Int64;\n}\n/* eslint-enable */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\nimport { IconOfficialLabel } from '@coze-arch/bot-icons';\n\nimport styles from './index.module.less';\n\n/**\n * small 16px\n * default 20px\n * large 32px\n */\nexport type OfficialLabelSize = 'small' | 'default' | 'large';\n\nexport interface OfficialLabelProps {\n  size?: OfficialLabelSize;\n  visible: boolean;\n  children?: React.ReactNode;\n  className?: string;\n}\n\nexport const OfficialLabelSizeMap = {\n  small: styles.small,\n  default: styles.default,\n  large: styles.large,\n};\n\nexport const OfficialLabel: React.FC<OfficialLabelProps> = ({\n  size = 'default',\n  children,\n  visible,\n  className,\n}) => (\n  <div className=\"relative w-fit h-fit\">\n    <Tooltip\n      spacing={12}\n      trigger={visible ? 'hover' : 'custom'}\n      content={I18n.t('mkpl_plugin_tooltip_official')}\n    >\n      {visible ? (\n        <IconOfficialLabel\n          className={classNames(\n            styles['official-label'],\n            OfficialLabelSizeMap[size],\n            className,\n          )}\n        />\n      ) : null}\n    </Tooltip>\n    {children}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useState,\n  useRef,\n  useEffect,\n  type Dispatch,\n  type SetStateAction,\n} from 'react';\n\nimport {\n  useInfiniteScroll,\n  useUpdateEffect,\n  useMemoizedFn,\n  useDebounceFn,\n} from 'ahooks';\n\nimport { type ScrollProps, type InfiniteListDataProps } from '../type';\n\n/* Rolling Hooks */\n\nfunction useForwardFunc<T>(\n  dataInfo: InfiniteListDataProps<T>,\n  mutate: Dispatch<SetStateAction<InfiniteListDataProps<T>>>,\n) {\n  // Insert data manually, without going through the interface\n  const insertData = (item, index) => {\n    dataInfo.list.splice(index, 0, item);\n    mutate({\n      ...dataInfo,\n      list: [...(dataInfo?.list || [])],\n    });\n  };\n\n  // Delete data manually, without going through the interface\n  const removeData = index => {\n    dataInfo.list.splice(index, 1);\n    mutate({\n      ...dataInfo,\n      list: [...(dataInfo?.list || [])],\n    });\n  };\n\n  const getDataList = () => dataInfo?.list;\n\n  return { insertData, removeData, getDataList };\n}\n\n// eslint-disable-next-line max-lines-per-function, @coze-arch/max-line-per-function -- the number of lines of code is not very good optimization\nfunction useScroll<T>(props: ScrollProps<T>) {\n  const {\n    targetRef,\n    loadData,\n    threshold,\n    reloadDeps,\n    isNeedBtnLoadMore,\n    resetDataIfReload = true,\n  } = props;\n  const [isLoadingError, setIsLoadingError] = useState<boolean>(false);\n  const refFetchNo = useRef<number>(0);\n  const refResolve = useRef<(value) => void>();\n  const {\n    loading,\n    data: dataInfo,\n    loadingMore,\n    loadMore,\n    noMore,\n    cancel,\n    mutate,\n    reload,\n  } = useInfiniteScroll<InfiniteListDataProps<T>>(\n    async current => {\n      // The logic here is so complex that it solves the bug in Scroll.\n      // The cancel in useInfiniteScroll simply cancels a request, but the data is reset based on the current.\n      const fetchNo = refFetchNo.current;\n      if (refResolve.current) {\n        // Guaranteed sequential execution, if there is a current method, cancel the last request to prevent data overwriting problems due to network reasons\n        // At the same time, A1, A2, and three requests were issued, but A1 arrived first, and then B1 was requested, but A1 was too slow, causing A1 to overwrite B1's request.\n        refResolve.current({\n          ...(current || {}),\n          list: [],\n        });\n      }\n\n      const result = await new Promise((resolve, reject) => {\n        refResolve.current = resolve;\n        loadData(current)\n          .then(value => resolve(value))\n          .catch(err => reject(err));\n      });\n\n      // @ts-expect-error -- linter-disable-autofix\n      refResolve.current = null;\n\n      // When switching tabs, if you are requesting at this time, prevent the residual interface display of the data\n      if (refFetchNo.current !== fetchNo) {\n        if (current) {\n          current.list = [];\n        }\n        return {\n          list: [],\n          nextPage: 1,\n        };\n      }\n      return result as InfiniteListDataProps<T>;\n    },\n    {\n      target: isLoadingError || isNeedBtnLoadMore ? null : targetRef, //When it fails, scrolling loading is prohibited by removing the event binding of the target.\n      threshold,\n      onBefore: () => {\n        //setIsLoadingError(false);\n      },\n      isNoMore: data => data?.hasMore !== undefined && !data?.hasMore,\n      onSuccess: () => {\n        if (isLoadingError) {\n          setIsLoadingError(false);\n        }\n      },\n      onError: e => {\n        // If an error occurs when requesting the first page of data and the current list is not empty, reset the data\n        // This case only occurs when resetDataIfReload is set to false\n        // @ts-expect-error -- linter-disable-autofix\n        if (dataInfo.nextPage === 1 && (dataInfo?.list?.length ?? 0) > 0) {\n          // @ts-expect-error -- linter-disable-autofix\n          mutate({\n            ...dataInfo,\n            list: [],\n          });\n        }\n        setIsLoadingError(true);\n      },\n    },\n  );\n\n  const { insertData, removeData, getDataList } = useForwardFunc(\n    // @ts-expect-error -- linter-disable-autofix\n    dataInfo,\n    mutate,\n  );\n\n  useEffect(() => {\n    if (isNeedBtnLoadMore && !(loading || loadingMore)) {\n      reload();\n    }\n  }, []);\n\n  const reloadData = useMemoizedFn(() => {\n    mutate({\n      list: resetDataIfReload ? [] : dataInfo?.list ?? [],\n      hasMore: undefined,\n      nextPage: 1,\n    });\n    cancel();\n    setIsLoadingError(false);\n    reload();\n  });\n\n  useUpdateEffect(() => {\n    refFetchNo.current++;\n    reloadData();\n  }, [...(reloadDeps || [])]);\n  const isLoading = loading || loadingMore || props.isLoading;\n  const { run: loadMoreDebounce } = useDebounceFn(\n    () => {\n      if (isLoading) {\n        return;\n      }\n      if (!isNeedBtnLoadMore) {\n        loadMore();\n      }\n    },\n    { wait: 500 },\n  );\n  useEffect(() => {\n    const resize = () => {\n      loadMoreDebounce();\n    };\n    window.addEventListener('resize', resize);\n    return () => {\n      window.removeEventListener('resize', resize);\n    };\n  }, []);\n  const { list } = dataInfo || {};\n  return {\n    dataList: list,\n    isLoading,\n    loadMore: () => {\n      if (!isLoading) {\n        //If there is already data loading, you need to prohibit repeated loading.\n        loadMore();\n      }\n    },\n    reload: reloadData,\n    noMore,\n    cancel,\n    isLoadingError,\n    mutate,\n    insertData,\n    removeData,\n    getDataList,\n  };\n}\n\nexport default useScroll;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Spin, UIButton } from '@coze-arch/bot-semi';\nimport { useIsResponsive } from '@coze-arch/bot-hooks';\n\nimport { type FooterProps } from '../../type';\n\nimport s from './index.module.less';\n\n/* Plugin header */\n\nfunction Index(props: FooterProps) {\n  const {\n    isLoading,\n    loadRetry,\n    isError,\n    renderFooter,\n    isNeedBtnLoadMore,\n    noMore,\n  } = props;\n  const isResponsive = useIsResponsive();\n\n  return (\n    <div\n      className={classNames(s['footer-container'], {\n        [s['responsive-foot-container']]: isResponsive,\n      })}\n    >\n      {renderFooter?.(props) ||\n        (isLoading ? (\n          <>\n            <Spin />\n            <span className={s.loading}>{I18n.t('Loading')}</span>\n          </>\n        ) : isError ? (\n          <>\n            <Spin />\n            <span className={s['error-retry']} onClick={loadRetry}>\n              {I18n.t('inifinit_list_retry')}\n            </span>\n          </>\n        ) : isNeedBtnLoadMore && !noMore ? (\n          <UIButton\n            onClick={loadRetry}\n            className={s['load-more-btn']}\n            theme=\"borderless\"\n          >\n            {I18n.t('mkpl_load_btn')}\n          </UIButton>\n        ) : null)}\n    </div>\n  );\n}\n\nexport default Index;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { UIEmpty, Spin } from '@coze-arch/bot-semi';\nimport { IllustrationFailure } from '@douyinfe/semi-illustrations';\n\nimport { type EmptyProps } from '../../type';\n\nimport s from './index.module.less';\n\n/* Plugin header */\n\nfunction Index(props: EmptyProps) {\n  const {\n    isLoading,\n    isSearching,\n    loadRetry,\n    isError,\n    renderEmpty,\n    text,\n    btn,\n    icon,\n  } = props;\n  return (\n    <div className={s.empty}>\n      {renderEmpty?.(props) ||\n        (!isError ? (\n          isLoading ? (\n            <Spin\n              tip={\n                <span className={s['loading-text']}>{I18n.t('Loading')}</span>\n              }\n              wrapperClassName={s.spin}\n              size=\"middle\"\n            />\n          ) : (\n            <UIEmpty\n              isNotFound={!!isSearching}\n              empty={{\n                title: text?.emptyTitle || I18n.t('inifinit_list_empty_title'),\n                description: text?.emptyTitle ? text?.emptyDesc : '',\n                btnText: btn?.emptyText,\n                btnOnClick: btn?.emptyClick,\n                icon,\n              }}\n              notFound={{\n                title:\n                  text?.searchEmptyTitle || I18n.t('inifinit_search_not_found'),\n              }}\n            />\n          )\n        ) : (\n          <UIEmpty\n            empty={{\n              title: I18n.t('inifinit_list_load_fail'),\n              icon: <IllustrationFailure />,\n              btnText: loadRetry && I18n.t('inifinit_list_retry'),\n              btnOnClick: () => {\n                loadRetry?.();\n              },\n            }}\n          />\n        ))}\n    </div>\n  );\n}\n\nexport default Index;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  forwardRef,\n  useImperativeHandle,\n  type RefObject,\n  useEffect,\n} from 'react';\n\nimport cls from 'classnames';\nimport { ResponsiveList } from '@coze-arch/responsive-kit';\nimport { List } from '@coze-arch/bot-semi';\n\nimport { type InfiniteListProps, type InfiniteListRef } from './type';\nimport useScroll from './hooks/use-scroll';\nimport Footer from './components/footer';\nimport Empty from './components/empty';\n\nimport s from './index.module.less';\n\n/* Plugin header */\n\nfunction Index<T extends object>(props: InfiniteListProps<T>, ref) {\n  const {\n    isSearching,\n    className,\n    emptyContent,\n    grid,\n    renderItem,\n    itemClassName,\n    renderFooter,\n    scrollConf,\n    emptyConf,\n    onChangeState,\n    canShowData = true,\n    isNeedBtnLoadMore = false,\n    isResponsive,\n    retryFunc,\n    responsiveConf,\n    containerClassName,\n  } = props;\n\n  const {\n    dataList,\n    isLoading,\n    loadMore,\n    noMore,\n    isLoadingError,\n    mutate,\n    reload,\n    insertData,\n    removeData,\n    getDataList,\n  } = useScroll<T>({ ...scrollConf, isNeedBtnLoadMore });\n\n  useImperativeHandle(\n    ref,\n    () => ({ mutate, reload, insertData, removeData, getDataList }),\n    [mutate, reload, insertData, removeData, getDataList],\n  );\n  useEffect(() => {\n    onChangeState?.(isLoading, dataList);\n  }, [dataList, isLoading]);\n\n  // Adapt the mobile end of the list according to the whitelist\n\n  return (\n    <div className={cls(s['height-whole-100'], containerClassName)}>\n      {!dataList?.length || !canShowData ? (\n        /** How to display an empty page when the data is empty */\n        <Empty\n          isError={canShowData ? isLoadingError : false}\n          isSearching={isSearching}\n          isLoading={canShowData ? isLoading : true}\n          loadRetry={retryFunc || loadMore}\n          {...emptyConf}\n        />\n      ) : isResponsive ? (\n        <ResponsiveList<T>\n          className={className}\n          emptyContent={isLoading ? <></> : emptyContent}\n          dataSource={dataList}\n          renderItem={(item, number) => renderItem?.(item, number)}\n          gridCols={responsiveConf?.gridCols}\n          gridGapXs={{\n            basic: 4,\n          }}\n          footer={\n            <div className=\"text-sm px-6 py-3\">\n              <Footer\n                isError={isLoadingError}\n                noMore={noMore}\n                isLoading={isLoading}\n                loadRetry={retryFunc || loadMore}\n                renderFooter={renderFooter}\n                isNeedBtnLoadMore={isNeedBtnLoadMore}\n              />\n            </div>\n          }\n        />\n      ) : (\n        <List\n          {...{ className, emptyContent, grid }}\n          emptyContent={isLoading ? <></> : emptyContent}\n          dataSource={dataList}\n          split={false}\n          renderItem={(item, number) => (\n            <List.Item\n              className={\n                typeof itemClassName === 'string'\n                  ? itemClassName\n                  : itemClassName?.(item) // Support dynamic row className\n              }\n            >\n              {renderItem?.(item, number)}\n            </List.Item>\n          )}\n          footer={\n            <Footer\n              isError={isLoadingError}\n              noMore={noMore}\n              isLoading={isLoading}\n              loadRetry={retryFunc || loadMore}\n              renderFooter={renderFooter}\n              isNeedBtnLoadMore={isNeedBtnLoadMore}\n              dataNum={dataList?.length}\n            />\n          }\n        />\n      )}\n    </div>\n  );\n}\n\nexport const InfiniteList = forwardRef(Index) as <T>(\n  props: InfiniteListProps<T> & { ref?: RefObject<InfiniteListRef> },\n) => JSX.Element;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { CozAvatar, Tag, Tooltip, Typography } from '@coze-arch/coze-design';\nimport { type PluginConnectorInfo } from '@coze-arch/bot-api/product_api';\n\nimport styles from './index.module.less';\n\ninterface ConnectorListProps {\n  connectors: PluginConnectorInfo[];\n  className?: string;\n  visibleNum?: number;\n}\n\nconst DEFAULT_VISIBLE_NUM = 3;\n\nexport const ConnectorList: React.FC<ConnectorListProps> = ({\n  connectors,\n  className,\n  visibleNum = DEFAULT_VISIBLE_NUM,\n}) => {\n  const moreNum = connectors.length - visibleNum;\n  return (\n    <div className={classNames('ml-auto flex gap-4px', className)}>\n      {connectors.slice(0, visibleNum).map(item => (\n        <Tooltip key={item.id} content={item.name} theme=\"dark\">\n          <CozAvatar\n            className=\"border coz-stroke-primary border-solid\"\n            size=\"micro\"\n            src={item.icon}\n            type=\"platform\"\n          />\n        </Tooltip>\n      ))}\n      {moreNum > 0 ? (\n        <Tooltip\n          position=\"right\"\n          content={\n            <div className=\"flex flex-col gap-8px max-w-[200px] max-h-[188px] overflow-y-auto overflow-x-hidden\">\n              {connectors.slice(visibleNum).map(item => (\n                <div\n                  key={item.id}\n                  className=\"flex gap-8px items-center max-w-full\"\n                >\n                  <CozAvatar\n                    className=\"border coz-stroke-primary border-solid\"\n                    size=\"micro\"\n                    src={item.icon}\n                    type=\"platform\"\n                  />\n                  <Typography.Text\n                    ellipsis={true}\n                    className=\"flex-1 overflow-hidden\"\n                  >\n                    {item.name}\n                  </Typography.Text>\n                </div>\n              ))}\n            </div>\n          }\n        >\n          <Tag className={styles.more} size=\"mini\" color=\"primary\">\n            +{moreNum}\n          </Tag>\n        </Tooltip>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemoizedFn } from 'ahooks';\nimport { type ProductEntityType } from '@coze-arch/bot-api/product_api';\nimport { ProductApi } from '@coze-arch/bot-api';\nimport { cozeMitt } from '@coze-common/coze-mitt';\n\nimport { type FavoriteCommParams } from '../type';\nexport const useFavoriteStatusRequest = ({\n  productId,\n  entityType,\n  entityId,\n  topicId,\n  onChange,\n  setIsFavorite,\n}: FavoriteCommParams & {\n  setIsFavorite: (isFavorite: boolean) => void;\n}) => {\n  const changeFavoriteStatus = useMemoizedFn(\n    async (isCurFavorite: boolean, action: string) => {\n      setIsFavorite(!isCurFavorite);\n      try {\n        await ProductApi.PublicFavoriteProduct({\n          // Backend cannot handle empty strings\n          product_id: productId || undefined,\n          entity_type: entityType as ProductEntityType,\n          is_cancel: isCurFavorite,\n          entity_id: entityId,\n          topic_id: topicId,\n        });\n        onChange?.(isCurFavorite ? -1 : 1);\n        cozeMitt.emit('refreshFavList', {\n          id: entityId,\n          numDelta: action === 'add' ? 1 : -1,\n          emitPosition: 'favorite-icon-btn',\n        });\n      } catch (_err) {\n        setIsFavorite(isCurFavorite);\n      }\n    },\n  );\n  return { changeFavoriteStatus };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useMemoizedFn } from 'ahooks';\n\nexport const useAnimationChange = ({ isVisible }: { isVisible?: boolean }) => {\n  const [isShowAni, setIsShowAni] = useState(false);\n  useEffect(() => {\n    if (!isVisible) {\n      setIsShowAni(false);\n    }\n  }, [isVisible]);\n  const changeAnimationStatus = useMemoizedFn((isCurFavorite: boolean) => {\n    if (!isCurFavorite) {\n      setIsShowAni(true);\n    } else {\n      setIsShowAni(false);\n    }\n  });\n  return { isShowAni, changeAnimationStatus };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useCallback, useRef, type MouseEvent } from 'react';\n\nimport { useMemoizedFn, useUpdateEffect } from 'ahooks';\n\nimport { type FavoriteCommParams } from '../type';\nimport { useFavoriteStatusRequest } from './use-farvorite-request';\nimport { useAnimationChange } from './use-animation-change';\n\ntype ClickAction = 'cancel' | 'add';\nconst getClickAction = (isCurFavoriteStatus: boolean): ClickAction =>\n  isCurFavoriteStatus ? 'cancel' : 'add';\n\nexport const useFavoriteChange = ({\n  isFavoriteDefault,\n  onReportTea,\n  productId,\n  entityId,\n  entityType,\n  onChange,\n  onClickBefore,\n  topicId,\n  isVisible,\n  onFavoriteStateChange,\n}: FavoriteCommParams & {\n  onReportTea?: (action: 'cancel' | 'add') => void;\n  isFavoriteDefault?: boolean;\n  isVisible?: boolean;\n  onFavoriteStateChange?: (isFavorite: boolean) => void;\n}) => {\n  const [isFavorite, setIsFavorite] = useState<boolean>(\n    isFavoriteDefault ?? false,\n  );\n  const { isShowAni, changeAnimationStatus } = useAnimationChange({\n    isVisible,\n  });\n  const refIsChange = useRef(false);\n\n  // Before changing the state, make a pre-request to determine whether the state change needs to be abandoned. If onClickBefore returns false, no change will be made.\n  const onClickBeforeHandle = useMemoizedFn(\n    async (\n      action: ClickAction,\n      event?: MouseEvent<HTMLDivElement, globalThis.MouseEvent>,\n    ) => (await onClickBefore?.(action, event)) !== false,\n  );\n  const { changeFavoriteStatus } = useFavoriteStatusRequest({\n    productId,\n    entityType,\n    entityId,\n    topicId,\n    onChange,\n    setIsFavorite,\n  });\n\n  const onClick = useCallback(\n    async (event?: MouseEvent<HTMLDivElement, globalThis.MouseEvent>) => {\n      if (refIsChange.current) {\n        // In progress, return directly, no processing\n        event?.stopPropagation?.();\n        event?.preventDefault?.();\n        return;\n      }\n      const action = getClickAction(isFavorite);\n      refIsChange.current = true;\n      try {\n        if ((await onClickBeforeHandle(action, event)) !== false) {\n          event?.stopPropagation?.();\n          onReportTea?.(action);\n          changeAnimationStatus(isFavorite);\n          await changeFavoriteStatus(isFavorite, action);\n        }\n      } catch (_err) {\n        console.error('useFavoriteChange:', _err);\n      }\n      refIsChange.current = false;\n    },\n    [isFavorite, onReportTea],\n  );\n\n  useUpdateEffect(() => {\n    onFavoriteStateChange?.(isFavorite);\n  }, [isFavorite]);\n  return { isFavorite, onClick, isShowAni };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { IconMobileCollect, IconMobileCollectFill } from '@coze-arch/bot-icons';\n\nexport const FavoriteIconMobile = (props: { isFavorite?: boolean }) => {\n  const { isFavorite } = props;\n  return <>{isFavorite ? <IconMobileCollectFill /> : <IconMobileCollect />}</>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cls from 'classnames';\nimport { IconButton } from '@coze-arch/coze-design';\nimport { IconCollectFilled, IconCollectStroked } from '@coze-arch/bot-icons';\n\nimport styles from './index.module.less';\n\nexport const FavoriteIcon = (props: {\n  isFavorite?: boolean;\n  isShowAni: boolean;\n  unCollectedIconCls?: string;\n  isMobile?: boolean;\n  useButton?: boolean;\n  className?: string;\n}) => {\n  const { isFavorite, isShowAni, className, unCollectedIconCls, useButton } =\n    props;\n\n  const iconProps = {\n    className: cls(\n      isFavorite ? styles['icon-filled'] : styles['icon-stroked'],\n      isFavorite ? className : unCollectedIconCls,\n      {\n        [styles['show-ani']]: isFavorite && isShowAni,\n        [styles['show-btn']]: useButton,\n      },\n    ),\n  };\n\n  const icon = isFavorite ? (\n    <IconCollectFilled {...iconProps} />\n  ) : (\n    <IconCollectStroked {...iconProps} />\n  );\n\n  if (useButton) {\n    return <IconButton size=\"default\" color=\"primary\" icon={icon} />;\n  }\n\n  return icon;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { forwardRef, useImperativeHandle } from 'react';\n\nimport { type FavoriteIconBtnProps } from './type';\nimport { useFavoriteChange } from './hooks/use-favorite-change';\nimport { FavoriteIconMobile } from './components/favorite-icon-mobile';\nimport { FavoriteIcon } from './components/favorite-icon';\n\nimport styles from './index.module.less';\n\nexport interface FavoriteIconBtnRef {\n  favorite: (event) => void;\n}\n\nexport const FavoriteIconBtn = forwardRef(\n  (props: FavoriteIconBtnProps, ref) => {\n    const {\n      topicId,\n      productId,\n      entityType,\n      entityId,\n      isFavorite: isFavoriteDefault,\n      onChange,\n      isVisible,\n      onReportTea,\n      unCollectedIconCls,\n      onClickBefore,\n      onFavoriteStateChange,\n      isMobile,\n      className,\n      useButton = false,\n      isForbiddenClick = false,\n    } = props;\n\n    const { isFavorite, onClick, isShowAni } = useFavoriteChange({\n      isFavoriteDefault,\n      onReportTea,\n      productId,\n      entityId,\n      entityType,\n      onChange,\n      onClickBefore,\n      topicId,\n      isVisible,\n      onFavoriteStateChange,\n    });\n\n    useImperativeHandle(\n      ref,\n      () => ({\n        favorite: onClick,\n      }),\n      [onClick],\n    );\n\n    if (!isVisible) {\n      return null;\n    }\n    return (\n      <div\n        onClick={isForbiddenClick ? undefined : onClick}\n        className={styles['favorite-icon-btn']}\n        data-testid=\"bot-card-favorite-icon\"\n      >\n        {isMobile ? (\n          <FavoriteIconMobile isFavorite={isFavorite} />\n        ) : (\n          <FavoriteIcon\n            useButton={useButton}\n            isFavorite={isFavorite}\n            isShowAni={isShowAni}\n            unCollectedIconCls={unCollectedIconCls}\n            className={className}\n          />\n        )}\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type ReactNode } from 'react';\n\nimport classNames from 'classnames';\nimport { Typography } from '@coze-arch/coze-design';\n\nexport interface SubMenuItemProps {\n  icon?: ReactNode;\n  title?: string;\n  activeIcon?: ReactNode;\n  isActive: boolean;\n  suffix?: ReactNode;\n  onClick: () => void;\n}\n\nexport const SubMenuItem: FC<SubMenuItemProps> = ({\n  icon = null,\n  title,\n  activeIcon = null,\n  isActive,\n  suffix,\n  onClick,\n}) => (\n  <div\n    onClick={onClick}\n    className={classNames(\n      'flex items-center gap-[8px]',\n      'transition-colors',\n      'rounded-[8px]',\n      'h-[32px] w-full',\n      'px-[8px]',\n      'cursor-pointer',\n      'hover:coz-mg-primary-hovered',\n      isActive ? 'coz-bg-primary coz-fg-plus' : 'coz-fg-primary coz-bg-max',\n    )}\n  >\n    <div className=\"text-[16px] leading-none leading-none w-[16px] h-[16px]\">\n      {isActive ? activeIcon : icon}\n    </div>\n    <Typography.Text\n      ellipsis={{ showTooltip: true, rows: 1 }}\n      fontSize=\"14px\"\n      weight={500}\n      className=\"flex-1 text-[14px] leading-[20px] font-[500]\"\n    >\n      {title}\n    </Typography.Text>\n    {suffix}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport {\n  IconCozBot,\n  IconCozWorkflow,\n  IconCozWorkspace,\n} from '@coze-arch/coze-design/icons';\nimport { Tag, type TagProps } from '@coze-arch/coze-design';\nimport { ProductEntityType } from '@coze-arch/bot-api/product_api';\n\ninterface IProps {\n  type: ProductEntityType;\n}\n\ninterface TagConfig {\n  icon: ReactNode;\n  i18nKey: I18nKeysNoOptionsType;\n}\n\nconst TYPE_ICON_MAP: Partial<Record<ProductEntityType, TagConfig>> = {\n  [ProductEntityType.BotTemplate]: {\n    icon: <IconCozBot />,\n    i18nKey: 'template_agent',\n  },\n  [ProductEntityType.WorkflowTemplateV2]: {\n    icon: <IconCozWorkflow />,\n    i18nKey: 'template_workflow',\n  },\n  [ProductEntityType.ImageflowTemplateV2]: {\n    icon: <IconCozWorkflow />,\n    i18nKey: 'template_workflow',\n  },\n  [ProductEntityType.ProjectTemplate]: {\n    icon: <IconCozWorkspace />,\n    i18nKey: 'project_store_search',\n  },\n};\n\nconst TYPE_COLOR_MAP: Partial<Record<ProductEntityType, TagProps['color']>> = {\n  [ProductEntityType.BotTemplate]: 'primary',\n  [ProductEntityType.WorkflowTemplateV2]: 'primary',\n  [ProductEntityType.ImageflowTemplateV2]: 'primary',\n  [ProductEntityType.ProjectTemplate]: 'brand',\n};\n\nexport const CardTag = ({ type }: IProps) => {\n  const config = TYPE_ICON_MAP[type];\n  if (!config) {\n    return null;\n  }\n\n  return (\n    <Tag\n      color={TYPE_COLOR_MAP[type] ?? 'primary'}\n      className=\"h-[20px] !px-[4px] !py-[2px] coz-fg-primary font-medium shrink-0\"\n    >\n      {config.icon}\n      <span className=\"ml-[2px]\">{I18n.t(config.i18nKey)}</span>\n    </Tag>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport cls from 'classnames';\nimport { AvatarName } from '@coze-studio/components';\nimport { type explore } from '@coze-studio/api-schema';\nimport { type UserInfo as ProductUserInfo } from '@coze-arch/bot-api/product_api';\nimport { Typography } from '@coze-arch/coze-design';\n\ntype UserInfo = explore.product_common.UserInfo | ProductUserInfo;\ninterface TemplateCardBodyProps {\n  title?: string;\n  description?: string;\n  userInfo?: UserInfo;\n  descClassName?: string;\n  renderCardTag?: () => React.ReactNode;\n  renderDescBottomSlot?: () => React.ReactNode;\n}\nexport const CardInfo: FC<TemplateCardBodyProps> = ({\n  title,\n  description,\n  userInfo,\n  renderCardTag,\n  descClassName,\n  renderDescBottomSlot,\n}) => (\n  <div className={cls('mt-[8px] px-[4px] grow', 'flex flex-col')}>\n    <div className=\"flex items-center gap-[8px] overflow-hidden\">\n      <Typography.Text\n        className=\"!font-medium text-[16px] leading-[22px] coz-fg-primary !max-w-[180px]\"\n        ellipsis={{ showTooltip: true, rows: 1 }}\n      >\n        {title}\n      </Typography.Text>\n      {renderCardTag?.()}\n    </div>\n\n    <AvatarName\n      className=\"mt-[4px]\"\n      avatar={userInfo?.avatar_url}\n      name={userInfo?.name}\n      username={userInfo?.user_name}\n      label={{\n        name: userInfo?.user_label?.label_name,\n        icon: userInfo?.user_label?.icon_url,\n        href: userInfo?.user_label?.jump_link,\n      }}\n    />\n\n    <div\n      className={cls(\n        'mt-[8px] flex flex-col justify-between grow',\n        descClassName,\n      )}\n    >\n      <Typography.Text\n        className=\"min-h-[40px] leading-[20px] coz-fg-secondary\"\n        ellipsis={{ showTooltip: true, rows: 2 }}\n      >\n        {description}\n      </Typography.Text>\n      {renderDescBottomSlot?.()}\n    </div>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\n\nimport s from './index.module.less';\n\nconst Container = (props: {\n  className?: string;\n  children?: React.ReactNode;\n  shadowMode?: 'default' | 'primary';\n  onClick?: () => void;\n}) => {\n  const { className, children, onClick, shadowMode } = props;\n\n  return (\n    <div\n      className={classNames(\n        'coz-bg-max',\n        s.container,\n        s.width100,\n        className,\n        s[`shadow-${shadowMode}`],\n      )}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n};\n\nconst SkeletonContainer = (props: {\n  children?: React.ReactNode;\n  className?: string;\n}) => (\n  <div\n    className={classNames(\n      'coz-mg-primary',\n      s.container,\n      s.width100,\n      s.skeleton,\n      props.className,\n    )}\n  >\n    {props?.children}\n  </div>\n);\n\nexport const CardContainer = Container;\nexport const CardSkeletonContainer = SkeletonContainer;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type PropsWithChildren } from 'react';\n\nimport cls from 'classnames';\n\nimport styles from './index.module.less';\n\nexport const CardButton: FC<\n  PropsWithChildren<{\n    className?: string;\n    onClick?: () => void;\n  }>\n> = ({ className, onClick, children }) => (\n  <button\n    className={cls(styles['card-button'], className)}\n    color=\"primary\"\n    onClick={onClick}\n  >\n    {children}\n  </button>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport cls from 'classnames';\nimport { explore } from '@coze-studio/api-schema';\nimport { useSpaceList } from '@coze-foundation/space-store';\nimport { I18n } from '@coze-arch/i18n';\nimport { Image, Input, Modal, Space, Toast } from '@coze-arch/coze-design';\nimport { type ProductEntityType } from '@coze-arch/bot-api/product_api';\n\nimport { type CardInfoProps } from '../type';\nimport { CardTag } from '../components/tag';\nimport { CardInfo } from '../components/info';\nimport { CardContainer, CardSkeletonContainer } from '../components/container';\nimport { CardButton } from '../components/button';\n\ntype ProductInfo = explore.ProductInfo;\nimport styles from './index.module.less';\n\nexport type TemplateCardProps = ProductInfo;\n\nexport const TemplateCard: FC<TemplateCardProps> = props => {\n  const [visible, setVisible] = useState(false);\n  return (\n    <CardContainer className={styles.template} shadowMode=\"default\">\n      <div className={styles['template-wrapper']}>\n        <TempCardBody\n          {...{\n            title: props.meta_info?.name,\n            description: props.meta_info?.description,\n            userInfo: props.meta_info?.user_info,\n            entityType: props.meta_info.entity_type,\n            imgSrc: props.meta_info.covers?.[0].url,\n          }}\n        />\n        <Space className={styles['btn-container']}>\n          <CardButton\n            onClick={() => {\n              setVisible(true);\n            }}\n            className=\"w-full\"\n          >\n            {I18n.t('copy')}\n          </CardButton>\n        </Space>\n      </div>\n      {visible ? (\n        <DuplicateModal\n          productId={props.meta_info.id}\n          entityType={props.meta_info.entity_type}\n          defaultTitle={`${props.meta_info?.name}(${I18n.t(\n            'duplicate_rename_copy',\n          )})`}\n          hide={() => setVisible(false)}\n        />\n      ) : null}\n    </CardContainer>\n  );\n};\n\nconst DuplicateModal: FC<{\n  defaultTitle: string;\n  productId: string;\n  entityType: explore.product_common.ProductEntityType;\n  hide: () => void;\n}> = ({ defaultTitle, hide, productId, entityType }) => {\n  const [title, setTitle] = useState(defaultTitle);\n  const { spaces } = useSpaceList();\n  const spaceId = spaces?.[0]?.id;\n  return (\n    <Modal\n      type=\"modal\"\n      title={I18n.t('creat_project_use_template')}\n      visible={true}\n      onOk={async () => {\n        try {\n          await explore.PublicDuplicateProduct({\n            product_id: productId,\n            entity_type: entityType,\n            space_id: spaceId,\n            name: title,\n          });\n          Toast.success(I18n.t('copy_success'));\n          hide();\n        } catch (err) {\n          console.error('PublicDuplicateProduct', err);\n          Toast.error(I18n.t('copy_failed'));\n        }\n      }}\n      onCancel={hide}\n      cancelText={I18n.t('Cancel')}\n      okText={I18n.t('Confirm')}\n    >\n      <Space vertical spacing={4} className=\"w-full\">\n        <Space className=\"w-full\">\n          <span className=\"coz-fg-primary font-medium leading-[20px]\">\n            {I18n.t('creat_project_project_name')}\n          </span>\n          <span className=\"coz-fg-hglt-red\">*</span>\n        </Space>\n        <Input\n          className=\"w-full\"\n          placeholder=\"\"\n          defaultValue={defaultTitle}\n          onChange={value => {\n            setTitle(value);\n          }}\n        />\n      </Space>\n    </Modal>\n  );\n};\n\nexport const TemplateCardSkeleton = () => (\n  <CardSkeletonContainer className={cls('h-[278px]', styles.template)} />\n);\n\nexport const TempCardBody: FC<\n  CardInfoProps & {\n    entityType?: explore.product_common.ProductEntityType | ProductEntityType;\n    renderImageBottomSlot?: () => React.ReactNode;\n    renderDescBottomSlot?: () => React.ReactNode;\n  }\n> = ({\n  title,\n  imgSrc,\n  description,\n  entityType,\n  userInfo,\n  renderImageBottomSlot,\n  renderDescBottomSlot,\n}) => (\n  <div>\n    <div className=\"relative w-full h-[140px] rounded-[8px] overflow-hidden\">\n      <Image\n        preview={false}\n        src={imgSrc}\n        className=\"w-full h-full\"\n        imgCls=\"w-full h-full object-cover object-center\"\n      />\n      {renderImageBottomSlot?.()}\n    </div>\n    <CardInfo\n      {...{\n        title,\n        description,\n        userInfo,\n        renderCardTag: () =>\n          entityType ? <CardTag type={entityType} /> : null,\n        descClassName: styles.description,\n        renderDescBottomSlot,\n      }}\n    />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport cls from 'classnames';\nimport { type explore } from '@coze-studio/api-schema';\nimport { I18n } from '@coze-arch/i18n';\nimport { Avatar, Space, Tag, Toast, Tooltip } from '@coze-arch/coze-design';\n\nimport { PluginAuthMode, type AuthMode } from '../type';\nimport { CardInfo } from '../components/info';\nimport { CardContainer, CardSkeletonContainer } from '../components/container';\nimport { CardButton } from '../components/button';\n\nimport styles from './index.module.less';\n\ninterface ProductInfo extends explore.ProductInfo {\n  plugin_extra: explore.ProductInfo['plugin_extra'] & AuthMode;\n}\n\nexport type PluginCardProps = ProductInfo & {\n  isInstalled?: boolean;\n  isShowInstallButton?: boolean;\n  className?: string;\n};\n\nexport const PluginCard: FC<PluginCardProps> = props => (\n  <CardContainer\n    className={cls(styles.plugin, props.className)}\n    shadowMode=\"default\"\n    onClick={() => {\n      const url = props?.plugin_extra?.jump_saas_url;\n\n      if (url) {\n        window.open(url, '_blank');\n      }\n    }}\n  >\n    <div className={styles['plugin-wrapper']}>\n      <PluginCardBody {...props} />\n      <Space\n        className={cls(styles['btn-container'], {\n          [styles['one-column-grid']]:\n            props.isInstalled || !props.isShowInstallButton,\n        })}\n      >\n        {!props.isInstalled && props.isShowInstallButton ? (\n          <CardButton\n            onClick={() => {\n              Toast.success(I18n.t('plugin_install_success'));\n            }}\n          >\n            {I18n.t('plugin_store_install')}\n          </CardButton>\n        ) : null}\n      </Space>\n    </div>\n  </CardContainer>\n);\n\nexport const PluginCardSkeleton = () => (\n  <CardSkeletonContainer className={cls('h-[186px]', styles.plugin)} />\n);\n\nconst PluginCardBody: FC<PluginCardProps> = props => {\n  const renderCardTag = () => {\n    if (\n      props.plugin_extra.auth_mode === PluginAuthMode.Required ||\n      props.plugin_extra.auth_mode === PluginAuthMode.Supported\n    ) {\n      return (\n        <Tag\n          color={'yellow'}\n          className=\"h-[20px] !px-[4px] !py-[2px] coz-fg-primary font-medium shrink-0\"\n        >\n          <span className=\"ml-[2px]\">\n            {I18n.t('plugin_store_unauthorized')}\n          </span>\n        </Tag>\n      );\n    } else if (props.plugin_extra.auth_mode === PluginAuthMode.Configured) {\n      return (\n        <Tooltip content={I18n.t('plugin_store_contact_deployer')}>\n          <Tag\n            color={'brand'}\n            className=\"h-[20px] !px-[4px] !py-[2px] coz-fg-primary font-medium shrink-0\"\n          >\n            <span className=\"ml-[2px]\">\n              {I18n.t('plugin_store_authorized')}\n            </span>\n          </Tag>\n        </Tooltip>\n      );\n    }\n    return null;\n  };\n  return (\n    <div>\n      <Avatar\n        className={styles['card-avatar']}\n        src={props.meta_info?.icon_url}\n        shape=\"square\"\n      />\n      <CardInfo\n        {...{\n          title: props.meta_info?.name,\n          description: props.meta_info?.description,\n          userInfo: props.meta_info?.user_info,\n          authMode: props.plugin_extra.auth_mode,\n          renderCardTag,\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// , \nexport const formatNumber = (num?: number): string => {\n  if (num === undefined || num === null) {\n    return '-';\n  }\n\n  let formatted = '';\n  if (num >= 10000) {\n    formatted = (num / 10000).toFixed(1);\n    // 00\n    if (formatted.endsWith('.0')) {\n      formatted = formatted.slice(0, -2);\n    }\n    // w\n    formatted = `${formatted}w`;\n  } else {\n    formatted = num.toString();\n  }\n\n  return formatted;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n\nimport { useState } from 'react';\n\nimport dayjs from 'dayjs';\nimport { useRequest } from 'ahooks';\nimport { explore } from '@coze-studio/api-schema';\nimport { I18n } from '@coze-arch/i18n';\nimport { Modal, Space, Tag, Avatar } from '@coze-arch/coze-design';\nimport { formatPercent } from '@coze-arch/bot-utils';\nimport { UserLevel } from '@coze-arch/bot-api/trade';\n\nimport { formatNumber } from './format-number';\n\ninterface UsageModalProps {\n  entity_id?: string;\n}\n\nconst getLevel = (level?: UserLevel) => {\n  switch (level) {\n    case UserLevel.Free:\n      return I18n.t('coze_sidebar_free_ver');\n    case UserLevel.ProPersonal:\n      return I18n.t('export_import_2_agent_flow_15');\n    case UserLevel.Team:\n      return I18n.t('export_import_2_agent_flow_16');\n    case UserLevel.Enterprise:\n      return I18n.t('export_import_2_agent_flow_17');\n    default:\n      return I18n.t('coze_sidebar_free_ver');\n  }\n};\n\n//hook\nexport const useUsageModal = ({ entity_id }: UsageModalProps) => {\n  const [visible, setVisible] = useState(false);\n\n  const { data } = useRequest(\n    async () =>\n      await explore.PublicGetProductCallInfo({\n        entity_type: explore.product_common.ProductEntityType.Plugin,\n        entity_id,\n      }),\n    {\n      ready: visible,\n      refreshDeps: [visible, entity_id],\n    },\n  );\n\n  const onClose = () => {\n    setVisible(false);\n  };\n\n  // \n  const getUseRadio = () => {\n    if (\n      !data?.data?.call_count_limit?.used_count ||\n      !data?.data?.call_count_limit?.total_count\n    ) {\n      return 0;\n    }\n    return (\n      data?.data?.call_count_limit?.used_count /\n      data?.data?.call_count_limit?.total_count\n    );\n  };\n\n  return {\n    node: (\n      <Modal\n        visible={visible}\n        onCancel={onClose}\n        maskClosable={false}\n        closeOnEsc={true}\n        title=\"\"\n        width={525}\n        footer={null}\n      >\n        <div className=\"coz-fg-primary\">\n          <div>\n            <div>\n              <Space spacing={4} className=\"mb-[16px]\">\n                <span className=\"w-[110px] font-[500]\"></span>\n                <Avatar\n                  className=\"w-[18px] h-[18px]\"\n                  src={data?.data?.user_info?.avatar_url}\n                  shape=\"circle\"\n                />\n                <span className=\"coz-fg-secondary font-[500]\">\n                  {data?.data?.user_info?.nick_name}\n                </span>\n                <span className=\"coz-fg-secondary\">\n                  {`@${data?.data?.user_info?.user_name}`}\n                </span>\n              </Space>\n            </div>\n\n            <Space spacing={4} className=\"mb-[16px]\">\n              <span className=\"w-[110px] font-[500]\"></span>\n              <Tag color=\"primary\">{getLevel(data?.data?.user_level)}</Tag>\n            </Space>\n\n            <div className=\"mb-[16px]\">\n              <Space spacing={4}>\n                <span className=\"w-[110px] font-[500]\"></span>\n                {data?.data?.call_count_limit?.is_unlimited ? (\n                  <span></span>\n                ) : (\n                  <>\n                    <span>\n                      {`${formatNumber(data?.data?.call_count_limit?.used_count)}/${formatNumber(data?.data?.call_count_limit?.total_count)}`}\n                    </span>\n                    <span className=\"coz-fg-secondary\">\n                      {`${dayjs\n                        .unix(\n                          Number(data?.data?.call_count_limit?.reset_datetime),\n                        )\n                        .format('YYYY-MM-DD')} `}\n                    </span>\n                    {getUseRadio() > 0.8 && (\n                      <Tag color=\"yellow\" size=\"mini\">\n                        {formatPercent(getUseRadio())}\n                      </Tag>\n                    )}\n                  </>\n                )}\n              </Space>\n            </div>\n            <Space spacing={4}>\n              <span className=\"w-[110px] font-[500]\">QPS</span>\n              <span>{formatNumber(data?.data?.call_rate_limit?.qps)}</span>\n            </Space>\n          </div>\n        </div>\n      </Modal>\n    ),\n    open: () => {\n      setVisible(true);\n    },\n    close: onClose,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ProductEntityType,\n  type ProductInfo,\n} from '@coze-arch/bot-api/product_api';\n\nexport interface RecommendAreaRef {\n  getResultList: () => ProductInfo[];\n  isLoading: () => boolean;\n}\n\n// \nexport const defaultEntityAreaSort = [ProductEntityType.Plugin];\n\n//  \nexport const simpleEntitySelecotorSort: Array<ProductEntityType> = [\n  ProductEntityType.Plugin,\n];\n\n// { bot: 0, socialScene: 0}\nexport const defaultEntityAreaNumMap = Object.fromEntries(\n  defaultEntityAreaSort.map(item => [item, 0]),\n);\n\n//  { bot: null, socialScene: null}\nexport const defaultEntityAreaRefMap: Partial<\n  Record<ProductEntityType, RecommendAreaRef | null>\n> = Object.fromEntries(defaultEntityAreaSort.map(item => [item, null]));\n\n//  \nexport const entityNameMap: Partial<Record<ProductEntityType, () => string>> = {\n  [ProductEntityType.Bot]: () => I18n.t('project_store_search'),\n  [ProductEntityType.Plugin]: () => I18n.t('store_search_recommend_result2'),\n  [ProductEntityType.TemplateCommon]: () => I18n.t('template_name'),\n};\n\n// \nexport const entityUrlMap: Partial<Record<ProductEntityType, string>> = {\n  [ProductEntityType.Bot]: 'bot',\n  [ProductEntityType.Plugin]: 'plugin',\n  [ProductEntityType.TemplateCommon]: 'template',\n};\n\n// idid\nexport const getEntityUrl = (\n  entityType: ProductEntityType,\n  id?: string,\n  from?: string,\n) => {\n  const fromQuery = from ? `?from=${from}` : '';\n  switch (entityType) {\n    case ProductEntityType.Plugin:\n    case ProductEntityType.SaasPlugin:\n      return id\n        ? `https://www.coze.cn/store/plugin/${id}${fromQuery}`\n        : '/explore/plugin';\n    default:\n      return '#';\n  }\n};\n\n// entity\nexport const entityShowStaticsMap: Partial<\n  Record<\n    ProductEntityType,\n    Array<{\n      label: (productInfo?: ProductInfo) => string;\n      getValue: (productInfo: ProductInfo) => number;\n    }>\n  >\n> = {\n  [ProductEntityType.Bot]: [\n    {\n      label: () => I18n.t('store_search_chat'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.bot_extra?.chat_conversation_count) || 0,\n    },\n    {\n      label: () => I18n.t('store_search_use'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.bot_extra?.user_count) || 0,\n    },\n    {\n      label: () => I18n.t('store_search_collect'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.meta_info?.favorite_count) || 0,\n    },\n  ],\n  [ProductEntityType.Project]: [\n    {\n      label: () => I18n.t('store_search_use'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.project_extra?.user_count) || 0,\n    },\n    {\n      label: () => I18n.t('template_run'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.project_extra?.execute_count) || 0,\n    },\n    {\n      label: () => I18n.t('mkpl_num_favorites'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.meta_info?.favorite_count) || 0,\n    },\n  ],\n  [ProductEntityType.Plugin]: [\n    {\n      label: () => I18n.t('store_search_use'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.plugin_extra?.bots_use_count) || 0,\n    },\n    {\n      label: () => I18n.t('store_search_collect'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.meta_info?.favorite_count) || 0,\n    },\n    {\n      label: () => I18n.t('store_search_call'),\n      getValue: (productInfo: ProductInfo) =>\n        Number(productInfo?.plugin_extra?.call_amount) || 0,\n    },\n  ],\n  [ProductEntityType.TemplateCommon]: [\n    {\n      label: () => I18n.t('workflowstore_card_duplicate'),\n      getValue: (productInfo: ProductInfo) => productInfo?.meta_info?.heat || 0,\n    },\n  ],\n  [ProductEntityType.BotTemplate]: [\n    {\n      label: () => I18n.t('workflowstore_card_duplicate'),\n      getValue: (productInfo: ProductInfo) => productInfo?.meta_info?.heat || 0,\n    },\n    {\n      label: () => I18n.t('store_search_chat'),\n      getValue: productInfo =>\n        Number(productInfo?.bot_extra?.chat_conversation_count),\n    },\n  ],\n  [ProductEntityType.ProjectTemplate]: [\n    {\n      label: () => I18n.t('workflowstore_card_duplicate'),\n      getValue: productInfo => productInfo?.meta_info?.heat || 0,\n    },\n    {\n      label: () => I18n.t('template_search_run'),\n      getValue: productInfo => productInfo?.project_extra?.execute_count || 0,\n    },\n  ],\n  [ProductEntityType.WorkflowTemplateV2]: [\n    {\n      label: () => I18n.t('workflowstore_card_duplicate'),\n      getValue: productInfo => productInfo?.meta_info?.heat || 0,\n    },\n    {\n      label: () => I18n.t('template_search_run'),\n      getValue: productInfo =>\n        Number(productInfo?.workflow_extra?.used_count) || 0,\n    },\n  ],\n  [ProductEntityType.ImageflowTemplateV2]: [\n    {\n      label: () => I18n.t('workflowstore_card_duplicate'),\n      getValue: productInfo => productInfo?.meta_info?.heat || 0,\n    },\n    {\n      label: () => I18n.t('template_search_run'),\n      getValue: productInfo =>\n        Number(productInfo?.workflow_extra?.used_count) || 0,\n    },\n  ],\n};\n\nexport const getAllowEntitySortList = ({ isLogin }: { isLogin?: boolean }) => {\n  if (!isLogin) {\n    return simpleEntitySelecotorSort;\n  }\n\n  return defaultEntityAreaSort;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { create } from 'zustand';\nimport { ProductEntityType } from '@coze-arch/bot-api/product_api';\n\nimport { defaultEntityAreaNumMap } from './config';\ntype MoreContentType = 'moreContent';\n\ntype AllEntityType = ProductEntityType | MoreContentType;\n\ninterface StoreProps {\n  ableKeyBoardJumpDetail: boolean;\n  setAbleKeyBoardJumpDetail: (flag: boolean) => void;\n  inputValue: string;\n  setInputValue: (valueIn: string) => void;\n  contentLength: Partial<Record<AllEntityType, number>>;\n  setContentLength: (type: AllEntityType, length: number) => void;\n  resetAllContentLength: () => void;\n  currentSelectedIndex: {\n    type: AllEntityType;\n    index: number;\n  };\n  setCurrentSelectIndex: (type: AllEntityType, index) => void;\n  resetCurrentSelectIndex: () => void;\n  changeCurrentSelectIndexByDirection: (direction: 0 | 1) =>\n    | {\n        isTop?: boolean;\n        isBottom?: boolean;\n      }\n    | undefined;\n\n  entityTypeIn: ProductEntityType;\n  setEntityTypeIn: (entityType: ProductEntityType) => void;\n\n  currentEntitySort: ProductEntityType[];\n  setCurrentEntitySort: (entityTypeList: ProductEntityType[]) => void;\n}\n\ninterface GetEntityTypeParams {\n  currentEntityType: AllEntityType;\n  direction: 0 | 1;\n  contentLength: Partial<Record<AllEntityType, number>>;\n  recursionStartEntityType?: AllEntityType;\n  entityList: AllEntityType[];\n}\n\nconst getEntityType = (params: GetEntityTypeParams): AllEntityType => {\n  const {\n    currentEntityType,\n    direction,\n    contentLength,\n    recursionStartEntityType,\n    entityList,\n  } = params;\n  if (direction === 1) {\n    if (currentEntityType === entityList?.[entityList.length - 1]) {\n      return recursionStartEntityType ?? currentEntityType;\n    } else {\n      const nextEntityType =\n        entityList[entityList.indexOf(currentEntityType) + 1];\n      // @ts-expect-error -- linter-disable-autofix\n      if (contentLength[nextEntityType] <= 0) {\n        return getEntityType({\n          currentEntityType: nextEntityType,\n          direction,\n          contentLength,\n          entityList,\n          recursionStartEntityType:\n            recursionStartEntityType ?? currentEntityType,\n        });\n      }\n      return nextEntityType;\n    }\n  } else {\n    if (currentEntityType === entityList?.[0]) {\n      return recursionStartEntityType ?? currentEntityType;\n    } else {\n      const lastEntityType =\n        entityList[entityList.indexOf(currentEntityType) - 1];\n      // @ts-expect-error -- linter-disable-autofix\n      if (contentLength[lastEntityType] <= 0) {\n        return getEntityType({\n          currentEntityType: lastEntityType,\n          entityList,\n          direction,\n          contentLength,\n          recursionStartEntityType:\n            recursionStartEntityType ?? currentEntityType,\n        });\n      }\n      return lastEntityType;\n    }\n  }\n};\n\n// eslint-disable-next-line max-lines-per-function\nexport const useSearchInputStore = create<StoreProps>((set, get) => ({\n  currentEntitySort: [ProductEntityType.SaasPlugin],\n  setCurrentEntitySort: (entityTypeList: ProductEntityType[]) => {\n    set({\n      currentEntitySort: entityTypeList,\n    });\n  },\n  entityTypeIn: ProductEntityType.SaasPlugin,\n  setEntityTypeIn: (entityType: ProductEntityType) => {\n    set({\n      entityTypeIn: entityType,\n    });\n  },\n  // , true, enterbot, enter\n  ableKeyBoardJumpDetail: false,\n  setAbleKeyBoardJumpDetail: (flag: boolean) => {\n    set({ ableKeyBoardJumpDetail: flag });\n  },\n  inputValue: '',\n  setInputValue: (valueIn: string) => {\n    set({ inputValue: valueIn });\n  },\n  contentLength: { ...defaultEntityAreaNumMap },\n  setContentLength: (type: AllEntityType, length: number) => {\n    set({\n      contentLength: {\n        ...get().contentLength,\n        [type]: length,\n      },\n    });\n  },\n  resetAllContentLength: () => {\n    set({\n      contentLength: { ...defaultEntityAreaNumMap },\n    });\n  },\n  currentSelectedIndex: {\n    type: ProductEntityType.SaasPlugin,\n    index: -1,\n  },\n  setCurrentSelectIndex: (type: AllEntityType, index: number) => {\n    set({\n      currentSelectedIndex: {\n        type,\n        index,\n      },\n    });\n  },\n  resetCurrentSelectIndex: () => {\n    const { currentEntitySort } = get();\n    set({\n      currentSelectedIndex: {\n        type: currentEntitySort[0],\n        index: -1,\n      },\n    });\n  },\n  changeCurrentSelectIndexByDirection: (direction: 0 | 1) => {\n    const { currentSelectedIndex, contentLength, currentEntitySort } = get();\n\n    if (direction === 1) {\n      // \n      if (\n        currentSelectedIndex.index + 1 >=\n        // @ts-expect-error -- linter-disable-autofix\n        contentLength[currentSelectedIndex.type]\n      ) {\n        const nextEntityType = getEntityType({\n          currentEntityType: currentSelectedIndex.type,\n          direction: 1,\n          contentLength,\n          entityList: [...currentEntitySort],\n        });\n        if (nextEntityType !== currentSelectedIndex.type) {\n          set({\n            currentSelectedIndex: {\n              type: nextEntityType,\n              index: 0,\n            },\n          });\n        } else {\n          return { isBottom: true };\n        }\n      } else {\n        set({\n          currentSelectedIndex: {\n            type: currentSelectedIndex.type,\n            index: currentSelectedIndex.index + 1,\n          },\n        });\n      }\n    } else {\n      // \n      if (currentSelectedIndex.index <= 0) {\n        const lastEntityType = getEntityType({\n          currentEntityType: currentSelectedIndex.type,\n          direction: 0,\n          contentLength,\n          entityList: [...currentEntitySort],\n        });\n        set({\n          currentSelectedIndex: {\n            type: lastEntityType,\n            index:\n              lastEntityType === currentSelectedIndex.type\n                ? -1\n                : (contentLength[lastEntityType] as number) - 1,\n          },\n        });\n\n        if (lastEntityType === currentSelectedIndex.type) {\n          return { isTop: true };\n        }\n      } else {\n        set({\n          currentSelectedIndex: {\n            type: currentSelectedIndex.type,\n            index: currentSelectedIndex.index - 1,\n          },\n        });\n      }\n    }\n  },\n}));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNavigate } from 'react-router-dom';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowRight } from '@coze-arch/coze-design/icons';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport { Typography } from '@coze-arch/bot-semi';\n\nimport { useSearchInputStore } from '../../search-input-store';\n\nimport styles from './index.module.less';\n\ninterface RecommendItemProps {\n  onSearch?: (word: string) => void;\n}\n\nexport const RecommendMore = (props: RecommendItemProps) => {\n  const { onSearch } = props;\n  const navigate = useNavigate();\n\n  const { inputValue, entityTypeIn } = useSearchInputStore();\n\n  return (\n    <div\n      className={cls(styles.moreContainer)}\n      onMouseDown={() => {\n        sendTeaEvent(EVENT_NAMES.store_search_front, {\n          search_word: inputValue,\n          action: 'enter_search',\n        });\n        console.log('[dev] mousedown:', onSearch, inputValue, entityTypeIn);\n        if (onSearch) {\n          onSearch(\n            `/search/${encodeURIComponent(\n              inputValue,\n            )}?entityType=${entityTypeIn}`,\n          );\n        } else {\n          navigate(\n            `/search/${encodeURIComponent(\n              inputValue,\n            )}?entityType=${entityTypeIn}`,\n          );\n        }\n      }}\n    >\n      <Typography.Text className={styles.text} ellipsis={{ rows: 1 }}>\n        {I18n.t('store_search_suggest_page', { query: inputValue })}\n      </Typography.Text>\n      <IconCozArrowRight className={styles.arrow} />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ProductShowFrontParams } from '@coze-arch/bot-tea';\nimport {\n  ProductEntityType,\n  type ProductMetaInfo,\n} from '@coze-arch/bot-api/product_api';\n\nconst entityIdKeyMap = {\n  [ProductEntityType.Bot]: 'bot_id',\n  [ProductEntityType.Project]: 'project_id',\n  [ProductEntityType.Plugin]: 'plugin_id',\n} satisfies Partial<Record<ProductEntityType, keyof ProductShowFrontParams>>;\n\nconst entityTypeMap = {\n  [ProductEntityType.Bot]: 'bot',\n  [ProductEntityType.Project]: 'project',\n  [ProductEntityType.Plugin]: 'plugin',\n} satisfies Partial<\n  Record<ProductEntityType, ProductShowFrontParams['entity_type']>\n>;\n\nexport const getProductShowFrontCommonParams = (metaInfo: ProductMetaInfo) => {\n  const entityIdKey =\n    entityIdKeyMap[metaInfo.entity_type ?? ProductEntityType.Bot];\n  const entityType =\n    entityTypeMap[metaInfo.entity_type ?? ProductEntityType.Bot];\n\n  return {\n    product_id: metaInfo.id ?? '',\n    product_name: metaInfo.name ?? '',\n    ...(entityIdKey\n      ? {\n          [entityIdKey]: metaInfo.entity_id,\n        }\n      : {}),\n    entity_type: entityType ?? 'bot',\n  } satisfies Partial<ProductShowFrontParams>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AvatarName } from '@coze-studio/components';\nimport { type public_api } from '@coze-arch/bot-api/product_api';\n\ntype ProductMetaInfo = public_api.ProductMetaInfo;\nexport const StoreAvatarName = (props: {\n  metaInfo?: ProductMetaInfo;\n  theme?: 'default' | 'light' | 'white';\n  size?: 'small' | 'default' | 'large';\n  renderCenterSlot?: React.ReactNode; // \n  className?: string;\n}) => (\n  <AvatarName\n    avatar={props?.metaInfo?.user_info?.avatar_url}\n    username={props?.metaInfo?.user_info?.user_name}\n    name={props?.metaInfo?.user_info?.name}\n    label={{\n      name: props?.metaInfo?.user_info?.user_label?.label_name,\n      icon: props?.metaInfo?.user_info?.user_label?.icon_url,\n      href: props?.metaInfo?.user_info?.user_label?.jump_link,\n    }}\n    theme={props.theme}\n    nameMaxWidth={150}\n    size={props.size}\n    renderCenterSlot={props.renderCenterSlot}\n    className={props.className}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, type MutableRefObject } from 'react';\n\nimport { useSearchInputStore } from '../search-input-store';\nexport interface RecommendItemSelectedProps {\n  isSelected?: boolean;\n  ableKeyPressJump?: boolean;\n  onSelectedClick?: () => void;\n  itemRef: MutableRefObject<HTMLElement>;\n  containerRef: MutableRefObject<HTMLElement>;\n}\n\nexport const useItemSelect = (props: RecommendItemSelectedProps) => {\n  const {\n    isSelected,\n    ableKeyPressJump,\n    onSelectedClick,\n    itemRef,\n    containerRef,\n  } = props;\n  const { inputValue, ableKeyBoardJumpDetail } = useSearchInputStore();\n  useEffect(() => {\n    if (isSelected && ableKeyPressJump && ableKeyBoardJumpDetail) {\n      const jumpPage = (e: KeyboardEvent) => {\n        if (e.code === 'Enter') {\n          onSelectedClick?.();\n        }\n      };\n      document.addEventListener('keydown', jumpPage);\n\n      return () => {\n        document.removeEventListener('keydown', jumpPage);\n      };\n    }\n  }, [isSelected, inputValue, ableKeyPressJump, ableKeyBoardJumpDetail]);\n  useEffect(() => {\n    if (isSelected) {\n      if (itemRef?.current && containerRef?.current) {\n        const itemRect = itemRef?.current.getBoundingClientRect();\n        const containerRect = containerRef?.current.getBoundingClientRect();\n        if (itemRect.bottom > containerRect.bottom) {\n          containerRef.current.scrollTo({\n            top:\n              containerRef?.current.scrollTop +\n              itemRect.bottom -\n              containerRect.bottom +\n              8,\n            behavior: 'smooth',\n          });\n        } else if (itemRect.top < containerRect.top) {\n          containerRef.current.scrollTo({\n            top:\n              containerRef?.current.scrollTop +\n              itemRect.top -\n              containerRect.top,\n            behavior: 'smooth',\n          });\n        }\n      }\n    }\n  }, [isSelected]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, Fragment, useRef, type MutableRefObject } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDiamondFill } from '@coze-arch/coze-design/icons';\nimport { Tag } from '@coze-arch/coze-design';\nimport { formatNumber, getParamsFromQuery } from '@coze-arch/bot-utils';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport { Space, Avatar, Typography, Skeleton } from '@coze-arch/bot-semi';\nimport { IconArrowDownFill } from '@coze-arch/bot-icons';\nimport { useExposure } from '@coze-arch/bot-hooks';\nimport {\n  BusinessType,\n  ProductEntityType,\n  ProductPaidType,\n  type ProductInfo,\n} from '@coze-arch/bot-api/product_api';\n\nimport { getProductShowFrontCommonParams } from '@/utils/tea/product';\nimport { StoreAvatarName } from '@/avatar-name';\n\nimport { useSearchInputStore } from '../../search-input-store';\nimport { useItemSelect } from '../../hooks/use-item-select';\nimport { entityUrlMap, entityShowStaticsMap, getEntityUrl } from '../../config';\n\nimport styles from './index.module.less';\n\ninterface RecommendItemProps {\n  isSelected?: boolean;\n  item?: ProductInfo;\n  ableKeyPressJump?: boolean;\n  onSearch?: (word: string) => void;\n  onMouseHover?: () => void;\n  entityType?: ProductEntityType;\n  containerRef?: MutableRefObject<HTMLElement>;\n  index?: number;\n}\n\nconst EntityTypeTag: FC<{ type: ProductEntityType }> = ({ type }) => {\n  const map = {\n    [ProductEntityType.Bot]: (\n      <Tag size=\"mini\" color=\"primary\">\n        {I18n.t('community_Tagtag_bot')}\n      </Tag>\n    ),\n    [ProductEntityType.Project]: (\n      <Tag size=\"mini\" color=\"brand\">\n        {I18n.t('project_store_search')}\n      </Tag>\n    ),\n  };\n\n  return map[type];\n};\n\nconst StatisticsModule = ({\n  productInfo,\n  entityType,\n}: {\n  productInfo?: ProductInfo;\n  entityType?: ProductEntityType;\n}) => (\n  <>\n    {entityType && productInfo\n      ? entityShowStaticsMap[entityType]?.map((item, index) => (\n          <Fragment key={index}>\n            {index > 0 ? <div className={styles.dot} /> : null}\n            <Typography.Text className={styles['statie-elc']}>\n              {formatNumber(item.getValue(productInfo))}\n              {item.label(productInfo)}\n            </Typography.Text>\n          </Fragment>\n        ))\n      : null}\n  </>\n);\n\n// eslint-disable-next-line @coze-arch/max-line-per-function, complexity\nexport const RecommendItem = (props: RecommendItemProps) => {\n  const {\n    isSelected = false,\n    item,\n    ableKeyPressJump,\n    onMouseHover,\n    entityType,\n    containerRef,\n    index,\n  } = props;\n\n  const { inputValue } = useSearchInputStore();\n\n  const itemRef = useRef<HTMLDivElement>();\n\n  const onOpenDetail = () => {\n    if (!entityType) {\n      return;\n    }\n    const entityUrl = getEntityUrl(\n      item?.meta_info.entity_type ?? entityType,\n      item?.meta_info?.id,\n      'store_search_suggestion',\n    );\n\n    window.open(entityUrl, '_blank');\n  };\n  useItemSelect({\n    ...{ isSelected, ableKeyPressJump },\n    onSelectedClick: () => {\n      sendTeaEvent(EVENT_NAMES.store_search_front, {\n        // @ts-expect-error -- linter-disable-autofix\n        result_type: entityUrlMap[entityType] || '',\n        entity_id: item?.meta_info?.id || '',\n        entity_name: item?.meta_info?.name || '',\n        search_word: inputValue,\n        action: 'click_results',\n      });\n\n      window.open(\n        // @ts-expect-error -- linter-disable-autofix\n        getEntityUrl(entityType, item?.meta_info?.id),\n        '_blank',\n      );\n    },\n    // @ts-expect-error -- linter-disable-autofix\n    itemRef,\n    // @ts-expect-error -- linter-disable-autofix\n    containerRef,\n  });\n\n  useExposure({\n    target: itemRef,\n    options: { threshold: 0.5 },\n    eventName: EVENT_NAMES.product_show_front,\n    reportParams: {\n      ...(item?.meta_info\n        ? getProductShowFrontCommonParams(item?.meta_info)\n        : {\n            bot_id: '',\n            product_name: '',\n            product_id: '',\n          }),\n      c_position: index,\n      filter_tag: 'all',\n      source: 'store_search_suggestion',\n      from: getParamsFromQuery({ key: 'from' }) ?? 'store_search_suggestion',\n    },\n    isReportOnce: true,\n  });\n\n  return (\n    <div\n      className={cls(styles.normalItemContaienr, {\n        [styles.isSelected]: isSelected,\n      })}\n      style={{\n        gap: 12,\n      }}\n      onMouseDown={() => {\n        onOpenDetail();\n        sendTeaEvent(EVENT_NAMES.store_search_front, {\n          // @ts-expect-error -- linter-disable-autofix\n          result_type: entityUrlMap[entityType] || '',\n          entity_id: item?.meta_info?.id || '',\n          entity_name: item?.meta_info?.name || '',\n          search_word: inputValue,\n          action: 'click_results',\n        });\n      }}\n      onMouseEnter={() => onMouseHover?.()}\n      // @ts-expect-error -- linter-disable-autofix\n      ref={itemRef}\n    >\n      <Avatar\n        shape=\"square\"\n        src={item?.meta_info?.icon_url}\n        style={{ width: 32, height: 32 }}\n        className={styles.avatar}\n      />\n      <Space\n        vertical\n        spacing={2}\n        style={{\n          flex: 1,\n          overflow: 'hidden',\n        }}\n      >\n        <div className=\"flex items-center w-full gap-[6px]\">\n          {item?.meta_info.entity_type !== undefined ? (\n            <EntityTypeTag type={item?.meta_info.entity_type} />\n          ) : null}\n          <Typography.Text\n            className={cls(styles.title, 'ml-[4px]')}\n            ellipsis={{ rows: 1, showTooltip: false }}\n          >\n            {item?.meta_info?.name}\n          </Typography.Text>\n          <StoreAvatarName metaInfo={item?.meta_info} />\n          {item?.commercial_setting?.commercial_type ===\n          ProductPaidType.Paid ? (\n            <Tag\n              size=\"mini\"\n              color=\"brand\"\n              prefixIcon={<IconCozDiamondFill />}\n              className=\"font-medium\"\n            >\n              {I18n.t(\n                item?.commercial_setting?.business_type ===\n                  BusinessType.SelfOperated\n                  ? 'official_payment'\n                  : 'third_party_payment',\n              )}\n            </Tag>\n          ) : null}\n        </div>\n        <Space spacing={6} style={{ width: '100%' }}>\n          <StatisticsModule\n            entityType={item?.meta_info.entity_type ?? entityType}\n            productInfo={item}\n          />\n          {item?.meta_info?.description ? (\n            <>\n              <div className={styles.dot} />\n              <Typography.Text\n                className={styles.description}\n                ellipsis={{ rows: 1, showTooltip: false }}\n              >\n                {item?.meta_info?.description}\n              </Typography.Text>\n            </>\n          ) : null}\n        </Space>\n      </Space>\n    </div>\n  );\n};\n\nexport const RecommendSkeleton = () => (\n  <Space spacing={12} className={styles.skeletonContiner}>\n    <Skeleton.Image className={styles.image} />\n    <Space className={styles.textContainer} spacing={8} vertical>\n      <Skeleton.Title className={styles.title} />\n      <Skeleton.Title className={styles.description} />\n    </Space>\n  </Space>\n);\n\nexport const RecommendItemMore = (props: {\n  isSelected?: boolean;\n  ableKeyPressJump?: boolean;\n  requestList?: () => void;\n  onMouseHover?: () => void;\n  containerRef?: MutableRefObject<HTMLElement>;\n}) => {\n  const {\n    isSelected = false,\n    ableKeyPressJump,\n    requestList,\n    onMouseHover,\n    containerRef,\n  } = props;\n  const itemRef = useRef<HTMLDivElement>();\n  useItemSelect({\n    ...{ isSelected, ableKeyPressJump },\n    onSelectedClick: () => {\n      requestList?.();\n    },\n    // @ts-expect-error -- linter-disable-autofix\n    itemRef,\n    // @ts-expect-error -- linter-disable-autofix\n    containerRef,\n  });\n  return (\n    <div\n      onMouseDown={() => {\n        requestList?.();\n      }}\n      className={cls(styles.seeMore, {\n        [styles.isSelected]: isSelected,\n      })}\n      // @ts-expect-error -- linter-disable-autofix\n      ref={itemRef}\n      onMouseEnter={() => onMouseHover?.()}\n    >\n      {I18n.t('store_search_see_more')} <IconArrowDownFill />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useState,\n  useEffect,\n  useCallback,\n  useRef,\n  useImperativeHandle,\n  type MutableRefObject,\n} from 'react';\n\nimport queryString from 'query-string';\nimport { debounce } from 'lodash-es';\nimport axios, { type CancelTokenSource } from 'axios';\nimport { sendTeaEvent, EVENT_NAMES } from '@coze-arch/bot-tea';\nimport { IconLoading } from '@coze-arch/bot-icons';\nimport {\n  ProductEntityType,\n  type ProductInfo,\n} from '@coze-arch/bot-api/product_api';\nimport { ProductApi } from '@coze-arch/bot-api';\n\nimport {\n  RecommendItem,\n  RecommendSkeleton,\n  RecommendItemMore,\n} from '../recommend-item';\nimport { useSearchInputStore } from '../../search-input-store';\nimport { type RecommendAreaRef, entityNameMap } from '../../config';\n\nimport styles from './index.module.less';\n\ninterface RecommendPopoverProps {\n  focus: boolean;\n  inComposition: boolean;\n  onSearch?: (word: string) => void;\n  entityType: ProductEntityType;\n  onResultChange?: () => void;\n  containerRef?: MutableRefObject<HTMLElement>;\n}\n\nexport const RecommendArea = React.forwardRef(\n  // eslint-disable-next-line @coze-arch/max-line-per-function -- ignore\n  (props: RecommendPopoverProps, ref: React.ForwardedRef<RecommendAreaRef>) => {\n    const { inComposition, entityType, onResultChange, containerRef } = props;\n\n    const [contentList, setContentList] = useState<ProductInfo[]>([]);\n    const [isLoading, setIsLoading] = useState<boolean>(false);\n    const [hasMore, setHasMore] = useState<boolean>(false);\n\n    const {\n      inputValue,\n      ableKeyBoardJumpDetail,\n      setContentLength,\n      currentSelectedIndex,\n      setCurrentSelectIndex,\n    } = useSearchInputStore();\n\n    // const isLogin = useLoggedIn();\n\n    const cancelSource = useRef<CancelTokenSource>();\n    const currentPageRef = useRef<number>(1);\n\n    const ableKeyPressJump = !inComposition;\n\n    const requestList = useCallback(\n      debounce(\n        async (valueIn?: string) => {\n          sendTeaEvent(EVENT_NAMES.store_search_front, {\n            search_word: valueIn || '',\n            action: 'type',\n          });\n          cancelSource.current = axios.CancelToken.source();\n          try {\n            setIsLoading(true);\n            const { data } = await ProductApi.PublicSearchSuggest(\n              {\n                keyword: valueIn,\n                ...(entityType === ProductEntityType.Bot\n                  ? {\n                      entity_types: [\n                        ProductEntityType.Bot,\n                        ProductEntityType.Project,\n                      ],\n                    }\n                  : {\n                      entity_type: entityType,\n                    }),\n                page_num: currentPageRef.current++,\n                page_size: 5,\n              },\n              {\n                cancelToken: cancelSource.current.token,\n                paramsSerializer: p =>\n                  queryString.stringify(p, { arrayFormat: 'comma' }),\n              },\n            );\n            const list = data?.suggestion_v2 ?? [];\n            const hasMoreTemp = list?.length > 0 ? data?.has_more : false;\n            setHasMore(hasMoreTemp || false);\n            setIsLoading(false);\n\n            setContentList(cur => {\n              const newList = [...cur, ...list];\n              const itemLength =\n                (newList?.length ?? 0) + (data?.has_more ? 1 : 0);\n              setContentLength(entityType, itemLength);\n              return newList;\n            });\n            // eslint-disable-next-line @coze-arch/use-error-in-catch\n          } catch (e) {\n            console.log('[dev] ');\n          }\n        },\n        // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n        300,\n        {\n          leading: false,\n        },\n      ),\n      [entityType],\n    );\n\n    useEffect(() => {\n      // \n      cancelSource.current?.cancel?.('suggest request cancle by user');\n      // true\n      setIsLoading(true);\n      // \n      setContentList([]);\n      // \n      currentPageRef.current = 1;\n      // \n      requestList(inputValue);\n    }, [inputValue]);\n\n    useImperativeHandle(\n      ref,\n      () => ({\n        getResultList: () => contentList,\n        isLoading: () => isLoading,\n      }),\n      [isLoading, contentList],\n    );\n    useEffect(() => {\n      onResultChange?.();\n    }, [contentList, isLoading]);\n    if (contentList.length === 0 && !isLoading) {\n      return null;\n    }\n\n    return (\n      <div className={styles.popoverContainer}>\n        <div className={styles.title}>{entityNameMap[entityType]?.()}</div>\n        {isLoading && contentList.length === 0 ? (\n          new Array(4)\n            .fill('')\n            .map((_, index) => <RecommendSkeleton key={index} />)\n        ) : (\n          <>\n            {contentList.map((item, index) => (\n              <RecommendItem\n                item={item}\n                key={index}\n                ableKeyPressJump={ableKeyPressJump && ableKeyBoardJumpDetail}\n                isSelected={\n                  currentSelectedIndex.index === index &&\n                  currentSelectedIndex.type === entityType\n                }\n                onMouseHover={() => setCurrentSelectIndex(entityType, index)}\n                entityType={entityType}\n                containerRef={containerRef}\n              />\n            ))}\n            {hasMore ? (\n              <div className={styles.loadMoreContainer}>\n                {isLoading ? (\n                  <div className={styles.loading}>\n                    <IconLoading className={styles.loadingIcon} />\n                  </div>\n                ) : (\n                  <RecommendItemMore\n                    isSelected={\n                      currentSelectedIndex.index === contentList.length &&\n                      currentSelectedIndex.type === entityType\n                    }\n                    onMouseHover={() =>\n                      setCurrentSelectIndex(entityType, contentList.length)\n                    }\n                    containerRef={containerRef}\n                    ableKeyPressJump={ableKeyPressJump}\n                    requestList={() => {\n                      requestList(inputValue);\n                    }}\n                  />\n                )}\n              </div>\n            ) : null}\n          </>\n        )}\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNavigate } from 'react-router-dom';\nimport React, { useEffect, useRef, useState } from 'react';\n\nimport cls from 'classnames';\nimport { useUpdateEffect } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { sendTeaEvent, EVENT_NAMES } from '@coze-arch/bot-tea';\nimport { Typography } from '@coze-arch/bot-semi';\nimport { useLoggedIn } from '@coze-arch/bot-hooks';\n\nimport { RecommendMore } from '../recommend-more';\nimport { RecommendArea } from '../recommend-area';\nimport { useSearchInputStore } from '../../search-input-store';\nimport {\n  defaultEntityAreaRefMap,\n  type RecommendAreaRef,\n  getAllowEntitySortList,\n} from '../../config';\n\nimport styles from './index.module.less';\n\nconst { Text } = Typography;\ninterface RecommendPopoverProps {\n  inputContainerRef: React.MutableRefObject<HTMLElement>;\n  focus: boolean;\n  inComposition: boolean;\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n  onSearch?: (word: string) => void;\n  focusInput?: (isFocus: boolean) => void;\n  onResultEmpty?: (value: boolean) => void;\n}\n\nconst checkDomInTargetPath = (target: HTMLElement, dom): boolean => {\n  let currentTarget = target;\n  while (currentTarget && currentTarget !== document.body) {\n    if (currentTarget === dom) {\n      return true;\n    }\n    // @ts-expect-error -- linter-disable-autofix\n    currentTarget = currentTarget.parentElement;\n  }\n  return false;\n};\n\ninterface AreaRef {\n  [key: string]: RecommendAreaRef | null;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport const RecommendPopover = (props: RecommendPopoverProps) => {\n  const {\n    focus,\n    inComposition,\n    onSearch,\n    visible,\n    setVisible,\n    focusInput,\n    inputContainerRef,\n    onResultEmpty,\n  } = props;\n  const containerRef = useRef<HTMLDivElement>();\n  const [isEmpty, setIsEmpty] = useState(false);\n  const navigate = useNavigate();\n  const areaRef = useRef<AreaRef>({\n    ...defaultEntityAreaRefMap,\n  });\n\n  const {\n    inputValue,\n    ableKeyBoardJumpDetail,\n    setAbleKeyBoardJumpDetail,\n    resetAllContentLength,\n    changeCurrentSelectIndexByDirection,\n    resetCurrentSelectIndex,\n    entityTypeIn,\n    currentEntitySort,\n    setCurrentEntitySort,\n  } = useSearchInputStore();\n\n  const ableKeyPressJump = !inComposition && focus;\n  const isLogin = useLoggedIn();\n\n  useEffect(() => {\n    const tempAreaSort = getAllowEntitySortList({ isLogin });\n\n    //\n    const leftEntity = tempAreaSort.filter(item => item !== entityTypeIn);\n\n    if (leftEntity.length !== tempAreaSort.length) {\n      setCurrentEntitySort([entityTypeIn, ...leftEntity]);\n    } else {\n      setCurrentEntitySort([...tempAreaSort]);\n    }\n    resetCurrentSelectIndex();\n  }, [entityTypeIn, isLogin]);\n  useEffect(() => {\n    areaRef.current = {\n      ...defaultEntityAreaRefMap,\n    };\n    // \n    setAbleKeyBoardJumpDetail(false);\n    // \n    resetAllContentLength();\n    // selectedIndex\n    resetCurrentSelectIndex();\n    containerRef.current?.scrollTo?.(0, 0);\n    if (inputValue.length > 0 && focus) {\n      setVisible(true);\n    }\n  }, [inputValue]);\n\n  useEffect(() => {\n    if (focus) {\n      setVisible(true);\n      setAbleKeyBoardJumpDetail(false);\n      resetCurrentSelectIndex();\n    }\n  }, [focus]);\n\n  useEffect(() => {\n    if (visible) {\n      const close = (e: KeyboardEvent) => {\n        if (e.code === 'Escape') {\n          setVisible(false);\n        }\n      };\n      const closeClick = (e: MouseEvent) => {\n        if (\n          checkDomInTargetPath(\n            e.target as HTMLElement,\n            inputContainerRef.current,\n          )\n        ) {\n          // \n        } else {\n          setVisible(false);\n        }\n      };\n      document.addEventListener('keydown', close, true);\n      document.addEventListener('click', closeClick);\n      return () => {\n        document.removeEventListener('keydown', close, true);\n        document.removeEventListener('click', closeClick);\n        resetCurrentSelectIndex();\n      };\n    }\n  }, [visible]);\n\n  // \n  useEffect(() => {\n    if (visible) {\n      sendTeaEvent(EVENT_NAMES.store_search_front, {\n        search_word: inputValue,\n        action: 'click',\n      });\n      const listenKeydown = (e: KeyboardEvent) => {\n        if (e.code === 'ArrowUp') {\n          const res = changeCurrentSelectIndexByDirection(0);\n          e.preventDefault();\n          if (res?.isTop) {\n            focusInput?.(true);\n            containerRef.current?.scrollTo?.({\n              top: 0,\n              behavior: 'smooth',\n            });\n          }\n        }\n        if (e.code === 'ArrowDown') {\n          changeCurrentSelectIndexByDirection(1);\n          setAbleKeyBoardJumpDetail(true);\n          e.preventDefault();\n          focusInput?.(false);\n        }\n      };\n      document.addEventListener('keydown', listenKeydown);\n      return () => {\n        document.removeEventListener('keydown', listenKeydown);\n      };\n    }\n  }, [visible]);\n\n  // enter\n  useEffect(() => {\n    if (inputValue.length > 0 && ableKeyPressJump && !ableKeyBoardJumpDetail) {\n      const enterListener = (e: KeyboardEvent) => {\n        if (e.code === 'Enter' || e.key === 'Enter' || e.keyCode === 13) {\n          sendTeaEvent(EVENT_NAMES.store_search_front, {\n            search_word: inputValue,\n            action: 'enter_search',\n          });\n          if (onSearch) {\n            onSearch(\n              `/search/${encodeURIComponent(\n                inputValue,\n              )}?entityType=${entityTypeIn}`,\n            );\n            setVisible(false);\n          } else {\n            // \n            navigate(\n              `/search/${encodeURIComponent(\n                inputValue,\n              )}?entityType=${entityTypeIn}`,\n            );\n          }\n        }\n      };\n\n      document.addEventListener('keydown', enterListener);\n\n      return () => {\n        document.removeEventListener('keydown', enterListener);\n      };\n    }\n  }, [inputValue, ableKeyPressJump, ableKeyBoardJumpDetail]);\n  const onResultChange = () => {\n    let isEmptyTemp = true;\n    Object.keys(areaRef.current).map(key => {\n      const item = areaRef.current[key];\n      //\n      if (!currentEntitySort.includes(Number(key))) {\n        return;\n      }\n      if (\n        !item ||\n        item.isLoading() === true ||\n        item.getResultList().length > 0\n      ) {\n        isEmptyTemp = false;\n      }\n    });\n    setIsEmpty(isEmptyTemp);\n\n    onResultEmpty?.(isEmptyTemp);\n  };\n  useUpdateEffect(() => {\n    if (!visible) {\n      setAbleKeyBoardJumpDetail(false);\n    }\n    const onWheel = event => {\n      if (!containerRef.current) {\n        return;\n      }\n      if (\n        containerRef.current?.scrollTop + containerRef.current?.offsetHeight >=\n          containerRef.current?.scrollHeight &&\n        event.deltaY > 0\n      ) {\n        event?.preventDefault();\n      } else if (containerRef.current?.scrollTop === 0 && event?.deltaY < 0) {\n        event?.preventDefault();\n      }\n    };\n    containerRef.current?.addEventListener('wheel', onWheel);\n    return () => {\n      containerRef.current?.removeEventListener('wheel', onWheel);\n    };\n  }, [visible]);\n\n  return (\n    <div\n      className={cls(styles.popoverContainer, {\n        [styles.visible]: visible,\n      })}\n    >\n      <div\n        className={styles.contentCotaniner}\n        onClickCapture={e => e.stopPropagation()}\n      >\n        <div className={styles.divider} />\n\n        <div\n          className={styles['area-container']}\n          ref={elem => {\n            // @ts-expect-error -- linter-disable-autofix\n            containerRef.current = elem;\n          }}\n        >\n          {inputValue.length === 0 ? (\n            <Text className={styles.title}>\n              {I18n.t('store_search_recently_viewed')}\n            </Text>\n          ) : null}\n          {isEmpty ? (\n            <Text className={styles.nofound}>\n              {I18n.t('store_search_suggest_no_result')}\n            </Text>\n          ) : null}\n          {currentEntitySort.map(item => (\n            <RecommendArea\n              {...props}\n              key={item}\n              entityType={item}\n              onResultChange={onResultChange}\n              ref={ref => (areaRef.current[item] = ref)}\n              // @ts-expect-error -- linter-disable-autofix\n              containerRef={containerRef}\n            />\n          ))}\n        </div>\n\n        {inputValue.length > 0 && (\n          <>\n            <div\n              className={styles.divider}\n              style={{\n                margin: 0,\n              }}\n            />\n            <RecommendMore\n              onSearch={\n                onSearch\n                  ? (word: string) => {\n                      onSearch?.(word);\n                      setVisible(false);\n                    }\n                  : undefined\n              }\n            />\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState, useRef, useEffect, useImperativeHandle } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { Input } from '@coze-arch/coze-design';\nimport { IconSearchInput } from '@coze-arch/bot-icons';\nimport { ProductEntityType } from '@coze-arch/bot-api/product_api';\n\nimport { useSearchInputStore } from './search-input-store';\nimport { RecommendPopover } from './components';\n\nimport styles from './index.module.less';\n\ninterface InputProps {\n  border?: boolean;\n  className?: string;\n  inputClassName?: string;\n  defaultValue?: string;\n  onSearch?: (word: string) => void;\n  onFocus?: () => void;\n  onBlur?: () => void;\n  onActiveChange?: (isActive: boolean) => void;\n  entityType?: ProductEntityType;\n  useResponsive?: boolean;\n  enableFocusStyle?: boolean;\n}\nexport interface SearchInputRef {\n  setInputValue: (value: string) => void;\n}\n\nexport const SearchInput = React.forwardRef(\n  (props: InputProps, ref: React.ForwardedRef<SearchInputRef>) => {\n    const {\n      border,\n      className,\n      inputClassName,\n      defaultValue = '',\n      onSearch,\n      onFocus,\n      onBlur,\n      entityType,\n      useResponsive,\n      onActiveChange,\n      enableFocusStyle = true,\n    } = props;\n    const [focus, setFocus] = useState<boolean>(false);\n    const [inComposition, setInComposition] = useState<boolean>(false);\n    const [visible, setVisible] = useState<boolean>(false);\n    const inputContainerRef = useRef<HTMLDivElement>(null);\n    const { inputValue, setInputValue, setEntityTypeIn } =\n      useSearchInputStore();\n    const [isResultEmpty, setIsResultEmpty] = useState(false);\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n      setEntityTypeIn(entityType || ProductEntityType.SaasPlugin);\n    }, [entityType]);\n    useEffect(() => {\n      let inputValueTemp = defaultValue;\n      try {\n        inputValueTemp = decodeURIComponent(defaultValue);\n      } catch (_e) {\n        inputValueTemp = defaultValue;\n      }\n      setInputValue(inputValueTemp);\n      return () => {\n        setInputValue('');\n      };\n    }, []);\n\n    const focusInput = (isFocus: boolean) => {\n      if (isFocus) {\n        inputRef.current?.focus?.();\n      } else {\n        inputRef.current?.blur?.();\n      }\n    };\n    useImperativeHandle(\n      ref,\n      () => ({\n        setInputValue,\n      }),\n      [setInputValue],\n    );\n    useEffect(() => {\n      onActiveChange?.(focus || visible);\n    }, [focus, visible]);\n    const popoverVisible = visible && (!isResultEmpty || inputValue.length > 0);\n    return (\n      <>\n        <div\n          className={cls(className, styles.container, {\n            [styles.focus]: enableFocusStyle && (focus || visible),\n            [styles.popoverVisible]: enableFocusStyle && popoverVisible,\n          })}\n          ref={inputContainerRef}\n        >\n          <Input\n            className={cls(inputClassName, styles.inputContainer, {\n              [styles['has-word']]: inputValue.length > 0,\n              '!coz-stroke-plus': border,\n            })}\n            onChange={(val: string) => setInputValue(val)}\n            value={inputValue}\n            prefix={\n              focus || inputValue.length > 0 ? null : (\n                <div className={styles['icon-search']}>\n                  <IconSearchInput />\n                </div>\n              )\n            }\n            onClick={() => {\n              setVisible(true);\n            }}\n            showClear\n            onFocus={() => {\n              setFocus(true);\n              onActiveChange?.(true); //focus\n              onFocus?.();\n            }}\n            onBlur={() => {\n              setFocus(false);\n              if (!popoverVisible) {\n                setVisible(false);\n              }\n              onBlur?.();\n            }}\n            onCompositionStart={() => {\n              setInComposition(true);\n            }}\n            onCompositionEnd={() => {\n              setInComposition(false);\n            }}\n            placeholder={I18n.t('Search')}\n            maxLength={100}\n            ref={inputRef}\n            clearIcon={\n              <span className={styles['clear-icon']}>\n                <IconCozCross />\n              </span>\n            }\n          />\n          <RecommendPopover\n            focus={focus}\n            inComposition={inComposition}\n            onSearch={onSearch}\n            visible={popoverVisible}\n            setVisible={setVisible}\n            focusInput={focusInput}\n            inputContainerRef={\n              inputContainerRef as React.MutableRefObject<HTMLElement>\n            }\n            onResultEmpty={(value: boolean) => {\n              setIsResultEmpty(value);\n            }}\n          />\n        </div>\n        <div\n          className={cls(styles.mask, {\n            [styles.visible]: popoverVisible && useResponsive,\n          })}\n        />\n      </>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type CSSProperties, useState } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozArrowDown,\n  IconCozMouse,\n  IconCozTablet,\n} from '@coze-arch/coze-design/icons';\nimport { Popover, Typography } from '@coze-arch/bot-semi';\n\nimport { PadIcon } from './icons/pad';\nimport { MouseIcon } from './icons/mouse';\n\nimport styles from './mouse-pad-selector.module.less';\n\nconst { Title, Paragraph } = Typography;\n\nexport enum InteractiveType {\n  Mouse = 'MOUSE',\n  Pad = 'PAD',\n}\n\nexport interface MousePadSelectorProps {\n  value: InteractiveType;\n  onChange: (value: InteractiveType) => void;\n  onPopupVisibleChange?: (visible: boolean) => void;\n  containerStyle?: CSSProperties;\n  iconStyle?: CSSProperties;\n  arrowStyle?: CSSProperties;\n}\n\nconst IteractiveItem: React.FC<{\n  title: string;\n  subTitle: string;\n  icon: React.ReactNode;\n  value: InteractiveType;\n  selected: boolean;\n  onChange: (value: InteractiveType) => void;\n}> = ({ title, subTitle, icon, onChange, value, selected }) => (\n  <div\n    className={cls({\n      [styles['mouse-pad-option']]: true,\n      [styles['mouse-pad-option-selected']]: selected,\n    })}\n    onClick={() => onChange(value)}\n  >\n    <div\n      className={cls({\n        [styles['mouse-pad-option-icon']]: true,\n        [styles['mouse-pad-option-icon-selected']]: selected,\n      })}\n    >\n      {icon}\n    </div>\n    <Title\n      heading={6}\n      className={cls({\n        [styles['mouse-pad-option-title']]: true,\n        [styles['mouse-pad-option-title-selected']]: selected,\n      })}\n    >\n      {title}\n    </Title>\n    <Paragraph\n      type=\"tertiary\"\n      className={cls({\n        [styles['mouse-pad-option-subTitle']]: true,\n        [styles['mouse-pad-option-subTitle-selected']]: selected,\n      })}\n    >\n      {subTitle}\n    </Paragraph>\n  </div>\n);\n\nexport const MousePadSelector: React.FC<\n  MousePadSelectorProps & React.RefAttributes<HTMLDivElement>\n> = React.forwardRef(\n  (\n    {\n      value,\n      onChange,\n      onPopupVisibleChange,\n      containerStyle,\n      iconStyle,\n      arrowStyle,\n    },\n    ref,\n  ) => {\n    const isMouse = value === InteractiveType.Mouse;\n    const [visible, setVisible] = useState(false);\n\n    return (\n      <Popover\n        trigger=\"custom\"\n        position=\"topLeft\"\n        closeOnEsc\n        visible={visible}\n        onVisibleChange={v => {\n          onPopupVisibleChange?.(v);\n        }}\n        onClickOutSide={() => {\n          setVisible(false);\n        }}\n        spacing={20}\n        content={\n          <div className={styles['ui-mouse-pad-selector-popover']}>\n            <Typography.Title heading={4}>\n              {I18n.t('workflow_interactive_mode')}\n            </Typography.Title>\n            <div className={styles['ui-mouse-pad-selector-popover-options']}>\n              <IteractiveItem\n                title={I18n.t('workflow_mouse_friendly')}\n                subTitle={I18n.t('workflow_mouse_friendly_desc')}\n                data-testid=\"workflow.detail.toolbar.interactive.mouse\"\n                value={InteractiveType.Mouse}\n                selected={value === InteractiveType.Mouse}\n                icon={<MouseIcon />}\n                onChange={onChange}\n              />\n\n              <IteractiveItem\n                title={I18n.t('workflow_pad_friendly')}\n                subTitle={I18n.t('workflow_pad_friendly_desc')}\n                data-testid=\"workflow.detail.toolbar.interactive.pad\"\n                value={InteractiveType.Pad}\n                selected={value === InteractiveType.Pad}\n                icon={<PadIcon />}\n                onChange={onChange}\n              />\n            </div>\n          </div>\n        }\n      >\n        <div\n          className={cls({\n            [styles['ui-mouse-pad-selector']]: true,\n            [styles['ui-mouse-pad-selector-active']]: visible,\n          })}\n          ref={ref}\n          onClick={() => {\n            setVisible(!visible);\n          }}\n          style={containerStyle}\n        >\n          <div\n            className={styles['ui-mouse-pad-selector-icon']}\n            style={iconStyle}\n          >\n            {isMouse ? <IconCozMouse /> : <IconCozTablet />}\n          </div>\n\n          <div\n            className={styles['ui-mouse-pad-selector-arrow']}\n            style={arrowStyle}\n          >\n            <IconCozArrowDown />\n          </div>\n        </div>\n      </Popover>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function PadIcon() {\n  return (\n    <svg\n      width=\"48\"\n      height=\"38\"\n      viewBox=\"0 0 48 38\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        x=\"1.83317\"\n        y=\"1.49998\"\n        width=\"44.3333\"\n        height=\"35\"\n        rx=\"3.5\"\n        stroke=\"currentColor\"\n        stroke-opacity=\"0.8\"\n        stroke-width=\"2.33333\"\n      />\n      <path\n        d=\"M14.6665 30.6667H33.3332\"\n        stroke=\"currentColor\"\n        stroke-opacity=\"0.8\"\n        stroke-width=\"2.33333\"\n        stroke-linecap=\"round\"\n      />\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function MouseIcon() {\n  return (\n    <svg\n      width=\"34\"\n      height=\"52\"\n      viewBox=\"0 0 34 52\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fill-rule=\"evenodd\"\n        clip-rule=\"evenodd\"\n        d=\"M30.9998 16.6666V35.3333C30.9998 37.5748 30.9948 38.4695 30.9 39.1895C30.2108 44.4247 26.0912 48.5443 20.856 49.2335C20.1361 49.3283 19.2413 49.3333 16.9998 49.3333C14.7584 49.3333 13.8636 49.3283 13.1437 49.2335C7.90847 48.5443 3.78888 44.4247 3.09965 39.1895C3.00487 38.4695 2.99984 37.5748 2.99984 35.3333V16.6666C2.99984 14.4252 3.00487 13.5304 3.09965 12.8105C3.78888 7.57528 7.90847 3.45569 13.1437 2.76646C13.7232 2.69017 14.4159 2.67202 15.8332 2.66785V9.86573C14.4738 10.3462 13.4998 11.6426 13.4998 13.1666V17.8332C13.4998 19.3571 14.4738 20.6536 15.8332 21.1341V23.6666C15.8332 24.3109 16.3555 24.8333 16.9998 24.8333C17.6442 24.8333 18.1665 24.3109 18.1665 23.6666V21.1341C19.5259 20.6536 20.4998 19.3572 20.4998 17.8332V13.1666C20.4998 11.6426 19.5259 10.3462 18.1665 9.86571V2.66785C19.5837 2.67202 20.2765 2.69017 20.856 2.76646C26.0912 3.45569 30.2108 7.57528 30.9 12.8105C30.9948 13.5304 30.9998 14.4252 30.9998 16.6666ZM0.666504 16.6666C0.666504 14.4993 0.666504 13.4157 0.786276 12.5059C1.61335 6.22368 6.55687 1.28016 12.8391 0.453085C13.7489 0.333313 14.8325 0.333313 16.9998 0.333313C19.1671 0.333313 20.2508 0.333313 21.1605 0.453085C27.4428 1.28016 32.3863 6.22368 33.2134 12.5059C33.3332 13.4157 33.3332 14.4994 33.3332 16.6666V35.3333C33.3332 37.5006 33.3332 38.5843 33.2134 39.494C32.3863 45.7763 27.4428 50.7198 21.1605 51.5469C20.2508 51.6666 19.1671 51.6666 16.9998 51.6666C14.8325 51.6666 13.7489 51.6666 12.8391 51.5469C6.55687 50.7198 1.61335 45.7763 0.786276 39.494C0.666504 38.5843 0.666504 37.5006 0.666504 35.3333V16.6666ZM15.8332 13.1666C15.8332 13.0011 15.8676 12.8437 15.9297 12.7011C15.9886 12.566 16.0722 12.4443 16.1749 12.3416C16.386 12.1305 16.6777 11.9999 16.9998 11.9999C17.6435 11.9999 18.1654 12.5212 18.1665 13.1646L18.1665 13.1666V17.8332L18.1665 17.8353C18.1665 17.8364 18.1665 17.8376 18.1665 17.8387C18.1661 17.9132 18.1588 17.986 18.1452 18.0565C18.0853 18.3656 17.9033 18.6312 17.6515 18.8011C17.4655 18.9266 17.2412 18.9999 16.9998 18.9999C16.3555 18.9999 15.8332 18.4776 15.8332 17.8332V13.1666Z\"\n        fill=\"currentColor\"\n        fill-opacity=\"0.8\"\n      />\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const CACHE_KEY = 'workflow_prefer_interactive_type';\nexport const SHOW_KEY = 'show_workflow_interactive_type_guide';\n\nexport const IS_MAC_OS = /(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(\n  navigator.userAgent,\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InteractiveType } from './mouse-pad-selector';\nimport { CACHE_KEY, SHOW_KEY, IS_MAC_OS } from './constants';\n\nexport const getPreferInteractiveType = () => {\n  const data = localStorage.getItem(CACHE_KEY) as string;\n  if (\n    data &&\n    [InteractiveType.Mouse, InteractiveType.Pad].includes(\n      data as InteractiveType,\n    )\n  ) {\n    return data;\n  }\n  return IS_MAC_OS ? InteractiveType.Pad : InteractiveType.Mouse;\n};\n\n/** Record the selected interaction mode */\nexport const setPreferInteractiveType = (type: InteractiveType) => {\n  localStorage.setItem(CACHE_KEY, type);\n};\n\nexport const hideGuidingPopover = () => {\n  localStorage.setItem(SHOW_KEY, 'true');\n};\n\nexport const needShowGuidingPopover = () => {\n  const data = localStorage.getItem(SHOW_KEY) as string;\n  return data !== 'true';\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Popover, Typography } from '@coze-arch/bot-semi';\n\nimport { PadIcon } from '../src/icons/pad';\nimport { MouseIcon } from '../src/icons/mouse';\nimport { needShowGuidingPopover, hideGuidingPopover } from './utils';\n\nimport styles from './with-guiding-popover.module.less';\n\nexport interface GuidingPopoverProps {\n  buttonText: string;\n  mainTitle: string;\n  mouseOptionTitle: string;\n  mouseOptionDesc: string;\n  padOptionTitle: string;\n  padOptionDesc: string;\n  onGotIt: () => void;\n}\n\nconst GuidingContent = (props: GuidingPopoverProps) => (\n  <div className={styles['guiding-content']}>\n    <div className={styles['guiding-content-title']}>\n      <Typography.Text>{props.mainTitle}</Typography.Text>\n    </div>\n\n    <div className={styles['guiding-content-mouse-option']}>\n      <div className={styles['guiding-content-mouse-option-icon']}>\n        <MouseIcon />\n      </div>\n      <div>\n        <Typography.Text className={styles['guiding-content-title']}>\n          {props.mouseOptionTitle}\n        </Typography.Text>\n        <Typography.Paragraph className={styles['guiding-content-desc']}>\n          {props.mouseOptionDesc}\n        </Typography.Paragraph>\n      </div>\n    </div>\n\n    <div className={styles['guiding-content-pad-option']}>\n      <div className={styles['guiding-content-pad-option-icon']}>\n        <PadIcon />\n      </div>\n      <div>\n        <Typography.Text className={styles['guiding-content-title']}>\n          {props.padOptionTitle}\n        </Typography.Text>\n        <Typography.Paragraph className={styles['guiding-content-desc']}>\n          {props.padOptionDesc}\n        </Typography.Paragraph>\n      </div>\n    </div>\n\n    <div>\n      <Button\n        type=\"primary\"\n        theme=\"solid\"\n        className={styles['guiding-content-button']}\n        onClick={props?.onGotIt}\n      >\n        {props.buttonText}\n      </Button>\n    </div>\n  </div>\n);\n\nexport const GuidingPopover = (\n  props: React.PropsWithChildren<Partial<GuidingPopoverProps>>,\n) => {\n  const {\n    children,\n    mainTitle = I18n.t('workflow_interactive_mode_popover_title'),\n    buttonText = I18n.t('guidance_got_it'),\n    mouseOptionTitle = I18n.t('workflow_interactive_mode_mouse_friendly'),\n    mouseOptionDesc = I18n.t('workflow_interactive_mode_mouse_friendly_desc'),\n    padOptionTitle = I18n.t('workflow_interactive_mode_pad_friendly'),\n    padOptionDesc = I18n.t('workflow_interactive_mode_pad_friendly_desc'),\n  } = props;\n\n  const [visible, setVisible] = useState(() => needShowGuidingPopover());\n  const onButtonClick = () => setVisible(false);\n\n  // The gotIt method is not exposed to the upper layer first, and it needs to be used later before being exposed.\n  const handleGotIt = () => {\n    hideGuidingPopover();\n    setVisible(false);\n  };\n\n  const textProps = {\n    mainTitle,\n    mouseOptionTitle,\n    mouseOptionDesc,\n    padOptionTitle,\n    padOptionDesc,\n    buttonText,\n  };\n\n  return (\n    <Popover\n      content={<GuidingContent {...textProps} onGotIt={handleGotIt} />}\n      trigger=\"custom\"\n      position=\"top\"\n      style={{ padding: 0 }}\n      visible={visible}\n      showArrow\n      onClickOutSide={onButtonClick}\n    >\n      {children}\n    </Popover>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type FlowNodeEntity,\n  type IPoint,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nexport interface CustomLine {\n  from: FlowNodeEntity;\n  to: FlowNodeEntity;\n  fromPoint: IPoint;\n  toPoint: IPoint;\n  activated?: boolean;\n}\n\n/**\n * Resource icon type\n */\nexport enum NodeType {\n  WORKFLOW, // Workflow\n  CHAT_FLOW, // conversation flow\n  KNOWLEDGE, // Knowledge Base\n  PLUGIN, // plugin\n  DATABASE, // database\n}\n\n/**\n * source of resources\n */\nexport enum DependencyOrigin {\n  LIBRARY, // resource library\n  APP, // App / Project\n  SHOP, // store\n}\n\nexport interface EdgeItem {\n  from: string;\n  to: string;\n  collapsed?: boolean;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ConfigEntity } from '@flowgram-adapter/fixed-layout-editor';\n\ninterface CustomRenderState {\n  version: number;\n}\n/**\n * Rendering-related global state management\n */\nexport class CustomRenderStateEntity extends ConfigEntity<CustomRenderState> {\n  static type = 'CustomRenderStateEntity';\n\n  private _localVersion = 0;\n\n  getDefaultConfig() {\n    return {\n      version: 0,\n    };\n  }\n\n  private bumpVersion() {\n    this._localVersion = this._localVersion + 1;\n    if (this._localVersion === Number.MAX_SAFE_INTEGER) {\n      this._localVersion = 0;\n    }\n  }\n\n  updateVersion() {\n    this.bumpVersion();\n    this.updateConfig({\n      version: this._localVersion,\n    });\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ConfigEntity,\n  type FlowNodeEntity,\n  type EntityOpts,\n} from '@flowgram-adapter/fixed-layout-editor';\n\ninterface NodeRenderState {\n  selectNodes: string[];\n  selectLines: string[];\n  activatedNode?: FlowNodeEntity;\n}\n/**\n * Rendering-related global state management\n */\nexport class CustomRenderStateConfigEntity extends ConfigEntity<\n  NodeRenderState,\n  EntityOpts\n> {\n  static type = 'CustomRenderStateConfigEntity';\n\n  getDefaultConfig() {\n    return {\n      selectNodes: [],\n      selectLines: [],\n    };\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n  constructor(conf: EntityOpts) {\n    super(conf);\n  }\n\n  get selectNodes() {\n    return this.config.selectNodes;\n  }\n\n  setSelectNodes(nodes: string[]) {\n    this.updateConfig({\n      selectNodes: nodes,\n    });\n  }\n\n  get activatedNode() {\n    return this.config.activatedNode;\n  }\n\n  setActivatedNode(node?: FlowNodeEntity) {\n    this.updateConfig({\n      activatedNode: node,\n    });\n  }\n\n  get activeLines() {\n    return this.config.selectLines;\n  }\n\n  set activeLines(lines) {\n    this.updateConfig({\n      selectLines: lines,\n    });\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/fixed-layout-editor';\n\nconst getParentOfNoBlock = (\n  node: FlowNodeEntity,\n): FlowNodeEntity | undefined => {\n  if (!node.parent) {\n    return undefined;\n  }\n  if (node.parent.flowNodeType === 'block') {\n    return getParentOfNoBlock(node.parent);\n  }\n  return node.parent;\n};\n\nexport const getParentChildrenCount = (node: FlowNodeEntity) => {\n  const parent = getParentOfNoBlock(node);\n  return parent?.children?.length || 0;\n};\n\nexport const getTreeIdFromNodeId = (id: string) =>\n  id.replace('$blockIcon$', '');\n\nexport const getNodeIdFromTreeId = (id: string) => `$blockIcon$${id}`;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IPoint, Rectangle } from '@flowgram-adapter/fixed-layout-editor';\n\nexport enum BezierControlType {\n  RIGHT_TOP,\n  RIGHT_BOTTOM,\n  LEFT_TOP,\n  LEFT_BOTTOM,\n}\n\nconst CONTROL_MAX = 300;\n\n/**\n * Get the control node for the vertical direction of the Bzier curve\n * @param fromPos starting point\n * @param toPos destination\n */\nexport function getBezierVerticalControlPoints(\n  fromPos: IPoint,\n  toPos: IPoint,\n): IPoint[] {\n  const rect = Rectangle.createRectangleWithTwoPoints(fromPos, toPos);\n  let type: BezierControlType;\n\n  if (fromPos.y <= toPos.y) {\n    type =\n      fromPos.x <= toPos.x\n        ? BezierControlType.RIGHT_BOTTOM\n        : BezierControlType.LEFT_BOTTOM;\n  } else {\n    type =\n      fromPos.x <= toPos.x\n        ? BezierControlType.RIGHT_TOP\n        : BezierControlType.LEFT_TOP;\n  }\n\n  let controls: IPoint[];\n\n  switch (type) {\n    case BezierControlType.RIGHT_BOTTOM:\n      controls = [\n        {\n          x: rect.leftTop.x,\n          y: rect.leftTop.y + rect.height / 2,\n        },\n        {\n          x: rect.rightBottom.x,\n          y: rect.rightBottom.y - rect.height / 2,\n        },\n      ];\n      break;\n    case BezierControlType.LEFT_BOTTOM:\n      controls = [\n        {\n          x: rect.rightTop.x,\n          y: rect.rightTop.y + rect.height / 2,\n        },\n        {\n          x: rect.leftBottom.x,\n          y: rect.leftBottom.y - rect.height / 2,\n        },\n      ];\n      break;\n    case BezierControlType.RIGHT_TOP:\n      controls = [\n        {\n          x: rect.leftBottom.x,\n          y: rect.leftBottom.y + Math.min(rect.height, CONTROL_MAX),\n        },\n        {\n          x: rect.rightTop.x,\n          y: rect.rightTop.y - Math.min(rect.height, CONTROL_MAX),\n        },\n      ];\n      break;\n    case BezierControlType.LEFT_TOP:\n      controls = [\n        {\n          x: rect.rightBottom.x,\n          y: rect.rightBottom.y + Math.min(rect.height, CONTROL_MAX),\n        },\n        {\n          x: rect.leftTop.x,\n          y: rect.leftTop.y - Math.min(rect.height, CONTROL_MAX),\n        },\n      ];\n      break;\n    default:\n      controls = [];\n  }\n\n  return controls;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Bezier } from 'bezier-js';\nimport { type IPoint, Point } from '@flowgram-adapter/fixed-layout-editor';\n\nimport { type CustomLine } from '../typings';\nimport { getBezierVerticalControlPoints } from '../components/lines-render/utils';\n\nexport const getLineId = (line?: CustomLine) => {\n  if (!line) {\n    return undefined;\n  }\n  return `${line.from.id}${line.to.id}`;\n};\n\nexport const calcDistance = (pos: IPoint, line?: CustomLine) => {\n  if (!line) {\n    return Number.MAX_SAFE_INTEGER;\n  }\n  const { fromPoint, toPoint } = line;\n  const controls = getBezierVerticalControlPoints(line.fromPoint, line.toPoint);\n  const bezier = new Bezier([fromPoint, ...controls, toPoint]);\n  return Point.getDistance(pos, bezier.project(pos));\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isEmpty } from 'lodash-es';\nimport {\n  type FlowNodeEntity,\n  FlowNodeBaseType,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nexport const getStoreNode = (node: FlowNodeEntity) => {\n  const isBlockOrderIcon =\n    node.flowNodeType === FlowNodeBaseType.BLOCK_ORDER_ICON;\n  const isBlockIcon = node.flowNodeType === FlowNodeBaseType.BLOCK_ICON;\n  return {\n    node: isBlockOrderIcon || isBlockIcon ? node.parent! : node,\n    updateCurrent: !(isBlockOrderIcon || isBlockIcon),\n  };\n};\n\nexport const updateNodeExtInfo = (\n  renderNode: FlowNodeEntity,\n  info: Record<string, any>,\n) => {\n  const { node, updateCurrent } = getStoreNode(renderNode);\n  if (!updateCurrent) {\n    renderNode.updateExtInfo(info);\n  }\n  if (isEmpty(node.getExtInfo())) {\n    return;\n  } else {\n    node.updateExtInfo(info);\n  }\n};\n\nexport const getNodeExtInfo = (renderNode: FlowNodeEntity) => {\n  const { node } = getStoreNode(renderNode);\n  return node.getExtInfo();\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport type {\n  DependencyTree,\n  DependencyTreeNode,\n  KnowledgeInfo,\n  PluginVersionInfo,\n  TableInfo,\n  WorkflowVersionInfo,\n} from '@coze-arch/bot-api/workflow_api';\n\nimport { DependencyOrigin, NodeType } from '../typings';\nimport { NANO_ID_NUM } from '../constants';\n\nexport const getFrom = (project_id?: boolean, is_product?: boolean) => {\n  let from = DependencyOrigin.LIBRARY;\n  if (project_id) {\n    from = DependencyOrigin.APP;\n  }\n  if (is_product) {\n    from = DependencyOrigin.SHOP;\n  }\n  return from;\n};\n\nexport const transformKnowledge = (depth: number, knowledge: KnowledgeInfo) => {\n  const from = getFrom(\n    Boolean(knowledge.project_id && knowledge.project_id !== '0'),\n    knowledge.is_product,\n  );\n\n  return {\n    id: `${knowledge.id}_${nanoid(NANO_ID_NUM)}`,\n    type: 'custom',\n    meta: {\n      isNodeEnd: true,\n    },\n    data: {\n      id: knowledge.id,\n      name: knowledge.name,\n      depth,\n      collapsed: false,\n      type: NodeType.KNOWLEDGE,\n      from,\n      version: undefined,\n      icon: knowledge.icon,\n    },\n  };\n};\n\nexport const transformTable = (depth: number, table: TableInfo) => {\n  const from = getFrom(\n    Boolean(table.project_id && table.project_id !== '0'),\n    table.is_product,\n  );\n\n  return {\n    id: `${table.id}_${nanoid(NANO_ID_NUM)}`,\n    type: 'custom',\n    meta: {\n      isNodeEnd: true,\n    },\n    data: {\n      id: table.id,\n      name: table.name,\n      depth,\n      collapsed: false,\n      type: NodeType.DATABASE,\n      from,\n      version: undefined,\n      icon: table.icon,\n    },\n  };\n};\n\nexport const transformPlugin = (depth: number, plugin: PluginVersionInfo) => {\n  const from = getFrom(\n    Boolean(plugin.project_id && plugin.project_id !== '0'),\n    plugin.is_product,\n  );\n  return {\n    id: `${plugin.id}_${plugin.version}`,\n    type: 'custom',\n    meta: {\n      isNodeEnd: true,\n    },\n    data: {\n      id: plugin.id,\n      name: plugin.name,\n      depth,\n      collapsed: false,\n      type: NodeType.PLUGIN,\n      from,\n      version: plugin.version,\n      icon: plugin.icon,\n    },\n  };\n};\n\nconst findNode = (\n  tree: DependencyTree,\n  id?: string,\n): DependencyTreeNode | undefined => {\n  if (!id) {\n    return undefined;\n  }\n  const nodeList = tree.node_list || [];\n  const node = nodeList.find(n => n?.id === id);\n  return node;\n};\n\n/**\n * Determine whether to cycle\n */\nexport const isLoop = (id: string, json: DependencyTree) => {\n  const node = findNode(json, id);\n  // Only workflow has loops, so just focus on workflow_version\n  if (node?.dependency?.workflow_version?.length) {\n    return hasSameId(id, node.dependency.workflow_version, json);\n  }\n  return false;\n};\n\n// judgment loop\nconst hasSameId = (\n  id: string,\n  arr: WorkflowVersionInfo[],\n  json: DependencyTree,\n): boolean => {\n  const hasSame = arr.some(n => n?.id === id);\n  if (hasSame) {\n    return true;\n  }\n  return arr.some(n => {\n    const node = findNode(json, n?.id);\n    return hasSameId(id, node?.dependency?.workflow_version || [], json);\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const NANO_ID_NUM = 5;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DependencyTree } from '@coze-arch/bot-api/workflow_api';\n\nexport const isDepEmpty = (data?: DependencyTree) => {\n  if (!data) {\n    return true;\n  }\n  if (data.edge_list?.length) {\n    return false;\n  }\n  const rootNode = data.node_list?.[0]?.dependency || {};\n  const hasKnowledge = rootNode.knowledge_list?.length;\n  const hasPlugins = rootNode.plugin_version?.length;\n  const hasTable = rootNode.table_list?.length;\n  const hasSubWorkflow = rootNode.workflow_version?.length;\n  return !hasKnowledge && !hasPlugins && !hasTable && !hasSubWorkflow;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n/* eslint-disable max-params */\n/* eslint-disable complexity */\nimport { nanoid } from 'nanoid';\nimport { inject, injectable } from 'inversify';\nimport {\n  FlowDocument,\n  type FlowNodeJSON,\n} from '@flowgram-adapter/fixed-layout-editor';\nimport type {\n  DependencyTree,\n  DependencyTreeNode,\n  KnowledgeInfo,\n  PluginVersionInfo,\n  TableInfo,\n} from '@coze-arch/bot-api/workflow_api';\n\nimport {\n  transformKnowledge,\n  transformPlugin,\n  transformTable,\n  isLoop,\n} from '../utils';\nimport {\n  DependencyOrigin,\n  type EdgeItem,\n  NodeType,\n  type TreeNode,\n} from '../typings';\n\n@injectable()\nexport class TreeService {\n  @inject(FlowDocument) declare document: FlowDocument;\n\n  declare root: TreeNode;\n\n  edges: EdgeItem[] = [];\n\n  treeHistory: {\n    // unique device identifier\n    id: string;\n    // To determine whether two conditions already exist\n    resourceId: string;\n    version?: string;\n    depth: number;\n  }[] = [];\n\n  declare globalJson: DependencyTree;\n\n  declare addChildrenArr: {\n    parentId: string;\n    json: FlowNodeJSON;\n  }[];\n\n  getUnCollapsedEdges() {\n    return this.edges.filter(e => !e.collapsed);\n  }\n\n  /**\n   * Used to check for duplicates\n   */\n  getNodeDuplicateFromTree = (id: string, version?: string) => {\n    let duplicate = false;\n    const depth: number[] = [];\n    const dupId: string[] = [];\n    const matchArr = this.treeHistory.filter(\n      history =>\n        `${history.resourceId}${history.version || ''}` ===\n        `${id}${version || ''}`,\n    );\n\n    if (matchArr?.length) {\n      duplicate = true;\n      matchArr.forEach(item => {\n        depth.push(item.depth);\n        dupId.push(item.id);\n      });\n    }\n\n    return {\n      depth,\n      duplicate,\n      dupId,\n    };\n  };\n\n  traverseDFS(node: TreeNode, id: string): TreeNode | undefined {\n    if (node.id === id) {\n      return node;\n    } else {\n      if (!node.children?.length) {\n        return undefined;\n      }\n      for (const _node of node.children) {\n        const findNode = this.traverseDFS(_node, id);\n        if (findNode) {\n          return findNode;\n        }\n      }\n      return undefined;\n    }\n  }\n\n  getNodeByIdFromTree(id: string): TreeNode | undefined {\n    return this.traverseDFS(this.root, id);\n  }\n\n  /**\n   * Handling knowledge, plugins, table logic\n   */\n  transformDuplicateInfo = (\n    id: string,\n    info: KnowledgeInfo | PluginVersionInfo | TableInfo,\n    type: 'knowledge' | 'plugin' | 'table',\n    depth: number,\n    fromId: string,\n  ) => {\n    const {\n      duplicate,\n      depth: dupDepth,\n      dupId,\n    } = this.getNodeDuplicateFromTree(id);\n    let newSchema: FlowNodeJSON;\n    if (type === 'knowledge') {\n      newSchema = transformKnowledge(depth + 1, info);\n    } else if (type === 'plugin') {\n      newSchema = transformPlugin(depth + 1, info);\n    } else {\n      newSchema = transformTable(depth + 1, info);\n    }\n    // If repeated, determine whether to add a line or a node\n    if (duplicate) {\n      for (const [i, d] of dupDepth.entries()) {\n        // As long as there is a match, add the line.\n        // The logic of adding nodes at the bottom\n        if (depth + 1 === d) {\n          // Save in line\n          this.edges.push({\n            from: fromId,\n            to: dupId[i],\n          });\n          return;\n        }\n      }\n      return newSchema;\n    }\n    // Otherwise, add data to blocks normally\n    return newSchema;\n  };\n\n  dfsTransformNodeToSchema = (\n    depth: number,\n    node: DependencyTreeNode,\n    type?: NodeType,\n    parentId?: string,\n  ): TreeNode | undefined => {\n    if (!node?.commit_id) {\n      return undefined;\n    }\n    let from = DependencyOrigin.APP;\n    if (node.is_library) {\n      from = DependencyOrigin.LIBRARY;\n    }\n    if (node.is_product) {\n      from = DependencyOrigin.SHOP;\n    }\n    const dependencies = node.dependency;\n    const children: TreeNode[] = [];\n    const nodeId = `${node.commit_id}_${nanoid(5)}`;\n    const {\n      duplicate,\n      depth: dupDepth,\n      dupId,\n    } = this.getNodeDuplicateFromTree(\n      node!.id as string,\n      node.workflow_version,\n    );\n    if (duplicate) {\n      for (const [i, d] of dupDepth.entries()) {\n        if (depth === d) {\n          this.edges.push({\n            from: parentId || '',\n            to: dupId[i],\n          });\n          return;\n        }\n      }\n      const loop = node.id && isLoop(node.id, this.globalJson);\n      // Repeat node, stop, continue down\n      const endData = {\n        id: nodeId,\n        type: 'custom',\n        data: {\n          id: node.id,\n          name: node.name,\n          type:\n            type || (node.is_chatflow ? NodeType.CHAT_FLOW : NodeType.WORKFLOW),\n          from,\n          collapsed: false,\n          version: node.workflow_version,\n          depth,\n          loop,\n        },\n        parent: [],\n        meta: {\n          isNodeEnd: true,\n        },\n        blocks: [],\n      };\n      return endData;\n    }\n    this.treeHistory.push({\n      id: nodeId,\n      resourceId: node.id as string,\n      version: node.workflow_version,\n      depth,\n    });\n\n    (dependencies?.knowledge_list || []).map(k => {\n      const newS = this.transformDuplicateInfo(\n        k.id as string,\n        k,\n        'knowledge',\n        depth,\n        nodeId,\n      );\n      if (newS) {\n        this.treeHistory.push({\n          id: newS.id,\n          resourceId: newS.data?.id,\n          version: newS.data?.version,\n          depth: newS.data?.depth,\n        });\n        children.push({\n          ...newS,\n          data: newS.data || {},\n          type: newS.type as string,\n          parent: [],\n          children: [],\n        });\n      }\n    });\n    (dependencies?.table_list || []).map(t => {\n      const newS = this.transformDuplicateInfo(\n        t.id as string,\n        t,\n        'table',\n        depth,\n        nodeId,\n      );\n      if (newS) {\n        this.treeHistory.push({\n          id: newS.id,\n          resourceId: newS.data?.id,\n          version: newS.data?.version,\n          depth: newS.data?.depth,\n        });\n        children.push({\n          ...newS,\n          data: newS.data || {},\n          type: newS.type as string,\n          parent: [],\n          children: [],\n        });\n      }\n    });\n    (dependencies?.plugin_version || []).map(p => {\n      const newS = this.transformDuplicateInfo(\n        p.id as string,\n        p,\n        'plugin',\n        depth,\n        nodeId,\n      );\n      if (newS) {\n        this.treeHistory.push({\n          id: newS.id,\n          resourceId: newS.data?.id,\n          version: newS.data?.version,\n          depth: newS.data?.depth,\n        });\n        children.push({\n          ...newS,\n          data: newS.data || {},\n          type: newS.type as string,\n          parent: [],\n          children: [],\n        });\n      }\n    });\n    (dependencies?.workflow_version?.filter(v => v.id !== node.id) || []).map(\n      w => {\n        const workflowInfo = this.globalJson.node_list?.find(\n          _node => _node.id === w.id && _node.workflow_version === w.version,\n        );\n        const subWorkflowSchema = this.dfsTransformNodeToSchema(\n          depth + 1,\n          workflowInfo!,\n          undefined,\n          nodeId,\n        );\n        // Detect duplication of workflow\n        if (subWorkflowSchema) {\n          this.treeHistory.push({\n            id: subWorkflowSchema.id,\n            resourceId: subWorkflowSchema.data?.id || '',\n            version: subWorkflowSchema.data?.version,\n            depth: subWorkflowSchema?.data?.depth,\n          });\n          children.push(subWorkflowSchema);\n        }\n      },\n    );\n    const isNodeEnd = !children.length;\n    return {\n      id: nodeId,\n      type: isNodeEnd ? 'custom' : 'split',\n      parent: [],\n      data: {\n        id: node.id,\n        name: node.name,\n        type:\n          type || (node.is_chatflow ? NodeType.CHAT_FLOW : NodeType.WORKFLOW),\n        from,\n        collapsed: false,\n        version: node.workflow_version,\n        depth,\n      },\n      ...(isNodeEnd\n        ? {\n            meta: {\n              isNodeEnd: true,\n            },\n          }\n        : {}),\n      children,\n    };\n  };\n\n  // Expand all child elements\n  dfsCloneCollapsedOpen(node: TreeNode): TreeNode {\n    const children = node.children?.map(c => this.dfsCloneCollapsedOpen(c));\n    return {\n      ...node,\n      data: {\n        ...node.data,\n        collapsed: false,\n      },\n      children,\n    };\n  }\n\n  // According to edges, move the node to the children of another TreeNode.\n  // It needs to be collapsed and opened\n  cloneNode(node: TreeNode) {\n    return this.dfsCloneCollapsedOpen(node);\n  }\n\n  /**\n   * Bind parent element parent\n   */\n  bindTreeParent(node: TreeNode, parent?: TreeNode) {\n    if (parent) {\n      node.parent.push(parent);\n    }\n    this.edges.forEach(edge => {\n      if (edge.to === node.id) {\n        const fromNode = this.getNodeByIdFromTree(edge.from);\n        if (fromNode) {\n          node.parent.push(fromNode);\n        }\n      }\n    });\n    node.children?.forEach(item => {\n      this.bindTreeParent(item, node);\n    });\n  }\n\n  /**\n   * Initialize the data and turn the data from the back-end data json into a tree structure\n   */\n  transformSchema(json: DependencyTree) {\n    this.globalJson = json;\n    const { node_list = [] } = json;\n    const rootWorkflow = node_list.find(node => node.is_root);\n    if (!rootWorkflow) {\n      return undefined;\n    }\n    const root = this.dfsTransformNodeToSchema(0, rootWorkflow);\n    if (root) {\n      this.root = root;\n      // this.bindTreeParent(root);\n    }\n  }\n\n  dfsTreeJson(node: TreeNode): FlowNodeJSON {\n    let blocks: FlowNodeJSON[] = [];\n    const lines = this.getUnCollapsedEdges();\n    node?.children?.forEach(c => {\n      const connectLines = lines.filter(l => l.to === c.id);\n      if (c.data?.collapsed && connectLines?.length) {\n        const cloneNode = this.cloneNode(c);\n        connectLines.forEach(l => {\n          this.addChildrenArr.push({\n            parentId: l.from,\n            json: this.dfsTreeJson(cloneNode),\n          });\n        });\n      }\n    });\n    if (node?.children?.length) {\n      blocks = node.children\n        .filter(c => !c?.data?.collapsed)\n        .map(c => ({\n          id: `${c.id}_block`,\n          type: 'block',\n          blocks: [this.dfsTreeJson(c)],\n        }));\n    }\n    return {\n      id: node?.id,\n      type: node?.type,\n      data: node?.data,\n      meta: node?.meta,\n      blocks,\n    };\n  }\n\n  addNode(\n    json: FlowNodeJSON,\n    addItem: {\n      parentId: string;\n      json: FlowNodeJSON;\n    },\n  ) {\n    if (json.id === addItem.parentId) {\n      const blockItem = {\n        id: `${addItem.json.id}_block`,\n        type: 'block',\n        blocks: [addItem.json],\n      };\n      if (json.blocks) {\n        json.blocks.push(blockItem);\n      } else {\n        json.blocks = [blockItem];\n      }\n    } else {\n      json.blocks?.forEach(block => {\n        this.addNode(block, addItem);\n      });\n    }\n    // Perhaps because of this, the node that was originally set to end now has children\n    if (json.blocks?.length) {\n      if (json.type === 'custom') {\n        json.type = 'split';\n      }\n      if (json.meta) {\n        json.meta.isNodeEnd = false;\n      } else {\n        json.meta = {\n          isNodeEnd: true,\n        };\n      }\n    }\n  }\n\n  treeToFlowNodeJson() {\n    this.addChildrenArr = [];\n    const rootNodeJson = this.dfsTreeJson(this.root);\n    if (!rootNodeJson || !rootNodeJson?.id) {\n      const json = {\n        nodes: [],\n      };\n      this.document.fromJSON(json);\n      return json;\n    }\n\n    const json2 = {\n      nodes: [rootNodeJson],\n    };\n\n    this.addChildrenArr.forEach(item => {\n      this.addNode(rootNodeJson, item);\n    });\n\n    this.document.fromJSON(json2);\n    return json2;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  EntityManager,\n  FlowDocument,\n  type FlowNodeEntity,\n  FlowNodeTransformData,\n  type IPoint,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport type { CustomLine, EdgeItem } from '../typings';\nimport { CustomRenderStateEntity } from '../entities';\nimport { NODE_HEIGHT } from '../constants';\nimport { TreeService } from './tree-service';\n\nconst FILTER_NODE_TYPE = ['block', 'blockIcon', 'root', 'inlineBlocks'];\n\n@injectable()\nexport class CustomLinesManager {\n  @inject(FlowDocument) declare document: FlowDocument;\n\n  @inject(EntityManager) declare entityManager: EntityManager;\n\n  // Additional connection\n  @inject(TreeService) declare treeService: TreeService;\n\n  get edges(): EdgeItem[] {\n    return this.treeService.edges;\n  }\n\n  get treeNodes() {\n    return this.filterTreeNode(this.document.getAllNodes());\n  }\n\n  private _lines: CustomLine[] = [];\n\n  get lines() {\n    return this._lines;\n  }\n\n  set lines(lines: CustomLine[]) {\n    this._lines = lines;\n  }\n\n  /**\n   * Filter other non-rendering nodes\n   */\n  filterTreeNode(nodes: FlowNodeEntity[]) {\n    return nodes.filter(\n      node => !FILTER_NODE_TYPE.includes(node.flowNodeType as string),\n    );\n  }\n\n  getOutputFromInput(inputPoint: IPoint) {\n    return {\n      x: inputPoint.x,\n      y: inputPoint.y + NODE_HEIGHT,\n    };\n  }\n\n  bfsAddLine(root: FlowNodeEntity): CustomLine[] {\n    const queue: FlowNodeEntity[] = [root];\n    const result: CustomLine[] = [];\n\n    while (queue.length > 0) {\n      const node = queue.shift()!;\n      if (node.next) {\n        result.push({\n          from: node,\n          to: node.next,\n          fromPoint: this.getOutputFromInput(\n            node.getData(FlowNodeTransformData)?.inputPoint,\n          ),\n          toPoint: node.next.getData(FlowNodeTransformData)?.inputPoint,\n        });\n        queue.push(node.next);\n      }\n      if (node.children?.length) {\n        if (node.flowNodeType === 'root') {\n          queue.push(node.children[0]);\n        } else if (node.flowNodeType === 'split') {\n          // Branch logic special handling\n          const inlineBlocksChildren = node.children[1]?.children || [];\n          const branchChildren =\n            inlineBlocksChildren\n              ?.map(c => c?.children?.[0]?.children?.[0])\n              ?.filter(Boolean) || [];\n          branchChildren.forEach(child => {\n            result.push({\n              from: node,\n              to: child,\n              fromPoint: this.getOutputFromInput(\n                node.getData(FlowNodeTransformData)?.inputPoint,\n              ),\n              toPoint: child.getData(FlowNodeTransformData)?.inputPoint,\n            });\n          });\n          queue.push(...branchChildren);\n        } else {\n          node.children.forEach(child => {\n            result.push({\n              from: node,\n              to: child,\n              fromPoint: this.getOutputFromInput(\n                node.getData(FlowNodeTransformData)?.inputPoint,\n              ),\n              toPoint: child.getData(FlowNodeTransformData)?.inputPoint,\n            });\n          });\n          queue.push(...node.children);\n        }\n      }\n    }\n\n    return result;\n  }\n\n  initLines() {\n    if (this._lines?.length) {\n      return;\n    }\n    this.renderLines();\n  }\n\n  renderLines() {\n    // The next frame is rendered to ensure the latest line data\n    requestAnimationFrame(() => {\n      const lines = this.bfsAddLine(this.document.originTree.root);\n      const extraLines: CustomLine[] = (this.edges || [])\n        .filter(edge => {\n          const from = this.entityManager.getEntityById<FlowNodeEntity>(\n            edge.from,\n          )!;\n          const to = this.entityManager.getEntityById<FlowNodeEntity>(edge.to)!;\n          return from && to && !edge.collapsed;\n        })\n        .map(edge => {\n          const from = this.entityManager.getEntityById<FlowNodeEntity>(\n            edge.from,\n          )!;\n          const to = this.entityManager.getEntityById<FlowNodeEntity>(edge.to)!;\n          return {\n            from,\n            to,\n            fromPoint: this.getOutputFromInput(\n              from.getData(FlowNodeTransformData)?.inputPoint,\n            ),\n            toPoint: to.getData(FlowNodeTransformData)?.inputPoint,\n          };\n        });\n      this._lines = [...lines, ...extraLines];\n      const renderState = this.entityManager.getEntity<CustomRenderStateEntity>(\n        CustomRenderStateEntity,\n      );\n      renderState?.updateVersion();\n    });\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const NODE_WIDTH = 200;\nexport const NODE_HEIGHT = 80;\n\nexport const COLLAPSE_WIDTH = 14;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const STROKE_WIDTH = 2;\nexport const ARROW_HEIGHT = 7;\nexport const LINE_CLASS_NAME = 'resource-tree-custom-line';\nexport const LINE_HOVER_DISTANCE = 8; // Minimum detection distance of line hover\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  Emitter,\n  EntityManager,\n  FlowDocument,\n  type IPoint,\n  type PositionSchema,\n  type FlowNodeEntity,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport {\n  getLineId,\n  getNodeIdFromTreeId,\n  getTreeIdFromNodeId,\n  calcDistance,\n} from '../utils';\nimport { type CustomLine, type EdgeItem } from '../typings';\nimport { CustomRenderStateConfigEntity } from '../entities';\nimport { LINE_HOVER_DISTANCE } from '../constants';\nimport { TreeService } from './tree-service';\nimport { CustomLinesManager } from './custom-lines-manager';\n\n@injectable()\nexport class CustomHoverService {\n  @inject(CustomLinesManager) declare linesManager: CustomLinesManager;\n\n  @inject(FlowDocument) declare document: FlowDocument;\n\n  @inject(TreeService) declare treeService: TreeService;\n\n  @inject(EntityManager) declare entityManager: EntityManager;\n\n  @inject(CustomRenderStateConfigEntity)\n  declare renderStateEntity: CustomRenderStateConfigEntity;\n\n  get edges(): EdgeItem[] {\n    return this.treeService.getUnCollapsedEdges();\n  }\n\n  private onBackgroundClickEmitter = new Emitter<void>();\n\n  onBackgroundClick = this.onBackgroundClickEmitter.event;\n\n  private onHoverCollapseEmitter = new Emitter<FlowNodeEntity | undefined>();\n\n  onHoverCollapse = this.onHoverCollapseEmitter.event;\n\n  private onHoverLineEmitter = new Emitter<CustomLine | undefined>();\n\n  onHoverLine = this.onHoverLineEmitter.event;\n\n  private onSelectNodeEmitter = new Emitter<void>();\n\n  onSelectNode = this.onSelectNodeEmitter.event;\n\n  private _hoveredLine: CustomLine | undefined;\n\n  get hoveredLine() {\n    return this._hoveredLine;\n  }\n\n  /**\n   * Calculate and line spacing based on mouse position\n   */\n  getCloseInLineFromMousePos(\n    mousePos: IPoint,\n    minDistance: number = LINE_HOVER_DISTANCE,\n  ): CustomLine | undefined {\n    let targetLine: CustomLine | undefined, targetLineDist: number | undefined;\n    (this.linesManager?.lines || []).forEach(line => {\n      const dist = calcDistance(mousePos, line);\n\n      if (dist <= minDistance && (!targetLineDist || targetLineDist >= dist)) {\n        targetLineDist = dist;\n        targetLine = line;\n      }\n    });\n    return targetLine;\n  }\n\n  updateHoverLine(pos: PositionSchema, checkTarget: boolean) {\n    if (!checkTarget) {\n      this.onHoverLineEmitter.fire(undefined);\n    }\n    const hoverLine = this.getCloseInLineFromMousePos(pos);\n    if (hoverLine) {\n      this.onHoverLineEmitter.fire(hoverLine);\n      this._hoveredLine = hoverLine;\n    } else {\n      this.onHoverLineEmitter.fire(undefined);\n      this._hoveredLine = undefined;\n    }\n    return hoverLine;\n  }\n\n  backgroundClick(updateLines = true) {\n    this.onBackgroundClickEmitter.fire();\n    this.renderStateEntity.setSelectNodes([]);\n    this.renderStateEntity.setActivatedNode(undefined);\n    if (this.hoveredLine) {\n      const lineId = getLineId(this._hoveredLine);\n      this.renderStateEntity.activeLines = [lineId!];\n    } else if (updateLines) {\n      this.renderStateEntity.activeLines = [];\n    } else {\n      this.renderStateEntity.activeLines = [];\n    }\n  }\n\n  // Collapse strategy: access all connected elements and access their parent elements simultaneously, performing collapse.\n  hoverCollapse(from?: FlowNodeEntity) {\n    this.onHoverCollapseEmitter.fire(from);\n  }\n\n  getParent(node?: FlowNodeEntity): FlowNodeEntity | undefined {\n    if (!node) {\n      return node;\n    }\n    if (node.flowNodeType !== 'blockIcon') {\n      return this.getParent(node.parent);\n    } else {\n      return node;\n    }\n  }\n\n  selectNode(node: FlowNodeEntity) {\n    const selectNodes = this.getRelatedNodes(node);\n    this.renderStateEntity.setSelectNodes(selectNodes);\n    this.renderStateEntity.setActivatedNode(node);\n    // Highlight all relevant lines\n    const activeLines: string[] = [];\n    this.linesManager.lines.map(line => {\n      const fromInclude = selectNodes.includes(line.from.id);\n      const toInclude = selectNodes.includes(line.to.id);\n      if (fromInclude && toInclude) {\n        activeLines.push(getLineId(line)!);\n      }\n    });\n    this.renderStateEntity.activeLines = activeLines;\n    this.linesManager.renderLines();\n  }\n\n  traverseAncestors = (node: FlowNodeEntity): string[] => {\n    let ancArr: string[] = [];\n    if (node.parent) {\n      const arr = this.traverseAncestors(node.parent);\n      ancArr = ancArr.concat(arr);\n    }\n    this.edges.forEach(edge => {\n      if (edge.to === getTreeIdFromNodeId(node.id)) {\n        // Push extra lines\n        ancArr.push(edge.from);\n        // Traverse the previous node information\n        const fromNode = this.document.getNode(getNodeIdFromTreeId(edge.from));\n        if (fromNode) {\n          const arr = this.traverseAncestors(fromNode);\n          ancArr.concat(arr);\n        }\n      }\n    });\n    ancArr.push(node.id);\n    return ancArr;\n  };\n\n  traverseDescendants = (node: FlowNodeEntity): string[] => {\n    let ancArr: string[] = [];\n    if (node.children?.length) {\n      node.children?.forEach(child => {\n        ancArr.push(child.id);\n        const childArr = this.traverseDescendants(child);\n        ancArr = ancArr.concat(childArr);\n      });\n    }\n    if (node.next) {\n      const childArr = this.traverseDescendants(node.next);\n      ancArr = ancArr.concat(childArr);\n    }\n    return ancArr;\n  };\n\n  /**\n   * According to the current tree structure, iterate through the nodes and select\n   */\n  getRelatedNodes = (node: FlowNodeEntity) => {\n    const parentRelated = this.traverseAncestors(node);\n    const childRelated = this.traverseDescendants(node);\n    return [...parentRelated, ...childRelated];\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  bindConfigEntity,\n  definePluginCreator,\n  type PluginCreator,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport {\n  CustomLinesManager,\n  CustomHoverService,\n  TreeService,\n} from '../services';\nimport { CustomRenderStateConfigEntity } from '../entities';\n\nexport const createCustomLinesPlugin: PluginCreator<any> =\n  definePluginCreator<any>({\n    onBind: ({ bind }) => {\n      bind(CustomLinesManager).toSelf().inSingletonScope();\n      bind(CustomHoverService).toSelf().inSingletonScope();\n      bind(TreeService).toSelf().inSingletonScope();\n      bindConfigEntity(bind, CustomRenderStateConfigEntity);\n    },\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type FlowNodeJSON,\n  FlowNodeBaseType,\n  type FlowNodeEntity,\n  type FlowNodeRegister,\n} from '@flowgram-adapter/fixed-layout-editor';\n/**\n * BlockOrderIcon-free branch nodes\n */\nexport const Split: FlowNodeRegister = {\n  type: 'split',\n  extend: 'dynamicSplit',\n  onBlockChildCreate(\n    originParent: FlowNodeEntity,\n    blockData: FlowNodeJSON,\n    addedNodes: FlowNodeEntity[] = [], // All newly created nodes must exist here\n  ) {\n    const { document } = originParent;\n    const parent = document.getNode(`$inlineBlocks$${originParent.id}`);\n    // The block node will generate an empty block node to cut the block.\n    const proxyBlock = document.addNode({\n      id: `$block$${blockData.id}`,\n      type: FlowNodeBaseType.BLOCK,\n      originParent,\n      parent,\n    });\n    const realBlock = document.addNode(\n      {\n        ...blockData,\n        type: blockData.type || FlowNodeBaseType.BLOCK,\n        parent: proxyBlock,\n      },\n      addedNodes,\n    );\n    addedNodes.push(proxyBlock, realBlock);\n    return proxyBlock;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function Arrow({ color }: { color: string }) {\n  return (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      style={{\n        transform: 'rotate(-90deg)',\n      }}\n    >\n      <circle\n        cx=\"8\"\n        cy=\"8\"\n        r=\"7\"\n        fill=\"transparent\"\n        stroke={color}\n        strokeWidth={1.6}\n      />\n      <path\n        fill={color}\n        d=\"M10.8281 9.4715C11.0883 9.21131 11.0885 8.78909 10.8291 8.52804C10.6413 8.33892 10.4536 8.14952 10.266 7.9601C9.66706 7.35551 9.06799 6.75079 8.46068 6.15496C8.20439 5.90352 7.7947 5.90352 7.53841 6.15496C6.93103 6.75085 6.33191 7.35564 5.73291 7.96029C5.5454 8.14957 5.3579 8.33884 5.17017 8.52782C4.91075 8.78895 4.91096 9.21099 5.17124 9.47127C5.43152 9.73155 5.85355 9.73176 6.11383 9.47148L7.99955 7.58576L9.88548 9.4717C10.1457 9.73189 10.5679 9.73169 10.8281 9.4715Z\"\n      />\n      <path\n        fill={color}\n        d=\"M0.888672 7.99997C0.888672 4.07261 4.07242 0.888855 7.99978 0.888855C11.9271 0.888855 15.1109 4.07261 15.1109 7.99997C15.1109 11.9273 11.9271 15.1111 7.99978 15.1111C4.07242 15.1111 0.888672 11.9273 0.888672 7.99997ZM13.818 7.99997C13.818 4.78667 11.2131 2.18178 7.99978 2.18178C4.78649 2.18178 2.1816 4.78667 2.1816 7.99997C2.1816 11.2133 4.78649 13.8181 7.99978 13.8181C11.2131 13.8181 13.818 11.2133 13.818 7.99997Z\"\n      />\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport {\n  type CollapseProps,\n  useService,\n  useBaseColor,\n  EntityManager,\n  useRefresh,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { getTreeIdFromNodeId } from '../../utils';\nimport {\n  CustomHoverService,\n  CustomLinesManager,\n  TreeService,\n} from '../../services';\nimport { Arrow } from './arrow';\n\nimport s from './index.module.less';\n\nexport function Collapse(props: Omit<CollapseProps, 'collapsed'>): JSX.Element {\n  const { collapseNode, hoverActivated } = props;\n\n  const hoverService = useService<CustomHoverService>(CustomHoverService);\n  const treeService = useService<TreeService>(TreeService);\n  const linesManager = useService<CustomLinesManager>(CustomLinesManager);\n  const entityManager = useService<EntityManager>(EntityManager);\n\n  const refresh = useRefresh();\n\n  const treeNode = treeService.getNodeByIdFromTree(\n    getTreeIdFromNodeId(collapseNode.id),\n  );\n\n  const { edges: originEdges } = treeService;\n  const edges = treeService.getUnCollapsedEdges();\n  // If there are no child elements, it is collapsed.\n  // Also determine whether there are lines connecting\n  const collapsed =\n    !collapseNode?.children?.length &&\n    !collapseNode.next &&\n    !edges.some(edge => edge.from === collapseNode.id);\n\n  const { baseActivatedColor } = useBaseColor();\n\n  const rerenderLines = () => {\n    setTimeout(() => {\n      linesManager.renderLines();\n    }, 50);\n  };\n\n  const collapseBlock = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (treeNode) {\n      originEdges\n        .filter(_e => _e.from === treeNode.id && !_e.collapsed)\n        .forEach(edge => (edge.collapsed = true));\n      treeNode.children?.forEach(c => {\n        if (c.type !== 'blockIcon') {\n          c.data!.collapsed = true;\n        }\n      });\n    }\n    // Node redraw\n    treeService.treeToFlowNodeJson();\n    // Line redrawing\n    rerenderLines();\n  };\n\n  const openBlock = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (treeNode) {\n      originEdges\n        .filter(_e => _e.from === treeNode.id && _e.collapsed)\n        .forEach(edge => (edge.collapsed = false));\n      treeNode.children?.forEach(c => {\n        if (c.type !== 'blockIcon') {\n          c.data!.collapsed = false;\n        }\n      });\n    }\n    // Node redraw\n    treeService.treeToFlowNodeJson();\n    rerenderLines();\n  };\n\n  // flow-labels-layer is not updated\n  useEffect(() => {\n    const disposable = entityManager.onEntityChange(() => {\n      refresh();\n    });\n    return () => {\n      disposable.dispose();\n    };\n  }, []);\n\n  // expand\n  if (collapsed) {\n    let childCount = 0;\n    if (treeNode) {\n      childCount = treeNode.children?.length || 0;\n    }\n    if (originEdges?.length) {\n      const num = originEdges.reduce((sum, e) => {\n        if (e.from === collapseNode.id) {\n          return (sum += 1);\n        }\n        return sum;\n      }, 0);\n      childCount += num;\n    }\n\n    return (\n      <div\n        className={s.container}\n        onClick={openBlock}\n        style={{\n          background: hoverActivated ? '#82A7FC' : '#BBBFC4',\n        }}\n        aria-hidden=\"true\"\n      >\n        <span\n          style={{\n            transform: 'rotate(-90deg)',\n          }}\n        >\n          {childCount}\n        </span>\n      </div>\n    );\n  }\n\n  // dark: var(--semi-color-black)\n  // light: var(--semi-color-white)\n  const color = baseActivatedColor;\n\n  const handleHover = () => {\n    hoverService.hoverCollapse(collapseNode);\n  };\n\n  const handleLeave = () => {\n    hoverService.hoverCollapse(undefined);\n  };\n\n  // collapse\n  return (\n    <div\n      className={s.container}\n      onClick={collapseBlock}\n      onMouseEnter={handleHover}\n      onMouseLeave={handleLeave}\n      aria-hidden=\"true\"\n      onMouseMove={e => e.stopPropagation()}\n    >\n      <Arrow color={color} />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport interface TreeContextValue {\n  renderLinkNode?: (extInfo: any) => React.ReactNode;\n}\n\nexport const TreeContext = React.createContext<TreeContextValue>({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DependencyOrigin, NodeType } from '../../typings';\n\nexport const colorMap: Record<NodeType, string> = {\n  [NodeType.WORKFLOW]: 'linear-gradient(#ebf9f0 0%, var(--coz-bg-plus) 100%)',\n  [NodeType.CHAT_FLOW]: 'linear-gradient(#ebf9f0 0%, var(--coz-bg-plus) 100%)',\n  [NodeType.PLUGIN]: 'linear-gradient(#fbf2ff 0%, var(--coz-bg-plus) 100%)',\n  [NodeType.KNOWLEDGE]: 'linear-gradient(#fff5ed 0%, var(--coz-bg-plus) 100%)',\n  [NodeType.DATABASE]: 'linear-gradient(#fef9eb 0%, var(--coz-bg-plus) 100%)',\n};\n\nexport const contentMap = {\n  [NodeType.WORKFLOW]: 'edit_block_api_workflow',\n  [NodeType.CHAT_FLOW]: 'wf_chatflow_76',\n  [NodeType.PLUGIN]: 'edit_block_api_plugin',\n  [NodeType.KNOWLEDGE]: 'datasets_title',\n  [NodeType.DATABASE]: 'bot_database',\n};\n\nexport const getFromText = {\n  [DependencyOrigin.APP]: '',\n  [DependencyOrigin.LIBRARY]: 'workflow_version_origin_text',\n  [DependencyOrigin.SHOP]: 'navigation_store',\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport { IconCozInfinity } from '@coze-arch/coze-design/icons';\nimport { Tag, Tooltip } from '@coze-arch/coze-design';\n\nimport { type DependencyOrigin, type NodeType } from '../../typings';\nimport { contentMap, getFromText } from './constants';\n\nimport s from './index.module.less';\n\nexport const Tags = ({\n  type,\n  from,\n  loop,\n  version,\n}: {\n  type: NodeType;\n  from: DependencyOrigin;\n  loop?: boolean;\n  version?: string;\n}) => {\n  const typeText = contentMap[type] as I18nKeysNoOptionsType;\n  const fromText = getFromText[from] as I18nKeysNoOptionsType;\n\n  return (\n    <div className={s['tag-container']}>\n      <Tag className={s.tag} color=\"primary\">\n        {I18n.t(typeText)}\n      </Tag>\n      {fromText ? (\n        <Tag className={s.tag} color=\"primary\">\n          {I18n.t(fromText)}\n        </Tag>\n      ) : null}\n      {version ? (\n        <Tag className={s.tag} color=\"primary\">\n          {version}\n        </Tag>\n      ) : null}\n      {loop ? (\n        <Tooltip content={I18n.t('reference_graph_node_loop_tip')} theme=\"dark\">\n          <Tag className={s.tag} color=\"primary\">\n            <IconCozInfinity style={{ fill: 'var(--coz-fg-hglt)' }} />\n          </Tag>\n        </Tooltip>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { CozAvatar } from '@coze-arch/coze-design';\n\nimport { NodeType } from '../../typings';\nimport { ReactComponent as IconWorkflow } from '../../assets/icon-workflow.svg';\nimport { ReactComponent as IconPlugin } from '../../assets/icon-plugin.svg';\nimport { ReactComponent as IconKnowledge } from '../../assets/icon-knowledge.svg';\nimport { ReactComponent as IconDatabase } from '../../assets/icon-database.svg';\nimport { ReactComponent as IconChatflow } from '../../assets/icon-chatflow.svg';\n\nexport const Icon = ({ type, icon }: { type: NodeType; icon?: string }) => {\n  const [error, setError] = useState(false);\n  if (icon && !error) {\n    return (\n      <CozAvatar\n        size=\"small\"\n        type=\"bot\"\n        src={icon}\n        onError={() => setError(true)}\n      />\n    );\n  }\n  if (type === NodeType.CHAT_FLOW) {\n    return <IconChatflow />;\n  }\n  if (type === NodeType.WORKFLOW) {\n    return <IconWorkflow />;\n  }\n  if (type === NodeType.KNOWLEDGE) {\n    return <IconKnowledge />;\n  }\n  if (type === NodeType.DATABASE) {\n    return <IconDatabase />;\n  }\n  // Plugin from store and repository scenes have different default icons\n  if (type === NodeType.PLUGIN) {\n    return <IconPlugin />;\n  }\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useState, useContext } from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { ConfigProvider, Typography } from '@coze-arch/coze-design';\nimport {\n  type FlowNodeEntity,\n  useConfigEntity,\n  useService,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { Collapse } from '../collapse';\nimport { getNodeExtInfo, getTreeIdFromNodeId } from '../../utils';\nimport { type NodeType, type CustomLine } from '../../typings';\nimport { CustomHoverService, TreeService } from '../../services';\nimport { useCustomNodeRender } from '../../hooks';\nimport { CustomRenderStateConfigEntity } from '../../entities';\nimport { TreeContext } from '../../contexts';\nimport { NODE_WIDTH, COLLAPSE_WIDTH, NODE_HEIGHT } from '../../constants';\nimport { Tags } from './tags';\nimport { Icon } from './icon';\nimport { colorMap } from './constants';\n\nimport s from './index.module.less';\n\nconst { Text } = Typography;\n\nexport const BaseNode = ({ node }: { node: FlowNodeEntity }) => {\n  const nodeRender = useCustomNodeRender();\n  const treeService = useService<TreeService>(TreeService);\n  // Schema Information Store\n  const extraInfo = nodeRender.getExtInfo();\n  const [hoverNode, setHoverNode] = useState(false);\n  const { renderLinkNode } = useContext(TreeContext);\n\n  const { edges } = treeService;\n\n  const getPopupContainer = useCallback(\n    () => node.renderData.node || document.body,\n    [],\n  );\n  const [collapseVisible, setCollapseVisible] = useState(false);\n  const nodeState = useConfigEntity<CustomRenderStateConfigEntity>(\n    CustomRenderStateConfigEntity,\n    true,\n  );\n\n  const nodeId = getTreeIdFromNodeId(node.id);\n  const highlight = nodeState.selectNodes.includes(nodeId);\n  const activatedResId: string = nodeState.activatedNode\n    ? getNodeExtInfo(nodeState.activatedNode).id\n    : '';\n  const activatedVersion = nodeState.activatedNode\n    ? getNodeExtInfo(nodeState.activatedNode).version\n    : '';\n  const isOtherVersion = activatedResId === extraInfo.id;\n  const activated = nodeState.activatedNode?.id === node.id;\n\n  const hoverService = useService<CustomHoverService>(CustomHoverService);\n\n  useEffect(() => {\n    const disposable = hoverService.onHoverLine((line?: CustomLine) => {\n      if (line?.from?.id && node?.id?.includes(line?.from?.id)) {\n        setCollapseVisible(true);\n      } else {\n        setCollapseVisible(false);\n      }\n    });\n    return () => disposable?.dispose();\n  }, []);\n\n  const handleClick = (e: React.MouseEvent) => {\n    // 1. Uncheck other selected lines\n    hoverService.backgroundClick();\n    // 2. Select the node and recalculate the lines that need to be selected.\n    hoverService.selectNode(node);\n    e.stopPropagation();\n  };\n\n  const handleMouseEnter = () => {\n    setHoverNode(true);\n    // Determine the node type\n    if (\n      node.flowNodeType !== 'custom' ||\n      edges.some(edge => edge.from === node.id)\n    ) {\n      setCollapseVisible(true);\n    }\n  };\n  const handleMouseLeave = () => {\n    setHoverNode(false);\n    setCollapseVisible(false);\n  };\n\n  const collapsed =\n    (node.flowNodeType === 'blockIcon' &&\n      !node?.children?.length &&\n      !node.next) ||\n    edges.find(e => e.from === node.id)?.collapsed;\n\n  const { loop } = extraInfo;\n\n  return (\n    <ConfigProvider getPopupContainer={getPopupContainer}>\n      <div\n        className={classNames(s.nodeContainer, {\n          [s.activated]: activated || isOtherVersion,\n          [s.highlight]: isOtherVersion || highlight,\n        })}\n        style={{\n          background: colorMap[extraInfo.type as NodeType],\n        }}\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n        onClick={handleClick}\n      >\n        <div className={s.header}>\n          <div className={s['icon-container']}>\n            <Icon type={extraInfo.type} icon={extraInfo.icon} />\n          </div>\n          <Text\n            className={s.title}\n            ellipsis={{\n              showTooltip: {\n                type: 'tooltip',\n                opts: {\n                  theme: 'dark',\n                },\n              },\n            }}\n          >\n            {extraInfo.name}\n          </Text>\n          {hoverNode ? renderLinkNode?.(extraInfo) || null : null}\n        </div>\n        <Tags\n          type={extraInfo.type}\n          from={extraInfo.from}\n          loop={loop}\n          version={extraInfo.version}\n        />\n        {collapseVisible || collapsed ? (\n          <div\n            style={{\n              position: 'absolute',\n              left: NODE_WIDTH / 2 - COLLAPSE_WIDTH / 2,\n              top: NODE_HEIGHT + 2,\n              rotate: '90deg',\n            }}\n          >\n            <Collapse\n              node={node}\n              collapseNode={node}\n              collapsed={collapsed}\n              hoverActivated={hoverNode}\n            />\n          </div>\n        ) : null}\n        {/* Different versions of tags */}\n        {isOtherVersion && !activated ? (\n          <div className={s['diff-tag']}>\n            {activatedVersion === extraInfo.version\n              ? I18n.t('reference_graph_tag_different_version_same_resource')\n              : I18n.t(\n                  'reference_graph_tag_different_version_of_same_resource',\n                )}\n          </div>\n        ) : null}\n      </div>\n    </ConfigProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useContext, useMemo } from 'react';\n\nimport {\n  usePlayground,\n  type FlowNodeEntity,\n  FlowNodeRenderData,\n  PlaygroundEntityContext,\n  type NodeFormProps,\n  getNodeForm,\n} from '@flowgram-adapter/fixed-layout-editor';\nimport { useObserve } from '@flowgram-adapter/common';\n\nimport { getStoreNode } from '../utils';\n\nexport interface NodeRenderReturnType {\n  /**\n   * The current node (if it is an icon, it will return its parent node)\n   */\n  node: FlowNodeEntity;\n  /**\n   * Is the node active?\n   */\n  activated: boolean;\n  /**\n   * Is the node expanded?\n   */\n  expanded: boolean;\n  /**\n   * Mouse entry, mainly used to control the activated state\n   */\n  onMouseEnter: (e: React.MouseEvent) => void;\n  /**\n   * The mouse leaves, mainly used to control the activated state\n   */\n  onMouseLeave: (e: React.MouseEvent) => void;\n\n  /**\n   * Render the form, which can only be used if the node engine is turned on\n   */\n  form: NodeFormProps<any> | undefined;\n\n  /**\n   * Get the extended data of the node\n   */\n  getExtInfo<T = any>(): T;\n\n  /**\n   * Update the extended data of the node\n   * @param extInfo\n   */\n  updateExtInfo<T = any>(extInfo: T): void;\n\n  /**\n   * Expand/Collapse Nodes\n   * @param expanded\n   */\n  toggleExpand(): void;\n  /**\n   * Global readonly state\n   */\n  readonly: boolean;\n}\n\n/**\n * Custom useNodeRender\n * Do not distinguish between blockIcon and inlineBlocks\n */\nexport function useCustomNodeRender(\n  nodeFromProps?: FlowNodeEntity,\n): NodeRenderReturnType {\n  const ctx = useContext<FlowNodeEntity>(PlaygroundEntityContext);\n  const renderNode = nodeFromProps || ctx;\n  const renderData =\n    renderNode.getData<FlowNodeRenderData>(FlowNodeRenderData)!;\n  const { node } = getStoreNode(renderNode);\n  const { expanded, activated } = renderData;\n  const playground = usePlayground();\n\n  const onMouseEnter = useCallback(() => {\n    renderData.toggleMouseEnter();\n  }, [renderData]);\n\n  const onMouseLeave = useCallback(() => {\n    renderData.toggleMouseLeave();\n  }, [renderData]);\n\n  const toggleExpand = useCallback(() => {\n    renderData.toggleExpand();\n  }, [renderData]);\n\n  const getExtInfo = useCallback(() => node.getExtInfo() as any, [node]);\n  const updateExtInfo = useCallback(\n    (data: any) => {\n      node.updateExtInfo(data);\n    },\n    [node],\n  );\n  const form = useMemo(() => getNodeForm(node), [node]);\n  // Listen FormState change\n  const formState = useObserve<any>(form?.state);\n\n  const { readonly } = playground.config;\n\n  return useMemo(\n    () => ({\n      node,\n      activated,\n      readonly,\n      expanded,\n      onMouseEnter,\n      onMouseLeave,\n      getExtInfo,\n      updateExtInfo,\n      toggleExpand,\n      get form() {\n        if (!form) {\n          return undefined;\n        }\n        return {\n          ...form,\n          get values() {\n            return form.values!;\n          },\n          get state() {\n            return formState;\n          },\n        };\n      },\n    }),\n    [\n      node,\n      activated,\n      readonly,\n      expanded,\n      onMouseEnter,\n      onMouseLeave,\n      getExtInfo,\n      updateExtInfo,\n      toggleExpand,\n      form,\n      formState,\n    ],\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-magic-numbers */\nimport { useMemo, useState, type CSSProperties } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowDown } from '@coze-arch/coze-design/icons';\nimport { Dropdown, Divider } from '@coze-arch/coze-design';\nimport {\n  usePlaygroundTools,\n  usePlayground,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nexport const ZoomSelect = () => {\n  const tools = usePlaygroundTools();\n  const playground = usePlayground();\n  const [selected, setSelected] = useState(false);\n  const zoom = useMemo(() => {\n    const zoomValue = tools.zoom * 100;\n    return zoomValue.toFixed(0);\n  }, [tools.zoom]);\n  // In order to override the style of the cozed design, you cannot use tailwind css.\n  const zoomOptionStyle: CSSProperties = {\n    padding: '8px',\n    lineHeight: '16px',\n  };\n  return (\n    <Dropdown\n      clickToHide\n      position=\"top\"\n      trigger=\"custom\"\n      visible={selected}\n      onClickOutSide={() => setSelected(false)}\n      onVisibleChange={setSelected}\n      render={\n        <Dropdown.Menu>\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.out\"\n            style={zoomOptionStyle}\n            onClick={() => tools.zoomout()}\n          >\n            {I18n.t('workflow_toolbar_zoom_out')}\n          </Dropdown.Item>\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.in\"\n            style={zoomOptionStyle}\n            onClick={() => tools.zoomin()}\n          >\n            {I18n.t('workflow_toolbar_zoom_in')}\n          </Dropdown.Item>\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.fit\"\n            style={zoomOptionStyle}\n            onClick={() => tools.fitView()}\n          >\n            {I18n.t('workflow_toolbar_zoom_fit')}\n          </Dropdown.Item>\n          <Divider className=\"m-[4px] w-[108px]\" />\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.50\"\n            style={zoomOptionStyle}\n            onClick={() => {\n              playground.config.updateZoom(0.5);\n            }}\n          >\n            {I18n.t('workflow_toolbar_zoom_to')} 50%\n          </Dropdown.Item>\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.100\"\n            style={zoomOptionStyle}\n            onClick={() => {\n              playground.config.updateZoom(1);\n            }}\n          >\n            {I18n.t('workflow_toolbar_zoom_to')} 100%\n          </Dropdown.Item>\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.150\"\n            style={zoomOptionStyle}\n            onClick={() => {\n              playground.config.updateZoom(1.5);\n            }}\n          >\n            {I18n.t('workflow_toolbar_zoom_to')} 150%\n          </Dropdown.Item>\n          <Dropdown.Item\n            data-testid=\"workflow.detail.toolbar.zoom.200\"\n            style={zoomOptionStyle}\n            onClick={() => {\n              playground.config.updateZoom(2);\n            }}\n          >\n            {I18n.t('workflow_toolbar_zoom_to')} 200%\n          </Dropdown.Item>\n        </Dropdown.Menu>\n      }\n    >\n      <div\n        className=\"workflow-toolbar-zoom flex justify-start items-center w-[70px] h-[24px] p-[2px] rounded-small border border-solid border-[var(--coz-stroke-plus)] cursor-pointer select-none\"\n        data-testid=\"workflow.detail.toolbar.zoom\"\n        onClick={() => setSelected(!selected)}\n        style={{\n          borderColor: selected\n            ? 'var(--coz-stroke-hglt)'\n            : 'var(--coz-stroke-plus)',\n        }}\n      >\n        <p className=\"text-[12px] flex items-center mx-[4px] w-[40px] h-[20px]\">\n          {zoom}%\n        </p>\n        <div\n          className=\"flex items-center justify-center pr-[2px] color-[var(--coz-fg-secondary)]\"\n          style={{\n            color: 'var(--coz-fg-secondary)',\n          }}\n        >\n          <IconCozArrowDown />\n        </div>\n      </div>\n    </Dropdown>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozRectangleMap } from '@coze-arch/coze-design/icons';\nimport { Tooltip, IconButton } from '@coze-arch/coze-design';\n\nexport const MinimapSwitch = (props: {\n  minimapVisible: boolean;\n  setMinimapVisible: (visible: boolean) => void;\n}) => {\n  const { minimapVisible, setMinimapVisible } = props;\n\n  return (\n    <Tooltip content={I18n.t('workflow_toolbar_minimap_tooltips')}>\n      <IconButton\n        icon={\n          <IconCozRectangleMap\n            className={minimapVisible ? undefined : 'coz-fg-primary'}\n          />\n        }\n        color={minimapVisible ? 'highlight' : 'secondary'}\n        onClick={() => setMinimapVisible(!minimapVisible)}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FlowMinimapService,\n  MinimapRender,\n} from '@flowgram-adapter/free-layout-editor';\nimport { useService } from '@flowgram-adapter/fixed-layout-editor';\n\nexport const Minimap = ({ visible }: { visible: boolean }) => {\n  const minimapService = useService(FlowMinimapService);\n  if (!visible) {\n    return <></>;\n  }\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        bottom: '60px',\n        width: '198px',\n        zIndex: 99,\n      }}\n    >\n      <MinimapRender\n        service={minimapService}\n        panelStyles={{}}\n        containerStyles={{\n          pointerEvents: 'auto',\n          position: 'relative',\n          top: 'unset',\n          right: 'unset',\n          bottom: 'unset',\n          left: 'unset',\n        }}\n        inactiveStyle={{\n          opacity: 1,\n          scale: 1,\n          translateX: 0,\n          translateY: 0,\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\nimport {\n  usePlayground,\n  EditorState,\n} from '@flowgram-adapter/fixed-layout-editor';\nimport {\n  GuidingPopover,\n  InteractiveType,\n  MousePadSelector,\n  getPreferInteractiveType,\n  // setPreferInteractiveType,\n} from '@coze-common/mouse-pad-selector';\n\nexport enum EditorCursorState {\n  GRAB = 'GRAB',\n  SELECT = 'SELECT',\n}\n\nexport const Interactive = () => {\n  const playground = usePlayground();\n\n  const [interactiveType, setInteractiveType] = useState<InteractiveType>(\n    () => getPreferInteractiveType() as InteractiveType,\n  );\n\n  const [showInteractivePanel, setShowInteractivePanel] = useState(false);\n\n  function handleUpdateMouseScrollDelta(\n    delta: number | ((zoom: number) => number),\n  ) {\n    playground.config.updateConfig({\n      mouseScrollDelta: delta,\n    });\n  }\n\n  const mousePadTooltip = I18n.t(\n    interactiveType === InteractiveType.Mouse\n      ? 'workflow_mouse_friendly'\n      : 'workflow_pad_friendly',\n  );\n\n  function handleUpdateInteractiveType(interType: InteractiveType) {\n    if (interType === InteractiveType.Mouse) {\n      // Mouse First Interactive Mode: Update Status & Set Small Hands\n      playground.editorState.changeState(\n        EditorState.STATE_MOUSE_FRIENDLY_SELECT.id,\n      );\n    } else if (interType === InteractiveType.Pad) {\n      // Trackpad Priority Interaction Mode: Update Status & Settings Arrows\n      playground.editorState.changeState(EditorState.STATE_SELECT.id);\n    }\n    setInteractiveType(interType);\n    return;\n  }\n\n  useEffect(() => {\n    handleUpdateMouseScrollDelta(zoom => zoom / 20);\n\n    // Read interactive mode from cache, application takes effect\n    const preferInteractiveType = getPreferInteractiveType();\n    handleUpdateInteractiveType(preferInteractiveType as InteractiveType);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- init\n  }, []);\n\n  return (\n    <GuidingPopover>\n      <Tooltip\n        content={mousePadTooltip}\n        style={{ display: showInteractivePanel ? 'none' : 'block' }}\n      >\n        <div className=\"workflow-toolbar-interactive\">\n          <MousePadSelector\n            value={interactiveType}\n            onChange={value => {\n              setInteractiveType(value);\n              // The current logic is to only read settings from the canvas.\n              // setPreferInteractiveType(value);\n              handleUpdateInteractiveType(value as unknown as InteractiveType);\n            }}\n            onPopupVisibleChange={setShowInteractivePanel}\n            containerStyle={{\n              border: 'none',\n              height: '24px',\n              width: '38px',\n              justifyContent: 'center',\n              alignItems: 'center',\n              gap: '2px',\n              padding: '4px',\n              paddingTop: '1px',\n              borderRadius: 'var(--small, 6px)',\n            }}\n            iconStyle={{\n              margin: '0',\n              width: '16px',\n              height: '16px',\n            }}\n            arrowStyle={{\n              width: '12px',\n              height: '12px',\n              lineHeight: 0,\n            }}\n          />\n        </div>\n      </Tooltip>\n    </GuidingPopover>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { Divider } from '@coze-arch/coze-design';\n\nimport { ZoomSelect } from './zoom-select';\nimport { MinimapSwitch } from './minimap-switch';\nimport { Minimap } from './minimap';\nimport { Interactive } from './interactive';\n\nimport s from './index.module.less';\n\nexport const Tools = () => {\n  const [minimapVisible, setMinimapVisible] = useState(false);\n  return (\n    <div className={s.tools}>\n      <Interactive />\n      <MinimapSwitch\n        minimapVisible={minimapVisible}\n        setMinimapVisible={setMinimapVisible}\n      />\n      <Minimap visible={minimapVisible} />\n      <Divider className={s.divider} layout=\"vertical\" />\n      <ZoomSelect />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { createMinimapPlugin } from '@flowgram-adapter/free-layout-editor';\nimport {\n  ConstantKeys,\n  type FixedLayoutProps,\n  FlowRendererKey,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { CustomLinesManager, TreeService } from '../services';\nimport { createCustomLinesPlugin } from '../plugins';\nimport { Split } from '../node-registries';\nimport { BaseNode, Collapse } from '../components';\n\nexport const useEditorProps = (data?: any, json?: any) =>\n  useMemo<FixedLayoutProps>(\n    () => ({\n      background: true,\n      readonly: false,\n      initialData: data as any,\n      onDispose() {\n        console.log('---- Playground Dispose ----');\n      },\n      nodeRegistries: [Split],\n      constants: {\n        [ConstantKeys.BASE_ACTIVATED_COLOR]: '#5147ff',\n        [ConstantKeys.INLINE_BLOCKS_PADDING_TOP]: 44,\n        [ConstantKeys.NODE_SPACING]: 64,\n      },\n      materials: {\n        renderNodes: {\n          [FlowRendererKey.ADDER]: () => null,\n          [FlowRendererKey.COLLAPSE]: Collapse,\n          [FlowRendererKey.BRANCH_ADDER]: () => null,\n          [FlowRendererKey.DRAG_NODE]: () => null,\n        },\n        renderDefaultNode: BaseNode, // Node rendering\n      },\n      onReady(ctx) {\n        const treeService = ctx.get<TreeService>(TreeService);\n        treeService.transformSchema(json);\n        treeService.treeToFlowNodeJson();\n        // Forced resizing takes effect\n        setTimeout(() => {\n          ctx.playground.resize();\n        }, 100);\n      },\n      onAllLayersRendered(ctx) {\n        const linesManager = ctx.get<CustomLinesManager>(CustomLinesManager);\n        linesManager.initLines();\n      },\n      plugins: () => [\n        /**\n         * Custom Line Plugin\n         */\n        createCustomLinesPlugin({}),\n        /**\n         * Minimap plugin\n         * Thumbnail plugin\n         */\n        createMinimapPlugin({\n          disableLayer: true,\n          enableDisplayAllNodes: true,\n          canvasStyle: {\n            canvasWidth: 182,\n            canvasHeight: 102,\n            canvasPadding: 50,\n            canvasBackground: 'rgba(245, 245, 245, 1)',\n            canvasBorderRadius: 10,\n            viewportBackground: 'rgba(235, 235, 235, 1)',\n            viewportBorderRadius: 4,\n            viewportBorderColor: 'rgba(201, 201, 201, 1)',\n            viewportBorderWidth: 1,\n            viewportBorderDashLength: 2,\n            nodeColor: 'rgba(255, 255, 255, 1)',\n            nodeBorderRadius: 2,\n            nodeBorderWidth: 0.145,\n            nodeBorderColor: 'rgba(6, 7, 9, 0.10)',\n            overlayColor: 'rgba(255, 255, 255, 0)',\n          },\n          inactiveDebounceTime: 1,\n        }),\n      ],\n    }),\n    [],\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ClipboardService,\n  type EditorPluginContext,\n  EditorProps,\n  type FlowDocument,\n  type FlowDocumentJSON,\n  type FlowLayoutDefault,\n  type FlowOperationService,\n  type SelectionService,\n  type FixedHistoryPluginOptions,\n  type HistoryService,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nexport interface FixedLayoutPluginContext extends EditorPluginContext {\n  document: FlowDocument;\n  /**\n   * Provide operation methods related to canvas nodes, and support redo/undo\n   */\n  operation: FlowOperationService;\n  clipboard: ClipboardService;\n  selection: SelectionService;\n  history: HistoryService;\n}\n\n/**\n * fixed layout configuration\n */\nexport interface FixedLayoutProps\n  extends EditorProps<FixedLayoutPluginContext, FlowDocumentJSON> {\n  history?: FixedHistoryPluginOptions<FixedLayoutPluginContext> & {\n    disableShortcuts?: boolean;\n  };\n  defaultLayout?: FlowLayoutDefault | string; // default layout\n}\n\nexport const DEFAULT: FixedLayoutProps =\n  EditorProps.DEFAULT as FixedLayoutProps;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect } from 'react';\n\nimport {\n  useService,\n  type FlowNodeEntity,\n  type IPoint,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { getLineId } from '../../utils';\nimport { type CustomLine } from '../../typings';\nimport { CustomHoverService } from '../../services';\nimport { LINE_CLASS_NAME } from '../../constants/line';\nimport { STROKE_WIDTH, ARROW_HEIGHT } from '../../constants';\n\nconst defaultColor = 'rgba(216, 219, 232, 1)';\nconst activateColor = '#5147FF';\n\nexport const LineSVG = (props: {\n  line: CustomLine;\n  hovered: boolean;\n  path: string;\n  fromEntity: FlowNodeEntity;\n  toPos: IPoint;\n  activated: boolean;\n  setHovered: (_hovered: boolean) => void;\n}) => {\n  const {\n    line,\n    path: bezierPath,\n    fromEntity,\n    toPos,\n    activated,\n    hovered,\n    setHovered,\n  } = props;\n\n  const strokeWidth = STROKE_WIDTH;\n\n  const customHoverService = useService<CustomHoverService>(CustomHoverService);\n\n  useEffect(() => {\n    const disposable = customHoverService.onHoverCollapse(\n      (node?: FlowNodeEntity) => {\n        if (node?.id && node?.id.includes(fromEntity.id)) {\n          setHovered(true);\n        } else {\n          setHovered(false);\n        }\n      },\n    );\n    const disposableLine = customHoverService.onHoverLine((l?: CustomLine) => {\n      if (getLineId(l) === getLineId(line)) {\n        setHovered(true);\n      } else {\n        setHovered(false);\n      }\n    });\n    return () => {\n      disposable.dispose();\n      disposableLine?.dispose();\n    };\n  }, []);\n\n  if (fromEntity.collapsed) {\n    return null;\n  }\n\n  return (\n    <>\n      <path\n        className={LINE_CLASS_NAME}\n        d={bezierPath}\n        stroke={activated || hovered ? activateColor : defaultColor}\n        strokeWidth={strokeWidth}\n        fill=\"none\"\n      />\n      <polygon\n        className={LINE_CLASS_NAME}\n        points={`${toPos.x},${toPos.y} ${toPos.x - 4.5},${\n          toPos.y - ARROW_HEIGHT\n        } ${toPos.x + 4.5},${toPos.y - ARROW_HEIGHT}`}\n        fill={activated || hovered ? activateColor : defaultColor}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState } from 'react';\n\nimport { type IPoint } from '@flowgram-adapter/fixed-layout-editor';\n\nimport { type CustomLine } from '../../typings';\nimport { ARROW_HEIGHT } from '../../constants';\nimport { getBezierVerticalControlPoints } from './utils';\nimport { LineSVG } from './line-svg';\n\nexport interface PropsType {\n  line: CustomLine;\n  activated: boolean;\n}\n\nfunction getPath(params: {\n  fromPos: IPoint;\n  toPos: IPoint;\n  controls: IPoint[];\n}): string {\n  const { fromPos } = params;\n  const toPos = {\n    x: params.toPos.x,\n    y: params.toPos.y - ARROW_HEIGHT,\n  };\n\n  const { controls } = params;\n\n  // Render endpoint position calculation\n  const renderToPos: IPoint = { x: toPos.x, y: toPos.y };\n\n  const getPathData = (): string => {\n    const controlPoints = controls.map(s => `${s.x} ${s.y}`).join(',');\n    const curveType = controls.length === 1 ? 'S' : 'C';\n\n    return `M${fromPos.x} ${fromPos.y} ${curveType} ${controlPoints}, ${renderToPos.x} ${renderToPos.y}`;\n  };\n  const path = getPathData();\n  return path;\n}\n\nexport function RenderLine(props: PropsType) {\n  const { activated, line } = props;\n  const [hovered, setHovered] = useState(false);\n\n  const { from } = line;\n\n  const controls = getBezierVerticalControlPoints(line.fromPoint, line.toPoint);\n\n  const path = getPath({\n    fromPos: line.fromPoint,\n    toPos: line.toPoint,\n    controls,\n  });\n\n  return (\n    <LineSVG\n      line={line}\n      path={path}\n      fromEntity={from}\n      toPos={line.toPoint}\n      activated={activated}\n      hovered={hovered}\n      setHovered={setHovered}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport {\n  Rectangle,\n  useConfigEntity,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { getLineId } from '../../utils';\nimport { type CustomLine } from '../../typings';\nimport { CustomRenderStateConfigEntity } from '../../entities';\nimport { RenderLine } from './render-line';\n\nexport const LinesRenderer = ({\n  viewBox,\n  lines,\n  isViewportVisible,\n  version,\n}: {\n  viewBox: string;\n  lines: CustomLine[];\n  isViewportVisible: (bounds: Rectangle) => boolean;\n  version: number;\n}) => {\n  // Single line selection\n  const [activeLine, setActiveLine] = useState<string[]>([]);\n\n  const renderState = useConfigEntity<CustomRenderStateConfigEntity>(\n    CustomRenderStateConfigEntity,\n    true,\n  );\n\n  useEffect(() => {\n    setActiveLine(renderState.activeLines);\n  }, [renderState.activeLines]);\n\n  // The offset calculation of the semi pop-up window is wrong, and the lines here are directly displayed.\n  const visibleLines = lines.filter(line => {\n    const bounds = Rectangle.createRectangleWithTwoPoints(\n      line.fromPoint,\n      line.toPoint,\n    ).pad(10);\n    return isViewportVisible(bounds);\n  });\n  const activatedLines = visibleLines.filter(l =>\n    activeLine.some(lineId => lineId === getLineId(l)),\n  );\n  const normalLines = visibleLines.filter(\n    l => !activeLine.some(lineId => lineId === getLineId(l)),\n  );\n\n  const allLines = [...normalLines, ...activatedLines];\n\n  return (\n    <svg\n      className=\"flow-lines-container\"\n      width=\"1000\"\n      height=\"1000\"\n      overflow=\"visible\"\n      viewBox={viewBox}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      // Make sure to force a refresh when the number of lines changes\n      key={nanoid(5)}\n    >\n      {allLines.map(line => {\n        const activated = activeLine.some(lineId => lineId === getLineId(line));\n        return (\n          <RenderLine\n            key={`${getLineId(line)}${version}`}\n            line={line}\n            activated={activated}\n          />\n        );\n      })}\n    </svg>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { throttle } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport {\n  FlowDocument,\n  FlowDocumentTransformerEntity,\n  Layer,\n  observeEntity,\n  domUtils,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { CustomHoverService, CustomLinesManager } from '../services';\nimport { CustomRenderStateEntity } from '../entities';\nimport { LINE_CLASS_NAME } from '../constants';\nimport { LinesRenderer } from '../components/lines-render';\n\n@injectable()\nexport class FlowLinesLayer extends Layer {\n  @inject(FlowDocument) declare document: FlowDocument;\n\n  @inject(CustomLinesManager) declare linesManager: CustomLinesManager;\n\n  @inject(CustomHoverService) declare hoverService: CustomHoverService;\n\n  node = domUtils.createDivWithClass('gedit-flow-lines-layer');\n\n  @observeEntity(FlowDocumentTransformerEntity)\n  declare documentTransformer: FlowDocumentTransformerEntity;\n\n  @observeEntity(CustomRenderStateEntity)\n  protected declare renderState: CustomRenderStateEntity;\n\n  /**\n   * Visual area change\n   */\n  onViewportChange = throttle(() => {\n    this.render();\n  }, 100) as ReturnType<typeof throttle>;\n\n  onZoom() {\n    const svgContainer = this.node!.querySelector('svg.flow-lines-container')!;\n    svgContainer?.setAttribute?.('viewBox', this.viewBox);\n  }\n\n  onReady() {\n    this.node.style.zIndex = '1';\n    this.toDispose.pushAll([\n      this.listenPlaygroundEvent('click', () => {\n        this.hoverService.backgroundClick();\n      }),\n      this.listenPlaygroundEvent('mousemove', (e: React.MouseEvent) => {\n        const lineDomNodes = this.playgroundNode.querySelectorAll(\n          `.${LINE_CLASS_NAME}`,\n        );\n        const checkTargetFromLine = [...lineDomNodes].some(lineDom =>\n          lineDom.contains(e.target as HTMLElement),\n        );\n        const mousePos = this.config.getPosFromMouseEvent(e);\n        this.hoverService.updateHoverLine(mousePos, checkTargetFromLine);\n      }),\n    ]);\n  }\n\n  get viewBox(): string {\n    const ratio = 1000 / this.config.finalScale;\n    return `0 0 ${ratio} ${ratio}`;\n  }\n\n  render(): JSX.Element {\n    const isViewportVisible = this.config.isViewportVisible.bind(this.config);\n    // Not initialized yet\n    if (this.documentTransformer?.loading) {\n      return <></>;\n    }\n    this.documentTransformer?.refresh?.();\n\n    return (\n      <LinesRenderer\n        viewBox={this.viewBox}\n        isViewportVisible={isViewportVisible}\n        lines={this.linesManager.lines}\n        version={this.renderState.config.version}\n      />\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { injectable } from 'inversify';\nimport {\n  FlowNodesContentLayer,\n  FlowNodesTransformLayer,\n  type FlowRendererContribution,\n  type FlowRendererRegistry,\n  FlowScrollBarLayer,\n  FlowScrollLimitLayer,\n  type FlowDocument,\n  type FlowDocumentContribution,\n  FlowNodeRenderData,\n  FlowNodeTransformData,\n  FlowNodeTransitionData,\n  PlaygroundLayer,\n  FixedLayoutRegistries,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { FlowLinesLayer } from '../../layers';\n\n@injectable()\nexport class FlowRegisters\n  implements FlowDocumentContribution, FlowRendererContribution\n{\n  /**\n   * registration data layer\n   * @param document\n   */\n  registerDocument(document: FlowDocument) {\n    /**\n     * Registered Node (ECS - Entity)\n     */\n    document.registerFlowNodes(\n      // Wait for Simplification\n      FixedLayoutRegistries.RootRegistry, // root node\n      FixedLayoutRegistries.StartRegistry, // start node\n      FixedLayoutRegistries.DynamicSplitRegistry, // Dynamic branching (parallel, exclusive)\n      FixedLayoutRegistries.BlockRegistry, // Single block registration\n      FixedLayoutRegistries.InlineBlocksRegistry, // A list of multiple blocks\n      FixedLayoutRegistries.BlockIconRegistry, // Icon nodes, such as diamond icons for conditional branches\n      // FixedLayoutRegistries. EndRegistry,//End Node\n      FixedLayoutRegistries.EmptyRegistry, // placeholder node\n    );\n    /**\n     * Registered Node Data (ECS - Components)\n     */\n    document.registerNodeDatas(\n      FlowNodeRenderData, // Render node related data\n      FlowNodeTransitionData, // line drawing data\n      FlowNodeTransformData, // coordinate calculation data\n    );\n  }\n\n  /**\n   * Register the render layer\n   * @param renderer\n   */\n  registerRenderer(renderer: FlowRendererRegistry) {\n    /**\n     * Registration layer (ECS - System)\n     */\n    renderer.registerLayers(\n      FlowNodesTransformLayer, // Node position rendering\n      FlowNodesContentLayer, // Node content rendering\n      FlowLinesLayer, // line rendering\n      // FlowLabelsLayer,//Label rendering\n      PlaygroundLayer, // Canvas base layer, providing zoom, gesture, and more\n      FlowScrollLimitLayer, // Control scroll range\n      FlowScrollBarLayer, // scroll bar\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContainerModule } from 'inversify';\nimport {\n  bindContributions,\n  FlowDocumentContribution,\n  FlowRendererContribution,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport { FlowRegisters } from './flow-registers';\n\nexport const FixedLayoutContainerModule = new ContainerModule(bind => {\n  bindContributions(bind, FlowRegisters, [\n    FlowDocumentContribution,\n    FlowRendererContribution,\n  ]);\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useCallback, forwardRef } from 'react';\n\nimport { type interfaces } from 'inversify';\nimport {\n  FlowDocument,\n  createPluginContextDefault,\n  PlaygroundReactProvider,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport {\n  createFixedLayoutPreset,\n  type FixedLayoutPluginContext,\n  type FixedLayoutProps,\n} from './preset';\n\nexport const FixedLayoutEditorProvider = forwardRef<\n  FixedLayoutPluginContext,\n  FixedLayoutProps\n>(function FixedLayoutEditorProvider(props: FixedLayoutProps, ref) {\n  const { parentContainer, children, ...others } = props;\n  const preset = useMemo(() => createFixedLayoutPreset(others), []);\n  const customPluginContext = useCallback(\n    (container: interfaces.Container) =>\n      ({\n        ...createPluginContextDefault(container),\n        get document(): FlowDocument {\n          return container.get<FlowDocument>(FlowDocument);\n        },\n      } as FixedLayoutPluginContext),\n    [],\n  );\n  return (\n    <PlaygroundReactProvider\n      ref={ref}\n      plugins={preset}\n      customPluginContext={customPluginContext}\n      parentContainer={parentContainer}\n    >\n      {children}\n    </PlaygroundReactProvider>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createOperationPlugin,\n  type PluginsProvider,\n  createDefaultPreset,\n  createPlaygroundPlugin,\n  type Plugin,\n  FlowDocumentOptionsDefault,\n  FlowDocumentOptions,\n  FlowNodesContentLayer,\n  FlowNodesTransformLayer,\n  FlowScrollBarLayer,\n  FlowScrollLimitLayer,\n  createPlaygroundReactPreset,\n} from '@flowgram-adapter/fixed-layout-editor';\n\nimport {\n  type FixedLayoutPluginContext,\n  type FixedLayoutProps,\n  DEFAULT,\n} from './fixed-layout-props';\nimport { FixedLayoutContainerModule } from './container-module';\n\nexport function createFixedLayoutPreset(\n  opts: FixedLayoutProps,\n): PluginsProvider<FixedLayoutPluginContext> {\n  return (ctx: FixedLayoutPluginContext) => {\n    opts = { ...DEFAULT, ...opts };\n    let plugins: Plugin[] = [createOperationPlugin(opts)];\n    /**\n     * Load default editor configuration\n     */\n    plugins = createDefaultPreset(opts, plugins)(ctx);\n    /*\n     * Load fixed layout canvas module\n     * */\n    plugins.push(\n      createPlaygroundPlugin<FixedLayoutPluginContext>({\n        containerModules: [FixedLayoutContainerModule],\n        onBind(bindConfig) {\n          if (!bindConfig.isBound(FlowDocumentOptions)) {\n            bindConfig.bind(FlowDocumentOptions).toConstantValue({\n              ...FlowDocumentOptionsDefault,\n              jsonAsV2: true,\n              defaultLayout: opts.defaultLayout,\n              toNodeJSON: opts.toNodeJSON,\n              fromNodeJSON: opts.fromNodeJSON,\n              allNodesDefaultExpanded: opts.allNodesDefaultExpanded,\n            } as FlowDocumentOptions);\n          }\n        },\n        onInit: _ctx => {\n          _ctx.playground.registerLayers(\n            FlowNodesContentLayer, // Node content rendering\n            FlowNodesTransformLayer, // Node position offset calculation\n          );\n          if (!opts.scroll?.disableScrollLimit) {\n            // Control scroll range\n            _ctx.playground.registerLayer(FlowScrollLimitLayer);\n          }\n          if (!opts.scroll?.disableScrollBar) {\n            // control bar\n            _ctx.playground.registerLayer(FlowScrollBarLayer);\n          }\n          if (opts.nodeRegistries) {\n            _ctx.document.registerFlowNodes(...opts.nodeRegistries);\n          }\n        },\n      }),\n    );\n    return createPlaygroundReactPreset(opts, plugins)(ctx);\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EditorRenderer } from '@flowgram-adapter/fixed-layout-editor';\nimport { type DependencyTree } from '@coze-arch/bot-api/workflow_api';\n\nimport { useEditorProps } from './hooks';\nimport { FixedLayoutEditorProvider } from './fixed-layout-editor-provider';\nimport { TreeContext } from './contexts';\nimport { Tools } from './components';\nimport '@flowgram-adapter/fixed-layout-editor/css-load';\nexport { NodeType, DependencyOrigin } from './typings';\nexport { isDepEmpty } from './utils';\n\nexport const ResourceTree = ({\n  className,\n  data,\n  renderLinkNode,\n}: {\n  className?: string;\n  data: DependencyTree;\n  renderLinkNode?: (extInfo: any) => React.ReactNode;\n}) => {\n  const initialData = {\n    nodes: [],\n  };\n  const editorProps = useEditorProps(initialData, data);\n\n  return (\n    <FixedLayoutEditorProvider {...editorProps}>\n      <TreeContext.Provider\n        value={{\n          renderLinkNode,\n        }}\n      >\n        <div className={className}>\n          <EditorRenderer />\n          <Tools />\n        </div>\n      </TreeContext.Provider>\n    </FixedLayoutEditorProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { unstable_batchedUpdates } from 'react-dom';\n\nimport type { Draft } from 'immer';\nimport { enableMapSet, produce } from 'immer';\n\nexport type Disposer = () => void;\n\nexport interface IExternalStore<T> {\n  subscribe: (onStoreChange: () => void) => () => void;\n  getSnapshot: () => T;\n}\n\nexport abstract class ExternalStore<T> implements IExternalStore<T> {\n  constructor() {\n    enableMapSet();\n  }\n\n  private _listeners: Set<() => void> = new Set();\n\n  protected abstract _state: T;\n\n  protected _produce = (recipe: (draft: Draft<T>) => void): void => {\n    const newState = produce(this._state, recipe);\n    if (newState !== this._state) {\n      this._state = newState;\n      this._dispatch();\n    }\n  };\n\n  private _dispatch = (): void => {\n    if (!this._listeners.size) {\n      return;\n    }\n    unstable_batchedUpdates(() => {\n      this._listeners.forEach(listener => listener());\n    });\n  };\n\n  subscribe = (onStoreChange: () => void): Disposer => {\n    this._listeners.add(onStoreChange);\n    return () => {\n      this._listeners.delete(onStoreChange);\n    };\n  };\n\n  getSnapshot = (): T => this._state;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ExternalStore } from './external-store';\nimport type { FeatureRegistry } from '.';\n\nclass FeatureRegistryManager extends ExternalStore<\n  Set<FeatureRegistry<any, any, any>>\n> {\n  protected _state = new Set<FeatureRegistry<any, any, any>>();\n\n  add(featureRegistry: FeatureRegistry<any, any, any>) {\n    this._produce(draft => {\n      draft.add(featureRegistry);\n    });\n  }\n\n  delete(featureRegistry: FeatureRegistry<any, any, any>) {\n    this._produce(draft => {\n      draft.delete(featureRegistry);\n    });\n  }\n}\n\n/**\n * FeatureRegistryManager instance for registering and unregistering FeatureRegistry. It will be written to this instance when FeatureRegistry is initialized during development, which is convenient for debugging.\n */\nexport const featureRegistryManager = new FeatureRegistryManager();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport type { SetRequired } from 'type-fest';\nimport type { Draft } from 'immer';\nimport { castDraft } from 'immer';\nimport { logger } from '@coze-arch/logger';\n\nimport { featureRegistryManager } from './feature-registry-manager';\nimport { ExternalStore } from './external-store';\n\nexport type FeatureModule<Type, Module> = Module & {\n  type: Type | string; // By default, add the type field to the Module, which is convenient as the key of the component\n};\n\nexport interface FeatureConfig<Type, Module> {\n  type: Type | string;\n  module?: Module;\n  loader?: () => Promise<{ default: Module }>;\n  tags?: string[]; // Usually Used for Feature Grouping\n}\n\nexport interface DefaultFeatureConfig<Type, Module>\n  extends FeatureConfig<Type, Module> {\n  module: Module;\n}\n\n// Get the Feature type that should be used by parsing the context\nexport interface FeatureTypeParser<Type, Context> {\n  (context: Context): Type | string;\n}\n\nexport interface FeatureRegistryConfig<Type, Module, Context> {\n  name: string;\n  defaultFeature?: DefaultFeatureConfig<Type, Module>;\n  features?: FeatureConfig<Type, Module>[];\n  featureTypeParser?: FeatureTypeParser<Type, Context>;\n}\n\nexport interface FeatureTypeInternalThisType<Type> {\n  internalHas: (type: Type | string) => boolean;\n}\n\nexport type Disposer = () => void;\n\nexport class FeatureRegistry<\n  Type,\n  Module,\n  Context = undefined,\n> extends ExternalStore<{\n  featureMap: Map<string, FeatureConfig<Type, Module>>;\n}> {\n  protected name: string;\n  protected _state: {\n    featureMap: Map<string, FeatureConfig<Type, Module>>;\n  };\n  protected featureTypeParser: FeatureTypeParser<Type, Context> | undefined;\n  private defaultFeature: DefaultFeatureConfig<Type, Module> | undefined;\n  protected get featureMap() {\n    return this._state.featureMap;\n  }\n\n  constructor(config: FeatureRegistryConfig<Type, Module, Context>) {\n    super();\n    const { name, defaultFeature, features, featureTypeParser } = config;\n    this.name = name;\n    this._state = { featureMap: new Map() };\n    if (defaultFeature) {\n      this.setDefaultFeature(defaultFeature);\n    }\n    if (features) {\n      this.registerSome(features);\n    }\n    if (featureTypeParser) {\n      this.setFeatureTypeParser(featureTypeParser);\n    }\n    IS_DEV_MODE && featureRegistryManager.add(this);\n  }\n\n  private getFeature(\n    type: Type | string,\n  ): FeatureConfig<Type, Module> | undefined {\n    const key = this.getFeatureKey(type);\n    const feature = this.featureMap.get(key);\n    if (!feature) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} get feature not exist ${type}`,\n        ),\n      });\n      return;\n    }\n    return feature;\n  }\n\n  private getFeatureKey(type: Type | string) {\n    return `feature_${this.name}_${type}`;\n  }\n\n  getName() {\n    return this.name;\n  }\n\n  private _register(\n    draft: Draft<{\n      featureMap: Map<string, FeatureConfig<Type, Module>>;\n    }>,\n    feature: FeatureConfig<Type, Module>,\n  ) {\n    const { defaultFeature } = this;\n    const { type } = feature;\n    const key = this.getFeatureKey(type);\n    if (defaultFeature && type === defaultFeature.type) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} register type is default feature ${type}`,\n        ),\n      });\n      return;\n    }\n    if (this._state.featureMap.get(key)) {\n      logger.warning(\n        `[Message Feature]: ${this.name} register feature already registered ${type}`,\n      );\n    }\n    draft.featureMap.set(key, castDraft(feature));\n  }\n\n  register(feature: FeatureConfig<Type, Module>): () => void {\n    this._produce(draft => {\n      this._register(draft, feature);\n    });\n    return () => {\n      this._produce(draft => {\n        this._deregister(draft, feature.type);\n      });\n    };\n  }\n\n  registerSome(features: FeatureConfig<Type, Module>[]) {\n    this._produce(draft => {\n      features.map(f => this._register(draft, f));\n    });\n    return () => {\n      this._produce(draft => {\n        features.forEach(feature => {\n          this._deregister(draft, feature.type);\n        });\n      });\n    };\n  }\n\n  private _deregister(\n    draft: Draft<{\n      featureMap: Map<string, FeatureConfig<Type, Module>>;\n    }>,\n    type: Type | string,\n  ) {\n    const { defaultFeature } = this;\n    const key = this.getFeatureKey(type);\n    if (defaultFeature && type === defaultFeature.type) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} deregister type is default feature ${type}`,\n        ),\n      });\n      return;\n    }\n    if (!this._state.featureMap.get(key)) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} deregister invalid feature ${type}`,\n        ),\n      });\n      return;\n    }\n    draft.featureMap.delete(key);\n  }\n\n  deregister(type: Type | string) {\n    this._produce(draft => {\n      this._deregister(draft, type);\n    });\n  }\n\n  deregisterSome(types: (Type | string)[]) {\n    this._produce(draft => {\n      types.forEach(type => {\n        this._deregister(draft, type);\n      });\n    });\n  }\n\n  deregisterAll() {\n    this._produce(draft => {\n      draft.featureMap = new Map();\n    });\n  }\n\n  // Feature loader to load component\n  async load(type: Type | string): Promise<void> {\n    const feature = this.getFeature(type);\n    if (!feature) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} load unknown feature ${type}`,\n        ),\n      });\n      return;\n    }\n    if (!feature.loader) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} load feature loader unset ${type}`,\n        ),\n      });\n      return;\n    }\n    const module = await feature.loader();\n    this._produce(draft => {\n      const loadedFeature = draft.featureMap.get(this.getFeatureKey(type));\n      if (loadedFeature) {\n        loadedFeature.module = castDraft(module.default);\n      }\n    });\n  }\n\n  // Determine whether the Feature has been loaded\n  isLoaded(type: Type | string): boolean {\n    const feature = this.getFeature(type);\n    if (!feature) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} isLoaded unknown feature ${type}`,\n        ),\n      });\n      return false;\n    }\n    if (!feature.module) {\n      return false;\n    }\n    return true;\n  }\n\n  // Features Registration\n  has(type: Type | string): boolean {\n    return Boolean(this.getFeature(type));\n  }\n\n  /**\n   * Get Feature Modules\n   *\n   * @param type Feature type\n   * @Returns undefined if Feature does not exist or Feature. Module is empty\n   */\n  getModule(type: Type | string): Module | undefined {\n    const feature = this.getFeature(type);\n    if (!feature) {\n      logger.error({\n        error: new Error(\n          `[Message Feature][getModule]: ${this.name} get feature not exist ${type}`,\n        ),\n      });\n      return;\n    }\n    if (!feature.module) {\n      logger.error({\n        error: new Error(\n          `[Message Feature][getModule]: ${this.name} get feature module unset ${type}`,\n        ),\n      });\n      return;\n    }\n    return feature.module;\n  }\n\n  /**\n   * Get Feature Modules\n   *\n   * @Deprecated [Note!] Be careful when using this method, because it will cause the type field of the module to be overwritten, use the'getModule () 'method\n   */\n  get(type: Type | string): FeatureModule<Type, Module> | undefined {\n    const feature = this.getFeature(type);\n    if (!feature) {\n      logger.error({\n        error: new Error(\n          `[Message Feature][get]: ${this.name} get feature not exist ${type}`,\n        ),\n      });\n      return;\n    }\n    if (!feature.module) {\n      logger.error({\n        error: new Error(\n          `[Message Feature][get]: ${this.name} get feature module unset ${type}`,\n        ),\n      });\n      return;\n    }\n    return { ...feature.module, type };\n  }\n\n  async getAsync(\n    type: Type | string,\n  ): Promise<FeatureModule<Type, Module> | undefined> {\n    const feature = this.getFeature(type);\n    if (!feature) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} getAsync unknown feature ${type}`,\n        ),\n      });\n      return;\n    }\n    if (!feature.module) {\n      await this.load(type);\n    }\n    return this.get(type);\n  }\n\n  /**\n   * Get entries for all Feature modules, key is feature type, value is feature module\n   */\n  entries(): [Type | string, Module][] {\n    const { featureMap } = this;\n    const features = [...featureMap.values()];\n    return features\n      .filter((feature): feature is SetRequired<typeof feature, 'module'> => {\n        if (!feature.module) {\n          logger.warning(\n            `[Message Feature][entries]: ${this.name} entries module unloaded feature.type=${feature.type}`,\n          );\n        }\n        return feature.module !== null && feature.module !== undefined;\n      })\n      .map(feature => [feature.type, feature.module]);\n  }\n\n  async getAllAsync(): Promise<FeatureModule<Type, Module>[]> {\n    const { featureMap } = this;\n    const features = [...featureMap.values()];\n    const modules = await Promise.all(\n      features.map(feature => this.getAsync(feature.type)),\n    );\n    return modules.filter(module => Boolean(module)) as FeatureModule<\n      Type,\n      Module\n    >[];\n  }\n\n  // Get the corresponding Feature type through context\n  getTypeByContext(context: Context): Type | string {\n    const { featureTypeParser } = this;\n    if (!featureTypeParser) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} getTypeByContext featureTypeParser unset`,\n        ),\n      });\n      return this.getDefaultType() ?? '';\n    }\n    try {\n      return featureTypeParser(context);\n    } catch (err) {\n      logger.error({\n        error: new Error(\n          `[Message Feature]: ${this.name} getTypeByContext featureTypeParser error ${err}`,\n        ),\n      });\n      return this.getDefaultType() ?? '';\n    }\n  }\n\n  // Get the corresponding Feature module through the context\n  getByContext(context: Context): FeatureModule<Type, Module> | undefined {\n    const type = this.getTypeByContext(context);\n    return this.get(type);\n  }\n\n  async getByContextAsync(\n    context: Context,\n  ): Promise<FeatureModule<Type, Module> | undefined> {\n    const type = this.getTypeByContext(context);\n    return this.getAsync(type);\n  }\n\n  // Get Default Feature Module\n  getDefault(): FeatureModule<Type, Module> | undefined {\n    if (!this.defaultFeature) {\n      return undefined;\n    }\n    return {\n      type: this.defaultFeature.type,\n      ...this.defaultFeature.module,\n    };\n  }\n\n  // Get Default Feature Type\n  getDefaultType(): Type | string | undefined {\n    return this.defaultFeature?.type;\n  }\n\n  // Set Default Features\n  setDefaultFeature(feature: DefaultFeatureConfig<Type, Module>) {\n    const { type } = feature;\n    const key = this.getFeatureKey(type);\n    this.defaultFeature = feature;\n    this._produce(draft => {\n      draft.featureMap.set(key, castDraft(feature));\n    });\n  }\n\n  // Setting Features Type Resolving Functions\n  setFeatureTypeParser(parser: FeatureTypeParser<Type, Context>) {\n    this.featureTypeParser = parser.bind({\n      /**\n       * @internal\n       * Non-standard methods of internal exposure has\n       * Used to find whether the current type is registered when returning a type.\n       * Attention: According to the situation, use it with caution and do not abuse it!\n       */\n      internalHas: (type: Type | string): boolean => {\n        try {\n          const key = this.getFeatureKey(type);\n          const feature = this.featureMap.get(key);\n          return Boolean(feature);\n        } catch (err) {\n          logger.error({\n            error: new Error(\n              `[Message Feature]: ${this.name} featureTypeParser internalHas error ${err}`,\n            ),\n          });\n          return false;\n        }\n      },\n    });\n  }\n\n  deregisterByTag(tag: string) {\n    const { featureMap } = this;\n    const features = [...featureMap.values()].filter(f =>\n      f.tags?.includes(tag),\n    );\n    this._produce(draft => {\n      features.forEach(feature => {\n        this._deregister(draft, feature.type);\n      });\n    });\n  }\n\n  // Get the Feature Module containing the corresponding Tag\n  getByTag(tag: string): FeatureModule<Type, Module>[] {\n    const { featureMap } = this;\n    const features = [...featureMap.values()].filter(feature =>\n      feature.tags?.includes(tag),\n    );\n    if (!features.length) {\n      logger.warning(\n        `[Message Feature]: ${this.name} getByTag no feature include tag ${tag}`,\n      );\n      return [];\n    }\n    return features\n      .map(feature => this.get(feature.type))\n      .filter((module, index) => {\n        if (!module) {\n          logger.warning(\n            `[Message Feature]: ${this.name} getByTag module unloaded features[index].type=${features[index].type}`,\n          );\n        }\n        return Boolean(module);\n      }) as FeatureModule<Type, Module>[];\n  }\n\n  async getByTagAsync(tag: string): Promise<FeatureModule<Type, Module>[]> {\n    const { featureMap } = this;\n    const features = [...featureMap.values()].filter(feature =>\n      feature.tags?.includes(tag),\n    );\n    if (!features.length) {\n      logger.warning(\n        `[Message Feature]: ${this.name} getByTagAsync no feature include tag ${tag}`,\n      );\n      return [];\n    }\n    const modules = await Promise.all(\n      features.map(feature => this.getAsync(feature.type)),\n    );\n    return modules.filter(module => Boolean(module)) as FeatureModule<\n      Type,\n      Module\n    >[];\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState, useRef } from 'react';\n\nimport { Spin } from '@coze-arch/coze-design';\n\ninterface IPreviewMdProps {\n  fileUrl: string;\n}\n\nfunction wait(ms: number) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport const PreviewMd = (props: IPreviewMdProps) => {\n  const { fileUrl } = props;\n  const [mdContent, setMdContent] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    fetch(fileUrl)\n      .then(res => res.text())\n      .then(text => {\n        setLoading(false);\n        setMdContent(text);\n      });\n  }, [fileUrl]);\n\n  const ref = useRef<HTMLPreElement>(null);\n\n  useEffect(() => {\n    async function render() {\n      if (ref.current) {\n        for (\n          let i = 0, len = mdContent.length;\n          i < Math.ceil(len / 50_000);\n          i++\n        ) {\n          await wait(10);\n          ref.current.textContent += mdContent.slice(\n            i * 50_000,\n            (i + 1) * 50_000,\n          );\n        }\n        ref.current.textContent = mdContent;\n      }\n    }\n\n    render();\n  }, [mdContent]);\n\n  return (\n    <div className=\"flex flex-col items-center w-full h-full flex-1 py-2 px-4\">\n      <Spin\n        wrapperClassName=\"w-full h-full grow\"\n        spinning={loading}\n        childStyle={{\n          width: '100%',\n          height: '100%',\n          flexGrow: 1,\n        }}\n      >\n        {mdContent ? (\n          <div>\n            <pre\n              className=\"max-w-full overflow-auto whitespace-pre-wrap break-all text-[14px] leading-[22px]\"\n              ref={ref}\n            >\n              {/* {mdContent} */}\n            </pre>\n          </div>\n        ) : null}\n      </Spin>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\nimport { Spin } from '@coze-arch/coze-design';\ninterface IPreviewTxtProps {\n  fileUrl: string;\n}\n\nfunction wait(ms: number) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport const PreviewTxt = (props: IPreviewTxtProps) => {\n  const { fileUrl } = props;\n  const [txtContent, setTxtContent] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    fetch(fileUrl)\n      .then(res => res.text())\n      .then(text => {\n        setLoading(false);\n        setTxtContent(text);\n      });\n  }, [fileUrl]);\n\n  const ref = useRef<HTMLPreElement>(null);\n\n  useEffect(() => {\n    async function render() {\n      if (ref.current) {\n        for (\n          let i = 0, len = txtContent.length;\n          i < Math.ceil(len / 50_000);\n          i++\n        ) {\n          await wait(10);\n          if (ref.current) {\n            ref.current.textContent += txtContent.slice(\n              i * 50_000,\n              (i + 1) * 50_000,\n            );\n          }\n        }\n        if (ref.current) {\n          ref.current.textContent = txtContent;\n        }\n      }\n    }\n\n    render();\n  }, [txtContent]);\n\n  return (\n    <div className=\"flex flex-col items-center w-full h-full flex-1 py-2 px-4\">\n      <Spin\n        wrapperClassName=\"w-full h-full grow\"\n        spinning={loading}\n        childStyle={{\n          width: '100%',\n          height: '100%',\n          flexGrow: 1,\n        }}\n      >\n        <pre\n          className=\"max-w-full overflow-auto whitespace-pre-wrap break-all text-[14px] leading-[22px]\"\n          ref={ref}\n        >\n          {/* {txtContent} */}\n        </pre>\n      </Spin>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { Document, Page, pdfjs } from 'react-pdf';\nimport { useMemo, useRef, useState } from 'react';\n\nimport cls from 'classnames';\nimport { FixedSizeList as List, AutoSizer } from '@coze-common/virtual-list';\nimport { Spin } from '@coze-arch/coze-design';\nimport 'react-pdf/dist/Page/TextLayer.css';\nimport 'react-pdf/dist/Page/AnnotationLayer.css';\n\ninterface IUsePreviewPdfProps {\n  fileUrl: string;\n}\n\npdfjs.GlobalWorkerOptions.workerSrc =\n  REGION === 'cn'\n    ? // cp-disable-next-line\n      `//lf-cdn.coze.cn/obj/unpkg/pdfjs-dist/${pdfjs.version}/build/pdf.worker.min.mjs`\n    : // cp-disable-next-line\n      `//sf-cdn.coze.com/obj/unpkg-va/pdfjs-dist/${pdfjs.version}/build/pdf.worker.min.mjs`;\n\nconst options = {\n  cMapUrl:\n    REGION === 'cn'\n      ? // cp-disable-next-line\n        `//lf-cdn.coze.cn/obj/unpkg/pdfjs-dist/${pdfjs.version}/cmaps/`\n      : // cp-disable-next-line\n        `//sf-cdn.coze.com/obj/unpkg-va/pdfjs-dist/${pdfjs.version}/cmaps/`,\n  // Boost performance\n  cMapPacked: true,\n};\n\nexport const usePreviewPdf = (props: IUsePreviewPdfProps) => {\n  const { fileUrl } = props;\n  const [loading, setLoading] = useState(true);\n  const [numPages, setNumPages] = useState<number>(0);\n  const [currentPage, setCurrentPage] = useState<number>(0);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const listRef = useRef<List>(null);\n  const [pageHeight, setPageHeight] = useState(\n    containerRef.current?.clientHeight,\n  );\n  const itemSize = Math.floor((pageHeight ?? 500) + 20);\n\n  const onNext = () => {\n    if (currentPage < numPages - 1) {\n      const nextPage = currentPage + 1;\n      setCurrentPage(nextPage);\n      listRef.current?.scrollToItem(nextPage, 'start');\n    }\n  };\n\n  const onBack = () => {\n    if (currentPage > 0) {\n      const prevPage = currentPage - 1;\n      setCurrentPage(prevPage);\n      listRef.current?.scrollToItem(prevPage, 'start');\n    }\n  };\n\n  const onDocumentLoadSuccess = ({\n    numPages: totalPages,\n  }: {\n    numPages: number;\n  }) => {\n    setLoading(false);\n    setNumPages(totalPages);\n  };\n\n  const handleScroll = ({ scrollOffset }: { scrollOffset: number }) => {\n    const newIndex = Math.floor(scrollOffset / itemSize);\n    setCurrentPage(newIndex);\n  };\n\n  const [scale, setScale] = useState(1);\n  const increaseScale = () => {\n    setScale(prevScale => Math.min(prevScale + 0.1, 2));\n  };\n  const decreaseScale = () => {\n    setScale(prevScale => Math.max(prevScale - 0.1, 0.5));\n  };\n\n  const memoizedList = useMemo(\n    () =>\n      !loading ? (\n        <AutoSizer>\n          {({ height, width }) => (\n            <List\n              height={height ?? 0}\n              itemCount={numPages}\n              itemSize={itemSize}\n              width={width ?? 0}\n              onScroll={handleScroll}\n              ref={listRef}\n            >\n              {({\n                index,\n                style,\n              }: {\n                index: number;\n                style: React.CSSProperties;\n              }) => (\n                <div key={`page_${index + 1}`} style={style}>\n                  <Page\n                    pageNumber={index + 1}\n                    className={cls(\n                      'flex items-center justify-center !coz-bg-primary',\n                    )}\n                    width={(width ?? 100) - 32}\n                    scale={scale}\n                    onLoadSuccess={page => {\n                      setPageHeight(page.height);\n                    }}\n                    loading={\n                      <div\n                        style={{\n                          height: containerRef.current?.clientHeight,\n                        }}\n                      ></div>\n                    }\n                  />\n                </div>\n              )}\n            </List>\n          )}\n        </AutoSizer>\n      ) : null,\n    [loading, numPages, pageHeight, scale, itemSize],\n  );\n\n  const pdfNode = (\n    <>\n      <div className=\"flex flex-col items-center w-full h-full relative coz-bg-primary\">\n        <div\n          className={cls(\n            'absolute top-0 left-0 right-0 bot-0 flex items-center justify-center h-full',\n            'z-10',\n            !loading && 'invisible',\n          )}\n        >\n          <Spin />\n        </div>\n        <div\n          className={cls(\n            'flex absolute top-0 left-0 right-0 overflow-auto px-5 w-full h-full justify-center',\n            loading && 'invisible',\n          )}\n          ref={containerRef}\n        >\n          <Document\n            file={fileUrl}\n            // bug fix https://github.com/wojtekmaj/react-pdf/issues/974\n            key={fileUrl}\n            onLoadSuccess={onDocumentLoadSuccess}\n            options={options}\n            className={cls('flex w-full h-full')}\n            loading={\n              <Spin\n                wrapperClassName=\"w-full h-full\"\n                childStyle={{\n                  width: containerRef.current?.clientWidth,\n                  height: '100%',\n                }}\n              ></Spin>\n            }\n          >\n            {containerRef.current ? memoizedList : null}\n          </Document>\n        </div>\n      </div>\n    </>\n  );\n\n  return {\n    pdfNode,\n    numPages,\n    currentPage: currentPage + 1,\n    onNext,\n    onBack,\n    scale,\n    increaseScale,\n    decreaseScale,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport { type ILevelSegment } from '@coze-data/knowledge-stores';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type LevelDocumentTree } from '../types';\n\nexport const getTreeNodes = (\n  segments: ILevelSegment[],\n): LevelDocumentTree[] => {\n  const root = segments.find(f => f.parent === -1 && f.type === 'title');\n\n  if (!root) {\n    return segments.map(item => ({\n      ...item,\n      id: item.id.toString(),\n      parent: item.parent?.toString(),\n      children: [],\n    }));\n  }\n\n  return [\n    {\n      ...root,\n      id: root.id?.toString(),\n      parent: root.parent?.toString(),\n      children: getChildren(root, segments),\n    },\n  ];\n};\n\n/** Segments to TreeNodes */\nconst getChildren = (\n  target: ILevelSegment,\n  list: ILevelSegment[],\n): LevelDocumentTree[] =>\n  (target.children ?? []).reduce<LevelDocumentTree[]>((acc, cur) => {\n    const found = list.find(f => f.id === cur);\n    if (found) {\n      return [\n        ...acc,\n        {\n          ...found,\n          id: found.id?.toString(),\n          parent: found.parent?.toString(),\n          children: getChildren(found, list),\n        },\n      ];\n    } else {\n      return [...acc];\n    }\n  }, []);\n\n/**TreeNodes related */\nexport const findDescendantIDs = (node: LevelDocumentTree) => {\n  const ids = new Set<string>();\n  const findChild = (item: LevelDocumentTree) => {\n    if (!item || !item.id) {\n      return;\n    }\n    const { children } = item;\n    if (children && children.length) {\n      children.forEach(child => {\n        if (child && child.id) {\n          ids.add(child.id);\n          findChild(child);\n        }\n      });\n    }\n  };\n  findChild(node);\n  return ids;\n};\n\nexport const findTreeNodeByID = (\n  nodes: LevelDocumentTree[],\n  id: string,\n): LevelDocumentTree | null => {\n  for (const node of nodes) {\n    if (node.id === id) {\n      return node;\n    }\n    if (node.children) {\n      const found = findTreeNodeByID(node.children, id);\n      if (found) {\n        return found;\n      }\n    }\n  }\n  return null;\n};\n\nexport const handleTreeNodeMove = (\n  positions: { dragIDs: string[]; parentID: string | null; dropIndex: number },\n  segments: ILevelSegment[],\n): {\n  segments: ILevelSegment[] | null;\n  errMsg: string | null;\n} => {\n  if (positions.parentID === null) {\n    return {\n      segments: null,\n      errMsg: I18n.t('knowledge_hierarchies_categories_01'),\n    };\n  }\n  const resSegments = cloneDeep(segments);\n  for (const id of positions.dragIDs) {\n    const dragSegmentIdx = resSegments.findIndex(\n      segment => segment.id.toString() === id,\n    );\n\n    if (dragSegmentIdx === -1) {\n      continue;\n    }\n\n    const dragSegment = resSegments[dragSegmentIdx];\n    const parentSegment = resSegments.find(\n      segment => segment.id.toString() === positions.parentID,\n    );\n\n    if (!parentSegment) {\n      return {\n        segments: null,\n        errMsg: I18n.t('knowledge_hierarchies_categories_02'),\n      };\n    }\n\n    // If it is the same parent and the dragged position is before the current position, the dropIndex is reduced by 1.\n    const originalIndex = parentSegment.children.indexOf(dragSegment.id);\n    const dropIndex =\n      originalIndex < positions.dropIndex &&\n      dragSegment.parent === parentSegment.id\n        ? positions.dropIndex - 1\n        : positions.dropIndex;\n\n    if (dragSegment.parent !== parentSegment.id) {\n      // Remove from old parent's children\n      const oldParent = resSegments.find(s => s.id === dragSegment.parent);\n      oldParent?.children.splice(oldParent.children.indexOf(dragSegment.id), 1);\n      dragSegment.parent = parentSegment.id;\n    }\n\n    // Reorder in parent's children\n    parentSegment.children = parentSegment.children.filter(\n      child => child !== dragSegment.id,\n    );\n    parentSegment.children.splice(dropIndex, 0, dragSegment.id);\n  }\n\n  return {\n    segments: resSegments,\n    errMsg: null,\n  };\n};\n\nexport const handleDeleteNode = (ids: string[], segments: ILevelSegment[]) => {\n  const resSegments = cloneDeep(segments);\n  for (const id of ids) {\n    const index = resSegments.findIndex(item => item.id.toString() === id);\n    const parentSegment = resSegments.find(\n      item => item.id === resSegments[index].parent,\n    );\n    if (parentSegment) {\n      parentSegment.children = parentSegment.children.filter(\n        item => item !== resSegments[index].id,\n      );\n    }\n    resSegments.splice(index, 1);\n  }\n  return resSegments;\n};\n\nexport const handleMergeNodes = (\n  id: string,\n  descendants: string[],\n  segments: ILevelSegment[],\n): {\n  segments: ILevelSegment[] | null;\n  errMsg: string | null;\n} => {\n  const resSegments = cloneDeep(segments);\n  const mergedSegment = resSegments.find(item => item.id.toString() === id);\n\n  if (!mergedSegment) {\n    return {\n      segments: null,\n      errMsg: I18n.t('knowledge_hierarchies_categories_03'),\n    };\n  }\n\n  if (mergedSegment.parent === -1 && mergedSegment.type === 'title') {\n    return {\n      segments: null,\n      errMsg: I18n.t('knowledge_hierarchies_categories_03'),\n    };\n  }\n\n  mergedSegment.children = [];\n  mergedSegment.type = 'section-text';\n\n  for (const descendant of descendants) {\n    const segmentToMerge = resSegments.find(\n      item => item.id.toString() === descendant,\n    );\n    if (!segmentToMerge) {\n      return {\n        segments: null,\n        errMsg: I18n.t('knowledge_hierarchies_categories_04'),\n      };\n    }\n\n    // Remove the node from the children of the original parent\n    const parentSegment = resSegments.find(\n      item => item.id === segmentToMerge.parent,\n    );\n    if (parentSegment) {\n      parentSegment.children = parentSegment.children.filter(\n        childId => childId !== segmentToMerge.id,\n      );\n    }\n\n    if (!['table', 'image', 'title'].includes(segmentToMerge?.type ?? '')) {\n      // Merge text content and delete nodes\n      mergedSegment.text += segmentToMerge.text;\n      const index = resSegments.findIndex(\n        item => item.id === segmentToMerge.id,\n      );\n      if (index !== -1) {\n        resSegments.splice(index, 1);\n      }\n    } else {\n      // Nodes of type non-section-text, move them to the children of the merged node\n      segmentToMerge.parent = mergedSegment.id;\n      mergedSegment.children.push(segmentToMerge.id);\n    }\n  }\n\n  return {\n    segments: resSegments,\n    errMsg: null,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Tree, type NodeRendererProps, type CursorProps } from 'react-arborist';\nimport { useState, type CSSProperties } from 'react';\n\nimport useResizeObserver from 'use-resize-observer';\nimport cls from 'classnames';\nimport { type ILevelSegment } from '@coze-data/knowledge-stores';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowRight } from '@coze-arch/coze-design/icons';\nimport { IconButton, Toast } from '@coze-arch/coze-design';\n\nimport {\n  findDescendantIDs,\n  getTreeNodes,\n  handleDeleteNode,\n  handleMergeNodes,\n  handleTreeNodeMove,\n} from './utils/level-tree-op';\nimport { useSegmentContextMenu } from './use-context-menu';\nimport { type LevelDocumentTree } from './types';\n\ninterface ISegmentTreeProps {\n  segments: ILevelSegment[];\n  setLevelSegments?: (segments: ILevelSegment[]) => void;\n  setSelectionIDs?: (ids: string[]) => void;\n  disabled?: boolean;\n}\n\nexport const SegmentTree: React.FC<ISegmentTreeProps> = ({\n  segments,\n  setLevelSegments,\n  setSelectionIDs,\n  disabled,\n}) => {\n  /**\n   * select function\n   */\n  const [selected, setSelected] = useState(new Set<string>());\n  // Sharding id\n  const [selectedThroughParent, setSelectedThroughParent] = useState(\n    new Set<string>(),\n  );\n  const { ref, width, height } = useResizeObserver<HTMLDivElement>();\n\n  const onSelect = (node: LevelDocumentTree) => {\n    setSelected(new Set([node.id]));\n    setSelectedThroughParent(findDescendantIDs(node));\n    setSelectionIDs?.([node.id, ...findDescendantIDs(node)]);\n  };\n\n  /**\n   * render\n   */\n  const Node = ({\n    node,\n    style,\n    dragHandle,\n  }: NodeRendererProps<LevelDocumentTree>) => {\n    const { isOpen, data } = node;\n    const isLeaf = !data.children?.length;\n    const expandIcon = (\n      <IconButton\n        size=\"small\"\n        color=\"secondary\"\n        icon={\n          <IconCozArrowRight\n            className={cls(\n              isOpen && 'rotate-90',\n              'transition duration-150 ease-in-out',\n            )}\n          />\n        }\n        onClick={e => {\n          e.stopPropagation();\n          node.toggle();\n        }}\n        className={cls('bg-transparent ml-[4px] shrink-0')}\n      />\n    );\n\n    return (\n      <div\n        className={cls(\n          'flex items-center gap-[4px]',\n          'h-[32px] py-[4px] pr-[8px] mb-[2px]',\n          'hover:coz-mg-primary cursor-pointer',\n          'transition duration-150 ease-in-out',\n          'rounded-[8px]',\n          (selected.has(data.id) || selectedThroughParent.has(data.id)) &&\n            'coz-mg-primary',\n        )}\n        onClick={() => {\n          onSelect(data);\n        }}\n        onContextMenu={e => {\n          if (disabled) {\n            return;\n          }\n          onContextMenu(e, node);\n        }}\n        style={style}\n        ref={dragHandle}\n      >\n        {isLeaf ? <span className=\"w-6 ml-[4px] shrink-0\" /> : expandIcon}\n        <span\n          className={cls('text-[14px] leading-[20px] coz-fg-primary truncate')}\n        >\n          {data.type !== 'image'\n            ? data.text.slice(0, 50)\n            : I18n.t('knowledge_level_110')}\n        </span>\n      </div>\n    );\n  };\n\n  /**\n   * context menu\n   */\n  const { popoverNode, onContextMenu } = useSegmentContextMenu({\n    onMerge: node => {\n      const { segments: newSegments, errMsg } = handleMergeNodes(\n        node.id,\n        Array.from(findDescendantIDs(node)),\n        segments,\n      );\n      if (errMsg) {\n        Toast.error(errMsg);\n      }\n      if (newSegments?.length) {\n        setLevelSegments?.(newSegments);\n      }\n    },\n    onDelete: node => {\n      const newSegments = handleDeleteNode(\n        [node.id, ...findDescendantIDs(node)],\n        segments,\n      );\n      setLevelSegments?.(newSegments);\n    },\n  });\n\n  return (\n    <div ref={ref} className=\"w-full h-full relative translate-z-0\">\n      <Tree\n        data={getTreeNodes(segments)}\n        disableDrag={disabled}\n        disableDrop={disabled}\n        onMove={({ dragIds, parentId, index }) => {\n          const { segments: newSegments, errMsg } = handleTreeNodeMove(\n            { dragIDs: dragIds, parentID: parentId, dropIndex: index },\n            segments,\n          );\n          if (errMsg) {\n            Toast.error(errMsg);\n          }\n          if (newSegments?.length) {\n            setLevelSegments?.(newSegments);\n          }\n        }}\n        rowHeight={34}\n        paddingTop={4}\n        paddingBottom={4}\n        width={width}\n        height={height}\n        renderCursor={Cursor}\n      >\n        {Node}\n      </Tree>\n      {popoverNode}\n    </div>\n  );\n};\n\nconst Cursor = ({ top, left, indent }: CursorProps) => {\n  const placeholderStyle = {\n    display: 'flex',\n    alignItems: 'center',\n    zIndex: 1,\n  };\n  const style: CSSProperties = {\n    position: 'absolute',\n    pointerEvents: 'none',\n    top: `${top - 2}px`,\n    left: `${left}px`,\n    right: `${indent}px`,\n  };\n  return (\n    <div style={{ ...placeholderStyle, ...style }}>\n      <div className={cls('flex-1 h-[2px] coz-mg-hglt-plus')}></div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeApi } from 'react-arborist';\nimport { useState } from 'react';\n\nimport { useKnowledgeParams } from '@coze-data/knowledge-stores';\nimport { I18n } from '@coze-arch/i18n';\nimport { Menu, MenuSubMenu } from '@coze-arch/coze-design';\n\nimport { type LevelDocumentTree } from './types';\n\ninterface IUseSegmentContextMenuProps {\n  onDelete: (node: LevelDocumentTree) => void;\n  onMerge: (node: LevelDocumentTree) => void;\n}\n\nexport function useSegmentContextMenu({\n  onDelete,\n  onMerge,\n}: IUseSegmentContextMenuProps): {\n  popoverNode: React.ReactNode;\n  onContainerScroll: () => void;\n  onContextMenu: (\n    e: React.MouseEvent<HTMLDivElement>,\n    treeNode: NodeApi<LevelDocumentTree>,\n  ) => void;\n} {\n  const [treeNode, setTreeNode] = useState<NodeApi<LevelDocumentTree> | null>();\n  const [visible, setVisible] = useState(false);\n  const [position, setPosition] = useState({ top: 0, left: 0 });\n  const params = useKnowledgeParams();\n\n  return {\n    popoverNode: (\n      <Menu\n        visible={visible}\n        onVisibleChange={setVisible}\n        onClickOutSide={() => {\n          setVisible(false);\n          setTreeNode(null);\n        }}\n        trigger=\"custom\"\n        position=\"bottomLeft\"\n        render={\n          <MenuSubMenu mode=\"menu\">\n            {treeNode && !treeNode.children?.length ? (\n              <>\n                <Menu.Item\n                  isMenu\n                  onClick={() => {\n                    onDelete(treeNode.data);\n                    setVisible(false);\n                  }}\n                >\n                  {I18n.t('knowledge_level_028')}\n                </Menu.Item>\n              </>\n            ) : null}\n            {treeNode && treeNode.children?.length ? (\n              <>\n                <Menu.Item\n                  isMenu\n                  onClick={() => {\n                    onMerge(treeNode.data);\n                    setVisible(false);\n                  }}\n                >\n                  {I18n.t('knowledge_level_029')}\n                </Menu.Item>\n                <Menu.Item\n                  isMenu\n                  onClick={() => {\n                    onDelete(treeNode.data);\n                    setVisible(false);\n                  }}\n                >\n                  {I18n.t('knowledge_level_028')}\n                </Menu.Item>\n              </>\n            ) : null}\n          </MenuSubMenu>\n        }\n      >\n        <div\n          style={{\n            height: 0,\n            width: 0,\n            position: 'fixed',\n            top: position.top,\n            left: position.left,\n          }}\n        />\n      </Menu>\n    ),\n    onContainerScroll: () => {\n      if (visible) {\n        setVisible(false);\n      }\n    },\n    onContextMenu: (e, node: NodeApi<LevelDocumentTree>) => {\n      e.preventDefault();\n      setTreeNode(node);\n      /** In the project ide, the ide container is set to contain: strict, which will cause a fixed position.\n       *  The base of the offset is wrong, so you need to subtract the left and top values of the ide container here\n       */\n      let clickX = e.pageX;\n      let clickY = e.pageY;\n      const ideDom = document.getElementById(\n        `coze-project:///knowledge/${params.datasetID}`,\n      );\n\n      if (ideDom) {\n        const { left, top } = ideDom.getBoundingClientRect();\n        clickX = clickX - left;\n        clickY = clickY - top;\n      }\n\n      setPosition({ left: clickX, top: clickY });\n      setVisible(true);\n    },\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport cls from 'classnames';\nimport { Typography } from '@coze-arch/coze-design';\n\nexport interface IDocumentItemProps {\n  id: string;\n  title: string;\n  selected?: boolean;\n  onClick?: (id: string) => void;\n  label?: ReactNode;\n  tag?: ReactNode;\n}\n\nconst DocumentItem: React.FC<IDocumentItemProps> = props => {\n  const { id, onClick, title, selected, tag, label } = props;\n\n  return (\n    <div\n      className={cls(\n        'w-full h-8 px-2 py-[6px] rounded-[8px] hover:coz-mg-primary cursor-pointer',\n        'flex items-center',\n        selected && 'coz-mg-primary',\n      )}\n      onClick={() => onClick?.(id)}\n    >\n      {label ? (\n        <div className=\"w-full\">{label}</div>\n      ) : (\n        <>\n          <Typography.Text\n            ellipsis={{ showTooltip: true }}\n            className=\"w-full coz-fg-primary text-[14px] leading-[20px] grow truncate\"\n          >\n            {title}\n          </Typography.Text>\n          <div className=\"flex items-center shrink-0\">{tag}</div>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default DocumentItem;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode, useState } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Search, Tooltip } from '@coze-arch/coze-design';\nimport { type ILevelSegment } from '@coze-data/knowledge-stores';\n\nimport MergeOperation from '../assets/merge-operation.png';\nimport MergeOperationEn from '../assets/merge-operation-en.png';\nimport LevelOperation from '../assets/level-operation.png';\nimport DeleteOperation from '../assets/delete-operation.png';\nimport DeleteOperationEn from '../assets/delete-operation-en.png';\nimport { SegmentTree } from './segment-tree';\nimport DocumentItem from './document-item';\ninterface IMenuItem {\n  id: string;\n  title: string;\n  label?: ReactNode;\n  tag?: ReactNode;\n  tosUrl?: string;\n}\n\ninterface ISegmentMenuProps {\n  list: IMenuItem[];\n  onClick?: (id: string) => void;\n  selectedID?: string;\n  isSearchable?: boolean;\n  treeVisible?: boolean;\n  treeDisabled?: boolean;\n  levelSegments?: ILevelSegment[];\n  setLevelSegments?: (segments: ILevelSegment[]) => void;\n  setSelectionIDs?: (ids: string[]) => void;\n}\n\nconst SegmentMenu: React.FC<ISegmentMenuProps> = props => {\n  const {\n    isSearchable,\n    list,\n    onClick,\n    selectedID,\n    levelSegments,\n    setLevelSegments,\n    setSelectionIDs,\n    treeDisabled,\n    treeVisible,\n  } = props;\n  const [searchValue, setSearchValue] = useState('');\n\n  return (\n    <div className=\"flex flex-col grow w-full h-full\">\n      {isSearchable ? (\n        <Search\n          value={searchValue}\n          placeholder={I18n.t('datasets_placeholder_search')}\n          onChange={setSearchValue}\n        />\n      ) : null}\n      <div className=\"pl-2 h-6 mt-4 mb-1 flex items-center\">\n        <div className=\"coz-fg-secondary text-[12px] font-[400] leading-4 shrink-0\">\n          {/**document list */}\n          {I18n.t('knowledge_level_012')}\n        </div>\n      </div>\n      <div className=\"flex flex-col grow w-full\">\n        <div className=\"flex flex-col gap-1 h-[150px] grow !overflow-auto shrink-0\">\n          {list\n            .filter(item => item.title.includes(searchValue))\n            .map(document => {\n              if (document.id !== '') {\n                return (\n                  <DocumentItem\n                    key={document.id}\n                    id={document.id}\n                    selected={document.id === selectedID}\n                    onClick={onClick}\n                    title={document.title}\n                    tag={document.tag}\n                    label={document.label}\n                  />\n                );\n              } else {\n                return null;\n              }\n            })}\n        </div>\n\n        {levelSegments?.length && treeVisible ? (\n          <>\n            <div className=\"h-4 flex justify-center items-center px-[8px] mb-[8px]\">\n              <div\n                className={cls(\n                  'border border-solid border-[0.5px] transition w-full',\n                  'coz-stroke-primary',\n                )}\n              />\n            </div>\n            <div className=\"flex flex-col gap-1 !overflow-auto\">\n              <div className=\"w-full pl-2 h-6 items-center flex gap-[4px]\">\n                <div className=\"coz-fg-secondary text-[12px] font-[400] leading-4 shrink-0\">\n                  {/**segment hierarchy */}\n                  {I18n.t('knowledge_level_adjust')}\n                </div>\n                {treeDisabled ? null : (\n                  <Tooltip\n                    style={{\n                      maxWidth: 602,\n                    }}\n                    position=\"left\"\n                    content={\n                      <>\n                        <div className=\"coz-fg-plus text-[14px] font-[500] leading-[20px] mb-3\">\n                          {I18n.t('knowledge_hierarchies_categories')}\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <div className=\"flex flex-col gap-1 justify-between w-[182px]\">\n                            <span className=\"coz-fg-primary text-[12px] leading-[16px] font-[400]\">\n                              {I18n.t('level_999')}\n                            </span>\n                            <img src={LevelOperation} className=\"w-[182px]\" />\n                          </div>\n                          <div className=\"flex flex-col gap-1 justify-between w-[182px]\">\n                            <span className=\"coz-fg-primary text-[12px] leading-[16px] font-[400]\">\n                              {I18n.t('level_998')}\n                            </span>\n                            <img\n                              src={\n                                IS_OVERSEA ? MergeOperationEn : MergeOperation\n                              }\n                              className=\"w-[182px]\"\n                            />\n                          </div>\n                          <div className=\"flex flex-col gap-1 justify-between w-[182px]\">\n                            <span className=\"coz-fg-primary text-[12px] leading-[16px] font-[400]\">\n                              {I18n.t('level_997')}\n                            </span>\n                            <img\n                              src={\n                                IS_OVERSEA ? DeleteOperationEn : DeleteOperation\n                              }\n                              className=\"w-[182px]\"\n                            />\n                          </div>\n                        </div>\n                      </>\n                    }\n                  >\n                    <IconCozInfoCircle className=\"coz-fg-secondary\" />\n                  </Tooltip>\n                )}\n              </div>\n              <div className=\"h-[360px]\">\n                <SegmentTree\n                  segments={levelSegments}\n                  setLevelSegments={setLevelSegments}\n                  setSelectionIDs={setSelectionIDs}\n                  disabled={treeDisabled}\n                />\n              </div>\n            </div>\n          </>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nexport default SegmentMenu;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport mitt from 'mitt';\nimport type { Emitter, Handler, EventType } from 'mitt';\n\nimport { type Chunk } from '../types/chunk';\n\n// Define event name literal type\nexport type EventTypeName =\n  | 'previewContextMenuItemAction'\n  | 'hoverEditBarAction';\n\n/**\n * event type definition\n */\nexport interface EventTypes extends Record<EventType, unknown> {\n  // right-click menu related events\n  previewContextMenuItemAction: {\n    type: 'add-after' | 'add-before' | 'delete' | 'edit';\n    targetChunk: Chunk;\n    newChunk?: Chunk;\n    chunks?: Chunk[];\n  };\n\n  // Floating edit bar related events\n  hoverEditBarAction: {\n    type: 'add-after' | 'add-before' | 'delete' | 'edit';\n    targetChunk: Chunk;\n    newChunk?: Chunk;\n    chunks?: Chunk[];\n  };\n}\n\n/**\n * event handler type\n */\nexport type EventHandler<T extends EventTypeName> = Handler<EventTypes[T]>;\n\n/**\n * Create an event bus instance\n */\nexport const createEventBus = (): Emitter<EventTypes> => mitt<EventTypes>();\n\n/**\n * Global Event Bus instance\n */\nexport const eventBus = createEventBus();\n\n/**\n * event bus hook\n * Used to use the event bus in components\n */\nexport const useEventBus = () => eventBus;\n\n/**\n * listen event hook\n * Used to listen for events in a component\n * @param eventName\n * @param handler event handler\n * @Param deps dependency arrays, rebind events when dependencies change\n */\nexport const useEventListener = <T extends EventTypeName>(\n  eventName: T,\n  handler: EventHandler<T>,\n  deps: React.DependencyList = [],\n) => {\n  useEffect(() => {\n    // binding event\n    eventBus.on(eventName, handler as Handler<unknown>);\n\n    // Unbind event when component is unmounted\n    return () => {\n      eventBus.off(eventName, handler as Handler<unknown>);\n    };\n  }, deps);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureRegistry } from '@coze-data/feature-register';\n\nimport { type EditorActionModule } from './module';\n\nexport type EditorActionFeatureType = 'upload-image';\n\nexport type EditorActionRegistry = FeatureRegistry<\n  EditorActionFeatureType,\n  EditorActionModule\n>;\n\nexport const createEditorActionFeatureRegistry = (\n  name: string,\n): EditorActionRegistry =>\n  new FeatureRegistry<EditorActionFeatureType, EditorActionModule>({\n    name,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { CustomError } from '@coze-arch/bot-error';\n\n// eslint-disable-next-line @typescript-eslint/no-magic-numbers\nconst LIMIT_SIZE = 20 * 1024 * 1024;\nexport const isValidSize = (size: number) => LIMIT_SIZE > size;\n\nexport const getBase64 = (file: Blob): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = event => {\n      const result = event.target?.result;\n\n      if (!result || typeof result !== 'string') {\n        reject(new CustomError('getBase64', 'file read invalid'));\n        return;\n      }\n\n      resolve(result.replace(/^.*?,/, ''));\n    };\n    fileReader.onerror = () => {\n      Toast.error(I18n.t('read_file_failed_please_retry'));\n      reject(new CustomError('getBase64', 'file read fail'));\n    };\n    fileReader.onabort = () => {\n      reject(new CustomError('getBase64', 'file read abort'));\n    };\n    fileReader.readAsDataURL(file);\n  });\n\nexport const getUint8Array = (file: Blob): Promise<Uint8Array> =>\n  new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n\n    fileReader.onload = event => {\n      if (event.target?.result) {\n        const arrayBuffer = event.target.result as ArrayBuffer;\n        const uint8Array = new Uint8Array(arrayBuffer);\n        resolve(uint8Array);\n      } else {\n        reject(new CustomError('getUint8Array', 'file read invalid'));\n      }\n    };\n\n    fileReader.readAsArrayBuffer(file);\n  });\n\nexport const getFileExtension = (name: string) => {\n  const index = name.lastIndexOf('.');\n  return name.slice(index + 1);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { Upload, Toast, type customRequestArgs } from '@coze-arch/coze-design';\nimport { type UploadProps } from '@coze-arch/bot-semi/Upload';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { FileBizType } from '@coze-arch/bot-api/developer_api';\nimport { DeveloperApi } from '@coze-arch/bot-api';\n\nimport {\n  getBase64,\n  getFileExtension,\n  isValidSize,\n} from '@/text-knowledge-editor/utils/upload';\n\ninterface CustomUploadProps {\n  customRequest: UploadProps['customRequest'];\n}\n\nexport const CustomUpload: React.FC<PropsWithChildren<CustomUploadProps>> = ({\n  customRequest,\n  children,\n}) => (\n  <Upload\n    accept=\"image/*\"\n    maxSize={20480}\n    fileList={[]}\n    customRequest={customRequest}\n    onChange={fileItem => {\n      const { currentFile } = fileItem;\n      if (currentFile) {\n        const isValid = isValidSize(currentFile?.fileInstance?.size || 0);\n        if (!isValid) {\n          Toast.error(I18n.t('knowledge_insert_img_013'));\n        }\n      }\n    }}\n  >\n    {children}\n  </Upload>\n);\n\nexport interface CustomRequestParams {\n  object: customRequestArgs;\n  options: {\n    onFinish?: (result: { url?: string; tosKey?: string }) => void;\n    onFinally?: () => void;\n    onBeforeUpload?: () => void;\n  };\n}\n\nexport const handleCustomUploadRequest = async ({\n  object,\n  options,\n}: CustomRequestParams) => {\n  const { onSuccess, onProgress, file } = object;\n  const { onFinish, onFinally, onBeforeUpload } = options;\n\n  if (typeof file === 'string') {\n    return;\n  }\n\n  try {\n    // business logic\n    onBeforeUpload?.();\n    const { name, fileInstance } = file;\n\n    if (fileInstance) {\n      const extension = getFileExtension(name);\n\n      const base64 = await getBase64(fileInstance);\n      const result = await DeveloperApi.UploadFile(\n        {\n          file_head: {\n            file_type: extension,\n            biz_type: FileBizType.BIZ_BOT_DATASET,\n          },\n          data: base64,\n        },\n        {\n          onUploadProgress: e => {\n            onProgress({\n              total: e.total ?? fileInstance.size,\n              loaded: e.loaded,\n            });\n          },\n        },\n      );\n      onSuccess(result.data);\n      if (result.data) {\n        onFinish?.({\n          url: result.data.upload_url,\n          tosKey: result.data.upload_uri,\n        });\n      }\n    } else {\n      dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n        eventName: ReportEventNames.KnowledgeUploadFile,\n        error: new CustomError(\n          ReportEventNames.KnowledgeUploadFile,\n          `${ReportEventNames.KnowledgeUploadFile}: Failed to upload image`,\n        ),\n      });\n    }\n  } catch (error) {\n    dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n      eventName: ReportEventNames.KnowledgeUploadFile,\n      error: error as Error,\n    });\n  } finally {\n    onFinally?.();\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { type Editor } from '@tiptap/react';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip, type customRequestArgs } from '@coze-arch/coze-design';\n\nimport { type EditorActionProps } from '../module';\nimport { CustomUpload, handleCustomUploadRequest } from './custom-upload';\n\nexport interface BaseUploadImageProps extends EditorActionProps {\n  editor: Editor | null;\n  renderUI: (props: {\n    disabled?: boolean;\n    showTooltip?: boolean;\n  }) => React.ReactNode;\n}\n\nexport const BaseUploadImage = ({\n  editor,\n  disabled,\n  showTooltip,\n  renderUI,\n}: BaseUploadImageProps) => {\n  // Handle image upload\n  const handleImageUpload = (object: customRequestArgs) => {\n    if (!editor) {\n      return;\n    }\n\n    const { fileInstance } = object;\n    if (!fileInstance) {\n      return;\n    }\n\n    return handleCustomUploadRequest({\n      object,\n      options: {\n        onFinish: (result: { url?: string; tosKey?: string }) => {\n          if (result.url && editor) {\n            // Insert pictures into the editor and set the tosKey\n            editor\n              .chain()\n              .focus()\n              .setImageWithTosKey({\n                src: result.url,\n                dataTosKey: result.tosKey ?? null,\n              })\n              .run();\n          }\n        },\n      },\n    });\n  };\n  const TooltipWrapper = showTooltip ? Tooltip : React.Fragment;\n\n  return (\n    <CustomUpload customRequest={handleImageUpload}>\n      <TooltipWrapper\n        content={I18n.t('knowledge_insert_img_002')}\n        clickToHide\n        autoAdjustOverflow\n      >\n        {renderUI({ disabled, showTooltip })}\n      </TooltipWrapper>\n    </CustomUpload>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozImage } from '@coze-arch/coze-design/icons';\nimport { Button } from '@coze-arch/coze-design';\n\nimport { BaseUploadImage, type BaseUploadImageProps } from './base';\n\nexport const UploadImageButton = (\n  props: Omit<BaseUploadImageProps, 'renderUI'>,\n) => (\n  <BaseUploadImage\n    {...props}\n    renderUI={({ disabled }) => (\n      <Button\n        disabled={disabled}\n        color=\"primary\"\n        className=\"coz-fg-primary leading-none\"\n        icon={<IconCozImage className=\"text-[14px]\" />}\n      >\n        {I18n.t('knowledge_insert_img_002')}\n      </Button>\n    )}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozImage } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { BaseUploadImage, type BaseUploadImageProps } from './base';\n\nexport const UploadImageMenu = (\n  props: Omit<BaseUploadImageProps, 'renderUI'>,\n) => (\n  <BaseUploadImage\n    {...props}\n    renderUI={({ disabled }) => (\n      <Menu.Item\n        disabled={disabled}\n        icon={\n          <IconCozImage\n            className={classNames('w-3.5 h-3.5', {\n              'opacity-30': disabled,\n            })}\n          />\n        }\n        className={classNames('h-8 p-2 text-xs rounded-lg', {\n          'cursor-not-allowed': disabled,\n        })}\n      >\n        {I18n.t('knowledge_insert_img_002')}\n      </Menu.Item>\n    )}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nexport interface UseOutEditorModeProps {\n  editorRef: React.RefObject<HTMLDivElement>;\n  exclude?: React.RefObject<HTMLDivElement>[];\n  onExitEditMode?: () => void;\n}\n\nexport const useOutEditorMode = ({\n  editorRef,\n  exclude,\n  onExitEditMode,\n}: UseOutEditorModeProps) => {\n  // Process Click Document Other Locations\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      // If you click outside the editor, exit editing mode\n      if (\n        editorRef.current &&\n        !editorRef.current.contains(event.target as Node) &&\n        !exclude?.some(ref => ref.current?.contains(event.target as Node))\n      ) {\n        onExitEditMode?.();\n      }\n    };\n\n    window.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      window.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [editorRef, exclude, onExitEditMode]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { type Editor } from '@tiptap/react';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { type EditorActionRegistry } from '@/text-knowledge-editor/features/editor-actions/registry';\ninterface EditorContextMenuProps {\n  x: number;\n  y: number;\n  editor: Editor | null;\n  readonly?: boolean;\n  contextMenuRef: React.RefObject<HTMLDivElement>;\n  editorActionRegistry: EditorActionRegistry;\n}\n\nexport const EditorContextMenu: React.FC<EditorContextMenuProps> = props => {\n  const { editorActionRegistry, readonly, contextMenuRef, x, y, editor } =\n    props;\n\n  if (readonly) {\n    return null;\n  }\n\n  return (\n    <div\n      ref={contextMenuRef}\n      className=\"absolute bg-white shadow-lg rounded-md py-1 z-50\"\n      style={{\n        top: `${y}px`,\n        left: `${x}px`,\n      }}\n    >\n      <Menu\n        visible\n        clickToHide\n        keepDOM\n        position=\"bottomLeft\"\n        spacing={-4}\n        trigger=\"custom\"\n        getPopupContainer={() => contextMenuRef.current ?? document.body}\n        className={classNames('coz-shadow-large')}\n        render={\n          <Menu.SubMenu className={classNames('p-1')} mode=\"menu\">\n            {editorActionRegistry.entries().map(([key, { Component }]) => (\n              <Component key={key} editor={editor} />\n            ))}\n          </Menu.SubMenu>\n        }\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef } from 'react';\n\nimport classNames from 'classnames';\nimport { EditorContent, type Editor } from '@tiptap/react';\n\nimport { getEditorContent } from '@/text-knowledge-editor/services/use-case/get-editor-content';\nimport { getEditorWordsCls } from '@/text-knowledge-editor/services/inner/get-editor-words-cls';\nimport { getEditorTableClassname } from '@/text-knowledge-editor/services/inner/get-editor-table-cls';\nimport { getEditorImgClassname } from '@/text-knowledge-editor/services/inner/get-editor-img-cls';\nimport { useOutEditorMode } from '@/text-knowledge-editor/hooks/inner/use-out-editor-mode';\nimport { useControlContextMenu } from '@/text-knowledge-editor/hooks/inner/use-control-context-menu';\n\nimport { EditorContextMenu } from '../editor-context-menu';\nimport { type EditorActionRegistry } from '../editor-actions/registry';\n\ninterface DocumentEditorProps {\n  editor: Editor | null;\n  placeholder?: string;\n  editorContextMenuItemsRegistry?: EditorActionRegistry;\n  editorBottomSlot?: React.ReactNode;\n  onBlur?: (newContent: string) => void;\n}\n\nexport const DocumentEditor: React.FC<DocumentEditorProps> = props => {\n  const {\n    editor,\n    placeholder,\n    editorContextMenuItemsRegistry,\n    editorBottomSlot,\n    onBlur,\n  } = props;\n  const editorRef = useRef<HTMLDivElement>(null);\n  const contextMenuRef = useRef<HTMLDivElement>(null);\n\n  /**\n   * When right-clicking on the editor, the context menu is displayed\n   */\n  const { contextMenuPosition, openContextMenu } = useControlContextMenu({\n    contextMenuRef,\n  });\n\n  /**\n   * When clicking outside the editor\n   */\n  useOutEditorMode({\n    editorRef,\n    exclude: [contextMenuRef],\n    onExitEditMode: () => {\n      const newContent = getEditorContent(editor);\n      onBlur?.(newContent);\n    },\n  });\n\n  if (!editor) {\n    return null;\n  }\n\n  return (\n    <div className=\"relative\">\n      <div\n        ref={editorRef}\n        className={classNames(\n          // layout\n          'relative',\n          // spacing\n          'mb-2 p-2',\n          // Text Style\n          'text-sm leading-5',\n          // color\n          'coz-fg-primary coz-bg-max',\n          // border\n          'border border-solid coz-stroke-hglt rounded-lg',\n        )}\n        onContextMenu={openContextMenu}\n      >\n        <div\n          className={classNames(\n            // table style\n            getEditorTableClassname(),\n            // image style\n            getEditorImgClassname(),\n            // line feed\n            getEditorWordsCls(),\n          )}\n        >\n          <EditorContent editor={editor} placeholder={placeholder} />\n          {editorBottomSlot}\n        </div>\n      </div>\n\n      {/* right-click menu */}\n      {contextMenuPosition && editorContextMenuItemsRegistry ? (\n        <EditorContextMenu\n          x={contextMenuPosition.x}\n          y={contextMenuPosition.y}\n          contextMenuRef={contextMenuRef}\n          editor={editor}\n          editorActionRegistry={editorContextMenuItemsRegistry}\n        />\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocumentAddBottom } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useAddEmptyChunkAction } from '@/text-knowledge-editor/hooks/use-case/chunk-actions';\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type HoverEditBarActionProps } from './module';\n\nexport const AddAfterAction: React.FC<HoverEditBarActionProps> = ({\n  chunk,\n  chunks,\n  disabled,\n}) => {\n  // Add new shardings after specific shardings\n  const { addEmptyChunkAfter } = useAddEmptyChunkAction({\n    chunks: chunks || [],\n    onChunksChange: ({ newChunk, chunks: newChunks }) => {\n      eventBus.emit('hoverEditBarAction', {\n        type: 'add-after',\n        targetChunk: chunk,\n        chunks: newChunks,\n        newChunk,\n      });\n    },\n  });\n\n  return (\n    <Tooltip\n      content={I18n.t('knowledge_optimize_016')}\n      clickToHide\n      autoAdjustOverflow\n    >\n      <IconButton\n        data-dtestid={`${KnowledgeE2e.SegmentDetailContentItemAddBottomIcon}.${chunk.text_knowledge_editor_chunk_uuid}`}\n        size=\"small\"\n        color=\"secondary\"\n        disabled={disabled}\n        icon={<IconCozDocumentAddBottom className=\"text-[14px]\" />}\n        iconPosition=\"left\"\n        className=\"coz-fg-secondary leading-none !w-6 !h-6\"\n        onClick={() => addEmptyChunkAfter(chunk)}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocumentAddTop } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useAddEmptyChunkAction } from '@/text-knowledge-editor/hooks/use-case/chunk-actions';\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type HoverEditBarActionProps } from './module';\n\n/**\n * Add the action component of a new sharding before a specific sharding\n */\nexport const AddBeforeAction: React.FC<HoverEditBarActionProps> = ({\n  chunk,\n  chunks = [],\n  disabled,\n}) => {\n  // Add new shardings before specific shardings\n  const { addEmptyChunkBefore } = useAddEmptyChunkAction({\n    chunks,\n    onChunksChange: ({ newChunk, chunks: newChunks }) => {\n      eventBus.emit('hoverEditBarAction', {\n        type: 'add-before',\n        targetChunk: chunk,\n        chunks: newChunks,\n        newChunk,\n      });\n    },\n  });\n\n  return (\n    <Tooltip\n      content={I18n.t('knowledge_optimize_017')}\n      clickToHide\n      autoAdjustOverflow\n    >\n      <IconButton\n        data-dtestid={`${KnowledgeE2e.SegmentDetailContentItemAddTopIcon}.${chunk.text_knowledge_editor_chunk_uuid}`}\n        size=\"small\"\n        color=\"secondary\"\n        disabled={disabled}\n        icon={<IconCozDocumentAddTop className=\"text-[14px]\" />}\n        iconPosition=\"left\"\n        className=\"coz-fg-secondary leading-none !w-6 !h-6\"\n        onClick={() => addEmptyChunkBefore(chunk)}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useDeleteAction } from '@/text-knowledge-editor/hooks/use-case/chunk-actions';\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type HoverEditBarActionProps } from './module';\n\n/**\n * Remove the action component for specific shardings\n *\n * The logic to remove specific shardings is implemented internally\n * If an onDelete callback is passed, it will be called on click\n * If chunks, onChunksChange are provided, the deletion logic is handled internally.\n * No need to rely on external usePreviewContextMenu\n */\nexport const DeleteAction: React.FC<HoverEditBarActionProps> = ({\n  chunk,\n  chunks = [],\n  disabled,\n}) => {\n  // Remove specific shardings\n  const { deleteChunk } = useDeleteAction({\n    chunks,\n    onChunksChange: ({ chunks: newChunks }) => {\n      eventBus.emit('hoverEditBarAction', {\n        type: 'delete',\n        targetChunk: chunk,\n        chunks: newChunks,\n      });\n    },\n  });\n\n  return (\n    <Tooltip\n      content={I18n.t('knowledge_level_028')}\n      clickToHide\n      autoAdjustOverflow\n    >\n      <IconButton\n        size=\"small\"\n        color=\"secondary\"\n        disabled={disabled}\n        icon={<IconCozTrashCan className=\"text-[14px]\" />}\n        iconPosition=\"left\"\n        className=\"coz-fg-secondary leading-none !w-6 !h-6\"\n        onClick={() => deleteChunk(chunk)}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type HoverEditBarActionProps } from './module';\n\n/**\n * Edit action component\n *\n * The logic to activate the edit mode for specific shardings is implemented internally\n * If an onEdit callback is passed, it will be called on click\n */\nexport const EditAction: React.FC<HoverEditBarActionProps> = ({\n  chunk,\n  disabled,\n}) => (\n  <Tooltip\n    content={I18n.t('datasets_segment_edit')}\n    clickToHide\n    autoAdjustOverflow\n  >\n    <IconButton\n      data-dtestid={`${KnowledgeE2e.SegmentDetailContentItemEditIcon}.${chunk.text_knowledge_editor_chunk_uuid}`}\n      size=\"small\"\n      color=\"secondary\"\n      disabled={disabled}\n      icon={<IconCozEdit className=\"text-[14px]\" />}\n      iconPosition=\"left\"\n      className=\"coz-fg-secondary leading-none !w-6 !h-6\"\n      onClick={() => {\n        eventBus.emit('hoverEditBarAction', {\n          type: 'edit',\n          targetChunk: chunk,\n        });\n      }}\n    />\n  </Tooltip>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureRegistry } from '@coze-data/feature-register';\n\nimport { type HoverEditBarActionModule } from './module';\n\nexport type HoverEditBarActionFeatureType =\n  | 'edit'\n  | 'delete'\n  | 'add-before'\n  | 'add-after';\n\nexport type HoverEditBarActionRegistry = FeatureRegistry<\n  HoverEditBarActionFeatureType,\n  HoverEditBarActionModule\n>;\n\nexport const createHoverEditBarActionFeatureRegistry = (\n  name: string,\n): HoverEditBarActionRegistry =>\n  new FeatureRegistry<HoverEditBarActionFeatureType, HoverEditBarActionModule>({\n    name,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { IconButton, Space, Tooltip } from '@coze-arch/coze-design';\nimport { SliceStatus } from '@coze-arch/bot-api/knowledge';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { type HoverEditBarActionRegistry } from '@/text-knowledge-editor/features/hover-edit-bar-actions/registry';\nexport interface HoverEditBarProps {\n  chunk: Chunk;\n  chunks: Chunk[];\n  disabled?: boolean;\n  hoverEditBarActionsRegistry: HoverEditBarActionRegistry;\n  onChunksChange?: (chunks: Chunk[]) => void;\n}\n\nexport const HoverEditBar: React.FC<HoverEditBarProps> = ({\n  chunk,\n  chunks,\n  disabled,\n  hoverEditBarActionsRegistry,\n  onChunksChange,\n}) => {\n  const isAudiFailed = chunk.status === SliceStatus.AuditFailed;\n  const iconButtonCommonClasses = 'coz-fg-secondary leading-none !w-6 !h-6';\n\n  if (!hoverEditBarActionsRegistry) {\n    return null;\n  }\n\n  return (\n    <div className=\"absolute top-[2px] right-[2px] flex z-10\">\n      {!disabled ? (\n        <div\n          className={classNames(\n            'p-1 coz-bg-plus rounded-lg',\n            'coz-shadow-default',\n          )}\n        >\n          <Space spacing={3}>\n            {hoverEditBarActionsRegistry\n              .entries()\n              .map(([key, { Component }]) => (\n                <Component\n                  key={key}\n                  chunk={chunk}\n                  chunks={chunks}\n                  onChunksChange={onChunksChange}\n                />\n              ))}\n          </Space>\n        </div>\n      ) : null}\n\n      {isAudiFailed ? (\n        <div\n          className={classNames(\n            'p-1 coz-bg-plus rounded-lg',\n            'coz-shadow-default',\n            'ml-1',\n          )}\n        >\n          <Tooltip\n            content={I18n.t('community_This_is_a_toast_Machine_review_failed')}\n            clickToHide\n            autoAdjustOverflow\n          >\n            <IconButton\n              icon={\n                <IconCozInfoCircle className=\"text-[14px] coz-fg-hglt-red\" />\n              }\n              size=\"small\"\n              color=\"secondary\"\n              className={iconButtonCommonClasses}\n            />\n          </Tooltip>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { useDeleteAction } from '@/text-knowledge-editor/hooks/use-case/chunk-actions';\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type PreviewContextMenuItemProps } from './module';\n\n/**\n * Remove a specific sharding menu item component\n */\nexport const DeleteAction: React.FC<PreviewContextMenuItemProps> = ({\n  chunk,\n  chunks = [],\n  disabled,\n}) => {\n  const getIconStyles = (isDisabled: boolean) =>\n    classNames('w-3.5 h-3.5', {\n      'opacity-30': isDisabled,\n    });\n\n  const getMenuItemStyles = (isDisabled: boolean) =>\n    classNames('h-8 px-2 py-2 text-xs rounded-lg', {\n      'cursor-not-allowed': isDisabled,\n    });\n\n  // Remove specific shardings\n  const { deleteChunk } = useDeleteAction({\n    chunks,\n    onChunksChange: ({ chunks: newChunks }) => {\n      eventBus.emit('previewContextMenuItemAction', {\n        type: 'delete',\n        targetChunk: chunk,\n        chunks: newChunks,\n      });\n    },\n  });\n\n  return (\n    <Menu.Item\n      disabled={disabled}\n      icon={<IconCozTrashCan className={getIconStyles(!!disabled)} />}\n      onClick={() => deleteChunk(chunk)}\n      className={getMenuItemStyles(!!disabled)}\n    >\n      {I18n.t('Delete')}\n    </Menu.Item>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type PreviewContextMenuItemProps } from './module';\n\n/**\n * Edit Action Menu Item Component\n *\n * The logic to activate the edit mode for specific shardings is implemented internally\n * If an onEdit callback is passed, it will be called on click\n */\nexport const EditAction: React.FC<PreviewContextMenuItemProps> = ({\n  chunk,\n  disabled,\n}) => {\n  const getIconStyles = (isDisabled: boolean) =>\n    classNames('w-3.5 h-3.5', {\n      'opacity-30': isDisabled,\n    });\n\n  const getMenuItemStyles = (isDisabled: boolean) =>\n    classNames('h-8 px-2 py-2 text-xs rounded-lg', {\n      'cursor-not-allowed': isDisabled,\n    });\n\n  return (\n    <Menu.Item\n      disabled={disabled}\n      icon={<IconCozEdit className={getIconStyles(!!disabled)} />}\n      onClick={() => {\n        eventBus.emit('previewContextMenuItemAction', {\n          type: 'edit',\n          targetChunk: chunk,\n        });\n      }}\n      className={getMenuItemStyles(!!disabled)}\n    >\n      {I18n.t('Edit')}\n    </Menu.Item>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureRegistry } from '@coze-data/feature-register';\n\nimport { type PreviewContextMenuItemModule } from './module';\n\nexport type PreviewContextMenuItemFeatureType =\n  | 'edit'\n  | 'delete'\n  | 'add-before'\n  | 'add-after';\n\nexport type PreviewContextMenuItemRegistry = FeatureRegistry<\n  PreviewContextMenuItemFeatureType,\n  PreviewContextMenuItemModule\n>;\n\nexport const createPreviewContextMenuItemFeatureRegistry = (\n  name: string,\n): PreviewContextMenuItemRegistry =>\n  new FeatureRegistry<\n    PreviewContextMenuItemFeatureType,\n    PreviewContextMenuItemModule\n  >({\n    name,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nexport const useHoverEffect = () => {\n  const [hoveredChunk, setHoveredChunk] = useState<string | null>(null);\n\n  // Handling mouse hover events\n  const handleMouseEnter = (chunkId: string) => {\n    setHoveredChunk(chunkId);\n  };\n\n  // Handling mouse away events\n  const handleMouseLeave = () => {\n    setHoveredChunk(null);\n  };\n\n  return {\n    hoveredChunk,\n    handleMouseEnter,\n    handleMouseLeave,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport DOMPurify from 'dompurify';\nimport classNames from 'classnames';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { getRenderHtmlContent } from '@/text-knowledge-editor/services/use-case/get-render-editor-content';\nimport { getEditorWordsCls } from '@/text-knowledge-editor/services/inner/get-editor-words-cls';\nimport { getEditorTableClassname } from '@/text-knowledge-editor/services/inner/get-editor-table-cls';\nimport { getEditorImgClassname } from '@/text-knowledge-editor/services/inner/get-editor-img-cls';\n\nexport const DocumentChunkPreview = ({\n  chunk,\n  locateId,\n}: {\n  chunk: Chunk;\n  locateId: string;\n}) => (\n  <div\n    id={locateId}\n    className={classNames(\n      // layout\n      'relative',\n      // spacing\n      'mb-2 p-2',\n      // Text Style\n      'text-sm leading-5',\n      // color\n      'coz-fg-primary hover:coz-mg-hglt-secondary-hovered coz-mg-secondary',\n      // border\n      'border border-solid coz-stroke-primary rounded-lg',\n      // table style\n      getEditorTableClassname(),\n      // image style\n      getEditorImgClassname(),\n      // line feed\n      getEditorWordsCls(),\n    )}\n  >\n    <p\n      // Filtered xss with DOMPurify\n      // eslint-disable-next-line risxss/catch-potential-xss-react\n      dangerouslySetInnerHTML={{\n        __html:\n          DOMPurify.sanitize(getRenderHtmlContent(chunk.content ?? ''), {\n            /**\n             * 1. Prevent CSS injection attacks\n             * 2. Prevent users from writing the style tag by mistake, resulting in the global style being modified and the page display being abnormal\n             */\n            FORBID_TAGS: ['style'],\n          }) ?? '',\n      }}\n    />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { type PreviewContextMenuItemRegistry } from '@/text-knowledge-editor/features/preview-context-menu-items/registry';\ninterface PreviewContextMenuProps {\n  x: number;\n  y: number;\n  chunk: Chunk;\n  chunks: Chunk[];\n  readonly?: boolean;\n  contextMenuRef: React.RefObject<HTMLDivElement>;\n  previewContextMenuItemsRegistry: PreviewContextMenuItemRegistry;\n}\n\nconst PreviewContextMenu: React.FC<PreviewContextMenuProps> = props => {\n  const {\n    previewContextMenuItemsRegistry,\n    chunk,\n    chunks,\n    readonly,\n    contextMenuRef,\n    x,\n    y,\n  } = props;\n\n  if (readonly) {\n    return null;\n  }\n\n  return (\n    <div\n      ref={contextMenuRef}\n      className=\"absolute bg-white shadow-lg rounded-md py-1 z-50\"\n      style={{\n        top: `${y}px`,\n        left: `${x}px`,\n      }}\n    >\n      <Menu\n        visible\n        position=\"bottomLeft\"\n        spacing={-4}\n        trigger=\"custom\"\n        getPopupContainer={() => contextMenuRef.current ?? document.body}\n        className={classNames('rounded-lg')}\n        render={\n          <Menu.SubMenu className={classNames('w-40 p-1')} mode=\"menu\">\n            {previewContextMenuItemsRegistry\n              .entries()\n              .map(([key, { Component }]) => (\n                <Component key={key} chunk={chunk} chunks={chunks} />\n              ))}\n          </Menu.SubMenu>\n        }\n      />\n    </div>\n  );\n};\n\nexport default PreviewContextMenu;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef } from 'react';\n\nimport classNames from 'classnames';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { useHoverEffect } from '@/text-knowledge-editor/hooks/inner/use-hover-effect';\nimport { useControlContextMenu } from '@/text-knowledge-editor/hooks/inner/use-control-context-menu';\nimport { DocumentChunkPreview } from '@/text-knowledge-editor/components/preview-chunk/document';\n\nimport { type PreviewContextMenuItemRegistry } from '../preview-context-menu-items/registry';\nimport PreviewContextMenu from '../preview-context-menu';\nimport { type HoverEditBarActionRegistry } from '../hover-edit-bar-actions/registry';\nimport { HoverEditBar } from '../hover-edit-bar';\ninterface DocumentPreviewProps {\n  chunk: Chunk;\n  chunks: Chunk[];\n  readonly?: boolean;\n  locateId?: string;\n  hoverEditBarActionsRegistry: HoverEditBarActionRegistry;\n  previewContextMenuItemsRegistry: PreviewContextMenuItemRegistry;\n  onActivateEditMode?: (chunk: Chunk) => void;\n}\n\nconst DocumentPreviewComponent: React.FC<DocumentPreviewProps> = props => {\n  const {\n    chunk,\n    chunks,\n    readonly = false,\n    locateId,\n    onActivateEditMode,\n    hoverEditBarActionsRegistry,\n    previewContextMenuItemsRegistry,\n  } = props;\n  const contextMenuRef = useRef<HTMLDivElement>(null);\n  const { hoveredChunk, handleMouseEnter, handleMouseLeave } = useHoverEffect();\n\n  const { contextMenuPosition, openContextMenu } = useControlContextMenu({\n    contextMenuRef,\n  });\n\n  return (\n    <div className=\"relative\">\n      <div\n        className={classNames(\n          // layout\n          'relative overflow-hidden',\n        )}\n        onContextMenu={readonly ? undefined : e => openContextMenu(e)}\n        onMouseEnter={\n          readonly\n            ? undefined\n            : () => handleMouseEnter(chunk.text_knowledge_editor_chunk_uuid)\n        }\n        onMouseLeave={readonly ? undefined : handleMouseLeave}\n        onDoubleClick={readonly ? undefined : () => onActivateEditMode?.(chunk)}\n      >\n        {/* The action bar displayed when hovering */}\n        {hoveredChunk === chunk.text_knowledge_editor_chunk_uuid &&\n        !readonly ? (\n          <HoverEditBar\n            chunk={chunk}\n            chunks={chunks}\n            hoverEditBarActionsRegistry={hoverEditBarActionsRegistry}\n          />\n        ) : null}\n\n        <DocumentChunkPreview chunk={chunk} locateId={locateId || ''} />\n      </div>\n\n      {/* right-click menu */}\n      {contextMenuPosition ? (\n        <PreviewContextMenu\n          previewContextMenuItemsRegistry={previewContextMenuItemsRegistry}\n          x={contextMenuPosition.x}\n          y={contextMenuPosition.y}\n          chunk={chunk}\n          chunks={chunks}\n          readonly={readonly}\n          contextMenuRef={contextMenuRef}\n        />\n      ) : null}\n    </div>\n  );\n};\n\n// Wrap components with React.memo to avoid unnecessary re-rendering\nexport const DocumentPreview = React.memo(\n  DocumentPreviewComponent,\n  (prevProps, nextProps) => {\n    // If the sharding content changes, it needs to be re-rendered\n    if (prevProps.chunk.content !== nextProps.chunk.content) {\n      return false;\n    }\n\n    // In other cases, no re-rendering is required\n    return true;\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\ninterface UseControlContextMenuProps {\n  contextMenuRef: React.RefObject<HTMLDivElement>;\n}\n\nexport const useControlContextMenu = ({\n  contextMenuRef,\n}: UseControlContextMenuProps) => {\n  const [contextMenuPosition, setContextMenuPosition] = useState<{\n    x: number;\n    y: number;\n  } | null>(null);\n\n  // Handle right-click menus\n  const openContextMenu = (e: React.MouseEvent) => {\n    e.preventDefault();\n\n    // Calculate the position relative to the event target element\n    const rect = e.currentTarget.getBoundingClientRect();\n    const relativeX = e.clientX - rect.left;\n    const relativeY = e.clientY - rect.top;\n\n    setContextMenuPosition({\n      x: relativeX,\n      y: relativeY,\n    });\n  };\n\n  // Close the right-click menu\n  const closeContextMenu = () => {\n    setContextMenuPosition(null);\n  };\n\n  // Process Click Document Other Locations\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      // If you click outside the right-click menu, close the menu\n      if (\n        contextMenuRef.current &&\n        !contextMenuRef.current.contains(event.target as Node)\n      ) {\n        closeContextMenu();\n      }\n    };\n\n    window.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      window.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  return {\n    contextMenuPosition,\n    openContextMenu,\n    closeContextMenu,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRequest } from 'ahooks';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nexport const useDeleteChunk = () => {\n  const { runAsync: deleteSlice } = useRequest(\n    async (sliceId: string) => {\n      if (!sliceId) {\n        throw new CustomError('normal_error', 'missing slice_id');\n      }\n      await KnowledgeApi.DeleteSlice({\n        slice_ids: [sliceId],\n      });\n    },\n    {\n      manual: true,\n    },\n  );\n  return {\n    deleteSlice,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useEffect } from 'react';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { createLocalChunk } from '@/text-knowledge-editor/services/inner/chunk-op.service';\n\ninterface UseAddEmptyChunkActionProps {\n  chunks: Chunk[];\n  onChunksChange?: (params: { newChunk: Chunk; chunks: Chunk[] }) => void;\n}\n/**\n * Add new sharding hook after specific sharding\n *\n * Provides the ability to add new shardings after specific shardings\n */\nexport const useAddEmptyChunkAction = ({\n  chunks,\n  onChunksChange,\n}: UseAddEmptyChunkActionProps) => {\n  // Use ref to save the latest chunks reference\n  const chunksRef = useRef<Chunk[]>(chunks);\n\n  // Every time props.chunks is updated, update the ref.\n  useEffect(() => {\n    chunksRef.current = chunks;\n  }, [chunks]);\n\n  /**\n   * Add new shardings after specific shardings\n   * @Returns the result object containing the new sharding and the updated sharding list\n   */\n  const handleAddEmptyChunkAfter = (chunk: Chunk) => {\n    // Get the latest chunks from the ref\n    const currentChunks = chunksRef.current;\n    const index = currentChunks.findIndex(\n      c =>\n        c.text_knowledge_editor_chunk_uuid ===\n        chunk.text_knowledge_editor_chunk_uuid,\n    );\n    if (index === -1) {\n      return;\n    }\n\n    const sequence =\n      currentChunks.find(\n        c =>\n          c.text_knowledge_editor_chunk_uuid ===\n          chunk.text_knowledge_editor_chunk_uuid,\n      )?.sequence ?? '1';\n    const newChunk = createLocalChunk({\n      sequence: String(Number(sequence) + 1),\n    });\n\n    const updatedChunks = [\n      ...currentChunks.slice(0, index + 1),\n      newChunk,\n      ...currentChunks.slice(index + 1),\n    ];\n\n    onChunksChange?.({\n      newChunk,\n      chunks: updatedChunks,\n    });\n  };\n\n  /**\n   * Add new shardings before specific shardings\n   */\n  const handleAddEmptyChunkBefore = (chunk: Chunk) => {\n    // Get the latest chunks from the ref\n    const currentChunks = chunksRef.current;\n    const index = currentChunks.findIndex(\n      c =>\n        c.text_knowledge_editor_chunk_uuid ===\n        chunk.text_knowledge_editor_chunk_uuid,\n    );\n    const sequence =\n      currentChunks.find(\n        c =>\n          c.text_knowledge_editor_chunk_uuid ===\n          chunk.text_knowledge_editor_chunk_uuid,\n      )?.sequence ?? '1';\n    if (index === -1) {\n      return;\n    }\n\n    const newChunk = createLocalChunk({\n      sequence,\n    });\n\n    const updatedChunks = [\n      ...currentChunks.slice(0, index),\n      newChunk,\n      ...currentChunks.slice(index),\n    ];\n\n    onChunksChange?.({\n      newChunk,\n      chunks: updatedChunks,\n    });\n  };\n\n  return {\n    addEmptyChunkAfter: handleAddEmptyChunkAfter,\n    addEmptyChunkBefore: handleAddEmptyChunkBefore,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useRef, useEffect } from 'react';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { useDeleteChunk } from '@/text-knowledge-editor/hooks/inner/use-delete-chunk';\n\ninterface UseDeleteActionProps {\n  chunks: Chunk[];\n  onChunksChange?: (params: { chunks: Chunk[]; targetChunk: Chunk }) => void;\n}\n\n/**\n * Remove sharding hook\n *\n * Provides the ability to remove specific shardings\n */\nexport const useDeleteAction = ({\n  chunks,\n  onChunksChange,\n}: UseDeleteActionProps) => {\n  // Use ref to save the latest chunks reference\n  const chunksRef = useRef<Chunk[]>(chunks);\n  const { deleteSlice } = useDeleteChunk();\n\n  // Every time props.chunks is updated, update the ref.\n  useEffect(() => {\n    chunksRef.current = chunks;\n  }, [chunks]);\n\n  /**\n   * Remove specific shardings\n   */\n  const handleDeleteChunk = useCallback(\n    (chunk: Chunk) => {\n      // Get the latest chunks from the ref\n      const currentChunks = chunksRef.current;\n      const updatedChunks = currentChunks.filter(\n        c =>\n          c.text_knowledge_editor_chunk_uuid !==\n          chunk.text_knowledge_editor_chunk_uuid,\n      );\n      if (!chunk.slice_id) {\n        return;\n      }\n      deleteSlice(chunk.slice_id).then(() => {\n        onChunksChange?.({\n          chunks: updatedChunks,\n          targetChunk: chunk,\n        });\n      });\n    },\n    [onChunksChange, deleteSlice],\n  );\n\n  return {\n    deleteChunk: handleDeleteChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Image from '@tiptap/extension-image';\n\n// Extend TipTap Image to support a custom data-tos-key HTML attribute\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    imageWithTosKey: {\n      setImageWithTosKey: (options: {\n        src: string;\n        alt?: string;\n        title?: string;\n        dataTosKey?: string | null;\n      }) => ReturnType;\n    };\n  }\n}\n\nconst ImageWithTosKey = Image.extend({\n  addAttributes() {\n    const parentAttributes = (this.parent?.() as Record<string, unknown>) || {};\n    return {\n      ...parentAttributes,\n      dataTosKey: {\n        default: null,\n        parseHTML: (element: HTMLElement) =>\n          element.getAttribute('data-tos-key'),\n        renderHTML: (attributes: { dataTosKey?: string | null }) => {\n          if (!attributes.dataTosKey) {\n            return {};\n          }\n          return { 'data-tos-key': attributes.dataTosKey };\n        },\n      },\n    };\n  },\n\n  addCommands() {\n    return {\n      setImageWithTosKey:\n        (options: {\n          src: string;\n          alt?: string;\n          title?: string;\n          dataTosKey?: string | null;\n        }) =>\n        ({ commands }) =>\n          commands.insertContent({\n            type: this.name,\n            attrs: {\n              src: options.src,\n              alt: options.alt,\n              title: options.title,\n              dataTosKey: options.dataTosKey ?? null,\n            },\n          }),\n    };\n  },\n});\n\nexport default ImageWithTosKey;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport StarterKit from '@tiptap/starter-kit';\nimport { useEditor, type Editor } from '@tiptap/react';\nimport { type EditorProps } from '@tiptap/pm/view';\nimport TableRow from '@tiptap/extension-table-row';\nimport TableHeader from '@tiptap/extension-table-header';\nimport TableCell from '@tiptap/extension-table-cell';\nimport Table from '@tiptap/extension-table';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { getRenderHtmlContent } from '@/text-knowledge-editor/services/use-case/get-render-editor-content';\nimport { getEditorContent } from '@/text-knowledge-editor/services/use-case/get-editor-content';\nimport ImageWithTosKey from '@/text-knowledge-editor/extensions/image-with-tos-key';\n\ninterface UseDocumentEditorProps {\n  chunk: Chunk | null;\n  editorProps?: EditorProps;\n  onChange?: (chunk: Chunk) => void;\n}\n\nexport const useInitEditor = ({\n  chunk,\n  editorProps,\n  onChange,\n}: UseDocumentEditorProps) => {\n  // Create an editor instance\n  const editor: Editor | null = useEditor({\n    extensions: [\n      StarterKit.configure({\n        hardBreak: {\n          // force wrap\n          keepMarks: false,\n        },\n        paragraph: {\n          // Configure paragraphs to avoid generating extra empty paragraphs\n          HTMLAttributes: {\n            class: 'text-knowledge-tiptap-editor-paragraph',\n          },\n        },\n      }),\n      Table.configure({\n        resizable: true,\n      }),\n      TableRow,\n      TableCell,\n      TableHeader,\n      ImageWithTosKey.configure({\n        inline: false,\n        allowBase64: true,\n      }),\n    ],\n    content: getRenderHtmlContent(chunk?.content || ''),\n    parseOptions: {\n      preserveWhitespace: 'full',\n    },\n    onUpdate: ({ editor: editorInstance }) => {\n      if (!chunk || !editorInstance) {\n        return;\n      }\n      const newContent = getEditorContent(editorInstance);\n      onChange?.({\n        ...chunk,\n        content: newContent,\n      });\n    },\n    editorProps: {\n      ...editorProps,\n      handlePaste(view, event, slice) {\n        if (!editor) {\n          return false;\n        }\n        const text = event.clipboardData?.getData('text/plain');\n\n        // If the pasted plain text contains a newline character\n        if (text?.includes('\\n')) {\n          event.preventDefault(); // Block default paste behavior\n\n          const html = getRenderHtmlContent(text);\n\n          // Insert the converted HTML into the editor\n          editor.chain().focus().insertContent(html).run();\n\n          return true; // It means we have dealt with it.\n        }\n\n        return false; // Use default behavior\n      },\n    },\n  });\n\n  // Update editor content when active sharding changes\n  useEffect(() => {\n    if (!editor || !chunk) {\n      return;\n    }\n    const htmlContent = getRenderHtmlContent(chunk.content || '');\n    // Set content, keep newlines\n    editor.commands.setContent(htmlContent || '', false, {\n      preserveWhitespace: 'full',\n    });\n  }, [chunk, editor]);\n\n  return {\n    editor,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\n\nimport { processEditorContent } from '../inner/document-editor.service';\n\n/**\n * Determine whether the content has changed\n */\nexport const isEditorContentChange = (\n  chunks: Chunk[],\n  chunk: Chunk,\n): boolean => {\n  const newContent = processEditorContent(chunk.content ?? '');\n  const oldContent = chunks.find(c => c.slice_id === chunk.slice_id)?.content;\n  return newContent !== oldContent;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRequest } from 'ahooks';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nexport const useUpdateChunk = () => {\n  const { runAsync: updateSlice, loading: updateLoading } = useRequest(\n    async (sliceId: string, updateContent: string) => {\n      if (!sliceId) {\n        throw new CustomError('normal_error', 'missing slice_id');\n      }\n      await KnowledgeApi.UpdateSlice({\n        slice_id: sliceId,\n        raw_text: updateContent,\n      });\n      return updateContent;\n    },\n    {\n      manual: true,\n    },\n  );\n  return {\n    updateSlice,\n    updateLoading,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { isEditorContentChange } from '@/text-knowledge-editor/services/use-case/is-editor-content-change';\nimport { updateChunks } from '@/text-knowledge-editor/services/inner/chunk-op.service';\nimport { useUpdateChunk } from '@/text-knowledge-editor/hooks/inner/use-update-chunk';\n\nexport interface UseUpdateRemoteChunkProps {\n  chunks: Chunk[];\n  onChunksChange?: (chunks: Chunk[]) => void;\n  onUpdateChunk?: (chunk: Chunk) => void;\n}\n\nexport const useUpdateRemoteChunk = ({\n  chunks,\n  onChunksChange,\n  onUpdateChunk,\n}: UseUpdateRemoteChunkProps) => {\n  const { updateSlice } = useUpdateChunk();\n\n  /**\n   * Handling updates for remote sharding\n   */\n  const updateRemoteChunk = async (chunk: Chunk) => {\n    if (!chunk.slice_id) {\n      Toast.error('The slice ID does not exist. Please refresh the page');\n      return;\n    }\n    if (!isEditorContentChange(chunks, chunk)) {\n      onChunksChange?.(chunks);\n      return;\n    }\n    await updateSlice(chunk.slice_id, chunk.content ?? '');\n    const newChunks = updateChunks(chunks, chunk);\n    onUpdateChunk?.(chunk);\n    onChunksChange?.(newChunks);\n  };\n\n  return {\n    updateRemoteChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { deleteRemoteChunk as deleteRemoteChunkService } from '@/text-knowledge-editor/services/inner/chunk-op.service';\nimport { useDeleteChunk } from '@/text-knowledge-editor/hooks/inner/use-delete-chunk';\n\nexport interface UseDeleteRemoteChunkProps {\n  chunks: Chunk[];\n  onChunksChange?: (chunks: Chunk[]) => void;\n  onDeleteChunk?: (chunk: Chunk) => void;\n}\n\nexport const useDeleteRemoteChunk = ({\n  chunks,\n  onChunksChange,\n  onDeleteChunk,\n}: UseDeleteRemoteChunkProps) => {\n  const { deleteSlice } = useDeleteChunk();\n\n  /**\n   * Handling remotely sharding deletion operations\n   */\n  const deleteRemoteChunk = async (chunk: Chunk) => {\n    if (!chunk.slice_id) {\n      return;\n    }\n    await deleteSlice(chunk.slice_id);\n    const newChunks = deleteRemoteChunkService(chunks, chunk.slice_id);\n    onChunksChange?.(newChunks);\n    onDeleteChunk?.(chunk);\n  };\n\n  return {\n    deleteRemoteChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { deleteLocalChunk as deleteLocalChunkService } from '@/text-knowledge-editor/services/inner/chunk-op.service';\n\nexport interface UseDeleteLocalChunkProps {\n  chunks: Chunk[];\n  onChunksChange?: (chunks: Chunk[]) => void;\n}\n\nexport const useDeleteLocalChunk = ({\n  chunks,\n  onChunksChange,\n}: UseDeleteLocalChunkProps) => {\n  /**\n   * Handle deletion of local shardings\n   */\n  const deleteLocalChunk = (chunk: Chunk) => {\n    if (!chunk.local_slice_id) {\n      return;\n    }\n    const newChunks = deleteLocalChunkService(chunks, chunk.local_slice_id);\n    onChunksChange?.(newChunks);\n  };\n\n  return {\n    deleteLocalChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRequest } from 'ahooks';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nimport { createRemoteChunk } from '@/text-knowledge-editor/services/inner/chunk-op.service';\n\nexport interface UseCreateChunkProps {\n  documentId: string;\n}\n\nexport const useCreateChunk = ({ documentId }: UseCreateChunkProps) => {\n  const { runAsync } = useRequest(\n    async (props: { content: string; sequence: string }) => {\n      const { content, sequence } = props;\n      if (!documentId) {\n        throw new CustomError('normal_error', 'missing doc_id');\n      }\n\n      const data = await KnowledgeApi.CreateSlice({\n        document_id: documentId,\n        raw_text: content,\n        sequence,\n      });\n\n      const chunk = createRemoteChunk({\n        slice_id: data?.slice_id ?? '',\n        sequence,\n        content,\n      });\n\n      return chunk;\n    },\n    {\n      manual: true,\n      onError: error => {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: REPORT_EVENTS.KnowledgeCreateSlice,\n          error,\n        });\n      },\n    },\n  );\n\n  return {\n    createChunk: runAsync,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\nimport { updateLocalChunk } from '@/text-knowledge-editor/services/inner/chunk-op.service';\nimport { useCreateChunk } from '@/text-knowledge-editor/hooks/inner/use-create-chunk';\n\nexport interface UseCreateLocalChunkProps {\n  chunks: Chunk[];\n  documentId: string;\n  onChunksChange?: (chunks: Chunk[]) => void;\n  onAddChunk?: (chunk: Chunk) => void;\n}\n\nexport const useCreateLocalChunk = ({\n  chunks,\n  documentId,\n  onChunksChange,\n  onAddChunk,\n}: UseCreateLocalChunkProps) => {\n  const { createChunk } = useCreateChunk({\n    documentId,\n  });\n\n  /**\n   * Handle the creation of local shardings\n   */\n  const createLocalChunk = async (chunk: Chunk) => {\n    if (!chunk.local_slice_id) {\n      return;\n    }\n    const newChunk = await createChunk({\n      content: chunk.content ?? '',\n      sequence: chunk.sequence ?? '1',\n    });\n    const newChunks = updateLocalChunk({\n      chunks,\n      localChunkSliceId: chunk.local_slice_id,\n      newChunk,\n    });\n    onAddChunk?.(newChunk);\n    onChunksChange?.(newChunks);\n  };\n\n  return {\n    createLocalChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\n\nimport { useUpdateRemoteChunk } from './use-update-remote-chunk';\nimport { useDeleteRemoteChunk } from './use-delete-remote-chunk';\nimport { useDeleteLocalChunk } from './use-delete-local-chunk';\nimport { useCreateLocalChunk } from './use-create-local-chunk';\n\nexport interface UseSaveChunkProps {\n  chunks: Chunk[];\n  documentId: string;\n  onChunksChange?: (chunks: Chunk[]) => void;\n  onAddChunk?: (chunk: Chunk) => void;\n  onUpdateChunk?: (chunk: Chunk) => void;\n  onDeleteChunk?: (chunk: Chunk) => void;\n}\n\nexport const useSaveChunk = ({\n  chunks,\n  documentId,\n  onAddChunk,\n  onUpdateChunk,\n  onChunksChange,\n  onDeleteChunk,\n}: UseSaveChunkProps) => {\n  const { createLocalChunk } = useCreateLocalChunk({\n    chunks,\n    documentId,\n    onChunksChange,\n    onAddChunk,\n  });\n\n  const { updateRemoteChunk } = useUpdateRemoteChunk({\n    chunks,\n    onChunksChange,\n    onUpdateChunk,\n  });\n\n  const { deleteLocalChunk } = useDeleteLocalChunk({\n    chunks,\n    onChunksChange,\n  });\n\n  const { deleteRemoteChunk } = useDeleteRemoteChunk({\n    chunks,\n    onChunksChange,\n    onDeleteChunk,\n  });\n\n  /**\n   * Handling save logic for remote shardings\n   */\n  const saveRemoteChunk = async (chunk: Chunk) => {\n    if (chunk.content === '') {\n      await deleteRemoteChunk(chunk);\n      return;\n    }\n    await updateRemoteChunk(chunk);\n  };\n\n  /**\n   * Save logic for handling local shardings\n   */\n  const saveLocalChunk = async (chunk: Chunk) => {\n    if (chunk.content === '') {\n      deleteLocalChunk(chunk);\n    } else {\n      await createLocalChunk(chunk);\n    }\n  };\n\n  /**\n   * Save the main function of sharding\n   */\n  const saveChunk = async (chunk: Chunk) => {\n    if (!chunk.local_slice_id) {\n      await saveRemoteChunk(chunk);\n      return;\n    }\n    await saveLocalChunk(chunk);\n  };\n\n  return {\n    saveChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Editor } from '@tiptap/react';\n\nimport { type EditorActionRegistry } from '../editor-actions/registry';\n\nexport interface EditorToolbarProps {\n  editor: Editor | null;\n  actionRegistry: EditorActionRegistry;\n}\n\nexport const EditorToolbar = ({\n  editor,\n  actionRegistry,\n}: EditorToolbarProps) => (\n  <div className=\"h-[32px] box-content px-2 pt-2\">\n    {actionRegistry.entries().map(([key, { Component }]) => (\n      <Component key={key} editor={editor} />\n    ))}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UploadImageMenu } from '@/text-knowledge-editor/features/editor-actions/upload-image';\nimport {\n  createEditorActionFeatureRegistry,\n  type EditorActionRegistry,\n} from '@/text-knowledge-editor/features/editor-actions/registry';\nexport const editorContextActionRegistry: EditorActionRegistry = (() => {\n  const editorContextActionFeatureRegistry = createEditorActionFeatureRegistry(\n    'editor-context-actions',\n  );\n  editorContextActionFeatureRegistry.registerSome([\n    {\n      type: 'upload-image',\n      module: {\n        Component: UploadImageMenu,\n      },\n    },\n  ]);\n  return editorContextActionFeatureRegistry;\n})();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createPreviewContextMenuItemFeatureRegistry,\n  type PreviewContextMenuItemRegistry,\n} from '@/text-knowledge-editor/features/preview-context-menu-items/registry';\nimport { EditAction } from '@/text-knowledge-editor/features/preview-context-menu-items/edit-action';\nimport { DeleteAction } from '@/text-knowledge-editor/features/preview-context-menu-items/delete-action';\nimport { AddBeforeAction } from '@/text-knowledge-editor/features/preview-context-menu-items/add-before-action';\nimport { AddAfterAction } from '@/text-knowledge-editor/features/preview-context-menu-items/add-after-action';\nexport const previewContextMenuItemsContributes: PreviewContextMenuItemRegistry =\n  (() => {\n    const previewContextMenuItemFeatureRegistry =\n      createPreviewContextMenuItemFeatureRegistry('preview-context-menu-items');\n    previewContextMenuItemFeatureRegistry.registerSome([\n      {\n        type: 'edit',\n        module: {\n          Component: EditAction,\n        },\n      },\n      {\n        type: 'add-before',\n        module: {\n          Component: AddBeforeAction,\n        },\n      },\n      {\n        type: 'add-after',\n        module: {\n          Component: AddAfterAction,\n        },\n      },\n      {\n        type: 'delete',\n        module: {\n          Component: DeleteAction,\n        },\n      },\n    ]);\n    return previewContextMenuItemFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createHoverEditBarActionFeatureRegistry,\n  type HoverEditBarActionRegistry,\n} from '@/text-knowledge-editor/features/hover-edit-bar-actions/registry';\nimport { EditAction } from '@/text-knowledge-editor/features/hover-edit-bar-actions/edit-action';\nimport { DeleteAction } from '@/text-knowledge-editor/features/hover-edit-bar-actions/delete-action';\nimport { AddBeforeAction } from '@/text-knowledge-editor/features/hover-edit-bar-actions/add-before-action';\nimport { AddAfterAction } from '@/text-knowledge-editor/features/hover-edit-bar-actions/add-after-action';\nexport const hoverEditBarActionsContributes: HoverEditBarActionRegistry =\n  (() => {\n    const hoverEditBarActionFeatureRegistry =\n      createHoverEditBarActionFeatureRegistry('hover-edit-bar-actions');\n    hoverEditBarActionFeatureRegistry.registerSome([\n      {\n        type: 'edit',\n        module: {\n          Component: EditAction,\n        },\n      },\n      {\n        type: 'add-before',\n        module: {\n          Component: AddBeforeAction,\n        },\n      },\n      {\n        type: 'add-after',\n        module: {\n          Component: AddAfterAction,\n        },\n      },\n      {\n        type: 'delete',\n        module: {\n          Component: DeleteAction,\n        },\n      },\n    ]);\n    return hoverEditBarActionFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocumentAddTop } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { useAddEmptyChunkAction } from '@/text-knowledge-editor/hooks/use-case/chunk-actions';\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type PreviewContextMenuItemProps } from './module';\n\n/**\n * Add a new sharding's menu item component before a specific sharding\n */\nexport const AddBeforeAction: React.FC<PreviewContextMenuItemProps> = ({\n  chunk,\n  chunks = [],\n  disabled,\n}) => {\n  const getIconStyles = (isDisabled: boolean) =>\n    classNames('w-3.5 h-3.5', {\n      'opacity-30': isDisabled,\n    });\n\n  const getMenuItemStyles = (isDisabled: boolean) =>\n    classNames('h-8 px-2 py-2 text-xs rounded-lg', {\n      'cursor-not-allowed': isDisabled,\n    });\n\n  // Add new shardings before specific shardings\n  const { addEmptyChunkBefore } = useAddEmptyChunkAction({\n    chunks,\n    onChunksChange: ({ newChunk, chunks: newChunks }) => {\n      eventBus.emit('previewContextMenuItemAction', {\n        type: 'add-before',\n        targetChunk: chunk,\n        newChunk,\n        chunks: newChunks,\n      });\n    },\n  });\n\n  return (\n    <Menu.Item\n      disabled={disabled}\n      icon={<IconCozDocumentAddTop className={getIconStyles(!!disabled)} />}\n      onClick={() => addEmptyChunkBefore(chunk)}\n      className={getMenuItemStyles(!!disabled)}\n    >\n      {I18n.t('knowledge_optimize_017')}\n    </Menu.Item>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocumentAddBottom } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport { useAddEmptyChunkAction } from '@/text-knowledge-editor/hooks/use-case/chunk-actions';\nimport { eventBus } from '@/text-knowledge-editor/event';\n\nimport { type PreviewContextMenuItemProps } from './module';\n\n/**\n * Add a new sharding's menu item component after a specific sharding\n */\nexport const AddAfterAction: React.FC<PreviewContextMenuItemProps> = ({\n  chunk,\n  chunks = [],\n  disabled,\n}) => {\n  const getIconStyles = (isDisabled: boolean) =>\n    classNames('w-3.5 h-3.5', {\n      'opacity-30': isDisabled,\n    });\n\n  const getMenuItemStyles = (isDisabled: boolean) =>\n    classNames('h-8 px-2 py-2 text-xs rounded-lg', {\n      'cursor-not-allowed': isDisabled,\n    });\n\n  // Add new shardings after specific shardings\n  const { addEmptyChunkAfter } = useAddEmptyChunkAction({\n    chunks,\n    onChunksChange: ({ newChunk, chunks: newChunks }) => {\n      // Issue an event to add a new sharding after a specific sharding\n      eventBus.emit('previewContextMenuItemAction', {\n        type: 'add-after',\n        newChunk,\n        targetChunk: chunk,\n        chunks: newChunks,\n      });\n    },\n  });\n\n  return (\n    <Menu.Item\n      disabled={disabled}\n      icon={<IconCozDocumentAddBottom className={getIconStyles(!!disabled)} />}\n      onClick={() => addEmptyChunkAfter(chunk)}\n      className={getMenuItemStyles(!!disabled)}\n    >\n      {I18n.t('knowledge_optimize_016')}\n    </Menu.Item>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { useSaveChunk } from '@/text-knowledge-editor/hooks/use-case/use-save-chunk';\nimport { useInitEditor } from '@/text-knowledge-editor/hooks/use-case/use-init-editor';\nimport { useEventListener } from '@/text-knowledge-editor/event';\n\nimport { DocumentPreview } from '../../features/preview';\nimport { DocumentEditor } from '../../features/editor';\nimport { type DocumentChunk } from './types/base-document';\nimport { previewContextMenuItemsContributes } from './preview-context-menu-items-contributes';\nimport { hoverEditBarActionsContributes } from './hover-edit-bar-actions-contributes';\nimport { editorContextActionRegistry } from './editor-context-actions-contributes';\nexport interface BaseTextKnowledgeEditorProps {\n  chunks: DocumentChunk[];\n  documentId: string;\n  readonly?: boolean;\n  onChange?: (chunks: DocumentChunk[]) => void;\n  onAddChunk?: (chunk: DocumentChunk) => void;\n  onDeleteChunk?: (chunk: DocumentChunk) => void;\n}\n\nexport const BaseTextKnowledgeEditor = ({\n  chunks: initialChunks,\n  documentId,\n  readonly = false,\n  onChange,\n  onAddChunk,\n  onDeleteChunk,\n}: BaseTextKnowledgeEditorProps) => {\n  const [chunks, setChunks] = useState<DocumentChunk[]>(initialChunks);\n  const [activeChunk, setActiveChunk] = useState<DocumentChunk | null>(null);\n\n  // Using the core editor functions\n  const { editor } = useInitEditor({\n    chunk: activeChunk,\n  });\n\n  // Exit the new sharding feature\n  const { saveChunk } = useSaveChunk({\n    chunks,\n    documentId,\n    onChunksChange: newChunks => {\n      onChange?.(newChunks);\n      setActiveChunk(null);\n    },\n    onAddChunk,\n    onDeleteChunk,\n  });\n\n  // Monitor right-click menu events\n  useEventListener(\n    'previewContextMenuItemAction',\n    useCallback(\n      ({ type, newChunk, chunks: newChunks, targetChunk }) => {\n        if (type === 'add-after') {\n          newChunk && setActiveChunk(newChunk);\n          newChunks && setChunks(newChunks);\n        }\n        if (type === 'add-before') {\n          newChunk && setActiveChunk(newChunk);\n          newChunks && setChunks(newChunks);\n        }\n        if (type === 'delete') {\n          onDeleteChunk?.(targetChunk);\n          newChunks && onChange?.(newChunks);\n        }\n        if (type === 'edit') {\n          setActiveChunk(targetChunk);\n        }\n      },\n      [onDeleteChunk, onChange],\n    ),\n  );\n\n  // Monitor floating edit bar events\n  useEventListener(\n    'hoverEditBarAction',\n    useCallback(\n      ({ type, targetChunk, chunks: newChunks, newChunk }) => {\n        if (type === 'add-after') {\n          newChunk && setActiveChunk(newChunk);\n          newChunks && setChunks(newChunks);\n        }\n        if (type === 'add-before') {\n          newChunk && setActiveChunk(newChunk);\n          newChunks && setChunks(newChunks);\n        }\n        if (type === 'delete') {\n          onDeleteChunk?.(targetChunk);\n          newChunks && onChange?.(newChunks);\n        }\n        if (type === 'edit') {\n          setActiveChunk(targetChunk);\n        }\n      },\n      [onDeleteChunk, onChange],\n    ),\n  );\n\n  useEffect(() => {\n    setChunks(initialChunks);\n  }, [initialChunks]);\n\n  return (\n    <>\n      {chunks.map(chunk => (\n        <div key={chunk.text_knowledge_editor_chunk_uuid}>\n          {(() => {\n            if (\n              chunk.text_knowledge_editor_chunk_uuid ===\n                activeChunk?.text_knowledge_editor_chunk_uuid &&\n              activeChunk\n            ) {\n              return (\n                <DocumentEditor\n                  editor={editor}\n                  editorContextMenuItemsRegistry={editorContextActionRegistry}\n                  onBlur={content => {\n                    saveChunk({\n                      ...activeChunk,\n                      content,\n                    });\n                  }}\n                />\n              );\n            }\n            return (\n              <DocumentPreview\n                chunk={chunk}\n                chunks={chunks}\n                readonly={readonly}\n                onActivateEditMode={setActiveChunk}\n                hoverEditBarActionsRegistry={hoverEditBarActionsContributes}\n                previewContextMenuItemsRegistry={\n                  previewContextMenuItemsContributes\n                }\n              />\n            );\n          })()}\n        </div>\n      ))}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createPreviewContextMenuItemFeatureRegistry,\n  type PreviewContextMenuItemRegistry,\n} from '@/text-knowledge-editor/features/preview-context-menu-items/registry';\nimport { EditAction } from '@/text-knowledge-editor/features/preview-context-menu-items/edit-action';\nimport { DeleteAction } from '@/text-knowledge-editor/features/preview-context-menu-items/delete-action';\nexport const previewContextMenuItemsContributes: PreviewContextMenuItemRegistry =\n  (() => {\n    const previewContextMenuItemFeatureRegistry =\n      createPreviewContextMenuItemFeatureRegistry('preview-context-menu-items');\n    previewContextMenuItemFeatureRegistry.registerSome([\n      {\n        type: 'edit',\n        module: {\n          Component: EditAction,\n        },\n      },\n      {\n        type: 'delete',\n        module: {\n          Component: DeleteAction,\n        },\n      },\n    ]);\n    return previewContextMenuItemFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createHoverEditBarActionFeatureRegistry,\n  type HoverEditBarActionRegistry,\n} from '@/text-knowledge-editor/features/hover-edit-bar-actions/registry';\nimport { EditAction } from '@/text-knowledge-editor/features/hover-edit-bar-actions/edit-action';\nimport { DeleteAction } from '@/text-knowledge-editor/features/hover-edit-bar-actions/delete-action';\nexport const hoverEditBarActionsContributes: HoverEditBarActionRegistry =\n  (() => {\n    const hoverEditBarActionFeatureRegistry =\n      createHoverEditBarActionFeatureRegistry('hover-edit-bar-actions');\n    hoverEditBarActionFeatureRegistry.registerSome([\n      {\n        type: 'edit',\n        module: {\n          Component: EditAction,\n        },\n      },\n      {\n        type: 'delete',\n        module: {\n          Component: DeleteAction,\n        },\n      },\n    ]);\n    return hoverEditBarActionFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cls from 'classnames';\n\nexport const TitleChunkPreview = ({\n  title,\n  id,\n}: {\n  title: string;\n  id: string;\n}) => (\n  <div\n    id={id}\n    className={cls('w-full text-[14px] font-[500] leading-[20px] coz-fg-plus')}\n  >\n    {title}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport DOMPurify from 'dompurify';\nimport cls from 'classnames';\n\nexport const ImageChunkPreview = ({\n  base64,\n  htmlText,\n  link,\n  caption,\n  locateId,\n  selected,\n}: {\n  base64?: string;\n  htmlText?: string;\n  link?: string;\n  caption?: string;\n  locateId: string;\n  selected?: boolean;\n}) => (\n  <div\n    id={locateId}\n    className={cls(\n      'flex items-center flex-col gap-2',\n      'w-full p-2 coz-mg-secondary',\n      'border border-solid coz-stroke-primary rounded-[8px]',\n      selected && '!coz-mg-hglt',\n    )}\n  >\n    {base64 ? (\n      <img\n        src={`data:image/jpeg;base64, ${base64}`}\n        className=\"w-full h-full\"\n      />\n    ) : null}\n    {htmlText ? (\n      <div\n        className=\"w-full h-full overflow-auto [&>*]:w-full [&>*]:h-full\"\n        dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(htmlText) }}\n      />\n    ) : null}\n    {link ? (\n      <div className=\"coz-fg-primary text-[14px] leading-[20px] font-[400] break-all\">\n        {link}\n      </div>\n    ) : null}\n    {caption ? (\n      <div className=\"coz-fg-primary text-[14px] leading-[20px] font-[400] break-all\">\n        {caption}\n      </div>\n    ) : null}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const createLocateChunkId = (id: number | string) => `segment-${id}`;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type LevelDocumentTree,\n  type LevelDocumentChunk,\n} from '../types/level-document';\n\nexport const getLevelDocumentTree = (\n  segments: LevelDocumentChunk[],\n): LevelDocumentTree | [] => {\n  const root = segments.find(f => f.parent === -1 && f.type === 'title');\n\n  if (!root) {\n    return segments.map(item => ({\n      ...item,\n      text: item.content ?? '',\n      parent: item.parent?.toString(),\n      children: [],\n      renderLevel: `root-${item.text_knowledge_editor_chunk_uuid}`,\n    }));\n  }\n\n  return [\n    {\n      ...root,\n      text: root.content ?? '',\n      parent: root.parent?.toString(),\n      children: getChildren(root, segments, 'root'),\n      renderLevel: `root-${root.text_knowledge_editor_chunk_uuid}`,\n    },\n  ];\n};\n\n/** Segments to TreeNodes */\nconst getChildren = (\n  target: LevelDocumentChunk,\n  list: LevelDocumentChunk[],\n  parentPath: string,\n): LevelDocumentTree =>\n  (target.children ?? []).reduce<LevelDocumentTree>((acc, cur, index) => {\n    const found = list.find(f => f.id.toString() === cur.toString());\n    if (found) {\n      const currentPath = `${parentPath}-${index}`;\n      const renderLevel = `${currentPath}-${found.text_knowledge_editor_chunk_uuid}`;\n      return [\n        ...acc,\n        {\n          ...found,\n          parent: found.parent?.toString(),\n          text: found.content ?? '',\n          children: getChildren(found, list, currentPath),\n          renderLevel,\n        },\n      ];\n    } else {\n      return [...acc];\n    }\n  }, []);\n\n/** Bottom line, if the result of idp has no title, add the title */\nexport const withTitle = (\n  segments: LevelDocumentChunk[],\n  title?: string,\n): LevelDocumentChunk[] =>\n  segments.map(item => {\n    if (item.parent === -1 && item.type === 'title' && !item.text) {\n      return {\n        ...item,\n        text: title ?? '',\n      };\n    }\n    return item;\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { createLocateChunkId } from '../../services/locate-segment';\n\n/**\n * Scroll to the selected element\n * @Param selectionIDs array of selected element IDs\n */\nexport const useScrollToSelection = (selectionIDs?: string[]) => {\n  useEffect(() => {\n    if (selectionIDs?.length) {\n      const firstSelectedId = selectionIDs[0];\n      const element = document.getElementById(\n        createLocateChunkId(firstSelectedId),\n      );\n      element?.scrollIntoView({ behavior: 'smooth', block: 'start' });\n    }\n  }, [selectionIDs]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { type LevelDocumentTreeNode } from '../../types/level-document';\n\nexport interface ActiveChunkInfo {\n  chunk: LevelDocumentTreeNode | null;\n  renderLevel: string | null;\n}\n\n/**\n * Manage active chunks in documents\n * Use the renderLevel field to uniquely identify the render location of the chunk\n */\nexport const useActiveChunk = () => {\n  // Store the active chunk and its renderLevel\n  const [activeChunkInfo, setActiveChunkInfo] = useState<ActiveChunkInfo>({\n    chunk: null,\n    renderLevel: null,\n  });\n\n  /**\n   * Clear active chunks\n   */\n  const clearActiveChunk = () => {\n    setActiveChunkInfo({\n      chunk: null,\n      renderLevel: null,\n    });\n  };\n\n  /**\n   * Set the active chunk and its renderLevel\n   * Use during user interaction (e.g. double-clicking)\n   */\n  const setActiveChunkWithLevel = (chunk: LevelDocumentTreeNode) => {\n    if (!chunk.renderLevel) {\n      console.warn('Chunk does not have renderLevel field', chunk);\n      return;\n    }\n\n    setActiveChunkInfo({\n      chunk,\n      renderLevel: chunk.renderLevel,\n    });\n  };\n\n  /**\n   * Checks whether the given chunk is the currently active chunk\n   */\n  const isActiveChunk = (renderLevel: string | undefined) => {\n    if (!renderLevel) {\n      return false;\n    }\n    return renderLevel === activeChunkInfo.renderLevel;\n  };\n\n  return {\n    activeChunkInfo,\n    clearActiveChunk,\n    setActiveChunkWithLevel,\n    isActiveChunk,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useEffect, useState, useCallback } from 'react';\n\nimport { type Editor } from '@tiptap/react';\n\nimport { updateChunkContent } from '@/text-knowledge-editor/services/inner/document-editor.service';\nimport { useSaveChunk } from '@/text-knowledge-editor/hooks/use-case/use-save-chunk';\nimport { useInitEditor } from '@/text-knowledge-editor/hooks/use-case/use-init-editor';\nimport { useEventListener } from '@/text-knowledge-editor/event';\nimport { TitleChunkPreview } from '@/text-knowledge-editor/components/preview-chunk/title';\nimport { ImageChunkPreview } from '@/text-knowledge-editor/components/preview-chunk/image';\n\nimport { editorContextActionRegistry } from '../base/editor-context-actions-contributes';\nimport { DocumentPreview } from '../../features/preview';\nimport { DocumentEditor } from '../../features/editor';\nimport {\n  type LevelDocumentChunk,\n  type LevelDocumentTreeNode,\n} from './types/level-document';\nimport { createLocateChunkId } from './services/locate-segment';\nimport { getLevelDocumentTree } from './services/chunk-op.service';\nimport { previewContextMenuItemsContributes } from './preview-context-menu-items-contributes';\nimport { hoverEditBarActionsContributes } from './hover-edit-bar-actions-contributes';\nimport { useScrollToSelection } from './hooks/use-case';\nimport {\n  useActiveChunk,\n  type ActiveChunkInfo,\n} from './hooks/inner/use-active-chunk';\n\nexport interface LevelTextKnowledgeEditorProps {\n  documentId: string;\n  chunks: LevelDocumentChunk[];\n  readonly?: boolean;\n  selectionIDs?: string[];\n  onChange?: (chunks: LevelDocumentChunk[]) => void;\n  onDeleteChunk?: (chunk: LevelDocumentChunk) => void;\n}\nexport const LevelTextKnowledgeEditor: React.FC<\n  LevelTextKnowledgeEditorProps\n> = ({\n  readonly,\n  chunks: initialChunks,\n  documentId,\n  selectionIDs,\n  onChange,\n  onDeleteChunk,\n}) => {\n  const [chunks, setChunks] = useState<LevelDocumentChunk[]>(initialChunks);\n  const levelDocumentTree = useMemo(\n    () => getLevelDocumentTree(chunks),\n    [chunks],\n  );\n\n  // Using active chunk hooks\n  const {\n    activeChunkInfo,\n    clearActiveChunk,\n    setActiveChunkWithLevel,\n    isActiveChunk,\n  } = useActiveChunk();\n\n  // Using the core editor functions\n  const { editor } = useInitEditor({\n    chunk: activeChunkInfo.chunk,\n  });\n\n  // Sharding function\n  const { saveChunk } = useSaveChunk({\n    chunks: initialChunks,\n    documentId,\n    onChunksChange: newChunks => {\n      onChange?.(newChunks as LevelDocumentChunk[]);\n      clearActiveChunk();\n    },\n    onDeleteChunk: chunk => {\n      onDeleteChunk?.(chunk as LevelDocumentChunk);\n    },\n  });\n\n  // Use the hook that scrolls to the selected element\n  useScrollToSelection(selectionIDs);\n\n  // Monitor right-click menu events\n  useEventListener(\n    'previewContextMenuItemAction',\n    useCallback(({ type, targetChunk, chunks: newChunks }) => {\n      if (type === 'delete') {\n        onDeleteChunk?.(targetChunk as LevelDocumentChunk);\n        newChunks && onChange?.(newChunks as LevelDocumentChunk[]);\n      }\n      if (type === 'edit') {\n        setActiveChunkWithLevel(targetChunk as LevelDocumentTreeNode);\n      }\n    }, []),\n  );\n\n  // Monitor floating edit bar events\n  useEventListener(\n    'hoverEditBarAction',\n    useCallback(({ type, targetChunk, chunks: newChunks }) => {\n      if (type === 'delete') {\n        onDeleteChunk?.(targetChunk as LevelDocumentChunk);\n        newChunks && onChange?.(newChunks as LevelDocumentChunk[]);\n      }\n      if (type === 'edit') {\n        setActiveChunkWithLevel(targetChunk as LevelDocumentTreeNode);\n      }\n    }, []),\n  );\n\n  useEffect(() => {\n    setChunks(initialChunks);\n  }, [initialChunks]);\n\n  if (!levelDocumentTree) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex flex-col gap-2 w-full h-full\">\n      {levelDocumentTree.map(item => (\n        <RenderContent\n          key={item.text_knowledge_editor_chunk_uuid}\n          editor={editor}\n          chunks={chunks}\n          levelDocumentTree={item}\n          activeChunkInfo={activeChunkInfo}\n          isActiveChunk={isActiveChunk}\n          setActiveChunkWithLevel={setActiveChunkWithLevel}\n          selectionIDs={selectionIDs}\n          readonly={readonly}\n          saveChunk={saveChunk}\n          setChunks={setChunks}\n        />\n      ))}\n    </div>\n  );\n};\ninterface SingleContentProps {\n  editor: Editor | null;\n  readonly?: boolean;\n  chunks: LevelDocumentChunk[];\n  levelDocumentTree?: LevelDocumentTreeNode;\n  selectionIDs?: string[];\n  activeChunkInfo: ActiveChunkInfo;\n  isActiveChunk: (renderLevel: string | undefined) => boolean;\n  setActiveChunkWithLevel: (chunk: LevelDocumentTreeNode) => void;\n  setChunks: (chunks: LevelDocumentChunk[]) => void;\n  saveChunk: (chunk: LevelDocumentChunk) => void;\n}\n\nconst RenderContent = ({\n  levelDocumentTree,\n  selectionIDs,\n  chunks,\n  activeChunkInfo,\n  isActiveChunk,\n  setActiveChunkWithLevel,\n  readonly,\n  editor,\n  saveChunk,\n  setChunks,\n}: SingleContentProps) => {\n  const childrenContent = levelDocumentTree?.children?.length ? (\n    <div className=\"flex w-full\">\n      <div className=\"w-6 shrink-0\"></div>\n      <div className=\"flex flex-col w-[calc(100%-24px)] gap-2\">\n        {levelDocumentTree.children.map(item => (\n          <RenderContent\n            key={item.text_knowledge_editor_chunk_uuid}\n            editor={editor}\n            chunks={chunks}\n            saveChunk={saveChunk}\n            levelDocumentTree={item}\n            selectionIDs={selectionIDs}\n            activeChunkInfo={activeChunkInfo}\n            isActiveChunk={isActiveChunk}\n            setActiveChunkWithLevel={setActiveChunkWithLevel}\n            readonly={readonly}\n            setChunks={setChunks}\n          />\n        ))}\n      </div>\n    </div>\n  ) : null;\n\n  if (!levelDocumentTree) {\n    return null;\n  }\n\n  return (\n    <div\n      key={levelDocumentTree.text_knowledge_editor_chunk_uuid}\n      className=\"flex flex-col gap-2 w-full\"\n    >\n      {['title', 'section-title', 'page-title'].includes(\n        levelDocumentTree.type,\n      ) ? (\n        <TitleChunkPreview\n          title={levelDocumentTree.text}\n          id={createLocateChunkId(levelDocumentTree.id)}\n        />\n      ) : null}\n      {[\n        'section-text',\n        'text',\n        'header-footer',\n        'caption',\n        'header',\n        'footer',\n        'formula',\n        'footnote',\n        'toc',\n        'code',\n        'table',\n      ].includes(levelDocumentTree.type) ? (\n        <div key={levelDocumentTree.text_knowledge_editor_chunk_uuid}>\n          {(() => {\n            // Check whether this chunk is the currently active chunk, using the renderLevel field\n            const chunkIsActive = isActiveChunk(levelDocumentTree.renderLevel);\n\n            if (chunkIsActive) {\n              return (\n                <DocumentEditor\n                  editor={editor}\n                  editorContextMenuItemsRegistry={editorContextActionRegistry}\n                  onBlur={newContent => {\n                    saveChunk?.(\n                      updateChunkContent(\n                        levelDocumentTree,\n                        newContent,\n                      ) as unknown as LevelDocumentChunk,\n                    );\n                  }}\n                />\n              );\n            }\n            return (\n              <DocumentPreview\n                chunk={levelDocumentTree}\n                readonly={readonly}\n                chunks={chunks}\n                locateId={createLocateChunkId(levelDocumentTree.id)}\n                hoverEditBarActionsRegistry={hoverEditBarActionsContributes}\n                previewContextMenuItemsRegistry={\n                  previewContextMenuItemsContributes\n                }\n                onActivateEditMode={activedChunk => {\n                  // Set the active chunk, using the renderLevel of the chunk itself\n                  setActiveChunkWithLevel(\n                    activedChunk as LevelDocumentTreeNode,\n                  );\n                }}\n              />\n            );\n          })()}\n        </div>\n      ) : null}\n\n      {['image'].includes(levelDocumentTree.type) ? (\n        <ImageChunkPreview\n          base64={levelDocumentTree.image_detail.base64 ?? ''}\n          htmlText={levelDocumentTree.html_text || levelDocumentTree.text}\n          link={levelDocumentTree.image_detail.links?.[0] ?? ''}\n          caption={levelDocumentTree.image_detail.caption ?? ''}\n          locateId={createLocateChunkId(levelDocumentTree.id)}\n          selected={selectionIDs?.includes(levelDocumentTree.id.toString())}\n        />\n      ) : null}\n      {childrenContent}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { SliceStatus } from '@coze-arch/bot-api/knowledge';\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\n\nexport const createLocalChunk = (props: { sequence: string }): Chunk => {\n  const localSliceId = nanoid();\n  return {\n    text_knowledge_editor_chunk_uuid: nanoid(),\n    local_slice_id: localSliceId,\n    slice_id: localSliceId,\n    sequence: props.sequence,\n    content: '',\n  };\n};\n\n/**\n * Update local sharding\n */\nexport const updateLocalChunk = ({\n  chunks,\n  localChunkSliceId,\n  newChunk,\n}: {\n  chunks: Chunk[];\n  localChunkSliceId: string;\n  newChunk: Chunk;\n}): Chunk[] =>\n  chunks.map(c => (c.local_slice_id === localChunkSliceId ? newChunk : c));\n\n// Delete local sharding\nexport const deleteLocalChunk = (\n  chunks: Chunk[],\n  localChunkSliceId: string,\n): Chunk[] => chunks.filter(c => c.local_slice_id !== localChunkSliceId);\n\n/**\n * Update document sharding content\n */\nexport const updateChunkContent = (chunk: Chunk, content: string): Chunk => ({\n  ...chunk,\n  content,\n});\n\n// Delete remote sharding\nexport const deleteRemoteChunk = (\n  chunks: Chunk[],\n  remoteChunkSliceId: string,\n): Chunk[] => chunks.filter(c => c.slice_id !== remoteChunkSliceId);\n\n/**\n * Update chunks\n */\nexport const updateChunks = (chunks: Chunk[], chunk: Chunk): Chunk[] =>\n  chunks.map(c => (c.slice_id === chunk.slice_id ? chunk : c));\n\n/**\n * Create remote sharding\n */\nexport const createRemoteChunk = (props: {\n  sequence: string;\n  content: string;\n  slice_id?: string;\n}): Chunk => ({\n  text_knowledge_editor_chunk_uuid: nanoid(),\n  status: SliceStatus.FinishVectoring,\n  content: props.content,\n  sequence: props.sequence,\n  slice_id: props.slice_id ?? '',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Chunk } from '@/text-knowledge-editor/types/chunk';\n\n/**\n * Update document sharding content\n */\nexport const updateChunkContent = (chunk: Chunk, content: string): Chunk => ({\n  ...chunk,\n  content,\n});\n\n/**\n * Update chunks\n */\nexport const updateChunks = (chunks: Chunk[], chunk: Chunk): Chunk[] =>\n  chunks.map(c => (c.slice_id === chunk.slice_id ? chunk : c));\n\n/**\n * Get active sharding\n */\nexport const getActiveChunk = (\n  chunks: Chunk[],\n  activeChunkId: string | undefined,\n) => {\n  if (!activeChunkId) {\n    return undefined;\n  }\n  return chunks.find(chunk => chunk.slice_id === activeChunkId) || undefined;\n};\n\n/**\n * Process the HTML content output by the editor\n * Remove unnecessary outer < p > tags to maintain the original content format\n */\nexport const processEditorContent = (content: string): string => {\n  if (!content) {\n    return '';\n  }\n\n  // If the content is wrapped with < p > tags, and there is only one < p > tag\n  const singleParagraphMatch = content.match(/^<p>(.*?)<\\/p>$/s);\n  if (singleParagraphMatch) {\n    return singleParagraphMatch[1];\n  }\n\n  return content;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\n\nexport const getEditorImgClassname = () =>\n  classNames(\n    '[&_img]:relative [&_img]:block',\n    '[&_img]:my-3 [&_img]:bg-white [&_img]:rounded-md',\n    '[&_img]:max-w-[610px] [&_img]:max-h-[367px] [&_img]:w-auto',\n    '[&_img.ProseMirror-selectednode]:outline-2 [&_img.ProseMirror-selectednode]:outline [&_img.ProseMirror-selectednode]:outline-blue-500',\n    '[&_img.ProseMirror-selectednode]:shadow-md',\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\n\nexport const getEditorTableClassname = () =>\n  classNames(\n    // table style\n    '[&_table]:border-collapse [&_table]:m-0 [&_table]:w-full [&_table]:table-fixed [&_table]:overflow-hidden [&_table]:text-[0.9em]',\n    '[&_table_td]:border [&_table_th]:border [&_table_td]:border-[#ddd] [&_table_th]:border-[#ddd]',\n    '[&_table_td]:p-2 [&_table_th]:p-2',\n    '[&_table_td]:relative [&_table_th]:relative',\n    '[&_table_td]:align-top [&_table_th]:align-top',\n    '[&_table_td]:box-border [&_table_th]:box-border',\n    '[&_table_td]:border-solid [&_table_th]:border-solid',\n    '[&_table_td]:min-w-[100px] [&_table_th]:min-w-[100px]',\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\n\nexport const getEditorWordsCls = () =>\n  classNames(\n    // line feed\n    '[&_p]:break-words [&_p]:whitespace-pre-wrap',\n    // Keep all spaces and line breaks\n    '[&_.ProseMirror_*]:break-words [&_.ProseMirror_*]:whitespace-pre-wrap',\n    // paragraph\n    '[&_.editor-paragraph]:min-h-[1.5em] [&_.editor-paragraph]:leading-normal',\n    // Empty paragraph\n    '[&_.editor-paragraph:empty]:min-h-[1.5em] [&_.editor-paragraph:empty]:block',\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Editor } from '@tiptap/react';\n\n/**\n * Get editor content\n * Return the user's actual edited content and remove the outer < p > tag automatically added by TipTap\n */\nexport const getEditorContent = (editor: Editor | null) => {\n  if (!editor) {\n    return '';\n  }\n\n  const content = editor.isEmpty ? '' : editor.getHTML();\n\n  const doc = removeEditorWrapperParagraph(content);\n\n  // Returns the processed HTML.\n  return doc;\n};\n\n/**\n * Process the HTML content output by the editor\n * Remove unnecessary outer < p > tags to maintain the original content format\n */\nexport const removeEditorWrapperParagraph = (content: string): string => {\n  if (!content) {\n    return '';\n  }\n\n  // Using a DOM parser to process HTML\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(content, 'text/html');\n\n  // Find all editor-generated p tags\n  const generatedParagraphs = doc.querySelectorAll(\n    'p.text-knowledge-tiptap-editor-paragraph',\n  );\n\n  // Replace these p tags with their content\n  generatedParagraphs.forEach(p => {\n    const parent = p.parentNode;\n    if (parent) {\n      // Create a document fragment to store the contents of the p tag\n      const fragment = document.createDocumentFragment();\n      while (p.firstChild) {\n        fragment.appendChild(p.firstChild);\n      }\n      // Replace p tags with content\n      parent.replaceChild(fragment, p);\n    }\n  });\n\n  return doc.body.innerHTML;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * HTML whitelist to prevent XSS attacks\n */\n\n// Whitelist of HTML tags allowed by default\nconst DEFAULT_ALLOWED_TAGS = [\n  'img',\n  'table',\n  'colgroup',\n  'col',\n  'tbody',\n  'thead',\n  'tfoot',\n  'tr',\n  'td',\n  'th',\n  'br',\n  'p',\n];\n\n/**\n * Escape HTML, allowing only whitelisted tags\n * @param unsafe HTML string\n * @Param allowedTags Array of HTML tags allowed, default to DEFAULT_ALLOWED_TAGS\n * @Returns the escaped HTML string\n */\nexport function escapeHtml(\n  unsafe: string,\n  allowedTags: string[] = DEFAULT_ALLOWED_TAGS,\n): string {\n  if (!unsafe) {\n    return '';\n  }\n\n  // Building regular expression patterns\n  const allowedTagsPattern = allowedTags.join('|');\n  const tagRegex = new RegExp(\n    `<(?!(${allowedTagsPattern})\\\\b[^>]*>|\\\\/(?:${allowedTagsPattern})>)`,\n    'g',\n  );\n\n  return unsafe.replace(tagRegex, '&lt;');\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { escapeHtml } from '@/text-knowledge-editor/utils/escape-html';\n\n/**\n * Get the rendered HTML content\n */\nexport const getRenderHtmlContent = (content: string) => {\n  if (content === '') {\n    return '';\n  }\n\n  // Escape HTML, allowing only whitelisted tags\n  const htmlContent = escapeHtml(content);\n\n  // The editor doesn't wrap/n, so it needs to be converted to a < br/> tag\n  return htmlContent.replace(/\\n/g, '<br />');\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRequest } from 'ahooks';\n\nexport const useTosContent = (tosUrl?: string) => {\n  const {\n    data: content,\n    loading,\n    error,\n  } = useRequest(\n    async () => {\n      if (!tosUrl) {\n        return null;\n      }\n      const response = await fetch(tosUrl, { cache: 'no-cache' });\n      if (!response.ok) {\n        throw new Error('Failed to fetch content');\n      }\n      return response.json();\n    },\n    {\n      refreshDeps: [tosUrl],\n    },\n  );\n\n  return { content, loading, error };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useNavigate,\n  type To,\n  type Path,\n  type NavigateOptions,\n} from 'react-router-dom';\n\nimport { getKnowledgeIDEQuery } from '@coze-data/knowledge-common-services/use-case';\n\n/** useNavigate dedicated to the knowledge module for persisting common query parameters */\nexport const useKnowledgeNavigate: typeof useNavigate = () => {\n  const navigate = useNavigate();\n  const knowledgePageQuery = getKnowledgeIDEQuery();\n  const overwriteNavigate = (to: To | number, opt?: NavigateOptions) => {\n    if (typeof to === 'string') {\n      const toPathname = to.startsWith('/') ? to : `${location.pathname}/${to}`;\n      const urlObject = new URL(toPathname, window.location.origin);\n      Object.entries(knowledgePageQuery).forEach(([queryKey, queryValue]) => {\n        if (queryValue && !urlObject.searchParams.has(queryKey)) {\n          urlObject.searchParams.set(queryKey, queryValue);\n        }\n      });\n      const { pathname, search } = urlObject;\n      return navigate(`${pathname}${search}`, opt);\n    }\n    if (isPathType(to)) {\n      const { search } = to;\n      const searchParams = new URLSearchParams(search);\n      Object.entries(knowledgePageQuery).forEach(([queryKey, queryValue]) => {\n        if (queryValue && !searchParams.has(queryKey)) {\n          searchParams.set(queryKey, queryValue);\n        }\n      });\n      return navigate({ ...to, search: searchParams.toString() }, opt);\n    }\n    if (isNumberType(to)) {\n      return navigate(to);\n    }\n    return navigate(to, opt);\n  };\n\n  return overwriteNavigate;\n};\n\nconst isPathType = (to: To | number): to is Partial<Path> =>\n  typeof to === 'object';\nconst isNumberType = (to: To | number): to is number => typeof to === 'number';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRequest } from 'ahooks';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { useErrorHandler } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\nimport { Toast } from '@coze-arch/coze-design';\n\nexport const useGetKnowledgeListInfo = (params: { datasetID: string }) => {\n  const spaceId = useSpaceStore(s => s.space.id);\n  const cacheKey = `dataset-${params.datasetID}`;\n  const capture = useErrorHandler();\n  return useRequest(\n    async () => {\n      if (!params.datasetID) {\n        throw new CustomError(\n          'useListDataSetReq_error',\n          'datasetid cannot be empty',\n        );\n      }\n      const res = await KnowledgeApi.ListDataset({\n        filter: {\n          dataset_ids: [params.datasetID],\n        },\n        space_id: spaceId,\n      });\n\n      if (res?.total) {\n        return res?.dataset_list?.find(i => i.dataset_id === params.datasetID);\n      } else if (res?.total !== 0) {\n        capture(new CustomError('useListDataSetReq_error', res.msg || ''));\n      }\n    },\n    {\n      cacheKey,\n      setCache: data => sessionStorage.setItem(cacheKey, JSON.stringify(data)),\n      getCache: () => JSON.parse(sessionStorage.getItem(cacheKey) || '{}'),\n      onError: error => {\n        Toast.error({\n          content: I18n.t('Network_error'),\n          showClose: false,\n        });\n        capture(error);\n      },\n    },\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface KnowledgeIDEQuery {\n  biz?: 'agentIDE' | 'workflow' | 'library' | 'project';\n  bot_id?: string;\n  workflow_id?: string;\n  agent_id?: string;\n  page_mode?: 'modal' | 'normal';\n}\nexport const getKnowledgeIDEQuery = (): KnowledgeIDEQuery => {\n  const queryParams = new URLSearchParams(location.search);\n  const knowledgeQuery = {\n    biz: queryParams.get('biz') as KnowledgeIDEQuery['biz'],\n    bot_id: queryParams.get('bot_id'),\n    workflow_id: queryParams.get('workflow_id'),\n    agent_id: queryParams.get('agent_id'),\n    page_mode: queryParams.get('page_mode') as KnowledgeIDEQuery['page_mode'],\n  };\n  // Filter out null values to avoid generating extra querystrings.\n  return Object.fromEntries(Object.entries(knowledgeQuery).filter(e => !!e[1]));\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TextLocalModule } from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu/text-local';\nimport { TextCustomModule } from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu/text-custom';\nimport {\n  createImportKnowledgeMenuSourceFeatureRegistry,\n  type ImportKnowledgeMenuSourceRegistry,\n} from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu';\nexport const importKnowledgeSourceMenuContributes: ImportKnowledgeMenuSourceRegistry =\n  (() => {\n    const importKnowledgeMenuSourceFeatureRegistry =\n      createImportKnowledgeMenuSourceFeatureRegistry(\n        'import-knowledge-source-text-menu',\n      );\n    importKnowledgeMenuSourceFeatureRegistry.registerSome([\n      {\n        type: 'text-local',\n        module: TextLocalModule,\n      },\n      {\n        type: 'text-custom',\n        module: TextCustomModule,\n      },\n    ]);\n    return importKnowledgeMenuSourceFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ConfigurationTableStructureModule,\n  createTableConfigMenuRegistry,\n  type TableConfigMenuRegistry,\n} from '@/features/knowledge-ide-table-config-menus';\n\nexport const knowledgeTableLocalConfigMenuContributes: TableConfigMenuRegistry =\n  (() => {\n    const knowledgeTableConfigMenuRegistry = createTableConfigMenuRegistry(\n      'knowledge-ide-table-local-config-menu',\n    );\n    knowledgeTableConfigMenuRegistry.registerSome([\n      {\n        type: 'configuration-table-structure',\n        module: ConfigurationTableStructureModule,\n      },\n    ]);\n    return knowledgeTableConfigMenuRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ConfigurationTableStructureModule,\n  createTableConfigMenuRegistry,\n  type TableConfigMenuRegistry,\n} from '@/features/knowledge-ide-table-config-menus';\n\nexport const knowledgeTableConfigMenuContributes: TableConfigMenuRegistry =\n  (() => {\n    const knowledgeTableConfigMenuRegistry = createTableConfigMenuRegistry(\n      'knowledge-ide-table-custom-config-menu',\n    );\n    knowledgeTableConfigMenuRegistry.registerSome([\n      {\n        type: 'configuration-table-structure',\n        module: ConfigurationTableStructureModule,\n      },\n    ]);\n    return knowledgeTableConfigMenuRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  TableLocalModule,\n  TableCustomModule,\n} from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu';\nimport {\n  createImportKnowledgeMenuSourceFeatureRegistry,\n  type ImportKnowledgeMenuSourceRegistry,\n} from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu';\n\nexport const importKnowledgeSourceMenuContributes: ImportKnowledgeMenuSourceRegistry =\n  (() => {\n    const importKnowledgeMenuSourceFeatureRegistry =\n      createImportKnowledgeMenuSourceFeatureRegistry(\n        'import-knowledge-source-table-menu',\n      );\n    importKnowledgeMenuSourceFeatureRegistry.registerSome([\n      {\n        type: 'table-local',\n        module: TableLocalModule,\n      },\n      {\n        type: 'table-custom',\n        module: TableCustomModule,\n      },\n    ]);\n    return importKnowledgeMenuSourceFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ImageLocalModule } from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu/image-local';\nimport {\n  createImportKnowledgeMenuSourceFeatureRegistry,\n  type ImportKnowledgeMenuSourceRegistry,\n} from '@coze-data/knowledge-ide-base/features/import-knowledge-sources/menu';\n\nexport const importKnowledgeSourceMenuContributes: ImportKnowledgeMenuSourceRegistry =\n  (() => {\n    const importKnowledgeMenuSourceFeatureRegistry =\n      createImportKnowledgeMenuSourceFeatureRegistry(\n        'import-knowledge-source-image-menu',\n      );\n    importKnowledgeMenuSourceFeatureRegistry.register({\n      type: 'image-local',\n      module: ImageLocalModule,\n    });\n    return importKnowledgeMenuSourceFeatureRegistry;\n  })();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useRequest } from 'ahooks';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { useErrorHandler } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { type Dataset } from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\nimport { useProcessingStore } from '@coze-data/knowledge-stores';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { Toast } from '@coze-arch/coze-design';\n\nconst POLLING_TIME = 1000;\n\nexport const useListDataSetReq = (params: { datasetID: string }) => {\n  const spaceId = useSpaceStore(s => s.space.id);\n  const cacheKey = `dataset-${params.datasetID}`;\n  const capture = useErrorHandler();\n  return useRequest(\n    async () => {\n      if (!params.datasetID) {\n        throw new CustomError(\n          'useListDataSetReq_error',\n          'datasetid cannot be empty',\n        );\n      }\n      const res = await KnowledgeApi.ListDataset({\n        filter: {\n          dataset_ids: [params.datasetID],\n        },\n        space_id: spaceId,\n      });\n\n      if (res?.total) {\n        return res?.dataset_list?.find(i => i.dataset_id === params.datasetID);\n      } else if (res?.total !== 0) {\n        capture(new CustomError('useListDataSetReq_error', res.msg || ''));\n      }\n    },\n    {\n      cacheKey,\n      setCache: data => sessionStorage.setItem(cacheKey, JSON.stringify(data)),\n      getCache: () => JSON.parse(sessionStorage.getItem(cacheKey) || '{}'),\n      onError: error => {\n        Toast.error({\n          content: I18n.t('Network_error'),\n          showClose: false,\n        });\n        capture(error);\n      },\n    },\n  );\n};\nexport const useDataSetDetailReq = (\n  onSuccess?: (res: Dataset | undefined) => void,\n  onError?: () => void,\n) => {\n  const capture = useErrorHandler();\n  const spaceId = useSpaceStore(s => s.space.id);\n  const { data, run, loading, mutate } = useRequest(\n    async ({ datasetID }: { datasetID: string }) => {\n      if (!datasetID) {\n        throw new CustomError(\n          'useDataSetDetailReq_error',\n          'datasetid cannot be empty',\n        );\n      }\n      try {\n        const res = await KnowledgeApi.DatasetDetail({\n          dataset_ids: [datasetID],\n          space_id: spaceId,\n        });\n        const curDatasetDetail = res?.dataset_details?.[datasetID];\n        if (curDatasetDetail) {\n          onSuccess?.(curDatasetDetail);\n          return curDatasetDetail;\n        }\n      } catch (error) {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: ReportEventNames.KnowledgeGetDataSetDeatil,\n          error: error as Error,\n        });\n      }\n    },\n    {\n      // No automatic request\n      manual: true,\n      onError: error => {\n        Toast.error({\n          content: I18n.t('Network_error'),\n          showClose: false,\n        });\n        capture(error);\n      },\n    },\n  );\n  return { data, run, loading, mutate };\n};\n\nexport const usePollingDatasetProcess = () => {\n  const capture = useErrorHandler();\n  const { addProcessingDataset, deleteProcessingDataset } = useProcessingStore(\n    useShallow(store => ({\n      addProcessingDataset: store.addProcessingDataset,\n      deleteProcessingDataset: store.deleteProcessingDataset,\n    })),\n  );\n  const spaceId = useSpaceStore(s => s.space.id);\n\n  const { run: startPollingProcess, cancel: cancelPollingProcess } = useRequest(\n    async ({ datasetID }: { datasetID: string }) => {\n      if (!datasetID) {\n        throw new CustomError(\n          'useDataSetDetailReq_error',\n          'datasetid cannot be empty',\n        );\n      }\n      try {\n        const res = await KnowledgeApi.DatasetDetail({\n          dataset_ids: [datasetID],\n          space_id: spaceId,\n        });\n        const curDatasetDetail = res?.dataset_details?.[datasetID];\n        if (\n          curDatasetDetail &&\n          // @ts-expect-error -- linter-disable-autofix\n          curDatasetDetail.processing_file_id_list?.length > 0\n        ) {\n          addProcessingDataset(datasetID);\n        } else {\n          deleteProcessingDataset(datasetID);\n          cancelPollingProcess();\n        }\n      } catch (error) {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: ReportEventNames.KnowledgeGetDataSetDeatil,\n          error: error as Error,\n        });\n      }\n    },\n    {\n      // No automatic request\n      manual: true,\n      pollingInterval: POLLING_TIME,\n      onError: error => {\n        Toast.error({\n          content: I18n.t('Network_error'),\n          showClose: false,\n        });\n        capture(error);\n      },\n    },\n  );\n  return {\n    startPollingProcess,\n    cancelPollingProcess,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\n\nimport { useDataSetDetailReq } from '@/service/dataset';\nexport const useGetKnowledgeType = () => {\n  const { datasetID = '' } = useKnowledgeParams();\n  // Knowledge Base Details\n  const { data: dataSetDetail, run: fetchDataSetDetail } =\n    useDataSetDetailReq();\n  const { setDataSetDetail, dataSetDetail: storeDataSetDetail } =\n    useKnowledgeStore(\n      useShallow(state => ({\n        setDataSetDetail: state.setDataSetDetail,\n        dataSetDetail: state.dataSetDetail,\n      })),\n    );\n\n  useEffect(() => {\n    if (storeDataSetDetail.dataset_id) {\n      return;\n    }\n    fetchDataSetDetail({ datasetID });\n  }, []);\n\n  useEffect(() => {\n    setDataSetDetail(dataSetDetail || {});\n    return () => {\n      setDataSetDetail({});\n    };\n  }, [dataSetDetail]);\n\n  return {\n    dataSetDetail,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { DocumentUpdateType, FormatType } from '@coze-arch/bot-api/memory';\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\n\nexport const MAX_SEGMENT_TOTAL = 10000;\nexport const CREATE_UNIT_DISABLE_UNIT_TYPES = [\n  UnitType.TABLE_GOOGLE_DRIVE,\n  UnitType.TABLE_FEISHU,\n  UnitType.TEXT_FEISHU,\n  UnitType.TEXT_LARK,\n  UnitType.TABLE_LARK,\n  UnitType.TEXT_GOOGLE_DRIVE,\n  UnitType.TEXT_DOC,\n  UnitType.TEXT_URL,\n  UnitType.TEXT_NOTION,\n  UnitType.TEXT_CUSTOM,\n];\nexport const CREATE_UNIT_DISABLE_FORMAT_TYPES = [FormatType.Text];\nexport enum ViewMode {\n  ContentView,\n  SegmentView,\n}\n\nexport const VIEW_MODE_OPTIONS = [\n  {\n    value: ViewMode.ContentView,\n    label: I18n.t('content_view_001'),\n  },\n  {\n    value: ViewMode.SegmentView,\n    label: I18n.t('content_view_002'),\n  },\n];\nexport enum SegmentOptSelect {\n  RENAME = 0,\n  UPDATE_CONTENT = 1,\n  UPDATE_FREQUENCY = 2,\n  DELETE = 4,\n  CONFIGURATION_TABLE_STRUCTURE = 5,\n  FETCH_SLICE = 6,\n  UPDATE_FREQUENCY_BATCH = 7,\n  APPEND_FREQUENCY = 8,\n  OPEN_SEARCH_CONFIG = 9,\n}\n\nexport const DOCUMENT_UPDATE_TYPE_MAP = {\n  [DocumentUpdateType.NoUpdate]: I18n.t('datasets_segment_tag_updateNo'),\n  [DocumentUpdateType.Cover]: I18n.t('datasets_segment_tag_overwrite'),\n  [DocumentUpdateType.Append]: I18n.t('datasets_segment_tag_overwriteNo'),\n} as const;\n\nexport { POLLING_TIME } from './polling';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { reportFailGetProgress } from '@coze-data/knowledge-resource-processor-base/utils';\nimport {\n  clearPolling,\n  isStopPolling,\n} from '@coze-data/knowledge-resource-processor-base';\nimport { KNOWLEDGE_MAX_DOC_SIZE } from '@coze-data/knowledge-modal-base';\nimport {\n  REPORT_EVENTS,\n  REPORT_EVENTS as ReportEventNames,\n} from '@coze-arch/report-events';\nimport { useErrorHandler } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport {\n  type PhotoDetailResponse,\n  type DocumentInfo,\n} from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { type ProgressMap } from '@/types';\nimport { POLLING_TIME } from '@/constant';\n\nexport const useListDocumentReq = (\n  onSuccess?: (res: DocumentInfo[] | undefined) => void,\n  onError?: () => void,\n) => {\n  const capture = useErrorHandler();\n  const { data, run, loading, mutate } = useRequest(\n    async ({\n      datasetID,\n      page,\n      size,\n    }: {\n      datasetID: string;\n      page?: number;\n      size?: number;\n    }) => {\n      if (!datasetID) {\n        throw new CustomError(\n          'useListDocumentReq_error',\n          'datasetid cannot be empty',\n        );\n      }\n      try {\n        const res = await KnowledgeApi.ListDocument({\n          dataset_id: datasetID,\n          page: page ?? 0,\n          size: size ?? KNOWLEDGE_MAX_DOC_SIZE,\n        });\n        if (res.document_infos) {\n          onSuccess?.(res.document_infos);\n          return res.document_infos;\n        }\n\n        capture(new CustomError('useListDataSetReq_error', res.msg || ''));\n      } catch (error) {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: ReportEventNames.KnowledgeGetDataSetDeatil,\n          error: error as Error,\n        });\n      }\n    },\n    {\n      // No automatic request\n      manual: true,\n      onError: error => {\n        Toast.error({\n          content: I18n.t('Network_error'),\n          showClose: false,\n        });\n        capture(error);\n      },\n    },\n  );\n  return { data, run, loading, mutate };\n};\n\nexport const usePollingTaskProgress = () => {\n  const pollingId = useRef<number>();\n  useEffect(\n    () => () => {\n      clearPolling(pollingId);\n    },\n    [],\n  );\n  const pollingTaskProgressInternal = (\n    documentIds: string[],\n    options: {\n      onProgressing: (progressMap: ProgressMap) => void;\n      onFinish: () => void;\n      isImage?: boolean;\n      dataSetId?: string;\n    },\n  ) => {\n    // An ongoing poll needs to be aborted before starting a new poll\n    if (pollingId.current) {\n      clearPolling(pollingId);\n    }\n\n    const fetchProgress = async () => {\n      const { data = [] } = await KnowledgeApi.GetDocumentProgress({\n        document_ids: documentIds,\n      });\n\n      let photoInfos: PhotoDetailResponse['photo_infos'];\n\n      // Check photo details separately\n      if (options.isImage) {\n        photoInfos = (\n          await KnowledgeApi.PhotoDetail({\n            document_ids: documentIds,\n            // @ts-expect-error -- linter-disable-autofix\n            dataset_id: options.dataSetId,\n          })\n        )?.photo_infos;\n      }\n      const updatedProgressMap = data.reduce((res, item) => {\n        // Add photo details separately\n        // @ts-expect-error -- linter-disable-autofix\n        const detail = photoInfos?.[item.document_id] || {};\n        // @ts-expect-error -- linter-disable-autofix\n        res[item.document_id] = {\n          status: item.status,\n          progress: item.progress,\n          ...detail,\n        };\n        return res as ProgressMap;\n      }, {}) as ProgressMap;\n\n      reportFailGetProgress(data);\n      options.onProgressing(updatedProgressMap);\n\n      if (isStopPolling(data)) {\n        options.onFinish();\n        clearPolling(pollingId);\n      }\n    };\n\n    // Execute once immediately\n    const immediatelyExecuteFunction = () => {\n      fetchProgress();\n      return fetchProgress;\n    };\n\n    pollingId.current = window.setInterval(\n      immediatelyExecuteFunction(),\n      POLLING_TIME,\n    );\n  };\n  return pollingTaskProgressInternal;\n};\nexport const useUpdateDocument = ({ onSuccess }) => {\n  const { run, loading } = useRequest(\n    async params => {\n      if (!params.document_id) {\n        throw new CustomError(\n          REPORT_EVENTS.KnowledgeUpdateDocumentName,\n          `${REPORT_EVENTS.KnowledgeUpdateDocumentName}: missing doc_id`,\n        );\n      }\n      await KnowledgeApi.UpdateDocument(params);\n    },\n    {\n      manual: true,\n      onSuccess: () => {\n        onSuccess();\n      },\n      onError: error => {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: REPORT_EVENTS.KnowledgeUpdateDocumentName,\n          error,\n        });\n      },\n    },\n  );\n  return { run, loading };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const POLLING_TIME = 5000; //ms\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\n\nimport { useListDocumentReq } from '@/service/document';\nimport { useDataSetDetailReq } from '@/service/dataset';\n\nexport const useReloadKnowledgeIDE = () => {\n  const { datasetID = '' } = useKnowledgeParams();\n  const {\n    run: fetchDataSetDetail,\n    loading: isDataSetLoading,\n    data: dataSetDetail,\n  } = useDataSetDetailReq();\n  const {\n    run: fetchDocumentList,\n    loading: isDocumentLoading,\n    data: documentList,\n  } = useListDocumentReq();\n\n  const { setDataSetDetail, setDocumentList } = useKnowledgeStore(\n    useShallow(state => ({\n      setDataSetDetail: state.setDataSetDetail,\n      setDocumentList: state.setDocumentList,\n    })),\n  );\n\n  // Monitor data changes and update store\n  useEffect(() => {\n    if (!isDataSetLoading && dataSetDetail) {\n      setDataSetDetail(dataSetDetail);\n    }\n  }, [dataSetDetail, isDataSetLoading]);\n\n  useEffect(() => {\n    if (!isDocumentLoading && documentList) {\n      setDocumentList(documentList);\n    }\n  }, [documentList, isDocumentLoading]);\n  return {\n    loading: isDataSetLoading || isDocumentLoading,\n    reload: () => {\n      fetchDataSetDetail({ datasetID });\n      fetchDocumentList({ datasetID });\n    },\n    reset: () => {\n      setDataSetDetail({});\n      setDocumentList([]);\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type BasicTarget } from 'ahooks/lib/utils/domTarget';\nimport { useInfiniteScroll, useRequest } from 'ahooks';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport {\n  REPORT_EVENTS,\n  REPORT_EVENTS as ReportEventNames,\n} from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport {\n  type CreateSliceRequest,\n  type ListSliceRequest,\n} from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { type ISliceInfo } from '@/types/slice';\n\nconst pageSize = 50;\nexport interface UseScrollListSliceReqParams {\n  params: ListSliceRequest;\n  onSuccess?: (res: DatasetDataScrollList | undefined) => void;\n  onError?: (e: Error) => void;\n  reloadDeps: unknown[];\n  target: BasicTarget;\n  ready?: boolean;\n  dataReady?: boolean;\n}\nexport interface DatasetDataScrollList {\n  list: ISliceInfo[];\n  total: number;\n  ready?: boolean;\n  hasMore?: boolean;\n}\nexport const useScrollListSliceReq = ({\n  params,\n  onSuccess,\n  onError,\n  reloadDeps = [],\n  target = null,\n  dataReady = true,\n}: UseScrollListSliceReqParams) => {\n  const { loading, data, loadingMore, mutate, cancel, reload, loadMore } =\n    useInfiniteScroll<DatasetDataScrollList>(\n      async d => {\n        if (!params.dataset_id && !params.document_id) {\n          return {\n            list: [],\n            total: 0,\n            hasMore: false,\n            ready: false,\n          };\n        }\n        const isAllType = !!params.dataset_id;\n        const lastSequence = d?.list?.length\n          ? d.list[d.list.length - 1].sequence\n          : undefined;\n        const extendParams = isAllType\n          ? {\n              document_id:\n                d && d?.list?.length\n                  ? d.list[d.list.length - 1].document_id\n                  : undefined,\n              sequence: lastSequence,\n            }\n          : {\n              sequence: lastSequence,\n            };\n\n        const resp = await KnowledgeApi.ListSlice({\n          ...extendParams,\n          page_size: String(pageSize),\n          ...params,\n        });\n        return {\n          list: resp?.slices || [],\n          total: Number(resp?.total ?? 0),\n          hasMore: resp?.hasmore,\n          ready: true,\n        };\n      },\n      {\n        isNoMore: res => Boolean(!res?.hasMore),\n        target,\n        onBefore: () => {\n          if (loadingMore || loading) {\n            cancel();\n          }\n        },\n        onSuccess,\n        onError,\n        reloadDeps,\n      },\n    );\n  return {\n    loading,\n    data,\n    loadingMore,\n    mutate,\n    cancel,\n    reload,\n    loadMore,\n    pageSize,\n  };\n};\n\nexport const delSlice = async (sliceIds: string[]) => {\n  if (!sliceIds || !sliceIds.length) {\n    throw new CustomError(\n      ReportEventNames.KnowledgeDeleteSlice,\n      `${ReportEventNames.KnowledgeDeleteSlice}: missing slice_id`,\n    );\n  }\n  await KnowledgeApi.DeleteSlice({\n    slice_ids: sliceIds,\n  });\n\n  return sliceIds;\n};\n\nexport const updateSlice = async (\n  sliceId: string,\n  updateContent: string,\n  updateValue?: string,\n) => {\n  if (!sliceId) {\n    throw new CustomError('normal_error', 'missing slice_id');\n  }\n  await KnowledgeApi.UpdateSlice({\n    slice_id: sliceId,\n    raw_text: updateContent,\n    table_unit_text: updateValue,\n  });\n  Toast.success(I18n.t('Update_success'));\n\n  return updateContent;\n};\nexport const useCreateSlice = ({ onReload }) => {\n  const { run: createSlice } = useRequest(\n    async (params: CreateSliceRequest) => {\n      if (!params.document_id) {\n        throw new CustomError('normal_error', 'missing doc_id');\n      }\n\n      const data = await KnowledgeApi.CreateSlice(params);\n      return {\n        ...data,\n        ...params,\n      };\n    },\n    {\n      manual: true,\n      onSuccess: data => {\n        Toast.success(I18n.t('Update_success'));\n        onReload({\n          document_id: data.document_id,\n          slice_id: data.slice_id,\n          sequence: '0',\n          content: data.raw_text ?? {},\n        });\n      },\n      onError: error => {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: REPORT_EVENTS.KnowledgeCreateSlice,\n          error,\n        });\n      },\n    },\n  );\n  return {\n    createSlice,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { DataErrorBoundary, DataNamespace } from '@coze-data/reporter';\nimport {\n  useDataCallbacks,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { useReportTti } from '@coze-arch/report-tti';\nimport { I18n } from '@coze-arch/i18n';\nimport { Layout } from '@coze-arch/coze-design';\nimport { renderHtmlTitle } from '@coze-arch/bot-utils';\nimport { type DocumentInfo, type Dataset } from '@coze-arch/bot-api/knowledge';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\n\nimport { type ProgressMap } from '@/types';\nimport { usePollingTaskProgress } from '@/service';\nimport { useReloadKnowledgeIDE } from '@/hooks/use-case/use-reload-knowledge-ide';\n\nimport {\n  type KnowledgeIDEBaseLayoutProps,\n  type KnowledgeRenderContext,\n} from '../module';\n\nexport const KnowledgeIDEBaseLayout = ({\n  keepDocTitle,\n  className,\n  renderNavBar,\n  renderContent,\n}: KnowledgeIDEBaseLayoutProps) => {\n  const { onUpdateDisplayName, onStatusChange } = useDataCallbacks();\n\n  const { setDataSetDetail, dataSetDetail, setDocumentList, documentList } =\n    useKnowledgeStore(\n      useShallow(state => ({\n        setDataSetDetail: state.setDataSetDetail,\n        dataSetDetail: state.dataSetDetail,\n        setDocumentList: state.setDocumentList,\n        documentList: state.documentList,\n      })),\n    );\n  const [progressMap, setProgressMap] = useState<ProgressMap>({});\n\n  const pollingTaskProgressInternal = usePollingTaskProgress();\n  const { reload, loading: isReloading, reset } = useReloadKnowledgeIDE();\n  // initialization\n  useEffect(() => {\n    reload();\n    return () => {\n      reset();\n    };\n  }, []);\n  // Callback to project IDE tab\n  useEffect(() => {\n    if (dataSetDetail?.name) {\n      onUpdateDisplayName?.(dataSetDetail.name);\n      onStatusChange?.('normal');\n    }\n  }, [dataSetDetail?.name]);\n  useReportTti({\n    isLive: !!documentList?.length,\n  });\n  useEffect(() => {\n    const progressIds = dataSetDetail?.processing_file_id_list;\n    if (progressIds && progressIds.length) {\n      pollingTaskProgressInternal(progressIds, {\n        onProgressing: res => {\n          setProgressMap(res);\n        },\n        onFinish: () => {\n          reload();\n        },\n        dataSetId: dataSetDetail?.dataset_id,\n        isImage: dataSetDetail?.format_type === FormatType.Image,\n      });\n    }\n  }, [dataSetDetail]);\n\n  // Build the rendering context\n  const renderContext: KnowledgeRenderContext = {\n    layoutProps: {\n      keepDocTitle,\n      renderContent,\n      renderNavBar,\n    },\n    dataInfo: {\n      dataSetDetail,\n      documentList,\n    },\n    statusInfo: {\n      isReloading,\n      progressMap,\n    },\n    dataActions: {\n      refreshData: reload,\n      updateDataSetDetail: (data: Dataset) => setDataSetDetail(data || {}),\n      updateDocumentList: (data: DocumentInfo[]) => setDocumentList(data || []),\n    },\n  };\n\n  // Editor Profile\n  return (\n    <DataErrorBoundary namespace={DataNamespace.KNOWLEDGE}>\n      <Layout\n        className={\n          className ||\n          'flex flex-col p-[24px] pt-[16px] gap-[16px] !bg-transparent '\n        }\n        title={renderHtmlTitle(\n          `${dataSetDetail?.name} - ${I18n.t('tab_dataset_list')}`,\n        )}\n        keepDocTitle={keepDocTitle}\n      >\n        {/* navigation bar */}\n        {renderNavBar?.(renderContext)}\n        {/* content area */}\n        {renderContent?.(renderContext)}\n      </Layout>\n    </DataErrorBoundary>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozDicumentOnline,\n  IconCozDocument,\n  IconCozGoogleDriveFill,\n  IconCozLarkFill,\n  IconCozNotionFill,\n  IconCozPencilPaper,\n  IconCozPlug,\n  IconCozWechatFill,\n} from '@coze-arch/coze-design/icons';\nimport { FormatType, type DocumentSource } from '@coze-arch/bot-api/knowledge';\n\nexport function isNoMore(data, pageSize) {\n  return Boolean(\n    !data?.total || (data.nextPageIndex - 1) * pageSize >= data.total,\n  );\n}\n\nexport function isStop(res) {\n  return res?.list?.length || res?.total;\n}\n\nexport const getResegmentType = (\n  formatType: FormatType,\n  sourceType?: DocumentSource,\n) => {\n  switch (formatType) {\n    case FormatType.Table: {\n      return 'table';\n    }\n    default:\n      return 'text';\n  }\n};\nexport const getBasicConfig = () => ({\n  [UnitType.IMAGE_FILE]: {\n    unitType: UnitType.IMAGE_FILE,\n    name: I18n.t('knowledge_photo_002'),\n    icon: <IconCozDocument className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TABLE_DOC]: {\n    unitType: UnitType.TABLE_DOC,\n    name: I18n.t('datasets_createFileModel_step1_TabLocalTitle'),\n    icon: <IconCozDocument className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TABLE_API]: {\n    unitType: UnitType.TABLE_API,\n    name: I18n.t('datasets_createFileModel_step1_apiTitle'),\n    icon: <IconCozPlug className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TABLE_CUSTOM]: {\n    unitType: UnitType.TABLE_CUSTOM,\n    name: I18n.t('dataset_detail_source_custom'),\n    icon: <IconCozPencilPaper className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TABLE_FEISHU]: {\n    unitType: UnitType.TABLE_FEISHU,\n    name: I18n.t('knowledge-3rd-party-feishu'),\n    icon: <IconCozLarkFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TABLE_LARK]: {\n    unitType: UnitType.TABLE_LARK,\n    name: I18n.t('Lark_00001'),\n    icon: <IconCozLarkFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TABLE_GOOGLE_DRIVE]: {\n    unitType: UnitType.TABLE_GOOGLE_DRIVE,\n    name: I18n.t('knowledge-3rd-party-google-drive'),\n    icon: <IconCozGoogleDriveFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_DOC]: {\n    unitType: UnitType.TEXT_DOC,\n    name: I18n.t('datasets_createFileModel_step1_TabLocalTitle'),\n    icon: <IconCozDocument className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_URL]: {\n    unitType: UnitType.TEXT_URL,\n    name: I18n.t('datasets_createFileModel_step1_urlTitle'),\n    icon: <IconCozDicumentOnline className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_EXTENSION]: {\n    unitType: UnitType.TEXT_EXTENSION,\n    name: I18n.t('datasets_createFileModel_step1_urlTitle'),\n    icon: <IconCozDicumentOnline className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_NOTION]: {\n    unitType: UnitType.TEXT_NOTION,\n    name: I18n.t('knowledge-3rd-party-notion'),\n    icon: <IconCozNotionFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_FEISHU]: {\n    unitType: UnitType.TEXT_FEISHU,\n    node: 'item',\n    name: I18n.t('knowledge-3rd-party-feishu'),\n    icon: <IconCozLarkFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_LARK]: {\n    unitType: UnitType.TEXT_LARK,\n    name: I18n.t('Lark_00001'),\n    icon: <IconCozLarkFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_GOOGLE_DRIVE]: {\n    unitType: UnitType.TEXT_GOOGLE_DRIVE,\n    name: I18n.t('knowledge-3rd-party-google-drive'),\n    icon: <IconCozGoogleDriveFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_CUSTOM]: {\n    unitType: UnitType.TEXT_CUSTOM,\n    name: I18n.t('dataset_detail_source_custom'),\n    icon: <IconCozPencilPaper className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n  [UnitType.TEXT_WECHAT]: {\n    unitType: UnitType.TEXT_WECHAT,\n    // @ts-expect-error -- no translation yet TODO: hzf\n    name: I18n.t(''),\n    icon: <IconCozWechatFill className=\"w-4 h-4 [&>path]:fill-current\" />,\n  },\n});\n\nexport function escapeHtml(unsafe: string): string {\n  return unsafe\n    .replace(/<(?!(img|table|tr|td|th)\\b[^>]*>|\\/(?:table|tr|td|th)>)/g, '&lt;')\n    .replace(/\\n/g, '<br />');\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport {\n  OptType,\n  UnitType,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { I18n } from '@coze-arch/i18n';\nimport { type DropDownMenuItemItem } from '@coze-arch/bot-semi/Dropdown';\nimport { FormatType, type DocumentInfo } from '@coze-arch/bot-api/knowledge';\nimport { DocumentSource } from '@coze-arch/bot-api/knowledge';\n\nimport { type ActionType } from '@/types';\n\nimport { getBasicConfig, getResegmentType } from './preview';\n\nexport const getUnitType = (doc: DocumentInfo) => {\n  if (doc.format_type === FormatType.Text) {\n    if (doc.source_type === DocumentSource.Document) {\n      return UnitType.TEXT_DOC;\n    }\n    if (doc.source_type === DocumentSource.Web) {\n      return UnitType.TEXT_URL;\n    }\n    if (doc.source_type === DocumentSource.Custom) {\n      return UnitType.TEXT_CUSTOM;\n    }\n    if (doc.source_type === DocumentSource.FrontCrawl) {\n      return UnitType.TEXT_EXTENSION;\n    }\n    if (doc.source_type === DocumentSource.Notion) {\n      return UnitType.TEXT_NOTION;\n    }\n    if (doc.source_type === DocumentSource.GoogleDrive) {\n      return UnitType.TEXT_GOOGLE_DRIVE;\n    }\n    if (doc.source_type === DocumentSource.FeishuWeb) {\n      return UnitType.TEXT_FEISHU;\n    }\n    if (doc.source_type === DocumentSource.LarkWeb) {\n      return UnitType.TEXT_LARK;\n    }\n    if (doc.source_type === DocumentSource.WeChat) {\n      return UnitType.TEXT_WECHAT;\n    }\n  }\n  if (doc.format_type === FormatType.Table) {\n    if (doc.source_type === DocumentSource.Document) {\n      return UnitType.TABLE_DOC;\n    }\n    if (doc.source_type === DocumentSource.Web) {\n      return UnitType.TABLE_API;\n    }\n    if (doc.source_type === DocumentSource.Custom) {\n      return UnitType.TABLE_CUSTOM;\n    }\n    if (doc.source_type === DocumentSource.GoogleDrive) {\n      return UnitType.TABLE_GOOGLE_DRIVE;\n    }\n    if (doc.source_type === DocumentSource.FeishuWeb) {\n      return UnitType.TABLE_FEISHU;\n    }\n    if (doc.source_type === DocumentSource.LarkWeb) {\n      return UnitType.TABLE_LARK;\n    }\n  }\n  return UnitType.TEXT_URL;\n};\nexport const DOCUMENT_SOURCE_TYPE_MAP: Record<DocumentSource, string> = {\n  [DocumentSource.Document]: I18n.t('dataset_detail_source_local'),\n  [DocumentSource.Web]: I18n.t('dataset_detail_source_online'),\n  [DocumentSource.Custom]: I18n.t('dataset_detail_source_custom'),\n  [DocumentSource.ThirdParty]: '', // Todo three-way, the backend idl has this type, but no i18n.\n  [DocumentSource.FrontCrawl]: I18n.t('dataset_detail_source_online'),\n  [DocumentSource.GoogleDrive]: I18n.t('knowledge-3rd-party-google-drive'),\n  [DocumentSource.Notion]: I18n.t('knowledge-3rd-party-notion'),\n  [DocumentSource.FeishuWeb]: I18n.t('knowledge-3rd-party-feishu'),\n  [DocumentSource.LarkWeb]: I18n.t('Lark_00001'),\n  [DocumentSource.OpenApi]: I18n.t('dataset_detail_source_custom'),\n  [DocumentSource.WeChat]: I18n.t('knowledge_weixin_001'),\n};\n\n/**\n * Get source name\n */\nexport const getSourceName = (docInfo: DocumentInfo) => {\n  const { format_type: formatType, source_type: sourceType } = docInfo || {};\n  if (formatType === FormatType.Table && sourceType === DocumentSource.Web) {\n    return 'Api';\n    // If it is a third-party data source\n  }\n  return DOCUMENT_SOURCE_TYPE_MAP[sourceType || 0] || '-';\n};\n\nexport const getFormatTypeFromUnitType = (type: UnitType) => {\n  switch (type) {\n    case UnitType.TABLE:\n    case UnitType.TABLE_API:\n    case UnitType.TABLE_DOC:\n    case UnitType.TABLE_CUSTOM:\n    case UnitType.TABLE_FEISHU:\n    case UnitType.TABLE_GOOGLE_DRIVE:\n      return FormatType.Table;\n    case UnitType.IMAGE:\n      return FormatType.Image;\n    default:\n      return FormatType.Text;\n  }\n};\n\ninterface JumpToResegmentUrlParams {\n  spaceID: string;\n  datasetID: string;\n  formatType: FormatType;\n  docID?: string;\n  sourceType?: DocumentSource;\n}\ninterface JumpToAddDocParams {\n  spaceID: string;\n  datasetID: string;\n  formatType: FormatType;\n  docID?: string;\n  type?: UnitType;\n  /** The function is to bring the Douyin mark in the url when jumping to the upload page to distinguish the views on the upload page */\n  isDouyinBot?: boolean;\n}\n\nexport const jumpToResegmentUrl = (\n  params: JumpToResegmentUrlParams,\n  jump: (url: string) => void,\n) => {\n  jump(\n    `/space/${params.spaceID}/knowledge/${\n      params.datasetID\n    }/upload?type=${getResegmentType(\n      params?.formatType,\n      params?.sourceType,\n    )}&opt=${OptType.RESEGMENT}${\n      params?.docID ? `&doc_id=${params?.docID}` : ''\n    }`,\n  );\n};\n\nexport const getAddContentUrl = ({\n  spaceID,\n  datasetID,\n  type,\n  docID,\n  formatType,\n  pageMode,\n  botId,\n  actionType,\n  isDouyinBot,\n}: JumpToAddDocParams & {\n  pageMode?: string;\n  botId?: string;\n  actionType?: ActionType;\n}) => {\n  const baseUrl = `/space/${spaceID}/knowledge/${datasetID}/upload`;\n\n  const queryParams: Record<string, string> = { type: type ?? '' };\n\n  if (formatType === FormatType.Table && docID) {\n    queryParams.opt = OptType.INCREMENTAL;\n    queryParams.doc_id = docID;\n  }\n\n  if (pageMode) {\n    queryParams.page_mode = pageMode;\n  }\n\n  if (botId) {\n    queryParams.bot_id = botId;\n  }\n\n  if (actionType) {\n    queryParams.action_type = actionType;\n  }\n\n  if (isDouyinBot) {\n    queryParams.is_douyin = 'true';\n  }\n\n  const params = new URLSearchParams(queryParams);\n\n  return `${baseUrl}?${params.toString()}`;\n};\n\nexport const jumpToAddDocUrl = (\n  params: JumpToAddDocParams,\n  jump: (url: string) => void,\n) => {\n  jump(getAddContentUrl(params));\n};\n\nexport const getAddContentMenu = ({\n  documentList,\n  formatType,\n  publicConfig,\n  isGoogleEnabled,\n  isFeishuEnabled,\n  isNotionEnabled,\n  isLarkEnabled,\n  isWechatEnabled,\n}: {\n  documentList: DocumentInfo[];\n  formatType: FormatType;\n  publicConfig: Omit<Partial<DropDownMenuItemItem>, 'onClick'> & {\n    onClick: (unitType: UnitType) => void;\n  };\n  isGoogleEnabled: boolean;\n  isNotionEnabled: boolean;\n  isFeishuEnabled: boolean;\n  isLarkEnabled: boolean;\n  isWechatEnabled: boolean;\n}): (DropDownMenuItemItem & {\n  unitType: UnitType;\n})[] => {\n  const { onClick } = publicConfig;\n  const basicConfig = getBasicConfig();\n  let validOptions = [];\n  switch (formatType) {\n    case FormatType.Image: {\n      // @ts-expect-error -- linter-disable-autofix\n      validOptions = [UnitType.IMAGE_FILE];\n      break;\n    }\n    case FormatType.Table: {\n      if (documentList?.length > 0) {\n        validOptions = [\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_DOC,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_API,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_CUSTOM,\n        ];\n      } else {\n        validOptions = [\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_DOC,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_API,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_FEISHU,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_LARK,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_GOOGLE_DRIVE,\n          // @ts-expect-error -- linter-disable-autofix\n          UnitType.TABLE_CUSTOM,\n        ];\n      }\n\n      break;\n    }\n    default:\n      validOptions = [\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_DOC,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_URL,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_FEISHU,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_WECHAT,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_NOTION,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_LARK,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_GOOGLE_DRIVE,\n        // @ts-expect-error -- linter-disable-autofix\n        UnitType.TEXT_CUSTOM,\n      ];\n  }\n  return validOptions\n    .filter(value => {\n      if (\n        value === UnitType.TABLE_GOOGLE_DRIVE ||\n        value === UnitType.TEXT_GOOGLE_DRIVE\n      ) {\n        return isGoogleEnabled;\n      }\n      if (value === UnitType.TEXT_NOTION) {\n        return isNotionEnabled;\n      }\n      if (value === UnitType.TEXT_FEISHU || value === UnitType.TABLE_FEISHU) {\n        return isFeishuEnabled;\n      }\n      if (value === UnitType.TEXT_LARK || value === UnitType.TABLE_LARK) {\n        return isLarkEnabled;\n      }\n      if (value === UnitType.TEXT_WECHAT) {\n        return isWechatEnabled;\n      }\n      return true;\n    })\n    .map(item => ({\n      // @ts-expect-error -- linter-disable-autofix\n      'data-dtestid': `${KnowledgeE2e.SegmentDetailDropdownItem}.${basicConfig[item].name}`,\n      node: 'item',\n      // @ts-expect-error -- linter-disable-autofix\n      ...basicConfig[item],\n      ...publicConfig,\n      // @ts-expect-error -- linter-disable-autofix\n      onClick: () => onClick(basicConfig[item]?.unitType),\n    })) as unknown as (DropDownMenuItemItem & {\n    unitType: UnitType;\n  })[];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { type ILevelSegment } from '@coze-data/knowledge-stores';\nimport { type DocumentChunk } from '@coze-data/knowledge-common-components/text-knowledge-editor/scenes/base';\nimport { type LevelDocumentChunk } from '@coze-data/knowledge-common-components/text-knowledge-editor';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tag, Tooltip, Typography } from '@coze-arch/coze-design';\nimport { type OptionProps } from '@coze-arch/bot-semi/Select';\nimport {\n  DocumentStatus,\n  type DocumentInfo,\n  type SliceInfo,\n} from '@coze-arch/bot-api/knowledge';\n\nimport { getBasicConfig } from '@/utils/preview';\nimport { getUnitType } from '@/utils';\nimport { type ProgressMap } from '@/types';\n\nconst FINISH_PROGRESS = 100;\n\n/**\n * Create base document block\n */\nexport const createBaseDocumentChunkBySliceInfo = (\n  props: SliceInfo,\n): DocumentChunk => ({\n  text_knowledge_editor_chunk_uuid: nanoid(),\n  ...props,\n});\n\n/**\n * Create hierarchical document blocks\n */\nexport const createLevelDocumentChunkByLevelSegment = (\n  props: ILevelSegment,\n): LevelDocumentChunk => ({\n  text_knowledge_editor_chunk_uuid: nanoid(),\n  sequence: props.slice_sequence?.toString(),\n  content: props.text,\n  ...props,\n});\n\n/**\n * Get document options\n */\nexport const getDocumentOptions = (\n  documentList: DocumentInfo[],\n  progressMap: ProgressMap = {},\n): OptionProps[] => {\n  const basicConfig = getBasicConfig();\n  return documentList.map(doc => {\n    const unitType = getUnitType({\n      format_type: doc?.format_type,\n      source_type: doc?.source_type,\n    });\n    const config = basicConfig[unitType];\n\n    return {\n      value: doc.document_id,\n      text: doc.name,\n      label: (\n        <div\n          className=\"flex flex-row items-center justify-center max-w-[603px] coz-fg-primary\"\n          key={doc?.document_id}\n        >\n          <div className=\"flex text-[16px]\">{config?.icon}</div>\n          <Typography.Text\n            ellipsis={{ showTooltip: { opts: { theme: 'dark' } } }}\n            fontSize=\"14px\"\n            className=\"w-full grow truncate ml-[8px]\"\n          >\n            {doc.name}\n          </Typography.Text>\n\n          <div className=\"flex items-center shrink-0 ml-[4px]\">\n            {Object.keys(progressMap).includes(doc?.document_id ?? '') &&\n            progressMap?.[doc?.document_id ?? '']?.progress <\n              FINISH_PROGRESS ? (\n              <Tag color=\"blue\" size=\"mini\" className=\"font-medium\">\n                {I18n.t('datasets_segment_tag_processing')}\n                {` ${progressMap[doc?.document_id ?? '']?.progress}%`}\n              </Tag>\n            ) : null}\n            {doc?.status === DocumentStatus.Failed ? (\n              <Tooltip theme=\"dark\" content={doc?.status_descript}>\n                <IconCozInfoCircle className=\"coz-fg-hglt-red\" />\n              </Tooltip>\n            ) : null}\n          </div>\n        </div>\n      ),\n    };\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport {\n  useDeleteUnitModal,\n  useUpdateFrequencyModal,\n} from '@coze-data/knowledge-modal-base';\nimport {\n  type FormatType,\n  type DocumentSource,\n  type UpdateType,\n} from '@coze-arch/bot-api/knowledge';\n\nexport interface UseModalsProps {\n  docId?: string;\n  documentType?: FormatType;\n  documentSource?: DocumentSource;\n  onDelete?: () => void;\n  onUpdateFrequency?: (formData: {\n    updateInterval?: number;\n    updateType?: UpdateType;\n  }) => void;\n}\n\nexport interface UseModalsReturn {\n  deleteModalNode: ReactNode;\n  showDeleteModal: () => void;\n  updateFrequencyModalNode: ReactNode;\n  showUpdateFrequencyModal: (params: {\n    updateInterval?: number;\n    updateType?: UpdateType;\n  }) => void;\n}\n\nexport const useModals = (props: UseModalsProps): UseModalsReturn => {\n  const { docId, documentType, documentSource, onDelete, onUpdateFrequency } =\n    props;\n\n  // Delete modal box\n  const { node: deleteModalNode, delete: showDeleteModal } = useDeleteUnitModal(\n    {\n      docId,\n      onDel: () => {\n        onDelete?.();\n      },\n    },\n  );\n\n  // Update frequency mode box\n  const { node: updateFrequencyModalNode, edit: showUpdateFrequencyModal } =\n    useUpdateFrequencyModal({\n      docId,\n      onFinish: formData => {\n        onUpdateFrequency?.(formData);\n      },\n      type: documentType,\n      documentSource,\n    });\n\n  return {\n    deleteModalNode,\n    showDeleteModal,\n    updateFrequencyModalNode,\n    showUpdateFrequencyModal,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { UpdateType } from '@coze-arch/bot-api/knowledge';\n\nimport { useUpdateDocument } from '@/service/document';\n\nexport const useDocumentManagement = (props?: {\n  reloadDataset?: () => void;\n}) => {\n  const { curDocId, setCurDocId, documentList } = useKnowledgeStore(\n    useShallow(state => ({\n      curDocId: state.curDocId,\n      setCurDocId: state.setCurDocId,\n      documentList: state.documentList,\n    })),\n  );\n\n  // Cache the previous document ID for rollback after load failure\n  const prevDocIdRef = useRef<string | null>(null);\n\n  // Update document name\n  const { run: updateDocument } = useUpdateDocument({\n    onSuccess: () => {\n      Toast.success(I18n.t('Update_success'));\n      props?.reloadDataset?.();\n    },\n  });\n\n  // Select document\n  const handleSelectDocument = (docId: string) => {\n    prevDocIdRef.current = curDocId || null;\n    setCurDocId(docId);\n  };\n\n  // rename document\n  const handleRenameDocument = (docId: string, newName: string) => {\n    updateDocument({\n      document_id: docId,\n      document_name: newName,\n    });\n  };\n\n  // Update document frequency\n  const handleUpdateDocumentFrequency = (\n    docId: string,\n    formData: { updateInterval?: number; updateType?: UpdateType },\n  ) => {\n    if (!documentList) {\n      return;\n    }\n\n    const updatedDocList = documentList.map(doc => {\n      if (doc.document_id === docId) {\n        return {\n          ...doc,\n          update_interval: formData?.updateInterval,\n          update_type: formData.updateInterval\n            ? UpdateType.Cover\n            : UpdateType.NoUpdate,\n        };\n      }\n      return doc;\n    });\n\n    return updatedDocList;\n  };\n\n  // Rollback document selection\n  const rollbackDocumentSelection = () => {\n    if (prevDocIdRef.current) {\n      setCurDocId(prevDocIdRef.current);\n    }\n  };\n\n  return {\n    prevDocIdRef,\n    updateDocument,\n    handleSelectDocument,\n    handleRenameDocument,\n    handleUpdateDocumentFrequency,\n    rollbackDocumentSelection,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\n\nimport { useDocumentManagement } from './use-document-management';\n\nexport const useInitSelectFirstDoc = () => {\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const { handleSelectDocument } = useDocumentManagement();\n  useEffect(() => {\n    if (documentList?.length) {\n      handleSelectDocument(documentList[0]?.document_id ?? '');\n    }\n  }, [documentList]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nexport const useFilePreview = (curDocId: string) => {\n  const [showOriginalFile, setShowOriginalFile] = useState(false);\n\n  // Reset the preview state when switching documents\n  useEffect(() => {\n    if (showOriginalFile) {\n      setShowOriginalFile(false);\n    }\n  }, [curDocId]);\n\n  const handleToggleOriginalFile = (checked: boolean) => {\n    setShowOriginalFile(checked);\n  };\n\n  return {\n    showOriginalFile,\n    handleToggleOriginalFile,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { DocumentStatus } from '@coze-arch/bot-api/knowledge';\n\nimport { type ProgressMap } from '@/types';\n\n/**\n * Hooks that handle basic information about documents\n */\nexport const useDocumentInfo = (progressMap: ProgressMap) => {\n  const { documentList, dataSetDetail, curDocId } = useKnowledgeStore(\n    useShallow(state => ({\n      curDocId: state.curDocId,\n      documentList: state.documentList,\n      dataSetDetail: state.dataSetDetail,\n    })),\n  );\n\n  // current document\n  const curDoc = documentList?.find(i => i.document_id === curDocId);\n\n  // processing state\n  const isProcessing = curDoc?.status === DocumentStatus.Processing;\n  const processFinished = curDocId\n    ? progressMap[curDocId]?.status === DocumentStatus.Enable\n    : false;\n\n  // Dataset ID\n  const datasetId = dataSetDetail?.dataset_id ?? '';\n\n  return {\n    curDoc,\n    curDocId,\n    isProcessing,\n    processFinished,\n    datasetId,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { type BasicTarget } from 'ahooks/lib/utils/domTarget';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { type DocumentChunk } from '@coze-data/knowledge-common-components/text-knowledge-editor/scenes/base';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { ChunkType } from '@coze-arch/bot-api/knowledge';\n\nimport { useScrollListSliceReq } from '@/service';\n\nimport { createBaseDocumentChunkBySliceInfo } from '../../utils/document-utils';\n\ninterface UseSliceDataParams {\n  curDocId: string;\n  datasetId: string;\n  curChunkType?: ChunkType;\n  processFinished: boolean;\n  target?: BasicTarget;\n  rollbackDocumentSelection: () => void;\n}\n\n/**\n * Hooks for processing document fragment data acquisition\n */\nexport const useSliceData = ({\n  curDocId,\n  datasetId,\n  curChunkType,\n  processFinished,\n  target,\n  rollbackDocumentSelection,\n}: UseSliceDataParams) => {\n  const { searchValue } = useKnowledgeStore(\n    useShallow(state => ({\n      searchValue: state.searchValue,\n    })),\n  );\n\n  // Get document content\n  const {\n    loading,\n    data: sliceData,\n    mutate,\n    reload,\n  } = useScrollListSliceReq({\n    target,\n    params: {\n      keyword: searchValue,\n      document_id:\n        // If it is a hierarchical segmentation, it is not requested.\n        curChunkType !== ChunkType.LevelChunk ? curDocId : '',\n    },\n    reloadDeps: [searchValue, curDocId, datasetId, processFinished],\n    onError: error => {\n      /** When pulling a slice fails, roll back curDocId to avoid inconsistencies between the document title and content, and user confusion */\n      dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n        eventName: ReportEventNames.KnowledgeGetSliceList,\n        error,\n      });\n\n      Toast.error(I18n.t('knowledge_document_view'));\n      rollbackDocumentSelection();\n    },\n  });\n\n  // Use useMemo to cache the chunks array to avoid unnecessary recreations due to progressMap updates\n  const renderData = useMemo(\n    () =>\n      sliceData?.list.map(item => createBaseDocumentChunkBySliceInfo(item)) ??\n      [],\n    [sliceData?.list],\n  );\n\n  // Handling content changes\n  const handleContentChange = (chunks: DocumentChunk[]) => {\n    mutate({\n      ...sliceData,\n      list: chunks,\n      total: Number(sliceData?.total ?? '0'),\n    });\n  };\n\n  return {\n    loading,\n    sliceData,\n    renderData,\n    handleContentChange,\n    reload,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useMemo, useEffect } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { type ILevelSegment } from '@coze-data/knowledge-stores';\nimport { useTosContent } from '@coze-data/knowledge-common-hooks';\nimport { withTitle } from '@coze-data/knowledge-common-components/text-knowledge-editor/scenes/level';\nimport { ChunkType, type DocumentInfo } from '@coze-arch/bot-api/knowledge';\n\nimport { createLevelDocumentChunkByLevelSegment } from '../../utils/document-utils';\n\ninterface UseLevelSegmentsParams {\n  curDoc?: DocumentInfo;\n}\n\n/**\n * Hooks for processing hierarchical segmented data\n */\nexport const useLevelSegments = ({ curDoc }: UseLevelSegmentsParams) => {\n  // Scroll selected for hierarchical segmentation\n  const [selectionIDs, setSelectionIDs] = useState<string[]>([]);\n\n  const { levelSegments, setLevelSegments } = useKnowledgeStore(\n    useShallow(state => ({\n      levelSegments: state.levelSegments,\n      setLevelSegments: state.setLevelSegments,\n    })),\n  );\n\n  // Get a list of hierarchical segments and slices\n  const { content: treeContent, loading: tosLoading } = useTosContent(\n    curDoc?.chunk_strategy?.chunk_type === ChunkType.LevelChunk\n      ? curDoc?.doc_tree_tos_url\n      : undefined,\n  );\n\n  // Use useMemo to cache hierarchical segmented data after conversion\n  const renderLevelSegmentsData = useMemo(\n    () =>\n      levelSegments.map(item => createLevelDocumentChunkByLevelSegment(item)),\n    [levelSegments],\n  );\n\n  // Handling hierarchy segmentation changes\n  const handleLevelSegmentsChange = (chunks: ILevelSegment[]) => {\n    setLevelSegments(chunks);\n  };\n\n  // Handling deletion of hierarchical segmentation\n  const handleLevelSegmentDelete = (chunk: ILevelSegment) => {\n    setLevelSegments(\n      levelSegments.filter(item => item.slice_id !== chunk.slice_id),\n    );\n  };\n\n  // Load hierarchical segmentation during initialization\n  useEffect(() => {\n    setLevelSegments(withTitle(treeContent?.chunks ?? [], curDoc?.name ?? ''));\n  }, [treeContent]);\n\n  return {\n    levelSegments,\n    renderLevelSegmentsData,\n    selectionIDs,\n    setSelectionIDs,\n    tosLoading,\n    handleLevelSegmentsChange,\n    handleLevelSegmentDelete,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\n\n/**\n * Hooks that handle document fragment counting\n */\nexport const useSliceCounter = () => {\n  const { dataSetDetail, setDataSetDetail } = useKnowledgeStore(\n    useShallow(state => ({\n      dataSetDetail: state.dataSetDetail,\n      setDataSetDetail: state.setDataSetDetail,\n    })),\n  );\n\n  // Update count when processing added blocks\n  const handleIncreaseSliceCount = () => {\n    if (!dataSetDetail) {\n      return;\n    }\n\n    setDataSetDetail({\n      ...dataSetDetail,\n      slice_count:\n        // @ts-expect-error -- linter-disable-autofix\n        dataSetDetail.slice_count > -1\n          ? // @ts-expect-error -- linter-disable-autofix\n            dataSetDetail.slice_count + 1\n          : 0,\n    });\n  };\n\n  // Update count when processing deleted blocks\n  const handleDecreaseSliceCount = () => {\n    if (!dataSetDetail) {\n      return;\n    }\n\n    setDataSetDetail({\n      ...dataSetDetail,\n      slice_count:\n        // @ts-expect-error -- linter-disable-autofix\n        dataSetDetail.slice_count > -1\n          ? // @ts-expect-error -- linter-disable-autofix\n            dataSetDetail.slice_count - 1\n          : 0,\n    });\n  };\n\n  return {\n    handleIncreaseSliceCount,\n    handleDecreaseSliceCount,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Space, Tag } from '@coze-arch/coze-design';\nimport {\n  ChunkType,\n  DocumentSource,\n  FormatType,\n  type DocumentInfo,\n} from '@coze-arch/bot-api/knowledge';\n\nimport { getSourceName } from '@/utils';\nimport { DOCUMENT_UPDATE_TYPE_MAP } from '@/constant';\n\nimport styles from '../styles/index.module.less';\n\nexport interface DocTagProps {\n  documentInfo?: DocumentInfo;\n}\n\nexport const DocTag: React.FC<DocTagProps> = ({ documentInfo }) => {\n  const updateFrequencyStr = useMemo(() => {\n    let str: string = DOCUMENT_UPDATE_TYPE_MAP[documentInfo?.update_type ?? ''];\n    if (documentInfo?.update_interval) {\n      str = `${I18n.t('datasets_segment_tag_updateFrequency', {\n        num: documentInfo.update_interval,\n      })}`;\n    }\n    return str;\n  }, [documentInfo]);\n\n  if (!documentInfo) {\n    return null;\n  }\n\n  const renderSegmentTag = () => {\n    const { format_type, chunk_strategy } = documentInfo;\n    if (format_type !== FormatType.Text || !chunk_strategy) {\n      return null;\n    }\n    if (chunk_strategy.chunk_type === ChunkType.CustomChunk) {\n      return (\n        <Tag color=\"primary\" size=\"mini\">\n          {I18n.t('datasets_segment_tag_custom')}\n        </Tag>\n      );\n    }\n    if (chunk_strategy.chunk_type === ChunkType.LevelChunk) {\n      return (\n        <Tag color=\"primary\" size=\"mini\">\n          {I18n.t('knowledge_level_016')}\n        </Tag>\n      );\n    }\n    return (\n      <Tag color=\"primary\" size=\"mini\">\n        {I18n.t('datasets_segment_tag_auto')}\n      </Tag>\n    );\n  };\n\n  return (\n    <Space className={styles['doc-tag-wrapper']} spacing={4}>\n      <Tag color=\"primary\" size=\"mini\">\n        {getSourceName(documentInfo)}\n      </Tag>\n      {documentInfo.source_type === DocumentSource.Web && (\n        <Tag color=\"primary\" size=\"mini\">\n          {updateFrequencyStr}\n        </Tag>\n      )}\n      {renderSegmentTag()}\n    </Space>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { useState } from 'react';\n\nimport classNames from 'classnames';\nimport { useDebounceFn } from 'ahooks';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit } from '@coze-arch/coze-design/icons';\nimport {\n  Popover,\n  Select,\n  Tooltip,\n  Button,\n  TextArea,\n  Search,\n} from '@coze-arch/coze-design';\nimport { type OptionProps } from '@coze-arch/bot-semi/Select';\nimport { type FormatType } from '@coze-arch/bot-api/knowledge';\n\nimport styles from '../styles/index.module.less';\n\nexport interface DocSelectorProps<T> {\n  type: FormatType;\n  options: OptionProps[];\n  value: T;\n  canEdit?: boolean;\n  onChange: (v: T) => void;\n  onRename: (docId: string, newName: string) => void;\n}\n\nconst DOC_NAME_MAX_LEN = 100;\nexport const DocSelector = ({\n  type,\n  options,\n  value,\n  onChange,\n  canEdit,\n  onRename,\n}: DocSelectorProps<typeof value>) => {\n  const [search, setSearch] = useState('');\n  const [searchValue, setSearchValue] = useState('');\n  const [docName, setDocName] = useState('');\n  const [visible, setVisible] = useState(false);\n  const [loading, setLoading] = useState(false);\n\n  const debounceSetSearch = useDebounceFn(\n    (v?: string) => {\n      setSearchValue(v || '');\n    },\n    {\n      wait: 300,\n    },\n  );\n\n  const handledOptions = options.filter(op => {\n    if (!searchValue) {\n      return true;\n    }\n    try {\n      const regx = new RegExp(searchValue);\n      // Search results do not show the \"All Content\" option\n      return (\n        (op.value !== 'all' && op.value === value) ||\n        (op?.text as string)?.match(regx)\n      );\n    } catch (e) {\n      return true;\n    }\n  });\n\n  const setDocNameFn = () => {\n    const name = options.find(op => op.value === value)?.text;\n    if (name) {\n      setDocName(name as string);\n    }\n  };\n\n  const handleEditDocName = e => {\n    e.stopPropagation();\n    setVisible(true);\n  };\n\n  const handleSaveDocName = () => {\n    if (!docName) {\n      return;\n    }\n    setLoading(true);\n\n    try {\n      onRename(value as string, docName);\n      setVisible(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const triggerRender = ({ value: values }) => (\n    <Popover\n      clickToHide={true}\n      visible={visible}\n      onClickOutSide={() => setVisible(false)}\n      trigger=\"custom\"\n      style={{ padding: 16, width: 320 }}\n      onVisibleChange={v => {\n        if (v) {\n          setDocNameFn();\n        }\n      }}\n      content={\n        <div\n          className={styles['edit-doc-name-container']}\n          onClick={e => e.stopPropagation()}\n        >\n          <div className={styles['edit-doc-name-container-title']}>\n            {I18n.t('knowledge_detail_doc_rename')}\n          </div>\n          <div className={styles['edit-doc-name-container-input']}>\n            <TextArea\n              value={docName}\n              maxLength={DOC_NAME_MAX_LEN}\n              maxCount={DOC_NAME_MAX_LEN}\n              validateStatus={!docName ? 'error' : 'default'}\n              placeholder={I18n.t('knowledge_upload_text_custom_doc_name_tips')}\n              onChange={v => setDocName(v)}\n            />\n            {!docName && (\n              <div className={styles['edit-doc-name-container-input-error']}>\n                {I18n.t('knowledge_upload_text_custom_doc_name_tips')}\n              </div>\n            )}\n          </div>\n          <div className=\"text-right\">\n            <Button\n              disabled={!docName}\n              onClick={handleSaveDocName}\n              size=\"small\"\n              loading={loading}\n            >\n              {I18n.t('Save')}\n            </Button>\n          </div>\n        </div>\n      }\n      position=\"bottomLeft\"\n    >\n      <div\n        onClick={() => {\n          setVisible(false);\n        }}\n        className={styles['doc-selector-trigger']}\n        data-testid={KnowledgeE2e.SegmentDetailContentSelectTrigger}\n      >\n        <div className={styles['doc-selector-trigger-label']}>\n          {values.map(item => (\n            <div key={item.value}>{item.label}</div>\n          ))}\n        </div>\n        {!canEdit || !value ? null : (\n          <div>\n            <Tooltip\n              clickToHide\n              theme=\"dark\"\n              content={I18n.t('knowledge_detail_doc_rename')}\n            >\n              <div\n                className={styles['doc-selector-trigger-icon']}\n                onClick={handleEditDocName}\n                data-testid={\n                  KnowledgeE2e.SegmentDetailContentSelectTriggerEditIcon\n                }\n              >\n                <IconCozEdit className={'text-[14px]'} />\n              </div>\n            </Tooltip>\n          </div>\n        )}\n      </div>\n    </Popover>\n  );\n\n  return (\n    <Select\n      clickToHide={true}\n      maxHeight={670}\n      disabled\n      className={classNames(styles['doc-selector'])}\n      dropdownClassName={styles['doc-selector-dropdown']}\n      optionList={handledOptions}\n      value={value}\n      onChange={onChange}\n      getPopupContainer={() => document.body}\n      triggerRender={triggerRender}\n      innerTopSlot={\n        <Search\n          value={search}\n          placeholder={I18n.t('datasets_placeholder_search')}\n          onChange={v => {\n            setSearch(v);\n          }}\n          onSearch={v => {\n            logger.info({\n              message: 'onSearch',\n              meta: { v },\n            });\n            debounceSetSearch.run(v);\n          }}\n        />\n      }\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n\nimport { type ReactNode } from 'react';\n\nimport classnames from 'classnames';\nimport { isFeishuOrLarkDocumentSource } from '@coze-data/utils';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozAdjust,\n  IconCozHistory,\n  IconCozTrashCan,\n} from '@coze-arch/coze-design/icons';\nimport { Space, Tooltip, IconButton, Switch } from '@coze-arch/coze-design';\nimport { type OptionProps } from '@coze-arch/bot-semi/Select';\nimport {\n  DocumentSource,\n  FormatType,\n  type DocumentInfo,\n} from '@coze-arch/bot-api/knowledge';\n\nimport { DocTag } from './doc-tag';\nimport { DocSelector } from './doc-selector';\n\n// Documentation basic information\nexport interface DocumentData {\n  curDoc?: DocumentInfo;\n  curDocId: string;\n  curFormatType?: FormatType;\n  docOptions: OptionProps[];\n}\n\n// File preview related\nexport interface FilePreviewData {\n  showOriginalFile: boolean;\n  fileUrl?: string;\n}\n\n// document action callback\nexport interface DocumentActions {\n  onChangeDoc: (docId: string) => void;\n  onRenameDoc: (docId: string, newName: string) => void;\n  onToggleOriginalFile: (checked: boolean) => void;\n  onResegment: () => void;\n  onUpdateFrequency: () => void;\n  onDelete: () => void;\n  reloadDataset?: () => void;\n}\n\n// Custom UI elements\nexport interface CustomUIElements {\n  linkOriginUrlButton?: ReactNode;\n  fetchSliceButton?: ReactNode;\n}\n\nexport interface TextToolbarProps {\n  documentData: DocumentData;\n  filePreviewData: FilePreviewData;\n  documentActions: DocumentActions;\n  customUIElements: CustomUIElements;\n}\n\nexport const TextToolbar: React.FC<TextToolbarProps> = ({\n  documentData: { curDoc, curDocId, curFormatType, docOptions },\n  filePreviewData: { showOriginalFile, fileUrl },\n  documentActions: {\n    onChangeDoc,\n    onRenameDoc,\n    onToggleOriginalFile,\n    onResegment,\n    onUpdateFrequency,\n    onDelete,\n  },\n  customUIElements: { linkOriginUrlButton, fetchSliceButton },\n}) => {\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n\n  // Control button display logic\n  const showUpdateFreBtn =\n    canEdit &&\n    curDoc &&\n    (curDoc.source_type === DocumentSource.Web ||\n      isFeishuOrLarkDocumentSource(curDoc?.source_type));\n\n  const showDeleteDocBtn = curDoc && canEdit;\n  const showResegmentButton = curDoc?.format_type === FormatType.Text;\n  const showFetchSliceBtn =\n    canEdit &&\n    curDoc &&\n    ![DocumentSource.Custom, DocumentSource.Document].includes(\n      curDoc.source_type as DocumentSource,\n    );\n\n  return (\n    <div\n      className={classnames(\n        'w-full flex items-center justify-between py-[12px] px-[16px]',\n        'border border-solid coz-stroke-primary border-l-0 border-t-0 border-r-0',\n      )}\n    >\n      <div className={classnames('flex items-center')}>\n        <DocSelector\n          type={curFormatType as FormatType}\n          options={docOptions}\n          canEdit={canEdit}\n          value={curDocId}\n          onChange={onChangeDoc}\n          onRename={onRenameDoc}\n        />\n        <DocTag documentInfo={curDoc} />\n      </div>\n\n      <Space spacing={8}>\n        {fileUrl ? (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"coz-fg-secondary text-[12px] leading-[16px]\">\n              {I18n.t('knowledge_level_030')}\n            </span>\n            <Switch\n              size=\"mini\"\n              checked={showOriginalFile}\n              onChange={onToggleOriginalFile}\n            ></Switch>\n          </div>\n        ) : null}\n\n        {showResegmentButton && canEdit ? (\n          <Tooltip theme=\"dark\" content={I18n.t('knowledge_new_001')}>\n            <IconButton\n              data-testid={KnowledgeE2e.SegmentDetailUpdateBtn}\n              iconPosition=\"left\"\n              color=\"secondary\"\n              size=\"small\"\n              icon={<IconCozAdjust />}\n              onClick={onResegment}\n            />\n          </Tooltip>\n        ) : null}\n\n        {showUpdateFreBtn ? (\n          <Tooltip\n            theme=\"dark\"\n            content={I18n.t('datasets_unit_upload_field_update_frequency')}\n          >\n            <IconButton\n              data-dtestid={`${KnowledgeE2e.SegmentDetailContentItemFrequencyIcon}.${curDoc?.document_id}`}\n              icon={<IconCozHistory className=\"text-[14px]\" />}\n              iconPosition=\"left\"\n              color=\"secondary\"\n              size=\"small\"\n              onClick={onUpdateFrequency}\n            ></IconButton>\n          </Tooltip>\n        ) : null}\n\n        {showFetchSliceBtn ? fetchSliceButton : null}\n        {linkOriginUrlButton}\n\n        {showDeleteDocBtn ? (\n          <Tooltip theme=\"dark\" content={I18n.t('kl2_006')}>\n            <IconButton\n              data-testid={KnowledgeE2e.SegmentDetailContentDeleteIcon}\n              icon={<IconCozTrashCan className=\"text-[14px]\" />}\n              color=\"secondary\"\n              iconPosition=\"left\"\n              size=\"small\"\n              onClick={onDelete}\n            ></IconButton>\n          </Tooltip>\n        ) : null}\n      </Space>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classnames from 'classnames';\nimport { IllustrationNoResult } from '@douyinfe/semi-illustrations';\nimport {\n  useKnowledgeStore,\n  type ILevelSegment,\n} from '@coze-data/knowledge-stores';\nimport { LevelTextKnowledgeEditor } from '@coze-data/knowledge-common-components/text-knowledge-editor';\nimport { I18n } from '@coze-arch/i18n';\nimport { EmptyState } from '@coze-arch/coze-design';\nimport { IconSegmentEmpty } from '@coze-arch/bot-icons';\n\nimport { createLevelDocumentChunkByLevelSegment } from '../utils/document-utils';\nimport styles from '../styles/index.module.less';\n\nexport interface LevelContentProps {\n  isProcessing: boolean;\n  documentId: string;\n  levelSegments: ILevelSegment[];\n  selectionIDs: string[];\n  onLevelSegmentsChange: (chunks: ILevelSegment[]) => void;\n  onLevelSegmentDelete: (chunk: ILevelSegment) => void;\n}\n\nexport const LevelContent: React.FC<LevelContentProps> = ({\n  isProcessing,\n  documentId,\n  levelSegments,\n  selectionIDs,\n  onLevelSegmentsChange,\n  onLevelSegmentDelete,\n}) => {\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n  const searchValue = useKnowledgeStore(state => state.searchValue);\n\n  // Convert hierarchical segmented data into an editor-usable format\n  const renderLevelSegmentsData = levelSegments.map(item =>\n    createLevelDocumentChunkByLevelSegment(item),\n  );\n\n  if (levelSegments.length === 0) {\n    return (\n      <div className={classnames(styles['empty-content'])}>\n        <EmptyState\n          size=\"large\"\n          icon={\n            searchValue ? (\n              <IllustrationNoResult style={{ width: 150, height: '100%' }} />\n            ) : (\n              <IconSegmentEmpty style={{ width: 150, height: '100%' }} />\n            )\n          }\n          title={\n            isProcessing\n              ? I18n.t('content_view_003')\n              : searchValue\n              ? I18n.t('knowledge_no_result')\n              : I18n.t('dataset_segment_empty_desc')\n          }\n        />\n      </div>\n    );\n  }\n\n  return (\n    <LevelTextKnowledgeEditor\n      chunks={renderLevelSegmentsData}\n      selectionIDs={selectionIDs}\n      documentId={documentId}\n      readonly={!canEdit}\n      onChange={onLevelSegmentsChange}\n      onDeleteChunk={onLevelSegmentDelete}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classnames from 'classnames';\nimport {\n  usePreviewPdf,\n  PreviewMd,\n  PreviewTxt,\n} from '@coze-data/knowledge-common-components';\nimport {\n  IconCozArrowLeft,\n  IconCozArrowRight,\n  IconCozMinus,\n  IconCozPlus,\n} from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nexport interface FilePreviewProps {\n  fileType?: string;\n  fileUrl: string;\n  visible: boolean;\n}\n\nexport const FilePreview: React.FC<FilePreviewProps> = ({\n  fileType,\n  fileUrl,\n  visible,\n}) => {\n  const {\n    pdfNode,\n    numPages,\n    currentPage,\n    onNext,\n    onBack,\n    scale,\n    increaseScale,\n    decreaseScale,\n  } = usePreviewPdf({\n    fileUrl,\n  });\n\n  return (\n    <div\n      className={classnames(\n        'w-full h-full',\n        'border border-solid coz-stroke-primary border-t-0 border-b-0 border-l-0',\n        'flex flex-col items-center overflow-auto',\n        !visible && 'hidden',\n      )}\n    >\n      {(() => {\n        if (fileType === 'md') {\n          return <PreviewMd fileUrl={fileUrl} />;\n        }\n\n        if (fileType === 'txt') {\n          return <PreviewTxt fileUrl={fileUrl} />;\n        }\n\n        if (['docx', 'pdf', 'doc'].includes(fileType ?? '')) {\n          return (\n            <div className=\"grow w-full relative\">\n              {numPages >= 1 ? (\n                <div\n                  className={classnames(\n                    'flex w-fit h-[32px] items-center justify-center gap-[3px] absolute top-[8px] right-[8px]',\n                    'coz-bg-max rounded-[8px] coz-shadow-default',\n                    'z-10',\n                    'px-[8px]',\n                  )}\n                >\n                  <IconButton\n                    icon={<IconCozArrowLeft />}\n                    size=\"small\"\n                    color=\"secondary\"\n                    onClick={onBack}\n                  ></IconButton>\n                  <div className=\"coz-fg-secondary text-[12px] font-[400] leading-[24px]\">\n                    {currentPage} / {numPages}\n                  </div>\n                  <IconButton\n                    icon={<IconCozArrowRight />}\n                    size=\"small\"\n                    color=\"secondary\"\n                    onClick={onNext}\n                  />\n                  <div className=\"w-[1px] h-[12px] coz-mg-primary\"></div>\n                  <IconButton\n                    icon={<IconCozMinus />}\n                    size=\"small\"\n                    color=\"secondary\"\n                    onClick={decreaseScale}\n                  />\n                  <div className=\"coz-fg-secondary text-[12px] font-[400] leading-[16px]\">\n                    {Math.round(scale * 100)}%\n                  </div>\n                  <IconButton\n                    icon={<IconCozPlus />}\n                    size=\"small\"\n                    color=\"secondary\"\n                    onClick={increaseScale}\n                  />\n                </div>\n              ) : null}\n              {pdfNode}\n            </div>\n          );\n        }\n        return null;\n      })()}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classnames from 'classnames';\nimport { IllustrationNoResult } from '@douyinfe/semi-illustrations';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { type DocumentChunk } from '@coze-data/knowledge-common-components/text-knowledge-editor/scenes/base';\nimport { BaseTextKnowledgeEditor } from '@coze-data/knowledge-common-components/text-knowledge-editor';\nimport { I18n } from '@coze-arch/i18n';\nimport { EmptyState } from '@coze-arch/coze-design';\nimport { IconSegmentEmpty } from '@coze-arch/bot-icons';\n\nimport styles from '../styles/index.module.less';\n\nexport interface BaseContentProps {\n  loading: boolean;\n  isProcessing: boolean;\n  documentId: string;\n  renderData: DocumentChunk[];\n  onContentChange: (chunks: DocumentChunk[]) => void;\n  onAddChunk: () => void;\n  onDeleteChunk: (chunk: DocumentChunk) => void;\n}\n\nexport const BaseContent: React.FC<BaseContentProps> = ({\n  loading,\n  isProcessing,\n  documentId,\n  renderData,\n  onContentChange,\n  onAddChunk,\n  onDeleteChunk,\n}) => {\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n  const searchValue = useKnowledgeStore(state => state.searchValue);\n\n  if (renderData?.length === 0 && !loading) {\n    return (\n      <div className={classnames(styles['empty-content'])}>\n        <EmptyState\n          size=\"large\"\n          icon={\n            searchValue ? (\n              <IllustrationNoResult style={{ width: 150, height: '100%' }} />\n            ) : (\n              <IconSegmentEmpty style={{ width: 150, height: '100%' }} />\n            )\n          }\n          title={\n            isProcessing\n              ? I18n.t('content_view_003')\n              : searchValue\n              ? I18n.t('knowledge_no_result')\n              : I18n.t('dataset_segment_empty_desc')\n          }\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles['slice-article-content']}>\n      <BaseTextKnowledgeEditor\n        chunks={renderData}\n        documentId={documentId}\n        readonly={!canEdit}\n        onChange={onContentChange}\n        onAddChunk={onAddChunk}\n        onDeleteChunk={onDeleteChunk}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n\n/* eslint-disable complexity */\nimport { type ReactNode, useRef } from 'react';\n\nimport classnames from 'classnames';\nimport {\n  useDataNavigate,\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport {\n  OptType,\n  UnitType,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { SegmentMenu } from '@coze-data/knowledge-common-components';\nimport { Spin } from '@coze-arch/coze-design';\nimport {\n  ChunkType,\n  DocumentSource,\n  type DocumentInfo,\n} from '@coze-arch/bot-api/knowledge';\n\nimport { type ProgressMap } from '@/types';\n\nimport { getDocumentOptions } from '../utils/document-utils';\nimport { useModals } from '../hooks/use-case/use-modals';\nimport { useInitSelectFirstDoc } from '../hooks/use-case/use-init-select-first-doc';\nimport { useFilePreview } from '../hooks/use-case/use-file-preview';\nimport { useDocumentManagement } from '../hooks/use-case/use-document-management';\nimport {\n  useDocumentInfo,\n  useSliceData,\n  useLevelSegments,\n  useSliceCounter,\n} from '../hooks';\nimport { TextToolbar } from './text-toolbar';\nimport { LevelContent } from './level-content';\nimport { FilePreview } from './file-preview';\nimport { BaseContent } from './base-content';\n\nexport interface TextKnowledgeWorkspaceProps {\n  onChangeDocList?: (docList: DocumentInfo[]) => void;\n  reload?: () => void;\n  progressMap: ProgressMap;\n  linkOriginUrlButton?: ReactNode;\n  fetchSliceButton?: ReactNode;\n}\n\nexport const TextKnowledgeWorkspace = ({\n  onChangeDocList,\n  reload: reloadDataset,\n  progressMap,\n  linkOriginUrlButton,\n  fetchSliceButton,\n}: TextKnowledgeWorkspaceProps) => {\n  const contentWrapperRef = useRef<HTMLDivElement>(null);\n\n  const knowledgeParams = useKnowledgeParams();\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const resourceNavigate = useDataNavigate();\n\n  // Initialize to select the first document\n  useInitSelectFirstDoc();\n\n  // Document Management\n  const {\n    handleSelectDocument,\n    handleRenameDocument,\n    handleUpdateDocumentFrequency,\n    rollbackDocumentSelection,\n  } = useDocumentManagement({\n    reloadDataset,\n  });\n\n  // Documentation basic information\n  const { curDoc, curDocId, isProcessing, processFinished, datasetId } =\n    useDocumentInfo(progressMap);\n\n  // file preview\n  const { showOriginalFile, handleToggleOriginalFile } =\n    useFilePreview(curDocId);\n\n  // document fragment data\n  const { loading, renderData, handleContentChange, reload } = useSliceData({\n    curDocId,\n    datasetId,\n    curChunkType: curDoc?.chunk_strategy?.chunk_type,\n    processFinished,\n    target: contentWrapperRef,\n    rollbackDocumentSelection,\n  });\n\n  // hierarchical segmented data\n  const {\n    levelSegments,\n    selectionIDs,\n    setSelectionIDs,\n    tosLoading,\n    handleLevelSegmentsChange,\n    handleLevelSegmentDelete,\n  } = useLevelSegments({\n    curDoc,\n  });\n\n  // fragment counter\n  const { handleIncreaseSliceCount, handleDecreaseSliceCount } =\n    useSliceCounter();\n\n  // modal box\n  const {\n    deleteModalNode,\n    showDeleteModal,\n    updateFrequencyModalNode,\n    showUpdateFrequencyModal,\n  } = useModals({\n    docId: curDoc?.document_id,\n    documentType: curDoc?.format_type,\n    documentSource: curDoc?.source_type,\n    onDelete: () => {\n      reloadDataset?.();\n      handleSelectDocument('');\n    },\n    onUpdateFrequency: formData => {\n      if (!onChangeDocList || !curDoc) {\n        return;\n      }\n\n      const updatedDocList = handleUpdateDocumentFrequency(\n        curDoc.document_id ?? '',\n        formData,\n      );\n\n      if (updatedDocList) {\n        onChangeDocList(updatedDocList);\n      }\n    },\n  });\n\n  // Document Options\n  const docOptions = getDocumentOptions(documentList, progressMap);\n\n  // Handle re-segmentation\n  const handleResegment = () => {\n    const isLocalText = Boolean(\n      curDoc?.source_type === DocumentSource.Document,\n    );\n    resourceNavigate.upload?.({\n      type: isLocalText ? UnitType.TEXT_DOC : UnitType.TEXT,\n      opt: OptType.RESEGMENT,\n      doc_id: curDocId ?? '',\n      page_mode: knowledgeParams.pageMode ?? '',\n      bot_id: knowledgeParams.botID ?? '',\n    });\n  };\n\n  const fromProject = knowledgeParams.biz === 'project';\n\n  return (\n    <>\n      <div\n        className={classnames(\n          'flex grow border-solid coz-stroke-primary coz-bg-max',\n          fromProject\n            ? 'h-[calc(100%-64px)] border-0 border-t'\n            : 'h-[calc(100%-112px)] border rounded-[8px]',\n        )}\n      >\n        <div\n          className={classnames(\n            'w-[300px] h-full shrink-0 overflow-auto p-[12px]',\n            'border-0 border-r border-solid coz-stroke-primary',\n          )}\n        >\n          <SegmentMenu\n            isSearchable\n            list={(documentList ?? []).map(item => ({\n              id: item.document_id ?? '',\n              title: item.name ?? '',\n              label: docOptions.find(opt => opt.value === item.document_id)\n                ?.label,\n            }))}\n            selectedID={curDocId}\n            onClick={id => {\n              if (id !== curDocId) {\n                handleSelectDocument(id);\n              }\n            }}\n            levelSegments={levelSegments}\n            setSelectionIDs={setSelectionIDs}\n            treeDisabled\n            treeVisible={\n              curDoc?.chunk_strategy?.chunk_type === ChunkType.LevelChunk\n            }\n          />\n        </div>\n\n        <Spin\n          spinning={loading || tosLoading}\n          size=\"large\"\n          wrapperClassName=\"h-full !w-full grow rounded-r-[8px] overflow-hidden\"\n          childStyle={{ height: '100%', flexGrow: 1, width: '100%' }}\n        >\n          <TextToolbar\n            documentData={{\n              curDoc,\n              curDocId,\n              curFormatType: curDoc?.format_type,\n              docOptions,\n            }}\n            filePreviewData={{\n              showOriginalFile,\n              fileUrl: curDoc?.preview_tos_url,\n            }}\n            documentActions={{\n              onChangeDoc: handleSelectDocument,\n              onRenameDoc: handleRenameDocument,\n              onToggleOriginalFile: handleToggleOriginalFile,\n              onResegment: handleResegment,\n              onUpdateFrequency: () =>\n                showUpdateFrequencyModal({\n                  updateInterval: curDoc?.update_interval,\n                  updateType: curDoc?.update_type,\n                }),\n              onDelete: showDeleteModal,\n              reloadDataset,\n            }}\n            customUIElements={{\n              linkOriginUrlButton,\n              fetchSliceButton,\n            }}\n          />\n\n          <div className=\"flex h-[calc(100%-56px)] grow w-full\">\n            <FilePreview\n              fileType={curDoc?.type}\n              fileUrl={curDoc?.preview_tos_url || ''}\n              visible={showOriginalFile}\n            />\n\n            <div\n              ref={contentWrapperRef}\n              className={classnames(\n                'w-full grow h-full overflow-auto',\n                'px-[16px] pt-[16px]',\n              )}\n            >\n              {curDoc?.chunk_strategy?.chunk_type === ChunkType.LevelChunk ? (\n                <LevelContent\n                  isProcessing={isProcessing}\n                  documentId={curDocId}\n                  levelSegments={levelSegments}\n                  selectionIDs={selectionIDs}\n                  onLevelSegmentsChange={handleLevelSegmentsChange}\n                  onLevelSegmentDelete={handleLevelSegmentDelete}\n                />\n              ) : (\n                <BaseContent\n                  loading={loading}\n                  isProcessing={isProcessing}\n                  documentId={curDocId}\n                  renderData={renderData}\n                  onContentChange={handleContentChange}\n                  onAddChunk={() => {\n                    reload();\n                    handleIncreaseSliceCount();\n                  }}\n                  onDeleteChunk={() => {\n                    handleDecreaseSliceCount();\n                  }}\n                />\n              )}\n            </div>\n          </div>\n        </Spin>\n      </div>\n\n      {deleteModalNode}\n      {updateFrequencyModalNode}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type ImportKnowledgeMenuSourceRegistry } from '@/features/import-knowledge-sources/menu/registry';\n\nexport interface KnowledgeIDERegistry {\n  importKnowledgeMenuSourceFeatureRegistry?: ImportKnowledgeMenuSourceRegistry;\n}\n\nexport const KnowledgeIDERegistryContext = createContext<KnowledgeIDERegistry>({\n  importKnowledgeMenuSourceFeatureRegistry: undefined,\n});\n\nexport const useKnowledgeIDERegistry = () =>\n  useContext(KnowledgeIDERegistryContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ReactNode } from 'react';\n\nimport { Menu } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\nexport interface KnowledgeSourceMenuProps {\n  triggerComponent: ReactNode;\n  onVisibleChange?: (visible: boolean) => void;\n  children: ReactNode;\n}\n\nexport const KnowledgeSourceMenu = (props: KnowledgeSourceMenuProps) => {\n  const { triggerComponent, onVisibleChange, children } = props;\n\n  return (\n    <Menu\n      clickToHide\n      trigger=\"click\"\n      position=\"bottomRight\"\n      onVisibleChange={onVisibleChange}\n      render={\n        <Menu.SubMenu mode=\"menu\" className={styles['create-opt-select-down']}>\n          {children}\n        </Menu.SubMenu>\n      }\n    >\n      {triggerComponent}\n    </Menu>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ReactNode } from 'react';\n\nimport { type UnitType } from '@coze-data/knowledge-resource-processor-core';\n\nimport { useKnowledgeIDERegistry } from '../../context/knowledge-ide-registry-context';\nimport { KnowledgeSourceMenu as KnowledgeSourceMenuComponent } from '../../components/knowledge-source-menu';\n\nexport interface ImportKnowledgeSourceMenuProps {\n  triggerComponent?: ReactNode;\n  onVisibleChange?: (visible: boolean) => void;\n  onChange?: (val: UnitType) => void;\n}\n\nexport const ImportKnowledgeSourceMenu = (\n  props: ImportKnowledgeSourceMenuProps,\n) => {\n  const { triggerComponent, onVisibleChange, onChange } = props;\n  const { importKnowledgeMenuSourceFeatureRegistry } =\n    useKnowledgeIDERegistry();\n\n  return (\n    <KnowledgeSourceMenuComponent\n      triggerComponent={triggerComponent}\n      onVisibleChange={onVisibleChange}\n    >\n      {importKnowledgeMenuSourceFeatureRegistry\n        ?.entries()\n        .map(([key, { Component }]) => (\n          <Component key={key} onClick={value => onChange?.(value)} />\n        ))}\n    </KnowledgeSourceMenuComponent>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  KNOWLEDGE_MAX_DOC_SIZE,\n  KNOWLEDGE_MAX_SLICE_COUNT,\n} from '@coze-data/knowledge-modal-base';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Dataset, type DocumentInfo } from '@coze-arch/bot-api/knowledge';\nimport { DocumentStatus, FormatType } from '@coze-arch/bot-api/knowledge';\n\n/**\n * Disable hints for working with table-type datasets\n */\nexport const getTableFormatTooltip = (documentList: DocumentInfo[]): string => {\n  const docInfo = documentList?.[0];\n  if (!docInfo) {\n    return '';\n  }\n\n  if (docInfo.status === DocumentStatus.Processing) {\n    return I18n.t('knowledge_add_content_processing_tips');\n  }\n\n  // @ts-expect-error -- linter-disable-autofix\n  if (docInfo?.slice_count >= KNOWLEDGE_MAX_SLICE_COUNT) {\n    return I18n.t('kl2_002');\n  }\n\n  return '';\n};\n\n/**\n * Disable hints for handling default type datasets\n */\nexport const getDefaultFormatTooltip = (dataSetDetail: Dataset): string => {\n  // @ts-expect-error -- linter-disable-autofix\n  if (dataSetDetail?.doc_count >= KNOWLEDGE_MAX_DOC_SIZE) {\n    return I18n.t('kl2_003');\n  }\n\n  if (dataSetDetail?.processing_file_id_list?.length) {\n    return I18n.t('knowledge_add_content_processing_tips');\n  }\n\n  return '';\n};\n\n/**\n * Create prompt text when button is disabled\n * @param dataSetDetail - Dataset Details\n * @param documentList - Document List\n * @Returns prompt text\n */\nexport const createBtnDisableToolTip = (\n  dataSetDetail: Dataset,\n  documentList: DocumentInfo[],\n): string => {\n  const formatType = dataSetDetail?.format_type;\n\n  const tooltipHandlers: Record<string, () => string> = {\n    [FormatType.Table]: () => getTableFormatTooltip(documentList),\n    default: () => getDefaultFormatTooltip(dataSetDetail),\n  };\n\n  if (!formatType) {\n    return tooltipHandlers.default();\n  }\n\n  const handler = tooltipHandlers[formatType] || tooltipHandlers.default;\n  return handler();\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport {\n  useDataNavigate,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { OptType } from '@coze-data/knowledge-resource-processor-core';\nimport { getKnowledgeIDEQuery } from '@coze-data/knowledge-common-services/use-case';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowDown } from '@coze-arch/bot-icons';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\nimport { IconCozArrowUp } from '@coze-arch/coze-design/icons';\nimport { Button, Tooltip } from '@coze-arch/coze-design';\n\nimport { ImportKnowledgeSourceMenu } from '@/features/import-knowledge-source-menu';\n\nimport { type ImportKnowledgeSourceButtonProps } from '../module';\nimport {\n  createBtnDisableToolTip,\n  getTableFormatTooltip,\n  getDefaultFormatTooltip,\n} from './services/use-case/disabled-tooltip';\n\nexport const ImportKnowledgeSourceButton = ({\n  disabledTooltip: disabledTooltipProp,\n  onSourceChange,\n}: ImportKnowledgeSourceButtonProps) => {\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const dataSetDetail = useKnowledgeStore(state => state.dataSetDetail);\n  const [visible, setVisible] = useState<boolean>(false);\n  const resourceNavigate = useDataNavigate();\n  const disabledTooltip =\n    disabledTooltipProp ?? createBtnDisableToolTip(dataSetDetail, documentList);\n  const query = getKnowledgeIDEQuery() as Record<string, string>;\n  if (disabledTooltip) {\n    return (\n      <Tooltip\n        content={disabledTooltip}\n        arrowPointAtCenter={false}\n        position=\"top\"\n      >\n        <Button\n          data-testid={KnowledgeE2e.SegmentDetailAddBtn}\n          color=\"hgltplus\"\n          disabled\n          iconPosition=\"right\"\n          icon={<IconCozArrowDown className={'text-[12px]'} />}\n        >\n          {I18n.t('knowledg_unit_add_segments')}\n        </Button>\n      </Tooltip>\n    );\n  }\n  return (\n    <ImportKnowledgeSourceMenu\n      onVisibleChange={dropVisible => {\n        setVisible(dropVisible);\n      }}\n      onChange={unitType => {\n        if (onSourceChange) {\n          onSourceChange(unitType);\n          return;\n        }\n        /** Default jump to upload */\n        const formatType = dataSetDetail?.format_type;\n        const docID = documentList?.[0]?.document_id;\n        const params: Record<string, string> = {\n          type: unitType,\n          ...query,\n        };\n        if (formatType === FormatType.Table && docID) {\n          params.opt = OptType.INCREMENTAL;\n          params.doc_id = docID;\n        }\n        resourceNavigate.upload?.(params);\n      }}\n      triggerComponent={\n        <Button\n          data-testid={KnowledgeE2e.SegmentDetailAddBtn}\n          iconPosition=\"right\"\n          icon={\n            visible ? (\n              <IconCozArrowUp className={'text-[12px]'} />\n            ) : (\n              <IconCozArrowDown className={'text-[12px]'} />\n            )\n          }\n        >\n          {I18n.t('knowledg_unit_add_segments')}\n        </Button>\n      }\n    />\n  );\n};\n\nexport {\n  getTableFormatTooltip,\n  getDefaultFormatTooltip,\n  createBtnDisableToolTip,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\nimport {\n  IconSvgFile,\n  IconSvgSheet,\n  IconSvgUnbound,\n} from '@coze-arch/bot-icons';\n\nimport style from './index.module.less';\n\ninterface Props {\n  hasSuffix: boolean;\n  formatType?: FormatType;\n  className?: string;\n}\n\nexport const IconMap = {\n  [FormatType.Table]: {\n    icon: <IconSvgSheet />,\n    bgColor: '#35C566',\n    suffixIcon: <IconSvgUnbound />,\n    suffixBgColor: 'rgba(255,150,0,1)',\n  },\n  [FormatType.Text]: {\n    icon: <IconSvgFile />,\n    bgColor: 'rgba(34, 136, 255, 1)',\n    suffixIcon: <IconSvgUnbound />,\n    suffixBgColor: 'rgba(255,150,0,1)',\n  },\n};\n\nexport const IconWithSuffix = (props: Props) => {\n  const { formatType = FormatType.Text, hasSuffix, className } = props;\n\n  return (\n    <div className={classNames(style['icon-with-suffix'], className)}>\n      <div\n        className={classNames('icon-with-suffix-common', 'icon')}\n        style={{\n          backgroundColor: `${IconMap?.[formatType]?.bgColor}`,\n        }}\n      >\n        {IconMap?.[formatType]?.icon}\n      </div>\n      {hasSuffix ? (\n        <div\n          className={classNames('icon-with-suffix-common', 'suffix')}\n          style={{\n            backgroundColor: `${IconMap?.[formatType]?.suffixBgColor}`,\n          }}\n        >\n          {IconMap?.[formatType]?.suffixIcon}\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DocumentSource, FormatType } from '@coze-arch/bot-api/knowledge';\nimport { isFeishuOrLarkDocumentSource } from '@coze-data/utils';\nimport { IconUnitsTable, IconUnitsFile } from '@coze-arch/bot-icons';\n\nimport { IconWithSuffix } from './suffix';\n\n// Get icon\nexport const RenderDocumentIcon = ({\n  formatType,\n  sourceType,\n  isDisconnect,\n  className,\n  iconSuffixClassName,\n}: {\n  formatType?: FormatType;\n  sourceType?: DocumentSource;\n  isDisconnect?: boolean;\n  className?: string;\n  iconSuffixClassName?: string;\n}) => {\n  if (\n    sourceType &&\n    ([DocumentSource.Notion, DocumentSource.GoogleDrive].includes(sourceType) ||\n      isFeishuOrLarkDocumentSource(sourceType))\n  ) {\n    return (\n      <IconWithSuffix\n        hasSuffix={!!isDisconnect}\n        formatType={formatType}\n        className={iconSuffixClassName}\n      />\n    );\n  } else {\n    return formatType === FormatType.Table ? (\n      <IconUnitsTable className={className} />\n    ) : (\n      <IconUnitsFile className={className} />\n    );\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { Divider } from '@coze-arch/coze-design';\n\nimport { FilterPhotoType } from '@/types';\n\nimport styles from './index.module.less';\n\nexport const PhotoFilter: FC = () => {\n  const photoFilterValue = useKnowledgeStore(state => state.photoFilterValue);\n  const setPhotoFilterValue = useKnowledgeStore(\n    state => state.setPhotoFilterValue,\n  );\n\n  return (\n    <div className={styles['photo-filter-tab']}>\n      <div\n        data-testid={KnowledgeE2e.ImageAnnotationAllTab}\n        key={FilterPhotoType.All}\n        onClick={() => setPhotoFilterValue(FilterPhotoType.All)}\n        className={\n          photoFilterValue === FilterPhotoType.All\n            ? styles['photo-filter-tab-item-active']\n            : styles['photo-filter-tab-item']\n        }\n      >\n        {I18n.t('knowledge-dataset-type-all')}\n      </div>\n      <Divider layout=\"vertical\" margin=\"12px\" />\n      <div\n        data-testid={KnowledgeE2e.ImageAnnotationAnnotationedTab}\n        key={FilterPhotoType.HasCaption}\n        onClick={() => setPhotoFilterValue(FilterPhotoType.HasCaption)}\n        className={\n          photoFilterValue === FilterPhotoType.HasCaption\n            ? styles['photo-filter-tab-item-active']\n            : styles['photo-filter-tab-item']\n        }\n      >\n        {I18n.t('knowledge_photo_013')}\n      </div>\n      <Divider layout=\"vertical\" margin=\"12px\" />\n      <div\n        data-testid={KnowledgeE2e.ImageAnnotationUnAnnotationTab}\n        key={FilterPhotoType.NoCaption}\n        onClick={() => setPhotoFilterValue(FilterPhotoType.NoCaption)}\n        className={\n          photoFilterValue === FilterPhotoType.NoCaption\n            ? styles['photo-filter-tab-item-active']\n            : styles['photo-filter-tab-item']\n        }\n      >\n        {I18n.t('knowledge_photo_014')}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { formatBytes } from '@coze-arch/bot-utils';\nimport {\n  FormatType,\n  type Dataset,\n  type DocumentInfo,\n  DocumentSource,\n  DocumentStatus,\n  StorageLocation,\n} from '@coze-arch/bot-api/knowledge';\nimport { Space, Tag } from '@coze-arch/coze-design';\n\nimport { type ProgressMap } from '@/types';\nimport { DOCUMENT_UPDATE_TYPE_MAP } from '@/constant';\n\nimport { getSourceName } from '../../utils';\n\nexport interface HeaderTagProps {\n  dataSetDetail: Dataset;\n  docInfo?: DocumentInfo;\n  progressMap?: ProgressMap;\n}\n// eslint-disable-next-line complexity\nexport const HeaderTags = ({\n  dataSetDetail,\n  docInfo,\n  progressMap = {},\n}: HeaderTagProps) => {\n  const formatType = dataSetDetail?.format_type;\n  const updateFrequencyStr = useMemo(() => {\n    if (!docInfo) {\n      return '';\n    }\n    // @ts-expect-error -- linter-disable-autofix\n    let str: string = DOCUMENT_UPDATE_TYPE_MAP[docInfo?.update_type];\n    if (docInfo.update_interval) {\n      str = `${I18n.t('datasets_segment_tag_updateFrequency', {\n        num: docInfo.update_interval,\n      })}`;\n    }\n    return str;\n  }, [docInfo]);\n  return (\n    <div className=\"flex pb-[4px]\" data-testid={KnowledgeE2e.UnitDetailTags}>\n      <Space spacing={4} className=\"[&_.semi-tag-content]:font-medium\">\n        {/* file size */}\n        {dataSetDetail?.all_file_size ? (\n          <Tag size=\"mini\" color=\"primary\">\n            {formatBytes(parseInt(String(dataSetDetail.all_file_size)))}\n          </Tag>\n        ) : null}\n\n        {/* table source type  */}\n        {formatType === FormatType.Table && !!docInfo && (\n          <Tag size=\"mini\" color=\"primary\">\n            {getSourceName(docInfo)}\n          </Tag>\n        )}\n\n        {/* table api update type  */}\n        {formatType === FormatType.Table &&\n        docInfo &&\n        docInfo?.source_type === DocumentSource.Web ? (\n          <Tag size=\"mini\" color=\"primary\">\n            {updateFrequencyStr}\n          </Tag>\n        ) : null}\n\n        {/* doc count */}\n        {formatType === FormatType.Text && !!dataSetDetail?.doc_count && (\n          <Tag size=\"mini\" color=\"primary\">\n            {I18n.t('kl2_009', {\n              num: dataSetDetail?.doc_count ?? 0,\n            })}\n          </Tag>\n        )}\n\n        {/* Image source */}\n        {formatType === FormatType.Image && (\n          <Tag size=\"mini\" color=\"primary\">\n            {I18n.t('dataset_detail_source_local')}\n          </Tag>\n        )}\n\n        {/* number of pictures */}\n        {formatType === FormatType.Image && !!dataSetDetail?.doc_count && (\n          <Tag size=\"mini\" color=\"primary\">\n            {I18n.t('knowledge_photo_015', {\n              num: dataSetDetail?.doc_count || 0,\n            })}\n          </Tag>\n        )}\n\n        {/*  Do not display when no document is added */}\n        {formatType !== FormatType.Image && !!dataSetDetail?.doc_count && (\n          <>\n            {/* slice count  */}\n            <Tag size=\"mini\" color=\"primary\">\n              {I18n.t('datasets_segment_tag_segments', {\n                num: dataSetDetail?.slice_count ?? 0,\n              })}\n            </Tag>\n            {/* hit count  */}\n            <Tag size=\"mini\" color=\"primary\">\n              {I18n.t('datasets_segment_card_hit', {\n                num: dataSetDetail?.hit_count,\n              })}\n            </Tag>\n          </>\n        )}\n\n        {dataSetDetail?.storage_location === StorageLocation.OpenSearch ? (\n          <Tag size=\"mini\" color=\"cyan\">\n            {I18n.t('knowledge_es_001')}\n          </Tag>\n        ) : null}\n\n        {/* loading */}\n        {Boolean(dataSetDetail?.processing_file_id_list) &&\n          Boolean(dataSetDetail?.processing_file_id_list?.length) && (\n            <Tag\n              size=\"mini\"\n              color=\"blue\"\n              data-testid={KnowledgeE2e.UnitDetailTagsProcessing}\n            >\n              {I18n.t('datasets_segment_tag_processing')}\n              {docInfo?.format_type === FormatType.Table &&\n              // @ts-expect-error -- linter-disable-autofix\n              progressMap?.[docInfo?.document_id]\n                ? // @ts-expect-error -- linter-disable-autofix\n                  `${progressMap?.[docInfo?.document_id]?.progress}%`\n                : ''}\n            </Tag>\n          )}\n\n        {/** Table error  */}\n        {formatType === FormatType.Table &&\n          docInfo?.status === DocumentStatus.Failed && (\n            <Tag\n              size=\"mini\"\n              color=\"red\"\n              data-testid={KnowledgeE2e.UnitDetailTagsFailed}\n            >\n              {docInfo?.status_descript || I18n.t('dataset_process_fail')}\n            </Tag>\n          )}\n      </Space>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { Loading } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\ninterface RelatedBotsListProps {\n  datasetId: string;\n  classNameItem?: string;\n  style?: Record<string, string>;\n}\n\nexport const RelatedBotsList = (props: RelatedBotsListProps) => {\n  const { datasetId, style, classNameItem } = props;\n\n  const {\n    loading,\n    data,\n    run,\n    error: requestError,\n  } = useRequest(\n    async () => {\n      const resq = await KnowledgeApi.GetDatasetRefBots({\n        dataset_id: datasetId,\n      });\n      return resq.ref_bots;\n    },\n    {\n      onError: error => {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: REPORT_EVENTS.KnowledgeGetDatasetRefDetail,\n          error,\n        });\n      },\n      manual: true,\n    },\n  );\n  useEffect(() => {\n    run();\n  }, [datasetId]);\n  if (requestError) {\n    return <div>{I18n.t('knowledge_optimize_020')}</div>;\n  }\n  if (loading) {\n    return <Loading loading={loading}></Loading>;\n  }\n  return (\n    <div className={styles['related-bots-list']}>\n      {data?.map(item => (\n        <div\n          className={\n            classNameItem ? classNameItem : styles['related-bots-list-item']\n          }\n          style={style}\n          key={item.name}\n        >\n          <div className=\"related-bots-circle\">.</div>\n\n          <div>{item.name}</div>\n        </div>\n      ))}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { FormatType } from '@coze-arch/bot-api/memory';\nimport {\n  IconSvgFile,\n  IconSvgSheet,\n  IconSvgUnbound,\n} from '@coze-arch/bot-icons';\n\nimport style from './index.module.less';\n\ninterface Props {\n  hasSuffix: boolean;\n  formatType?: FormatType;\n  className?: string;\n}\n\nexport const IconMap = {\n  [FormatType.Table]: {\n    icon: <IconSvgSheet />,\n    bgColor: '#35C566',\n    suffixIcon: <IconSvgUnbound />,\n    suffixBgColor: 'rgba(255,150,0,1)',\n  },\n  [FormatType.Text]: {\n    icon: <IconSvgFile />,\n    bgColor: 'rgba(34, 136, 255, 1)',\n    suffixIcon: <IconSvgUnbound />,\n    suffixBgColor: 'rgba(255,150,0,1)',\n  },\n};\n\nexport const IconWithSuffix = (props: Props) => {\n  const { formatType = FormatType.Text, hasSuffix, className } = props;\n\n  return (\n    <div className={classNames(style['icon-with-suffix'], className)}>\n      <div\n        className={classNames('icon-with-suffix-common', 'icon')}\n        style={{\n          backgroundColor: `${IconMap?.[formatType]?.bgColor}`,\n        }}\n      >\n        {IconMap?.[formatType]?.icon}\n      </div>\n      {hasSuffix ? (\n        <div\n          className={classNames('icon-with-suffix-common', 'suffix')}\n          style={{\n            backgroundColor: `${IconMap?.[formatType]?.suffixBgColor}`,\n          }}\n        >\n          {IconMap?.[formatType]?.suffixIcon}\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport {\n  FormatType,\n  type Dataset,\n  type DocumentInfo,\n} from '@coze-arch/bot-api/knowledge';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { IconButton, Avatar, Space } from '@coze-arch/coze-design';\n\nimport { getFormatTypeFromUnitType } from '@/utils';\nimport { RenderDocumentIcon } from '@/components/render-document-icon';\nimport { PhotoFilter } from '@/components/photo-filter';\nimport { HeaderTags } from '@/components/header-tags';\n\nimport styles from './index.module.less';\n\nexport interface KnowledgeModalNavBarProps {\n  title: string;\n  datasetDetail?: Dataset;\n  docInfo?: DocumentInfo;\n  importKnowledgeSourceButton?: React.ReactNode;\n  actionButtons?: React.ReactNode;\n  onBack?: () => void;\n  beforeBack?: () => void;\n}\n\nexport const KnowledgeModalNavBar: React.FC<KnowledgeModalNavBarProps> = ({\n  title,\n  actionButtons,\n  datasetDetail,\n  docInfo,\n  onBack,\n  beforeBack,\n  importKnowledgeSourceButton,\n}) => {\n  const setSearchValue = useKnowledgeStore(state => state.setSearchValue);\n  const dataSetDetail = useKnowledgeStore(state => state.dataSetDetail);\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n\n  const params = useKnowledgeParams();\n\n  useEffect(\n    () => () => {\n      setSearchValue('');\n    },\n    [],\n  );\n\n  const isImageFormat = dataSetDetail?.format_type === FormatType.Image;\n\n  return (\n    <div\n      className={classNames(\n        'flex items-center justify-between shrink-0 h-[56px]',\n        styles.navbar,\n      )}\n      data-testid={KnowledgeE2e.KnowledgeAddContentNavBar}\n    >\n      <div className={styles.brief}>\n        <IconButton\n          color=\"secondary\"\n          icon={<IconCozCross className=\"text-[16px]\" />}\n          iconPosition=\"left\"\n          className={`${styles['back-icon']} mr-[8px]`}\n          onClick={() => {\n            beforeBack?.();\n            onBack?.();\n          }}\n        ></IconButton>\n        {datasetDetail?.icon_url ? (\n          <Avatar src={datasetDetail?.icon_url} shape=\"square\" />\n        ) : (\n          <RenderDocumentIcon\n            formatType={getFormatTypeFromUnitType(params.type ?? UnitType.TEXT)}\n            className={styles['doc-icon-note']}\n            iconSuffixClassName=\"icon-with-suffix-overlay\"\n          />\n        )}\n        <div className=\"ml-[12px]\">\n          <p className=\"text-[18px] font-medium\">{title}</p>\n          {!!datasetDetail && (\n            <HeaderTags dataSetDetail={datasetDetail} docInfo={docInfo} />\n          )}\n        </div>\n      </div>\n\n      <div className={styles.toolbar}>\n        <Space spacing={12}>\n          {isImageFormat ? <PhotoFilter /> : null}\n          {/* import button */}\n          {canEdit ? importKnowledgeSourceButton : null}\n          {actionButtons}\n        </Space>\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n/* eslint-disable complexity */\nimport { useNavigate } from 'react-router-dom';\nimport { useMemo } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { useEditKnowledgeModal } from '@coze-data/knowledge-modal-adapter';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { useFlags } from '@coze-arch/bot-flags';\nimport { FormatType, type Dataset } from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\nimport {\n  IconCozArrowLeft,\n  IconCozEdit,\n  IconCozInfoCircle,\n} from '@coze-arch/coze-design/icons';\nimport {\n  Space,\n  IconButton,\n  Avatar,\n  Tooltip,\n  Typography,\n} from '@coze-arch/coze-design';\n\nimport { getUnitType } from '@/utils';\nimport { type ProgressMap } from '@/types';\nimport { RenderDocumentIcon } from '@/components/render-document-icon';\nimport { PhotoFilter } from '@/components/photo-filter';\nimport { HeaderTags, RelatedBotsList } from '@/components';\n\nimport styles from './index.module.less';\n\nexport interface KnowledgeIDENavBarProps {\n  progressMap: ProgressMap;\n  hideBackButton?: boolean;\n  textConfigButton?: React.ReactNode;\n  tableConfigButton?: React.ReactNode;\n  importKnowledgeSourceButton?: React.ReactNode;\n  onChangeDataset: (dataset: Dataset) => void;\n  onBack?: () => void;\n}\n\nexport const KnowledgeIDENavBar = ({\n  onChangeDataset,\n  progressMap,\n  hideBackButton,\n  textConfigButton,\n  tableConfigButton,\n  importKnowledgeSourceButton,\n  onBack,\n}: KnowledgeIDENavBarProps) => {\n  const dataSetDetail = useKnowledgeStore(state => state.dataSetDetail);\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const navigate = useNavigate();\n  const params = useKnowledgeParams();\n\n  const [FLAGS] = useFlags();\n\n  const { node: editKnowledgeModal, edit } = useEditKnowledgeModal({\n    onOk: async formValue => {\n      await KnowledgeApi.UpdateDataset({\n        dataset_id: formValue.id,\n        name: formValue.name,\n        icon_uri: formValue.icon_uri?.[0].uid,\n        description: formValue.description,\n      });\n      onChangeDataset({\n        ...dataSetDetail,\n        name: formValue?.name || dataSetDetail?.name,\n        description: formValue?.description || dataSetDetail?.description,\n        icon_uri: formValue.icon_uri?.at(0)?.uid || dataSetDetail?.icon_uri,\n        icon_url: formValue.icon_uri?.at(0)?.url || dataSetDetail?.icon_url,\n      });\n    },\n  });\n\n  const isTableFormat = dataSetDetail?.format_type === FormatType.Table;\n  const isImageFormat = dataSetDetail?.format_type === FormatType.Image;\n  const isShowResegmentBtn =\n    canEdit &&\n    !isTableFormat &&\n    !!dataSetDetail?.doc_count &&\n    !dataSetDetail?.processing_file_id_list?.length &&\n    !isImageFormat;\n\n  const documentInfo = documentList?.[0];\n  const unitType = useMemo(() => {\n    if (documentInfo) {\n      return getUnitType({\n        format_type: FormatType.Table,\n        source_type: documentInfo?.source_type,\n      });\n    }\n    return UnitType.TABLE_API;\n  }, [documentInfo]);\n  const isShowLinkUrl = useMemo(\n    () =>\n      unitType &&\n      [\n        UnitType.TABLE_API,\n        UnitType.TABLE_GOOGLE_DRIVE,\n        UnitType.TABLE_FEISHU,\n        UnitType.TABLE_LARK,\n      ].includes(unitType),\n    [unitType],\n  );\n  // Link or action will only be displayed when one exists\n  const showTableConfigButton =\n    (isShowLinkUrl || canEdit) && isTableFormat && documentList?.length;\n\n  const handleBack = () => {\n    onBack?.();\n    navigate(`/space/${params.spaceID}/library`);\n  };\n\n  const fromProject = params.biz === 'project';\n\n  return (\n    <div\n      className={classNames(\n        'flex items-center justify-between shrink-0',\n        fromProject ? 'px-[16px] py-[12px]' : 'h-[56px]',\n        styles.brief,\n      )}\n    >\n      <div className={styles.info}>\n        {hideBackButton ? null : (\n          <IconButton\n            color=\"secondary\"\n            icon={<IconCozArrowLeft className=\"text-[16px]\" />}\n            iconPosition=\"left\"\n            onClick={handleBack}\n            className=\"mr-[4px]\"\n          ></IconButton>\n        )}\n        {/* icon */}\n        <div className={styles.icon}>\n          {dataSetDetail?.icon_url ? (\n            <Avatar\n              src={dataSetDetail?.icon_url}\n              shape=\"square\"\n              size=\"default\"\n            />\n          ) : (\n            <RenderDocumentIcon\n              formatType={dataSetDetail?.format_type || FormatType.Text}\n              className={styles['doc-icon-note']}\n              iconSuffixClassName=\"icon-with-suffix-overlay\"\n            />\n          )}\n        </div>\n        <div className={styles.content}>\n          <div className=\"flex items-center gap-[3px]\">\n            <Typography.Text\n              data-testid={KnowledgeE2e.SegmentDetailTitle}\n              className={styles.title}\n              weight={500}\n              ellipsis={{\n                showTooltip: {\n                  opts: { content: dataSetDetail?.name },\n                },\n              }}\n            >\n              {dataSetDetail?.name}\n            </Typography.Text>\n            {canEdit ? (\n              <Tooltip content={I18n.t('datasets_segment_edit')}>\n                <IconButton\n                  data-testid={KnowledgeE2e.SegmentDetailTitleEditIcon}\n                  size=\"mini\"\n                  color=\"secondary\"\n                  icon={<IconCozEdit className=\"text-[14px]\" />}\n                  iconPosition=\"left\"\n                  wrapperClass=\"text-[0] leading-none\"\n                  className=\"coz-fg-secondary\"\n                  onClick={() => {\n                    edit({\n                      id: dataSetDetail.dataset_id || '',\n                      name: dataSetDetail?.name,\n                      description: dataSetDetail?.description,\n                      icon_uri: [\n                        {\n                          url: dataSetDetail?.icon_url || '',\n                          uid: dataSetDetail?.icon_uri || '',\n                        },\n                      ],\n                    });\n                  }}\n                />\n              </Tooltip>\n            ) : null}\n            {FLAGS['bot.data.knowledge_bots_count'] ? (\n              <div className={styles['bot-count']}>\n                <div className={styles['bot-count-text']}>\n                  {I18n.t('knowledge_optimize_019', {\n                    n: dataSetDetail?.bot_used_count ?? 0,\n                  })}\n                </div>\n                {!!dataSetDetail?.bot_used_count && (\n                  <Tooltip\n                    autoAdjustOverflow={true}\n                    position={\n                      dataSetDetail?.bot_used_count > 2 ? 'bottom' : 'top'\n                    }\n                    content={\n                      <RelatedBotsList\n                        datasetId={dataSetDetail?.dataset_id ?? ''}\n                        classNameItem={styles['bot-used-count']}\n                      />\n                    }\n                  >\n                    <IconCozInfoCircle className={styles['bot-count-icon']} />\n                  </Tooltip>\n                )}\n              </div>\n            ) : null}\n          </div>\n          <HeaderTags\n            dataSetDetail={dataSetDetail}\n            docInfo={documentList?.[0]}\n            progressMap={progressMap}\n          />\n        </div>\n      </div>\n      <div>\n        <Space spacing={10}>\n          {isImageFormat ? <PhotoFilter /> : null}\n          {isShowResegmentBtn ? textConfigButton : null}\n          {showTableConfigButton ? tableConfigButton : null}\n          {canEdit ? importKnowledgeSourceButton : null}\n        </Space>\n      </div>\n      {editKnowledgeModal}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\n\nimport { ImportKnowledgeSourceButton } from '@/features/import-knowledge-source-button/base';\nimport { KnowledgeIDENavBar as KnowledgeIDENavBarComponent } from '@/components/knowledge-nav-bar';\n\nimport { type KnowledgeIDENavBarProps } from '../module';\n\nexport const BaseKnowledgeIDENavBar = (props: KnowledgeIDENavBarProps) => {\n  const { progressMap, hideBackButton, importKnowledgeSourceButton } = props;\n  const { setDataSetDetail } = useKnowledgeStore(\n    useShallow(state => ({\n      setDataSetDetail: state.setDataSetDetail,\n    })),\n  );\n  return (\n    <KnowledgeIDENavBarComponent\n      {...props}\n      importKnowledgeSourceButton={\n        importKnowledgeSourceButton ?? <ImportKnowledgeSourceButton />\n      }\n      onChangeDataset={setDataSetDetail}\n      progressMap={progressMap}\n      hideBackButton={hideBackButton}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Menu } from '@coze-arch/coze-design';\n\ninterface KnowledgeSourceMenuItemProps {\n  value?: string;\n  onClick?: (value: string) => void;\n  title: string;\n  icon?: React.ReactNode;\n  testId?: string;\n}\n\nexport const KnowledgeSourceMenuItem = (\n  props: KnowledgeSourceMenuItemProps,\n) => {\n  const { title, icon, testId, value, onClick } = props;\n  return (\n    <Menu.Item\n      key={value}\n      icon={icon ?? null}\n      onClick={() => {\n        if (value && onClick) {\n          onClick.call(this, value);\n        }\n      }}\n      data-testid={testId}\n    >\n      {title}\n    </Menu.Item>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocument } from '@coze-arch/coze-design/icons';\n\nimport { KnowledgeSourceMenuItem } from '@/components/knowledge-source-menu-item';\n\nimport {\n  type ImportKnowledgeMenuSourceModule,\n  type ImportKnowledgeMenuSourceModuleProps,\n} from '../module';\n\nexport const TextLocal = (props: ImportKnowledgeMenuSourceModuleProps) => {\n  const { onClick } = props;\n  return (\n    <KnowledgeSourceMenuItem\n      title={I18n.t('datasets_createFileModel_step1_LocalTitle')}\n      icon={<IconCozDocument className=\"w-4 h-4\" />}\n      testId={`${KnowledgeE2e.SegmentDetailDropdownItem}.${UnitType.TEXT_DOC}`}\n      value={UnitType.TEXT_DOC}\n      onClick={() => onClick(UnitType.TEXT_DOC)}\n    />\n  );\n};\n\nexport const TextLocalModule: ImportKnowledgeMenuSourceModule = {\n  Component: TextLocal,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPencilPaper } from '@coze-arch/coze-design/icons';\n\nimport { KnowledgeSourceMenuItem } from '@/components/knowledge-source-menu-item';\n\nimport {\n  type ImportKnowledgeMenuSourceModule,\n  type ImportKnowledgeMenuSourceModuleProps,\n} from '../module';\n\nexport const TextCustom = (props: ImportKnowledgeMenuSourceModuleProps) => {\n  const { onClick } = props;\n  return (\n    <KnowledgeSourceMenuItem\n      title={I18n.t('datasets_createFileModel_step1_CustomTitle')}\n      icon={<IconCozPencilPaper className=\"w-4 h-4\" />}\n      testId={`${KnowledgeE2e.SegmentDetailDropdownItem}.${UnitType.TEXT_CUSTOM}`}\n      value={UnitType.TEXT_CUSTOM}\n      onClick={() => onClick(UnitType.TEXT_CUSTOM)}\n    />\n  );\n};\n\nexport const TextCustomModule: ImportKnowledgeMenuSourceModule = {\n  Component: TextCustom,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPencilPaper } from '@coze-arch/coze-design/icons';\n\nimport { KnowledgeSourceMenuItem } from '@/components/knowledge-source-menu-item';\n\nimport {\n  type ImportKnowledgeMenuSourceModule,\n  type ImportKnowledgeMenuSourceModuleProps,\n} from '../module';\n\nexport const TableCustom = (props: ImportKnowledgeMenuSourceModuleProps) => {\n  const { onClick } = props;\n  return (\n    <KnowledgeSourceMenuItem\n      title={I18n.t('datasets_createFileModel_step1_TabCustomTitle')}\n      icon={<IconCozPencilPaper className=\"w-4 h-4\" />}\n      testId={`${KnowledgeE2e.SegmentDetailDropdownItem}.${UnitType.TABLE_CUSTOM}`}\n      value={UnitType.TABLE_CUSTOM}\n      onClick={() => onClick(UnitType.TABLE_CUSTOM)}\n    />\n  );\n};\n\nexport const TableCustomModule: ImportKnowledgeMenuSourceModule = {\n  Component: TableCustom,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocument } from '@coze-arch/coze-design/icons';\n\nimport { KnowledgeSourceMenuItem } from '@/components/knowledge-source-menu-item';\n\nimport {\n  type ImportKnowledgeMenuSourceModule,\n  type ImportKnowledgeMenuSourceModuleProps,\n} from '../module';\n\nexport const TableLocal = (props: ImportKnowledgeMenuSourceModuleProps) => {\n  const { onClick } = props;\n  return (\n    <KnowledgeSourceMenuItem\n      title={I18n.t('datasets_createFileModel_step1_TabLocalTitle')}\n      icon={<IconCozDocument className=\"w-4 h-4\" />}\n      testId={`${KnowledgeE2e.SegmentDetailDropdownItem}.${UnitType.TABLE_DOC}`}\n      value={UnitType.TABLE_DOC}\n      onClick={() => onClick(UnitType.TABLE_DOC)}\n    />\n  );\n};\n\nexport const TableLocalModule: ImportKnowledgeMenuSourceModule = {\n  Component: TableLocal,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozDocument } from '@coze-arch/coze-design/icons';\n\nimport { KnowledgeSourceMenuItem } from '@/components/knowledge-source-menu-item';\n\nimport {\n  type ImportKnowledgeMenuSourceModule,\n  type ImportKnowledgeMenuSourceModuleProps,\n} from '../module';\n\nexport const ImageLocal = (props: ImportKnowledgeMenuSourceModuleProps) => {\n  const { onClick } = props;\n  return (\n    <KnowledgeSourceMenuItem\n      title={I18n.t('knowledge_photo_002')}\n      icon={<IconCozDocument className=\"w-4 h-4\" />}\n      testId={`${KnowledgeE2e.SegmentDetailDropdownItem}.${UnitType.IMAGE_FILE}`}\n      value={UnitType.IMAGE_FILE}\n      onClick={() => onClick(UnitType.IMAGE_FILE)}\n    />\n  );\n};\n\nexport const ImageLocalModule: ImportKnowledgeMenuSourceModule = {\n  Component: ImageLocal,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureRegistry } from '@coze-data/feature-register';\n\nimport { type ImportKnowledgeMenuSourceModule } from './module';\n\nexport type ImportKnowledgeMenuSourceFeatureType =\n  | 'text-local'\n  | 'text-custom'\n  | 'table-custom'\n  | 'table-local'\n  | 'image-local'\n  | 'image-custom';\n\nexport type ImportKnowledgeMenuSourceRegistry = FeatureRegistry<\n  ImportKnowledgeMenuSourceFeatureType,\n  ImportKnowledgeMenuSourceModule\n>;\n\nexport const createImportKnowledgeMenuSourceFeatureRegistry = (\n  name: string,\n): ImportKnowledgeMenuSourceRegistry =>\n  new FeatureRegistry<\n    ImportKnowledgeMenuSourceFeatureType,\n    ImportKnowledgeMenuSourceModule\n  >({\n    name,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { KnowledgeIDEBaseLayout } from '@coze-data/knowledge-ide-base/layout/base';\nimport {\n  type TextKnowledgeWorkspaceProps,\n  TextKnowledgeWorkspace,\n} from '@coze-data/knowledge-ide-base/features/text-knowledge-workspace';\nimport { BaseKnowledgeIDENavBar } from '@coze-data/knowledge-ide-base/features/nav-bar/base';\nimport {\n  KnowledgeIDERegistryContext,\n  type KnowledgeIDERegistry,\n} from '@coze-data/knowledge-ide-base/context/knowledge-ide-registry-context';\n\nimport { type BaseKnowledgeIDEProps } from '../types';\nimport { importKnowledgeSourceMenuContributes } from './import-knowledge-source-menu-contributes';\n\nexport interface BaseKnowledgeTextIDEProps extends BaseKnowledgeIDEProps {\n  contentProps?: Partial<TextKnowledgeWorkspaceProps>;\n}\n\nconst registryContextValue: KnowledgeIDERegistry = {\n  importKnowledgeMenuSourceFeatureRegistry:\n    importKnowledgeSourceMenuContributes,\n};\n\nexport const BaseKnowledgeTextIDE = (props: BaseKnowledgeTextIDEProps) => (\n  <KnowledgeIDERegistryContext.Provider value={registryContextValue}>\n    <KnowledgeIDEBaseLayout\n      renderNavBar={({ statusInfo }) => (\n        <BaseKnowledgeIDENavBar\n          progressMap={statusInfo.progressMap}\n          {...props.navBarProps}\n        />\n      )}\n      renderContent={({ dataActions, statusInfo }) => (\n        <TextKnowledgeWorkspace\n          progressMap={statusInfo.progressMap}\n          reload={dataActions.refreshData}\n          onChangeDocList={dataActions.updateDocumentList}\n          linkOriginUrlButton={props.contentProps?.linkOriginUrlButton}\n          fetchSliceButton={props.contentProps?.fetchSliceButton}\n        />\n      )}\n      {...props.layoutProps}\n    />\n  </KnowledgeIDERegistryContext.Provider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { useScrollListSliceReq } from '@/service';\n\nexport const useGetSliceListData = () => {\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const curDocId = documentList?.[0]?.document_id;\n  // load data\n  const {\n    data: sliceListData,\n    mutate: mutateSliceListData,\n    reload: reloadSliceList,\n    loadMore: loadMoreSliceList,\n    loading: isLoadingSliceList,\n    loadingMore: isLoadingMoreSliceList,\n  } = useScrollListSliceReq({\n    params: {\n      document_id: curDocId,\n    },\n    reloadDeps: [curDocId],\n    target: null,\n    onError: error => {\n      dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n        eventName: ReportEventNames.KnowledgeGetSliceList,\n        error,\n      });\n\n      Toast.error(I18n.t('knowledge_document_view'));\n    },\n  });\n\n  return {\n    sliceListData,\n    mutateSliceListData,\n    reloadSliceList,\n    loadMoreSliceList,\n    isLoadingMoreSliceList,\n    isLoadingSliceList,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\nimport { type MutableRefObject } from 'react';\n\nimport { type TableViewMethods } from '@coze-common/table-view';\n\n// Context related to table UI\ninterface TableUIContextType {\n  tableViewRef: MutableRefObject<TableViewMethods | null>;\n  isLoadingMoreSliceList: boolean;\n  isLoadingSliceList: boolean;\n  isShowAddBtn: boolean;\n}\n\nexport const TableUIContext = createContext<TableUIContextType | null>(null);\n\nexport const useTableUI = () => {\n  const context = useContext(TableUIContext);\n  if (!context) {\n    throw new Error('useTableUI must be used within a TableUIProvider');\n  }\n  return context;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type DatasetDataScrollList } from '@/service';\n\n// Context related to tabular data\ninterface TableDataContextType {\n  sliceListData: DatasetDataScrollList;\n  curIndex: number;\n  curSliceId: string;\n  delSliceIds: string[];\n}\n\nexport const TableDataContext = createContext<TableDataContextType | null>(\n  null,\n);\n\nexport const useTableData = () => {\n  const context = useContext(TableDataContext);\n  if (!context) {\n    throw new Error('useTableData must be used within a TableDataProvider');\n  }\n  return context;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type DatasetDataScrollList } from '@/service';\n\n// Context related to table manipulation\ninterface TableActionsContextType {\n  setCurIndex: (index: number | ((prev: number) => number)) => void;\n  setCurSliceId: (id: string | ((prev: string) => string)) => void;\n  setDelSliceIds: (ids: string[] | ((prev: string[]) => string[])) => void;\n  loadMoreSliceList: () => void;\n  mutateSliceListData: (data: DatasetDataScrollList) => void;\n}\n\nexport const TableActionsContext =\n  createContext<TableActionsContextType | null>(null);\n\nexport const useTableActions = () => {\n  const context = useContext(TableActionsContext);\n  if (!context) {\n    throw new Error(\n      'useTableActions must be used within a TableActionsProvider',\n    );\n  }\n  return context;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { get } from 'lodash-es';\nimport { getDataTypeText } from '@coze-data/utils';\nimport { getSrcFromImg } from '@coze-data/knowledge-modal-base';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport {\n  TextRender,\n  ActionsRender,\n  TagRender,\n  ImageRender,\n  type TableViewRecord,\n  type TableViewColumns,\n  colWidthCacheService,\n} from '@coze-common/table-view';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tag, Tooltip, Typography } from '@coze-arch/coze-design';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport { ColumnType, SliceStatus } from '@coze-arch/bot-api/knowledge';\n\nimport { type TranSliceListParams } from '@/types/slice';\n\nconst MAX_WIDTH = 1400;\nconst MIN_WIDTH = 200;\nconst DIFF_WIDTH = 397;\nconst READONLY_DIFF_WIDTH = 259;\n\nexport function isNoMore(data, pageSize) {\n  return Boolean(\n    !data?.total || (data.nextPageIndex - 1) * pageSize >= data.total,\n  );\n}\n\nexport function isStop(res) {\n  return res?.list?.length || res?.total;\n}\n\nconst ColumnTypeComp = (props: { columnType: ColumnType }) => (\n  <Tag color=\"primary\" className=\"ml-[6px] text-xs\" size=\"mini\">\n    {getDataTypeText(props.columnType)}\n  </Tag>\n);\n\nconst getTableCacheWidthMap = (tableKey: string) => {\n  try {\n    return colWidthCacheService.getTableWidthMap(tableKey) ?? {};\n  } catch (e) {\n    console.log('getTableCacheWidthMap error', e);\n    return {};\n  }\n};\n\n/**\n * Slice data to the data type received by the TableView component\n */\n\nexport const getTableRenderColumnsData = ({\n  sliceList,\n  metaData = [],\n  onEdit,\n  onUpdate,\n  onDelete,\n  canEdit,\n  tableKey,\n}: TranSliceListParams): {\n  data: TableViewRecord[];\n  columns: TableViewColumns[];\n} => {\n  try {\n    const dom = document.getElementsByClassName(\n      'knowledge-ide-base-slice-list-ui-content',\n    )[0];\n    const cacheWidthMap = getTableCacheWidthMap(tableKey);\n    const maxWidth = dom\n      ? (dom as HTMLElement).offsetWidth -\n        (canEdit ? DIFF_WIDTH : READONLY_DIFF_WIDTH)\n      : MAX_WIDTH;\n    const res: TableViewRecord[] = sliceList.map(slice => {\n      const { char_count, hit_count, status } = slice;\n      const record = { char_count, hit_count, status };\n      const sliceArr = safeJSONParse(slice.content);\n      if (Array.isArray(sliceArr)) {\n        sliceArr.forEach(sliceData => {\n          record[sliceData.column_id] = sliceData.value;\n        });\n      }\n      return record;\n    });\n    const dataWidth =\n      maxWidth / metaData.length > MIN_WIDTH\n        ? maxWidth / metaData.length\n        : MIN_WIDTH;\n    const columns: TableViewColumns[] = metaData.map((meta, columnIndex) => ({\n      dataIndex: meta.id,\n      title: (\n        <div className=\"flex flex-row items-center\">\n          <Typography.Text\n            className=\"cursor-pointer\"\n            ellipsis={{\n              showTooltip: {\n                opts: { content: meta.column_name },\n              },\n            }}\n          >\n            {meta.column_name}\n          </Typography.Text>\n          {meta.is_semantic ? (\n            <Tag\n              size=\"mini\"\n              color=\"green\"\n              className=\"ml-2\"\n              data-testid={KnowledgeE2e.TableLocalPreviewSemantic}\n            >\n              {I18n.t('knowledge_1226_001')}\n            </Tag>\n          ) : null}\n          {meta.column_type ? (\n            <ColumnTypeComp columnType={meta.column_type} />\n          ) : null}\n        </div>\n      ),\n      width: get(cacheWidthMap, meta.id || '') ?? dataWidth,\n      render: (text, record, index) => {\n        const isEditing =\n          columnIndex === 0 &&\n          index === sliceList.length - 1 &&\n          !!sliceList[index].addId;\n        if (meta.column_type === ColumnType.Image) {\n          const srcList = getSrcFromImg(text);\n          return (\n            <ImageRender\n              srcList={srcList}\n              onChange={(src, tosKey) => {\n                let val = '';\n                if (src || tosKey) {\n                  val = `<img src=\"${src ?? ''}\" ${\n                    tosKey ? `data-tos-key=\"${tosKey}\"` : ''\n                  }>`;\n                }\n                const newRecord = { ...record, [meta?.id as string]: val };\n                onUpdate?.(newRecord, index);\n              }}\n            />\n          );\n        }\n        // Highlighting violations\n        const isAudiFailed = record?.status === SliceStatus.AuditFailed;\n        const textRender = () => (\n          <div className={`w-full ${isAudiFailed ? 'text-red-500' : ''}`}>\n            <TextRender\n              dataIndex={meta.id}\n              value={text}\n              record={record}\n              index={index}\n              isEditing={isEditing}\n              editable={canEdit}\n              validator={{\n                validate: value => {\n                  if (meta.is_semantic) {\n                    return !value || value === '';\n                  }\n                  return false;\n                },\n                errorMsg: I18n.t('datasets_url_empty'),\n              }}\n              onBlur={async (_text, updateRecord) =>\n                await onUpdate?.(updateRecord, index, _text as string)\n              }\n            />\n          </div>\n        );\n        if (isAudiFailed) {\n          return (\n            <Tooltip\n              content={I18n.t('knowledge_content_illegal_error_msg')}\n              trigger=\"hover\"\n              position=\"top\"\n              getPopupContainer={() => document.body}\n            >\n              {textRender()}\n            </Tooltip>\n          );\n        }\n        return textRender();\n      },\n    }));\n    columns.push({\n      title: '',\n      className: 'not-resize-handle data-tags',\n      resize: false,\n      render: (_text, record, _index) => {\n        const { char_count, hit_count } = record;\n        return (\n          <div className=\"flex gap-3\">\n            <TagRender\n              value={`${char_count ?? 0} ${I18n.t('datasets_segment_card_bit', {\n                num: char_count ?? 0,\n              })}`}\n            />\n            <TagRender\n              value={I18n.t('datasets_segment_card_hit', {\n                num: hit_count ?? 0,\n              })}\n            />\n          </div>\n        );\n      },\n    });\n    if (canEdit) {\n      columns.push({\n        title: '',\n        width: 100,\n        className: 'not-resize-handle',\n        resize: false,\n        render: (_text, record, index) => (\n          <ActionsRender\n            record={record}\n            index={index}\n            editProps={{\n              disabled: false,\n              onEdit: () => {\n                onEdit?.(record, index);\n              },\n            }}\n            deleteProps={{\n              disabled: false,\n              onDelete: () => {\n                onDelete?.([index]);\n              },\n            }}\n          />\n        ),\n      });\n    }\n    columns.unshift({\n      title: '',\n      width: 68,\n      fixed: true,\n      resize: false,\n      className: 'pl-0 text-sm not-resize-handle',\n      render: (_text, _record, index) => (\n        <div className=\"text-xs coz-fg-secondary\">{index + 1}</div>\n      ),\n    });\n    return {\n      data: res,\n      columns,\n    };\n  } catch (error) {\n    console.log('transSliceList handler error', error);\n    return {\n      data: [],\n      columns: [],\n    };\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\n\nimport { type ISliceInfo } from '@/types/slice';\nimport { useCreateSlice as useCreateSliceService } from '@/service/slice';\n\nimport { useTableData } from '../../context/table-data-context';\nimport { useTableActions } from '../../context/table-actions-context';\n\nexport const useCreateSlice = () => {\n  const dataSetDetail = useKnowledgeStore(state => state.dataSetDetail);\n  const setDataSetDetail = useKnowledgeStore(state => state.setDataSetDetail);\n  const { sliceListData } = useTableData();\n  const { mutateSliceListData } = useTableActions();\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const curDoc = documentList?.[0];\n\n  // Create slice\n  const { createSlice } = useCreateSliceService({\n    onReload: (createItem: ISliceInfo) => {\n      const list =\n        (sliceListData?.list ?? []).filter(item => !item.addId) ?? [];\n      const createSliceContent = JSON.parse(createItem.content ?? '{}');\n      const itemContent = (curDoc?.table_meta ?? []).reduce(\n        (\n          prev: { column_name: string; column_id: string; value: string }[],\n          cur,\n        ) => {\n          prev.push({\n            column_name: cur?.column_name ?? '',\n            column_id: cur?.id ?? '',\n            value: cur.id ? createSliceContent[cur.id] : '',\n          });\n          return prev;\n        },\n        [],\n      );\n      list.push({\n        ...createItem,\n        content: JSON.stringify(itemContent),\n      });\n\n      mutateSliceListData({\n        ...sliceListData,\n        total: Number(sliceListData?.total ?? '0'),\n        list,\n      });\n\n      if (dataSetDetail) {\n        setDataSetDetail({\n          ...dataSetDetail,\n          slice_count: list?.length ?? 0,\n        });\n      }\n    },\n  });\n\n  return {\n    createSlice,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { transSliceContentOutput } from '@coze-data/knowledge-modal-base';\nimport { type TableViewRecord } from '@coze-common/table-view';\nimport { ColumnType } from '@coze-arch/bot-api/knowledge';\n\nimport { type DatasetDataScrollList, updateSlice } from '@/service';\n\nimport { useCreateSlice } from '../inner/use-create-slice';\nimport { useTableUI } from '../../context/table-ui-context';\nimport { useTableData } from '../../context/table-data-context';\nimport { useTableActions } from '../../context/table-actions-context';\n\nexport const useTableSliceOperations = ({\n  openDeleteSliceModal,\n  openTableSegmentModal,\n}: {\n  openDeleteSliceModal: () => void;\n  openTableSegmentModal: (content: string) => void;\n}) => {\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const { mutateSliceListData, setDelSliceIds, setCurIndex, setCurSliceId } =\n    useTableActions();\n  const { createSlice } = useCreateSlice();\n  const { sliceListData } = useTableData();\n  const { tableViewRef } = useTableUI();\n  const curDoc = documentList?.[0];\n  const slices = sliceListData?.list;\n\n  const handleDeleteSlice = (indexs: number[]) => {\n    if (!slices) {\n      return;\n    }\n\n    /** new row */\n    const addIndex = indexs.filter(i => !slices[i].slice_id);\n    const addIds = addIndex.map(i => slices[i]?.addId);\n    const oldIndex = indexs.filter(v => !addIndex.includes(v));\n    // Make sure to filter out undefined values\n    const sliceIds = oldIndex\n      .map(i => slices[i].slice_id)\n      .filter(Boolean) as string[];\n\n    if (addIds.length && sliceIds.length <= 0) {\n      mutateSliceListData({\n        ...sliceListData,\n        total: Number(sliceListData?.total ?? '0'),\n        list: slices.filter(item => !addIds.includes(item?.addId)),\n      } satisfies DatasetDataScrollList);\n      tableViewRef?.current?.resetSelected();\n    }\n\n    if (sliceIds.length) {\n      setDelSliceIds(sliceIds);\n      openDeleteSliceModal();\n    }\n  };\n\n  const handleCreateSlice = (createParams: string) => {\n    if (!curDoc?.document_id) {\n      return;\n    }\n\n    try {\n      return {\n        document_id: curDoc.document_id,\n        raw_text: createParams,\n      };\n    } catch (error) {\n      console.log('error', error);\n      return null;\n    }\n  };\n\n  const handleUpdateSliceData = async (\n    record: TableViewRecord,\n    index: number,\n    updateValue?: string,\n  ) => {\n    if (!slices) {\n      return;\n    }\n\n    const oldData = cloneDeep(sliceListData);\n    try {\n      const sliceId = slices[index].slice_id;\n      const filterRecord = Object.fromEntries(\n        Object.entries(record).filter(\n          ([key]) => !['tableViewKey', 'char_count', 'hit_count'].includes(key),\n        ),\n      );\n\n      const ImageIds: string[] = [];\n      curDoc?.table_meta?.forEach(meta => {\n        if (meta.column_type === ColumnType.Image) {\n          ImageIds.push(meta.id as string);\n        }\n      });\n\n      const formatRecord = Object.fromEntries(\n        Object.entries(filterRecord).map(([key, value]) => {\n          if (ImageIds.includes(key)) {\n            return [key, transSliceContentOutput(value as string)];\n          }\n          return [key, value];\n        }),\n      );\n\n      const updateParams = { ...formatRecord };\n      delete updateParams.status;\n      const updateContent = JSON.stringify(updateParams);\n\n      if (sliceId) {\n        await updateSlice(sliceId as string, updateContent, updateValue);\n      } else {\n        /** Add sharding */\n        const createParams = await handleCreateSlice(updateContent);\n        if (createParams && createSlice && curDoc?.document_id) {\n          // Call the createSlice method passed in to create a new sharding.\n          try {\n            // Here you need to use the createSlice method passed in the props to call the API.\n            await createSlice({\n              document_id: curDoc.document_id,\n              raw_text: updateContent,\n            });\n          } catch (error) {\n            console.log('createSlice error:', error);\n          }\n        }\n      }\n\n      // Change to update after the interface request is successful\n      if (slices) {\n        return true;\n      }\n    } catch (error) {\n      console.log(error);\n      mutateSliceListData(oldData);\n      throw Error(error as string);\n    }\n  };\n\n  /** Pop-up editing slice */\n  const handleModalEditSlice = (_record: TableViewRecord, index: number) => {\n    if (!slices || index < 0 || index >= slices.length) {\n      return;\n    }\n\n    setCurIndex(index);\n    setCurSliceId(slices[index]?.slice_id || '');\n    openTableSegmentModal(slices[index]?.content || '');\n  };\n\n  return {\n    deleteSlice: handleDeleteSlice,\n    createSlice: handleCreateSlice,\n    modalEditSlice: handleModalEditSlice,\n    rowUpdateSliceData: handleUpdateSliceData,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport {\n  ModalActionType,\n  useTableSegmentModal as useBaseTableSegmentModal,\n} from '@coze-data/knowledge-modal-base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { SliceStatus } from '@coze-arch/bot-api/knowledge';\n\nimport { useTableData } from '../../context/table-data-context';\nimport { useTableActions } from '../../context/table-actions-context';\n\nexport const useTableSegmentModal = () => {\n  const documentList = useKnowledgeStore(state => state.documentList);\n\n  const { sliceListData, curIndex, curSliceId } = useTableData();\n  const { mutateSliceListData } = useTableActions();\n  const curDoc = documentList?.[0];\n\n  // table segmentation pop-up\n  const {\n    node: tableSegmentModalNode,\n    edit: openTableSegmentModal,\n    fetchCreateTableSegment,\n    fetchUpdateTableSegment,\n  } = useBaseTableSegmentModal({\n    title:\n      curIndex > -1 ? (\n        <div className=\"slice-modal-title\">\n          {I18n.t('datasets_segment_detailModel_title', { num: curIndex + 1 })}\n        </div>\n      ) : (\n        I18n.t('dataset_segment_content')\n      ),\n    meta: curDoc?.table_meta || [],\n    canEdit: true,\n    onSubmit: async (actionType, tData) => {\n      if (actionType === ModalActionType.Create && curDoc?.document_id) {\n        await fetchCreateTableSegment(curDoc?.document_id, tData);\n      } else if (actionType === ModalActionType.Edit && curSliceId) {\n        await fetchUpdateTableSegment(curSliceId, tData);\n      }\n    },\n    onFinish: (actionType, tData) => {\n      if (actionType === ModalActionType.Create) {\n        Toast.success({\n          content: I18n.t('knowledge_tableview_03'),\n          showClose: false,\n        });\n      } else if (actionType === ModalActionType.Edit) {\n        if (sliceListData) {\n          const updateContent = JSON.stringify(tData);\n          const newList = sliceListData.list;\n          newList[curIndex].content = updateContent;\n          newList[curIndex].status = SliceStatus.FinishVectoring;\n          mutateSliceListData({\n            ...sliceListData,\n            list: newList,\n          });\n        }\n      }\n    },\n  });\n\n  return {\n    tableSegmentModalNode,\n    openTableSegmentModal,\n    fetchCreateTableSegment,\n    fetchUpdateTableSegment,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { useSliceDeleteModal } from '@coze-data/knowledge-modal-base';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { delSlice } from '@/service';\n\nimport { useTableUI } from '../../context/table-ui-context';\nimport { useTableData } from '../../context/table-data-context';\nimport { useTableActions } from '../../context/table-actions-context';\n\nexport const useDeleteSliceModal = () => {\n  // external data\n  const dataSetDetail = useKnowledgeStore(state => state.dataSetDetail);\n  const setDataSetDetail = useKnowledgeStore(state => state.setDataSetDetail);\n  const documentList = useKnowledgeStore(state => state.documentList);\n\n  // internal data\n  const { sliceListData, delSliceIds } = useTableData();\n  const { tableViewRef } = useTableUI();\n  const { mutateSliceListData } = useTableActions();\n\n  const curDoc = documentList?.[0];\n  const slices = sliceListData?.list;\n\n  // Delete slice pop-up\n  const { node: deleteSliceModalNode, delete: openDeleteSliceModal } =\n    useSliceDeleteModal({\n      onDel: async () => {\n        try {\n          await delSlice(delSliceIds);\n          if (!curDoc) {\n            return;\n          }\n          Toast.success({\n            content: I18n.t('Delete_success'),\n            showClose: false,\n          });\n          console.log('oldList', slices);\n          const newList = (slices || []).filter(\n            lItem =>\n              !delSliceIds.includes(lItem.slice_id ?? '') &&\n              !delSliceIds.includes(lItem.addId ?? ''),\n          );\n          mutateSliceListData({\n            ...sliceListData,\n            list: newList,\n          });\n          console.log('newList', newList);\n          tableViewRef?.current?.resetSelected();\n          if (dataSetDetail && typeof dataSetDetail.slice_count === 'number') {\n            setDataSetDetail({\n              ...dataSetDetail,\n              slice_count:\n                dataSetDetail.slice_count > -1\n                  ? Math.max(\n                      0,\n                      dataSetDetail.slice_count - (delSliceIds?.length || 0),\n                    )\n                  : 0,\n            });\n          }\n        } catch (error) {\n          dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n            eventName: ReportEventNames.KnowledgeDeleteSlice,\n            error: error as Error,\n          });\n        }\n      },\n    });\n\n  return {\n    deleteSliceModalNode,\n    openDeleteSliceModal,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\n\nimport { type ISliceInfo } from '@/types/slice';\n\nimport { useTableData } from '../../context/table-data-context';\nimport { useTableActions } from '../../context/table-actions-context';\n\nconst ADD_BTN_HEIGHT = 56;\n\ninterface UseAddRowProps {\n  increaseTableHeight: (height: number) => void;\n  scrollTableBodyToBottom: () => void;\n}\n\nexport const useAddRow = ({\n  increaseTableHeight,\n  scrollTableBodyToBottom,\n}: UseAddRowProps) => {\n  const { sliceListData } = useTableData();\n  const { mutateSliceListData } = useTableActions();\n  const handleAddRow = () => {\n    /** Increase the height of the container first */\n    increaseTableHeight(ADD_BTN_HEIGHT);\n    const items = JSON.parse(sliceListData?.list[0]?.content ?? '[]');\n\n    const addItemContent = items?.map(v => ({\n      ...v,\n      value: '',\n      char_count: 0,\n      hit_count: 0,\n    }));\n\n    mutateSliceListData({\n      ...sliceListData,\n      total: Number(sliceListData?.total ?? '0'),\n      list: sliceListData?.list.concat([\n        { content: JSON.stringify(addItemContent), addId: nanoid() },\n      ]) as ISliceInfo[],\n    });\n\n    scrollTableBodyToBottom();\n  };\n\n  return {\n    handleAddRow,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useTableUI } from '../../context/table-ui-context';\nimport { useTableData } from '../../context/table-data-context';\n\nexport const useTableHeight = () => {\n  const { tableViewRef, isShowAddBtn } = useTableUI();\n  const { sliceListData } = useTableData();\n  const [tableH, setTableHeight] = useState<number | string>(0);\n\n  // Update table height\n  useEffect(() => {\n    const h = tableViewRef?.current?.getTableHeight();\n    if (h) {\n      setTableHeight(isShowAddBtn ? h : '100%');\n    }\n  }, [sliceListData, isShowAddBtn, tableViewRef]);\n\n  const increaseTableHeight = (addBtnHeight: number) => {\n    setTableHeight(Number(tableH ?? '0') + addBtnHeight);\n  };\n\n  return {\n    tableH,\n    increaseTableHeight,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useTableData } from '../../context/table-data-context';\n\nconst ADD_BTN_HEIGHT = 56;\n\nexport const useScroll = () => {\n  const { sliceListData } = useTableData();\n  // Scroll table to the bottom\n  const scrollTableBodyToBottom = () => {\n    const bodyDom = document.querySelector(\n      '.table-view-box .semi-table-container>.semi-table-body',\n    );\n    if (bodyDom && sliceListData?.list.length) {\n      bodyDom.scrollTop = sliceListData?.list.length * ADD_BTN_HEIGHT;\n    }\n  };\n\n  return {\n    scrollTableBodyToBottom,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classnames from 'classnames';\nimport {\n  useKnowledgeParamsStore,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { TableView } from '@coze-common/table-view';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { Button } from '@coze-arch/coze-design';\nimport { DocumentStatus } from '@coze-arch/bot-api/knowledge';\n\nimport styles from '../styles/index.module.less';\nimport { getTableRenderColumnsData } from '../service/use-case/get-table-render-columns-data';\nimport { useTableSliceOperations } from '../hooks/use-case/use-table-slice-operations';\nimport { useTableSegmentModal } from '../hooks/use-case/use-table-segment-modal';\nimport { useDeleteSliceModal } from '../hooks/use-case/use-delete-slice-modal';\nimport { useAddRow } from '../hooks/use-case/use-add-row';\nimport { useTableHeight } from '../hooks/inner/use-table-height';\nimport { useScroll } from '../hooks/inner/use-scroll';\nimport { useTableUI } from '../context/table-ui-context';\nimport { useTableData } from '../context/table-data-context';\nimport { useTableActions } from '../context/table-actions-context';\n\n// Table Content Component\nconst TableContent = () => {\n  const knowledgeIDEBiz = useKnowledgeParamsStore(state => state.params.biz);\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const curDoc = documentList?.[0];\n\n  const { tableViewRef, isLoadingMoreSliceList, isLoadingSliceList } =\n    useTableUI();\n\n  const { sliceListData } = useTableData();\n\n  const slices = sliceListData?.list;\n\n  const { loadMoreSliceList } = useTableActions();\n\n  const canEdit = Boolean(useKnowledgeStore(state => state.canEdit));\n\n  // Delete slice pop-up\n  const { deleteSliceModalNode, openDeleteSliceModal } = useDeleteSliceModal();\n\n  // Edit slice pop-up\n  const { tableSegmentModalNode, openTableSegmentModal } =\n    useTableSegmentModal();\n\n  // Get table manipulation method\n  const { deleteSlice, rowUpdateSliceData, modalEditSlice } =\n    useTableSliceOperations({\n      openDeleteSliceModal,\n      openTableSegmentModal,\n    });\n\n  const { tableH } = useTableHeight();\n\n  // If there is no data, return to empty directly\n  if (!slices?.length) {\n    return null;\n  }\n\n  const tableKey = curDoc?.document_id;\n\n  const { data: dataSource, columns } = getTableRenderColumnsData({\n    sliceList: slices,\n    metaData: curDoc?.table_meta,\n    onEdit: modalEditSlice,\n    onDelete: deleteSlice,\n    onUpdate: rowUpdateSliceData,\n    canEdit,\n    tableKey: tableKey || '',\n  });\n\n  return (\n    <div\n      className={classnames(\n        styles['table-view-container-box'],\n        'table-view-box',\n      )}\n      style={{ height: tableH }}\n    >\n      <TableView\n        tableKey={tableKey}\n        ref={tableViewRef}\n        className={classnames(\n          `${styles['unit-table-view']} ${\n            isLoadingMoreSliceList ? styles['table-view-loading'] : ''\n          }`,\n          knowledgeIDEBiz === 'project'\n            ? styles['table-preview-max']\n            : styles['table-preview-secondary'],\n        )}\n        resizable\n        dataSource={dataSource}\n        loading={isLoadingSliceList}\n        columns={columns}\n        rowSelect={canEdit}\n        isVirtualized\n        rowOperation={canEdit}\n        scrollToBottom={() => {\n          if (!isLoadingSliceList && !isLoadingMoreSliceList) {\n            loadMoreSliceList();\n          }\n        }}\n        editProps={{\n          onDelete: indexs => deleteSlice(indexs as number[]),\n          onEdit: (record, index) => {\n            modalEditSlice(record, index as number);\n          },\n        }}\n      />\n      {deleteSliceModalNode}\n      {tableSegmentModalNode}\n    </div>\n  );\n};\n\n// Add line button component\nconst AddRowButton = () => {\n  const { isShowAddBtn } = useTableUI();\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const curDoc = documentList?.[0];\n  const { increaseTableHeight } = useTableHeight();\n  const { scrollTableBodyToBottom } = useScroll();\n  const { handleAddRow } = useAddRow({\n    increaseTableHeight,\n    scrollTableBodyToBottom,\n  });\n\n  if (!isShowAddBtn) {\n    return null;\n  }\n\n  return (\n    <div className={styles['add-row-btn']}>\n      <Button\n        disabled={curDoc?.status === DocumentStatus.Processing}\n        data-testid={KnowledgeE2e.SegmentDetailContentAddRowBtn}\n        color=\"primary\"\n        size=\"default\"\n        icon={<IconCozPlus />}\n        onClick={handleAddRow}\n      >\n        {I18n.t('knowledge_optimize_0010')}\n      </Button>\n    </div>\n  );\n};\n\n// main component\nexport const TableDataView = () => {\n  const { sliceListData } = useTableData();\n  const slices = sliceListData?.list;\n\n  // If there is no data, only the add button is displayed.\n  if (!slices?.length) {\n    return <AddRowButton />;\n  }\n\n  return (\n    <>\n      <TableContent />\n      <AddRowButton />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useRef, useState } from 'react';\n\nimport classnames from 'classnames';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { type TableViewMethods } from '@coze-common/table-view';\nimport { I18n } from '@coze-arch/i18n';\nimport { EmptyState, Spin, Layout } from '@coze-arch/coze-design';\nimport { IconSegmentEmpty } from '@coze-arch/bot-icons';\nimport { type DocumentInfo } from '@coze-arch/bot-api/knowledge';\n\nimport styles from '../styles/index.module.less';\nimport { useGetSliceListData } from '../hooks/inner/use-get-slice-list-data';\nimport { TableUIContext } from '../context/table-ui-context';\nimport { TableDataContext } from '../context/table-data-context';\nimport { TableActionsContext } from '../context/table-actions-context';\nimport { TableDataView } from './table-data-view';\n\nconst MAX_TOTAL = 1000;\n\nexport interface TableKnowledgeWorkspaceProps {\n  onChangeDocList?: (docList: DocumentInfo[]) => void;\n  reload?: () => void;\n  isReloading: boolean;\n}\n\nexport const TableKnowledgeWorkspace = ({\n  isReloading,\n}: TableKnowledgeWorkspaceProps) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const contentWrapperRef = useRef<HTMLDivElement>(null);\n  const tableViewRef = useRef<TableViewMethods>(null);\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n  const documentList = useKnowledgeStore(state => state.documentList)?.filter(\n    doc => doc.document_id,\n  ) as { document_id: string }[];\n  const [curIndex, setCurIndex] = useState(0);\n  const [curSliceId, setCurSliceId] = useState('');\n  const [delSliceIds, setDelSliceIds] = useState<string[]>([]);\n\n  const {\n    sliceListData,\n    mutateSliceListData,\n    loadMoreSliceList,\n    isLoadingSliceList,\n    isLoadingMoreSliceList,\n  } = useGetSliceListData();\n\n  const slices = sliceListData?.list;\n\n  const isShowAddBtn = useMemo(\n    () =>\n      Boolean(\n        canEdit &&\n          !sliceListData?.hasMore &&\n          sliceListData?.total &&\n          sliceListData?.total < MAX_TOTAL,\n      ),\n    [canEdit, sliceListData],\n  );\n\n  const hasShowEmptyContent = useMemo(() => {\n    if (!documentList?.length && !isReloading) {\n      return true;\n    }\n    return (\n      sliceListData?.ready &&\n      !slices?.length &&\n      !(isLoadingMoreSliceList || isLoadingSliceList)\n    );\n  }, [\n    sliceListData,\n    documentList,\n    isReloading,\n    isLoadingMoreSliceList,\n    isLoadingSliceList,\n    slices,\n  ]);\n\n  // Creating UI Context Values\n  const uiContextValue = {\n    tableViewRef,\n    isLoadingMoreSliceList,\n    isLoadingSliceList,\n    isShowAddBtn,\n  };\n\n  // Creating Data Context Values\n  const dataContextValue = {\n    sliceListData: sliceListData || { list: [], total: 0 },\n    curIndex,\n    curSliceId,\n    delSliceIds,\n  };\n\n  // Create Action Context Value\n  const actionsContextValue = {\n    setCurIndex,\n    setCurSliceId,\n    setDelSliceIds,\n    loadMoreSliceList,\n    mutateSliceListData,\n  };\n\n  return (\n    <TableUIContext.Provider value={uiContextValue}>\n      <TableDataContext.Provider value={dataContextValue}>\n        <TableActionsContext.Provider value={actionsContextValue}>\n          <Layout.Content\n            ref={containerRef}\n            className={classnames(\n              styles['slice-list-ui-content'],\n              'knowledge-ide-base-slice-list-ui-content',\n            )}\n          >\n            <Spin\n              spinning={isLoadingSliceList}\n              wrapperClassName={styles.spin}\n              size=\"large\"\n              style={{ width: '100%', height: '100%' }}\n            >\n              {slices?.length ? (\n                <div\n                  ref={contentWrapperRef}\n                  className={styles['slice-list-table']}\n                >\n                  <TableDataView />\n                </div>\n              ) : null}\n              {hasShowEmptyContent && !isLoadingSliceList ? (\n                <div className={styles['empty-content']}>\n                  <EmptyState\n                    size=\"large\"\n                    icon={\n                      <IconSegmentEmpty\n                        style={{ width: 150, height: '100%' }}\n                      />\n                    }\n                    title={I18n.t('dataset_segment_empty_desc')}\n                  />\n                </div>\n              ) : null}\n            </Spin>\n          </Layout.Content>\n        </TableActionsContext.Provider>\n      </TableDataContext.Provider>\n    </TableUIContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type ReactNode } from 'react';\n\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport {\n  IconCozSetting,\n  IconCozArrowUp,\n  IconCozArrowDown,\n} from '@coze-arch/coze-design/icons';\nimport { Button, Menu } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\nexport interface KnowledgeConfigMenuProps {\n  children: ReactNode;\n}\n\nexport const KnowledgeConfigMenu = (props: KnowledgeConfigMenuProps) => {\n  const { children } = props;\n  const [visible, setVisible] = useState(false);\n  return (\n    <Menu\n      clickToHide\n      keepDOM\n      trigger=\"click\"\n      position=\"bottomRight\"\n      onVisibleChange={setVisible}\n      render={\n        <Menu.SubMenu mode=\"menu\" className={styles['table-config-menu-down']}>\n          {children}\n        </Menu.SubMenu>\n      }\n    >\n      <Button\n        className={styles['action-btn']}\n        data-testid={KnowledgeE2e.SegmentDetailSystemBtn}\n        icon={\n          visible ? (\n            <IconCozArrowUp className={'text-[12px]'} />\n          ) : (\n            <IconCozArrowDown className={'text-[12px]'} />\n          )\n        }\n        iconPosition=\"right\"\n        color=\"primary\"\n        style={{\n          minWidth: '45px',\n          padding: '6px 6px 6px 8px',\n        }}\n      >\n        <IconCozSetting />\n      </Button>\n    </Menu>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { type DocumentInfo } from '@coze-arch/bot-api/knowledge';\n\nimport { useReloadKnowledgeIDE } from '@/hooks/use-case/use-reload-knowledge-ide';\n\nimport { type TableConfigMenuRegistry } from '../../knowledge-ide-table-config-menus';\nimport { KnowledgeConfigMenu as KnowledgeConfigMenuComponent } from '../../../components/knowledge-config-menu';\n\nexport interface TableConfigButtonProps {\n  knowledgeTableConfigMenuContributes?: TableConfigMenuRegistry;\n  onChangeDocList?: (docList: DocumentInfo[]) => void;\n}\n\nexport const TableConfigButton = (props: TableConfigButtonProps) => {\n  const { knowledgeTableConfigMenuContributes, onChangeDocList } = props;\n  const documentList = useKnowledgeStore(state => state.documentList);\n  const documentInfo = documentList?.[0];\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n  const { reload } = useReloadKnowledgeIDE();\n\n  if (!knowledgeTableConfigMenuContributes) {\n    return null;\n  }\n\n  return (\n    <KnowledgeConfigMenuComponent>\n      {canEdit\n        ? knowledgeTableConfigMenuContributes\n            ?.entries()\n            .map(([key, { Component }]) => (\n              <Component\n                key={key}\n                documentInfo={documentInfo}\n                onChangeDocList={onChangeDocList}\n                reload={reload}\n              />\n            ))\n        : null}\n    </KnowledgeConfigMenuComponent>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureRegistry } from '@coze-data/feature-register';\n\nimport { type TableConfigMenuModule } from './module';\n\nexport type TableConfigMenuFeatureType =\n  | 'configuration-table-structure'\n  | 'update-frequency'\n  | 'fetch-slice'\n  | 'view-source';\n\nexport type TableConfigMenuRegistry = FeatureRegistry<\n  TableConfigMenuFeatureType,\n  TableConfigMenuModule\n>;\n\nexport const createTableConfigMenuRegistry = (\n  name: string,\n): TableConfigMenuRegistry =>\n  new FeatureRegistry<TableConfigMenuFeatureType, TableConfigMenuModule>({\n    name,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useDataNavigate } from '@coze-data/knowledge-stores';\nimport { OptType } from '@coze-data/knowledge-resource-processor-core';\nimport { I18n } from '@coze-arch/i18n';\nimport { UpdateType } from '@coze-arch/bot-api/knowledge';\nimport { Menu } from '@coze-arch/coze-design';\n\nimport {\n  type TableConfigMenuModule,\n  type TableConfigMenuModuleProps,\n} from '../module';\n\nexport const ConfigurationTableStructure = (\n  props: TableConfigMenuModuleProps,\n) => {\n  const { documentInfo } = props;\n  const resourceNavigate = useDataNavigate();\n\n  if (\n    documentInfo.update_type !== undefined &&\n    documentInfo.update_type !== UpdateType.NoUpdate\n  ) {\n    return null;\n  }\n\n  const handleClick = () => {\n    resourceNavigate.upload?.({\n      type: 'table',\n      opt: OptType.RESEGMENT,\n      doc_id: documentInfo?.document_id ?? '',\n    });\n  };\n\n  return (\n    <Menu.Item onClick={handleClick}>\n      {I18n.t('knowledge_segment_config_table')}\n    </Menu.Item>\n  );\n};\nexport const ConfigurationTableStructureModule: TableConfigMenuModule = {\n  Component: ConfigurationTableStructure,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TableConfigButton, type TableConfigButtonProps } from '../base';\nimport { knowledgeTableLocalConfigMenuContributes } from './knowledge-ide-table-config-menu-contributes';\nexport const TableLocalTableConfigButton = (props: TableConfigButtonProps) => (\n  <TableConfigButton\n    {...props}\n    knowledgeTableConfigMenuContributes={\n      knowledgeTableLocalConfigMenuContributes\n    }\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TableConfigButton, type TableConfigButtonProps } from '../base';\nimport { knowledgeTableConfigMenuContributes } from './knowledge-ide-table-config-menu-contributes';\nexport const TableCustomTableConfigButton = (props: TableConfigButtonProps) => (\n  <TableConfigButton\n    {...props}\n    knowledgeTableConfigMenuContributes={knowledgeTableConfigMenuContributes}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\nimport { UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\n\nimport { getUnitType } from '@/utils';\n\nimport { TableLocalTableConfigButton } from './table-local';\nimport { TableCustomTableConfigButton } from './table-custom';\nimport { type TableConfigButtonProps } from './base';\nexport const KnowledgeIDETableConfig = (props: TableConfigButtonProps) => {\n  const documentInfo = useKnowledgeStore(state => state.documentList?.[0]);\n  const unitType = useMemo(() => {\n    if (documentInfo) {\n      return getUnitType({\n        format_type: FormatType.Table,\n        source_type: documentInfo?.source_type,\n      });\n    }\n    return UnitType.TABLE_API;\n  }, [documentInfo]);\n  if (unitType === UnitType.TABLE_CUSTOM) {\n    return <TableCustomTableConfigButton {...props} />;\n  }\n  if (unitType === UnitType.TABLE_DOC) {\n    return <TableLocalTableConfigButton {...props} />;\n  }\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { KnowledgeIDEBaseLayout } from '@coze-data/knowledge-ide-base/layout/base';\nimport {\n  TableKnowledgeWorkspace,\n  type TableKnowledgeWorkspaceProps,\n} from '@coze-data/knowledge-ide-base/features/table-knowledge-workspace';\nimport { BaseKnowledgeIDENavBar } from '@coze-data/knowledge-ide-base/features/nav-bar/base';\nimport { KnowledgeIDETableConfig } from '@coze-data/knowledge-ide-base/features/knowledge-ide-table-config';\nimport {\n  KnowledgeIDERegistryContext,\n  type KnowledgeIDERegistry,\n} from '@coze-data/knowledge-ide-base/context/knowledge-ide-registry-context';\n\nimport { type BaseKnowledgeIDEProps } from '../types';\nimport { importKnowledgeSourceMenuContributes } from './import-knowledge-source-menu-contributes';\n\nexport interface BaseKnowledgeTableIDEProps extends BaseKnowledgeIDEProps {\n  contentProps?: Partial<TableKnowledgeWorkspaceProps>;\n}\n\nconst registryContextValue: KnowledgeIDERegistry = {\n  importKnowledgeMenuSourceFeatureRegistry:\n    importKnowledgeSourceMenuContributes,\n};\n\nexport const BaseKnowledgeTableIDE = (props: BaseKnowledgeTableIDEProps) => (\n  <KnowledgeIDERegistryContext.Provider value={registryContextValue}>\n    <KnowledgeIDEBaseLayout\n      renderNavBar={({ statusInfo, dataActions }) => (\n        <BaseKnowledgeIDENavBar\n          progressMap={statusInfo.progressMap}\n          tableConfigButton={\n            <KnowledgeIDETableConfig\n              onChangeDocList={dataActions.updateDocumentList}\n            />\n          }\n          {...props.navBarProps}\n        />\n      )}\n      renderContent={({ dataActions, statusInfo }) => (\n        <TableKnowledgeWorkspace\n          reload={dataActions.refreshData}\n          onChangeDocList={dataActions.updateDocumentList}\n          isReloading={statusInfo.isReloading}\n          {...props.contentProps}\n        />\n      )}\n      {...props.layoutProps}\n    />\n  </KnowledgeIDERegistryContext.Provider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIIconButton, Icon, Tooltip, UIModal } from '@coze-arch/bot-semi';\nimport { IconCloseKnowledge, IconWarningSize24 } from '@coze-arch/bot-icons';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nimport { ReactComponent as SvgTranslate } from '@/assets/icon_translate.svg';\n\nimport styles from './index.module.less';\n\nexport interface AutoGenerateButtonProps {\n  currentValue: string;\n  document_id: string;\n  disable: boolean;\n  onChange: (value: string) => void;\n  onProgress: (loading: boolean) => void;\n}\n\nexport const AutoGenerateButton: React.FC<AutoGenerateButtonProps> = ({\n  currentValue,\n  document_id,\n  disable,\n  onChange,\n  onProgress,\n}) => {\n  const handleGenerate = async () => {\n    const generateCaption = async () => {\n      onProgress(true);\n      try {\n        const res = await KnowledgeApi.ExtractPhotoCaption({\n          document_id,\n        });\n        if (res.caption) {\n          onChange(res.caption);\n        }\n      } catch (error) {\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: REPORT_EVENTS.KnowledgeGeneratePhotoCaption,\n          error: error as Error,\n        });\n      } finally {\n        onProgress(false);\n      }\n    };\n    // If there is no caption, do not confirm\n    if (!currentValue) {\n      await generateCaption();\n      return;\n    }\n    UIModal.warning({\n      // Required parameters to confirm modal style\n      className: styles['confirm-modal'],\n      closeIcon: <IconCloseKnowledge />,\n\n      // custom parameters\n      title: I18n.t('knowledge_photo_021'),\n      content: I18n.t('knowledge_photo_022'),\n      icon: <IconWarningSize24 />,\n      cancelText: I18n.t('Cancel'),\n      okText: I18n.t('Confirm'),\n      okButtonProps: { theme: 'solid', type: 'warning' },\n      onOk: () => {\n        generateCaption();\n      },\n    });\n  };\n\n  return (\n    <Tooltip content={I18n.t('knowledge_photo_020')}>\n      <UIIconButton\n        icon={\n          <Icon\n            svg={\n              <SvgTranslate\n                color={disable ? 'rgba(28, 31, 35, 0.35)' : '#4D53E8'}\n              />\n            }\n          />\n        }\n        className=\"absolute !bottom-[8px] !left-[12px]\"\n        onClick={handleGenerate}\n        disabled={disable}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useState } from 'react';\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  UIModal,\n  Image,\n  TextArea,\n  Spin,\n  IconButton,\n  Icon,\n} from '@coze-arch/bot-semi';\nimport { DocumentStatus, type PhotoInfo } from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nimport { type ProgressMap } from '@/types';\nimport { ReactComponent as SvgArrowLeft } from '@/assets/icon_arrow_left.svg';\n\nimport { AutoGenerateButton } from '../auto-generate-photo-detail-button';\n\nimport styles from './index.module.less';\n\nexport interface UsePhotoDetailModalParams {\n  photo: PhotoInfo | undefined;\n  photoList: PhotoInfo[] | undefined;\n  progressMap: ProgressMap;\n  canEdit: boolean;\n  setCurrentPhotoId: (v: string) => void;\n  reload: () => void;\n  onCancel?: () => void;\n  onSubmit?: () => void;\n}\n\nexport const usePhotoDetailModal = (params: UsePhotoDetailModalParams) => {\n  const {\n    photo = {},\n    photoList = [],\n    canEdit = false,\n    setCurrentPhotoId,\n    reload,\n    progressMap,\n    onCancel,\n    onSubmit,\n  } = params;\n\n  const [visible, setVisible] = useState(false);\n  const [textAreaLoading, setTextAreaLoading] = useState(false);\n  const [saveButtonLoading, setSaveButtonLoading] = useState(false);\n  const [textAreaValue, setTextAreaValue] = useState('');\n\n  const { document_id, status: originStatus } = photo;\n\n  const currentIndex = photoList.findIndex(i => i.document_id === document_id);\n\n  const status = progressMap[document_id || '']?.status || originStatus;\n\n  // The photo that failed to be processed is not allowed to update the caption.\n  const disableUpdate =\n    status === DocumentStatus.Processing ||\n    status === DocumentStatus.Failed ||\n    !canEdit;\n\n  useEffect(() => {\n    if (visible) {\n      // @ts-expect-error -- linter-disable-autofix\n      setTextAreaValue(photo.caption);\n    }\n  }, [\n    visible,\n    // The initial state needs to be updated when switching pictures.\n    document_id,\n  ]);\n\n  const handleSave = async () => {\n    if (disableUpdate) {\n      setVisible(false);\n      return;\n    }\n\n    onSubmit?.();\n    setSaveButtonLoading(true);\n    try {\n      await KnowledgeApi.UpdatePhotoCaption({\n        // @ts-expect-error -- linter-disable-autofix\n        document_id,\n        caption: textAreaValue,\n      });\n      reload();\n      setSaveButtonLoading(false);\n      setVisible(false);\n    } catch (error) {\n      dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n        eventName: REPORT_EVENTS.KnowledgeUpdatePhotoCaption,\n        error: error as Error,\n      });\n      setSaveButtonLoading(false);\n    }\n  };\n\n  return {\n    node: (\n      <UIModal\n        visible={visible}\n        onCancel={() => {\n          setVisible(false);\n          onCancel?.();\n        }}\n        centered\n        title={I18n.t('knowledge_photo_019')}\n        width={792}\n        onOk={handleSave}\n        okButtonProps={{\n          disabled: disableUpdate,\n          loading: saveButtonLoading,\n        }}\n      >\n        <div className={styles['modal-content']}>\n          <div className={styles['photo-large']}>\n            <Image\n              // Only set the height, and the width will be automatically scaled according to the original scale of the picture.\n              height={300}\n              src={photo.url}\n            />\n            {\n              // Not found, or for the first one, the pre button is not displayed\n              currentIndex < 1 ? null : (\n                <IconButton\n                  icon={<Icon svg={<SvgArrowLeft />} />}\n                  className={styles['arrow-button']}\n                  style={{\n                    left: '24px',\n                  }}\n                  onClick={() => {\n                    const { document_id: preId } = photoList[currentIndex - 1];\n                    // @ts-expect-error -- linter-disable-autofix\n                    setCurrentPhotoId(preId);\n                  }}\n                />\n              )\n            }\n            {\n              // Not found, or for the last one, the pre button is not displayed\n              currentIndex === -1 ||\n              currentIndex === photoList.length - 1 ? null : (\n                <IconButton\n                  icon={<Icon rotate={180} svg={<SvgArrowLeft />} />}\n                  className={styles['arrow-button']}\n                  style={{\n                    right: '24px',\n                  }}\n                  onClick={() => {\n                    const { document_id: nextId } = photoList[currentIndex + 1];\n                    // @ts-expect-error -- linter-disable-autofix\n                    setCurrentPhotoId(nextId);\n                  }}\n                />\n              )\n            }\n          </div>\n          <div className={styles['photo-caption-textarea']}>\n            <Spin spinning={textAreaLoading}>\n              <TextArea\n                maxCount={2000}\n                maxLength={2000}\n                placeholder={I18n.t('knowledge_photo_026')}\n                value={textAreaValue}\n                onChange={v => setTextAreaValue(v)}\n                disabled={disableUpdate}\n              />\n            </Spin>\n            <AutoGenerateButton\n              currentValue={textAreaValue}\n              document_id={document_id || ''}\n              disable={disableUpdate}\n              onChange={setTextAreaValue}\n              onProgress={setTextAreaLoading}\n            />\n          </div>\n        </div>\n      </UIModal>\n    ),\n    open: () => {\n      setVisible(true);\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type InfiniteScrollOptions } from 'ahooks/lib/useInfiniteScroll/types';\nimport { useInfiniteScroll } from 'ahooks';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { KNOWLEDGE_MAX_DOC_SIZE } from '@coze-data/knowledge-modal-base';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { type PhotoInfo } from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nimport { FilterPhotoType } from '@/types';\n\nexport interface UsePhotoListParams {\n  datasetID: string;\n  searchValue?: string;\n  filterPhotoType?: FilterPhotoType;\n}\n\ninterface Result {\n  list: PhotoInfo[];\n  total: number;\n}\n\nconst PAGE_SIZE = 20;\n\nexport const usePhotoList = (\n  params: UsePhotoListParams,\n  options: InfiniteScrollOptions<Result>,\n) => {\n  const { datasetID, searchValue, filterPhotoType } = params;\n\n  const fetchPhotoList = async (\n    page: number,\n    pageSize: number,\n    // @ts-expect-error -- linter-disable-autofix\n  ): Promise<Result> => {\n    try {\n      const res = await KnowledgeApi.ListPhoto({\n        page: page ?? 1,\n        size: pageSize ?? KNOWLEDGE_MAX_DOC_SIZE,\n        dataset_id: datasetID,\n        filter: {\n          keyword: searchValue,\n          has_caption:\n            filterPhotoType === FilterPhotoType.HasCaption\n              ? true\n              : filterPhotoType === FilterPhotoType.NoCaption\n              ? false\n              : // Pass undefined to return all\n                undefined,\n        },\n      });\n      return {\n        list: res.photo_infos || [],\n        total: res.total || 0,\n      };\n    } catch (error) {\n      dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n        eventName: REPORT_EVENTS.KnowledgePhotoList,\n        error: error as Error,\n      });\n    }\n  };\n\n  return useInfiniteScroll<Result>(\n    async d => {\n      const p = d ? Math.ceil(d.list.length / PAGE_SIZE) + 1 : 1;\n      return fetchPhotoList(p, PAGE_SIZE);\n    },\n    {\n      manual: true,\n      ...options,\n    },\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n/* eslint-disable react-hooks/exhaustive-deps */\n/* eslint-disable max-lines-per-function */\nimport { useSearchParams } from 'react-router-dom';\nimport { useEffect, useState, type FC, useRef } from 'react';\n\nimport dayjs from 'dayjs';\nimport classNames from 'classnames';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  Card,\n  CardGroup,\n  Image,\n  Space,\n  Spin,\n  Tooltip,\n  Typography,\n  UIIconButton,\n  UIModal,\n  UIEmpty,\n} from '@coze-arch/bot-semi';\nimport {\n  IconCloseKnowledge,\n  IconDeleteOutline,\n  IconEdit,\n  IconWaringRed,\n  IconSegmentEmpty,\n  IconImageFailOutlined,\n} from '@coze-arch/bot-icons';\nimport { DocumentStatus, type PhotoInfo } from '@coze-arch/bot-api/knowledge';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nimport { type ProgressItem, type ProgressMap } from '@/types';\nimport { usePhotoDetailModal } from '@/components/photo-detail-modal';\n\nimport { usePhotoList } from './use-photo-list';\n\nimport styles from './index.module.less';\n\nexport interface ImageKnowledgeWorkspaceProps {\n  progressMap: ProgressMap;\n}\n\nexport const ImageKnowledgeWorkspace: FC<\n  ImageKnowledgeWorkspaceProps\n> = props => {\n  const { progressMap } = props;\n  const [_, setSearchParams] = useSearchParams();\n  const params = useKnowledgeParams();\n  const firstAutoOpenEditDocumentId = params.first_auto_open_edit_document_id;\n  const [currentPhotoId, setCurrentPhotoId] = useState<string>('');\n  const [currentHoverCardId, setCurrentHoverCardId] = useState<string>('');\n\n  const dataSetDetail = useKnowledgeStore(state => state.dataSetDetail);\n  const canEdit = useKnowledgeStore(state => state.canEdit);\n  const searchValue = useKnowledgeStore(state => state.searchValue);\n  const photoFilterValue = useKnowledgeStore(state => state.photoFilterValue);\n  const ref = useRef<HTMLDivElement>(null);\n\n  const { data, loading, loadingMore, reloadAsync, noMore } = usePhotoList(\n    {\n      // @ts-expect-error -- linter-disable-autofix\n      datasetID: dataSetDetail?.dataset_id,\n      filterPhotoType: photoFilterValue,\n      searchValue,\n    },\n    {\n      // @ts-expect-error -- linter-disable-autofix\n      isNoMore: d => d?.list.length >= d?.total,\n      target: ref,\n    },\n  );\n\n  const photoList = data?.list;\n\n  const shouldAutoOpenDetailModal = photoList?.find(\n    i => i.document_id === firstAutoOpenEditDocumentId,\n  );\n\n  const previewPhotoList = photoList?.filter(\n    photo => photo.status !== DocumentStatus.AuditFailed,\n  );\n  const curPhoto = previewPhotoList?.find(\n    i => i.document_id === currentPhotoId,\n  );\n\n  const resetUrlQueryParams = () => {\n    setSearchParams((state: URLSearchParams) => {\n      state.delete('action_type');\n      return state;\n    });\n  };\n\n  const { node, open } = usePhotoDetailModal({\n    photo: curPhoto,\n    progressMap,\n    photoList: previewPhotoList,\n    canEdit: !!canEdit,\n    setCurrentPhotoId,\n    reload: reloadAsync,\n    onCancel: () => {\n      // Reset url parameters\n      resetUrlQueryParams();\n    },\n    onSubmit: () => {\n      resetUrlQueryParams();\n    },\n  });\n\n  // Manually control data loading timing\n  useEffect(() => {\n    if (dataSetDetail?.dataset_id) {\n      reloadAsync();\n\n      // When reloading, return to the top\n      ref.current?.scrollTo?.({\n        top: 0,\n        behavior: 'smooth',\n      });\n    }\n  }, [searchValue, photoFilterValue, dataSetDetail?.dataset_id]);\n\n  // Automatically open the editing pop-up window\n  useEffect(() => {\n    if (shouldAutoOpenDetailModal) {\n      if (firstAutoOpenEditDocumentId) {\n        setCurrentPhotoId(firstAutoOpenEditDocumentId);\n      }\n      open();\n    }\n  }, [firstAutoOpenEditDocumentId, shouldAutoOpenDetailModal]);\n\n  return (\n    <>\n      <div className={styles['photo-list']} ref={ref}>\n        <Spin\n          spinning={loading}\n          wrapperClassName={styles['photo-list-spin']}\n          childStyle={{\n            height: '100%',\n            width: '100%',\n          }}\n        >\n          {/* @ts-expect-error -- linter-disable-autofix */}\n          {photoList?.length <= 0 ? (\n            <UIEmpty\n              empty={{\n                icon: <IconSegmentEmpty />,\n                title: I18n.t('query_data_empty'),\n              }}\n            />\n          ) : (\n            <CardGroup spacing={12} className={styles['card-group']}>\n              {photoList?.map(item => {\n                const {\n                  url,\n                  document_id,\n                  name,\n                  update_time,\n                  caption: originCaption,\n                  status: originStatus,\n                } = item;\n                // Use progressMap here to keep refreshing until completion\n                // @ts-expect-error -- linter-disable-autofix\n                const status = progressMap[document_id]?.status || originStatus;\n                // Use progressMap to get the latest caption\n                const caption =\n                  // @ts-expect-error -- linter-disable-autofix\n                  (progressMap[document_id] as ProgressItem & PhotoInfo)\n                    ?.caption || originCaption;\n\n                const hasCaption =\n                  typeof caption === 'string' && Boolean(caption);\n\n                const handleEdit = () => {\n                  // @ts-expect-error -- linter-disable-autofix\n                  setCurrentPhotoId(document_id);\n                  open();\n                };\n\n                const handleDelete = () => {\n                  UIModal.error({\n                    // Required parameters to confirm modal style\n                    className: styles['confirm-modal'],\n                    closeIcon: <IconCloseKnowledge />,\n\n                    // custom parameters\n                    title: I18n.t('kl2_007'),\n                    content: I18n.t(\n                      'dataset_detail_table_deleteModel_description',\n                    ),\n                    icon: <IconWaringRed />,\n                    cancelText: I18n.t('Cancel'),\n                    okText: I18n.t('Delete'),\n                    okButtonProps: {\n                      type: 'danger',\n                    },\n                    onOk: async () => {\n                      try {\n                        await KnowledgeApi.DeleteDocument({\n                          // @ts-expect-error -- linter-disable-autofix\n                          document_ids: [document_id],\n                        });\n                        await reloadAsync();\n                      } catch (error) {\n                        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n                          eventName: REPORT_EVENTS.KnowledgeDeleteDocument,\n                          error: error as Error,\n                        });\n                      }\n                    },\n                  });\n                };\n\n                const onMouseEnter = () => {\n                  // @ts-expect-error -- linter-disable-autofix\n                  setCurrentHoverCardId(document_id);\n                };\n\n                const onMouseLeave = () => {\n                  setCurrentHoverCardId('');\n                };\n\n                const isHover = currentHoverCardId === document_id;\n                const isAudiFailed =\n                  originStatus === DocumentStatus.AuditFailed;\n                const getCaption = () => {\n                  // Illegal pictures\n                  if (isAudiFailed) {\n                    return (\n                      <span>\n                        {I18n.t('knowledge_content_illegal_error_msg')}\n                      </span>\n                    );\n                  }\n\n                  // Processing failed\n                  if (status === DocumentStatus.Failed) {\n                    return (\n                      <span className={styles['failed-tag']}>\n                        {I18n.t('dataset_process_fail')}\n                      </span>\n                    );\n                  }\n\n                  // Processing\n                  if (status === DocumentStatus.Processing) {\n                    return (\n                      <span className={styles['processing-tag']}>\n                        {I18n.t('datasets_segment_tag_processing')}\n                      </span>\n                    );\n                  }\n\n                  // marked\n                  if (hasCaption) {\n                    return caption;\n                  }\n\n                  // unmarked\n                  return I18n.t('knowledge_photo_016');\n                };\n\n                return (\n                  <Card\n                    key={document_id}\n                    cover={\n                      isAudiFailed ? (\n                        <div className={styles['prohibit-cover']}>\n                          <IconImageFailOutlined size={'extra-small'} />\n                          <p>{I18n.t('knowledge_photo_illegal_error_msg')}</p>\n                        </div>\n                      ) : (\n                        <Image\n                          src={url}\n                          // Only set the width, and the height will be automatically scaled according to the original scale of the picture.\n                          width={222}\n                          preview={false}\n                          onClick={handleEdit}\n                          className={styles['card-cover']}\n                        />\n                      )\n                    }\n                    headerLine={false}\n                    bodyStyle={{\n                      padding: '12px 16px',\n                    }}\n                    className={classNames(\n                      styles.card,\n                      isAudiFailed ? styles['card-disabled'] : '',\n                    )}\n                  >\n                    <div\n                      onMouseEnter={onMouseEnter}\n                      onMouseLeave={onMouseLeave}\n                      className={styles['card-content']}\n                    >\n                      <Typography.Text\n                        className={styles['photo-name']}\n                        ellipsis={{\n                          showTooltip: true,\n                        }}\n                      >\n                        {name}\n                      </Typography.Text>\n                      <Typography.Paragraph\n                        className={styles['photo-description']}\n                        ellipsis={{\n                          showTooltip: true,\n                          rows: 2,\n                        }}\n                        style={{\n                          color: hasCaption\n                            ? 'rgba(29, 28, 35, 0.6)'\n                            : 'rgba(255, 178, 51, 1)',\n                        }}\n                      >\n                        {getCaption()}\n                      </Typography.Paragraph>\n\n                      <div className={styles['card-footer']}>\n                        <Typography.Text className={styles['create-time']}>\n                          {/* @ts-expect-error -- linter-disable-autofix */}\n                          {dayjs.unix(update_time).format('YYYY-MM-DD HH:mm')}\n                        </Typography.Text>\n                        {isHover && canEdit ? (\n                          <Space spacing={12}>\n                            <Tooltip content={I18n.t('Edit')}>\n                              <UIIconButton\n                                icon={<IconEdit />}\n                                disabled={isAudiFailed}\n                                onClick={handleEdit}\n                              />\n                            </Tooltip>\n                            <Tooltip content={I18n.t('Delete')}>\n                              <UIIconButton\n                                icon={<IconDeleteOutline />}\n                                onClick={handleDelete}\n                              />\n                            </Tooltip>\n                          </Space>\n                        ) : null}\n                      </div>\n                    </div>\n                  </Card>\n                );\n              })}\n            </CardGroup>\n          )}\n        </Spin>\n        <div className={styles.footer}>\n          {!noMore && (\n            <Spin\n              spinning={loadingMore}\n              tip={I18n.t('loading')}\n              wrapperClassName={styles.spin}\n            />\n          )}\n        </div>\n      </div>\n      {node}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { KnowledgeIDEBaseLayout } from '@coze-data/knowledge-ide-base/layout/base';\nimport { BaseKnowledgeIDENavBar } from '@coze-data/knowledge-ide-base/features/nav-bar/base';\nimport {\n  ImageKnowledgeWorkspace,\n  type ImageKnowledgeWorkspaceProps,\n} from '@coze-data/knowledge-ide-base/features/image-knowledge-workspace';\nimport { KnowledgeIDERegistryContext } from '@coze-data/knowledge-ide-base/context/knowledge-ide-registry-context';\n\nimport { type BaseKnowledgeIDEProps } from '../types';\nimport { importKnowledgeSourceMenuContributes } from './import-knowledge-source-menu-contributes';\n\nexport interface BaseKnowledgeImgIDEProps extends BaseKnowledgeIDEProps {\n  contentProps?: Partial<ImageKnowledgeWorkspaceProps>;\n}\n\nconst registryContextValue = {\n  importKnowledgeMenuSourceFeatureRegistry:\n    importKnowledgeSourceMenuContributes,\n};\n\nexport const BaseKnowledgeImgIDE = (props: BaseKnowledgeImgIDEProps) => (\n  <KnowledgeIDERegistryContext.Provider value={registryContextValue}>\n    <KnowledgeIDEBaseLayout\n      renderNavBar={({ statusInfo }) => (\n        <BaseKnowledgeIDENavBar\n          progressMap={statusInfo.progressMap}\n          {...props.navBarProps}\n        />\n      )}\n      renderContent={({ statusInfo }) => (\n        <ImageKnowledgeWorkspace\n          progressMap={statusInfo.progressMap}\n          {...props.contentProps}\n        />\n      )}\n      {...props.layoutProps}\n    />\n  </KnowledgeIDERegistryContext.Provider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useGetKnowledgeType } from '@coze-data/knowledge-ide-base/hooks/use-case';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\n\nimport { type BaseKnowledgeIDEProps } from './types';\nimport { BaseKnowledgeTextIDE } from './text-ide';\nimport { BaseKnowledgeTableIDE } from './table-ide';\nimport { BaseKnowledgeImgIDE } from './img-ide';\n\nexport type { BaseKnowledgeIDEProps };\n\nexport const BaseKnowledgeIDE = (props: BaseKnowledgeIDEProps) => {\n  const { dataSetDetail: { format_type } = {} } = useGetKnowledgeType();\n  if (format_type === FormatType.Text) {\n    return <BaseKnowledgeTextIDE {...props} />;\n  }\n  if (format_type === FormatType.Table) {\n    return <BaseKnowledgeTableIDE {...props} />;\n  }\n  if (format_type === FormatType.Image) {\n    return <BaseKnowledgeImgIDE {...props} />;\n  }\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-params */\nimport { useState } from 'react';\n\nimport { useDataModal } from '@coze-data/utils';\nimport {\n  KnowledgeParamsStoreProvider,\n  type IKnowledgeParams,\n  type PluginNavType,\n} from '@coze-data/knowledge-stores';\n\nimport styles from './index.module.less';\n\nexport interface UseKnowledgeIDEFullScreenModalProps {\n  biz: IKnowledgeParams['biz'];\n  renderKnowledgeIDE: (props: { onClose: () => void }) => React.ReactNode;\n  createResourceNavigate?: ({\n    datasetID,\n  }: {\n    datasetID: string;\n  }) => PluginNavType;\n}\n\nexport const useKnowledgeIDEFullScreenModal = ({\n  biz,\n  renderKnowledgeIDE,\n}: UseKnowledgeIDEFullScreenModalProps) => {\n  const [curDatasetID, setCurDatasetID] = useState('');\n  const { modal, open, close } = useDataModal({\n    hideOkButton: true,\n    hideCancelButton: true,\n    showCloseIcon: false,\n    closable: false,\n    fullScreen: true,\n    footer: null,\n    className: styles['knowledge-preview-modal'],\n  });\n  return {\n    node: modal(\n      <div className={styles['knowledge-preview-modal-content']}>\n        <KnowledgeParamsStoreProvider\n          params={{ datasetID: curDatasetID, biz }}\n          resourceNavigate={{}}\n        >\n          {renderKnowledgeIDE({ onClose: close })}\n        </KnowledgeParamsStoreProvider>\n      </div>,\n    ),\n    open: (datasetID: string) => {\n      setCurDatasetID(datasetID);\n      open();\n    },\n    close,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useKnowledgeParams } from '@coze-data/knowledge-stores';\nimport { I18n } from '@coze-arch/i18n';\nimport { SceneType, usePageJumpService } from '@coze-arch/bot-hooks';\nimport {\n  type Knowledge,\n  type GetDraftBotInfoAgwData,\n  type KnowledgeInfo,\n  ReferenceUpdateType,\n  BotMode,\n} from '@coze-arch/bot-api/playground_api';\nimport {\n  type Dataset,\n  DatasetStatus,\n  StorageLocation,\n} from '@coze-arch/bot-api/knowledge';\nimport { PlaygroundApi } from '@coze-arch/bot-api';\nimport { Toast, Button } from '@coze-arch/coze-design';\n\nimport { ActionType } from '@/types';\n\ntype BotDataset =\n  | Knowledge\n  | {\n      dataset: KnowledgeInfo[];\n    };\n\ninterface UpdateDatasetForBot {\n  botId: string;\n  agentId: string;\n  dataset: BotDataset;\n  updatedDatasetList?: KnowledgeInfo[];\n  spaceId: string;\n\n  dataSetDetail?: Dataset;\n}\nexport const useFetchBotInfo = (spaceId, botId) => {\n  const [botInfo, setBotInfo] = useState<GetDraftBotInfoAgwData>();\n  const fetchBotInfo = async () => {\n    try {\n      const { data } = await PlaygroundApi.GetDraftBotInfoAgw({\n        bot_id: botId,\n      });\n      setBotInfo(data ?? {});\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  useEffect(() => {\n    if (spaceId && botId) {\n      fetchBotInfo();\n    }\n  }, [spaceId, botId]);\n\n  return botInfo;\n};\n\nconst updateDatasetForBot = async ({\n  botId,\n  agentId,\n  dataset,\n  botInfo,\n  updatedDatasetList,\n  spaceId,\n}: UpdateDatasetForBot & {\n  botInfo?: GetDraftBotInfoAgwData;\n}) => {\n  if (botInfo?.bot_info.bot_mode === BotMode.SingleMode) {\n    await PlaygroundApi.UpdateDraftBotInfoAgw({\n      bot_info: {\n        bot_id: botId,\n        knowledge: {\n          ...dataset,\n          knowledge_info: updatedDatasetList,\n        },\n      },\n    });\n  } else {\n    const currentAgent = botInfo?.bot_info?.agents?.find(\n      agent => agent.agent_id === agentId,\n    );\n    if (currentAgent?.agent_id) {\n      await PlaygroundApi.UpdateAgentV2({\n        ...currentAgent,\n        current_version:\n          currentAgent.update_type === ReferenceUpdateType.AutoUpdate\n            ? '0'\n            : currentAgent.current_version,\n        id: currentAgent?.agent_id,\n        space_id: spaceId,\n        bot_id: botId,\n        knowledge: {\n          ...dataset,\n          knowledge_info: updatedDatasetList,\n        },\n      });\n    }\n  }\n};\n\nexport const getUpdatedDataset = (\n  dataset: BotDataset,\n  actionType: ActionType,\n  dataSetDetail: Dataset,\n): KnowledgeInfo[] => {\n  // Updated bot knowledge base\n  let updatedDatasetList: KnowledgeInfo[] = [];\n  // The original bot knowledge base content\n  let originDataset: KnowledgeInfo[] = [];\n\n  // Compatible with the json version of dataset, delete it after FG is full\n  if ('dataset' in dataset) {\n    originDataset = dataset?.dataset ?? [];\n  } else {\n    originDataset = dataset?.knowledge_info ?? [];\n  }\n\n  if (actionType === ActionType.REMOVE) {\n    updatedDatasetList = originDataset?.filter(\n      item => item.id !== dataSetDetail.dataset_id,\n    );\n  } else {\n    updatedDatasetList = [\n      ...originDataset,\n      { name: dataSetDetail.name, id: dataSetDetail.dataset_id },\n    ];\n  }\n\n  return updatedDatasetList;\n};\n\n// Update bot knowledge base logic\nexport const handleDatasetUpdate = async ({\n  botInfo,\n  botId,\n  agentId,\n  dataSetDetail = {},\n  dataset,\n  actionType,\n  spaceId,\n  updateSuccess,\n}: UpdateDatasetForBot & {\n  botInfo?: GetDraftBotInfoAgwData;\n  updateSuccess: () => void;\n  actionType: ActionType;\n}) => {\n  const updatedDatasetList = getUpdatedDataset(\n    dataset,\n    actionType,\n    dataSetDetail,\n  );\n\n  const updateBotParams = {\n    spaceId,\n    botId,\n    agentId,\n    updatedDatasetList,\n    dataset,\n  };\n\n  await updateDatasetForBot({ ...updateBotParams, botInfo });\n\n  updateSuccess();\n};\n\n// Get the original dataset of different bots according to different botInfo information\nexport const getDatasetInfo = (\n  botInfo: GetDraftBotInfoAgwData | undefined,\n  agentId: string,\n): BotDataset => {\n  if (agentId) {\n    return (\n      botInfo?.bot_info?.agents?.find(item => item.agent_id === agentId)\n        ?.knowledge ?? {}\n    );\n  }\n\n  return botInfo?.bot_info?.knowledge ?? {};\n};\n\nexport const NavBarActionButton = ({\n  dataSetDetail,\n}: {\n  dataSetDetail: Dataset;\n}) => {\n  const [loading, setLoading] = useState(false);\n  const { jump } = usePageJumpService();\n  const params = useKnowledgeParams();\n  const { spaceID, botID, agentID, actionType } = params;\n\n  const botInfo = useFetchBotInfo(spaceID, botID);\n\n  const dataset = getDatasetInfo(botInfo, agentID ?? '');\n\n  const updateSuccess = () => {\n    Toast.success(\n      I18n.t(\n        actionType === ActionType.REMOVE\n          ? 'bot_edit_dataset_removed_toast'\n          : 'bot_edit_dataset_added_toast',\n        { dataset_name: dataSetDetail.name },\n      ),\n    );\n    jump(SceneType.KNOWLEDGE__BACK__BOT, {\n      spaceID,\n      botID,\n      mode:\n        dataSetDetail.storage_location === StorageLocation.Douyin\n          ? 'douyin'\n          : 'bot',\n    });\n  };\n  const handleActionClick = async () => {\n    setLoading(true);\n    try {\n      await handleDatasetUpdate({\n        botInfo,\n        botId: botID ?? '',\n        agentId: agentID ?? '',\n        dataSetDetail,\n        dataset,\n        actionType: actionType ?? ActionType.ADD,\n        spaceId: spaceID ?? '',\n        updateSuccess,\n      });\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Button\n      loading={loading}\n      disabled={dataSetDetail?.status === DatasetStatus.DatasetForbid}\n      onClick={handleActionClick}\n    >\n      {actionType === ActionType.REMOVE &&\n      dataSetDetail?.storage_location === StorageLocation.Douyin\n        ? I18n.t('dy_avatar_resource_delete')\n        : null}\n      {actionType === ActionType.REMOVE &&\n      dataSetDetail?.storage_location !== StorageLocation.Douyin\n        ? I18n.t('kl2_014')\n        : null}\n      {actionType !== ActionType.REMOVE &&\n      dataSetDetail?.storage_location === StorageLocation.Douyin\n        ? I18n.t('dy_avatar_resource_add')\n        : null}\n      {actionType !== ActionType.REMOVE &&\n      dataSetDetail?.storage_location !== StorageLocation.Douyin\n        ? I18n.t('kl2_013')\n        : null}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { type UnitType } from '@coze-data/knowledge-resource-processor-core';\nimport { useKnowledgeNavigate } from '@coze-data/knowledge-common-hooks/use-case';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { type FormatType } from '@coze-arch/bot-api/knowledge';\n\nimport { getAddContentUrl } from '@/utils';\nimport { ActionType } from '@/types';\n\nimport { type ImportKnowledgeSourceButtonProps } from '../module';\nimport { ImportKnowledgeSourceButton } from '../base';\n\nexport type BizAgentIdeImportKnowledgeSourceButtonProps =\n  ImportKnowledgeSourceButtonProps;\n\nexport const BizAgentIdeImportKnowledgeSourceButton = ({\n  disabledTooltip,\n}: BizAgentIdeImportKnowledgeSourceButtonProps) => {\n  const navigate = useKnowledgeNavigate();\n  const { documentList, dataSetDetail } = useKnowledgeStore(\n    useShallow(state => ({\n      documentList: state.documentList,\n      dataSetDetail: state.dataSetDetail,\n    })),\n  );\n  const params = useKnowledgeParams();\n  const spaceId = useSpaceStore(item => item.space.id);\n  return (\n    <ImportKnowledgeSourceButton\n      disabledTooltip={disabledTooltip}\n      onSourceChange={unitType => {\n        navigate(\n          getAddContentUrl({\n            spaceID: spaceId as string,\n            datasetID: dataSetDetail?.dataset_id as string,\n            docID: documentList?.[0]?.document_id,\n            formatType: dataSetDetail?.format_type as FormatType,\n            type: unitType as UnitType,\n            pageMode: 'modal',\n            botId: params.botID,\n            actionType: ActionType.ADD,\n          }),\n        );\n      }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  useKnowledgeParams,\n  useKnowledgeStore,\n} from '@coze-data/knowledge-stores';\nimport { I18n } from '@coze-arch/i18n';\nimport { SceneType, usePageJumpService } from '@coze-arch/bot-hooks';\nimport { StorageLocation } from '@coze-arch/bot-api/knowledge';\nimport { Modal, Toast } from '@coze-arch/coze-design';\n\nimport { ActionType } from '@/types';\nimport {\n  useFetchBotInfo,\n  getDatasetInfo,\n  handleDatasetUpdate,\n} from '@/features/nav-bar-action-button';\n\nexport const useBeforeKnowledgeIDEClose = ({\n  onBack,\n}: {\n  onBack?: () => void;\n}) => {\n  const [loading, setLoading] = useState(false);\n  const {\n    spaceID: spaceId,\n    agentID: agentId,\n    botID: botId,\n    actionType,\n  } = useKnowledgeParams();\n  const { dataSetDetail } = useKnowledgeStore(\n    useShallow(state => ({\n      dataSetDetail: state.dataSetDetail,\n    })),\n  );\n\n  const { jump } = usePageJumpService();\n\n  const botInfo = useFetchBotInfo(spaceId, botId);\n\n  const dataset = getDatasetInfo(botInfo, agentId ?? '');\n\n  const hasAddDataset = useMemo(() => {\n    let datasetIds: string[] = [];\n    if ('dataset' in dataset) {\n      datasetIds = (dataset?.dataset || []).map(item => item.id ?? '');\n    }\n    if ('knowledge_info' in dataset) {\n      datasetIds = (dataset?.knowledge_info || []).map(item => item.id ?? '');\n    }\n    return !datasetIds.includes(dataSetDetail?.dataset_id || '');\n  }, [dataset, dataSetDetail?.dataset_id]);\n\n  const updateSuccessJump = () => {\n    jump(SceneType.KNOWLEDGE__BACK__BOT, {\n      spaceID: spaceId,\n      botID: botId,\n      mode:\n        dataSetDetail?.storage_location === StorageLocation.Douyin\n          ? 'douyin'\n          : 'bot',\n    });\n  };\n  const handleFullModalBack = () => {\n    if (onBack) {\n      onBack?.();\n    } else {\n      updateSuccessJump();\n    }\n  };\n\n  const updateSuccess = () => {\n    Toast.success(\n      I18n.t(\n        actionType === ActionType.REMOVE\n          ? 'bot_edit_dataset_removed_toast'\n          : 'bot_edit_dataset_added_toast',\n        { dataset_name: dataSetDetail?.name },\n      ),\n    );\n    updateSuccessJump();\n  };\n\n  const handleBotIdeBack = () => {\n    // Bot IDE checks whether there is binding knowledge. If there is binding knowledge base, it will be closed normally, and there is no binding confirmation prompt.\n    if (hasAddDataset) {\n      Modal.confirm({\n        title: I18n.t('bot_ide_knowledge_confirm_title'),\n        content:\n          dataSetDetail?.storage_location === StorageLocation.Douyin\n            ? I18n.t('dy_avatar_resource_add_tip')\n            : I18n.t('bot_ide_knowledge_confirm_content'),\n        okText: I18n.t('bot_ide_knowledge_confirm_ok'),\n        cancelText: I18n.t('bot_ide_knowledge_confirm_cancel'),\n        confirmLoading: loading,\n        onOk: async () => {\n          setLoading(true);\n          try {\n            await handleDatasetUpdate({\n              botInfo,\n              botId: botId ?? '',\n              agentId: agentId ?? '',\n              dataSetDetail,\n              dataset,\n              actionType: actionType ?? ActionType.ADD,\n              spaceId: spaceId ?? '',\n              updateSuccess,\n            });\n          } catch (error) {\n            console.error(error);\n          } finally {\n            setLoading(false);\n            // Jump once regardless of success\n            handleFullModalBack();\n          }\n        },\n        onCancel: () => {\n          // Cancel, jump normally\n          handleFullModalBack();\n        },\n      });\n    } else {\n      // Normal binding does not do pop-up interception\n      handleFullModalBack();\n    }\n  };\n\n  return handleBotIdeBack;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\n\nimport { NavBarActionButton } from '@/features/nav-bar-action-button';\nimport { BizAgentIdeImportKnowledgeSourceButton } from '@/features/import-knowledge-source-button/biz-agent-ide';\nimport { KnowledgeModalNavBar as KnowledgeModalNavBarComponent } from '@/components/knowledge-modal-nav-bar';\n\nimport { type KnowledgeIDENavBarProps } from '../module';\nimport { useBeforeKnowledgeIDEClose } from './hooks/use-case/use-before-knowledgeide-close';\n\nexport type BizAgentIdeKnowledgeIDENavBarProps = KnowledgeIDENavBarProps;\n\nexport const BizAgentIdeKnowledgeIDENavBar = (\n  props: BizAgentIdeKnowledgeIDENavBarProps,\n) => {\n  const { onBack, importKnowledgeSourceButton } = props;\n  const { dataSetDetail, documentList } = useKnowledgeStore(\n    useShallow(state => ({\n      dataSetDetail: state.dataSetDetail,\n      documentList: state.documentList,\n    })),\n  );\n  const handleBotIdeBack = useBeforeKnowledgeIDEClose({\n    onBack,\n  });\n  return (\n    <KnowledgeModalNavBarComponent\n      title={dataSetDetail?.name as string}\n      onBack={onBack}\n      datasetDetail={dataSetDetail}\n      docInfo={documentList?.[0]}\n      actionButtons={\n        <NavBarActionButton\n          key={dataSetDetail?.dataset_id}\n          dataSetDetail={dataSetDetail}\n        />\n      }\n      importKnowledgeSourceButton={\n        importKnowledgeSourceButton ?? (\n          <BizAgentIdeImportKnowledgeSourceButton />\n        )\n      }\n      beforeBack={handleBotIdeBack}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BizAgentIdeKnowledgeIDENavBar } from '@coze-data/knowledge-ide-base/features/nav-bar/biz-agent-ide';\n\nimport { BaseKnowledgeIDE, type BaseKnowledgeIDEProps } from '../base';\n\nexport type BizAgentKnowledgeIDEProps = BaseKnowledgeIDEProps;\nexport const BizAgentKnowledgeIDE = (props: BizAgentKnowledgeIDEProps) => (\n  <BaseKnowledgeIDE\n    {...props}\n    layoutProps={{\n      renderNavBar: ({ statusInfo }) => (\n        <BizAgentIdeKnowledgeIDENavBar\n          progressMap={statusInfo.progressMap}\n          {...props.navBarProps}\n        />\n      ),\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseKnowledgeIDE, type BaseKnowledgeIDEProps } from '../base';\nexport type BizLibraryKnowledgeIDEProps = BaseKnowledgeIDEProps;\nexport const BizLibraryKnowledgeIDE = (props: BizLibraryKnowledgeIDEProps) => (\n  <BaseKnowledgeIDE {...props} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type KnowledgeIDENavBarProps } from '../module';\nimport { BaseKnowledgeIDENavBar } from '../base';\n\nexport type BizProjectKnowledgeIDENavBarProps = KnowledgeIDENavBarProps;\n\nexport const BizProjectKnowledgeIDENavBar = (\n  props: BizProjectKnowledgeIDENavBarProps,\n) => <BaseKnowledgeIDENavBar {...props} hideBackButton />;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BizProjectKnowledgeIDENavBar } from '@coze-data/knowledge-ide-base/features/nav-bar/biz-project';\n\nimport { BaseKnowledgeIDE, type BaseKnowledgeIDEProps } from '../base';\n\nexport type BizProjectKnowledgeIDEProps = BaseKnowledgeIDEProps;\nexport const BizProjectKnowledgeIDE = (props: BizProjectKnowledgeIDEProps) => (\n  <BaseKnowledgeIDE\n    {...props}\n    layoutProps={{\n      className: 'coz-bg-max border border-solid coz-stroke-primary',\n      renderNavBar: ({ statusInfo }) => (\n        <BizProjectKnowledgeIDENavBar\n          progressMap={statusInfo.progressMap}\n          {...props.navBarProps}\n        />\n      ),\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useKnowledgeStore } from '@coze-data/knowledge-stores';\n\nimport { KnowledgeModalNavBar as KnowledgeModalNavBarComponent } from '@/components/knowledge-modal-nav-bar';\n\nimport { type KnowledgeIDENavBarProps } from '../module';\n\nexport type BizWorkflowKnowledgeIDENavBarProps = KnowledgeIDENavBarProps;\n\nexport const BizWorkflowKnowledgeIDENavBar = (\n  props: BizWorkflowKnowledgeIDENavBarProps,\n) => {\n  const { onBack, actionButtons } = props;\n  const { dataSetDetail, documentList } = useKnowledgeStore(\n    useShallow(state => ({\n      dataSetDetail: state.dataSetDetail,\n      documentList: state.documentList,\n    })),\n  );\n  return (\n    <KnowledgeModalNavBarComponent\n      title={dataSetDetail?.name as string}\n      onBack={onBack}\n      datasetDetail={dataSetDetail}\n      docInfo={documentList?.[0]}\n      actionButtons={actionButtons}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BizWorkflowKnowledgeIDENavBar } from '@coze-data/knowledge-ide-base/features/nav-bar/biz-workflow';\n\nimport { BaseKnowledgeIDE, type BaseKnowledgeIDEProps } from '../base';\n\nexport type BizWorkflowKnowledgeIDEProps = BaseKnowledgeIDEProps;\nexport const BizWorkflowKnowledgeIDE = (\n  props: BizWorkflowKnowledgeIDEProps,\n) => (\n  <BaseKnowledgeIDE\n    {...props}\n    layoutProps={{\n      renderNavBar: ({ statusInfo }) => (\n        <BizWorkflowKnowledgeIDENavBar\n          progressMap={statusInfo.progressMap}\n          {...props.navBarProps}\n        />\n      ),\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IKnowledgeParams } from '@coze-data/knowledge-stores';\nimport { useKnowledgeIDEFullScreenModal as useKnowledgeIDEFullScreenModalBase } from '@coze-data/knowledge-ide-base/layout/base/modal';\nimport { type KnowledgeModalNavBarProps } from '@coze-data/knowledge-ide-base/components/knowledge-modal-nav-bar';\n\nimport { BizWorkflowKnowledgeIDE } from '../index';\n\nexport const useBizWorkflowKnowledgeIDEFullScreenModal = (props: {\n  keepDocTitle?: boolean;\n  navBarProps?: Partial<KnowledgeModalNavBarProps>;\n  biz: IKnowledgeParams['biz'];\n}) =>\n  useKnowledgeIDEFullScreenModalBase({\n    ...props,\n    renderKnowledgeIDE: ({ onClose }) => (\n      <BizWorkflowKnowledgeIDE\n        {...props}\n        navBarProps={{\n          ...props.navBarProps,\n          onBack: onClose,\n        }}\n      />\n    ),\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Fragment } from 'react';\n\nimport cls from 'classnames';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { Typography, Space } from '@coze-arch/coze-design';\n\nimport { ProcessStatus, type ProcessProgressItemProps } from '../../types';\n\nimport styles from './index.module.less';\n\nexport const ProcessProgressItem: React.FC<ProcessProgressItemProps> = ({\n  className,\n  style,\n  mainText,\n  subText,\n  percent = 10,\n  percentFormat,\n  avatar,\n  status,\n  actions,\n  tipText = '',\n}) => {\n  const renderProgress = () => {\n    if (status === ProcessStatus.Processing) {\n      return (\n        <div className={styles.progress} style={{ width: `${percent}%` }}></div>\n      );\n    }\n    return null;\n  };\n\n  const renderActions = () => {\n    if (status === ProcessStatus.Processing) {\n      return (\n        <span className={styles.percent}>\n          {percentFormat ? percentFormat : `${percent}%`}\n        </span>\n      );\n    }\n\n    return (\n      <div className={cls(styles.actions, 'process-progress-item-actions')}>\n        {Array.isArray(actions) ? (\n          <Space spacing=\"tight\">\n            {actions.map((action, idx) => (\n              <Fragment key={idx}>{action}</Fragment>\n            ))}\n          </Space>\n        ) : null}\n      </div>\n    );\n  };\n\n  return (\n    <div\n      key={mainText}\n      className={cls(\n        styles['progress-wrap'],\n        'flex justify-between relative mb-[8px]',\n        status === ProcessStatus.Failed ? styles['processing-failed'] : '',\n        status === ProcessStatus.Processing ? styles.processing : '',\n        className,\n      )}\n      style={style}\n    >\n      <div\n        className={cls(\n          styles.content,\n          'process-progress-item-content',\n          'max-w-[calc(100%-100px)]',\n        )}\n      >\n        <div className={cls('flex items-center', styles.info)}>\n          {avatar}\n          <div className={cls('pl-[10px] max-w-full')}>\n            <div className={styles['main-text']}>\n              <Typography.Text\n                data-dtestid={`${KnowledgeE2e.CreateUnitListProgressName}.${mainText}`}\n                className={'coz-fg-primary text-14px'}\n                ellipsis={{\n                  showTooltip: {\n                    opts: { content: mainText },\n                  },\n                }}\n              >\n                {mainText}\n              </Typography.Text>\n            </div>\n            <div className={styles['sub-text']}>\n              <div className={styles.desc}>{subText}</div>\n              {tipText ? (\n                <div className={styles['tip-desc']}>{tipText}</div>\n              ) : null}\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className={cls(styles.right, 'process-progress-item-right')}>\n        {renderActions()}\n      </div>\n      {renderProgress()}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport const initIndexOptions = (length: number, start: number) => {\n  const MAX_VALUE = 50;\n  const limit = length > MAX_VALUE ? MAX_VALUE : length;\n  const res: Array<{\n    label: string;\n    value: number;\n  }> = [];\n  for (let i = start; i < limit; i++) {\n    res.push({\n      label: I18n.t('datasets_createFileModel_tab_dataStarRow_value', {\n        LineNumber: i + 1,\n      }),\n      value: i,\n    });\n  }\n  return res;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo, useRef } from 'react';\n\nimport { get, isNumber } from 'lodash-es';\nimport classNames from 'classnames';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport { Form } from '@coze-arch/bot-semi';\nimport { type GetDocumentTableInfoResponse } from '@coze-arch/bot-api/memory';\nimport { FormSelect } from '@coze-arch/coze-design';\n\nimport { type TableSettings } from '@/types';\nimport { TableSettingFormFields } from '@/constants';\n\nimport { initIndexOptions } from './utils';\n\nimport styles from './index.module.less';\n\nexport interface TableSettingBarProps {\n  className?: string;\n  data: GetDocumentTableInfoResponse;\n  tableSettings: TableSettings;\n  setTableSettings: (values: TableSettings) => void;\n}\n\nconst minOptLen = 2;\nexport const TableSettingBar: React.FC<TableSettingBarProps> = ({\n  className = '',\n  data = {},\n  tableSettings,\n  setTableSettings,\n}) => {\n  const { preview_data, sheet_list } = data;\n  if (!preview_data || !sheet_list || !sheet_list.length) {\n    return <></>;\n  }\n\n  // eslint-disable-next-line react-hooks/rules-of-hooks -- linter-disable-autofix\n  const formApi = useRef<FormApi<TableSettings>>();\n  // eslint-disable-next-line react-hooks/rules-of-hooks -- linter-disable-autofix\n  const sheet = useMemo(\n    () => get(sheet_list, tableSettings[TableSettingFormFields.SHEET]),\n    [sheet_list, tableSettings],\n  );\n  // eslint-disable-next-line react-hooks/rules-of-hooks -- linter-disable-autofix\n  const initValues = useMemo(() => tableSettings, [sheet_list]);\n\n  // eslint-disable-next-line react-hooks/rules-of-hooks -- linter-disable-autofix\n  const settings = useMemo(() => {\n    const options =\n      !sheet.id && sheet.id !== 0\n        ? []\n        : initIndexOptions(\n            Number(sheet?.total_row) > 1 ? Number(sheet.total_row) : minOptLen,\n            0,\n          );\n    return [\n      {\n        e2e: KnowledgeE2e.TableLocalTableConfigurationDataSheet,\n        field: TableSettingFormFields.SHEET,\n        label: I18n.t('datasets_createFileModel_tab_DataSheet'),\n        options: sheet_list.map(s => ({\n          value: s.id,\n          label: s.sheet_name,\n        })),\n      },\n      {\n        e2e: KnowledgeE2e.TableLocalTableConfigurationSheetHeader,\n        field: TableSettingFormFields.KEY_START_ROW,\n        label: I18n.t('datasets_createFileModel_tab_header'),\n        options: options.slice(0, options.length - 1),\n      },\n      {\n        e2e: KnowledgeE2e.TableLocalTableConfigurationStarRow,\n        field: TableSettingFormFields.DATA_START_ROW,\n        label: I18n.t('datasets_createFileModel_tab_dataStarRow'),\n        // The starting row of the data must be larger than the header row\n        options: options.slice(\n          Number(tableSettings[TableSettingFormFields.KEY_START_ROW]) + 1,\n        ),\n      },\n    ];\n  }, [data, sheet]);\n\n  const handleFormChange = (\n    values: TableSettings,\n    changedValue: Partial<TableSettings>,\n  ) => {\n    if (setTableSettings) {\n      setTableSettings({ ...values });\n    }\n\n    const curSheet = get(changedValue, TableSettingFormFields.SHEET);\n    const curKeyStartRow = get(\n      changedValue,\n      TableSettingFormFields.KEY_START_ROW,\n    );\n    if (isNumber(curSheet) && formApi.current) {\n      // Modify the sheet, initialize the header and data rows\n      formApi.current.setValue(TableSettingFormFields.KEY_START_ROW, 0);\n      formApi.current.setValue(TableSettingFormFields.DATA_START_ROW, 1);\n    }\n    if (curKeyStartRow && formApi.current) {\n      const dataStartRow = get(values, TableSettingFormFields.DATA_START_ROW);\n      if (!(curKeyStartRow < dataStartRow)) {\n        formApi.current.setValue(\n          TableSettingFormFields.DATA_START_ROW,\n          curKeyStartRow + 1,\n        );\n      }\n    }\n  };\n\n  return (\n    <div className={classNames(styles['table-setting-bar'], className)}>\n      <Form<typeof initValues>\n        layout=\"horizontal\"\n        initValues={initValues}\n        getFormApi={api => (formApi.current = api)}\n        onValueChange={(values, changedValue) => {\n          handleFormChange(values, changedValue);\n        }}\n      >\n        {settings.map(setting => {\n          const { options, ...selectProps } = setting;\n          return (\n            <FormSelect\n              data-testid={setting.e2e}\n              key={setting.field}\n              optionList={options}\n              {...selectProps}\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\n              onChange={(v?: string | number | any[] | Record<string, any>) => {\n                if (!v) {\n                  return;\n                }\n                handleFormChange(\n                  { ...tableSettings, [setting.field]: v as unknown as number },\n                  { [setting.field]: v as unknown as number },\n                );\n              }}\n            />\n          );\n        })}\n      </Form>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { IllustrationNoResult } from '@douyinfe/semi-illustrations';\nimport { getDataTypeText } from '@coze-data/utils';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { ImageRender, type TableViewColumns } from '@coze-common/table-view';\nimport { ColumnType } from '@coze-arch/idl/knowledge';\nimport { I18n } from '@coze-arch/i18n';\nimport { type ColumnProps } from '@coze-arch/bot-semi/Table';\nimport { Table, Tag, Typography } from '@coze-arch/coze-design';\n\nimport { getSrcFromImg } from '@/utils/table';\nimport { type TableInfo, type TableSettings } from '@/types';\nimport { TableSettingFormFields } from '@/constants';\n\nimport styles from './index.module.less';\n\nexport interface TablePreviewProps {\n  data: TableInfo;\n  settings: TableSettings;\n}\n\ninterface PreviewColumn {\n  [key: string]: string;\n}\n\nconst ColumnTypeComp = (props: { columnType: ColumnType }) => (\n  <Tag color=\"primary\" className={styles['column-type']} size=\"mini\">\n    {getDataTypeText(props.columnType)}\n  </Tag>\n);\n\nconst baseClassName = 'table-preview';\nconst maxDataLen = 10;\nexport const TablePreview: React.FC<TablePreviewProps> = ({\n  data,\n  settings,\n}) => {\n  const { sheet_list = [], table_meta = {}, preview_data = {} } = data;\n  const startRow = Number(settings[TableSettingFormFields.DATA_START_ROW]) || 0;\n  // Selected table id\n  const sheetId = useMemo(\n    () => settings[TableSettingFormFields.SHEET] || 0,\n    [settings],\n  );\n  // Selected table name\n  const sheetName = useMemo(\n    () => (sheet_list || []).find(sheet => sheet?.id === sheetId)?.sheet_name,\n    [sheet_list, sheetId],\n  );\n  // The amount of data for the selected table\n  const total = useMemo(\n    () =>\n      Number(\n        (sheet_list || []).find(sheet => sheet?.id === sheetId)?.total_row || 0,\n      ) - startRow || 0,\n    [sheet_list, sheetId],\n  );\n  const newColumns: ColumnProps<PreviewColumn | TableViewColumns>[] = (\n    table_meta[sheetId] || []\n  ).map(meta => {\n    const {\n      sequence,\n      column_name,\n      is_semantic,\n      column_type = ColumnType.Unknown,\n    } = meta;\n    if (column_type === ColumnType.Image) {\n      return {\n        title: (\n          <div className={styles['td-title']}>\n            <div>{column_name}</div>\n            <ColumnTypeComp columnType={column_type}></ColumnTypeComp>\n          </div>\n        ),\n        dataIndex: sequence,\n        render: (text, _record) => {\n          const srcList = getSrcFromImg(text);\n          return <ImageRender srcList={srcList} editable={false} />;\n        },\n      };\n    }\n    return {\n      title: is_semantic ? (\n        <div className={styles['td-title']}>\n          {column_name}\n          {is_semantic ? (\n            <Tag\n              size=\"mini\"\n              color=\"green\"\n              className={styles['semantic-tag']}\n              data-testid={KnowledgeE2e.TableLocalPreviewSemantic}\n            >\n              {I18n.t('knowledge_1226_001')}\n            </Tag>\n          ) : null}\n          <ColumnTypeComp columnType={column_type}></ColumnTypeComp>\n        </div>\n      ) : (\n        <div className={styles['td-title']}>\n          {column_name}\n          <ColumnTypeComp columnType={column_type}></ColumnTypeComp>\n        </div>\n      ),\n      width: 180,\n      dataIndex: sequence,\n      ellipsis: { showTitle: false },\n      render: text => (\n        <Typography.Text ellipsis={{ showTooltip: true }}>\n          {text}\n        </Typography.Text>\n      ),\n    };\n  });\n  const dataList = useMemo(() => {\n    const previewData = preview_data[sheetId] || [];\n    return previewData\n      .slice(0, maxDataLen)\n      .sort((a, b) =>\n        (JSON.stringify(a) as unknown as number) >\n        (JSON.stringify(b) as unknown as number)\n          ? 1\n          : -1,\n      );\n  }, [preview_data, sheetId]);\n  return (\n    <div className={styles[baseClassName]}>\n      {dataList.length ? (\n        <>\n          <div\n            className={styles[`${baseClassName}-title`]}\n            data-testid={KnowledgeE2e.TableLocalPreviewTitle}\n          >\n            {sheetName}\n          </div>\n          <div className={styles[`${baseClassName}-content`]}>\n            <Table\n              tableProps={{\n                dataSource: dataList,\n                columns: newColumns,\n              }}\n            />\n          </div>\n          <div\n            className={styles['preview-tips']}\n            data-testid={KnowledgeE2e.TableLocalPreviewFooterTotal}\n          >\n            {I18n.t('datasets_unit_tableformat_tips1', {\n              TotalRows: total,\n              ShowRows: Number(total) > maxDataLen ? maxDataLen : total,\n            })}\n          </div>\n        </>\n      ) : (\n        <div className={styles['no-result']}>\n          <IllustrationNoResult></IllustrationNoResult>\n          <div className={styles['no-result-tips']}>\n            {I18n.t('knowledge_1221_02')}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\n/* eslint-disable max-lines-per-function */\nimport React, {\n  useCallback,\n  useMemo,\n  useState,\n  type FC,\n  type CSSProperties,\n} from 'react';\n\nimport classNames from 'classnames';\nimport { CSS as cssDndKit } from '@dnd-kit/utilities';\nimport {\n  SortableContext,\n  arrayMove,\n  useSortable,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport { restrictToVerticalAxis } from '@dnd-kit/modifiers';\nimport {\n  DndContext,\n  PointerSensor,\n  useSensors,\n  useSensor,\n  type DragEndEvent,\n} from '@dnd-kit/core';\nimport {\n  DataTypeSelect,\n  getDataTypeOptions,\n  getDataTypeText,\n} from '@coze-data/utils';\nimport { OptType } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozInfoCircle,\n  IconCozTrashCan,\n} from '@coze-arch/coze-design/icons';\nimport {\n  Input,\n  Table,\n  Tooltip,\n  Checkbox,\n  type CheckboxProps,\n} from '@coze-arch/coze-design';\nimport { type ColumnProps, type TableProps } from '@coze-arch/bot-semi/Table';\nimport { UIButton, Typography } from '@coze-arch/bot-semi';\nimport { IconDragOutlined } from '@coze-arch/bot-icons';\nimport { type DocTableColumn } from '@coze-arch/bot-api/memory';\nimport { ColumnType } from '@coze-arch/bot-api/knowledge';\n\nimport { type IValidateRes, validateField, useOptFromQuery } from '@/utils';\nimport { type TableItem } from '@/types/table';\nimport { type SemanticValidateItem } from '@/types';\n\nimport styles from './index.module.less';\n\ntype Align = 'center' | 'left' | 'right' | undefined;\nenum ValidateStatus {\n  Error = 'error',\n  Default = 'default',\n}\n\nexport interface TableStructureProps extends TableProps {\n  data: Array<\n    DocTableColumn & {\n      key?: string;\n      autofocus?: boolean;\n      errMsg?: string;\n    }\n  >;\n  setData: (v: Array<DocTableColumn>) => void;\n  initValid?: boolean;\n  isBlurValid?: boolean;\n  isPreview?: boolean;\n  verifyMap?: SemanticValidateItem;\n  baseKey?: string;\n  showTitle?: boolean;\n  tipsNode?: React.ReactNode;\n  isDragTable?: boolean;\n}\nconst NAME_MAX_STR_LEN = 30;\nconst DESC_MAX_STR_LEN = 2000;\nconst baseClassName = 'table-structure';\nconst RequiredColRender = ({\n  children,\n  tooltip,\n  dataTestId,\n}: {\n  children: React.ReactNode;\n  tooltip?: string | React.ReactNode;\n  dataTestId?: string;\n}) => (\n  <div\n    className={styles[`${baseClassName}-required-container`]}\n    data-testid={dataTestId}\n  >\n    {children}\n    <span className={styles[`${baseClassName}-col-required`]}> *</span>\n    {tooltip}\n  </div>\n);\n\ninterface InputRenderProps {\n  onChange: (v: string) => void;\n  validate?: (v: string, error: string) => IValidateRes;\n  record: TableItem & { errMsg?: string };\n  value: string;\n  autofocus: boolean;\n  initValid: boolean;\n  isBlurValid: boolean;\n  errorMsg?: string;\n  isPreview?: boolean;\n  placeholder?: string;\n  maxStrLen: number;\n}\nconst InputRender = ({\n  onChange,\n  record,\n  value,\n  autofocus = false,\n  isBlurValid = false,\n  initValid,\n  validate,\n  isPreview,\n  placeholder,\n  maxStrLen,\n}: InputRenderProps) => {\n  const ValidateResult = (v: string) => {\n    const validRes = validate?.(\n      v,\n      I18n.t('datasets_segment_tableStructure_field_errEmpty'),\n    );\n    return {\n      valid: initValid ? !!(validate ? validRes?.valid : v && v !== '') : true,\n      errorMsg:\n        validRes?.errorMsg ||\n        I18n.t('datasets_segment_tableStructure_field_errEmpty'),\n    };\n  };\n\n  const [inputValue, setInputValue] = useState(value);\n  const [validObj, setValidObj] = useState(() => {\n    const res = ValidateResult(value);\n    return {\n      valid: isBlurValid ? true : res.valid,\n      errorMsg: res.errorMsg,\n    };\n  });\n\n  const validateValue = (v: string) => {\n    const validRes = ValidateResult(v);\n    setValidObj(validRes);\n  };\n\n  const hasDisable = isPreview;\n  const apiErrorMsg = record?.errMsg || '';\n\n  const validateStatus = useMemo(() => {\n    if (apiErrorMsg) {\n      return ValidateStatus.Error;\n    }\n    return !validObj.valid ? ValidateStatus.Error : ValidateStatus.Default;\n  }, [validObj, apiErrorMsg]);\n\n  const renderErrorMsg = useCallback(() => {\n    if (apiErrorMsg) {\n      return <div className={styles['input-error-msg']}>{apiErrorMsg}</div>;\n    }\n\n    return (\n      <>\n        {!validObj.valid && (\n          <div className={styles['input-error-msg']}>{validObj.errorMsg}</div>\n        )}\n      </>\n    );\n  }, [apiErrorMsg, validObj]);\n\n  return (\n    <>\n      <Input\n        autoFocus={autofocus}\n        value={inputValue}\n        maxLength={maxStrLen}\n        onChange={v => {\n          setInputValue(v.substring(0, maxStrLen));\n          !isBlurValid && validateValue(v);\n        }}\n        disabled={hasDisable}\n        validateStatus={validateStatus}\n        suffix={\n          <span className={styles['input-suffix']}>\n            {(inputValue || '').length}/{maxStrLen}\n          </span>\n        }\n        onBlur={() => {\n          onChange(inputValue?.substring(0, maxStrLen) || '');\n          validateValue(inputValue);\n        }}\n        placeholder={placeholder}\n      />\n      {renderErrorMsg()}\n    </>\n  );\n};\n\n// TODO to be solved\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport const TableStructure: React.FC<TableStructureProps> = ({\n  data = [],\n  setData,\n  verifyMap = {},\n  initValid = false,\n  isBlurValid = false,\n  isPreview = false,\n  baseKey,\n  showTitle = false,\n  children: childrenNode,\n  tipsNode,\n  isDragTable = false,\n  ...tableProps\n}) => {\n  const opt = useOptFromQuery();\n  const isResegment = opt === OptType.RESEGMENT;\n\n  const columns: ColumnProps<TableItem>[] = [\n    {\n      title: () => (\n        <RequiredColRender\n          dataTestId={KnowledgeE2e.TableLocalTableConfigurationIndex}\n          tooltip={\n            <Tooltip\n              className=\"whitespace-pre-line\"\n              content={I18n.t('knowledge_multi_index')}\n            >\n              <UIButton\n                size=\"small\"\n                theme=\"borderless\"\n                type=\"tertiary\"\n                style={{\n                  marginLeft: 4,\n                }}\n                icon={<IconCozInfoCircle className=\"coz-fg-secondary\" />}\n              />\n            </Tooltip>\n          }\n        >\n          <div\n            className={styles['table-header-tooltip']}\n            data-testid={KnowledgeE2e.TableLocalTableConfigurationIndex}\n          >\n            <span>{I18n.t('knowledge_table_structure_semantic')}</span>\n          </div>\n        </RequiredColRender>\n      ),\n      dataIndex: 'is_semantic',\n      width: 90,\n      align: 'left' as Align,\n      render: (value, record, index: number) => {\n        const onChange: CheckboxProps['onChange'] = e => {\n          const newData = [...data];\n          newData[index].is_semantic = Boolean(e.target.checked);\n          setData(newData);\n        };\n        const { sequence } = record;\n        function hasFormItemDisable() {\n          const disabled = Object.keys(verifyMap).length\n            ? !verifyMap[sequence || index]?.valid\n            : false;\n          return disabled || isPreview;\n        }\n        const hasDisable = hasFormItemDisable();\n\n        const Wrapper = ({ children }: { children: JSX.Element }) => {\n          if (hasDisable && verifyMap[sequence || index]?.msg) {\n            return (\n              <Tooltip\n                trigger=\"hover\"\n                content={verifyMap[sequence || index]?.msg}\n              >\n                {children}\n              </Tooltip>\n            );\n          }\n          return children;\n        };\n\n        return (\n          <div className={styles['semantic-radio']}>\n            {isDragTable ? (\n              <IconDragOutlined className={'structure-table-drag-icon'} />\n            ) : null}\n            <Wrapper>\n              <Checkbox\n                checked={value}\n                disabled={hasDisable}\n                onChange={onChange}\n                data-testid={KnowledgeE2e.TableStructureIndexCheckbox}\n              />\n            </Wrapper>\n          </div>\n        );\n      },\n    },\n    {\n      title: () => (\n        <RequiredColRender\n          dataTestId={KnowledgeE2e.TableLocalTableConfigurationColumnName}\n        >\n          {I18n.t('knowledge_table_structure_column_name')}\n        </RequiredColRender>\n      ),\n      dataIndex: 'column_name',\n      align: 'left' as Align,\n      render: (value, record, index) => {\n        const { autofocus = false } = record;\n        const onChange = (v: string) => {\n          const newData = [...data];\n          newData[index].column_name = v;\n          setData(newData);\n        };\n\n        const validateFn = (v: string, emptyMsg: string) => {\n          if (data?.filter(i => i.column_name === v).length >= 2) {\n            return {\n              valid: false,\n              errorMsg: I18n.t('Manual_crawling_040'),\n            };\n          }\n          return validateField(v, emptyMsg);\n        };\n\n        return (\n          <div className={styles['column-item']}>\n            <InputRender\n              initValid={initValid}\n              isBlurValid={isBlurValid}\n              key={`${baseKey}${record?.sequence}`}\n              onChange={onChange}\n              record={record}\n              value={value}\n              validate={validateFn}\n              autofocus={autofocus}\n              isPreview={isPreview}\n              maxStrLen={NAME_MAX_STR_LEN}\n            />\n          </div>\n        );\n      },\n    },\n    {\n      title: () => (\n        <div data-testid={KnowledgeE2e.TableLocalTableConfigurationDesc}>\n          {I18n.t('knowledge_table_structure_desc')}\n        </div>\n      ),\n      dataIndex: 'desc',\n      align: 'left' as Align,\n      render: (value, record, index) => {\n        const onChange = (v: string) => {\n          const newData = [...data];\n          newData[index].desc = v;\n          setData(newData);\n        };\n\n        return (\n          <div className={styles['column-item']}>\n            <InputRender\n              initValid={false}\n              isBlurValid={false}\n              key={`column-desc.${baseKey}${record?.sequence}`}\n              placeholder={I18n.t('knowledge_variable_description_placeholder')}\n              onChange={onChange}\n              record={record}\n              value={value}\n              autofocus={false}\n              isPreview={isPreview}\n              maxStrLen={DESC_MAX_STR_LEN}\n            />\n          </div>\n        );\n      },\n    },\n    {\n      title: () => (\n        <RequiredColRender\n          dataTestId={KnowledgeE2e.TableLocalTableConfigurationType}\n        >\n          {I18n.t('knowledge_table_structure_data_type')}\n        </RequiredColRender>\n      ),\n      dataIndex: 'column_type',\n      align: 'left' as Align,\n      render: (value, record, index) => {\n        const valid = isBlurValid ? true : !!value;\n\n        return (\n          <div\n            className={`pr-[16px] ${styles['column-item']}`}\n            key={record.sequence}\n          >\n            {isPreview ? (\n              <Typography.Text className={styles['column-item-value']}>\n                {getDataTypeText(value)}\n              </Typography.Text>\n            ) : (\n              <DataTypeSelect\n                value={value || ''}\n                selectProps={{\n                  disabled: !record.is_new_column && isResegment,\n                  optionList: getDataTypeOptions().map(option => {\n                    if (option.value === ColumnType.Image) {\n                      return {\n                        ...option,\n                        disabled: record.is_semantic,\n                      };\n                    }\n                    return option;\n                  }),\n                  placeholder: I18n.t('db_table_save_exception_fieldtype'),\n                }}\n                errorMsg={\n                  valid\n                    ? undefined\n                    : I18n.t(\n                        'datasets_segment_tableStructure_field_type_errEmpty',\n                      )\n                }\n                handleChange={v => {\n                  const newData = [...data];\n                  newData[index].column_type = v as ColumnType;\n                  setData(newData);\n                }}\n              />\n            )}\n          </div>\n        );\n      },\n    },\n    {\n      title: (\n        <div data-testid={KnowledgeE2e.TableLocalTableConfigurationAction}>\n          {I18n.t('datasets_unit_upload_field_action')}\n        </div>\n      ),\n      dataIndex: 'operate',\n      width: 82,\n      align: 'left' as Align,\n      render: (_text, record, index) => (\n        <div\n          className={styles['column-item-action']}\n          onClick={() => {\n            setData(data.filter((_, i) => index !== i));\n          }}\n        >\n          <Tooltip\n            content={I18n.t(\n              record.is_semantic\n                ? 'datasets_segment_tableStructure_delTips'\n                : 'datasets_table_title_actions_delete',\n            )}\n          >\n            <IconCozTrashCan\n              aria-disabled={Boolean(record.is_semantic)}\n              className={styles['column-item-action-delete']}\n            />\n          </Tooltip>\n        </div>\n      ),\n    },\n  ];\n\n  // In the preview scenario, no operation column is required\n  if (isPreview) {\n    columns.pop();\n  }\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: { distance: 1 },\n    }),\n  );\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event;\n    if (active && over && active.id !== over.id) {\n      const items = Array.from(data);\n      const activeIndex = items.findIndex(item => item.key === active.id);\n      const overIndex = items.findIndex(item => item.key === over.id);\n      setData(arrayMove(items, activeIndex, overIndex));\n    }\n  };\n\n  const SortableRow: FC<{\n    className: string;\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    'data-row-key': string;\n    style: CSSProperties;\n  }> = props => {\n    const {\n      attributes,\n      listeners,\n      setNodeRef,\n      transform,\n      transition,\n      isDragging,\n    } = useSortable({\n      id: props['data-row-key'],\n    });\n    const style: CSSProperties = {\n      ...props.style,\n      transform: cssDndKit.Transform.toString(transform),\n      transition,\n      cursor: isDragging ? 'grabbing' : 'grab',\n      ...(isDragging\n        ? {\n            zIndex: 999,\n            position: 'relative',\n            background: 'rgba(217, 220, 250, 1)',\n          }\n        : {}),\n    };\n\n    return (\n      <tr\n        {...props}\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n      ></tr>\n    );\n  };\n\n  const renderTableContent = () => {\n    if (isDragTable) {\n      return (\n        <DndContext\n          // https://docs.dndkit.com/api-documentation/context-provider#autoscroll\n          autoScroll={true}\n          sensors={sensors}\n          modifiers={[restrictToVerticalAxis]}\n          onDragEnd={handleDragEnd}\n        >\n          <SortableContext\n            items={data.map(item => item.key || '')}\n            strategy={verticalListSortingStrategy}\n          >\n            <Table\n              wrapperClassName={classNames(\n                styles[`${baseClassName}-wrapper`],\n                styles['drag-table'],\n              )}\n              key={baseKey}\n              tableProps={{\n                sticky: true,\n                dataSource: data,\n                columns,\n                pagination: false,\n                className: styles[baseClassName],\n                components: {\n                  body: {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    row: SortableRow as any,\n                  },\n                },\n                ...tableProps,\n              }}\n            />\n          </SortableContext>\n        </DndContext>\n      );\n    }\n\n    return (\n      <Table\n        wrapperClassName={styles[`${baseClassName}-wrapper`]}\n        key={baseKey}\n        tableProps={{\n          sticky: true,\n          dataSource: data,\n          columns,\n          pagination: false,\n          className: styles[baseClassName],\n          ...tableProps,\n        }}\n      />\n    );\n  };\n\n  return (\n    <div className={styles['structure-wrapper']}>\n      {showTitle ? <TableStructureTitle /> : null}\n      {tipsNode ? tipsNode : null}\n      {renderTableContent()}\n      {childrenNode}\n    </div>\n  );\n};\n\nexport const TableStructureTitle = () => (\n  <div\n    className={styles['table-structure-bar-title']}\n    data-testid={KnowledgeE2e.TableLocalTableStructureTitle}\n  >\n    <span>{I18n.t('datasets_segment_tableStructure_title')}</span>\n    <Tooltip content={I18n.t('knowledge_table_structure_column_tooltip')}>\n      <IconCozInfoCircle\n        className={classNames(styles.icon, 'coz-fg-secondary')}\n      />\n    </Tooltip>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  UploadStatus,\n  type UnitItem,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { KNOWLEDGE_UNIT_NAME_MAX_LEN } from '@coze-data/knowledge-modal-base';\nimport { type FileItem } from '@coze-arch/bot-semi/Upload';\n\nimport { getFileExtension } from '../../utils/common';\n\ninterface GetFileListMapRes {\n  [key: string]: FileItem;\n}\n\nconst getFileName = (uri: string) => uri.substring(0, uri.lastIndexOf('.'));\n\nconst getNameFromFileList = (unitList: FileItem[], index: number) =>\n  unitList?.[index]?.name;\n\nconst getFileListMap = (fileList: FileItem[]): GetFileListMapRes =>\n  fileList.reduce((acc: GetFileListMapRes, item) => {\n    acc[item.uid || ''] = item;\n    return acc;\n  }, {});\n\n/** Filter the fileList to keep only the files in the unitList, that is, the files that were uploaded successfully. */\nexport const filterFileListByUnitList = (\n  fileList: FileItem[],\n  unitList: UnitItem[],\n): FileItem[] =>\n  fileList.filter(fileItem =>\n    unitList?.find(unitItem => unitItem.uri === fileItem?.response?.upload_uri),\n  );\n\nconst fileItem2UnitItem = (\n  file: FileItem,\n  config?: { filename?: string },\n): UnitItem => ({\n  type: getFileExtension(file?.response?.upload_uri || file.name),\n  uri: file?.response?.upload_uri,\n  url: file?.response?.upload_url,\n  name: (config?.filename ?? getFileName(file.name)).slice(\n    0,\n    KNOWLEDGE_UNIT_NAME_MAX_LEN,\n  ),\n  size: file.size,\n  status: file.status as UnitItem['status'],\n  percent: file.percent || 0,\n  fileInstance: file.fileInstance,\n  uid: file.uid,\n  validateMessage: (file.validateMessage as string) || '',\n});\n\nexport const filterFileList = (fileList: FileItem[]): UnitItem[] => {\n  const filteredList: UnitItem[] = fileList\n    .filter(\n      item =>\n        !(!item.shouldUpload && item.status === UploadStatus.VALIDATE_FAIL),\n    )\n    .map((file, index) => {\n      const filename = getNameFromFileList(fileList, index);\n      return fileItem2UnitItem(file, { filename });\n    });\n  return filteredList;\n};\n\nexport const filterUnitList = (\n  unitList: UnitItem[],\n  fileList: FileItem[],\n): UnitItem[] => {\n  const fileListMap = getFileListMap(fileList);\n  return unitList\n    .filter(unit => {\n      const file = fileListMap[unit.uid || ''];\n      if (!file.shouldUpload && file.status === UploadStatus.VALIDATE_FAIL) {\n        return false;\n      }\n      return true;\n    })\n    .map((unit, index) => {\n      const file = fileListMap[unit.uid || ''];\n      const filename = getNameFromFileList(fileList, index);\n      return {\n        ...unit,\n        ...fileItem2UnitItem(file, { filename }),\n      };\n    });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { type RenderFileItemProps } from '@coze-arch/bot-semi/Upload';\nimport {\n  IconPDFFile,\n  IconUnknowFile as IconUnknownFile,\n  IconTextFile,\n  IconDocxFile,\n} from '@coze-arch/bot-icons';\n\nimport { getFileExtension } from '../../utils/common';\nimport { type FileType } from './types';\n\nexport const PreviewFile: FC<RenderFileItemProps> = props => {\n  const type = (getFileExtension(props.name) || 'unknown') as FileType;\n\n  const components: Record<FileType, React.FC> = {\n    unknown: IconUnknownFile,\n    pdf: IconPDFFile,\n    text: IconTextFile,\n    docx: IconDocxFile,\n  };\n\n  const ComponentToRender = components[type] || IconUnknownFile;\n\n  return <ComponentToRender />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { UploadStatus } from '@coze-data/knowledge-resource-processor-core';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { type UploadProps } from '@coze-arch/bot-semi/Upload';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { FileBizType } from '@coze-arch/bot-api/developer_api';\nimport { DeveloperApi } from '@coze-arch/bot-api';\n\nimport { getBase64, getFileExtension } from '../../utils';\n\nexport const customRequest: UploadProps['customRequest'] = async options => {\n  const { onSuccess, onError, onProgress, file } = options;\n\n  try {\n    // business\n    const { name, fileInstance } = file;\n\n    if (fileInstance) {\n      const extension = getFileExtension(name);\n\n      const base64 = await getBase64(fileInstance);\n      const result = await DeveloperApi.UploadFile(\n        {\n          file_head: {\n            file_type: extension,\n            biz_type: FileBizType.BIZ_BOT_DATASET,\n          },\n          data: base64,\n        },\n        {\n          onUploadProgress: e => {\n            const status = file?.status;\n            const response = file?.response;\n            // Success or failure, after the inspection fails, or if the interface data is returned, the progress bar will not be updated.\n            if (\n              status === UploadStatus.SUCCESS ||\n              status === UploadStatus.UPLOAD_FAIL ||\n              status === UploadStatus.VALIDATE_FAIL ||\n              response?.upload_url\n            ) {\n              return;\n            }\n\n            const { total, loaded } = e;\n            if (total !== undefined && loaded < total) {\n              onProgress({\n                total: e.total ?? fileInstance.size,\n                loaded: e.loaded,\n              });\n            }\n          },\n        },\n      );\n      onSuccess(result.data);\n    } else {\n      onError({\n        status: 0,\n      });\n      dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n        eventName: REPORT_EVENTS.KnowledgeUploadFile,\n        error: new CustomError(\n          REPORT_EVENTS.KnowledgeUploadFile,\n          `${REPORT_EVENTS.KnowledgeUploadFile}: Failed to upload file`,\n        ),\n      });\n    }\n  } catch (e) {\n    const error = e as Error;\n    onError({\n      status: 0,\n    });\n    dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n      eventName: REPORT_EVENTS.KnowledgeUploadFile,\n      error,\n    });\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { UploadStatus } from '@coze-data/knowledge-resource-processor-core';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { type UploadProps } from '@coze-arch/bot-semi/Upload';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { getFileExtension, getUint8Array } from '../../utils';\nimport { UNIT_MAX_MB, PDF_MAX_PAGES } from '../../constants';\n\nexport const getBeforeUpload: (params: {\n  maxSizeMB: UploadProps['maxSize'];\n}) => UploadProps['beforeUpload'] =\n  ({ maxSizeMB }) =>\n  async fileInfo => {\n    // The reason for not limiting by the maxSize property is\n    // Only the beforeUpload hook can change validateMessage\n    const res = {\n      fileInstance: fileInfo.file.fileInstance,\n      status: fileInfo.file.status,\n      validateMessage: fileInfo.file.validateMessage,\n      shouldUpload: true,\n      autoRemove: false,\n    };\n\n    const { fileInstance } = fileInfo.file;\n\n    if (!fileInstance) {\n      return {\n        ...res,\n        status: UploadStatus.UPLOAD_FAIL,\n        shouldUpload: false,\n      };\n    }\n\n    const resultMaxSizeMB = maxSizeMB || UNIT_MAX_MB;\n\n    const maxSize = resultMaxSizeMB * 1024 * 1024;\n\n    if (fileInstance.size > maxSize) {\n      Toast.warning({\n        showClose: false,\n        content: I18n.t('file_too_large', {\n          max_size: `${resultMaxSizeMB}MB`,\n        }),\n      });\n\n      return {\n        ...res,\n        shouldUpload: false,\n        status: UploadStatus.VALIDATE_FAIL,\n        validateMessage: I18n.t('file_too_large', {\n          max_size: `${resultMaxSizeMB}MB`,\n        }),\n      };\n    }\n\n    if (getFileExtension(fileInstance.name).toLowerCase() === 'pdf') {\n      try {\n        // TODO: Subsequent pdfjs calls from other locations should also be changed to asynchronous loading\n        const pdfjs = await import('@coze-arch/pdfjs-shadow');\n        const { getDocument, initPdfJsWorker } = pdfjs;\n\n        initPdfJsWorker();\n        const uint8Array = await getUint8Array(fileInstance);\n        const pdfDocument = await getDocument({ data: uint8Array }).promise;\n        if (pdfDocument.numPages > PDF_MAX_PAGES) {\n          Toast.warning({\n            showClose: false,\n            content: I18n.t('atasets_createpdf_over250'),\n          });\n          return {\n            shouldUpload: false,\n            status: UploadStatus.VALIDATE_FAIL,\n          };\n        }\n      } catch (e) {\n        const error = e as Error;\n        dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n          eventName: REPORT_EVENTS.KnowledgeParseFile,\n          error,\n        });\n        if (error?.name === 'PasswordException') {\n          Toast.error({\n            showClose: false,\n            content: I18n.t('pdf_encrypted'),\n          });\n          return {\n            shouldUpload: false,\n            status: UploadStatus.VALIDATE_FAIL,\n          };\n        }\n      }\n    }\n    return res;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, useCallback, useMemo, type FC } from 'react';\n\nimport classNames from 'classnames';\nimport { IllustrationSuccess } from '@douyinfe/semi-illustrations';\nimport { abortable, useUnmountSignal } from '@coze-data/utils';\nimport { type UnitItem } from '@coze-data/knowledge-resource-processor-core';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  type FileItem,\n  type UploadProps,\n  type OnChangeProps,\n} from '@coze-arch/bot-semi/Upload';\nimport { IconCozUpload } from '@coze-arch/coze-design/icons';\nimport { Toast, Upload } from '@coze-arch/coze-design';\n\nimport { UNIT_MAX_MB } from '../../constants';\nimport {\n  filterFileListByUnitList,\n  filterFileList,\n  filterUnitList,\n} from './utils';\nimport { PreviewFile } from './preview-file';\nimport { customRequest } from './custom-request';\nimport { getBeforeUpload } from './before-upload';\n\nimport styles from './index.module.less';\n\ninterface UploadUnitFileProps extends UploadProps {\n  unitList: UnitItem[];\n  onFinish: (unitList: UnitItem[]) => void;\n  limit: number;\n  accept: string;\n  setUnitList: (unitList: UnitItem[]) => void;\n  showIllustration?: boolean;\n  maxSizeMB?: number;\n}\n\nexport const UploadUnitFile: FC<UploadUnitFileProps> = props => {\n  const {\n    unitList,\n    onFinish,\n    setUnitList,\n    showIllustration = true,\n    multiple = true,\n    maxSizeMB = UNIT_MAX_MB,\n    ...uploadProps\n  } = props;\n  const { limit } = uploadProps;\n\n  const [fileList, setFileList] = useState<FileItem[]>([]);\n\n  useEffect(() => {\n    if (unitList.length < fileList.length) {\n      setFileList(filterFileListByUnitList(fileList, unitList));\n    }\n  }, [unitList.length]);\n\n  const handleAcceptInvalid = useCallback(() => {\n    Toast.warning({\n      showClose: false,\n      content: I18n.t('knowledge_upload_format_error'),\n    });\n  }, []);\n\n  const signal = useUnmountSignal();\n\n  const handleUploadProcess = abortable((data: OnChangeProps) => {\n    setFileList(data.fileList);\n    setUnitList(filterFileList(data.fileList));\n  }, signal);\n\n  const handleUploadSuccess = abortable(() => {\n    onFinish(filterUnitList(unitList, fileList));\n  }, signal);\n\n  const uploadDisabled = useMemo(\n    () => unitList.length >= limit,\n    [unitList, limit],\n  );\n  const beforeUpload = getBeforeUpload({ maxSizeMB });\n  return (\n    <Upload\n      draggable\n      data-testid={KnowledgeE2e.UploadUnitFile}\n      multiple={multiple}\n      fileList={fileList}\n      disabled={uploadDisabled}\n      previewFile={PreviewFile}\n      onAcceptInvalid={handleAcceptInvalid}\n      beforeUpload={beforeUpload}\n      customRequest={customRequest}\n      onChange={handleUploadProcess}\n      onSuccess={handleUploadSuccess}\n      dragIcon={<IconCozUpload className={styles['upload-icon']} />}\n      {...uploadProps}\n      className={classNames(styles.upload, uploadProps.className)}\n    >\n      {unitList.length >= limit && showIllustration ? (\n        <div\n          className={styles['create-enough-file']}\n          onClick={e => e.stopPropagation()}\n        >\n          <IllustrationSuccess className={styles.picture} />\n          <div className={styles.text}>\n            {I18n.t('knowledge_1218_001', {\n              MaxDocs: limit,\n            })}\n          </div>\n        </div>\n      ) : null}\n    </Upload>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type UnitItem } from '@coze-data/knowledge-resource-processor-core';\nimport { useEditUnitNameModal } from '@coze-data/knowledge-modal-base';\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozEdit,\n  IconCozRefresh,\n  IconCozTrashCan,\n} from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { type RenderColumnsProps } from '../types';\nimport { getFrequencyMap } from '../../../utils';\n\nexport function getFileSizeInfo(record: UnitItem) {\n  return (\n    <div\n      data-dtestid={`${KnowledgeE2e.LocalUploadListFileSize}.${record.name}`}\n      className={'coz-fg-secondary text-12px'}\n    >\n      {record?.size}\n    </div>\n  );\n}\n\nexport function getFrequencyInfo(record: UnitItem) {\n  return (\n    <div\n      data-dtestid={`${KnowledgeE2e.LocalUploadListFrequency}.${record.name}`}\n      className={'coz-fg-secondary text-12px'}\n    >\n      {getFrequencyMap(record.updateInterval || 0)}\n    </div>\n  );\n}\n\nexport function ActionRenderByDelete(props: RenderColumnsProps) {\n  const { index, record, params } = props;\n  const { onChange, unitList, onDelete } = params;\n\n  const handleDelete = () => {\n    onChange(unitList.filter((u, i) => index !== i));\n    if (typeof onDelete === 'function') {\n      onDelete?.(record, index);\n    }\n  };\n  return (\n    <Tooltip spacing={12} content={I18n.t('Delete')} position=\"top\">\n      <IconButton\n        color=\"secondary\"\n        icon={<IconCozTrashCan className=\"text-14px\" />}\n        iconPosition=\"left\"\n        size=\"small\"\n        onClick={handleDelete}\n      ></IconButton>\n    </Tooltip>\n  );\n}\n\nexport function ActionRenderByEditName(props: RenderColumnsProps) {\n  const { index, record, params } = props;\n  const { onChange, unitList } = params;\n\n  const { node, open } = useEditUnitNameModal({\n    name: record?.name ?? '',\n    onOk: (name: string) => {\n      const arr = [...unitList];\n      arr[index].name = name;\n      onChange(arr);\n    },\n  });\n  return (\n    <>\n      <Tooltip spacing={12} content={I18n.t('Edit')} position=\"top\">\n        <IconButton\n          color=\"secondary\"\n          icon={<IconCozEdit className=\"text-14px\" />}\n          iconPosition=\"left\"\n          size=\"small\"\n          onClick={() => open()}\n        />\n      </Tooltip>\n      {node}\n    </>\n  );\n}\n\nexport function ActionRenderByRetry(props: RenderColumnsProps) {\n  const { index, record, params } = props;\n  if (params.disableRetry) {\n    return null;\n  }\n  const { onRetry } = params;\n\n  const handleRetry = () => {\n    onRetry?.(record, index);\n  };\n  return (\n    <Tooltip\n      spacing={12}\n      content={I18n.t('datasets_unit_update_retry')}\n      position=\"top\"\n    >\n      <IconButton\n        color=\"secondary\"\n        icon={<IconCozRefresh className=\"text-14px\" />}\n        iconPosition=\"left\"\n        size=\"small\"\n        onClick={handleRetry}\n      ></IconButton>\n    </Tooltip>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, type ReactNode } from 'react';\n\nimport { KnowledgeE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ProcessProgressItem } from '../process-progress-item/process-progress-item';\nimport { ProcessStatus } from '../../types';\nimport { getProcessStatus, getTypeIcon } from './utils';\nimport { type ColumnInfo, type UploadUnitTableProps } from './types';\n\nconst INIT_PERCENT = 10;\n\nconst renderSubText = (\n  status: ProcessStatus,\n  statusDesc: string,\n  subText: ReactNode,\n) => {\n  if (status === ProcessStatus.Failed) {\n    return (\n      <div\n        data-dtestid={`${KnowledgeE2e.CreateUnitListProgressName}.${'subText'}`}\n        className={'text-12px'}\n      >\n        {statusDesc || I18n.t('datasets_unit_upload_fail')}\n      </div>\n    );\n  }\n\n  return subText;\n};\n\nexport const UploadUnitTable: FC<UploadUnitTableProps> = props => {\n  const { unitList = [], getColumns } = props;\n  if (unitList.length === 0) {\n    return null;\n  }\n  return (\n    <div className=\"upload-container\">\n      {unitList.map((item, index) => {\n        const curStatus = getProcessStatus(item?.status);\n        const statusDescript = item?.statusDescript || '';\n\n        // Use getColumns to obtain information for each item\n        const columnInfo: ColumnInfo = getColumns\n          ? getColumns(item, index)\n          : {};\n        const { subText, actions, formatType } = columnInfo;\n\n        return (\n          <ProcessProgressItem\n            key={item.uid}\n            mainText={item.name || '--'}\n            subText={renderSubText(curStatus, statusDescript, subText)}\n            tipText={\n              <span\n                data-dtestid={`${KnowledgeE2e.LocalUploadListStatus}.${item.name}`}\n              >\n                {curStatus === ProcessStatus.Failed\n                  ? statusDescript || I18n.t('datasets_unit_upload_fail')\n                  : I18n.t('datasets_unit_upload_success')}\n              </span>\n            }\n            status={curStatus}\n            avatar={getTypeIcon({ ...item, formatType })}\n            actions={actions}\n            percent={item.percent || INIT_PERCENT}\n          />\n        );\n      })}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  EntityStatus,\n  UploadStatus,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { WebStatus } from '@coze-arch/idl/knowledge';\nimport { Image } from '@coze-arch/bot-semi';\nimport {\n  IconUploadPDF,\n  IconUploadCSV,\n  IconUploadDoc,\n  IconUploadTxt,\n  IconUploadTableUrl,\n  IconUploadXLS,\n  IconUploadTextUrl,\n  IconUploadMD,\n} from '@coze-arch/bot-icons';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\n\nimport { ProcessStatus } from '../../types';\n\nenum UploadType {\n  PDF = 'pdf',\n  DOCX = 'docx',\n  TXT = 'txt',\n  XLSX = 'xlsx',\n  XLTX = 'xltx',\n  CSV = 'csv',\n  PNG = 'png',\n  JPG = 'jpg',\n  JPEG = 'jpeg',\n  WEBP = 'webp',\n  XLS = 'xls',\n  MD = 'md',\n}\nexport const getTypeIcon = (params: {\n  type: string | undefined;\n  formatType?: FormatType;\n  url?: string;\n  inModal?: boolean;\n}) => {\n  const { type, formatType, url } = params;\n  // const iconClassName = inModal ? styles['icon-size-24'] : styles.icon;\n  if (\n    formatType === FormatType.Image &&\n    [UploadType.JPG, UploadType.JPEG, UploadType.PNG, UploadType.WEBP].includes(\n      type as UploadType,\n    )\n  ) {\n    return (\n      <Image\n        src={url}\n        width={24}\n        height={24}\n        style={{\n          borderRadius: '4px',\n          marginRight: '12px',\n          flexShrink: 0,\n        }}\n      />\n    );\n  }\n  if (type === UploadType.MD) {\n    return <IconUploadMD />;\n  }\n  if (type === UploadType.PDF) {\n    return <IconUploadPDF />;\n  }\n  if (type === UploadType.DOCX) {\n    return <IconUploadDoc />;\n  }\n  if (type === UploadType.TXT) {\n    return <IconUploadTxt />;\n  }\n  if (\n    type === UploadType.XLSX ||\n    type === UploadType.XLTX ||\n    type === UploadType.XLS\n  ) {\n    return <IconUploadXLS />;\n  }\n  if (type === UploadType.CSV) {\n    return <IconUploadCSV />;\n  }\n\n  return formatType === FormatType.Table ? (\n    <IconUploadTableUrl />\n  ) : (\n    <IconUploadTextUrl />\n  );\n};\n\nexport const getProcessStatus = (\n  status: UploadStatus | WebStatus | EntityStatus,\n) => {\n  if (\n    status === UploadStatus.UPLOADING ||\n    status === UploadStatus.VALIDATING ||\n    status === UploadStatus.WAIT ||\n    status === WebStatus.Handling ||\n    status === EntityStatus.EntityStatusProcess\n  ) {\n    return ProcessStatus.Processing;\n  }\n\n  if (\n    status === UploadStatus.SUCCESS ||\n    status === WebStatus.Finish ||\n    status === EntityStatus.EntityStatusSuccess\n  ) {\n    return ProcessStatus.Complete;\n  }\n\n  if (\n    status === UploadStatus.VALIDATE_FAIL ||\n    status === UploadStatus.UPLOAD_FAIL ||\n    status === WebStatus.Failed ||\n    status === EntityStatus.EntityStatusFail\n  ) {\n    return ProcessStatus.Failed;\n  }\n  return ProcessStatus.Processing;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const SUCCESSFUL_UPLOAD_PROGRESS = 100;\n\nexport const POLLING_TIME = 3000;\n\nexport const MAX_UNIT_NAME_LEN = 100;\n\nexport const BOT_DATA_REFACTOR_CLASS_NAME = 'data-refactor';\n\nexport const TABLE_ACCEPT_LOCAL_FILE = ['.xls', '.xlsx', '.csv'];\n\ninterface TextUploadChannelConfig {\n  acceptFileTypes: string[];\n  fileFormatString: string;\n  addUnitMaxLimit: number;\n}\n\nexport type Channel = 'DOUYIN' | 'DEFAULT';\n\nconst textUploadChannelConfigMap: Record<Channel, TextUploadChannelConfig> = {\n  DOUYIN: {\n    acceptFileTypes: ['.pdf', '.txt', '.doc', '.docx'],\n    fileFormatString: 'PDFTXTDOCDOCX',\n    addUnitMaxLimit: 100,\n  },\n  DEFAULT: {\n    acceptFileTypes: ['.pdf', '.txt', '.docx', '.md'],\n    fileFormatString: 'PDFTXTDOCXMD',\n    addUnitMaxLimit: 300,\n  },\n};\n\nexport const getTextUploadChannelConfig = (\n  channel?: Channel,\n): TextUploadChannelConfig =>\n  (channel && textUploadChannelConfigMap[channel]) ||\n  textUploadChannelConfigMap.DEFAULT;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** update frequency */\nexport enum FrequencyDay {\n  ZERO = 0,\n  ONE = 1,\n  THREE = 3,\n  SEVEN = 7,\n  THIRTY = 30,\n}\nexport enum TableSettingFormFields {\n  SHEET = 'sheet_id',\n  KEY_START_ROW = 'header_line_idx',\n  DATA_START_ROW = 'start_line_idx',\n}\n\n/** Knowledge base upload file maximum size 100MB */\nexport const UNIT_MAX_MB = 100;\n\nexport const PDF_MAX_PAGES = 500;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** table common constants */\n\nexport enum TableStatus {\n  ERROR = 'error',\n  LOADING = 'loading',\n  NORMAL = 'normal',\n}\n\nexport const MAX_TABLE_META_COLUMN_LEN = 50;\n\nexport const MAX_TABLE_META_STR_LEN = 30;\n\n/** table-local resegment unit steps */\nexport enum TableLocalResegmentStep {\n  CONFIGURATION,\n  PREVIEW,\n  PROCESSING,\n}\n\nexport enum TableSettingFormFields {\n  SHEET = 'sheet_id',\n  KEY_START_ROW = 'header_line_idx',\n  DATA_START_ROW = 'start_line_idx',\n}\n\nexport const DEFAULT_TABLE_SETTINGS_FROM_ONE = {\n  [TableSettingFormFields.SHEET]: 0,\n  [TableSettingFormFields.KEY_START_ROW]: 0,\n  [TableSettingFormFields.DATA_START_ROW]: 1,\n};\n\nexport const DEFAULT_TABLE_SETTINGS_FROM_ZERO = {\n  [TableSettingFormFields.SHEET]: 0,\n  [TableSettingFormFields.KEY_START_ROW]: 0,\n  [TableSettingFormFields.DATA_START_ROW]: 0,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type CustomSegmentRule, SeperatorType } from '../types';\n\nconst getSeperatorSelect = () => ({\n  [SeperatorType.LINE_BREAK]: I18n.t('datasets_Custom_segmentID_linebreak'),\n  [SeperatorType.LINE_BREAK2]: I18n.t('datasets_Custom_segmentID_2linebreak'),\n  [SeperatorType.CN_PERIOD]: I18n.t('datasets_Custom_segmentID_cnperiod'),\n  [SeperatorType.CN_EXCLAMATION]: I18n.t(\n    'datasets_Custom_segmentID_cn_exclamation',\n  ),\n  [SeperatorType.EN_PERIOD]: I18n.t('datasets_Custom_segmentID_enperiod'),\n  [SeperatorType.EN_EXCLAMATION]: I18n.t(\n    'datasets_Custom_segmentID_en_exclamation',\n  ),\n  [SeperatorType.CN_QUESTION]: I18n.t('datasets_Custom_segmentID_cn_question'),\n  [SeperatorType.EN_QUESTION]: I18n.t('datasets_Custom_segmentID_en_question'),\n  [SeperatorType.CUSTOM]: I18n.t('datasets_Custom_segmentID_custom'),\n});\n\nexport const getSeperatorOptionList = () =>\n  Object.entries(getSeperatorSelect()).map(([k, label]) => ({\n    value: k,\n    label,\n  }));\n\nconst defaultMaxTokens = 800;\n\nconst defaultOverlap = 10;\n\nexport const defaultCustomSegmentRule: CustomSegmentRule = {\n  separator: {\n    type: SeperatorType.LINE_BREAK,\n    customValue: '###',\n  },\n  maxTokens: defaultMaxTokens,\n  preProcessRules: [],\n  overlap: defaultOverlap,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nexport enum ProcessStatus {\n  Processing, // Processing\n  Complete, // Processing complete\n  Failed, // Processing failed\n}\nexport interface ProcessProgressItemProps {\n  className?: string | undefined;\n  style?: React.CSSProperties;\n  mainText: string;\n  subText: ReactNode;\n  percent: number;\n  status: ProcessStatus;\n  actions?: Array<ReactNode>;\n  avatar: ReactNode;\n  tipText?: ReactNode;\n  percentFormat?: ReactNode;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum SegmentMode {\n  AUTO,\n  CUSTOM,\n  LEVEL,\n}\n\nexport enum PreProcessRule {\n  REMOVE_SPACES = 'remove_extra_spaces',\n  REMOVE_EMAILS = 'remove_urls_emails',\n}\n\nexport enum SeperatorType {\n  LINE_BREAK = '\\n',\n  LINE_BREAK2 = '\\n\\n',\n  CN_PERIOD = '',\n  CN_EXCLAMATION = '',\n  EN_PERIOD = '.',\n  EN_EXCLAMATION = '!',\n  CN_QUESTION = '',\n  EN_QUESTION = '?',\n  CUSTOM = 'custom',\n}\n\nexport interface Seperator {\n  type: SeperatorType;\n  customValue?: string;\n}\n\nexport interface CustomSegmentRule {\n  separator: Seperator;\n  maxTokens: number;\n  preProcessRules: PreProcessRule[];\n  /** segmented overlap */\n  overlap: number;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { useKnowledgeParams } from '@coze-data/knowledge-stores';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport {\n  type UnitItem,\n  OptType,\n  UploadStatus,\n  type CreateUnitStatus,\n  UnitType,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport {\n  type DocumentInfo,\n  DocumentStatus,\n  type DocumentProgress,\n} from '@coze-arch/bot-api/knowledge';\nimport { type UploadFileData } from '@coze-arch/bot-api/developer_api';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { SUCCESSFUL_UPLOAD_PROGRESS } from '../constants';\n\nexport const transformUnitList = ({\n  unitList,\n  data,\n  fileInstance,\n  index,\n}: {\n  unitList: UnitItem[];\n  data: UploadFileData | undefined;\n  fileInstance: File;\n  index: number;\n}): UnitItem[] => {\n  if (!data) {\n    return unitList;\n  }\n  const filteredList = unitList.map((unit, i) => {\n    if (index === i) {\n      return {\n        ...unit,\n        uri: data.upload_uri || '',\n        status: UploadStatus.SUCCESS,\n        percent: 100,\n        fileInstance,\n      };\n    }\n    return unit;\n  });\n  // TODO as to be solved\n  return filteredList as UnitItem[];\n};\n\nexport function reportFailGetProgress(data: DocumentProgress[]) {\n  const failIds = data.filter(item => item.status === DocumentStatus.Failed);\n  if (failIds.length) {\n    dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n      eventName: REPORT_EVENTS.KnowledgeGetTaskProgress,\n      error: new CustomError(\n        REPORT_EVENTS.KnowledgeGetTaskProgress,\n        `${\n          REPORT_EVENTS.KnowledgeGetTaskProgress\n        }: get progress fail. ${JSON.stringify(failIds)}`,\n      ),\n      meta: {\n        failIds,\n      },\n    });\n  }\n}\n\nexport function isStopPolling(data: DocumentProgress[]) {\n  return (\n    data.length > 0 &&\n    data.every(\n      item =>\n        item.progress === SUCCESSFUL_UPLOAD_PROGRESS ||\n        item.status === DocumentStatus.Failed,\n    )\n  );\n}\n\nexport const clearPolling = (\n  pollingId: React.MutableRefObject<number | undefined>,\n) => {\n  if (pollingId.current) {\n    clearTimeout(pollingId.current);\n    pollingId.current = undefined;\n  }\n};\n\nexport function useOptFromQuery(): OptType {\n  const query = useKnowledgeParams();\n  const opt = get(query, 'opt', OptType.ADD) as OptType;\n  return opt;\n}\n\n/** Why return undefined? You don't necessarily need an empty string. If you can't get it, return undefined. */\n/**Is there still an entrance for docID??? */\nexport function useDocIdFromQuery(): string | undefined {\n  const query = useKnowledgeParams();\n  return get(query, 'docID', undefined);\n}\n\nexport const getFileExtension = (name: string) => {\n  const index = name.lastIndexOf('.');\n  return name.slice(index + 1).toLowerCase();\n};\n\nexport const getBase64 = (file: Blob): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = event => {\n      const result = event.target?.result;\n\n      if (!result || typeof result !== 'string') {\n        reject(new CustomError('getBase64', 'file read invalid'));\n        return;\n      }\n\n      resolve(result.replace(/^.*?,/, ''));\n    };\n    fileReader.onerror = () => {\n      Toast.error(I18n.t('read_file_failed_please_retry'));\n      reject(new CustomError('getBase64', 'file read fail'));\n    };\n    fileReader.onabort = () => {\n      reject(new CustomError('getBase64', 'file read abort'));\n    };\n    fileReader.readAsDataURL(file);\n  });\n\nexport const getUint8Array = (file: Blob): Promise<Uint8Array> =>\n  new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n\n    fileReader.onload = event => {\n      if (event.target?.result) {\n        const arrayBuffer = event.target.result as ArrayBuffer;\n        const uint8Array = new Uint8Array(arrayBuffer);\n        resolve(uint8Array);\n      } else {\n        reject(new CustomError('getUint8Array', 'file read invalid'));\n      }\n    };\n\n    fileReader.readAsArrayBuffer(file);\n  });\n\nexport function reportProcessDocumentFail(\n  docInfos: DocumentInfo[],\n  reportEventName: string,\n) {\n  const failDocumentIds = docInfos.filter(\n    item => item.status === DocumentStatus.Failed,\n  );\n  failDocumentIds.length > 0 &&\n    dataReporter.errorEvent(DataNamespace.KNOWLEDGE, {\n      eventName: reportEventName,\n      error: new CustomError(\n        reportEventName,\n        `${reportEventName}: fail document_ids are ${JSON.stringify(\n          failDocumentIds,\n        )}`,\n      ),\n      meta: {\n        failDocumentIds,\n      },\n    });\n}\n\nexport const getProcessingDescMsg = (taskStatus: CreateUnitStatus) =>\n  I18n.t('knowledge_add_unit_process_notice');\n// taskStatus === CreateUnitStatus.TASK_FINISH\n//   ? ''\n//   : I18n.t('knowledge_add_unit_process_notice');\n\nexport const isThirdResegment = (opt: OptType, type: UnitType | undefined) =>\n  opt === OptType.RESEGMENT &&\n  type &&\n  [UnitType.TABLE_GOOGLE_DRIVE, UnitType.TABLE_FEISHU].includes(type);\n\nexport const isIncremental = (opt: OptType) => opt === OptType.INCREMENTAL;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Dataset, StorageLocation } from '@coze-arch/idl/knowledge';\n\nexport function getStorageStrategyEnabled(dataset?: Dataset) {\n  return (\n    // Cloud search is only available in the domestic environment\n    IS_CN_REGION &&\n    // Cloud search can only be configured if the knowledge base is uploaded for the first time.\n    dataset?.doc_count === 0 &&\n    dataset?.storage_location === StorageLocation.Default\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** This file contains table utils */\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type TableSettings } from '../types';\nimport { FrequencyDay, TableSettingFormFields } from '../constants';\n\nexport const getFrequencyMap = (updateInterval: FrequencyDay): string => {\n  const frequencyMap = {\n    [FrequencyDay.ZERO]: I18n.t('datasets_frequencyModal_frequency_noUpdate'),\n    [FrequencyDay.ONE]: I18n.t('datasets_frequencyModal_frequency_day', {\n      num: 1,\n    }),\n    [FrequencyDay.THREE]: I18n.t('datasets_frequencyModal_frequency_day', {\n      num: 3,\n    }),\n    [FrequencyDay.SEVEN]: I18n.t('datasets_frequencyModal_frequency_day', {\n      num: 7,\n    }),\n    [FrequencyDay.THIRTY]: I18n.t('datasets_frequencyModal_frequency_day', {\n      num: 30,\n    }),\n  };\n  return frequencyMap[updateInterval];\n};\n\nexport interface IValidateRes {\n  valid: boolean;\n  errorMsg: string;\n}\n// Verify tableStructure column names and indicate whether they contain special characters\nexport const validateField = (\n  fieldName: string,\n  emptyMsg = '',\n): IValidateRes => {\n  let valid = true;\n  let errorMsg = '';\n\n  // Whether it contains special characters -- > single quotes, double quotes, escape characters, backquotes\n  const notationReg = /[\"'`\\\\]+/g;\n\n  if (!fieldName) {\n    return {\n      valid: false,\n      errorMsg: emptyMsg,\n    };\n  }\n\n  if (notationReg.test(fieldName)) {\n    valid = false;\n    errorMsg = I18n.t('knowledge_tableStructure_field_errLegally');\n  }\n  // Cannot contain _knowledge_slice_id keywords\n  if (['_knowledge_slice_id'].includes(fieldName)) {\n    valid = false;\n    errorMsg = I18n.t('knowledge_tableStructure_errSystemField');\n  }\n  return {\n    valid,\n    errorMsg,\n  };\n};\nexport const getSrcFromImg = (str: string): string[] => {\n  if (!str) {\n    return [];\n  }\n  const imgRegx = /<img[^>]+src\\s*=\\s*['\"]([^'\"]+)['\"][^>]*>/g;\n  // Matching using regular expressions\n  const matches = str.match(imgRegx);\n\n  // Extract the value of the src attribute from the matching result\n  const srcList: string[] = [];\n  if (matches) {\n    for (let i = 0; i < matches.length; i++) {\n      const match = matches[i];\n      const src = match.match(/src\\s*=\\s*['\"]([^'\"]+)['\"]/)?.[1];\n      if (src) {\n        srcList.push(src);\n      }\n    }\n  }\n  return srcList;\n};\n\nexport const isKeyInTableSettings = (\n  key: string,\n): key is TableSettingFormFields =>\n  Object.values(TableSettingFormFields).includes(key as TableSettingFormFields);\n\nexport const tableSettingsToString = (tableSettings: TableSettings) => {\n  const res: { [key in keyof TableSettings]: string } = {\n    sheet_id: '',\n    header_line_idx: '',\n    start_line_idx: '',\n  };\n  Object.keys(tableSettings).reduce((acc, key) => {\n    if (isKeyInTableSettings(key)) {\n      acc[key] = String(get(tableSettings, key));\n    }\n    return acc;\n  }, res);\n  return res;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ChunkType,\n  type ChunkStrategy,\n  type DocumentInfo,\n} from '@coze-arch/bot-api/knowledge';\n\nimport { defaultCustomSegmentRule } from '@/constants/text';\n\nimport {\n  SegmentMode,\n  PreProcessRule,\n  SeperatorType,\n  type Seperator,\n} from '../types';\n\nexport const getSegmentMode = (rule: ChunkStrategy) => {\n  if (rule.chunk_type === ChunkType.CustomChunk) {\n    return SegmentMode.CUSTOM;\n  }\n  if (rule.chunk_type === ChunkType.LevelChunk) {\n    return SegmentMode.LEVEL;\n  }\n  return SegmentMode.AUTO;\n};\n\nexport const getSegmentCleanerParams = (docInfo: DocumentInfo) => {\n  if (docInfo && Object.keys(docInfo) && docInfo?.chunk_strategy) {\n    try {\n      const rule = docInfo?.chunk_strategy || {};\n      const preProcessRules: PreProcessRule[] = [];\n      if (rule.remove_extra_spaces) {\n        preProcessRules.push(PreProcessRule.REMOVE_SPACES);\n      }\n      if (rule.remove_urls_emails) {\n        preProcessRules.push(PreProcessRule.REMOVE_EMAILS);\n      }\n      return {\n        docInfo,\n        segmentMode: getSegmentMode(docInfo?.chunk_strategy),\n        segmentRule: {\n          separator: rule.separator\n            ? getSeparator(rule.separator as SeperatorType)\n            : defaultCustomSegmentRule.separator,\n          maxTokens: rule.max_tokens\n            ? Number(rule.max_tokens)\n            : defaultCustomSegmentRule.maxTokens,\n          preProcessRules,\n          overlap: rule.overlap\n            ? Number(rule.overlap)\n            : defaultCustomSegmentRule.overlap,\n        },\n      };\n    } catch (e) {\n      return undefined;\n    }\n  }\n  return undefined;\n};\n\nfunction getSeperatorTypeExceptCustom(\n  seperatorType: typeof SeperatorType,\n): string[] {\n  const result: string[] = [];\n\n  for (const [, value] of Object.entries(seperatorType)) {\n    if (value !== seperatorType.CUSTOM) {\n      result.push(value);\n    }\n  }\n\n  return result;\n}\n\nexport const getSeparator = (separator: SeperatorType): Seperator => {\n  const seperatorType = getSeperatorTypeExceptCustom(SeperatorType);\n  if (seperatorType.indexOf(separator) > -1) {\n    return {\n      type: separator,\n    };\n  }\n  return {\n    type: SeperatorType.CUSTOM,\n    customValue: separator,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FooterBtnStatus } from '@coze-data/knowledge-resource-processor-core';\n\nimport { type CustomSegmentRule, SegmentMode, SeperatorType } from '../types';\n\nexport const validateCommonDocResegmentStep = (\n  segmentMode: SegmentMode,\n  segmentRule: CustomSegmentRule,\n): FooterBtnStatus => {\n  if (segmentMode === SegmentMode.CUSTOM) {\n    const maxTokens = segmentRule?.maxTokens || 0;\n    const separator = segmentRule?.separator;\n    const isCustomSeperatorEmpty =\n      separator?.type === SeperatorType.CUSTOM && !separator?.customValue;\n\n    if (\n      maxTokens === 0 ||\n      isCustomSeperatorEmpty ||\n      typeof segmentRule.overlap !== 'number' ||\n      Number.isNaN(segmentRule.overlap)\n    ) {\n      return FooterBtnStatus.DISABLE;\n    }\n  }\n\n  return FooterBtnStatus.ENABLE;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { useState, type FC, useRef, useEffect, useCallback } from 'react';\n\nimport { CozeFormTextArea, CozeInputWithCountField } from '@coze-data/utils';\nimport {\n  PictureUpload,\n  type RenderAutoGenerateParams,\n} from '@coze-common/biz-components/picture-upload';\nimport { I18n } from '@coze-arch/i18n';\nimport { Form, type FormApi, Modal } from '@coze-arch/coze-design';\nimport { FormatType } from '@coze-arch/bot-api/memory';\nimport { FileBizType, IconType } from '@coze-arch/bot-api/developer_api';\nimport { KnowledgeApi } from '@coze-arch/bot-api';\n\nimport styles from './index.module.less';\n\nexport enum ModalMode {\n  CREATE = 'create',\n  EDIT = 'edit',\n}\n\nexport interface UseDatabaseBaseInfoModalProps {\n  onSubmit: (formData: FormData) => void;\n  onClose?: () => void;\n  initValues: FormData | undefined;\n  mode: ModalMode;\n  renderAutoGenerate?: (params: RenderAutoGenerateParams) => React.ReactNode;\n}\n\nexport interface DatabaseBaseInfoModalProps\n  extends UseDatabaseBaseInfoModalProps {\n  visible: boolean;\n}\n\nexport const useDatabaseInfoModal = ({\n  onSubmit,\n  onClose,\n  initValues,\n  mode = ModalMode.CREATE,\n  renderAutoGenerate,\n}: UseDatabaseBaseInfoModalProps) => {\n  const [visible, setVisible] = useState(false);\n\n  const open = () => {\n    setVisible(true);\n  };\n\n  const close = () => {\n    setVisible(false);\n    onClose?.();\n  };\n\n  return {\n    visible,\n    open,\n    close,\n    modal: (\n      <DatabaseBaseInfoModal\n        visible={visible}\n        onClose={close}\n        onSubmit={onSubmit}\n        initValues={initValues}\n        mode={mode}\n        renderAutoGenerate={renderAutoGenerate}\n      />\n    ),\n  };\n};\n\nexport interface FormData {\n  name: string;\n  description: string;\n  icon_uri?: Array<{\n    url: string;\n    uri: string;\n    uid?: string;\n    isDefault?: boolean;\n  }>;\n}\n\nexport const DatabaseBaseInfoModal: FC<DatabaseBaseInfoModalProps> = ({\n  visible,\n  initValues,\n  onClose,\n  onSubmit,\n  mode,\n  renderAutoGenerate,\n}) => {\n  const formRef = useRef<FormApi<FormData> | null>(null);\n\n  const handleSubmit = async () => {\n    if (!formRef.current) {\n      return;\n    }\n    const formData = await formRef.current.validate();\n\n    onSubmit({\n      ...formData,\n      icon_uri: [\n        {\n          url: formData?.icon_uri?.[0]?.url ?? '',\n          uri: formData?.icon_uri?.[0]?.uid ?? '',\n        },\n      ],\n    });\n  };\n\n  const [coverIcon, setCoverIcon] = useState<{\n    uri: string;\n    url: string;\n  }>({\n    uri: initValues?.icon_uri?.[0]?.uri ?? '',\n    url: initValues?.icon_uri?.[0]?.url ?? '',\n  });\n\n  const [iconInfoGenerate, setIconInfoGenerate] = useState<{\n    name: string;\n    desc: string;\n  }>({\n    name: initValues?.name ?? '',\n    desc: initValues?.description ?? '',\n  });\n\n  const setDefaultIcon = async () => {\n    const { icon } = await KnowledgeApi.GetIcon({\n      format_type: FormatType.Database,\n    });\n    setCoverIcon({\n      uri: icon?.uri ?? '',\n      url: icon?.url ?? '',\n    });\n    formRef.current?.setValue('icon_uri', [\n      {\n        url: icon?.url ?? '',\n        uri: icon?.uri ?? '',\n        uid: icon?.uri ?? '',\n        isDefault: true,\n      },\n    ]);\n  };\n  const initForm = useCallback(\n    ({ name, description, icon_uri }: FormData) => {\n      if (!formRef.current) {\n        return;\n      }\n      formRef.current.setValue('name', name);\n      formRef.current.setValue('description', description);\n      setIconInfoGenerate({\n        name: name ?? '',\n        desc: description ?? '',\n      });\n      if (!icon_uri || !icon_uri[0].url) {\n        setDefaultIcon();\n        return;\n      }\n      formRef.current.setValue('icon_uri', [\n        {\n          url: icon_uri[0].url,\n          uri: icon_uri[0].uri,\n          uid: icon_uri[0].uri,\n          isDefault: true,\n        },\n      ]);\n    },\n    [formRef],\n  );\n  useEffect(() => {\n    if (!visible) {\n      return;\n    }\n    if (!initValues) {\n      return;\n    }\n    initForm(initValues);\n  }, [visible, initValues, initForm]);\n\n  const handleClose = () => {\n    if (formRef.current) {\n      formRef.current?.reset(['name', 'description', 'icon_uri']);\n    }\n    onClose?.();\n  };\n\n  return (\n    <Modal\n      title={\n        mode === ModalMode.CREATE\n          ? I18n.t('db_add_table_title')\n          : I18n.t('db_edit_title')\n      }\n      closable\n      visible={visible}\n      onCancel={handleClose}\n      className=\"w-[480px]\"\n      okText={I18n.t('db2_004')}\n      okButtonProps={{\n        // @ts-expect-error -- for e2e\n        'data-testid': 'database.info_modal.button.confirm',\n      }}\n      cancelText={I18n.t('db_del_field_confirm_no')}\n      onOk={handleSubmit}\n      maskClosable={false}\n    >\n      <Form<FormData>\n        className={styles['database-model-content']}\n        getFormApi={formApi => {\n          formRef.current = formApi;\n        }}\n        initValues={initValues}\n      >\n        {({ formState }) => (\n          <>\n            <CozeInputWithCountField\n              data-testid=\"database.info_modal.input.name\"\n              field=\"name\"\n              label={I18n.t('db_add_table_name')}\n              placeholder={I18n.t('db_add_table_name_tips')}\n              required\n              maxLength={50}\n              disabled={mode === ModalMode.EDIT}\n              onChange={(value: string) => {\n                setIconInfoGenerate(prev => ({\n                  ...prev,\n                  name: value?.trim() || '',\n                }));\n              }}\n              rules={[\n                {\n                  required: true,\n                  message: I18n.t('db2_005'),\n                },\n                {\n                  pattern: /^[a-z][a-z0-9_]{0,63}$/,\n                  message: I18n.t('db_new_0004'),\n                },\n              ]}\n            />\n            <CozeFormTextArea\n              data-testid=\"database.info_modal.input.description\"\n              field=\"description\"\n              label={I18n.t('db_add_table_desc')}\n              placeholder={I18n.t('db_add_table_desc_tips')}\n              maxCount={100}\n              maxlength={100}\n              onChange={(value: string) => {\n                setIconInfoGenerate(prev => ({\n                  ...prev,\n                  desc: value?.trim() || '',\n                }));\n              }}\n            />\n            <PictureUpload\n              label={I18n.t('datasets_model_create_avatar')}\n              field=\"icon_uri\"\n              fileBizType={FileBizType.BIZ_DATASET_ICON}\n              iconType={IconType.Dataset}\n              uploadClassName=\"w-auto\"\n              generateInfo={iconInfoGenerate}\n              withAutoGenerate={!!renderAutoGenerate}\n              renderAutoGenerate={renderAutoGenerate}\n              initValue={[\n                {\n                  url: coverIcon?.url,\n                  uid: coverIcon?.uri,\n                  isDefault: true,\n                },\n              ]}\n            />\n          </>\n        )}\n      </Form>\n    </Modal>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseInfo } from '@coze-studio/bot-detail-store';\nimport {\n  type AlterBotTableResponse,\n  type InsertBotTableResponse,\n} from '@coze-arch/bot-api/memory';\n\nexport type OnSave = (params: {\n  response: InsertBotTableResponse | AlterBotTableResponse;\n}) => Promise<void>;\n\n/* eslint-disable @typescript-eslint/naming-convention -- history file copy */\nexport enum CreateType {\n  custom = 'custom',\n  template = 'template',\n  excel = 'excel',\n  // recommended table\n  recommend = 'recommend',\n  // Enter natural language to build a table\n  naturalLanguage = 'naturalLanguage',\n}\n/* eslint-enable @typescript-eslint/naming-convention -- history file copy */\n\nexport interface MapperItem {\n  label: string;\n  key: string;\n  validator: {\n    type: VerifyType;\n    message: string;\n  }[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- historical file copy\n  defaultValue: any;\n  require: boolean;\n}\n\nexport type TableBasicInfo = Pick<\n  DatabaseInfo,\n  'name' | 'desc' | 'readAndWriteMode'\n> & { prompt_disabled: boolean };\nexport type TableFieldsInfo = DatabaseInfo['tableMemoryList'];\n\nexport enum VerifyType {\n  Required = 1,\n  Unique = 2,\n  Naming = 3,\n}\n\nexport type TriggerType = 'blur' | 'change' | 'save';\n\nexport interface NL2DBInfo {\n  prompt: string;\n}\n\nexport type ReadAndWriteModeOptions = 'excel' | 'normal' | 'expert';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Database details page tab\n */\nexport enum DatabaseTabs {\n  /** table structure */\n  Structure = 'structure',\n  /** test data */\n  Draft = 'draft',\n  /** online data */\n  Online = 'online',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Steps } from '@coze-arch/coze-design';\n\nexport enum BatchImportStep {\n  Upload,\n  Config,\n  Preview,\n  Process,\n}\n\nexport interface BatchImportStepsProps {\n  step: BatchImportStep;\n}\n\nexport function BatchImportSteps({ step }: BatchImportStepsProps) {\n  return (\n    <Steps\n      type=\"basic\"\n      hasLine={false}\n      current={step}\n      className={classNames(\n        'my-[24px] justify-center',\n        '[&_.semi-steps-item]:flex-none',\n        '[&_.semi-steps-item-title]:!max-w-[unset]',\n      )}\n    >\n      <Steps.Step title={I18n.t('db_optimize_014')} />\n      <Steps.Step title={I18n.t('db_optimize_015')} />\n      <Steps.Step title={I18n.t('db_optimize_016')} />\n      <Steps.Step title={I18n.t('db_optimize_017')} />\n    </Steps>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport {\n  type BannerProps,\n  IconButton,\n  Typography,\n} from '@coze-arch/coze-design';\n\nexport type BannerType = NonNullable<BannerProps['type']>;\n\nconst BannerClassNames: Record<BannerType, string> = {\n  info: 'bg-[rgba(var(--coze-brand-1),var(--coze-brand-1-alpha))]',\n  warning: 'bg-[rgba(var(--coze-yellow-1),var(--coze-yellow-1-alpha))]',\n  danger: 'bg-[rgba(var(--coze-red-1),var(--coze-red-1-alpha))]',\n  success: 'bg-[rgba(var(--coze-green-1),var(--coze-green-1-alpha))]',\n};\n\nexport interface DismissibleBannerProps extends PropsWithChildren {\n  type?: BannerType;\n  persistentKey: string;\n  className?: string;\n}\n\nexport function DismissibleBanner({\n  type,\n  persistentKey,\n  className,\n  children,\n}: DismissibleBannerProps) {\n  const [dismissed, setDismissed] = useState(\n    Boolean(localStorage.getItem(persistentKey)),\n  );\n  const [closed, setClosed] = useState(false);\n\n  if (dismissed || closed) {\n    return null;\n  }\n\n  return (\n    <div\n      className={classNames(\n        'p-[8px] flex justify-center',\n        BannerClassNames[type ?? 'info'],\n        className,\n      )}\n    >\n      <div className=\"flex grow justify-center text-[14px] leading-[20px]\">\n        {children}\n      </div>\n      <div className=\"flex items-center gap-[10px] leading-none\">\n        <Typography.Text\n          type=\"secondary\"\n          fontSize=\"12px\"\n          className=\"cursor-pointer\"\n          onClick={() => {\n            localStorage.setItem(persistentKey, '1');\n            setDismissed(true);\n          }}\n        >\n          {I18n.t('not_show_again')}\n        </Typography.Text>\n        <IconButton\n          color=\"secondary\"\n          size=\"mini\"\n          className=\"!h-[unset]\"\n          icon={<IconCozCross className=\"w-[16px] h-[16px]\" />}\n          onClick={() => setClosed(true)}\n        />\n      </div>\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classnames from 'classnames';\nimport {\n  Select,\n  type SelectProps,\n  type InputProps,\n} from '@coze-arch/coze-design';\n\nimport s from './index.module.less';\n\nexport interface SLSelectRefType {\n  triggerFocus?: () => void;\n}\n\nexport type SLSelectProps = InputProps & {\n  value: SelectProps['value'];\n  handleChange?: (v: SelectProps['value']) => void;\n  errorMsg?: string;\n  errorMsgFloat?: boolean;\n  selectProps?: SelectProps & {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    'data-dtestid'?: string;\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    'data-testid'?: string;\n  };\n};\n\nexport const SLSelect: React.FC<SLSelectProps> = props => {\n  const { errorMsg, errorMsgFloat } = props;\n  return (\n    <div\n      className={classnames({\n        [s['select-wrapper']]: true,\n        [s['error-wrapper']]: Boolean(errorMsg),\n      })}\n    >\n      <Select\n        {...props.selectProps}\n        style={{ width: '100%' }}\n        value={props.value}\n        onChange={v => {\n          props?.handleChange?.(v);\n        }}\n        dropdownClassName={s['selected-option']}\n      />\n      {errorMsg ? (\n        <div\n          className={classnames({\n            [s['error-content']]: true,\n            [s['error-float']]: Boolean(errorMsgFloat),\n          })}\n        >\n          <div className={s['error-text']}>{errorMsg}</div>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  type ComponentProps,\n  useRef,\n  useImperativeHandle,\n  useMemo,\n  useEffect,\n  type ForwardedRef,\n} from 'react';\n\nimport isNumber from 'lodash-es/isNumber';\nimport cs from 'classnames';\nimport { useReactive } from 'ahooks';\nimport { type CommonexcludeType } from '@coze-arch/bot-semi/Form';\nimport {\n  type CommonFieldProps,\n  withField,\n  type InputProps,\n  Input,\n  type PopoverProps,\n  Popover,\n  type TooltipProps,\n  Tooltip,\n} from '@coze-arch/coze-design';\n\nimport s from './index.module.less';\n\nexport interface SLInputRefType {\n  triggerFocus?: () => void;\n}\n\nexport type SLInputProps = ComponentProps<typeof Input> & {\n  value: string | undefined;\n  onRef?: ForwardedRef<SLInputRefType>;\n  ellipsis?: boolean;\n  handleChange?: (v: string) => void;\n  handleBlur?: (v: string) => void;\n  handleFocus?: (v: string) => void;\n  ellipsisPopoverProps?: PopoverProps;\n  onFocusPopoverProps?: PopoverProps;\n  tooltipProps?: TooltipProps;\n  // eslint-disable-next-line @typescript-eslint/naming-convention -- historical logic\n  inputProps?: InputProps & { 'data-dtestid'?: string; 'data-testid'?: string };\n  errorMsg?: string;\n  errorMsgFloat?: boolean;\n  maxCount?: number;\n  className?: string;\n  style?: React.CSSProperties;\n};\n\n// eslint-disable-next-line complexity\nexport const SLInput: React.FC<SLInputProps> = props => {\n  const { ellipsis = true, maxCount, errorMsgFloat } = props;\n  const showCount = isNumber(maxCount) && maxCount > 0;\n  useImperativeHandle(props.onRef, () => ({\n    triggerFocus,\n  }));\n  const $state = useReactive({\n    value: props.value,\n    inputOnFocus: false,\n    inputEle: false,\n  });\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const triggerFocus = () => {\n    $state.inputEle = true;\n    inputRef?.current?.focus();\n  };\n\n  const onFocus = () => {\n    $state.inputOnFocus = true;\n    $state.inputEle = true;\n    props?.handleFocus?.($state.value || '');\n  };\n\n  const onBlur = (e: React.FocusEvent<HTMLInputElement>) => {\n    $state.inputOnFocus = false;\n    props?.handleBlur?.($state.value || '');\n    props?.onBlur?.(e);\n    $state.inputEle = false;\n  };\n\n  const onChange = (v: string) => {\n    $state.value = v;\n    props?.handleChange?.(v);\n  };\n\n  const onclick = () => {\n    if (!$state.inputEle) {\n      setTimeout(() => {\n        inputRef?.current?.focus();\n      }, 10);\n    }\n    $state.inputEle = true;\n  };\n  const hasEllipsis = useMemo(() => {\n    const clientWidth = inputRef.current?.clientWidth || 0;\n    const scrollWidth = inputRef.current?.scrollWidth || 0;\n    return clientWidth < scrollWidth - 1;\n  }, [\n    ellipsis,\n    $state.inputOnFocus,\n    $state.value,\n    inputRef.current?.clientWidth,\n    inputRef.current?.scrollWidth,\n    $state.inputEle,\n  ]);\n\n  useEffect(() => {\n    $state.value = props.value;\n  }, [props.value]);\n\n  const LimitCountNode = (\n    <span className={s['limit-count']}>\n      {$state.value?.length || 0}/{maxCount}\n    </span>\n  );\n\n  return (\n    <div\n      className={cs(s['input-wrapper'], props.className)}\n      style={props.style}\n    >\n      {!$state.inputEle && hasEllipsis ? (\n        <Tooltip\n          content={\n            <article\n              style={{\n                maxWidth: 200,\n                wordWrap: 'break-word',\n                wordBreak: 'normal',\n              }}\n            >\n              {$state.value}\n            </article>\n          }\n          position={'top'}\n          showArrow\n          mouseEnterDelay={300}\n          {...props.tooltipProps}\n        >\n          <div\n            className={cs(props?.errorMsg ? s['error-wrapper'] : null)}\n            onClick={onclick}\n          >\n            <Input\n              {...props.inputProps}\n              ref={inputRef}\n              value={$state.value}\n              className={ellipsis ? s.input : ''}\n              suffix={showCount ? LimitCountNode : undefined}\n            ></Input>\n          </div>\n        </Tooltip>\n      ) : (\n        <div className={cs(props?.errorMsg ? s['error-wrapper'] : null)}>\n          <Popover\n            {...props.onFocusPopoverProps}\n            trigger=\"custom\"\n            visible={\n              Boolean(props.onFocusPopoverProps?.content) && $state.inputOnFocus\n            }\n            showArrow\n          >\n            <Input\n              {...props.inputProps}\n              ref={inputRef}\n              value={$state.value}\n              className={ellipsis ? s.input : ''}\n              onChange={onChange}\n              onFocus={onFocus}\n              onBlur={onBlur}\n              suffix={showCount ? LimitCountNode : undefined}\n            ></Input>\n          </Popover>\n        </div>\n      )}\n      {props?.errorMsg ? (\n        <div\n          className={cs({\n            [s['error-content']]: true,\n            [s['error-float']]: Boolean(errorMsgFloat),\n          })}\n        >\n          <div className={s['error-text']}>{props?.errorMsg}</div>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\n// Semi does not export the props type (or even any _>`) of the component wrapped with the withField.\n// https://github.com/DouyinFE/semi-design/blob/v2.69.2/packages/semi-ui/form/hoc/withField.tsx#L528\nexport const FormSLInput: React.FunctionComponent<\n  CommonFieldProps & Omit<SLInputProps, keyof CommonexcludeType>\n> = withField(SLInput, {\n  valueKey: 'value',\n  onKeyChangeFnName: 'handleChange',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport {\n  type DatabaseInfo,\n  type TableMemoryItem,\n} from '@coze-studio/bot-detail-store';\nimport { I18n } from '@coze-arch/i18n';\nimport { FieldItemType, BotTableRWMode } from '@coze-arch/bot-api/memory';\n\nimport { type ReadAndWriteModeOptions } from '../types/database-field';\n\nexport const FIELD_TYPE_OPTIONS = [\n  { value: FieldItemType.Text, label: I18n.t('db_add_table_field_type_txt') },\n  { value: FieldItemType.Number, label: I18n.t('db_add_table_field_type_int') },\n  { value: FieldItemType.Date, label: I18n.t('db_add_table_field_type_time') },\n  {\n    value: FieldItemType.Float,\n    label: I18n.t('db_add_table_field_type_number'),\n  },\n  {\n    value: FieldItemType.Boolean,\n    label: I18n.t('db_add_table_field_type_bool'),\n  },\n];\n\nexport const TEMPLATE_INFO: DatabaseInfo = {\n  name: 'book_notes',\n  desc: I18n.t('db_add_table_temp_desc'),\n  tableId: '',\n  readAndWriteMode: BotTableRWMode.LimitedReadWrite,\n  tableMemoryList: [\n    {\n      nanoid: nanoid(),\n      name: 'name',\n      desc: I18n.t('db_add_table_temp_field_desc1'),\n      type: FieldItemType.Text,\n      must_required: true,\n    },\n    {\n      name: 'section',\n      nanoid: nanoid(),\n      desc: I18n.t('db_add_table_temp_field_desc2'),\n      type: FieldItemType.Number,\n      must_required: false,\n    },\n    {\n      name: 'note',\n      nanoid: nanoid(),\n      desc: I18n.t('db_add_table_temp_field_desc3'),\n      type: FieldItemType.Text,\n      must_required: false,\n    },\n  ],\n};\n\nexport const RW_MODE_OPTIONS_CONFIG: Record<\n  BotTableRWMode,\n  { tips: string; label: string }\n> = {\n  [BotTableRWMode.LimitedReadWrite]: {\n    tips: I18n.t('db_table_0129_005'),\n    label: I18n.t('db_table_0129_002'),\n  },\n  [BotTableRWMode.ReadOnly]: {\n    tips: I18n.t('db_table_0129_006'),\n    label: I18n.t('db_table_0129_003'),\n  },\n  [BotTableRWMode.UnlimitedReadWrite]: {\n    tips: I18n.t('db_table_0129_007'),\n    label: I18n.t('db_table_0129_004'),\n  },\n  [BotTableRWMode.RWModeMax]: {\n    tips: '',\n    label: '',\n  },\n};\n\nexport const RW_MODE_OPTIONS_MAP: Record<\n  ReadAndWriteModeOptions,\n  BotTableRWMode[]\n> = {\n  excel: [BotTableRWMode.LimitedReadWrite],\n  normal: [BotTableRWMode.LimitedReadWrite],\n  expert: [BotTableRWMode.LimitedReadWrite, BotTableRWMode.UnlimitedReadWrite],\n};\n\nexport const DATABASE_CONTENT_CHECK_ERROR_CODE = 708024072;\nexport const DATABASE_CONTENT_CHECK_ERROR_CODE_NEW = 708334072;\n\n/**\n * Built-in field: uuid\n * bstudio_connector_uid\n */\nexport const USER_ID_FIELD: TableMemoryItem = {\n  name: 'uuid',\n  desc: I18n.t('workflow_240221_01'),\n  type: FieldItemType.Text,\n  must_required: true,\n  nanoid: nanoid(),\n  isSystemField: true,\n};\n\n/**\n * Built-in field: id\n */\nexport const ID_FIELD: TableMemoryItem = {\n  name: 'id',\n  desc: I18n.t('database_240520_01'),\n  type: FieldItemType.Number,\n  must_required: true,\n  nanoid: nanoid(),\n  isSystemField: true,\n};\n\n/**\n * Built-in fields: sys_platform\n * bstudio_connector_id\n */\nexport const PLATFORM_FIELD: TableMemoryItem = {\n  name: 'sys_platform',\n  desc: I18n.t('db_optimize_002'),\n  type: FieldItemType.Text,\n  must_required: true,\n  nanoid: nanoid(),\n  isSystemField: true,\n};\n\n/**\n * Built-in fields: connector_id\n * bstudio_create_time\n */\nexport const CREATE_TIME_FIELD: TableMemoryItem = {\n  name: 'bstudio_create_time',\n  desc: I18n.t('db_optimize_003'),\n  type: FieldItemType.Date,\n  must_required: true,\n  nanoid: nanoid(),\n  isSystemField: true,\n};\n\n/**\n * Built-in system fields\n */\nexport const SYSTEM_FIELDS = [\n  ID_FIELD,\n  PLATFORM_FIELD,\n  USER_ID_FIELD,\n  CREATE_TIME_FIELD,\n];\n\nexport const SYSTEM_FIELD_ROW_INDEX: Record<string, string | undefined> = {\n  id: 'bstudio_id',\n  sys_platform: 'bstudio_connector_id',\n  uuid: 'bstudio_connector_uid',\n  bstudio_create_time: 'bstudio_create_time',\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { type FieldItemType } from '@coze-arch/bot-api/developer_api';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tag, Tooltip, Typography } from '@coze-arch/coze-design';\n\nimport { FIELD_TYPE_OPTIONS } from '../../constants/database-field';\n\nexport interface DatabaseFieldTitleProps {\n  field?: string;\n  textType?: 'primary' | 'secondary';\n  type?: FieldItemType;\n  tip?: ReactNode;\n  required?: boolean;\n}\n\nexport function DatabaseFieldTitle({\n  field,\n  textType = 'secondary',\n  type,\n  tip,\n  required,\n}: DatabaseFieldTitleProps) {\n  return (\n    <div className=\"flex flex-row items-center\">\n      <Typography.Text type={textType} weight={500} fontSize=\"12px\" ellipsis>\n        {field}\n      </Typography.Text>\n      {required ? (\n        <span className=\"coz-fg-hglt-red text-[12px] leading-[16px]\">*</span>\n      ) : null}\n      {tip ? (\n        <Tooltip content={tip} style={{ maxWidth: 'unset' }}>\n          <IconCozInfoCircle className=\"w-[12px] h-[12px] ml-[3px] coz-fg-secondary\" />\n        </Tooltip>\n      ) : null}\n      {typeof type === 'number' ? (\n        <Tag color=\"primary\" size=\"mini\" className=\"ml-[4px]\">\n          {FIELD_TYPE_OPTIONS.find(i => i.value === type)?.label ?? type}\n        </Tag>\n      ) : null}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport { type TableMemoryItem } from '@coze-studio/bot-detail-store';\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  type MapperItem,\n  type TriggerType,\n  VerifyType,\n} from '../../../types/database-field';\n\n// Validation Table Name and Field Name\nconst namingRegexMapper = [\n  {\n    type: 1,\n    regex: /[^a-z0-9_]/,\n    errorMsg: I18n.t('db_add_table_field_name_tips2'),\n  },\n  {\n    type: 2,\n    regex: /^[^a-z]/,\n    errorMsg: I18n.t('db_add_table_field_name_tips3'),\n  },\n  {\n    type: 3,\n    regex: /[\\s\\S]{64,}/,\n    errorMsg: I18n.t('db_add_table_field_name_tips4'),\n  },\n];\nexport const validateNaming = (str: string, errList: string[] = []) => {\n  let list = [...errList];\n  namingRegexMapper.forEach(i => {\n    list = list.filter(j => j !== i.errorMsg);\n    if (i.regex.test(str || '')) {\n      list.push(i.errorMsg);\n    }\n  });\n  return list;\n};\n\n// Validation Table Fields\nexport const thMapper: MapperItem[] = [\n  {\n    label: I18n.t('db_add_table_field_name'),\n    key: 'name',\n    validator: [\n      {\n        type: VerifyType.Naming,\n        message: '',\n      },\n      {\n        type: VerifyType.Required,\n        message: I18n.t('db_table_save_exception_nofieldname'),\n      },\n      {\n        type: VerifyType.Unique,\n        message: I18n.t('db_table_save_exception_fieldname'),\n      },\n    ],\n    defaultValue: '',\n    require: true,\n  },\n  {\n    label: I18n.t('db_add_table_field_desc'),\n    key: 'desc',\n    require: false,\n    validator: [],\n    defaultValue: '',\n  },\n  {\n    label: I18n.t('db_add_table_field_type'),\n    key: 'type',\n    require: true,\n    validator: [\n      {\n        type: VerifyType.Required,\n        message: I18n.t('db_table_save_exception_fieldtype'),\n      },\n    ],\n    defaultValue: '',\n  },\n  {\n    label: I18n.t('db_add_table_field_necessary'),\n    key: 'must_required',\n    require: false,\n    validator: [],\n    defaultValue: true,\n  },\n];\nexport const validateFields = (\n  list: TableMemoryItem[],\n  trigger: TriggerType,\n) => {\n  const resList = list.map(_listItem => {\n    const listItem: TableMemoryItem = { ..._listItem };\n    thMapper.forEach(thItem => {\n      const thKey = thItem.key as keyof TableMemoryItem;\n\n      thItem.validator.forEach(verifyItem => {\n        if (!listItem?.errorMapper) {\n          listItem.errorMapper = {};\n        }\n        let errTarget = listItem?.errorMapper?.[thKey];\n        const value = listItem[thKey];\n        if (!errTarget) {\n          listItem.errorMapper[thKey] = [];\n          errTarget = [];\n        }\n        const msg = verifyItem.message;\n        switch (verifyItem.type) {\n          case VerifyType.Required: {\n            // When the error occurs: When clicking the Save button, a prompt appears. When a row in the table fills in the data, but the required fields are not filled in, an error needs to be reported.\n            if (\n              trigger === 'save' &&\n              !value &&\n              thMapper.find(\n                i =>\n                  !!listItem[i.key as keyof TableMemoryItem] && !i.defaultValue,\n              )\n            ) {\n              listItem.errorMapper[thKey].push(msg);\n            }\n            // Error reporting and disappearance timing: Required text box After entering the content, the error will disappear immediately\n            if (trigger === 'change' && value) {\n              listItem.errorMapper[thKey] = errTarget.filter(i => i !== msg);\n            }\n            break;\n          }\n          case VerifyType.Unique: {\n            // When the error occurs: When you click the Save button, a prompt appears.\n            if (\n              trigger === 'save' &&\n              value &&\n              list.filter(i => i[thKey] === listItem[thKey]).length !== 1\n            ) {\n              listItem.errorMapper[thKey].push(msg);\n            }\n            // Error reporting and disappearance timing: Required text box After entering the content, the error will disappear immediately\n            if (\n              trigger === 'change' &&\n              value &&\n              list.filter(i => i[thKey] === listItem[thKey]).length === 1\n            ) {\n              listItem.errorMapper[thKey] = errTarget.filter(i => i !== msg);\n            }\n            break;\n          }\n          case VerifyType.Naming: {\n            // Error timing: There is a problem with the naming format. When you lose focus, check the format immediately\n            if (\n              trigger === 'save' ||\n              trigger === 'blur' ||\n              (trigger === 'change' && errTarget.length)\n            ) {\n              listItem.errorMapper[thKey] = validateNaming(\n                value as string,\n                errTarget,\n              );\n            }\n            break;\n          }\n          default:\n            break;\n        }\n        listItem.errorMapper[thKey] = Array.from(\n          new Set(listItem.errorMapper[thKey]),\n        );\n      });\n    });\n    return listItem;\n  });\n\n  return resList;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PopoverContent } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\n\nimport s from './index.module.less';\n\nexport const KeyTipsNode: React.FC = () => (\n  <PopoverContent className={s['modal-key-tip']}>{`- ${I18n.t(\n    'db_add_table_field_name_tips1',\n  )}\n- ${I18n.t('db_add_table_field_name_tips2')}\n- ${I18n.t('db_add_table_field_name_tips3')}\n- ${I18n.t('db_add_table_field_name_tips4')}`}</PopoverContent>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\nimport {\n  useRef,\n  forwardRef,\n  useImperativeHandle,\n  useState,\n  type MutableRefObject,\n  useEffect,\n  type ReactNode,\n} from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { noop } from 'lodash-es';\nimport classNames from 'classnames';\nimport { useBoolean } from 'ahooks';\nimport { type DatabaseInfo } from '@coze-studio/bot-detail-store';\nimport { DataNamespace, dataReporter } from '@coze-data/reporter';\nimport { BotE2e } from '@coze-data/e2e';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Switch, Form } from '@coze-arch/coze-design';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport {\n  UITable,\n  UITableAction,\n  Tooltip,\n  Image,\n  Banner,\n} from '@coze-arch/bot-semi';\nimport { IconAdd } from '@coze-arch/bot-icons';\nimport { isApiError } from '@coze-arch/bot-http';\nimport {\n  type UpdateDatabaseRequest,\n  type AddDatabaseRequest,\n  BotTableRWMode,\n  type FieldItemType,\n} from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\n\nimport { SLSelect } from '../singleline-select';\nimport { FormSLInput, SLInput } from '../singleline-input';\nimport { DatabaseFieldTitle } from '../database-field-title';\nimport {\n  type TriggerType,\n  type TableFieldsInfo,\n  type TableBasicInfo,\n  type ReadAndWriteModeOptions,\n  type CreateType,\n  type OnSave,\n} from '../../types/database-field';\nimport {\n  DATABASE_CONTENT_CHECK_ERROR_CODE,\n  DATABASE_CONTENT_CHECK_ERROR_CODE_NEW,\n  FIELD_TYPE_OPTIONS,\n  RW_MODE_OPTIONS_MAP,\n  SYSTEM_FIELDS,\n} from '../../constants/database-field';\nimport keyExample from '../../assets/key-example.png';\nimport { validateFields, validateNaming } from './helpers/validate';\nimport { KeyTipsNode } from './components/KeyTipsNode';\n\nimport s from './index.module.less';\n\nconst MAX_COLUMNS = 20;\n\nexport interface DatabaseTableStructureProps {\n  data: DatabaseInfo;\n  botId?: string;\n  spaceId?: string;\n  creatorId?: string;\n  forceEdit?: boolean;\n  loading?: boolean;\n  loadingTips?: string;\n  projectID?: string;\n  /**\n   * Excel: single user mode | read-only mode\n   * Normal: Single user mode | Read-only mode\n   * Expert: Single user mode | Read-only mode | Multi-user mode\n   * Undefined: Read and write modes are not supported\n   */\n  readAndWriteModeOptions?: ReadAndWriteModeOptions;\n  /** Only display Mode UI in DatabaseInfo */\n  onlyShowDatabaseInfoRWMode?: boolean;\n  enableAdd?: boolean;\n  isReadonlyMode?: boolean;\n  maxColumnNum?: number;\n  /**\n   * Whether to display basic information (table name, introduction)\n   */\n  showDatabaseBaseInfo?: boolean;\n  hiddenTableBorder?: boolean;\n\n  useComputingEnableGoToNextStep?: (\n    list: TableFieldsInfo,\n    isEmptyList: boolean,\n  ) => void;\n  onCancel?: () => void;\n  onSave?: OnSave;\n  onDeleteField?: (list: TableFieldsInfo) => void;\n  setContentCheckErrorMsg?: (s: string) => void;\n\n  createType: CreateType;\n\n  renderModeSelect?: (props: {\n    dataTestId: string;\n    field: string;\n    label: string;\n    type: 'select';\n    options: BotTableRWMode[];\n  }) => ReactNode;\n}\n\nexport interface DatabaseTableStructureRef {\n  validate: () => Promise<boolean>;\n  submit: () => Promise<void>;\n  isReadonly: boolean;\n  setTableFieldsList: (list: TableFieldsInfo) => void;\n  tableFieldsList: TableFieldsInfo;\n  tableBasicInfoFormRef: MutableRefObject<Form<TableBasicInfo>>;\n}\n\nexport const DatabaseTableStructure = forwardRef<\n  DatabaseTableStructureRef,\n  DatabaseTableStructureProps\n  // eslint-disable-next-line max-lines-per-function, @coze-arch/max-line-per-function, complexity -- historical file copy\n>((props, ref) => {\n  const {\n    data: initialData,\n    botId = '',\n    spaceId = '',\n    creatorId = '',\n    onSave,\n    onCancel,\n    onDeleteField,\n    forceEdit = false,\n    maxColumnNum = MAX_COLUMNS,\n    useComputingEnableGoToNextStep,\n    readAndWriteModeOptions,\n    onlyShowDatabaseInfoRWMode,\n    enableAdd = true,\n    loading = false,\n    setContentCheckErrorMsg = noop,\n    // TODO put AI generated loading tips into the table\n    // loadingTips,\n    createType,\n    showDatabaseBaseInfo,\n    hiddenTableBorder,\n    isReadonlyMode,\n    projectID,\n    renderModeSelect,\n  } = props;\n  const [tableFieldsList, setTableFieldsList] = useState<TableFieldsInfo>([]);\n\n  const inputRef = useRef<{\n    triggerFocus?: () => void;\n  }>(null);\n  const scrollRef = useRef<HTMLDivElement>(null);\n  const tableBasicInfoFormRef = useRef<Form<TableBasicInfo>>();\n\n  const isModify = Boolean(initialData.tableId);\n\n  const [isReadonly, { setTrue: enableReadonly, setFalse: disableReadonly }] =\n    useBoolean(false);\n  // System fields do not count towards the number of fields limit\n  const userFields = tableFieldsList.filter(i => !i.isSystemField);\n  const isRowMaxLimit = userFields.length >= maxColumnNum;\n  const isExceedRowMaxLimit = userFields.length > maxColumnNum;\n  const isEmptyList =\n    userFields.filter(i => i.name || i.desc || i.type).length <= 0;\n  const databaseAuditErrorCodes = [\n    DATABASE_CONTENT_CHECK_ERROR_CODE,\n    DATABASE_CONTENT_CHECK_ERROR_CODE_NEW,\n  ];\n  const handleContentCheckError = (error: Error) => {\n    if (\n      isApiError(error) &&\n      databaseAuditErrorCodes.includes(Number(error?.code))\n    ) {\n      setContentCheckErrorMsg(\n        error?.msg || I18n.t('knowledge_bot_update_databse_tnserr_msg'),\n      );\n    }\n  };\n\n  const handleAdd = (triggerFocus = true) => {\n    if (isReadonly) {\n      return;\n    }\n    const newTableFieldsList = [\n      ...tableFieldsList,\n      {\n        nanoid: nanoid(),\n        name: '',\n        desc: '',\n        type: undefined as unknown as FieldItemType,\n        must_required: false,\n      },\n    ];\n\n    setTableFieldsList(newTableFieldsList);\n\n    if (triggerFocus) {\n      setTimeout(() => {\n        inputRef.current?.triggerFocus?.();\n        scrollRef.current?.scrollIntoView({\n          block: 'end',\n          behavior: 'smooth',\n        });\n      }, 100);\n    }\n  };\n\n  const verifyTableFields = (trigger: TriggerType) => {\n    setTableFieldsList(newTableFieldsList =>\n      validateFields(newTableFieldsList, trigger),\n    );\n  };\n\n  const verifyAllBeforeSave = async (): Promise<boolean> => {\n    // Trigger tableFields validation\n    const validatedTableFieldsList = validateFields(tableFieldsList, 'save');\n    setTableFieldsList(validatedTableFieldsList);\n\n    // Trigger and validate tableBasicInfo\n    if (showDatabaseBaseInfo) {\n      try {\n        // @ts-expect-error -- linter-disable-autofix\n        await tableBasicInfoFormRef.current.formApi.validate(['name']);\n      } catch (error) {\n        return false;\n      }\n    }\n\n    // Validation tableFields\n    if (\n      validatedTableFieldsList.find(i =>\n        Object.keys(i.errorMapper || {}).find(\n          j => !!i?.errorMapper?.[j]?.length,\n        ),\n      )\n    ) {\n      return false;\n    }\n\n    // Verify that tableFields is empty\n    if (isEmptyList) {\n      return false;\n    }\n    return true;\n  };\n\n  const save = async () => {\n    // @ts-expect-error -- linter-disable-autofix\n    let tableBasicInfo: TableBasicInfo = {};\n    if (tableBasicInfoFormRef.current) {\n      tableBasicInfo = tableBasicInfoFormRef.current.formApi.getValues();\n    } else {\n      tableBasicInfo = {\n        name: initialData.name,\n        desc: initialData.desc,\n        readAndWriteMode: initialData.readAndWriteMode,\n        prompt_disabled: initialData.extra_info?.prompt_disabled === 'true',\n      };\n    }\n    if (isModify) {\n      sendTeaEvent(EVENT_NAMES.edit_table_click, {\n        need_login: true,\n        have_access: true,\n        bot_id: botId,\n        table_name: tableBasicInfo.name,\n      });\n    } else {\n      sendTeaEvent(EVENT_NAMES.create_table_click, {\n        need_login: true,\n        have_access: true,\n        bot_id: botId,\n        table_name: tableBasicInfo.name,\n        database_create_type: createType,\n      });\n    }\n\n    let resp;\n    const params: AddDatabaseRequest | UpdateDatabaseRequest = {\n      table_name: onlyShowDatabaseInfoRWMode\n        ? initialData.name\n        : tableBasicInfo.name,\n      table_desc: onlyShowDatabaseInfoRWMode\n        ? initialData.desc\n        : tableBasicInfo.desc,\n      icon_uri: initialData.icon_uri,\n      prompt_disabled: !!tableBasicInfo.prompt_disabled,\n      field_list: tableFieldsList\n        .filter(i => !!i.name && !i.isSystemField)\n        .map(i => ({\n          name: i.name,\n          desc: i.desc || '',\n          type: i.type,\n          must_required: i.must_required,\n          id: i?.id,\n          alterId: i?.alterId,\n        })),\n      rw_mode: tableBasicInfo.readAndWriteMode,\n    };\n    if (!isModify) {\n      try {\n        resp = await MemoryApi.AddDatabase({\n          ...params,\n          space_id: spaceId,\n          creator_id: creatorId,\n          project_id: projectID,\n        });\n      } catch (error) {\n        dataReporter.errorEvent(DataNamespace.DATABASE, {\n          eventName: REPORT_EVENTS.DatabaseAddTable,\n          error: error as Error,\n        });\n        handleContentCheckError(error as Error);\n        return;\n      }\n    } else {\n      try {\n        resp = await MemoryApi.UpdateDatabase({\n          ...params,\n          id: initialData.tableId,\n        });\n      } catch (error) {\n        dataReporter.errorEvent(DataNamespace.DATABASE, {\n          eventName: REPORT_EVENTS.DatabaseAlterTable,\n          error: error as Error,\n        });\n        handleContentCheckError(error as Error);\n        return;\n      }\n    }\n    if (onSave) {\n      await onSave({\n        response: resp,\n      });\n    }\n    onCancel?.();\n  };\n\n  const handleSave = async () => {\n    try {\n      enableReadonly();\n\n      const validateRes = await verifyAllBeforeSave();\n      if (!validateRes) {\n        return;\n      }\n\n      await save();\n    } finally {\n      disableReadonly();\n    }\n  };\n\n  const getTableNameErrorMessage = (v: string) => {\n    if (!v) {\n      return I18n.t('db_add_table_name_tips');\n    }\n    const errList = validateNaming(v);\n    if (errList.length > 0) {\n      return errList.join('; ');\n    }\n    return '';\n  };\n\n  // Initialize ref attribute\n  useImperativeHandle<DatabaseTableStructureRef, DatabaseTableStructureRef>(\n    ref,\n    () => ({\n      async submit() {\n        return await handleSave();\n      },\n      async validate() {\n        const res = await verifyAllBeforeSave();\n        return res;\n      },\n      setTableFieldsList,\n      isReadonly,\n      // @ts-expect-error -- linter-disable-autofix\n      tableBasicInfoFormRef,\n      tableFieldsList,\n    }),\n    [isReadonly, tableFieldsList, tableBasicInfoFormRef],\n  );\n\n  // Verify that the Next button is disabled\n  useComputingEnableGoToNextStep?.(tableFieldsList, isEmptyList);\n\n  const dataSource = enableAdd\n    ? [...tableFieldsList, { operate: 'add' }]\n    : tableFieldsList;\n\n  const resetContentCheckErrorMsg = () => {\n    setContentCheckErrorMsg('');\n  };\n\n  useEffect(() => {\n    setTableFieldsList([...SYSTEM_FIELDS, ...initialData.tableMemoryList]);\n    if (tableBasicInfoFormRef.current && !loading) {\n      tableBasicInfoFormRef.current.formApi.setValues({\n        name: initialData?.name || '',\n        desc: initialData?.desc || '',\n        prompt_disabled: isModify\n          ? initialData.extra_info?.prompt_disabled === 'true'\n          : false,\n        readAndWriteMode:\n          initialData?.readAndWriteMode || BotTableRWMode.LimitedReadWrite,\n      });\n    }\n  }, [initialData, loading]);\n\n  return (\n    <div\n      className={classNames(s['table-structure-wrapper'], {\n        [s['hidden-form-border']]: hiddenTableBorder,\n      })}\n    >\n      {showDatabaseBaseInfo ? (\n        <Form<TableBasicInfo>\n          // @ts-expect-error -- linter-disable-autofix\n          ref={tableBasicInfoFormRef}\n          layout=\"vertical\"\n          className={s['table-structure-form']}\n          onValueChange={(_values, changedV) => {\n            if ('name' in changedV || 'desc' in changedV) {\n              resetContentCheckErrorMsg();\n            }\n          }}\n        >\n          {onlyShowDatabaseInfoRWMode ? null : (\n            <>\n              <FormSLInput\n                field=\"name\"\n                label={{\n                  text: I18n.t('db_add_table_name'),\n                  required: true,\n                }}\n                validate={v => getTableNameErrorMessage(v)}\n                trigger={['change', 'blur']}\n                fieldClassName={s['table-name-form-field']}\n                disabled={isReadonlyMode}\n                inputProps={{\n                  'data-testid': BotE2e.BotDatabaseAddModalTableNameInput,\n                  disabled: !forceEdit && (isReadonly || isModify),\n                  placeholder: I18n.t('db_add_table_name_tips'),\n                }}\n                onFocusPopoverProps={{\n                  style: { padding: '2px 12px' },\n                  position: 'left',\n                  content: <KeyTipsNode />,\n                }}\n              />\n              <Form.TextArea\n                data-testid={BotE2e.BotDatabaseAddModalTableDescInput}\n                field=\"desc\"\n                label={I18n.t('db_add_table_desc')}\n                disabled={isReadonly || isReadonlyMode}\n                rows={2}\n                placeholder={I18n.t('db_add_table_desc_tips')}\n                fieldClassName={s['table-desc-form-field']}\n              />\n            </>\n          )}\n          {renderModeSelect && readAndWriteModeOptions\n            ? renderModeSelect({\n                dataTestId: BotE2e.BotDatabaseAddModalTableQueryModeSelect,\n                field: 'readAndWriteMode',\n                label: I18n.t('db_table_0129_001'),\n                type: 'select',\n                options: RW_MODE_OPTIONS_MAP[readAndWriteModeOptions],\n              })\n            : null}\n        </Form>\n      ) : null}\n\n      {isExceedRowMaxLimit ? (\n        <Banner\n          type=\"warning\"\n          description={I18n.t('db_table_0126_027', {\n            ColumNum: maxColumnNum,\n          })}\n          className={s['max-row-banner']}\n        />\n      ) : null}\n\n      <UITable\n        tableProps={{\n          loading,\n          columns: [\n            {\n              dataIndex: 'name',\n              title: (\n                <DatabaseFieldTitle\n                  field={I18n.t('db_add_table_field_name')}\n                  required\n                  tip={\n                    <div className={s['th-tip-name']}>\n                      <span style={{ width: 494, marginBottom: 8 }}>\n                        {I18n.t('db_add_table_field_name_tips')}\n                      </span>\n                      <Image\n                        preview={false}\n                        width={494}\n                        height={163}\n                        src={keyExample}\n                      />\n                    </div>\n                  }\n                />\n              ),\n              render: (text, record, index) =>\n                record.operate !== 'add' ? (\n                  <SLInput\n                    style={{ position: 'static' }}\n                    onRef={inputRef}\n                    value={record.name}\n                    inputProps={{\n                      'data-testid': BotE2e.BotDatabaseAddModalFieldNameInput,\n                      'data-dtestid': BotE2e.BotDatabaseAddModalFieldNameInput,\n                      disabled:\n                        isReadonly || record.isSystemField || isReadonlyMode,\n                      placeholder: 'Enter Name',\n                    }}\n                    errorMsgFloat\n                    onFocusPopoverProps={{\n                      style: { padding: '2px 12px' },\n                      position: 'left',\n                      content: <KeyTipsNode />,\n                    }}\n                    errorMsg={tableFieldsList[index]?.errorMapper?.name?.join(\n                      '; ',\n                    )}\n                    handleChange={v => {\n                      const newTableMemoryList = [...tableFieldsList];\n                      newTableMemoryList[index].name = v;\n                      setTableFieldsList(newTableMemoryList);\n                      verifyTableFields('change');\n                      resetContentCheckErrorMsg();\n                    }}\n                    handleBlur={() => {\n                      verifyTableFields('blur');\n                    }}\n                  />\n                ) : (\n                  <div\n                    ref={scrollRef}\n                    data-testid={BotE2e.BotDatabaseAddModalAddBtn}\n                  >\n                    {isRowMaxLimit ? (\n                      <div style={{ paddingRight: 10 }}>\n                        <Tooltip\n                          position=\"top\"\n                          content={I18n.t('bot_database_add_field', {\n                            number: maxColumnNum,\n                          })}\n                        >\n                          <Button color=\"secondary\" disabled icon={<IconAdd />}>\n                            {I18n.t('bot_userProfile_add')}\n                          </Button>\n                        </Tooltip>\n                      </div>\n                    ) : (\n                      <Button\n                        color=\"primary\"\n                        disabled={isReadonly}\n                        onClick={() => handleAdd(true)}\n                        icon={<IconAdd />}\n                      >\n                        {I18n.t('bot_userProfile_add')}\n                      </Button>\n                    )}\n                  </div>\n                ),\n              width: 261,\n            },\n            {\n              dataIndex: 'desc',\n              title: (\n                <DatabaseFieldTitle\n                  field={I18n.t('db_add_table_field_desc')}\n                  tip={\n                    <article style={{ width: 327 }}>\n                      {I18n.t('db_add_table_field_desc_tips')}\n                    </article>\n                  }\n                />\n              ),\n              render: (text, record, index) =>\n                record.operate !== 'add' ? (\n                  <SLInput\n                    value={record.desc}\n                    maxCount={300}\n                    inputProps={{\n                      'data-testid': `${BotE2e.BotDatabaseAddModalFieldDescInput}.${index}.${record.name}`,\n                      'data-dtestid': `${BotE2e.BotDatabaseAddModalFieldDescInput}.${index}.${record.name}`,\n                      maxLength: 300,\n                      disabled:\n                        isReadonly || record.isSystemField || isReadonlyMode,\n                      placeholder: I18n.t(\n                        'bot_edit_variable_description_placeholder',\n                      ),\n                    }}\n                    errorMsgFloat\n                    handleChange={v => {\n                      const newTableMemoryList = [...tableFieldsList];\n                      newTableMemoryList[index].desc = v;\n                      setTableFieldsList(newTableMemoryList);\n                      resetContentCheckErrorMsg();\n                    }}\n                  />\n                ) : null,\n              width: 369,\n            },\n            {\n              dataIndex: 'type',\n              title: (\n                <DatabaseFieldTitle\n                  field={I18n.t('db_add_table_field_type')}\n                  required\n                  tip={\n                    <article style={{ width: 327 }}>\n                      {I18n.t('db_add_table_field_type_tips')}\n                    </article>\n                  }\n                />\n              ),\n              render: (text, record, index) =>\n                record.operate !== 'add' ? (\n                  <SLSelect\n                    value={record.type}\n                    selectProps={{\n                      'data-testid': `${BotE2e.BotDatabaseAddModalFieldTypeSelect}.${index}.${record.name}`,\n                      'data-dtestid': `${BotE2e.BotDatabaseAddModalFieldTypeSelect}.${index}.${record.name}`,\n                      disabled:\n                        isReadonly ||\n                        (isModify && !!record.id) ||\n                        record.isSystemField ||\n                        isReadonlyMode,\n                      placeholder: I18n.t('db_table_save_exception_fieldtype'),\n                      optionList: FIELD_TYPE_OPTIONS,\n                    }}\n                    errorMsgFloat\n                    errorMsg={tableFieldsList[index]?.errorMapper?.type?.join(\n                      '; ',\n                    )}\n                    handleChange={v => {\n                      const newTableMemoryList = [...tableFieldsList];\n                      newTableMemoryList[index].type = v as FieldItemType;\n                      setTableFieldsList(newTableMemoryList);\n                      verifyTableFields('change');\n                    }}\n                  />\n                ) : null,\n              width: 214,\n            },\n            {\n              dataIndex: 'must_required',\n              title: (\n                <DatabaseFieldTitle\n                  field={I18n.t('db_add_table_field_necessary')}\n                  tip={\n                    <article style={{ width: 327 }}>\n                      <p className={s['th-tip-dot']}>\n                        {I18n.t('db_add_table_field_necessary_tips1')}\n                      </p>\n                      <p className={s['th-tip-dot']}>\n                        {I18n.t('db_add_table_field_necessary_tips2')}\n                      </p>\n                    </article>\n                  }\n                />\n              ),\n              render: (text, record, index) =>\n                record.operate !== 'add' ? (\n                  <div style={{ display: 'flex', alignItems: 'center' }}>\n                    <Switch\n                      data-testid={`${BotE2e.BotDatabaseAddModalFieldRequiredSwitch}.${index}.${record.name}`}\n                      data-dtestid={`${BotE2e.BotDatabaseAddModalFieldRequiredSwitch}.${index}.${record.name}`}\n                      disabled={\n                        isReadonly ||\n                        record.disableMustRequired ||\n                        record.isSystemField ||\n                        isReadonlyMode\n                      }\n                      checked={record.must_required}\n                      onChange={v => {\n                        const newTableMemoryList = [...tableFieldsList];\n                        newTableMemoryList[index].must_required = v;\n                        setTableFieldsList(newTableMemoryList);\n                      }}\n                      size=\"small\"\n                      aria-label=\"a switch for semi demo\"\n                    />\n                  </div>\n                ) : null,\n              width: 108,\n            },\n            {\n              dataIndex: 'operate',\n              title: <DatabaseFieldTitle field={I18n.t('db_table_0126_021')} />,\n              render: (text, record, index) =>\n                record.operate !== 'add' ? (\n                  <UITableAction\n                    deleteProps={{\n                      handleClick: () => {\n                        if (isReadonly) {\n                          return;\n                        }\n\n                        const newTableMemoryList = [\n                          ...tableFieldsList.slice(0, index),\n                          ...tableFieldsList.slice(index + 1),\n                        ];\n\n                        setTableFieldsList(newTableMemoryList);\n                        verifyTableFields('change');\n                        onDeleteField?.(newTableMemoryList);\n                      },\n                      popconfirm: {\n                        defaultVisible: false,\n                        visible: false,\n                      },\n                      tooltip: {\n                        content: I18n.t('datasets_table_title_actions_delete'),\n                      },\n                      disabled: record.isSystemField || isReadonlyMode,\n                    }}\n                    editProps={{\n                      hide: true,\n                    }}\n                  />\n                ) : null,\n              width: 85,\n            },\n          ],\n          dataSource,\n          pagination: false,\n          className: s['table-structure-table'],\n          rowKey: 'nanoid',\n        }}\n        wrapperClassName={s['table-structure-table-wrapper']}\n      />\n      {/* Error message at the bottom when the table is empty */}\n      {isEmptyList && !loading ? (\n        <div className={s['table-empty-tips']}>\n          {I18n.t('db_table_save_exception_nofield')}\n        </div>\n      ) : null}\n    </div>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useRef, useMemo, useEffect } from 'react';\nimport type { ReactNode, RefObject } from 'react';\n\nimport {\n  type DatabaseInfo,\n  type TableMemoryItem,\n} from '@coze-studio/bot-detail-store';\nimport { BotE2e } from '@coze-data/e2e';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { IconButton, Modal, Button } from '@coze-arch/coze-design';\nimport {\n  type BotTableRWMode,\n  type AlterBotTableResponse,\n  type InsertBotTableResponse,\n} from '@coze-arch/bot-api/memory';\n\nimport { DismissibleBanner } from '../dismissible-banner';\nimport {\n  DatabaseTableStructure,\n  type DatabaseTableStructureRef,\n} from '../database-table-structure';\nimport {\n  CreateType,\n  type TableFieldsInfo,\n  type OnSave,\n} from '../../types/database-field';\n\n// import { useExpertModeConfig } from '../../hooks/use-expert-mode-config';\n\nconst MAX_COLUMNS = 20;\n\ninterface CreateTableModalExtraParams {\n  botId?: string;\n  spaceId?: string;\n  creatorId?: string;\n}\n\n// RenderGenerate property type definition\nexport interface RenderGenerateProps {\n  tableStructureRef: RefObject<DatabaseTableStructureRef>;\n  onGenerateChange: (tableMemoryList: TableMemoryItem[]) => void;\n  onGenerating: (loading: boolean) => void;\n  botId: string;\n}\n\nexport interface RenderModeSelectProps {\n  dataTestId: string;\n  field: string;\n  label: string;\n  type: 'select';\n  options: BotTableRWMode[];\n}\n\nexport interface DatabaseCreateTableModalProps {\n  visible: boolean;\n  onClose: () => void;\n  onReturn?: () => void;\n  onSubmit?: (response: InsertBotTableResponse | AlterBotTableResponse) => void;\n  initValue: DatabaseInfo;\n  showDatabaseBaseInfo: boolean;\n  extraParams?: CreateTableModalExtraParams;\n  onlyShowDatabaseInfoRWMode: boolean;\n  projectID?: string;\n  renderGenerate?: (props: RenderGenerateProps) => ReactNode;\n  renderModeSelect?: (props: RenderModeSelectProps) => ReactNode;\n}\n\ninterface UseDatabaseCreateTableModalProps {\n  onClose?: () => void;\n  onReturn?: () => void;\n  initValue: DatabaseInfo;\n  onSubmit?: (response: InsertBotTableResponse | AlterBotTableResponse) => void;\n  showDatabaseBaseInfo: boolean;\n  extraParams?: CreateTableModalExtraParams;\n  onlyShowDatabaseInfoRWMode: boolean;\n  projectID?: string;\n  renderGenerate?: (props: RenderGenerateProps) => ReactNode;\n  renderModeSelect?: (props: RenderModeSelectProps) => ReactNode;\n}\n\nexport const useDatabaseCreateTableModal = ({\n  onReturn,\n  onSubmit,\n  initValue,\n  showDatabaseBaseInfo,\n  extraParams,\n  onlyShowDatabaseInfoRWMode,\n  projectID,\n  renderGenerate,\n  renderModeSelect,\n}: UseDatabaseCreateTableModalProps) => {\n  const [visible, setVisible] = useState(false);\n\n  const open = () => {\n    setVisible(true);\n  };\n\n  const close = () => {\n    setVisible(false);\n    // onClose?.();\n  };\n\n  return {\n    visible,\n    open,\n    close,\n    modal: (\n      <DatabaseCreateTableModal\n        visible={visible}\n        onClose={close}\n        onReturn={onReturn}\n        onSubmit={onSubmit}\n        initValue={initValue}\n        showDatabaseBaseInfo={showDatabaseBaseInfo}\n        extraParams={extraParams}\n        onlyShowDatabaseInfoRWMode={onlyShowDatabaseInfoRWMode}\n        projectID={projectID}\n        renderGenerate={renderGenerate}\n        renderModeSelect={renderModeSelect}\n      />\n    ),\n  };\n};\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function DatabaseCreateTableModal({\n  visible,\n  onClose,\n  onReturn,\n  onSubmit,\n  initValue,\n  showDatabaseBaseInfo,\n  onlyShowDatabaseInfoRWMode,\n  extraParams: { botId = '', spaceId = '', creatorId = '' } = {},\n  projectID,\n  renderGenerate,\n  renderModeSelect,\n}: DatabaseCreateTableModalProps) {\n  // AI generate loading\n  const [generateTableLoading, setGenerateTableLoading] = useState(false);\n  // save button loading\n  const [saveBtnLoading, setSaveBtnLoading] = useState<boolean>(false);\n  // save button disabled\n  const [saveBtnDisabled, setSaveBtnDisabled] = useState<boolean>(false);\n  // database structure\n  const [databaseInitValue, setDatabaseInitValue] =\n    useState<DatabaseInfo>(initValue);\n\n  // export mode's some config(actually nobody knows why this is here...)\n  // const expertModeConfig = useExpertModeConfig({ botId });\n\n  // DataBase Table ref\n  const tableStructureRef = useRef<DatabaseTableStructureRef>(null);\n\n  /**\n   * modal mode\n   * @has tableId: Edit Mode;\n   * @no tableId: Create Mode\n   */\n  const isModify = useMemo(() => Boolean(initValue.tableId), [initValue]);\n\n  const handleValidateTable = (list: TableFieldsInfo, isEmptyList: boolean) => {\n    if (isEmptyList) {\n      setSaveBtnDisabled(true);\n      return;\n    }\n    // System fields do not count towards the number of fields limit\n    if (list.filter(i => !i.isSystemField).length > MAX_COLUMNS) {\n      setSaveBtnDisabled(true);\n      return;\n    }\n    const validateRes = list.every(ele => {\n      if (!ele?.errorMapper) {\n        return true;\n      } else {\n        if (\n          ele.errorMapper.name?.length > 0 ||\n          ele.errorMapper.type?.length > 0\n        ) {\n          return false;\n        }\n        return true;\n      }\n    });\n    setSaveBtnDisabled(!validateRes);\n  };\n\n  const onSave: OnSave = async ({ response }) => {\n    /**\n     * In DatabaseTableStructure component, commit already distinguishes between edit and create states,\n     * And there is an onSave callback, so the logic after commit all converges here\n     */\n    await onSubmit?.(response);\n  };\n\n  const onCreateSubmit = async () => {\n    if (tableStructureRef.current) {\n      try {\n        setSaveBtnLoading(true);\n        await tableStructureRef.current.submit();\n      } finally {\n        setSaveBtnLoading(false);\n      }\n    }\n  };\n\n  useEffect(() => {\n    setDatabaseInitValue(initValue);\n  }, [initValue]);\n\n  return (\n    <Modal\n      closable\n      maskClosable={false}\n      visible={visible}\n      onCancel={undefined}\n      onOk={onCreateSubmit}\n      size=\"xxl\"\n      header={\n        <>\n          <div className=\"flex flex-row items-center\">\n            <div className=\"flex-1 text-[20px] font-medium coz-fg-plus\">\n              {isModify\n                ? I18n.t('db_edit_title')\n                : I18n.t('db_add_table_title')}\n            </div>\n            {!isModify\n              ? renderGenerate?.({\n                  tableStructureRef,\n                  onGenerateChange: tableMemoryList => {\n                    setDatabaseInitValue({\n                      ...databaseInitValue,\n                      tableMemoryList,\n                    });\n                  },\n                  onGenerating: setGenerateTableLoading,\n                  botId,\n                })\n              : null}\n            <div>\n              <IconButton\n                color=\"secondary\"\n                icon={<IconCozCross className=\"text-[20px] coz-fg-secondary\" />}\n                onClick={onClose}\n              />\n            </div>\n          </div>\n          {/* Banner prompt appears in the edit pop-up window */}\n          {isModify ? (\n            <DismissibleBanner\n              type=\"warning\"\n              persistentKey=\"_coze_database_edit_warning\"\n              className=\"mx-[-24px]\"\n            >\n              {I18n.t('db_edit_tips1')}\n            </DismissibleBanner>\n          ) : null}\n        </>\n      }\n      footer={\n        <div className=\"coz-modal-footer\">\n          <Button\n            color=\"primary\"\n            onClick={() => {\n              if (onReturn) {\n                onReturn();\n                return;\n              }\n            }}\n          >\n            {isModify ? I18n.t('db_del_field_confirm_no') : I18n.t('db2_003')}\n          </Button>\n          <Button\n            data-testid={BotE2e.BotDatabaseAddModalSubmitBtn}\n            loading={saveBtnLoading}\n            onClick={onCreateSubmit}\n            disabled={saveBtnDisabled}\n          >\n            {I18n.t('db_edit_save')}\n          </Button>\n        </div>\n      }\n    >\n      <div>\n        <DatabaseTableStructure\n          data={databaseInitValue}\n          ref={tableStructureRef}\n          loading={generateTableLoading}\n          loadingTips={I18n.t('bot_database_ai_waiting')}\n          botId={botId}\n          spaceId={spaceId}\n          creatorId={creatorId}\n          // maxColumnNum={expertModeConfig.maxColumnNum}\n          maxColumnNum={MAX_COLUMNS}\n          useComputingEnableGoToNextStep={handleValidateTable}\n          createType={CreateType.custom}\n          hiddenTableBorder\n          readAndWriteModeOptions=\"expert\"\n          showDatabaseBaseInfo={showDatabaseBaseInfo}\n          onlyShowDatabaseInfoRWMode={onlyShowDatabaseInfoRWMode}\n          onSave={onSave}\n          onCancel={onClose}\n          projectID={projectID}\n          renderModeSelect={renderModeSelect}\n        />\n      </div>\n    </Modal>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useState, useMemo } from 'react';\n\nimport { userStoreService } from '@coze-studio/user-store';\nimport { type DatabaseInfo } from '@coze-studio/bot-detail-store';\nimport { useDataNavigate } from '@coze-data/knowledge-stores';\nimport { ModalMode } from '@coze-data/database-v2-base/components/base-info-modal';\nimport { useDatabaseCreateTableModal } from '@coze-data/database-v2-adapter/components/create-table-modal';\nimport {\n  useDatabaseInfoModal,\n  type FormData,\n} from '@coze-data/database-v2-adapter/components/base-info-modal';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport {\n  BotTableRWMode,\n  type SingleDatabaseResponse,\n} from '@coze-arch/bot-api/memory';\n\nexport const enum Step {\n  BASE_INFO = 0,\n  CREATE_TABLE = 1,\n}\nexport const useLibraryCreateDatabaseModal = ({\n  projectID,\n  onFinish,\n}: {\n  projectID?: string;\n  onFinish?: (databaseID: string, draftId: string) => void;\n  enterFrom?: 'library' | 'project';\n}) => {\n  const step = useRef<Step>(Step.BASE_INFO);\n\n  const resourceNavigate = useDataNavigate();\n\n  const spaceId = useSpaceStore(store => store.getSpaceId());\n  const userId = userStoreService.useUserInfo()?.user_id_str;\n\n  const [databaseBaseInfo, setDatabaseBaseInfo] = useState<FormData>({\n    name: '',\n    description: '',\n    icon_uri: [\n      {\n        uri: '',\n        url: '',\n        uid: '',\n      },\n    ],\n  });\n\n  const tableInitData: DatabaseInfo = useMemo(\n    () => ({\n      tableId: '',\n      name: databaseBaseInfo?.name,\n      desc: databaseBaseInfo?.description,\n      icon_uri: databaseBaseInfo.icon_uri?.[0]?.uri,\n      readAndWriteMode: BotTableRWMode.LimitedReadWrite,\n      tableMemoryList: [],\n    }),\n    [databaseBaseInfo],\n  );\n\n  const handleBaseInfoSubmit = (data: FormData) => {\n    setDatabaseBaseInfo(data);\n    step.current = Step.CREATE_TABLE;\n    closeDatabaseInfoModal();\n    open();\n  };\n\n  const handleCreateTableSubmit = (createRes: SingleDatabaseResponse) => {\n    const { id, draft_id } = createRes.database_info ?? {};\n    if (id && draft_id) {\n      if (onFinish) {\n        // Bot binding database needs draft_id, other scenarios generally only need to use id\n        onFinish(id, draft_id);\n        return;\n      } else {\n        resourceNavigate.toResource?.('database', id, {\n          page_modal: 'normal',\n          from: 'create',\n        });\n        close();\n      }\n    }\n  };\n\n  // onReturn\n  const handleCreateTableModalClose = () => {\n    step.current = Step.BASE_INFO;\n    open();\n    closeCreateTableModal();\n  };\n\n  // onClose\n  const handleCloseCreateTable = () => {\n    console.log('open');\n    step.current = Step.BASE_INFO;\n    open();\n  };\n\n  const close = () => {\n    closeDatabaseInfoModal();\n    closeCreateTableModal();\n    step.current = Step.BASE_INFO;\n  };\n\n  const {\n    modal: databaseInfoModal,\n    open: openDatabaseInfoModal,\n    close: closeDatabaseInfoModal,\n  } = useDatabaseInfoModal({\n    onSubmit: handleBaseInfoSubmit,\n    initValues: databaseBaseInfo,\n    mode: ModalMode.CREATE,\n  });\n\n  const {\n    modal: createTableModal,\n    open: openCreateTableModal,\n    close: closeCreateTableModal,\n  } = useDatabaseCreateTableModal({\n    onClose: handleCloseCreateTable,\n    onReturn: handleCreateTableModalClose,\n    onSubmit: handleCreateTableSubmit,\n    initValue: tableInitData,\n    showDatabaseBaseInfo: true,\n    onlyShowDatabaseInfoRWMode: true,\n    extraParams: {\n      spaceId,\n      creatorId: userId,\n    },\n    projectID,\n  });\n\n  const open = () => {\n    if (step.current === Step.BASE_INFO) {\n      openDatabaseInfoModal();\n    } else {\n      openCreateTableModal();\n    }\n  };\n\n  const modal = (\n    <>\n      {databaseInfoModal}\n      {createTableModal}\n    </>\n  );\n\n  return {\n    modal,\n    open,\n    close,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { IconCozKnowledgeFill } from '@coze-arch/coze-design/icons';\n\ninterface SiderCategoryProps {\n  label: string;\n  selected: boolean;\n\n  onClick?: React.MouseEventHandler<HTMLDivElement>;\n}\n\nconst SiderCategory = ({ label, onClick, selected }: SiderCategoryProps) => (\n  <div\n    onClick={onClick}\n    className={classNames([\n      'flex items-center gap-[8px] px-[12px]',\n      'px-[12px] py-[6px] rounded-[8px]',\n      'cursor-pointer',\n      'hover:text-[var(--light-usage-text-color-text-0,#1c1f23)]',\n      'hover:bg-[var(--light-usage-fill-color-fill-0,rgba(46,50,56,5%))]',\n      selected &&\n        'text-[var(--light-usage-text-color-text-0,#1c1d23)] bg-[var(--light-usage-fill-color-fill-0,rgba(46,47,56,5%))]',\n    ])}\n  >\n    <IconCozKnowledgeFill />\n    {label}\n  </div>\n);\n\nexport default SiderCategory;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport cn from 'classnames';\nimport { useBoolean } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { type ButtonProps } from '@coze-arch/bot-semi/Button';\nimport { Button, Typography } from '@coze-arch/bot-semi';\n\nimport styles from './index.module.less';\n\ninterface IProps {\n  icon: string | undefined;\n  title: string | undefined;\n  description: string | undefined;\n  isAdd: boolean;\n  onClick: () => void;\n  onAdd: () => void;\n  onRemove?: () => void;\n}\n\nconst AddedButton = (buttonProps: ButtonProps) => {\n  const [isMouseIn, { setFalse, setTrue }] = useBoolean(false);\n\n  const onMouseEnter = () => {\n    setTrue();\n  };\n  const onMouseLeave = () => {\n    setFalse();\n  };\n\n  return (\n    <Button\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      {...buttonProps}\n      className={cn(styles['database-added'], {\n        [styles['added-mousein']]: isMouseIn,\n      })}\n    >\n      {isMouseIn ? I18n.t('Remove') : I18n.t('Added')}\n    </Button>\n  );\n};\n\nexport const DatabaseListItem: FC<IProps> = props => {\n  const { icon, title, description, isAdd, onClick, onAdd, onRemove } = props;\n\n  const operateDatabase = () => {\n    if (isAdd) {\n      onRemove?.();\n      return;\n    } else {\n      onAdd?.();\n      return;\n    }\n  };\n  return (\n    <div\n      onClick={onClick}\n      className=\"flex flex-row items-center p-[16px] border-t-0 border-l-0 border-r-0 border-b-[1px] border-solid coz-stroke-primary last:border-b-0 cursor-pointer\"\n    >\n      <img src={icon} className=\"w-[36px] h-[36px] rounded-[8px]\" />\n      <div className=\"flex flex-col ml-[12px] min-w-0 flex-grow\">\n        <p className=\"text-[14px] font-medium leading-[20px] coz-fg-primary mb-[4px]\">\n          {title}\n        </p>\n        <Typography.Text\n          ellipsis={{\n            showTooltip: {\n              opts: { content: description },\n            },\n          }}\n          className=\"text-[12px] leading-[16px] coz-fg-secondary truncate !max-w-[680px]\"\n        >\n          {description}\n        </Typography.Text>\n      </div>\n      <div className=\"ml-[16px]\">\n        {isAdd ? (\n          <AddedButton\n            onClick={e => {\n              e.stopPropagation();\n              operateDatabase();\n            }}\n          />\n        ) : (\n          <Button\n            data-testid=\"bot.database.add.modal.add.button\"\n            className={cn(\n              'w-[53px] flex justify-center items-center',\n              styles['database-add'],\n            )}\n            onClick={e => {\n              e.stopPropagation();\n              operateDatabase();\n            }}\n          >\n            {I18n.t('Add_2')}\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\nimport React, {\n  useState,\n  type FC,\n  useRef,\n  useEffect,\n  type ReactNode,\n} from 'react';\n\nimport { debounce } from 'lodash-es';\nimport classNames from 'classnames';\nimport { useInfiniteScroll } from 'ahooks';\nimport { IllustrationNoContent } from '@douyinfe/semi-illustrations';\nimport { IconSpin } from '@douyinfe/semi-icons';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { type DatabaseInfo as DatabaseInitInfo } from '@coze-studio/bot-detail-store';\nimport { DatabaseCreateTableModal } from '@coze-data/database-v2-adapter/components/create-table-modal';\nimport { getUnReactiveLanguage, I18n } from '@coze-arch/i18n';\nimport {\n  Image,\n  UICompositionModal,\n  UICompositionModalMain,\n  UICompositionModalSider,\n} from '@coze-arch/bot-semi';\nimport { IconCozArrowDown } from '@coze-arch/bot-icons';\nimport {\n  BotTableRWMode,\n  type DatabaseInfo,\n  TableType,\n  SortDirection,\n  type SingleDatabaseResponse,\n} from '@coze-arch/bot-api/memory';\nimport { FormatType } from '@coze-arch/bot-api/knowledge';\nimport { MemoryApi, KnowledgeApi } from '@coze-arch/bot-api';\nimport {\n  Button,\n  Dropdown,\n  Input,\n  Tag,\n  Popover,\n  Spin,\n  Select,\n  Empty,\n} from '@coze-arch/coze-design';\n\nimport { useLibraryCreateDatabaseModal } from '../../hooks/use-library-create-database-modal';\nimport tipsTemplateEN from '../../assets/tips-template-en.png';\nimport tipsTemplateCN from '../../assets/tips-template-cn.png';\nimport SiderCategory from './sider-category';\nimport { DatabaseListItem } from './items';\n\nimport styles from './index.module.less';\n\ninterface SelectDatabaseModalProps {\n  visible: boolean;\n  onClose: () => void;\n  onAddDatabase: (id: string, addCallback?: () => void) => void;\n  onRemoveDatabase?: (id: string, removeCallback?: () => void) => void;\n  onClickDatabase: (id: string) => void;\n  onCreateDatabase?: (id: string, draftId: string) => void;\n  enterFrom: string;\n  botId?: string;\n  workflowId?: string;\n  spaceId: string;\n  workflowAddList?: string[];\n  projectID?: string;\n  tips?: ReactNode;\n}\n\ninterface GetDatabaseListData {\n  list: DatabaseInfo[];\n  nextOffset: number;\n  total: number;\n  hasMore: boolean | undefined;\n}\n\nenum ModalMode {\n  CUSTOMIZE = 'customize',\n  TEMPLATE = 'template',\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function, max-lines-per-function\nexport const useSelectDatabaseModal = ({\n  visible,\n  onClose,\n  onAddDatabase,\n  onRemoveDatabase,\n  onClickDatabase,\n  onCreateDatabase,\n  enterFrom,\n  botId,\n  spaceId,\n  workflowAddList = [],\n  projectID,\n  tips,\n}: SelectDatabaseModalProps) => {\n  const language = getUnReactiveLanguage();\n  const userInfo = userStoreService.useUserInfo();\n\n  const scrollRef = useRef<HTMLDivElement>(null);\n\n  const [category, setCategory] = useState<'library' | 'project'>(\n    projectID ? 'project' : 'library',\n  );\n\n  // dropdown visible\n  const [dropdownVisible, setDropdownVisible] = useState<boolean>(false);\n  // whether there is a shadow on th bottom\n  const [showBottomShadow, setShowBottomShadow] = useState(true);\n  // filter creator\n  const [filterCreator, setFilterCreator] = useState<string>('all');\n  // sotr method\n  const [sort, setSort] = useState<string>('create_time');\n  // search value\n  const [keyword, setKeyword] = useState<string>('');\n  // create table init value\n  const [initValue, setInitValue] = useState<DatabaseInitInfo>({\n    tableId: '',\n    name: '',\n    desc: '',\n    icon_uri: '',\n    readAndWriteMode: BotTableRWMode.LimitedReadWrite,\n    tableMemoryList: [],\n  });\n  // modal visible\n  const [createVisible, setCreateVisible] = useState<boolean>(false);\n\n  const fetchDatabaseList = async (reqParams: {\n    key_word: string;\n    filter_creator: string;\n    page_offset: number;\n    sort_by: string;\n  }) => {\n    const { key_word, filter_creator, page_offset, sort_by } = reqParams;\n    const res = await MemoryApi.ListDatabase({\n      ...(category === 'project' ? { project_id: projectID } : {}),\n      bot_id: enterFrom === 'bot' ? botId : '0',\n      space_id: spaceId,\n      table_type:\n        enterFrom === 'bot' ? TableType.DraftTable : TableType.OnlineTable,\n      table_name: key_word,\n      creator_id: filter_creator === 'all' ? '0' : filter_creator,\n      // Do not do paging loading for the time being\n      limit: 50,\n      offset: page_offset,\n      order_by: [\n        {\n          field: sort_by,\n          direction: SortDirection.Desc,\n        },\n      ],\n    });\n    return {\n      list: res.database_info_list || [],\n      nextOffset: page_offset + 1,\n      total: res.total_count as number,\n      hasMore: res.has_more,\n    };\n  };\n\n  const { loading, data, loadingMore, reload } = useInfiniteScroll(\n    (newData?: GetDatabaseListData): Promise<GetDatabaseListData> =>\n      fetchDatabaseList({\n        key_word: keyword,\n        filter_creator: filterCreator,\n        page_offset: newData?.nextOffset || 0,\n        sort_by: sort,\n      }),\n    {\n      manual: true,\n      // true meas there is more data\n      isNoMore: newData => Boolean(!newData?.total || !newData.hasMore),\n      reloadDeps: [keyword, filterCreator, sort, category, projectID],\n      target: scrollRef,\n    },\n  );\n\n  // onScroll Determines whether scrollRef bottoms out\n  const handleScroll = () => {\n    if (!scrollRef.current) {\n      return;\n    }\n\n    const { scrollTop, scrollHeight, clientHeight } = scrollRef.current;\n    const scrollBottom = scrollHeight - (scrollTop + clientHeight);\n\n    if (scrollBottom < 1) {\n      setShowBottomShadow(false);\n    } else {\n      setShowBottomShadow(true);\n    }\n  };\n\n  const handleAddDatabase = (item: DatabaseInfo) => {\n    if (onAddDatabase && item.id) {\n      onAddDatabase?.(item.id, reload);\n    }\n  };\n\n  const handleRemoveDatabase = (item: DatabaseInfo) => {\n    if (onRemoveDatabase && item.id) {\n      onRemoveDatabase?.(item.id, reload);\n    }\n  };\n\n  const handleClickDatabase = (item: DatabaseInfo) => {\n    if (onClickDatabase && item.id) {\n      onClickDatabase?.(item.id);\n    }\n  };\n\n  const openCreateTableModal = (mode: ModalMode) => {\n    if (mode === ModalMode.TEMPLATE) {\n      setInitValue({\n        ...initValue,\n        name: 'reading_notes',\n        desc: 'for saving reading notes',\n        readAndWriteMode: BotTableRWMode.LimitedReadWrite,\n        extra_info: {\n          prompt_disabled: 'true',\n        },\n        tableMemoryList: [\n          {\n            name: 'name',\n            desc: '',\n            type: 1,\n            must_required: true,\n          },\n          {\n            name: 'section',\n            desc: '',\n            type: 2,\n            must_required: true,\n          },\n          {\n            name: 'note',\n            desc: '',\n            type: 1,\n            must_required: true,\n          },\n        ],\n      });\n    } else {\n      setInitValue({\n        tableId: '',\n        name: '',\n        desc: '',\n        readAndWriteMode: BotTableRWMode.LimitedReadWrite,\n        tableMemoryList: [],\n      });\n    }\n    setCreateVisible(true);\n  };\n\n  const renderTemplateTips = () => (\n    <div className={styles['tips-wrapper']}>\n      <div className={styles['tip-title']}>{I18n.t('db2_018')}:</div>\n      <p className=\"my-[8px]\">\n         <em className={styles['tip-desc']}>{I18n.t('db2_019')}:</em>\n      </p>\n      <Image\n        height={136}\n        src={language === 'zh-CN' ? tipsTemplateCN : tipsTemplateEN}\n      />\n      <div className={styles['tip-title']}>{I18n.t('db2_020')}:</div>\n      <div className={styles['bot-bg']}>\n        <div className={classNames(styles['bot-item'], 'mb-[12px]')}>\n          <div className={classNames(styles['bot-img'], styles['img-user'])}>\n            {I18n.t('db2_021')}\n          </div>\n          <div\n            className={classNames(\n              styles['bot-content'],\n              styles['content-user'],\n            )}\n          >\n            {I18n.t('db2_022')}\n          </div>\n        </div>\n\n        <div className={styles['bot-item']}>\n          <div className={classNames(styles['bot-img'], styles['img-bot'])}>\n            {I18n.t('db2_023')}\n          </div>\n          <div\n            className={classNames(styles['bot-content'], styles['content-bot'])}\n          >\n            {I18n.t('db2_024')}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  const renderInput = () => (\n    <Input\n      placeholder={I18n.t('db2_014')}\n      className=\"w-full\"\n      value={keyword}\n      onChange={debounce(v => {\n        setKeyword(v);\n      }, 500)}\n    />\n  );\n\n  const renderFilter = () => (\n    <div className=\"flex flex-row items-center w-full justify-between pr-[12px]\">\n      <div className={classNames(styles.select, 'flex flex-row flex-1')}>\n        <div className=\"flex flex-row items-center\">\n          <Select\n            showArrow\n            size=\"default\"\n            className=\"border-none ml-[4px] hover:border-none bg-transparent outline-none\"\n            value={filterCreator}\n            onChange={v => setFilterCreator(v as string)}\n            insetLabel={<p className={styles.label}>{I18n.t('db2_009')}</p>}\n          >\n            <Select.Option value={'all'} label={I18n.t('db2_010')} />\n            {userInfo ? (\n              <Select.Option\n                value={userInfo.user_id_str}\n                label={userInfo.name}\n                key={userInfo.user_id_str}\n              />\n            ) : null}\n          </Select>\n        </div>\n        <div className=\"flex flex-row items-center ml-[12px]\">\n          <Select\n            showArrow\n            size=\"default\"\n            className=\"border-none ml-[4px] hover:border-none bg-transparent outline-none\"\n            value={sort}\n            onChange={v => setSort(v as string)}\n            insetLabel={<p className={styles.label}>{I18n.t('db2_011')}</p>}\n          >\n            <Select.Option value=\"create_time\" label={I18n.t('db2_012')} />\n            <Select.Option value=\"update_time\" label={I18n.t('db2_013')} />\n          </Select>\n        </div>\n      </div>\n    </div>\n  );\n\n  const renderList = () => (\n    <div\n      className=\"overflow-y-auto relative h-full\"\n      ref={scrollRef}\n      onScroll={handleScroll}\n    >\n      {/* FIXME: This needs to be rendered according to the actual situation. */}\n      {data?.list.map((item, index) => (\n        <DatabaseListItem\n          icon={item.icon_url}\n          title={item.table_name}\n          description={item.table_desc}\n          isAdd={\n            enterFrom === 'workflow'\n              ? Boolean(\n                  item.id &&\n                    workflowAddList?.length &&\n                    workflowAddList?.includes(item.id),\n                )\n              : Boolean(item.is_added_to_bot)\n          }\n          onClick={() => handleClickDatabase(item)}\n          onAdd={() => handleAddDatabase(item)}\n          onRemove={() => handleRemoveDatabase(item)}\n          key={index}\n        />\n      ))}\n      {loadingMore ? (\n        <div className={styles['loading-more']}>\n          <IconSpin spin style={{ marginRight: '4px' }} />\n          <div>{I18n.t('Loading')}</div>\n        </div>\n      ) : null}\n    </div>\n  );\n\n  const renderEmpty = () => (\n    <div className=\"overflow-y-auto relative w-full h-full flex justify-center items-center\">\n      <Empty\n        image={<IllustrationNoContent style={{ width: 150, height: 150 }} />}\n      />\n    </div>\n  );\n\n  const handleClose = () => {\n    onClose();\n  };\n\n  const handleJumpDatabase = (res: SingleDatabaseResponse) => {\n    handleClose();\n    const { id, draft_id } = res.database_info ?? {};\n    if (id && draft_id) {\n      onCreateDatabase?.(id, draft_id);\n    }\n  };\n\n  const fetchDefaultIcon = async () => {\n    const res = await KnowledgeApi.GetIcon({\n      format_type: FormatType.Database,\n    });\n    if (res.icon?.uri) {\n      setInitValue({\n        ...initValue,\n        icon_uri: res.icon?.uri,\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (visible) {\n      reload();\n      fetchDefaultIcon();\n    }\n  }, [visible]);\n\n  const {\n    modal: createDatabaseModal,\n    open: openCreateDatabaseModal,\n    close: closeCreateDatabaseModal,\n  } = useLibraryCreateDatabaseModal({\n    projectID,\n    enterFrom: 'library',\n    onFinish: (databaseID, draftId) => {\n      closeCreateDatabaseModal();\n      onCreateDatabase?.(databaseID, draftId);\n    },\n  });\n\n  const renderContent = () => (\n    <>\n      {tips}\n      <Spin\n        spinning={loading}\n        wrapperClassName={classNames(['overflow-hidden', styles.list])}\n      >\n        {data?.list.length !== 0 ? renderList() : renderEmpty()}\n      </Spin>\n      {showBottomShadow ? (\n        <div\n          className={classNames(\n            styles['bottom-shadow'],\n            'w-full h-[80px] absolute left-0 bottom-0',\n            'pointer-events-none',\n          )}\n        ></div>\n      ) : null}\n    </>\n  );\n\n  const renderDatabase = () => (\n    <React.Fragment>\n      {createDatabaseModal}\n      <UICompositionModal\n        closable\n        visible={visible}\n        onCancel={handleClose}\n        header={I18n.t('db2_025')}\n        filter={renderFilter()}\n        sider={\n          <UICompositionModalSider className=\"!pt-[16px]\">\n            <UICompositionModalSider.Header className=\"mb-[16px] gap-[12px]\">\n              {renderInput()}\n              <Dropdown\n                trigger=\"custom\"\n                visible={dropdownVisible}\n                render={\n                  <Dropdown.Menu className=\"w-[196px]\">\n                    <Dropdown.Item\n                      className=\"!pl-[8px]\"\n                      onClick={() => {\n                        setDropdownVisible(false);\n                        openCreateDatabaseModal();\n                      }}\n                    >\n                      {I18n.t('db2_015')}\n                    </Dropdown.Item>\n                    <Dropdown.Item\n                      className=\"!pl-[8px] [&_.coz-item-text]:w-full\"\n                      onClick={() => {\n                        setDropdownVisible(false);\n                        openCreateTableModal(ModalMode.TEMPLATE);\n                      }}\n                    >\n                      <div className=\"flex justify-between\">\n                        <span>{I18n.t('db2_016')}</span>\n                        <Popover\n                          style={{\n                            maxWidth: '460px',\n                            backgroundColor: 'var(--Bg-COZ-bg-max, #363D4D)',\n                            boxShadow:\n                              '0 4px 12px 0 rgba(0, 0, 0, 8%), 0 8px 24px 0 rgba(0, 0, 0, 4%)',\n                          }}\n                          trigger=\"hover\"\n                          content={renderTemplateTips()}\n                          zIndex={9999}\n                          showArrow\n                        >\n                          <Tag\n                            color=\"primary\"\n                            size=\"small\"\n                            className=\"ml-[8px]\"\n                          >\n                            {I18n.t('db2_017')}\n                          </Tag>\n                        </Popover>\n                      </div>\n                    </Dropdown.Item>\n                  </Dropdown.Menu>\n                }\n                onClickOutSide={() => {\n                  setDropdownVisible(false);\n                }}\n              >\n                <Button\n                  color=\"brand\"\n                  iconPosition=\"right\"\n                  icon={<IconCozArrowDown />}\n                  onClick={() => setDropdownVisible(true)}\n                >\n                  {I18n.t('db_add_table_title')}\n                </Button>\n              </Dropdown>\n            </UICompositionModalSider.Header>\n            <UICompositionModalSider.Content className=\"flex flex-col gap-[4px]\">\n              <SiderCategory\n                label={I18n.t('project_resource_modal_library_resources', {\n                  resource: I18n.t('resource_type_database'),\n                })}\n                onClick={() => {\n                  setCategory('library');\n                }}\n                selected={category === 'library'}\n              />\n              {projectID ? (\n                <SiderCategory\n                  label={I18n.t('project_resource_modal_project_resources', {\n                    resource: I18n.t('resource_type_database'),\n                  })}\n                  onClick={() => {\n                    setCategory('project');\n                  }}\n                  selected={category === 'project'}\n                />\n              ) : null}\n            </UICompositionModalSider.Content>\n          </UICompositionModalSider>\n        }\n        content={\n          <UICompositionModalMain className=\"relative px-[12px] gap-[16px]\">\n            {renderContent()}\n          </UICompositionModalMain>\n        }\n      ></UICompositionModal>\n\n      <DatabaseCreateTableModal\n        visible={createVisible}\n        onClose={() => setCreateVisible(false)}\n        onReturn={() => setCreateVisible(false)}\n        onSubmit={handleJumpDatabase}\n        showDatabaseBaseInfo\n        onlyShowDatabaseInfoRWMode={false}\n        initValue={initValue}\n        extraParams={{\n          botId,\n          spaceId,\n          creatorId: userInfo?.user_id_str,\n        }}\n      />\n    </React.Fragment>\n  );\n\n  return { renderDatabase, renderContent, renderInput, renderFilter };\n};\n\nexport const SelectDatabaseModal: FC<SelectDatabaseModalProps> = props => {\n  const { renderDatabase } = useSelectDatabaseModal(props);\n\n  return <>{renderDatabase()}</>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { type CommonexcludeType } from '@coze-arch/bot-semi/Form';\nimport { type BotTableRWMode } from '@coze-arch/bot-api/memory';\nimport { type CommonFieldProps, withField } from '@coze-arch/coze-design';\nexport interface DatabaseModeSelectProps {\n  disabled?: boolean;\n  type?: 'button' | 'select';\n  value?: BotTableRWMode;\n  options?: BotTableRWMode[];\n  onChange?: (value: BotTableRWMode) => void;\n}\n\nexport const DatabaseModeSelect: FC<DatabaseModeSelectProps> = () => <></>;\n\nexport const FormDatabaseModeSelect: React.FunctionComponent<\n  CommonFieldProps & Omit<DatabaseModeSelectProps, keyof CommonexcludeType>\n> = withField(DatabaseModeSelect, {\n  valueKey: 'value',\n  onKeyChangeFnName: 'onChange',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DatabaseDetailWaring = () => <></>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\nimport { type TableMemoryItem } from '@coze-studio/bot-detail-store';\nimport {\n  FIELD_TYPE_OPTIONS,\n  SYSTEM_FIELDS,\n} from '@coze-data/database-v2-base/constants';\nimport { DatabaseFieldTitle } from '@coze-data/database-v2-base/components/database-field-title';\nimport { I18n } from '@coze-arch/i18n';\nimport { Image, Table, type ColumnProps } from '@coze-arch/coze-design';\n\nimport keyExample from '../../assets/key-example.png';\n\nimport s from './index.module.less';\n\nfunction getTableStructureColumns(): ColumnProps<TableMemoryItem>[] {\n  // The field header content comes from../database-table-structure/index.tsx: 578\n  return [\n    {\n      title: (\n        <DatabaseFieldTitle\n          field={I18n.t('db_add_table_field_name')}\n          tip={\n            <article className=\"w-[494px]\">\n              <p className=\"mb-[8px]\">\n                {I18n.t('db_add_table_field_name_tips')}\n              </p>\n              <Image\n                preview={false}\n                width={494}\n                height={163}\n                src={keyExample}\n              />\n            </article>\n          }\n        />\n      ),\n      dataIndex: 'name',\n      width: 261,\n    },\n    {\n      title: (\n        <DatabaseFieldTitle\n          field={I18n.t('db_add_table_field_desc')}\n          tip={\n            <article className=\"w-[327px]\">\n              {I18n.t('db_add_table_field_desc_tips')}\n            </article>\n          }\n        />\n      ),\n      dataIndex: 'desc',\n    },\n    {\n      title: (\n        <DatabaseFieldTitle\n          field={I18n.t('db_add_table_field_type')}\n          tip={\n            <article className=\"w-[327px]\">\n              {I18n.t('db_add_table_field_type_tips')}\n            </article>\n          }\n        />\n      ),\n      dataIndex: 'type',\n      width: 214,\n      render: (_, record) =>\n        FIELD_TYPE_OPTIONS.find(i => i.value === record.type)?.label ??\n        record.type,\n    },\n    {\n      title: (\n        <DatabaseFieldTitle\n          field={I18n.t('db_add_table_field_necessary')}\n          tip={\n            <article className=\"w-[327px]\">\n              <p>{I18n.t('db_add_table_field_necessary_tips1')}</p>\n              <p>{I18n.t('db_add_table_field_necessary_tips2')}</p>\n            </article>\n          }\n        />\n      ),\n      dataIndex: 'must_required',\n      width: 108,\n      render: (_, record) =>\n        I18n.t(record.must_required ? 'db_optimize_037' : 'db_optimize_038'),\n    },\n  ];\n}\n\nexport interface DatabaseTableStructureReadonlyProps {\n  loading?: boolean;\n  fieldList: TableMemoryItem[];\n}\n\nexport function DatabaseTableStructureReadonly({\n  loading,\n  fieldList,\n}: DatabaseTableStructureReadonlyProps) {\n  const columns = getTableStructureColumns();\n  const dataSource = SYSTEM_FIELDS.concat(fieldList);\n\n  const [tableHeight, setTableHeight] = useState(0);\n  const tableWrapperRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const observer = new ResizeObserver(entries => {\n      for (const e of entries) {\n        if (e.target === tableWrapperRef.current) {\n          setTableHeight(e.contentRect.height);\n        }\n      }\n    });\n    if (tableWrapperRef.current) {\n      observer.observe(tableWrapperRef.current);\n    }\n    return () => observer.disconnect();\n  }, []);\n\n  return (\n    <div className=\"h-full mt-[8px]\" ref={tableWrapperRef}>\n      <Table\n        tableProps={{\n          loading,\n          columns,\n          dataSource,\n          scroll: {\n            // The height of the watch header is 40px.\n            y: tableHeight > 40 ? tableHeight - 40 : 'auto',\n          },\n        }}\n        className={s['table-structure-wrapper']}\n      />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// The maximum and minimum values of int64\nexport const INT64_MAX = BigInt('9223372036854775807');\nexport const INT64_MIN = BigInt('-9223372036854775808');\n\n/**\n * Check if the value is in the int64 range\n * @Param value - string to check\n * @returns\n *  If it is a valid integer in the int64 range, return true.\n *  If invalid or out of range, return false\n */\nexport const isInInt64Range = (value: string): boolean => {\n  if (\n    value === '' ||\n    value === undefined ||\n    value === null ||\n    Number.isNaN(value)\n  ) {\n    return false;\n  }\n\n  try {\n    const bigIntValue = BigInt(value);\n    if (bigIntValue > INT64_MAX || bigIntValue < INT64_MIN) {\n      return false;\n    }\n    return true;\n    // eslint-disable-next-line @coze-arch/use-error-in-catch -- normal business logic\n  } catch {\n    return false;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useParams, useSearchParams } from 'react-router-dom';\n\nimport { useRequest } from 'ahooks';\nimport { type DynamicParams } from '@coze-arch/bot-typings/teamspace';\nimport { MemoryApi } from '@coze-arch/bot-api';\n\n/**\n * Mapping of migrated old channel IDs to new channel IDs\n * Key (old) - > value (new)\n */\nconst migratedConnectorIds: Record<string, string | undefined> = {\n  // WeChat service account\n  '10000114': '10000120',\n  // WeChat subscribed account\n  '10000115': '10000121',\n};\n\nexport interface ConnectorOption {\n  label: string;\n  value: string;\n  /** Has the channel ID been migrated? */\n  migrated?: boolean;\n}\n\nexport interface UseConnectorOptionsParams {\n  /** Whether to include the old channels that have been migrated, not by default */\n  includeMigrated?: boolean;\n}\n\nexport function useConnectorOptions({\n  includeMigrated = false,\n}: UseConnectorOptionsParams = {}): ConnectorOption[] {\n  const { space_id } = useParams<DynamicParams>();\n  // There is no space_id parameter on the url of the library workflow page, you need to get it from searchParams\n  const [searchParams] = useSearchParams();\n  const spaceId = space_id ?? searchParams.get('space_id') ?? '';\n  const { data } = useRequest(\n    async () => {\n      const res = await MemoryApi.GetConnectorName({\n        SpaceId: spaceId,\n        Version: IS_RELEASE_VERSION ? 'release' : 'inhouse',\n        ListAll: true,\n      });\n      const connectors = res.ConnectorList;\n      return connectors?.map(i => {\n        const value = i.ConnectorID?.toString() ?? '';\n        if (migratedConnectorIds[value]) {\n          const target = connectors.find(\n            j => j.ConnectorID?.toString() === migratedConnectorIds[value],\n          );\n          if (target?.ConnectorName) {\n            return { label: target.ConnectorName, value, migrated: true };\n          }\n        }\n        return { label: i.ConnectorName ?? '', value };\n      });\n    },\n    {\n      refreshDeps: [spaceId],\n      // Set cache key to prevent duplicate requests\n      cacheKey: `db_connector_name_${spaceId}`,\n    },\n  );\n  return (includeMigrated ? data : data?.filter(c => !c.migrated)) ?? [];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\nimport dayjs from 'dayjs';\nimport classNames from 'classnames';\nimport { type TableMemoryItem } from '@coze-studio/bot-detail-store';\nimport {\n  PLATFORM_FIELD,\n  SYSTEM_FIELD_ROW_INDEX,\n} from '@coze-data/database-v2-base/constants';\nimport { DatabaseFieldTitle } from '@coze-data/database-v2-base/components/database-field-title';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  CozInputNumber,\n  type DatePickerProps,\n  DatePicker,\n  Form,\n  TextArea,\n  Modal,\n  Select,\n  withField,\n  type CommonFieldProps,\n} from '@coze-arch/coze-design';\nimport { FieldItemType, TableType } from '@coze-arch/bot-api/memory';\n\nimport {\n  type TableRow,\n  type TableFieldData,\n} from '../database-table-data/type';\nimport { isInInt64Range } from '../../utils/is-in-int64-range';\nimport { useConnectorOptions } from '../../hooks/use-connector-options';\n\nconst FormTextArea = withField(TextArea);\nconst FormInputNumber = withField(CozInputNumber);\nconst FormDatePicker = withField(\n  (\n    props: Omit<DatePickerProps, 'onChange'> & {\n      onChange?: (dateString: string) => void;\n    },\n  ) => (\n    <DatePicker\n      {...props}\n      type=\"dateTime\"\n      // Semi DatePicker uses date-fns format\n      format=\"yyyy-MM-dd HH:mm:ss\"\n      onChange={date =>\n        props.onChange?.(dayjs(date as Date).format('YYYY-MM-DD HH:mm:ss'))\n      }\n    />\n  ),\n);\nconst FormSelect = withField(Select);\n\nfunction tableRowToFormValues(row: TableRow): Record<string, string> {\n  return Object.fromEntries(\n    Object.values(row).map(field => [\n      field.fieldName,\n      field.value?.toString() ?? '',\n    ]),\n  );\n}\n\nfunction stringifyFormValues(\n  values: Record<string, string | number | boolean>,\n) {\n  return Object.fromEntries(\n    Object.entries(values).map(([key, value]) => [\n      key,\n      value?.toString() ?? '',\n    ]),\n  );\n}\n\nexport interface RowEditModalProps {\n  visible: boolean;\n  fields: TableFieldData[];\n  tableType?: TableType;\n  initialValues?: TableRow;\n  onSubmit: (\n    values: Record<string, string>,\n    originalConnectorId?: string,\n  ) => Promise<void>;\n  onCancel: () => void;\n}\n\nexport function RowEditModal({\n  visible,\n  fields,\n  tableType,\n  initialValues,\n  onSubmit,\n  onCancel,\n}: RowEditModalProps) {\n  const isAdd = typeof initialValues !== 'object';\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const formRef = useRef<Form>(null);\n\n  useEffect(() => {\n    if (visible && initialValues) {\n      formRef.current?.formApi?.setValues(tableRowToFormValues(initialValues));\n    }\n  }, [visible, initialValues]);\n\n  const connectorOptions = useConnectorOptions();\n\n  return (\n    <Modal\n      visible={visible}\n      title={I18n.t(isAdd ? 'db_optimize_022' : 'db_optimize_023')}\n      okText={I18n.t(isAdd ? 'db_optimize_025' : 'db_edit_save')}\n      okButtonProps={{ loading: isSubmitting }}\n      onOk={async () => {\n        setIsSubmitting(true);\n        try {\n          const values = await formRef.current?.formApi?.validate();\n          if (values) {\n            await onSubmit(\n              Object.assign(\n                initialValues ? tableRowToFormValues(initialValues) : {},\n                stringifyFormValues(values),\n              ),\n              initialValues?.bstudio_connector_id?.value as string | undefined,\n            );\n          }\n        } finally {\n          setIsSubmitting(false);\n        }\n      }}\n      cancelText={I18n.t('db_optimize_024')}\n      onCancel={() => {\n        onCancel();\n        formRef.current?.formApi?.reset();\n      }}\n    >\n      <Form<Record<string, unknown>> allowEmpty ref={formRef}>\n        {tableType === TableType.OnlineTable ? (\n          // Only \"Online Data\" supports modifying the \"Channel\" field\n          <FormSelect\n            {...getSystemFieldCommonProps(PLATFORM_FIELD)}\n            optionList={connectorOptions}\n            className=\"w-full\"\n          />\n        ) : null}\n        {fields.map(field => {\n          const commonProps = getUserFieldCommonProps(field);\n          switch (field.type) {\n            case FieldItemType.Text: {\n              return (\n                <FormTextArea\n                  {...commonProps}\n                  autosize={{ minRows: 1, maxRows: 5 }}\n                />\n              );\n            }\n            case FieldItemType.Number: {\n              return (\n                <Form.Input\n                  {...commonProps}\n                  className={classNames(\n                    'w-full',\n                    '[&_.semi-input-wrapper]:coz-stroke-plus',\n                    'focus-within:[&_.semi-input-wrapper]:coz-stroke-hglt',\n                    '[&_.semi-input-wrapper.semi-input-wrapper-error]:coz-stroke-hglt-red',\n                  )}\n                  validate={value => {\n                    if (!isInInt64Range(value?.toString() ?? '')) {\n                      return 'invalid Integer';\n                    }\n                    return '';\n                  }}\n                />\n              );\n            }\n            case FieldItemType.Date: {\n              return (\n                <FormDatePicker\n                  {...commonProps}\n                  className={classNames(\n                    'w-full',\n                    '[&_.semi-datepicker-input]:w-full',\n                    '[&_.coz-date-picker-select]:w-full',\n                    '[&[aria-invalid]_.coz-date-picker-select]:coz-stroke-hglt-red',\n                  )}\n                />\n              );\n            }\n            case FieldItemType.Float: {\n              return (\n                <FormInputNumber\n                  {...commonProps}\n                  className={classNames(\n                    'w-full',\n                    '[&_.semi-input-wrapper]:coz-stroke-plus',\n                    'focus-within:[&_.semi-input-wrapper]:coz-stroke-hglt',\n                    '[&_.semi-input-wrapper.semi-input-wrapper-error]:coz-stroke-hglt-red',\n                  )}\n                  validate={value => {\n                    if (Number.isNaN(value) || Math.abs(value) === Infinity) {\n                      return 'invalid Float';\n                    }\n                    return '';\n                  }}\n                />\n              );\n            }\n            case FieldItemType.Boolean: {\n              return (\n                <FormSelect\n                  {...commonProps}\n                  optionList={[\n                    { value: 'true', label: 'true' },\n                    { value: 'false', label: 'false' },\n                  ]}\n                  className=\"w-full\"\n                />\n              );\n            }\n            default: {\n              return null;\n            }\n          }\n        })}\n      </Form>\n    </Modal>\n  );\n}\n\ntype FieldCommonProps = React.Attributes & CommonFieldProps;\n\nfunction getSystemFieldCommonProps(field: TableMemoryItem): FieldCommonProps {\n  return {\n    key: field.name,\n    field: SYSTEM_FIELD_ROW_INDEX[field.name ?? ''] ?? '',\n    label: (\n      <DatabaseFieldTitle\n        field={field.name}\n        textType=\"primary\"\n        // @ts-expect-error fix me late\n        type={field.type}\n        tip={field.desc}\n        required\n      />\n    ),\n  };\n}\n\nfunction getUserFieldCommonProps(field: TableFieldData): FieldCommonProps {\n  return {\n    key: field.fieldName,\n    field: field.fieldName,\n    rules: [{ required: field.required }],\n    label: {\n      text: (\n        <DatabaseFieldTitle\n          field={field.fieldName}\n          textType=\"primary\"\n          type={field.type}\n          tip={field.fieldDescription}\n          required={field.required}\n        />\n      ),\n      // The required * symbol is already displayed in DatabaseFieldTitle\n      required: false,\n    },\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ColumnProps } from '@coze-arch/coze-design';\n\nimport { type TableRow } from '../components/database-table-data/type';\n\nconst FIXED_COLUMN_WIDTH = 60;\nconst MIN_COLUMN_WIDTH = 100;\n/**\n * Callbacks when table columns are scaled to limit the scaling boundaries\n * @param column\n * @returns\n */\nexport const resizeFn = (\n  column: ColumnProps<TableRow>,\n): ColumnProps<TableRow> => {\n  // The checkbox/serial number column is not retractable\n  if (column.key === 'column-selection') {\n    return {\n      ...column,\n      resizable: false,\n      width: FIXED_COLUMN_WIDTH,\n    };\n  }\n  // Fixed columns (action columns) are not scalable\n  if (column.fixed) {\n    return {\n      ...column,\n      resizable: false,\n    };\n  }\n  // The remaining field columns are scalable, but the minimum width needs to be limited\n  return {\n    ...column,\n    width:\n      Number(column.width) < MIN_COLUMN_WIDTH\n        ? MIN_COLUMN_WIDTH\n        : Number(column.width),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  type UnitItem,\n  UnitType,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { ActionRenderByDelete } from '@coze-data/knowledge-resource-processor-base/components/upload-unit-table';\nimport {\n  UploadUnitFile,\n  UploadUnitTable,\n} from '@coze-data/knowledge-resource-processor-base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/coze-design';\nimport { type TableType } from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\n\nexport interface StepUploadProps {\n  databaseId: string;\n  tableType: TableType;\n  unitList: UnitItem[];\n  onUnitListChange: (list: UnitItem[]) => void;\n}\n\nexport function StepUpload({\n  databaseId,\n  tableType,\n  unitList,\n  onUnitListChange,\n}: StepUploadProps) {\n  useEffect(() => {\n    onUnitListChange(unitList);\n  }, [onUnitListChange, unitList]);\n\n  const downloadTemplate = async () => {\n    const res = await MemoryApi.GetDatabaseTemplate({\n      database_id: databaseId,\n      table_type: tableType,\n    });\n    if (res.TosUrl) {\n      window.open(res.TosUrl, '_blank');\n    }\n  };\n\n  return (\n    <>\n      <UploadUnitFile\n        unitList={unitList}\n        setUnitList={onUnitListChange}\n        onFinish={onUnitListChange}\n        limit={1}\n        multiple={false}\n        accept=\".csv,.xlsx\"\n        maxSizeMB={20}\n        showRetry={false}\n        dragMainText={I18n.t('datasets_createFileModel_step2_UploadDoc')}\n        dragSubText={I18n.t('datasets_unit_update_exception_tips3')}\n        action=\"\"\n        className={classNames('[&_.semi-upload-drag-area]:!h-[290px]', {\n          hidden: unitList.length > 0,\n        })}\n        showIllustration={false}\n      />\n      <Typography.Paragraph\n        type=\"secondary\"\n        className={classNames('mt-[8px]', { hidden: unitList.length > 0 })}\n      >\n        {I18n.t('db_optimize_018')}\n        <Typography.Text link className=\"ml-[8px]\" onClick={downloadTemplate}>\n          {I18n.t('db_optimize_019')}\n        </Typography.Text>\n      </Typography.Paragraph>\n      <UploadUnitTable\n        edit={false}\n        type={UnitType.TABLE_DOC}\n        unitList={unitList}\n        onChange={onUnitListChange}\n        disableRetry\n        getColumns={(record, index) => ({\n          actions: [\n            <ActionRenderByDelete\n              record={record}\n              index={index}\n              params={{\n                unitList,\n                onChange: onUnitListChange,\n                type: UnitType.TABLE_DOC,\n                edit: false,\n              }}\n            />,\n          ],\n        })}\n      />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, useMemo } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport { type UnitItem } from '@coze-data/knowledge-resource-processor-core';\nimport {\n  type ProcessProgressItemProps,\n  ProcessStatus,\n} from '@coze-data/knowledge-resource-processor-base/types';\nimport { ProcessProgressItem } from '@coze-data/knowledge-resource-processor-base';\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport { formatBytes } from '@coze-arch/bot-utils';\nimport { IconUploadXLS } from '@coze-arch/bot-icons';\nimport { type TableType, type TableSheet } from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport { Typography } from '@coze-arch/coze-design';\n\ntype ProcessProps = Pick<\n  ProcessProgressItemProps,\n  'mainText' | 'subText' | 'tipText' | 'percent' | 'status' | 'actions'\n>;\n\nconst INIT_PERCENT = 10;\nconst COMPLETE_PERCENT = 100;\n\nconst statusTextMap: Record<ProcessStatus, I18nKeysNoOptionsType> = {\n  [ProcessStatus.Processing]: 'datasets_createFileModel_step4_processing',\n  [ProcessStatus.Complete]: 'datasets_createFileModel_step4_Finish',\n  [ProcessStatus.Failed]: 'datasets_createFileModel_step4_failed',\n};\n\nexport interface StepProcessProps {\n  databaseId: string;\n  tableType: TableType;\n  fileItem: UnitItem;\n  tableSheet?: TableSheet;\n  connectorId?: string;\n}\n\nexport function StepProcess({\n  databaseId,\n  tableType,\n  fileItem,\n  tableSheet,\n  connectorId,\n}: StepProcessProps) {\n  const fileSize = useMemo(\n    () => formatBytes(fileItem.fileInstance?.size ?? 0),\n    [fileItem],\n  );\n  const [progressProps, setProgressProps] = useState<ProcessProps>({\n    // First line of text (file name)\n    mainText: fileItem.name,\n    // Second line of text (file size)\n    subText: fileSize,\n    // The second line of text displayed when hovering, consistent with the above\n    tipText: fileSize,\n    // Progress bar percentage, initial 10% is consistent with @code-data/knowledge-resource-processor-base/unit-progress\n    percent: INIT_PERCENT,\n    status: ProcessStatus.Processing,\n  });\n\n  const { run, cancel } = useRequest(\n    () =>\n      MemoryApi.DatabaseFileProgressData({\n        database_id: databaseId,\n        table_type: tableType,\n      }),\n    {\n      manual: true,\n      pollingInterval: 3000,\n      onSuccess: res => {\n        const { data } = res;\n        if (data) {\n          // If there is an error message, it means the processing failed. Display the error message and stop polling.\n          if (data.status_descript) {\n            const msg = data.status_descript;\n            setProgressProps(props => ({\n              ...props,\n              subText: msg,\n              tipText: msg,\n              status: ProcessStatus.Failed,\n            }));\n            cancel();\n          } else {\n            setProgressProps(props => ({\n              ...props,\n              percent: data.progress ?? 0,\n            }));\n            // Progress 100 represents process completion, update status and stop polling\n            if (data.progress === COMPLETE_PERCENT) {\n              setProgressProps(props => ({\n                ...props,\n                status: ProcessStatus.Complete,\n                actions: [I18n.t('datasets_unit_process_success')],\n              }));\n              cancel();\n            }\n          }\n        }\n      },\n    },\n  );\n\n  // Submit the task and start polling progress\n  useEffect(() => {\n    MemoryApi.SubmitDatabaseInsertTask({\n      database_id: databaseId,\n      table_type: tableType,\n      file_uri: fileItem.uri,\n      table_sheet: tableSheet,\n      connector_id: connectorId,\n    }).finally(() => {\n      run();\n    });\n  }, []);\n\n  return (\n    <>\n      <div className=\"h-[32px] leading-[32px] mb-[8px]\">\n        <Typography.Text fontSize=\"14px\" weight={500}>\n          {I18n.t(statusTextMap[progressProps.status])}\n        </Typography.Text>\n      </div>\n      <ProcessProgressItem\n        avatar={<IconUploadXLS />}\n        {...progressProps}\n        className=\"[&_.process-progress-item-actions]:!block\"\n      />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useState } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport {\n  type TableInfo,\n  type TableSettings,\n} from '@coze-data/knowledge-resource-processor-base/types';\nimport { TablePreview } from '@coze-data/knowledge-resource-processor-base/components/table-format';\nimport {\n  type TableSheet,\n  type DocTableColumn,\n  TableDataType,\n} from '@coze-arch/bot-api/memory';\nimport { ColumnType } from '@coze-arch/bot-api/knowledge';\nimport { FieldItemType } from '@coze-arch/bot-api/developer_api';\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport { Spin } from '@coze-arch/coze-design';\n\nimport { type TableFieldData } from '../../database-table-data/type';\n\nfunction convertFieldItemType(type?: FieldItemType): ColumnType {\n  switch (type) {\n    case FieldItemType.Text:\n      return ColumnType.Text;\n    case FieldItemType.Number:\n      return ColumnType.Number;\n    case FieldItemType.Date:\n      return ColumnType.Date;\n    case FieldItemType.Float:\n      return ColumnType.Float;\n    case FieldItemType.Boolean:\n      return ColumnType.Boolean;\n    default:\n      return ColumnType.Text;\n  }\n}\n\nfunction tableSheetToSettings(tableSheet: TableSheet): TableSettings {\n  return {\n    sheet_id: Number.parseInt(tableSheet?.sheet_id ?? '0'),\n    header_line_idx: Number.parseInt(tableSheet?.header_line_idx ?? '0'),\n    start_line_idx: Number.parseInt(tableSheet?.start_line_idx ?? '0'),\n  };\n}\n\nexport interface StepPreviewProps {\n  databaseId: string;\n  tableFields: TableFieldData[];\n  fileUri: string;\n  tableSheet?: TableSheet;\n}\n\nexport function StepPreview({\n  databaseId,\n  tableFields,\n  fileUri,\n  tableSheet,\n}: StepPreviewProps) {\n  const [tableInfo, setTableInfo] = useState<TableInfo>();\n  const tableMeta: DocTableColumn[] = useMemo(\n    () =>\n      tableFields.map((field, index) => ({\n        column_name: field.fieldName,\n        column_type: convertFieldItemType(field.type),\n        desc: field.fieldDescription,\n        sequence: `${index}`,\n        is_semantic: false,\n        id: `${index}`,\n      })),\n    [tableFields],\n  );\n\n  const { loading } = useRequest(\n    () =>\n      MemoryApi.GetTableSchema({\n        database_id: databaseId,\n        source_file: { tos_uri: fileUri },\n        table_data_type: TableDataType.OnlyPreview,\n        table_sheet: tableSheet,\n      }),\n    {\n      onSuccess: res => {\n        const sheetId = tableSheet?.sheet_id;\n        if (sheetId) {\n          setTableInfo({\n            sheet_list: res.sheet_list,\n            table_meta: { [sheetId]: tableMeta },\n            preview_data: { [sheetId]: res.preview_data ?? [] },\n          });\n        }\n      },\n    },\n  );\n\n  return loading || !tableInfo || !tableSheet ? (\n    <Spin size=\"large\" wrapperClassName=\"w-full h-[288px]\" />\n  ) : (\n    <TablePreview\n      data={tableInfo}\n      settings={tableSheetToSettings(tableSheet)}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport classNames from 'classnames';\nimport { useRequest } from 'ahooks';\nimport { type TableSettings } from '@coze-data/knowledge-resource-processor-base/types';\nimport { TableSettingBar } from '@coze-data/knowledge-resource-processor-base/components/table-format';\nimport { FIELD_TYPE_OPTIONS } from '@coze-data/database-v2-base/constants';\nimport { DatabaseFieldTitle } from '@coze-data/database-v2-base/components/database-field-title';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  type TableType,\n  type TableSheet,\n  TableDataType,\n  type GetDocumentTableInfoResponse,\n  ColumnType,\n  FieldItemType,\n} from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport { type ColumnProps, Spin, Table } from '@coze-arch/coze-design';\n\nimport { type TableFieldData } from '../../database-table-data/type';\n\ntype TableSettingsData = Pick<\n  GetDocumentTableInfoResponse,\n  'sheet_list' | 'preview_data'\n>;\n\nfunction tableSettingsToSheet(tableSettings: TableSettings): TableSheet {\n  return {\n    sheet_id: tableSettings?.sheet_id?.toString() ?? '',\n    header_line_idx: tableSettings?.header_line_idx?.toString() ?? '',\n    start_line_idx: tableSettings?.start_line_idx?.toString() ?? '',\n  };\n}\n\nexport interface StepConfigProps {\n  databaseId: string;\n  tableType: TableType;\n  tableFields: TableFieldData[];\n  fileUri: string;\n  onTableSheetChange: (tableSheet?: TableSheet) => void;\n}\n\nexport function StepConfig({\n  databaseId,\n  tableType,\n  tableFields,\n  fileUri,\n  onTableSheetChange,\n}: StepConfigProps) {\n  const [tableData, setTableData] = useState<TableSettingsData>();\n  // Default: Use the first data table, the first row is the header, and the second row starts with data\n  const [tableSettings, setTableSettings] = useState<TableSettings>({\n    sheet_id: 0,\n    header_line_idx: 0,\n    start_line_idx: 1,\n  });\n  const [tableStructure, setTableStructure] = useState<TableFieldData[]>([]);\n\n  const { loading } = useRequest(\n    () =>\n      MemoryApi.GetTableSchema({\n        database_id: databaseId,\n        source_file: { tos_uri: fileUri },\n        table_data_type: TableDataType.OnlySchema,\n        table_sheet: tableSettingsToSheet(tableSettings),\n      }),\n    {\n      refreshDeps: [fileUri, tableSettings],\n      onSuccess: res => {\n        setTableData({\n          sheet_list: res.sheet_list,\n          preview_data: {}, // TableSettingBar does not read preview_data, but it is not empty\n        });\n        if (res.table_meta) {\n          setTableStructure(\n            res.table_meta.map(column => {\n              // When there are fields with the same name in the table structure, use the original type and description\n              const matchedField = tableFields.find(\n                field => field.fieldName === column.column_name,\n              );\n              return (\n                matchedField ??\n                ({\n                  fieldName: column.column_name ?? '-',\n                  fieldDescription: column.desc ?? '-',\n                  type: convertColumnType(column.column_type),\n                  required: false,\n                } satisfies TableFieldData)\n              );\n            }),\n          );\n        }\n      },\n    },\n  );\n\n  useEffect(() => {\n    MemoryApi.ValidateTableSchema({\n      database_id: databaseId,\n      source_file: { tos_uri: fileUri },\n      table_type: tableType,\n      table_sheet: tableSettingsToSheet(tableSettings),\n    })\n      .then(res => {\n        if (!res.schema_valid_result) {\n          onTableSheetChange(tableSettingsToSheet(tableSettings));\n        } else {\n          onTableSheetChange();\n        }\n      })\n      .catch(() => {\n        onTableSheetChange();\n      });\n  }, [tableSettings]);\n\n  return !tableData ? (\n    <Spin size=\"large\" wrapperClassName=\"w-full h-[288px]\" />\n  ) : (\n    <>\n      <TableSettingBar\n        data={tableData}\n        tableSettings={tableSettings}\n        setTableSettings={setTableSettings}\n      />\n      <Table\n        tableProps={{\n          loading,\n          columns: getTableStructureColumns(),\n          dataSource: tableStructure,\n        }}\n        className={classNames(\n          '[&_.semi-table-row-head]:!border-b-[1px]',\n          '[&_.semi-table-row-cell]:!h-[56px]',\n          '[&_.semi-table-row-cell]:!border-b-0',\n          '[&_.semi-table-row-cell]:!bg-none',\n          '[&_.semi-table-row-cell]:!bg-transparent',\n        )}\n      />\n    </>\n  );\n}\n\nfunction convertColumnType(type?: ColumnType): FieldItemType {\n  switch (type) {\n    case ColumnType.Text:\n      return FieldItemType.Text;\n    case ColumnType.Number:\n      return FieldItemType.Number;\n    case ColumnType.Date:\n      return FieldItemType.Date;\n    case ColumnType.Float:\n      return FieldItemType.Float;\n    case ColumnType.Boolean:\n      return FieldItemType.Boolean;\n    default:\n      return FieldItemType.Text;\n  }\n}\n\nfunction getTableStructureColumns(): ColumnProps<TableFieldData>[] {\n  return [\n    {\n      title: <DatabaseFieldTitle field={I18n.t('db_add_table_field_name')} />,\n      render: (_, record) => record.fieldName,\n    },\n    {\n      title: <DatabaseFieldTitle field={I18n.t('db_add_table_field_desc')} />,\n      render: (_, record) => record.fieldDescription,\n    },\n    {\n      title: <DatabaseFieldTitle field={I18n.t('db_add_table_field_type')} />,\n      render: (_, record) =>\n        FIELD_TYPE_OPTIONS.find(i => i.value === record.type)?.label ?? '-',\n    },\n  ];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport {\n  type UnitItem,\n  UploadStatus,\n} from '@coze-data/knowledge-resource-processor-core';\nimport { I18n } from '@coze-arch/i18n';\nimport { type TableType, type TableSheet } from '@coze-arch/bot-api/memory';\nimport { Button, Modal } from '@coze-arch/coze-design';\n\nimport { type TableFieldData } from '../database-table-data/type';\nimport { StepUpload } from './steps/upload';\nimport { StepProcess } from './steps/process';\nimport { StepPreview } from './steps/preview';\nimport { StepConfig } from './steps/config';\nimport { BatchImportStep, BatchImportSteps } from './import-steps';\n\nexport interface BatchImportModalProps {\n  visible: boolean;\n  databaseId: string;\n  tableFields: TableFieldData[];\n  tableType: TableType;\n  connectorId?: string;\n  onClose?: () => void;\n  onComplete?: () => void;\n}\n\nexport function BatchImportModal({\n  visible,\n  databaseId,\n  tableFields,\n  tableType,\n  connectorId,\n  onClose,\n  onComplete,\n}: BatchImportModalProps) {\n  const [currentStep, setCurrentStep] = useState(BatchImportStep.Upload);\n  const [unitList, setUnitList] = useState<UnitItem[]>([]);\n  const [tableSheet, setTableSheet] = useState<TableSheet>();\n\n  const resetSteps = () => {\n    setCurrentStep(BatchImportStep.Upload);\n    setUnitList([]);\n    setTableSheet(undefined);\n  };\n\n  const getNextDisabled = () => {\n    switch (currentStep) {\n      case BatchImportStep.Upload:\n        return (\n          unitList.length <= 0 ||\n          unitList.some(item => item.status !== UploadStatus.SUCCESS)\n        );\n      case BatchImportStep.Config:\n        return !tableSheet;\n      case BatchImportStep.Preview:\n        return false;\n      case BatchImportStep.Process:\n        return false;\n      default:\n        return false;\n    }\n  };\n\n  return (\n    <Modal\n      visible={visible}\n      title={I18n.t('db_optimize_013')}\n      onCancel={onClose}\n      width={1120}\n      className=\"[&_.semi-modal-content]:min-h-[520px]\"\n      footer={\n        <>\n          {currentStep !== BatchImportStep.Process ? (\n            <>\n              <Button\n                color=\"primary\"\n                disabled={currentStep === BatchImportStep.Upload}\n                onClick={() => setCurrentStep(currentStep - 1)}\n              >\n                {I18n.t('db_optimize_020')}\n              </Button>\n              <Button\n                disabled={getNextDisabled()}\n                onClick={() => setCurrentStep(currentStep + 1)}\n              >\n                {I18n.t('db_optimize_021')}\n              </Button>\n            </>\n          ) : (\n            <Button\n              onClick={() => {\n                onClose?.();\n                onComplete?.();\n                resetSteps();\n              }}\n            >\n              {I18n.t('db2_004')}\n            </Button>\n          )}\n        </>\n      }\n    >\n      <BatchImportSteps step={currentStep} />\n      {currentStep === BatchImportStep.Upload ? (\n        <StepUpload\n          databaseId={databaseId}\n          tableType={tableType}\n          unitList={unitList}\n          onUnitListChange={setUnitList}\n        />\n      ) : null}\n      {currentStep === BatchImportStep.Config ? (\n        <StepConfig\n          databaseId={databaseId}\n          tableFields={tableFields}\n          tableType={tableType}\n          fileUri={unitList[0].uri}\n          onTableSheetChange={setTableSheet}\n        />\n      ) : null}\n      {currentStep === BatchImportStep.Preview ? (\n        <StepPreview\n          databaseId={databaseId}\n          tableFields={tableFields}\n          fileUri={unitList[0].uri}\n          tableSheet={tableSheet}\n        />\n      ) : null}\n      {currentStep === BatchImportStep.Process ? (\n        <StepProcess\n          databaseId={databaseId}\n          tableType={tableType}\n          fileItem={unitList[0]}\n          tableSheet={tableSheet}\n          connectorId={connectorId}\n        />\n      ) : null}\n    </Modal>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { TableType } from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport {\n  IconCozArrowDown,\n  IconCozImport,\n  IconCozPlus,\n  IconCozRefresh,\n  IconCozTrashCan,\n} from '@coze-arch/coze-design/icons';\nimport { Button, Dropdown, Modal } from '@coze-arch/coze-design';\n\nimport { BatchImportModal } from '../batch-import-modal';\nimport { useConnectorOptions } from '../../hooks/use-connector-options';\nimport { type TableFieldData } from './type';\n\nexport interface ToolButtonsBarProps {\n  readonly: boolean;\n  databaseId: string;\n  tableType: TableType;\n  tableFields: TableFieldData[];\n  onNewRow: () => void;\n  onRefresh: () => void;\n}\n\nexport function ToolButtonsBar({\n  readonly,\n  databaseId,\n  tableType,\n  tableFields,\n  onNewRow,\n  onRefresh,\n}: ToolButtonsBarProps) {\n  const [connectorDropdownVisible, setConnectorDropdownVisible] =\n    useState(false);\n  const [batchImportVisible, setBatchImportVisible] = useState(false);\n  const [batchImportConnectorId, setBatchImportConnectorId] = useState<\n    string | undefined\n  >();\n  const connectorOptions = useConnectorOptions();\n  const showBatchImportModal = (connectorId?: string) => {\n    setConnectorDropdownVisible(false);\n    setBatchImportVisible(true);\n    setBatchImportConnectorId(connectorId);\n  };\n\n  const handleClearDatabase = () =>\n    Modal.confirm({\n      title: I18n.t('dialog_240305_01'),\n      content: I18n.t('dialog_240305_02'),\n      okText: I18n.t('dialog_240305_03'),\n      okButtonColor: 'red',\n      cancelText: I18n.t('dialog_240305_04'),\n      onOk: async () => {\n        await MemoryApi.ResetBotTable({\n          database_info_id: databaseId,\n          table_type: tableType,\n        });\n        onRefresh();\n      },\n    });\n\n  return (\n    <div className=\"flex gap-[8px] mt-[8px] mb-[12px]\">\n      <Button\n        color=\"secondary\"\n        icon={<IconCozPlus className={readonly ? '' : 'coz-fg-hglt'} />}\n        disabled={readonly}\n        onClick={onNewRow}\n      >\n        <span className={readonly ? '' : 'coz-fg-hglt'}>\n          {I18n.t('db_optimize_022')}\n        </span>\n      </Button>\n      {tableType === TableType.DraftTable ? (\n        <Button\n          color=\"secondary\"\n          icon={<IconCozImport />}\n          disabled={readonly}\n          onClick={() => showBatchImportModal()}\n        >\n          {I18n.t('db_optimize_013')}\n        </Button>\n      ) : (\n        <Dropdown\n          trigger=\"custom\"\n          visible={connectorDropdownVisible}\n          onClickOutSide={() => setConnectorDropdownVisible(false)}\n          position=\"bottomLeft\"\n          render={\n            <>\n              <Dropdown.Title className=\"pl-[32px] border-0 border-b border-solid coz-stroke-primary\">\n                {I18n.t('database_optimize_100')}\n              </Dropdown.Title>\n              <div className=\"min-w-[170px] max-h-[220px] overflow-auto\">\n                <Dropdown.Menu>\n                  {connectorOptions.map(item => (\n                    <Dropdown.Item\n                      key={item.value}\n                      onClick={() => showBatchImportModal(item.value)}\n                    >\n                      {item.label}\n                    </Dropdown.Item>\n                  ))}\n                </Dropdown.Menu>\n              </div>\n            </>\n          }\n        >\n          <Button\n            color=\"secondary\"\n            icon={<IconCozImport />}\n            disabled={readonly}\n            onClick={() => setConnectorDropdownVisible(true)}\n          >\n            <span>{I18n.t('db_optimize_013')}</span>\n            <IconCozArrowDown className=\"ml-[4px]\" />\n          </Button>\n        </Dropdown>\n      )}\n      <div className=\"ml-auto\"></div>\n      {tableType === TableType.DraftTable ? (\n        <Button\n          color=\"secondary\"\n          icon={<IconCozTrashCan />}\n          disabled={readonly}\n          onClick={handleClearDatabase}\n        >\n          {I18n.t('db_optimize_011')}\n        </Button>\n      ) : null}\n      <Button color=\"secondary\" icon={<IconCozRefresh />} onClick={onRefresh}>\n        {I18n.t('db_optimize_012')}\n      </Button>\n      <BatchImportModal\n        visible={batchImportVisible}\n        databaseId={databaseId}\n        tableFields={tableFields}\n        tableType={tableType}\n        connectorId={batchImportConnectorId}\n        onClose={() => setBatchImportVisible(false)}\n        onComplete={onRefresh}\n      />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { type TableMemoryItem } from '@coze-studio/bot-detail-store';\nimport {\n  SYSTEM_FIELDS,\n  SYSTEM_FIELD_ROW_INDEX,\n} from '@coze-data/database-v2-base/constants';\nimport { DatabaseFieldTitle } from '@coze-data/database-v2-base/components/database-field-title';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit, IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport {\n  type ColumnProps,\n  IconButton,\n  Popconfirm,\n  Space,\n  Typography,\n} from '@coze-arch/coze-design';\nimport { FieldItemType } from '@coze-arch/bot-api/memory';\n\nimport { type TableRow, type TableField, type TableFieldData } from './type';\n\nexport function formatTableStructList(\n  structList: TableMemoryItem[],\n): TableFieldData[] {\n  // @ts-expect-error fix me late\n  return structList.map(item => ({\n    fieldName: item.name ?? '',\n    fieldDescription: item.desc ?? '',\n    required: item.must_required ?? false,\n    type: item.type ?? FieldItemType.Text,\n  }));\n}\n\nexport function formatTableDataRow(\n  structList: TableFieldData[],\n  dataRow: Record<string, string>[],\n): TableRow[] {\n  return dataRow.map(_data => {\n    const dataRowFieldList = Object.keys(_data);\n    const formattedDataRow: TableRow = {};\n    dataRowFieldList.forEach(_key => {\n      const structItem = structList.find(i => i.fieldName === _key);\n      if (!structItem) {\n        // System field\n        formattedDataRow[_key] = {\n          fieldName: _key,\n          type: FieldItemType.Text,\n          required: true,\n          value: _data[_key as unknown as number],\n        };\n        return;\n      }\n\n      switch (structItem.type) {\n        case FieldItemType.Boolean:\n          formattedDataRow[_key] = {\n            fieldName: _key,\n            value: _data[_key as unknown as number] as unknown as boolean,\n            type: FieldItemType.Boolean,\n            required: structItem.required,\n          };\n          break;\n        case FieldItemType.Number:\n          formattedDataRow[_key] = {\n            fieldName: _key,\n            value: _data[_key as unknown as number] as unknown as number,\n            type: FieldItemType.Number,\n            required: structItem.required,\n          };\n          break;\n        case FieldItemType.Date:\n          formattedDataRow[_key] = {\n            fieldName: _key,\n            value: _data[_key as unknown as number] as unknown as string,\n            type: FieldItemType.Date,\n            required: structItem.required,\n          };\n          break;\n        case FieldItemType.Float:\n          formattedDataRow[_key] = {\n            fieldName: _key,\n            value: _data[_key as unknown as number] as unknown as string,\n            type: FieldItemType.Float,\n            required: structItem.required,\n          };\n          break;\n        case FieldItemType.Text:\n          formattedDataRow[_key] = {\n            fieldName: _key,\n            value: _data[_key as unknown as number] as unknown as string,\n            type: FieldItemType.Text,\n            required: structItem.required,\n          };\n          break;\n        default:\n          break;\n      }\n    });\n\n    return formattedDataRow;\n  });\n}\n\nconst SystemFieldWidth: Record<string, number | undefined> = {\n  id: 200,\n  sys_platform: 180,\n  uuid: 260,\n  bstudio_create_time: 200,\n};\n\ninterface GetTableColumnsParams {\n  fieldList: TableFieldData[];\n  connectorNames: Record<string, string>;\n  isReadonlyMode: boolean;\n  handleEditRow: (row: TableRow) => void;\n  handleDeleteRow: (row: TableRow) => void;\n}\n\ninterface DatabaseTableCellProps {\n  value?: string | number | boolean;\n}\n\nfunction DatabaseTableCell({ value }: DatabaseTableCellProps) {\n  const stringValue = value?.toString() ?? '';\n\n  return (\n    <Typography.Text\n      ellipsis={{\n        showTooltip: {\n          opts: {\n            className: classNames(\n              '[&_.semi-tooltip-content]:max-h-[110px]',\n              '[&_.semi-tooltip-content]:line-clamp-5',\n            ),\n          },\n        },\n      }}\n    >\n      {stringValue}\n    </Typography.Text>\n  );\n}\n\n/**\n * Get Table Field Header Data\n */\nexport const getTableColumns = ({\n  fieldList,\n  connectorNames,\n  isReadonlyMode,\n  handleEditRow,\n  handleDeleteRow,\n}: GetTableColumnsParams) => {\n  const columns: ColumnProps<TableRow>[] = [];\n\n  // System field column\n  columns.push(\n    ...SYSTEM_FIELDS.map(item => ({\n      title: () => (\n        <DatabaseFieldTitle\n          field={item.name}\n          // @ts-expect-error fix me late\n          type={item.type}\n          tip={item.desc}\n          required\n        />\n      ),\n      dataIndex: SYSTEM_FIELD_ROW_INDEX[item.name ?? ''],\n      width: SystemFieldWidth[item.name ?? ''] ?? 260,\n      render: (field: TableField) =>\n        field.fieldName === 'bstudio_connector_id' ? (\n          <Typography.Text ellipsis>\n            {connectorNames[field.value as string] ?? field.value}\n          </Typography.Text>\n        ) : (\n          <DatabaseTableCell value={field.value} />\n        ),\n    })),\n  );\n\n  // user field column\n  columns.push(\n    ...fieldList.map(item => ({\n      title: () => (\n        <DatabaseFieldTitle\n          field={item.fieldName}\n          type={item.type}\n          tip={item.fieldDescription}\n          required={item.required}\n        />\n      ),\n      dataIndex: item.fieldName,\n      width: 260,\n      render: (field: TableField) => <DatabaseTableCell value={field?.value} />,\n    })),\n  );\n\n  // action column\n  columns.push({\n    title: I18n.t('db_table_0126_021'),\n    width: 100,\n    resize: false,\n    fixed: 'right',\n    render: (_: TableField, row: TableRow, _index: number) =>\n      isReadonlyMode ? (\n        <Space>\n          <IconButton\n            disabled\n            icon={<IconCozEdit />}\n            size=\"small\"\n            color=\"secondary\"\n          />\n          <IconButton\n            disabled\n            icon={<IconCozTrashCan />}\n            size=\"small\"\n            color=\"secondary\"\n          />\n        </Space>\n      ) : (\n        <Space>\n          <IconButton\n            icon={<IconCozEdit />}\n            size=\"default\"\n            color=\"secondary\"\n            onClick={() => handleEditRow(row)}\n          />\n          <Popconfirm\n            title={I18n.t('db_optimize_026')}\n            content={I18n.t('db_optimize_027')}\n            okText={I18n.t('db_optimize_028')}\n            okButtonColor=\"red\"\n            cancelText={I18n.t('db_optimize_029')}\n            onConfirm={() => handleDeleteRow(row)}\n          >\n            <IconButton\n              icon={<IconCozTrashCan />}\n              size=\"default\"\n              color=\"secondary\"\n            />\n          </Popconfirm>\n        </Space>\n      ),\n  });\n\n  return columns;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCross, IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport {\n  Button,\n  Divider,\n  IconButton,\n  Typography,\n} from '@coze-arch/coze-design';\n\nexport interface BatchDeleteToolbarProps {\n  selectedCount?: number;\n  onDelete: () => void;\n  onCancel: () => void;\n}\n\nexport function BatchDeleteToolbar({\n  selectedCount = 0,\n  onDelete,\n  onCancel,\n}: BatchDeleteToolbarProps) {\n  return (\n    <div\n      className={classNames(\n        'flex items-center p-[8px] gap-[8px] rounded-[12px]',\n        'coz-bg-max border-solid coz-stroke-primary coz-shadow-default',\n        'fixed bottom-[8px] left-[50%] translate-x-[-50%] z-10',\n        { hidden: selectedCount <= 0 },\n      )}\n    >\n      <Typography.Text type=\"secondary\">\n        {I18n.t('db_optimize_031', { n: selectedCount })}\n      </Typography.Text>\n      <Divider layout=\"vertical\" />\n      <Button color=\"red\" icon={<IconCozTrashCan />} onClick={onDelete}>\n        {I18n.t('db_optimize_030')}\n      </Button>\n      <Divider layout=\"vertical\" />\n      <IconButton\n        color=\"secondary\"\n        icon={<IconCozCross />}\n        onClick={onCancel}\n      />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useMemo, useRef, useEffect } from 'react';\n\nimport classNames from 'classnames';\nimport { useRequest } from 'ahooks';\nimport { IllustrationNoContent } from '@douyinfe/semi-illustrations';\nimport { I18n } from '@coze-arch/i18n';\nimport { type TableType, type FieldItem } from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport {\n  Modal,\n  Table,\n  Divider,\n  Typography,\n  CozPagination,\n  Empty,\n} from '@coze-arch/coze-design';\n\nimport { RowEditModal } from '../row-edit-modal';\nimport { resizeFn } from '../../utils/table';\nimport { useConnectorOptions } from '../../hooks/use-connector-options';\nimport { type TableRow } from './type';\nimport { ToolButtonsBar } from './tool-buttons-bar';\nimport {\n  formatTableDataRow,\n  formatTableStructList,\n  getTableColumns,\n} from './formatter';\nimport { BatchDeleteToolbar } from './batch-delete-toolbar';\n\nimport styles from './index.module.less';\n\ninterface DatabaseTableDataProps {\n  databaseId: string;\n  tableType: TableType;\n  tableFields: FieldItem[];\n  isReadonlyMode: boolean;\n  enterFrom?: string;\n  onAfterEditRecords?: () => void;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function DatabaseTableData({\n  databaseId,\n  tableType,\n  tableFields,\n  isReadonlyMode,\n  enterFrom,\n  onAfterEditRecords,\n}: DatabaseTableDataProps) {\n  const fields = useMemo(\n    () => formatTableStructList(tableFields),\n    [tableFields],\n  );\n\n  const [pageSize, setPageSize] = useState(20);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalRecords, setTotalRecords] = useState(0);\n  const [dataRows, setDataRows] = useState<Record<string, string>[]>([]);\n\n  const { loading, refresh } = useRequest(\n    () =>\n      MemoryApi.ListDatabaseRecords({\n        database_id: databaseId,\n        table_type: tableType,\n        offset: (currentPage - 1) * pageSize,\n        limit: pageSize,\n      }),\n    {\n      onSuccess: res => {\n        setTotalRecords(res.TotalNum);\n        setDataRows(res.data);\n      },\n      refreshDeps: [databaseId, tableType, pageSize, currentPage],\n    },\n  );\n\n  const tableDataSource = useMemo(\n    () => formatTableDataRow(fields, dataRows),\n    [fields, dataRows],\n  );\n\n  const afterEdit = () => {\n    refresh();\n    onAfterEditRecords?.();\n  };\n\n  const connectorOptions = useConnectorOptions({ includeMigrated: true });\n  const connectorNames = useMemo(\n    () =>\n      Object.fromEntries(\n        connectorOptions.map(item => [item.value, item.label]),\n      ),\n    [connectorOptions],\n  );\n\n  const [selectedRows, setSelectedRows] = useState<TableRow[]>([]);\n\n  const handleBatchDelete = () =>\n    Modal.confirm({\n      title: I18n.t('db_optimize_026'),\n      content: I18n.t('db_optimize_027'),\n      okText: I18n.t('dialog_240305_03'),\n      okButtonColor: 'red',\n      cancelText: I18n.t('dialog_240305_04'),\n      onOk: async () => {\n        await MemoryApi.UpdateDatabaseRecords({\n          database_id: databaseId,\n          table_type: tableType,\n          record_data_delete: selectedRows.map(row => ({\n            bstudio_id: row.bstudio_id.value as string,\n          })),\n        });\n        setSelectedRows([]);\n        afterEdit();\n      },\n    });\n\n  const [rowEditModelVisible, setRowEditModelVisible] = useState(false);\n  const [editingRow, setEditingRow] = useState<TableRow>();\n  const handleEditRow = (row?: TableRow) => {\n    setEditingRow(row);\n    setRowEditModelVisible(true);\n  };\n\n  const handleRowEditSubmit = async (\n    values: Record<string, string>,\n    originalConnectorId?: string,\n  ) => {\n    if (!originalConnectorId) {\n      await MemoryApi.UpdateDatabaseRecords({\n        database_id: databaseId,\n        table_type: tableType,\n        record_data_add: [values],\n      });\n    } else {\n      await MemoryApi.UpdateDatabaseRecords({\n        database_id: databaseId,\n        table_type: tableType,\n        record_data_alter: [values],\n        // When editing the line, bring the original connector_id, and the backend needs to determine whether the data comes from/targets the \"bean bag\" channel\n        ori_connector_id: originalConnectorId,\n      });\n    }\n    setRowEditModelVisible(false);\n    setEditingRow(undefined);\n    afterEdit();\n  };\n\n  const handleDeleteRow = async (row: TableRow) => {\n    await MemoryApi.UpdateDatabaseRecords({\n      database_id: databaseId,\n      table_type: tableType,\n      record_data_delete: [\n        {\n          bstudio_id: row.bstudio_id.value as string,\n        },\n      ],\n    });\n    afterEdit();\n  };\n\n  const tableFieldColumns = useMemo(\n    () =>\n      getTableColumns({\n        fieldList: fields,\n        isReadonlyMode,\n        connectorNames,\n        handleDeleteRow,\n        handleEditRow,\n      }),\n    [fields, isReadonlyMode, connectorNames],\n  );\n\n  const [tableHeight, setTableHeight] = useState(0);\n  const tableWrapperRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const observer = new ResizeObserver(entires => {\n      for (const e of entires) {\n        if (e.target === tableWrapperRef.current) {\n          setTableHeight(e.contentRect.height);\n        }\n      }\n    });\n    if (tableWrapperRef.current) {\n      observer.observe(tableWrapperRef.current);\n    }\n    return () => observer.disconnect();\n  }, []);\n\n  return (\n    <div className={styles.table} ref={tableWrapperRef}>\n      <ToolButtonsBar\n        readonly={isReadonlyMode}\n        databaseId={databaseId}\n        tableType={tableType}\n        tableFields={fields}\n        onNewRow={() => handleEditRow()}\n        onRefresh={refresh}\n      />\n      <Table\n        tableProps={{\n          loading,\n          columns: tableFieldColumns,\n          dataSource: tableDataSource,\n          rowSelection: {\n            fixed: true,\n            selectedRowKeys: selectedRows.map(\n              r => r.bstudio_id?.value as string,\n            ),\n            onChange: (_, rows) => setSelectedRows(rows ?? []),\n          },\n          resizable: {\n            onResize: resizeFn,\n          },\n          rowKey: (record: TableRow) => record?.bstudio_id?.value as string,\n          scroll: {\n            // 128 = ToolButtonsBar (52) + Header (28) + Pagination (48)\n            y: tableHeight > 128 ? tableHeight - 128 : 'auto',\n          },\n          pagination: {\n            total: totalRecords,\n            currentPage,\n            pageSize,\n            onChange: (current, size) => {\n              setCurrentPage(current);\n              setPageSize(size);\n              setSelectedRows([]);\n            },\n          },\n          renderPagination: paginationProps => (\n            <div className=\"w-full flex gap-[8px] items-center justify-end\">\n              <Typography.Text type=\"secondary\" fontSize=\"12px\">\n                {I18n.t('db_optimize_032', { n: totalRecords })}\n              </Typography.Text>\n              <Divider layout=\"vertical\" className=\"h-[16px]\" />\n              <CozPagination\n                size=\"small\"\n                showSizeChanger\n                pageSizeOpts={[20, 50, 100]}\n                {...paginationProps}\n              />\n            </div>\n          ),\n        }}\n        wrapperClassName={classNames(styles['table-wrapper'], {\n          // Use coz-bg-max white background for database data tables in Project IDE\n          [styles['table-wrapper-project']]: enterFrom === 'project',\n        })}\n        empty={\n          <Empty\n            image={<IllustrationNoContent className=\"w-[140px] h-[140px]\" />}\n            title={I18n.t('timecapsule_0108_003')}\n          />\n        }\n        indexRowSelection\n      />\n      <BatchDeleteToolbar\n        selectedCount={selectedRows.length}\n        onDelete={handleBatchDelete}\n        onCancel={() => setSelectedRows([])}\n      />\n      <RowEditModal\n        fields={fields}\n        visible={rowEditModelVisible}\n        tableType={tableType}\n        initialValues={editingRow}\n        onSubmit={handleRowEditSubmit}\n        onCancel={() => setRowEditModelVisible(false)}\n      />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState, useEffect, useMemo } from 'react';\n\nimport { pick } from 'lodash-es';\nimport classNames from 'classnames';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { type DatabaseInfo as DatabaseInitInfo } from '@coze-studio/bot-detail-store';\nimport { type WidgetUIState } from '@coze-data/knowledge-stores';\nimport { BotE2e } from '@coze-data/e2e';\nimport { DatabaseTabs } from '@coze-data/database-v2-base/types';\nimport { DismissibleBanner } from '@coze-data/database-v2-base/components/dismissible-banner';\nimport {\n  type FormData,\n  ModalMode,\n} from '@coze-data/database-v2-base/components/base-info-modal';\nimport { DatabaseModeSelect } from '@coze-data/database-v2-adapter/components/database-mode-select';\nimport { DatabaseCreateTableModal } from '@coze-data/database-v2-adapter/components/create-table-modal';\nimport { DatabaseBaseInfoModal } from '@coze-data/database-v2-adapter/components/base-info-modal';\nimport { DatabaseDetailWaring } from '@coze-data/database-v2-adapter';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozEdit,\n  IconCozCross,\n  IconCozArrowLeft,\n} from '@coze-arch/coze-design/icons';\nimport {\n  Button,\n  IconButton,\n  TabBar,\n  Toast,\n  CozAvatar,\n  Typography,\n  Space,\n} from '@coze-arch/coze-design';\nimport {\n  BotTableRWMode,\n  TableType,\n  type DatabaseInfo,\n  type UpdateDatabaseRequest,\n} from '@coze-arch/bot-api/memory';\nimport { MemoryApi } from '@coze-arch/bot-api';\n\nimport { DatabaseTableStructureReadonly } from '../database-table-structure-readonly';\nimport { DatabaseTableData } from '../database-table-data';\n\nimport styles from './index.module.less';\n\nexport interface DatabaseDetailProps {\n  version?: string;\n  needHideCloseIcon?: boolean;\n  databaseId: string;\n  enterFrom: string;\n  initialTab?: `${DatabaseTabs}`;\n  addRemoveButtonText: string;\n  onClose?: () => void;\n  onAfterEditBasicInfo?: () => void;\n  onAfterEditRecords?: () => void;\n  onIDECallback?: {\n    onStatusChange?: (v: WidgetUIState) => void;\n    onUpdateDisplayName?: (v: string) => void;\n  };\n  onClickAddRemoveButton: (databaseId?: string) => void;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function, max-lines-per-function, complexity\nexport const DatabaseDetail = ({\n  version,\n  enterFrom,\n  initialTab,\n  needHideCloseIcon = false,\n  addRemoveButtonText,\n  onClose,\n  onClickAddRemoveButton,\n  onIDECallback,\n  onAfterEditBasicInfo,\n  onAfterEditRecords,\n  databaseId,\n}: DatabaseDetailProps) => {\n  const userId = userStoreService.useUserInfo()?.user_id_str;\n\n  const [basicInfoVisible, setBasicInfoVisible] = useState(false);\n  const [createTableVisible, setCreateTableVisible] = useState(false);\n  // database basicInfo\n  const [databaseInfo, setDatabaseInfo] = useState<DatabaseInfo>({});\n  // tab key\n  const [activeKey, setActiveKey] = useState(\n    version ? DatabaseTabs.Structure : initialTab ?? DatabaseTabs.Structure,\n  );\n  // btn loading\n  const [btnLoading, setBtnLoading] = useState(false);\n  // page loading\n  const [loading, setLoading] = useState(true);\n\n  // fetch database basicInfo\n  const fetchDatabaseInfo = async () => {\n    try {\n      setLoading(true);\n      const res = await MemoryApi.GetDatabaseByID({\n        id: databaseId,\n        ...(version ? { version } : {}),\n      });\n      if (res.database_info) {\n        setDatabaseInfo(res.database_info);\n        if (res.database_info.table_name) {\n          onIDECallback?.onUpdateDisplayName?.(res.database_info.table_name);\n          onIDECallback?.onStatusChange?.('normal');\n        }\n      } else {\n        onIDECallback?.onStatusChange?.('error');\n      }\n    } catch {\n      onIDECallback?.onStatusChange?.('error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Need a store, follow-up renovation\n  const isReadOnlyMode = databaseInfo.creator_id !== userId || !!version;\n\n  const tableInitData: DatabaseInitInfo = useMemo(\n    () => ({\n      tableId: databaseInfo.id || '',\n      name: databaseInfo.table_name || '',\n      desc: databaseInfo.table_desc || '',\n      icon_uri: databaseInfo.icon_uri || '',\n      readAndWriteMode: databaseInfo.rw_mode || BotTableRWMode.LimitedReadWrite,\n      tableMemoryList: databaseInfo.field_list || [],\n    }),\n    [databaseInfo],\n  );\n\n  const basicInitData: FormData = useMemo(\n    () => ({\n      name: databaseInfo.table_name || '',\n      description: databaseInfo.table_desc || '',\n      icon_uri: [\n        {\n          url: databaseInfo.icon_url || '',\n          uri: databaseInfo.icon_uri || '',\n          uid: databaseInfo.icon_uri || '',\n          isDefault: true,\n        },\n      ],\n    }),\n    [databaseInfo],\n  );\n\n  const handleEditBasicInfo = async (obj: UpdateDatabaseRequest) => {\n    const res = await MemoryApi.UpdateDatabase({\n      ...pick(databaseInfo, [\n        'id',\n        'icon_uri',\n        'table_name',\n        'table_desc',\n        'field_list',\n        'rw_mode',\n        'prompt_disabled',\n        'extra_info',\n      ]),\n      ...obj,\n    });\n    if (res?.database_info?.id) {\n      await fetchDatabaseInfo();\n      // update basicInfo callback\n      if (onAfterEditBasicInfo) {\n        onAfterEditBasicInfo();\n      }\n      // close basicInfo modal\n      if (basicInfoVisible) {\n        setBasicInfoVisible(false);\n      }\n    } else {\n      Toast.error('Update database failed');\n    }\n  };\n\n  const handleChangeDatabaseMode = async (mode: BotTableRWMode) => {\n    const res = await MemoryApi.UpdateDatabase({\n      ...databaseInfo,\n      rw_mode: mode,\n    });\n    if (res?.database_info?.id) {\n      await fetchDatabaseInfo();\n      // update basicInfo callback\n      if (onAfterEditBasicInfo) {\n        onAfterEditBasicInfo();\n      }\n    }\n  };\n\n  const handleEditTable = async () => {\n    await fetchDatabaseInfo();\n    // update basicInfo callback\n    if (onAfterEditBasicInfo) {\n      onAfterEditBasicInfo();\n    }\n  };\n\n  const handleBtnAction = () => {\n    if (onClickAddRemoveButton) {\n      try {\n        setBtnLoading(true);\n        onClickAddRemoveButton(\n          enterFrom === 'workflow' ? databaseId : databaseInfo?.draft_id,\n        );\n      } finally {\n        setBtnLoading(false);\n      }\n    }\n  };\n\n  useEffect(() => {\n    fetchDatabaseInfo();\n  }, []);\n\n  const fromLibrary = ['create', 'library'].includes(enterFrom);\n\n  return (\n    <>\n      <div\n        className={classNames(\n          'h-full w-full max-w-[100vw] flex flex-col overflow-hidden',\n          enterFrom === 'project'\n            ? 'coz-bg-max rounded-b-[8px] border-solid coz-stroke-primary'\n            : 'coz-bg-plus',\n        )}\n      >\n        {/* header */}\n        <div\n          className={classNames(\n            'flex flex-row items-center justify-between shrink-0',\n            fromLibrary\n              ? 'h-[40px] m-[24px]'\n              : 'h-[64px] px-[16px] py-[12px] border-0 border-b border-solid coz-stroke-primary',\n          )}\n        >\n          <div className=\"flex items-center gap-[8px]\">\n            {needHideCloseIcon ? null : (\n              <IconButton\n                color=\"secondary\"\n                icon={fromLibrary ? <IconCozArrowLeft /> : <IconCozCross />}\n                onClick={onClose}\n              />\n            )}\n            <CozAvatar\n              type=\"bot\"\n              color=\"grey\"\n              src={basicInitData.icon_uri?.[0]?.url}\n            />\n            <div className=\"flex flex-col\">\n              <div className=\"flex flex-row items-center gap-[2px] leading-none\">\n                <Typography.Text weight={500} fontSize=\"14px\">\n                  {basicInitData.name}\n                </Typography.Text>\n                {isReadOnlyMode ? null : (\n                  <IconButton\n                    size=\"mini\"\n                    color=\"secondary\"\n                    icon={<IconCozEdit className=\"coz-fg-secondary\" />}\n                    onClick={() => setBasicInfoVisible(true)}\n                  />\n                )}\n              </div>\n              <Typography.Text fontSize=\"12px\">\n                {basicInitData.description}\n              </Typography.Text>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-[8px]\">\n            <DatabaseModeSelect\n              disabled={isReadOnlyMode}\n              value={databaseInfo.rw_mode}\n              onChange={handleChangeDatabaseMode}\n            />\n            {enterFrom.includes('bot') || enterFrom === 'workflow' ? (\n              <Button\n                disabled={isReadOnlyMode}\n                loading={btnLoading}\n                onClick={handleBtnAction}\n              >\n                {addRemoveButtonText}\n              </Button>\n            ) : null}\n          </div>\n        </div>\n        {/* content */}\n        <div\n          className={classNames(\n            'grow overflow-hidden',\n            fromLibrary ? 'mx-[24px]' : 'mx-[16px]',\n          )}\n        >\n          <TabBar\n            className={styles.tab}\n            type=\"text\"\n            align=\"left\"\n            tabBarExtraContent={\n              <Space spacing={16}>\n                <DatabaseDetailWaring />\n                {activeKey === DatabaseTabs.Structure ? (\n                  <Button\n                    data-testid={BotE2e.BotDatabaseEditTableStructureBtn}\n                    onClick={() => setCreateTableVisible(true)}\n                    icon={<IconCozEdit />}\n                    color=\"highlight\"\n                    disabled={isReadOnlyMode}\n                  >\n                    {I18n.t('db_new_0003')}\n                  </Button>\n                ) : null}\n              </Space>\n            }\n            tabBarClassName=\"flex flex-row items-center w-full\"\n            activeKey={activeKey}\n            onChange={(key: string) => setActiveKey(key as DatabaseTabs)}\n            lazyRender\n          >\n            <TabBar.TabPanel\n              tab={I18n.t('db_new_0001')}\n              itemKey={DatabaseTabs.Structure}\n            >\n              <DatabaseTableStructureReadonly\n                loading={loading}\n                fieldList={databaseInfo.field_list ?? []}\n              />\n            </TabBar.TabPanel>\n            <TabBar.TabPanel\n              tab={I18n.t('db_optimize_009')}\n              itemKey={DatabaseTabs.Draft}\n              disabled={!!version}\n            >\n              <DismissibleBanner\n                type=\"info\"\n                persistentKey=\"_coze_database_draft_data_warning\"\n              >\n                {I18n.t('db_optimize_010')}\n              </DismissibleBanner>\n              <DatabaseTableData\n                databaseId={databaseId}\n                tableType={TableType.DraftTable}\n                tableFields={databaseInfo.field_list || []}\n                // Test data does not require control rights, as long as the data can be seen, it can be modified and deleted\n                isReadonlyMode={false}\n                enterFrom={enterFrom}\n                onAfterEditRecords={onAfterEditRecords}\n              />\n            </TabBar.TabPanel>\n            <TabBar.TabPanel\n              tab={I18n.t('db_new_0002')}\n              itemKey={DatabaseTabs.Online}\n              disabled={!!version}\n            >\n              <DismissibleBanner\n                type=\"info\"\n                persistentKey=\"_coze_database_online_data_warning\"\n              >\n                {I18n.t('database_optimize_200')}\n              </DismissibleBanner>\n              <DatabaseTableData\n                databaseId={databaseId}\n                tableType={TableType.OnlineTable}\n                tableFields={databaseInfo.field_list || []}\n                isReadonlyMode={isReadOnlyMode}\n                enterFrom={enterFrom}\n                onAfterEditRecords={onAfterEditRecords}\n              />\n            </TabBar.TabPanel>\n          </TabBar>\n        </div>\n      </div>\n      <DatabaseBaseInfoModal\n        visible={basicInfoVisible}\n        onSubmit={formData =>\n          handleEditBasicInfo({\n            table_name: formData.name,\n            icon_uri: formData.icon_uri?.[0]?.uri,\n            table_desc: formData.description,\n          })\n        }\n        initValues={basicInitData}\n        mode={ModalMode.EDIT}\n        onClose={() => setBasicInfoVisible(false)}\n      />\n      <DatabaseCreateTableModal\n        visible={createTableVisible}\n        initValue={tableInitData}\n        onSubmit={handleEditTable}\n        showDatabaseBaseInfo={false}\n        onlyShowDatabaseInfoRWMode={true}\n        onReturn={() => setCreateTableVisible(false)}\n        onClose={() => setCreateTableVisible(false)}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNavigate } from 'react-router-dom';\nimport React, { useMemo, useState } from 'react';\n\nimport { useDataCallbacks } from '@coze-data/knowledge-stores';\nimport { type DatabaseTabs } from '@coze-data/database-v2-base/types';\nimport { I18n } from '@coze-arch/i18n';\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { DatabaseDetail } from '../../components/database-detail';\n\ninterface IProps {\n  version?: string;\n  botId: string;\n  spaceId?: string;\n  databaseId: string;\n  enterFrom: string;\n  needHideCloseIcon?: boolean;\n  initialTab?: DatabaseTabs;\n}\n\nexport const DatabaseInner = ({\n  version,\n  botId,\n  spaceId,\n  databaseId,\n  enterFrom,\n  needHideCloseIcon,\n  initialTab,\n}: IProps) => {\n  const { onStatusChange, onUpdateDisplayName } = useDataCallbacks();\n  const navigate = useNavigate();\n  const [actionText, setActionText] = useState<string>(\n    enterFrom === 'bot_add' ? 'Add' : 'Remove',\n  );\n\n  const handleAddDatabase = async (id: string) => {\n    const res = await MemoryApi.BindDatabase({\n      database_id: id,\n      bot_id: botId,\n    });\n    if (res.code === 0) {\n      Toast.success('Add database success');\n      setActionText('Remove');\n    } else {\n      Toast.error(res.msg);\n    }\n  };\n\n  const handleRemoveDatabase = async (id: string) => {\n    const res = await MemoryApi.UnBindDatabase({\n      database_id: id,\n      bot_id: botId,\n    });\n    if (res.code === 0) {\n      Toast.success('Remove database success');\n      setActionText('Add');\n    } else {\n      Toast.error(res.msg);\n    }\n  };\n\n  const handleAddRemoveDatabase = (id?: string) => {\n    if (!id) {\n      return;\n    }\n    if (actionText === 'Add') {\n      handleAddDatabase(id);\n    } else if (actionText === 'Remove') {\n      handleRemoveDatabase(id);\n    } else {\n      return;\n    }\n  };\n\n  const handleClose = () => {\n    if (window.history.length === 1) {\n      navigate(`/space/${spaceId}/library`);\n    }\n    navigate(-1);\n  };\n\n  const addRemoveButtonText = useMemo(() => {\n    if (actionText === 'Add') {\n      return I18n.t('db2_030');\n    } else if (actionText === 'Remove') {\n      return I18n.t('db2_031');\n    } else {\n      return '';\n    }\n  }, [actionText]);\n\n  return (\n    <DatabaseDetail\n      version={version}\n      enterFrom={enterFrom}\n      databaseId={databaseId}\n      initialTab={initialTab}\n      addRemoveButtonText={addRemoveButtonText}\n      onIDECallback={{\n        onStatusChange,\n        onUpdateDisplayName,\n      }}\n      onClickAddRemoveButton={handleAddRemoveDatabase}\n      needHideCloseIcon={needHideCloseIcon}\n      onClose={handleClose}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useKnowledgeParams } from '@coze-data/knowledge-stores';\nimport { type DatabaseTabs } from '@coze-data/database-v2-base/types';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\n\nimport { DatabaseInner } from '../library';\n\nexport interface DatabaseDetailProps {\n  needHideCloseIcon?: boolean;\n  initialTab?: DatabaseTabs;\n  version?: string;\n}\n\nexport const DatabaseDetail = ({\n  version,\n  needHideCloseIcon,\n  initialTab,\n}: DatabaseDetailProps) => {\n  const params = useKnowledgeParams();\n  const { botID, tableID, biz } = params;\n  const spaceId = useSpaceStore(store => store.getSpaceId());\n\n  if (!tableID) {\n    return <div>no database id!</div>;\n    // return null;\n  }\n\n  return (\n    <DatabaseInner\n      version={version}\n      botId={botID ?? ''}\n      databaseId={tableID}\n      needHideCloseIcon={needHideCloseIcon}\n      enterFrom={biz ?? ''}\n      spaceId={spaceId ?? ''}\n      initialTab={initialTab ?? (params.initialTab as DatabaseTabs)}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type RuleItem } from '@coze-arch/bot-semi/Form';\n\nexport const REAL_DATA_ID = '0';\n\nexport const REAL_DATA_MOCKSET = {\n  id: REAL_DATA_ID,\n  name: I18n.t('real_data'),\n};\n\n// Initialization only real_data\nexport const MOCK_OPTION_LIST = [REAL_DATA_MOCKSET];\n\nexport const POLLING_INTERVAL = 10000;\n\nexport const DELAY_TIME = 2000;\n\nexport const CONNECTOR_ID = '10000010';\n\nexport const mockSetInfoRules: {\n  name: Array<RuleItem>;\n  desc: Array<RuleItem>;\n} = {\n  name: [\n    {\n      required: true,\n      message: I18n.t('please_enter_mockset_name'),\n    },\n    IS_OVERSEA\n      ? {\n          pattern: /^[\\w\\s]+$/,\n          message: I18n.t('create_plugin_modal_nameerror'),\n        }\n      : {\n          pattern: /^[\\w\\s\\u4e00-\\u9fa5]+$/u, // Increased domestic support for Chinese\n          message: I18n.t('create_plugin_modal_nameerror_cn'),\n        },\n  ],\n  desc: IS_OVERSEA\n    ? [\n        {\n          // eslint-disable-next-line no-control-regex -- regex\n          pattern: /^[\\x00-\\x7F]+$/,\n          message: I18n.t('create_plugin_modal_descrip_error'),\n        },\n      ]\n    : [],\n};\n\nexport const MOCK_SET_ERR_CODE = {\n  REPEAT_NAME: 600303100,\n};\n\nexport enum MockTrafficEnabled {\n  DISABLE = 0,\n  ENABLE = 1,\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type CSSProperties } from 'react';\n\nimport {\n  type OptionProps,\n  type optionRenderProps,\n} from '@coze-arch/bot-semi/Select';\nimport {\n  type BizCtx,\n  type MockSet,\n  type ComponentSubject,\n} from '@coze-arch/bot-api/debugger_api';\n\nexport interface BizCtxInfo\n  extends Omit<BizCtx, 'connectorID' | 'connectorUID' | 'ext'> {\n  ext?: { mockSubjectInfo?: string } & Record<string, string>;\n}\n\nexport type BindSubjectInfo = ComponentSubject & { detail?: BindSubjectDetail };\n\nexport interface BasicMockSetInfo {\n  bindSubjectInfo: ComponentSubject;\n  bizCtx: BizCtx;\n}\n\nexport interface BindSubjectDetail {\n  name?: string;\n}\nexport interface MockSetSelectProps {\n  bindSubjectInfo: BindSubjectInfo;\n  bizCtx: BizCtxInfo;\n  className?: string;\n  style?: CSSProperties;\n  readonly?: boolean;\n}\n\nexport enum MockSetStatus {\n  Incompatible = 'Incompatible',\n  Normal = 'Normal',\n}\n\nexport interface MockSelectOptionProps extends OptionProps {\n  detail?: MockSet;\n}\n\nexport interface MockSelectRenderOptionProps extends optionRenderProps {\n  detail?: MockSet;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PluginMockDataGenerateMode } from '@coze-arch/bot-tea';\n\nconst LOCAL_STORAGE_KEY = 'mockset_auto_generate_latest_choice';\n\nlet latestAutoGenerationChoice = PluginMockDataGenerateMode.MANUAL;\n\nasync function getFromLocalStorage() {\n  const info = await localStorage.getItem(LOCAL_STORAGE_KEY);\n  if (Number(info) === PluginMockDataGenerateMode.LLM) {\n    latestAutoGenerationChoice = PluginMockDataGenerateMode.LLM;\n  } else {\n    latestAutoGenerationChoice = PluginMockDataGenerateMode.RANDOM;\n  }\n\n  if (!info || Number.isNaN(Number(info))) {\n    localStorage.setItem(\n      LOCAL_STORAGE_KEY,\n      String(PluginMockDataGenerateMode.RANDOM),\n    );\n  }\n  return latestAutoGenerationChoice;\n}\n\nexport function getLatestAutoGenerationChoice() {\n  if (latestAutoGenerationChoice === PluginMockDataGenerateMode.MANUAL) {\n    return getFromLocalStorage();\n  } else {\n    return latestAutoGenerationChoice;\n  }\n}\n\nexport function setLatestAutoGenerationChoice(\n  choice: PluginMockDataGenerateMode.RANDOM | PluginMockDataGenerateMode.LLM,\n) {\n  latestAutoGenerationChoice = choice;\n  localStorage.setItem(LOCAL_STORAGE_KEY, String(choice));\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { PluginMockDataGenerateMode } from '@coze-arch/bot-tea';\nimport { RadioGroup, Radio, InputNumber } from '@coze-arch/bot-semi';\n// eslint-disable-next-line no-restricted-imports\nimport { type RadioChangeEvent } from '@douyinfe/semi-ui/lib/es/radio';\n\nimport {\n  getLatestAutoGenerationChoice,\n  setLatestAutoGenerationChoice,\n} from '../../utils/auto-generate-storage';\n\nimport style from './index.module.less';\n\ninterface AutoGenerateSelectProps {\n  showLabel?: boolean;\n  enableMulti?: boolean;\n  defaultCount?: number;\n  onChange?: (mode: AutoGenerateConfig) => void;\n  onInit?: (mode: AutoGenerateConfig) => void;\n}\n\nexport interface AutoGenerateConfig {\n  generateMode: PluginMockDataGenerateMode;\n  generateCount?: number;\n}\n\nexport function AutoGenerateSelect({\n  showLabel,\n  enableMulti,\n  defaultCount,\n  onChange,\n  onInit,\n}: AutoGenerateSelectProps) {\n  const [config, setConfig] = useState<AutoGenerateConfig>({\n    generateMode: PluginMockDataGenerateMode.MANUAL,\n    generateCount: defaultCount || 1,\n  });\n\n  const onSelectChange = (e: RadioChangeEvent) => {\n    const updatedConfig = { ...config, generateMode: e.target.value };\n    setLatestAutoGenerationChoice(e.target.value);\n    setConfig(updatedConfig);\n    onChange?.(updatedConfig);\n  };\n\n  const initMode = async () => {\n    const m = await getLatestAutoGenerationChoice();\n    const initConfig = { ...config, generateMode: m };\n    setConfig(initConfig);\n    onInit?.(initConfig);\n  };\n\n  useEffect(() => {\n    initMode();\n  }, []);\n\n  return (\n    <div className={style['auto-generate-select']}>\n      {showLabel ? (\n        <h4 className={style['auto-generate-label']}>\n          {I18n.t('plugin_creation_method')}\n        </h4>\n      ) : null}\n\n      <RadioGroup\n        type=\"card\"\n        value={config.generateMode}\n        onChange={onSelectChange}\n      >\n        <Radio\n          className={style['auto-generate-radio']}\n          value={PluginMockDataGenerateMode.RANDOM}\n          extra={I18n.t('generate_randomly_based_on_data_type_name')}\n        >\n          {I18n.t('randomlymode')}\n        </Radio>\n        <Radio\n          className={style['auto-generate-radio']}\n          value={PluginMockDataGenerateMode.LLM}\n          extra={I18n.t('intelligently_generated_by_large_language_model')}\n        >\n          {I18n.t('llm_mode')}\n        </Radio>\n      </RadioGroup>\n\n      {enableMulti && showLabel ? (\n        <h4 className={style['auto-generate-label']}>\n          {I18n.t('mock_data_quantity')}\n        </h4>\n      ) : null}\n\n      {enableMulti ? (\n        <InputNumber\n          value={config.generateCount}\n          max={5}\n          min={1}\n          onChange={e => {\n            if (!Number.isNaN(Number(e))) {\n              const updatedConfig = { ...config, generateCount: Number(e) };\n              setConfig(updatedConfig);\n              onChange?.(updatedConfig);\n            }\n          }}\n        />\n      ) : null}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isEqual } from 'lodash-es';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport {\n  type BizCtx,\n  type ComponentSubject,\n  TrafficScene,\n  type MockSet,\n} from '@coze-arch/bot-api/debugger_api';\n\nimport { type BasicMockSetInfo, type BizCtxInfo } from '../interface';\nimport { REAL_DATA_MOCKSET } from '../const';\n\nexport function isRealData(mockSet: MockSet) {\n  return mockSet.id === REAL_DATA_MOCKSET.id;\n}\n\nexport function isCurrent(sItem: BasicMockSetInfo, tItem: BasicMockSetInfo) {\n  const { bindSubjectInfo: mockSubject, bizCtx } = sItem;\n  const { bindSubjectInfo: compSubject, bizCtx: compBizCtx } = tItem;\n  const isCurrentComponent = isEqual(mockSubject, compSubject);\n  const { ext, ...baseBizCtx } = bizCtx || {};\n  const { ext: compExt, ...baseCompBizCxt } = compBizCtx || {};\n  const isCurrentScene = isSameScene(baseBizCtx, baseCompBizCxt);\n  const isWorkflowExt =\n    bizCtx?.trafficScene !== TrafficScene.CozeWorkflowDebug ||\n    isSameWorkflowTool(\n      ext?.mockSubjectInfo || '',\n      compExt?.mockSubjectInfo || '',\n    );\n  return isCurrentComponent && isCurrentScene && isWorkflowExt;\n}\n\nexport function isSameWorkflowTool(\n  sMockSubjectInfo: string,\n  tMockSubjectInfo: string,\n) {\n  const sMockInfo = safeJSONParse(sMockSubjectInfo || '{}');\n  const tMockInfo = safeJSONParse(tMockSubjectInfo || '{}');\n  return isEqual(sMockInfo, tMockInfo);\n}\nexport function isSameScene(sBizCtx: BizCtx, tBizCtx: BizCtx) {\n  return (\n    sBizCtx.bizSpaceID === tBizCtx.bizSpaceID &&\n    sBizCtx.trafficScene === tBizCtx.trafficScene &&\n    sBizCtx.trafficCallerID === tBizCtx.trafficCallerID\n  );\n}\n\nexport function getPluginInfo(\n  bizCtx: BizCtxInfo,\n  mockSubjectInfo: ComponentSubject,\n): { spaceID?: string; pluginID?: string; toolID?: string } {\n  const { bizSpaceID, ext, trafficScene } = bizCtx || {};\n  const extMockSubjectInfo = safeJSONParse(ext?.mockSubjectInfo || '{}');\n  const { componentID, parentComponentID } = mockSubjectInfo;\n  switch (trafficScene) {\n    case TrafficScene.CozeWorkflowDebug:\n      return {\n        spaceID: bizSpaceID,\n        toolID: extMockSubjectInfo?.componentID,\n        pluginID: extMockSubjectInfo?.parentComponentID,\n      };\n    case TrafficScene.CozeSingleAgentDebug:\n    case TrafficScene.CozeMultiAgentDebug:\n    case TrafficScene.CozeToolDebug:\n    default:\n      return {\n        spaceID: bizSpaceID,\n        toolID: componentID,\n        pluginID: parentComponentID,\n      };\n  }\n}\n\nexport function getMockSubjectInfo(\n  bizCtx: BizCtxInfo,\n  mockSubjectInfo: ComponentSubject,\n) {\n  const { ext, trafficScene } = bizCtx || {};\n  const extMockSubjectInfo = safeJSONParse(ext?.mockSubjectInfo || '{}');\n  switch (trafficScene) {\n    case TrafficScene.CozeWorkflowDebug:\n      return extMockSubjectInfo;\n    case TrafficScene.CozeSingleAgentDebug:\n    case TrafficScene.CozeMultiAgentDebug:\n    case TrafficScene.CozeToolDebug:\n    default:\n      return mockSubjectInfo;\n  }\n}\n\nexport function getEnvironment() {\n  if (!IS_PROD) {\n    return 'cn-boe';\n  }\n  const regionPart = IS_OVERSEA ? 'oversea' : 'cn';\n  const inhousePart = IS_RELEASE_VERSION ? 'release' : 'inhouse';\n\n  return [regionPart, inhousePart].join('-');\n}\n\nexport function getUsedScene(scene?: TrafficScene): 'bot' | 'agent' | 'flow' {\n  switch (scene) {\n    case TrafficScene.CozeSingleAgentDebug:\n      return 'bot';\n    case TrafficScene.CozeMultiAgentDebug:\n      return 'agent';\n    case TrafficScene.CozeWorkflowDebug:\n      return 'flow';\n    case TrafficScene.CozeToolDebug:\n      return 'bot';\n    default:\n      return 'bot';\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function -- migrating code */\nimport { useRef } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { PluginMockDataGenerateMode } from '@coze-arch/bot-tea';\nimport {\n  EVENT_NAMES,\n  sendTeaEvent,\n  type ParamsTypeDefine,\n} from '@coze-arch/bot-tea';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport { Form, UIFormTextArea, UIModal, UIToast } from '@coze-arch/bot-semi';\nimport { type ApiError, isApiError } from '@coze-arch/bot-http';\nimport { useFlags } from '@coze-arch/bot-flags';\nimport { SpaceType } from '@coze-arch/bot-api/developer_api';\nimport { type MockSet } from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\n\nimport {\n  type AutoGenerateConfig,\n  AutoGenerateSelect,\n} from '../auto-generate-select';\nimport { getEnvironment, getMockSubjectInfo, getPluginInfo } from '../../utils';\nimport { type BasicMockSetInfo } from '../../interface';\nimport { MOCK_SET_ERR_CODE, mockSetInfoRules } from '../../const';\n\nimport styles from './index.module.less';\n\nexport interface EditMockSetInfo\n  extends BasicMockSetInfo,\n    Partial<AutoGenerateConfig> {\n  id?: string;\n  name?: string;\n  desc?: string;\n  autoGenerate?: boolean;\n}\n\nexport interface MockSetEditModalProps {\n  visible?: boolean;\n  zIndex?: number;\n  disabled?: boolean;\n  initialInfo: EditMockSetInfo;\n  onSuccess?: (\n    mockSetInfo?: MockSet,\n    autoGenerateConfig?: AutoGenerateConfig,\n  ) => void;\n  onCancel?: () => void;\n  needResetPopoverContainer?: boolean;\n}\n\nfunction getRandomName(toolName?: string): string | undefined {\n  if (!toolName) {\n    return undefined;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  const num = Math.floor(Math.random() * 90 + 10);\n  return `${toolName} mockset${num}`;\n}\n\nexport const MockSetEditModal = ({\n  visible,\n  zIndex,\n  disabled,\n  initialInfo,\n  onSuccess,\n  onCancel,\n  needResetPopoverContainer,\n}: MockSetEditModalProps) => {\n  const formApiRef = useRef<FormApi<EditMockSetInfo>>();\n\n  const [FLAGS] = useFlags();\n\n  // Determine whether to create a scene based on whether to pass in the id\n  const isCreate = !initialInfo.id;\n\n  // Space information\n  const spaceType = useSpaceStore(s => s.space.space_type);\n  const isPersonal = spaceType === SpaceType.Personal;\n\n  const handleAutoGenerateSelect = (config: AutoGenerateConfig) => {\n    formApiRef.current?.setValue?.('generateMode', String(config.generateMode));\n    formApiRef.current?.setValue?.(\n      'generateCount',\n      String(config.generateCount),\n    );\n  };\n\n  const handleSubmit = async (formValues: EditMockSetInfo) => {\n    const {\n      id: existingId,\n      name,\n      desc,\n      bindSubjectInfo,\n      bizCtx,\n      autoGenerate,\n      generateMode,\n      generateCount,\n    } = formValues;\n    const { toolID, spaceID } = getPluginInfo(bizCtx, bindSubjectInfo);\n    const basicParams: ParamsTypeDefine[EVENT_NAMES.create_mockset_front] = {\n      environment: getEnvironment(),\n      workspace_id: spaceID || '',\n      workspace_type: isPersonal ? 'personal_workspace' : 'team_workspace',\n      tool_id: toolID || '',\n      status: 1,\n      mock_set_id: '',\n      auto_gen_mode: !autoGenerate\n        ? PluginMockDataGenerateMode.MANUAL\n        : Number(generateMode) || PluginMockDataGenerateMode.RANDOM,\n      mock_counts: 1,\n    };\n    try {\n      const { id } = await debuggerApi.SaveMockSet(\n        {\n          name,\n          description: desc,\n          mockSubject: getMockSubjectInfo(bizCtx, bindSubjectInfo),\n          bizCtx,\n          id: existingId || '0',\n        },\n        { __disableErrorToast: true },\n      );\n      onSuccess?.(\n        { id, name, description: desc },\n        autoGenerate\n          ? {\n              generateMode: Number(generateMode),\n              generateCount: Number(generateCount),\n            }\n          : undefined,\n      );\n      sendTeaEvent(EVENT_NAMES.create_mockset_front, {\n        ...basicParams,\n        status: 0,\n        mock_set_id: String(id) || '',\n      });\n    } catch (e) {\n      const { message } = (e as Error | undefined) || {};\n      const reportParams: ParamsTypeDefine[EVENT_NAMES.create_mockset_front] = {\n        ...basicParams,\n        status: 1,\n        error: message,\n        error_type: 'unknown',\n      };\n\n      if (isApiError(e)) {\n        const { code } = (e as ApiError) || {};\n\n        if (Number(code) === MOCK_SET_ERR_CODE.REPEAT_NAME) {\n          formApiRef.current?.setError('name', I18n.t('name_already_taken'));\n          sendTeaEvent(EVENT_NAMES.create_mockset_front, {\n            ...reportParams,\n            error_type: 'repeat_name',\n          });\n          return;\n        }\n      }\n\n      if (message) {\n        UIToast.error(message);\n      }\n\n      sendTeaEvent(EVENT_NAMES.create_mockset_front, {\n        ...reportParams,\n        error_type: 'unknown',\n      });\n    }\n  };\n\n  const handleOk = async () => {\n    await formApiRef.current?.submitForm();\n  };\n\n  return (\n    <UIModal\n      type=\"action-small\"\n      zIndex={zIndex}\n      title={`${isCreate ? I18n.t('create_mockset') : I18n.t('edit_mockset')}`}\n      visible={visible}\n      getPopupContainer={\n        needResetPopoverContainer ? () => document.body : undefined\n      }\n      onCancel={onCancel}\n      okButtonProps={{\n        onClick: handleOk,\n        disabled,\n      }}\n    >\n      <Form<EditMockSetInfo>\n        getFormApi={api => (formApiRef.current = api)}\n        showValidateIcon={false}\n        initValues={\n          isCreate\n            ? { ...initialInfo, name: getRandomName(initialInfo.name) }\n            : initialInfo\n        }\n        onSubmit={values => handleSubmit(values)}\n        className={styles['mockset-create-form']}\n      >\n        {({ formState }) => (\n          <>\n            {/* mockSet name */}\n            {disabled ? (\n              <Form.Slot\n                label={{\n                  text: I18n.t('mockset_name'),\n                  required: true,\n                }}\n              >\n                <div>{initialInfo?.name}</div>\n              </Form.Slot>\n            ) : (\n              <UIFormTextArea\n                field=\"name\"\n                label={I18n.t('mockset_name')}\n                placeholder={I18n.t('good_mockset_name_descriptive_concise')}\n                trigger={['blur', 'change']}\n                maxCount={50}\n                maxLength={50}\n                rows={1}\n                onBlur={() => {\n                  formApiRef.current?.setValue(\n                    'name',\n                    formApiRef.current?.getValue('name')?.trim(),\n                  );\n                }}\n                rules={mockSetInfoRules.name}\n              />\n            )}\n            {/* mockSet description */}\n            {disabled ? (\n              <Form.Slot\n                label={{\n                  text: I18n.t('mockset_description'),\n                }}\n              >\n                <div>{initialInfo?.desc}</div>\n              </Form.Slot>\n            ) : (\n              <UIFormTextArea\n                field=\"desc\"\n                label={{\n                  text: I18n.t('mockset_description'),\n                }}\n                trigger={['blur', 'change']}\n                placeholder={I18n.t('describe_use_scenarios_of_mockset')}\n                rows={2}\n                maxCount={2000}\n                maxLength={2000}\n                rules={mockSetInfoRules.desc}\n                onBlur={() => {\n                  formApiRef.current?.setValue(\n                    'desc',\n                    formApiRef.current?.getValue('desc')?.trim(),\n                  );\n                }}\n              />\n            )}\n            {/* Phase II supports autoGenerate*/}\n            {/* The community edition does not support this function for the time being */}\n            {isCreate && FLAGS['bot.devops.mockset_auto_generate'] ? (\n              <>\n                <Form.Checkbox\n                  field=\"autoGenerate\"\n                  noLabel\n                  disabled={disabled}\n                  className={styles['auto-generate-checkbox']}\n                >\n                  {I18n.t('auto_generate')}\n                </Form.Checkbox>\n                {formState.values.autoGenerate ? (\n                  <AutoGenerateSelect\n                    onInit={handleAutoGenerateSelect}\n                    onChange={handleAutoGenerateSelect}\n                  />\n                ) : null}\n              </>\n            ) : null}\n          </>\n        )}\n      </Form>\n    </UIModal>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  EVENT_NAMES,\n  sendTeaEvent,\n  type ParamsTypeDefine,\n} from '@coze-arch/bot-tea';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { UIModal } from '@coze-arch/bot-semi';\nimport { SpaceType } from '@coze-arch/bot-api/developer_api';\nimport {\n  type BizCtx,\n  type MockSet,\n  type ComponentSubject,\n} from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\nimport { IconAlertCircle } from '@douyinfe/semi-icons';\n\nimport { getEnvironment, getPluginInfo } from '../../utils';\n\nexport interface MockSetInfo {\n  detail: MockSet;\n  ctx?: {\n    mockSubjectInfo?: ComponentSubject;\n    bizCtx?: BizCtx;\n  };\n}\n\nexport interface MockSetEditModalProps {\n  visible: boolean;\n  zIndex?: number;\n  mockSetInfo: MockSetInfo;\n  onSuccess?: () => void;\n  onCancel?: () => void;\n  needResetPopoverContainer?: boolean;\n}\n\nfunction isValidRefCount(refCount: number) {\n  return refCount >= 0;\n}\n\nexport const MockSetDeleteModal = ({\n  visible,\n  mockSetInfo,\n  onSuccess,\n  onCancel,\n  zIndex,\n  needResetPopoverContainer,\n}: MockSetEditModalProps) => {\n  const {\n    detail: { id },\n    ctx,\n  } = mockSetInfo || {};\n  const [mockSetRefCount, setMockSetRefCount] = useState(-1);\n\n  // Space information\n  const spaceType = useSpaceStore(s => s.space.space_type);\n  const isPersonal = spaceType === SpaceType.Personal;\n\n  const { run: fetchRefInfo } = useRequest(\n    async () => {\n      const { spaceID } = getPluginInfo(\n        ctx?.bizCtx || {},\n        ctx?.mockSubjectInfo || {},\n      );\n      try {\n        const { usersUsageCount } = await debuggerApi.GetMockSetUsageInfo({\n          mockSetID: id,\n          spaceID,\n        });\n        setMockSetRefCount(Number(usersUsageCount ?? 0));\n      } catch (e) {\n        logger.error({\n          error: e as Error,\n          eventName: 'fetch_mockset_ref_fail',\n        });\n        setMockSetRefCount(0);\n      }\n    },\n    {\n      manual: true,\n    },\n  );\n  useEffect(() => {\n    fetchRefInfo();\n  }, [mockSetInfo]);\n\n  const renderTitle =\n    mockSetRefCount > 0\n      ? I18n.t('people_using_mockset_delete', { num: mockSetRefCount })\n      : I18n.t('delete_the_mockset');\n\n  const handleOk = async () => {\n    const { toolID, spaceID } = getPluginInfo(\n      ctx?.bizCtx || {},\n      ctx?.mockSubjectInfo || {},\n    );\n    const basicParams: ParamsTypeDefine[EVENT_NAMES.del_mockset_front] = {\n      environment: getEnvironment(),\n      workspace_id: spaceID || '',\n      workspace_type: isPersonal ? 'personal_workspace' : 'team_workspace',\n      tool_id: toolID || '',\n      mock_set_id: String(id) || '',\n      status: 1,\n    };\n    try {\n      id && (await debuggerApi.DeleteMockSet({ id, bizCtx: ctx?.bizCtx }));\n      onSuccess?.();\n      sendTeaEvent(EVENT_NAMES.del_mockset_front, {\n        ...basicParams,\n        status: 0,\n      });\n    } catch (e) {\n      sendTeaEvent(EVENT_NAMES.del_mockset_front, {\n        ...basicParams,\n        status: 1,\n        error: (e as Error | undefined)?.message as string,\n      });\n    }\n  };\n  return (\n    <UIModal\n      type=\"info\"\n      zIndex={zIndex}\n      icon={\n        <IconAlertCircle\n          size=\"extra-large\"\n          className=\"inline-flex text-[#FF2710]\"\n        />\n      }\n      title={renderTitle}\n      visible={isValidRefCount(mockSetRefCount) && visible}\n      onCancel={onCancel}\n      onOk={handleOk}\n      getPopupContainer={\n        needResetPopoverContainer ? () => document.body : undefined\n      }\n      okType=\"danger\"\n    >\n      {I18n.t('operation_cannot_be_reversed')}\n    </UIModal>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { create } from 'zustand';\nimport { produce } from 'immer';\nimport {\n  type BizCtx,\n  type MockSet,\n  type MockSetBinding,\n} from '@coze-arch/bot-api/debugger_api';\n\nimport { isCurrent } from '../utils';\nimport { type BasicMockSetInfo } from '../interface';\n\nexport interface EnabledMockSetInfo {\n  mockSetBinding: MockSetBinding;\n  mockSetDetail?: MockSet;\n}\n\ninterface MockInfoStoreState {\n  bizCtx: BizCtx;\n  enabledMockSetInfo: Array<EnabledMockSetInfo>;\n  isPolling: boolean;\n  isLoading: boolean;\n  currentMockComp: Array<BasicMockSetInfo>;\n  timer?: NodeJS.Timeout;\n  restartTimer?: NodeJS.Timeout;\n}\n\ninterface MockInfoStoreAction {\n  setPolling: (polling: boolean) => void;\n  setLoading: (loading: boolean) => void;\n  setCurrentBizCtx: (bizCtx: BizCtx) => void;\n  setEnabledMockSetInfo: (mockSetList?: Array<EnabledMockSetInfo>) => void;\n  removeMockComp: (mockComp: BasicMockSetInfo) => number;\n  addMockComp: (mockComp: BasicMockSetInfo) => number;\n  setTimer: (timer?: NodeJS.Timeout) => void;\n  setRestartTimer: (timer?: NodeJS.Timeout) => void;\n}\n\nexport const useMockInfoStore = create<\n  MockInfoStoreState & MockInfoStoreAction\n>((set, get) => ({\n  bizCtx: {},\n  enabledMockSetInfo: [],\n  isPolling: false,\n  isLoading: false,\n  currentMockComp: [],\n  setPolling: polling => {\n    set({ isPolling: polling });\n  },\n  setLoading: loading => {\n    set({ isLoading: loading });\n  },\n  setCurrentBizCtx: bizCtx => {\n    set({ bizCtx });\n  },\n  setEnabledMockSetInfo: enabledMockSetInfo => {\n    set({ enabledMockSetInfo });\n  },\n  addMockComp: mockSetInfo => {\n    set(\n      produce<MockInfoStoreState>(s => {\n        const index = s.currentMockComp.findIndex(item =>\n          isCurrent(item, mockSetInfo),\n        );\n        index <= -1 && s.currentMockComp.push(mockSetInfo);\n      }),\n    );\n    return get().currentMockComp.length;\n  },\n  removeMockComp: mockSetInfo => {\n    set(\n      produce<MockInfoStoreState>(s => {\n        const index = s.currentMockComp.findIndex(item =>\n          isCurrent(item, mockSetInfo),\n        );\n        if (index > -1) {\n          s.currentMockComp.splice(index, 1);\n        }\n      }),\n    );\n    return get().currentMockComp.length;\n  },\n  setTimer: timer => {\n    set({ timer });\n  },\n  setRestartTimer: timer => {\n    set({ timer });\n  },\n}));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function -- code migration */\n/* eslint-disable @coze-arch/max-line-per-function -- code migration */\nimport { useEffect, useRef } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport axios, { type Canceler } from 'axios';\nimport { logger } from '@coze-arch/logger';\nimport {\n  type BizCtx,\n  type MockSet,\n  type MockSetBinding,\n} from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\n\nimport { isSameScene } from '../utils';\nimport { MockTrafficEnabled } from '../const';\nimport { type EnabledMockSetInfo, useMockInfoStore } from './store';\n\nfunction combineBindMockSetInfo(\n  mockSetBindingList: Array<MockSetBinding>,\n  mockSetDetailSet: Record<string, MockSet>,\n): Array<EnabledMockSetInfo> {\n  return mockSetBindingList.map(mockSetInfo => {\n    const { mockSetID } = mockSetInfo;\n    const detail = mockSetID ? mockSetDetailSet[mockSetID] : {};\n    return {\n      mockSetBinding: mockSetInfo,\n      mockSetDetail: detail,\n    };\n  });\n}\n\nexport const useInitialGetEnabledMockSet = ({\n  bizCtx,\n  pollingInterval,\n}: {\n  bizCtx: BizCtx;\n  pollingInterval?: number;\n}) => {\n  const {\n    enabledMockSetInfo,\n    setPolling,\n    setEnabledMockSetInfo,\n    bizCtx: currentBizCtx,\n    setCurrentBizCtx,\n    addMockComp,\n    removeMockComp,\n    isPolling,\n    setTimer,\n    timer,\n    currentMockComp,\n    setLoading,\n    isLoading,\n    restartTimer,\n    setRestartTimer,\n  } = useMockInfoStore();\n  const status = useRef<boolean>(false);\n  const lastRequestId = useRef(0);\n  const pollingTurnRef = useRef<string>();\n\n  const cancelReq = useRef<Canceler>();\n\n  const requestFn = async (curBizCtx: BizCtx) => {\n    const currentRequestId = ++lastRequestId.current;\n    const currentPollingTurn = pollingTurnRef.current;\n    try {\n      const { mockSetBindings = [], mockSetDetails = {} } =\n        await debuggerApi.MGetMockSetBinding(\n          {\n            bizCtx: curBizCtx,\n            needMockSetDetail: true,\n          },\n          {\n            headers: {\n              'rpc-persist-mock-traffic-enable': MockTrafficEnabled.ENABLE,\n            },\n            cancelToken: new axios.CancelToken(function executor(c) {\n              cancelReq.current = c;\n            }),\n          },\n        );\n\n      if (\n        (currentRequestId > 1 && currentRequestId !== lastRequestId.current) ||\n        !pollingTurnRef.current ||\n        pollingTurnRef.current !== currentPollingTurn\n      ) {\n        return;\n      }\n      setEnabledMockSetInfo?.(\n        combineBindMockSetInfo(mockSetBindings, mockSetDetails),\n      );\n      return { mockSetBindings, mockSetDetails };\n    } catch (e) {\n      if (axios.isCancel(e)) {\n        logger.info('poll_scene_mockset_canceled');\n      } else {\n        logger.error({\n          error: e as Error,\n          eventName: 'poll_scene_mockset_fail',\n        });\n      }\n    }\n  };\n\n  const request = async () => {\n    try {\n      const {\n        trafficCallerID,\n        connectorID,\n        connectorUID,\n        bizSpaceID,\n        trafficScene,\n      } = bizCtx;\n      !status.current && (status.current = true);\n      setLoading(true);\n      if (status.current && pollingInterval) {\n        setPolling(true);\n        const id = setTimeout(() => {\n          status.current && request();\n        }, pollingInterval);\n        setTimer(id);\n      }\n      await requestFn({\n        trafficCallerID,\n        connectorID,\n        connectorUID,\n        bizSpaceID,\n        trafficScene,\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // cancel\n  const cancel = () => {\n    pollingTurnRef.current = undefined;\n    cancelReq.current?.();\n    lastRequestId.current = 0;\n    cancelRestartTask();\n\n    if (timer) {\n      clearTimeout(timer);\n      setPolling(false);\n      setTimer(undefined);\n      status.current && (status.current = false);\n    }\n  };\n\n  const cancelRestartTask = () => {\n    if (restartTimer) {\n      clearTimeout(restartTimer);\n      setRestartTimer(undefined);\n    }\n  };\n\n  const start = async () => {\n    cancel();\n    pollingTurnRef.current = nanoid();\n    await request();\n  };\n\n  useEffect(() => {\n    if (currentBizCtx && isSameScene(bizCtx, currentBizCtx)) {\n      return;\n    }\n    setCurrentBizCtx(bizCtx);\n  }, [bizCtx]);\n\n  return {\n    start,\n    cancel,\n    isLoading,\n    data: enabledMockSetInfo,\n    addMockComp,\n    removeMockComp,\n    currentMockComp,\n    isPolling,\n    setRestartTimer,\n    restartTimer,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type CSSProperties } from 'react';\n\nimport classNames from 'classnames';\nimport { Typography, UIIconButton } from '@coze-arch/bot-semi';\nimport { IconDeleteOutline, IconEdit } from '@coze-arch/bot-icons';\nimport { IconEyeOpened, IconUploadError } from '@douyinfe/semi-icons';\n\nimport { MockSetStatus } from '../../interface';\n\nimport styles from './option-item.module.less';\n\nexport interface MockSetItemProps {\n  name: string;\n  onDelete?: () => void;\n  onView?: () => void;\n  status?: MockSetStatus;\n  creatorName?: string;\n  viewOnly?: boolean;\n  disableCreator?: boolean;\n  className?: string;\n  style?: CSSProperties;\n}\n\nexport const MockSetItem = ({\n  name,\n  onDelete,\n  onView,\n  status = MockSetStatus.Normal,\n  creatorName,\n  viewOnly,\n  disableCreator,\n  className,\n  style,\n}: MockSetItemProps) => {\n  const [isHover, setIsHover] = useState(false);\n  const renderExtraInfo = () => {\n    if (isHover) {\n      return (\n        <div\n          className={styles['operation-icon']}\n          onClick={e => e.stopPropagation()}\n        >\n          {viewOnly ? (\n            <UIIconButton onClick={onView} icon={<IconEyeOpened />} />\n          ) : (\n            <>\n              <UIIconButton\n                onClick={onView}\n                icon={<IconEdit />}\n                wrapperClass=\"mr-[4px]\"\n              />\n              <UIIconButton onClick={onDelete} icon={<IconDeleteOutline />} />\n            </>\n          )}\n        </div>\n      );\n    }\n    return disableCreator ? null : (\n      <Typography.Text\n        ellipsis={{\n          showTooltip: {\n            opts: { content: creatorName },\n          },\n        }}\n        className={styles['creator-name']}\n      >\n        {creatorName}\n      </Typography.Text>\n    );\n  };\n  return (\n    <div\n      className={classNames(styles['mock-select-item'], className)}\n      style={style}\n      onMouseEnter={() => {\n        setIsHover(true);\n      }}\n      onMouseLeave={() => setIsHover(false)}\n    >\n      <span className={styles['mock-main-info']}>\n        {status !== MockSetStatus.Normal && (\n          <IconUploadError className={styles['status-icon']} />\n        )}\n        <Typography.Text ellipsis={{}} className={styles['mock-name']}>\n          {name}\n        </Typography.Text>\n      </span>\n      <div className={styles['mock-extra-info']}>{renderExtraInfo()}</div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function -- migrating code */\n/* eslint-disable @typescript-eslint/no-explicit-any -- migrate code */\n/* eslint-disable max-lines -- migrate code */\n/* eslint-disable max-lines-per-function -- migrating code */\n\nimport {\n  useState,\n  useEffect,\n  useRef,\n  forwardRef,\n  type ForwardedRef,\n  useImperativeHandle,\n} from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useInViewport,\n  useInfiniteScroll,\n  useRequest,\n  useUnmount,\n} from 'ahooks';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  PluginMockDataGenerateMode,\n  sendTeaEvent,\n  type ParamsTypeDefine,\n  EVENT_NAMES,\n} from '@coze-arch/bot-tea';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\n// eslint-disable-next-line @coze-arch/no-pkg-dir-import\nimport { type SemiSelectActions } from '@coze-arch/bot-semi/src/components/ui-select';\nimport {\n  Spin,\n  UIToast,\n  Tooltip,\n  UIButton,\n  UISelect,\n} from '@coze-arch/bot-semi';\nimport { IconAdd } from '@coze-arch/bot-icons';\nimport { SceneType, usePageJumpService } from '@coze-arch/bot-hooks';\nimport { SpaceType } from '@coze-arch/bot-api/developer_api';\nimport {\n  TrafficScene,\n  infra,\n  type BizCtx,\n  type MockSet,\n} from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\nimport { IconTick, IconUploadError } from '@douyinfe/semi-icons';\n\nimport { MockSetEditModal } from '../mockset-edit-modal';\nimport { MockSetDeleteModal } from '../mockset-delete-modal';\nimport { type AutoGenerateConfig } from '../auto-generate-select';\nimport {\n  getEnvironment,\n  getMockSubjectInfo,\n  getPluginInfo,\n  getUsedScene,\n  isCurrent,\n  isRealData,\n} from '../../utils';\nimport {\n  type MockSelectOptionProps,\n  type MockSelectRenderOptionProps,\n  type MockSetSelectProps,\n  MockSetStatus,\n} from '../../interface';\nimport { useInitialGetEnabledMockSet } from '../../hooks/use-get-mockset';\nimport {\n  CONNECTOR_ID,\n  DELAY_TIME,\n  MOCK_OPTION_LIST,\n  POLLING_INTERVAL,\n  REAL_DATA_ID,\n  REAL_DATA_MOCKSET,\n} from '../../const';\nimport { MockSetItem } from './option-item';\n\nimport styles from './index.module.less';\n\nexport function getMockSetOption(mockSet: MockSet): MockSelectOptionProps {\n  const isInValid =\n    !isRealData(mockSet) &&\n    (mockSet?.schemaIncompatible || !mockSet?.mockRuleQuantity);\n  return {\n    value: mockSet?.id || '',\n    label: (\n      <Tooltip\n        key={mockSet?.id}\n        content={I18n.t('mockset_invaild_tip', { MockSetName: mockSet.name })}\n        style={{ display: isInValid ? 'block' : 'none' }}\n      >\n        <span\n          className={classNames(\n            'flex items-center w-[100%] min-w-0',\n            styles['select-label'],\n          )}\n        >\n          {isInValid ? (\n            <IconUploadError\n              style={{\n                verticalAlign: 'middle',\n                marginRight: 2,\n                color: '#FF8500',\n              }}\n            />\n          ) : null}\n          <span\n            className={classNames(\n              'flex-1 min-w-0 overflow-hidden text-ellipsis',\n              isInValid ? 'text-[#1D1C2359]' : 'text-[#1D1C23CC]',\n            )}\n          >\n            {mockSet?.name || ''}\n          </span>\n        </span>\n      </Tooltip>\n    ),\n    disabled: isInValid,\n    detail: mockSet,\n  };\n}\n\nexport function getMockSetOptionList(\n  mockSets: MockSet[],\n): Array<MockSelectOptionProps> {\n  return mockSets.map(mockSet => getMockSetOption(mockSet));\n}\nexport interface MockSetSelectActions {\n  handleParentNodeDelete: () => void;\n}\n\nconst MockSetSelectComp = (\n  {\n    bindSubjectInfo: mockSubjectInfo,\n    bizCtx: bizSceneCtx,\n    className,\n    style: baseStyle,\n    readonly,\n  }: MockSetSelectProps,\n  ref: ForwardedRef<MockSetSelectActions>,\n) => {\n  const { detail: subjectDetail, ...bindSubjectInfo } = mockSubjectInfo;\n\n  const { spaceID, toolID, pluginID } = getPluginInfo(\n    bizSceneCtx,\n    bindSubjectInfo,\n  );\n  const uid = userStoreService.useUserInfo()?.user_id_str;\n  const spaceType = useSpaceStore(s => s.space.space_type);\n  const isPersonal = spaceType === SpaceType.Personal;\n\n  const bizCtx: BizCtx = {\n    ...bizSceneCtx,\n    connectorUID: uid,\n    connectorID: CONNECTOR_ID, // Business line for Coze\n  };\n\n  const { jump } = usePageJumpService();\n\n  const [selectedMockSet, setSelectedMockSet] =\n    useState<MockSet>(REAL_DATA_MOCKSET);\n  const selectedValue = getMockSetOption(selectedMockSet);\n\n  const [optionList, setOptionList] = useState<Array<MockSelectOptionProps>>(\n    getMockSetOptionList(MOCK_OPTION_LIST),\n  );\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [deleteMockSet, setDeleteMockSet] = useState<MockSet | undefined>();\n\n  const preSelectionRef = useRef<MockSet>(REAL_DATA_MOCKSET);\n  const selectionDomRef = useRef<HTMLDivElement>(null);\n  const selectionRef = useRef<SemiSelectActions>(null);\n\n  const [inViewPort] = useInViewport(selectionDomRef);\n  const {\n    data: enabledMockSetInfo,\n    addMockComp,\n    removeMockComp,\n    start,\n    cancel,\n    setRestartTimer,\n  } = useInitialGetEnabledMockSet({\n    bizCtx,\n    pollingInterval: POLLING_INTERVAL,\n  });\n\n  const { runAsync: changeMockSet, loading: changeMockSetLoading } = useRequest(\n    async (mockSet: MockSet, isBinding = true) => {\n      const basicParams: ParamsTypeDefine[EVENT_NAMES.use_mockset_front] = {\n        environment: getEnvironment(),\n        workspace_id: spaceID || '',\n        workspace_type: isPersonal ? 'personal_workspace' : 'team_workspace',\n        tool_id: toolID || '',\n        status: 1,\n        mock_set_id: (mockSet.id as string) || '',\n        where: getUsedScene(bizCtx.trafficScene),\n      };\n      try {\n        await debuggerApi.BindMockSet({\n          mockSetID: isBinding ? mockSet.id : '0',\n          bizCtx,\n          mockSubject: bindSubjectInfo,\n        });\n        isBinding &&\n          sendTeaEvent(EVENT_NAMES.use_mockset_front, {\n            ...basicParams,\n            status: 0,\n          });\n      } catch (e) {\n        setSelectedMockSet(preSelectionRef.current);\n        logger.error({ error: e as Error, eventName: 'change_mockset_fail' });\n        isBinding &&\n          sendTeaEvent(EVENT_NAMES.use_mockset_front, {\n            ...basicParams,\n            status: 1,\n            error: (e as Error | undefined)?.message as string,\n          });\n      }\n    },\n    {\n      manual: true,\n    },\n  );\n\n  const handleChange = async (obj?: MockSelectOptionProps) => {\n    cancel();\n    preSelectionRef.current = selectedMockSet;\n    setSelectedMockSet((obj as MockSelectOptionProps)?.detail || {});\n    await changeMockSet((obj as MockSelectOptionProps)?.detail || {});\n    const restartTimerId = setTimeout(() => {\n      start();\n    }, DELAY_TIME);\n    setRestartTimer(restartTimerId);\n  };\n\n  const {\n    reload: fetchOptionList,\n    loadMore,\n    loading,\n    loadingMore,\n    data: optionListData,\n  } = useInfiniteScroll(\n    async d => {\n      try {\n        const res = await debuggerApi.MGetMockSet({\n          bizCtx,\n          mockSubject: getMockSubjectInfo(bizCtx, mockSubjectInfo),\n          pageToken: d?.pageToken,\n          orderBy: infra.OrderBy.UpdateTime,\n          desc: true,\n        });\n        const mockSetList = getMockSetOptionList(res?.mockSets || []);\n\n        return {\n          list: mockSetList || [],\n          pageToken: res?.pageToken,\n          hasMore: res?.hasMore ?? true,\n          schema: res?.schema,\n          count: res?.count,\n        };\n      } catch (e) {\n        logger.error({\n          error: e as Error,\n          eventName: 'mockset_list_fetch_fail',\n        });\n        return {\n          list: [],\n          pageToken: d?.pageToken,\n          hasMore: d?.hasMore,\n        };\n      }\n    },\n    {\n      manual: true,\n    },\n  );\n\n  useImperativeHandle(ref, () => ({\n    handleParentNodeDelete: () => {\n      changeMockSet(selectedMockSet, false);\n    },\n  }));\n\n  useEffect(() => {\n    const newOptionList = [\n      getMockSetOption(REAL_DATA_MOCKSET),\n      ...(optionListData?.list || []),\n    ];\n    setOptionList(newOptionList);\n  }, [optionListData]);\n\n  useEffect(() => {\n    const mockSetInfo = enabledMockSetInfo.find(mockInfo =>\n      isCurrent(\n        {\n          bizCtx: mockInfo?.mockSetBinding?.bizCtx || {},\n          bindSubjectInfo: mockInfo?.mockSetBinding?.mockSubject || {},\n        },\n        {\n          bizCtx,\n          bindSubjectInfo,\n        },\n      ),\n    );\n\n    if (changeMockSetLoading) {\n      return;\n    }\n\n    if (mockSetInfo?.mockSetDetail) {\n      setSelectedMockSet(mockSetInfo?.mockSetDetail);\n    } else {\n      setSelectedMockSet(REAL_DATA_MOCKSET);\n    }\n  }, [enabledMockSetInfo]);\n\n  useUnmount(() => {\n    const length = removeMockComp({ bizCtx, bindSubjectInfo });\n    if (!length) {\n      cancel();\n    }\n  });\n\n  useEffect(() => {\n    if (inViewPort) {\n      const length = addMockComp({ bizCtx, bindSubjectInfo });\n      if (length === 1) {\n        start();\n      }\n    } else {\n      const length = removeMockComp({ bizCtx, bindSubjectInfo });\n      if (!length) {\n        cancel();\n      }\n    }\n  }, [inViewPort]);\n\n  const closePanel = () => {\n    selectionRef?.current?.close();\n  };\n\n  const handleView = (\n    record?: MockSet,\n    autoGenerateConfig?: AutoGenerateConfig,\n  ) => {\n    const { trafficScene } = bizCtx || {};\n    const { id } = record || {};\n    if (spaceID && pluginID && toolID && id) {\n      jump(\n        trafficScene === TrafficScene.CozeWorkflowDebug\n          ? SceneType.WORKFLOW__TO__PLUGIN_MOCK_DATA\n          : SceneType.BOT__TO__PLUGIN_MOCK_DATA,\n        {\n          spaceId: spaceID,\n          pluginId: pluginID,\n          toolId: toolID,\n          toolName: subjectDetail?.name,\n          mockSetId: String(id),\n          mockSetName: record?.name,\n          bizCtx: JSON.stringify(bizCtx),\n          bindSubjectInfo: JSON.stringify(bindSubjectInfo),\n          generationMode: autoGenerateConfig?.generateMode,\n        },\n      );\n    }\n  };\n\n  const renderCreateMockSet = () => (\n    <>\n      <div className={styles.divider}></div>\n      <div\n        onClick={() => {\n          setShowCreateModal(true);\n          closePanel();\n        }}\n        className={styles['create-container']}\n      >\n        <IconAdd\n          className=\"mr-[10px]\"\n          style={{ fontSize: 14, color: '#4D53E8' }}\n        />\n        <span>{I18n.t('create_mockset')}</span>\n      </div>\n    </>\n  );\n\n  const renderLoadMore = () =>\n    loading ||\n    (optionListData?.list?.length || 0) >=\n      (optionListData?.count || 0) ? null : (\n      <div\n        className={classNames(\n          styles['select-option-container'],\n          styles['load-more'],\n        )}\n      >\n        {loadingMore ? (\n          <>\n            <Spin wrapperClassName={styles['spin-icon']} />\n            <span>{I18n.t('Loading')}</span>\n          </>\n        ) : (\n          <UIButton\n            onClick={loadMore}\n            theme=\"borderless\"\n            style={{ fontSize: 12 }}\n          >\n            {I18n.t('Load More' as any)}\n          </UIButton>\n        )}\n      </div>\n    );\n\n  const renderOptionItem = (renderProps: MockSelectRenderOptionProps) => {\n    const {\n      disabled,\n      selected,\n      value,\n      focused,\n      style,\n      onMouseEnter,\n      onClick,\n      detail,\n    } = renderProps;\n\n    const getTooltipInfo = () => {\n      if (detail?.schemaIncompatible) {\n        return I18n.t('tool_updated_check_mockset_compatibility');\n      } else if ((detail?.mockRuleQuantity || 0) <= 0) {\n        return I18n.t('mockset_is_empty_add_data_before_use');\n      }\n      return '';\n    };\n\n    return (\n      <Tooltip\n        zIndex={110}\n        content={getTooltipInfo()}\n        visible={disabled && focused}\n        position=\"left\"\n        style={{ display: disabled ? 'block' : 'none' }} // Visible disabled not effective\n      >\n        <div\n          style={style}\n          className={classNames(\n            styles['select-option-container'],\n            focused && styles['custom-option-render-focused'],\n            disabled && styles['custom-option-render-disabled'],\n            selected && styles['custom-option-render-selected'],\n          )}\n          onClick={onClick}\n          onMouseEnter={onMouseEnter}\n        >\n          <div className=\"w-[16px] h-[16px] mr-[8px]\">\n            {selected ? (\n              <IconTick style={{ fontSize: 14 }} className=\"text-[#4D53E8]\" />\n            ) : (\n              <div className=\"w-[16px]\"></div>\n            )}\n          </div>\n          {value === REAL_DATA_ID ? (\n            <span>{I18n.t('real_data')}</span>\n          ) : (\n            <MockSetItem\n              status={\n                detail?.schemaIncompatible\n                  ? MockSetStatus.Incompatible\n                  : MockSetStatus.Normal\n              }\n              name={detail?.name || ''}\n              onDelete={() => {\n                closePanel();\n                setDeleteMockSet(detail);\n              }}\n              onView={() => {\n                handleView(detail);\n              }}\n              disableCreator={isPersonal}\n              viewOnly={uid !== detail?.creator?.ID}\n              creatorName={detail?.creator?.name}\n              className=\"flex-1 min-w-0\"\n            ></MockSetItem>\n          )}\n        </div>\n      </Tooltip>\n    );\n  };\n\n  return (\n    <div ref={selectionDomRef} style={baseStyle} className={className}>\n      <UISelect\n        stopPropagation\n        disabled={readonly || changeMockSetLoading}\n        className={classNames(\n          styles['select-container'],\n          changeMockSetLoading && styles['switch-disabled'],\n        )}\n        ref={selectionRef}\n        selectedClassname={styles['item-selected']}\n        optionList={optionList}\n        dropdownClassName={styles['option-list']}\n        outerBottomSlot={renderCreateMockSet()}\n        innerBottomSlot={renderLoadMore()}\n        onDropdownVisibleChange={(visible: boolean) => {\n          if (visible) {\n            fetchOptionList();\n          } else {\n            setOptionList([getMockSetOption(REAL_DATA_MOCKSET)]);\n          }\n        }}\n        loading={loading}\n        renderOptionItem={renderOptionItem}\n        value={selectedValue}\n        onChangeWithObject\n        onChange={async obj => {\n          await handleChange(obj as unknown as MockSelectOptionProps);\n        }}\n      />\n      {showCreateModal ? (\n        <MockSetEditModal\n          zIndex={9999}\n          visible={showCreateModal}\n          onCancel={() => setShowCreateModal(false)}\n          onSuccess={(info, autoGenerateConfig) => {\n            const { id } = info || {};\n            setShowCreateModal(false);\n\n            const msgMap = {\n              [PluginMockDataGenerateMode.LLM]: I18n.t(\n                'created_mockset_please_add_mock_data_llm_generation',\n              ),\n              [PluginMockDataGenerateMode.RANDOM]: I18n.t(\n                'created_mockset_please_add_mock_data_random_generation',\n              ),\n              [PluginMockDataGenerateMode.MANUAL]: I18n.t(\n                'created_mockset_please_add_mock_data',\n              ),\n            };\n            UIToast.success(\n              msgMap[\n                autoGenerateConfig?.generateMode ||\n                  PluginMockDataGenerateMode.MANUAL\n              ],\n            );\n\n            handleView({ id }, autoGenerateConfig);\n          }}\n          initialInfo={{\n            bizCtx,\n            bindSubjectInfo,\n            name: subjectDetail?.name,\n          }}\n          needResetPopoverContainer={\n            bizCtx.trafficScene === TrafficScene.CozeWorkflowDebug\n          }\n        />\n      ) : null}\n      {deleteMockSet ? (\n        <MockSetDeleteModal\n          zIndex={9999}\n          visible={!!deleteMockSet}\n          mockSetInfo={{\n            detail: deleteMockSet,\n            ctx: { bizCtx, mockSubjectInfo: bindSubjectInfo },\n          }}\n          onSuccess={() => {\n            deleteMockSet.id === selectedMockSet.id &&\n              setSelectedMockSet(REAL_DATA_MOCKSET);\n            setDeleteMockSet(undefined);\n            cancel();\n            start();\n          }}\n          onCancel={() => setDeleteMockSet(undefined)}\n          needResetPopoverContainer={\n            bizCtx.trafficScene === TrafficScene.CozeWorkflowDebug\n          }\n        />\n      ) : null}\n    </div>\n  );\n};\n\nexport const MockSetSelect = forwardRef(MockSetSelectComp);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { sortBy } from 'lodash-es';\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { type PopoverProps } from '@coze-arch/bot-semi/Popover';\nimport { Popover, Space } from '@coze-arch/bot-semi';\nimport {\n  PluginParamTypeFormat,\n  type PluginApi,\n  type PluginParameter,\n} from '@coze-arch/bot-api/developer_api';\n\nimport s from './index.module.less';\n\ninterface ParametersPopoverProps extends PopoverProps {\n  pluginApi: PluginApi;\n  callback?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n  onVisibleChange?: (visible: boolean) => void;\n}\n\nenum AssistType {\n  File = 1,\n  Image = 2,\n  Doc = 3,\n  Code = 4,\n  Ppt = 5,\n  Txt = 6,\n  Excel = 7,\n  Audio = 8,\n  Zip = 9,\n  Video = 10,\n  Svg = 11,\n}\n\nconst assistTypeToDisplayMap = {\n  [AssistType.File]: 'File',\n  [AssistType.Image]: 'Image',\n  [AssistType.Doc]: 'Doc',\n  [AssistType.Code]: 'Code',\n  [AssistType.Ppt]: 'PPT',\n  [AssistType.Txt]: 'Txt',\n  [AssistType.Excel]: 'Excel',\n  [AssistType.Audio]: 'Audio',\n  [AssistType.Zip]: 'Zip',\n  [AssistType.Video]: 'Video',\n  [AssistType.Svg]: 'Svg',\n};\n\nconst getDisplayType = (parameter: Readonly<PluginParameter>) => {\n  const { type, format } = parameter;\n\n  const { assist_type } = parameter as { assist_type: AssistType };\n\n  let displayType = type;\n  if (type === 'string' && format === PluginParamTypeFormat.ImageUrl) {\n    displayType = 'image';\n  } else if (type === 'string' && assist_type) {\n    displayType = assistTypeToDisplayMap[assist_type];\n  }\n  return displayType;\n};\n\nconst ParameterItem: React.FC<{ parameter: Readonly<PluginParameter> }> = ({\n  parameter,\n}) => {\n  const { name, desc, required } = parameter;\n\n  return (\n    <div className={s['parameter-item']}>\n      <Space className={s['parameter-text']} wrap>\n        <span className={s['parameter-name']}>{name}</span>\n        <span className={s['parameter-type']}>{getDisplayType(parameter)}</span>\n        {required ? (\n          <span className={s['parameter-required']}>\n            {I18n.t('tool_para_required')}\n          </span>\n        ) : null}\n      </Space>\n      <div className={s['parameter-desc']}>{desc}</div>\n    </div>\n  );\n};\n\nexport const ParametersPopover: React.FC<\n  PropsWithChildren<ParametersPopoverProps>\n> = ({ children, pluginApi, callback, onVisibleChange, ...props }) => (\n  <Popover\n    trigger={props?.trigger || 'hover'}\n    position=\"right\"\n    showArrow\n    onVisibleChange={onVisibleChange}\n    content={\n      <div\n        className={classNames(\n          'max-h-[400px] overflow-x-hidden overflow-y-auto',\n          s['popover-content'],\n        )}\n        onClick={e => {\n          callback?.(e);\n        }}\n      >\n        {pluginApi.name ? (\n          <div className={s['popover-api-name']}>{pluginApi.name}</div>\n        ) : null}\n        {pluginApi.desc ? (\n          <div className={s['popover-api-desc']}>{pluginApi.desc}</div>\n        ) : null}\n        {sortBy(pluginApi.parameters || [], item => item.name?.length)?.map(\n          p => {\n            if (!p) {\n              return null;\n            }\n            return <ParameterItem parameter={p} key={p.name} />;\n          },\n        )}\n      </div>\n    }\n    {...props}\n  >\n    <div>{children}</div>\n  </Popover>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type JSX } from 'react';\n\nimport { type Theme } from '@coze-arch/coze-design';\nexport interface COZTheme {\n  theme: Theme;\n}\ninterface Props extends COZTheme {\n  className?: string;\n  components: {\n    dark: JSX.Element;\n    light: JSX.Element;\n  };\n}\nexport function ThemeFactory({ theme, components, className }: Props) {\n  const ComponentRender =\n    theme === 'light' ? components.light : components.dark;\n  return <div className={className}>{ComponentRender}</div>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function SearchNoResultLight(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"576\"\n      height=\"288\"\n      viewBox=\"0 0 576 288\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <g opacity=\"0.2\">\n        <mask\n          id=\"mask0_4513_102601\"\n          maskUnits=\"userSpaceOnUse\"\n          x=\"0\"\n          y=\"0\"\n          width=\"576\"\n          height=\"288\"\n        >\n          <rect\n            width=\"576\"\n            height=\"288\"\n            fill=\"url(#paint0_linear_4513_102601)\"\n          />\n        </mask>\n        <g mask=\"url(#mask0_4513_102601)\">\n          <mask\n            id=\"mask1_4513_102601\"\n            maskUnits=\"userSpaceOnUse\"\n            x=\"0\"\n            y=\"0\"\n            width=\"576\"\n            height=\"288\"\n          >\n            <rect\n              width=\"576\"\n              height=\"288\"\n              fill=\"url(#paint1_linear_4513_102601)\"\n            />\n          </mask>\n          <g mask=\"url(#mask1_4513_102601)\">\n            <rect width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"48\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint2_linear_4513_102601)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"192\"\n              y=\"48\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint3_linear_4513_102601)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"240\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"336\"\n              y=\"96\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint4_linear_4513_102601)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"384\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"240\"\n              y=\"192\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint5_linear_4513_102601)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"288\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"480\"\n              y=\"240\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint6_linear_4513_102601)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"528\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n          </g>\n        </g>\n      </g>\n      <defs>\n        <linearGradient\n          id=\"paint0_linear_4513_102601\"\n          x1=\"576\"\n          y1=\"144\"\n          x2=\"-3.75509e-06\"\n          y2=\"144\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n          <stop offset=\"0.500048\" stopColor=\"#D9D9D9\" />\n          <stop offset=\"1\" stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4513_102601\"\n          x1=\"288\"\n          y1=\"0\"\n          x2=\"288\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n          <stop offset=\"0.493585\" stopColor=\"#D9D9D9\" />\n          <stop offset=\"1\" stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_4513_102601\"\n          x1=\"72\"\n          y1=\"0\"\n          x2=\"72\"\n          y2=\"48\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_4513_102601\"\n          x1=\"216\"\n          y1=\"48\"\n          x2=\"216\"\n          y2=\"96\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint4_linear_4513_102601\"\n          x1=\"360\"\n          y1=\"96\"\n          x2=\"360\"\n          y2=\"144\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint5_linear_4513_102601\"\n          x1=\"264\"\n          y1=\"192\"\n          x2=\"264\"\n          y2=\"240\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint6_linear_4513_102601\"\n          x1=\"504\"\n          y1=\"240\"\n          x2=\"504\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function SearchNoResultDark(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"576\"\n      height=\"288\"\n      viewBox=\"0 0 576 288\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <g opacity=\"0.4\">\n        <mask\n          id=\"mask0_4513_103145\"\n          maskUnits=\"userSpaceOnUse\"\n          x=\"0\"\n          y=\"0\"\n          width=\"576\"\n          height=\"288\"\n        >\n          <rect\n            width=\"576\"\n            height=\"288\"\n            fill=\"url(#paint0_linear_4513_103145)\"\n          />\n        </mask>\n        <g mask=\"url(#mask0_4513_103145)\">\n          <mask\n            id=\"mask1_4513_103145\"\n            maskUnits=\"userSpaceOnUse\"\n            x=\"0\"\n            y=\"0\"\n            width=\"576\"\n            height=\"288\"\n          >\n            <rect\n              width=\"576\"\n              height=\"288\"\n              fill=\"url(#paint1_linear_4513_103145)\"\n            />\n          </mask>\n          <g mask=\"url(#mask1_4513_103145)\">\n            <rect width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"48\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint2_linear_4513_103145)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"192\"\n              y=\"48\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint3_linear_4513_103145)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"240\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"48\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"336\"\n              y=\"96\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint4_linear_4513_103145)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"384\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"96\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"144\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"240\"\n              y=\"192\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint5_linear_4513_103145)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"288\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"480\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"528\" y=\"192\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"48\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"96\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"144\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"192\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"240\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"288\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"336\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"384\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect x=\"432\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n            <rect\n              x=\"480\"\n              y=\"240\"\n              width=\"48\"\n              height=\"48\"\n              fill=\"url(#paint6_linear_4513_103145)\"\n              stroke=\"#3C445C\"\n            />\n            <rect x=\"528\" y=\"240\" width=\"48\" height=\"48\" stroke=\"#3C445C\" />\n          </g>\n        </g>\n      </g>\n      <defs>\n        <linearGradient\n          id=\"paint0_linear_4513_103145\"\n          x1=\"576\"\n          y1=\"144\"\n          x2=\"-3.75509e-06\"\n          y2=\"144\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n          <stop offset=\"0.500048\" stopColor=\"#D9D9D9\" />\n          <stop offset=\"1\" stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4513_103145\"\n          x1=\"288\"\n          y1=\"0\"\n          x2=\"288\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n          <stop offset=\"0.493585\" stopColor=\"#D9D9D9\" />\n          <stop offset=\"1\" stopColor=\"#D9D9D9\" stopOpacity=\"0\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_4513_103145\"\n          x1=\"72\"\n          y1=\"0\"\n          x2=\"72\"\n          y2=\"48\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_4513_103145\"\n          x1=\"216\"\n          y1=\"48\"\n          x2=\"216\"\n          y2=\"96\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint4_linear_4513_103145\"\n          x1=\"360\"\n          y1=\"96\"\n          x2=\"360\"\n          y2=\"144\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint5_linear_4513_103145\"\n          x1=\"264\"\n          y1=\"192\"\n          x2=\"264\"\n          y2=\"240\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint6_linear_4513_103145\"\n          x1=\"504\"\n          y1=\"240\"\n          x2=\"504\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3C445C\" stopOpacity=\"0\" />\n          <stop offset=\"1\" stopColor=\"#3C445C\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../factory';\nimport { SearchNoResultLight } from './SearchNoResultLight';\nimport { SearchNoResultDark } from './SearchNoResultDark';\n\nimport s from './index.module.less';\n\nexport function SearchNoMask({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      className={s['search-no-mask']}\n      theme={theme}\n      components={{\n        dark: <SearchNoResultDark />,\n        light: <SearchNoResultLight />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nexport function WidgetNoResultDark(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"280\"\n      height=\"184\"\n      viewBox=\"0 0 280 184\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect y=\"148\" width=\"280\" height=\"14\" rx=\"7\" fill=\"#1C2333\" />\n      <rect y=\"170\" width=\"192\" height=\"14\" rx=\"7\" fill=\"#1C2333\" />\n      <rect x=\"200\" y=\"170\" width=\"80\" height=\"14\" rx=\"7\" fill=\"#1C2333\" />\n      <rect x=\"0.5\" y=\"0.5\" width=\"279\" height=\"135\" rx=\"7.5\" fill=\"#1C2333\" />\n      <rect\n        x=\"0.5\"\n        y=\"0.5\"\n        width=\"279\"\n        height=\"135\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_116_6085)\"\n      />\n      <g filter=\"url(#filter0_d_116_6085)\">\n        <path\n          d=\"M16 28.8C16 24.3196 16 22.0794 16.8719 20.3681C17.6389 18.8628 18.8628 17.6389 20.3681 16.8719C22.0794 16 24.3196 16 28.8 16H251.2C255.68 16 257.921 16 259.632 16.8719C261.137 17.6389 262.361 18.8628 263.128 20.3681C264 22.0794 264 24.3196 264 28.8V51.2C264 55.6804 264 57.9206 263.128 59.6319C262.361 61.1372 261.137 62.3611 259.632 63.1281C257.921 64 255.68 64 251.2 64H28.8C24.3196 64 22.0794 64 20.3681 63.1281C18.8628 62.3611 17.6389 61.1372 16.8719 59.6319C16 57.9206 16 55.6804 16 51.2V28.8Z\"\n          fill=\"url(#paint1_linear_116_6085)\"\n        />\n        <path\n          d=\"M16.1 28.8C16.1 26.5581 16.1001 24.8828 16.2087 23.5538C16.3171 22.2259 16.5335 21.2527 16.961 20.4135C17.7184 18.927 18.927 17.7184 20.4135 16.961C21.2527 16.5335 22.2259 16.3171 23.5538 16.2087C24.8828 16.1001 26.5581 16.1 28.8 16.1H251.2C253.442 16.1 255.117 16.1001 256.446 16.2087C257.774 16.3171 258.747 16.5335 259.587 16.961C261.073 17.7184 262.282 18.927 263.039 20.4135C263.467 21.2527 263.683 22.2259 263.791 23.5538C263.9 24.8828 263.9 26.5581 263.9 28.8V51.2C263.9 53.4419 263.9 55.1172 263.791 56.4462C263.683 57.7741 263.467 58.7473 263.039 59.5865C262.282 61.073 261.073 62.2816 259.587 63.039C258.747 63.4665 257.774 63.6828 256.446 63.7913C255.117 63.8999 253.442 63.9 251.2 63.9H28.8C26.5581 63.9 24.8828 63.8999 23.5538 63.7913C22.2259 63.6828 21.2527 63.4665 20.4135 63.039C18.927 62.2816 17.7184 61.073 16.961 59.5865C16.5335 58.7473 16.3171 57.7741 16.2087 56.4462C16.1001 55.1172 16.1 53.4419 16.1 51.2V28.8Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <defs>\n        <filter\n          id=\"filter0_d_116_6085\"\n          x=\"7.42857\"\n          y=\"10.2857\"\n          width=\"265.143\"\n          height=\"65.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_116_6085\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_116_6085\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_116_6085\"\n          x1=\"140\"\n          y1=\"0\"\n          x2=\"140\"\n          y2=\"136\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_116_6085\"\n          x1=\"140\"\n          y1=\"16\"\n          x2=\"140\"\n          y2=\"64\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3D8DF3\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#133BFE\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport function WidgetNoResult(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"280\"\n      height=\"184\"\n      viewBox=\"0 0 280 184\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect y=\"148\" width=\"280\" height=\"14\" rx=\"7\" fill=\"white\" />\n      <rect y=\"170\" width=\"192\" height=\"14\" rx=\"7\" fill=\"white\" />\n      <rect x=\"200\" y=\"170\" width=\"80\" height=\"14\" rx=\"7\" fill=\"white\" />\n      <rect width=\"280\" height=\"136\" rx=\"8\" fill=\"white\" />\n      <rect\n        x=\"0.5\"\n        y=\"0.5\"\n        width=\"279\"\n        height=\"135\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_4434_146978)\"\n        strokeOpacity=\"0.24\"\n      />\n      <g filter=\"url(#filter0_d_4434_146978)\">\n        <path\n          d=\"M16 28.8C16 24.3196 16 22.0794 16.8719 20.3681C17.6389 18.8628 18.8628 17.6389 20.3681 16.8719C22.0794 16 24.3196 16 28.8 16H251.2C255.68 16 257.921 16 259.632 16.8719C261.137 17.6389 262.361 18.8628 263.128 20.3681C264 22.0794 264 24.3196 264 28.8V51.2C264 55.6804 264 57.9206 263.128 59.6319C262.361 61.1372 261.137 62.3611 259.632 63.1281C257.921 64 255.68 64 251.2 64H28.8C24.3196 64 22.0794 64 20.3681 63.1281C18.8628 62.3611 17.6389 61.1372 16.8719 59.6319C16 57.9206 16 55.6804 16 51.2V28.8Z\"\n          fill=\"url(#paint1_linear_4434_146978)\"\n        />\n        <path\n          d=\"M16.1 28.8C16.1 26.5581 16.1001 24.8828 16.2087 23.5538C16.3171 22.2259 16.5335 21.2527 16.961 20.4135C17.7184 18.927 18.927 17.7184 20.4135 16.961C21.2527 16.5335 22.2259 16.3171 23.5538 16.2087C24.8828 16.1001 26.5581 16.1 28.8 16.1H251.2C253.442 16.1 255.117 16.1001 256.446 16.2087C257.774 16.3171 258.747 16.5335 259.587 16.961C261.073 17.7184 262.282 18.927 263.039 20.4135C263.467 21.2527 263.683 22.2259 263.791 23.5538C263.9 24.8828 263.9 26.5581 263.9 28.8V51.2C263.9 53.4419 263.9 55.1172 263.791 56.4462C263.683 57.7741 263.467 58.7473 263.039 59.5865C262.282 61.073 261.073 62.2816 259.587 63.039C258.747 63.4665 257.774 63.6828 256.446 63.7913C255.117 63.8999 253.442 63.9 251.2 63.9H28.8C26.5581 63.9 24.8828 63.8999 23.5538 63.7913C22.2259 63.6828 21.2527 63.4665 20.4135 63.039C18.927 62.2816 17.7184 61.073 16.961 59.5865C16.5335 58.7473 16.3171 57.7741 16.2087 56.4462C16.1001 55.1172 16.1 53.4419 16.1 51.2V28.8Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <defs>\n        <filter\n          id=\"filter0_d_4434_146978\"\n          x=\"7.42857\"\n          y=\"10.2857\"\n          width=\"265.143\"\n          height=\"65.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4434_146978\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4434_146978\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_4434_146978\"\n          x1=\"140\"\n          y1=\"0\"\n          x2=\"140\"\n          y2=\"136\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4434_146978\"\n          x1=\"140\"\n          y1=\"16\"\n          x2=\"140\"\n          y2=\"64\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3D8DF3\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#133BFE\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../../factory';\nimport { WidgetNoResultDark } from './WidgetNoResultDark';\nimport { WidgetNoResult } from './WidgetNoResult';\nexport function WidgetSearchNoCard({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      theme={theme}\n      components={{\n        dark: <WidgetNoResultDark />,\n        light: <WidgetNoResult />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport function SocialSceneFlowNoResultDark(\n  props: React.SVGProps<SVGSVGElement>,\n) {\n  return (\n    <svg\n      width=\"178\"\n      height=\"66\"\n      viewBox=\"0 0 178 66\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        x=\"0.261719\"\n        y=\"0.61499\"\n        width=\"177.474\"\n        height=\"64.6513\"\n        rx=\"5.07069\"\n        fill=\"#1C2333\"\n      />\n      <rect\n        x=\"0.578637\"\n        y=\"0.931908\"\n        width=\"176.84\"\n        height=\"64.0175\"\n        rx=\"4.75377\"\n        stroke=\"#060709\"\n        strokeOpacity=\"0.1\"\n        strokeWidth=\"0.633837\"\n      />\n      <rect\n        x=\"10.4023\"\n        y=\"12.0239\"\n        width=\"65.919\"\n        height=\"8.87371\"\n        rx=\"4.43686\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        x=\"10.4023\"\n        y=\"25.9683\"\n        width=\"111.555\"\n        height=\"8.87371\"\n        rx=\"4.43686\"\n        fill=\"#2B3245\"\n      />\n      <g filter=\"url(#filter0_d_3854_22323)\">\n        <path\n          d=\"M129.564 23.4331C129.564 16.4319 135.24 10.7563 142.241 10.7563H154.918C161.919 10.7563 167.595 16.4319 167.595 23.4331C167.595 30.4342 161.919 36.1098 154.918 36.1098H142.241C135.24 36.1098 129.564 30.4342 129.564 23.4331Z\"\n          fill=\"url(#paint0_linear_3854_22323)\"\n        />\n        <path\n          d=\"M129.628 23.4331C129.628 16.4669 135.275 10.8197 142.241 10.8197H154.918C161.884 10.8197 167.531 16.4669 167.531 23.4331C167.531 30.3992 161.884 36.0464 154.918 36.0464H142.241C135.275 36.0464 129.628 30.3992 129.628 23.4331Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.126767\"\n        />\n      </g>\n      <rect\n        x=\"10.4023\"\n        y=\"46.2512\"\n        width=\"157.191\"\n        height=\"8.87371\"\n        rx=\"4.43686\"\n        fill=\"#2B3245\"\n      />\n      <defs>\n        <filter\n          id=\"filter0_d_3854_22323\"\n          x=\"124.132\"\n          y=\"7.13442\"\n          width=\"48.8951\"\n          height=\"36.2193\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"1.81096\" />\n          <feGaussianBlur stdDeviation=\"2.71644\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_3854_22323\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_3854_22323\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_3854_22323\"\n          x1=\"148.58\"\n          y1=\"10.7563\"\n          x2=\"148.58\"\n          y2=\"36.1098\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport function SocialSceneFlowNoResult(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"178\"\n      height=\"66\"\n      viewBox=\"0 0 178 66\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        x=\"0.261719\"\n        y=\"0.61499\"\n        width=\"177.474\"\n        height=\"64.6513\"\n        rx=\"5.07069\"\n        fill=\"white\"\n      />\n      <rect\n        x=\"0.578637\"\n        y=\"0.931908\"\n        width=\"176.84\"\n        height=\"64.0175\"\n        rx=\"4.75377\"\n        stroke=\"#060709\"\n        strokeOpacity=\"0.1\"\n        strokeWidth=\"0.633837\"\n      />\n      <rect\n        x=\"10.4023\"\n        y=\"12.0239\"\n        width=\"65.919\"\n        height=\"8.87371\"\n        rx=\"4.43686\"\n        fill=\"#060709\"\n        fillOpacity=\"0.3\"\n      />\n      <rect\n        x=\"10.4023\"\n        y=\"25.9683\"\n        width=\"111.555\"\n        height=\"8.87371\"\n        rx=\"4.43686\"\n        fill=\"#060709\"\n        fillOpacity=\"0.3\"\n      />\n      <g filter=\"url(#filter0_d_3854_22323)\">\n        <path\n          d=\"M129.564 23.4331C129.564 16.4319 135.24 10.7563 142.241 10.7563H154.918C161.919 10.7563 167.595 16.4319 167.595 23.4331C167.595 30.4342 161.919 36.1098 154.918 36.1098H142.241C135.24 36.1098 129.564 30.4342 129.564 23.4331Z\"\n          fill=\"url(#paint0_linear_3854_22323)\"\n        />\n        <path\n          d=\"M129.628 23.4331C129.628 16.4669 135.275 10.8197 142.241 10.8197H154.918C161.884 10.8197 167.531 16.4669 167.531 23.4331C167.531 30.3992 161.884 36.0464 154.918 36.0464H142.241C135.275 36.0464 129.628 30.3992 129.628 23.4331Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.126767\"\n        />\n      </g>\n      <rect\n        x=\"10.4023\"\n        y=\"46.2512\"\n        width=\"157.191\"\n        height=\"8.87371\"\n        rx=\"4.43686\"\n        fill=\"#060709\"\n        fillOpacity=\"0.3\"\n      />\n      <defs>\n        <filter\n          id=\"filter0_d_3854_22323\"\n          x=\"124.132\"\n          y=\"7.13442\"\n          width=\"48.8951\"\n          height=\"36.2193\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"1.81096\" />\n          <feGaussianBlur stdDeviation=\"2.71644\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_3854_22323\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_3854_22323\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_3854_22323\"\n          x1=\"148.58\"\n          y1=\"10.7563\"\n          x2=\"148.58\"\n          y2=\"36.1098\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../../factory';\nimport { SocialSceneFlowNoResultDark } from './SocialSceneFlowNoResultDark';\nimport { SocialSceneFlowNoResult } from './SocialSceneFlowNoResult';\nexport function SocialSceneFlowSearchNoCard({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      theme={theme}\n      components={{\n        dark: <SocialSceneFlowNoResultDark />,\n        light: <SocialSceneFlowNoResult />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nexport function SocialNoResultDark(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"576\"\n      height=\"288\"\n      viewBox=\"0 0 576 288\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        x=\"208.5\"\n        y=\"88.5\"\n        width=\"159\"\n        height=\"199\"\n        rx=\"7.5\"\n        fill=\"#1C2333\"\n      />\n      <rect\n        x=\"208.5\"\n        y=\"88.5\"\n        width=\"159\"\n        height=\"199\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_4453_179036)\"\n      />\n      <g filter=\"url(#filter0_d_4453_179036)\">\n        <path\n          d=\"M248 116.8C248 112.32 248 110.079 248.872 108.368C249.639 106.863 250.863 105.639 252.368 104.872C254.079 104 256.32 104 260.8 104H315.2C319.68 104 321.921 104 323.632 104.872C325.137 105.639 326.361 106.863 327.128 108.368C328 110.079 328 112.32 328 116.8V187.2C328 191.68 328 193.921 327.128 195.632C326.361 197.137 325.137 198.361 323.632 199.128C321.921 200 319.68 200 315.2 200H260.8C256.32 200 254.079 200 252.368 199.128C250.863 198.361 249.639 197.137 248.872 195.632C248 193.921 248 191.68 248 187.2V116.8Z\"\n          fill=\"url(#paint1_linear_4453_179036)\"\n        />\n        <path\n          d=\"M248.1 116.8C248.1 114.558 248.1 112.883 248.209 111.554C248.317 110.226 248.533 109.253 248.961 108.413C249.718 106.927 250.927 105.718 252.413 104.961C253.253 104.533 254.226 104.317 255.554 104.209C256.883 104.1 258.558 104.1 260.8 104.1H315.2C317.442 104.1 319.117 104.1 320.446 104.209C321.774 104.317 322.747 104.533 323.587 104.961C325.073 105.718 326.282 106.927 327.039 108.413C327.467 109.253 327.683 110.226 327.791 111.554C327.9 112.883 327.9 114.558 327.9 116.8V187.2C327.9 189.442 327.9 191.117 327.791 192.446C327.683 193.774 327.467 194.747 327.039 195.587C326.282 197.073 325.073 198.282 323.587 199.039C322.747 199.467 321.774 199.683 320.446 199.791C319.117 199.9 317.442 199.9 315.2 199.9H260.8C258.558 199.9 256.883 199.9 255.554 199.791C254.226 199.683 253.253 199.467 252.413 199.039C250.927 198.282 249.718 197.073 248.961 195.587C248.533 194.747 248.317 193.774 248.209 192.446C248.1 191.117 248.1 189.442 248.1 187.2V116.8Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect x=\"248\" y=\"226\" width=\"80\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"224\" y=\"248\" width=\"128\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <defs>\n        <filter\n          id=\"filter0_d_4453_179036\"\n          x=\"239.429\"\n          y=\"98.2857\"\n          width=\"97.1429\"\n          height=\"113.143\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4453_179036\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4453_179036\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_4453_179036\"\n          x1=\"288\"\n          y1=\"88\"\n          x2=\"288\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4453_179036\"\n          x1=\"288\"\n          y1=\"104\"\n          x2=\"288\"\n          y2=\"200\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#FAC818\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport function SocialNoResult(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"576\"\n      height=\"288\"\n      viewBox=\"0 0 576 288\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect x=\"208\" y=\"88\" width=\"160\" height=\"200\" rx=\"8\" fill=\"white\" />\n      <rect\n        x=\"208.5\"\n        y=\"88.5\"\n        width=\"159\"\n        height=\"199\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_6466_153347)\"\n        strokeOpacity=\"0.24\"\n      />\n      <g filter=\"url(#filter0_d_6466_153347)\">\n        <path\n          d=\"M248 116.8C248 112.32 248 110.079 248.872 108.368C249.639 106.863 250.863 105.639 252.368 104.872C254.079 104 256.32 104 260.8 104H315.2C319.68 104 321.921 104 323.632 104.872C325.137 105.639 326.361 106.863 327.128 108.368C328 110.079 328 112.32 328 116.8V187.2C328 191.68 328 193.921 327.128 195.632C326.361 197.137 325.137 198.361 323.632 199.128C321.921 200 319.68 200 315.2 200H260.8C256.32 200 254.079 200 252.368 199.128C250.863 198.361 249.639 197.137 248.872 195.632C248 193.921 248 191.68 248 187.2V116.8Z\"\n          fill=\"url(#paint1_linear_6466_153347)\"\n        />\n        <path\n          d=\"M315.2 199.9H260.8C258.558 199.9 256.883 199.9 255.554 199.791C254.226 199.683 253.253 199.467 252.413 199.039C250.927 198.282 249.718 197.073 248.961 195.587C248.533 194.747 248.317 193.774 248.209 192.446C248.1 191.117 248.1 189.442 248.1 187.2V116.8C248.1 114.558 248.1 112.883 248.209 111.554C248.317 110.226 248.533 109.253 248.961 108.413C249.718 106.927 250.927 105.718 252.413 104.961C253.253 104.533 254.226 104.317 255.554 104.209C256.883 104.1 258.558 104.1 260.8 104.1H315.2C317.442 104.1 319.117 104.1 320.446 104.209C321.774 104.317 322.747 104.533 323.587 104.961C325.073 105.718 326.282 106.927 327.039 108.413C327.467 109.253 327.683 110.226 327.791 111.554C327.9 112.883 327.9 114.558 327.9 116.8V187.2C327.9 189.442 327.9 191.117 327.791 192.446C327.683 193.774 327.467 194.747 327.039 195.587C326.282 197.073 325.073 198.282 323.587 199.039C322.747 199.467 321.774 199.683 320.446 199.791C319.117 199.9 317.442 199.9 315.2 199.9Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect\n        opacity=\"0.12\"\n        x=\"244\"\n        y=\"226\"\n        width=\"88\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"224\"\n        y=\"248\"\n        width=\"128\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <defs>\n        <filter\n          id=\"filter0_d_6466_153347\"\n          x=\"239.429\"\n          y=\"98.2857\"\n          width=\"97.1429\"\n          height=\"113.143\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_6466_153347\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_6466_153347\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_6466_153347\"\n          x1=\"288\"\n          y1=\"88\"\n          x2=\"288\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_6466_153347\"\n          x1=\"288\"\n          y1=\"104\"\n          x2=\"288\"\n          y2=\"200\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#FAC818\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../../factory';\nimport { SocialNoResultDark } from './SocialNoResultDark';\nimport { SocialNoResult } from './SocialNoResult';\nexport function SocialSearchNoCard({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      theme={theme}\n      components={{\n        dark: <SocialNoResultDark />,\n        light: <SocialNoResult />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function RecommendNoResultDark(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"576\"\n      height=\"288\"\n      viewBox=\"0 0 576 288\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        x=\"148.5\"\n        y=\"136.5\"\n        width=\"279\"\n        height=\"151\"\n        rx=\"7.5\"\n        fill=\"#1C2333\"\n      />\n      <rect\n        x=\"148.5\"\n        y=\"136.5\"\n        width=\"279\"\n        height=\"151\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_7238_218933)\"\n      />\n      <rect x=\"164\" y=\"152\" width=\"104\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"164\" y=\"174\" width=\"248\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"164\" y=\"196\" width=\"248\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"164\" y=\"226\" width=\"120\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <g filter=\"url(#filter0_d_7238_218933)\">\n        <path\n          d=\"M164 262.4C164 260.16 164 259.04 164.436 258.184C164.819 257.431 165.431 256.819 166.184 256.436C167.04 256 168.16 256 170.4 256H173.6C175.84 256 176.96 256 177.816 256.436C178.569 256.819 179.181 257.431 179.564 258.184C180 259.04 180 260.16 180 262.4V265.6C180 267.84 180 268.96 179.564 269.816C179.181 270.569 178.569 271.181 177.816 271.564C176.96 272 175.84 272 173.6 272H170.4C168.16 272 167.04 272 166.184 271.564C165.431 271.181 164.819 270.569 164.436 269.816C164 268.96 164 267.84 164 265.6V262.4Z\"\n          fill=\"url(#paint1_linear_7238_218933)\"\n        />\n        <path\n          d=\"M170.4 272.5H173.6H173.623C174.724 272.5 175.581 272.5 176.268 272.444C176.966 272.387 177.533 272.269 178.043 272.01C178.89 271.578 179.578 270.89 180.01 270.043C180.269 269.533 180.387 268.966 180.444 268.268C180.5 267.581 180.5 266.724 180.5 265.623V265.6V262.4V262.377C180.5 261.276 180.5 260.419 180.444 259.732C180.387 259.034 180.269 258.467 180.01 257.957C179.578 257.11 178.89 256.422 178.043 255.99C177.533 255.731 176.966 255.613 176.268 255.556C175.581 255.5 174.724 255.5 173.623 255.5H173.6H170.4H170.377C169.276 255.5 168.419 255.5 167.732 255.556C167.034 255.613 166.467 255.731 165.957 255.99C165.11 256.422 164.422 257.11 163.99 257.957C163.731 258.467 163.613 259.034 163.556 259.732C163.5 260.419 163.5 261.276 163.5 262.377V262.4V265.6V265.623C163.5 266.724 163.5 267.581 163.556 268.268C163.613 268.966 163.731 269.533 163.99 270.043C164.422 270.89 165.11 271.578 165.957 272.01C166.467 272.269 167.034 272.387 167.732 272.444C168.419 272.5 169.276 272.5 170.377 272.5H170.4Z\"\n          stroke=\"white\"\n        />\n      </g>\n      <g filter=\"url(#filter1_d_7238_218933)\">\n        <path\n          d=\"M176 262.4C176 260.16 176 259.04 176.436 258.184C176.819 257.431 177.431 256.819 178.184 256.436C179.04 256 180.16 256 182.4 256H185.6C187.84 256 188.96 256 189.816 256.436C190.569 256.819 191.181 257.431 191.564 258.184C192 259.04 192 260.16 192 262.4V265.6C192 267.84 192 268.96 191.564 269.816C191.181 270.569 190.569 271.181 189.816 271.564C188.96 272 187.84 272 185.6 272H182.4C180.16 272 179.04 272 178.184 271.564C177.431 271.181 176.819 270.569 176.436 269.816C176 268.96 176 267.84 176 265.6V262.4Z\"\n          fill=\"url(#paint2_linear_7238_218933)\"\n        />\n        <path\n          d=\"M182.4 272.5H185.6H185.623C186.724 272.5 187.581 272.5 188.268 272.444C188.966 272.387 189.533 272.269 190.043 272.01C190.89 271.578 191.578 270.89 192.01 270.043C192.269 269.533 192.387 268.966 192.444 268.268C192.5 267.581 192.5 266.724 192.5 265.623V265.6V262.4V262.377C192.5 261.276 192.5 260.419 192.444 259.732C192.387 259.034 192.269 258.467 192.01 257.957C191.578 257.11 190.89 256.422 190.043 255.99C189.533 255.731 188.966 255.613 188.268 255.556C187.581 255.5 186.724 255.5 185.623 255.5H185.6H182.4H182.377C181.276 255.5 180.419 255.5 179.732 255.556C179.034 255.613 178.467 255.731 177.957 255.99C177.11 256.422 176.422 257.11 175.99 257.957C175.731 258.467 175.613 259.034 175.556 259.732C175.5 260.419 175.5 261.276 175.5 262.377V262.4V265.6V265.623C175.5 266.724 175.5 267.581 175.556 268.268C175.613 268.966 175.731 269.533 175.99 270.043C176.422 270.89 177.11 271.578 177.957 272.01C178.467 272.269 179.034 272.387 179.732 272.444C180.419 272.5 181.276 272.5 182.377 272.5H182.4Z\"\n          stroke=\"white\"\n        />\n      </g>\n      <g filter=\"url(#filter2_d_7238_218933)\">\n        <path\n          d=\"M188 262.4C188 260.16 188 259.04 188.436 258.184C188.819 257.431 189.431 256.819 190.184 256.436C191.04 256 192.16 256 194.4 256H197.6C199.84 256 200.96 256 201.816 256.436C202.569 256.819 203.181 257.431 203.564 258.184C204 259.04 204 260.16 204 262.4V265.6C204 267.84 204 268.96 203.564 269.816C203.181 270.569 202.569 271.181 201.816 271.564C200.96 272 199.84 272 197.6 272H194.4C192.16 272 191.04 272 190.184 271.564C189.431 271.181 188.819 270.569 188.436 269.816C188 268.96 188 267.84 188 265.6V262.4Z\"\n          fill=\"url(#paint3_linear_7238_218933)\"\n        />\n        <path\n          d=\"M194.4 272.5H197.6H197.623C198.724 272.5 199.581 272.5 200.268 272.444C200.966 272.387 201.533 272.269 202.043 272.01C202.89 271.578 203.578 270.89 204.01 270.043C204.269 269.533 204.387 268.966 204.444 268.268C204.5 267.581 204.5 266.724 204.5 265.623V265.6V262.4V262.377C204.5 261.276 204.5 260.419 204.444 259.732C204.387 259.034 204.269 258.467 204.01 257.957C203.578 257.11 202.89 256.422 202.043 255.99C201.533 255.731 200.966 255.613 200.268 255.556C199.581 255.5 198.724 255.5 197.623 255.5H197.6H194.4H194.377C193.276 255.5 192.419 255.5 191.732 255.556C191.034 255.613 190.467 255.731 189.957 255.99C189.11 256.422 188.422 257.11 187.99 257.957C187.731 258.467 187.613 259.034 187.556 259.732C187.5 260.419 187.5 261.276 187.5 262.377V262.4V265.6V265.623C187.5 266.724 187.5 267.581 187.556 268.268C187.613 268.966 187.731 269.533 187.99 270.043C188.422 270.89 189.11 271.578 189.957 272.01C190.467 272.269 191.034 272.387 191.732 272.444C192.419 272.5 193.276 272.5 194.377 272.5H194.4Z\"\n          stroke=\"white\"\n        />\n      </g>\n      <defs>\n        <filter\n          id=\"filter0_d_7238_218933\"\n          x=\"154.429\"\n          y=\"249.286\"\n          width=\"35.1429\"\n          height=\"35.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_7238_218933\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_7238_218933\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter1_d_7238_218933\"\n          x=\"166.429\"\n          y=\"249.286\"\n          width=\"35.1429\"\n          height=\"35.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_7238_218933\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_7238_218933\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter2_d_7238_218933\"\n          x=\"178.429\"\n          y=\"249.286\"\n          width=\"35.1429\"\n          height=\"35.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_7238_218933\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_7238_218933\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_7238_218933\"\n          x1=\"288\"\n          y1=\"136\"\n          x2=\"288\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_7238_218933\"\n          x1=\"172\"\n          y1=\"256\"\n          x2=\"172\"\n          y2=\"272\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_7238_218933\"\n          x1=\"184\"\n          y1=\"256\"\n          x2=\"184\"\n          y2=\"272\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#FAC818\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_7238_218933\"\n          x1=\"196\"\n          y1=\"256\"\n          x2=\"196\"\n          y2=\"272\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#133BFE\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function RecommendNoResult(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"576\"\n      height=\"288\"\n      viewBox=\"0 0 576 288\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect x=\"148\" y=\"136\" width=\"280\" height=\"152\" rx=\"8\" fill=\"#F9F9F9\" />\n      <rect\n        x=\"148.5\"\n        y=\"136.5\"\n        width=\"279\"\n        height=\"151\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_7238_190934)\"\n        strokeOpacity=\"0.24\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"164\"\n        y=\"152\"\n        width=\"104\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"164\"\n        y=\"174\"\n        width=\"248\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"164\"\n        y=\"196\"\n        width=\"248\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"164\"\n        y=\"226\"\n        width=\"120\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <g filter=\"url(#filter0_d_7238_190934)\">\n        <path\n          d=\"M164 262.4C164 260.16 164 259.04 164.436 258.184C164.819 257.431 165.431 256.819 166.184 256.436C167.04 256 168.16 256 170.4 256H173.6C175.84 256 176.96 256 177.816 256.436C178.569 256.819 179.181 257.431 179.564 258.184C180 259.04 180 260.16 180 262.4V265.6C180 267.84 180 268.96 179.564 269.816C179.181 270.569 178.569 271.181 177.816 271.564C176.96 272 175.84 272 173.6 272H170.4C168.16 272 167.04 272 166.184 271.564C165.431 271.181 164.819 270.569 164.436 269.816C164 268.96 164 267.84 164 265.6V262.4Z\"\n          fill=\"url(#paint1_linear_7238_190934)\"\n        />\n        <path\n          d=\"M170.4 272.5H173.6H173.623C174.724 272.5 175.581 272.5 176.268 272.444C176.966 272.387 177.533 272.269 178.043 272.01C178.89 271.578 179.578 270.89 180.01 270.043C180.269 269.533 180.387 268.966 180.444 268.268C180.5 267.581 180.5 266.724 180.5 265.623V265.6V262.4V262.377C180.5 261.276 180.5 260.419 180.444 259.732C180.387 259.034 180.269 258.467 180.01 257.957C179.578 257.11 178.89 256.422 178.043 255.99C177.533 255.731 176.966 255.613 176.268 255.556C175.581 255.5 174.724 255.5 173.623 255.5H173.6H170.4H170.377C169.276 255.5 168.419 255.5 167.732 255.556C167.034 255.613 166.467 255.731 165.957 255.99C165.11 256.422 164.422 257.11 163.99 257.957C163.731 258.467 163.613 259.034 163.556 259.732C163.5 260.419 163.5 261.276 163.5 262.377V262.4V265.6V265.623C163.5 266.724 163.5 267.581 163.556 268.268C163.613 268.966 163.731 269.533 163.99 270.043C164.422 270.89 165.11 271.578 165.957 272.01C166.467 272.269 167.034 272.387 167.732 272.444C168.419 272.5 169.276 272.5 170.377 272.5H170.4Z\"\n          stroke=\"white\"\n        />\n      </g>\n      <g filter=\"url(#filter1_d_7238_190934)\">\n        <path\n          d=\"M176 262.4C176 260.16 176 259.04 176.436 258.184C176.819 257.431 177.431 256.819 178.184 256.436C179.04 256 180.16 256 182.4 256H185.6C187.84 256 188.96 256 189.816 256.436C190.569 256.819 191.181 257.431 191.564 258.184C192 259.04 192 260.16 192 262.4V265.6C192 267.84 192 268.96 191.564 269.816C191.181 270.569 190.569 271.181 189.816 271.564C188.96 272 187.84 272 185.6 272H182.4C180.16 272 179.04 272 178.184 271.564C177.431 271.181 176.819 270.569 176.436 269.816C176 268.96 176 267.84 176 265.6V262.4Z\"\n          fill=\"url(#paint2_linear_7238_190934)\"\n        />\n        <path\n          d=\"M182.4 272.5H185.6H185.623C186.724 272.5 187.581 272.5 188.268 272.444C188.966 272.387 189.533 272.269 190.043 272.01C190.89 271.578 191.578 270.89 192.01 270.043C192.269 269.533 192.387 268.966 192.444 268.268C192.5 267.581 192.5 266.724 192.5 265.623V265.6V262.4V262.377C192.5 261.276 192.5 260.419 192.444 259.732C192.387 259.034 192.269 258.467 192.01 257.957C191.578 257.11 190.89 256.422 190.043 255.99C189.533 255.731 188.966 255.613 188.268 255.556C187.581 255.5 186.724 255.5 185.623 255.5H185.6H182.4H182.377C181.276 255.5 180.419 255.5 179.732 255.556C179.034 255.613 178.467 255.731 177.957 255.99C177.11 256.422 176.422 257.11 175.99 257.957C175.731 258.467 175.613 259.034 175.556 259.732C175.5 260.419 175.5 261.276 175.5 262.377V262.4V265.6V265.623C175.5 266.724 175.5 267.581 175.556 268.268C175.613 268.966 175.731 269.533 175.99 270.043C176.422 270.89 177.11 271.578 177.957 272.01C178.467 272.269 179.034 272.387 179.732 272.444C180.419 272.5 181.276 272.5 182.377 272.5H182.4Z\"\n          stroke=\"white\"\n        />\n      </g>\n      <g filter=\"url(#filter2_d_7238_190934)\">\n        <path\n          d=\"M188 262.4C188 260.16 188 259.04 188.436 258.184C188.819 257.431 189.431 256.819 190.184 256.436C191.04 256 192.16 256 194.4 256H197.6C199.84 256 200.96 256 201.816 256.436C202.569 256.819 203.181 257.431 203.564 258.184C204 259.04 204 260.16 204 262.4V265.6C204 267.84 204 268.96 203.564 269.816C203.181 270.569 202.569 271.181 201.816 271.564C200.96 272 199.84 272 197.6 272H194.4C192.16 272 191.04 272 190.184 271.564C189.431 271.181 188.819 270.569 188.436 269.816C188 268.96 188 267.84 188 265.6V262.4Z\"\n          fill=\"url(#paint3_linear_7238_190934)\"\n        />\n        <path\n          d=\"M194.4 272.5H197.6H197.623C198.724 272.5 199.581 272.5 200.268 272.444C200.966 272.387 201.533 272.269 202.043 272.01C202.89 271.578 203.578 270.89 204.01 270.043C204.269 269.533 204.387 268.966 204.444 268.268C204.5 267.581 204.5 266.724 204.5 265.623V265.6V262.4V262.377C204.5 261.276 204.5 260.419 204.444 259.732C204.387 259.034 204.269 258.467 204.01 257.957C203.578 257.11 202.89 256.422 202.043 255.99C201.533 255.731 200.966 255.613 200.268 255.556C199.581 255.5 198.724 255.5 197.623 255.5H197.6H194.4H194.377C193.276 255.5 192.419 255.5 191.732 255.556C191.034 255.613 190.467 255.731 189.957 255.99C189.11 256.422 188.422 257.11 187.99 257.957C187.731 258.467 187.613 259.034 187.556 259.732C187.5 260.419 187.5 261.276 187.5 262.377V262.4V265.6V265.623C187.5 266.724 187.5 267.581 187.556 268.268C187.613 268.966 187.731 269.533 187.99 270.043C188.422 270.89 189.11 271.578 189.957 272.01C190.467 272.269 191.034 272.387 191.732 272.444C192.419 272.5 193.276 272.5 194.377 272.5H194.4Z\"\n          stroke=\"white\"\n        />\n      </g>\n      <defs>\n        <filter\n          id=\"filter0_d_7238_190934\"\n          x=\"154.429\"\n          y=\"249.286\"\n          width=\"35.1429\"\n          height=\"35.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_7238_190934\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_7238_190934\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter1_d_7238_190934\"\n          x=\"166.429\"\n          y=\"249.286\"\n          width=\"35.1429\"\n          height=\"35.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_7238_190934\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_7238_190934\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter2_d_7238_190934\"\n          x=\"178.429\"\n          y=\"249.286\"\n          width=\"35.1429\"\n          height=\"35.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_7238_190934\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_7238_190934\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_7238_190934\"\n          x1=\"288\"\n          y1=\"136\"\n          x2=\"288\"\n          y2=\"288\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_7238_190934\"\n          x1=\"172\"\n          y1=\"256\"\n          x2=\"172\"\n          y2=\"272\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_7238_190934\"\n          x1=\"184\"\n          y1=\"256\"\n          x2=\"184\"\n          y2=\"272\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#FAC818\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_7238_190934\"\n          x1=\"196\"\n          y1=\"256\"\n          x2=\"196\"\n          y2=\"272\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#133BFE\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../../factory';\nimport { RecommendNoResultDark } from './RecommendNoResultDark';\nimport { RecommendNoResult } from './RecommendNoResult';\nexport function RecommendSearchNoCard({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      theme={theme}\n      components={{\n        dark: <RecommendNoResultDark />,\n        light: <RecommendNoResult />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function CommonNoResultDark(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"360\"\n      height=\"248\"\n      viewBox=\"0 0 360 248\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect x=\"80.5\" y=\"0.5\" width=\"279\" height=\"71\" rx=\"7.5\" fill=\"#1C2333\" />\n      <rect\n        x=\"80.5\"\n        y=\"0.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_116_6085)\"\n      />\n      <g filter=\"url(#filter0_d_116_6085)\">\n        <path\n          d=\"M96 28.8C96 24.3196 96 22.0794 96.8719 20.3681C97.6389 18.8628 98.8628 17.6389 100.368 16.8719C102.079 16 104.32 16 108.8 16H123.2C127.68 16 129.921 16 131.632 16.8719C133.137 17.6389 134.361 18.8628 135.128 20.3681C136 22.0794 136 24.3196 136 28.8V43.2C136 47.6804 136 49.9206 135.128 51.6319C134.361 53.1372 133.137 54.3611 131.632 55.1281C129.921 56 127.68 56 123.2 56H108.8C104.32 56 102.079 56 100.368 55.1281C98.8628 54.3611 97.6389 53.1372 96.8719 51.6319C96 49.9206 96 47.6804 96 43.2V28.8Z\"\n          fill=\"url(#paint1_linear_116_6085)\"\n        />\n        <path\n          d=\"M96.1 28.8C96.1 26.5581 96.1001 24.8828 96.2087 23.5538C96.3171 22.2259 96.5335 21.2527 96.961 20.4135C97.7184 18.927 98.927 17.7184 100.413 16.961C101.253 16.5335 102.226 16.3171 103.554 16.2087C104.883 16.1001 106.558 16.1 108.8 16.1H123.2C125.442 16.1 127.117 16.1001 128.446 16.2087C129.774 16.3171 130.747 16.5335 131.587 16.961C133.073 17.7184 134.282 18.927 135.039 20.4135C135.467 21.2527 135.683 22.2259 135.791 23.5538C135.9 24.8828 135.9 26.5581 135.9 28.8V43.2C135.9 45.4419 135.9 47.1172 135.791 48.4462C135.683 49.7741 135.467 50.7473 135.039 51.5865C134.282 53.073 133.073 54.2816 131.587 55.039C130.747 55.4665 129.774 55.6828 128.446 55.7913C127.117 55.8999 125.442 55.9 123.2 55.9H108.8C106.558 55.9 104.883 55.8999 103.554 55.7913C102.226 55.6828 101.253 55.4665 100.413 55.039C98.927 54.2816 97.7184 53.073 96.961 51.5865C96.5335 50.7473 96.3171 49.7741 96.2087 48.4462C96.1001 47.1172 96.1 45.4419 96.1 43.2V28.8Z\"\n          stroke=\"black\"\n          stopOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect x=\"148\" y=\"18\" width=\"120\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"148\" y=\"40\" width=\"196\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"0.5\" y=\"88.5\" width=\"279\" height=\"71\" rx=\"7.5\" fill=\"#1C2333\" />\n      <rect\n        x=\"0.5\"\n        y=\"88.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        stroke=\"url(#paint2_linear_116_6085)\"\n      />\n      <g filter=\"url(#filter1_d_116_6085)\">\n        <path\n          d=\"M16 116.8C16 112.32 16 110.079 16.8719 108.368C17.6389 106.863 18.8628 105.639 20.3681 104.872C22.0794 104 24.3196 104 28.8 104H43.2C47.6804 104 49.9206 104 51.6319 104.872C53.1372 105.639 54.3611 106.863 55.1281 108.368C56 110.079 56 112.32 56 116.8V131.2C56 135.68 56 137.921 55.1281 139.632C54.3611 141.137 53.1372 142.361 51.6319 143.128C49.9206 144 47.6804 144 43.2 144H28.8C24.3196 144 22.0794 144 20.3681 143.128C18.8628 142.361 17.6389 141.137 16.8719 139.632C16 137.921 16 135.68 16 131.2V116.8Z\"\n          fill=\"url(#paint3_linear_116_6085)\"\n        />\n        <path\n          d=\"M16.1 116.8C16.1 114.558 16.1001 112.883 16.2087 111.554C16.3171 110.226 16.5335 109.253 16.961 108.413C17.7184 106.927 18.927 105.718 20.4135 104.961C21.2527 104.533 22.2259 104.317 23.5538 104.209C24.8828 104.1 26.5581 104.1 28.8 104.1H43.2C45.4419 104.1 47.1172 104.1 48.4462 104.209C49.7741 104.317 50.7473 104.533 51.5865 104.961C53.073 105.718 54.2816 106.927 55.039 108.413C55.4665 109.253 55.6828 110.226 55.7913 111.554C55.8999 112.883 55.9 114.558 55.9 116.8V131.2C55.9 133.442 55.8999 135.117 55.7913 136.446C55.6828 137.774 55.4665 138.747 55.039 139.587C54.2816 141.073 53.073 142.282 51.5865 143.039C50.7473 143.467 49.7741 143.683 48.4462 143.791C47.1172 143.9 45.4419 143.9 43.2 143.9H28.8C26.5581 143.9 24.8828 143.9 23.5538 143.791C22.2259 143.683 21.2527 143.467 20.4135 143.039C18.927 142.282 17.7184 141.073 16.961 139.587C16.5335 138.747 16.3171 137.774 16.2087 136.446C16.1001 135.117 16.1 133.442 16.1 131.2V116.8Z\"\n          stroke=\"black\"\n          stopOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect x=\"68\" y=\"106\" width=\"120\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"68\" y=\"128\" width=\"196\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect\n        x=\"80.5\"\n        y=\"176.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        fill=\"#1C2333\"\n      />\n      <rect\n        x=\"80.5\"\n        y=\"176.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        stroke=\"url(#paint4_linear_116_6085)\"\n      />\n      <g filter=\"url(#filter2_d_116_6085)\">\n        <path\n          d=\"M96 204.8C96 200.32 96 198.079 96.8719 196.368C97.6389 194.863 98.8628 193.639 100.368 192.872C102.079 192 104.32 192 108.8 192H123.2C127.68 192 129.921 192 131.632 192.872C133.137 193.639 134.361 194.863 135.128 196.368C136 198.079 136 200.32 136 204.8V219.2C136 223.68 136 225.921 135.128 227.632C134.361 229.137 133.137 230.361 131.632 231.128C129.921 232 127.68 232 123.2 232H108.8C104.32 232 102.079 232 100.368 231.128C98.8628 230.361 97.6389 229.137 96.8719 227.632C96 225.921 96 223.68 96 219.2V204.8Z\"\n          fill=\"url(#paint5_linear_116_6085)\"\n        />\n        <path\n          d=\"M96.1 204.8C96.1 202.558 96.1001 200.883 96.2087 199.554C96.3171 198.226 96.5335 197.253 96.961 196.413C97.7184 194.927 98.927 193.718 100.413 192.961C101.253 192.533 102.226 192.317 103.554 192.209C104.883 192.1 106.558 192.1 108.8 192.1H123.2C125.442 192.1 127.117 192.1 128.446 192.209C129.774 192.317 130.747 192.533 131.587 192.961C133.073 193.718 134.282 194.927 135.039 196.413C135.467 197.253 135.683 198.226 135.791 199.554C135.9 200.883 135.9 202.558 135.9 204.8V219.2C135.9 221.442 135.9 223.117 135.791 224.446C135.683 225.774 135.467 226.747 135.039 227.587C134.282 229.073 133.073 230.282 131.587 231.039C130.747 231.467 129.774 231.683 128.446 231.791C127.117 231.9 125.442 231.9 123.2 231.9H108.8C106.558 231.9 104.883 231.9 103.554 231.791C102.226 231.683 101.253 231.467 100.413 231.039C98.927 230.282 97.7184 229.073 96.961 227.587C96.5335 226.747 96.3171 225.774 96.2087 224.446C96.1001 223.117 96.1 221.442 96.1 219.2V204.8Z\"\n          stroke=\"black\"\n          stopOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect x=\"148\" y=\"193\" width=\"120\" height=\"16\" rx=\"8\" fill=\"#2B3245\" />\n      <rect x=\"148\" y=\"217\" width=\"196\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <defs>\n        <filter\n          id=\"filter0_d_116_6085\"\n          x=\"87.4286\"\n          y=\"10.2857\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_116_6085\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_116_6085\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter1_d_116_6085\"\n          x=\"7.42857\"\n          y=\"98.2857\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          color-interpolation-filters=\"sRGB\"\n        >\n          <feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_116_6085\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_116_6085\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter2_d_116_6085\"\n          x=\"87.4286\"\n          y=\"186.286\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_116_6085\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_116_6085\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_116_6085\"\n          x1=\"220\"\n          y1=\"0\"\n          x2=\"220\"\n          y2=\"72\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_116_6085\"\n          x1=\"116\"\n          y1=\"16\"\n          x2=\"116\"\n          y2=\"56\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_116_6085\"\n          x1=\"140\"\n          y1=\"88\"\n          x2=\"140\"\n          y2=\"160\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_116_6085\"\n          x1=\"36\"\n          y1=\"104\"\n          x2=\"36\"\n          y2=\"144\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#FAC818\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint4_linear_116_6085\"\n          x1=\"220\"\n          y1=\"176\"\n          x2=\"220\"\n          y2=\"248\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint5_linear_116_6085\"\n          x1=\"116\"\n          y1=\"192\"\n          x2=\"116\"\n          y2=\"232\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3D8DF3\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#133BFE\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport function CommonNoResult(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"360\"\n      height=\"248\"\n      viewBox=\"0 0 360 248\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect x=\"80\" width=\"280\" height=\"72\" rx=\"8\" fill=\"white\" />\n      <rect\n        x=\"80.5\"\n        y=\"0.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_4434_146978)\"\n        stopOpacity=\"0.24\"\n      />\n      <g filter=\"url(#filter0_d_4434_146978)\">\n        <path\n          d=\"M96 28.8C96 24.3196 96 22.0794 96.8719 20.3681C97.6389 18.8628 98.8628 17.6389 100.368 16.8719C102.079 16 104.32 16 108.8 16H123.2C127.68 16 129.921 16 131.632 16.8719C133.137 17.6389 134.361 18.8628 135.128 20.3681C136 22.0794 136 24.3196 136 28.8V43.2C136 47.6804 136 49.9206 135.128 51.6319C134.361 53.1372 133.137 54.3611 131.632 55.1281C129.921 56 127.68 56 123.2 56H108.8C104.32 56 102.079 56 100.368 55.1281C98.8628 54.3611 97.6389 53.1372 96.8719 51.6319C96 49.9206 96 47.6804 96 43.2V28.8Z\"\n          fill=\"url(#paint1_linear_4434_146978)\"\n        />\n        <path\n          d=\"M96.1 28.8C96.1 26.5581 96.1001 24.8828 96.2087 23.5538C96.3171 22.2259 96.5335 21.2527 96.961 20.4135C97.7184 18.927 98.927 17.7184 100.413 16.961C101.253 16.5335 102.226 16.3171 103.554 16.2087C104.883 16.1001 106.558 16.1 108.8 16.1H123.2C125.442 16.1 127.117 16.1001 128.446 16.2087C129.774 16.3171 130.747 16.5335 131.587 16.961C133.073 17.7184 134.282 18.927 135.039 20.4135C135.467 21.2527 135.683 22.2259 135.791 23.5538C135.9 24.8828 135.9 26.5581 135.9 28.8V43.2C135.9 45.4419 135.9 47.1172 135.791 48.4462C135.683 49.7741 135.467 50.7473 135.039 51.5865C134.282 53.073 133.073 54.2816 131.587 55.039C130.747 55.4665 129.774 55.6828 128.446 55.7913C127.117 55.8999 125.442 55.9 123.2 55.9H108.8C106.558 55.9 104.883 55.8999 103.554 55.7913C102.226 55.6828 101.253 55.4665 100.413 55.039C98.927 54.2816 97.7184 53.073 96.961 51.5865C96.5335 50.7473 96.3171 49.7741 96.2087 48.4462C96.1001 47.1172 96.1 45.4419 96.1 43.2V28.8Z\"\n          stopOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect\n        opacity=\"0.12\"\n        x=\"148\"\n        y=\"18\"\n        width=\"120\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"148\"\n        y=\"40\"\n        width=\"196\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect y=\"88\" width=\"280\" height=\"72\" rx=\"8\" fill=\"white\" />\n      <rect\n        x=\"0.5\"\n        y=\"88.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        stroke=\"url(#paint2_linear_4434_146978)\"\n        stopOpacity=\"0.24\"\n      />\n      <g filter=\"url(#filter1_d_4434_146978)\">\n        <path\n          d=\"M16 116.8C16 112.32 16 110.079 16.8719 108.368C17.6389 106.863 18.8628 105.639 20.3681 104.872C22.0794 104 24.3196 104 28.8 104H43.2C47.6804 104 49.9206 104 51.6319 104.872C53.1372 105.639 54.3611 106.863 55.1281 108.368C56 110.079 56 112.32 56 116.8V131.2C56 135.68 56 137.921 55.1281 139.632C54.3611 141.137 53.1372 142.361 51.6319 143.128C49.9206 144 47.6804 144 43.2 144H28.8C24.3196 144 22.0794 144 20.3681 143.128C18.8628 142.361 17.6389 141.137 16.8719 139.632C16 137.921 16 135.68 16 131.2V116.8Z\"\n          fill=\"url(#paint3_linear_4434_146978)\"\n        />\n        <path\n          d=\"M16.1 116.8C16.1 114.558 16.1001 112.883 16.2087 111.554C16.3171 110.226 16.5335 109.253 16.961 108.413C17.7184 106.927 18.927 105.718 20.4135 104.961C21.2527 104.533 22.2259 104.317 23.5538 104.209C24.8828 104.1 26.5581 104.1 28.8 104.1H43.2C45.4419 104.1 47.1172 104.1 48.4462 104.209C49.7741 104.317 50.7473 104.533 51.5865 104.961C53.073 105.718 54.2816 106.927 55.039 108.413C55.4665 109.253 55.6828 110.226 55.7913 111.554C55.8999 112.883 55.9 114.558 55.9 116.8V131.2C55.9 133.442 55.8999 135.117 55.7913 136.446C55.6828 137.774 55.4665 138.747 55.039 139.587C54.2816 141.073 53.073 142.282 51.5865 143.039C50.7473 143.467 49.7741 143.683 48.4462 143.791C47.1172 143.9 45.4419 143.9 43.2 143.9H28.8C26.5581 143.9 24.8828 143.9 23.5538 143.791C22.2259 143.683 21.2527 143.467 20.4135 143.039C18.927 142.282 17.7184 141.073 16.961 139.587C16.5335 138.747 16.3171 137.774 16.2087 136.446C16.1001 135.117 16.1 133.442 16.1 131.2V116.8Z\"\n          stopOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect\n        opacity=\"0.12\"\n        x=\"68\"\n        y=\"106\"\n        width=\"120\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"68\"\n        y=\"128\"\n        width=\"196\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect x=\"80\" y=\"176\" width=\"280\" height=\"72\" rx=\"8\" fill=\"white\" />\n      <rect\n        x=\"80.5\"\n        y=\"176.5\"\n        width=\"279\"\n        height=\"71\"\n        rx=\"7.5\"\n        stroke=\"url(#paint4_linear_4434_146978)\"\n        stopOpacity=\"0.24\"\n      />\n      <g filter=\"url(#filter2_d_4434_146978)\">\n        <path\n          d=\"M96 204.8C96 200.32 96 198.079 96.8719 196.368C97.6389 194.863 98.8628 193.639 100.368 192.872C102.079 192 104.32 192 108.8 192H123.2C127.68 192 129.921 192 131.632 192.872C133.137 193.639 134.361 194.863 135.128 196.368C136 198.079 136 200.32 136 204.8V219.2C136 223.68 136 225.921 135.128 227.632C134.361 229.137 133.137 230.361 131.632 231.128C129.921 232 127.68 232 123.2 232H108.8C104.32 232 102.079 232 100.368 231.128C98.8628 230.361 97.6389 229.137 96.8719 227.632C96 225.921 96 223.68 96 219.2V204.8Z\"\n          fill=\"url(#paint5_linear_4434_146978)\"\n        />\n        <path\n          d=\"M96.1 204.8C96.1 202.558 96.1001 200.883 96.2087 199.554C96.3171 198.226 96.5335 197.253 96.961 196.413C97.7184 194.927 98.927 193.718 100.413 192.961C101.253 192.533 102.226 192.317 103.554 192.209C104.883 192.1 106.558 192.1 108.8 192.1H123.2C125.442 192.1 127.117 192.1 128.446 192.209C129.774 192.317 130.747 192.533 131.587 192.961C133.073 193.718 134.282 194.927 135.039 196.413C135.467 197.253 135.683 198.226 135.791 199.554C135.9 200.883 135.9 202.558 135.9 204.8V219.2C135.9 221.442 135.9 223.117 135.791 224.446C135.683 225.774 135.467 226.747 135.039 227.587C134.282 229.073 133.073 230.282 131.587 231.039C130.747 231.467 129.774 231.683 128.446 231.791C127.117 231.9 125.442 231.9 123.2 231.9H108.8C106.558 231.9 104.883 231.9 103.554 231.791C102.226 231.683 101.253 231.467 100.413 231.039C98.927 230.282 97.7184 229.073 96.961 227.587C96.5335 226.747 96.3171 225.774 96.2087 224.446C96.1001 223.117 96.1 221.442 96.1 219.2V204.8Z\"\n          stopOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect\n        opacity=\"0.12\"\n        x=\"148\"\n        y=\"193\"\n        width=\"120\"\n        height=\"16\"\n        rx=\"8\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"148\"\n        y=\"217\"\n        width=\"196\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <defs>\n        <filter\n          id=\"filter0_d_4434_146978\"\n          x=\"87.4286\"\n          y=\"10.2857\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4434_146978\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4434_146978\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter1_d_4434_146978\"\n          x=\"7.42857\"\n          y=\"98.2857\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          color-interpolation-filters=\"sRGB\"\n        >\n          <feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4434_146978\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4434_146978\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter2_d_4434_146978\"\n          x=\"87.4286\"\n          y=\"186.286\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4434_146978\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4434_146978\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_4434_146978\"\n          x1=\"220\"\n          y1=\"0\"\n          x2=\"220\"\n          y2=\"72\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#EBEBED\" />\n          <stop offset=\"1\" stopColor=\"#CFDBD7\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4434_146978\"\n          x1=\"116\"\n          y1=\"16\"\n          x2=\"116\"\n          y2=\"56\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_4434_146978\"\n          x1=\"140\"\n          y1=\"88\"\n          x2=\"140\"\n          y2=\"160\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#EBEBED\" />\n          <stop offset=\"1\" stopColor=\"#CFDBD7\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_4434_146978\"\n          x1=\"36\"\n          y1=\"104\"\n          x2=\"36\"\n          y2=\"144\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#FAC818\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint4_linear_4434_146978\"\n          x1=\"220\"\n          y1=\"176\"\n          x2=\"220\"\n          y2=\"248\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#EBEBED\" />\n          <stop offset=\"1\" stopColor=\"#CFDBD7\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint5_linear_4434_146978\"\n          x1=\"116\"\n          y1=\"192\"\n          x2=\"116\"\n          y2=\"232\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#3D8DF3\" />\n          <stop offset=\"0.0001\" stopColor=\"#5CBCB0\" />\n          <stop offset=\"1\" stopColor=\"#133BFE\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../../factory';\nimport { CommonNoResultDark } from './CommonNoResultDark';\nimport { CommonNoResult } from './CommonNoResult';\nexport function CommonSearchNoCard({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      theme={theme}\n      components={{\n        dark: <CommonNoResultDark />,\n        light: <CommonNoResult />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport function BotNoResultDark(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"280\"\n      height=\"102\"\n      viewBox=\"0 0 280 102\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect x=\"0.5\" y=\"0.5\" width=\"279\" height=\"101\" rx=\"7.5\" fill=\"#1C2333\" />\n      <rect\n        x=\"0.5\"\n        y=\"0.5\"\n        width=\"279\"\n        height=\"101\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_4513_103137)\"\n      />\n      <rect x=\"16\" y=\"18\" width=\"104\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <rect x=\"16\" y=\"40\" width=\"196\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <g filter=\"url(#filter0_d_4513_103137)\">\n        <path\n          d=\"M224 22.4C224 20.1598 224 19.0397 224.436 18.184C224.819 17.4314 225.431 16.8195 226.184 16.436C227.04 16 228.16 16 230.4 16H257.6C259.84 16 260.96 16 261.816 16.436C262.569 16.8195 263.181 17.4314 263.564 18.184C264 19.0397 264 20.1598 264 22.4V49.6C264 51.8402 264 52.9603 263.564 53.816C263.181 54.5686 262.569 55.1805 261.816 55.564C260.96 56 259.84 56 257.6 56H230.4C228.16 56 227.04 56 226.184 55.564C225.431 55.1805 224.819 54.5686 224.436 53.816C224 52.9603 224 51.8402 224 49.6V22.4Z\"\n          fill=\"url(#paint1_linear_4513_103137)\"\n        />\n        <path\n          d=\"M224.1 22.4C224.1 21.2782 224.1 20.4429 224.154 19.781C224.208 19.1201 224.315 18.6408 224.525 18.2294C224.899 17.4956 225.496 16.899 226.229 16.5251C226.641 16.3155 227.12 16.2082 227.781 16.1542C228.443 16.1001 229.278 16.1 230.4 16.1H257.6C258.722 16.1 259.557 16.1001 260.219 16.1542C260.88 16.2082 261.359 16.3155 261.771 16.5251C262.504 16.899 263.101 17.4956 263.475 18.2294C263.685 18.6408 263.792 19.1201 263.846 19.781C263.9 20.4429 263.9 21.2782 263.9 22.4V49.6C263.9 50.7218 263.9 51.5571 263.846 52.219C263.792 52.8799 263.685 53.3592 263.475 53.7706C263.101 54.5044 262.504 55.101 261.771 55.4749C261.359 55.6845 260.88 55.7918 260.219 55.8458C259.557 55.8999 258.722 55.9 257.6 55.9H230.4C229.278 55.9 228.443 55.8999 227.781 55.8458C227.12 55.7918 226.641 55.6845 226.229 55.4749C225.496 55.101 224.899 54.5044 224.525 53.7706C224.315 53.3592 224.208 52.8799 224.154 52.219C224.1 51.5571 224.1 50.7218 224.1 49.6V22.4Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect x=\"16\" y=\"72\" width=\"248\" height=\"14\" rx=\"7\" fill=\"#2B3245\" />\n      <defs>\n        <filter\n          id=\"filter0_d_4513_103137\"\n          x=\"215.429\"\n          y=\"10.2857\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4513_103137\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4513_103137\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_4513_103137\"\n          x1=\"140\"\n          y1=\"0\"\n          x2=\"140\"\n          y2=\"102\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4513_103137\"\n          x1=\"244\"\n          y1=\"16\"\n          x2=\"244\"\n          y2=\"56\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport function BotNoResult(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg\n      width=\"280\"\n      height=\"102\"\n      viewBox=\"0 0 280 102\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect width=\"280\" height=\"102\" rx=\"8\" fill=\"#F9F9F9\" />\n      <rect\n        x=\"0.5\"\n        y=\"0.5\"\n        width=\"279\"\n        height=\"101\"\n        rx=\"7.5\"\n        stroke=\"url(#paint0_linear_4513_102766)\"\n        strokeOpacity=\"0.24\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"16\"\n        y=\"18\"\n        width=\"104\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <rect\n        opacity=\"0.12\"\n        x=\"16\"\n        y=\"40\"\n        width=\"196\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <g filter=\"url(#filter0_d_4513_102766)\">\n        <path\n          d=\"M224 22.4C224 20.1598 224 19.0397 224.436 18.184C224.819 17.4314 225.431 16.8195 226.184 16.436C227.04 16 228.16 16 230.4 16H257.6C259.84 16 260.96 16 261.816 16.436C262.569 16.8195 263.181 17.4314 263.564 18.184C264 19.0397 264 20.1598 264 22.4V49.6C264 51.8402 264 52.9603 263.564 53.816C263.181 54.5686 262.569 55.1805 261.816 55.564C260.96 56 259.84 56 257.6 56H230.4C228.16 56 227.04 56 226.184 55.564C225.431 55.1805 224.819 54.5686 224.436 53.816C224 52.9603 224 51.8402 224 49.6V22.4Z\"\n          fill=\"url(#paint1_linear_4513_102766)\"\n        />\n        <path\n          d=\"M224.1 22.4C224.1 21.2782 224.1 20.4429 224.154 19.781C224.208 19.1201 224.315 18.6408 224.525 18.2294C224.899 17.4956 225.496 16.899 226.229 16.5251C226.641 16.3155 227.12 16.2082 227.781 16.1542C228.443 16.1001 229.278 16.1 230.4 16.1H257.6C258.722 16.1 259.557 16.1001 260.219 16.1542C260.88 16.2082 261.359 16.3155 261.771 16.5251C262.504 16.899 263.101 17.4956 263.475 18.2294C263.685 18.6408 263.792 19.1201 263.846 19.781C263.9 20.4429 263.9 21.2782 263.9 22.4V49.6C263.9 50.7218 263.9 51.5571 263.846 52.219C263.792 52.8799 263.685 53.3592 263.475 53.7706C263.101 54.5044 262.504 55.101 261.771 55.4749C261.359 55.6845 260.88 55.7918 260.219 55.8458C259.557 55.8999 258.722 55.9 257.6 55.9H230.4C229.278 55.9 228.443 55.8999 227.781 55.8458C227.12 55.7918 226.641 55.6845 226.229 55.4749C225.496 55.101 224.899 54.5044 224.525 53.7706C224.315 53.3592 224.208 52.8799 224.154 52.219C224.1 51.5571 224.1 50.7218 224.1 49.6V22.4Z\"\n          stroke=\"black\"\n          strokeOpacity=\"0.08\"\n          strokeWidth=\"0.2\"\n        />\n      </g>\n      <rect\n        opacity=\"0.12\"\n        x=\"16\"\n        y=\"72\"\n        width=\"248\"\n        height=\"14\"\n        rx=\"7\"\n        fill=\"#2B3245\"\n      />\n      <defs>\n        <filter\n          id=\"filter0_d_4513_102766\"\n          x=\"215.429\"\n          y=\"10.2857\"\n          width=\"57.1429\"\n          height=\"57.1429\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dy=\"2.85714\" />\n          <feGaussianBlur stdDeviation=\"4.28571\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_4513_102766\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_4513_102766\"\n            result=\"shape\"\n          />\n        </filter>\n        <linearGradient\n          id=\"paint0_linear_4513_102766\"\n          x1=\"140\"\n          y1=\"0\"\n          x2=\"140\"\n          y2=\"102\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#38415A\" />\n          <stop offset=\"1\" stopColor=\"#2B3245\" stopOpacity=\"0.4\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_4513_102766\"\n          x1=\"244\"\n          y1=\"16\"\n          x2=\"244\"\n          y2=\"56\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stopColor=\"#F45D68\" />\n          <stop offset=\"1\" stopColor=\"#FFCA00\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeFactory, type COZTheme } from '../../factory';\nimport { BotNoResultDark } from './BotNoResultDark';\nimport { BotNoResult } from './BotNoResult';\nexport function BotSearchNoCard({ theme }: COZTheme) {\n  return (\n    <ThemeFactory\n      theme={theme}\n      components={{\n        dark: <BotNoResultDark />,\n        light: <BotNoResult />,\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classnames from 'classnames';\n\nimport { type COZTheme } from '../factory';\nimport { WidgetSearchNoCard } from './widget';\nimport { SocialSceneFlowSearchNoCard } from './social-scene-flow';\nimport { SocialSearchNoCard } from './social';\nimport { RecommendSearchNoCard } from './recommend';\nimport { CommonSearchNoCard } from './common';\nimport { BotSearchNoCard } from './bot';\n\nimport s from './index.module.less';\n\nexport interface CardProps extends COZTheme {\n  type:\n    | 'bot'\n    | 'common'\n    | 'widget'\n    | 'social'\n    | 'recommend'\n    | 'social-scene-flow';\n  position: 'top' | 'bottom' | 'center';\n}\n\nconst renderSearchNoCard = (\n  type: CardProps['type'],\n  theme: CardProps['theme'],\n) => {\n  switch (type) {\n    case 'bot':\n      return <BotSearchNoCard theme={theme} />;\n    case 'common':\n      return <CommonSearchNoCard theme={theme} />;\n    case 'widget':\n      return <WidgetSearchNoCard theme={theme} />;\n    case 'social':\n      return <SocialSearchNoCard theme={theme} />;\n    case 'recommend':\n      return <RecommendSearchNoCard theme={theme} />;\n    case 'social-scene-flow':\n      return <SocialSceneFlowSearchNoCard theme={theme} />;\n    default:\n      return null;\n  }\n};\n\nexport function SearchNoCard({ type, theme, position }: CardProps) {\n  return (\n    <div\n      className={classnames(s['search-no-card'], {\n        ['items-start']: position === 'top',\n        ['items-center']: position === 'center',\n        ['items-end']: position === 'bottom',\n      })}\n    >\n      <div className={s[`${type}-no-card`]}>\n        {renderSearchNoCard(type, theme)}\n      </div>\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classnames from 'classnames';\nimport { useTheme } from '@coze-arch/coze-design';\n\nimport { SearchNoMask } from './mask';\nimport { SearchNoCard, type CardProps } from './card';\n\nimport s from './index.module.less';\n\ninterface Props {\n  title: string;\n  description?: string;\n  className?: string;\n  type: CardProps['type'];\n  cardPosition?: CardProps['position'];\n  isNotFound?: boolean;\n  notFound?: string;\n  button?: React.ReactElement | null;\n  children?: React.ReactNode;\n  cardClassName?: string;\n  textClassName?: string;\n}\n\nexport function SearchNoResult({\n  title,\n  description = '',\n  className,\n  type,\n  button,\n  notFound = '',\n  isNotFound = true,\n  cardPosition = 'bottom',\n  cardClassName,\n  textClassName,\n}: Props) {\n  const { theme } = useTheme();\n  return (\n    <div className={classnames(s['search-no-result'], className)}>\n      <div className={classnames(s['search-no-wrapper'], cardClassName)}>\n        <SearchNoMask theme={theme} />\n        <SearchNoCard theme={theme} position={cardPosition} type={type} />\n      </div>\n      <div className={classnames(s['search-no-tips'], textClassName)}>\n        <div\n          className={classnames(\n            s['search-no-title'],\n            'coz-fg-plus text-center font-normal',\n          )}\n        >\n          {notFound !== '' ? notFound : title}\n        </div>\n        <div\n          className={classnames(\n            s['search-no-desc'],\n            'coz-fg-dim text-center font-normal',\n            {\n              hidden: isNotFound,\n            },\n          )}\n        >\n          {description}\n        </div>\n        <div>{!isNotFound && button}</div>\n      </div>\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GetPluginInfoResponse } from '@coze-arch/bot-api/plugin_develop';\n\nexport type PluginInfoProps = GetPluginInfoResponse & { plugin_id?: string };\nexport interface ExtInfoText {\n  type: 'title' | 'text' | 'br' | 'demo';\n  text?: string;\n}\n\nexport enum InitialAction {\n  DEFAULT = 'default',\n  CREATE_TOOL = 'create_tool',\n  SELECT_TOOL = 'select_tool',\n  PUHSLISH = 'publish',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type TagColor } from '@coze-arch/bot-semi/Tag';\nimport {\n  CreationMethod,\n  PluginType as PluginTypeFromApi,\n  GrantType,\n  APIDebugStatus,\n  OnlineStatus,\n} from '@coze-arch/bot-api/plugin_develop';\n\nimport { type ExtInfoText } from '../types';\n\nexport enum PluginType {\n  Form = 1,\n  Code = 2,\n}\n\nexport const pluginTypeOption = [\n  { label: I18n.t('form_mode'), value: 1 },\n  { label: I18n.t('code_mode'), value: 2 },\n];\n\nexport const locationOption = [\n  { label: I18n.t('create_plugin_modal_header'), value: 1 },\n  { label: I18n.t('create_plugin_modal_query'), value: 2 },\n];\n\nexport interface OauthTccOpt {\n  key: string;\n  label?: string;\n  max_len?: number;\n  required?: boolean;\n  type?: string;\n  default?: string;\n  placeholder?: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ruleList?: Array<any>;\n}\n\nexport const extInfoText: Record<string, ExtInfoText[]> = {\n  header_list: [\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_header_list'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_header_list1'),\n    },\n  ],\n  auth: [\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_info_all'),\n    },\n    {\n      type: 'br',\n    },\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_info_None1'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_info_None2'),\n    },\n    {\n      type: 'br',\n    },\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_info_Service1'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_info_Service2'),\n    },\n    {\n      type: 'br',\n    },\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_info_Oauth1'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_info_Oauth2'),\n    },\n  ],\n  location: [\n    {\n      type: 'title',\n      text: I18n.t('plugin_location_info_all'),\n    },\n    {\n      type: 'br',\n    },\n    {\n      type: 'title',\n      text: I18n.t('plugin_location_info_query'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('plugin_location_info_query1'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('plugin_location_info_query2'),\n    },\n    {\n      type: 'br',\n    },\n    {\n      type: 'title',\n      text: I18n.t('plugin_location_header'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('plugin_location_header1'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('plugin_location_header2'),\n    },\n  ],\n  service_token: [\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_Servicetoken_info1'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_Servicetoken_info2'),\n    },\n  ],\n  key: [\n    {\n      type: 'title',\n      text: I18n.t('create_plugin_modal_Parameter_info1'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_Parameter_info2'),\n    },\n  ],\n  client_id: [\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_client_id4'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('create_plugin_modal_client_id5'),\n    },\n  ],\n  client_secret: [\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_client_secret4'),\n    },\n  ],\n  client_url: [\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_client_url_info1'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('create_plugin_modal_client_url_info2'),\n    },\n  ],\n  scope: [\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_scope_info1'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('create_plugin_modal_scope_info2'),\n    },\n  ],\n  authorization_url: [\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_authorization_url_info1'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('create_plugin_modal_authorization_url_info2'),\n    },\n  ],\n  authorization_content_type: [\n    {\n      type: 'text',\n      text: I18n.t('create_plugin_modal_authorization_content_type_info1'),\n    },\n    {\n      type: 'demo',\n      text: I18n.t('create_plugin_modal_authorization_content_type_info2'),\n    },\n  ],\n  creation_method: [\n    {\n      type: 'title',\n      text: I18n.t(\n        'plugin_creation_method_hover_tip_using_existing_services_title',\n      ),\n    },\n    {\n      type: 'text',\n      text: I18n.t(\n        'plugin_creation_method_hover_tip_using_existing_services_desc',\n      ),\n    },\n  ],\n  private_link_id: [\n    {\n      type: 'title',\n      text: I18n.t('vpc_plugin_create_plugin_1'),\n    },\n    {\n      type: 'text',\n      text: I18n.t('vpc_plugin_tooltips'),\n    },\n  ],\n};\n\nexport const authOptionsPlaceholder = {\n  client_id: I18n.t('create_plugin_modal_client_id2'),\n  client_secret: I18n.t('create_plugin_modal_client_secret2'),\n  client_url: I18n.t('create_plugin_modal_client_url_empty'),\n  scope: I18n.t('create_plugin_modal_scope_empty'),\n  authorization_url: I18n.t('create_plugin_modal_authorization_url_empty'),\n  authorization_content_type: I18n.t(\n    'create_plugin_modal_authorization_content_type_empty',\n  ),\n  service_token: I18n.t('create_plugin_modal_Servicetoken_empty'),\n  key: I18n.t('create_plugin_modal_Parameter_empty'),\n};\n\nexport const CLOUD_PLUGIN_COZE = `${PluginTypeFromApi.PLUGIN}-${CreationMethod.COZE}`;\nexport const CLOUD_PLUGIN_IDE = `${PluginTypeFromApi.PLUGIN}-${CreationMethod.IDE}`;\nexport const LOCAL_PLUGIN_COZE = `${PluginTypeFromApi.LOCAL}-${CreationMethod.COZE}`;\n\nexport const doGetCreationMethodTips = () => extInfoText.creation_method;\n\nexport const grantTypeOptions = [\n  {\n    label: 'TokenExchange',\n    value: GrantType.TokenExchange,\n  },\n  {\n    label: 'ClientCredential',\n    value: GrantType.ClientCredential,\n  },\n];\nexport const PLUGIN_API_TYPE_MAP = new Map<\n  APIDebugStatus,\n  { label: string; color: TagColor }\n>([\n  [\n    APIDebugStatus.DebugWaiting,\n    { label: I18n.t('plugin_api_type_fail'), color: 'red' },\n  ],\n  [\n    APIDebugStatus.DebugPassed,\n    { label: I18n.t('plugin_api_type_pass'), color: 'green' },\n  ],\n]);\nexport const PLUGIN_SERVICE_MAP = new Map<\n  OnlineStatus,\n  { label: string; color: string }\n>([\n  [\n    OnlineStatus.ONLINE,\n    {\n      label: I18n.t('plugin_service_status_online'),\n      color: 'var(--plugin-unpublished-color)',\n    },\n  ],\n  [\n    OnlineStatus.OFFLINE,\n    {\n      label: I18n.t('plugin_service_status_offline'),\n      color: 'var(--plugin-published-color)',\n    },\n  ],\n]);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum PremiumPaywallScene {\n  // Create a new space\n  AddSpace,\n  // New model experience\n  NewModel,\n  // paid user template\n  ProTemplate,\n  // Add space member\n  AddSpaceMember,\n  // collaboration\n  Collaborate,\n  // Cross-spatial resource replication\n  CopyResourceCrossSpace,\n  // Publish to API or SDK\n  API,\n  // Add Timbre Resources\n  AddVoice,\n  // real-time voice conversation\n  RTC,\n  // export log\n  ExportLog,\n  // query log\n  FilterLog,\n}\nexport function useBenefitAvailable(_props: unknown) {\n  return true;\n}\nconst voidFunc = () => {\n  console.log('unImplement void func');\n};\nexport function usePremiumPaywallModal(_props: unknown) {\n  return {\n    node: <></>,\n    open: voidFunc,\n    close: voidFunc,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { useFetchKnowledgeBenefit } from './use-fetch-knowledge-benefit';\nexport enum PremiumPaywallBannerScene {\n  Knowledge, // Knowledge base scenario\n  Token, // Token consumption scenarios\n}\n\nexport function PremiumPaywallBanner(_props: {\n  scene: PremiumPaywallBannerScene;\n  knowledgeBenefit?: {\n    total: number;\n    used: number;\n  };\n  center?: boolean;\n}) {\n  return <></>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst voidFunc = () => {\n  console.log('unImplement void func');\n};\nexport function usePremiumManageModal(_props?: unknown) {\n  return {\n    node: <></>,\n    open: voidFunc,\n    close: voidFunc,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type SubscriptionBenefitDetail,\n  type SKUInfo,\n  type SubscriptionUserInfo,\n  type SubscriptionDetail,\n  type SubscriptionRelateBenefit,\n  type MemberVersionRights,\n  type SubscriptionDetailV2,\n} from '@coze-arch/bot-api/trade';\nimport { type BindConnection } from '@coze-arch/bot-api/developer_api';\n\nexport enum UserLevel {\n  /** The free version. */\n  Free = 0,\n  /** overseas\nPremiumLite */\n  PremiumLite = 10,\n  /** Premium */\n  Premium = 15,\n  PremiumPlus = 20,\n  /** domestic\nV1 Volcano Pro */\n  V1ProInstance = 100,\n  /** Personal flagship version */\n  ProPersonal = 110,\n  /** Team Edition */\n  Team = 120,\n  /** Enterprise Edition */\n  Enterprise = 130,\n}\n\nexport type {\n  MemberVersionRights,\n  SubscriptionDetail,\n  BindConnection,\n  SubscriptionDetailV2,\n  SubscriptionUserInfo,\n  SKUInfo,\n};\nexport type PremiumPlan = SKUInfo & {\n  benefit_info?: SubscriptionBenefitDetail;\n  relate_benefit?: SubscriptionRelateBenefit;\n};\n\nexport type PremiumSubs = Record<string, SubscriptionUserInfo>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\n\nimport {\n  UserLevel,\n  type PremiumPlan,\n  type PremiumSubs,\n  type SubscriptionDetail,\n  type BindConnection,\n  type SubscriptionDetailV2,\n  type MemberVersionRights,\n} from '../types';\n\n// Only handle the lowest and highest subscription service gears\nexport enum PremiumPlanLevel {\n  Free = 0,\n\n  PremiumPlus = 20,\n}\n\nexport enum PremiumChannel {\n  Coze = '10000010',\n  Telegram = '11000007',\n  Discord = '10000028',\n}\n\nexport interface VolcanoInfo {\n  authInstanceId?: string;\n  authUserId?: string;\n  loading?: boolean;\n}\n\ninterface PremiumStoreState {\n  polling: boolean; // Whether to enable automatic polling of subscription data\n  plans: PremiumPlan[]; // List of paid subscription plans\n  subs: PremiumSubs; // All subscription data\n  currentPlan: SubscriptionDetail; // Current subscription details\n  hasTrial: boolean;\n  connections: BindConnection[]; // third-party account connection data\n  benefit: SubscriptionDetailV2; // user rights data\n  plansCN: Array<MemberVersionRights>; // List of domestic subscription packages\n  volcanoInfo: VolcanoInfo; // Oauth jump to the volcano required parameters\n}\n\ninterface PremiumStoreAction {\n  /**\n   * reset state\n   */\n  reset: () => void;\n  /**\n   * To set whether to poll for subscription data, the following scenarios are required:\n   * - Bot details to determine whether the subscription card needs to be displayed\n   * - The left menu bar determines whether to display'coze premium'\n   * - The left menu bar displays the number of credits\n   */\n  setPolling: (polling: boolean) => void;\n  /**\n   * Get a list of overseas subscription packages\n   */\n  fetchPremiumPlans: () => Promise<{\n    plans: PremiumPlan[];\n    subs: PremiumSubs;\n    hasTrial: boolean;\n  }>;\n  /**\n   * Set up a list of domestic packages\n   */\n  setPremiumPlansCN: (plans: Array<MemberVersionRights>) => void;\n  /**\n   * Resume subscription, only overseas for the time being\n   */\n  renewCurrentPlan: (plan: SubscriptionDetail) => void;\n  /**\n   * Get the current user subscription details, only overseas for the time being\n   */\n  fetchPremiumPlan: () => Promise<SubscriptionDetail>;\n  /**\n   * Cancel the subscription, only overseas for the time being.\n   */\n  cancelCurrentPlan: () => void;\n  /**\n   * Get channel binding information, only overseas for the time being.\n   */\n  fetchConnections: () => Promise<void>;\n  /**\n   * Cancel the channel user binding, only overseas for the time being\n   */\n  disconnectUser: (connectorId: string) => void;\n  /**\n   * Set the current logged in user rights and interests information, common at home and abroad\n   */\n  setUserBenefit: (benefit: unknown) => void;\n  /**\n   * Set the current account related volcano information\n   */\n  setVolcanoInfo: (info: VolcanoInfo) => void;\n}\n\nconst defaultState: PremiumStoreState = {\n  polling: false,\n  plans: [],\n  subs: {},\n  currentPlan: {},\n  hasTrial: false,\n  connections: [],\n  benefit: {\n    user_basic_info: {\n      user_level: UserLevel.Free,\n    },\n  },\n  plansCN: [],\n  volcanoInfo: {},\n};\n\nexport const usePremiumStore = create<PremiumStoreState & PremiumStoreAction>()(\n  devtools(\n    (set, get) => ({\n      ...defaultState,\n\n      reset: () => {\n        console.log('unImplement usePremiumStore reset ');\n      },\n\n      setPolling: _polling => {\n        console.log('unImplement usePremiumStore setPolling ');\n      },\n\n      fetchPremiumPlans: async () => {\n        const { plans, subs, hasTrial } = get();\n        await 0;\n        return { plans, subs, hasTrial };\n      },\n\n      setPremiumPlansCN: (plans = []) => {\n        set({ plansCN: plans });\n      },\n\n      fetchPremiumPlan: async () => {\n        await 0;\n        return get().currentPlan;\n      },\n\n      cancelCurrentPlan: () => {\n        console.log('unImplement usePremiumStore cancelCurrentPlan ');\n      },\n\n      renewCurrentPlan: _detail => {\n        console.log('unImplement usePremiumStore renewCurrentPlan ');\n      },\n\n      fetchConnections: async () => {\n        await 0;\n        console.log('unImplement usePremiumStore fetchConnections ');\n      },\n\n      disconnectUser: _connectorId => {\n        console.log('unImplement usePremiumStore disconnectUser ');\n      },\n\n      setUserBenefit: _benefit => {\n        console.log('unImplement usePremiumStore setUserBenefit ');\n      },\n\n      setVolcanoInfo: _volcanoInfo => {\n        console.log('unImplement usePremiumStore setVolcanoInfo ');\n      },\n    }),\n    {\n      enabled: IS_DEV_MODE,\n      name: 'botStudio.premiumStore',\n    },\n  ),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UserLevel, type MemberVersionRights } from '../types';\n\ninterface UseBenefitBasicResult {\n  name: string; // Current user package name\n  level: UserLevel; // Current Workspace: User's plan level\n  compareLevel: UserLevel; // Current workspace: If it is a professional version, the value is UserLevel. ProPersonal, and other scenes are at the same level.\n  currPlan: MemberVersionRights; // Current package information\n  nextPlan: MemberVersionRights; // Next package information. If it is already the highest package level, the value is the highest package level.\n  accountPlan: MemberVersionRights; // Package information in the account dimension\n  instanceStatus: unknown; // The current package status can be used to determine the unsubscribe/expiration status.\n  isOverdue: boolean; // Is it in arrears?\n  isExpired: boolean; // Whether it has expired\n  isTerminated: boolean; // Whether to unsubscribe\n  maxMember: number; //maximum membership\n}\n\nconst defaultData = {\n  name: '',\n  level: UserLevel.Free,\n  compareLevel: UserLevel.Free,\n  currPlan: {},\n  nextPlan: {},\n  accountPlan: {},\n  instanceStatus: 1,\n  isOverdue: false,\n  isExpired: false,\n  isTerminated: false,\n  maxMember: -1,\n};\n/**\n * Acquire basic information on domestic rights and interests\n */\nexport function useBenefitBasic(): UseBenefitBasicResult {\n  return defaultData;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SubscriptionDetail } from '../types';\nconst defaultData = {\n  isFree: false,\n  isPremiumPlus: false,\n  hasLowLevelActive: false,\n  hasHighLevelActive: false,\n  sub: {},\n  activeSub: {},\n};\nexport function usePremiumType(): {\n  isFree: boolean;\n  isPremiumPlus: boolean;\n  hasLowLevelActive: boolean;\n  hasHighLevelActive: boolean;\n  sub: SubscriptionDetail;\n  activeSub: SubscriptionDetail;\n} {\n  return defaultData;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\n\nexport interface PluginHistoryPanelUIState {\n  isVisible: boolean;\n}\nexport interface PluginHistoryPanelUIAction {\n  setVisible: (action: ((prevVisible: boolean) => boolean) | boolean) => void;\n}\n\nexport const createPluginHistoryPanelUIStore = () =>\n  create<PluginHistoryPanelUIState & PluginHistoryPanelUIAction>()(\n    devtools(\n      (set, get) => ({\n        isVisible: false,\n        setVisible: action =>\n          set(\n            {\n              isVisible:\n                typeof action === 'boolean' ? action : action(get().isVisible),\n            },\n            false,\n            'setVisible',\n          ),\n      }),\n      {\n        enabled: IS_DEV_MODE,\n        name: 'botStudio.plugin-history-panel-ui',\n      },\n    ),\n  );\n\nexport type PluginHistoryPanelUIStore = ReturnType<\n  typeof createPluginHistoryPanelUIStore\n>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const getPluginErrorMessage = (msg: string) =>\n  `[PluginStore.Error]: ${msg}`;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SpaceRoleType } from '@coze-arch/bot-api/plugin_develop';\nimport { I18n } from '@coze-arch/i18n';\nexport { type GetUserAuthorityData } from '@coze-arch/bot-api/plugin_develop';\nexport { CreationMethod } from '@coze-arch/bot-api/plugin_develop';\n\nexport const ROLE_TAG_TEXT_MAP = {\n  [SpaceRoleType.Owner]: I18n.t('team_management_role_owner', {}, 'Owner'),\n  [SpaceRoleType.Admin]: I18n.t('team_management_role_admin', {}, 'Admin'),\n  [SpaceRoleType.Member]: I18n.t('team_management_role_member', {}, 'Member'),\n  [SpaceRoleType.Default]: '-',\n} as const;\n\nexport { SpaceRoleType };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function -- store */\n/* eslint-disable max-lines-per-function -- store */\nimport { devtools, subscribeWithSelector } from 'zustand/middleware';\nimport { create } from 'zustand';\nimport { produce } from 'immer';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIModal } from '@coze-arch/bot-semi';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\n\nimport { getPluginErrorMessage } from '../utils/error';\nimport { type BotPluginStateAction } from '../types/store/plugin';\nimport { CreationMethod, ROLE_TAG_TEXT_MAP } from '../types';\n\nexport const createPluginStore = (options: {\n  pluginID: string;\n  spaceID: string;\n  projectID?: string;\n  version?: string;\n}) => {\n  const { pluginID, spaceID, projectID, version } = options;\n\n  return create<BotPluginStateAction>()(\n    devtools(\n      subscribeWithSelector((set, get) => ({\n        version,\n        canEdit: !version,\n        isUnlocking: false,\n        pluginId: pluginID,\n        spaceID,\n        projectID,\n        pluginInfo: {},\n        initSuccessed: false,\n        getIsIdePlugin: () => {\n          const { pluginInfo } = get();\n\n          return pluginInfo?.creation_method === CreationMethod.IDE;\n        },\n        setInitSuccessed: (v: boolean) =>\n          set(\n            produce<BotPluginStateAction>(s => {\n              s.initSuccessed = v;\n            }),\n            false,\n            'setInitSuccessed',\n          ),\n        setPluginInfo: info =>\n          set(\n            produce<BotPluginStateAction>(s => {\n              s.pluginInfo = info;\n            }),\n            false,\n            'setPluginInfo',\n          ),\n        setUpdatedInfo: info =>\n          set(\n            produce<BotPluginStateAction>(s => {\n              s.updatedInfo = info;\n            }),\n            false,\n            'setUpdatedInfo',\n          ),\n        initUserPluginAuth: async () => {\n          const { setCanEdit } = get();\n          const resp = await PluginDevelopApi.GetUserAuthority({\n            project_id: projectID,\n            plugin_id: pluginID,\n            creation_method: CreationMethod.COZE,\n          });\n\n          if (resp.code !== 0) {\n            throw new CustomError(\n              REPORT_EVENTS.normalError,\n              getPluginErrorMessage('auth init'),\n            );\n          }\n\n          set(\n            produce<BotPluginStateAction>(s => {\n              s.auth = resp.data;\n            }),\n            false,\n            'initUserPluginAuth',\n          );\n\n          setCanEdit(!!resp.data?.can_edit && !version);\n        },\n        setCanEdit(can) {\n          set(\n            produce<BotPluginStateAction>(s => {\n              s.canEdit = can;\n            }),\n            false,\n            'setCanEdit',\n          );\n        },\n        wrapWithCheckLock: fn => async () => {\n          const { checkPluginIsLockedByOthers } = get();\n\n          const isLocked = await checkPluginIsLockedByOthers();\n\n          if (isLocked) {\n            return;\n          }\n\n          fn();\n        },\n        initPlugin: async () => {\n          const { pluginId, setPluginInfo } = get();\n\n          const res = await PluginDevelopApi.GetPluginInfo({\n            plugin_id: pluginId || '',\n            preview_version_ts: version,\n          });\n\n          if (res?.code !== 0) {\n            throw new CustomError(\n              REPORT_EVENTS.normalError,\n              getPluginErrorMessage('getPluginInfo error'),\n            );\n          }\n          setPluginInfo({ ...res, plugin_id: pluginId || '' });\n        },\n        initTool: async () => {\n          const { pluginId, setUpdatedInfo } = get();\n\n          const res = await PluginDevelopApi.GetUpdatedAPIs(\n            {\n              plugin_id: pluginId || '',\n            },\n            { __disableErrorToast: true },\n          );\n\n          if (res?.code !== 0) {\n            throw new CustomError(\n              REPORT_EVENTS.normalError,\n              getPluginErrorMessage('getToolInfo error'),\n            );\n          }\n\n          setUpdatedInfo({\n            updated_api_names: res?.updated_api_names || [],\n            created_api_names: res?.created_api_names || [], //For the time being, only the mockset permission of the newly added tool is judged.\n          });\n        },\n        init: async () => {\n          const { initPlugin, initTool, initUserPluginAuth, setInitSuccessed } =\n            get();\n          await Promise.all([initPlugin(), initTool(), initUserPluginAuth()]);\n          setInitSuccessed(true);\n        },\n        checkPluginIsLockedByOthers: async () => {\n          const { pluginId, getIsIdePlugin } = get();\n\n          if (getIsIdePlugin()) {\n            return false;\n          }\n\n          const resp = await PluginDevelopApi.CheckAndLockPluginEdit({\n            plugin_id: pluginId,\n          });\n\n          if (resp.code !== 0) {\n            return false;\n          }\n\n          const { data } = resp;\n          const user = data?.user;\n\n          /**\n           * Someone occupies & not themselves\n           */\n          if (data?.Occupied && user && !user.self) {\n            UIModal.info({\n              okText: I18n.t('guidance_got_it'),\n              title: I18n.t('plugin_team_edit_tip_unable_to_edit'),\n              content: `${user.name}(${\n                // @ts-expect-error -- linter-disable-autofix\n                ROLE_TAG_TEXT_MAP[user.space_roly_type]\n              }) ${I18n.t('plugin_team_edit_tip_another_user_is_editing')}`,\n              hasCancel: false,\n            });\n\n            return true;\n          }\n\n          return false;\n        },\n        unlockPlugin: async () => {\n          const { pluginId, canEdit, isUnlocking, getIsIdePlugin } = get();\n          if (getIsIdePlugin()) {\n            return;\n          }\n\n          if (!canEdit) {\n            return;\n          }\n\n          if (isUnlocking) {\n            return;\n          }\n\n          try {\n            set(\n              produce<BotPluginStateAction>(s => {\n                s.isUnlocking = true;\n              }),\n              false,\n              'unlocking-true',\n            );\n\n            const resp = await PluginDevelopApi.UnlockPluginEdit({\n              plugin_id: pluginId,\n            });\n\n            if (resp.code !== 0) {\n              throw new CustomError(\n                REPORT_EVENTS.normalError,\n                getPluginErrorMessage('unlock'),\n              );\n            }\n          } finally {\n            set(\n              produce<BotPluginStateAction>(s => {\n                s.isUnlocking = false;\n              }),\n              false,\n              'unlocking-false',\n            );\n          }\n        },\n        updatePluginInfoByImmer: updateFn =>\n          set(\n            produce<BotPluginStateAction>(s => {\n              updateFn(s.pluginInfo);\n            }),\n            false,\n            'updatePluginInfoByImmer',\n          ),\n      })),\n      {\n        enabled: IS_DEV_MODE,\n        name: 'botStudio.botPlugin',\n      },\n    ),\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createContext,\n  type PropsWithChildren,\n  type FC,\n  useRef,\n  useContext,\n} from 'react';\n\nimport { useStoreWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { useCreation } from 'ahooks';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { CustomError } from '@coze-arch/bot-error';\n\nimport { type BotPluginStateAction } from './types/store/plugin';\nimport { type BotPluginStore } from './types/store';\nimport {\n  createPluginHistoryPanelUIStore,\n  type PluginHistoryPanelUIStore,\n} from './store/plugin-history-panel-ui';\nimport { createPluginStore } from './store/plugin';\n\ninterface StoreRef {\n  plugin?: BotPluginStore;\n}\n\nexport interface PluginNavType {\n  toResource?: (\n    res: string,\n    resID?: string,\n    query?: Record<string, string>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    options?: Record<string, any>,\n  ) => void;\n  // submodule\n  tool?: (\n    toolID: string,\n    query?: Record<string, string>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    options?: Record<string, any>,\n  ) => void;\n  mocksetList?: (\n    toolID: string,\n    query?: Record<string, string>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    options?: Record<string, any>,\n  ) => void;\n  mocksetDetail?: (\n    toolID: string,\n    mocksetID: string,\n    query?: Record<string, string>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    options?: Record<string, any>,\n  ) => void;\n  cloudIDE?: (\n    query?: Record<string, string>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    options?: Record<string, any>,\n  ) => void;\n}\n\nexport interface CallbacksType {\n  onUpdateDisplayName?: (displayName: string) => void;\n  onStatusChange?: (status: WidgetUIState) => void;\n}\n\nconst BotPluginStoreContext = createContext<{\n  storeRef: StoreRef;\n  callbacks: CallbacksType;\n  resourceNavigate: PluginNavType;\n  memorizedStoreSet: null | {\n    usePluginHistoryPanelUIStore: PluginHistoryPanelUIStore;\n  };\n}>({\n  storeRef: {\n    plugin: undefined,\n  },\n  callbacks: {},\n  resourceNavigate: {},\n  memorizedStoreSet: null,\n});\n\ninterface PluginHistoryControllerType {\n  reload: () => void;\n}\n\nconst BotPluginControllerContext = createContext<{\n  pluginHistoryController: { current: PluginHistoryControllerType | null };\n  registryPluginHistoryController: (\n    controller: PluginHistoryControllerType,\n  ) => void;\n}>({\n  pluginHistoryController: { current: null },\n  registryPluginHistoryController: () => 0,\n});\n\nexport type WidgetUIState = 'loading' | 'saving' | 'error' | 'normal';\n\nexport const BotPluginStoreProvider: FC<\n  PropsWithChildren<{\n    pluginID: string;\n    spaceID: string;\n    projectID?: string;\n    version?: string;\n\n    onUpdateDisplayName?: (displayName: string) => void;\n    onStatusChange?: (status: WidgetUIState) => void;\n    resourceNavigate: PluginNavType;\n  }>\n> = ({\n  pluginID,\n  spaceID,\n  projectID,\n  version,\n  children,\n  onUpdateDisplayName,\n  onStatusChange,\n  resourceNavigate,\n}) => {\n  const store = useRef<StoreRef>({});\n  const usePluginHistoryPanelUIStore = useCreation(\n    () => createPluginHistoryPanelUIStore(),\n    [],\n  );\n  const pluginHistoryControllerRef = useRef<PluginHistoryControllerType | null>(\n    null,\n  );\n\n  if (!store.current?.plugin) {\n    store.current.plugin = createPluginStore({\n      pluginID,\n      spaceID,\n      projectID,\n      version,\n    });\n  }\n\n  return (\n    <BotPluginStoreContext.Provider\n      value={{\n        storeRef: store.current,\n        memorizedStoreSet: { usePluginHistoryPanelUIStore },\n        callbacks: {\n          onUpdateDisplayName,\n          onStatusChange,\n        },\n        resourceNavigate,\n      }}\n    >\n      <BotPluginControllerContext.Provider\n        value={{\n          pluginHistoryController: pluginHistoryControllerRef,\n          registryPluginHistoryController: inputController => {\n            pluginHistoryControllerRef.current = inputController;\n          },\n        }}\n      >\n        {children}\n      </BotPluginControllerContext.Provider>\n    </BotPluginStoreContext.Provider>\n  );\n};\n\nexport const usePluginStore: <T>(\n  selector: (store: BotPluginStateAction) => T,\n) => T = selector => {\n  const ctx = useContext(BotPluginStoreContext);\n\n  if (!ctx.storeRef.plugin) {\n    throw new CustomError(REPORT_EVENTS.normalError, 'plugin store context');\n  }\n\n  return useStoreWithEqualityFn(ctx.storeRef.plugin, selector, shallow);\n};\n\nexport const usePluginStoreInstance = () => {\n  const ctx = useContext(BotPluginStoreContext);\n\n  if (!ctx.storeRef.plugin) {\n    throw new CustomError(REPORT_EVENTS.normalError, 'plugin store context');\n  }\n  return ctx.storeRef.plugin;\n};\n\nexport const usePluginCallbacks: () => CallbacksType = () => {\n  const {\n    callbacks: { onStatusChange, onUpdateDisplayName },\n  } = useContext(BotPluginStoreContext);\n\n  return { onStatusChange, onUpdateDisplayName };\n};\n\nexport const usePluginNavigate: () => PluginNavType = () => {\n  const { resourceNavigate } = useContext(BotPluginStoreContext);\n\n  return resourceNavigate;\n};\n\nexport const useMemorizedPluginStoreSet = () => {\n  const { memorizedStoreSet } = useContext(BotPluginStoreContext);\n  if (!memorizedStoreSet) {\n    throw new Error('plugin memorized store set not provided');\n  }\n  return memorizedStoreSet;\n};\n\nexport const usePluginHistoryController = () => {\n  const { pluginHistoryController } = useContext(BotPluginControllerContext);\n  return pluginHistoryController;\n};\n\nexport const usePluginHistoryControllerRegistry = () => {\n  const { registryPluginHistoryController } = useContext(\n    BotPluginControllerContext,\n  );\n  return registryPluginHistoryController;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const unlockByFetch = (pluginId: string) =>\n  fetch('/api/plugin_api/unlock_plugin_edit', {\n    keepalive: true,\n    method: 'POST',\n    body: JSON.stringify({\n      plugin_id: pluginId,\n    }),\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { unlockByFetch } from '../utils/fetch';\n\nexport const useUnmountUnlock = (pluginId: string) => {\n  useEffect(() => {\n    const unlock = () => unlockByFetch(pluginId);\n\n    window.addEventListener('beforeunload', unlock);\n\n    return () => {\n      window.removeEventListener('beforeunload', unlock);\n    };\n  }, []);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIModal } from '@coze-arch/bot-semi';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\n\nimport { getPluginErrorMessage } from '../utils/error';\nimport { ROLE_TAG_TEXT_MAP } from '../types';\n\nexport const checkOutPluginContext = async (pluginId: string) => {\n  const resp = await PluginDevelopApi.CheckAndLockPluginEdit({\n    plugin_id: pluginId,\n  });\n\n  if (resp.code !== 0) {\n    return false;\n  }\n\n  const { data } = resp;\n  const user = data?.user;\n\n  /**\n   * Someone occupies & not themselves\n   */\n  if (data?.Occupied && user && !user.self) {\n    UIModal.info({\n      okText: I18n.t('guidance_got_it'),\n      title: I18n.t('plugin_team_edit_tip_unable_to_edit'),\n      content: `${user.name}(${\n        // @ts-expect-error -- linter-disable-autofix\n        ROLE_TAG_TEXT_MAP[user.space_roly_type]\n      }) ${I18n.t('plugin_team_edit_tip_another_user_is_editing')}`,\n      hasCancel: false,\n    });\n\n    return true;\n  }\n\n  return false;\n};\n\nexport const unlockOutPluginContext = async (pluginId: string) => {\n  const resp = await PluginDevelopApi.UnlockPluginEdit({\n    plugin_id: pluginId,\n  });\n\n  if (resp.code !== 0) {\n    throw new CustomError(\n      REPORT_EVENTS.normalError,\n      getPluginErrorMessage('unlock out'),\n    );\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\n// All nodes are available by default and can be customized.\nexport const getEnabledNodeTypes = (_params: {\n  loopSelected: boolean;\n  isProject: boolean;\n  isSupportImageflowNodes: boolean;\n  isSceneFlow: boolean;\n  isBindDouyin: boolean;\n}) => {\n  const { loopSelected } = _params;\n  const nodesMap = {\n    [StandardNodeType.LLM]: true,\n    [StandardNodeType.Api]: true,\n    [StandardNodeType.Code]: true,\n    [StandardNodeType.Dataset]: true,\n    [StandardNodeType.If]: true,\n    [StandardNodeType.SubWorkflow]: true,\n    [StandardNodeType.Database]: true,\n    [StandardNodeType.Output]: true,\n    [StandardNodeType.Text]: true,\n    [StandardNodeType.Question]: true,\n    [StandardNodeType.Break]: loopSelected,\n    [StandardNodeType.SetVariable]: loopSelected,\n    [StandardNodeType.Continue]: loopSelected,\n    [StandardNodeType.Loop]: true,\n    [StandardNodeType.Intent]: true,\n    [StandardNodeType.DatasetWrite]: true,\n    [StandardNodeType.Batch]: true,\n    [StandardNodeType.Input]: true,\n    [StandardNodeType.Comment]: true,\n    [StandardNodeType.VariableMerge]: true,\n    [StandardNodeType.QueryMessageList]: true,\n    [StandardNodeType.ClearContext]: true,\n    [StandardNodeType.CreateConversation]: true,\n    [StandardNodeType.VariableAssign]: true,\n    [StandardNodeType.Http]: true,\n    [StandardNodeType.DatabaseUpdate]: true,\n    [StandardNodeType.DatabaseQuery]: true,\n    [StandardNodeType.DatabaseDelete]: true,\n    [StandardNodeType.DatabaseCreate]: true,\n    // [StandardNodeType.JsonParser]: true,\n    [StandardNodeType.JsonStringify]: true,\n    [StandardNodeType.UpdateConversation]: true,\n    [StandardNodeType.DeleteConversation]: true,\n    [StandardNodeType.QueryConversationList]: true,\n    [StandardNodeType.QueryConversationHistory]: true,\n    [StandardNodeType.CreateMessage]: true,\n    [StandardNodeType.UpdateMessage]: true,\n    [StandardNodeType.DeleteMessage]: true,\n  };\n  const enabledNodeTypes: StandardNodeType[] = Object.keys(nodesMap)\n    .filter(key => nodesMap[key])\n    .map(key => key as StandardNodeType);\n\n  return enabledNodeTypes;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * get asset upload cdn address\n * @param assetName asset name\n * @returns asset name with cdn address\n */\nexport function getUploadCDNAsset(assetName: string) {\n  // If the `UPLOAD_CDN` environment variable exists, use it\n  if (UPLOAD_CDN) {\n    return `${UPLOAD_CDN}/${assetName}`;\n  }\n\n  throw new Error('The UPLOAD_CDN environment variable is not configured');\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function useSupportImageflowNodesQuery() {\n  return {\n    isSupportImageflowNodes: true,\n    isLoading: false,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface ParamSchemaType {\n  name: string;\n  type: number;\n  children?: ParamSchemaType[];\n}\n\nexport function convertSchema(object, maxDepth = 20, currentDepth = 1) {\n  if (currentDepth > maxDepth) {\n    throw new Error('Max depth exceeded');\n  }\n\n  const paramSchema: ParamSchemaType[] = [];\n  Object.keys(object).forEach(key => {\n    const value = object[key];\n    switch (typeof value) {\n      case 'string':\n        paramSchema.push({\n          name: key,\n          type: 1 /* String */,\n        });\n        break;\n      case 'number':\n        if (Number.isInteger(value)) {\n          paramSchema.push({\n            name: key,\n            type: 2 /* Integer */,\n          });\n        } else {\n          paramSchema.push({\n            name: key,\n            type: 4 /* Number */,\n          });\n        }\n        break;\n      case 'boolean':\n        paramSchema.push({\n          name: key,\n          type: 3 /* Boolean */,\n        });\n        break;\n      case 'object':\n        if (value === null) {\n          break;\n        }\n        if (Array.isArray(value)) {\n          if (value.length > 0) {\n            switch (typeof value[0]) {\n              case 'string':\n                paramSchema.push({\n                  name: key,\n                  type: 99 /* ArrayString */,\n                });\n                break;\n              case 'number':\n                if (Number.isInteger(value[0])) {\n                  paramSchema.push({\n                    name: key,\n                    type: 100 /* ArrayInteger */,\n                  });\n                } else {\n                  paramSchema.push({\n                    name: key,\n                    type: 102 /* ArrayNumber */,\n                  });\n                }\n                break;\n              case 'boolean':\n                paramSchema.push({\n                  name: key,\n                  type: 101 /* ArrayBoolean */,\n                });\n                break;\n              case 'object':\n                paramSchema.push({\n                  name: key,\n                  type: 103 /* ArrayObject */,\n                  children: convertSchema(value[0], maxDepth, currentDepth + 1),\n                });\n                break;\n              default:\n                paramSchema.push({\n                  name: key,\n                  type: 99 /* ArrayString */,\n                });\n            }\n          } else {\n            paramSchema.push({\n              name: key,\n              type: 99 /* ArrayString */,\n            });\n          }\n        } else {\n          paramSchema.push({\n            name: key,\n            type: 6 /* Object */,\n            children: convertSchema(value, maxDepth, currentDepth + 1),\n          });\n        }\n        break;\n      default:\n        console.log('value,to default', value);\n        throw new Error('ContainsInvalidValue');\n    }\n  });\n  return paramSchema;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createTheme } from '@coze-editor/editor/preset-code';\nimport { type Extension } from '@codemirror/state';\n\nconst colors = {\n  background: '#151B27',\n};\n\nexport const createDarkTheme: () => Extension = () =>\n  createTheme({\n    variant: 'dark',\n    settings: {\n      background: colors.background,\n      foreground: '#fff',\n      caret: '#AEAFAD',\n      selection: '#d9d9d942',\n      gutterBackground: colors.background,\n      gutterForeground: '#FFFFFF63',\n      gutterBorderColor: 'transparent',\n      gutterBorderWidth: 0,\n      lineHighlight: '#272e3d36',\n      bracketColors: ['#FFEF61', '#DD99FF', '#78B0FF'],\n      tooltip: {\n        backgroundColor: '#363D4D',\n        color: '#fff',\n        border: 'none',\n      },\n      completionItemHover: {\n        backgroundColor: '#FFFFFF0F',\n      },\n      completionItemSelected: {\n        backgroundColor: '#FFFFFF17',\n      },\n      completionItemIcon: {\n        color: '#FFFFFFC9',\n      },\n      completionItemLabel: {\n        color: '#FFFFFFC9',\n      },\n      completionItemDetail: {\n        color: '#FFFFFF63',\n      },\n    },\n    styles: [],\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, lazy, Suspense, useMemo } from 'react';\n\nimport { type EditorOtherProps, type EditorProps } from '../../interface';\n\nconst LazyPythonEditor: FC<EditorProps> = lazy(async () => {\n  const { PythonEditor } = await import('./python-editor');\n  return { default: PythonEditor };\n});\n\nconst PythonEditor: FC<EditorProps> = props => (\n  <Suspense>\n    <LazyPythonEditor {...props} />\n  </Suspense>\n);\n\nconst LazyTypescriptEditor: FC<EditorProps> = lazy(async () => {\n  const { TypescriptEditor } = await import('./typescript-editor');\n  return { default: TypescriptEditor };\n});\n\nconst TypescriptEditor: FC<EditorProps> = props => (\n  <Suspense>\n    <LazyTypescriptEditor {...props} />\n  </Suspense>\n);\n\nexport const Editor = (props: EditorProps & EditorOtherProps) => {\n  const language = useMemo(\n    () => props.language || props.defaultLanguage,\n    [props.defaultLanguage, props.language],\n  );\n\n  if (language === 'python') {\n    return <PythonEditor {...props} />;\n  }\n\n  return <TypescriptEditor {...props} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo, type ReactNode } from 'react';\n\nimport { concatTestId, useNodeTestId } from '@coze-workflow/base';\nimport {\n  IconCozCodeFill,\n  IconCozPlayCircle,\n  IconCozSideCollapse,\n} from '@coze-arch/coze-design/icons';\nimport {\n  Select,\n  Tooltip,\n  Button,\n  IconButton,\n  Typography,\n} from '@coze-arch/coze-design';\n\nconst { Text } = Typography;\n\nimport { type EditorProps, type LanguageType } from '../../interface';\n\nimport style from './style.module.less';\n\nimport { I18n } from '@coze-arch/i18n';\n\nconst HELP_DOCUMENT_LINK = IS_OVERSEA\n  ? '/docs/guides/code_node?_lang=en'\n  : '/docs/guides/code_node';\n\ninterface Props extends EditorProps {\n  children: ReactNode;\n  onLanguageSelect?: (language: LanguageType) => void;\n  language: LanguageType;\n}\n\nexport const Layout = ({\n  children,\n  title,\n  language,\n  onClose,\n  onTestRun,\n  testRunIcon,\n  onLanguageSelect,\n  languageTemplates,\n}: Props) => {\n  const optionList = useMemo(\n    () =>\n      languageTemplates?.map(e => ({\n        value: e.language,\n        label: e.displayName,\n      })),\n    [languageTemplates],\n  );\n\n  const { getNodeSetterId } = useNodeTestId();\n  const setterTestId = getNodeSetterId('biz-editor-layout');\n\n  return (\n    <div className={style.container}>\n      <div className={style.header}>\n        <div className={style.title}>\n          <div className={style['title-icon']}>\n            <IconCozCodeFill />\n          </div>\n          <div className={style['title-content']}>{title}</div>\n\n          <Tooltip\n            content={\n              <div>\n                {I18n.t('code_node_more_info')}\n                <Text link={{ href: HELP_DOCUMENT_LINK, target: '_blank' }}>\n                  {I18n.t('code_node_help_doc')}\n                </Text>\n              </div>\n            }\n            theme={'dark'}\n          >\n            <Select\n              onChange={value => onLanguageSelect?.(value as LanguageType)}\n              value={language}\n              data-testid={concatTestId(setterTestId, 'language-select')}\n              renderSelectedItem={item => (\n                <span\n                  style={{\n                    fontSize: 12,\n                    color: 'var(--coz-fg-secondary)',\n                  }}\n                >\n                  {I18n.t('code_node_language')} {item.label}\n                </span>\n              )}\n              size={'small'}\n              optionList={optionList}\n            ></Select>\n          </Tooltip>\n        </div>\n\n        <div style={{ display: 'flex', gap: 8 }}>\n          <Button\n            color={'highlight'}\n            data-testid={concatTestId(setterTestId, 'test-run')}\n            icon={\n              testRunIcon ? (\n                <span\n                  style={{\n                    fontSize: 14,\n                    display: 'flex',\n                    alignItems: 'center',\n                  }}\n                >\n                  {testRunIcon}\n                </span>\n              ) : (\n                <IconCozPlayCircle style={{ fontSize: 14 }} />\n              )\n            }\n            size={'small'}\n            onClick={onTestRun}\n          >\n            {I18n.t('code_node_test_code')}\n          </Button>\n\n          <IconButton\n            onClick={onClose}\n            color={'secondary'}\n            size={'small'}\n            icon={<IconCozSideCollapse style={{ fontSize: 18 }} />}\n            data-testid={concatTestId(setterTestId, 'expand-button')}\n          />\n        </div>\n      </div>\n      {children}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozWarningCircleFill } from '@coze-arch/coze-design/icons';\nimport { Modal } from '@coze-arch/coze-design';\n\nimport { Layout } from '../layout';\nimport { type EditorProps, type LanguageType } from '../../interface';\nimport { Editor } from './editor';\n\nexport const BizEditor = (props: EditorProps) => {\n  const editorApi = useRef<undefined | { getValue?: () => string }>(undefined);\n\n  const [language, setLanguage] = useState<LanguageType>(props.defaultLanguage);\n  const [content, setContent] = useState<string | undefined>(\n    props.defaultContent,\n  );\n\n  const handleLanguageChange = (value: LanguageType) => {\n    const langTemplate = props.languageTemplates?.find(\n      e => e.language === value,\n    );\n\n    const preLangTemplate = props.languageTemplates?.find(\n      e => e.language === language,\n    );\n\n    if (preLangTemplate?.template === editorApi.current?.getValue?.()) {\n      setLanguage(value);\n      setContent(langTemplate?.template);\n      props.onChange?.(langTemplate?.template || '', value);\n      return;\n    }\n\n    Modal.warning({\n      icon: (\n        <IconCozWarningCircleFill\n          style={{ color: 'rgba(var(--coze-yellow-5), 1)' }}\n        />\n      ),\n      title: I18n.t('code_node_switch_language'),\n      content: I18n.t('code_node_switch_language_description'),\n      okType: 'warning',\n      okText: I18n.t('Confirm'),\n      cancelText: I18n.t('Cancel'),\n      closable: true,\n      width: 448,\n      height: 160,\n      onOk: () => {\n        setLanguage(value);\n        setContent(langTemplate?.template);\n        props.onChange?.(langTemplate?.template || '', value);\n      },\n    });\n  };\n\n  return (\n    <>\n      <Layout\n        {...props}\n        language={language}\n        onLanguageSelect={handleLanguageChange}\n      >\n        <Editor\n          {...props}\n          defaultContent={content}\n          language={language}\n          didMount={api => {\n            editorApi.current = api;\n          }}\n        />\n      </Layout>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useRef } from 'react';\n\nimport { type EditorAPI } from '../editor/preset';\nimport { Editor } from '../editor';\nimport { type PreviewerProps } from '../../interface';\n\nexport const Previewer = (props: PreviewerProps) => {\n  const apiRef = useRef<EditorAPI | null>();\n\n  useEffect(() => {\n    if (!apiRef.current) {\n      return;\n    }\n\n    if (props.content !== apiRef.current.getValue()) {\n      apiRef.current.forceSetValue(props.content);\n    }\n  }, [props.content]);\n\n  return (\n    <Editor\n      uuid={`previewer_${new Date().getTime()}`}\n      height={`${props.height}px`}\n      defaultLanguage={props.language}\n      defaultContent={props.content}\n      readonly\n      didMount={api => {\n        apiRef.current = api;\n      }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { themes } from '@coze-editor/editor/preset-code';\n\nimport { convertSchema } from './utils';\nimport { type PreviewerProps, type EditorProps } from './interface';\nimport { createDarkTheme } from './components/theme';\nimport { Previewer } from './components/previewer';\nimport { BizEditor as Editor } from './components/editor';\n\nthemes.register('code-editor-dark', createDarkTheme());\n\nexport {\n  Previewer,\n  Editor,\n  type PreviewerProps,\n  type EditorProps,\n  convertSchema,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum PublishWorkflowModal {\n  PUBLISH_RESULT = 'publishResult',\n  WORKFLOW = 'workflow',\n  WORKFLOW_INFO = 'workflowDetail',\n  WORKFLOW_CASE = 'workflowCase',\n}\n\nexport const usePublishWorkflowModal = _options => ({\n  ModalComponent: null,\n  showModal: _modalOptions => null,\n  setSpace: _spaceId => null,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\nimport { useState, useCallback, useEffect, useRef } from 'react';\n\ninterface IAudioPlayerOptions {\n  // Whether to play automatically\n  autoPlay?: boolean;\n  // Whether to loop\n  loop?: boolean;\n  // end of play callback\n  onEnded?: () => void;\n  // load completion callback\n  onLoad?: () => void;\n}\n\ninterface IAudioPlayer {\n  // Is it playing?\n  isPlaying: boolean;\n  // Whether to pause\n  isPaused: boolean;\n  // Whether to stop\n  isStopped: boolean;\n  // current playing time\n  currentTime: number;\n  // total audio duration\n  duration: number;\n  // play\n  play: () => void;\n  // pause\n  pause: () => void;\n  // Stop\n  stop: () => void;\n  // toggle playback pause\n  togglePlayPause: () => void;\n  // jump\n  seek: (time: number) => void;\n}\n\n/**\n * Audio Player Hook\n * @Param src - audio files\n * @Param options - player configuration options\n * @Returns Audio Player Control Interface\n */\nexport const useAudioPlayer = (\n  src: File | string | undefined | null,\n  { autoPlay, loop, onEnded, onLoad }: IAudioPlayerOptions = {},\n): IAudioPlayer => {\n  // playback state management\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isPaused, setIsPaused] = useState(false);\n  const [isStopped, setIsStopped] = useState(true);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n\n  // audio element reference\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n\n  // Initialize audio elements and event listeners\n  useEffect(() => {\n    if (!src) {\n      return;\n    }\n\n    const url = src instanceof Blob ? URL.createObjectURL(src) : src;\n    // Create audio instance\n    const audio = new Audio(url);\n    audioRef.current = audio;\n\n    // Set up loop playback\n    audio.loop = loop ?? false;\n\n    // Update the handler for the current playback time\n    const handleTimeUpdate = () => {\n      setCurrentTime(audio.currentTime);\n    };\n\n    // The processing function for the completion of metadata loading (to obtain information such as audio duration)\n    const handleLoadedMetadata = () => {\n      setDuration(audio.duration);\n      setCurrentTime(0);\n      onLoad?.();\n\n      if (autoPlay) {\n        audio.play();\n      }\n\n      if (src instanceof Blob) {\n        // Release the URL of the audio file to avoid memory leaks\n        URL.revokeObjectURL(url);\n      }\n    };\n\n    // Handler function for end of playback\n    const handleEnded = () => {\n      setIsPlaying(false);\n      setIsStopped(true);\n      setCurrentTime(audio.duration);\n      onEnded?.();\n    };\n\n    // Add event listeners\n    audio.addEventListener('loadedmetadata', handleLoadedMetadata);\n    audio.addEventListener('timeupdate', handleTimeUpdate);\n    audio.addEventListener('ended', handleEnded);\n\n    // Cleanup function: removes event listeners and frees resources when a component is unloaded\n    return () => {\n      audio.removeEventListener('loadedmetadata', handleLoadedMetadata);\n      audio.removeEventListener('timeupdate', handleTimeUpdate);\n      audio.removeEventListener('ended', handleEnded);\n\n      audio.pause();\n      audio.src = '';\n      audioRef.current = null;\n    };\n  }, [src, autoPlay, loop, onEnded, onLoad]);\n\n  // playback control function\n  const play = useCallback(() => {\n    if (audioRef.current) {\n      audioRef.current.play();\n      setIsPlaying(true);\n      setIsPaused(false);\n      setIsStopped(false);\n    }\n  }, []);\n\n  // pause control function\n  const pause = useCallback(() => {\n    if (audioRef.current) {\n      audioRef.current.pause();\n      setIsPlaying(false);\n      setIsPaused(true);\n    }\n  }, []);\n\n  // Stop control function\n  const stop = useCallback(() => {\n    if (audioRef.current) {\n      audioRef.current.pause();\n      audioRef.current.currentTime = 0;\n      setIsPlaying(false);\n      setIsPaused(false);\n      setIsStopped(true);\n    }\n  }, []);\n\n  // Switch play/pause state\n  const togglePlayPause = useCallback(() => {\n    if (isPlaying) {\n      pause();\n    } else {\n      play();\n    }\n  }, [isPlaying, play, pause]);\n\n  // Jump to the specified time\n  const seek = useCallback((time: number) => {\n    if (audioRef.current) {\n      audioRef.current.currentTime = time;\n      setCurrentTime(time);\n    }\n  }, []);\n\n  // Back to Audio Player Control Interface\n  return {\n    isPlaying,\n    isPaused,\n    isStopped,\n    currentTime,\n    duration,\n    play,\n    pause,\n    stop,\n    togglePlayPause,\n    seek,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file The open source version does not provide timbre-related capabilities\n */\n\nexport function useSelectVoiceModal(_options: unknown) {\n  return {\n    open: () => {\n      // add your custom logic here\n    },\n    modal: null,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file The open source version does not currently provide multi-person collaboration capabilities\n */\nimport { create } from 'zustand';\n\nexport const CollaboratorsBtn = _props => null;\nexport const getIsCozePro = _props => false;\n\ninterface CozeProRightsStore {\n  rightsInfo: {};\n  getRights: (refresh?: boolean) => Promise<{}>;\n}\n\nexport const useCozeProRightsStore = create<CozeProRightsStore>(() => ({\n  rightsInfo: {},\n  getRights: _refresh => Promise.resolve({}),\n}));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DouyinKnowledgeListModal = _props => null;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file The open source version does not currently provide AI generation capabilities\n */\n\nimport React, { type PropsWithChildren } from 'react';\n\nexport const NLPromptButton = _props => null;\nexport const NLPromptModal = _props => null;\nexport const NlPromptAction = _props => null;\nexport const NlPromptShortcut = _props => null;\nexport const NLPromptProvider: React.FC<PropsWithChildren> = ({ children }) => (\n  <>{children}</>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const useWorkflowPublishEntry = (): { enablePublishEntry: boolean } => ({\n  enablePublishEntry: false,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\n\nexport const workflowQueryClient = new QueryClient();\n\n// eslint-disable-next-line @typescript-eslint/naming-convention, @typescript-eslint/no-explicit-any\nexport function withQueryClient<T extends FC<any>>(Component: T): T {\n  return function WrappedComponent(props) {\n    return (\n      <QueryClientProvider client={workflowQueryClient}>\n        <Component {...props} />\n      </QueryClientProvider>\n    );\n  } as T;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { workflowApi as archWorkflowApi } from '@coze-arch/bot-api';\n\n// eslint-disable-next-line @coze-arch/no-batch-import-or-export\nexport * from '@coze-arch/bot-api/workflow_api';\n\nexport { withQueryClient, workflowQueryClient } from './with-query-client';\n\n/** Operating the interface platform will replace permission verification */\nconst workflowOperationApiNameMap = {\n  GetHistorySchema: 'OPGetHistorySchema',\n  GetWorkFlowProcess: 'OPGetWorkFlowProcess',\n  GetCanvasInfo: 'OPGetCanvasInfo',\n  GetWorkflowReferences: 'OPGetWorkflowReferences',\n  GetReleasedWorkflows: 'OPGetReleasedWorkflows',\n  GetApiDetail: 'OPGetApiDetail',\n  NodeTemplateList: 'OPNodeTemplateList',\n  GetWorkflowGrayFeature: 'OPGetWorkflowGrayFeature',\n  CheckLatestSubmitVersion: 'OPCheckLatestSubmitVersion',\n  GetImageflowBasicNodeList: 'OPGetImageflowBasicNodeList',\n  GetWorkflowDetail: 'OPGetWorkflowDetail',\n  GetLLMNodeFCSettingDetail: 'OPGetLLMNodeFCSettingDetail',\n  ListTriggerAppEvents: 'OPListTriggerAppEvents',\n  GetTrigger: 'OPGetTrigger',\n  GetWorkflowDetailInfo: 'OPGetWorkflowDetailInfo',\n  GetNodeExecuteHistory: 'OPGetNodeExecuteHistory',\n  VersionHistoryList: 'OPVersionHistoryList',\n  GetChatFlowRole: 'OPGetChatFlowRole',\n  ListRootSpans: 'OPListRootSpans',\n  GetTraceSDK: 'OPGetTraceSDK',\n};\n\nconst workflowApi: typeof archWorkflowApi = new Proxy(\n  {} as unknown as typeof archWorkflowApi,\n  {\n    get: (target, name: string) => {\n      if (IS_BOT_OP && workflowOperationApiNameMap[name]) {\n        return archWorkflowApi[workflowOperationApiNameMap[name]].bind(\n          archWorkflowApi,\n        );\n      } else {\n        return archWorkflowApi[name].bind(archWorkflowApi);\n      }\n    },\n  },\n);\n\nexport { workflowApi };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** empty method */\nexport const EmptyFunction = () => {\n  /** empty method */\n};\nexport const EmptyAsyncFunction = () => Promise.resolve();\n\n/** Public space ID */\nexport const PUBLIC_SPACE_ID = '999999';\n\n/** BOT_USER_INPUT variable name */\nexport const BOT_USER_INPUT = 'BOT_USER_INPUT';\n\n/** USER_INPUT parameters, the new version BOT_USER_INPUT parameters, the same function as BOT_USER_INPUT, Coze2.0 Chatflow requirements are introduced */\nexport const USER_INPUT = 'USER_INPUT';\n\n/** CONVERSATION_NAME variable name, start node session name imported parameter */\nexport const CONVERSATION_NAME = 'CONVERSATION_NAME';\n\n/**\n * Workflow name Maximum number of characters\n */\nexport const WORKFLOW_NAME_MAX_LEN = 30;\n\n/**\n * workflow naming regular\n */\nexport const WORKFLOW_NAME_REGEX = /^[a-zA-Z][a-zA-Z0-9_]{0,63}$/;\n\n/**\n * Node test ID prefix\n */\nexport const NODE_TEST_ID_PREFIX = 'playground.node';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum SchemaExtractorParserName {\n  DEFAULT = 'default',\n  INPUT_PARAMETERS = 'inputParameters',\n  OUTPUTS = 'outputs',\n  DATASET_PARAM = 'datasetParam',\n  LLM_PARAM = 'llmParam',\n  INTENTS = 'intents',\n  CONCAT_RESULT = 'concatResult',\n  CUSTOM_ARRAY_CONCAT_CHAR = 'customArrayConcatChar',\n  CUSTOM_SPLIT_CHAR = 'customSplitChar',\n  REF_INPUT_PARAMETER = 'refInputParameter',\n  VARIABLE_ASSIGN = 'variableAssign',\n  JSON_STRING_PARSER = 'jsonStringParser',\n  IMAGE_REFERENCE_PARSER = 'imageReferenceParser',\n  EXPRESSION_PARSER = 'expressionParser',\n  VARIABLE_MERGE_GROUPS_PARSER = 'variableMergeGroupsParser',\n  DB_FIELDS_PARSER = 'dbFieldsParser',\n  DB_CONDITIONS_PARSER = 'dbConditionsParser',\n}\n\nexport const SYSTEM_DELIMITERS = [\n  '\\n',\n  '\\t',\n  '.',\n  '',\n  ',',\n  '',\n  ';',\n  '',\n  ' ',\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable security/detect-object-injection -- no-need */\n/* eslint-disable @typescript-eslint/no-namespace -- no-need */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any -- no-need\nexport type TraverseValue = any;\nexport interface TraverseNode {\n  value: TraverseValue;\n  container?: TraverseValue;\n  parent?: TraverseNode;\n  key?: string;\n  index?: number;\n}\n\nexport interface TraverseContext {\n  node: TraverseNode;\n  setValue: (value: TraverseValue) => void;\n  getParents: () => TraverseNode[];\n  getPath: () => Array<string | number>;\n  getStringifyPath: () => string;\n  deleteSelf: () => void;\n}\n\nexport type TraverseHandler = (context: TraverseContext) => void;\n\n/**\n * Traverse the object in depth, processing each value\n * @param value over object\n * @param handling function\n */\nexport const traverse = <T extends TraverseValue = TraverseValue>(\n  value: T,\n  handler: TraverseHandler | TraverseHandler[],\n): T => {\n  const traverseHandler: TraverseHandler = Array.isArray(handler)\n    ? (context: TraverseContext) => {\n        handler.forEach(handlerFn => handlerFn(context));\n      }\n    : handler;\n  TraverseUtils.traverseNodes({ value }, traverseHandler);\n  return value;\n};\n\nnamespace TraverseUtils {\n  /**\n   * Traverse the object in depth, processing each value\n   * @param node traverse node\n   * @param handling function\n   */\n  export const traverseNodes = (\n    node: TraverseNode,\n    handle: TraverseHandler,\n  ): void => {\n    const { value } = node;\n    if (!value) {\n      // exception handling\n      return;\n    }\n    if (Object.prototype.toString.call(value) === '[object Object]') {\n      // Object, iterate through each property of the object\n      Object.entries(value).forEach(([key, item]) =>\n        traverseNodes(\n          {\n            value: item,\n            container: value,\n            key,\n            parent: node,\n          },\n          handle,\n        ),\n      );\n    } else if (Array.isArray(value)) {\n      // Array, iterate through each element of the array\n      // The iteration starts at the end of the array, so that even if an element is removed halfway through, it will not affect the index of the unprocessed element\n      for (let index = value.length - 1; index >= 0; index--) {\n        const item: string = value[index];\n        traverseNodes(\n          {\n            value: item,\n            container: value,\n            index,\n            parent: node,\n          },\n          handle,\n        );\n      }\n    }\n    const context: TraverseContext = createContext({ node });\n    handle(context);\n  };\n\n  const createContext = ({\n    node,\n  }: {\n    node: TraverseNode;\n  }): TraverseContext => ({\n    node,\n    setValue: (value: unknown) => setValue(node, value),\n    getParents: () => getParents(node),\n    getPath: () => getPath(node),\n    getStringifyPath: () => getStringifyPath(node),\n    deleteSelf: () => deleteSelf(node),\n  });\n\n  const setValue = (node: TraverseNode, value: unknown) => {\n    // Set Value Function\n    // Reference type, you need to modify the value with the help of the parent element\n    // Since it is a recursive traversal, it is necessary to determine which property of the object to assign a value to, or which element of the array to assign a value to, according to node\n    if (!value || !node) {\n      return;\n    }\n    node.value = value;\n    // Remove container, key, index from upper scope node\n    const { container, key, index } = node;\n    if (key && container) {\n      container[key] = value;\n    } else if (typeof index === 'number') {\n      container[index] = value;\n    }\n  };\n\n  const getParents = (node: TraverseNode): TraverseNode[] => {\n    const parents: TraverseNode[] = [];\n    let currentNode: TraverseNode | undefined = node;\n    while (currentNode) {\n      parents.unshift(currentNode);\n      currentNode = currentNode.parent;\n    }\n    return parents;\n  };\n\n  const getPath = (node: TraverseNode): Array<string | number> => {\n    const path: Array<string | number> = [];\n    const parents = getParents(node);\n    parents.forEach(parent => {\n      if (parent.key) {\n        path.unshift(parent.key);\n      } else if (parent.index) {\n        path.unshift(parent.index);\n      }\n    });\n    return path;\n  };\n\n  const getStringifyPath = (node: TraverseNode): string => {\n    const path = getPath(node);\n    return path.reduce((stringifyPath: string, pathItem: string | number) => {\n      if (typeof pathItem === 'string') {\n        const re = /\\W/g;\n        if (re.test(pathItem)) {\n          // Contains special characters\n          return `${stringifyPath}[\"${pathItem}\"]`;\n        }\n        return `${stringifyPath}.${pathItem}`;\n      } else {\n        return `${stringifyPath}[${pathItem}]`;\n      }\n    }, '');\n  };\n\n  const deleteSelf = (node: TraverseNode): void => {\n    const { container, key, index } = node;\n    if (key && container) {\n      delete container[key];\n    } else if (typeof index === 'number') {\n      container.splice(index, 1);\n    }\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\n\nimport { type ValueExpressionDTO } from '../../types';\n\n// Whether we upload the generated url ourselves, this is a temporary solution, after fixing the type: string - > type: image in the schema, delete this logic\nexport function isWorkflowImageTypeURL(str: string): boolean {\n  // base64 processing\n  const hostWhiteList = [\n    'cC1ib3Qtd29ya2Zsb3ctc2lnbi5ieXRlZGFuY2UubmV0',\n    'cC1ib3Qtd29ya2Zsb3cuYnl0ZWQub3Jn',\n    'cC1ib3Qtd29ya2Zsb3cuYnl0ZWRhbmNlLm5ldA==',\n    'cDI2LWJvdC13b3JrZmxvdy1zaWduLmJ5dGVpbWcuY29t',\n    'cDMtYm90LXdvcmtmbG93LXNpZ24uYnl0ZWltZy5jb20=',\n    'cDktYm90LXdvcmtmbG93LXNpZ24uYnl0ZWltZy5jb20=',\n  ];\n  const suffixWhiteList = ['image', 'jpg', 'jpeg', 'png'];\n\n  let urlObj;\n\n  try {\n    urlObj = new URL(str);\n  } catch (_) {\n    return false;\n  }\n\n  const suffix =\n    urlObj.searchParams?.get('x-wf-file_name')?.split('.')?.pop() ||\n    urlObj.pathname.split('.').pop();\n\n  if (!suffixWhiteList.includes(suffix)) {\n    return false;\n  }\n\n  if (!hostWhiteList.includes(btoa(urlObj.hostname ?? ''))) {\n    return false;\n  }\n\n  return true;\n}\n\nexport const parseExpression = (expression?: ValueExpressionDTO) => {\n  if (!expression) {\n    return null;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const content = get(expression, 'value.content') as any;\n  if (!content) {\n    return null;\n  } else if (typeof content === 'string') {\n    return {\n      value: content,\n      isImage: isWorkflowImageTypeURL(content),\n    };\n  } else if (content.source === 'block-output' && typeof content.name) {\n    return {\n      value: content.name,\n      isImage: false,\n    };\n  } else if (\n    typeof content.source === 'string' &&\n    content.source.startsWith('global_variable')\n  ) {\n    return {\n      value: content?.path?.join('.'),\n      isImage: false,\n    };\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { parseExpression } from '../utils';\nimport { type SchemaExtractorExpressionParser } from '../type';\nimport type { ValueExpressionDTO } from '../../../types';\nexport const expressionParser: SchemaExtractorExpressionParser = expression => {\n  const expressions = ([] as ValueExpressionDTO[])\n    .concat(expression)\n    .filter(Boolean);\n  return expressions\n    .map(parseExpression)\n    .filter(Boolean) as ReturnType<SchemaExtractorExpressionParser>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SchemaExtractorVariableAssignParser } from '../type';\nimport { type ValueExpressionDTO, type DTODefine } from '../../../types';\n\nconst getValueExpressionName = (\n  valueExpression: ValueExpressionDTO,\n): string | undefined => {\n  const content = valueExpression?.value?.content as\n    | DTODefine.RefExpressionContent\n    | string;\n  if (!content) {\n    return;\n  }\n  if (typeof content === 'string') {\n    return content;\n  } else if (typeof content === 'object') {\n    if (content.source === 'block-output' && typeof content.name === 'string') {\n      return content.name;\n    } else if (\n      typeof content.source === 'string' &&\n      content.source.startsWith('global_variable')\n    ) {\n      return (\n        content as {\n          source: `global_variable_${string}`;\n          path: string[];\n          blockID: string;\n          name: string;\n        }\n      )?.path?.join('.');\n    }\n  }\n};\n\nexport const variableAssignParser: SchemaExtractorVariableAssignParser =\n  variableAssigns => {\n    if (!Array.isArray(variableAssigns)) {\n      return [];\n    }\n\n    return variableAssigns\n      .map(variableAssign => {\n        const leftContent = getValueExpressionName(variableAssign.left);\n        const rightContent = getValueExpressionName(variableAssign.right);\n        // Rvalue field of variable assignment node\n        const inputContent = variableAssign.input\n          ? getValueExpressionName(variableAssign.input)\n          : null;\n        return {\n          name: leftContent ?? '',\n          value: rightContent ?? inputContent ?? '',\n        };\n      })\n      .filter(Boolean) as ReturnType<SchemaExtractorVariableAssignParser>;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\n\nimport { parseExpression } from '../utils';\nimport { type SchemaExtractorInputParametersParser } from '../type';\nimport type { InputValueDTO } from '../../../types';\nexport const inputParametersParser: SchemaExtractorInputParametersParser =\n  inputParameters => {\n    let parameters: InputValueDTO[] = [];\n    if (!Array.isArray(inputParameters)) {\n      if (typeof inputParameters === 'object') {\n        Object.keys(inputParameters || {}).forEach(key => {\n          parameters.push({\n            name: key,\n            input: inputParameters[key],\n          });\n        });\n      }\n    } else {\n      parameters = inputParameters;\n    }\n\n    return parameters\n      .map(inputParameter => {\n        const expression = get(inputParameter, 'input');\n        const parsedExpression = parseExpression(expression);\n        if (!parsedExpression) {\n          return null;\n        }\n        return {\n          name: inputParameter.name,\n          ...parsedExpression,\n        };\n      })\n      .filter(Boolean) as ReturnType<SchemaExtractorInputParametersParser>;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SchemaExtractorParser } from '../type';\nimport { SchemaExtractorParserName } from '../constant';\nimport { variableMergeGroupsParser } from './variable-merge-groups-parser';\nimport { variableAssignParser } from './variable-assign';\nimport { refInputParametersParser } from './ref-input-parameters';\nimport { outputsParser } from './output';\nimport { llmParamParser } from './llm-param';\nimport { jsonStringParser } from './json-string-parser';\nimport { intentsParser } from './intents';\nimport { inputParametersParser } from './input-parameters';\nimport { imageReferenceParser } from './image-reference';\nimport { expressionParser } from './expression-parser';\nimport { dbFieldsParser } from './db-fields';\nimport { dbConditionsParser } from './db-conditions';\nimport { datasetParamParser } from './dataset-param';\nimport { splitCharParser } from './custom-split-char';\nimport { arrayConcatCharParser } from './custom-array-concat-char';\nimport { concatResultParser } from './concat-result';\n\nexport const schemaExtractorParsers: Record<\n  SchemaExtractorParserName,\n  SchemaExtractorParser\n> = {\n  [SchemaExtractorParserName.DEFAULT]: t => t,\n  [SchemaExtractorParserName.INPUT_PARAMETERS]: inputParametersParser,\n  [SchemaExtractorParserName.OUTPUTS]: outputsParser,\n  [SchemaExtractorParserName.DATASET_PARAM]: datasetParamParser,\n  [SchemaExtractorParserName.LLM_PARAM]: llmParamParser,\n  [SchemaExtractorParserName.INTENTS]: intentsParser,\n  [SchemaExtractorParserName.CONCAT_RESULT]: concatResultParser,\n  [SchemaExtractorParserName.CUSTOM_ARRAY_CONCAT_CHAR]: arrayConcatCharParser,\n  [SchemaExtractorParserName.CUSTOM_SPLIT_CHAR]: splitCharParser,\n  [SchemaExtractorParserName.REF_INPUT_PARAMETER]: refInputParametersParser,\n  [SchemaExtractorParserName.VARIABLE_ASSIGN]: variableAssignParser,\n  [SchemaExtractorParserName.JSON_STRING_PARSER]: jsonStringParser,\n  [SchemaExtractorParserName.IMAGE_REFERENCE_PARSER]: imageReferenceParser,\n  [SchemaExtractorParserName.EXPRESSION_PARSER]: expressionParser,\n  [SchemaExtractorParserName.VARIABLE_MERGE_GROUPS_PARSER]:\n    variableMergeGroupsParser,\n  [SchemaExtractorParserName.DB_FIELDS_PARSER]: dbFieldsParser,\n  [SchemaExtractorParserName.DB_CONDITIONS_PARSER]: dbConditionsParser,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { NODE_TEST_ID_PREFIX } from '../constants';\n\nexport const concatTestId = (...testIds: string[]) =>\n  testIds.filter(id => !!id).join('.');\n\n/**\n * Generate the test ID of the node.\n * @example concatNodeTestId(node, 'right-panel') => playground.node.100001.right-panel\n * @param node\n * @param testIds other id\n * @returns\n */\nexport const concatNodeTestId = (node: FlowNodeEntity, ...testIds: string[]) =>\n  concatTestId(\n    node?.id ? concatTestId(NODE_TEST_ID_PREFIX, node.id) : '',\n    ...testIds,\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { flatten, get } from 'lodash-es';\nimport { type WorkflowNodeJSON } from '@flowgram-adapter/free-layout-editor';\n\nimport { StandardNodeType, VariableTypeDTO, AssistTypeDTO } from '../types';\n\ninterface Schema {\n  type: VariableTypeDTO;\n  name: string;\n  schema: Schema | Schema[];\n  assistType: AssistTypeDTO;\n}\n\nconst isImageType = (schema: Schema) => {\n  if (\n    schema?.type === VariableTypeDTO.image ||\n    (schema?.type === VariableTypeDTO.string &&\n      [AssistTypeDTO.image, AssistTypeDTO.svg].includes(schema?.assistType))\n  ) {\n    return true;\n  }\n};\n\nfunction getImgList(data: unknown, schema: Schema): string[] {\n  let imgList: string[] = [];\n\n  if (isImageType(schema) && typeof data === 'string') {\n    imgList.push(data);\n  }\n\n  if (schema?.type === VariableTypeDTO.list && Array.isArray(data)) {\n    const imgListInItems = (data as unknown[]).map(item =>\n      getImgList(item, schema.schema as Schema),\n    );\n    imgList = imgList.concat(...imgListInItems);\n  }\n\n  if (schema?.type === VariableTypeDTO.object) {\n    const imgListInObject = Object.entries(\n      (data as Record<string, unknown>) || {},\n    ).map(([key, value]) =>\n      getImgList(\n        value,\n        ((schema.schema as Schema[]) || []).find(\n          item => item.name === key,\n        ) as Schema,\n      ),\n    );\n    imgList = imgList.concat(...imgListInObject);\n  }\n\n  return imgList;\n}\n\n/**\n * Parse image links from node output data\n * @Param outputData node output data JSON serialized string\n * @param nodeSchema\n * @Param excludeNodeTypes does not resolve image links for nodes of this type\n */\nexport function parseImagesFromOutputData({\n  outputData,\n  nodeSchema,\n  excludeNodeTypes = [],\n}: {\n  outputData?: any;\n  nodeSchema?: WorkflowNodeJSON;\n  excludeNodeTypes?: StandardNodeType[];\n}): string[] {\n  if (!nodeSchema || !outputData) {\n    return [];\n  }\n  if (excludeNodeTypes.includes(nodeSchema?.type as StandardNodeType)) {\n    return [];\n  }\n  let outputParameters: any[] = [];\n  if (\n    nodeSchema?.type === StandardNodeType.End ||\n    nodeSchema?.type === StandardNodeType.Output\n  ) {\n    outputParameters = (nodeSchema?.data?.inputs as any)?.inputParameters;\n  } else {\n    outputParameters = nodeSchema?.data?.outputs as any[];\n  }\n  if (!outputParameters) {\n    return [];\n  }\n\n  const imgListInOutput = flatten(\n    outputParameters.map(p =>\n      getImgList(\n        get(outputData, p?.name),\n        p?.input\n          ? {\n              ...p.input,\n              name: p.name,\n            }\n          : p,\n      ),\n    ),\n  ).filter(url => !!url);\n\n  return imgListInOutput;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reporter as infraReporter } from '@coze-arch/logger';\nconst namespace = 'workflow';\n\n/**\n * The slardar reporting instance used by the process\n */\nexport const reporter = infraReporter.createReporterWithPreset({\n  namespace,\n});\n\n/**\n * Exception capture will be reported as a js error\n * @param exception\n * @param importErrorInfo\n */\nexport function captureException(exception: Error) {\n  infraReporter.slardarInstance?.('captureException', exception, {\n    isErrorBoundary: 'false',\n    namespace,\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport { isFormV2 } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\n/**\n * Find the FormItem ending in pathEnds and get its value\n * @param node\n * @param pathEnds\n * @returns\n */\nexport function getFormValueByPathEnds<T = unknown>(\n  node: FlowNodeEntity,\n  pathEnds: string,\n): T | undefined {\n  return isFormV2(node)\n    ? getFormValueByPathEndsV2<T>(node, pathEnds)\n    : getFormValueByPathEndsV1<T>(node, pathEnds);\n}\n\nfunction getFormValueByPathEndsV1<T = unknown>(\n  node: FlowNodeEntity,\n  pathEnds: string,\n): T | undefined {\n  const form = node.getData(FlowNodeFormData).formModel;\n\n  const paths: string[] = [...form.formItemPathMap.keys()];\n  const formPath = paths.find(path => path.endsWith(pathEnds));\n\n  if (!formPath) {\n    return undefined;\n  }\n\n  const formValue = cloneDeep<T>(form.getFormItemValueByPath(formPath));\n  return formValue;\n}\n\nfunction getFormValueByPathEndsV2<T = unknown>(\n  node: FlowNodeEntity,\n  pathEnds: string,\n): T | undefined {\n  const form = node.getData(FlowNodeFormData).formModel;\n  const data = form.getFormItemValueByPath('/');\n\n  if (!data || typeof data !== 'object') {\n    return undefined;\n  }\n\n  const value = findValueByPathEnds<T>(data, pathEnds);\n\n  return cloneDeep(value);\n}\n\nconst findValueByPathEnds = <T = unknown>(\n  obj: unknown,\n  pathEnds: string,\n  currentPath = '',\n): T | undefined => {\n  if (!obj) {\n    return undefined;\n  }\n\n  // Check if the current path ends with pathEnds\n  if (currentPath.endsWith(pathEnds)) {\n    return obj as T;\n  }\n\n  // processing object\n  if (typeof obj === 'object' && !Array.isArray(obj)) {\n    for (const key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        const newPath = currentPath ? `${currentPath}/${key}` : `/${key}`;\n\n        if (newPath.endsWith(pathEnds)) {\n          return obj[key] as T;\n        }\n\n        // recursive search for child objects\n        const result = findValueByPathEnds(obj[key], pathEnds, newPath);\n        if (result !== undefined) {\n          return result as T;\n        }\n      }\n    }\n  }\n\n  // Processing Array\n  if (Array.isArray(obj)) {\n    for (let i = 0; i < obj.length; i++) {\n      const newPath = `${currentPath}/${i}`;\n\n      if (newPath.endsWith(pathEnds)) {\n        return obj[i] as T;\n      }\n\n      // Recursive lookup of array elements\n      const result = findValueByPathEnds(obj[i], pathEnds, newPath);\n      if (result !== undefined) {\n        return result as T;\n      }\n    }\n  }\n\n  return undefined;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WorkflowMode } from '@coze-arch/bot-api/workflow_api';\n\n/**\n *\n * @Param flowMode Whether it is a workflow in a broad sense, including the original Workflow and the Chatflow added by Coze 2.0\n * @returns\n */\nexport const isGeneralWorkflow = (flowMode: WorkflowMode) =>\n  flowMode === WorkflowMode.Workflow || flowMode === WorkflowMode.ChatFlow;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BOT_USER_INPUT, CONVERSATION_NAME, USER_INPUT } from '../constants';\n/**\n * Whether to preset the input parameters of the start node\n */\nexport const isPresetStartParams = (name?: string): boolean =>\n  [BOT_USER_INPUT, USER_INPUT, CONVERSATION_NAME].includes(name ?? '');\n\n/**\n * The Start node parameter is the user's input during BOT chat\n * @param name\n * @returns\n */\nexport const isUserInputStartParams = (name?: string): boolean =>\n  [BOT_USER_INPUT, USER_INPUT].includes(name ?? '');\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '../types/view-variable-type';\n\nexport const ACCEPT_MAP = {\n  [ViewVariableType.Image]: ['image/*'],\n  [ViewVariableType.Doc]: ['.docx', '.doc', '.pdf'],\n  [ViewVariableType.Audio]: [\n    '.mp3',\n    '.wav',\n    '.aac',\n    '.flac',\n    '.ogg',\n    '.wma',\n    '.alac',\n    '.mid',\n    '.midi',\n    '.ac3',\n    '.dsd',\n  ],\n  [ViewVariableType.Excel]: ['.xls', '.xlsx', '.csv'],\n  [ViewVariableType.Video]: ['.mp4', '.avi', '.mov', '.wmv', '.flv', '.mkv'],\n  [ViewVariableType.Zip]: ['.zip', '.rar', '.7z', '.tar', '.gz', '.bz2'],\n  [ViewVariableType.Code]: ['.py', '.java', '.c', '.cpp', '.js', '.css'],\n  [ViewVariableType.Txt]: ['.txt'],\n  [ViewVariableType.Ppt]: ['.ppt', '.pptx'],\n  [ViewVariableType.Svg]: ['.svg'],\n};\n\nexport const getFileAccept = (\n  inputType: ViewVariableType,\n  availableFileTypes?: ViewVariableType[],\n) => {\n  let accept: string;\n  const itemType = ViewVariableType.isArrayType(inputType)\n    ? ViewVariableType.getArraySubType(inputType)\n    : inputType;\n\n  if (itemType === ViewVariableType.File) {\n    if (availableFileTypes?.length) {\n      accept = availableFileTypes\n        .map(type => ACCEPT_MAP[type]?.join(','))\n        .join(',');\n    } else {\n      accept = Object.values(ACCEPT_MAP)\n        .map(items => items.join(','))\n        .join(',');\n    }\n  } else {\n    accept = (ACCEPT_MAP[itemType] || []).join(',');\n  }\n\n  return accept;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CustomError } from '@coze-arch/bot-error';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { concatTestId } from '../utils';\nimport { NODE_TEST_ID_PREFIX } from '../constants';\n\n/**\n * Only used within the node\n */\ntype UseNodeTestId = () => {\n  /**\n   * Returns the test-id of the current node, which is the node id of the current node.\n   * 'playground.11001\n   */\n  getNodeTestId: () => string;\n  /**\n   * Returns the test-id of the current setter, which will automatically bring the test-id of the node.\n   * 'playground.11001.llm'\n   */\n  getNodeSetterId: (setterName: string) => string;\n  /**\n   * Connect two test-ids to generate a new test-id.\n   * ('a', 'b') => 'a.b'\n   */\n  concatTestId: typeof concatTestId;\n};\n\nexport const useNodeTestId: UseNodeTestId = () => {\n  const node = useCurrentEntity();\n\n  if (!node?.id) {\n    throw new CustomError(\n      'useNodeTestId must be called in a workflow node',\n      '',\n    );\n  }\n\n  const getNodeTestId = () => concatTestId(NODE_TEST_ID_PREFIX, node.id);\n\n  return {\n    /**\n     * Returns the test-id of the current node, which is the node id of the current node.\n     * 'playground.11001\n     */\n    getNodeTestId,\n    /**\n     * Returns the test-id of the current setter, which will automatically bring the test-id of the node.\n     * 'playground.11001.llm'\n     */\n    getNodeSetterId: setterName => concatTestId(getNodeTestId(), setterName),\n    /**\n     * Connect two test-ids to generate a new test-id.\n     * ('a', 'b') => 'a.b'\n     */\n    concatTestId,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext } from 'react';\n\nimport { type WorkflowNode } from '../entities';\n\nexport const WorkflowNodeContext = createContext<WorkflowNode | undefined>(\n  undefined,\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport type { WorkflowNode } from '../entities';\nimport { WorkflowNodeContext } from '../contexts';\n\nexport function useWorkflowNode() {\n  const workflowNode = useContext(WorkflowNodeContext) as WorkflowNode;\n\n  return workflowNode;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Business layer process node class (encapsulation of node business rules)\n */\nimport {\n  FlowNodeErrorData,\n  FlowNodeFormData,\n  isFormV2,\n  type FormModelV2,\n  type FlowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { getFormValueByPathEnds } from '../utils';\nimport {\n  type StandardNodeType,\n  type WorkflowNodeRegistry,\n  type InputValueVO,\n  type OutputValueVO,\n} from '../types';\nexport class WorkflowNode {\n  private node: FlowNodeEntity;\n\n  constructor(node: FlowNodeEntity) {\n    this.node = node;\n    this.setData = this.setData.bind(this);\n    this.setError = this.setError.bind(this);\n  }\n\n  public get registry(): WorkflowNodeRegistry {\n    return this.node.getNodeRegistry() as WorkflowNodeRegistry;\n  }\n\n  public get inputParameters(): InputValueVO[] | undefined {\n    if (this.registry.getNodeInputParameters) {\n      return this.registry.getNodeInputParameters(this.node);\n    }\n\n    if (this.node.getNodeMeta()?.inputParametersPath) {\n      return this.node\n        .getData<FlowNodeFormData>(FlowNodeFormData)\n        .formModel.getFormItemValueByPath(\n          this.node.getNodeMeta()?.inputParametersPath,\n        );\n    }\n\n    return this.getFormValueByPathEnds<InputValueVO[]>('/inputParameters');\n  }\n\n  public get outputs(): OutputValueVO[] | undefined {\n    if (this.registry.getNodeOutputs) {\n      return this.registry.getNodeOutputs(this.node);\n    } else {\n      return this.data?.outputs;\n    }\n  }\n\n  // This method is recommended not to be used for the time being, because it does not reflect business logic, but is a simplification of the underlying method\n  protected getFormValueByPathEnds<T = unknown>(\n    pathEnds: string,\n  ): T | undefined {\n    return getFormValueByPathEnds(this.node, pathEnds);\n  }\n\n  get type() {\n    return this.node.flowNodeType as StandardNodeType;\n  }\n\n  get isError() {\n    return !!this.error;\n  }\n\n  get error() {\n    const errorData = this.node.getData<FlowNodeErrorData>(FlowNodeErrorData);\n    const error = errorData.getError();\n\n    return error;\n  }\n\n  public setError(error: Error) {\n    const errorData = this.node.getData<FlowNodeErrorData>(FlowNodeErrorData);\n    errorData.setError(error);\n  }\n\n  get isInitialized() {\n    return this.form.initialized;\n  }\n\n  get data() {\n    return this.form.getFormItemValueByPath('/');\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public setData(data: any) {\n    if (data === undefined) {\n      return;\n    }\n\n    const { form } = this;\n\n    if (isFormV2(this.node)) {\n      Object.keys(data).forEach(key => {\n        (form as FormModelV2).setValueIn(key, data[key]);\n      });\n    } else {\n      const formItem = form.getFormItemByPath('/');\n      if (formItem) {\n        formItem.value = data;\n      }\n    }\n  }\n\n  get icon() {\n    return this?.data?.nodeMeta?.icon;\n  }\n\n  get title() {\n    return this?.data?.nodeMeta?.title;\n  }\n\n  get description() {\n    return this?.data?.nodeMeta?.description;\n  }\n\n  private get form() {\n    return this.node.getData(FlowNodeFormData).formModel;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public getValueByPath<T = any>(pathname: string): T {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const value = (this.form as any).getValueIn(pathname);\n    return value;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type UseBoundStoreWithEqualityFn } from 'zustand/traditional';\nimport { type StoreApi } from 'zustand';\nimport { type FeedbackStatus } from '@flowgram-adapter/free-layout-editor';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nexport const ValidationService = Symbol('ValidationService');\n\nexport const useValidationService = () =>\n  useService<ValidationService>(ValidationService);\nexport const useValidationServiceStore = <T>(\n  selector: (s: ValidationState) => T,\n) => useValidationService().store(selector);\n\nexport interface ValidateError {\n  // error description\n  errorInfo: string;\n  // error level\n  errorLevel: FeedbackStatus;\n  // Error Type: Node/Connection\n  errorType: 'node' | 'line';\n  // Node ID\n  nodeId: string;\n  // In the case of a connection error, the target node is also required to confirm the connection\n  targetNodeId?: string;\n}\nexport interface WorkflowValidateError {\n  workflowId: string;\n  /** process name */\n  name?: string;\n  errors: ValidateErrorMap;\n}\n\nexport type ValidateErrorMap = Record<string, ValidateError[]>;\nexport type WorkflowValidateErrorMap = Record<string, WorkflowValidateError>;\n\nexport interface ValidateResult {\n  hasError: boolean;\n  nodeErrorMap: ValidateErrorMap;\n}\nexport interface ValidateResultV2 {\n  hasError: boolean;\n  errors: WorkflowValidateErrorMap;\n}\n\nexport interface ValidationState {\n  /**\n   * @deprecated Please use errorsV2\n   */\n  errors: ValidateErrorMap;\n  /** Errors classified by process attribution */\n  errorsV2: WorkflowValidateErrorMap;\n  /** Verifying now. */\n  validating: boolean;\n}\n\nexport interface ValidationService {\n  store: UseBoundStoreWithEqualityFn<StoreApi<ValidationState>>;\n\n  /**\n   * Front-end process validation, including nodes, forms, ports, etc\n   */\n  validateWorkflow: () => Promise<ValidateResult>;\n\n  /**\n   * Verification of nodes, including forms, ports, etc\n   */\n  validateNode: (node: WorkflowNodeEntity) => Promise<ValidateResult>;\n\n  /**\n   * @Deprecated please use validateSchemaV2\n   * Process definition validation, usually backend validation\n   */\n  validateSchema: () => Promise<ValidateResult>;\n  /**\n   * Process definition validation, usually backend validation\n   */\n  validateSchemaV2: () => Promise<ValidateResultV2>;\n\n  /**\n   * Gets the error list for the specified id\n   */\n  getErrors: (id: string) => ValidateError[];\n  /**\n   * @deprecated Please use setErrorsV2\n   * setting error\n   * @param errors\n   * @param force to overwrite all errors\n   */\n  setErrors: (errors: ValidationState['errors'], force?: boolean) => void;\n\n  /**\n   * setting error\n   * @param errors\n   * @returns\n   */\n  setErrorsV2: (errors: ValidationState['errorsV2']) => void;\n  /**\n   * Clear all errors\n   */\n  clearErrors: () => void;\n  /** Is there an error in the line? */\n  isLineError: (fromId: string, toId?: string) => boolean;\n\n  get validating(): boolean;\n  set validating(value: boolean);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Workflow store, currently holds the nodes and edges data of the flow\n\nimport { devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\nimport {\n  type WorkflowEdgeJSON,\n  type WorkflowNodeJSON,\n} from '@flowgram-adapter/free-layout-editor';\n\ninterface WorkflowStoreState {\n  /** node data */\n  nodes: WorkflowNodeJSON[];\n\n  /** edge data */\n  edges: WorkflowEdgeJSON[];\n\n  /** Are you creating a workflow? */\n  isCreatingWorkflow: boolean;\n}\n\ninterface WorkflowStoreAction {\n  setNodes: (value: WorkflowNodeJSON[]) => void;\n  setEdges: (value: WorkflowEdgeJSON[]) => void;\n  setIsCreatingWorkflow: (value: boolean) => void;\n}\n\nconst initialStore: WorkflowStoreState = {\n  nodes: [],\n  edges: [],\n  isCreatingWorkflow: false,\n};\n\nexport const useWorkflowStore = create<\n  WorkflowStoreState & WorkflowStoreAction\n>()(\n  devtools(set => ({\n    ...initialStore,\n    setNodes: nodes => set({ nodes: nodes ?? [] }),\n    setEdges: edges => set({ edges: edges ?? [] }),\n    setIsCreatingWorkflow: value => set({ isCreatingWorkflow: value }),\n  })),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * These are the variable definitions for migration, you can ignore them.\n */\n\nimport { type ValueExpressionRawMeta } from './vo';\nimport { type StandardNodeType } from './node-type';\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace DTODefine {\n  export type LiteralExpressionContent =\n    | string\n    | number\n    | boolean\n    | Array<unknown>;\n\n  export interface LiteralExpression {\n    type: 'literal';\n    content?: LiteralExpressionContent;\n    rawMeta?: ValueExpressionRawMeta;\n  }\n\n  export type RefExpressionContent =\n    | {\n        source: 'variable';\n        blockID: undefined;\n        name: string;\n      }\n    | {\n        source: 'block-output';\n        blockID: string;\n        name: string;\n      }\n    | {\n        source: `global_variable_${string}`;\n        path: string[];\n        blockID: string;\n        name: string;\n      };\n  export interface RefExpression {\n    type: 'ref';\n    content?: RefExpressionContent;\n    rawMeta?: ValueExpressionRawMeta;\n  }\n\n  export interface ObjectRefExpression {\n    type: 'object_ref';\n    content?: unknown;\n    rawMeta?: ValueExpressionRawMeta;\n  }\n\n  // Represents the original FDL type when schema is string export type ListVariableSchema = VariableTypeDef & Omit < VariableOption, 'name' >\n  export type ObjectVariableSchema = InputVariableDTO[];\n  export type ListVariableSchema = VariableTypeDef &\n    Omit<VariableOption, 'name'>;\n  export type VariableSchema = ListVariableSchema | ObjectVariableSchema;\n  export type BasicVariableType =\n    | 'string'\n    | 'integer'\n    | 'float'\n    | 'boolean'\n    | 'image'\n    | 'unknown';\n  export type ComplexVariableType = 'object' | 'list';\n  export type VariableType = BasicVariableType | ComplexVariableType;\n\n  export interface BasicVarTypeDef {\n    type: BasicVariableType;\n    assistType?: AssistTypeDTO;\n  }\n  export interface ObjectVarTypeDef {\n    type: VariableTypeDTO.object;\n    schema?: ObjectVariableSchema;\n    assistType?: AssistTypeDTO;\n  }\n  export interface ListVarTypeDef {\n    type: VariableTypeDTO.list;\n    schema: ListVariableSchema;\n    assistType?: AssistTypeDTO;\n  }\n\n  export type VariableTypeDef =\n    | BasicVarTypeDef\n    | ObjectVarTypeDef\n    | ListVarTypeDef;\n  interface VariableOption {\n    name: string;\n    label?: string;\n    defaultValue?: LiteralExpressionContent;\n    description?: string;\n    required?: boolean;\n  }\n\n  export type InputVariableDTO = VariableOption & VariableTypeDef;\n}\n\n/**\n * Expression formats defined by the backend\n * @example\n * - literal\n * {\n *     type: 'string',\n *     value: {\n *         type: 'liteal',\n *         Content: 'Zhejiang'\n *     }\n * }\n *\n * - ref\n * //Common reference typery reference type\n * {\n *     Type: 'string',//Determined by the type of the referenced variable the type of variable being referenced\n *     value: {\n *         type: 'ref',\n *         content: {\n *             source: 'block-output',\n *             blockID: '1002',\n *             name: 'result'\n *         }\n *     }\n * }\n *\n * //list or object reference typerence type\n * {\n *     Type: 'list',//Determined by the last value type of the referenced variable path, if list.a.c, the format of che referenced variable path, if list.a.c, the format of c\n *     Schema : { // only list and object have schemasts have schemas\n *          type: 'object',\n *          schema: [\n *             { name: 'role', type: 'string' },\n *             { name: 'content', type: 'string' }\n *          ]\n *     }\n *     value: {\n *         type: 'ref',\n *         content: {\n *             source: 'block-output',\n *             blockID: '1002',\n *             Name: 'list.a.c'//Here is the path of the referencee path to the reference\n *         },\n *     }\n * }\n */\nexport interface ValueExpressionDTO {\n  type?: string;\n  assistType?: number;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  schema?: any;\n  value:\n    | DTODefine.LiteralExpression\n    | DTODefine.RefExpression\n    | DTODefine.ObjectRefExpression;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ValueExpressionDTO {\n  /**\n   * null reference\n   */\n  export function createEmpty(): ValueExpressionDTO {\n    return {\n      type: 'string',\n      value: {\n        type: 'ref',\n        content: {\n          source: 'block-output',\n          blockID: '',\n          name: '',\n        },\n      },\n    };\n  }\n}\nexport interface InputValueDTO {\n  name?: string;\n  input: ValueExpressionDTO;\n  schema?: InputValueDTO[];\n  id?: string;\n}\n\nexport enum VariableTypeDTO {\n  object = 'object',\n  list = 'list',\n  string = 'string',\n  integer = 'integer',\n  float = 'float',\n  boolean = 'boolean',\n  image = 'image',\n  time = 'time',\n}\n\nexport enum AssistTypeDTO {\n  file = 1,\n  image = 2,\n  doc = 3,\n  code = 4,\n  ppt = 5,\n  txt = 6,\n  excel = 7,\n  audio = 8,\n  zip = 9,\n  video = 10,\n  svg = 11,\n  voice = 12,\n  time = 10000,\n}\n\n/**\n * Variable format for the backend\n * @example\n * 1. simple\n *  {\n *    name: 'message',\n *    type: 'string'\n *  }\n * 2. object\n *  {\n *    name: 'someObj'\n *    type: 'object',\n *    schema: [\n *      {\n *        name: 'role',\n *        type: 'string'\n *      },\n *      {\n *        name: 'content',\n *        type: 'string'\n *      }\n *    ]\n *  }\n * 3. list<object>\n *   {\n *     name: 'history'\n *     type: 'list',\n *     schema: {\n *       type: 'object',\n *       schema: [\n *         { name: 'role', type: 'string' },\n *         { name: 'content', type: 'string' }\n *       ]\n *     }\n *   }\n */\nexport interface VariableMetaDTO {\n  /**\n   * Variable type\n   */\n  type: VariableTypeDTO;\n  /**\n   * Auxiliary types, such as: string type variables can be file or image\n   */\n  assistType?: AssistTypeDTO;\n  /**\n   * Variable names are not repeatable within a node\n   */\n  name: string;\n  /**\n   * Variable data structures, only object and list variables are available\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  schema?: any; // BlockVariableDefine.ObjectVariableSchema | BlockVariableDefine.ListVariableSchema\n  required?: boolean;\n  description?: string;\n  readonly?: boolean;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  defaultValue?: any;\n}\n\nexport interface BatchDTOInputList {\n  name?: string;\n  input: ValueExpressionDTO;\n  // Exists after initialization, server level data does not exist\n  id?: string;\n}\n\nexport interface BatchDTO {\n  batchSize: number;\n  concurrentSize: number;\n  inputLists: BatchDTOInputList[];\n}\n\nexport interface NodeDataDTO {\n  inputs: {\n    inputParameters?: InputValueDTO[];\n    settingOnError?: { switch: boolean; dataOnErr: string };\n    [key: string]: unknown;\n  };\n  nodeMeta: {\n    description: string;\n    icon: string;\n    subTitle: string;\n    title: string;\n    mainColor: string;\n  };\n  outputs: VariableMetaDTO[];\n  version?: string;\n}\n\nexport interface NodeDTO {\n  id: string;\n  type: StandardNodeType;\n  meta?: {\n    position: { x: number; y: number };\n    [key: string]: unknown;\n  };\n  data: NodeDataDTO;\n  edges?: {\n    sourceNodeId: string;\n    targetNodeId: string;\n    sourcePortId: string;\n  }[];\n  blocks?: NodeDataDTO[];\n}\n\nexport interface InputTypeValueDTO {\n  name: string;\n  type: VariableTypeDTO;\n  input: ValueExpressionDTO;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ViewVariableType } from './view-variable-type';\n\nexport interface ViewVariableTreeNode {\n  key: string;\n  type: ViewVariableType;\n  name: string;\n  children?: ViewVariableTreeNode[];\n  required?: boolean;\n  description?: string;\n  // Identifies that the parameter is a built-in parameter, and the default is false.\n  isPreset?: boolean;\n  // Identifies whether the parameter is enabled, the default is false\n  enabled?: boolean;\n  // user-defined node name display\n  label?: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  defaultValue?: any;\n}\n\nexport interface ViewVariableMeta extends ViewVariableTreeNode {\n  required?: boolean;\n  description?: string;\n  readonly?: boolean;\n  mutable?: boolean; // Can be selected by the lvalue of the Set node\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ViewVariableTreeNode {\n  /**\n   * Query sub-node via path\n   * @param node\n   */\n  export function getVariableTreeNodeByPath(\n    node: ViewVariableTreeNode,\n    keyPath: string[],\n  ): ViewVariableTreeNode | undefined {\n    keyPath = keyPath.slice();\n    let currentNode: ViewVariableTreeNode | undefined = node;\n    let key: string | undefined = keyPath.shift();\n    while (key && currentNode) {\n      key = keyPath.shift();\n      if (key) {\n        currentNode = (currentNode.children || []).find(\n          child => child.key === key,\n        ) as ViewVariableTreeNode;\n        if (!currentNode) {\n          return undefined;\n        }\n      }\n    }\n    return currentNode;\n  }\n  /**\n   * ['xxx', 'xxx'] -> 'a.b.c'\n   * @param keyPath\n   * @deprecated\n   */\n  export function keyPathToNameString(\n    node: ViewVariableTreeNode,\n    keyPath: string[],\n  ): string {\n    const result: string[] = [];\n    keyPath = keyPath.slice();\n    let currentNode: ViewVariableTreeNode | undefined = node;\n    let key: string | undefined = keyPath.shift();\n    while (key && currentNode) {\n      result.push(currentNode.name);\n      key = keyPath.shift();\n      if (key) {\n        currentNode = (currentNode.children || []).find(\n          child => child.key === key,\n        ) as ViewVariableTreeNode;\n        if (!currentNode) {\n          return '';\n        }\n      }\n    }\n    return result.join('.');\n  }\n\n  /**\n   * 'a.b.c' -> ['xxx', 'xxx']\n   * @param nameStr\n   * @deprecated\n   */\n  export function nameStringToKeyPath(\n    node: ViewVariableTreeNode,\n    nameStr: string,\n  ): string[] {\n    const result: string[] = [];\n    const nameList = nameStr.split('.');\n    let currentNode: ViewVariableTreeNode | undefined = node;\n    let name = nameList.shift();\n    while (name && currentNode) {\n      result.push(currentNode.key);\n      name = nameList.shift();\n      if (name) {\n        currentNode = (currentNode.children || []).find(\n          child => child.name === name,\n        ) as ViewVariableTreeNode;\n        if (!currentNode) {\n          return [];\n        }\n      }\n    }\n    return result;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This file defines the data consumed by the front end and is represented by VO (view object)\n */\nimport { isNil, isUndefined } from 'lodash-es';\n\nimport type { ViewVariableType } from './view-variable-type';\n\nexport interface RefExpressionContent {\n  /**\n   * The reference value is the key path of a variable\n   */\n  keyPath: string[];\n}\n\n/**\n * value expression type\n */\nexport enum ValueExpressionType {\n  LITERAL = 'literal',\n  REF = 'ref',\n  OBJECT_REF = 'object_ref',\n}\n/**\n * Used to store ValueExpression's original data source for front-end consumption\n */\nexport interface ValueExpressionRawMeta {\n  type?: ViewVariableType;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n\n/**\n * Text expression\n */\nexport interface LiteralExpression {\n  type: ValueExpressionType.LITERAL;\n  content?: string | number | boolean | Array<unknown>;\n  rawMeta?: ValueExpressionRawMeta;\n}\n\n/**\n * object expression\n */\nexport interface ObjectRefExpression {\n  type: ValueExpressionType.OBJECT_REF;\n  content?: unknown;\n  rawMeta?: ValueExpressionRawMeta;\n}\n\n/**\n * reference variable\n */\nexport interface RefExpression {\n  type: ValueExpressionType.REF;\n  content?: RefExpressionContent;\n  /**\n   * rawMeta records the type of the ref expression\n   * May be different from the referenced variable type, which triggers automatic type conversion: [Workflow type automatic conversion] ()\n   */\n  rawMeta?: ValueExpressionRawMeta;\n}\n\n/**\n * Front-end input value expression\n */\nexport type ValueExpression =\n  | RefExpression\n  | LiteralExpression\n  | ObjectRefExpression;\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ValueExpression {\n  export function isRef(value: ValueExpression): value is RefExpression {\n    return value.type === ValueExpressionType.REF;\n  }\n  export function isLiteral(\n    value: ValueExpression,\n  ): value is LiteralExpression {\n    return value.type === ValueExpressionType.LITERAL;\n  }\n  export function isObjectRef(\n    value: ValueExpression,\n  ): value is ObjectRefExpression {\n    return value?.type === ValueExpressionType.OBJECT_REF;\n  }\n\n  export function isExpression(value?: ValueExpression): boolean {\n    if (isUndefined(value)) {\n      return false;\n    }\n    return isRef(value) || isLiteral(value);\n  }\n\n  export function isEmpty(value: ValueExpression | undefined): boolean {\n    if (value?.type === ValueExpressionType.OBJECT_REF) {\n      return false;\n    }\n\n    if (value === null) {\n      return true;\n    }\n\n    // If value is not an object or function, that is, a native type, it will exist in the plug-in custom component\n    if (typeof value !== 'object' && typeof value !== 'function') {\n      return isNil(value);\n    }\n\n    // Value.content has multiple types and may be false\n    if (value?.content === '' || isNil(value?.content)) {\n      return true;\n    }\n    if (Array.isArray(value?.content)) {\n      return value?.content.length === 0;\n    }\n\n    if (value?.type === ValueExpressionType.REF) {\n      return !(value?.content as RefExpressionContent)?.keyPath?.length;\n    }\n\n    return false;\n  }\n}\n\n/**\n * Front end value input value\n * {\n *     name: '',\n *     input: {\n *         type: ValueExpressionType.REF,\n *         content: {\n *             keyPath: ['nodeId', 'out3']\n *         }\n *\n *     }\n * }\n */\nexport interface InputValueVO {\n  name?: string;\n  input: ValueExpression;\n  children?: InputValueVO[];\n  key?: string;\n}\n\nexport interface InputTypeValueVO {\n  name: string;\n  type: ViewVariableType;\n  input: ValueExpression;\n}\n\nexport enum BatchMode {\n  Single = 'single',\n  Batch = 'batch',\n}\n\nexport interface BatchVOInputList {\n  id: string;\n  name: string;\n  input: ValueExpression;\n}\n\nexport interface BatchVO {\n  batchSize: number;\n  concurrentSize: number;\n  inputLists: BatchVOInputList[];\n}\n\nexport interface OutputValueVO {\n  key: string;\n  name: string;\n  type: ViewVariableType;\n  description?: string;\n  readonly?: boolean;\n  required?: boolean;\n  children?: OutputValueVO[];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Node base type definition\n */\nexport enum StandardNodeType {\n  Start = '1',\n  End = '2',\n  LLM = '3',\n  Api = '4',\n  Code = '5',\n  Dataset = '6',\n  If = '8',\n  SubWorkflow = '9',\n  Variable = '11',\n  Database = '12',\n  Output = '13',\n  Imageflow = '14',\n  Text = '15',\n  ImageGenerate = '16',\n  ImageReference = '17',\n  Question = '18',\n  Break = '19',\n  SetVariable = '20',\n  Loop = '21',\n  Intent = '22',\n  // For new nodes, StandardNodeType can be written in text form, without relying on NodeTemplateType.\n  ImageCanvas = '23',\n  SceneChat = '25',\n  SceneVariable = '24',\n\n  /** Long term memory */\n  LTM = '26',\n  /** database write node */\n  DatasetWrite = '27',\n  Batch = '28',\n\n  Continue = '29',\n  // input node\n  Input = '30',\n\n  Comment = '31',\n  // variable aggregation\n  VariableMerge = '32',\n  // Query message list\n  QueryMessageList = '37',\n  // clear the context node\n  ClearContext = '38',\n  // Create a session node\n  CreateConversation = '39',\n\n  // Trigger CURD 4 nodes\n  // TriggerCreate = '33',\n  // TriggerUpdate = '34',\n  TriggerUpsert = '34',\n  TriggerDelete = '35',\n  TriggerRead = '36',\n\n  VariableAssign = '40',\n\n  // HTTP Node\n  Http = '45',\n  // Database crud node\n\n  DatabaseUpdate = '42',\n  DatabaseQuery = '43',\n  DatabaseDelete = '44',\n  DatabaseCreate = '46',\n\n  // Update session\n  UpdateConversation = '51',\n\n  // Delete session\n  DeleteConversation = '52',\n\n  // Query session list\n  QueryConversationList = '53',\n\n  // Query session history\n  QueryConversationHistory = '54',\n\n  // Create a message (a conversation)\n  CreateMessage = '55',\n\n  // Update message (a message for a session)\n  UpdateMessage = '56',\n\n  // Delete a message (a message for a session)\n  DeleteMessage = '57',\n\n  JsonStringify = '58',\n  JsonParser = '59',\n}\n\n/**\n * Basic node types other than APIs, SubWorkflow, and Imageflow\n */\nexport type BasicStandardNodeTypes = Exclude<\n  StandardNodeType,\n  | StandardNodeType.Api\n  | StandardNodeType.Imageflow\n  | StandardNodeType.SubWorkflow\n>;\n\n/** Node display sorting */\nexport const NODE_ORDER = {\n  [StandardNodeType.Start]: 1,\n  [StandardNodeType.End]: 2,\n  [StandardNodeType.Api]: 3,\n  [StandardNodeType.LLM]: 4,\n  [StandardNodeType.Code]: 5,\n  [StandardNodeType.Dataset]: 6,\n  [StandardNodeType.SubWorkflow]: 7,\n  [StandardNodeType.Imageflow]: 8,\n  [StandardNodeType.If]: 9,\n  [StandardNodeType.Loop]: 10,\n  [StandardNodeType.Intent]: 11,\n  [StandardNodeType.Text]: 12,\n  [StandardNodeType.Output]: 13,\n  [StandardNodeType.Question]: 14,\n  [StandardNodeType.Variable]: 15,\n  [StandardNodeType.Database]: 16,\n  [StandardNodeType.LTM]: 17,\n  [StandardNodeType.Batch]: 18,\n  [StandardNodeType.Input]: 19,\n  [StandardNodeType.SetVariable]: 20,\n  [StandardNodeType.Break]: 21,\n  [StandardNodeType.Continue]: 22,\n  [StandardNodeType.SceneChat]: 23,\n  [StandardNodeType.SceneVariable]: 24,\n  // [StandardNodeType.TriggerCreate]: 25,\n  [StandardNodeType.TriggerUpsert]: 26,\n  [StandardNodeType.TriggerRead]: 27,\n  [StandardNodeType.TriggerDelete]: 28,\n};\n\n/** session class node */\nexport const CONVERSATION_NODES = [\n  StandardNodeType.CreateConversation,\n  StandardNodeType.UpdateConversation,\n  StandardNodeType.DeleteConversation,\n  StandardNodeType.QueryConversationList,\n];\n\n/** message class node */\nexport const MESSAGE_NODES = [\n  StandardNodeType.CreateMessage,\n  StandardNodeType.UpdateMessage,\n  StandardNodeType.DeleteMessage,\n  StandardNodeType.QueryMessageList,\n];\n\n/** session history class node */\nexport const CONVERSATION_HISTORY_NODES = [\n  StandardNodeType.QueryConversationHistory,\n  StandardNodeType.ClearContext,\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// The agreement agreed with the backend is not perceived by the workflow backend. Corresponding to the key response.data modal_list [*] .model_params [*] .default in the api/bot/get_type_list interface\nexport enum GenerationDiversity {\n  Customize = 'default_val',\n  Creative = 'creative',\n  Balance = 'balance',\n  Precise = 'precise',\n}\n\nexport const RESPONSE_FORMAT_NAME = 'response_format';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ConditionLogic {\n  OR = 1,\n  AND = 2,\n}\n\nexport enum ConditionLogicDTO {\n  OR = 'OR',\n  AND = 'AND',\n}\n\nexport type ConditionOperator =\n  | 'EQUAL' // \"=\"\n  | 'NOT_EQUAL' // \"< >\" or \"! =\"\n  | 'GREATER_THAN' // \">\"\n  | 'LESS_THAN' // \"<\"\n  | 'GREATER_EQUAL' // \">=\"\n  | 'LESS_EQUAL' // \"<=\"\n  | 'IN' // \"IN\"\n  | 'NOT_IN' // \"NOT IN\"\n  | 'IS_NULL' // \"IS NULL\"\n  | 'IS_NOT_NULL' // \"IS NOT NULL\"\n  | 'LIKE' // \"LIKE\" fuzzy match string\n  | 'NOT_LIKE' // \"NOT LIKE\" inverse fuzzy match\n  | 'BE_TRUE' // \"BE TRUE\" is true\n  | 'BE_FALSE'; // \"BE FALSE\" Boolean value false\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/no-batch-import-or-export */\nexport {\n  ViewVariableType,\n  VARIABLE_TYPE_ALIAS_MAP,\n  type InputVariable,\n  FILE_TYPES,\n} from './view-variable-type';\nexport {\n  type RecursedParamDefinition,\n  ParamValueType,\n} from './param-definition';\nexport {\n  ViewVariableTreeNode,\n  type ViewVariableMeta,\n} from './view-variable-tree';\nexport {\n  type DTODefine,\n  ValueExpressionDTO,\n  type InputValueDTO,\n  VariableTypeDTO,\n  AssistTypeDTO,\n  type VariableMetaDTO,\n  type BatchDTOInputList,\n  type BatchDTO,\n  type NodeDTO,\n  type NodeDataDTO,\n  type InputTypeValueDTO,\n} from './dto';\nexport { BlockInput } from './block-input-dto';\nexport {\n  type RefExpressionContent,\n  ValueExpressionType,\n  type LiteralExpression,\n  type RefExpression,\n  type ObjectRefExpression,\n  ValueExpression,\n  type InputValueVO,\n  type OutputValueVO,\n  BatchMode,\n  type BatchVOInputList,\n  type BatchVO,\n  type InputTypeValueVO,\n} from './vo';\n\nexport {\n  StandardNodeType,\n  NODE_ORDER,\n  CONVERSATION_NODES,\n  MESSAGE_NODES,\n  CONVERSATION_HISTORY_NODES,\n  type BasicStandardNodeTypes,\n} from './node-type';\nexport { type WorkflowJSON, type WorkflowNodeJSON } from './node';\n// ! Notice data-set.ts is using io-ts for runtime type checking, and direct export is prohibited to avoid io-ts being hit into other pages\n// export { datasetParams, type DatasetParams } from './data-set';\nimport { InputType } from '@coze-arch/bot-api/developer_api';\n\nimport {\n  VARIABLE_TYPE_ALIAS_MAP,\n  ViewVariableType,\n} from './view-variable-type';\nimport { AssistTypeDTO } from './dto';\n\nexport { type ValueOf, type WithCustomStyle } from './utils';\n// Bumped with the back-end definition, comment\nexport { type WorkflowInfo as FrontWorkflowInfo } from './workflow';\n\nexport {\n  type WorkflowNodeRegistry,\n  WorkflowNodeVariablesMeta,\n  type NodeMeta,\n} from './registry';\n\n/**\n * Parameter type display copy\n * @Tips workflow edit page please use {PARAM_TYPE_ALIAS_MAP}\n */\nexport const PARAM_TYPE_LABEL_MAP: Record<InputType, string> = {\n  [InputType.String]: 'String',\n  [InputType.Integer]: 'Integer',\n  [InputType.Boolean]: 'Boolean',\n  [InputType.Double]: 'Double',\n  [InputType.List]: 'List',\n  [InputType.Object]: 'Object',\n};\n\nexport const STRING_ASSIST_TYPE_LABEL_MAP = {\n  [AssistTypeDTO.file]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.File],\n  [AssistTypeDTO.image]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Image],\n  [AssistTypeDTO.doc]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Doc],\n  [AssistTypeDTO.code]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Code],\n  [AssistTypeDTO.ppt]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Ppt],\n  [AssistTypeDTO.txt]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Txt],\n  [AssistTypeDTO.excel]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Excel],\n  [AssistTypeDTO.audio]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Audio],\n  [AssistTypeDTO.zip]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Zip],\n  [AssistTypeDTO.video]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Video],\n  [AssistTypeDTO.svg]: VARIABLE_TYPE_ALIAS_MAP[ViewVariableType.Svg],\n};\n\nexport enum WorkflowExecStatus {\n  DEFAULT = 'default',\n  /** in progress */\n  EXECUTING = 'executing',\n  /** End of execution (there is still an end of execution banner at this time, and the workflow is disabled) */\n  DONE = 'done',\n}\n\nexport * from './llm';\n\nexport {\n  type WorkflowDatabase,\n  type DatabaseField,\n  type DatabaseSettingField,\n  type DatabaseSettingFieldDTO,\n  type DatabaseCondition,\n  type DatabaseConditionOperator,\n  type DatabaseConditionLeft,\n  type DatabaseConditionRight,\n  type DatabaseConditionDTO,\n} from './database';\n\nexport {\n  ConditionLogic,\n  type ConditionOperator,\n  ConditionLogicDTO,\n} from './condition';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from './view-variable-type';\nimport { type DTODefine, type InputValueDTO } from './dto';\n\n/**\n * BlockInput is a type defined by the backend, which corresponds to InputValueDTO.\n */\nexport type BlockInput = InputValueDTO;\n\n/**\n * BlockInput conversion method\n */\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace BlockInput {\n  /**\n   * @param name\n   * @param value\n   * @param type\n   * @example\n   * {\n   *  name: 'apiName',\n   *  input: {\n   *      type: 'string',\n   *      value: {\n   *          type: 'literal',\n   *          content: 'xxxxxxxxx'\n   *      }\n   *  }\n   * }\n   */\n  export function create(\n    name: string,\n    value = '',\n    type: DTODefine.BasicVariableType = 'string',\n  ): BlockInput {\n    const blockInput: BlockInput = {\n      name,\n      input: {\n        type,\n        value: {\n          type: 'literal',\n          content: String(value),\n        },\n      },\n    };\n    let rawMetaType: ViewVariableType = ViewVariableType.String;\n    switch (type) {\n      case 'string':\n        rawMetaType = ViewVariableType.String;\n        break;\n      case 'integer':\n        rawMetaType = ViewVariableType.Integer;\n        break;\n      case 'float':\n        rawMetaType = ViewVariableType.Number;\n        break;\n      case 'boolean':\n        rawMetaType = ViewVariableType.Boolean;\n        break;\n      default:\n        break;\n    }\n    blockInput.input.value.rawMeta = { type: rawMetaType };\n    return blockInput;\n  }\n  export function createString(name: string, value: string): BlockInput {\n    return create(name, value, 'string');\n  }\n  export function createInteger(name: string, value: string): BlockInput {\n    return create(name, value, 'integer');\n  }\n  export function createFloat(name: string, value: string): BlockInput {\n    return create(name, value, 'float');\n  }\n\n  export function createArray<T>(\n    name: string,\n    value: Array<T>,\n    schema: unknown,\n  ): BlockInput {\n    return {\n      name,\n      input: {\n        type: 'list',\n        schema,\n        value: {\n          type: 'literal',\n          content: value,\n        },\n      },\n    };\n  }\n\n  export function createBoolean(name: string, value: boolean): BlockInput {\n    const booleanInput = create(name, value as never, 'boolean');\n    booleanInput.input.value.content = value;\n    return booleanInput;\n  }\n\n  export function toLiteral<T>(blockInput: BlockInput): T {\n    return blockInput.input.value.content as unknown as T;\n  }\n\n  export function isBlockInput(d: unknown): d is BlockInput {\n    return (\n      Boolean((d as BlockInput)?.name) &&\n      typeof (d as BlockInput)?.input?.value?.content !== undefined\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type WorkflowNodeEntity,\n  type WorkflowSubCanvas,\n  type WorkflowNodeRegistry as WorkflowOriginNodeRegistry,\n  type WorkflowNodeJSON,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  type OutputValueVO,\n  type InputValueVO,\n  type ValueExpression,\n} from './vo';\nimport { type VariableTagProps } from './view-variable-type';\nimport { type StandardNodeType } from './node-type';\n\nexport interface WorkflowNodeVariablesMeta {\n  /**\n   * Output variable path, default ['outputs']\n   */\n  outputsPathList?: string[];\n  /**\n   * Input variable path, default ['input.inputParameters']\n   */\n  inputsPathList?: string[];\n  batchInputListPath?: string;\n}\n\nexport namespace WorkflowNodeVariablesMeta {\n  export const DEFAULT: WorkflowNodeVariablesMeta = {\n    outputsPathList: ['outputs'],\n    inputsPathList: ['inputs.inputParameters'],\n    batchInputListPath: 'inputs.batch.inputLists',\n  };\n}\n\nexport interface NodeMeta<NodeTest = any> {\n  isStart?: boolean;\n  isNodeEnd?: boolean;\n  deleteDisable?: boolean;\n  copyDisable?: boolean; // Unable to copy\n  nodeDTOType: StandardNodeType;\n  nodeMetaPath?: string;\n  batchPath?: string;\n  outputsPath?: string;\n  inputParametersPath?: string;\n  renderKey?: string;\n  style?: any;\n  errorStyle?: any;\n  size?: { width: number; height: number }; // Default size at initialization\n  defaultPorts?: Array<any>;\n  useDynamicPort?: boolean;\n  disableSideSheet?: boolean;\n  subCanvas?: (node: WorkflowNodeEntity) => WorkflowSubCanvas | undefined;\n\n  /** Whether to show trigger icon */\n  showTrigger?: (props: { projectId?: string }) => boolean;\n  /** Whether to hide the test */\n  hideTest?: boolean;\n  /** Get card input variable label */\n  getInputVariableTag?: (\n    /** variable name */\n    variableName: string | undefined,\n    /** Input value or variable */\n    input: ValueExpression,\n    /** additional parameters */\n    extra?: {\n      /**\n       * Variable service, WorkflowVariableService imported from '@code-workflow/variable'\n       * The type is not written here to avoid circular references. In addition, it is unreasonable for the base package to refer to the content of the variable package.\n       */\n      variableService: any;\n\n      /** current node */\n      node: WorkflowNodeEntity;\n    },\n  ) => VariableTagProps;\n\n  /** Whether to support single-node debugging copilot generation form parameters */\n  enableCopilotGenerateTestNodeForm?: boolean;\n  /**\n   * Get llm ids, all nodes that require large model selection must implement this method\n   * Because the user may have an account upgrade or the model is removed from the shelves, the list data pulled normally may not have this id.\n   * Therefore, to obtain the model list, you need to traverse all nodes to get the used model IDs.\n   * @param nodeJSON\n   * @returns\n   */\n  getLLMModelIdsByNodeJSON?: (\n    nodeJSON: WorkflowNodeJSON,\n  ) => string[] | undefined | string | number | number[];\n  /**\n   * Node header not editable & hide... button\n   */\n  headerReadonly?: boolean;\n  headerReadonlyAllowDeleteOperation?: boolean;\n\n  /**\n   * Node Help Documentation\n   */\n  helpLink?: string | ((props: { apiName: string }) => string);\n  /**\n   * Node test related data\n   */\n  test?: NodeTest;\n}\n\nexport interface WorkflowNodeRegistry<NodeTestMeta = any>\n  extends WorkflowOriginNodeRegistry {\n  variablesMeta?: WorkflowNodeVariablesMeta;\n  meta: NodeMeta<NodeTestMeta>;\n\n  /**\n   * Specialization: Get the value of the input Parameters according to the node, and judge by /inputParameters field by default\n   * @param node\n   * @returns\n   */\n  getNodeInputParameters?: (node: FlowNodeEntity) => InputValueVO[] | undefined;\n\n  /**\n   * Get additional actions for the More menu to the right of the Stage node, currently used in the Subprocess node and the Plugin node\n   * @returns\n   */\n  getHeaderExtraOperation?: (\n    formValues: any,\n    node: FlowNodeEntity,\n  ) => React.ReactNode;\n\n  /**\n   * Specialization: Get the value of Outputs according to the node, and judge by /outputs field by default\n   */\n  getNodeOutputs?: (node: FlowNodeEntity) => OutputValueVO[] | undefined;\n\n  /**\n   * The last conversion before the node commits, this method is executed after'formMeta.transformOnSubmit'\n   * @param node data\n   * @Param converted node data\n   */\n  beforeNodeSubmit?: (node: WorkflowNodeJSON) => WorkflowNodeJSON;\n\n  /**\n   * - Node Registry initialization, you can get the initialization data here, and then render the form. Note that the node has not been created at this time\n   * - Currently works with v2 form engine nodes\n   * @Param nodeJSON node initialization data (when clicking Add, or when fetching from the backend)\n   * @Param context WorkflowPlaygroundContext, see packages/workflow/playground/src/workflow-playground-context\n   * @returns Promise<void>\n   */\n  onInit?: (nodeJSON: WorkflowNodeJSON, context: any) => Promise<void>;\n\n  /**\n   * - Whether there is an error message (taken from the service), if there is an error message, return an error message, otherwise return an empty string or undefined\n   * - Currently consumed in node-context-provider, monitor the current node error message, if any, update the FlowNodeErrorData data, thereby triggering the node to render the error state\n   * - Currently works with v2 form engine nodes\n   * @Param nodeJSON node initialization data (when clicking Add, or when fetching from the backend)\n   * @Param context WorkflowPlaygroundContext, see packages/workflow/playground/src/workflow-playground-context\n   */\n  checkError?: (nodeJSON: WorkflowNodeJSON, context: any) => string | undefined;\n\n  /**\n   * - Called when the node is destroyed, used to do some cleaning work, such as clearing the error information of the joint point and recycling resources\n   * - Currently works with v2 form engine nodes\n   * @param node\n   * @param context workflow-playground-context\n   * @returns\n   */\n  onDispose?: (nodeJSON: WorkflowNodeJSON, context: any) => void;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\n/**\n * Front-end variable type\n */\nexport enum ViewVariableType {\n  String = 1,\n  Integer,\n  Boolean,\n  Number,\n  Object = 6,\n  Image,\n  File,\n  Doc,\n  Code,\n  Ppt,\n  Txt,\n  Excel,\n  Audio,\n  Zip,\n  Video,\n  Svg,\n  Voice,\n  Time,\n  // The above is the InputType defined in the api. The following is the integrated one. Start from 99 to avoid collisions with the backend definition.\n  ArrayString = 99,\n  ArrayInteger,\n  ArrayBoolean,\n  ArrayNumber,\n  ArrayObject,\n  ArrayImage,\n  ArrayFile,\n  ArrayDoc,\n  ArrayCode,\n  ArrayPpt,\n  ArrayTxt,\n  ArrayExcel,\n  ArrayAudio,\n  ArrayZip,\n  ArrayVideo,\n  ArraySvg,\n  ArrayVoice,\n  ArrayTime,\n}\n/**\n * Variable types that use JSON to represent values\n */\nexport const JSON_INPUT_TYPES = [\n  ViewVariableType.Object,\n  ViewVariableType.ArrayString,\n  ViewVariableType.ArrayInteger,\n  ViewVariableType.ArrayBoolean,\n  ViewVariableType.ArrayNumber,\n  ViewVariableType.ArrayObject,\n  ViewVariableType.ArrayTime,\n];\n\nexport const FILE_TYPES = [\n  ViewVariableType.File,\n  ViewVariableType.Image,\n  ViewVariableType.Doc,\n  ViewVariableType.Code,\n  ViewVariableType.Ppt,\n  ViewVariableType.Txt,\n  ViewVariableType.Excel,\n  ViewVariableType.Audio,\n  ViewVariableType.Zip,\n  ViewVariableType.Video,\n  ViewVariableType.Svg,\n  ViewVariableType.Voice,\n\n  ViewVariableType.ArrayImage,\n  ViewVariableType.ArrayFile,\n  ViewVariableType.ArrayDoc,\n  ViewVariableType.ArrayCode,\n  ViewVariableType.ArrayPpt,\n  ViewVariableType.ArrayTxt,\n  ViewVariableType.ArrayExcel,\n  ViewVariableType.ArrayAudio,\n  ViewVariableType.ArrayZip,\n  ViewVariableType.ArrayVideo,\n  ViewVariableType.ArraySvg,\n  ViewVariableType.ArrayVoice,\n];\n\n// Base types, and pairing with their corresponding array types\nexport const BASE_ARRAY_PAIR: [ViewVariableType, ViewVariableType][] = [\n  [ViewVariableType.String, ViewVariableType.ArrayString],\n  [ViewVariableType.Integer, ViewVariableType.ArrayInteger],\n  [ViewVariableType.Boolean, ViewVariableType.ArrayBoolean],\n  [ViewVariableType.Number, ViewVariableType.ArrayNumber],\n  [ViewVariableType.Object, ViewVariableType.ArrayObject],\n  [ViewVariableType.Image, ViewVariableType.ArrayImage],\n  [ViewVariableType.File, ViewVariableType.ArrayFile],\n  [ViewVariableType.Doc, ViewVariableType.ArrayDoc],\n  [ViewVariableType.Code, ViewVariableType.ArrayCode],\n  [ViewVariableType.Ppt, ViewVariableType.ArrayPpt],\n  [ViewVariableType.Txt, ViewVariableType.ArrayTxt],\n  [ViewVariableType.Excel, ViewVariableType.ArrayExcel],\n  [ViewVariableType.Audio, ViewVariableType.ArrayAudio],\n  [ViewVariableType.Zip, ViewVariableType.ArrayZip],\n  [ViewVariableType.Video, ViewVariableType.ArrayVideo],\n  [ViewVariableType.Svg, ViewVariableType.ArraySvg],\n  [ViewVariableType.Voice, ViewVariableType.ArrayVoice],\n  [ViewVariableType.Time, ViewVariableType.ArrayTime],\n];\n\nexport const VARIABLE_TYPE_ALIAS_MAP: Record<ViewVariableType, string> = {\n  [ViewVariableType.String]: 'String',\n  [ViewVariableType.Integer]: 'Integer',\n  [ViewVariableType.Boolean]: 'Boolean',\n  [ViewVariableType.Number]: 'Number',\n  [ViewVariableType.Object]: 'Object',\n  [ViewVariableType.Image]: 'Image',\n  [ViewVariableType.File]: 'File',\n  [ViewVariableType.Doc]: 'Doc',\n  [ViewVariableType.Code]: 'Code',\n  [ViewVariableType.Ppt]: 'PPT',\n  [ViewVariableType.Txt]: 'Txt',\n  [ViewVariableType.Excel]: 'Excel',\n  [ViewVariableType.Audio]: 'Audio',\n  [ViewVariableType.Zip]: 'Zip',\n  [ViewVariableType.Video]: 'Video',\n  [ViewVariableType.Svg]: 'Svg',\n  [ViewVariableType.Voice]: 'Voice',\n  [ViewVariableType.Time]: 'Time',\n  [ViewVariableType.ArrayString]: 'Array<String>',\n  [ViewVariableType.ArrayInteger]: 'Array<Integer>',\n  [ViewVariableType.ArrayBoolean]: 'Array<Boolean>',\n  [ViewVariableType.ArrayNumber]: 'Array<Number>',\n  [ViewVariableType.ArrayObject]: 'Array<Object>',\n  [ViewVariableType.ArrayImage]: 'Array<Image>',\n  [ViewVariableType.ArrayFile]: 'Array<File>',\n  [ViewVariableType.ArrayDoc]: 'Array<Doc>',\n  [ViewVariableType.ArrayCode]: 'Array<Code>',\n  [ViewVariableType.ArrayPpt]: 'Array<PPT>',\n  [ViewVariableType.ArrayTxt]: 'Array<Txt>',\n  [ViewVariableType.ArrayExcel]: 'Array<Excel>',\n  [ViewVariableType.ArrayAudio]: 'Array<Audio>',\n  [ViewVariableType.ArrayZip]: 'Array<Zip>',\n  [ViewVariableType.ArrayVideo]: 'Array<Video>',\n  [ViewVariableType.ArraySvg]: 'Array<Svg>',\n  [ViewVariableType.ArrayVoice]: 'Array<Voice>',\n  [ViewVariableType.ArrayTime]: 'Array<Time>',\n};\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ViewVariableType {\n  export const LabelMap = VARIABLE_TYPE_ALIAS_MAP;\n  export const ArrayTypes = BASE_ARRAY_PAIR.map(_pair => _pair[1]);\n\n  export function getLabel(type: ViewVariableType): string {\n    return LabelMap[type];\n  }\n\n  /**\n   * Get the complement of all variable types\n   * This function is generated by GPT\n   * @param inputTypes\n   */\n  export function getComplement(inputTypes: ViewVariableType[]) {\n    const allTypes: ViewVariableType[] = [\n      ...BASE_ARRAY_PAIR.map(_pair => _pair[0]),\n      ...BASE_ARRAY_PAIR.map(_pair => _pair[1]),\n    ];\n\n    return allTypes.filter(type => !inputTypes.includes(type));\n  }\n\n  export function canDrilldown(type: ViewVariableType): boolean {\n    return [ViewVariableType.Object, ViewVariableType.ArrayObject].includes(\n      type,\n    );\n  }\n\n  export function isArrayType(type: ViewVariableType): boolean {\n    const arrayTypes = BASE_ARRAY_PAIR.map(_pair => _pair[1]);\n    return arrayTypes.includes(type);\n  }\n\n  export function isFileType(type: ViewVariableType): boolean {\n    return FILE_TYPES.includes(type);\n  }\n\n  export function isVoiceType(type: ViewVariableType): boolean {\n    return [ViewVariableType.Voice].includes(type);\n  }\n\n  /**\n   * Variable types that use JSON to represent values\n   * @param type\n   * @returns\n   */\n  export function isJSONInputType(type: ViewVariableType): boolean {\n    return JSON_INPUT_TYPES.includes(type);\n  }\n\n  export function getArraySubType(type: ViewVariableType): ViewVariableType {\n    const subType = BASE_ARRAY_PAIR.find(_pair => _pair[1] === type)?.[0];\n\n    if (!subType) {\n      throw new Error('WorkflowVariableEntity Error: Unknown Variable Type');\n    }\n\n    return subType;\n  }\n\n  export function wrapToArrayType(type: ViewVariableType): ViewVariableType {\n    const arrayType = BASE_ARRAY_PAIR.find(_pair => _pair[0] === type)?.[1];\n\n    if (!arrayType) {\n      throw new Error('WorkflowVariableEntity Error: Unknown Variable Type');\n    }\n\n    return arrayType;\n  }\n\n  export function getAllArrayType(): ViewVariableType[] {\n    const allTypes: ViewVariableType[] = [\n      ...BASE_ARRAY_PAIR.map(_pair => _pair[0]),\n      ...BASE_ARRAY_PAIR.map(_pair => _pair[1]),\n    ];\n\n    return allTypes.filter(isArrayType);\n  }\n}\n\nexport interface InputVariable {\n  name: string;\n  /**\n   * The id does not necessarily have a front-end and back-end convention, imposed by the front-end. Risk: This property may be deleted when workflowSchema is structured\n   * If you need an id, define it in the nodes schema:\n   *  getDefaultAppendValue: () => ({\n          id: nanoid(),\n        }),\n   * Reference packages/workflow/nodes/src/workflow-nodes/image-canvas/index.ts\n   * It can only be guaranteed to be unique within the same node, it can only be guaranteed to be unique within the same node, and it can only be guaranteed to be unique within the same node.\n   * Because nodes can create replicas\n   */\n  id?: string;\n  type: ViewVariableType;\n  /**\n   * index\n   */\n  index: number;\n}\n\n/** Variable display labels on cards */\nexport interface VariableTagProps {\n  key?: string;\n  /* Variable type */\n  type?: ViewVariableType;\n  /* Variable name, when empty, is displayed as Undefined/Undefined */\n  label?: ReactNode;\n  /** Is it valid? */\n  invalid?: boolean;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { DynamicParams } from '@coze-arch/bot-typings/teamspace';\nimport { useParams } from 'react-router-dom';\n\nexport const useOpenWorkflowDetail = () => {\n  const { bot_id: botId } = useParams<DynamicParams>();\n\n  /** Open the process details page */\n  const openWorkflowDetailPage = ({\n    workflowId,\n    spaceId,\n    projectId,\n    ideNavigate,\n  }: {\n    workflowId: string;\n    spaceId: string;\n    projectId?: string;\n    ideNavigate?: (uri: string) => void;\n  }) => {\n    if (projectId && ideNavigate) {\n      ideNavigate(`/workflow/${workflowId}?from=createSuccess`);\n    } else {\n      const query = new URLSearchParams();\n      botId && query.append('bot_id', botId);\n      query.append('space_id', spaceId ?? '');\n      query.append('workflow_id', workflowId);\n      query.append('from', 'createSuccess');\n      window.open(`/work_flow?${query.toString()}`, '_blank');\n    }\n  };\n  return openWorkflowDetailPage;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\n/* eslint-disable @coze-arch/max-line-per-function */\n\nimport {\n  type Dispatch,\n  type SetStateAction,\n  useCallback,\n  useMemo,\n  useState,\n} from 'react';\n\nimport { omit } from 'lodash-es';\nimport {\n  useInfiniteQuery,\n  type UseInfiniteQueryResult,\n} from '@tanstack/react-query';\nimport {\n  WorkflowMode,\n  type GetWorkFlowListRequest,\n  type GetExampleWorkFlowListRequest,\n  type GetWorkFlowListResponse,\n  type GetExampleWorkFlowListResponse,\n  WorkFlowType,\n  DeleteType,\n  workflowApi,\n  DeleteAction,\n  type WorkflowListByBindBizRequest,\n  SchemaType,\n  BindBizType,\n  CheckType,\n} from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { reporter, wait } from '../utils';\nimport { type WorkflowInfo, WorkflowModalFrom } from '../types';\n\ninterface FetchWorkflowListResult {\n  total: number;\n  workflow_list: WorkflowInfo[];\n}\n\ninterface WorkflowListReturn {\n  flowType: WorkFlowType;\n  setFlowType: Dispatch<SetStateAction<WorkFlowType>>;\n  flowMode: WorkflowMode;\n  setFlowMode: Dispatch<SetStateAction<WorkflowMode>>;\n  spaceId: string;\n  setSpaceId: Dispatch<SetStateAction<string>>;\n  status: GetWorkFlowListRequest['status'] | undefined;\n  setStatus: Dispatch<\n    SetStateAction<GetWorkFlowListRequest['status'] | undefined>\n  >;\n  name: GetWorkFlowListRequest['name'] | undefined;\n  setName: Dispatch<SetStateAction<GetWorkFlowListRequest['name'] | undefined>>;\n  tags: GetWorkFlowListRequest['tags'] | undefined;\n  setTags: Dispatch<SetStateAction<GetWorkFlowListRequest['tags'] | undefined>>;\n  orderBy: GetWorkFlowListRequest['order_by'] | undefined;\n  setOrderBy: Dispatch<\n    SetStateAction<GetWorkFlowListRequest['order_by'] | undefined>\n  >;\n  loginUserCreate: boolean | undefined;\n  setLoginUserCreate: Dispatch<SetStateAction<boolean | undefined>>;\n  updatePageParam: (\n    newParam: Partial<GetWorkFlowListRequest & WorkflowListByBindBizRequest>,\n  ) => void;\n  workflowList: WorkflowInfo[];\n  total: number;\n  queryError: UseInfiniteQueryResult['error'];\n  fetchNextPage: UseInfiniteQueryResult['fetchNextPage'];\n  hasNextPage: UseInfiniteQueryResult['hasNextPage'];\n  isFetching: UseInfiniteQueryResult['isFetching'];\n  isFetchingNextPage: UseInfiniteQueryResult['isFetchingNextPage'];\n  loadingStatus: UseInfiniteQueryResult['status'];\n  refetch: UseInfiniteQueryResult['refetch'];\n  handleCopy: (item: WorkflowInfo) => Promise<void>;\n  handleDelete: (item: WorkflowInfo) => Promise<{\n    canDelete: boolean;\n    deleteType: DeleteType;\n    handleDelete:\n      | ((params?: { needDeleteBlockwise: boolean }) => Promise<void>)\n      | undefined;\n  }>;\n}\n\nconst defaultPageSize = 20;\n\n/**\n * process list\n */\nexport function useWorkflowList({\n  pageSize = defaultPageSize,\n  enabled = false,\n  from,\n  fetchWorkflowListApi = workflowApi.GetWorkFlowList.bind(workflowApi),\n}: {\n  pageSize?: number;\n  /** Whether to enable data acquisition */\n  enabled?: boolean;\n  from?: WorkflowModalFrom;\n  fetchWorkflowListApi?: (\n    params: GetWorkFlowListRequest | GetExampleWorkFlowListRequest,\n  ) => Promise<GetWorkFlowListResponse | GetExampleWorkFlowListResponse>;\n} = {}): Readonly<WorkflowListReturn> {\n  const [flowMode, setFlowMode] = useState<WorkflowMode>(WorkflowMode.All);\n  const [flowType, setFlowType] = useState<WorkFlowType>(WorkFlowType.User);\n  const [spaceId, setSpaceId] = useState<string>('');\n  const [name, setName] = useState<GetWorkFlowListRequest['name']>();\n  const [status, setStatus] = useState<GetWorkFlowListRequest['status']>();\n  const [orderBy, setOrderBy] = useState<GetWorkFlowListRequest['order_by']>();\n  const [tags, setTags] = useState<GetWorkFlowListRequest['tags']>();\n  const [bindBizId, setBindBizId] =\n    useState<WorkflowListByBindBizRequest['bind_biz_id']>();\n  const [bindBizType, setBindBizType] =\n    useState<WorkflowListByBindBizRequest['bind_biz_type']>();\n  const [loginUserCreate, setLoginUserCreate] =\n    useState<GetWorkFlowListRequest['login_user_create']>();\n  const [projectId, setProjectId] =\n    useState<GetWorkFlowListRequest['project_id']>('');\n  const initialPageParam = useMemo<GetWorkFlowListRequest>(\n    () => ({\n      page: 1,\n      size: pageSize,\n      type: flowType,\n      name,\n      space_id: spaceId,\n      status,\n      tags,\n      order_by: orderBy,\n      login_user_create: loginUserCreate,\n      flow_mode: flowMode,\n      bind_biz_id: bindBizId,\n      bind_biz_type: bindBizType,\n      project_id: projectId,\n    }),\n    [\n      flowType,\n      status,\n      name,\n      flowMode,\n      orderBy,\n      spaceId,\n      loginUserCreate,\n      tags,\n      bindBizId,\n      bindBizType,\n      projectId,\n    ],\n  );\n\n  const updatePageParam = useCallback(\n    (newParam: Partial<GetWorkFlowListRequest>) => {\n      [\n        { key: 'type', func: setFlowType, defaultValue: WorkFlowType.User },\n        { key: 'name', func: setName },\n        { key: 'space_id', func: setSpaceId, defaultValue: '' },\n        { key: 'status', func: setStatus },\n        { key: 'tags', func: setTags },\n        { key: 'order_by', func: setOrderBy },\n        { key: 'login_user_create', func: setLoginUserCreate },\n        {\n          key: 'flow_mode',\n          func: setFlowMode,\n          defaultValue: WorkflowMode.All,\n        },\n        { key: 'bind_biz_id', func: setBindBizId },\n        { key: 'bind_biz_type', func: setBindBizType },\n        { key: 'project_id', func: setProjectId },\n      ]\n        .filter(({ key }) => key in newParam)\n        .forEach(({ key, defaultValue, func }) =>\n          func?.(newParam[key] ?? defaultValue),\n        );\n    },\n    [],\n  );\n\n  const fetchWorkflowList = async (\n    params: GetWorkFlowListRequest & WorkflowListByBindBizRequest,\n  ): Promise<FetchWorkflowListResult> => {\n    try {\n      reporter.info({\n        message: 'workflow_list_get_list',\n      });\n\n      const result: FetchWorkflowListResult = {\n        total: 0,\n        workflow_list: [],\n      };\n\n      if (params.bind_biz_type === BindBizType.Scene && params.bind_biz_id) {\n        const resp = await workflowApi.WorkflowListByBindBiz(params);\n        result.total = (resp.data.total as number) ?? 0;\n        // Set process permissions\n        result.workflow_list = (resp.data.workflow_list ?? []).map(\n          (item): WorkflowInfo => {\n            const authInfo = {\n              can_edit: true,\n              can_copy: true,\n              can_delete: !!item?.creator?.self,\n            };\n            return {\n              ...item,\n              authInfo,\n            };\n          },\n        );\n      } else {\n        // Multiplayer collaboration scenarios, DEV mode needs to demonstrate Blockwise workflow (except for process list references)\n        Object.assign(params, {\n          schema_type_list: [SchemaType.FDL],\n          checker:\n            from === WorkflowModalFrom.WorkflowAgent\n              ? [CheckType.BotAgent]\n              : undefined,\n        });\n\n        const isDouyinBot = params.bind_biz_type === BindBizType.DouYinBot;\n        // If not Douyin doppelganger mode, search parameters do not carry bind_biz_id parameters\n        // Otherwise, it will cause a workflow to be associated with the agent after 0, and then the workflow list will not be visible when a child workflow is added to the workflow\n        const fetchParams = isDouyinBot\n          ? params\n          : omit(params, ['bind_biz_id']);\n\n        const resp = await fetchWorkflowListApi(fetchParams);\n        result.total = (resp.data.total as number) ?? 0;\n        // Set process permissions\n        result.workflow_list = (resp.data.workflow_list ?? []).map(\n          (item): WorkflowInfo => {\n            let authInfo = {\n              can_edit: true,\n              can_copy: true,\n              can_delete: !!item?.creator?.self,\n            };\n            const authItem = (resp.data.auth_list ?? []).find(\n              it => it.workflow_id === item.workflow_id,\n            );\n            if (authItem) {\n              authInfo = { ...authInfo, ...authItem.auth };\n            }\n\n            return {\n              ...item,\n              authInfo,\n            };\n          },\n        );\n      }\n\n      reporter.info({\n        message: 'workflow_list_get_list_success',\n        meta: {\n          currentPage: params.page,\n          pageSize: params.size,\n          order_by: params.order_by,\n          name: params.name,\n          total: result.total,\n        },\n      });\n      return result;\n    } catch (error) {\n      reporter.error({\n        message: 'workflow_list_get_list_fail',\n        error,\n      });\n      throw error;\n    }\n  };\n\n  const {\n    data: pageData,\n    error: queryError,\n    fetchNextPage,\n    hasNextPage,\n    isFetching,\n    isFetchingNextPage,\n    status: loadingStatus,\n    refetch,\n  } = useInfiniteQuery({\n    enabled: enabled && !!spaceId,\n    queryKey: ['space_workflow_list', 'vcs', JSON.stringify(initialPageParam)],\n    queryFn: ({ pageParam }) => fetchWorkflowList(pageParam),\n    initialPageParam,\n    getNextPageParam: (lastPage, allPages, lastPageParam) => {\n      if ((lastPageParam.page ?? 1) * pageSize > lastPage.total) {\n        return null;\n      }\n      return {\n        ...lastPageParam,\n        page: (lastPageParam.page ?? 1) + 1,\n      };\n    },\n  });\n\n  const workflowList = useMemo(() => {\n    const result: WorkflowInfo[] = [];\n    const idMap: Record<string, boolean> = {};\n    pageData?.pages.forEach(page => {\n      page.workflow_list.forEach(workflow => {\n        if (!workflow.workflow_id) {\n          return;\n        }\n\n        if (!idMap[workflow.workflow_id]) {\n          result.push(workflow);\n        }\n        idMap[workflow.workflow_id] = true;\n      });\n    });\n    return result;\n  }, [pageData]);\n\n  const total = useMemo(() => {\n    if (\n      !pageData?.pages ||\n      !Array.isArray(pageData.pages) ||\n      pageData.pages.length === 0\n    ) {\n      return 0;\n    }\n\n    return pageData.pages[pageData.pages.length - 1].total ?? 0;\n  }, [pageData]);\n\n  // copy\n  const handleCopy = async (item: WorkflowInfo) => {\n    if (!item.workflow_id || !spaceId) {\n      throw new CustomError('normal_error', 'miss workflowId or spaceID');\n    }\n\n    // Check copy permissions\n    if (!item.authInfo.can_copy) {\n      throw new CustomError('normal_error', 'no copy permission');\n    }\n    reporter.info({\n      message: 'workflow_list_copy_row',\n      meta: {\n        workflowId: item.workflow_id,\n      },\n    });\n\n    try {\n      let isError = false;\n      const { data } = await workflowApi.CopyWorkflow({\n        space_id: spaceId,\n        workflow_id: item.workflow_id,\n      });\n      isError = !data?.workflow_id;\n\n      if (isError) {\n        Toast.error(I18n.t('workflow_detail_toast_createcopy_failed'));\n        reporter.error({\n          message: 'workflow_list_copy_row_fail',\n          error: new CustomError('normal_error', 'result no workflow'),\n        });\n        return;\n      }\n\n      Toast.success({\n        content:\n          flowMode === WorkflowMode.Imageflow\n            ? I18n.t('imageflow_detail_toast_createcopy_succeed')\n            : I18n.t('workflow_detail_toast_createcopy_succeed'),\n        showClose: false,\n      });\n\n      reporter.info({\n        message: 'workflow_list_copy_row_success',\n        meta: {\n          workflowId: item.workflow_id,\n        },\n      });\n\n      // Bottom line leader/follower delay\n      await wait(300);\n\n      // refresh list\n      refetch();\n    } catch (error) {\n      reporter.error({\n        message: 'workflow_list_copy_row_fail',\n        error,\n      });\n      Toast.error(I18n.t('workflow_detail_toast_createcopy_failed'));\n    }\n  };\n\n  // delete\n  const handleDelete = async (item: WorkflowInfo) => {\n    if (!item.workflow_id || !spaceId) {\n      throw new CustomError('normal_error', 'miss workflowId or spaceID');\n    }\n\n    // Check the delete permission first\n    if (!item.authInfo.can_delete) {\n      throw new CustomError('normal_error', 'no delete permission');\n    }\n\n    reporter.info({\n      message: 'workflow_list_delete_row',\n      meta: {\n        workflowId: item.workflow_id,\n      },\n    });\n\n    let deleteType = DeleteType.CanDelete;\n\n    // Delete mode from server level query\n    const resp = await workflowApi.GetDeleteStrategy({\n      space_id: spaceId,\n      workflow_id: item.workflow_id,\n    });\n    deleteType = resp.data;\n\n    const canDelete = [\n      DeleteType.CanDelete,\n      DeleteType.RejectProductDraft,\n    ].includes(deleteType);\n\n    const deleteFuc = async (deleteParams?: {\n      needDeleteBlockwise: boolean;\n    }) => {\n      const needDeleteBlockwise = deleteParams?.needDeleteBlockwise;\n      const action = needDeleteBlockwise\n        ? DeleteAction.BlockwiseDelete\n        : DeleteAction.BlockwiseUnbind;\n\n      if (!item.workflow_id || !spaceId) {\n        throw new CustomError('normal_error', 'miss workflowId or spaceID');\n      }\n      try {\n        await workflowApi.DeleteWorkflow({\n          space_id: spaceId,\n          workflow_id: item.workflow_id,\n          action,\n        });\n\n        Toast.success({\n          content: I18n.t('workflow_add_delete_success'),\n          showClose: false,\n        });\n\n        reporter.info({\n          message: 'workflow_list_delete_row_success',\n        });\n\n        // Bottom line leader/follower delay\n        await wait(300);\n\n        // refresh list\n        refetch();\n      } catch (error) {\n        reporter.error({\n          message: 'workflow_list_delete_row_fail',\n          error,\n        });\n        Toast.error({\n          content: I18n.t('workflow_add_delete_fail'),\n          showClose: false,\n        });\n      }\n    };\n    return {\n      /** Can it be deleted */\n      canDelete,\n      /** delete policy */\n      deleteType,\n      /** Delete method */\n      handleDelete: canDelete ? deleteFuc : undefined,\n    };\n  };\n\n  return {\n    // list filter status\n    flowType,\n    setFlowType,\n    flowMode,\n    setFlowMode,\n    spaceId,\n    setSpaceId,\n    status,\n    setStatus,\n    name,\n    setName,\n    tags,\n    setTags,\n    orderBy,\n    setOrderBy,\n    loginUserCreate,\n    setLoginUserCreate,\n    /** Update filter parameters */\n    updatePageParam,\n    // list acquisition\n    /** process list data */\n    workflowList,\n    /** total number of processes */\n    total,\n    /** Get list request error */\n    queryError,\n    /** Pull the next page of data */\n    fetchNextPage,\n    /** Is there a next page? */\n    hasNextPage,\n    /** Acquiring data */\n    isFetching,\n    /** Get the next page of data */\n    isFetchingNextPage,\n    /** loading status */\n    loadingStatus,\n    /** Reload */\n    refetch,\n    // list operation\n    /** replication process */\n    handleCopy,\n    // /** Delete process */process */\n    handleDelete,\n  } as const;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ExpressionEditorEvent {\n  Change = 'change',\n  Select = 'select',\n  Dispose = 'dispose',\n  CompositionStart = 'compositionStart',\n}\n\nexport enum ExpressionEditorToken {\n  Start = '{',\n  End = '}',\n  FullStart = '{{',\n  FullEnd = '}}',\n  Separator = '.',\n  ArrayStart = '[',\n  ArrayEnd = ']',\n}\n\nexport enum ExpressionEditorSegmentType {\n  ObjectKey = 'object_key',\n  ArrayIndex = 'array_index',\n  EndEmpty = 'end_empty',\n}\n\nexport enum ExpressionEditorSignal {\n  Line = 'paragraph',\n  Valid = 'valid',\n  Invalid = 'invalid',\n  SelectedValid = 'selectedValid',\n  SelectedInvalid = 'selectedInvalid',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Dispatch, RefObject } from 'react';\n\nimport type { Tree } from '@coze-arch/bot-semi';\nimport type { SelectorBoxConfigEntity } from '@flowgram-adapter/free-layout-editor';\nimport type { PlaygroundConfigEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport type {\n  ExpressionEditorParseData,\n  ExpressionEditorTreeNode,\n} from '../../type';\nimport type { ExpressionEditorModel } from '../../model';\n\nexport interface SuggestionState {\n  initialized: boolean;\n  version: number;\n  model: ExpressionEditorModel;\n  entities: {\n    playgroundConfig?: PlaygroundConfigEntity;\n    selectorBoxConfig?: SelectorBoxConfigEntity;\n  };\n  ref: {\n    container: RefObject<HTMLDivElement>;\n    suggestion: RefObject<HTMLDivElement>;\n    tree: RefObject<Tree>;\n  };\n  key: number;\n  variableTree: ExpressionEditorTreeNode[];\n  visible: boolean;\n  allowVisibleChange: boolean;\n  hiddenDOM: boolean;\n  renderEffect: {\n    search: boolean;\n    filtered: boolean;\n  };\n  rect?: {\n    top: number;\n    left: number;\n  };\n  selected?: ExpressionEditorTreeNode;\n  parseData?: ExpressionEditorParseData;\n  editorPath?: number[];\n  emptyContent?: string;\n  matchTreeBranch?: ExpressionEditorTreeNode[];\n}\n\nexport enum SuggestionActionType {\n  SetInitialized = 'set_initialized',\n  Refresh = 'refresh',\n  SetParseDataAndEditorPath = 'set_parse_data_and_editor_path',\n  ClearParseDataAndEditorPath = 'clear_parse_data_and_editor_path',\n  SetVariableTree = 'set_variable_tree',\n  SetVisible = 'set_visible',\n  SetAllowVisibleChange = 'set_allow_visible_change',\n  SetHiddenDOM = 'set_hidden_dom',\n  SetRect = 'set_rect',\n  SetSelected = 'set_selected',\n  SetEmptyContent = 'set_empty_content',\n  SetMatchTreeBranch = 'set_match_tree_branch',\n  SearchEffectStart = 'search_effect_start',\n  SearchEffectEnd = 'search_effect_end',\n  FilteredEffectStart = 'filtered_effect_start',\n  FilteredEffectEnd = 'filtered_effect_end',\n}\n\nexport type SuggestionActionPayload<T extends SuggestionActionType> = {\n  [SuggestionActionType.SetInitialized]?: undefined;\n  [SuggestionActionType.Refresh]?: undefined;\n  [SuggestionActionType.SetParseDataAndEditorPath]?: {\n    parseData: ExpressionEditorParseData;\n    editorPath: number[];\n  };\n  [SuggestionActionType.ClearParseDataAndEditorPath]?: undefined;\n  [SuggestionActionType.SetVariableTree]: ExpressionEditorTreeNode[];\n  [SuggestionActionType.SetVisible]: boolean;\n  [SuggestionActionType.SetAllowVisibleChange]: boolean;\n  [SuggestionActionType.SetHiddenDOM]: boolean;\n  [SuggestionActionType.SetRect]: {\n    top: number;\n    left: number;\n  };\n  [SuggestionActionType.SetSelected]?: ExpressionEditorTreeNode;\n  [SuggestionActionType.SetEmptyContent]?: string;\n  [SuggestionActionType.SetMatchTreeBranch]:\n    | ExpressionEditorTreeNode[]\n    | undefined;\n  [SuggestionActionType.SearchEffectStart]?: undefined;\n  [SuggestionActionType.SearchEffectEnd]?: undefined;\n  [SuggestionActionType.FilteredEffectStart]?: undefined;\n  [SuggestionActionType.FilteredEffectEnd]?: undefined;\n}[T];\n\nexport interface SuggestionAction<\n  T extends SuggestionActionType = SuggestionActionType,\n> {\n  type: SuggestionActionType;\n  payload?: SuggestionActionPayload<T>;\n}\n\nexport type SuggestionReducer = [SuggestionState, Dispatch<SuggestionAction>];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-magic-numbers */\nimport { ViewVariableType } from '@coze-workflow/base/types';\n\nimport type {\n  ExpressionEditorTreeNode,\n  ExpressionEditorSegment,\n  ExpressionEditorVariable,\n} from '../type';\nimport { ExpressionEditorSegmentType } from '../constant';\n\nexport namespace ExpressionEditorTreeHelper {\n  export interface Input {\n    name: string;\n    keyPath?: string[];\n    children?: Input[];\n  }\n\n  export interface AvailableVariable extends Input {\n    variable?: ExpressionEditorVariable;\n    children?: AvailableVariable[];\n  }\n\n  const findAvailableVariable = (params: {\n    variables: ExpressionEditorVariable[];\n    input: Input;\n  }): AvailableVariable => {\n    const { variables, input } = params;\n\n    if (!input.keyPath) {\n      return {\n        name: input.name,\n      };\n    }\n    const nodeId = input.keyPath.shift();\n    const nodePath = input.keyPath;\n    const nodeVariables = variables.filter(\n      variable => variable.nodeId === nodeId,\n    );\n    let variable: ExpressionEditorVariable | undefined;\n    nodePath.reduce(\n      (\n        availableVariables: ExpressionEditorVariable[],\n        path: string,\n        index: number,\n      ) => {\n        const targetVariable = availableVariables.find(\n          availableVariable => availableVariable.key === path,\n        );\n        if (index === nodePath.length - 1) {\n          variable = targetVariable;\n        }\n        if (targetVariable && targetVariable.children) {\n          return targetVariable.children;\n        }\n        return [];\n      },\n      nodeVariables,\n    );\n    if (!variable) {\n      return {\n        name: input.name,\n      };\n    }\n    return {\n      name: input.name,\n      keyPath: input.keyPath,\n      variable,\n    };\n  };\n\n  export const findAvailableVariables = (params: {\n    variables: ExpressionEditorVariable[];\n    inputs: Input[];\n  }): AvailableVariable[] => {\n    const { variables, inputs } = params;\n    return inputs.map(input => {\n      const availableVariable = findAvailableVariable({ input, variables });\n\n      if (input.children?.length) {\n        availableVariable.children = findAvailableVariables({\n          variables,\n          inputs: input.children || [],\n        });\n      }\n\n      return availableVariable;\n    });\n  };\n\n  const createVariableLeaves = (\n    variables: ExpressionEditorVariable[],\n    parent: ExpressionEditorTreeNode,\n  ): ExpressionEditorTreeNode[] =>\n    variables.map(\n      (variable: ExpressionEditorVariable): ExpressionEditorTreeNode => {\n        const node: ExpressionEditorTreeNode = {\n          label: variable.name,\n          value: `${parent.value}.${variable.key}`,\n          key: `${parent.value}.${variable.key}`,\n          variable,\n          parent,\n        };\n        node.children = createVariableLeaves(variable.children || [], node);\n        return node;\n      },\n    );\n\n  export const createVariableTree = (\n    availableVariables: AvailableVariable[],\n    parent?: ExpressionEditorTreeNode,\n  ): ExpressionEditorTreeNode[] =>\n    availableVariables.map(\n      (availableVariable: AvailableVariable): ExpressionEditorTreeNode => {\n        const path = parent\n          ? `${parent.key}.${availableVariable.name}`\n          : availableVariable.name;\n\n        const node: ExpressionEditorTreeNode = {\n          label: availableVariable.name,\n          value: availableVariable.keyPath?.join('.') || path,\n          key: path,\n          keyPath: availableVariable.keyPath,\n          variable: availableVariable.variable,\n          parent,\n        };\n\n        if (availableVariable.children?.length) {\n          node.children = createVariableTree(availableVariable.children, node);\n        } else {\n          node.children = createVariableLeaves(\n            availableVariable.variable?.children || [],\n            node,\n          );\n        }\n\n        return node;\n      },\n    );\n\n  export const pruning = (params: {\n    tree: ExpressionEditorTreeNode[];\n    segments: ExpressionEditorSegment[];\n  }): ExpressionEditorTreeNode[] => {\n    const { tree, segments } = params;\n    if (segments.length === 0) {\n      return tree;\n    }\n    const lastSegment = segments[segments.length - 1];\n    const segmentsRemovedLast =\n      lastSegment.type === ExpressionEditorSegmentType.ArrayIndex\n        ? segments.slice(0, segments.length - 2) // The array index belongs to the previous level, and two layers need to be removed.\n        : segments.slice(0, segments.length - 1);\n    let treeLayer = tree;\n    segmentsRemovedLast.forEach(segment => {\n      if (segment.type !== ExpressionEditorSegmentType.ObjectKey) {\n        return;\n      }\n      const treeChild = treeLayer.find(\n        node => node.label === segment.objectKey,\n      );\n      if (treeChild) {\n        treeLayer = treeChild.children || [];\n      } else {\n        treeLayer = [];\n      }\n    });\n    return treeLayer;\n  };\n\n  export const concatFullPath = (params: {\n    node: ExpressionEditorTreeNode;\n    segments: ExpressionEditorSegment[];\n  }): string => {\n    const { node, segments } = params;\n    let current: ExpressionEditorTreeNode | undefined = node;\n    const pathList: { objectKey: string; arrayIndex?: number }[] = [];\n    while (current) {\n      if (current.variable?.type === ViewVariableType.ArrayObject) {\n        // Default 0th\n        pathList.unshift({\n          objectKey: current.label,\n          arrayIndex: 0,\n        });\n      } else {\n        pathList.unshift({\n          objectKey: current.label,\n        });\n      }\n      current = current.parent;\n    }\n    let pathIndex = 0;\n    segments.find((segment, index) => {\n      if (segment.type !== ExpressionEditorSegmentType.ObjectKey) {\n        return false;\n      }\n      const pathItem = pathList[pathIndex];\n      pathIndex++;\n      if (pathItem.objectKey !== segment.objectKey) {\n        // exit the loop\n        return true;\n      }\n      const nextSegment = segments[index + 1];\n      if (\n        typeof pathItem.arrayIndex === 'number' &&\n        nextSegment?.type === ExpressionEditorSegmentType.ArrayIndex\n      ) {\n        pathItem.arrayIndex = nextSegment.arrayIndex;\n      }\n      return false;\n    });\n    return pathList\n      .map((pathItem, index) => {\n        const isLastPathItem = index === pathList.length - 1;\n        if (typeof pathItem.arrayIndex === 'number' && !isLastPathItem) {\n          return `${pathItem.objectKey}[${pathItem.arrayIndex}]`;\n        }\n        return pathItem.objectKey;\n      })\n      .join('.');\n  };\n\n  export const matchTreeBranch = (params: {\n    tree: ExpressionEditorTreeNode[];\n    segments: ExpressionEditorSegment[];\n  }): ExpressionEditorTreeNode[] | undefined => {\n    const { tree, segments } = params;\n    const treeBranch: (ExpressionEditorTreeNode | null)[] = [];\n    let treeLayer = tree;\n    const invalid = segments.find((segment, index) => {\n      const itemInvalid = (): boolean => {\n        treeBranch.push(null);\n        return true;\n      };\n      const itemValid = (treeNode?: ExpressionEditorTreeNode): boolean => {\n        treeBranch.push(treeNode || null);\n        return false;\n      };\n      const beforeTreeNode = treeBranch[treeBranch.length - 1];\n      // Verify Illegal Case: Whether to Use Array Indexing for Non-Array Types\n      if (\n        segment.type === ExpressionEditorSegmentType.ArrayIndex &&\n        beforeTreeNode &&\n        (!beforeTreeNode.variable ||\n          !ViewVariableType.isArrayType(beforeTreeNode.variable.type))\n      ) {\n        return itemInvalid();\n      }\n      // Confirm illegal condition: Array can only follow array subscript\n      if (\n        beforeTreeNode?.variable?.type &&\n        ViewVariableType.isArrayType(beforeTreeNode.variable.type) &&\n        segment.type !== ExpressionEditorSegmentType.ArrayIndex\n      ) {\n        return itemInvalid();\n      }\n      // ignore\n      if (segment.type !== ExpressionEditorSegmentType.ObjectKey) {\n        return itemValid();\n      }\n      const treeNode = treeLayer.find(node => node.label === segment.objectKey);\n      // Verify illegal condition: each object key must correspond to a variable node\n      if (!treeNode) {\n        return itemInvalid();\n      }\n      treeLayer = treeNode.children || [];\n      return itemValid(treeNode);\n    });\n    const filteredTreeBranch = treeBranch.filter(\n      Boolean,\n    ) as ExpressionEditorTreeNode[];\n    const filteredSegments = segments.filter(\n      segment => segment.type === ExpressionEditorSegmentType.ObjectKey,\n    );\n    if (invalid || filteredSegments.length !== filteredTreeBranch.length) {\n      return;\n    }\n    return filteredTreeBranch;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\nimport { Node } from 'slate';\n\nimport type {\n  ExpressionEditorLine,\n  ExpressionEditorParseData,\n  ExpressionEditorSegment,\n} from '../type';\nimport {\n  ExpressionEditorSegmentType,\n  ExpressionEditorSignal,\n  ExpressionEditorToken,\n} from '../constant';\n\nexport namespace ExpressionEditorParserBuiltin {\n  /** Calculate the serial number of the start and end tags */\n  export const tokenOffset = (line: {\n    lineContent: string;\n    lineOffset: number;\n  }):\n    | {\n        lastStartTokenOffset: number;\n        firstEndTokenOffset: number;\n      }\n    | undefined => {\n    const { lineContent: content, lineOffset: offset } = line;\n\n    const firstEndTokenOffset = content.indexOf(\n      ExpressionEditorToken.End,\n      offset,\n    );\n\n    const endChars = content.slice(\n      firstEndTokenOffset,\n      // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n      firstEndTokenOffset + 2,\n    );\n    if (endChars !== ExpressionEditorToken.FullEnd) {\n      // End symbol \"}}\" is incomplete\n      return;\n    }\n    const lastStartTokenOffset = content.lastIndexOf(\n      ExpressionEditorToken.Start,\n      offset - 1,\n    );\n    const startChars = content.slice(\n      lastStartTokenOffset - 1,\n      lastStartTokenOffset + 1,\n    );\n    if (startChars !== ExpressionEditorToken.FullStart) {\n      // The opening symbol \"{{\" is incomplete\n      return;\n    }\n    return {\n      lastStartTokenOffset,\n      firstEndTokenOffset,\n    };\n  };\n\n  /** Extract content from line content */\n  export const extractContent = (params: {\n    lineContent: string;\n    lineOffset: number;\n    lastStartTokenOffset: number;\n    firstEndTokenOffset: number;\n  }):\n    | {\n        content: string;\n        offset: number;\n      }\n    | undefined => {\n    const {\n      lineContent,\n      lineOffset,\n      lastStartTokenOffset,\n      firstEndTokenOffset,\n    } = params;\n    const content = lineContent.slice(\n      lastStartTokenOffset + 1,\n      firstEndTokenOffset,\n    );\n    const offset = lineOffset - lastStartTokenOffset - 1;\n    return {\n      content,\n      offset,\n    };\n  };\n\n  /** Split text content into available and unavailable by offset */\n  export const sliceReachable = (params: {\n    content: string;\n    offset: number;\n  }): {\n    reachable: string;\n    unreachable: string;\n  } => {\n    const { content, offset } = params;\n    const reachable = content.slice(0, offset);\n    const unreachable = content.slice(offset, content.length);\n    return {\n      reachable,\n      unreachable,\n    };\n  };\n\n  /** Split text */\n  export const splitText = (pathString: string): string[] => {\n    // The obtained split array, initially the result of splitting the original string with \".\"\n    const segments = pathString.split(ExpressionEditorToken.Separator);\n\n    // Define the result array and handle empty strings resulting from consecutive \".\"\n    const result: string[] = [];\n\n    segments.forEach(segment => {\n      if (!segment.match(/\\[\\d+\\]/)) {\n        // If it is not an array index, add the result array directly, even if it is an empty string, to maintain the correct segmentation\n        result.push(segment);\n        return;\n      }\n      // If the current segment is an array index, add the previous string and the current array index to the result array, respectively\n      const lastSegmentIndex = segment.lastIndexOf(\n        ExpressionEditorToken.ArrayStart,\n      );\n      const key = segment.substring(0, lastSegmentIndex);\n      const index = segment.substring(lastSegmentIndex);\n      // Array in {{array [0]}}\n      result.push(key);\n      // [0] in {{array [0]}}\n      result.push(index);\n      return;\n    });\n\n    return result;\n  };\n\n  /** String parsed as path */\n  export const toSegments = (\n    text: string,\n  ): ExpressionEditorSegment[] | undefined => {\n    const textSegments = ExpressionEditorParserBuiltin.splitText(text);\n    const segments: ExpressionEditorSegment[] = [];\n    const validate = textSegments.every((textSegment, index) => {\n      // array subscript\n      if (\n        textSegment.startsWith(ExpressionEditorToken.ArrayStart) &&\n        textSegment.endsWith(ExpressionEditorToken.ArrayEnd)\n      ) {\n        const arrayIndexString = textSegment.slice(1, -1);\n        const arrayIndex = Number(arrayIndexString);\n        if (arrayIndexString === '' || Number.isNaN(arrayIndex)) {\n          // Index must be a number\n          return false;\n        }\n        const lastSegment = segments[segments.length - 1];\n        if (\n          !lastSegment ||\n          lastSegment.type !== ExpressionEditorSegmentType.ObjectKey\n        ) {\n          // The array index must be after the key\n          return false;\n        }\n        segments.push({\n          type: ExpressionEditorSegmentType.ArrayIndex,\n          index,\n          arrayIndex,\n        });\n      }\n      // The last empty line of text\n      else if (index === textSegments.length - 1 && textSegment === '') {\n        segments.push({\n          type: ExpressionEditorSegmentType.EndEmpty,\n          index,\n        });\n      } else {\n        if (!textSegment || !/^[\\u4e00-\\u9fa5_a-zA-Z0-9]*$/.test(textSegment)) {\n          return false;\n        }\n        segments.push({\n          type: ExpressionEditorSegmentType.ObjectKey,\n          index,\n          objectKey: textSegment,\n        });\n      }\n      return true;\n    });\n    if (!validate) {\n      return undefined;\n    }\n    return segments;\n  };\n}\n\nexport namespace ExpressionEditorParser {\n  /** Serialization */\n  export const serialize = (value: ExpressionEditorLine[]) =>\n    value.map(n => Node.string(n)).join('\\n');\n\n  /** deserialization */\n  export const deserialize = (text: string): ExpressionEditorLine[] => {\n    const lines = text.split('\\n');\n    return lines.map(line => ({\n      type: ExpressionEditorSignal.Line,\n      children: [{ text: line || '' }],\n    }));\n  };\n\n  export const parse = (line: {\n    lineContent: string;\n    lineOffset: number;\n  }): ExpressionEditorParseData | undefined => {\n    const { lineContent, lineOffset } = line;\n    const tokenOffsets = ExpressionEditorParserBuiltin.tokenOffset(line);\n    if (!tokenOffsets) {\n      return;\n    }\n    const { lastStartTokenOffset, firstEndTokenOffset } = tokenOffsets;\n    const extractedContent = ExpressionEditorParserBuiltin.extractContent({\n      ...line,\n      ...tokenOffsets,\n    });\n    if (!extractedContent) {\n      return;\n    }\n    const { content, offset } = extractedContent;\n    const slicedReachable =\n      ExpressionEditorParserBuiltin.sliceReachable(extractedContent);\n    if (!slicedReachable) {\n      return;\n    }\n    const reachableSegments = ExpressionEditorParserBuiltin.toSegments(\n      slicedReachable.reachable,\n    );\n    const inlineSegments = ExpressionEditorParserBuiltin.toSegments(content);\n    if (!reachableSegments) {\n      return;\n    }\n    return {\n      content: {\n        line: lineContent,\n        inline: content,\n        reachable: slicedReachable.reachable,\n        unreachable: slicedReachable.unreachable,\n      },\n      offset: {\n        line: lineOffset,\n        inline: offset,\n        lastStart: lastStartTokenOffset,\n        firstEnd: firstEndTokenOffset,\n      },\n      segments: {\n        inline: inlineSegments,\n        reachable: reachableSegments,\n      },\n    };\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-magic-numbers */\n/* eslint-disable max-lines */\n\nimport { useCallback, useEffect } from 'react';\n\nimport { ReactEditor } from 'slate-react';\nimport { Range, type Selection, Transforms } from 'slate';\nimport { I18n } from '@coze-arch/i18n';\n\nimport type {\n  ExpressionEditorEventParams,\n  ExpressionEditorParseData,\n  ExpressionEditorTreeNode,\n} from '../../type';\nimport { ExpressionEditorTreeHelper } from '../../tree-helper';\nimport { ExpressionEditorParser } from '../../parser';\nimport type { ExpressionEditorModel } from '../../model';\nimport {\n  ExpressionEditorEvent,\n  ExpressionEditorSegmentType,\n  ExpressionEditorToken,\n} from '../../constant';\nimport {\n  type SuggestionReducer,\n  SuggestionActionType,\n  type SuggestionState,\n} from './type';\n\nimport styles from './index.module.less';\n\n/** built-in function */\nnamespace SuggestionViewUtils {\n  /** Editor selected event handling */\n  export const editorSelectHandler = (params: {\n    reducer: SuggestionReducer;\n    payload: ExpressionEditorEventParams<ExpressionEditorEvent.Select>;\n  }) => {\n    const { reducer, payload } = params;\n    const [state, dispatch] = reducer;\n\n    // Set up parse data\n    const parseData = ExpressionEditorParser.parse({\n      lineContent: payload.content,\n      lineOffset: payload.offset,\n    });\n    if (!parseData) {\n      dispatch({\n        type: SuggestionActionType.ClearParseDataAndEditorPath,\n      });\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: false,\n      });\n      dispatch({\n        type: SuggestionActionType.SetRect,\n        payload: undefined,\n      });\n      return;\n    }\n\n    dispatch({\n      type: SuggestionActionType.SetParseDataAndEditorPath,\n      payload: {\n        parseData,\n        editorPath: payload.path,\n      },\n    });\n\n    // Reset UI component internal state\n    const shouldRefresh = parseData.content.reachable === '';\n    if (shouldRefresh) {\n      dispatch({\n        type: SuggestionActionType.Refresh,\n      });\n    }\n\n    // Set the selected value\n    const selected = SuggestionViewUtils.computeSelected({\n      model: state.model,\n      parseData,\n    });\n    dispatch({\n      type: SuggestionActionType.SetSelected,\n      payload: selected,\n    });\n\n    // Set the visible variable tree\n    const variableTree = SuggestionViewUtils.computeVariableTree({\n      model: state.model,\n      parseData,\n    });\n    dispatch({\n      type: SuggestionActionType.SetVariableTree,\n      payload: variableTree,\n    });\n\n    // Set matching branches\n    const matchTreeBranch: ExpressionEditorTreeNode[] | undefined =\n      ExpressionEditorTreeHelper.matchTreeBranch({\n        tree: state.model.variableTree,\n        segments: parseData.segments.reachable,\n      });\n    dispatch({\n      type: SuggestionActionType.SetMatchTreeBranch,\n      payload: matchTreeBranch,\n    });\n\n    // Set empty content\n    const emptyContent = SuggestionViewUtils.computeEmptyContent({\n      parseData,\n      fullVariableTree: state.model.variableTree,\n      variableTree,\n      matchTreeBranch,\n    });\n    dispatch({\n      type: SuggestionActionType.SetEmptyContent,\n      payload: emptyContent,\n    });\n\n    // Set UI relative coordinates\n    const rect = SuggestionViewUtils.computeRect(state);\n    dispatch({\n      type: SuggestionActionType.SetRect,\n      payload: rect,\n    });\n    if (!rect) {\n      dispatch({\n        type: SuggestionActionType.ClearParseDataAndEditorPath,\n      });\n      return;\n    }\n\n    // FIXME: Set the search value, very hacked logic. Later, it is recommended to refactor without semi components, and write one yourself.\n    if (!state.ref.tree.current) {\n      // Not set to visible can't get ref\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: true,\n      });\n    }\n\n    dispatch({\n      type: SuggestionActionType.SearchEffectStart,\n    });\n  };\n\n  export const getFinalScale = (state: SuggestionState): number => {\n    if (state.entities.playgroundConfig) {\n      return state.entities.playgroundConfig.finalScale;\n    }\n    return 1;\n  };\n\n  /** Calculate relative parent container coordinates when visible */\n  export const computeRect = (\n    state: SuggestionState,\n  ):\n    | {\n        top: number;\n        left: number;\n      }\n    | undefined => {\n    const borderTopOffset = 5;\n    const containerRect = state.ref.container.current?.getBoundingClientRect();\n    if (!state.model.editor.selection || !containerRect) {\n      return;\n    }\n    try {\n      const rect = ReactEditor.toDOMRange(\n        state.model.editor,\n        state.model.editor.selection,\n      ).getBoundingClientRect();\n      return {\n        top:\n          (rect.top - containerRect.top) / getFinalScale(state) +\n          borderTopOffset,\n        left: (rect.left - containerRect.left) / getFinalScale(state),\n      };\n    } catch (e) {\n      // Slate DOM calculation error can be ignored\n      return;\n    }\n  };\n\n  /** Calculate the currently selected variable */\n  export const computeSelected = (params: {\n    model: ExpressionEditorModel;\n    parseData: ExpressionEditorParseData;\n  }): ExpressionEditorTreeNode | undefined => {\n    const { model, parseData } = params;\n    if (!parseData?.segments.inline) {\n      return;\n    }\n    const treeBrach = ExpressionEditorTreeHelper.matchTreeBranch({\n      tree: model.variableTree,\n      segments: parseData.segments.inline,\n    });\n    if (!treeBrach) {\n      return;\n    }\n    return treeBrach[treeBrach.length - 1];\n  };\n\n  /** Calculate the current search value */\n  export const computeSearch = (\n    parseData: ExpressionEditorParseData,\n  ): string => {\n    if (!parseData) {\n      return '';\n    }\n    const segments = parseData.segments.reachable;\n    const lastSegment =\n      segments[segments.length - 1].type ===\n      ExpressionEditorSegmentType.ArrayIndex\n        ? segments[segments.length - 2] // The array index belongs to the previous level and needs to be removed to prevent it from affecting the search value\n        : segments[segments.length - 1];\n    if (\n      !lastSegment ||\n      lastSegment.type !== ExpressionEditorSegmentType.ObjectKey\n    ) {\n      return '';\n    }\n    return lastSegment.objectKey;\n  };\n\n  /** Calculate the variable tree of the clipping level */\n  export const computeVariableTree = (params: {\n    model: ExpressionEditorModel;\n    parseData: ExpressionEditorParseData;\n  }): ExpressionEditorTreeNode[] => {\n    const { model, parseData } = params;\n    if (!parseData?.segments.reachable) {\n      return [];\n    }\n    const prunedVariableTree = ExpressionEditorTreeHelper.pruning({\n      tree: model.variableTree,\n      segments: parseData.segments.reachable,\n    });\n    return prunedVariableTree;\n  };\n\n  export const computeEmptyContent = (params: {\n    parseData: ExpressionEditorParseData;\n    fullVariableTree: ExpressionEditorTreeNode[];\n    variableTree: ExpressionEditorTreeNode[];\n    matchTreeBranch: ExpressionEditorTreeNode[] | undefined;\n  }): string | undefined => {\n    const { parseData, fullVariableTree, variableTree, matchTreeBranch } =\n      params;\n    if (\n      !fullVariableTree ||\n      !Array.isArray(fullVariableTree) ||\n      fullVariableTree.length === 0\n    ) {\n      if (parseData.content.reachable === '') {\n        return I18n.t('workflow_variable_refer_no_input');\n      }\n      return;\n    }\n    if (\n      !variableTree ||\n      !Array.isArray(variableTree) ||\n      variableTree.length === 0\n    ) {\n      if (parseData.content.inline === '') {\n        return I18n.t('workflow_variable_refer_no_input');\n      }\n      if (matchTreeBranch && matchTreeBranch.length !== 0) {\n        return I18n.t('workflow_variable_refer_no_sub_variable');\n      }\n      return;\n    }\n    return;\n  };\n\n  export const keyboardSelectedClassName = () =>\n    styles['expression-editor-suggestion-keyboard-selected'];\n\n  /** Highlight the selected item */\n  export const setUIOptionSelected = (uiOption: Element): void => {\n    if (\n      !uiOption?.classList?.add ||\n      !uiOption?.classList?.contains ||\n      uiOption.classList.contains('semi-tree-option-empty')\n    ) {\n      return;\n    }\n    uiOption.classList.add(SuggestionViewUtils.keyboardSelectedClassName());\n  };\n\n  /** Get all options UI elements */\n  export const computeUIOptions = (\n    state: SuggestionState,\n  ):\n    | {\n        optionList: Element[];\n        selectedIndex: number;\n        selectedOption?: Element;\n      }\n    | undefined => {\n    // Get all option elements\n    const optionListDom =\n      state.ref.suggestion.current?.children?.[0]?.children?.[1]?.children;\n    if (!optionListDom) {\n      return;\n    }\n    const optionList = Array.from(optionListDom);\n    // Find the currently highlighted option\n    const selectedIndex = optionList.findIndex(element =>\n      element.classList.contains(keyboardSelectedClassName()),\n    );\n    return {\n      optionList,\n      selectedIndex,\n      selectedOption: optionList[selectedIndex],\n    };\n  };\n\n  /** Disable visible changes Prevent UI jitter */\n  export const preventVisibleJitter = (\n    reducer: SuggestionReducer,\n    time = 150,\n  ) => {\n    const [state, dispatch] = reducer;\n    if (!state.allowVisibleChange) {\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.SetAllowVisibleChange,\n      payload: false,\n    });\n    setTimeout(() => {\n      dispatch({\n        type: SuggestionActionType.SetAllowVisibleChange,\n        payload: true,\n      });\n    }, time);\n  };\n\n  /** Clear keyboard UI options */\n  export const clearSelectedUIOption = (state: SuggestionState) => {\n    const uiOptions = SuggestionViewUtils.computeUIOptions(state);\n    if (uiOptions?.selectedOption) {\n      // Clear keyboard selection\n      uiOptions.selectedOption.classList.remove(\n        SuggestionViewUtils.keyboardSelectedClassName(),\n      );\n    }\n  };\n\n  /** The default keyboard UI option is the first item */\n  export const selectFirstUIOption = (state: SuggestionState) => {\n    const uiOptions = SuggestionViewUtils.computeUIOptions(state);\n    if (!uiOptions?.optionList) {\n      return;\n    }\n    clearSelectedUIOption(state);\n    if (!uiOptions?.optionList?.[0]?.classList?.add) {\n      return;\n    }\n    // Default first item highlighting\n    SuggestionViewUtils.setUIOptionSelected(uiOptions.optionList[0]);\n  };\n}\n\n/** selected node */\nexport const useSelectNode = (reducer: SuggestionReducer) => {\n  const [state] = reducer;\n  return useCallback(\n    (node: ExpressionEditorTreeNode) => {\n      const fullPath: string = ExpressionEditorTreeHelper.concatFullPath({\n        node,\n        segments: state.parseData?.segments.reachable ?? [],\n      });\n      if (!state.parseData || !state.editorPath) {\n        return;\n      }\n      const selection: Selection = {\n        anchor: {\n          path: state.editorPath,\n          offset: state.parseData.offset.lastStart - 1,\n        },\n        focus: {\n          path: state.editorPath,\n          offset: state.parseData.offset.firstEnd + 2,\n        },\n      };\n      const insertText = `${ExpressionEditorToken.FullStart}${fullPath}${ExpressionEditorToken.FullEnd}`;\n      // replacement text\n      Transforms.insertText(state.model.editor, insertText, {\n        at: selection,\n      });\n    },\n    [state],\n  );\n};\n\n/** mount the listener */\nexport const useListeners = (reducer: SuggestionReducer) => {\n  const [state, dispatch] = reducer;\n\n  useEffect(() => {\n    // Mount Listening: Mouse Click Events\n    const mouseHandler = (e: MouseEvent) => {\n      if (!state.visible || !state.ref.suggestion.current) {\n        return;\n      }\n      if (state.ref.suggestion.current?.contains(e.target as Node)) {\n        return;\n      }\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: false,\n      });\n      dispatch({\n        type: SuggestionActionType.SetRect,\n        payload: undefined,\n      });\n    };\n    window.addEventListener('mousedown', mouseHandler);\n    const mouseDisposer = () => {\n      window.removeEventListener('mousedown', mouseHandler);\n    };\n    return () => {\n      // Prevent memory leaks by uninstalling listeners when destroyed\n      mouseDisposer();\n    };\n  }, [state]);\n\n  useEffect(() => {\n    // Mount Listening: Editor Selection Event\n    const editorSelectDisposer = state.model.on<ExpressionEditorEvent.Select>(\n      ExpressionEditorEvent.Select,\n      payload =>\n        SuggestionViewUtils.editorSelectHandler({\n          reducer,\n          payload,\n        }),\n    );\n    return () => {\n      // Prevent memory leaks by uninstalling listeners when destroyed\n      editorSelectDisposer();\n    };\n  }, []);\n\n  useEffect(() => {\n    // Mount Monitor: Editor Pinyin Input Event\n    const compositionStartDisposer =\n      state.model.on<ExpressionEditorEvent.CompositionStart>(\n        ExpressionEditorEvent.CompositionStart,\n        payload =>\n          dispatch({\n            type: SuggestionActionType.SetVisible,\n            payload: false,\n          }),\n      );\n    return () => {\n      // Prevent memory leaks by uninstalling listeners when destroyed\n      compositionStartDisposer();\n    };\n  }, []);\n\n  useEffect(() => {\n    // First render activation DOM before initialization\n    if (state.initialized) {\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.SetVisible,\n      payload: false,\n    });\n  }, []);\n\n  useEffect(() => {\n    // Listen to DOM activation before initialization and hide after activation\n    if (state.initialized || state.visible) {\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.SetHiddenDOM,\n      payload: false,\n    });\n    dispatch({\n      type: SuggestionActionType.SetInitialized,\n    });\n  }, [state]);\n};\n\n/** Keyboard Enter up and down to select the node */\nexport const useKeyboardSelect = (\n  reducer: SuggestionReducer,\n  selectNode: (node: ExpressionEditorTreeNode) => void,\n) => {\n  const [state, dispatch] = reducer;\n\n  // Keyboard up and down\n  useEffect(() => {\n    const keyboardArrowHandler = event => {\n      if (\n        !state.visible ||\n        !state.ref.suggestion.current ||\n        !['ArrowDown', 'ArrowUp'].includes(event.key)\n      ) {\n        return;\n      }\n      const uiOptions = SuggestionViewUtils.computeUIOptions(state);\n      if (!uiOptions) {\n        return;\n      }\n      const { optionList, selectedIndex } = uiOptions;\n      if (optionList.length === 1) {\n        // Do not deal with when there is only one option\n        return;\n      }\n      event.preventDefault();\n      let newIndex = selectedIndex;\n      if (event.key === 'ArrowDown') {\n        // If there is currently no highlighted option or the last option, highlight the first option\n        newIndex =\n          selectedIndex === -1 || selectedIndex === optionList.length - 1\n            ? 0\n            : selectedIndex + 1;\n      } else if (event.key === 'ArrowUp') {\n        // If there is currently no highlighted option or the first option, highlight the last option\n        newIndex =\n          selectedIndex <= 0 ? optionList.length - 1 : selectedIndex - 1;\n      }\n      const selectedOption = optionList[newIndex];\n      // Update highlighting options\n      if (selectedIndex !== -1) {\n        optionList[selectedIndex].classList.remove(\n          SuggestionViewUtils.keyboardSelectedClassName(),\n        );\n      }\n      SuggestionViewUtils.setUIOptionSelected(selectedOption);\n      // Scroll the newly selected option into view\n      selectedOption.scrollIntoView({\n        behavior: 'smooth', // Smooth scrolling\n        block: 'nearest', // The closest view boundary, possibly the top or bottom\n      });\n    };\n    document.addEventListener('keydown', keyboardArrowHandler);\n    return () => {\n      document.removeEventListener('keydown', keyboardArrowHandler);\n    };\n  }, [state]);\n\n  // Keyboard Enter\n  useEffect(() => {\n    const keyboardEnterHandler = event => {\n      if (\n        !state.visible ||\n        !state.ref.suggestion.current ||\n        event.key !== 'Enter'\n      ) {\n        return;\n      }\n      const uiOptions = SuggestionViewUtils.computeUIOptions(state);\n      if (!uiOptions?.selectedOption) {\n        return;\n      }\n      const { selectedOption } = uiOptions;\n      const selectedDataKey = selectedOption.getAttribute('data-key');\n      if (!selectedDataKey) {\n        return;\n      }\n      const variableTreeNode =\n        state.ref.tree.current?.state?.keyEntities?.[selectedDataKey]?.data;\n      if (!variableTreeNode) {\n        return;\n      }\n      event.preventDefault();\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: false,\n      });\n      selectNode(variableTreeNode as ExpressionEditorTreeNode);\n      if (\n        !variableTreeNode.variable?.children ||\n        variableTreeNode.variable?.children.length === 0\n      ) {\n        // leaf node\n        return;\n      }\n      // Non-leaf node, move the cursor forward two spaces\n      const { selection } = state.model.editor;\n      if (selection && Range.isCollapsed(selection)) {\n        // Move the cursor two characters forward\n        Transforms.move(state.model.editor, { distance: 2, reverse: true });\n      }\n      SuggestionViewUtils.preventVisibleJitter(reducer);\n    };\n    document.addEventListener('keydown', keyboardEnterHandler);\n    return () => {\n      document.removeEventListener('keydown', keyboardEnterHandler);\n    };\n  }, [state]);\n\n  // Keyboard ESC cancel pop-up window\n  useEffect(() => {\n    const keyboardESCHandler = event => {\n      if (\n        !state.visible ||\n        !state.ref.suggestion.current ||\n        event.key !== 'Escape'\n      ) {\n        return;\n      }\n      event.preventDefault();\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: false,\n      });\n    };\n    document.addEventListener('keydown', keyboardESCHandler);\n    return () => {\n      document.removeEventListener('keydown', keyboardESCHandler);\n    };\n  }, [state]);\n\n  // First item selected by default\n  useEffect(() => {\n    SuggestionViewUtils.selectFirstUIOption(state);\n  }, [state]);\n};\n\n/** Side effects of waiting for semi component data to be updated */\nexport const useRenderEffect = (reducer: SuggestionReducer) => {\n  const [state, dispatch] = reducer;\n\n  // Set the search value after the component tree data is updated\n  useEffect(() => {\n    if (!state.renderEffect.search || !state.parseData) {\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.SearchEffectEnd,\n    });\n    const searchValue = SuggestionViewUtils.computeSearch(state.parseData);\n    state.ref.tree.current?.search(searchValue);\n    if (!searchValue && state.matchTreeBranch) {\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: true,\n      });\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.FilteredEffectStart,\n    });\n  }, [state]);\n\n  // Is it empty after searching for filters?\n  useEffect(() => {\n    if (!state.renderEffect.filtered) {\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.FilteredEffectEnd,\n    });\n    const filteredKeys = Array.from(\n      state.ref.tree.current?.state.filteredKeys || [],\n    );\n    if (!state.emptyContent && filteredKeys.length === 0) {\n      dispatch({\n        type: SuggestionActionType.SetVisible,\n        payload: false,\n      });\n      return;\n    }\n    dispatch({\n      type: SuggestionActionType.SetVisible,\n      payload: true,\n    });\n  }, [state]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable no-cond-assign */\nimport { Node } from 'slate';\n\nimport type {\n  ExpressionEditorLine,\n  ExpressionEditorTreeNode,\n  ExpressionEditorValidateData,\n} from '../type';\nimport { ExpressionEditorTreeHelper } from '../tree-helper';\nimport { ExpressionEditorParserBuiltin } from '../parser';\nimport { ExpressionEditorSegmentType } from '../constant';\n\nexport namespace ExpressionEditorValidator {\n  interface ExpressionEditorPattern {\n    start: number;\n    end: number;\n    content: string;\n  }\n  export const findPatterns = (text: string): ExpressionEditorPattern[] => {\n    const matches: ExpressionEditorPattern[] = [];\n    const regex = /{{(.*?)}}/g;\n\n    let match: RegExpExecArray | null;\n    while ((match = regex.exec(text)) !== null) {\n      const start: number = match.index;\n      const end: number = regex.lastIndex;\n      const content: string = match[1];\n      matches.push({ start, end, content });\n    }\n    return matches;\n  };\n  const patternValidate = (params: {\n    pattern: ExpressionEditorPattern;\n    tree: ExpressionEditorTreeNode[];\n  }) => {\n    const { pattern, tree } = params;\n    // 1. content to segments\n    const segments = ExpressionEditorParserBuiltin.toSegments(pattern.content);\n    if (!segments) {\n      return {\n        start: pattern.start,\n        end: pattern.end,\n        valid: false,\n        message: 'invalid variable path',\n      };\n    }\n    if (\n      segments[segments.length - 1].type ===\n      ExpressionEditorSegmentType.EndEmpty\n    ) {\n      return {\n        start: pattern.start,\n        end: pattern.end,\n        valid: false,\n        message: 'empty with empty',\n      };\n    }\n    // 2. segments mix variable tree, match tree branch\n    const treeBranch = ExpressionEditorTreeHelper.matchTreeBranch({\n      tree,\n      segments,\n    });\n    if (!treeBranch) {\n      return {\n        start: pattern.start,\n        end: pattern.end,\n        valid: false,\n        message: 'no match variable path',\n      };\n    }\n    // 3. if full segments path could match one tree branch, the pattern is valid\n    return {\n      start: pattern.start,\n      end: pattern.end,\n      valid: true,\n    };\n  };\n  export const lineTextValidate = (params: {\n    lineText: string;\n    tree: ExpressionEditorTreeNode[];\n  }): ExpressionEditorValidateData[] => {\n    const { lineText, tree } = params;\n    // find patterns {{content}}, record start / end offset\n    const patterns: ExpressionEditorPattern[] = findPatterns(lineText);\n    const validateList: ExpressionEditorValidateData[] = patterns.map(pattern =>\n      patternValidate({ pattern, tree }),\n    );\n    return validateList;\n  };\n  export const validate = (params: {\n    lines: ExpressionEditorLine[];\n    tree: ExpressionEditorTreeNode[];\n  }): ExpressionEditorValidateData[] => {\n    const { lines, tree } = params;\n    const textLines: string[] = lines.map(n => Node.string(n));\n    const validateList: ExpressionEditorValidateData[] = textLines\n      .map((lineText: string, lineIndex: number) =>\n        ExpressionEditorValidator.lineTextValidate({\n          lineText,\n          tree,\n        }),\n      )\n      .flat();\n    return validateList;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { workflowApi } from '@coze-workflow/base/api';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { upLoadFile } from '@coze-arch/bot-utils';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { FileBizType } from '@coze-arch/bot-api/developer_api';\nimport { DeveloperApi } from '@coze-arch/bot-api';\n\n/** image upload error code */\nexport enum ImgUploadErrNo {\n  Success = 0,\n  /** Missing document */\n  NoFile,\n  /** Upload failed. */\n  UploadFail,\n  /** Upload timed out */\n  UploadTimeout,\n  /** Failed to get URL */\n  GetUrlFail,\n  /** Check exception, but not specific exception */\n  ValidateError,\n  /** File size exceeds limit */\n  MaxSizeError,\n  /** File type not supported */\n  SuffixError,\n  /** Maximum width limit */\n  MaxWidthError,\n  /** Maximum height limit */\n  MaxHeightError,\n  /** minimum width limit */\n  MinWidthError,\n  /** Minimum height limit */\n  MinHeightError,\n  /** Fixed Aspect Ratio */\n  AspectRatioError,\n}\n\nexport interface ImageRule {\n  /** File size limit, unit b, 1M = 1 * 1024 * 1024 */\n  maxSize?: number;\n  /** file suffix */\n  suffix?: string[];\n  /** Maximum width limit */\n  maxWidth?: number;\n  /** Maximum height limit */\n  maxHeight?: number;\n  /** minimum width limit */\n  minWidth?: number;\n  /** Minimum height limit */\n  minHeight?: number;\n  /** Fixed Aspect Ratio */\n  aspectRatio?: number;\n}\n\ntype UploadResult =\n  | {\n      isSuccess: false;\n      errNo: ImgUploadErrNo;\n      msg: string;\n    }\n  | {\n      isSuccess: true;\n      errNo: ImgUploadErrNo.Success;\n      uri: string;\n      url: string;\n    };\n\n/**\n * Workflow image upload\n */\nclass ImageUploader {\n  /** Task ID to avoid ABA issues */\n  private taskId = 0;\n  /**\n   * upload mode\n   * - API directly uses the interface to upload\n   * - uploader to Video Cloud as a Service, go workflow service.! Overseas version has not been tested\n   */\n  mode: 'uploader' | 'api' = 'uploader';\n  /** validation rule */\n  rules?: ImageRule;\n  /** Uploaded file */\n  file?: File;\n  /** Show URLs, generated after adding files, for preview */\n  displayUrl?: string;\n  /** Upload Status */\n  isUploading = false;\n  /** timeout */\n  timeout?: number;\n  /** verification result */\n  validateResult?: {\n    isSuccess: boolean;\n    errNo: ImgUploadErrNo;\n    msg?: string;\n  };\n  /** Upload result */\n  uploadResult?: UploadResult;\n\n  constructor(config?: {\n    rules?: ImageRule;\n    mode?: ImageUploader['mode'];\n    timeout?: number;\n  }) {\n    this.rules = config?.rules ?? this.rules;\n    this.mode = config?.mode ?? this.mode;\n    this.timeout = config?.timeout ?? this.timeout;\n  }\n\n  /** Select the file to upload */\n  async select(file: File) {\n    if (!file) {\n      throw new CustomError('normal_error', '');\n    }\n    this.reset();\n    this.file = file;\n    this.displayUrl = URL.createObjectURL(this.file);\n\n    await this.validate().catch(() => {\n      this.validateResult = {\n        isSuccess: false,\n        errNo: ImgUploadErrNo.ValidateError,\n        msg: I18n.t('imageflow_upload_error'),\n      };\n    });\n  }\n\n  /** Upload image */\n  async upload() {\n    // No file was selected or the file does not meet the requirements\n    if (!this.file || !this.validateResult?.isSuccess || this.isUploading) {\n      return;\n    }\n\n    this.isUploading = true;\n\n    // Add task IDs to avoid ABA issues\n    this.taskId += 1;\n    const currentId = this.taskId;\n\n    let uploadResult: UploadResult;\n    if (this.mode === 'api') {\n      uploadResult = await this.uploadByApi(this.file);\n    } else if (this.mode === 'uploader') {\n      uploadResult = await this.uploadByUploader(this.file);\n    } else {\n      throw new CustomError('normal_error', 'ImageUploader mode error');\n    }\n\n    if (currentId !== this.taskId) {\n      return;\n    }\n\n    this.uploadResult = uploadResult;\n    this.isUploading = false;\n  }\n\n  private uploadByUploader(file: File): Promise<UploadResult> {\n    return new Promise(resolve => {\n      const timer =\n        this.timeout &&\n        setTimeout(\n          () =>\n            resolve({\n              isSuccess: false,\n              errNo: ImgUploadErrNo.UploadTimeout,\n              msg: I18n.t('imageflow_upload_error7'),\n            }),\n          this.timeout,\n        );\n\n      const doUpload = async () => {\n        const uri = await upLoadFile({\n          biz: 'workflow',\n          file,\n          fileType: 'image',\n        })\n          .then(result => {\n            if (!result) {\n              throw new CustomError('normal_error', 'no uri');\n            }\n            return result;\n          })\n          .catch(() => {\n            resolve({\n              isSuccess: false,\n              errNo: ImgUploadErrNo.UploadFail,\n              msg: I18n.t('imageflow_upload_error'),\n            });\n            return '';\n          });\n\n        if (!uri) {\n          return;\n        }\n        // Get URL\n        const resp = await workflowApi\n          .SignImageURL(\n            {\n              uri,\n            },\n            {\n              __disableErrorToast: true,\n            },\n          )\n          .catch(() => null);\n        const url = resp?.url || '';\n\n        if (url) {\n          resolve({\n            isSuccess: true,\n            errNo: ImgUploadErrNo.Success,\n            uri,\n            url,\n          });\n        } else {\n          resolve({\n            isSuccess: false,\n            errNo: ImgUploadErrNo.GetUrlFail,\n            msg: I18n.t('imageflow_upload_error'),\n          });\n        }\n      };\n\n      doUpload().finally(() => {\n        clearTimeout(timer);\n      });\n    });\n  }\n\n  private uploadByApi(file: File): Promise<UploadResult> {\n    return new Promise(resolve => {\n      const timer =\n        this.timeout &&\n        setTimeout(\n          () =>\n            resolve({\n              isSuccess: false,\n              errNo: ImgUploadErrNo.UploadTimeout,\n              msg: I18n.t('imageflow_upload_error7'),\n            }),\n          this.timeout,\n        );\n\n      const doUpload = async function () {\n        const base64 = await getBase64(file).catch(() => '');\n\n        if (!base64) {\n          resolve({\n            isSuccess: false,\n            errNo: ImgUploadErrNo.UploadFail,\n            msg: I18n.t('imageflow_upload_error'),\n          });\n          return;\n        }\n\n        await DeveloperApi.UploadFile({\n          file_head: {\n            file_type: getFileExtension(file.name),\n            biz_type: FileBizType.BIZ_BOT_WORKFLOW,\n          },\n          data: base64,\n        })\n          .then(result => {\n            resolve({\n              isSuccess: true,\n              errNo: ImgUploadErrNo.Success,\n              uri: result.data?.upload_uri || '',\n              url: result.data?.upload_url || '',\n            });\n          })\n          .catch(() => {\n            resolve({\n              isSuccess: false,\n              errNo: ImgUploadErrNo.UploadFail,\n              msg: I18n.t('imageflow_upload_error'),\n            });\n          });\n      };\n      doUpload().finally(() => {\n        clearTimeout(timer);\n      });\n    });\n  }\n\n  reset() {\n    this.file = undefined;\n    if (this.displayUrl) {\n      // Is an internal link\n      URL.revokeObjectURL(this.displayUrl);\n      this.displayUrl = undefined;\n    }\n    this.isUploading = false;\n    this.uploadResult = undefined;\n    this.validateResult = undefined;\n    this.taskId += 1;\n  }\n\n  // eslint-disable-next-line complexity\n  private async validate() {\n    if (!this.file || !this.displayUrl) {\n      return;\n    }\n\n    const rules = this.rules || {};\n\n    // file size\n    if (rules.maxSize) {\n      if (this.file.size > rules.maxSize) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.MaxSizeError,\n          msg: I18n.t('imageflow_upload_exceed', {\n            size: formatBytes(rules.maxSize),\n          }),\n        };\n        return;\n      }\n    }\n\n    // file suffix\n    if (Array.isArray(rules.suffix) && rules.suffix.length > 0) {\n      const fileExtension = getFileExtension(this.file.name);\n      if (!rules.suffix.includes(fileExtension)) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.SuffixError,\n          msg: I18n.t('imageflow_upload_error_type', {\n            type: `${rules.suffix.filter(Boolean).join('/')}`,\n          }),\n        };\n        return;\n      }\n    }\n\n    // image size\n    const { width, height } = await getImageSize(this.displayUrl);\n\n    if (!width || !height) {\n      this.validateResult = {\n        isSuccess: false,\n        errNo: ImgUploadErrNo.ValidateError,\n        msg: I18n.t('imageflow_upload_error6'),\n      };\n      return;\n    }\n    if (rules.maxWidth) {\n      if (width > rules.maxWidth) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.MaxWidthError,\n          msg: I18n.t('imageflow_upload_error5', {\n            value: `${rules.maxWidth}px`,\n          }),\n        };\n        return;\n      }\n    }\n    if (rules.maxHeight) {\n      if (height > rules.maxHeight) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.MaxHeightError,\n          msg: I18n.t('imageflow_upload_error4', {\n            value: `${rules.maxHeight}px`,\n          }),\n        };\n        return;\n      }\n    }\n    if (rules.minWidth) {\n      if (width < rules.minWidth) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.MinWidthError,\n          msg: I18n.t('imageflow_upload_error3', {\n            value: `${rules.minWidth}px`,\n          }),\n        };\n        return;\n      }\n    }\n    if (rules.minHeight) {\n      if (height < rules.minHeight) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.MinHeightError,\n          msg: I18n.t('imageflow_upload_error2', {\n            value: `${rules.minHeight}px`,\n          }),\n        };\n        return;\n      }\n    }\n    if (rules.aspectRatio) {\n      if (width / height - rules.aspectRatio > Number.MIN_VALUE) {\n        this.validateResult = {\n          isSuccess: false,\n          errNo: ImgUploadErrNo.AspectRatioError,\n          msg: I18n.t('imageflow_upload_error1'),\n        };\n        return;\n      }\n    }\n\n    this.validateResult = {\n      isSuccess: true,\n      errNo: ImgUploadErrNo.Success,\n      msg: 'success',\n    };\n  }\n}\n\nexport default ImageUploader;\n\nfunction getBase64(file: Blob): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = event => {\n      const result = event.target?.result;\n      if (!result || typeof result !== 'string') {\n        reject(\n          new CustomError(REPORT_EVENTS.parmasValidation, 'file read fail'),\n        );\n        return;\n      }\n      resolve(result.replace(/^.*?,/, ''));\n    };\n    fileReader.readAsDataURL(file);\n  });\n}\n\n/** Get filename suffix */\nfunction getFileExtension(name: string) {\n  const index = name.lastIndexOf('.');\n  return name.slice(index + 1).toLowerCase();\n}\n\n/**\n * @Param url Get image width and height\n */\nfunction getImageSize(url: string): Promise<{ width: number; height: number }> {\n  return new Promise((resolve, reject) => {\n    const img = new window.Image();\n    img.onload = () =>\n      resolve({\n        width: img.naturalWidth,\n        height: img.naturalHeight,\n      });\n    img.onerror = e => reject(e);\n    img.src = url;\n  });\n}\n\n/**\n * Format file size\n * @param bytes file size\n * @Param decimals, default 2 digits\n * @example\n * formatBytes(1024);       // 1KB\n * formatBytes('1024');     // 1KB\n * formatBytes(1234);       // 1.21KB\n * formatBytes(1234, 3);    // 1.205KB\n */\nfunction formatBytes(bytes: number, decimals = 2) {\n  if (bytes === 0) {\n    return '0 Bytes';\n  }\n  const k = 1024,\n    dm = decimals,\n    sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],\n    i = Math.floor(Math.log(bytes) / Math.log(k));\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))}${sizes[i]}`;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst isMacOS = /(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(\n  navigator.userAgent,\n);\n\nexport const SHORTCUTS = {\n  CTRL: isMacOS ? '' : 'Ctrl',\n  SHIFT: isMacOS ? '' : '',\n  ALT: isMacOS ? '' : 'Alt',\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type ReactNode } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { Divider, Typography, Tag } from '@coze-arch/coze-design';\nimport { InteractiveType } from '@coze-common/mouse-pad-selector';\n\nimport { getIsIPad } from '../utils';\nimport { SHORTCUTS } from './constants';\n\nimport s from './index.module.less';\n\ninterface ShortcutItemProps {\n  title: ReactNode;\n  children?: ReactNode;\n}\n\nfunction ShortcutItem({ title, children }: ShortcutItemProps) {\n  return (\n    <div className={s.item}>\n      <div className={s.itemTitle}>{title}</div>\n      <div className={s.itemContent}>{children}</div>\n    </div>\n  );\n}\n\nfunction DividerWithMargin() {\n  return <Divider style={{ margin: '12px 0' }} />;\n}\n\nfunction ShortcutTag({ children }: { children: ReactNode }) {\n  return (\n    <Tag className=\"mx-1 text-[14px]\" prefixIcon={null} color=\"primary\">\n      {children}\n    </Tag>\n  );\n}\n\ninterface FlowShortcutsHelpProps {\n  closable?: boolean;\n  onClose?: () => void;\n  isAgentFlow?: boolean;\n  interactiveType?: InteractiveType;\n}\n\nconst isIPad = getIsIPad();\n\nfunction FlowShortcutsHelp(props: FlowShortcutsHelpProps) {\n  const {\n    closable = false,\n    onClose,\n    isAgentFlow = false,\n    interactiveType,\n  } = props;\n\n  const isMouseFriendly = interactiveType === InteractiveType.Mouse;\n  return (\n    <>\n      {closable ? (\n        <div className={s.close} onClick={() => onClose?.()}>\n          <IconCozCross />\n        </div>\n      ) : null}\n\n      <Typography.Title heading={5} style={{ marginBottom: 16 }}>\n        {I18n.t('flowcanvas_shortcuts_shortcuts')}\n      </Typography.Title>\n\n      <ShortcutItem title={I18n.t('flowcanvas_shortcuts_move_canvas')}>\n        {isMouseFriendly ? (\n          <>\n            <ShortcutTag>{I18n.t('flowcanvas_shortcuts_drag')}</ShortcutTag>\n          </>\n        ) : (\n          <>\n            <ShortcutTag>{I18n.t('flowcanvas_shortcuts_space')}</ShortcutTag>\n            <ShortcutTag>{I18n.t('flowcanvas_shortcuts_drag')}</ShortcutTag>\n          </>\n        )}\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <ShortcutItem title={I18n.t('workflow_area_select')}>\n        {isMouseFriendly ? (\n          <>\n            <ShortcutTag>{SHORTCUTS.SHIFT}</ShortcutTag>\n            <ShortcutTag>{I18n.t('flowcanvas_shortcuts_drag')}</ShortcutTag>\n          </>\n        ) : (\n          <>\n            <ShortcutTag>{I18n.t('flowcanvas_shortcuts_drag')}</ShortcutTag>\n          </>\n        )}\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <ShortcutItem\n        title={\n          <>\n            {I18n.t('flowcanvas_shortcuts_multiple_select')}/\n            {I18n.t('flowcanvas_shortcuts_multiple_deselect')}\n          </>\n        }\n      >\n        <ShortcutTag>\n          {SHORTCUTS.CTRL}/{SHORTCUTS.SHIFT}\n        </ShortcutTag>\n        <ShortcutTag>{I18n.t('flowcanvas_shortcuts_click')}</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <ShortcutItem title={I18n.t('flowcanvas_shortcuts_zoom_in')}>\n        <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag>\n        <ShortcutTag>+</ShortcutTag>\n        <span style={{ margin: '0 6px' }}>\n          {I18n.t('flowcanvas_shortcuts_or')}\n        </span>\n        {!isMouseFriendly ? <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag> : null}\n        <ShortcutTag>{I18n.t('flowcanvas_shortcuts_scroll')}</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <ShortcutItem title={I18n.t('flowcanvas_shortcuts_zoom_out')}>\n        <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag>\n        <ShortcutTag>-</ShortcutTag>\n        <span style={{ margin: '0 6px' }}>\n          {I18n.t('flowcanvas_shortcuts_or')}\n        </span>\n        {!isMouseFriendly ? <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag> : null}\n        <ShortcutTag>{I18n.t('flowcanvas_shortcuts_scroll')}</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      {isIPad || isAgentFlow ? null : (\n        <>\n          <ShortcutItem title={I18n.t('flowcanvas_shortcuts_duplicate')}>\n            <ShortcutTag>{SHORTCUTS.ALT}</ShortcutTag>\n            <ShortcutTag>{I18n.t('flowcanvas_shortcuts_drag')}</ShortcutTag>\n          </ShortcutItem>\n          <DividerWithMargin />\n        </>\n      )}\n\n      <ShortcutItem title={I18n.t('flowcanvas_shortcuts_copy')}>\n        <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag>\n        <ShortcutTag>C</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <ShortcutItem title={I18n.t('flowcanvas_shortcuts_paste')}>\n        <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag>\n        <ShortcutTag>V</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <UndoRedoShortcuts />\n\n      <ShortcutItem title={I18n.t('flowcanvas_shortcuts_delete')}>\n        <ShortcutTag>{I18n.t('flowcanvas_shortcuts_backspace')}</ShortcutTag>\n      </ShortcutItem>\n    </>\n  );\n}\n\nfunction UndoRedoShortcuts() {\n  return (\n    <>\n      <ShortcutItem title={I18n.t('workflow_detail_undo_tooltip')}>\n        <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag>\n        <ShortcutTag>Z</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n\n      <ShortcutItem title={I18n.t('workflow_detail_redo_tooltip')}>\n        <ShortcutTag>{SHORTCUTS.CTRL}</ShortcutTag>\n        <ShortcutTag>{SHORTCUTS.SHIFT}</ShortcutTag>\n        <ShortcutTag>Z</ShortcutTag>\n      </ShortcutItem>\n\n      <DividerWithMargin />\n    </>\n  );\n}\n\nexport { FlowShortcutsHelp };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { useMemo, type FC } from 'react';\n\nimport semver from 'semver';\nimport dayjs from 'dayjs';\nimport classNames from 'classnames';\nimport { type VersionMetaInfo, OperateType } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozMore } from '@coze-arch/coze-design/icons';\nimport {\n  Avatar,\n  IconButton,\n  Menu,\n  Space,\n  Tag,\n  Typography,\n} from '@coze-arch/coze-design';\n\nimport { type WorkflowCommitListProps } from './type';\n\nexport interface CommitItemProps {\n  className?: string;\n  data: VersionMetaInfo;\n  /** Is it selected? */\n  isActive?: boolean;\n  readonly?: WorkflowCommitListProps['readonly'];\n  enablePublishPPE?: WorkflowCommitListProps['enablePublishPPE'];\n  onClick?: WorkflowCommitListProps['onItemClick'];\n  onPublishPPE?: WorkflowCommitListProps['onPublishPPE'];\n  onResetToCommit?: WorkflowCommitListProps['onResetToCommit'];\n  onShowCommit?: WorkflowCommitListProps['onShowCommit'];\n  /** Hide action drop-down menu */\n  hiddenActionMenu?: boolean;\n  /** Hide commitId */\n  hideCommitId?: boolean;\n}\n\nconst { Text } = Typography;\n\n// eslint-disable-next-line complexity\nexport const CommitItem: FC<CommitItemProps> = ({\n  className,\n  data,\n  readonly,\n  isActive,\n  hiddenActionMenu,\n  enablePublishPPE,\n  onClick,\n  onPublishPPE,\n  onResetToCommit,\n  onShowCommit,\n  hideCommitId,\n}) => {\n  const action = hiddenActionMenu ? null : (\n    <Menu\n      className=\"min-w-[96px] mb-2px flex-shrink-0\"\n      trigger=\"hover\"\n      stopPropagation={true}\n      position=\"bottomRight\"\n      render={\n        <Menu.SubMenu mode=\"menu\">\n          <Menu.Item\n            onClick={(_, e) => {\n              e.stopPropagation();\n              onShowCommit?.(data);\n            }}\n          >\n            {I18n.t('bmv_view_version')}\n          </Menu.Item>\n          <Menu.Item\n            onClick={(_, e) => {\n              e.stopPropagation();\n              onResetToCommit?.(data);\n            }}\n          >\n            {I18n.t('bmv_load_to_draft')}\n          </Menu.Item>\n          {enablePublishPPE ? (\n            <Menu.Item\n              onClick={(_, e) => {\n                e.stopPropagation();\n                onPublishPPE?.(data);\n              }}\n            >\n              {I18n.t('bmv_pre_release_to_lane')}\n            </Menu.Item>\n          ) : null}\n        </Menu.SubMenu>\n      }\n    >\n      <IconButton\n        color=\"secondary\"\n        iconSize=\"small\"\n        icon={\n          <>\n            <IconCozMore className=\"rotate-90\" />\n          </>\n        }\n      />\n    </Menu>\n  );\n\n  const time = useMemo(\n    () =>\n      data.create_time\n        ? dayjs(data.create_time).format('YYYY-MM-DD HH:mm:ss')\n        : '',\n    [data],\n  );\n\n  return (\n    <div\n      className={classNames(\n        'commit-item',\n        isActive && 'active',\n        'p-2 rounded-mini',\n        isActive && 'coz-mg-hglt',\n        !readonly && !isActive && 'hover:coz-mg-secondary',\n        !readonly && 'cursor-pointer',\n        className,\n      )}\n      onClick={() => onClick?.(data)}\n    >\n      <div className=\"mb-2\">\n        {data.type === OperateType.SubmitOperate && (\n          <Tag size=\"small\">\n            {I18n.t('workflow_publish_multibranch_submitted_title')}\n          </Tag>\n        )}\n        {data.type === OperateType.PubPPEOperate && (\n          <Tag size=\"small\" color={data.offline ? 'primary' : 'green'}>\n            {data.env}\n          </Tag>\n        )}\n        {data.type === OperateType.PublishOperate && (\n          <Tag size=\"small\" color={data.offline ? 'primary' : 'green'}>\n            {semver.valid(data.version)\n              ? data.version\n              : I18n.t('bmv_official_version')}\n          </Tag>\n        )}\n      </div>\n      {!hideCommitId && (\n        <Space className=\"w-full items-start\" vertical spacing={4}>\n          <Text\n            ellipsis={{\n              showTooltip: {\n                opts: { content: data.submit_commit_id || data.commit_id },\n              },\n            }}\n          >\n            <span className=\"font-bold mr-2\">{I18n.t('bmv_submit_id')}:</span>\n            {data.submit_commit_id || data.commit_id}\n          </Text>\n          {data.type !== OperateType.SubmitOperate &&\n          data.offline &&\n          data.update_time ? (\n            <Text\n              ellipsis={{\n                showTooltip: {\n                  opts: {\n                    content: dayjs(data.update_time as number).format(\n                      'YYYY-MM-DD HH:mm',\n                    ),\n                  },\n                },\n              }}\n            >\n              <span className=\"font-bold mr-2\">\n                {I18n.t('bmv_offline_time')}:\n              </span>\n              {dayjs(data.update_time as number).format('YYYY-MM-DD HH:mm')}\n            </Text>\n          ) : null}\n        </Space>\n      )}\n\n      {data.type === OperateType.PublishOperate && data.desc ? (\n        <div>\n          <Text ellipsis={{ rows: 4, showTooltip: true }}>{data.desc}</Text>\n        </div>\n      ) : null}\n\n      <div className=\"flex items-end mt-2\">\n        <div>\n          <div className=\"min-w-0 flex items-center mb-1\">\n            <Avatar\n              className=\"mr-2 flex-shrink-0\"\n              size=\"extra-extra-small\"\n              src={data.user?.user_avatar}\n              alt=\"avatar\"\n            />\n            <Text ellipsis fontSize=\"12px\">\n              {data.user?.user_name}\n            </Text>\n          </div>\n          <Text type=\"secondary\" fontSize=\"12px\">\n            {time}\n          </Text>\n        </div>\n\n        <div className=\"flex-1\" />\n        {action}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n\nimport { useEffect, type FC, useRef } from 'react';\n\nimport classNames from 'classnames';\nimport { useInViewport, useUpdateEffect } from 'ahooks';\nimport {\n  OperateType,\n  type VersionMetaInfo,\n  withQueryClient,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozFocus } from '@coze-arch/coze-design/icons';\nimport { EmptyState, Spin, Timeline, Typography } from '@coze-arch/coze-design';\n\nimport { useVersionHistory } from './use-version-history';\nimport { type WorkflowCommitListProps } from './type';\nimport { CommitItem } from './commit-item';\n\nimport css from './history-list.module.less';\n\nconst { Text } = Typography;\n\nconst currentKey = 'current';\n\nconst WorkflowCommitListComp: FC<WorkflowCommitListProps> = withQueryClient(\n  ({\n    className,\n    spaceId,\n    value,\n    workflowId,\n    readonly,\n    type,\n    enablePublishPPE,\n    showCurrent,\n    onItemClick,\n    onPublishPPE,\n    onResetToCommit,\n    onShowCommit,\n    onCurrentClick,\n    hideCommitId,\n  }) => {\n    const {\n      queryParams,\n      updatePageParam,\n      list,\n      loadingStatus,\n      fetchNextPage,\n      isFetching,\n      hasNextPage,\n    } = useVersionHistory({\n      spaceId,\n      workflowId,\n      type,\n      enabled: true,\n    });\n\n    /** Scroll container */\n    const scrollContainerRef = useRef<HTMLDivElement | null>(null);\n    /** Monitor the bottom observer */\n    const intersectionObserverDom = useRef<HTMLDivElement>(null);\n    // Is it bottoming out?\n    const [inViewPort] = useInViewport(intersectionObserverDom, {\n      root: () => scrollContainerRef.current,\n      threshold: 0.8,\n    });\n\n    useEffect(() => {\n      updatePageParam({ type });\n    }, [type, updatePageParam]);\n\n    // The first effect is not executed, this is the effect of switching the state\n    useUpdateEffect(() => {\n      // When the filter item changes, return to the top\n      if (scrollContainerRef.current) {\n        scrollContainerRef.current.scrollTo({\n          top: 0,\n        });\n      }\n    }, [queryParams]);\n\n    // Get next page logic\n    useEffect(() => {\n      if (!inViewPort) {\n        return;\n      }\n\n      if (loadingStatus !== 'success' || isFetching || !hasNextPage) {\n        return;\n      }\n\n      fetchNextPage();\n    }, [inViewPort, loadingStatus, isFetching, hasNextPage]);\n\n    if (loadingStatus === 'error') {\n      return (\n        <div className=\"flex justify-center items-center min-h-[300px] w-full\">\n          <EmptyState\n            title=\"An error occurred\"\n            description=\"Please try again later\"\n          />\n        </div>\n      );\n    }\n\n    if (loadingStatus === 'pending') {\n      return (\n        <Spin wrapperClassName=\"flex justify-center items-center min-h-[300px] w-full\" />\n      );\n    }\n\n    if (loadingStatus === 'success' && !list.length && !showCurrent) {\n      return (\n        <div className=\"flex justify-center items-center min-h-[300px] w-full\">\n          <EmptyState\n            title={I18n.t('query_data_empty')}\n            description={I18n.t('bwc_no_version_record')}\n          />\n        </div>\n      );\n    }\n\n    const timelineType = (data: VersionMetaInfo, index) => {\n      // PPE history, online activation\n      if (type === OperateType.PubPPEOperate) {\n        return !data.offline ? 'ongoing' : 'default';\n      }\n\n      // Submission history and release history, latest activations\n      return index === 0 ? 'ongoing' : 'default';\n    };\n\n    return (\n      <div ref={scrollContainerRef} className={className}>\n        <Timeline>\n          {showCurrent ? (\n            <Timeline.Item\n              className={css['history-item']}\n              type=\"warning\"\n              dot={value === currentKey ? <IconCozFocus /> : undefined}\n            >\n              <div\n                className={classNames(\n                  'relative top-[-8px] p-2 rounded-mini',\n                  value === currentKey\n                    ? 'coz-mg-hglt'\n                    : 'hover:coz-mg-secondary',\n                  !readonly && 'cursor-pointer',\n                )}\n                onClick={() => onCurrentClick?.(currentKey)}\n              >\n                <Text className=\"font-bold\">\n                  {I18n.t('devops_publish_multibranch_Current')}\n                </Text>\n              </div>\n            </Timeline.Item>\n          ) : null}\n          {list.map((item, index) => (\n            <Timeline.Item\n              className={css['history-item']}\n              key={item.commit_id}\n              type={timelineType(item, index)}\n              dot={value === item.commit_id ? <IconCozFocus /> : undefined}\n            >\n              <CommitItem\n                className=\"relative top-[-8px]\"\n                data={item}\n                readonly={readonly}\n                isActive={value === item.commit_id}\n                enablePublishPPE={enablePublishPPE}\n                onClick={!readonly ? onItemClick : undefined}\n                onPublishPPE={onPublishPPE}\n                onResetToCommit={onResetToCommit}\n                onShowCommit={onShowCommit}\n                hideCommitId={hideCommitId}\n              />\n            </Timeline.Item>\n          ))}\n        </Timeline>\n        {hasNextPage ? (\n          <div\n            className=\"flex justify-center py-1\"\n            ref={intersectionObserverDom}\n          >\n            <Spin spinning wrapperClassName=\"mr-2\" />\n            <div className=\"coz-fg-primary\">{I18n.t('Loading')}</div>\n          </div>\n        ) : null}\n      </div>\n    );\n  },\n);\n\nexport const WorkflowCommitList = Object.assign(WorkflowCommitListComp, {\n  Item: CommitItem,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useMemo, useState } from 'react';\n\nimport {\n  type UseInfiniteQueryResult,\n  useInfiniteQuery,\n} from '@tanstack/react-query';\nimport {\n  type VersionMetaInfo,\n  type VersionHistoryListRequest,\n  type OperateType,\n  workflowApi,\n} from '@coze-workflow/base/api';\n\ntype VersionHistoryQueryParams = Omit<\n  VersionHistoryListRequest,\n  'limit' | 'cursor'\n>;\n\ninterface VersionHistoryParams {\n  spaceId: string;\n  workflowId: string;\n  type: OperateType;\n  /** Number of requests per page, default 10 */\n  pageSize?: number;\n  /** Whether to start the request, default false */\n  enabled?: boolean;\n}\n\ninterface VersionHistoryReturn {\n  queryParams: VersionHistoryQueryParams;\n  updatePageParam: (newParam: Partial<VersionHistoryListRequest>) => void;\n  list: VersionMetaInfo[];\n  queryError: UseInfiniteQueryResult['error'];\n  loadingStatus: UseInfiniteQueryResult['status'];\n  refetch: UseInfiniteQueryResult['refetch'];\n  fetchNextPage: UseInfiniteQueryResult['fetchNextPage'];\n  isFetching: UseInfiniteQueryResult['isFetching'];\n  isFetchingNextPage: UseInfiniteQueryResult['isFetchingNextPage'];\n  hasNextPage: UseInfiniteQueryResult['hasNextPage'];\n}\n\nexport function useVersionHistory({\n  spaceId,\n  workflowId,\n  type,\n  pageSize = 10,\n  enabled = false,\n}: VersionHistoryParams): Readonly<VersionHistoryReturn> {\n  const [queryParams, setQueryParams] = useState<VersionHistoryQueryParams>({\n    space_id: spaceId,\n    workflow_id: workflowId,\n    type,\n  });\n  const initialPageParam = useMemo<VersionHistoryListRequest>(\n    () => ({\n      ...queryParams,\n      limit: pageSize,\n      last_commit_id: '',\n    }),\n    [queryParams, pageSize],\n  );\n\n  const updatePageParam = useCallback(\n    (newParam: Partial<VersionHistoryQueryParams>) => {\n      setQueryParams(prevParams => ({\n        ...prevParams,\n        ...newParam,\n      }));\n    },\n    [],\n  );\n\n  const queryKey = useMemo(\n    () => ['workflowApi_OperateList', JSON.stringify(initialPageParam)],\n    [initialPageParam],\n  );\n\n  const fetchList = async (params: VersionHistoryListRequest) => {\n    const resp = await workflowApi.VersionHistoryList(params);\n\n    return resp.data;\n  };\n\n  const {\n    data: pageData,\n    error: queryError,\n    fetchNextPage,\n    hasNextPage,\n    isFetching,\n    isFetchingNextPage,\n    status: loadingStatus,\n    refetch,\n  } = useInfiniteQuery({\n    enabled: Boolean(spaceId && workflowId && enabled),\n    queryKey,\n    queryFn: ({ pageParam }) => fetchList(pageParam),\n    initialPageParam,\n    getNextPageParam: (lastPage, allPages, lastPageParam) => {\n      if (!lastPage?.has_more) {\n        return null;\n      }\n      return {\n        ...lastPageParam,\n        cursor: lastPage.cursor || '',\n      };\n    },\n  });\n\n  const targetList = useMemo(() => {\n    const result: VersionMetaInfo[] = [];\n    const idMap: Record<string, boolean> = {};\n\n    pageData?.pages.forEach(page => {\n      page?.version_list?.forEach(item => {\n        const key = item.commit_id || '';\n        if (!idMap[key]) {\n          result.push(item);\n        }\n        idMap[key] = true;\n      });\n    });\n\n    return result;\n  }, [pageData]);\n\n  return {\n    queryParams,\n    updatePageParam,\n\n    list: targetList,\n    queryError,\n    loadingStatus,\n    refetch,\n    fetchNextPage,\n    isFetching,\n    isFetchingNextPage,\n    hasNextPage,\n  } as const;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport classNames from 'classnames';\n\nimport { type ExpressionEditorModel } from '../../model';\n\nimport styles from './index.module.less';\n\ninterface ExpressionEditorCounterProps {\n  className?: string;\n  model: ExpressionEditorModel;\n  maxLength?: number;\n  disabled?: boolean;\n  isError?: boolean;\n}\n\n/**\n * length counter\n */\nexport const ExpressionEditorCounter: FC<\n  ExpressionEditorCounterProps\n> = props => {\n  const { className, model, maxLength, disabled, isError } = props;\n\n  const { visible, count, max } = useMemo(() => {\n    if (typeof model.value.length !== 'number') {\n      return {\n        visible: false,\n      };\n    }\n    if (typeof maxLength !== 'number') {\n      return {\n        visible: false,\n      };\n    }\n    return {\n      visible: true,\n      count: model.value.length,\n      max: maxLength,\n    };\n  }, [model.value.length, maxLength]);\n\n  if (disabled || !visible) {\n    return <></>;\n  }\n\n  return (\n    <div\n      className={classNames(styles['expression-editor-counter'], className, {\n        [styles['expression-editor-counter-error']]: isError,\n      })}\n    >\n      <p>\n        {count} / {max}\n      </p>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type CSSProperties } from 'react';\n\nimport type { RenderLeafProps } from 'slate-react';\n\nimport { ExpressionEditorSignal } from '../../constant';\n\nconst LeafStyle: Partial<Record<ExpressionEditorSignal, CSSProperties>> = {\n  [ExpressionEditorSignal.Valid]: {\n    color: '#6675D9',\n  },\n  [ExpressionEditorSignal.Invalid]: {\n    color: 'inherit',\n  },\n  [ExpressionEditorSignal.SelectedValid]: {\n    color: '#6675D9',\n    borderRadius: 2,\n    backgroundColor:\n      'var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))',\n  },\n  [ExpressionEditorSignal.SelectedInvalid]: {\n    color: 'inherit',\n    borderRadius: 2,\n    backgroundColor:\n      'var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))',\n  },\n};\n\nexport const ExpressionEditorLeaf = (props: RenderLeafProps) => {\n  const { type } = props.leaf as {\n    type?: ExpressionEditorSignal;\n  };\n  return (\n    <span style={type && LeafStyle[type]} {...props.attributes}>\n      {props.children}\n    </span>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type CompositionEventHandler } from 'react';\n\nimport { Slate, Editable } from 'slate-react';\nimport classNames from 'classnames';\n\nimport { ExpressionEditorLeaf } from '../leaf';\nimport { type ExpressionEditorLine } from '../../type';\nimport { type ExpressionEditorModel } from '../../model';\n\nimport styles from './index.module.less';\n\ninterface ExpressionEditorRenderProps {\n  model: ExpressionEditorModel;\n  className?: string;\n  placeholder?: string;\n  readonly?: boolean;\n  onFocus?: () => void;\n  onBlur?: () => void;\n  dataTestID?: string;\n}\n\n/**\n * It should only contain editor logic, business-independent\n */\nexport const ExpressionEditorRender: React.FC<\n  ExpressionEditorRenderProps\n> = props => {\n  const {\n    model,\n    className,\n    placeholder,\n    onFocus,\n    onBlur,\n    readonly = false,\n    dataTestID,\n  } = props;\n\n  return (\n    <div className={className}>\n      <Slate\n        editor={model.editor}\n        initialValue={model.lines}\n        onChange={value => {\n          // eslint-disable-next-line @typescript-eslint/require-await -- prevent blocking slate rendering\n          const asyncOnChange = async () => {\n            const lines = value as ExpressionEditorLine[];\n            model.change(lines);\n            model.select(lines);\n          };\n          asyncOnChange();\n        }}\n      >\n        <Editable\n          data-testid={dataTestID}\n          className={classNames(\n            styles.slateEditable,\n            'flow-canvas-not-draggable',\n          )}\n          data-flow-editor-selectable=\"false\"\n          readOnly={readonly}\n          onFocus={onFocus}\n          onBlur={onBlur}\n          placeholder={placeholder}\n          renderLeaf={ExpressionEditorLeaf}\n          decorate={model.decorate}\n          onKeyDown={e => model.keydown(e)}\n          onCompositionStart={e =>\n            model.compositionStart(\n              e as unknown as CompositionEventHandler<HTMLDivElement>,\n            )\n          }\n        />\n      </Slate>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport { useReducer } from 'react';\n\nimport { type ExpressionEditorTreeNode } from '../../type';\nimport {\n  type SuggestionState,\n  type SuggestionAction,\n  SuggestionActionType,\n  type SuggestionActionPayload,\n  type SuggestionReducer,\n} from './type';\n\nconst updateState = (\n  state: SuggestionState,\n  snapshot: Partial<SuggestionState>,\n): SuggestionState => ({\n  ...state,\n  version: state.version + 1,\n  ...snapshot,\n});\n\nexport const suggestionReducer = (\n  state: SuggestionState,\n  action: SuggestionAction,\n) => {\n  if (action.type === SuggestionActionType.SetInitialized) {\n    return updateState(state, {\n      initialized: true,\n    });\n  }\n  if (action.type === SuggestionActionType.Refresh) {\n    return updateState(state, {\n      key: state.key + 1,\n    });\n  }\n  if (action.type === SuggestionActionType.SetParseDataAndEditorPath) {\n    const { parseData, editorPath } =\n      (action.payload as SuggestionActionPayload<SuggestionActionType.SetParseDataAndEditorPath>) ||\n      {};\n    return updateState(state, {\n      parseData,\n      editorPath,\n    });\n  }\n  if (action.type === SuggestionActionType.ClearParseDataAndEditorPath) {\n    return updateState(state, {\n      parseData: undefined,\n      editorPath: undefined,\n    });\n  }\n  if (action.type === SuggestionActionType.SetVariableTree) {\n    const variableTree = action.payload as ExpressionEditorTreeNode[];\n    return updateState(state, {\n      variableTree,\n    });\n  }\n  if (action.type === SuggestionActionType.SetAllowVisibleChange) {\n    const allowVisibleChange =\n      action.payload as SuggestionActionPayload<SuggestionActionType.SetAllowVisibleChange>;\n    return updateState(state, {\n      allowVisibleChange,\n    });\n  }\n  if (\n    action.type === SuggestionActionType.SetVisible &&\n    state.allowVisibleChange\n  ) {\n    const visible =\n      action.payload as SuggestionActionPayload<SuggestionActionType.SetVisible>;\n    if (state.entities.selectorBoxConfig) {\n      if (visible) {\n        state.entities.selectorBoxConfig.disabled = true; // Prevent mouse dragging from triggering clicks\n      }\n      if (!visible) {\n        state.entities.selectorBoxConfig.disabled = false;\n      }\n    }\n    return updateState(state, {\n      visible,\n    });\n  }\n  if (action.type === SuggestionActionType.SetHiddenDOM) {\n    const hiddenDOM =\n      action.payload as SuggestionActionPayload<SuggestionActionType.SetHiddenDOM>;\n    return updateState(state, {\n      hiddenDOM,\n    });\n  }\n  if (action.type === SuggestionActionType.SetRect) {\n    const rect = action.payload as {\n      top: number;\n      left: number;\n    };\n    return updateState(state, {\n      rect,\n    });\n  }\n  if (action.type === SuggestionActionType.SetSelected) {\n    const selected = action.payload as ExpressionEditorTreeNode;\n    return updateState(state, {\n      selected,\n    });\n  }\n  if (action.type === SuggestionActionType.SetEmptyContent) {\n    const emptyContent = action.payload as string;\n    return updateState(state, {\n      emptyContent,\n    });\n  }\n  if (action.type === SuggestionActionType.SetMatchTreeBranch) {\n    const matchTreeBranch = action.payload as\n      | ExpressionEditorTreeNode[]\n      | undefined;\n    return updateState(state, {\n      matchTreeBranch,\n    });\n  }\n  if (action.type === SuggestionActionType.SearchEffectStart) {\n    return updateState(state, {\n      renderEffect: {\n        ...state.renderEffect,\n        search: true,\n      },\n    });\n  }\n  if (action.type === SuggestionActionType.SearchEffectEnd) {\n    return updateState(state, {\n      renderEffect: {\n        ...state.renderEffect,\n        search: false,\n      },\n    });\n  }\n  if (action.type === SuggestionActionType.FilteredEffectStart) {\n    return updateState(state, {\n      renderEffect: {\n        ...state.renderEffect,\n        filtered: true,\n      },\n    });\n  }\n  if (action.type === SuggestionActionType.FilteredEffectEnd) {\n    return updateState(state, {\n      renderEffect: {\n        ...state.renderEffect,\n        filtered: false,\n      },\n    });\n  }\n  return state;\n};\n\n/** Get status */\nexport const useSuggestionReducer = (\n  initialState: Omit<\n    SuggestionState,\n    | 'initialized'\n    | 'version'\n    | 'key'\n    | 'visible'\n    | 'allowVisibleChange'\n    | 'hiddenDOM'\n    | 'variableTree'\n    | 'renderEffect'\n  >,\n): SuggestionReducer => {\n  const [state, dispatch]: SuggestionReducer = useReducer(suggestionReducer, {\n    ...initialState,\n    initialized: false, // initialization\n    version: 0, // update status count\n    key: 0, // Used to trigger react to re-render components\n    variableTree: [], // Component tree for presentation\n    visible: true, // Default display, allowing ref to access the DOM\n    hiddenDOM: true, // Hidden by default, so that users cannot see the UI.\n    allowVisibleChange: true, // Allow visible changes\n    renderEffect: {\n      // rendering side effects\n      search: false,\n      filtered: false,\n    },\n  });\n  return [state, dispatch];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CompositionEventHandler, KeyboardEventHandler } from 'react';\n\nimport { type ReactEditor, withReact } from 'slate-react';\nimport { withHistory } from 'slate-history';\nimport {\n  Text,\n  type NodeEntry,\n  Transforms,\n  createEditor,\n  Range,\n  type BaseEditor,\n  Editor,\n} from 'slate';\nimport EventEmitter from 'eventemitter3';\n\nimport { ExpressionEditorValidator } from '../validator';\nimport type {\n  ExpressionEditorEventParams,\n  ExpressionEditorRange,\n  ExpressionEditorEventDisposer,\n  ExpressionEditorLine,\n  ExpressionEditorTreeNode,\n  ExpressionEditorValidateData,\n} from '../type';\nimport { ExpressionEditorParser } from '../parser';\nimport {\n  ExpressionEditorEvent,\n  ExpressionEditorToken,\n  ExpressionEditorSignal,\n} from '../constant';\n\nexport class ExpressionEditorModel {\n  public readonly editor: BaseEditor & ReactEditor;\n  protected innerValue: string;\n  protected innerFocus: boolean;\n  protected innerLines: ExpressionEditorLine[];\n  protected innerVariableTree: ExpressionEditorTreeNode[];\n  protected emitter: EventEmitter;\n\n  constructor(initialValue: string) {\n    this.emitter = new EventEmitter();\n    this.editor = withReact(withHistory(createEditor()));\n    this.innerValue = initialValue;\n    this.innerLines = ExpressionEditorParser.deserialize(initialValue);\n  }\n\n  /** Set variable tree */\n  public setVariableTree(variableTree: ExpressionEditorTreeNode[]): void {\n    this.innerVariableTree = variableTree;\n  }\n\n  /** Get variable tree */\n  public get variableTree(): ExpressionEditorTreeNode[] {\n    return this.innerVariableTree;\n  }\n\n  /** Get row data */\n  public get lines(): ExpressionEditorLine[] {\n    return this.innerLines;\n  }\n\n  /** Get Serialized Value */\n  public get value(): string {\n    return this.innerValue;\n  }\n\n  /** External setting model values */\n  public setValue(value: string): void {\n    if (value === this.innerValue) {\n      return;\n    }\n    this.innerValue = value;\n    this.innerLines = ExpressionEditorParser.deserialize(value);\n    this.syncEditorValue();\n  }\n\n  /** Synchronize selected state */\n  public setFocus(focus: boolean): void {\n    if (this.innerFocus === focus) {\n      return;\n    }\n    this.innerFocus = focus;\n    if (focus) {\n      // Active trigger selection event when first selected, active trigger variable recommendation\n      this.select(this.lines);\n    } else if (this.innerValue !== '' && this.editor.children.length !== 0) {\n      // Trigger out of focus and editor content is not empty, reset the selection\n      Transforms.select(this.editor, Editor.start(this.editor, []));\n    }\n  }\n\n  /** Register an event */\n  public on<T extends ExpressionEditorEvent>(\n    event: T,\n    callback: (params: ExpressionEditorEventParams<T>) => void,\n  ): ExpressionEditorEventDisposer {\n    this.emitter.on(event, callback);\n    return () => {\n      this.emitter.off(event, callback);\n    };\n  }\n\n  /** data change event */\n  public change(lines: ExpressionEditorLine[]): void {\n    const isAstChange = this.editor.operations.some(\n      op => 'set_selection' !== op.type,\n    );\n    if (!isAstChange) {\n      return;\n    }\n    this.innerLines = lines;\n    this.innerValue = ExpressionEditorParser.serialize(lines);\n    this.emitter.emit(ExpressionEditorEvent.Change, {\n      lines,\n      value: this.innerValue,\n    });\n  }\n\n  /** selected event */\n  public select(lines: ExpressionEditorLine[]): void {\n    const { selection } = this.editor;\n    if (!selection || !Range.isCollapsed(selection)) {\n      return;\n    }\n    if (\n      selection.anchor.offset !== selection.focus.offset ||\n      selection.anchor.path[0] !== selection.focus.path[0] ||\n      selection.anchor.path[1] !== selection.focus.path[1]\n    ) {\n      // box selection\n      this.emitter.emit(ExpressionEditorEvent.Select, {\n        content: '',\n        offset: -1,\n      });\n      return;\n    }\n    const cursorOffset = selection.anchor.offset;\n    const lineIndex = selection.anchor.path[0];\n    const contentIndex = selection.anchor.path[1];\n    const line = lines[lineIndex];\n    if (!line) {\n      return;\n    }\n    const content = line.children[contentIndex];\n    const cursorContent = content?.text;\n    if (typeof cursorContent !== 'string') {\n      return;\n    }\n    this.emitter.emit(ExpressionEditorEvent.Select, {\n      content: cursorContent,\n      offset: cursorOffset,\n      path: selection.anchor.path,\n    });\n  }\n\n  /** keyboard event */\n  public keydown(\n    event: Parameters<KeyboardEventHandler<HTMLDivElement>>[0],\n  ): void {\n    if (event.key === ExpressionEditorToken.Start) {\n      event.preventDefault();\n      Transforms.insertText(\n        this.editor,\n        ExpressionEditorToken.FullStart + ExpressionEditorToken.FullEnd,\n      );\n      Transforms.move(this.editor, {\n        distance: 2,\n        reverse: true,\n      });\n      setTimeout(() => {\n        // Slate UI Rendering\n        this.select(this.innerLines);\n      }, 0);\n    }\n    if (event.ctrlKey || event.metaKey) {\n      switch (event.key) {\n        case 'a':\n          event.preventDefault();\n          Transforms.select(this.editor, {\n            anchor: Editor.start(this.editor, []),\n            focus: Editor.end(this.editor, []),\n          });\n          return;\n        default:\n          return;\n      }\n    }\n  }\n\n  /** Start typing pinyin */\n  public compositionStart(\n    event: CompositionEventHandler<HTMLDivElement>,\n  ): void {\n    this.emitter.emit(ExpressionEditorEvent.CompositionStart, {\n      event,\n    });\n  }\n\n  /** Decorative leaf node */\n  public get decorate(): ([node, path]: NodeEntry) => ExpressionEditorRange[] {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    const decorateFn = ([node, path]: NodeEntry): ExpressionEditorRange[] => {\n      const ranges: ExpressionEditorRange[] = [];\n      if (!Text.isText(node)) {\n        return ranges;\n      }\n      // Evaluation expressions are legal/illegal\n      const validateList = ExpressionEditorValidator.lineTextValidate({\n        lineText: node.text,\n        tree: self.innerVariableTree,\n      });\n      validateList.forEach(validateData => {\n        const { start, end, valid } = validateData;\n        const rangePath = {\n          anchor: { path, offset: start },\n          focus: { path, offset: end },\n        };\n        if (valid) {\n          ranges.push({\n            type: ExpressionEditorSignal.Valid,\n            ...rangePath,\n          });\n        } else {\n          ranges.push({\n            type: ExpressionEditorSignal.Invalid,\n            ...rangePath,\n          });\n        }\n      });\n      if (!this.innerFocus) {\n        return ranges;\n      }\n      // The following is the logic for evaluating the currently selected expression\n      const selectedItem = self.isValidateSelectPath([node, path]);\n      const selectedValidItem = validateList.find(\n        validateData =>\n          validateData.valid &&\n          validateData.start === selectedItem?.start &&\n          validateData.end === selectedItem?.end,\n      );\n      if (selectedItem && selectedValidItem) {\n        ranges.push({\n          type: ExpressionEditorSignal.SelectedValid,\n          anchor: { path, offset: selectedItem.start },\n          focus: { path, offset: selectedItem.end },\n        });\n      } else if (selectedItem && !selectedValidItem) {\n        ranges.push({\n          type: ExpressionEditorSignal.SelectedInvalid,\n          anchor: { path, offset: selectedItem.start },\n          focus: { path, offset: selectedItem.end },\n        });\n      }\n      return ranges;\n    };\n    return decorateFn;\n  }\n\n  /**\n   * Synchronize editor instance content\n   * > ** NOTICE: ** * To ensure that performance is not affected, it should only be called when an external value change causes the editor value to be inconsistent with the model value.\n   */\n  private syncEditorValue(): void {\n    // Delete all lines in the editor\n    this.editor.children.forEach((line, index) => {\n      Transforms.removeNodes(this.editor, {\n        at: [index],\n      });\n    });\n    // Reinsert the current line content in the editor\n    this.lines.forEach((line, index) => {\n      Transforms.insertNodes(this.editor, line, {\n        at: [this.editor.children.length],\n      });\n    });\n  }\n\n  private isValidateSelectPath([node, path]: NodeEntry):\n    | ExpressionEditorValidateData\n    | undefined {\n    if (!Text.isText(node)) {\n      return;\n    }\n    const { selection } = this.editor;\n    if (!selection) {\n      return;\n    }\n    const cursorOffset = selection.anchor.offset;\n    const lineIndex = selection.anchor.path[0];\n    const contentIndex = selection.anchor.path[1];\n    if (lineIndex !== path[0] || contentIndex !== path[1]) {\n      return;\n    }\n    const lineContent = node.text;\n    const lineOffset = cursorOffset;\n    const parsedData = ExpressionEditorParser.parse({\n      lineContent,\n      lineOffset,\n    });\n    if (!parsedData) {\n      return;\n    }\n    return {\n      start: parsedData.offset.lastStart - 1,\n      // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n      end: parsedData.offset.firstEnd + 2,\n      valid: true,\n    };\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { useBoolean } from 'ahooks';\n\nimport { type WorkFlowModalModeProps } from '../workflow-modal/type';\nimport WorkflowModal from '../workflow-modal';\n\ninterface UseWorkFlowListReturnValue {\n  node: ReactNode;\n  open: () => void;\n  close: () => void;\n}\n\nexport const useWorkflowModal = (\n  props?: WorkFlowModalModeProps,\n): UseWorkFlowListReturnValue => {\n  const { onClose, ...restProps } = props || {};\n  const [visible, { setTrue: showModal, setFalse: hideModal }] =\n    useBoolean(false);\n  const closeModal = () => {\n    onClose?.();\n    hideModal();\n  };\n  return {\n    node: visible ? (\n      <WorkflowModal visible onClose={closeModal} {...restProps} />\n    ) : null,\n    close: closeModal,\n    open: showModal,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nimport { useUnmount } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport ImageUploader, { ImgUploadErrNo } from './image-uploader';\n\ninterface UseImageUploaderParams {\n  /** image restrictions */\n  rules?: ImageUploader['rules'];\n  /** upload mode */\n  mode?: ImageUploader['mode'];\n  /** upload configuration */\n  timeout?: ImageUploader['timeout'];\n}\n\ninterface UseImageUploaderReturn {\n  /** Image ID for submission to the service */\n  uri: string;\n  /** Picture display address */\n  url: string;\n  /** file name */\n  fileName: string;\n  /** Uploading status */\n  loading: boolean;\n  /** Upload failed status */\n  isError: boolean;\n  /** Upload image */\n  uploadImg: (file: File) => Promise<ImageUploader['uploadResult']>;\n  /** Clear uploaded images */\n  clearImg: () => void;\n  /** Retry after upload failure */\n  retryUploadImg: () => Promise<ImageUploader['uploadResult']>;\n  /**\n   * Set the initial state for echoing data sent by the service\n   *\n   * @param val corresponding value\n   * @Param isMerge Whether to merge mode, merge mode only updates incoming fields. Default false\n   */\n  setImgValue: (\n    val: { uri?: string; url?: string; fileName?: string },\n    isMerge?: boolean,\n  ) => void;\n}\n\n/** cache filename */\nconst fileNameCache: Record<string, string> = Object.create(null);\n\n// eslint-disable-next-line max-lines-per-function\nexport default function useImageUploader(\n  params?: UseImageUploaderParams,\n): UseImageUploaderReturn {\n  const { rules, mode, timeout } = params || {};\n  const uploaderRef = useRef<ImageUploader>(\n    new ImageUploader({ rules, mode, timeout }),\n  );\n  const [loading, setLoading] = useState(false);\n  const [isError, setIsError] = useState(false);\n  const [uri, setUri] = useState('');\n  const [url, setUrl] = useState('');\n  const [fileName, setFileName] = useState('');\n\n  useUnmount(() => {\n    uploaderRef.current?.reset();\n  });\n\n  useEffect(() => {\n    uploaderRef.current.rules = rules;\n    uploaderRef.current.mode = mode ?? uploaderRef.current.mode;\n  }, [rules, mode]);\n\n  const setImgValue: UseImageUploaderReturn['setImgValue'] = useCallback(\n    (\n      { url: targetDisplayUrl, uri: targetUri, fileName: targetFileName },\n      isMerge = false,\n    ) => {\n      if (typeof targetUri !== 'undefined') {\n        setUri(targetUri);\n      }\n      if (typeof targetDisplayUrl !== 'undefined') {\n        setUrl(targetDisplayUrl);\n      }\n      if (typeof targetFileName !== 'undefined') {\n        setFileName(targetFileName);\n      }\n\n      // Non-Merge mode, unset values are cleared\n      if (!isMerge) {\n        setUrl(targetDisplayUrl ?? '');\n        setUri(targetUri ?? '');\n        setFileName(targetFileName ?? '');\n      }\n\n      // Filename special logic, remapping filenames from cache based on URIs\n      if (!targetFileName) {\n        if (targetUri && fileNameCache[targetUri]) {\n          setFileName(fileNameCache[targetUri]);\n        } else if (!targetUri) {\n          setFileName('');\n        }\n      }\n\n      if (typeof targetUri !== 'undefined' || !isMerge) {\n        setLoading(false);\n        setIsError(false);\n        uploaderRef.current?.reset();\n      }\n    },\n    [],\n  );\n\n  const uploadImg = useCallback(\n    async (file: File): Promise<ImageUploader['uploadResult'] | undefined> => {\n      await uploaderRef.current.select(file);\n      // The picture verification failed.\n      if (!uploaderRef.current.validateResult?.isSuccess) {\n        Toast.error(\n          uploaderRef.current.validateResult?.msg || '',\n        );\n        // @ts-expect-error here validateResult.isSuccess is false\n        return uploaderRef.current.validateResult;\n      }\n\n      setIsError(false);\n      setLoading(true);\n      setUrl(uploaderRef.current.displayUrl || '');\n      setFileName(file.name || '');\n      await uploaderRef.current.upload();\n      setLoading(false);\n\n      // Upload result\n      const { uploadResult } = uploaderRef.current;\n\n      // No upload result indicates that the upload is cancelled.\n      if (!uploadResult) {\n        return;\n      }\n\n      setIsError(!uploadResult.isSuccess);\n\n      if (uploadResult.isSuccess) {\n        Toast.success(I18n.t('file_upload_success'));\n        setUri(uploadResult.uri);\n        // FIXME: A reasonable design should cache with URIs, but Imageflow initially only stored URLs, using URLs as a temporary solution\n        fileNameCache[uploadResult.url] = `${file.name}`;\n      } else {\n        Toast.error(uploadResult.msg);\n      }\n      return uploadResult;\n    },\n    [],\n  );\n\n  const retryUploadImg = useCallback(async (): Promise<\n    ImageUploader['uploadResult']\n  > => {\n    // Resend pre-check, there is a file and the verification is passed\n    if (\n      !uploaderRef.current?.file ||\n      !uploaderRef.current?.validateResult?.isSuccess\n    ) {\n      Toast.error(I18n.t('imageflow_upload_action'));\n      return {\n        isSuccess: false,\n        errNo: ImgUploadErrNo.NoFile,\n        msg: '',\n      };\n    }\n    setLoading(true);\n    setIsError(false);\n    await uploaderRef.current.upload();\n    setLoading(false);\n\n    // Upload result\n    const uploadResult = uploaderRef.current.uploadResult || {\n      isSuccess: false,\n      errNo: ImgUploadErrNo.UploadFail,\n      msg: '',\n    };\n\n    setIsError(!uploadResult.isSuccess);\n    if (uploadResult.isSuccess) {\n      Toast.success(I18n.t('file_upload_success'));\n      setUri(uploadResult.uri);\n      fileNameCache[uploadResult.url] = uploaderRef.current.file.name;\n    } else {\n      Toast.error(uploadResult.msg);\n    }\n    return uploadResult;\n  }, []);\n\n  const clearImg = useCallback(() => {\n    setUri('');\n    setUrl('');\n    setFileName('');\n    setLoading(false);\n    setIsError(false);\n    uploaderRef.current?.reset();\n  }, []);\n\n  return {\n    uri,\n    url,\n    fileName,\n    loading,\n    isError,\n    uploadImg,\n    clearImg,\n    retryUploadImg,\n    setImgValue,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState, type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { CozInputNumber, Select } from '@coze-arch/coze-design';\n\nexport interface SizeSelectProps {\n  minWidth?: number;\n  minHeight?: number;\n  maxWidth?: number;\n  maxHeight?: number;\n  value?: {\n    width?: number;\n    height?: number;\n  };\n  defaultValue?: {\n    width?: number;\n    height?: number;\n  };\n  onChange: (value: { width?: number; height?: number }) => void;\n  readonly?: boolean;\n  options?: {\n    label: string;\n    value: {\n      width: number;\n      height: number;\n    };\n    disabled?: boolean;\n  }[];\n  selectClassName?: string;\n  layoutStyle?: 'vertical' | 'horizontal';\n}\n\ninterface SizeOption {\n  label: string;\n  originValue?: {\n    width: number;\n    height: number;\n  };\n  value: string;\n  disabled?: boolean;\n}\n\nfunction isNumber(value) {\n  return typeof value === 'number' && !isNaN(value);\n}\n\nexport const SizeSelect: FC<SizeSelectProps> = props => {\n  const {\n    options = [],\n    value,\n    defaultValue,\n    minWidth = 0,\n    maxWidth = Infinity,\n    minHeight = 0,\n    maxHeight = Infinity,\n    onChange,\n    readonly,\n    selectClassName = '',\n    layoutStyle = 'horizontal',\n  } = props;\n\n  const width = value?.width ?? defaultValue?.width ?? 0;\n  const height = value?.height ?? defaultValue?.height ?? 0;\n\n  const [sizeOptionList, setSizeOptionList] = useState<SizeOption[]>([]);\n  const [sizeValue, setSizeValue] = useState<string>();\n\n  const stringToWidthHeight = (str: string) => ({\n    width: Number(str.split('x')[0]),\n    height: Number(str.split('x')[1]),\n  });\n\n  const widthHeightToString = (v: { width: number; height: number }) =>\n    `${v.width}x${v.height}`;\n\n  useEffect(() => {\n    const _sizeValue = widthHeightToString({ width, height });\n    const _options: SizeOption[] = options.map(d => ({\n      ...d,\n      originValue: d.value,\n      value: widthHeightToString(d.value),\n    }));\n    const selected = _options.find(d => d.value === _sizeValue);\n\n    if (!selected) {\n      _options.push({\n        label: I18n.t('customize_key_1'),\n        value: 'custom',\n      });\n    }\n\n    setSizeValue(selected?.value ?? 'custom');\n    setSizeOptionList(_options);\n  }, [width, height, options]);\n\n  return (\n    <div className=\"flex flex-wrap gap-[12px]\">\n      <Select\n        onChange={v => {\n          if (v === 'custom') {\n            return;\n          }\n\n          const wh = stringToWidthHeight(v as string);\n          onChange(wh);\n        }}\n        disabled={readonly}\n        className={`${selectClassName} ${\n          layoutStyle === 'horizontal' ? '' : 'w-full'\n        }`}\n        value={sizeValue}\n        optionList={sizeOptionList}\n        size=\"small\"\n      />\n\n      <div className=\"flex-1 flex items-center\">\n        <CozInputNumber\n          size=\"small\"\n          prefix={I18n.t('imageflow_canvas_width')}\n          hideButtons\n          onNumberChange={w => {\n            if (isNaN(w as number)) {\n              return;\n            }\n            onChange({\n              width: Number(w),\n              height,\n            });\n          }}\n          onBlur={e => {\n            if (\n              e.target.value === '' ||\n              (isNumber(minWidth) && Number(e.target.value) < minWidth)\n            ) {\n              onChange({\n                width: minWidth ?? 0,\n                height,\n              });\n            } else if (Number(e.target.value) > maxWidth) {\n              onChange({\n                width: maxWidth,\n                height,\n              });\n            }\n          }}\n          value={width}\n          disabled={readonly}\n          min={minWidth}\n          max={maxWidth}\n          className=\"flex-1\"\n        />\n      </div>\n      <div className=\"flex-1 flex items-center\">\n        <CozInputNumber\n          prefix={I18n.t('imageflow_canvas_height')}\n          size=\"small\"\n          hideButtons\n          onNumberChange={h => {\n            if (isNaN(h as number)) {\n              return;\n            }\n            onChange({\n              height: Number(h),\n              width,\n            });\n          }}\n          onBlur={e => {\n            if (\n              e.target.value === '' ||\n              (isNumber(minHeight) && Number(e.target.value) < minHeight)\n            ) {\n              onChange({\n                width,\n                height: minHeight ?? 0,\n              });\n            } else if (\n              isNumber(maxHeight) &&\n              Number(e.target.value) > maxHeight\n            ) {\n              onChange({\n                width,\n                height: maxHeight,\n              });\n            }\n          }}\n          value={height}\n          disabled={readonly}\n          min={minHeight}\n          max={maxHeight}\n          className=\"flex-1\"\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** Text component, beyond automatic... and show tooltip */\nimport { type FC } from 'react';\n\nimport { Typography } from '@coze-arch/coze-design';\nimport { type Position } from '@coze-arch/bot-semi/Tooltip';\n\ninterface IText {\n  text?: string;\n  rows?: number;\n  className?: string;\n  tooltipPosition?: Position;\n}\nexport const Text: FC<IText> = props => {\n  const { text = '', rows = 1, className, tooltipPosition } = props;\n  return (\n    <Typography.Paragraph\n      ellipsis={{\n        rows,\n        showTooltip: {\n          type: 'tooltip',\n          opts: {\n            style: {\n              width: '100%',\n              wordBreak: 'break-word',\n            },\n            position: tooltipPosition,\n          },\n        },\n      }}\n      className={className}\n    >\n      {text}\n    </Typography.Paragraph>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type MutableRefObject,\n  useRef,\n  useState,\n  useLayoutEffect,\n} from 'react';\n\nimport { dequal } from 'dequal';\n\nimport { ExpressionEditorParserBuiltin } from '@/expression-editor/parser';\nimport { ExpressionEditorSegmentType } from '@/expression-editor';\n\nfunction useLatest<T>(value: T): MutableRefObject<T> {\n  const ref = useRef(value);\n  ref.current = value;\n\n  return ref;\n}\n\n// Remove circular dependencies caused by parents (otherwise no deep comparison is possible)\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction cloneWithout(target: any, keys: string[]) {\n  // An error is thrown when target is undefined\n  try {\n    return JSON.parse(\n      JSON.stringify(target, function (key, value) {\n        if (keys.includes(key)) {\n          return null;\n        }\n\n        return value;\n      }),\n    );\n  } catch (e) {\n    return target;\n  }\n}\n\nfunction useDeepEqualMemo<T>(value: T): T {\n  const [state, setState] = useState<T>(value);\n  const lastValueRef = useRef<T>(value);\n\n  useLayoutEffect(() => {\n    if (\n      !dequal(\n        cloneWithout(value, ['parent']),\n        cloneWithout(lastValueRef.current, ['parent']),\n      )\n    ) {\n      setState(value);\n      lastValueRef.current = value;\n    }\n  }, [value]);\n\n  return state;\n}\n\nfunction generateUniqueId(): string {\n  return Math.floor(Math.random() * 2e6).toString(36);\n}\n\nfunction getSearchValue(textBefore: string) {\n  const segments = ExpressionEditorParserBuiltin.toSegments(textBefore);\n\n  if (!segments) {\n    return '';\n  }\n\n  const lastSegment =\n    segments[segments.length - 1].type ===\n    ExpressionEditorSegmentType.ArrayIndex\n      ? segments[segments.length - 2] // The array index belongs to the previous level and needs to be removed to prevent it from affecting the search value\n      : segments[segments.length - 1];\n  if (\n    !lastSegment ||\n    lastSegment.type !== ExpressionEditorSegmentType.ObjectKey\n  ) {\n    return '';\n  }\n  return lastSegment.objectKey;\n}\n\nexport { useLatest, useDeepEqualMemo, getSearchValue, generateUniqueId };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\n\nimport { ExpressionEditorParserBuiltin } from '@/expression-editor/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '@/expression-editor';\n\nimport styles from './popover.module.less';\n\nconst SKIP_SELECTION_CHANGE_USER_EVENT = 'api.skip-selection-change';\nconst SELECTED_OPTION_CLASSNAME =\n  styles['expression-editor-suggestion-keyboard-selected'];\n\n// modified from:\n// file: packages/workflow/components/src/expression-editor/components/suggestion/hooks.ts\n// method: computeUIOptions\ninterface OptionsInfo {\n  elements: Element[];\n  selectedIndex: number;\n  selectedElement?: Element;\n}\nconst getOptionInfoFromDOM = (\n  root: Element | null,\n): OptionsInfo | undefined => {\n  if (!root) {\n    return;\n  }\n\n  // Get all option elements\n  const foundNodes = root.querySelectorAll(\n    '.semi-tree-option-list .semi-tree-option',\n  );\n\n  if (foundNodes.length === 0) {\n    return;\n  }\n\n  const optionElements = [...foundNodes];\n\n  // Find the currently highlighted option\n  const selectedIndex = optionElements.findIndex(element =>\n    element.classList.contains(SELECTED_OPTION_CLASSNAME),\n  );\n\n  return {\n    elements: optionElements,\n    selectedIndex,\n    selectedElement: optionElements[selectedIndex],\n  };\n};\n\nfunction selectNodeByIndex(elements: Element[], index: number) {\n  const newSelectedElement = elements[index];\n\n  if (!newSelectedElement) {\n    return;\n  }\n\n  // remove old selected class\n  elements.forEach(element => {\n    if (element.classList.contains(SELECTED_OPTION_CLASSNAME)) {\n      element.classList.remove(SELECTED_OPTION_CLASSNAME);\n    }\n  });\n\n  newSelectedElement.classList.add(SELECTED_OPTION_CLASSNAME);\n\n  newSelectedElement.scrollIntoView({\n    behavior: 'smooth',\n    block: 'nearest',\n  });\n}\n\ninterface ApplyNodeOptions {\n  from: number;\n  to: number;\n  textBefore: string;\n}\n\nfunction isLeafNode(node: ExpressionEditorTreeNode) {\n  return !node.variable?.children || node.variable.children.length === 0;\n}\n\nfunction applyNode(\n  editor: ExpressionEditorAPI | undefined,\n  node: ExpressionEditorTreeNode,\n  options: ApplyNodeOptions,\n) {\n  if (!editor) {\n    return;\n  }\n\n  const { from, to, textBefore } = options;\n\n  const text = getInsertTextFromNode(node, textBefore);\n\n  if (!text) {\n    return;\n  }\n\n  editor.replaceTextByRange({\n    from,\n    to,\n    text,\n    cursorOffset: isLeafNode(node) ? '}}'.length : 0,\n    userEvent: SKIP_SELECTION_CHANGE_USER_EVENT,\n  });\n}\n\nfunction isSkipSelectionChangeUserEvent(tr) {\n  return tr.isUserEvent(SKIP_SELECTION_CHANGE_USER_EVENT);\n}\n\nfunction getInsertTextFromNode(\n  node: ExpressionEditorTreeNode,\n  textBefore: string,\n) {\n  const segments = ExpressionEditorParserBuiltin.toSegments(textBefore) ?? [];\n  return ExpressionEditorTreeHelper.concatFullPath({\n    node,\n    segments,\n  });\n}\n\nexport {\n  getOptionInfoFromDOM,\n  applyNode,\n  selectNodeByIndex,\n  isSkipSelectionChangeUserEvent,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ExpressionEditorParserBuiltin } from '@/expression-editor/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '@/expression-editor';\n\nimport { type InterpolationContent } from './types';\n\nfunction isEmpty(value: unknown) {\n  return !value || !Array.isArray(value) || value.length === 0;\n}\n\nfunction useEmptyContent(\n  fullVariableTree: ExpressionEditorTreeNode[] | undefined,\n  variableTree: ExpressionEditorTreeNode[] | undefined,\n  interpolationContent: InterpolationContent | undefined,\n) {\n  return useMemo(() => {\n    if (!interpolationContent) {\n      return;\n    }\n\n    if (isEmpty(fullVariableTree)) {\n      if (interpolationContent.textBefore === '') {\n        return I18n.t('workflow_variable_refer_no_input');\n      }\n      return;\n    }\n\n    if (isEmpty(variableTree)) {\n      if (interpolationContent.text === '') {\n        return I18n.t('workflow_variable_refer_no_input');\n      }\n\n      const segments = ExpressionEditorParserBuiltin.toSegments(\n        interpolationContent.textBefore,\n      );\n\n      if (!segments) {\n        return;\n      }\n\n      const matchTreeBranch = ExpressionEditorTreeHelper.matchTreeBranch({\n        tree: fullVariableTree ?? [],\n        segments,\n      });\n      const isMatchedButEmpty = matchTreeBranch && matchTreeBranch.length !== 0;\n\n      if (isMatchedButEmpty) {\n        return I18n.t('workflow_variable_refer_no_sub_variable');\n      }\n\n      return;\n    }\n    return;\n  }, [fullVariableTree, variableTree, interpolationContent]);\n}\n\nexport { useEmptyContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useLatest } from '../../shared';\n\ntype Keymap = Record<string, (e: KeyboardEvent) => void>;\n\nfunction useKeyboard(enable: boolean, keymap: Keymap) {\n  const keymapRef = useLatest(keymap);\n\n  useEffect(() => {\n    if (!enable) {\n      return;\n    }\n\n    function handleKeydown(e) {\n      const callback = keymapRef.current[e.key];\n      if (typeof callback === 'function') {\n        callback(e);\n      }\n    }\n\n    document.addEventListener('keydown', handleKeydown, false);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeydown, false);\n    };\n  }, [enable]);\n}\n\nexport { useKeyboard };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  type ReactNode,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\n\nimport classNames from 'classnames';\nimport {\n  CursorMirror,\n  useEditor,\n  SelectionSide,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type TreeNodeData } from '@coze-arch/bot-semi/Tree';\nimport { type PopoverProps } from '@coze-arch/bot-semi/Popover';\nimport { Popover as SemiPopover, Tree } from '@coze-arch/bot-semi';\n\nimport { type ExpressionEditorTreeNode } from '@/expression-editor';\n\nimport { generateUniqueId, useDeepEqualMemo, useLatest } from '../shared';\nimport { applyNode, getOptionInfoFromDOM, selectNodeByIndex } from './shared';\nimport {\n  useEmptyContent,\n  useFilteredVariableTree,\n  useFocused,\n  useInterpolationContent,\n  usePrunedVariableTree,\n  useSelection,\n  useTreeRefresh,\n  useTreeSearch,\n  useKeyboard,\n  useOptionsOperations,\n  useSelectedValue,\n} from './hooks';\n\nimport styles from './popover.module.less';\n\ninterface Props {\n  getPopupContainer?: PopoverProps['getPopupContainer'];\n  variableTree: ExpressionEditorTreeNode[];\n  className?: string;\n  onVisibilityChange?: (visible: boolean) => void;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nfunction Popover({\n  getPopupContainer,\n  variableTree: vTree,\n  className,\n  onVisibilityChange,\n}: Props) {\n  const variableTree = useDeepEqualMemo(vTree);\n  const treeRef = useRef<Tree | null>(null);\n  const treeContainerRef = useRef<HTMLDivElement | null>(null);\n  const onVisibilityChangeRef = useLatest(onVisibilityChange);\n  const [posKey, setPosKey] = useState('');\n  const editor = useEditor<ExpressionEditorAPI | undefined>();\n  const editorRef = useLatest(editor);\n  const selection = useSelection(editor);\n  const focused = useFocused(editor);\n  const interpolationContent = useInterpolationContent(\n    editor,\n    selection?.anchor,\n  );\n  const prunedVariableTree = usePrunedVariableTree(\n    editor,\n    variableTree,\n    interpolationContent,\n  );\n  const filteredVariableTree = useFilteredVariableTree(\n    interpolationContent,\n    prunedVariableTree,\n  );\n  const emptyContent = useEmptyContent(\n    variableTree,\n    prunedVariableTree,\n    interpolationContent,\n  );\n  const treeRefreshKey = useTreeRefresh(filteredVariableTree);\n  useTreeSearch(treeRefreshKey, treeRef, interpolationContent, () => {\n    const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n    if (!optionsInfo) {\n      return;\n    }\n    const { elements } = optionsInfo;\n    selectNodeByIndex(elements, 0);\n  });\n  // Selected is only used to display the blue selection effect for the corresponding item of the Tree component, and has no other purpose.\n  const selected = useSelectedValue(interpolationContent?.text, variableTree);\n\n  // Replace content in {{}} based on user selection\n  const handleSelect = useCallback(\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    (_, __, node: TreeNodeData) => {\n      if (!editor || !interpolationContent) {\n        return;\n      }\n\n      applyNode(editor, node as ExpressionEditorTreeNode, interpolationContent);\n    },\n    [editor, interpolationContent],\n  );\n\n  const internalVisible =\n    focused &&\n    ((Boolean(interpolationContent) && filteredVariableTree.length > 0) ||\n      Boolean(emptyContent));\n\n  const [allowVisible, setAllowVisible] = useState(false);\n  // Clear the lock effect when the selection changes\n  useEffect(() => {\n    setAllowVisible(true);\n  }, [selection]);\n\n  const visible = internalVisible && allowVisible;\n\n  const { prev, next, apply } = useOptionsOperations(\n    editor,\n    interpolationContent,\n    treeContainerRef,\n    treeRef,\n  );\n\n  // Press the up and down keys to switch the recommended items, and press Enter to fill in.\n  useKeyboard(visible, {\n    ArrowUp: prev,\n    ArrowDown: next,\n    Enter: apply,\n  });\n\n  // ESC Close\n  useKeyboard(visible, {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Escape() {\n      setAllowVisible(false);\n    },\n  });\n\n  // When the recommendation panel appears, disable the default behavior of ArrowUp/ArrowDown/Enter (the behavior is changed to up and down keys to switch recommendations & enter to insert)\n  useEffect(() => {\n    if (visible === true) {\n      editorRef.current?.disableKeybindings(['ArrowUp', 'ArrowDown', 'Enter']);\n    } else {\n      editorRef.current?.disableKeybindings([]);\n    }\n  }, [visible]);\n\n  useEffect(() => {\n    if (typeof onVisibilityChangeRef.current === 'function') {\n      onVisibilityChangeRef.current(visible);\n    }\n  }, [visible]);\n\n  return (\n    <SemiPopover\n      trigger=\"custom\"\n      visible={visible}\n      keepDOM={true}\n      rePosKey={posKey}\n      getPopupContainer={getPopupContainer}\n      content={\n        <div\n          onMouseDown={e => e.preventDefault()}\n          style={{ display: visible ? 'block' : 'none' }}\n          // The data-attribute is used for other components to ignore some click outside event\n          data-expression-popover\n        >\n          <EmptyContent visible={!!emptyContent} content={emptyContent} />\n          <TreeContainer\n            ref={treeContainerRef}\n            visible={!emptyContent}\n            className={className}\n          >\n            <Tree\n              // key={treeRefreshKey}\n              className={styles['expression-editor-suggestion-tree']}\n              showFilteredOnly\n              filterTreeNode\n              onChangeWithObject\n              ref={treeRef}\n              treeData={prunedVariableTree}\n              searchRender={false}\n              value={selected}\n              emptyContent={null}\n              onSelect={handleSelect}\n            />\n          </TreeContainer>\n        </div>\n      }\n    >\n      <CursorMirror\n        side={SelectionSide.Anchor}\n        onChange={() => setPosKey(generateUniqueId())}\n      />\n    </SemiPopover>\n  );\n}\n\ninterface EmptyContentProps {\n  visible: boolean;\n  content?: string;\n}\n\nfunction EmptyContent({ visible, content }: EmptyContentProps) {\n  return (\n    <div\n      className={styles['expression-editor-suggestion-empty']}\n      style={{ display: visible ? 'block' : 'none' }}\n    >\n      <p>{content}</p>\n    </div>\n  );\n}\n\ninterface TreeContainerProps {\n  visible: boolean;\n  className?: string;\n  children?: ReactNode;\n}\n\nconst TreeContainer = forwardRef<HTMLDivElement, TreeContainerProps>(\n  function TreeContainer({ visible, className, children }, ref) {\n    return (\n      <div\n        className={classNames(\n          className,\n          styles['expression-editor-suggestion'],\n        )}\n        style={{ display: visible ? 'block' : 'none' }}\n        ref={ref}\n      >\n        {children}\n      </div>\n    );\n  },\n);\n\nexport { Popover };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EditorProvider } from '@coze-editor/editor/react';\n\nimport { Renderer } from './renderer';\nimport { Popover } from './popover';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst Expression = {\n  Renderer,\n  Popover,\n  EditorProvider,\n};\n\nexport { Expression };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { Renderer as SDKRenderer } from '@coze-editor/editor/react';\nimport expression, {\n  type EditorAPI as ExpressionEditorAPI,\n} from '@coze-editor/editor/preset-expression';\n\nimport { type ExpressionEditorTreeNode } from '@/expression-editor';\n\nimport { useDeepEqualMemo, useLatest } from '../shared';\nimport { useInputRules, useExtensions } from './hooks';\n\ninterface RendererProps {\n  value?: string;\n  className?: string;\n  readonly?: boolean;\n  placeholder?: string;\n  dataTestID?: string;\n  variableTree: ExpressionEditorTreeNode[];\n  onChange?: (value: string) => void;\n}\n\nfunction Renderer({\n  value,\n  variableTree,\n  className,\n  readonly,\n  placeholder,\n  dataTestID,\n  onChange,\n}: RendererProps) {\n  const apiRef = useRef<ExpressionEditorAPI | null>(null);\n  const variableTreeRef = useLatest<ExpressionEditorTreeNode[] | undefined>(\n    variableTree,\n  );\n  const changedVariableTree = useDeepEqualMemo(variableTree);\n  const inputRules = useInputRules(apiRef);\n  const extensions = useExtensions(variableTreeRef);\n  const contentAttributes = useMemo(\n    () => ({\n      class: `${className ?? ''} flow-canvas-not-draggable`,\n      'data-testid': dataTestID ?? '',\n      'data-flow-editor-selectable': 'false',\n    }),\n    [className, dataTestID],\n  );\n\n  const handleChange = useCallback(\n    (e: { value: string }) => {\n      if (typeof onChange === 'function') {\n        onChange(e.value);\n      }\n    },\n    [onChange],\n  );\n\n  // Note: changedVariableTree is only used for performance optimization\n  // useVariableTree still has issues with the timing of triggering, and scaling the canvas also frequently triggers variableTree changes\n  useEffect(() => {\n    const editor = apiRef.current;\n\n    if (!editor) {\n      return;\n    }\n\n    editor.updateWholeDecorations();\n  }, [changedVariableTree]);\n\n  function handleFocus() {\n    const editor = apiRef.current;\n\n    if (!editor) {\n      return;\n    }\n\n    editor.updateWholeDecorations();\n  }\n\n  // value controlled\n  useEffect(() => {\n    const editor = apiRef.current;\n\n    if (!editor) {\n      return;\n    }\n\n    if (typeof value === 'string' && value !== editor.getValue()) {\n      editor.setValue(value);\n    }\n  }, [value]);\n\n  return (\n    <SDKRenderer\n      plugins={expression}\n      defaultValue={value ?? ''}\n      options={{\n        fontSize: 14,\n        inputRules,\n        readOnly: readonly,\n        placeholder,\n        contentAttributes,\n      }}\n      onFocus={handleFocus}\n      onChange={handleChange}\n      extensions={extensions}\n      didMount={api => (apiRef.current = api)}\n    />\n  );\n}\n\nexport { Renderer };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MutableRefObject, useMemo } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-expression';\nimport { mixLanguages, astDecorator } from '@coze-editor/editor';\nimport { EditorView } from '@codemirror/view';\n\nimport { type ExpressionEditorTreeNode } from '@/expression-editor/type';\n\nimport { validateExpression } from './validate';\n\nfunction useInputRules(apiRef: MutableRefObject<EditorAPI | null>) {\n  return useMemo(\n    () => [\n      {\n        type: 'character' as const,\n        triggerCharacter: '{',\n        handler({ from, to }) {\n          apiRef.current?.replaceTextByRange({\n            from,\n            to,\n            text: '{{}}',\n            cursorOffset: -2,\n          });\n          return true;\n        },\n      },\n    ],\n    [],\n  );\n}\n\ntype Extension =\n  | {\n      extension: Extension;\n    }\n  | readonly Extension[];\n\nfunction useExtensions(\n  variableTreeRef: MutableRefObject<ExpressionEditorTreeNode[] | undefined>,\n): Extension[] {\n  return useMemo(\n    () => [\n      mixLanguages({}),\n      EditorView.baseTheme({\n        '& .cm-line': {\n          padding: 0,\n        },\n        '& .cm-placeholder': {\n          color: 'inherit',\n          opacity: 0.333,\n        },\n        '& .cm-content': {\n          wordBreak: 'break-all',\n        },\n      }),\n      [\n        astDecorator.whole.of((cursor, state) => {\n          if (!variableTreeRef.current) {\n            return;\n          }\n\n          if (\n            cursor.node.type.name === 'Interpolation' &&\n            // Due to the fault tolerance of the parser\n            // It is possible that the missing right curly brace is also parsed normally as Interpolation\n            // Such as: {{variable\n            cursor.node.firstChild?.type.name === '{{' &&\n            cursor.node.lastChild?.type.name === '}}'\n          ) {\n            const source = state.sliceDoc(\n              cursor.node.firstChild.to,\n              cursor.node.lastChild.from,\n            );\n\n            const isValid = validateExpression(source, variableTreeRef.current);\n\n            if (isValid) {\n              return {\n                type: 'className',\n                className: 'cm-decoration-interpolation-valid',\n              };\n            }\n\n            return {\n              type: 'className',\n              className: 'cm-decoration-interpolation-invalid',\n            };\n          }\n        }),\n        EditorView.baseTheme({\n          '& .cm-decoration-interpolation-valid': {\n            color: '#6675D9',\n            caretColor: '#6675D9',\n          },\n          // '& .cm-decoration-interpolation-invalid': {\n          // },\n        }),\n      ],\n      [\n        astDecorator.fromCursor.of((cursor, state) => {\n          const { anchor } = state.selection.main;\n\n          const pos = anchor;\n          if (\n            cursor.node.type.name === 'Interpolation' &&\n            cursor.node.firstChild &&\n            cursor.node.lastChild &&\n            pos >= cursor.node.firstChild.to &&\n            pos <= cursor.node.lastChild.from\n          ) {\n            return {\n              type: 'background',\n              className: 'cm-decoration-interpolation-active',\n              from: cursor.node.firstChild.from,\n              to: cursor.node.lastChild.to,\n            };\n          }\n        }),\n        EditorView.baseTheme({\n          '& .cm-decoration-interpolation-active': {\n            borderRadius: '2px',\n            backgroundColor:\n              'var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))',\n          },\n        }),\n      ],\n    ],\n    [],\n  );\n}\n\nexport { useInputRules, useExtensions };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ExpressionEditorParserBuiltin } from '@/expression-editor/parser';\nimport {\n  ExpressionEditorSegmentType,\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '@/expression-editor';\n\nfunction validateExpression(source: string, tree: ExpressionEditorTreeNode[]) {\n  const segments = ExpressionEditorParserBuiltin.toSegments(source);\n\n  if (!segments) {\n    return false;\n  }\n\n  if (\n    segments[segments.length - 1].type === ExpressionEditorSegmentType.EndEmpty\n  ) {\n    return false;\n  }\n\n  // 2. segments mix variable tree, match tree branch\n  const treeBranch = ExpressionEditorTreeHelper.matchTreeBranch({\n    tree,\n    segments,\n  });\n  if (!treeBranch) {\n    return false;\n  }\n\n  // 3. if full segments path could match one tree branch, the pattern is valid\n  return true;\n}\n\nexport { validateExpression };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type EditorView } from '@codemirror/view';\nimport { syntaxTree } from '@codemirror/language';\n\nimport { type InterpolationContent } from './types';\n\nfunction getInterpolationContentAtPos(view: EditorView, pos: number) {\n  const tree = syntaxTree(view.state);\n  const cursor = tree.cursorAt(pos);\n\n  do {\n    if (\n      cursor.node.type.name === 'Interpolation' &&\n      cursor.node.firstChild &&\n      cursor.node.lastChild &&\n      pos >= cursor.node.firstChild.to &&\n      pos <= cursor.node.lastChild.from\n    ) {\n      const text = view.state.sliceDoc(\n        cursor.node.firstChild.to,\n        cursor.node.lastChild.from,\n      );\n      const offset = pos - cursor.node.firstChild.to;\n      return {\n        from: cursor.node.firstChild.to,\n        to: cursor.node.lastChild.from,\n        text,\n        offset,\n        textBefore: text.slice(0, offset),\n      };\n    }\n  } while (cursor.parent());\n}\n\nfunction useInterpolationContent(\n  editor: ExpressionEditorAPI | undefined,\n  pos: number | undefined,\n): InterpolationContent | undefined {\n  return useMemo(() => {\n    if (!editor || typeof pos === 'undefined') {\n      return;\n    }\n\n    const view = editor.$view;\n    return getInterpolationContentAtPos(view, pos);\n  }, [editor, pos]);\n}\n\nexport { useInterpolationContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\n\nimport { ExpressionEditorParserBuiltin } from '@/expression-editor/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '@/expression-editor';\n\nimport { type InterpolationContent } from './types';\n\nfunction usePrunedVariableTree(\n  editor: ExpressionEditorAPI | undefined,\n  variableTree: ExpressionEditorTreeNode[],\n  interpolationContent: InterpolationContent | undefined,\n): ExpressionEditorTreeNode[] {\n  return useMemo(() => {\n    if (!editor || !interpolationContent) {\n      return [];\n    }\n\n    const segments = ExpressionEditorParserBuiltin.toSegments(\n      interpolationContent.textBefore,\n    );\n\n    if (!segments) {\n      return [];\n    }\n\n    const prunedVariableTree = ExpressionEditorTreeHelper.pruning({\n      tree: variableTree,\n      segments,\n    });\n\n    return prunedVariableTree;\n  }, [editor, variableTree, interpolationContent]);\n}\n\nexport { usePrunedVariableTree };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type ExpressionEditorTreeNode } from '@/expression-editor';\n\nimport { getSearchValue } from '../../shared';\nimport { type InterpolationContent } from './types';\n\nfunction useFilteredVariableTree(\n  interpolationContent: InterpolationContent | undefined,\n  prunedVariableTree: ExpressionEditorTreeNode[],\n) {\n  return useMemo(() => {\n    if (!prunedVariableTree) {\n      return [];\n    }\n\n    if (!interpolationContent) {\n      return prunedVariableTree;\n    }\n\n    const searchValue = getSearchValue(interpolationContent.textBefore);\n\n    return prunedVariableTree.filter(variable =>\n      variable.label.startsWith(searchValue),\n    );\n  }, [interpolationContent, prunedVariableTree]);\n}\n\nexport { useFilteredVariableTree };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, type MutableRefObject } from 'react';\n\nimport { type Tree } from '@coze-arch/bot-semi';\n\nimport { type ExpressionEditorTreeNode } from '@/expression-editor';\n\nimport { generateUniqueId, getSearchValue, useLatest } from '../../shared';\nimport { type InterpolationContent } from './types';\n\n// Force the Tree component to re-render after the data update\nfunction useTreeRefresh(filteredVariableTree: ExpressionEditorTreeNode[]) {\n  const [treeRefreshKey, setTreeRefreshKey] = useState('');\n\n  useEffect(() => {\n    setTreeRefreshKey(generateUniqueId());\n  }, [filteredVariableTree]);\n\n  return treeRefreshKey;\n}\n\n// Search after the Tree component is re-rendered\n// eslint-disable-next-line max-params\nfunction useTreeSearch(\n  treeRefreshKey: string,\n  treeRef: MutableRefObject<Tree | null>,\n  interpolationContent: InterpolationContent | undefined,\n  callback: () => void,\n) {\n  const interpolationContentRef = useLatest(interpolationContent);\n\n  useEffect(() => {\n    if (treeRef.current && interpolationContentRef.current) {\n      const searchValue = getSearchValue(\n        interpolationContentRef.current.textBefore,\n      );\n      treeRef.current.search(searchValue);\n      callback();\n    }\n  }, [treeRefreshKey, interpolationContent]);\n}\n\nexport { useTreeRefresh, useTreeSearch };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { ExpressionEditorParserBuiltin } from '@/expression-editor/parser';\nimport {\n  ExpressionEditorTreeHelper,\n  type ExpressionEditorTreeNode,\n} from '@/expression-editor';\n\nfunction useSelectedValue(\n  interpolationText: string | undefined,\n  variableTree: ExpressionEditorTreeNode[],\n) {\n  return useMemo(() => {\n    if (!interpolationText) {\n      return;\n    }\n\n    const segments =\n      ExpressionEditorParserBuiltin.toSegments(interpolationText);\n\n    if (!segments) {\n      return;\n    }\n\n    const treeBrach = ExpressionEditorTreeHelper.matchTreeBranch({\n      tree: variableTree,\n      segments,\n    });\n\n    if (!treeBrach) {\n      return;\n    }\n\n    return treeBrach[treeBrach.length - 1];\n  }, [interpolationText, variableTree]);\n}\n\nexport { useSelectedValue };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\n\nimport { applyNode, getOptionInfoFromDOM, selectNodeByIndex } from '../shared';\nimport { useLatest } from '../../shared';\nimport { type InterpolationContent } from './types';\n\n// eslint-disable-next-line max-params\nfunction useOptionsOperations(\n  editor: ExpressionEditorAPI | undefined,\n  interpolationContent: InterpolationContent | undefined,\n  treeContainerRef,\n  treeRef,\n) {\n  const editorRef = useLatest(editor);\n  const interpolationContentRef = useLatest(interpolationContent);\n\n  return useMemo(() => {\n    function prev() {\n      const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { elements, selectedIndex } = optionsInfo;\n\n      if (elements.length === 1) {\n        return;\n      }\n\n      const newIndex =\n        selectedIndex - 1 < 0 ? elements.length - 1 : selectedIndex - 1;\n      selectNodeByIndex(elements, newIndex);\n    }\n\n    function next() {\n      const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { elements, selectedIndex } = optionsInfo;\n\n      const newIndex =\n        selectedIndex + 1 >= elements.length ? 0 : selectedIndex + 1;\n      selectNodeByIndex(elements, newIndex);\n    }\n\n    function apply() {\n      if (!interpolationContentRef.current) {\n        return;\n      }\n\n      const optionsInfo = getOptionInfoFromDOM(treeContainerRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { selectedElement } = optionsInfo;\n\n      const selectedDataKey = selectedElement?.getAttribute('data-key');\n\n      if (!selectedDataKey) {\n        return;\n      }\n\n      const variableTreeNode =\n        treeRef.current?.state?.keyEntities?.[selectedDataKey]?.data;\n      if (!variableTreeNode) {\n        return;\n      }\n\n      applyNode(\n        editorRef.current,\n        variableTreeNode,\n        interpolationContentRef.current,\n      );\n    }\n\n    return {\n      prev,\n      next,\n      apply,\n    };\n  }, []);\n}\n\nexport { useOptionsOperations };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { type EditorAPI as ExpressionEditorAPI } from '@coze-editor/editor/preset-expression';\nimport { type ViewUpdate } from '@codemirror/view';\n\nimport { isSkipSelectionChangeUserEvent } from '../shared';\nimport { useLatest } from '../../shared';\n\ninterface Selection {\n  anchor: number;\n  head: number;\n  from: number;\n  to: number;\n}\n\nfunction isSameSelection(a?: Selection, b?: Selection) {\n  if (!a && !b) {\n    return true;\n  }\n\n  return (\n    a &&\n    b &&\n    a.anchor === b.anchor &&\n    a.head === b.head &&\n    a.from === b.from &&\n    a.to === b.to\n  );\n}\n\nfunction useSelection(editor: ExpressionEditorAPI | undefined) {\n  const [selection, setSelection] = useState<Selection | undefined>();\n\n  const selectionRef = useLatest(selection);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    const view = editor.$view;\n\n    function updateSelection(update?: ViewUpdate) {\n      // Ignore the selection change caused by replaceTextByRange (effect: no selection change is triggered, and the recommendation panel is not displayed)\n      if (update?.transactions.some(tr => isSkipSelectionChangeUserEvent(tr))) {\n        setSelection(undefined);\n        return;\n      }\n\n      const { from, to, anchor, head } = view.state.selection.main;\n      const newSelection = { from, to, anchor, head };\n      if (isSameSelection(newSelection, selectionRef.current)) {\n        return;\n      }\n\n      setSelection({ from, to, anchor, head });\n    }\n\n    function handleSelectionChange(e: { update: ViewUpdate }) {\n      updateSelection(e.update);\n    }\n\n    function handleFocus() {\n      updateSelection();\n    }\n\n    editor.$on('selectionChange', handleSelectionChange);\n    editor.$on('focus', handleFocus);\n\n    return () => {\n      editor.$off('selectionChange', handleSelectionChange);\n      editor.$off('focus', handleFocus);\n    };\n  }, [editor]);\n\n  return selection;\n}\n\nexport { useSelection };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nfunction useFocused(editor) {\n  const [focused, setFocused] = useState(false);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    function handleFocus() {\n      setFocused(true);\n    }\n\n    function handleBlur() {\n      setFocused(false);\n    }\n\n    editor.$on('focus', handleFocus);\n    editor.$on('blur', handleBlur);\n\n    return () => {\n      editor.$off('focus', handleFocus);\n      editor.$off('blur', handleBlur);\n    };\n  }, [editor]);\n\n  return focused;\n}\n\nexport { useFocused };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ProductDraftStatus,\n  SchemaType,\n  type FrontWorkflowInfo,\n} from '@coze-workflow/base';\nimport { type ResourceInfo } from '@coze-arch/bot-api/plugin_develop';\n\nimport { type WorkflowResourceBizExtend } from './type';\n\nexport const parseWorkflowResourceBizExtend = (\n  bizExtend?: Record<string, string>,\n): WorkflowResourceBizExtend | undefined => {\n  if (!bizExtend) {\n    return undefined;\n  }\n  return {\n    product_draft_status:\n      bizExtend.product_draft_status !== undefined\n        ? parseInt(bizExtend.product_draft_status || '0')\n        : ProductDraftStatus.Default,\n    external_flow_info: bizExtend.external_flow_info,\n    schema_type:\n      bizExtend.schema_type !== undefined\n        ? parseInt(bizExtend.schema_type || '0')\n        : SchemaType.DAG,\n    plugin_id: bizExtend.plugin_id,\n    icon_uri: bizExtend.icon_uri,\n    url: bizExtend.url,\n  };\n};\n/**\n * Convert ResourceInfo to WorkflowInfoLocal structure required to edit workflow\n * @param resource\n */\nexport const transformResourceToWorkflowEditInfo = (\n  resource: ResourceInfo,\n): Pick<\n  FrontWorkflowInfo,\n  | 'workflow_id'\n  | 'url'\n  | 'icon_uri'\n  | 'name'\n  | 'desc'\n  | 'schema_type'\n  | 'external_flow_info'\n  | 'space_id'\n> => {\n  const bizExtend = parseWorkflowResourceBizExtend(resource.biz_extend);\n  return {\n    workflow_id: resource.res_id,\n    url: bizExtend?.url,\n    icon_uri: bizExtend?.icon_uri,\n    name: resource.name,\n    desc: resource.desc,\n    schema_type: bizExtend?.schema_type,\n    external_flow_info: bizExtend?.external_flow_info,\n    space_id: resource.space_id,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { WorkflowMode } from '@coze-workflow/base';\nimport { AddWorkflowToStoreEntry } from '@coze-arch/bot-tea';\nimport { type ResourceInfo, ResType } from '@coze-arch/bot-api/plugin_develop';\nimport {\n  PublishWorkflowModal,\n  usePublishWorkflowModal,\n} from '@coze-workflow/resources-adapter';\n\nimport { type CommonActionProps, type PublishActionReturn } from './type';\n\nexport const usePublishAction = ({\n  spaceId = '',\n  refreshPage,\n}: CommonActionProps): PublishActionReturn => {\n  const [flowMode, setFlowMode] = useState<WorkflowMode>(WorkflowMode.Workflow);\n  const publishWorkflowModalHook = usePublishWorkflowModal({\n    onPublishSuccess: () => {\n      refreshPage?.();\n    },\n    fromSpace: true,\n    flowMode,\n  });\n\n  /**\n   * NOTICE: This function is maintained by the store side, you can contact @gaoding.\n   * Release/Update Process Product\n   */\n  const onPublishStore = (item: ResourceInfo) => {\n    setFlowMode(\n      item.res_type === ResType.Imageflow\n        ? WorkflowMode.Imageflow\n        : WorkflowMode.Workflow,\n    );\n    // The store rendering process requires spaceId information, and in this scene, the corresponding information needs to be set manually\n    publishWorkflowModalHook.setSpace(spaceId);\n    publishWorkflowModalHook.showModal({\n      type: PublishWorkflowModal.WORKFLOW_INFO,\n      product: {\n        meta_info: {\n          entity_id: item.res_id,\n          name: item.name,\n        },\n      },\n      source: AddWorkflowToStoreEntry.WORKFLOW_PERSONAL_LIST,\n    });\n  };\n  return {\n    actionHandler: onPublishStore,\n    publishModal: publishWorkflowModalHook.ModalComponent,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState } from 'react';\n\nimport { DeleteAction, DeleteType, workflowApi } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { type ResourceInfo, ResType } from '@coze-arch/bot-api/plugin_develop';\nimport { Modal, Toast } from '@coze-arch/coze-design';\n\nimport { reporter, wait } from '@/utils';\n\nimport {\n  type CommonActionProps,\n  type DeleteActionReturn,\n  type DeleteModalConfig,\n} from './type';\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport const useDeleteAction = (\n  props: CommonActionProps,\n): DeleteActionReturn => {\n  const { spaceId, userId, refreshPage } = props;\n  const [modalVisible, setModalVisible] = useState(false);\n  const [deleteModalConfig, setDeleteModalConfig] =\n    useState<DeleteModalConfig>();\n  /**\n   * Logic comes from useWorkflowList (@code-workflow/components), no longer reused because imported parameters have changed\n   * @param item\n   */\n  const handleDeleteWorkflowResource = async (item: ResourceInfo) => {\n    if (!item.res_id || !spaceId) {\n      throw new CustomError('normal_error', 'miss workflowId or spaceID');\n    }\n\n    reporter.info({\n      message: 'workflow_list_delete_row',\n      meta: {\n        workflowId: item.res_id,\n      },\n    });\n\n    let deleteType = DeleteType.CanDelete;\n\n    // Delete mode from server level query\n    const resp = await workflowApi.GetDeleteStrategy({\n      space_id: spaceId,\n      workflow_id: item.res_id,\n    });\n    deleteType = resp.data;\n\n    const canDelete = [\n      DeleteType.CanDelete,\n      DeleteType.RejectProductDraft,\n    ].includes(deleteType);\n\n    const deleteFuc = async (deleteParams?: {\n      needDeleteBlockwise: boolean;\n    }) => {\n      const needDeleteBlockwise = deleteParams?.needDeleteBlockwise;\n      const action = needDeleteBlockwise\n        ? DeleteAction.BlockwiseDelete\n        : DeleteAction.BlockwiseUnbind;\n\n      if (!item.res_id || !spaceId) {\n        throw new CustomError('normal_error', 'miss workflowId or spaceID');\n      }\n      try {\n        await workflowApi.DeleteWorkflow({\n          space_id: spaceId,\n          workflow_id: item.res_id,\n          action,\n        });\n\n        Toast.success({\n          content: I18n.t('workflow_add_delete_success'),\n          showClose: false,\n        });\n\n        reporter.info({\n          message: 'workflow_list_delete_row_success',\n        });\n\n        // Bottom line leader/follower delay\n        await wait(300);\n\n        // refresh list\n        refreshPage?.();\n      } catch (error) {\n        reporter.error({\n          message: 'workflow_list_delete_row_fail',\n          error,\n        });\n        Toast.error({\n          content: I18n.t('workflow_add_delete_fail'),\n          showClose: false,\n        });\n      }\n    };\n    return {\n      canDelete,\n      deleteType,\n      handleDelete: canDelete ? deleteFuc : undefined,\n    };\n  };\n\n  const deleteAction = async (record: ResourceInfo) => {\n    const isSelfCreator = record.creator_id === userId;\n    const deleteConfig = await handleDeleteWorkflowResource(record);\n    let title = I18n.t('delete_title');\n    if (deleteConfig.deleteType === DeleteType.UnListProduct) {\n      title = I18n.t('workflowstore_unable_to_delete_workflow');\n    }\n\n    let desc = I18n.t('library_delete_desc');\n    if (deleteConfig.deleteType === DeleteType.UnListProduct) {\n      if (isSelfCreator) {\n        desc = I18n.t('workflowstore_the_workflow_has_been');\n      } else {\n        desc = I18n.t('workflowstore_delete_permission');\n      }\n    }\n\n    let okText = deleteConfig.canDelete\n      ? I18n.t('confirm')\n      : I18n.t('workflowstore_remove_wf');\n    if (\n      deleteConfig.deleteType === DeleteType.UnListProduct &&\n      !isSelfCreator\n    ) {\n      okText = '';\n    }\n\n    let cancelText = I18n.t('cancel');\n    if (\n      deleteConfig.deleteType === DeleteType.UnListProduct &&\n      !isSelfCreator\n    ) {\n      cancelText = I18n.t('confirm');\n    }\n\n    setDeleteModalConfig({\n      title,\n      desc,\n      cancelText,\n      okText,\n      okHandle: () => {\n        if (deleteConfig.canDelete) {\n          deleteConfig?.handleDelete?.({\n            needDeleteBlockwise: false,\n          });\n        } else {\n          if (\n            deleteConfig.deleteType === DeleteType.UnListProduct &&\n            isSelfCreator\n          ) {\n            window.open(\n              `/store/${\n                record.res_type === ResType.Workflow ? 'workflow' : 'imageflow'\n              }/${record.res_id}?entity_id=true`,\n              '_blank',\n            );\n          }\n        }\n      },\n    });\n    setModalVisible(true);\n  };\n  const deleteModal = (\n    <Modal\n      maskClosable={false}\n      centered={true}\n      visible={modalVisible}\n      title={deleteModalConfig?.title ?? ''}\n      onOk={() => {\n        setModalVisible(false);\n        deleteModalConfig?.okHandle();\n      }}\n      onCancel={() => {\n        setModalVisible(false);\n      }}\n      closeOnEsc={true}\n      cancelText={deleteModalConfig?.cancelText}\n      okText={deleteModalConfig?.okText}\n      okButtonColor={'red'}\n    >\n      <div className=\"coz-common-content\">{deleteModalConfig?.desc ?? ''}</div>\n    </Modal>\n  );\n  return { deleteModal, actionHandler: deleteAction };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { workflowApi } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { type ResourceInfo, ResType } from '@coze-arch/bot-api/plugin_develop';\nimport { useNavigate } from 'react-router-dom';\n\nimport { reporter, wait } from '@/utils';\n\nimport { type CommonActionProps, type CommonActionReturn } from './type';\n\nexport const useCopyAction = (props: CommonActionProps): CommonActionReturn => {\n  const { spaceId } = props;\n  const navigate = useNavigate();\n  // copy\n  const handleCopy = async (item: ResourceInfo) => {\n    if (!item.res_id || !spaceId) {\n      throw new CustomError('normal_error', 'miss workflowId or spaceID');\n    }\n\n    reporter.info({\n      message: 'workflow_list_copy_row',\n      meta: {\n        workflowId: item.res_id,\n      },\n    });\n\n    try {\n      let isError = false;\n      const { data } = await workflowApi.CopyWorkflow({\n        space_id: spaceId,\n        workflow_id: item.res_id,\n      });\n      isError = !data?.workflow_id;\n\n      if (isError) {\n        Toast.error(I18n.t('workflow_detail_toast_createcopy_failed'));\n        reporter.error({\n          message: 'workflow_list_copy_row_fail',\n          error: new CustomError('normal_error', 'result no workflow'),\n        });\n        return;\n      }\n\n      Toast.success({\n        content:\n          item.res_type === ResType.Imageflow\n            ? I18n.t('imageflow_detail_toast_createcopy_succeed')\n            : I18n.t('workflow_detail_toast_createcopy_succeed'),\n        showClose: false,\n      });\n\n      reporter.info({\n        message: 'workflow_list_copy_row_success',\n        meta: {\n          workflowId: item.res_id,\n        },\n      });\n\n      // Bottom line leader/follower delay\n      await wait(300);\n      // After copying, jump to the details page\n      navigate(\n        `/work_flow?workflow_id=${data.workflow_id}&space_id=${spaceId}`,\n      );\n    } catch (error) {\n      reporter.error({\n        message: 'workflow_list_copy_row_fail',\n        error,\n      });\n      Toast.error(I18n.t('workflow_detail_toast_createcopy_failed'));\n    }\n  };\n  return { actionHandler: handleCopy };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { workflowApi } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { WorkflowMode } from '@coze-arch/bot-api/workflow_api';\nimport { type ResourceInfo } from '@coze-arch/bot-api/plugin_develop';\nexport const useChatflowSwitch = ({\n  spaceId,\n  refreshPage,\n}: {\n  spaceId: string;\n  refreshPage?: () => void;\n}) => {\n  const changeFlowMode = async (flowMode: WorkflowMode, workflowId: string) => {\n    await workflowApi.UpdateWorkflowMeta({\n      space_id: spaceId,\n      workflow_id: workflowId,\n      flow_mode: flowMode,\n    });\n    Toast.success(\n      I18n.t('wf_chatflow_123', {\n        Chatflow: I18n.t(\n          flowMode === WorkflowMode.ChatFlow ? 'wf_chatflow_76' : 'Workflow',\n        ),\n      }),\n    );\n    await new Promise(resolve => setTimeout(resolve, 300));\n    refreshPage?.();\n  };\n  const switchToWorkflow = async (record: ResourceInfo) =>\n    changeFlowMode(WorkflowMode.Workflow, record.res_id ?? '');\n  const switchToChatflow = async (record: ResourceInfo) =>\n    changeFlowMode(WorkflowMode.ChatFlow, record.res_id ?? '');\n  return { switchToWorkflow, switchToChatflow };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ReactNode } from 'react';\n\nimport {\n  ProductDraftStatus,\n  type FrontWorkflowInfo,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Table, type TableActionProps } from '@coze-arch/coze-design';\nimport { useFlags } from '@coze-arch/bot-flags';\nimport {\n  resource_resource_common,\n  type ResourceInfo,\n  ResType,\n} from '@coze-arch/bot-api/plugin_develop';\n\nimport {\n  parseWorkflowResourceBizExtend,\n  transformResourceToWorkflowEditInfo,\n} from './utils';\nimport { useWorkflowPublishEntry } from './use-workflow-publish-entry';\nimport { usePublishAction } from './use-publish-action';\nimport { useDeleteAction } from './use-delete-action';\nimport { useCopyAction } from './use-copy-action';\nimport { useChatflowSwitch } from './use-chatflow-switch';\nimport {\n  type WorkflowResourceActionProps,\n  type WorkflowResourceActionReturn,\n} from './type';\n\nconst { ActionKey } = resource_resource_common;\n\ntype ActionItemProps = NonNullable<TableActionProps['actionList']>[number];\n\nexport const useWorkflowResourceMenuActions = (\n  props: WorkflowResourceActionProps & {\n    userId?: string;\n    onEditWorkflowInfo: (partialWorkflowInfo: FrontWorkflowInfo) => void;\n  },\n): Pick<WorkflowResourceActionReturn, 'renderWorkflowResourceActions'> & {\n  modals: ReactNode[];\n} => {\n  const [FLAGS] = useFlags();\n  const { userId, onEditWorkflowInfo, getCommonActions } = props;\n  const { actionHandler: deleteAction, deleteModal } = useDeleteAction(props);\n  const { actionHandler: copyAction } = useCopyAction(props);\n  const { actionHandler: publishAction, publishModal } =\n    usePublishAction(props);\n  const { switchToChatflow, switchToWorkflow } = useChatflowSwitch({\n    spaceId: props.spaceId ?? '',\n    refreshPage: props.refreshPage,\n  });\n  const actionMap = {\n    [ActionKey.Copy]: copyAction,\n    [ActionKey.Delete]: deleteAction,\n    [ActionKey.Edit]: (record: ResourceInfo) => {\n      const workflowPartialInfo = transformResourceToWorkflowEditInfo(record);\n      onEditWorkflowInfo(workflowPartialInfo as FrontWorkflowInfo);\n    },\n    [ActionKey.SwitchToFuncflow]: switchToWorkflow,\n    [ActionKey.SwitchToChatflow]: switchToChatflow,\n  };\n\n  const { enablePublishEntry } = useWorkflowPublishEntry();\n  // eslint-disable-next-line complexity\n  const renderWorkflowResourceActions = (record: ResourceInfo): ReactNode => {\n    const bizExtend = parseWorkflowResourceBizExtend(record.biz_extend);\n    const productDraftStatus = bizExtend?.product_draft_status;\n    const isImageFlow = record.res_type === ResType.Imageflow;\n    const { actions } = record;\n    const deleteActionConfig = actions?.find(\n      action => action.key === ActionKey.Delete,\n    );\n    const copyActionConfig = actions?.find(\n      action => action.key === ActionKey.Copy,\n    );\n    const editConfig = actions?.find(action => action.key === ActionKey.Edit);\n    const chatflowConfig = actions?.find(\n      action => action.key === ActionKey.SwitchToChatflow,\n    );\n    const workflowConfig = actions?.find(\n      action => action.key === ActionKey.SwitchToFuncflow,\n    );\n\n    const isSelfCreator = record.creator_id === userId;\n    const extraActions: ActionItemProps[] = [\n      {\n        hide: !editConfig,\n        disabled: editConfig?.enable === false,\n        actionKey: 'edit',\n        actionText: I18n.t('Edit'),\n        handler: () => actionMap?.[ActionKey.Edit]?.(record),\n      },\n      {\n        hide: !chatflowConfig,\n        disabled: chatflowConfig?.enable === false,\n        actionKey: 'switchChatflow',\n        actionText: I18n.t('wf_chatflow_121', {\n          flowMode: I18n.t('wf_chatflow_76'),\n        }),\n        handler: () => actionMap?.[ActionKey.SwitchToChatflow]?.(record),\n      },\n      {\n        hide: !workflowConfig,\n        disabled: workflowConfig?.enable === false,\n        actionKey: 'switchWorkflow',\n        actionText: I18n.t('wf_chatflow_121', { flowMode: I18n.t('Workflow') }),\n        handler: () => actionMap?.[ActionKey.SwitchToFuncflow]?.(record),\n      },\n      ...(getCommonActions?.(record) ?? []),\n      {\n        hide:\n          !enablePublishEntry || // The entrance on the shelf is white.\n          (!FLAGS['bot.community.store_imageflow'] && isImageFlow) || // Imageflow does not support stores\n          !isSelfCreator ||\n          bizExtend?.plugin_id === '0',\n        actionKey: 'publishWorkflowProduct',\n        actionText:\n          productDraftStatus === ProductDraftStatus.Default\n            ? I18n.t('workflowstore_submit')\n            : I18n.t('workflowstore_submit_update'),\n        handler: () => {\n          publishAction?.(record);\n        },\n      },\n    ];\n    return (\n      <Table.TableAction\n        deleteProps={{\n          hide: !deleteActionConfig,\n          disabled: deleteActionConfig?.enable === false,\n          disableConfirm: true,\n          handler: () => actionMap[ActionKey.Delete]?.(record),\n        }}\n        copyProps={{\n          hide: !copyActionConfig,\n          disabled: copyActionConfig?.enable === false,\n          handler: () => actionMap[ActionKey.Copy]?.(record),\n        }}\n        actionList={extraActions}\n      />\n    );\n  };\n  return { renderWorkflowResourceActions, modals: [deleteModal, publishModal] };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ResourceInfo } from '@coze-arch/bot-api/plugin_develop';\nimport { useNavigate } from 'react-router-dom';\n\nimport { reporter } from '@/utils';\n\nexport const useWorkflowResourceClick = (spaceId?: string) => {\n  const navigate = useNavigate();\n\n  const onEditWorkFlow = (workflowId?: string) => {\n    reporter.info({\n      message: 'workflow_list_edit_row',\n      meta: {\n        workflowId,\n      },\n    });\n    goWorkflowDetail(workflowId, spaceId);\n  };\n\n  /** Open the process edit page */\n  const goWorkflowDetail = (workflowId?: string, sId?: string) => {\n    if (!workflowId || !sId) {\n      return;\n    }\n    reporter.info({\n      message: 'workflow_list_navigate_to_detail',\n      meta: {\n        workflowId,\n      },\n    });\n\n    navigate(`/work_flow?workflow_id=${workflowId}&space_id=${sId}`);\n  };\n  const handleWorkflowResourceClick = (record: ResourceInfo) => {\n    reporter.info({\n      message: 'workflow_list_click_row',\n    });\n    onEditWorkFlow(record?.res_id);\n  };\n\n  return { handleWorkflowResourceClick, goWorkflowDetail };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useState } from 'react';\n\nimport { useBoolean } from 'ahooks';\nimport {\n  type FrontWorkflowInfo,\n  WorkflowMode,\n  isGeneralWorkflow,\n  type BindBizType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { useFlags } from '@coze-arch/bot-flags';\nimport { CustomError } from '@coze-arch/bot-error';\n\nimport { DataSourceType, WorkflowModalFrom } from '@/workflow-modal';\nimport { CreateWorkflowModal, type RuleItem } from '@/workflow-edit';\nimport { reporter } from '@/utils';\nimport { useWorkflowModal } from '@/hooks/use-workflow-modal';\n\nimport { type WorkflowResourceActionProps } from './type';\n\nexport const useCreateWorkflowModal = ({\n  from = WorkflowModalFrom.SpaceWorkflowList,\n  bindBizType,\n  bindBizId,\n  refreshPage,\n  spaceId,\n  goWorkflowDetail,\n  projectId,\n  onCreateSuccess,\n  hiddenTemplateEntry,\n  nameValidators,\n}: WorkflowResourceActionProps & {\n  from?: WorkflowModalFrom;\n  /** The current project id, only the workflow within the project has this field */\n  projectId?: string;\n  bindBizType?: BindBizType;\n  bindBizId?: string;\n  onCreateSuccess?: ({ workflowId }: { workflowId: string }) => void;\n  goWorkflowDetail?: (workflowId?: string, spaceId?: string) => void;\n  /** Hide entry created through template */\n  hiddenTemplateEntry?: boolean;\n  nameValidators?: RuleItem[];\n}) => {\n  const [currentWorkflow, setCurrentWorkflow] = useState<FrontWorkflowInfo>();\n  const [formMode, setFormMode] = useState<'add' | 'update'>('add');\n  const [flowMode, setFlowMode] = useState<WorkflowMode>(WorkflowMode.Workflow);\n  const [createModalVisible, { setTrue, setFalse: closeCreateModal }] =\n    useBoolean(false);\n\n  const [FLAGS] = useFlags();\n\n  const openCreateModal = (mode?: WorkflowMode) => {\n    setFormMode('add');\n    setFlowMode(mode || WorkflowMode.Workflow);\n    reporter.info({\n      message: 'workflow_list_open_create_modal',\n    });\n    setTrue();\n  };\n\n  const openEditModal = () => {\n    setFormMode('update');\n    reporter.info({\n      message: 'workflow_list_open_create_modal',\n    });\n    setTrue();\n  };\n\n  const handleEditWorkflow = (partialWorkflowInfo: FrontWorkflowInfo) => {\n    setCurrentWorkflow(partialWorkflowInfo);\n    setFlowMode(partialWorkflowInfo.flow_mode || WorkflowMode.Workflow);\n    openEditModal();\n  };\n\n  const workflowModalInitState = useMemo(() => {\n    // Support soon, so stay tuned.\n    if (isWorkflowMode || FLAGS['bot.community.store_imageflow']) {\n      return {\n        productCategory: 'all',\n        isSpaceWorkflow: false,\n        dataSourceType: DataSourceType.Product,\n      };\n    }\n    return {\n      workflowTag: 1,\n      isSpaceWorkflow: false,\n      dataSource: DataSourceType.Workflow,\n    };\n  }, [FLAGS, flowMode]);\n\n  const { node: workflowModal } = useWorkflowModal({\n    from,\n    flowMode,\n    dupText: I18n.t('Copy'),\n    hiddenCreate: true,\n    hiddenSpaceList: true,\n    initState: workflowModalInitState,\n    projectId,\n    onAdd: () => {\n      refreshPage?.();\n    },\n    onDupSuccess: val => {\n      window.open(\n        `/work_flow?space_id=${spaceId}&workflow_id=${val.workflow_id}&from=dupSuccess`,\n      );\n    },\n  });\n\n  const isWorkflowMode = useMemo(() => isGeneralWorkflow(flowMode), [flowMode]);\n\n  return {\n    openCreateModal,\n    handleEditWorkflow,\n    workflowModal,\n    createWorkflowModal: (\n      <CreateWorkflowModal\n        initConfirmDisabled\n        mode={formMode}\n        flowMode={flowMode}\n        projectId={projectId}\n        visible={createModalVisible}\n        onCancel={closeCreateModal}\n        bindBizType={bindBizType}\n        bindBizId={bindBizId}\n        workFlow={formMode === 'update' ? currentWorkflow : undefined}\n        getLatestWorkflowJson={undefined}\n        customTitleRender={undefined}\n        onSuccess={({ workflowId }) => {\n          closeCreateModal();\n          if (!workflowId) {\n            throw new CustomError(\n              '[Workflow] create failed',\n              'create workflow failed, no workflow id',\n            );\n          }\n\n          if (onCreateSuccess && formMode === 'add') {\n            onCreateSuccess({ workflowId });\n            return;\n          }\n          // Edit mode, do not jump, refresh the current list\n          if (formMode === 'update') {\n            refreshPage?.();\n            return;\n          }\n\n          const navigateDelay = 500;\n          //  Due to slow back-end data synchronization, there is a delay of 500 ms\n          setTimeout(() => {\n            goWorkflowDetail?.(workflowId, spaceId);\n          }, navigateDelay);\n        }}\n        spaceID={spaceId}\n        nameValidators={nameValidators}\n      />\n    ),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWorkflowResourceMenuActions } from './use-workflow-resource-menu-actions';\nimport { useWorkflowResourceClick } from './use-workflow-resource-click';\nimport { useCreateWorkflowModal } from './use-create-workflow-modal';\nimport {\n  type UseWorkflowResourceAction,\n  type WorkflowResourceActionProps,\n  type WorkflowResourceActionReturn,\n} from './type';\nexport { useWorkflowPublishEntry } from './use-workflow-publish-entry';\nexport const useWorkflowResourceAction: UseWorkflowResourceAction = props => {\n  const { spaceId, userId, getCommonActions } = props;\n  const { handleWorkflowResourceClick, goWorkflowDetail } =\n    useWorkflowResourceClick(spaceId);\n  const {\n    openCreateModal,\n    workflowModal,\n    createWorkflowModal,\n    handleEditWorkflow,\n  } = useCreateWorkflowModal({ ...props, goWorkflowDetail });\n  const { renderWorkflowResourceActions, modals } =\n    useWorkflowResourceMenuActions({\n      ...props,\n      userId,\n      onEditWorkflowInfo: handleEditWorkflow,\n      getCommonActions,\n    });\n\n  return {\n    workflowResourceModals: [createWorkflowModal, workflowModal, ...modals],\n    openCreateModal,\n    handleWorkflowResourceClick,\n    renderWorkflowResourceActions,\n  };\n};\n\nexport {\n  type WorkflowResourceActionProps,\n  type WorkflowResourceActionReturn,\n  useCreateWorkflowModal,\n  useWorkflowResourceClick,\n  useWorkflowResourceMenuActions,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\n\nimport { useRequest } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozPauseFill,\n  IconCozPlus,\n  IconCozTrashCan,\n  IconCozVolume,\n} from '@coze-arch/coze-design/icons';\nimport { Avatar, Button, IconButton } from '@coze-arch/coze-design';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { type VoiceDetail } from '@coze-arch/bot-api/multimedia_api';\nimport { MultimediaApi } from '@coze-arch/bot-api';\nimport {\n  useSelectVoiceModal,\n  useAudioPlayer,\n} from '@coze-workflow/resources-adapter';\n\ninterface CardProps {\n  voice: VoiceDetail | null;\n  onDelete?: () => void;\n  disabled?: boolean;\n}\n\nconst VoiceCard = ({ voice, onDelete, disabled }: CardProps) => {\n  const { isPlaying, togglePlayPause } = useAudioPlayer(voice?.preview_audio);\n\n  if (!voice) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        backgroundColor: 'var(--coz-mg-card-hovered)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        width: '100%',\n        height: '44px',\n        border: '1px solid var(--coz-stroke-primary)',\n        padding: '6px',\n        borderRadius: 'var(--coze-8)',\n        cursor: 'pointer',\n      }}\n    >\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n        }}\n      >\n        <Avatar shape={'square'} size=\"small\" src={voice.icon_url} />\n\n        <span style={{ marginLeft: '8px', marginRight: '2px' }}>\n          {voice.voice_name}\n        </span>\n\n        {isPlaying ? (\n          <IconButton\n            theme={'borderless'}\n            disabled={disabled}\n            onClick={togglePlayPause}\n            size=\"small\"\n            color=\"secondary\"\n            icon={<IconCozPauseFill color=\"#4E40E5\" />}\n          />\n        ) : (\n          <IconButton\n            theme={'borderless'}\n            disabled={disabled}\n            onClick={togglePlayPause}\n            size=\"small\"\n            color=\"secondary\"\n            icon={<IconCozVolume color=\"#4E40E5\" />}\n          />\n        )}\n      </div>\n\n      <IconButton\n        disabled={disabled}\n        onClick={onDelete}\n        size=\"small\"\n        color=\"secondary\"\n        icon={<IconCozTrashCan />}\n      />\n    </div>\n  );\n};\n\nconst useVoiceSource = (id?: string) => {\n  const [voice, setVoice] = useState<VoiceDetail | null | undefined>(null);\n\n  const { loading } = useRequest(\n    () => {\n      if (!id) {\n        return Promise.resolve(null).then(() => {\n          setVoice(null);\n          return null;\n        });\n      }\n\n      return MultimediaApi.APIMGetVoice({\n        voice_ids: [id],\n      })\n        .then(data => {\n          const v = data?.data?.voices?.[0];\n          setVoice(data?.data?.voices?.[0]);\n          return v;\n        })\n        .catch(() => {\n          setVoice(null);\n          return null;\n        });\n    },\n    {\n      refreshDeps: [id],\n    },\n  );\n\n  return {\n    voice,\n    setVoice,\n    loading,\n  };\n};\n\ninterface Props {\n  value?: string;\n  onChange?: (v?: string) => void;\n  disabled?: boolean;\n}\n\nconst VoiceSelect: React.FC<Props> = props => {\n  const { value, onChange, disabled } = props;\n  const [voiceId, setVoiceId] = useState<string | undefined>(value);\n  const spaceId = useSpaceStore(store => store.space.id) || '';\n\n  const { voice, setVoice } = useVoiceSource(voiceId);\n\n  useEffect(() => {\n    setVoiceId(value);\n  }, [value]);\n\n  const { open: openSelectVoiceModal, modal: selectVoiceModal } =\n    useSelectVoiceModal({\n      spaceId,\n      onSelectVoice: v => {\n        setVoice(v);\n        onChange?.(v.voice_id);\n      },\n    });\n\n  return (\n    <>\n      {!voice?.voice_id ? (\n        <Button\n          disabled={disabled}\n          style={{ width: '100%', fontWeight: '500' }}\n          size={'small'}\n          icon={<IconCozPlus />}\n          color=\"primary\"\n          onClick={openSelectVoiceModal}\n        >\n          {I18n.t('workflow_variable_select_voice')}\n        </Button>\n      ) : (\n        <VoiceCard\n          disabled={disabled}\n          voice={voice}\n          onDelete={() => {\n            setVoice(null);\n            onChange?.(undefined);\n          }}\n        />\n      )}\n\n      {selectVoiceModal}\n    </>\n  );\n};\n\nexport { VoiceSelect };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ResourceActionAuth,\n  type Workflow,\n} from '@coze-workflow/base/api';\n\ninterface Auth {\n  authInfo: ResourceActionAuth;\n}\n\nexport type WorkflowInfo = Workflow & Auth;\n\n/**\n * Open the pop-up scene, mainly for logging\n *\n * WorkflowAddNode scenes have special handling\n */\nexport enum WorkflowModalFrom {\n  /** Process details Add subprocess */\n  WorkflowAddNode = 'workflow_addNode',\n  /** Open in bot skills */\n  BotSkills = 'bot_skills',\n  /** Open ide in Douyin doppelganger scene */\n  BotSkillsDouyin = 'bot_skills_douyin_ide',\n  /** Open in bot multi-agent skills */\n  BotMultiSkills = 'bot_multi_skills',\n  /** Open in bot triggers  */\n  BotTrigger = 'bot_trigger',\n  /** Bot shortcut open */\n  BotShortcut = 'bot_shortcut',\n  /** process list under space */\n  SpaceWorkflowList = 'space_workflow_list',\n  /** From workflow as agent */\n  WorkflowAgent = 'workflow_agent',\n  /** Social scene workflow list */\n  SocialSceneHost = 'social_scene_host',\n  /** project import repository file */\n  ProjectImportLibrary = 'project_import_library',\n  /** Add subflow to workflow canvas in project */\n  ProjectWorkflowAddNode = 'project_workflow_addNode',\n  /**\n   * List of workflow resources in the project Add workflow resources\n   */\n  ProjectAddWorkflowResource = 'project_add_workflow_resource',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport dayjs from 'dayjs';\n\nlet getIsIPadCache: boolean | undefined;\n/**\n * Code provided by gpt-4\n */\nexport const getIsIPad = () => {\n  if (typeof getIsIPadCache === 'undefined') {\n    const { userAgent } = navigator;\n    const isIPadDevice = /iPad/.test(userAgent);\n    const isIPadOS =\n      userAgent.includes('Macintosh') &&\n      'ontouchstart' in document.documentElement;\n\n    getIsIPadCache = isIPadDevice || isIPadOS;\n  }\n\n  return getIsIPadCache;\n};\n\n/* Timestamp converts text and omits the year or date*/\nexport const formatOmittedDateTime = time => {\n  if (!time) {\n    return '';\n  }\n\n  const day = dayjs(time);\n  const today = dayjs();\n\n  let formatStr: string;\n\n  if (!today.isSame(day, 'year')) {\n    // Not the year, show the year\n    formatStr = 'YYYY-MM-DD HH:mm';\n  } else if (!today.isSame(day, 'day')) {\n    // Not the day, the display date.\n    formatStr = 'MM-DD HH:mm';\n  } else {\n    // Show time only on the day\n    formatStr = 'HH:mm';\n  }\n\n  return day.format(formatStr);\n};\n\n/** wait */\nexport const wait = (ms: number) =>\n  new Promise(r => {\n    setTimeout(r, ms);\n  });\n\nimport { reporter as infraReporter } from '@coze-arch/logger';\n\n/**\n * The slardar reporting instance used by the process\n */\nexport const reporter = infraReporter.createReporterWithPreset({\n  namespace: 'workflow',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cronstrue from 'cronstrue/i18n';\nimport { I18n } from '@coze-arch/i18n';\n\nconst langMap = {\n  // Simplified Chinese\n  'zh-CN': 'zh_CN',\n  zh: 'zh-CN',\n  // Traditional Chinese\n  zh_TW: 'zh_TW',\n  // English\n  'en-US': 'en',\n  en: 'en',\n  // Japanese\n  'ja-JP': 'ja',\n  ja: 'ja',\n  // Korean\n  'ko-KR': 'ko',\n  ko: 'ko',\n  // French\n  'fr-FR': 'fr',\n  fr: 'fr',\n  // German\n  'de-DE': 'de',\n  de: 'de',\n  // Italian\n  'it-IT': 'it',\n  it: 'it',\n  // Spanish\n  'es-ES': 'es',\n  es: 'es',\n};\n\n// Verify translation results using cronjob\nexport const isCronJobVerify = cronJob => {\n  // Only 6-bit cronjobs are supported (backend limit).\n  const parts = cronJob?.split(' ');\n  if (parts?.length !== 6) {\n    return false;\n  }\n  try {\n    const rs = cronstrue.toString(cronJob, {\n      locale: langMap['zh-CN'],\n      throwExceptionOnParseError: true,\n    });\n\n    // Extra check if the string contains null undefined\n    // 1 2 3 31 1- 1 at 03:02:01 am, limited to the 31st of each month, or for Monday, January to undefined\n    // 1 2 3 31 1 1 #6 at 03:02:01 am, limited to the 31st of each month, limited to null Mondays of each month, only in January\n    if (rs.includes('null') || rs.includes('undefined')) {\n      return false;\n    }\n\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nexport const cronJobTranslator = (\n  cronJob?: string,\n  errorMsg?: string,\n): string => {\n  if (!cronJob) {\n    return '';\n  }\n  const lang = I18n.getLanguages();\n\n  if (isCronJobVerify(cronJob)) {\n    return cronstrue.toString(cronJob, {\n      locale: langMap[lang[0]] ?? langMap['zh-CN'],\n      use24HourTimeFormat: true,\n    });\n  }\n  return (\n    errorMsg ??\n    I18n.t('workflow_trigger_param_unvalid_cron', {}, ' cron ')\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\n/* eslint-disable max-lines-per-function -- refactor later */\n\nimport { useMemo, useRef, useState } from 'react';\n\nimport { isFunction } from 'lodash-es';\nimport { type WorkflowJSON } from '@flowgram-adapter/free-layout-editor';\nimport { type FrontWorkflowInfo } from '@coze-workflow/base/types';\nimport {\n  type BindBizType,\n  type SchemaType,\n  workflowApi,\n  WorkflowMode,\n} from '@coze-workflow/base/api';\nimport {\n  WORKFLOW_NAME_MAX_LEN,\n  WORKFLOW_NAME_REGEX,\n} from '@coze-workflow/base';\nimport { PictureUpload } from '@coze-common/biz-components/picture-upload';\nimport { type UploadValue } from '@coze-common/biz-components';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { reporter } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { useUserInfo } from '@coze-arch/foundation-sdk';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport {\n  Button,\n  LoadingButton,\n  Space,\n  Toast,\n  Tooltip,\n} from '@coze-arch/coze-design';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\nimport { Form, Typography, UIFormTextArea, UIModal } from '@coze-arch/bot-semi';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { FileBizType, IconType } from '@coze-arch/bot-api/developer_api';\n\nimport s from './index.module.less';\n/** Enter error code for compliance exception */\nconst sensitiveWordsErrorCode = ['702095075', '702095081'];\n\nconst { Checkbox } = Form;\n\nexport interface RuleItem {\n  validator: (rules: unknown[], value: string) => boolean | Error;\n}\n\ninterface EditWorkFlowPropsInner {\n  /** process type */\n  flowMode?: WorkflowMode;\n  mode: 'update' | 'add';\n  visible: boolean;\n  // Default confirmed disabled\n\n  /** Custom pop-up title */\n  customTitleRender?: (title: React.ReactNode) => React.ReactNode;\n\n  initConfirmDisabled?: boolean;\n  workFlow?: FrontWorkflowInfo;\n  onSuccess?: (val: {\n    workflowId?: string;\n    flowMode?: EditWorkFlowPropsInner['flowMode'];\n  }) => void;\n  onCancel?: () => void;\n  /** @deprecated unused */\n  spaceID?: string;\n  getLatestWorkflowJson?: () => Promise<WorkflowJSON>;\n  bindBizId?: string;\n  bindBizType?: BindBizType;\n  /** The current project id, only the workflow within the project has this field */\n  projectId?: string;\n  nameValidators?: RuleItem[];\n}\n\n/** form value */\ninterface FormValue {\n  icon_uri: UploadValue;\n  name: string;\n  target: string;\n  schema_type: SchemaType;\n  create_conversation?: boolean;\n}\n\n/** Get pop-up title */\nfunction getModalTitle(\n  mode: EditWorkFlowPropsInner['mode'],\n  flowMode: EditWorkFlowPropsInner['flowMode'],\n): string {\n  switch (flowMode) {\n    case WorkflowMode.Imageflow:\n      return mode === 'add'\n        ? I18n.t('imageflow_create')\n        : I18n.t('imageflow_edit');\n    case WorkflowMode.Workflow:\n      return mode === 'add'\n        ? I18n.t('workflow_list_create_modal_title')\n        : I18n.t('workflow_list_edit_modal_title');\n    case WorkflowMode.ChatFlow:\n      return mode === 'add'\n        ? I18n.t('wf_chatflow_81')\n        : I18n.t('wf_chatflow_84');\n    default:\n      return mode === 'add'\n        ? I18n.t('workflow_list_create_modal_title')\n        : I18n.t('workflow_list_edit_modal_title');\n  }\n}\n\nconst getPictureUploadInitValue = (\n  workFlow?: FrontWorkflowInfo,\n): UploadValue | undefined => {\n  if (!workFlow) {\n    return;\n  }\n  return [\n    {\n      url: workFlow.url || '',\n      uid: workFlow.icon_uri || '',\n    },\n  ];\n};\n\nexport function CreateWorkflowModal({\n  flowMode = WorkflowMode.Workflow,\n  mode,\n  bindBizId,\n  bindBizType,\n  projectId,\n  visible,\n  workFlow,\n  initConfirmDisabled = false,\n  customTitleRender,\n  onSuccess,\n  onCancel,\n  nameValidators = [],\n}: EditWorkFlowPropsInner) {\n  const formRef = useRef<Form<Partial<FormValue>>>(null);\n  const [confirmDisabled, setConfirmDisabled] = useState(initConfirmDisabled);\n  const [sensitiveTip, setSensitiveTip] = useState<string | undefined>();\n  const userInfo = useUserInfo();\n  const currentLocale = userInfo?.locale ?? navigator.language ?? 'en-US';\n\n  const getValues = async () => {\n    const formApi = formRef.current?.formApi;\n    await formApi?.validate(['name']);\n    return formApi?.getValues() as Partial<FormValue> | undefined;\n  };\n\n  const handleCancel = () => {\n    reporter.info({\n      message: 'workflow_info_modal_cancel',\n      namespace: 'workflow',\n    });\n    setSensitiveTip(undefined);\n    onCancel?.();\n  };\n\n  const handleError = (error: Error & { code?: string; msg?: string }) => {\n    if (sensitiveWordsErrorCode.includes(error.code || '')) {\n      setConfirmDisabled(true);\n      setSensitiveTip(error.msg);\n      return;\n    }\n\n    handleCancel();\n    throw error;\n  };\n\n  const handleUpdateWorkflow = async () => {\n    const workflowId = workFlow?.workflow_id;\n\n    reporter.info({\n      message: 'workflow_info_modal_confirm_update',\n      namespace: 'workflow',\n      meta: {\n        workflowId,\n      },\n    });\n\n    if (!workflowId) {\n      const msg = I18n.t('workflow_list_create_modal_workflow_id_empty');\n      throw new CustomError(REPORT_EVENTS.parmasValidation, msg);\n    }\n    const values = await getValues();\n    const updateParams = {\n      workflow_id: workflowId,\n      icon_uri: values?.icon_uri?.[0].uid || '',\n      name: values?.name,\n      desc: values?.target ? values.target : '',\n      space_id: workFlow.space_id || '',\n      // There is no need to re-test run to update the avatar and other information.\n      ignore_status_transfer: true,\n      schema_type: values?.schema_type || workFlow?.schema_type,\n    };\n\n    try {\n      await workflowApi.UpdateWorkflowMeta(updateParams);\n\n      reporter.info({\n        message: 'workflow_info_modal_update_success',\n        namespace: 'workflow',\n      });\n      Toast.success({\n        content: I18n.t('workflow_list_update_success'),\n        showClose: false,\n      });\n      await onSuccess?.({\n        workflowId,\n        flowMode,\n      });\n    } catch (error) {\n      reporter.error({\n        message: 'workflow_info_modal_update_fail',\n        namespace: 'workflow',\n        error,\n      });\n      handleError(error);\n    }\n  };\n\n  const handleCreateWorkflow = async () => {\n    reporter.info({\n      message: 'workflow_info_modal_confirm_create',\n      namespace: 'workflow',\n    });\n    const values = await getValues();\n    try {\n      const reqParams = {\n        ...values,\n        space_id: useSpaceStore.getState().getSpaceId(),\n        name: values?.name || '',\n        desc: values?.target || '',\n        icon_uri: values?.icon_uri?.[0]?.uid || '',\n        flow_mode: flowMode,\n        bind_biz_id: bindBizId,\n        bind_biz_type: bindBizType,\n        project_id: projectId,\n        create_conversation: projectId\n          ? values?.create_conversation\n          : undefined,\n      };\n\n      const resp = await workflowApi.CreateWorkflow(reqParams, {\n        headers: {\n          'x-locale': currentLocale,\n        },\n      });\n\n      const content =\n        flowMode === WorkflowMode.Imageflow\n          ? I18n.t('imageflow_create_toast_success')\n          : flowMode === WorkflowMode.ChatFlow\n          ? I18n.t('wf_chatflow_95')\n          : I18n.t('workflow_list_create_success');\n      Toast.success({\n        content,\n        showClose: false,\n      });\n      await onSuccess?.({\n        workflowId: resp.data?.workflow_id,\n        flowMode,\n      });\n      reporter.info({\n        message: 'workflow_info_modal_create_success',\n        namespace: 'workflow',\n      });\n    } catch (error) {\n      reporter.error({\n        message: 'workflow_info_modal_create_fail',\n        namespace: 'workflow',\n        error,\n      });\n      handleError(error);\n    }\n  };\n\n  const title = useMemo(() => {\n    const modelTitle = getModalTitle(mode, flowMode);\n    if (customTitleRender && isFunction(customTitleRender)) {\n      return customTitleRender(modelTitle);\n    }\n    return modelTitle;\n  }, [mode, flowMode, customTitleRender]);\n  const labels = useMemo<{\n    nameLabel?: string;\n    namePlaceholder?: string;\n    descLabel?: string;\n    descPlaceholder?: string;\n    nameFormatRuleLabel?: string;\n    nameRequiredLabel?: string;\n    descRequiredLabel?: string;\n  }>(() => {\n    if (flowMode === WorkflowMode.Imageflow) {\n      return {\n        nameLabel: I18n.t('imageflow_create_name'),\n        namePlaceholder: I18n.t('imageflow_create_name_placeholder'),\n        descLabel: I18n.t('imageflow_create_description'),\n        descPlaceholder: I18n.t('imageflow_create_description_placeholder'),\n        nameRequiredLabel: I18n.t('imageflow_create_name_placeholder'),\n        nameFormatRuleLabel: I18n.t('imageflow_create_name_wrong_format'),\n        descRequiredLabel: I18n.t('imageflow_create_description_placeholder'),\n      };\n    }\n    if (flowMode === WorkflowMode.ChatFlow) {\n      return {\n        nameLabel: I18n.t('wf_chatflow_85'),\n        namePlaceholder: I18n.t('wf_chatflow_91'),\n        descLabel: I18n.t('wf_chatflow_86'),\n        descPlaceholder: I18n.t('wf_chatflow_92'),\n        nameRequiredLabel: I18n.t('wf_chatflow_93'),\n        nameFormatRuleLabel: I18n.t('wf_chatflow_94'),\n        descRequiredLabel: I18n.t('wf_chatflow_122'),\n      };\n    }\n    return {\n      nameLabel: I18n.t('workflow_list_create_modal_name_label'),\n      namePlaceholder: I18n.t('workflow_list_create_modal_name_placeholder'),\n      descLabel: I18n.t('workflow_list_create_modal_description_label'),\n      descPlaceholder: I18n.t(\n        'workflow_list_create_modal_description_placeholder',\n      ),\n      nameRequiredLabel: I18n.t(\n        'workflow_list_create_modal_name_rule_required',\n      ),\n      nameFormatRuleLabel: I18n.t('workflow_list_create_modal_name_rule_reg'),\n      descRequiredLabel: I18n.t(\n        'workflow_list_create_modal_description_rule_required',\n      ),\n    };\n  }, [flowMode]);\n  const iconType = useMemo(() => {\n    switch (flowMode) {\n      case WorkflowMode.Imageflow:\n        return IconType.Imageflow;\n      case WorkflowMode.Workflow:\n        return IconType.Workflow;\n      case WorkflowMode.ChatFlow:\n        return IconType.ChatFlow;\n      default:\n        return IconType.Workflow;\n    }\n  }, [flowMode]);\n  return (\n    <UIModal\n      type=\"action-small\"\n      keepDOM={false}\n      icon={null}\n      visible={visible}\n      onCancel={handleCancel}\n      title={title}\n      footer={\n        <Space>\n          <Button\n            className=\"min-w-[96px]\"\n            color=\"primary\"\n            onClick={handleCancel}\n            data-testid=\"workflow.list.create.cancel\"\n          >\n            {I18n.t('workflow_list_create_modal_footer_cancel')}\n          </Button>\n          <LoadingButton\n            className=\"min-w-[96px]\"\n            color=\"hgltplus\"\n            disabled={confirmDisabled}\n            onClick={\n              mode === 'add' ? handleCreateWorkflow : handleUpdateWorkflow\n            }\n            data-testid=\"workflow.list.create.submit\"\n          >\n            {I18n.t('workflow_list_create_modal_footer_confirm')}\n          </LoadingButton>\n        </Space>\n      }\n    >\n      <Form<Partial<FormValue>>\n        ref={formRef}\n        showValidateIcon={false}\n        className={s['upload-form']}\n        onValueChange={({ name, target }) => {\n          setSensitiveTip(undefined);\n          setConfirmDisabled(!name?.trim() || !target?.trim());\n        }}\n      >\n        <PictureUpload\n          noLabel\n          fieldClassName={s['upload-field']}\n          field=\"icon_uri\"\n          initValue={getPictureUploadInitValue(workFlow)}\n          iconType={iconType}\n          fileBizType={FileBizType.BIZ_BOT_WORKFLOW}\n        />\n        <UIFormTextArea\n          stopValidateWithError\n          className={s['textarea-single-line']}\n          field=\"name\"\n          placeholder={labels.namePlaceholder}\n          label={labels.nameLabel}\n          // noErrorMessage\n          initValue={workFlow?.name}\n          rows={1}\n          maxCount={WORKFLOW_NAME_MAX_LEN}\n          maxLength={WORKFLOW_NAME_MAX_LEN}\n          rules={[\n            {\n              required: true,\n              message: labels.nameRequiredLabel,\n            },\n            {\n              validator(_, value) {\n                if (!WORKFLOW_NAME_REGEX.test(value)) {\n                  return new CustomError(\n                    REPORT_EVENTS.formValidation,\n                    labels.nameFormatRuleLabel ?? '',\n                  );\n                }\n                return true;\n              },\n            },\n            ...nameValidators,\n          ]}\n          data-testid=\"workflow.list.create.name.input\"\n        />\n\n        {/* Sessions can only be bound when Chatflow is created within the project */}\n        {mode === 'add' && projectId && flowMode === WorkflowMode.ChatFlow ? (\n          <Checkbox\n            fieldClassName={s['conversation-field']}\n            noLabel\n            initValue={true}\n            field=\"create_conversation\"\n          >\n            <Typography.Text className=\"coz-fg-primary\">\n              {I18n.t('wf_chatflow_87')}\n            </Typography.Text>\n            <Tooltip\n              position=\"top\"\n              theme=\"dark\"\n              style={{ width: 278 }}\n              content={I18n.t('wf_chatflow_82')}\n            >\n              <IconCozInfoCircle className=\"text-[16px] ml-1.5 coz-fg-dim\" />\n            </Tooltip>\n          </Checkbox>\n        ) : null}\n        <UIFormTextArea\n          field=\"target\"\n          className={s['textarea-multi-line']}\n          label={labels.descLabel}\n          placeholder={labels.descPlaceholder}\n          initValue={workFlow?.desc}\n          maxCount={600}\n          maxLength={600}\n          rules={[\n            {\n              required: true,\n              message: labels.descRequiredLabel,\n            },\n          ]}\n          data-testid=\"workflow.list.create.desc.input\"\n        />\n        {typeof sensitiveTip === 'string' ? (\n          <Form.ErrorMessage error={sensitiveTip} />\n        ) : null}\n      </Form>\n    </UIModal>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { OrderBy, WorkFlowListStatus } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { WORKFLOW_LIST_STATUS_ALL } from '@/workflow-modal/type';\n\n/** Process Owner Options, All/Mine */\nexport const scopeOptions = [\n  {\n    label: I18n.t('workflow_list_scope_all'),\n    value: 'all',\n  },\n  {\n    label: I18n.t('workflow_list_scope_mine'),\n    value: 'me',\n  },\n];\n\n/** Process Status Options, All/Published/Unpublished */\nexport const statusOptions = [\n  {\n    label: I18n.t('workflow_list_status_all'),\n    value: WORKFLOW_LIST_STATUS_ALL,\n  },\n  {\n    label: I18n.t('workflow_list_status_published'),\n    value: WorkFlowListStatus.HadPublished,\n  },\n  {\n    label: I18n.t('workflow_list_status_unpublished'),\n    value: WorkFlowListStatus.UnPublished,\n  },\n];\n\n/** Process sorting options, creation time/update time */\nexport const sortOptions = [\n  {\n    label: I18n.t('workflow_list_sort_create_time'),\n    value: OrderBy.CreateTime,\n  },\n  {\n    label: I18n.t('workflow_list_sort_edit_time'),\n    value: OrderBy.UpdateTime,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Tooltip } from '@coze-arch/coze-design';\n\nimport { type WorkFlowModalModeProps, type WorkflowInfo } from '../../type';\nexport type LibButtonProps = Pick<WorkFlowModalModeProps, 'onImport'> & {\n  data?: WorkflowInfo;\n};\nexport const LibButton: React.FC<LibButtonProps> = ({ data, onImport }) => {\n  const isPublished = data?.plugin_id && data?.plugin_id !== '0';\n  const content = (\n    <div onClick={e => e.stopPropagation()}>\n      <Button\n        disabled={!isPublished}\n        color=\"primary\"\n        data-testid=\"workflow.modal.add\"\n        onClick={event => {\n          event.stopPropagation();\n          data?.workflow_id &&\n            onImport?.({\n              workflow_id: data.workflow_id,\n              name: data.name || '',\n            });\n        }}\n      >\n        {I18n.t('project_resource_modal_copy_to_project')}\n      </Button>\n    </div>\n  );\n  if (isPublished) {\n    return content;\n  }\n  return (\n    <Tooltip\n      position=\"top\"\n      content={I18n.t('project_toast_only_published_resources_can_be_imported')}\n    >\n      {content}\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useContext, type FC } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  PARAM_TYPE_LABEL_MAP,\n  STRING_ASSIST_TYPE_LABEL_MAP,\n} from '@coze-workflow/base/types';\nimport { InputType, PluginParamTypeFormat } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tag, Typography } from '@coze-arch/coze-design';\nimport { type OverflowListProps } from '@coze-arch/bot-semi/OverflowList';\nimport { Popover, OverflowList } from '@coze-arch/bot-semi';\n\nimport WorkflowModalContext from '../../../workflow-modal-context';\nimport {\n  DataSourceType,\n  type ProductInfo,\n  type WorkflowInfo,\n} from '../../../type';\nimport { type WorkflowCardProps } from '../../../hooks/use-workflow-action';\n\nimport styles from './index.module.less';\n\nconst { Paragraph, Text } = Typography;\n\nconst getInputType = ({ type, format, assist_type }) => {\n  let inputType = '';\n  if (type) {\n    if (\n      type === InputType.String &&\n      format === PluginParamTypeFormat.ImageUrl\n    ) {\n      inputType = 'Image';\n    } else if (type === InputType.String && assist_type) {\n      inputType = STRING_ASSIST_TYPE_LABEL_MAP[assist_type];\n    } else {\n      inputType = PARAM_TYPE_LABEL_MAP[type as InputType];\n    }\n  }\n\n  return inputType;\n};\n\nexport interface WorkflowParameterItem {\n  name?: string;\n  desc?: string;\n  required?: boolean;\n  type?: string;\n}\n\ntype WorkflowParametersProps = Pick<WorkflowCardProps, 'data'> & {\n  className?: string;\n  style?: React.CSSProperties;\n};\n\ninterface CustomParameterPopoverProps {\n  items: WorkflowParameterItem[];\n  children: React.ReactNode;\n}\n\nconst CustomParameterPopover: FC<CustomParameterPopoverProps> = ({\n  children,\n  items,\n}) => (\n  <Popover\n    stopPropagation\n    position=\"top\"\n    spacing={0}\n    content={\n      <div className={styles.popover}>\n        {items.map((item, index) => (\n          <div key={`item${index}`} className={styles.item}>\n            <div className={styles.header}>\n              <Text\n                ellipsis={{\n                  showTooltip: {\n                    opts: {\n                      content: item.name || '',\n                      position: 'top',\n                      style: {\n                        wordBreak: 'break-word',\n                      },\n                    },\n                  },\n                }}\n              >\n                <span className={styles.name}>{item.name || '-'}</span>\n              </Text>\n              <span className={styles.type}>{item.type || '-'}</span>\n              {Boolean(item.required) && (\n                <span className={styles.required}>\n                  {I18n.t('workflow_add_parameter_required')}\n                </span>\n              )}\n            </div>\n            <div className={styles.footer}>\n              <Paragraph\n                ellipsis={{\n                  rows: 2,\n                  showTooltip: {\n                    opts: {\n                      content: item.desc || '',\n                      position: 'top',\n                      style: {\n                        wordBreak: 'break-word',\n                      },\n                    },\n                  },\n                }}\n              >\n                <span className={styles.footer}>{item.desc || '-'}</span>\n              </Paragraph>\n            </div>\n          </div>\n        ))}\n      </div>\n    }\n  >\n    {children}\n  </Popover>\n);\n\nexport const WorkflowParameters: FC<WorkflowParametersProps> = ({\n  data,\n  style,\n  className,\n}) => {\n  const context = useContext(WorkflowModalContext);\n  function isTypeWorkflow(\n    target: WorkflowInfo | ProductInfo,\n  ): target is WorkflowInfo {\n    return context?.modalState.dataSourceType === DataSourceType.Workflow;\n  }\n  const getParameters = (): Array<WorkflowParameterItem> => {\n    // Although this split is a bit redundant, it allows for correct type derivation\n    if (isTypeWorkflow(data)) {\n      return (\n        data.start_node?.node_param?.input_parameters?.map(item => {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          const inputType = getInputType(item as any);\n\n          return {\n            name: item.name,\n            desc: item.desc,\n            required: item.required,\n            type: inputType,\n          };\n        }) || []\n      );\n    }\n\n    return (\n      data?.workflow_extra?.start_node?.node_param?.input_parameters?.map(\n        item => {\n          const inputType = getInputType({\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            ...(item as any),\n            type: item.input_type,\n          });\n\n          return {\n            name: item.name,\n            desc: item.desc,\n            required: item.is_required,\n            type: inputType,\n          };\n        },\n      ) || []\n    );\n  };\n\n  const items = getParameters();\n\n  const overflowRenderer: OverflowListProps['overflowRenderer'] = (\n    overflowItems: Array<WorkflowParameterItem>,\n  ) => {\n    const slicedItems = overflowItems.slice(overflowItems.length * -1);\n    return slicedItems.length ? (\n      <CustomParameterPopover items={items}>\n        <div>\n          <Tag style={{ flex: '0 0 auto' }} size=\"mini\" color=\"primary\">\n            +{slicedItems.length}\n          </Tag>\n        </div>\n      </CustomParameterPopover>\n    ) : null;\n  };\n  const visibleItemRenderer: OverflowListProps['visibleItemRenderer'] = (\n    item: WorkflowParameterItem,\n  ) => (\n    <CustomParameterPopover items={items}>\n      <div style={{ marginRight: 8 }}>\n        <Tag size=\"mini\" color=\"primary\">\n          {item.name}\n        </Tag>\n      </div>\n    </CustomParameterPopover>\n  );\n\n  return (\n    <div className={classNames(styles.container, className)} style={style}>\n      <div className={styles.wrapper}>\n        <OverflowList\n          items={items}\n          overflowRenderer={overflowRenderer}\n          visibleItemRenderer={visibleItemRenderer}\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type MouseEvent } from 'react';\n\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { IconButton, Popconfirm } from '@coze-arch/coze-design';\n\nexport const DeleteButton = ({\n  className,\n  onDelete,\n}: {\n  className?: string;\n  onDelete?: () => Promise<void>;\n}) => {\n  const [modalVisible, setModalVisible] = useState(false);\n  const handleClose = () => setModalVisible(false);\n  const showDeleteConfirm = (e: MouseEvent<HTMLButtonElement>) => {\n    e.stopPropagation();\n    setModalVisible(true);\n  };\n\n  const handleDelete = () =>\n    // Use promises to make the button appear loading, see\n    // https://semi.design/zh-CN/feedback/popconfirm\n    new Promise((resolve, reject) => {\n      onDelete?.()\n        .then(() => {\n          handleClose();\n          resolve(true);\n        })\n        .catch(error => {\n          // Handle errors\n          logger.error({\n            error: error as Error,\n            eventName: 'delete workflow error',\n          });\n          reject(error);\n        });\n    });\n  return (\n    <div className={className} onClick={e => e.stopPropagation()}>\n      <Popconfirm\n        visible={modalVisible}\n        title={I18n.t('scene_workflow_popup_delete_confirm_title')}\n        content={I18n.t('scene_workflow_popup_delete_confirm_subtitle')}\n        okText={I18n.t('shortcut_modal_confirm')}\n        cancelText={I18n.t('shortcut_modal_cancel')}\n        trigger=\"click\"\n        position=\"bottomRight\"\n        onConfirm={handleDelete}\n        onCancel={handleClose}\n        okButtonColor=\"red\"\n      >\n        <IconButton\n          icon={<IconCozTrashCan />}\n          type=\"primary\"\n          onClick={showDeleteConfirm}\n        />\n      </Popconfirm>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport classNames from 'classnames';\nimport { useBoolean } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, type ButtonProps } from '@coze-arch/coze-design';\n\nimport { useI18nText } from '@/workflow-modal/hooks/use-i18n-text';\n\nimport styles from './index.module.less';\n\ntype WorkflowAddedButtonProps = ButtonProps;\n\nexport const WorkflowAddedButton: FC<\n  WorkflowAddedButtonProps\n> = buttonProps => {\n  const [isMouseIn, { setFalse, setTrue }] = useBoolean(false);\n\n  const onMouseEnter = () => {\n    setTrue();\n  };\n  const onMouseLeave = () => {\n    setFalse();\n  };\n  const { i18nText, ModalI18nKey } = useI18nText();\n  return (\n    <Button\n      {...buttonProps}\n      color={isMouseIn ? 'red' : 'primary'}\n      className={classNames({\n        [styles.button]: true,\n        [styles.moreLevel]: true,\n      })}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      data-testid=\"workflow.modal.button.added\"\n    >\n      {isMouseIn\n        ? i18nText(ModalI18nKey.ListItemRemove)\n        : I18n.t('workflow_add_list_added')}\n    </Button>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, useContext, useMemo, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport { LoadingButton } from '@coze-arch/coze-design';\nimport { Popconfirm, Tooltip } from '@coze-arch/bot-semi';\nimport { CheckType, type CheckResult } from '@coze-arch/bot-api/workflow_api';\nimport { type WorkflowNodeJSON } from '@flowgram-adapter/free-layout-editor';\n\nimport WorkflowModalContext from '../../../workflow-modal-context';\nimport { isSelectProjectCategory } from '../../../utils';\nimport { type WorkflowInfo, WorkflowModalFrom } from '../../../type';\nimport { useI18nText } from '../../../hooks/use-i18n-text';\nimport { WorkflowAddedButton } from './added-button';\n\nimport styles from './index.module.less';\n\ninterface WorkflowBotButtonProps {\n  data?: WorkflowInfo;\n  isAdded?: boolean;\n  from?: WorkflowModalFrom;\n  loading?: boolean;\n  workflowNodes?: WorkflowNodeJSON[];\n  onAdd: () => Promise<boolean>;\n  onRemove: () => void;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nexport const WorkflowBotButton: FC<WorkflowBotButtonProps> = ({\n  data,\n  style,\n  isAdded,\n  onAdd,\n  onRemove,\n  className,\n  from,\n  workflowNodes,\n  loading,\n}) => {\n  const { plugin_id } = data || {};\n  const isPublished = plugin_id !== '0';\n  const isFromWorkflow =\n    from === WorkflowModalFrom.WorkflowAddNode ||\n    from === WorkflowModalFrom.ProjectWorkflowAddNode;\n  const context = useContext(WorkflowModalContext);\n  const isAddProjectWorkflow = isSelectProjectCategory(context?.modalState);\n  const canAdd = isPublished || isAddProjectWorkflow;\n  const isFromSocialScene = from === WorkflowModalFrom.SocialSceneHost;\n  const [count, setCount] = useState((workflowNodes || []).length);\n\n  const isFromWorkflowAgent = from === WorkflowModalFrom.WorkflowAgent;\n  const botAgentCheckResult = useMemo<CheckResult | undefined>(\n    () => data?.check_result?.find(check => check.type === CheckType.BotAgent),\n    [data],\n  );\n\n  const { i18nText, ModalI18nKey } = useI18nText();\n  const renderContent = () => {\n    if (isFromWorkflowAgent) {\n      if (botAgentCheckResult && !botAgentCheckResult.is_pass) {\n        return (\n          <Tooltip\n            position=\"top\"\n            className={styles.not_publish_tooltip}\n            content={\n              <span className={styles.content}>\n                {botAgentCheckResult.reason}\n              </span>\n            }\n          >\n            <LoadingButton\n              disabled\n              color=\"primary\"\n              className={styles.button}\n              data-testid=\"workflow.modal.add\"\n            >\n              {I18n.t('workflow_add_list_add')}\n            </LoadingButton>\n          </Tooltip>\n        );\n      }\n    }\n\n    // If added, display the Added button\n    if (isAdded) {\n      return (\n        <Popconfirm\n          title={i18nText(ModalI18nKey.ListItemRemoveConfirmTitle)}\n          content={i18nText(ModalI18nKey.ListItemRemoveConfirmDescription)}\n          okType=\"danger\"\n          position=\"topRight\"\n          onConfirm={onRemove}\n          zIndex={9999}\n          okText={I18n.t('neutral_age_gate_confirm', {}, 'Confirm')}\n          cancelText={I18n.t('workflow_240218_17', {}, 'Cancel')}\n        >\n          <div>\n            <WorkflowAddedButton />\n          </div>\n        </Popconfirm>\n      );\n    }\n    // Not added, judge the release status\n    // Unpublished, show the button below\n    if (!canAdd) {\n      let key: I18nKeysNoOptionsType = 'workflow_add_not_allow_before_publish';\n      if (isFromWorkflow) {\n        key = 'wf_node_add_wf_modal_tip_must_publish_to_add';\n      } else if (isFromSocialScene) {\n        key = 'scene_workflow_popup_add_forbidden';\n      }\n      return (\n        <Tooltip\n          position=\"top\"\n          className={styles.not_publish_tooltip}\n          content={<span className={styles.content}>{I18n.t(key)}</span>}\n        >\n          <LoadingButton\n            disabled\n            color=\"primary\"\n            className={styles.button}\n            data-testid=\"workflow.modal.add\"\n          >\n            {I18n.t('workflow_add_list_add')}\n          </LoadingButton>\n        </Tooltip>\n      );\n    }\n    // Published and not added, show the add button\n    if (!isAdded) {\n      return (\n        <LoadingButton\n          onClick={async () => {\n            const isSuccess = await onAdd?.();\n            if (isSuccess) {\n              setCount(prev => prev + 1);\n            }\n          }}\n          color=\"primary\"\n          className={styles.button}\n          data-testid=\"workflow.modal.add\"\n        >\n          {I18n.t('workflow_add_list_add')}\n          {isFromWorkflow && count !== 0 ? (\n            <span className={styles.workflow_count_span}>{count}</span>\n          ) : null}\n        </LoadingButton>\n      );\n    }\n\n    return null;\n  };\n\n  return (\n    <div\n      className={classNames(styles.container, className)}\n      style={style}\n      onClick={e => e.stopPropagation()}\n    >\n      {renderContent()}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @coze-arch/max-line-per-function */\nimport React, { type FC, useContext } from 'react';\n\nimport isNil from 'lodash-es/isNil';\nimport { unix } from 'dayjs';\nimport classNames from 'classnames';\nimport { OrderBy, WorkFlowListStatus } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozClockFill,\n  IconCozCheckMarkCircleFill,\n} from '@coze-arch/coze-design/icons';\nimport { Typography, LoadingButton } from '@coze-arch/coze-design';\nimport { Avatar, Image, Tooltip } from '@coze-arch/bot-semi';\nimport { CheckType } from '@coze-arch/bot-api/workflow_api';\nimport { type Int64, SpaceType } from '@coze-arch/bot-api/developer_api';\n\nimport { LibButton } from '@/workflow-modal/content/card/lib-button';\n\nimport WorkflowModalContext from '../../workflow-modal-context';\nimport { isSelectProjectCategory } from '../../utils';\nimport {\n  DataSourceType,\n  MineActiveEnum,\n  type ProductInfo,\n  WorkflowCategory,\n  type WorkflowInfo,\n  WorkflowModalFrom,\n} from '../../type';\nimport {\n  useWorkflowAction,\n  type WorkflowCardProps,\n} from '../../hooks/use-workflow-action';\nimport { WorkflowParameters } from './parameters';\nimport { DeleteButton } from './delete-button';\nimport { WorkflowBotButton } from './bot-button';\n\nimport styles from './index.module.less';\n\nconst { Text } = Typography;\n\nconst formatTime = (time?: Int64) => unix(Number(time)).format('YYYY-MM-DD');\n\nconst defaultWorkFlowList = [];\n\nexport const WorkflowCard: FC<WorkflowCardProps> = props => {\n  const {\n    data,\n    workFlowList = defaultWorkFlowList,\n    from,\n    workflowNodes,\n    dupText,\n    itemShowDelete,\n  } = props;\n  const context = useContext(WorkflowModalContext);\n\n  const isProfessionalTemplate = (data as ProductInfo)?.meta_info\n    ?.is_professional;\n\n  const {\n    dupWorkflowTpl,\n    addWorkflow,\n    removeWorkflow,\n    deleteWorkflow,\n    itemClick,\n  } = useWorkflowAction({ ...props, isProfessionalTemplate });\n\n  if (!context) {\n    return null;\n  }\n\n  const StatusMap = {\n    unpublished: {\n      label: I18n.t('workflow_add_status_unpublished'),\n      icon: <IconCozClockFill className=\"coz-fg-dim text-xs\" />,\n    },\n    published: {\n      label: I18n.t('workflow_add_status_published'),\n      icon: (\n        <IconCozCheckMarkCircleFill className=\"text-xs coz-fg-hglt-green\" />\n      ),\n    },\n  };\n\n  const { orderBy, spaceType } = context;\n  const {\n    creator: creator,\n    status,\n    isSpaceWorkflow,\n    workflowCategory,\n  } = context.modalState;\n  const isTeam = spaceType === SpaceType.Team;\n\n  function isTypeWorkflow(\n    target: WorkflowInfo | ProductInfo,\n  ): target is WorkflowInfo {\n    return context?.modalState.dataSourceType === DataSourceType.Workflow;\n  }\n\n  const pluginId = isTypeWorkflow(data) ? data.plugin_id : '';\n  const statusValue =\n    !isNil(pluginId) && isSpaceWorkflow\n      ? StatusMap[pluginId === '0' ? 'unpublished' : 'published']\n      : undefined;\n\n  const renderStatusValue = () => {\n    // Add workflow nodes in the project, official examples do not show release status\n    if (\n      isSelectProjectCategory(context?.modalState) ||\n      workflowCategory === WorkflowCategory.Example\n    ) {\n      return null;\n    }\n    if (statusValue) {\n      return (\n        <div className={classNames(styles.status)}>\n          {statusValue.icon}\n          <span className={styles.text}>{statusValue.label}</span>\n        </div>\n      );\n    }\n    return null;\n  };\n  const renderBottomLeftDesc = () => {\n    // bottom of the product\n    if (!isTypeWorkflow(data)) {\n      const timeRender = `${I18n.t('workflow_add_list_updated')} ${formatTime(\n        data.meta_info.listed_at,\n      )}`;\n\n      return (\n        <div className={styles.info}>\n          <div className={styles.creator}>\n            <Avatar\n              className={styles['creator-avatar']}\n              src={data.meta_info.user_info?.avatar_url}\n            />\n            <Text\n              ellipsis={{ showTooltip: true }}\n              className={styles['creator-name']}\n            >\n              {data.meta_info.user_info?.name ??\n                I18n.t('workflow_add_list_unknown')}\n            </Text>\n            <span className={styles.symbol}>|</span>\n          </div>\n          <span className={styles.date}>{timeRender}</span>\n\n          {(Number(data?.workflow_extra?.duplicate_count) || 0) > 0 ? (\n            <>\n              <span className={styles.symbol}>|</span>\n              <Text className={styles.date}>\n                {Number(data?.workflow_extra?.duplicate_count) || 0}{' '}\n                {I18n.t('workflowstore_card_duplicate')}\n              </Text>\n            </>\n          ) : null}\n        </div>\n      );\n    }\n\n    // User-created, showing modification time\n    if (isSpaceWorkflow || workflowCategory === WorkflowCategory.Example) {\n      const showCreator =\n        (creator !== MineActiveEnum.Mine && isTeam) ||\n        from === WorkflowModalFrom.ProjectImportLibrary;\n      const timeRender =\n        orderBy === OrderBy.CreateTime\n          ? `${I18n.t('workflow_add_list_created')} ${formatTime(\n              data.create_time,\n            )}`\n          : status === WorkFlowListStatus.HadPublished\n          ? `${I18n.t('workflow_add_list_publised')} ${formatTime(\n              data.update_time,\n            )}`\n          : `${I18n.t('workflow_add_list_updated')} ${formatTime(\n              data.update_time,\n            )}`;\n      return (\n        <div className={styles.info}>\n          {showCreator ? (\n            <div className={styles.creator}>\n              <Avatar\n                className={styles['creator-avatar']}\n                src={data.creator?.avatar_url}\n              />\n              <Text\n                ellipsis={{ showTooltip: true }}\n                className={styles['creator-name']}\n              >\n                {data.creator?.name ?? I18n.t('workflow_add_list_unknown')}\n              </Text>\n              <span className={styles.symbol}>|</span>\n            </div>\n          ) : null}\n          <span className={styles.date}>{timeRender}</span>\n        </div>\n      );\n    }\n\n    // Official template, showcasing creators\n    if (!isSpaceWorkflow) {\n      return (\n        <div className={styles.creator}>\n          <Image\n            preview={false}\n            src={data.template_author_picture_url}\n            className={styles.avatar}\n          />\n          <Text ellipsis={{ showTooltip: true }} className={styles.name}>\n            {data.template_author_name || '-'}\n          </Text>\n        </div>\n      );\n    }\n    return null;\n  };\n  const renderBotButton = () => {\n    if (workflowCategory === WorkflowCategory.Example && isTypeWorkflow(data)) {\n      const botAgentCheckResult = data?.check_result?.find(\n        check => check.type === CheckType.BotAgent,\n      );\n      const ButtonContent = (\n        <LoadingButton\n          color=\"primary\"\n          data-testid=\"workflow.modal.add\"\n          disabled={botAgentCheckResult && !botAgentCheckResult?.is_pass}\n          onClick={async e => {\n            e.stopPropagation();\n            await dupWorkflowTpl();\n          }}\n        >\n          {dupText || I18n.t('workflowstore_duplicate_and_add')}\n        </LoadingButton>\n      );\n\n      if (\n        botAgentCheckResult &&\n        !botAgentCheckResult.is_pass &&\n        botAgentCheckResult.reason\n      ) {\n        return (\n          <Tooltip content={botAgentCheckResult.reason}>\n            {ButtonContent}\n          </Tooltip>\n        );\n      }\n      return ButtonContent;\n    }\n\n    if (from === WorkflowModalFrom.ProjectImportLibrary) {\n      return (\n        <LibButton data={data as WorkflowInfo} onImport={props.onImport} />\n      );\n    }\n    return (\n      <>\n        <WorkflowBotButton\n          isAdded={workFlowList.some(\n            workflow =>\n              workflow.workflow_id === (data as WorkflowInfo)?.workflow_id,\n          )}\n          workflowNodes={workflowNodes}\n          from={from}\n          data={data as WorkflowInfo}\n          onAdd={() => addWorkflow()}\n          onRemove={() => {\n            removeWorkflow();\n          }}\n        />\n        {itemShowDelete ? (\n          <DeleteButton className=\"ml-[4px]\" onDelete={deleteWorkflow} />\n        ) : null}\n      </>\n    );\n  };\n\n  return (\n    <div\n      className={styles.container}\n      onClick={() => {\n        itemClick();\n      }}\n    >\n      <div className={styles.left}>\n        <div className={styles.icon}>\n          <Image\n            preview={false}\n            src={isTypeWorkflow(data) ? data.url : data.meta_info.icon_url}\n          />\n        </div>\n      </div>\n      <div className={styles.center}>\n        <div className={styles.header}>\n          <div className={styles.title_wrapper}>\n            <Text ellipsis={{ showTooltip: true }} className={styles.title}>\n              {isTypeWorkflow(data) ? data.name : data.meta_info.name}\n            </Text>\n            {renderStatusValue()}\n          </div>\n        </div>\n        <div className={styles.content}>\n          <Text\n            ellipsis={{\n              showTooltip: {\n                opts: {\n                  style: {\n                    maxWidth: 600,\n                    wordBreak: 'break-word',\n                  },\n                },\n              },\n            }}\n            className={styles.desc}\n          >\n            {(isTypeWorkflow(data) ? data.desc : data.meta_info.description) ||\n              ''}\n          </Text>\n        </div>\n        <div className={styles.footer}>\n          <WorkflowParameters data={data} />\n          {renderBottomLeftDesc()}\n        </div>\n      </div>\n      <div className={styles.right}>\n        <div className={styles.buttons}>{renderBotButton()}</div>\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n/* eslint-disable @coze-arch/max-line-per-function */\nimport { type FC, useContext, useEffect, useMemo, useRef } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport groupBy from 'lodash-es/groupBy';\nimport { useInViewport, useUpdateEffect } from 'ahooks';\nimport { StandardNodeType } from '@coze-workflow/base/types';\nimport { useWorkflowStore } from '@coze-workflow/base/store';\nimport {\n  WorkflowMode,\n  WorkFlowType,\n  Tag,\n  BindBizType,\n} from '@coze-workflow/base/api';\nimport { isGeneralWorkflow, workflowApi } from '@coze-workflow/base';\nimport { SearchNoResult } from '@coze-studio/components/search-no-result';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozLoading } from '@coze-arch/coze-design/icons';\nimport { Spin } from '@coze-arch/coze-design';\nimport { UICompositionModalMain, UIEmpty } from '@coze-arch/bot-semi';\nimport {\n  ProductEntityType,\n  ProductListSource,\n} from '@coze-arch/bot-api/product_api';\n\nimport { useWorkflowList } from '@/hooks/use-workflow-list';\n\nimport WorkflowModalContext from '../workflow-modal-context';\nimport { isSelectProjectCategory } from '../utils';\nimport {\n  DataSourceType,\n  MineActiveEnum,\n  type ProductInfo,\n  WORKFLOW_LIST_STATUS_ALL,\n  WorkflowCategory,\n  type WorkflowInfo,\n  WorkflowModalFrom,\n  type WorkFlowModalModeProps,\n  type WorkflowModalState,\n} from '../type';\nimport { useWorkflowProductList } from '../hooks/use-workflow-product-list';\nimport { useI18nText } from '../hooks/use-i18n-text';\nimport { WorkflowCard } from './card';\n\nimport s from './index.module.less';\n\n// eslint-disable-next-line max-lines-per-function\nconst WorkflowModalContent: FC<WorkFlowModalModeProps> = props => {\n  const { excludedWorkflowIds, from, projectId } = props;\n  const context = useContext(WorkflowModalContext);\n  const { i18nText, ModalI18nKey } = useI18nText();\n  const {\n    updatePageParam: updateWorkflowPageParam,\n    isFetching,\n    workflowList,\n    fetchNextPage,\n    loadingStatus,\n    refetch,\n    hasNextPage,\n    handleDelete,\n  } = useWorkflowList({\n    pageSize: 10,\n    enabled: context?.modalState.dataSourceType === DataSourceType.Workflow,\n    from,\n    fetchWorkflowListApi:\n      context?.modalState?.workflowCategory !== WorkflowCategory.Example\n        ? workflowApi.GetWorkFlowList.bind(workflowApi)\n        : workflowApi.GetExampleWorkFlowList.bind(workflowApi),\n  });\n\n  const {\n    workflowProductList,\n    updatePageParam: updateProductPageParam,\n    fetchNextPage: fetchNextProductPage,\n    isFetching: productIsFetching,\n    loadingStatus: productLoadingStatus,\n    hasNextPage: productHasNextPage,\n    copyProduct,\n  } = useWorkflowProductList({\n    pageSize: 10,\n    enabled: context?.modalState.dataSourceType === DataSourceType.Product,\n  });\n  // conversion filter parameters\n  useEffect(() => {\n    if (!context) {\n      return;\n    }\n\n    const { modalState, flowMode } = context;\n\n    if (modalState.dataSourceType === DataSourceType.Workflow) {\n      const isAddProjectWorkflow = isSelectProjectCategory(modalState);\n      let targetTags;\n      if (!modalState.isSpaceWorkflow) {\n        if (modalState.query) {\n          targetTags = 1;\n        } else {\n          targetTags = modalState.workflowTag;\n        }\n      }\n      let type: WorkFlowType;\n      if (modalState.workflowCategory === WorkflowCategory.Example) {\n        targetTags = Tag.All;\n        type = WorkFlowType.GuanFang;\n      } else {\n        type = modalState.isSpaceWorkflow\n          ? WorkFlowType.User\n          : WorkFlowType.GuanFang;\n      }\n      let status: WorkflowModalState['status'] | undefined = undefined;\n      if (modalState.isSpaceWorkflow) {\n        status =\n          // isAddProjectWorkflow: Add sub-workflow to the project, no release state concept, filter state pass undefined\n          modalState.status === WORKFLOW_LIST_STATUS_ALL || isAddProjectWorkflow\n            ? undefined\n            : modalState.status;\n      }\n      updateWorkflowPageParam({\n        space_id: context.spaceId,\n        flow_mode: modalState.listFlowMode,\n        name: modalState.query,\n        order_by: modalState.isSpaceWorkflow ? context.orderBy : undefined,\n        status,\n        type,\n        project_id: isSelectProjectCategory(modalState) ? projectId : undefined,\n        login_user_create: modalState.isSpaceWorkflow\n          ? modalState.creator === MineActiveEnum.Mine\n          : undefined,\n        tags: targetTags,\n        bind_biz_type: context.bindBizType,\n        bind_biz_id: context.bindBizId,\n      });\n    } else {\n      if (modalState.productCategory === 'recommend') {\n        updateProductPageParam({\n          keyword: modalState.query,\n          sort_type: modalState.sortType,\n          category_id: undefined,\n          source: ProductListSource.Recommend,\n          entity_type: isGeneralWorkflow(flowMode)\n            ? ProductEntityType.WorkflowTemplateV2\n            : ProductEntityType.ImageflowTemplateV2,\n        });\n      } else if (modalState.productCategory === 'all') {\n        updateProductPageParam({\n          keyword: modalState.query,\n          sort_type: modalState.sortType,\n          category_id: undefined,\n          source: undefined,\n          entity_type: isGeneralWorkflow(flowMode)\n            ? ProductEntityType.WorkflowTemplateV2\n            : ProductEntityType.ImageflowTemplateV2,\n        });\n      } else {\n        updateProductPageParam({\n          keyword: modalState.query,\n          sort_type: modalState.sortType,\n          category_id: modalState.productCategory,\n          source: undefined,\n          entity_type: isGeneralWorkflow(flowMode)\n            ? ProductEntityType.WorkflowTemplateV2\n            : ProductEntityType.ImageflowTemplateV2,\n        });\n      }\n    }\n  }, [context]);\n\n  const { nodes } = useWorkflowStore(\n    useShallow(state => ({\n      nodes: state.nodes,\n    })),\n  );\n\n  // Subprocess node map, e.g. {'workflowId': [node1, node2,...]}\n  const workflowNodesMap = useMemo(() => {\n    const subFlowNodes = nodes.filter(\n      v => v.type === StandardNodeType.SubWorkflow,\n    );\n    const groups = groupBy(\n      subFlowNodes,\n      item => item?.data?.inputs?.workflowId,\n    );\n    return groups;\n  }, [nodes]);\n\n  const targetWorkflowList = useMemo(() => {\n    if (!excludedWorkflowIds) {\n      return workflowList;\n    }\n    return workflowList.filter(\n      v => !excludedWorkflowIds.includes(v.workflow_id || ''),\n    );\n  }, [excludedWorkflowIds, workflowList]);\n\n  /** Scroll container */\n  const scrollContainerRef = useRef<HTMLDivElement | null>(null);\n  /** Monitor the bottom observer */\n  const intersectionObserverDom = useRef<HTMLDivElement>(null);\n  // Is it bottoming out?\n  const [inViewPort] = useInViewport(intersectionObserverDom, {\n    root: () => scrollContainerRef.current,\n    threshold: 0.8,\n  });\n\n  // The first effect is not executed, this is the effect of switching the state\n  useUpdateEffect(() => {\n    // When the filter item changes, return to the top\n    if (scrollContainerRef.current) {\n      scrollContainerRef.current.scrollTo({\n        top: 0,\n      });\n    }\n    // Perform this effect whenever a non-page change is made in the query\n  }, [context?.modalState]);\n\n  // Get next page logic\n  useEffect(() => {\n    if (!inViewPort) {\n      return;\n    }\n\n    if (dataSourceType === DataSourceType.Workflow) {\n      if (loadingStatus !== 'success' || isFetching || !hasNextPage) {\n        return;\n      }\n      fetchNextPage();\n    } else {\n      if (\n        productLoadingStatus !== 'success' ||\n        productIsFetching ||\n        !productHasNextPage\n      ) {\n        return;\n      }\n      fetchNextProductPage();\n    }\n  }, [\n    inViewPort,\n    loadingStatus,\n    isFetching,\n    hasNextPage,\n    productLoadingStatus,\n    productIsFetching,\n    productHasNextPage,\n  ]);\n\n  useEffect(() => {\n    if (!context?.modalState.isSpaceWorkflow) {\n      return;\n    }\n\n    const visibilityChangeHandler = () => {\n      const needRefresh = document.visibilityState === 'visible';\n      if (needRefresh) {\n        refetch();\n      }\n    };\n\n    document.addEventListener('visibilitychange', visibilityChangeHandler);\n    return () => {\n      document.removeEventListener('visibilitychange', visibilityChangeHandler);\n    };\n  }, [context?.modalState.isSpaceWorkflow, refetch]);\n\n  if (!context) {\n    return null;\n  }\n\n  function isTypeWorkflow(\n    _target: WorkflowInfo | ProductInfo,\n  ): _target is WorkflowInfo {\n    return context?.modalState.dataSourceType === DataSourceType.Workflow;\n  }\n\n  const { modalState, flowMode } = context;\n  const { dataSourceType } = context.modalState;\n\n  const targetLoadingStatus =\n    dataSourceType === DataSourceType.Workflow\n      ? loadingStatus\n      : productLoadingStatus;\n  const targetHasNextPage =\n    dataSourceType === DataSourceType.Workflow\n      ? hasNextPage\n      : productHasNextPage;\n  const targetList =\n    dataSourceType === DataSourceType.Workflow\n      ? targetWorkflowList\n      : workflowProductList;\n\n  const isAgentWorkflow = from === WorkflowModalFrom.WorkflowAgent;\n  const renderEmpty = () => {\n    const isNotFound = Boolean(modalState.query);\n    if (flowMode === WorkflowMode.SceneFlow) {\n      return (\n        <SearchNoResult\n          title={i18nText(ModalI18nKey.CreatedListEmptyTitle)}\n          type={'social-scene-flow'}\n          isNotFound={isNotFound}\n          notFound={isNotFound ? i18nText(ModalI18nKey.ListEmptyTitle) : ''}\n        />\n      );\n    } else {\n      return (\n        <UIEmpty\n          isNotFound={isNotFound}\n          notFound={{\n            title: i18nText(ModalI18nKey.ListEmptyTitle),\n          }}\n          empty={{\n            title: i18nText(ModalI18nKey.CreatedListEmptyTitle),\n            description: i18nText(ModalI18nKey.CreatedListEmptyDescription),\n          }}\n        />\n      );\n    }\n  };\n  return (\n    <UICompositionModalMain>\n      <Spin\n        spinning={targetLoadingStatus === 'pending'}\n        wrapperClassName={s.spin}\n        style={{ height: '100%', width: '100%' }}\n      >\n        {/* Workflow as agent support for adding dialog flows with custom imported parameters */}\n        {/* {isAgentWorkflow ? (\n          <div className=\"coz-mg-hglt px-[36px] py-[8px] mx-[24px] my-[0] rounded-[8px]\">\n            {I18n.t('wf_chatflow_133')}\n          </div>\n        ) : null} */}\n        <div\n          className={`${s['workflow-content']} new-workflow-modal-content`}\n          ref={scrollContainerRef}\n        >\n          {/* content rendering */}\n          {targetLoadingStatus !== 'pending' && targetList.length > 0 && (\n            <UICompositionModalMain.Content\n              style={{\n                minHeight: '100%',\n                paddingBottom: isAgentWorkflow ? '60px' : 0,\n              }}\n            >\n              {/* Data rendering style, list style/card style. Use card style when displaying image stream item lists */}\n              <>\n                {targetList.map((item: WorkflowInfo | ProductInfo) => (\n                  <WorkflowCard\n                    key={\n                      isTypeWorkflow(item)\n                        ? item.workflow_id\n                        : item.meta_info.entity_id\n                    }\n                    data={item}\n                    itemShowDelete={\n                      context?.bindBizType === BindBizType.DouYinBot\n                    }\n                    workflowNodes={\n                      isTypeWorkflow(item)\n                        ? workflowNodesMap[item.workflow_id || ''] ?? []\n                        : []\n                    }\n                    handleDeleteWorkflow={handleDelete}\n                    copyProductHandle={copyProduct}\n                    {...props}\n                  />\n                ))}\n              </>\n\n              {targetHasNextPage ? (\n                <div ref={intersectionObserverDom}>\n                  <div className={s['loading-more']}>\n                    <IconCozLoading className=\"animate-spin coz-fg-dim mr-[4px]\" />\n                    <div>{I18n.t('Loading')}</div>\n                  </div>\n                </div>\n              ) : null}\n            </UICompositionModalMain.Content>\n          )}\n          {targetLoadingStatus === 'success' &&\n            targetList.length === 0 &&\n            renderEmpty()}\n        </div>\n      </Spin>\n    </UICompositionModalMain>\n  );\n};\n\nexport { WorkflowModalContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useContext } from 'react';\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport { Banner, Select } from '@coze-arch/coze-design';\n\nimport WorkflowModalContext from '../workflow-modal-context';\nimport {\n  WORKFLOW_LIST_STATUS_ALL,\n  type WorkFlowModalModeProps,\n  type WorkflowModalState,\n} from '../type';\nimport { CreateWorkflowBtn } from '../sider/create-workflow-btn';\nimport styles from '../index.module.less';\nimport { useWorkflowSearch } from '../hooks/use-workflow-search';\nimport {\n  ModalI18nKey,\n  WORKFLOW_MODAL_I18N_KEY_MAP,\n} from '../hooks/use-i18n-text';\nimport { statusOptions } from '../constants';\n\nconst getStatusOptions = (showAll?: boolean) =>\n  showAll\n    ? statusOptions\n    : statusOptions.filter(item => item.value !== WORKFLOW_LIST_STATUS_ALL);\n\nconst WorkflowModalFilterForDouyin: FC<WorkFlowModalModeProps> = props => {\n  const context = useContext(WorkflowModalContext);\n  const searchNode = useWorkflowSearch();\n\n  if (!context) {\n    return null;\n  }\n\n  const { updateModalState, flowMode } = context;\n  const { status } = context.modalState;\n  const { filterOptionShowAll = false } = props;\n\n  const title = I18n.t(\n    WORKFLOW_MODAL_I18N_KEY_MAP[flowMode]?.[\n      ModalI18nKey.Title\n    ] as I18nKeysNoOptionsType,\n  );\n\n  return (\n    <div className=\"w-full\">\n      <div className=\"flex items-center w-full justify-between mt-[-4px]\">\n        <div className=\"flex items-center gap-[24px]\">\n          <div className={styles.titleForAvatar}>{title}</div>\n\n          <Select\n            insetLabel={I18n.t('publish_list_header_status')}\n            showClear={false}\n            value={status}\n            optionList={getStatusOptions(filterOptionShowAll)}\n            onChange={value => {\n              updateModalState({\n                status: value as WorkflowModalState['status'],\n              });\n            }}\n          />\n        </div>\n\n        <div className=\"flex items-center gap-[12px] mr-[12px]\">\n          <div className=\"w-[208px]\">{searchNode}</div>\n\n          <div className=\"flex items-center\">\n            <CreateWorkflowBtn\n              onCreateSuccess={props.onCreateSuccess}\n              nameValidators={props.nameValidators}\n            />\n          </div>\n        </div>\n      </div>\n\n      <Banner\n        type=\"info\"\n        className=\"mt-[16px] pt-[7px] pb-[7px] rounded-lg\"\n        description={I18n.t('dy_avatar_add_workflow_limit')}\n        closeIcon={null}\n      />\n    </div>\n  );\n};\n\nexport { WorkflowModalFilterForDouyin };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { SortType } from '@coze-arch/idl/product_api';\nimport { I18n } from '@coze-arch/i18n';\nimport { UISelect } from '@coze-arch/bot-semi';\n\nimport WorkflowModalContext, {\n  type WorkflowModalContextValue,\n} from '../workflow-modal-context';\n\nconst defaultDataSource = [\n  {\n    label: I18n.t('Popular', {}, ''),\n    value: SortType.Heat,\n  },\n  {\n    label: I18n.t('mkpl_published', {}, ''),\n    value: SortType.Newest,\n  },\n];\n\nconst queryDataSource = [\n  {\n    label: I18n.t('store_search_rank_default', {}, ''),\n    value: SortType.Relative,\n  },\n].concat(defaultDataSource);\n\nexport const SortTypeSelect = () => {\n  const context = useContext(WorkflowModalContext);\n  const { updateModalState } = context as WorkflowModalContextValue;\n  const { query, sortType } = context?.modalState || {};\n\n  const handleOnChange = value => {\n    updateModalState({ sortType: value as SortType });\n  };\n\n  return (\n    <UISelect\n      label={I18n.t('Sort')}\n      value={sortType}\n      optionList={query ? queryDataSource : defaultDataSource}\n      onChange={handleOnChange}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useContext, useMemo } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { UISelect } from '@coze-arch/bot-semi';\nimport { WorkflowMode } from '@coze-arch/bot-api/workflow_api';\nimport { SpaceType } from '@coze-arch/bot-api/playground_api';\n\nimport WorkflowModalContext from '../workflow-modal-context';\nimport { isSelectProjectCategory } from '../utils';\nimport {\n  DataSourceType,\n  MineActiveEnum,\n  WORKFLOW_LIST_STATUS_ALL,\n  type WorkFlowModalModeProps,\n  type WorkflowModalState,\n  WorkflowCategory,\n} from '../type';\nimport { CreateWorkflowBtn } from '../sider/create-workflow-btn';\nimport { useI18nText } from '../hooks/use-i18n-text';\nimport { statusOptions } from '../constants';\nimport { SortTypeSelect } from './sort-type-select';\n\nimport styles from './index.module.less';\n\nconst getStatusOptions = (showAll?: boolean) =>\n  showAll\n    ? statusOptions\n    : statusOptions.filter(item => item.value !== WORKFLOW_LIST_STATUS_ALL);\nconst flowModeOptions = [\n  {\n    label: I18n.t('filter_all'),\n    value: WorkflowMode.All,\n  },\n  {\n    label: I18n.t('library_resource_type_workflow'),\n    value: WorkflowMode.Workflow,\n  },\n  {\n    label: I18n.t('wf_chatflow_76'),\n    value: WorkflowMode.ChatFlow,\n  },\n];\n\nconst WorkflowModalFilter: FC<WorkFlowModalModeProps> = props => {\n  const context = useContext(WorkflowModalContext);\n  const { i18nText, ModalI18nKey } = useI18nText();\n  const scopeOptions = useMemo(() => {\n    if (!context) {\n      return [];\n    }\n    return [\n      {\n        label: i18nText(ModalI18nKey.TabAll),\n        value: MineActiveEnum.All,\n      },\n      {\n        label: i18nText(ModalI18nKey.TabMine),\n        value: MineActiveEnum.Mine,\n      },\n    ];\n  }, []);\n\n  if (!context) {\n    return null;\n  }\n\n  const { spaceType, updateModalState, modalState } = context;\n  const {\n    dataSourceType,\n    isSpaceWorkflow,\n    status,\n    creator,\n    listFlowMode,\n    workflowCategory,\n  } = context.modalState;\n  const {\n    hideSider,\n    hiddenCreate,\n    filterOptionShowAll = false,\n    hideCreatorSelect = false,\n    hiddenListFlowModeFilter = false,\n  } = props;\n\n  const isExampleWorkflow = workflowCategory === WorkflowCategory.Example;\n  const isAddProjectWorkflow = isSelectProjectCategory(modalState);\n  return (\n    <div\n      className={`${styles.header} ${\n        hideSider ? 'w-full justify-between' : ''\n      }`}\n    >\n      {(isSpaceWorkflow || isExampleWorkflow) &&\n      dataSourceType === DataSourceType.Workflow ? (\n        <>\n          {!hiddenListFlowModeFilter ? (\n            <UISelect\n              label={I18n.t('Type')}\n              showClear={false}\n              value={listFlowMode}\n              optionList={flowModeOptions}\n              onChange={value => {\n                updateModalState({\n                  listFlowMode: value as WorkflowMode,\n                });\n              }}\n            />\n          ) : null}\n          {isAddProjectWorkflow || isExampleWorkflow ? null : (\n            <UISelect\n              label={I18n.t('publish_list_header_status')}\n              showClear={false}\n              value={status}\n              optionList={getStatusOptions(filterOptionShowAll)}\n              onChange={value => {\n                updateModalState({\n                  status: value as WorkflowModalState['status'],\n                });\n              }}\n            />\n          )}\n\n          {spaceType === SpaceType.Team &&\n            !hideCreatorSelect &&\n            !isExampleWorkflow && (\n              <UISelect\n                label={I18n.t('Creator')}\n                showClear={false}\n                value={creator}\n                onChange={value => {\n                  updateModalState({ creator: value as MineActiveEnum });\n                }}\n                optionList={scopeOptions}\n              />\n            )}\n        </>\n      ) : null}\n      {hideSider ? (\n        <div className=\"flex items-center mr-[-24px]\">\n          {!hiddenCreate && (\n            <CreateWorkflowBtn\n              className=\"ml-12px\"\n              onCreateSuccess={props.onCreateSuccess}\n              nameValidators={props.nameValidators}\n            />\n          )}\n        </div>\n      ) : null}\n      {dataSourceType === DataSourceType.Product ? <SortTypeSelect /> : null}\n    </div>\n  );\n};\n\nexport { WorkflowModalFilter };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext, type ReactNode } from 'react';\n\nimport { WorkflowMode } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\n\nimport WorkflowModalContext from '../workflow-modal-context';\n\nexport enum ModalI18nKey {\n  Title = 'title',\n  NavigationMy = 'navigation_my',\n  NavigationTeam = 'navigation_team',\n  NavigationExplore = 'navigation_explore',\n  TabAll = 'tab_all',\n  TabMine = 'tab_mine',\n  ListEmptyTitle = 'list_empty_title',\n  CreatedListEmptyTitle = 'created_list_empty_title',\n  CreatedListEmptyDescription = 'created_list_empty_description',\n  NavigationCreate = 'navigation_create',\n  ListError = 'list_error',\n  ListItemRemove = 'list_item_remove',\n  ListItemRemoveConfirmTitle = 'list_item_remove_confirm_title',\n  ListItemRemoveConfirmDescription = 'list_item_remove_confirm_description',\n}\n\n/**\n * Use this structure when the i18n text has variables\n */\ninterface I18nKeyWithOptions {\n  /* I18n copy key */\n  key: string;\n  /* variable parameter object */\n  options?: Record<string, ReactNode>;\n}\nexport type I18nKey = string | I18nKeyWithOptions;\n\n// The key to each i18n copy used to store workflow and imageflow\nexport const WORKFLOW_MODAL_I18N_KEY_MAP: {\n  [WorkflowMode.Workflow]: Record<ModalI18nKey, I18nKey>;\n  [WorkflowMode.Imageflow]: Record<ModalI18nKey, I18nKey>;\n  [WorkflowMode.SceneFlow]: Record<ModalI18nKey, I18nKey>;\n} = {\n  [WorkflowMode.Workflow]: {\n    [ModalI18nKey.Title]: 'workflow_add_title',\n    [ModalI18nKey.NavigationMy]: 'workflow_add_navigation_my',\n    [ModalI18nKey.NavigationTeam]: 'workflow_add_navigation_team',\n    [ModalI18nKey.NavigationExplore]: 'workflow_add_navigation_explore',\n    [ModalI18nKey.TabAll]: 'workflow_add_created_tab_all',\n    [ModalI18nKey.TabMine]: 'workflow_add_created_tab_mine',\n    [ModalI18nKey.ListEmptyTitle]: 'workflow_add_list_empty_title',\n    [ModalI18nKey.CreatedListEmptyTitle]:\n      'workflow_add_created_list_empty_title',\n    [ModalI18nKey.CreatedListEmptyDescription]:\n      'workflow_add_created_list_empty_description',\n    [ModalI18nKey.NavigationCreate]: 'workflow_add_create_library',\n    [ModalI18nKey.ListError]: 'workflow_add_list_added_id_empty',\n    [ModalI18nKey.ListItemRemove]: 'workflow_add_list_remove',\n    [ModalI18nKey.ListItemRemoveConfirmTitle]:\n      'workflow_add_remove_confirm_title',\n    [ModalI18nKey.ListItemRemoveConfirmDescription]:\n      'workflow_add_remove_confirm_content',\n  },\n  [WorkflowMode.Imageflow]: {\n    [ModalI18nKey.Title]: 'imageflow_add',\n    [ModalI18nKey.NavigationMy]: 'workflow_add_navigation_my',\n    [ModalI18nKey.NavigationTeam]: 'imageflow_workspace2',\n    [ModalI18nKey.NavigationExplore]: 'imageflow_explore',\n    [ModalI18nKey.TabAll]: 'workflow_add_created_tab_all',\n    [ModalI18nKey.TabMine]: 'workflow_add_created_tab_mine',\n    [ModalI18nKey.ListEmptyTitle]: 'imageflow_detail_no_search_result',\n    [ModalI18nKey.CreatedListEmptyTitle]: 'imageflow_title',\n    [ModalI18nKey.CreatedListEmptyDescription]: 'imageflow_title_description',\n    [ModalI18nKey.NavigationCreate]: 'imageflow_create',\n    [ModalI18nKey.ListError]: 'imageflow_add_toast_error',\n    [ModalI18nKey.ListItemRemove]: 'workflow_add_list_remove',\n    [ModalI18nKey.ListItemRemoveConfirmTitle]:\n      'workflow_add_remove_confirm_title',\n    [ModalI18nKey.ListItemRemoveConfirmDescription]:\n      'workflow_add_remove_confirm_content',\n  },\n  [WorkflowMode.SceneFlow]: {\n    [ModalI18nKey.Title]: 'scene_workflow_popup_title',\n    [ModalI18nKey.NavigationMy]: 'workflow_add_navigation_my',\n    [ModalI18nKey.NavigationTeam]: 'workflow_add_navigation_team',\n    [ModalI18nKey.NavigationExplore]: 'workflow_add_navigation_explore',\n    [ModalI18nKey.TabAll]: 'workflow_add_created_tab_all',\n    [ModalI18nKey.TabMine]: 'workflow_add_created_tab_mine',\n    [ModalI18nKey.ListEmptyTitle]: 'scene_workflow_popup_search_empty',\n    [ModalI18nKey.CreatedListEmptyTitle]: 'scene_workflow_popup_list_empty',\n    // Scenario workflow not described\n    [ModalI18nKey.CreatedListEmptyDescription]: '',\n    [ModalI18nKey.NavigationCreate]: 'workflow_add_navigation_create',\n    [ModalI18nKey.ListError]: 'workflow_add_list_added_id_empty',\n    [ModalI18nKey.ListItemRemove]: {\n      key: 'scene_workflow_delete_workflow_button',\n      options: { source: I18n.t('scene_mkpl_search_title') },\n    },\n    [ModalI18nKey.ListItemRemoveConfirmTitle]: {\n      key: 'scene_workflow_delete_workflow_popup_title',\n      options: { source: I18n.t('scene_mkpl_search_title') },\n    },\n    [ModalI18nKey.ListItemRemoveConfirmDescription]: {\n      key: 'scene_workflow_delete_workflow_popup_subtitle',\n      options: { source: I18n.t('scene_mkpl_search_title') },\n    },\n  },\n};\n\n/**\n * Automatically returns the corresponding internationalization copy according to flowMode\n */\nexport function useI18nText() {\n  const context = useContext(WorkflowModalContext);\n  const flowMode = context?.flowMode ?? WorkflowMode.Workflow;\n\n  const i18nText = (key: ModalI18nKey) => {\n    const i18nKey =\n      context?.i18nMap?.[key] ||\n      WORKFLOW_MODAL_I18N_KEY_MAP[flowMode]?.[key] ||\n      WORKFLOW_MODAL_I18N_KEY_MAP[WorkflowMode.Workflow]?.[key];\n    const finalKey = typeof i18nKey === 'string' ? i18nKey : i18nKey.key;\n    return I18n.t(finalKey || '', i18nKey?.options);\n  };\n\n  return { i18nText, ModalI18nKey };\n}\n"],"names":["Select","TextArea","Form","FeedbackType","I18n","PluginModal","type","openMode","from","openModeCallback","showButton","showCopyPlugin","onCopyPluginCallback","pluginApiList","projectId","clickProjectPluginCallback","hideCreateBtn","initQuery","props","pluginApis","updateSkillPluginApis","useBotSkillStore","useShallow","store","sider","filter","content","usePluginModalParts","OpenModeType","UICompositionModal","classNames","s","usePluginApisModal","_ref","closeCallback","restProps","visible","setVisible","useState","setType","setInitQuery","node","open","params","openType","isNumber","_initQuery","undefined","close","PluginFilter","isSearching","onChange","isShowStorePlugin","spaceType","useSpaceStore","defaultId","getDefaultPluginCategory","enableSaaSPlugin","useRequest","_res_data","explore","onChangeAfterDiff","freshType","SpaceType","PluginFilterType","IconMyTools","From","IconTeamTools","UICompositionModalSider","IconCozDesktopFill","IconCozCoze","timeOptions","OrderBy","PluginModalFilter","query","setQuery","UISelect","v","PluginModalSider","onCreateSuccess","showFormPluginModel","setShowFormPluginModel","id","item","updateSearchQuery","search","debounceChangeSearch","cancel","useDebounceFn","CreateFormPluginModal","pluginID","UISearch","UIButton","window","getEmptyConf","spaceId","isMine","isTeam","isProject","PluginModalContent","onPluginApiListChange","mineActive","isOfficial","orderBy","orderByPublic","orderByFavorite","agentId","pluginType","scrollContainerRef","useRef","activeKey","setActivekey","refInfiniteScroll","scroll2Top","loadData","isFavorite","isTemplate","useInfiniteScrollCacheLoad","param","scrollContainer","triggerService","formatCacheKey","onSetScrollData","isCoze","isCreatorMine","MineActiveEnum","Number","onBeforeLoadData","current","cachedKey","isImmediateUpdate","res","getCache","data","currentPage","list","total","hasMore","DEFAULT_PAGE_SIZE","setCacheData","cacheTime","setCache","Date","nextPage","refIdList","_item_pluginInfo","uniqList","pluginId","useEffect","clearCache","fetchPlugin","scrollData","_refInfiniteScroll_current","workflowNodes","useWorkflowStore","state","useUpdateEffect","UICompositionModalMain","Collapse","value","IconChevronRight","IconChevronDown","InfiniteList","index","_item_productInfo","_item_pluginInfo1","PluginPanel","sortBy","p","String","getInitType","_initQuery_type","_initQuery_isOfficial","userInfo","userStoreService","DEFAULT_PAGE","SortType","PluginType","botId","useBotInfoStore","version","useCollaborationStore","updateQuery","refreshPage","botInfo","ProductEntityType","prev","formRuleList","getPictureUploadInitValue","info","_info_icon","_info_icon1","findAuthTypeItemV2","opts","authType","subAuthType","optsItem","optsItem1","usePluginSchame","authOption","setAuthOption","runtimeOptions","setRuntimeOptions","defaultRuntime","setDefaultRuntime","getOption","_safeJSONParse_find","_safeJSONParse","PluginDevelopApi","safeJSONParse","runtimeInfo","convertPluginMetaParams","_val_auth_type","_val_auth_type1","_val_plugin_uri_","_val_ide_code_runtime","val","headerList","creationMethod","extItemsJSON","mainAuthType","serviceSubAuthType","initParams","ParameterLocation","JSON","registerPluginMeta","updatePluginMeta","editInfo","doFormatTypeAndCreation","FormCascader","withField","Cascader","getOptionList","CLOUD_PLUGIN_COZE","PluginForm","_editInfo_meta_info_auth_type","_editInfo_meta_info1","_editInfo_meta_info2","_editInfo_meta_info3","_editInfo_meta_info4","_editInfo_meta_info5","_editInfo_meta_info6","_editInfo_meta_info_auth_type1","_editInfo_meta_info8","_editInfo_meta_info9","_editInfo_meta_info10","_editInfo_meta_info11","authTypeInitValue","_editInfo_meta_info","_creationMethodOption_find","pluginState","disabled","isCreate","formApi","extItems","setExtItems","setHeaderList","isValidCheckResult","setIsValidCheckResult","pluginTypeCreationMethod","setPluginTypeCreationMethod","FLAGS","useFlags","compareLevel","useBenefitBasic","enterpriseInfo","useCurrentEnterpriseInfo","setMainAuthType","setAuthType","disableEditUrl","setDisableEditUrl","changeVal","creationMethodOption","creationMethodTip","doGetCreationMethodTips","privateLinkMap","setPrivateLinkMap","privateNetworkListOptions","_data_private_links","UserLevel","getIcon","_res_data_icon_list","_formApi_current","DeveloperApi","IconType","iconData","url","uri","e","logger","_editInfo_meta_info_auth_type_at1","_findAuthTypeItemV2","_editInfo_meta_info_auth_type_","_editInfo_meta_info_common_params","_editInfo_meta_info7","_editInfo_meta_info_auth_type_at","reset","addHeader","deleteHeader","_","i","editHeader","header","api","values","PictureUpload","FileBizType","FormTextArea","_formApi_current_getValue","_formApi_current1","InfoPopover","Typography","option","FormSelect","extInfoText","_privateLinkMap_find","FormInput","IconButton","IconCozPlus","Row","Col","Input","name","IconCozTrashCan","locationOption","formInfo","grantTypeOptions","authOptionsPlaceholder","Fragment","usePluginFormState","ImportModal","onCancel","onSuccess","showFileImportPluginModel","setShowFileImportPluginModel","ImportPluginModal","d","Button","CreateCodePluginModal","actions","aiPlugin","setAiPlugin","clientId","setClientId","clientSecret","setClientSecret","serviceToken","setServiceToken","openApi","setOpenApi","_editInfo_code_info","_editInfo_code_info1","_editInfo_code_info2","_editInfo_code_info3","_editInfo_code_info4","desc","registerPlugin","Toast","UIModal","Space","Editor","CodeModal","showCodePluginModel","setShowCodePluginModel","IconCodeOutlined","modalTitle","useMemo","Divider","loading","setLoading","modalContent","document","confirmBtn","json","action","error","code","msg","ERROR_CODE","withSlardarIdButton","Modal","IconCozInfoCircleFill","PluginDocs","useBotCodeEditInPlugin","modalProps","pluginInfo","canEdit","unlockPlugin","wrapWithCheckLock","usePluginStore","editable","setEditable","styles","modal","useBotCodeEditOutPlugin","setPluginInfo","modalVisible","setModalVisible","disableEdit","setDisableEdit","unlockOutPluginContext","checkOutPluginContext","useCallback","disable","_res_code_info","_res_code_info1","_res_code_info2","_res_code_info3","_res_code_info4","useBotFormEditInPlugin","useImportToolInPlugin","_pluginInfo_meta_info","_pluginInfo_meta_info1","_pluginInfo_meta_info2","showImportToolModal","setShowImportToolModal","ImportToolModal","mode","height","theme","dataTestID","heightVal","setHeightVal","MonacoEditor","getFileExtension","_getContent","file","onProgress","Promise","resolve","reject","fileReader","FileReader","event","_event_target","result","CustomError","_customService","axiosInstance","axios","response","AUTH_TYPE_MAP","AuthorizationType","AUTH_LOCATION_MAP","AuthorizationServiceLocation","parsePluginInfo","openAPI","yamlParse","getKeyByValue","map","key","Object","getImportFormatType","format","PluginDataFormat","isDuplicatePathErrorResponseData","isObject","showMergeTool","duplicateInfos","onOk","IconWarningInfo","getEnv","ACCEPT_FORMAT","ACCEPT_EXT","INITIAL_PLUGIN_REPORT_PARAMS","INITIAL_TOOL_REPORT_PARAMS","IS_OVERSEA","findAuthTypeItem","_item_children","targetKey","PluginNameField","useFormApi","formValues","UIFormTextArea","_formApi_getValue","PluginDescField","_formValues_desc","PluginUrlField","UIFormInput","_formValues_url","HeaderListInnerField","filterList","cloneDeep","UIIconButton","IconAdd","h","UIInput","IconDeleteOutline","HeaderListField","AuthTypeField","_findAuthTypeItem","_formValues_auth_type","UICascader","ServiceField","_formApi_getValues","_formApi_getValues1","InputWithCountField","ExtItems","INITIAL_FORM_VALUES","PluginInfoConfirm","_importInfo_metaInfo_common_params","_formApi_current_getFormState","importInfo","submitting","setSubmitting","initialFormValues","formStateValues","authSchema","_importInfo_metaInfo_auth_type","getEditRegisterInfo","_importInfo_extra","UIToast","sendTeaEvent","EVENT_NAMES","_importInfo_extra1","_plugin_uri_","plugin_uri","extraValues","getRegisterInfo","pluginMetaInfo","oriAIPluginInfo","oriOpenAPIInfo","auth_type","common_params","location","service_token","oauth_info","icon","newAIPlugin","mergedAIPluginInfo","mergedOpenAPIInfo","yamlStringify","IconInfoCircle","FileUpload","onUpload","fileList","setFileList","customRequest","options","onError","fileInstance","extension","getContent","Upload","renderFileItemProps","onRemove","onRetry","percent","status","Image","YAMLImg","JsonImg","renderProgress","IconError","Progress","RawText","forwardRef","ref","extraProps","title","importType","setImportType","setContent","errMsg","setErrMsg","textAreaRef","handleContent","text","handleParse","originContent","isValidURL","str","Boolean","objExp","RegExp","customService","res1","_textAreaRef_current","RadioGroup","Radio","ImportPluginModalContent","importPluginInfo","setImportPluginInfo","space_type","reportParams","isPersonal","convert2OpenAPI","req","_result_openAPI","openapi","ai_plugin","plugin_data_format","metaImportPluginInfo","getInitialPluginMetaInfo","_openAPI_servers_","_aiPlugin_common_params","_aiPlugin_common_params1","_aiPlugin_common_params2","_aiPlugin_common_params3","oauthInfo","_response_data","_response_data1","success","handleConvertOpenAPI","ImportToolModalContent","handleBatchImportTool","_req_paths_to_replace","_resp_paths_created","_resp_paths_duplicated","resp","toolsCount","_response_data_paths_created","handleDupPath","paths_created","paths_duplicated","importedLength","duplicatedLength","failedContent","successContent","batchCreateReq","err","convertOpenAPI","batchImport","handleImport","importData","docsHref","initialStore","useRiskWarningStore","create","devtools","set","flag","IS_DEV_MODE","ContentMap","IconCommunityTabOutlined","IconDiscussOutlined","IconApiOutlined","handlePluginRiskWarning","pluginRiskIsRead","setPluginRiskIsRead","handleClose","PlaygroundApi","RiskAlertType","Tooltip","IconCozInfoCircle","ParameterTypeExtend","ParamsFormErrorStatus","childrenRecordName","ROWKEY","ARRAYTAG","ROOTTAG","STARTNODE","REQUESTNODE","RESPONSENODE","parameterLocationOptions","assistToExtend","extendToAssist","parameterTypeOptions","ParameterType","parameterTypeOptionsSub","parameterTypeExtendMap","FileTypeEnum","getParameterTypeOptionsWithCustom","enableFileType","parameterTypeOptionsWithCustom","label","getParameterTypeOptionsSubWithCustom","parameterTypeOptionsSubWithCustom","listLabel","getPluginParameterTypeOptions","isArrayType","parameterTypeOptionsMap","curr","parameterTypeOptionsSubMap","getParameterTypeLabel","getParameterTypeLabelFromRecord","record","methodType","paramsFormErrorStatusText","STATUS","findPathById","callback","childrenName","path","clonePath","addDepthAndValue","tree","valKey","depth","Array","handleDeepArr","deepArr","maxDeep","arr","Math","defaultNode","isArray","iscChildren","deep","nanoid","deleteNode","deleteAllChildNode","updateNodeByVal","field","updateNodeById","inherit","findTemplateNodeByPath","dsl","newPath","transformTreeToObj","checkType","acc","arrTemp","obj","isEmpty","subItem","cloneWithRandomKey","_obj_prop","_clone_sub_parameters","clone","prop","handleIsShowDelete","rootIds","isShowDelete","checkSameName","items","dataItem","checkHasArray","sleep","time","setTimeout","scrollToErrorElement","className","errorElement","scrollToBottom","ele","scrollEle","initParamsDefault","keyDefault","init","has","DefaultParamSource","addDefault","len","transformArrayToTree","array","template","arrObj","subTree","createSubTree","arrItem","tem","_subTree_sub_parameters","arrItemSubTree","childTree","_subTree_sub_parameters1","nestedSubTree","transformParamsToTree","doRemoveDefaultFromResponseParams","hasRequired","returnData","_current_sub_parameters","LazyDebug","lazy","Debug","useViewExample","_apiInfo_api_id","apiInfo","setApiInfo","Suspense","doShowExample","scene","requestParams","debugExample","requestParamsData","setWorkflowExampleValue","setStoreExampleValue","DebugExampleStatus","typesConfig","setEditToolExampleValue","exampleReqParams","setDefault","originData","currentJsonData","paramItem","_paramItem_name","_paramItem_sub_parameters","currentPathValue","get","resetWorkflowKey","currentTarget","_currentTarget_schema","_currentTarget_schema_schema","resetStoreKey","BotCreatorScene","BotCreatorContext","createContext","BotCreatorProvider","useBotCreatorContext","context","useContext","Error","ModelFormItem","_field_feedbacks","popoverContent","children","useField","Popover","commonStyles","MdBoxLazy","IconInfo","feedback","getOptions","ModelStyle","PresetRadioGroup","style","DiversityGroupItemImpl","formilyCore","formilyReact","form","isGenerationDiversityOpen","setGenerationDiversityOpen","hideDiversityCollapseButton","useModelForm","modelStyle","setModelStyle","effectId","localeForm","changedValue","IconCozArrowDown","Collapsible","modelFormComponentMap","ModelFormComponent","Switch","InputSlider","ModelFormVoidFieldComponent","useFormily","isReadonly","useBotDetailIsReadonly","ModelOptionAvatar","_model_model_status_details","_model_model_status_details1","_model_model_status_details2","model","InnerImg","cls","model_status_details","model_icon","bottomBanner","Avatar","featureIcon","FEATURE_ICON_MAP","ModelTagValue","IconCozStarFill","IconCozLightningFill","IconCozChatFill","IconCozDocumentFill","IconCozRoleFill","IconCozImageFill","IconCozVideoFill","IconCozMusic","IconCozCodeFill","IconCozWrenchFill","IconCozLightbulbFill","ModelOption","_param","_model_model_tag_list","_model_model_tag_list1","_model_model_quota","_model_model_status_details3","selected","onClick","isHovering","useHover","featureTags","t","ModelTagClass","functionTags","isProModel","isNewModelAvailable","useBenefitAvailable","PremiumPaywallScene","premiumPaywallModal","openPremiumPaywallModal","usePremiumPaywallModal","calcMaskStyle","buttonVisible","btnNum","prevNum","showBtn","gradientStart","gradientEnd","Tag","IconCozDiamondFill","feature","ModelTag","IconCozLongArrowUpCircle","OverflowList","idx","restItems","IconCozSetting","IconCozLongArrowTopRight","isFirst","isLast","ModelOptionThumb","PopoverModelListView","_selectedModel_model_status_details","hidden","selectedModelId","selectedModel","modelList","extraHeaderSlot","onModelClick","onDetailClick","onConfigClick","enableConfig","enableJumpDetail","modelGroups","renderModelOption","group","PopoverModelConfigView","onClose","modelConfigProps","formilyInitState","useInitFormily","formilyModule","retryImportFormily","Loading","IconCozWarningCircleFill","omit","primitiveExhaustiveCheck","IconCozArrowLeft","ModelForm","currentModelId","createSchemaField","FormProvider","currentConfig","onConfigChange","modelStore","agentType","diffType","createForm","useCreation","SchemaField","getSchema","handleFormInit","handleFormUnmount","useHandleModelForm","schema","ModelFormProvider","ModelSelectUI","popoverClassName","onModelChange","triggerRender","modelListExtraHeaderSlot","clickToHide","popoverPosition","popoverAutoAdjustOverflow","modalSlot","zIndex","defaultOpen","selectRef","popoverVisible","setPopoverVisible","detailConfigVisible","setDetailConfigVisible","model_type","m","isBoolean","modelId","ModelSelect","canSelectSuperiorModelProps","fetchPremiumPlan","fetchPremiumPlans","usePremiumStore","isBenefitAvailable","isFree","usePremiumType","canSelectSuperiorModel","upgradeModalState","setUpgradeModalState","premiumManageModal","openPremiumModal","usePremiumManageModal","useMount","_m_model_status_details","_m_model_status_details1","_m_model_status_details2","isFreeModel","FormilyContext","FormilyProvider","setFormilyModule","importFormily","ModelFromContext","customizeValueMapRef","setCustomizeValues","customizeValues","getFixedSingleAgentSchema","clonedSchema","properties","classId","voidField","decoratorProps","historyRoundFiled","precisionToStep","precision","getParamType","ModelParamType","getParamComponent","getComponentProps","component","max","min","rest","recordExhaustiveCheck","_item_value","convertedValue","convertModelValueType","convertModelParamsToSchema","modelParams","paramClassList","uniqBy","paramClass","a","b","_a_class_id","_b_class_id","paramDictionary","groupBy","_param_param_class","_paramClass_class_id","_paramClass_class_id1","parameterList","modelParam","paramIndex","paramField","componentProps","paramSchema","merge","useGetSchema","useModelStore","useBotEditor","_getModelById_model_params","isSingleAgent","getModelById","getFixedModelFormValues","modelParameterList","draft","_options_at_value","targetParameter","parameter","parameterType","numberedMax","numberedMin","getDiversityPresetValueByStyle","presetValues","convertModelInfoToFlatObject","modelInfo","flattenObject","target","convertFormValueToModelInfo","HistoryRound","ContextContentType","ShortMemPolicy","MinimumValueStrategy","i18nKey","_form","_field_value","onFieldInit","onFieldValueChange","fieldInitStrategies","CustomModelStyleStrategy","_field","onFieldInputValueChange","specialFieldKeyList","onValuesChange","getModelRecord","formRef","onlineModelList","offlineModelMap","getModelPreset","currentModelStyle","setCurrentModelStyle","customizeValueMap","handleStyleChange","debouncedHandleValuesChange","inputValues","formModelInfo","convertFormValuesOnInit","_modelRecord_model_style","modelRecord","defaultValues","configModelStyle","flattedModelValues","presetDiversityValue","customizeValue","expectValue","mergeValues","pick","handleModelStyleChange","_formRef_current1","_formRef_current2","_formRef_current3","modelPresetValues","_formRef_current","balance","creative","precise","_localeModel_model_params","localeModel","strategy","PluginAuthMode","IconAllActive","IconAll","getPluginApiKey","_api_plugin_id","_api_name","getApiUniqueId","filterProductListParams","formatPluginProductInfo","productInfo","_productInfo_meta_info","_productInfo_meta_info1","_productInfo_plugin_extra","apiList","_item_meta_info","_item_meta_info1","_item_meta_info2","_item_meta_info3","_item_meta_info4","_item_meta_info5","_item_meta_info6","_item_meta_info7","_item_meta_info8","_item_meta_info9","_item_meta_info10","_item_meta_info11","_item_meta_info12","_item_meta_info_user_info","_item_meta_info_user_info1","_item_meta_info_user_info2","_item_plugin_extra","_item_meta_info_category","favoriteTime","_item_card_info","_item_parameters","_getPluginFromMarket","queryParams","commParams","_res_data1","ProductApi","ProductListSource","qs","_getPluginFromFavorite","_this","_getPluginFromProject","devId","console","getPluginFromMinOrTeam","pluginTypes","_res_data_plugin_list","getPluginFromFavorite","getPluginFromProject","getPluginFromMarket","page","PluginPerfStatics","avgExecTime","callAmount","successRate","botsUseCount","ActivatePopover","show","AIButton","PluginItem","_pluginApi_card_binding_info","_pluginApi_card_binding_info1","_sortBy","isAdded","onApiToggle","pluginApi","marketStatus","marketPluginInfo","isLocalPlugin","connectors","auth_mode","productId","parameters","debug_example","exampleNode","isMouseIn","setFalse","setTrue","useBoolean","count","setCount","isFromWorkflow","isDisabled","ProductStatus","showAddConfirm","CardThumbnailPopover","_item_name","tag","UITag","ParametersPopover","Popconfirm","isSuccess","extractApiParams","paramName","apiParams","_param_input_value_content","CopyPlugin","_productInfo_connectors","_productInfo_user_info","_productInfo_user_info1","_productInfo_user_info2","_productInfo_user_info_user_label","_productInfo_user_info_user_label1","_productInfo_user_info_user_label2","_productInfo_is_official","highlightWords","showCreator","showCreateTime","showPublishTime","showMarketLink","showProjectPluginLink","isFromMarket","addonBefore","addonAfter","plugin_apis","plugin_icon","project_id","desc_for_human","create_time","update_time","statistic_data","listed_at","plugin_product_status","plugin_type","is_official","version_name","version_ts","refTarget","refHasReport","currentApiId","isFetching","setIsFetching","pluginApiNodesMap","_item_data_inputs_apiParam","apiID","isInView","useInViewport","isCheckNow","timePrefixText","timeToShow","OfficialLabel","Highlight","isUndefined","IconViewinchatOutlined","ProductPluginType","IconCozDesktop","formatNumber","ConnectorList","AvatarName","formatDate","_productInfo_tools","_api_plugin_id_toString","_pluginApiNodesMap_","addedApi","_addedApi_plugin_id_toString","_addedApi_name","emitEvent","OpenBlockEvent","PluginFrom","_i_plugin_name","_api_plugin_name","apiToSend","_result_data_plugin_list__plugin_apis","_result_data_plugin_list1","targetApi","cbResult","HandleTooltip","tipFormatter","rafRef","React","refreshKey","setRefreshKey","cancelKeepAlign","handleRender","RCSliderWrapper","step","marks","RcSlider","formateDecimalPlacesString","prevValue","decimalPlaces","numberValue","stringValue","isInteger","decimalPointIndex","formattedValue","formateDecimalPlacesNumber","pow","useRcSlider","onNumberChange","Slider","IconMinus","InputNumber","inputValue","IconPlus","plainFlags","getFlags","setTick","cb","featureFlagStorage","loader","load","config","monaco","LazyEditor","LazyDiffEditor","DiffEditor","FallbackComponent","el","deps","onEnter","onLeave","isHovered","setIsHovered","handleMouseEnter","handleMouseLeave","useLayoutEffect","fn","args","f","defaultValue","reverseValue","setState","reverseValueOrigin","toggle","effect","isMounted","MonetizationEntityType","ComponentType","TrafficScene","PluginProductStatus","ProductUnlistType","SliceStatus","FieldItemType","TableDataType","VariableChannel","VariableConnector","VariableType","ProjectResourceActionKey","ProjectResourceGroupType","ResourceCopyScene","ResType","TaskStatus","APIDebugStatus","APIMethod","AssistParameterType","CreationMethod","GrantType","OAuthStatus","OnlineStatus","PluginStatus","PluginToolAuthType","ProgramLang","SpaceRoleType","ActionKey","CopyStatus","PublishStatus","SyncOperation","RoleType","SpanStatus","SuggestReplyInfoMode","useReportTti","isLive","extra","REPORT_TTI_DEFAULT_SCENE","reportTti","fcpEntryName","lastRouteNameRef","sceneKey","performance","routeChangeEntries","lastRoute","_lastRoute_detail_location","reporter","_lastRoute_detail_location1","executeSendTtiHot","_lastRoute_startTime","fcp","executeSendTti","_PerformanceObserver_supportedEntryTypes","observer","PerformanceObserver","fcpEntry","innerError","_getSlardarInstance","ActionBarContext","useActionBarPreference","size","controller","ActionBar","onVisibleChange","trigger","internalVisible","setInternalVisible","reposKey","setReposKey","setPopoverPosition","containerRef","isReadOnly","useReadonly","selection","setSelection","editor","useEditor","injector","useInjector","position","setPosition","drawSelection","handleMousedown","handleMouseup","handleSelectionChange","_containerRef_current","selectionRange","isSelection","newPosition","PositionMirror","ThemeExtension","EditorView","InsertInputSlotAction","inInputSlot","useSelectionInInputSlot","inJinjaRaw","useSelectionInJinjaRaw","IconCozInputSlot","insertInputSlot","ExpressionEditorToken","ExpressionEditorSegmentType","ViewVariableType","ExpressionEditorTreeHelper","ArrayTypes","BASE_ARRAY_PAIR","_pair","segments","segmentsRemovedLast","lastSegment","treeLayer","segment","treeChildren","pre","cur","_cur_children","_current_variable","pathList","pathIndex","pathItem","nextSegment","isLastPathItem","treeBranch","invalid","_beforeTreeNode_variable","itemInvalid","itemValid","treeNode","beforeTreeNode","filteredTreeBranch","filteredSegments","ExpressionEditorParserBuiltin","line","offset","firstEndTokenOffset","endChars","lastStartTokenOffset","startChars","lineContent","lineOffset","reachable","unreachable","pathString","lastSegmentIndex","textSegments","textSegment","arrayIndexString","arrayIndex","ExpressionEditorParser","tokenOffsets","extractedContent","slicedReachable","reachableSegments","inlineSegments","getPopupContainer","vTree","onVisibilityChange","customApplyNode","disableUpdateTrigger","customInterpolationRule","variableTree","useDeepEqualMemo","treeRef","treeContainerRef","onVisibilityChangeRef","useLatest","posKey","setPosKey","editorRef","useSelection","focused","useFocused","baseInterpolationContent","useInterpolationContent","interpolationContent","triggerContext","useCharacterTriggerContext","completionContext","drilledVariableTree","useDrillVariableTree","filteredVariableTree","useFilteredVariableTree","emptyContent","useEmptyContent","treeRefreshKey","useTreeRefresh","useTreeSearch","optionsInfo","getOptionInfoFromDOM","elements","selectNodeByIndex","useSelectedValue","handleSelect","__","applyNode","allowVisible","setAllowVisible","next","apply","useOptionsOperations","useKeyboard","_editorRef_current","_editorRef_current1","SemiPopover","EmptyContent","TreeContainer","Tree","CursorMirror","SelectionSide","generateUniqueId","Validation","variableTreeRef","changedVariableTree","handleFocus","astDecorator","cursor","_cursor_node_firstChild","_cursor_node_lastChild","source","HighlightExpressionOnActive","anchor","pos","getInterpolationContentAtPos","view","syntaxTree","setTriggerContext","setTriggerContextRef","ViewPlugin","update","triggerCharacter","fromA","toA","fromB","toB","inserted","insertString","_node_lastChild","to","tr","hasExtraLeftBrace","characterBefore","EditorSelection","isSkipSelectionChangeUserEvent","from1","to1","fullVariableTree","matchTreeBranch","searchValue","getSearchValue","variable","setFocused","handleBlur","setTreeRefreshKey","contextRef","enable","keymap","keymapRef","handleKeydown","selectionRef","updateSelection","head","selectedIndex","newIndex","_treeRef_current_state_keyEntities_selectedDataKey","selectedElement","selectedDataKey","variableTreeNode","interpolationText","treeBrach","SKIP_SELECTION_CHANGE_USER_EVENT","SELECTED_OPTION_CLASSNAME","SELECTED_OPTION_CLASSNAME_NEW","getSelectedClassName","root","foundNodes","optionElements","element","newSelectedElement","textBefore","composeTransaction","getInsertTextFromNode","_ExpressionEditorParserBuiltin_toSegments","cursorOffset","isLeafNode","cursorPosition","transaction","transactions","cloneWithout","keys","lastValueRef","dequal","templateParser","TemplateParser","placeholder","textContent","InputConfigPopover","direction","ConfigModeWidgetPopover","setPlaceholder","setValue","configPopoverVisible","setConfigPopoverVisible","handleViewUpdate","range","_templateParser_getCursorTemplateData","state1","range1","content1","configPlaceholder","configValue","InputSlotWidget","onSelectionInInputSlot","readonly","markInfoField","openTemplate","SpanWidget","autoSelectRanges","selectionEnlarger","deletionEnlarger","markRangeInfo","useCursorInInputSlot","setInInputSlot","setInJinjaRaw","checkInJinjaRaw","isInRaw","getReferenceType","PromptReferenceType","findTargetLibrary","librarys","libraryCheck","libraryGroup","checkLibraryId","targetItem","library","checkApiId","checkId","isLibraryNameOutDate","latestLibrary","requestLibraryInfo","apiId","avatarBotId","getLibraryStatus","libraryBlockInfo","libraryStatus","targetLibrary","defaultLibraryBlockInfo","pluginIcon","workflowIcon","imageflowIcon","tableIcon","textIcon","imageIcon","getLibraryBlockInfoFromTemplate","getLibraryInfoByBlockInfo","blockInfo","_libraryTypeList_items","_libraryTypeList_items_find","libraryTypeList","RenameLibraryAction","onRename","getLibraryTooltip","libraryItem","blockDataInfo","onAddLibrary","getHiddenLibraryTooltip","getDisabledLibraryTooltip","getPublicLibraryTooltip","getOutdatedLibraryTooltip","getExistingLibraryTooltip","errorMsg","_libraryItem_name","_libraryItem_desc","_libraryItem_icon_url","LibraryItem","_item_desc","_item_icon_url","_libraryInfo_name","_libraryInfo_desc","_libraryInfo_icon_url","libraryInfo","AddLibraryAction","createElement","attributes","child","LibraryBlockWidgetType","WidgetType","_options_blockDataInfo","dom","_options_spaceId","tooltipTriggerDOM","createRoot","LibraryBlockWidgetReactCom","_this_root","hightlight","beforeMount","disabledTooltips","tooltipConfig","setTooltipConfig","loadTooltipConfig","baseElement","LibraryBlockWidget","contentFrom","contentTo","dataInfo","LibrarySearchPopover","toPosition","setToPosition","emptyLibrary","useChangeListener","_fromA","_toA","LibraryList","insertLibrary","uuid","description","avatar","icons","searchWords","LibraryTypeTextMap","onInsert","libraryItemClassName","icon_url","classnames","libraries","DefaultLibraryList","genLibraryInsertPosition","_from","ContentSearchPopover","activeTab","setActiveTab","libraryListPanel","useLibraryList","insertPosition","enableKeyboard","filterText","libraryListRef","filterLibraries","_item_items","handleLibraryInsert","rootRef","applyCallBack","selectedLibrary","previousValue","currentValue","variablesTreePanel","useVariablesTree","variableTreeFromProps","Tabs","tabBarProps","_tabBarProps_list","tab","TabPane","setIsReadOnly","StateField","postion","rangeInfo","templateString","match","regex","attrMatch","attrRegex","specs","contents","preData","newData","newText","closeTemplate","mark","Map","themes","displayType","ToolbarItemEnum","EditorEventType","DEFAULT_ZONE","ZoneDelta","DeltaSet","deltas","md2html","md","delta2md","delta","zoneDelta","ignoreAttr","checkAndGetMarkdown","normalizeSchema","input","_input_","_input_1","_input_2","Text","ToolbarButton","Plugin","LazyEditorFullInput","module","LazyEditorFullInputInner","PromptConfiguratorContext","PromptConfiguratorProvider","useCreatePromptContext","PromptInfoInput","initCount","rows","handleChange","countSuffix","ReadonlyInput","PromptHeader","onEditIconClick","IconCozEdit","CloseModal","SavePrompt","isSubmitting","onSubmit","PromptDiff","workflowId","submitFun","editId","onDiff","_editor_getValue","EMPTY_LIBRARY","ReactMarkdown","PromptConfiguratorModal","onUpdateSuccess","promptSectionConfig","enableDiff","defaultPrompt","containerAppendSlot","formApiRef","modalMode","setModalMode","isSubmiting","actionBarVisible","setActionBarVisible","selectionInInputSlotRef","editorPlaceholder","editorActions","headerActions","editorActiveLinePlaceholder","editorExtensions","setFormValues","handleSubmit","_formApiRef_current","handleInfoModeAction","_result_id","handleUpdateModeAction","promptText","navigator","submitValues","prompt_text","prompt","libraryId","PromptEditorRender","Placeholder","ActiveLinePlaceholder","usePromptConfiguratorModal","CustomPromptConfiguratorModal","dynamicProps","setDynamicProps","PromptEditorProvider","ImportPromptWhenEmptyPlaceholder","importPromptWhenEmpty","InsertInputSlotButton","showActionGuide","setShowActionGuide","useLocalStorageState","insertInputSlotTooltipGuideKey","GuideTooltip","InsertBlankSlotGuideEn","BlankSlotShortCutIcon","BasePromptConfiguratorModal","BaseUsePromptConfiguratorModal","prec","LanguageSupport","languageSupport","defaultTheme","onFocus","onBlur","isControled","getEditor","apiRef","curEditor","preVal","contentAttributes","Renderer","promptPreset","EditorProvider","insertToNewline","isDocEmpty","insertPrompt","newDoc","getTeamLibraryRequest","_res_resource_list_map","_res_has_more","_res_cursor","_Number","_item_res_id","_item_actions","getRecommendLibraryRequest","_res_data_map","_item_id","_item_description","_item_prompt_text","getLibraryListByCategory","actionsMap","_actions_filter","isSelected","onActive","onDeleteAction","onEditAction","isHover","setIsHover","handleActions","IconCozMore","mutate","targetRef","threshold","reloadDeps","isNeedBtnLoadMore","resetDataIfReload","isLoadingError","setIsLoadingError","refFetchNo","refResolve","loadingMore","loadMore","noMore","reload","useInfiniteScroll","defaultData","fetchNo","_dataInfo_list_length","insertData","removeData","getDataList","reloadData","useMemoizedFn","isLoading","loadMoreDebounce","resize","loadRetry","isError","renderFooter","Spin","renderEmpty","btn","EmptyState","IconCozWarningCircle","grid","renderItem","itemClassName","scrollConf","onChangeState","retryFunc","containerClassName","emptyConf","dataList","useScroll","useImperativeHandle","List","number","Footer","Empty","getData","searchWord","category","onEmptyClick","listRef","setDataList","setIsLoading","selectedLibraryId","setSelectedLibraryId","firstLibraryId","_listRef_current_reload","_listRef_current_getDataList","newIsLoading","newDataList","card","_current_cursor","EmptyLibraryIcon","CopyPrompt","onCopyPrompt","copy","InsertToEditor","outerEditor","onInsertPrompt","EmptyPrompt","IconCozEmpty","getTabLabelMap","PromptLibrary","defaultActiveTab","getConversationId","getPromptContextInfo","tabs","onDeletePrompt","setPrompt","setSearchWord","isEmptyList","openPromptConfiguratorModal","_listRef_current","newPrompt","Search","usePromptLibraryModal","RecommendCard","setPromptText","isPopoverVisible","setIsPopoverVisible","UsePromptPopoverContent","ViewAll","RecommendCardLoading","Skeleton","useGetLibrarys","runRecommendLibrary","loadingRecommendLibrary","dataRecommendLibrary","useGetRecommendLibrarys","runTeamLibrary","loadingTeamLibrary","dataTeamLibrary","useGetTeamLibrarys","slicedData","setSlicedData","runAsync","runAsyncHandler","_data_resource_list","useScrollControl","scrollRefs","canScrollLeft","setCanScrollLeft","canScrollRight","setCanScrollRight","getTabIndex","checkScrollable","scrollRef","scrollLeft","scrollWidth","clientWidth","handleResize","scrollElement","onScroll","handleScroll","newScrollLeft","EmptyRecommend","LeftScrollButton","IconCozArrowLeftFill","RightScrollButton","IconCozArrowRightFill","Index","_data_activeTab","domRef","cardClassName","listContainerClassName","enableLibrary","handleInsertPrompt","_data_item","_index","RecommendPannel","OfficialLabelSizeMap","IconOfficialLabel","_dataInfo_list","isResponsive","useIsResponsive","UIEmpty","IllustrationFailure","canShowData","responsiveConf","ResponsiveList","visibleNum","moreNum","CozAvatar","useFavoriteStatusRequest","entityType","entityId","topicId","setIsFavorite","changeFavoriteStatus","isCurFavorite","cozeMitt","_err","useAnimationChange","isVisible","isShowAni","setIsShowAni","changeAnimationStatus","getClickAction","isCurFavoriteStatus","useFavoriteChange","isFavoriteDefault","onReportTea","onClickBefore","onFavoriteStateChange","refIsChange","onClickBeforeHandle","FavoriteIconMobile","IconMobileCollectFill","IconMobileCollect","FavoriteIcon","unCollectedIconCls","useButton","iconProps","IconCollectFilled","IconCollectStroked","FavoriteIconBtn","isMobile","isForbiddenClick","SubMenuItem","activeIcon","isActive","suffix","TYPE_ICON_MAP","IconCozBot","IconCozWorkflow","IconCozWorkspace","TYPE_COLOR_MAP","CardTag","_TYPE_COLOR_MAP_type","CardInfo","_userInfo_user_label","_userInfo_user_label1","_userInfo_user_label2","renderCardTag","descClassName","renderDescBottomSlot","CardContainer","shadowMode","CardSkeletonContainer","CardButton","TemplateCard","_props_meta_info","_props_meta_info1","_props_meta_info2","_props_meta_info_covers","_props_meta_info3","TempCardBody","DuplicateModal","_spaces_","defaultTitle","hide","setTitle","spaces","useSpaceList","TemplateCardSkeleton","imgSrc","renderImageBottomSlot","PluginCard","_props_plugin_extra","PluginCardBody","PluginCardSkeleton","num","formatted","getLevel","level","useUsageModal","_data_data_user_info","_data_data_user_info1","_data_data_user_info2","_data_data3","_data_data_call_count_limit","_data_data_call_count_limit1","_data_data_call_count_limit2","_data_data_call_count_limit3","_data_data_call_rate_limit","entity_id","getUseRadio","dayjs","formatPercent","defaultEntityAreaSort","simpleEntitySelecotorSort","defaultEntityAreaNumMap","defaultEntityAreaRefMap","entityNameMap","entityUrlMap","getEntityUrl","fromQuery","entityShowStaticsMap","_productInfo_bot_extra","_productInfo_project_extra","_productInfo_workflow_extra","getAllowEntitySortList","isLogin","getEntityType","currentEntityType","contentLength","recursionStartEntityType","entityList","nextEntityType","lastEntityType","useSearchInputStore","entityTypeList","valueIn","length","currentEntitySort","currentSelectedIndex","RecommendMore","onSearch","navigate","useNavigate","entityTypeIn","encodeURIComponent","IconCozArrowRight","entityIdKeyMap","entityTypeMap","getProductShowFrontCommonParams","metaInfo","_metaInfo_entity_type","_metaInfo_entity_type1","_metaInfo_id","_metaInfo_name","entityIdKey","StoreAvatarName","_props_metaInfo_user_info","_props_metaInfo_user_info1","_props_metaInfo_user_info2","_props_metaInfo_user_info_user_label","_props_metaInfo_user_info_user_label1","_props_metaInfo_user_info_user_label2","useItemSelect","ableKeyPressJump","onSelectedClick","itemRef","ableKeyBoardJumpDetail","jumpPage","itemRect","containerRect","EntityTypeTag","StatisticsModule","_entityShowStaticsMap_entityType","RecommendItem","_item_commercial_setting","_item_commercial_setting1","_getParamsFromQuery","_item_meta_info_entity_type","onMouseHover","onOpenDetail","entityUrl","useExposure","ProductPaidType","BusinessType","RecommendSkeleton","RecommendItemMore","requestList","IconArrowDownFill","RecommendArea","inComposition","onResultChange","contentList","setContentList","setHasMore","setContentLength","setCurrentSelectIndex","cancelSource","currentPageRef","debounce","_data_suggestion_v2","queryString","hasMoreTemp","_newList_length","newList","itemLength","_cancelSource_current","IconLoading","checkDomInTargetPath","RecommendPopover","focus","focusInput","inputContainerRef","onResultEmpty","setIsEmpty","areaRef","setAbleKeyBoardJumpDetail","resetAllContentLength","changeCurrentSelectIndexByDirection","resetCurrentSelectIndex","setCurrentEntitySort","useLoggedIn","tempAreaSort","leftEntity","closeClick","listenKeydown","enterListener","isEmptyTemp","onWheel","_containerRef_current1","_containerRef_current2","_containerRef_current3","elem","word","SearchInput","border","inputClassName","useResponsive","onActiveChange","enableFocusStyle","setFocus","setInComposition","setInputValue","setEntityTypeIn","isResultEmpty","setIsResultEmpty","inputRef","inputValueTemp","decodeURIComponent","_e","IconSearchInput","IconCozCross","isFocus","_inputRef_current","_inputRef_current1","InteractiveType","PadIcon","MouseIcon","Title","Paragraph","IteractiveItem","subTitle","MousePadSelector","onPopupVisibleChange","containerStyle","iconStyle","arrowStyle","isMouse","IconCozMouse","IconCozTablet","CACHE_KEY","SHOW_KEY","IS_MAC_OS","getPreferInteractiveType","localStorage","setPreferInteractiveType","hideGuidingPopover","needShowGuidingPopover","GuidingContent","GuidingPopover","mainTitle","buttonText","mouseOptionTitle","mouseOptionDesc","padOptionTitle","padOptionDesc","textProps","NodeType","DependencyOrigin","CustomRenderStateEntity","ConfigEntity","CustomRenderStateConfigEntity","nodes","lines","conf","getTreeIdFromNodeId","getNodeIdFromTreeId","getBezierVerticalControlPoints","fromPos","toPos","controls","rect","Rectangle","getLineId","calcDistance","fromPoint","toPoint","bezier","Bezier","Point","getStoreNode","isBlockOrderIcon","FlowNodeBaseType","isBlockIcon","getNodeExtInfo","renderNode","getFrom","is_product","transformKnowledge","knowledge","transformTable","table","transformPlugin","plugin","findNode","nodeList","n","isLoop","_node_dependency_workflow_version","hasSameId","_node_dependency","isDepEmpty","_data_edge_list","_data_node_list_","_rootNode_knowledge_list","_rootNode_plugin_version","_rootNode_table_list","_rootNode_workflow_version","rootNode","hasKnowledge","hasPlugins","hasTable","hasSubWorkflow","TreeService","_node_children","_node","c","parent","edge","fromNode","node_list","rootWorkflow","_node_children1","blocks","_c_data","connectLines","l","cloneNode","addItem","_json_blocks","_json_blocks1","blockItem","block","rootNodeJson","json2","duplicate","dupId","matchArr","history","fromId","newSchema","dupDepth","parentId","_dependencies_workflow_version","dependencies","nodeId","loop","k","_newS_data","_newS_data1","_newS_data2","newS","w","_this_globalJson_node_list","_subWorkflowSchema_data","_subWorkflowSchema_data1","_subWorkflowSchema_data2","workflowInfo","subWorkflowSchema","isNodeEnd","FILTER_NODE_TYPE","CustomLinesManager","inputPoint","queue","FlowNodeTransformData","_node_getData","_node_next_getData","_node_children_","_inlineBlocksChildren_map","inlineBlocksChildren","branchChildren","_c_children__children","_child_getData","_this__lines","requestAnimationFrame","extraLines","_from_getData","_to_getData","renderState","LINE_CLASS_NAME","CustomHoverService","mousePos","_this_linesManager","targetLine","targetLineDist","minDistance","dist","checkTarget","hoverLine","updateLines","lineId","selectNodes","activeLines","fromInclude","toInclude","Emitter","ancArr","childArr","createCustomLinesPlugin","definePluginCreator","bind","bindConfigEntity","Split","originParent","blockData","addedNodes","proxyBlock","realBlock","Arrow","color","collapseNode","hoverActivated","hoverService","useService","treeService","linesManager","entityManager","EntityManager","refresh","useRefresh","originEdges","edges","collapsed","_collapseNode_children","baseActivatedColor","useBaseColor","rerenderLines","disposable","_treeNode_children","childCount","sum","TreeContext","colorMap","contentMap","getFromText","Tags","typeText","fromText","IconCozInfinity","Icon","setError","IconChatflow","IconWorkflow","IconKnowledge","IconDatabase","IconPlugin","BaseNode","_nodeState_activatedNode","_edges_find","nodeRender","useCustomNodeRender","nodeFromProps","ctx","PlaygroundEntityContext","renderData","FlowNodeRenderData","expanded","activated","playground","usePlayground","onMouseEnter","onMouseLeave","toggleExpand","getExtInfo","updateExtInfo","getNodeForm","formState","useObserve","extraInfo","hoverNode","setHoverNode","renderLinkNode","collapseVisible","setCollapseVisible","nodeState","useConfigEntity","highlight","activatedResId","activatedVersion","isOtherVersion","_line_from","_line_from1","_node_id","ConfigProvider","NODE_WIDTH","NODE_HEIGHT","ZoomSelect","tools","usePlaygroundTools","setSelected","zoom","zoomValue","zoomOptionStyle","Dropdown","MinimapSwitch","minimapVisible","setMinimapVisible","IconCozRectangleMap","Minimap","minimapService","FlowMinimapService","MinimapRender","Interactive","interactiveType","setInteractiveType","showInteractivePanel","setShowInteractivePanel","mousePadTooltip","handleUpdateInteractiveType","interType","EditorState","Tools","useEditorProps","ConstantKeys","FlowRendererKey","createMinimapPlugin","DEFAULT","EditorProps","defaultColor","activateColor","LineSVG","bezierPath","fromEntity","hovered","setHovered","customHoverService","disposableLine","RenderLine","getPath","controlPoints","curveType","renderToPos","LinesRenderer","viewBox","isViewportVisible","activeLine","setActiveLine","visibleLines","activatedLines","allLines","FlowLinesLayer","Layer","svgContainer","checkTargetFromLine","lineDom","ratio","_this_documentTransformer","_this_documentTransformer1","domUtils","throttle","FlowRegisters","FixedLayoutRegistries","FlowNodeTransitionData","renderer","FlowNodesTransformLayer","FlowNodesContentLayer","PlaygroundLayer","FlowScrollLimitLayer","FlowScrollBarLayer","FixedLayoutContainerModule","ContainerModule","bindContributions","FlowDocumentContribution","FlowRendererContribution","FixedLayoutEditorProvider","parentContainer","others","preset","plugins","createOperationPlugin","createDefaultPreset","createPlaygroundPlugin","bindConfig","FlowDocumentOptions","FlowDocumentOptionsDefault","_ctx","_opts_scroll","_opts_scroll1","createPlaygroundReactPreset","customPluginContext","container","createPluginContextDefault","FlowDocument","PlaygroundReactProvider","ResourceTree","editorProps","EditorRenderer","ExternalStore","Set","recipe","newState","produce","unstable_batchedUpdates","listener","onStoreChange","enableMapSet","FeatureRegistryManager","featureRegistry","FeatureRegistry","defaultFeature","castDraft","features","types","loadedFeature","featureMap","modules","_this_getDefaultType","_this_getDefaultType1","featureTypeParser","_this_defaultFeature","parser","_f_tags","_feature_tags","PreviewMd","fileUrl","mdContent","setMdContent","fetch","_render","render","PreviewTxt","txtContent","setTxtContent","pdfjs","usePreviewPdf","numPages","setNumPages","setCurrentPage","pageHeight","setPageHeight","itemSize","scrollOffset","scale","setScale","memoizedList","AutoSizer","width","Page","pdfNode","Document","totalPages","onNext","onBack","prevPage","increaseScale","prevScale","decreaseScale","getTreeNodes","_root_id","_root_parent","getChildren","_item_parent","_target_children","_found_id","_found_parent","found","findDescendantIDs","ids","findChild","handleTreeNodeMove","positions","dragSegmentIdx","resSegments","dragSegment","parentSegment","dropIndex","originalIndex","oldParent","handleDeleteNode","handleMergeNodes","descendants","_segmentToMerge_type","segmentToMerge","descendant","childId","mergedSegment","SegmentTree","setLevelSegments","setSelectionIDs","selectedThroughParent","setSelectedThroughParent","useResizeObserver","onSelect","popoverNode","onContextMenu","useSegmentContextMenu","_treeNode_children1","onDelete","onMerge","setTreeNode","useKnowledgeParams","Menu","MenuSubMenu","clickX","clickY","ideDom","left","top","newSegments","dragIds","Cursor","_data_children","dragHandle","isOpen","isLeaf","expandIcon","indent","isSearchable","selectedID","levelSegments","treeDisabled","treeVisible","setSearchValue","DocumentItem","LevelOperation","MergeOperation","DeleteOperation","eventBus","mitt","useEventListener","eventName","handler","createEditorActionFeatureRegistry","isValidSize","LIMIT_SIZE","getBase64","CustomUpload","fileItem","_currentFile_fileInstance","currentFile","handleCustomUploadRequest","object","onFinish","onFinally","onBeforeUpload","base64","_e_total","dataReporter","DataNamespace","ReportEventNames","BaseUploadImage","showTooltip","renderUI","TooltipWrapper","_result_tosKey","UploadImageButton","IconCozImage","UploadImageMenu","useOutEditorMode","exclude","onExitEditMode","handleClickOutside","_ref_current","EditorContextMenu","editorActionRegistry","contextMenuRef","x","y","_contextMenuRef_current","Component","DocumentEditor","editorContextMenuItemsRegistry","editorBottomSlot","contextMenuPosition","openContextMenu","useControlContextMenu","newContent","getEditorContent","getEditorTableClassname","getEditorImgClassname","getEditorWordsCls","EditorContent","AddAfterAction","chunk","chunks","addEmptyChunkAfter","useAddEmptyChunkAction","newChunk","newChunks","KnowledgeE2e","IconCozDocumentAddBottom","AddBeforeAction","addEmptyChunkBefore","IconCozDocumentAddTop","DeleteAction","deleteChunk","useDeleteAction","EditAction","createHoverEditBarActionFeatureRegistry","HoverEditBar","hoverEditBarActionsRegistry","onChunksChange","isAudiFailed","createPreviewContextMenuItemFeatureRegistry","useHoverEffect","hoveredChunk","setHoveredChunk","chunkId","DocumentChunkPreview","_chunk_content","_DOMPurify_sanitize","locateId","getRenderHtmlContent","previewContextMenuItemsRegistry","DocumentPreview","onActivateEditMode","PreviewContextMenu","prevProps","nextProps","setContextMenuPosition","closeContextMenu","useDeleteChunk","deleteSlice","sliceId","KnowledgeApi","chunksRef","_currentChunks_find_sequence","currentChunks","sequence","createLocalChunk","updatedChunks","ImageWithTosKey","parentAttributes","_options_dataTosKey","commands","useInitEditor","StarterKit","Table","TableRow","TableCell","TableHeader","editorInstance","slice","_event_clipboardData","html","htmlContent","isEditorContentChange","_chunks_find","processEditorContent","useUpdateChunk","updateSlice","updateLoading","updateContent","useUpdateRemoteChunk","onUpdateChunk","updateRemoteChunk","updateChunks","useDeleteRemoteChunk","onDeleteChunk","deleteRemoteChunk","deleteRemoteChunkService","useDeleteLocalChunk","deleteLocalChunk","deleteLocalChunkService","useCreateChunk","documentId","_data_slice_id","createRemoteChunk","REPORT_EVENTS","useCreateLocalChunk","onAddChunk","createChunk","_chunk_sequence","updateLocalChunk","useSaveChunk","saveRemoteChunk","saveLocalChunk","saveChunk","EditorToolbar","actionRegistry","editorContextActionFeatureRegistry","editorContextActionRegistry","previewContextMenuItemFeatureRegistry","hoverEditBarActionFeatureRegistry","previewContextMenuItemsContributes","hoverEditBarActionsContributes","BaseTextKnowledgeEditor","initialChunks","setChunks","activeChunk","setActiveChunk","targetChunk","TitleChunkPreview","ImageChunkPreview","htmlText","link","caption","DOMPurify","createLocateChunkId","getLevelDocumentTree","_root_content","_item_content","parentPath","_found_content","currentPath","renderLevel","withTitle","useScrollToSelection","selectionIDs","firstSelectedId","useActiveChunk","activeChunkInfo","setActiveChunkInfo","clearActiveChunk","setActiveChunkWithLevel","isActiveChunk","LevelTextKnowledgeEditor","levelDocumentTree","RenderContent","_levelDocumentTree_children","_levelDocumentTree_image_detail_links_","_levelDocumentTree_image_detail_base64","_levelDocumentTree_image_detail_caption","childrenContent","updateChunkContent","activedChunk","localSliceId","localChunkSliceId","remoteChunkSliceId","_props_slice_id","singleParagraphMatch","removeEditorWrapperParagraph","doc","DOMParser","generatedParagraphs","fragment","DEFAULT_ALLOWED_TAGS","escapeHtml","unsafe","allowedTags","allowedTagsPattern","tagRegex","useTosContent","tosUrl","useKnowledgeNavigate","knowledgePageQuery","getKnowledgeIDEQuery","opt","urlObject","URL","queryKey","queryValue","pathname","isPathType","search1","searchParams","URLSearchParams","isNumberType","useGetKnowledgeListInfo","cacheKey","capture","useErrorHandler","_res_dataset_list","sessionStorage","importKnowledgeMenuSourceFeatureRegistry","knowledgeTableConfigMenuRegistry","useDataSetDetailReq","run","datasetID","_res_dataset_details","curDatasetDetail","useGetKnowledgeType","dataSetDetail","fetchDataSetDetail","setDataSetDetail","storeDataSetDetail","useKnowledgeStore","UnitType","FormatType","DOCUMENT_UPDATE_TYPE_MAP","DocumentUpdateType","useListDocumentReq","KNOWLEDGE_MAX_DOC_SIZE","usePollingTaskProgress","pollingId","clearPolling","documentIds","fetchProgress","photoInfos","updatedProgressMap","detail","reportFailGetProgress","isStopPolling","useUpdateDocument","useReloadKnowledgeIDE","isDataSetLoading","fetchDocumentList","isDocumentLoading","documentList","setDocumentList","useScrollListSliceReq","dataReady","_d_list","_d_list1","_resp_total","isAllType","lastSequence","extendParams","pageSize","delSlice","sliceIds","updateValue","useCreateSlice","onReload","createSlice","_data_raw_text","KnowledgeIDEBaseLayout","keepDocTitle","renderNavBar","renderContent","onUpdateDisplayName","onStatusChange","useDataCallbacks","progressMap","setProgressMap","pollingTaskProgressInternal","isReloading","progressIds","renderContext","DataErrorBoundary","Layout","renderHtmlTitle","getBasicConfig","IconCozDocument","IconCozPlug","IconCozPencilPaper","IconCozLarkFill","IconCozGoogleDriveFill","IconCozDicumentOnline","IconCozNotionFill","IconCozWechatFill","getUnitType","DocumentSource","DOCUMENT_SOURCE_TYPE_MAP","getSourceName","docInfo","formatType","sourceType","getFormatTypeFromUnitType","getAddContentUrl","spaceID","docID","pageMode","actionType","isDouyinBot","baseUrl","OptType","createBaseDocumentChunkBySliceInfo","createLevelDocumentChunkByLevelSegment","_props_slice_sequence","getDocumentOptions","basicConfig","_progressMap_","_progressMap_1","_doc_document_id","_doc_document_id1","_doc_document_id2","DocumentStatus","useModals","docId","documentType","documentSource","onUpdateFrequency","deleteModalNode","showDeleteModal","useDeleteUnitModal","updateFrequencyModalNode","showUpdateFrequencyModal","useUpdateFrequencyModal","formData","useDocumentManagement","curDocId","setCurDocId","prevDocIdRef","updateDocument","handleSelectDocument","handleRenameDocument","newName","handleUpdateDocumentFrequency","UpdateType","rollbackDocumentSelection","useInitSelectFirstDoc","_documentList__document_id","useFilePreview","showOriginalFile","setShowOriginalFile","handleToggleOriginalFile","checked","useDocumentInfo","_progressMap_curDocId","_dataSetDetail_dataset_id","curDoc","isProcessing","processFinished","datasetId","useSliceData","curChunkType","sliceData","ChunkType","_sliceData_list_map","handleContentChange","_sliceData_total","useLevelSegments","_curDoc_chunk_strategy","treeContent","tosLoading","renderLevelSegmentsData","_treeContent_chunks","_curDoc_name","handleLevelSegmentsChange","handleLevelSegmentDelete","useSliceCounter","handleIncreaseSliceCount","handleDecreaseSliceCount","DocTag","documentInfo","updateFrequencyStr","_documentInfo_update_type","renderSegmentTag","format_type","chunk_strategy","DocSelector","setSearch","docName","setDocName","debounceSetSearch","handledOptions","op","_op_text","regx","setDocNameFn","_options_find","handleEditDocName","handleSaveDocName","TextToolbar","curFormatType","docOptions","onChangeDoc","onRenameDoc","onToggleOriginalFile","onResegment","linkOriginUrlButton","fetchSliceButton","showUpdateFreBtn","isFeishuOrLarkDocumentSource","showDeleteDocBtn","showResegmentButton","showFetchSliceBtn","IconCozAdjust","IconCozHistory","LevelContent","onLevelSegmentsChange","onLevelSegmentDelete","IllustrationNoResult","IconSegmentEmpty","FilePreview","fileType","IconCozMinus","BaseContent","onContentChange","TextKnowledgeWorkspace","_curDoc_chunk_strategy1","_curDoc_chunk_strategy2","onChangeDocList","reloadDataset","contentWrapperRef","knowledgeParams","resourceNavigate","useDataNavigate","_curDoc_document_id","updatedDocList","fromProject","SegmentMenu","_docOptions_find","_item_document_id","_knowledgeParams_pageMode","_knowledgeParams_botID","isLocalText","KnowledgeIDERegistryContext","useKnowledgeIDERegistry","KnowledgeSourceMenu","triggerComponent","ImportKnowledgeSourceMenu","KnowledgeSourceMenuComponent","getTableFormatTooltip","KNOWLEDGE_MAX_SLICE_COUNT","getDefaultFormatTooltip","_dataSetDetail_processing_file_id_list","createBtnDisableToolTip","tooltipHandlers","ImportKnowledgeSourceButton","disabledTooltipProp","onSourceChange","disabledTooltip","dropVisible","unitType","_documentList_","IconCozArrowUp","IconMap","IconSvgSheet","IconSvgUnbound","IconSvgFile","IconWithSuffix","_IconMap_formatType","_IconMap_formatType1","_IconMap_formatType2","_IconMap_formatType3","hasSuffix","RenderDocumentIcon","isDisconnect","iconSuffixClassName","IconUnitsTable","IconUnitsFile","PhotoFilter","photoFilterValue","setPhotoFilterValue","FilterPhotoType","HeaderTags","_progressMap_docInfo_document_id","_dataSetDetail_doc_count","_dataSetDetail_slice_count","formatBytes","parseInt","StorageLocation","RelatedBotsList","classNameItem","requestError","resq","KnowledgeModalNavBar","_params_type","actionButtons","datasetDetail","beforeBack","importKnowledgeSourceButton","isImageFormat","KnowledgeIDENavBar","_dataSetDetail_bot_used_count","onChangeDataset","hideBackButton","textConfigButton","tableConfigButton","editKnowledgeModal","edit","useEditKnowledgeModal","formValue","_formValue_icon_uri","_formValue_icon_uri_at","_formValue_icon_uri_at1","isTableFormat","isShowResegmentBtn","showTableConfigButton","isShowLinkUrl","BaseKnowledgeIDENavBar","KnowledgeIDENavBarComponent","KnowledgeSourceMenuItem","testId","TextLocalModule","TextCustomModule","TableCustomModule","TableLocalModule","ImageLocalModule","createImportKnowledgeMenuSourceFeatureRegistry","registryContextValue","BaseKnowledgeTextIDE","statusInfo","_props_contentProps","_props_contentProps1","dataActions","useGetSliceListData","sliceListData","mutateSliceListData","reloadSliceList","loadMoreSliceList","isLoadingSliceList","isLoadingMoreSliceList","TableUIContext","useTableUI","TableDataContext","useTableData","TableActionsContext","useTableActions","ColumnTypeComp","getDataTypeText","getTableCacheWidthMap","tableKey","_colWidthCacheService_getTableWidthMap","getTableRenderColumnsData","sliceList","metaData","onEdit","onUpdate","cacheWidthMap","maxWidth","char_count","hit_count","sliceArr","dataWidth","columns","meta","columnIndex","_get","isEditing","ColumnType","srcList","getSrcFromImg","ImageRender","src","tosKey","newRecord","textRender","TextRender","_text","updateRecord","TagRender","ActionsRender","_record","useCreateSliceService","createItem","_sliceListData_list","_filter","_createItem_content","_curDoc_table_meta","_sliceListData_total","_list_length","createSliceContent","itemContent","_cur_column_name","_cur_id","useTableSliceOperations","openDeleteSliceModal","openTableSegmentModal","setDelSliceIds","setCurIndex","setCurSliceId","tableViewRef","slices","handleCreateSlice","createParams","handleUpdateSliceData","oldData","filterRecord","ImageIds","formatRecord","transSliceContentOutput","updateParams","indexs","_tableViewRef_current","addIndex","addIds","_slices_i","oldIndex","_slices_index","_slices_index1","useTableSegmentModal","curIndex","curSliceId","tableSegmentModalNode","fetchCreateTableSegment","fetchUpdateTableSegment","useBaseTableSegmentModal","tData","ModalActionType","useDeleteSliceModal","delSliceIds","deleteSliceModalNode","useSliceDeleteModal","lItem","_lItem_slice_id","_lItem_addId","useAddRow","increaseTableHeight","scrollTableBodyToBottom","handleAddRow","_sliceListData_list__content","addItemContent","useTableHeight","isShowAddBtn","tableH","setTableHeight","addBtnHeight","bodyDom","ADD_BTN_HEIGHT","TableContent","knowledgeIDEBiz","useKnowledgeParamsStore","rowUpdateSliceData","modalEditSlice","dataSource","TableView","AddRowButton","TableDataView","TableKnowledgeWorkspace","_useKnowledgeStore","hasShowEmptyContent","KnowledgeConfigMenu","TableConfigButton","knowledgeTableConfigMenuContributes","KnowledgeConfigMenuComponent","createTableConfigMenuRegistry","ConfigurationTableStructureModule","_documentInfo_document_id","knowledgeTableLocalConfigMenuContributes","TableLocalTableConfigButton","TableCustomTableConfigButton","KnowledgeIDETableConfig","_state_documentList","BaseKnowledgeTableIDE","AutoGenerateButton","document_id","handleGenerate","generateCaption","IconCloseKnowledge","IconWarningSize24","SvgTranslate","usePhotoDetailModal","photo","photoList","setCurrentPhotoId","textAreaLoading","setTextAreaLoading","saveButtonLoading","setSaveButtonLoading","textAreaValue","setTextAreaValue","originStatus","currentIndex","disableUpdate","handleSave","SvgArrowLeft","preId","nextId","usePhotoList","filterPhotoType","fetchPhotoList","ImageKnowledgeWorkspace","setSearchParams","useSearchParams","firstAutoOpenEditDocumentId","currentPhotoId","currentHoverCardId","setCurrentHoverCardId","reloadAsync","shouldAutoOpenDetailModal","previewPhotoList","curPhoto","resetUrlQueryParams","CardGroup","_progressMap_document_id","_progressMap_document_id1","originCaption","hasCaption","handleEdit","Card","IconImageFailOutlined","IconEdit","IconWaringRed","BaseKnowledgeImgIDE","BaseKnowledgeIDE","useKnowledgeIDEFullScreenModal","biz","renderKnowledgeIDE","curDatasetID","setCurDatasetID","useDataModal","KnowledgeParamsStoreProvider","useFetchBotInfo","setBotInfo","fetchBotInfo","updateDatasetForBot","dataset","updatedDatasetList","BotMode","_botInfo_bot_info_agents","currentAgent","agent","ReferenceUpdateType","getUpdatedDataset","_dataset_dataset","_dataset_knowledge_info","originDataset","ActionType","handleDatasetUpdate","updateSuccess","updateBotParams","getDatasetInfo","_botInfo_bot_info_knowledge","_botInfo_bot_info_agents_find_knowledge","NavBarActionButton","jump","usePageJumpService","botID","agentID","SceneType","handleActionClick","DatasetStatus","BizAgentIdeImportKnowledgeSourceButton","useBeforeKnowledgeIDEClose","hasAddDataset","datasetIds","updateSuccessJump","handleFullModalBack","BizAgentIdeKnowledgeIDENavBar","handleBotIdeBack","KnowledgeModalNavBarComponent","BizAgentKnowledgeIDE","BizLibraryKnowledgeIDE","BizProjectKnowledgeIDENavBar","BizProjectKnowledgeIDE","BizWorkflowKnowledgeIDENavBar","BizWorkflowKnowledgeIDE","useBizWorkflowKnowledgeIDEFullScreenModal","useKnowledgeIDEFullScreenModalBase","ProcessProgressItem","mainText","subText","percentFormat","tipText","ProcessStatus","initIndexOptions","start","limit","TableSettingBar","tableSettings","setTableSettings","preview_data","sheet_list","sheet","TableSettingFormFields","initValues","settings","handleFormChange","curSheet","curKeyStartRow","setting","selectProps","baseClassName","TablePreview","table_meta","startRow","sheetId","sheetName","_find","newColumns","column_name","is_semantic","column_type","previewData","RequiredColRender","tooltip","dataTestId","InputRender","autofocus","isBlurValid","initValid","validate","isPreview","maxStrLen","ValidateResult","validRes","validObj","setValidObj","validateValue","apiErrorMsg","validateStatus","renderErrorMsg","TableStructure","setData","verifyMap","baseKey","showTitle","childrenNode","tipsNode","isDragTable","tableProps","isResegment","useOptFromQuery","_verifyMap_","hasDisable","IconDragOutlined","_verifyMap_1","Wrapper","Checkbox","emptyMsg","validateField","valid","DataTypeSelect","getDataTypeOptions","sensors","useSensors","useSensor","PointerSensor","handleDragEnd","active","over","activeIndex","overIndex","arrayMove","SortableRow","listeners","setNodeRef","transform","transition","isDragging","useSortable","cssDndKit","TableStructureTitle","DndContext","restrictToVerticalAxis","SortableContext","verticalListSortingStrategy","getFileName","getNameFromFileList","unitList","_unitList_index","getFileListMap","filterFileListByUnitList","unitItem","_fileItem_response","fileItem2UnitItem","_file_response","_file_response1","_file_response2","_config_filename","KNOWLEDGE_UNIT_NAME_MAX_LEN","filterFileList","UploadStatus","filename","filterUnitList","fileListMap","unit","PreviewFile","ComponentToRender","components","IconUnknownFile","IconPDFFile","IconTextFile","IconDocxFile","loaded","getBeforeUpload","maxSizeMB","fileInfo","resultMaxSizeMB","UNIT_MAX_MB","getDocument","initPdfJsWorker","uint8Array","getUint8Array","pdfDocument","PDF_MAX_PAGES","UploadUnitFile","setUnitList","showIllustration","multiple","uploadProps","handleAcceptInvalid","signal","useUnmountSignal","handleUploadProcess","abortable","handleUploadSuccess","uploadDisabled","beforeUpload","IconCozUpload","IllustrationSuccess","getFileSizeInfo","ActionRenderByDelete","u","ActionRenderByEditName","_record_name","useEditUnitNameModal","ActionRenderByRetry","IconCozRefresh","renderSubText","statusDesc","UploadUnitTable","getColumns","curStatus","getProcessStatus","statusDescript","getTypeIcon","IconUploadMD","IconUploadPDF","IconUploadDoc","IconUploadTxt","IconUploadXLS","IconUploadCSV","IconUploadTableUrl","IconUploadTextUrl","WebStatus","EntityStatus","SUCCESSFUL_UPLOAD_PROGRESS","POLLING_TIME","TABLE_ACCEPT_LOCAL_FILE","textUploadChannelConfigMap","getTextUploadChannelConfig","channel","FrequencyDay","TableStatus","MAX_TABLE_META_COLUMN_LEN","MAX_TABLE_META_STR_LEN","DEFAULT_TABLE_SETTINGS_FROM_ONE","DEFAULT_TABLE_SETTINGS_FROM_ZERO","getSeperatorSelect","SeperatorType","getSeperatorOptionList","defaultCustomSegmentRule","SegmentMode","PreProcessRule","transformUnitList","failIds","clearTimeout","useDocIdFromQuery","Uint8Array","reportProcessDocumentFail","docInfos","reportEventName","failDocumentIds","getProcessingDescMsg","taskStatus","isThirdResegment","isIncremental","getStorageStrategyEnabled","IS_CN_REGION","getFrequencyMap","updateInterval","frequencyMap","fieldName","notationReg","matches","_match_match","isKeyInTableSettings","tableSettingsToString","getSegmentMode","rule","getSegmentCleanerParams","preProcessRules","getSeparator","separator","seperatorType","getSeperatorTypeExceptCustom","validateCommonDocResegmentStep","segmentMode","segmentRule","maxTokens","isCustomSeperatorEmpty","FooterBtnStatus","ModalMode","CreateType","VerifyType","DatabaseTabs","BatchImportStep","useDatabaseInfoModal","renderAutoGenerate","DatabaseBaseInfoModal","_initValues_icon_uri__uri","_initValues_icon_uri__url","_initValues_name","_initValues_description","_formData_icon_uri__url","_formData_icon_uri__uid","coverIcon","setCoverIcon","iconInfoGenerate","setIconInfoGenerate","setDefaultIcon","_icon_uri","_icon_url","_icon_url1","_icon_uri1","_icon_uri2","initForm","icon_uri","CozeInputWithCountField","CozeFormTextArea","BannerClassNames","DismissibleBanner","persistentKey","dismissed","setDismissed","closed","setClosed","SLSelect","errorMsgFloat","SLInput","_$state_value","_props_onFocusPopoverProps","ellipsis","maxCount","showCount","triggerFocus","$state","useReactive","hasEllipsis","LimitCountNode","cs","FormSLInput","FIELD_TYPE_OPTIONS","BotTableRWMode","RW_MODE_OPTIONS_MAP","USER_ID_FIELD","ID_FIELD","PLATFORM_FIELD","SYSTEM_FIELDS","SYSTEM_FIELD_ROW_INDEX","DatabaseFieldTitle","_FIELD_TYPE_OPTIONS_find_label","textType","tip","required","namingRegexMapper","validateNaming","errList","j","thMapper","validateFields","_listItem","listItem","thItem","thKey","verifyItem","_listItem_errorMapper","errTarget","KeyTipsNode","PopoverContent","DatabaseTableStructure","initialData","creatorId","onSave","onDeleteField","forceEdit","maxColumnNum","useComputingEnableGoToNextStep","readAndWriteModeOptions","onlyShowDatabaseInfoRWMode","enableAdd","setContentCheckErrorMsg","noop","createType","showDatabaseBaseInfo","hiddenTableBorder","isReadonlyMode","projectID","renderModeSelect","tableFieldsList","setTableFieldsList","tableBasicInfoFormRef","isModify","enableReadonly","disableReadonly","userFields","isRowMaxLimit","isExceedRowMaxLimit","databaseAuditErrorCodes","handleContentCheckError","isApiError","handleAdd","_scrollRef_current","verifyTableFields","newTableFieldsList","verifyAllBeforeSave","validatedTableFieldsList","_i_errorMapper_j","save","_initialData_extra_info","tableBasicInfo","MemoryApi","getTableNameErrorMessage","resetContentCheckErrorMsg","_values","changedV","BotE2e","Banner","UITable","keyExample","_tableFieldsList_index_errorMapper_name","newTableMemoryList","_tableFieldsList_index_errorMapper_type","UITableAction","useDatabaseCreateTableModal","onReturn","initValue","extraParams","renderGenerate","DatabaseCreateTableModal","generateTableLoading","setGenerateTableLoading","saveBtnLoading","setSaveBtnLoading","saveBtnDisabled","setSaveBtnDisabled","databaseInitValue","setDatabaseInitValue","tableStructureRef","onCreateSubmit","tableMemoryList","_ele_errorMapper_name","_ele_errorMapper_type","useLibraryCreateDatabaseModal","_userStoreService_useUserInfo","userId","databaseBaseInfo","setDatabaseBaseInfo","tableInitData","_databaseBaseInfo_icon_uri_","closeDatabaseInfoModal","closeCreateTableModal","databaseInfoModal","openDatabaseInfoModal","createTableModal","openCreateTableModal","createRes","_createRes_database_info","draft_id","IconCozKnowledgeFill","AddedButton","buttonProps","cn","DatabaseListItem","isAdd","onAdd","operateDatabase","useSelectDatabaseModal","onAddDatabase","onRemoveDatabase","onClickDatabase","onCreateDatabase","enterFrom","workflowAddList","tips","language","getUnReactiveLanguage","setCategory","dropdownVisible","setDropdownVisible","showBottomShadow","setShowBottomShadow","filterCreator","setFilterCreator","sort","setSort","keyword","setKeyword","setInitValue","createVisible","setCreateVisible","fetchDatabaseList","reqParams","key_word","filter_creator","page_offset","sort_by","TableType","SortDirection","scrollTop","scrollHeight","clientHeight","scrollBottom","handleAddDatabase","handleRemoveDatabase","handleClickDatabase","renderTemplateTips","tipsTemplateCN","tipsTemplateEN","renderInput","renderFilter","renderList","IconSpin","IllustrationNoContent","handleJumpDatabase","_res_database_info","fetchDefaultIcon","_res_icon","_res_icon1","createDatabaseModal","openCreateDatabaseModal","closeCreateDatabaseModal","databaseID","draftId","renderDatabase","SiderCategory","SelectDatabaseModal","DatabaseModeSelect","DatabaseDetailWaring","DatabaseTableStructureReadonly","fieldList","tableHeight","tableWrapperRef","ResizeObserver","entries","INT64_MAX","BigInt","INT64_MIN","isInInt64Range","bigIntValue","migratedConnectorIds","useConnectorOptions","_ref1","includeMigrated","space_id","useParams","_i_ConnectorID_toString","_i_ConnectorName","_j_ConnectorID","FormInputNumber","CozInputNumber","FormDatePicker","DatePicker","date","tableRowToFormValues","row","_field_value_toString","RowEditModal","fields","tableType","initialValues","setIsSubmitting","_formRef_current_formApi","connectorOptions","_initialValues_bstudio_connector_id","_value_toString","getSystemFieldCommonProps","_field_name","_SYSTEM_FIELD_ROW_INDEX_","commonProps","getUserFieldCommonProps","Infinity","resizeFn","column","StepUpload","databaseId","onUnitListChange","downloadTemplate","statusTextMap","StepProcess","tableSheet","connectorId","fileSize","_fileItem_fileInstance_size","progressProps","setProgressProps","_data_progress","StepPreview","_tableSheet_sheet_id","_tableSheet_header_line_idx","_tableSheet_start_line_idx","tableFields","fileUri","tableInfo","setTableInfo","tableMeta","convertFieldItemType","_res_preview_data","tableSettingsToSheet","_tableSettings_sheet_id_toString","_tableSettings_header_line_idx_toString","_tableSettings_start_line_idx_toString","StepConfig","onTableSheetChange","tableData","setTableData","tableStructure","setTableStructure","_column_column_name","_column_desc","matchedField","convertColumnType","getTableStructureColumns","BatchImportSteps","Steps","BatchImportModal","onComplete","currentStep","setCurrentStep","setTableSheet","resetSteps","getNextDisabled","ToolButtonsBar","onNewRow","onRefresh","connectorDropdownVisible","setConnectorDropdownVisible","batchImportVisible","setBatchImportVisible","batchImportConnectorId","setBatchImportConnectorId","showBatchImportModal","IconCozImport","SystemFieldWidth","DatabaseTableCell","getTableColumns","connectorNames","handleEditRow","handleDeleteRow","_item_name1","_SystemFieldWidth_","_connectorNames_field_value","BatchDeleteToolbar","selectedCount","DatabaseTableData","onAfterEditRecords","structList","_item_must_required","_item_type","setPageSize","totalRecords","setTotalRecords","dataRows","setDataRows","tableDataSource","dataRow","_data","dataRowFieldList","formattedDataRow","_key","structItem","afterEdit","selectedRows","setSelectedRows","rowEditModelVisible","setRowEditModelVisible","editingRow","setEditingRow","handleRowEditSubmit","originalConnectorId","tableFieldColumns","entires","r","_r_bstudio_id","_record_bstudio_id","paginationProps","CozPagination","DatabaseDetail","_basicInitData_icon_uri_","_databaseInfo_field_list","initialTab","needHideCloseIcon","addRemoveButtonText","onClickAddRemoveButton","onIDECallback","onAfterEditBasicInfo","basicInfoVisible","setBasicInfoVisible","createTableVisible","setCreateTableVisible","databaseInfo","setDatabaseInfo","setActiveKey","btnLoading","setBtnLoading","fetchDatabaseInfo","isReadOnlyMode","basicInitData","handleEditBasicInfo","handleChangeDatabaseMode","handleEditTable","fromLibrary","TabBar","_formData_icon_uri_","DatabaseInner","actionText","setActionText","tableID","MockTrafficEnabled","MockSetStatus","REAL_DATA_MOCKSET","MOCK_OPTION_LIST","mockSetInfoRules","MOCK_SET_ERR_CODE","LOCAL_STORAGE_KEY","latestAutoGenerationChoice","PluginMockDataGenerateMode","_getFromLocalStorage","AutoGenerateSelect","showLabel","enableMulti","defaultCount","onInit","setConfig","initMode","getFromLocalStorage","initConfig","choice","updatedConfig","isCurrent","sItem","tItem","mockSubject","bizCtx","compSubject","compBizCtx","isCurrentComponent","isEqual","ext","baseBizCtx","compExt","isCurrentScene","isSameScene","baseCompBizCxt","isWorkflowExt","isSameWorkflowTool","sMockSubjectInfo","tMockSubjectInfo","sMockInfo","tMockInfo","sBizCtx","tBizCtx","getPluginInfo","mockSubjectInfo","bizSpaceID","trafficScene","extMockSubjectInfo","componentID","parentComponentID","getMockSubjectInfo","getEnvironment","MockSetEditModal","initialInfo","needResetPopoverContainer","handleAutoGenerateSelect","_formApiRef_current1","existingId","bindSubjectInfo","autoGenerate","generateMode","generateCount","toolID","basicParams","debuggerApi","message","handleOk","getRandomName","toolName","_formApiRef_current_getValue","MockSetDeleteModal","mockSetInfo","mockSetRefCount","setMockSetRefCount","fetchRefInfo","usersUsageCount","renderTitle","IconAlertCircle","isValidRefCount","useMockInfoStore","polling","enabledMockSetInfo","timer","useInitialGetEnabledMockSet","pollingInterval","setPolling","setEnabledMockSetInfo","currentBizCtx","setCurrentBizCtx","addMockComp","removeMockComp","isPolling","setTimer","currentMockComp","restartTimer","setRestartTimer","lastRequestId","pollingTurnRef","cancelReq","requestFn","curBizCtx","currentRequestId","currentPollingTurn","mockSetBindingList","mockSetDetailSet","mockSetBindings","mockSetDetails","mockSetID","request","trafficCallerID","connectorID","connectorUID","cancelRestartTask","MockSetItem","onView","creatorName","viewOnly","disableCreator","IconUploadError","IconEyeOpened","getMockSetOption","mockSet","isInValid","getMockSetOptionList","mockSets","MockSetSelect","_optionListData_list","bizSceneCtx","baseStyle","subjectDetail","uid","selectedMockSet","setSelectedMockSet","selectedValue","optionList","setOptionList","showCreateModal","setShowCreateModal","deleteMockSet","setDeleteMockSet","preSelectionRef","selectionDomRef","inViewPort","changeMockSet","changeMockSetLoading","isBinding","getUsedScene","fetchOptionList","optionListData","_res_hasMore","infra","mockSetList","mockInfo","_mockInfo_mockSetBinding","_mockInfo_mockSetBinding1","useUnmount","closePanel","_selectionRef_current","handleView","autoGenerateConfig","renderProps","_detail_creator","_detail_creator1","IconTick","msgMap","assistTypeToDisplayMap","getDisplayType","assist_type","PluginParamTypeFormat","ParameterItem","ThemeFactory","ComponentRender","SearchNoResultLight","SearchNoResultDark","SearchNoMask","WidgetNoResultDark","WidgetNoResult","WidgetSearchNoCard","SocialSceneFlowNoResultDark","SocialSceneFlowNoResult","SocialSceneFlowSearchNoCard","SocialNoResultDark","SocialNoResult","SocialSearchNoCard","RecommendNoResultDark","RecommendNoResult","RecommendSearchNoCard","CommonNoResultDark","CommonNoResult","CommonSearchNoCard","BotNoResultDark","BotNoResult","BotSearchNoCard","renderSearchNoCard","SearchNoCard","SearchNoResult","button","notFound","isNotFound","cardPosition","textClassName","useTheme","InitialAction","PluginTypeFromApi","PLUGIN_API_TYPE_MAP","PLUGIN_SERVICE_MAP","PremiumPaywallBannerScene","voidFunc","_props","PremiumPaywallBanner","defaultState","_polling","plans","subs","hasTrial","_detail","_connectorId","_benefit","_volcanoInfo","createPluginHistoryPanelUIStore","getPluginErrorMessage","ROLE_TAG_TEXT_MAP","createPluginStore","subscribeWithSelector","_resp_data","setCanEdit","can","checkPluginIsLockedByOthers","setUpdatedInfo","initPlugin","initTool","initUserPluginAuth","setInitSuccessed","getIsIdePlugin","user","isUnlocking","updateFn","BotPluginStoreContext","BotPluginControllerContext","BotPluginStoreProvider","_store_current","usePluginHistoryPanelUIStore","pluginHistoryControllerRef","inputController","selector","useStoreWithEqualityFn","shallow","usePluginStoreInstance","usePluginCallbacks","usePluginNavigate","usePluginHistoryController","pluginHistoryController","unlockByFetch","useUnmountUnlock","unlock","getEnabledNodeTypes","_params","loopSelected","nodesMap","StandardNodeType","getUploadCDNAsset","assetName","useSupportImageflowNodesQuery","convertSchema","maxDepth","currentDepth","LazyPythonEditor","PythonEditor","LazyTypescriptEditor","TypescriptEditor","onTestRun","testRunIcon","onLanguageSelect","languageTemplates","getNodeSetterId","useNodeTestId","setterTestId","concatTestId","IconCozPlayCircle","IconCozSideCollapse","BizEditor","editorApi","setLanguage","_props_languageTemplates","_props_languageTemplates1","_editorApi_current","langTemplate","preLangTemplate","Previewer","createTheme","PublishWorkflowModal","useAudioPlayer","autoPlay","onEnded","onLoad","isPlaying","setIsPlaying","isPaused","setIsPaused","isStopped","setIsStopped","currentTime","setCurrentTime","duration","setDuration","audioRef","Blob","audio","Audio","handleTimeUpdate","handleLoadedMetadata","handleEnded","play","pause","stop","togglePlayPause","seek","useSelectVoiceModal","_options","getIsCozePro","useCozeProRightsStore","_refresh","DouyinKnowledgeListModal","NLPromptButton","NLPromptModal","NlPromptAction","NlPromptShortcut","NLPromptProvider","usePublishWorkflowModal","_modalOptions","_spaceId","useWorkflowPublishEntry","workflowQueryClient","QueryClient","withQueryClient","QueryClientProvider","workflowApi","Proxy","archWorkflowApi","EmptyFunction","PUBLIC_SPACE_ID","BOT_USER_INPUT","USER_INPUT","CONVERSATION_NAME","WORKFLOW_NAME_MAX_LEN","WORKFLOW_NAME_REGEX","NODE_TEST_ID_PREFIX","SchemaExtractorParserName","TraverseUtils","getParents","getStringifyPath","deleteSelf","SYSTEM_DELIMITERS","isWorkflowImageTypeURL","_urlObj_searchParams_get_split","urlObj","_urlObj_hostname","suffixWhiteList","hostWhiteList","btoa","parseExpression","expression","_content_path","expressionParser","expressions","getValueExpressionName","valueExpression","_valueExpression_value","inputParametersParser","inputParameters","inputParameter","parsedExpression","testIds","concatNodeTestId","isImageType","VariableTypeDTO","AssistTypeDTO","parseImagesFromOutputData","_nodeSchema_data_inputs","_nodeSchema_data1","outputData","nodeSchema","excludeNodeTypes","outputParameters","flatten","getImgList","imgList","imgListInItems","imgListInObject","namespace","infraReporter","captureException","exception","getFormValueByPathEnds","pathEnds","isFormV2","getFormValueByPathEndsV2","FlowNodeFormData","findValueByPathEnds","getFormValueByPathEndsV1","formPath","paths","newPath1","result1","isGeneralWorkflow","flowMode","WorkflowMode","isPresetStartParams","isUserInputStartParams","traverse","traverseHandler","handlerFn","handle","parents","currentNode","stringifyPath","re","ACCEPT_MAP","getFileAccept","inputType","availableFileTypes","accept","itemType","_ACCEPT_MAP_type","useCurrentEntity","getNodeTestId","setterName","WorkflowNodeContext","useWorkflowNode","WorkflowNode","_this_node_getNodeMeta","_this_node_getNodeMeta1","_this_data","errorData","FlowNodeErrorData","formItem","_this_data_nodeMeta","ValidationService","Symbol","useValidationService","useValidationServiceStore","ValueExpressionDTO","createEmpty","ViewVariableTreeNode","ValueExpressionType","BatchMode","GenerationDiversity","ConditionLogic","ConditionLogicDTO","WorkflowExecStatus","getVariableTreeNodeByPath","keyPath","keyPathToNameString","nameStringToKeyPath","nameStr","nameList","BlockInput","blockInput","rawMetaType","createString","createInteger","createFloat","createArray","createBoolean","booleanInput","toLiteral","isBlockInput","_d_input_value","ValueExpression","isRef","isLiteral","isObjectRef","isExpression","isNil","_value_content_keyPath","_value_content","NODE_ORDER","CONVERSATION_NODES","MESSAGE_NODES","CONVERSATION_HISTORY_NODES","WorkflowNodeVariablesMeta","RESPONSE_FORMAT_NAME","PARAM_TYPE_LABEL_MAP","InputType","STRING_ASSIST_TYPE_LABEL_MAP","VARIABLE_TYPE_ALIAS_MAP","JSON_INPUT_TYPES","FILE_TYPES","getLabel","getComplement","inputTypes","allTypes","arrayTypes","canDrilldown","isFileType","isVoiceType","isJSONInputType","getArraySubType","_BASE_ARRAY_PAIR_find","subType","wrapToArrayType","arrayType","getAllArrayType","useOpenWorkflowDetail","ideNavigate","useWorkflowList","enabled","fetchWorkflowListApi","setFlowMode","flowType","setFlowType","WorkFlowType","setSpaceId","setName","setStatus","setOrderBy","tags","setTags","bindBizId","setBindBizId","bindBizType","setBindBizType","loginUserCreate","setLoginUserCreate","setProjectId","initialPageParam","updatePageParam","newParam","_newParam_key","func","fetchWorkflowList","BindBizType","_resp_data_total","_resp_data_workflow_list","_item_creator","authInfo","SchemaType","WorkflowModalFrom","CheckType","_resp_data_total1","_resp_data_workflow_list1","fetchParams","resp1","_resp_data_auth_list","authItem","it","pageData","queryError","fetchNextPage","hasNextPage","isFetchingNextPage","loadingStatus","refetch","useInfiniteQuery","pageParam","lastPage","allPages","lastPageParam","_lastPageParam_page","_lastPageParam_page1","workflowList","idMap","workflow","_pageData_pages__total","handleCopy","wait","handleDelete","deleteType","DeleteType","canDelete","deleteFuc","deleteParams","needDeleteBlockwise","ExpressionEditorEvent","ExpressionEditorSignal","SuggestionActionType","findAvailableVariable","createVariableLeaves","SuggestionViewUtils","ExpressionEditorValidator","patternValidate","ImgUploadErrNo","getIsIPad","CommitItem","_data_user","_data_user1","hiddenActionMenu","enablePublishPPE","onPublishPPE","onResetToCommit","onShowCommit","hideCommitId","OperateType","semver","currentKey","showCurrent","onItemClick","onCurrentClick","useVersionHistory","setQueryParams","prevParams","fetchList","_page_version_list","intersectionObserverDom","timelineType","Timeline","css","IconCozFocus","ExpressionEditorCounter","maxLength","LeafStyle","ExpressionEditorLeaf","ExpressionEditorRender","Slate","asyncOnChange","Editable","updateState","snapshot","suggestionReducer","parseData","editorPath","allowVisibleChange","hiddenDOM","useSuggestionReducer","initialState","dispatch","useReducer","variables","nodePath","nodeVariables","availableVariables","targetVariable","availableVariable","inputs","_input_children","_availableVariable_keyPath","_availableVariable_children","_availableVariable_variable","treeChild","Node","reducer","payload","_state_ref_container_current","ReactEditor","uiOption","_uiOption_classList","_uiOption_classList1","_state_ref_suggestion_current_children__children_","optionListDom","uiOptions","_uiOptions_optionList__classList","useSelectNode","_state_parseData_segments_reachable","fullPath","insertText","Transforms","useListeners","mouseHandler","_state_ref_suggestion_current","mouseDisposer","editorSelectDisposer","compositionStartDisposer","useKeyboardSelect","selectNode","keyboardArrowHandler","selectedOption","keyboardEnterHandler","_state_ref_tree_current_state_keyEntities_selectedDataKey","_variableTreeNode_variable","_variableTreeNode_variable1","Range","keyboardESCHandler","useRenderEffect","_state_ref_tree_current","filteredKeys","end","pattern","lineText","patterns","textLines","lineIndex","ExpressionEditorModel","contentIndex","cursorContent","self","ranges","validateList","validateData","rangePath","selectedItem","selectedValidItem","parsedData","initialValue","EventEmitter","withReact","withHistory","createEditor","useWorkflowModal","showModal","hideModal","closeModal","WorkflowModal","ImageUploader","_this_validateResult","uploadResult","currentId","doUpload","upLoadFile","_result_data","_result_data1","rules","bytes","decimals","sizes","parseFloat","fileExtension","getImageSize","img","_config_rules","_config_mode","_config_timeout","fileNameCache","useImageUploader","timeout","uploaderRef","setIsError","setUri","setUrl","fileName","setFileName","_uploaderRef_current","setImgValue","targetDisplayUrl","targetUri","targetFileName","isMerge","uploadImg","_uploaderRef_current_validateResult","_uploaderRef_current_validateResult1","retryUploadImg","clearImg","isNaN","SizeSelect","minWidth","minHeight","maxHeight","selectClassName","layoutStyle","sizeOptionList","setSizeOptionList","sizeValue","setSizeValue","stringToWidthHeight","widthHeightToString","_selected_value","_sizeValue","tooltipPosition","_node_variable","Expression","inputRules","_apiRef_current","extensions","mixLanguages","SDKRenderer","prunedVariableTree","interpolationContentRef","parseWorkflowResourceBizExtend","bizExtend","ProductDraftStatus","transformResourceToWorkflowEditInfo","resource","usePublishAction","publishWorkflowModalHook","AddWorkflowToStoreEntry","_deleteModalConfig_title","_deleteModalConfig_desc","deleteModalConfig","setDeleteModalConfig","handleDeleteWorkflowResource","deleteAction","isSelfCreator","deleteConfig","okText","cancelText","deleteModal","useCopyAction","useChatflowSwitch","changeFlowMode","switchToWorkflow","_record_res_id","switchToChatflow","resource_resource_common","useWorkflowResourceMenuActions","_props_spaceId","onEditWorkflowInfo","getCommonActions","copyAction","publishAction","publishModal","actionMap","enablePublishEntry","renderWorkflowResourceActions","_getCommonActions","productDraftStatus","isImageFlow","deleteActionConfig","copyActionConfig","editConfig","chatflowConfig","workflowConfig","extraActions","useWorkflowResourceClick","onEditWorkFlow","goWorkflowDetail","sId","handleWorkflowResourceClick","useCreateWorkflowModal","hiddenTemplateEntry","nameValidators","currentWorkflow","setCurrentWorkflow","formMode","setFormMode","createModalVisible","closeCreateModal","openEditModal","workflowModalInitState","isWorkflowMode","DataSourceType","workflowModal","openCreateModal","handleEditWorkflow","partialWorkflowInfo","CreateWorkflowModal","useWorkflowResourceAction","createWorkflowModal","modals","VoiceCard","voice","IconCozPauseFill","IconCozVolume","useVoiceSource","setVoice","MultimediaApi","_data_data_voices","_data_data_voices1","VoiceSelect","voiceId","setVoiceId","openSelectVoiceModal","selectVoiceModal","getIsIPadCache","userAgent","isIPadDevice","isIPadOS","ms","langMap","isCronJobVerify","cronJob","parts","rs","cronstrue","cronJobTranslator","_langMap_lang_","lang","sensitiveWordsErrorCode","workFlow","initConfirmDisabled","customTitleRender","confirmDisabled","setConfirmDisabled","sensitiveTip","setSensitiveTip","useUserInfo","currentLocale","getValues","handleCancel","handleError","handleUpdateWorkflow","_values_icon_uri","handleCreateWorkflow","_values_icon_uri_","modelTitle","getModalTitle","isFunction","labels","iconType","LoadingButton","_labels_nameFormatRuleLabel","statusOptions","WORKFLOW_LIST_STATUS_ALL","WorkFlowListStatus","LibButton","onImport","isPublished","getInputType","CustomParameterPopover","WorkflowParameters","_data_workflow_extra_start_node_node_param_input_parameters","_data_start_node_node_param_input_parameters","WorkflowModalContext","overflowItems","slicedItems","DeleteButton","WorkflowAddedButton","i18nText","ModalI18nKey","useI18nText","WorkflowBotButton","plugin_id","isAddProjectWorkflow","isSelectProjectCategory","canAdd","isFromSocialScene","isFromWorkflowAgent","botAgentCheckResult","_data_check_result","check","formatTime","unix","defaultWorkFlowList","WorkflowCard","_data_meta_info","workFlowList","dupText","itemShowDelete","isProfessionalTemplate","dupWorkflowTpl","addWorkflow","removeWorkflow","deleteWorkflow","itemClick","useWorkflowAction","StatusMap","IconCozClockFill","IconCozCheckMarkCircleFill","creator","isSpaceWorkflow","workflowCategory","isTypeWorkflow","statusValue","WorkflowCategory","renderBottomLeftDesc","_data_meta_info_user_info","_data_meta_info_user_info_name","_data_workflow_extra","_data_workflow_extra1","timeRender","_data_creator","_data_creator_name","timeRender1","renderBotButton","ButtonContent","WorkflowModalContent","_context_modalState","excludedWorkflowIds","updateWorkflowPageParam","workflowProductList","updateProductPageParam","fetchNextProductPage","productIsFetching","productLoadingStatus","productHasNextPage","copyProduct","useWorkflowProductList","modalState","targetTags","workflowNodesMap","subFlowNodes","_item_data_inputs","targetWorkflowList","dataSourceType","visibilityChangeHandler","_target","targetLoadingStatus","targetHasNextPage","targetList","isAgentWorkflow","_workflowNodesMap_","IconCozLoading","getStatusOptions","showAll","WorkflowModalFilterForDouyin","_WORKFLOW_MODAL_I18N_KEY_MAP_flowMode","searchNode","useWorkflowSearch","updateModalState","filterOptionShowAll","CreateWorkflowBtn","defaultDataSource","queryDataSource","SortTypeSelect","sortType","flowModeOptions","WorkflowModalFilter","scopeOptions","listFlowMode","hideSider","hiddenCreate","hideCreatorSelect","hiddenListFlowModeFilter","isExampleWorkflow","WORKFLOW_MODAL_I18N_KEY_MAP","_context_flowMode","_context_i18nMap","_WORKFLOW_MODAL_I18N_KEY_MAP_WorkflowMode_Workflow","finalKey"],"mappings":"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"}