{"version":3,"file":"static/js/async/513.4f67f59d.js","sources":["webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/report-events/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/action-bar-container/index.module.less?7a4c","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/action-bar-container/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/action-bar-hover-container/index.module.less?bc74","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/action-bar-hover-container/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/utils/get-is-pushed-message.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/utils/get-is-last-group.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/utils/get-show-regenerate.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/hooks/use-tooltip-trigger.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/regenerate-message/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/frown-upon/index.module.less?5322","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/delete-message/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/copy-text-message/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/hooks/use-quote-plugin.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/quote-message/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/bot-trigger-config-button-group/index.module.less?bcb0","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/services/life-cycle/render.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/services/life-cycle/message.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/services/life-cycle/command.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/services/life-cycle/app.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/services/life-cycle/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/custom-components/message-inner-addon-bottom/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/plugin.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-area-plugin-reasoning/src/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/workflow-render/components/utils.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/workflow-render/components/node-wrapper-ui.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/workflow-render/components/question-node-render.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/workflow-render/components/input-node-render.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/workflow-render/components/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/workflow-render/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/chat-flow-render/components/utils.ts","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/chat-flow-render/components/node-wrapper-ui.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/chat-flow-render/components/question-node-render.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/chat-flow-render/components/input-node-render.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/chat-flow-render/components/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/chat-workflow-render/src/components/chat-flow-render/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/types/biz-context.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/store.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/services/life-cycle/app.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/custom-components/chat-background-ui/index.module.less?d9f3","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/custom-components/chat-background-ui/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/plugin.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/hooks/use-imperative-layout-effect.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/hooks/shortcut-bar/use-load-more.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/load-more-list/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/index.module.less?6958","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/shortcut-query.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/hooks/shortcut.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/load-more/method.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/load-more/shortcuts-load-more-list.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/assets/split-line.svg","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/variants.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/component/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/query-shortcut/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/template-shortcut/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/load-more/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/assets/load-more-arrow-up.svg","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/assets/load-more-arrow-down.svg","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-bar/index.module.less?4296","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-bar/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/get-ui-mode-by-biz-scene.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/hooks/use-upload-plugin.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/context/chat-area-state/context.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/label-with-desc/index.module.less?6fd9","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/label-with-desc/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/upload/index.module.less?cef4","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/upload/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/text-input/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/context/chat-area-state/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/submit-button/index.module.less?78fd","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/submit-button/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/select/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/placeholder/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/layout/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/form/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/root/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-template/index.module.less?8a84","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-template/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/method.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-type-select/index.module.less?190c","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-type-select/upload-contnet.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-type-select/select-content.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-type-select/method.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-type-select/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-parameter/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-default-value/upload-field.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-default-value/select-field.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-default-value/input-field.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-default-value/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/table-components.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/index.module.less?83aa","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/empty.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components/action-button/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components/field-label/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components/tip/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/method.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/types/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/dsl-template/templates.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/dsl-template/index.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/file-const.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/tool-params.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/utils/uuid.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/types/plugin-biz-context.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/stores/selection.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/stores/quote.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/stores/preference.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/services/life-cycle/message.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/services/life-cycle/command.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/services/life-cycle/app.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/utils/get-message.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/quote-button/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/menu-list/index.module.less?b5be","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/menu-list/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/constants/filter-message.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-list-float-slot/grab-menu.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/hooks/use-hide-quote.ts","webpack://@coze-studio/app/../../../common/temp/default/node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/delay.js","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/utils/get-mouse-nearby-rect.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/hooks/use-float-menu-listener.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/hooks/use-auto-get-max-position.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-list-float-slot/float-menu.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-list-float-slot/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/variants.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/quote-node/index.module.less?385e","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/quote-node/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/utils/get-refer-from-message.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-inner-top-slot/quote-top-ui.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-inner-top-slot/remote-slot.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-inner-top-slot/local-slot.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/message-inner-top-slot/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/input-addon-top/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/plugin.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/create.ts","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/hooks/use-grab-plugin.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/types/node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/types/selection.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/is-touch-device.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/constants/range.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/get-all-nodes-in-range.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/find-ancestor-node-by-tag-name.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/get-ancestor-attribute-value.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/should-refine-range.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/find-last-sibling-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/find-last-child-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/compare-node-position.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/refine-range/fix-start-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/find-nearest-link-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/refine-range/fix-link.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/refine-range/fix-end-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/get-all-child-nodes-in-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/find-not-contains-previous-sibling.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/refine-range/fix-end-empty.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/refine-range/refine-range.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/normalizer/is-grab-text-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/normalizer/is-grab-link.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/normalizer/is-grab-image.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/normalizer/get-origin-content-text.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/get-picture-node-url.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/find-picture-valid-child-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/process-node/process-special-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/normalizer/get-normalize-node-list.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/normalizer/get-humanize-content-text.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/is-range-collapsed.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/helper/get-selection-direction.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/get-ancestor-attribute-node.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/get-selection-data.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/get-rect-data.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/hooks/use-grab.ts","webpack://@coze-studio/app/../../packages/common/chat-area/text-grab/src/utils/parse-markdown-to-grab-node.ts","webpack://@coze-studio/app/../../packages/studio/components/src/dnd-provider/index.tsx","webpack://@coze-studio/app/../../packages/studio/components/src/sortable-list/hooks.ts","webpack://@coze-studio/app/../../packages/studio/components/src/sortable-list/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/types/client.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/util/error.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/types/open.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/types/conversations.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/util/storage.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/types/props.ts","webpack://@coze-studio/app/../../../common/temp/default/node_modules/.pnpm/@coze+api@1.3.5_axios@1.10.0_debug@4.3.3/node_modules/@coze/api/dist/esm/index.mjs","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-user-info.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-pagination-request.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-conversation-list.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/mobile/operate/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/mobile/index.module.less?c722","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/mobile/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/pc/operate/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/pc/index.module.less?1353","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/pc/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-list/index.module.less?9743","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-list/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/index.module.less?4ac4","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/util/json-handle.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/store/store.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/store/context.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-is-show-background.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-get-theme.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/components/shortcut-bar/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/icon/add-new-conversation.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-chat-op-info.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/components/chat-input-let-slot/index.module.less?59ba","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/components/chat-input-let-slot/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/area/index.module.less?f0d2","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/area/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/services/life-cycle/render.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/services/life-cycle/message.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/services/life-cycle/command.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/services/life-cycle/app.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/services/life-cycle/index.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/plugin.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/plugin/index.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/helper/coze-api-upload.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/helper/studio-open-client-reporter.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/hooks/use-update-conversation-name-by-message.ts","webpack://@coze-studio/app/../../../common/temp/default/node_modules/.pnpm/reconnecting-websocket@4.4.0/node_modules/reconnecting-websocket/dist/reconnecting-websocket-mjs.js","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/helper/coze-api-custom.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/use-api-client.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/context.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/use-upload-file-api.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/helper/convert-shortcut-data.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/message/message-convert-to-sdk.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/message/message-convert-to-coze.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/use-message-list.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/use-request-init.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/use-clear-message-context.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/message/message-parser.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/use-send-message.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/use-clear-history.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/use-common-hooks.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/api-adapter/use-break-message.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/use-core-manager.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/use-core-override-config.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/services/life-cycle/render.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/services/life-cycle/message.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/services/life-cycle/command.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/services/life-cycle/app.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/services/life-cycle/index.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-group-footer/use-message-group-footer-info.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-group-footer/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/hooks/use-cur-message-info.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/hooks/use-delete-message.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/components/delete-message/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box-hover-slot/use-message-hover-info.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box-hover-slot/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box-footer/use-message-footer-info.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box-footer/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box/index.module.less?121d","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/plugin.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/index.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/hooks/use-bg-background-plugin.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/chat-provider.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/loading/index.module.less?fb44","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/loading/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/pc/index.module.less?ec95","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/pc/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/mobile/index.module.less?f47d","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/mobile/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/index.module.less?8bf9","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/footer/index.module.less?6ec4","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/footer/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/error-fallback/index.module.less?7e04","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/error-fallback/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/error-boundary/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/services/life-cycle/render.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/services/life-cycle/message.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/services/life-cycle/command.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/services/life-cycle/app.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/services/life-cycle/index.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/plugin.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/plugins/event-callback/index.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/helper/get-connector-id.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/util/connector.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/services/get-bot-info.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/services/create-conversation.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/context/builder-chat-context.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/hooks/use-request-init.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/hooks/use-on-boarding-update.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/hooks/use-init-chat.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/hooks/use-core-manager.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/hooks/use-bot-user-update.ts","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/components/background/index.module.less?fa69","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/components/background/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/components/audit-panel/index.module.less?c3ce","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/components/audit-panel/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/index.module.less?a7c7","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/coze-chat.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/index.tsx","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/web-sdk/index.module.less?81ab","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/web-sdk/index.tsx","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components/action-button/index.module.less?8ffb","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/assets/shortcut-icon-default.svg","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/action-bar-container/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/action-bar-hover-container/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/bot-trigger-config-button-group/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/chat-answer-action/src/components/frown-upon/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-background/src/custom-components/chat-background-ui/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/label-with-desc/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/submit-button/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/components/short-cut-panel/widgets/upload/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-bar/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-template/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/component-type-select/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components-table/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut-tool/shortcut-edit/components/action-button/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-chat-shortcuts/src/shortcut/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/menu-list/index.module.less","webpack://@coze-studio/app/../../packages/common/chat-area/plugin-message-grab/src/custom-components/quote-node/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/components/audit-panel/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/components/background/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/builder-chat/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/chat/web-sdk/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/mobile/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-item/pc/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/conversation-list/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/conversation-list-sider/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/error-fallback/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/footer/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/mobile/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/header/pc/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/loading/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/area/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/components/chat-input-let-slot/index.module.less","webpack://@coze-studio/app/../../packages/studio/open-platform/open-chat/src/components/studio-open-chat/provider/coz-sdk/plugin/custom-components/message-box/index.module.less","webpack://@coze-studio/app/../../../common/temp/default/node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseDelay.js","webpack://@coze-studio/app/../../../common/temp/default/node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/defer.js"],"sourcesContent":["/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ReportEventNames {\n  /** Original name: chat_area_tts_voice_ws */\n  TtsVoiceWs = 'chat_answer_action_start_TTS',\n  /** Original name: chat_area_report_message */\n  ReportMessage = 'chat_answer_action_message_feedback',\n  /** Original name: chat_area_copy_text_message */\n  CopyTextMessage = 'chat_answer_action_copy_text_message',\n}\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport s from './index.module.less';\n\ninterface ActionBarContainerProps {\n  leftContent?: React.ReactNode;\n  rightContent?: React.ReactNode;\n}\n\nexport const ActionBarContainer: React.FC<\n  PropsWithChildren<ActionBarContainerProps>\n> = ({ leftContent, rightContent, children }) => (\n  <div className={s.container}>\n    <div className={s['icon-container']}>\n      <div\n        data-testid=\"chat-area.answer-action.left-content\"\n        className={s['left-content']}\n      >\n        {leftContent}\n      </div>\n      <div\n        data-testid=\"chat-area.answer-action.right-content\"\n        className={s['right-content']}\n      >\n        {rightContent}\n      </div>\n    </div>\n    {children}\n  </div>\n);\n\nActionBarContainer.displayName = 'ActionBarContainer';\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { forwardRef, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\n\nimport s from './index.module.less';\n\n// Props can be refined when subsequent iterations of TODO are expanded\ninterface ActionBarHoverContainerProps {\n  style?: React.CSSProperties;\n}\n\nexport const ActionBarHoverContainer = forwardRef<\n  HTMLDivElement,\n  PropsWithChildren<ActionBarHoverContainerProps>\n>(({ children, style }, ref) => (\n  <div\n    data-testid=\"chat-area.answer-action.hover-action-bar\"\n    className={classNames(s.container, ['coz-stroke-primary', 'coz-bg-max'])}\n    style={style}\n    ref={ref}\n  >\n    {children}\n  </div>\n));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type Message,\n  getIsNotificationMessage,\n  getIsTriggerMessage,\n  getIsAsyncResultMessage,\n} from '@coze-common/chat-area';\n\nexport const getIsPushedMessage = (\n  message: Pick<Message, 'type' | 'source'>,\n): boolean =>\n  getIsTriggerMessage(message) ||\n  getIsNotificationMessage(message) ||\n  getIsAsyncResultMessage(message);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MessageMeta } from '@coze-common/chat-area';\n\nexport const getIsLastGroup = ({\n  meta: { isFromLatestGroup, sectionId },\n  latestSectionId,\n}: {\n  meta: Pick<MessageMeta, 'isFromLatestGroup' | 'sectionId'>;\n  latestSectionId: string;\n}) => isFromLatestGroup && sectionId === latestSectionId;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Message, type MessageMeta } from '@coze-common/chat-area';\n\nimport { getIsPushedMessage } from './get-is-pushed-message';\nimport { getIsLastGroup } from './get-is-last-group';\n\nexport const getShowRegenerate = ({\n  message,\n  meta,\n  latestSectionId,\n}: {\n  message: Pick<Message, 'type' | 'source'>;\n  meta: Pick<MessageMeta, 'isFromLatestGroup' | 'sectionId'>;\n  latestSectionId: string;\n}): boolean => {\n  // Is it a pushed message?\n  const isPushedMessage = getIsPushedMessage(message);\n  if (isPushedMessage) {\n    return false;\n  }\n\n  // From the last message group\n  return getIsLastGroup({ meta, latestSectionId });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useChatAreaLayout } from '@coze-common/chat-area/hooks/public/common';\nimport { Layout } from '@coze-common/chat-uikit-shared';\n\nexport const useTooltipTrigger = (\n  defaultTrigger: 'hover' | 'click' | 'focus' | 'contextMenu',\n) => {\n  const layout = useChatAreaLayout();\n  if (layout === Layout.MOBILE) {\n    return 'custom';\n  }\n  return defaultTrigger;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useMessageBoxContext,\n  useLatestSectionId,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozRefresh } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { getShowRegenerate } from '../../utils/get-show-regenerate';\nimport { useTooltipTrigger } from '../../hooks/use-tooltip-trigger';\n\ntype RegenerateMessageProps = Omit<\n  ComponentProps<typeof IconButton>,\n  'icon' | 'iconSize' | 'onClick'\n>;\n\nexport const RegenerateMessage: React.FC<\n  PropsWithChildren<RegenerateMessageProps>\n> = ({ className, ...props }) => {\n  const { message, meta, regenerateMessage } = useMessageBoxContext();\n  const latestSectionId = useLatestSectionId();\n\n  const trigger = useTooltipTrigger('hover');\n\n  const showRegenerate = getShowRegenerate({ message, meta, latestSectionId });\n  if (!showRegenerate) {\n    return null;\n  }\n\n  return (\n    <Tooltip trigger={trigger} content={I18n.t('message_tool_regenerate')}>\n      <IconButton\n        data-testid=\"chat-area.answer-action.regenerate-message-button\"\n        size=\"small\"\n        color=\"secondary\"\n        icon={\n          <IconCozRefresh\n            className={classNames(className, 'w-[14px] h-[14px]')}\n          />\n        }\n        onClick={() => {\n          regenerateMessage();\n        }}\n        {...props}\n      />\n    </Tooltip>\n  );\n};\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useDeleteMessageGroup,\n  useIsDeleteMessageLock,\n  useMessageBoxContext,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useTooltipTrigger } from '../../hooks/use-tooltip-trigger';\n\ntype DeleteMessageProps = Omit<\n  ComponentProps<typeof IconButton>,\n  'icon' | 'iconSize' | 'onClick'\n>;\n\nexport const DeleteMessage: React.FC<PropsWithChildren<DeleteMessageProps>> = ({\n  className,\n  ...props\n}) => {\n  const { groupId } = useMessageBoxContext();\n  const trigger = useTooltipTrigger('hover');\n  const isDeleteMessageLock = useIsDeleteMessageLock(groupId);\n  const deleteMessageGroup = useDeleteMessageGroup();\n\n  return (\n    <Tooltip trigger={trigger} content={I18n.t('Delete')}>\n      <IconButton\n        data-testid=\"chat-area.answer-action.delete-message-button\"\n        disabled={isDeleteMessageLock}\n        size=\"small\"\n        icon={\n          <IconCozTrashCan\n            className={classNames(\n              'coz-fg-hglt-red',\n              className,\n              'w-[14px] h-[14px]',\n            )}\n          />\n        }\n        onClick={() => {\n          // Just index through groupId.\n          deleteMessageGroup(groupId);\n        }}\n        color=\"secondary\"\n        {...props}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps, useState, type PropsWithChildren } from 'react';\n\nimport copy from 'copy-to-clipboard';\nimport classNames from 'classnames';\nimport { getReportError } from '@coze-common/chat-area-utils';\nimport {\n  getIsTextMessage,\n  useChatArea,\n  useMessageBoxContext,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCheckMark, IconCozCopy } from '@coze-arch/coze-design/icons';\nimport { IconButton, Toast, Tooltip } from '@coze-arch/coze-design';\n\nimport { ReportEventNames } from '../../report-events';\nimport { useTooltipTrigger } from '../../hooks/use-tooltip-trigger';\n\ntype CopyTextMessageProps = Omit<\n  ComponentProps<typeof IconButton>,\n  'icon' | 'iconSize' | 'onClick'\n> & {\n  isMustGroupLastAnswerMessage?: boolean;\n  isUseExternalContent?: boolean;\n  externalContent?: string;\n};\n\nexport const CopyTextMessage: React.FC<\n  PropsWithChildren<CopyTextMessageProps>\n> = ({\n  className,\n  isMustGroupLastAnswerMessage = true,\n  isUseExternalContent = false,\n  externalContent,\n  ...props\n}) => {\n  const { reporter } = useChatArea();\n  const { message, meta } = useMessageBoxContext();\n\n  const content = isUseExternalContent\n    ? externalContent || ''\n    : message.content;\n\n  const [isCopySuccessful, setIsCopySuccessful] = useState<boolean>(false);\n  const trigger = useTooltipTrigger('hover');\n\n  // Unit s\n  const COUNT_DOWN_TIME = 3;\n\n  // The unit's is converted to a multiple of ms\n  const TIMES = 1000;\n\n  const handleCopy = () => {\n    const resp = copy(content);\n    if (resp) {\n      // Copy successful\n      setIsCopySuccessful(true);\n      setTimeout(() => setIsCopySuccessful(false), COUNT_DOWN_TIME * TIMES);\n      Toast.success({\n        content: I18n.t('copy_success'),\n        showClose: false,\n        duration: COUNT_DOWN_TIME,\n      });\n      reporter.successEvent({\n        eventName: ReportEventNames.CopyTextMessage,\n      });\n    } else {\n      // Copy failed\n      Toast.warning({\n        content: I18n.t('copy_failed'),\n        showClose: false,\n        duration: COUNT_DOWN_TIME,\n      });\n      reporter.errorEvent({\n        eventName: ReportEventNames.CopyTextMessage,\n        ...getReportError('copy_text_message_error', 'copy_text_message_error'),\n      });\n    }\n  };\n\n  const isTextMessage = getIsTextMessage(message);\n\n  if (!isTextMessage) {\n    return null;\n  }\n\n  if (!meta.isGroupLastAnswerMessage && isMustGroupLastAnswerMessage) {\n    return null;\n  }\n\n  const iconClassNames = classNames(className, 'w-[14px] h-[14px]');\n\n  return (\n    <Tooltip\n      content={isCopySuccessful ? I18n.t('copied') : I18n.t('copy')}\n      trigger={trigger}\n    >\n      <IconButton\n        data-testid=\"chat-area.answer-action.copy-button\"\n        size=\"small\"\n        icon={\n          isCopySuccessful ? (\n            <IconCozCheckMark className={iconClassNames} />\n          ) : (\n            <IconCozCopy className={iconClassNames} />\n          )\n        }\n        color=\"secondary\"\n        onClick={handleCopy}\n        {...props}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GrabPluginBizContext } from '@coze-common/chat-area-plugin-message-grab';\nimport { PluginName, useWriteablePlugin } from '@coze-common/chat-area';\n\nexport const useQuotePlugin = () => {\n  try {\n    const plugin = useWriteablePlugin<GrabPluginBizContext>(\n      PluginName.MessageGrab,\n    );\n\n    return plugin;\n  } catch (e) {\n    return null;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  parseMarkdownToGrabNode,\n  GrabElementType,\n} from '@coze-common/text-grab';\nimport { messageSource, type MessageContent } from '@coze-common/chat-core';\nimport {\n  safeAsyncThrow,\n  typeSafeJsonParseEnhanced,\n} from '@coze-common/chat-area-utils';\nimport { type GrabPluginBizContext } from '@coze-common/chat-area-plugin-message-grab';\nimport {\n  getIsImageMessage,\n  ContentType,\n  getIsTextMessage,\n  useMessageBoxContext,\n  type WriteableChatAreaPlugin,\n} from '@coze-common/chat-area';\nimport { IconCozQuotation } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useTooltipTrigger } from '../../hooks/use-tooltip-trigger';\nimport { useQuotePlugin } from '../../hooks/use-quote-plugin';\n\ntype QuoteMessageProps = Omit<\n  ComponentProps<typeof IconButton>,\n  'icon' | 'iconSize' | 'onClick'\n>;\n\nexport const QuoteMessage: React.FC<\n  PropsWithChildren<QuoteMessageProps>\n> = props => {\n  const plugin = useQuotePlugin();\n\n  const { message } = useMessageBoxContext();\n\n  if (!plugin || message.source === messageSource.Notice) {\n    return null;\n  }\n\n  return <QuoteMessageImpl {...props} />;\n};\n\n/**\n * Brothers, be careful with changes here. The pre-dependency of QuoteMessageImpl is message-grab.\n */\nexport const QuoteMessageImpl: React.FC<\n  PropsWithChildren<QuoteMessageProps>\n> = ({ className, ...props }) => {\n  // INFO: As is used here because it is clear that the parent component tries to fetch the plugin in advance and intercepts it in advance\n  // If there are any changes in the future, please be sure to pay attention here.\n  const plugin = useQuotePlugin() as WriteableChatAreaPlugin<\n    GrabPluginBizContext,\n    unknown\n  >;\n\n  const { chatAreaPluginContext, pluginBizContext } = plugin;\n\n  const { useDeleteFile } = plugin.chatAreaPluginContext.writeableHook.file;\n\n  const { getFileStoreInstantValues } =\n    chatAreaPluginContext.readonlyAPI.batchFile;\n\n  const { useQuoteStore } = pluginBizContext.storeSet;\n\n  const { onQuote } = pluginBizContext.eventCallbacks;\n\n  const { updateQuoteContent, updateQuoteVisible } = useQuoteStore.getState();\n\n  const { message, meta } = useMessageBoxContext();\n\n  const { content, content_type } = message;\n\n  const trigger = useTooltipTrigger('hover');\n\n  const deleteFile = useDeleteFile();\n\n  const deleteAllFile = () => {\n    const { fileIdList } = getFileStoreInstantValues();\n\n    fileIdList.forEach(id => deleteFile(id));\n  };\n\n  const handleQuote = () => {\n    deleteAllFile();\n\n    if (content_type === ContentType.Image) {\n      const contentObj = typeSafeJsonParseEnhanced<\n        MessageContent<ContentType.Image>\n      >({\n        str: content,\n        verifyStruct: (\n          _content: unknown,\n        ): _content is MessageContent<ContentType.Image> =>\n          _content instanceof Object && 'image_list' in _content,\n        onParseError: error => {\n          safeAsyncThrow(error.message);\n        },\n        onVerifyError: error => {\n          safeAsyncThrow(error.message);\n        },\n      });\n\n      updateQuoteContent(\n        contentObj?.image_list.map(img => ({\n          type: GrabElementType.IMAGE,\n          src: img.image_ori.url,\n          children: [],\n        })) ?? [],\n      );\n    } else {\n      const grabNodeList = parseMarkdownToGrabNode(content);\n      updateQuoteContent(grabNodeList);\n    }\n\n    onQuote?.({ botId: message.sender_id ?? '', source: message.source });\n\n    updateQuoteVisible(true);\n  };\n\n  const isTextMessage = getIsTextMessage(message);\n  const isImageMessage = getIsImageMessage(message);\n\n  if (!isTextMessage && !isImageMessage) {\n    return null;\n  }\n\n  if (!meta.isGroupLastAnswerMessage) {\n    return null;\n  }\n\n  if (!plugin) {\n    return null;\n  }\n\n  return (\n    <Tooltip content={I18n.t('quote_ask_in_chat')} trigger={trigger}>\n      <IconButton\n        data-testid=\"chat-area.answer-action.quote-message\"\n        size=\"small\"\n        icon={\n          <IconCozQuotation\n            className={classNames(className, 'w-[14px] h-[14px]')}\n          />\n        }\n        onClick={handleQuote}\n        color=\"secondary\"\n        {...props}\n      />\n    </Tooltip>\n  );\n};\n\nQuoteMessage.displayName = 'QuoteMessage';\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReadonlyRenderLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const renderLifeCycleServiceGenerator: ReadonlyRenderLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReadonlyMessageLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const messageLifeCycleServiceGenerator: ReadonlyMessageLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReadonlyCommandLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const commandLifeCycleServiceGenerator: ReadonlyCommandLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReadonlyAppLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const appLifeCycleServiceGenerator: ReadonlyAppLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReadonlyLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\nimport { renderLifeCycleServiceGenerator } from './render';\nimport { messageLifeCycleServiceGenerator } from './message';\nimport { commandLifeCycleServiceGenerator } from './command';\nimport { appLifeCycleServiceGenerator } from './app';\n\nexport const bizLifeCycleServiceGenerator: ReadonlyLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  appLifeCycleService: appLifeCycleServiceGenerator(plugin),\n  messageLifeCycleService: messageLifeCycleServiceGenerator(plugin),\n  commandLifeCycleService: commandLifeCycleServiceGenerator(plugin),\n  renderLifeCycleService: renderLifeCycleServiceGenerator(plugin),\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { memo, useEffect, useRef, useState, type FC } from 'react';\n\nimport { type Message, type ContentType } from '@coze-common/chat-core';\nimport { MdBoxLazy } from '@coze-arch/bot-md-box-adapter/lazy';\n\ntype IProps = Record<'message', Message<ContentType>>;\n\n// export const BizMessageInnerAddonBottom: FC<IProps> = p =>\n//   p.message.role === 'assistant' && p.message.reasoning_content ? (\n//     <div className=\"my-[8px] px-[14px] border-solid border-[0] border-l-[0.25em] border-l-[var(--color-border-default)] text-[var(--color-fg-muted)]\">\n//       {p.message.reasoning_content}\n//     </div>\n//   ) : null;\n\nexport const BizMessageInnerAddonBottom: FC<IProps> = memo(\n  p => {\n    const [reasoningFinished, setReasoningFinished] = useState(false);\n    const ref = useRef(p.message.reasoning_content);\n\n    useEffect(() => {\n      setReasoningFinished(ref.current === p.message.reasoning_content);\n\n      return () => {\n        ref.current = p.message.reasoning_content;\n      };\n      // Content used to trigger reasoning rerender\n    }, [p.message.reasoning_content, p.message.content]);\n\n    return p.message.role === 'assistant' && p.message.reasoning_content ? (\n      <div className=\"my-[8px]\">\n        <MdBoxLazy\n          markDown={`${p.message.reasoning_content.replace(/^/gm, '> ')}`}\n          showIndicator={!p.message.is_finish && !reasoningFinished}\n        ></MdBoxLazy>\n      </div>\n    ) : null;\n  },\n  (prev, next) =>\n    prev.message.role === next.message.role &&\n    prev.message.is_finish === next.message.is_finish &&\n    prev.message.reasoning_content === next.message.reasoning_content &&\n    prev.message.content === next.message.content,\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PluginMode,\n  PluginName,\n  ReadonlyChatAreaPlugin,\n  createReadonlyLifeCycleServices,\n  createCustomComponents,\n} from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { bizLifeCycleServiceGenerator } from './services/life-cycle';\nimport { BizMessageInnerAddonBottom } from './custom-components/message-inner-addon-bottom';\n\nexport class BizPlugin extends ReadonlyChatAreaPlugin<PluginBizContext> {\n  /**\n   * plugin type\n   * PluginMode. Readonly = read-only mode\n   * PluginMode. Writeable = Writable Mode\n   */\n  public pluginMode = PluginMode.Readonly;\n  /**\n   * plugin name\n   * Please click PluginName to define it.\n   */\n  public pluginName = PluginName.Demo;\n\n  /**\n   * lifecycle services\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public lifeCycleServices: any = createReadonlyLifeCycleServices(\n    this,\n    bizLifeCycleServiceGenerator,\n  );\n\n  /**\n   * custom component\n   */\n  public customComponents = createCustomComponents({\n    TextMessageInnerTopSlot: BizMessageInnerAddonBottom,\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { BizPlugin } from './plugin';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention -- Plugin names start with uppercase as expected\nexport const ReasoningPluginRegistry: PluginRegistryEntry<PluginBizContext> = {\n  /**\n   * Context of components throughout the plug-in lifecycle\n   */\n  createPluginBizContext() {\n    return {};\n  },\n  /**\n   * plug-in ontology\n   */\n  Plugin: BizPlugin,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isObject } from 'lodash-es';\n\nimport { type InputWorkflowNodeContent, type WorkflowNode } from './type';\n\nexport const isWorkflowNodeData = (value: unknown): value is WorkflowNode =>\n  isObject(value) && 'content' in value && 'content_type' in value;\n\nexport const isInputWorkflowNodeContent = (\n  value: unknown,\n): value is InputWorkflowNodeContent =>\n  isObject(value) && 'type' in value && 'name' in value;\n\nexport const isInputWorkflowNodeContentLikelyArray = (\n  value: unknown,\n): value is unknown[] => Array.isArray(value);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nexport const NodeWrapperUI: React.FC<PropsWithChildren> = ({ children }) => (\n  <div className=\"overflow-hidden w-full min-w-[282px] max-w-[546px]\">\n    {children}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Button, Space, Typography } from '@coze-arch/coze-design';\n\nimport { type QuestionRenderNodeProps } from './type';\nimport { NodeWrapperUI } from './node-wrapper-ui';\n\nexport const QuestionNodeRender: React.FC<QuestionRenderNodeProps> = ({\n  data,\n  onCardSendMsg,\n  readonly,\n  isDisable,\n  message,\n}) => {\n  const disabled = readonly || isDisable;\n  return (\n    <NodeWrapperUI>\n      <Space className=\"w-full\" vertical spacing={12} align=\"start\">\n        <Typography.Text ellipsis className=\"text-18px\">\n          {data.content.question}\n        </Typography.Text>\n        <Space className=\"w-full\" vertical spacing={16}>\n          {data.content.options.map((option, index) => (\n            <Button\n              key={option.name + index}\n              className=\"w-full\"\n              color=\"primary\"\n              disabled={disabled}\n              onClick={() =>\n                onCardSendMsg?.({\n                  message,\n                  extra: { msg: option.name, mentionList: [] },\n                })\n              }\n            >\n              {option.name}\n            </Button>\n          ))}\n        </Space>\n      </Space>\n    </NodeWrapperUI>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { noop } from 'lodash-es';\nimport { produce } from 'immer';\nimport { typeSafeJsonParse } from '@coze-common/chat-area-utils';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Input, Space, Typography } from '@coze-arch/coze-design';\n\nimport {\n  isInputWorkflowNodeContent,\n  isInputWorkflowNodeContentLikelyArray,\n} from './utils';\nimport { type InputRenderNodeProps } from './type';\nimport { NodeWrapperUI } from './node-wrapper-ui';\n\nexport const InputNodeRender: React.FC<InputRenderNodeProps> = ({\n  data,\n  onCardSendMsg,\n  readonly,\n  isDisable,\n  message,\n}) => {\n  const [inputData, setInputData] = useState<Record<string, string>>({});\n  const [hasSend, setHasSend] = useState(false);\n  const disabled = readonly || isDisable || hasSend;\n  const parsedContent = typeSafeJsonParse(data.content, noop);\n\n  if (!isInputWorkflowNodeContentLikelyArray(parsedContent)) {\n    return 'input node content is not supported';\n  }\n\n  const validContent = parsedContent.filter(isInputWorkflowNodeContent);\n\n  return (\n    <NodeWrapperUI>\n      <Space spacing={12} vertical className=\"w-full\">\n        {validContent.map((item, index) => (\n          <Space\n            align=\"start\"\n            className=\"w-full\"\n            spacing={6}\n            vertical\n            key={item.name + index}\n          >\n            <Typography.Text ellipsis className=\"text-lg !font-medium\">\n              {item?.name}\n            </Typography.Text>\n            <Input\n              disabled={disabled || hasSend}\n              value={inputData[item.name]}\n              onChange={value => {\n                setInputData(\n                  produce(draft => {\n                    draft[item.name] = value;\n                  }),\n                );\n              }}\n            />\n          </Space>\n        ))}\n\n        <Button\n          className=\"w-full\"\n          disabled={disabled}\n          onClick={() => {\n            if (disabled) {\n              return;\n            }\n            setHasSend(true);\n            onCardSendMsg?.({\n              message,\n              extra: {\n                msg:\n                  validContent\n                    .map(item => `${item.name}:${inputData[item.name] || ''}`)\n                    .join('\\n') || '',\n                mentionList: [],\n              },\n            });\n          }}\n        >\n          {I18n.t('workflow_detail_title_testrun_submit')}\n        </Button>\n      </Space>\n    </NodeWrapperUI>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { memo } from 'react';\n\nimport { isEqual, isFunction, noop, omitBy } from 'lodash-es';\nimport { typeSafeJsonParse } from '@coze-common/chat-area-utils';\n\nimport { isWorkflowNodeData } from './utils';\nimport { type RenderNodeEntryProps } from './type';\nimport { QuestionNodeRender } from './question-node-render';\nimport { InputNodeRender } from './input-node-render';\n\nconst BaseComponent: React.FC<RenderNodeEntryProps> = ({\n  message,\n  ...restProps\n}) => {\n  const data = typeSafeJsonParse(message.content, noop);\n  if (!isWorkflowNodeData(data)) {\n    return 'card content is not supported';\n  }\n\n  if (data.content_type === 'option') {\n    return <QuestionNodeRender data={data} message={message} {...restProps} />;\n  }\n  if (data.content_type === 'form_schema') {\n    return <InputNodeRender data={data} message={message} {...restProps} />;\n  }\n  return 'content type is not supported';\n};\n\nexport const WorkflowRenderEntry = memo(BaseComponent, (prevProps, nextProps) =>\n  isEqual(omitBy(prevProps, isFunction), omitBy(nextProps, isFunction)),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentBoxType } from '@coze-common/chat-uikit-shared';\nimport {\n  ContentBox,\n  type EnhancedContentConfig,\n  ContentType,\n} from '@coze-common/chat-uikit';\nimport {\n  PluginScopeContextProvider,\n  usePluginCustomComponents,\n  type ComponentTypesMap,\n} from '@coze-common/chat-area';\n\nimport { WorkflowRenderEntry } from './components';\n\nconst defaultEnable = (value?: boolean) => {\n  if (typeof value === 'undefined') {\n    return true;\n  }\n  return value;\n};\n\nexport const WorkflowRender: ComponentTypesMap['contentBox'] = props => {\n  const customTextMessageInnerTopSlotList = usePluginCustomComponents(\n    'TextMessageInnerTopSlot',\n  );\n  const enhancedContentConfigList: EnhancedContentConfig[] = [\n    {\n      rule: ({ contentType, contentConfigs }) => {\n        const isCardEnable = defaultEnable(\n          contentConfigs?.[ContentBoxType.CARD]?.enable,\n        );\n        return contentType === ContentType.Card && isCardEnable;\n      },\n      render: ({ message, eventCallbacks, contentConfigs, options }) => {\n        const { isCardDisabled, readonly } = options;\n\n        const { onCardSendMsg } = eventCallbacks ?? {};\n\n        return (\n          <WorkflowRenderEntry\n            message={message}\n            onCardSendMsg={onCardSendMsg}\n            readonly={readonly}\n            isDisable={isCardDisabled}\n          />\n        );\n      },\n    },\n  ];\n  return (\n    <ContentBox\n      enhancedContentConfigList={enhancedContentConfigList}\n      multimodalTextContentAddonTop={\n        <>\n          {customTextMessageInnerTopSlotList.map(\n            // eslint-disable-next-line @typescript-eslint/naming-convention -- matches the expected naming\n            ({ pluginName, Component }, index) => (\n              <PluginScopeContextProvider\n                pluginName={pluginName}\n                key={pluginName}\n              >\n                <Component key={index} message={props.message} />\n              </PluginScopeContextProvider>\n            ),\n          )}\n        </>\n      }\n      {...props}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IMessage } from '@coze-common/chat-uikit-shared';\nimport { safeJSONParse } from '@coze-common/chat-uikit';\n\nimport { type ChatflowNodeData } from './type';\n\nexport const extractChatflowMessage = (message: IMessage) => {\n  if (message.content_type === 'card') {\n    const contentStruct = safeJSONParse(message.content) as {\n      x_properties: {\n        workflow_card_info: string;\n      };\n    };\n    const workflowDataStr = contentStruct?.x_properties?.workflow_card_info;\n    if (workflowDataStr) {\n      const cardData = safeJSONParse(workflowDataStr) as ChatflowNodeData;\n      if (cardData?.card_type === 'QUESTION' && cardData?.question_card_data) {\n        return cardData;\n      }\n      if (cardData?.card_type === 'INPUT' && cardData?.input_card_data) {\n        return cardData;\n      }\n    }\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nexport const NodeWrapperUI: React.FC<PropsWithChildren> = ({ children }) => (\n  <div className=\"overflow-hidden w-full min-w-[282px] max-w-[546px] p-[16px] coz-bg-primary\">\n    {children}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type IEventCallbacks,\n  type IMessage,\n} from '@coze-common/chat-uikit-shared';\nimport { Button, Space, Typography } from '@coze-arch/coze-design';\n\nimport { type ChatflowNodeData } from './type';\nimport { NodeWrapperUI } from './node-wrapper-ui';\n\nexport const QuestionNodeRender = ({\n  data,\n  onCardSendMsg,\n  readonly,\n  isDisable,\n  message,\n}: {\n  data: ChatflowNodeData;\n  onCardSendMsg?: IEventCallbacks['onCardSendMsg'];\n  readonly?: boolean;\n  isDisable?: boolean;\n  message: IMessage;\n}) => {\n  const disabled = readonly || isDisable;\n  return (\n    <NodeWrapperUI>\n      <Space className=\"w-full\" vertical spacing={12} align=\"start\">\n        <Typography.Text ellipsis className=\"text-18px\">\n          {data.question_card_data?.Title}\n        </Typography.Text>\n        <Space className=\"w-full\" vertical spacing={16}>\n          {data.question_card_data?.Options?.map((option, index) => (\n            <Button\n              key={option.name + index}\n              className=\"w-full\"\n              color=\"primary\"\n              disabled={disabled}\n              onClick={() =>\n                onCardSendMsg?.({\n                  message,\n                  extra: { msg: option.name, mentionList: [] },\n                })\n              }\n            >\n              {option.name}\n            </Button>\n          ))}\n        </Space>\n      </Space>\n    </NodeWrapperUI>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { produce } from 'immer';\nimport {\n  type IEventCallbacks,\n  type IMessage,\n} from '@coze-common/chat-uikit-shared';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Input, Space, Typography } from '@coze-arch/coze-design';\n\nimport { type ChatflowNodeData } from './type';\nimport { NodeWrapperUI } from './node-wrapper-ui';\n\nexport const InputNodeRender = ({\n  data,\n  onCardSendMsg,\n  readonly,\n  isDisable,\n  message,\n}: {\n  data: ChatflowNodeData;\n  onCardSendMsg?: IEventCallbacks['onCardSendMsg'];\n  readonly?: boolean;\n  isDisable?: boolean;\n  message: IMessage;\n}) => {\n  const [inputData, setInputData] = useState<Record<string, string>>({});\n  const [hasSend, setHasSend] = useState(false);\n  const disabled = readonly || isDisable || hasSend;\n\n  return (\n    <NodeWrapperUI>\n      <Space spacing={12} vertical className=\"w-full\">\n        {data.input_card_data?.map((item, index) => (\n          <Space\n            align=\"start\"\n            className=\"w-full\"\n            spacing={6}\n            vertical\n            key={item?.name + index}\n          >\n            <Typography.Text ellipsis className=\"text-lg !font-medium\">\n              {item?.name}\n            </Typography.Text>\n            <Input\n              disabled={disabled || hasSend}\n              value={inputData[item.name]}\n              onChange={value => {\n                setInputData(\n                  produce(draft => {\n                    draft[item.name] = value;\n                  }),\n                );\n              }}\n            />\n          </Space>\n        ))}\n\n        <Button\n          className=\"w-full\"\n          disabled={disabled}\n          onClick={() => {\n            if (disabled) {\n              return;\n            }\n            setHasSend(true);\n            onCardSendMsg?.({\n              message,\n              extra: {\n                msg:\n                  data.input_card_data\n                    ?.map(item => `${item.name}:${inputData[item.name] || ''}`)\n                    .join('\\n') || '',\n                mentionList: message.sender_id\n                  ? [{ id: message.sender_id }]\n                  : [],\n              },\n            });\n          }}\n        >\n          {I18n.t('workflow_detail_title_testrun_submit')}\n        </Button>\n      </Space>\n    </NodeWrapperUI>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { memo, useMemo } from 'react';\n\nimport { isEqual, isFunction, omitBy } from 'lodash-es';\n\nimport { extractChatflowMessage } from './utils';\nimport { type ChatflowNodeData, type RenderNodeEntryProps } from './type';\nimport { QuestionNodeRender } from './question-node-render';\nimport { InputNodeRender } from './input-node-render';\n\nconst BaseComponent: React.FC<RenderNodeEntryProps> = ({\n  message,\n  ...restProps\n}) => {\n  const chatflowNodeData: ChatflowNodeData | undefined = useMemo(\n    () => extractChatflowMessage(message),\n    [message],\n  );\n  if (!chatflowNodeData) {\n    return null;\n  }\n  if (chatflowNodeData.card_type === 'INPUT') {\n    return (\n      <InputNodeRender\n        data={chatflowNodeData}\n        message={message}\n        {...restProps}\n      />\n    );\n  } else if (chatflowNodeData.card_type === 'QUESTION') {\n    return (\n      <QuestionNodeRender\n        data={chatflowNodeData}\n        message={message}\n        {...restProps}\n      />\n    );\n  } else {\n    return 'content type is not supported';\n  }\n};\n\nexport const WorkflowRenderEntry = memo(BaseComponent, (prevProps, nextProps) =>\n  isEqual(omitBy(prevProps, isFunction), omitBy(nextProps, isFunction)),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentBoxType } from '@coze-common/chat-uikit-shared';\nimport {\n  ContentBox,\n  type EnhancedContentConfig,\n  ContentType,\n} from '@coze-common/chat-uikit';\nimport {\n  PluginScopeContextProvider,\n  usePluginCustomComponents,\n  type ComponentTypesMap,\n} from '@coze-common/chat-area';\n\nimport { WorkflowRenderEntry } from './components';\n\nconst defaultEnable = (value?: boolean) => {\n  if (typeof value === 'undefined') {\n    return true;\n  }\n  return value;\n};\n\nexport const ChatFlowRender: ComponentTypesMap['contentBox'] = props => {\n  const customTextMessageInnerTopSlotList = usePluginCustomComponents(\n    'TextMessageInnerTopSlot',\n  );\n  const enhancedContentConfigList: EnhancedContentConfig[] = [\n    {\n      rule: ({ contentType, contentConfigs }) => {\n        const isCardEnable = defaultEnable(\n          contentConfigs?.[ContentBoxType.CARD]?.enable,\n        );\n        return contentType === ContentType.Card && isCardEnable;\n      },\n      render: ({ message, eventCallbacks, options }) => {\n        const { isCardDisabled, readonly } = options;\n\n        const { onCardSendMsg } = eventCallbacks ?? {};\n\n        return (\n          <WorkflowRenderEntry\n            message={message}\n            onCardSendMsg={onCardSendMsg}\n            readonly={readonly}\n            isDisable={isCardDisabled}\n          />\n        );\n      },\n    },\n  ];\n  return (\n    <ContentBox\n      enhancedContentConfigList={enhancedContentConfigList}\n      multimodalTextContentAddonTop={\n        <>\n          {customTextMessageInnerTopSlotList.map(\n            // eslint-disable-next-line @typescript-eslint/naming-convention -- matches the expected naming\n            ({ pluginName, Component }, index) => (\n              <PluginScopeContextProvider\n                pluginName={pluginName}\n                key={pluginName}\n              >\n                <Component key={index} message={props.message} />\n              </PluginScopeContextProvider>\n            ),\n          )}\n        </>\n      }\n      {...props}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Emitter } from 'mitt';\nimport { type BackgroundImageInfo } from '@coze-arch/bot-api/developer_api';\n\nimport { type BackgroundImageStore } from '../store';\n\nexport enum ChatBackgroundEventName {\n  OnBackgroundChange = 'onBackgroundChange',\n}\n// eslint-disable-next-line @typescript-eslint/consistent-type-definitions\nexport type ChatBackgroundEvent = {\n  [ChatBackgroundEventName.OnBackgroundChange]: BackgroundImageInfo;\n};\n\nexport interface BackgroundPluginBizContext {\n  storeSet: {\n    useChatBackgroundContext: BackgroundImageStore;\n  };\n  chatBackgroundEvent: Emitter<ChatBackgroundEvent>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\nimport { type BackgroundImageInfo } from '@coze-arch/bot-api/developer_api';\n\ninterface BackgroundImageState {\n  backgroundImageInfo: BackgroundImageInfo;\n}\n\ninterface BackgroundImageAction {\n  setBackgroundInfo: (backgroundImageInfo: BackgroundImageInfo) => void;\n  clearBackgroundStore: () => void;\n}\n\nexport const createBackgroundImageStore = (mark: string) =>\n  create<BackgroundImageState & BackgroundImageAction>()(\n    devtools(\n      set => ({\n        backgroundImageInfo: {\n          mobile_background_image: {},\n          web_background_image: {},\n        },\n        clearBackgroundStore: () =>\n          set(\n            {\n              backgroundImageInfo: {\n                mobile_background_image: {},\n                web_background_image: {},\n              },\n            },\n            false,\n            'clearBackgroundStore',\n          ),\n        setBackgroundInfo: info => {\n          set({ backgroundImageInfo: info }, false, 'setBackgroundInfo');\n        },\n      }),\n      {\n        name: `botStudio.ChatBackground.${mark}`,\n        enabled: IS_DEV_MODE,\n      },\n    ),\n  );\n\nexport type BackgroundImageStore = ReturnType<\n  typeof createBackgroundImageStore\n>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReadonlyAppLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport {\n  ChatBackgroundEventName,\n  type BackgroundPluginBizContext,\n} from '../../types/biz-context';\n\nexport const bizAppLifeCycleService: ReadonlyAppLifeCycleServiceGenerator<\n  BackgroundPluginBizContext\n> = plugin => ({\n  onBeforeInitial: () => {\n    const { chatBackgroundEvent, storeSet } = plugin.pluginBizContext;\n\n    const { setBackgroundInfo } = storeSet.useChatBackgroundContext.getState();\n\n    chatBackgroundEvent.on(\n      ChatBackgroundEventName.OnBackgroundChange,\n      backgroundInfo => {\n        setBackgroundInfo(backgroundInfo);\n      },\n    );\n  },\n\n  onAfterInitial: ctx => {\n    const { setBackgroundInfo, clearBackgroundStore } =\n      plugin.pluginBizContext.storeSet.useChatBackgroundContext.getState();\n    const ctxBackgroundInfo = ctx.messageListFromService.backgroundInfo;\n    if (ctxBackgroundInfo) {\n      setBackgroundInfo(ctxBackgroundInfo);\n    } else {\n      clearBackgroundStore();\n    }\n  },\n\n  onBeforeDestroy: () => {\n    const { chatBackgroundEvent } = plugin.pluginBizContext;\n    chatBackgroundEvent.all.clear();\n  },\n});\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { WithRuleImgBackground } from '@coze-common/chat-uikit';\nimport {\n  type CustomComponent,\n  useReadonlyPlugin,\n  PluginName,\n} from '@coze-common/chat-area';\n\nimport { type BackgroundPluginBizContext } from '../../types/biz-context';\n\nimport styles from './index.module.less';\n\nexport const ChatBackgroundUI: CustomComponent['MessageListFloatSlot'] = ({\n  headerNode,\n}) => {\n  const plugin = useReadonlyPlugin<BackgroundPluginBizContext>(\n    PluginName.ChatBackground,\n  );\n  const { useChatBackgroundContext } = plugin.pluginBizContext.storeSet;\n  const backgroundImageInfo = useChatBackgroundContext(\n    useShallow(state => state.backgroundImageInfo),\n  );\n  const isBackgroundMode =\n    !!backgroundImageInfo?.mobile_background_image?.origin_image_url;\n\n  return isBackgroundMode ? (\n    <>\n      {headerNode ? <div className={styles.mask}></div> : null}\n      <WithRuleImgBackground backgroundInfo={backgroundImageInfo} />\n    </>\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PluginMode,\n  PluginName,\n  ReadonlyChatAreaPlugin,\n  createCustomComponents,\n  createReadonlyLifeCycleServices,\n  type ReadonlyLifeCycleServiceGenerator,\n} from '@coze-common/chat-area';\n\nimport { type BackgroundPluginBizContext } from './types/biz-context';\nimport { bizAppLifeCycleService } from './services/life-cycle/app';\nimport { ChatBackgroundUI } from './custom-components/chat-background-ui';\n\nexport const bizLifeCycleServiceGenerator: ReadonlyLifeCycleServiceGenerator<\n  BackgroundPluginBizContext\n> = plugin => ({\n  appLifeCycleService: bizAppLifeCycleService(plugin),\n});\n\nexport class BizPlugin extends ReadonlyChatAreaPlugin<BackgroundPluginBizContext> {\n  public pluginMode = PluginMode.Readonly;\n\n  public pluginName = PluginName.ChatBackground;\n\n  public lifeCycleServices = createReadonlyLifeCycleServices(\n    this,\n    bizLifeCycleServiceGenerator,\n  );\n\n  public customComponents = createCustomComponents({\n    MessageListFloatSlot: ChatBackgroundUI,\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport mitt from 'mitt';\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport {\n  type BackgroundPluginBizContext,\n  type ChatBackgroundEvent,\n} from './types/biz-context';\nimport { createBackgroundImageStore } from './store';\nimport { BizPlugin } from './plugin';\n\nexport const chatBackgroundEvent = mitt<ChatBackgroundEvent>();\nexport {\n  ChatBackgroundEvent,\n  ChatBackgroundEventName,\n} from './types/biz-context';\n\nexport const createChatBackgroundPlugin = () => {\n  const useChatBackgroundContext = createBackgroundImageStore('chatBackground');\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention -- Plugin names start with uppercase as expected\n  const ChatBackgroundPlugin: PluginRegistryEntry<BackgroundPluginBizContext> =\n    {\n      createPluginBizContext() {\n        return {\n          storeSet: {\n            useChatBackgroundContext,\n          },\n          chatBackgroundEvent,\n        };\n      },\n      Plugin: BizPlugin,\n    };\n  return {\n    ChatBackgroundPlugin,\n    chatBackgroundEvent,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useRef, useLayoutEffect } from 'react';\n\n// eslint-disable-next-line @typescript-eslint/no-invalid-void-type -- x\ntype Destructor = (() => void) | void;\ntype Fn<ARGS extends unknown[]> = (...args: ARGS) => Destructor;\n\nexport const useImperativeLayoutEffect = <Params extends unknown[]>(\n  effect: Fn<Params>,\n  deps: unknown[] = [],\n) => {\n  const [effectValue, setEffectValue] = useState(0);\n  const paramRef = useRef<Params>();\n  const effectRef = useRef<Fn<Params>>(() => undefined);\n  effectRef.current = effect;\n  useLayoutEffect(() => {\n    if (!effectValue) {\n      return;\n    }\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment -- gymnastics don't move, let's make a living\n    // @ts-expect-error\n    const params = paramRef.current || ([] as Params);\n    return effectRef.current(...params);\n  }, [effectValue, ...deps]);\n  return (...args: Params) => {\n    paramRef.current = args;\n    setEffectValue(pre => pre + 1);\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type RefObject, useMemo, useState } from 'react';\n\nimport { useInfiniteScroll } from 'ahooks';\n\nimport { useImperativeLayoutEffect } from '../use-imperative-layout-effect';\nimport { type LoadMoreListData } from '../../components/load-more-list';\n\nexport interface LoadMoreHookProps<TData extends object> {\n  getId: (item: TData) => string;\n  listRef: RefObject<HTMLDivElement>;\n  defaultList?: TData[];\n  getMoreListService: (\n    currentData: LoadMoreListData<TData> | undefined,\n  ) => Promise<LoadMoreListData<TData>>;\n}\nexport const useLoadMore = <TData extends object>(\n  props: LoadMoreHookProps<TData>,\n) => {\n  const { getId, listRef, getMoreListService, defaultList } = props;\n  const [activeId, setActiveId] = useState('');\n\n  const { data, loadingMore, loading, loadMore } = useInfiniteScroll<\n    LoadMoreListData<TData>\n  >(currentData => getMoreListService(currentData), {\n    target: listRef,\n    isNoMore: d => !d?.hasMore,\n  });\n\n  const resultData = useMemo(() => {\n    if (defaultList) {\n      return {\n        list: defaultList.concat(data?.list ?? []),\n        hasMore: !!data?.hasMore,\n      };\n    }\n    return {\n      list: data?.list ?? [],\n      hasMore: !!data?.hasMore,\n    };\n  }, [data]);\n\n  const { list } = resultData;\n\n  const focusTo = (toItem: TData | null) => {\n    if (!toItem) {\n      setActiveId('');\n      return;\n    }\n    if (!listRef.current) {\n      return;\n    }\n    const findItem = list.find(item => getId(toItem) === getId(item));\n    if (!findItem) {\n      return;\n    }\n    const itemId = getId(findItem);\n    setActiveId(itemId);\n  };\n\n  const focusFirst = () => {\n    const firstItem = list[0];\n    firstItem && focusTo(firstItem);\n  };\n\n  const scrollToFirst = () => {\n    if (!listRef.current) {\n      return;\n    }\n    listRef.current.scrollTop = 0;\n  };\n\n  const scrollIntoView = useImperativeLayoutEffect((toItem: TData) => {\n    const itemId = getId(toItem);\n    const itemRef = listRef.current?.querySelector(`[data-id=\"${itemId}\"]`);\n    if (!itemRef) {\n      return;\n    }\n    itemRef.scrollIntoView({\n      behavior: 'instant' as ScrollBehavior,\n      block: 'nearest',\n    });\n  });\n\n  const goNext = () => {\n    const curItem = list.find(item => getId(item) === activeId);\n    if (!curItem) {\n      return;\n    }\n    const { item: nextItem, reachLimit } = getNextActiveItem<TData>({\n      getId,\n      list,\n      curItem,\n    });\n    if (reachLimit) {\n      loadMore();\n    }\n    if (!loadingMore) {\n      focusTo(nextItem);\n      scrollIntoView(nextItem);\n    }\n  };\n\n  const goPrev = () => {\n    const curItem = list.find(item => getId(item) === activeId);\n    if (!curItem) {\n      return;\n    }\n    const { item: prevItem, reachLimit } = getPreviousItem<TData>({\n      getId,\n      list,\n      curItem,\n    });\n    if (reachLimit) {\n      loadMore();\n    }\n    focusTo(prevItem);\n    scrollIntoView(prevItem);\n  };\n\n  return {\n    activeId,\n    focusFirst,\n    focusTo,\n    scrollToFirst,\n    scrollIntoView,\n    goNext,\n    goPrev,\n    loadingMore,\n    data: resultData,\n    loading,\n  };\n};\nconst getTargetItemAndIndex = <TData extends object>({\n  getId,\n  list,\n  target,\n}: {\n  getId: (item: TData) => string;\n  list: TData[];\n  target: TData;\n}) => {\n  let targetIndex = -1;\n  const targetItem = list.find((item, index) => {\n    if (getId(item) === getId(target)) {\n      targetIndex = index;\n      return true;\n    }\n    return false;\n  });\n  return {\n    targetItem,\n    targetIndex,\n  };\n};\n\nexport const getNextActiveItem = <TData extends object>({\n  curItem,\n  list,\n  getId,\n}: {\n  curItem: TData;\n  list: TData[];\n  getId: (item: TData) => string;\n}): {\n  reachLimit: boolean;\n  item: TData;\n} => {\n  const { targetIndex } = getTargetItemAndIndex({\n    getId,\n    list,\n    target: curItem,\n  });\n  if (targetIndex < 0) {\n    return {\n      reachLimit: false,\n      item: curItem,\n    };\n  }\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  const reachLimit = targetIndex >= list.length - 3;\n  const nextIndex = (targetIndex + 1) % list.length;\n  const item = list.at(nextIndex) || curItem;\n  return {\n    reachLimit,\n    item,\n  };\n};\n\nexport const getPreviousItem = <TData extends object>({\n  curItem,\n  list,\n  getId,\n}: {\n  curItem: TData;\n  list: TData[];\n  getId: (item: TData) => string;\n}): {\n  reachLimit: boolean;\n  item: TData;\n} => {\n  const { targetIndex } = getTargetItemAndIndex({\n    getId,\n    list,\n    target: curItem,\n  });\n  if (targetIndex < 0) {\n    return {\n      reachLimit: false,\n      item: curItem,\n    };\n  }\n  const reachLimit = targetIndex === 0;\n  const nextIdx = (targetIndex - 1) % list.length;\n  const item = list.at(nextIdx) || curItem;\n  return {\n    reachLimit,\n    item,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useRef } from 'react';\n\nimport { useUpdateEffect } from 'ahooks';\nimport { IconSpin } from '@douyinfe/semi-icons';\n\nimport { useLoadMore } from '../../hooks/shortcut-bar/use-load-more';\nconst TIME_TO_CANCEL_MOUSE_MOVE = 50;\n\nexport interface LoadMoreListData<TData extends object> {\n  list: TData[];\n  hasMore: boolean;\n}\n\nexport type LoadMoreListProps<TData extends object> = {\n  className?: string;\n  getId: (data: TData) => string;\n  defaultId?: string;\n  itemRender: (data: TData) => React.ReactNode;\n  defaultList?: TData[];\n  listTopSlot?: React.ReactNode;\n  getMoreListService: (\n    currentData: LoadMoreListData<TData> | undefined,\n  ) => Promise<LoadMoreListData<TData>>;\n  onSelect?: (data: TData) => void;\n  onActiveId?: (id: string) => void;\n} & Omit<React.HTMLAttributes<HTMLDivElement>, 'className' | 'onSelect'>;\n\nexport const LoadMoreList = <TData extends object>(\n  props: LoadMoreListProps<TData>,\n) => {\n  const {\n    className,\n    onSelect,\n    getId,\n    itemRender,\n    onActiveId,\n    getMoreListService,\n    defaultId,\n    listTopSlot,\n    defaultList,\n    ...restProps\n  } = props;\n  const mouseMovingCancelIdRef = useRef<ReturnType<typeof setTimeout>>();\n  const mouseMovingRef = useRef(false);\n  const listRef = useRef<HTMLDivElement>(null);\n  const activeItemRef = useRef<HTMLDivElement | null>(null);\n\n  const {\n    data,\n    scrollIntoView,\n    activeId,\n    focusTo,\n    goNext,\n    goPrev,\n    loadingMore,\n    loading,\n  } = useLoadMore<TData>({\n    getMoreListService,\n    getId: (item: TData) => getId(item),\n    listRef,\n    defaultList,\n  });\n\n  const list = data?.list ?? [];\n\n  useEffect(() => {\n    onActiveId?.(activeId);\n  }, [activeId]);\n\n  useUpdateEffect(() => {\n    if (loading) {\n      return;\n    }\n    const defaultItem = list.find(item => getId(item) === defaultId);\n    if (defaultItem) {\n      focusTo(defaultItem);\n      scrollIntoView(defaultItem);\n      onActiveId?.(defaultId || getId(defaultItem));\n    }\n  }, [loading]);\n\n  return (\n    <div\n      ref={listRef}\n      tabIndex={1}\n      className={className}\n      onMouseLeave={() => {\n        focusTo(null);\n      }}\n      onMouseMove={() => {\n        clearTimeout(mouseMovingCancelIdRef.current);\n        mouseMovingRef.current = true;\n        mouseMovingCancelIdRef.current = setTimeout(() => {\n          mouseMovingRef.current = false;\n        }, TIME_TO_CANCEL_MOUSE_MOVE);\n      }}\n      onKeyDown={event => {\n        if (event.key === 'ArrowDown') {\n          event.preventDefault();\n          goNext();\n          return;\n        }\n        if (event.key === 'ArrowUp') {\n          event.preventDefault();\n          goPrev();\n          return;\n        }\n        if (event.key === 'Enter') {\n          const selectItem = list.find(item => getId(item) === activeId);\n          selectItem && onSelect?.(selectItem);\n        }\n      }}\n      {...restProps}\n    >\n      {listTopSlot}\n      {list.map(item => (\n        <div\n          key={getId(item)}\n          data-id={getId(item)}\n          ref={getId(item) === activeId ? activeItemRef : null}\n          onClick={() => {\n            onSelect?.(item);\n          }}\n          onMouseEnter={() => {\n            // The mouse is in the scroll bar, which triggers the event, and the settings are only updated during mouse movement\n            if (mouseMovingRef.current) {\n              focusTo(item);\n              listRef.current?.focus();\n            }\n          }}\n        >\n          {itemRender(item)}\n        </div>\n      ))}\n      {loadingMore || loading ? (\n        <div className=\"flex justify-center items-center\">\n          <IconSpin style={{ color: '#4D53E8' }} spin />\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","\n      import API from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Stitching queries based on template_query and components\nexport const getQueryFromTemplate = (\n  templateQuery: string,\n  values: Record<string, unknown>,\n) => {\n  let query = templateQuery;\n  // Replace the {{key}} in the template with the value corresponding to the key in values\n  Object.keys(values).forEach(key => {\n    query = query.replace(\n      new RegExp(`\\\\{\\\\{${key}\\\\}\\\\}`, 'g'),\n      values[key] as string,\n    );\n  });\n\n  return query;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep, merge } from 'lodash-es';\nimport websocketManager from '@coze-common/websocket-manager-adapter';\nimport {\n  getFileInfo,\n  type TextAndFileMixMessageProps,\n} from '@coze-common/chat-core';\nimport {\n  ContentType,\n  type SendMessageOptions,\n  useSendMultimodalMessage,\n  useSendTextMessage,\n} from '@coze-common/chat-area';\nimport { type PartialRequired } from '@coze-arch/bot-typings/common';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport { ToolType } from '@coze-arch/bot-api/playground_api';\nimport type { ShortCutCommand } from '@coze-agent-ide/tool-config';\n\nimport { getQueryFromTemplate } from '../utils/shortcut-query';\nimport { enableSendTypePanelHideTemplate } from '../shortcut-tool/shortcut-edit/method';\nimport {\n  type OnBeforeSendQueryShortcutParams,\n  type OnBeforeSendTemplateShortcutParams,\n} from '../shortcut-bar/types';\nimport {\n  type FileValue,\n  type TValue,\n} from '../components/short-cut-panel/widgets/types';\n\nexport const useSendTextQueryMessage = () => {\n  const sendTextMessage = useSendTextMessage();\n  return (params: {\n    queryTemplate: string;\n    options?: SendMessageOptions;\n    onBeforeSend?: (\n      sendParams: OnBeforeSendQueryShortcutParams,\n    ) => OnBeforeSendQueryShortcutParams;\n    shortcut: ShortCutCommand;\n  }) => {\n    const {\n      queryTemplate,\n      onBeforeSend,\n      options: inputOptions,\n      shortcut,\n    } = params;\n    const { tool_type } = shortcut;\n    const useTool =\n      tool_type !== undefined &&\n      [ToolType.ToolTypeWorkFlow, ToolType.ToolTypePlugin].includes(tool_type);\n\n    const message = {\n      payload: {\n        text: queryTemplate,\n        mention_list: [],\n      },\n    };\n\n    const pluginParams = useTool ? getPluginDefaultParams(shortcut) : {};\n\n    const options = merge(\n      {\n        extendFiled: {\n          ...pluginParams,\n          device_id: String(websocketManager.deviceId),\n        },\n      },\n      inputOptions,\n    );\n    const { message: newMessage, options: newOptions } = onBeforeSend?.({\n      message,\n      options,\n    }) || {\n      message,\n      options,\n    };\n    sendTextMessage(\n      {\n        text: newMessage.payload.text,\n        mentionList: newMessage.payload.mention_list,\n      },\n      'shortcut',\n      newOptions,\n    );\n    sendTeaEvent(EVENT_NAMES.shortcut_use, {\n      tool_type,\n      use_components: !!shortcut.components_list?.length,\n      show_panel: enableSendTypePanelHideTemplate(shortcut),\n    });\n  };\n};\n\nexport const useSendUseToolMessage = () => {\n  const sendMultimodalMessage = useSendMultimodalMessage();\n  return ({\n    shortcut,\n    options: inputOptions,\n    componentsFormValues,\n    onBeforeSendTemplateShortcut,\n    withoutComponentsList = false,\n  }: {\n    shortcut: ShortCutCommand;\n    componentsFormValues: Record<string, TValue>;\n    options?: SendMessageOptions;\n    onBeforeSendTemplateShortcut?: (\n      params: OnBeforeSendTemplateShortcutParams & {\n        shortcut: ShortCutCommand;\n      },\n    ) => OnBeforeSendTemplateShortcutParams;\n    withoutComponentsList?: boolean;\n  }) => {\n    const { tool_type } = shortcut;\n    const sendQuery = getTemplateQuery(\n      shortcut,\n      componentsFormValues,\n      /**\n       * Calling store without parameters does not have a pixentList\n       */\n      withoutComponentsList,\n    );\n    const useTool =\n      tool_type !== undefined &&\n      [ToolType.ToolTypeWorkFlow, ToolType.ToolTypePlugin].includes(tool_type);\n\n    const pluginParams = useTool\n      ? getPluginParams(shortcut, componentsFormValues)\n      : {};\n\n    const imageAndFileList = getImageAndFileList(componentsFormValues);\n\n    const message: TextAndFileMixMessageProps = {\n      payload: {\n        mixList: [\n          {\n            type: ContentType.Text,\n            // TODO needs to see if it can be optimized.\n            /**\n             * Prevent sending empty messages (no dialog bubble box) = > Use spaces to occupy space\n             */\n            text: sendQuery || ' ',\n          },\n          ...imageAndFileList,\n        ],\n        mention_list: [],\n      },\n    };\n\n    const options = merge(\n      {\n        extendFiled: {\n          ...pluginParams,\n          device_id: String(websocketManager.deviceId),\n        },\n      },\n      inputOptions,\n    );\n\n    const handledParams = onBeforeSendTemplateShortcut?.({\n      message: cloneDeep(message),\n      options: cloneDeep(options),\n      shortcut,\n    }) || {\n      message,\n      options,\n    };\n    sendMultimodalMessage(\n      handledParams.message ?? message,\n      'shortcut',\n      handledParams.options,\n    );\n    sendTeaEvent(EVENT_NAMES.shortcut_use, {\n      tool_type,\n      use_components: !!shortcut.components_list?.length,\n      show_panel: !enableSendTypePanelHideTemplate(shortcut),\n    });\n  };\n};\n\ninterface ToolParamValue {\n  value: string;\n  resource_type: 'uri' | '';\n}\n\nconst getPluginParams = (\n  shortcut: ShortCutCommand,\n  componentsFormValues: Record<string, TValue>,\n) => {\n  const {\n    plugin_id,\n    plugin_api_name,\n    components_list,\n    tool_info: { tool_params_list } = {},\n  } = shortcut;\n\n  const filterImagesValues = filterComponentFormValues(\n    componentsFormValues,\n    value => {\n      const { fileInstance, url } = value;\n      const resourceType = fileInstance ? 'uri' : '';\n      return {\n        value: url,\n        resource_type: resourceType,\n      };\n    },\n    value => ({\n      value,\n      resource_type: '',\n    }),\n  );\n\n  // The parameter attribute value in key: components_list: the corresponding value in values | default_value\n  const runPluginVariables = (tool_params_list ?? []).reduce<\n    Record<string, ToolParamValue>\n  >((acc, cur) => {\n    const { default_value, name, refer_component } = cur;\n    if (!name) {\n      return acc;\n    }\n    if (!refer_component) {\n      acc[name] = {\n        value: default_value ?? '',\n        resource_type: '',\n      };\n      return acc;\n    }\n    const targetComponentName = components_list?.find(\n      com => com.parameter === name,\n    )?.name;\n    const componentValue =\n      targetComponentName && filterImagesValues[targetComponentName];\n    if (componentValue) {\n      acc[name] = componentValue as ToolParamValue;\n    }\n    return acc;\n  }, {});\n\n  if (!Object.keys(runPluginVariables).length) {\n    return {\n      shortcut_cmd_id: shortcut.command_id,\n      toolList: [],\n    };\n  }\n\n  return {\n    shortcut_cmd_id: shortcut.command_id,\n    toolList: [\n      {\n        plugin_id,\n        api_name: plugin_api_name ?? '',\n        parameters: runPluginVariables,\n      },\n    ],\n  };\n};\n\nconst getPluginDefaultParams = (shortcut: ShortCutCommand) => {\n  const {\n    plugin_id,\n    plugin_api_name,\n    tool_info: { tool_params_list } = {},\n  } = shortcut;\n\n  // The parameter attribute value in key: components_list: the corresponding value in values | default_value\n  const runPluginVariables = (tool_params_list ?? []).reduce<\n    Record<string, ToolParamValue>\n  >((acc, cur) => {\n    const { default_value, name } = cur;\n    if (!name) {\n      return acc;\n    }\n\n    acc[name] = {\n      value: default_value ?? '',\n      resource_type: '',\n    };\n\n    return acc;\n  }, {});\n\n  return {\n    shortcut_cmd_id: shortcut.command_id,\n    toolList: [\n      {\n        plugin_id,\n        api_name: plugin_api_name ?? '',\n        parameters: runPluginVariables,\n      },\n    ],\n  };\n};\n\nexport const getTemplateQuery = (\n  shortcut: ShortCutCommand,\n  componentsFormValues: Record<string, TValue>,\n  withoutComponentsList = false,\n) => {\n  const { template_query, components_list } = shortcut;\n  if (!template_query) {\n    throw new Error('template_query is not defined');\n  }\n  // Processing image files\n  const componentListValue = getComponentListValue(\n    components_list,\n    componentsFormValues,\n  );\n\n  if (withoutComponentsList) {\n    return getQueryFromTemplate(template_query, componentsFormValues ?? {});\n  }\n\n  return getQueryFromTemplate(template_query, componentListValue);\n};\n\nconst filterComponentFormValues = (\n  componentsFormValues: Record<string, TValue>,\n  setImageAndFileValue: (value: FileValue) => unknown,\n  setTextValue: (value: string) => unknown,\n) =>\n  Object.keys(componentsFormValues).reduce<Record<string, unknown>>(\n    (acc, cur) => {\n      const value = componentsFormValues[cur];\n      // file type\n      if (typeof value === 'object' && value.fileInstance) {\n        acc[cur] = setImageAndFileValue(value);\n        return acc;\n      }\n      // plain text type\n      acc[cur] = setTextValue(value as string);\n      return acc;\n    },\n    {},\n  );\n\nexport const getImageAndFileList = (\n  componentsFormValues: Record<string, TValue>,\n): TextAndFileMixMessageProps['payload']['mixList'] =>\n  Object.keys(componentsFormValues).reduce<\n    TextAndFileMixMessageProps['payload']['mixList']\n  >((acc, cur) => {\n    const value = componentsFormValues[cur];\n    if (isComponentFile(value)) {\n      acc.push({\n        type: ContentType.File,\n        file: value.fileInstance,\n        uri: value.url,\n      });\n      return acc;\n    }\n    if (isComponentImage(value)) {\n      acc.push({\n        type: ContentType.Image,\n        file: value.fileInstance,\n        uri: value.url,\n        width: value.width || 0,\n        height: value.height || 0,\n      });\n      return acc;\n    }\n    return acc;\n  }, []);\n\nconst isComponentFile = (\n  value: TValue,\n): value is PartialRequired<FileValue, 'fileInstance' | 'url'> =>\n  Boolean(\n    typeof value === 'object' &&\n      value.fileInstance &&\n      getFileInfo(value.fileInstance)?.fileType !== 'image',\n  );\n\nconst isComponentImage = (\n  value: TValue,\n): value is PartialRequired<FileValue, 'fileInstance' | 'url'> =>\n  Boolean(\n    typeof value === 'object' &&\n      value.fileInstance &&\n      getFileInfo(value.fileInstance)?.fileType === 'image',\n  );\n\n// Get component_list value with default value\nexport const getComponentListValue = (\n  componentsList: ShortCutCommand['components_list'],\n  componentsFormValues: Record<string, TValue>,\n): Record<string, string> => {\n  const filterValues = filterComponentFormValues(\n    componentsFormValues,\n    value => value?.fileInstance?.name,\n    value => value,\n  );\n\n  // The parameter attribute value in key: components_list: the corresponding value in values | default_value\n  return (componentsList ?? []).reduce<Record<string, string>>((acc, cur) => {\n    const { default_value, name, hide } = cur;\n    if (!name) {\n      return acc;\n    }\n    if (hide) {\n      acc[name] = default_value?.value ?? '';\n      return acc;\n    }\n    const componentValue = filterValues[name];\n    if (componentValue) {\n      acc[name] = componentValue as string;\n    }\n    return acc;\n  }, {});\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\n\nexport const shortcutIconAndNameVisibleControl = (\n  shortcut: ShortCutCommand,\n): {\n  iconVisible: boolean;\n  nameVisible: boolean;\n  splitLineVisible: boolean;\n} => {\n  const { bot_info } = shortcut;\n  const iconVisible = !!bot_info?.icon_url;\n  const nameVisible = !!bot_info?.name;\n  const splitLineVisible = iconVisible || nameVisible;\n  return { iconVisible, nameVisible, splitLineVisible };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport cls from 'classnames';\nimport type { ShortCutCommand } from '@coze-agent-ide/tool-config';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/bot-semi';\nimport { SendType } from '@coze-arch/bot-api/playground_api';\n\nimport styles from '../index.module.less';\nimport { type OnBeforeSendQueryShortcutParams } from '../../shortcut-bar/types';\nimport { useSendTextQueryMessage } from '../../hooks/shortcut';\nimport { LoadMoreList } from '../../components/load-more-list';\nimport SplitLine from '../../assets/split-line.svg';\nimport DefaultShortcutIcon from '../../assets/shortcut-icon-default.svg';\nimport { shortcutIconAndNameVisibleControl } from './method';\n\nconst { Text } = Typography;\n\nexport const ShortcutsLoadMoreList: FC<{\n  shortcuts: ShortCutCommand[];\n  onSelect?: (shortcut: ShortCutCommand) => void;\n  defaultId?: string;\n  onBeforeSendTextMessage?: (\n    params: OnBeforeSendQueryShortcutParams,\n  ) => OnBeforeSendQueryShortcutParams;\n}> = ({ shortcuts, onSelect, onBeforeSendTextMessage, defaultId }) => {\n  const sendQueryMessage = useSendTextQueryMessage();\n  const [activeId, setActiveId] = useState('');\n  const onShortcutClick = (shortcut: ShortCutCommand) => {\n    onSelect?.(shortcut);\n    if (shortcut.send_type === SendType.SendTypeQuery) {\n      shortcut?.template_query &&\n        sendQueryMessage({\n          queryTemplate: shortcut.template_query,\n          onBeforeSend: onBeforeSendTextMessage,\n          shortcut,\n        });\n      return;\n    }\n  };\n\n  return (\n    <div className=\"p-2\">\n      <div className=\"text-xs coz-fg-secondary mb-2 pl-2 pt-1\">\n        {I18n.t('bot_ide_shortcut')}\n      </div>\n      <LoadMoreList<ShortCutCommand>\n        className={cls(\n          'w-full max-h-[312px] overflow-y-auto cursor-pointer',\n          styles['load-more-list'],\n        )}\n        defaultId={defaultId}\n        getId={(item: ShortCutCommand) => item.command_id}\n        onActiveId={id => setActiveId(id)}\n        getMoreListService={() =>\n          Promise.resolve({\n            list: shortcuts,\n            hasMore: false,\n          })\n        }\n        onSelect={onShortcutClick}\n        itemRender={(shortcut: ShortCutCommand) => {\n          const { splitLineVisible, iconVisible, nameVisible } =\n            shortcutIconAndNameVisibleControl(shortcut);\n          return (\n            <div\n              className={cls(\n                'flex justify-start items-center max-w-full overflow-hidden h-[52px] px-2 py-[6px]',\n                {\n                  'coz-mg-primary-hovered': activeId === shortcut.command_id,\n                  'rounded-md': activeId === shortcut.command_id,\n                },\n              )}\n            >\n              <img\n                src={shortcut.shortcut_icon?.url || DefaultShortcutIcon}\n                alt=\"icon\"\n                className=\"w-9 h-9 p-[10px] rounded bg-white border-[0.5px] border-solid coz-stroke-primary mr-2\"\n              />\n              <div className=\"grow-0 shrink max-w-[37%] overflow-hidden box-border mr-3 flex items-center\">\n                <Text\n                  className=\"text-sm coz-fg-plus font-medium\"\n                  ellipsis={{\n                    showTooltip: {\n                      opts: {\n                        content: shortcut.command_name,\n                        position: 'top',\n                        style: {\n                          wordBreak: 'break-word',\n                        },\n                      },\n                    },\n                  }}\n                >\n                  {shortcut.command_name}\n                </Text>\n              </div>\n              {shortcut.description ? (\n                <div className=\"flex-0 max-w-[60%] overflow-hidden box-border mr-3 flex items-center\">\n                  <Text\n                    className=\"coz-fg-secondary text-xs\"\n                    ellipsis={{\n                      showTooltip: {\n                        opts: {\n                          content: shortcut.description,\n                          position: 'top',\n                          style: {\n                            wordBreak: 'break-word',\n                          },\n                        },\n                      },\n                    }}\n                  >\n                    {shortcut.description}\n                  </Text>\n                </div>\n              ) : null}\n              <div className=\"flex items-center max-w-full flex-0 overflow-hidden box-border min-w-[100px]\">\n                {splitLineVisible ? <img src={SplitLine} alt=\"\" /> : null}\n                {iconVisible ? (\n                  <img\n                    alt=\"bot icon\"\n                    className=\"w-[14px] h-[14px] rounded-full mr-1 ml-3\"\n                    src={shortcut.bot_info?.icon_url}\n                  />\n                ) : null}\n                {nameVisible ? (\n                  <Text\n                    className=\"coz-fg-secondary text-xs\"\n                    ellipsis={{\n                      showTooltip: {\n                        opts: {\n                          content: shortcut.bot_info?.name,\n                          position: 'top',\n                          style: {\n                            wordBreak: 'break-word',\n                          },\n                        },\n                      },\n                    }}\n                  >\n                    {shortcut.bot_info?.name}\n                  </Text>\n                ) : null}\n              </div>\n            </div>\n          );\n        }}\n      ></LoadMoreList>\n    </div>\n  );\n};\n","import * as React from \"react\";\nconst SvgSplitLine = props => <svg xmlns=\"http://www.w3.org/2000/svg\" width={2} height={12} fill=\"none\" viewBox=\"0 0 2 12\" {...props}><path stroke=\"#1D1C23\" strokeOpacity={0.12} d=\"M1 0v12\" /></svg>;\nexport { SvgSplitLine as ReactComponent };\nexport default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMiIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDIgMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGlkPSJWZWN0b3IgMjU5NCIgZD0iTTEgMFYxMiIgc3Ryb2tlPSIjMUQxQzIzIiBzdHJva2Utb3BhY2l0eT0iMC4xMiIvPgo8L3N2Zz4K\";","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nconst shortcutCommandVariants = cva(\n  [\n    'mr-8px',\n    'rounded-[99px]',\n    'border-[1px]',\n    'border-solid',\n    'overflow-hidden',\n  ],\n  {\n    variants: {\n      color: {\n        grey: [\n          'coz-stroke-primary',\n          'coz-mg-secondary',\n          'backdrop-blur-[3.45px]',\n        ],\n        white: ['coz-stroke-primary', 'coz-bg-max', 'backdrop-blur-[3.45px]'],\n        blur: [\n          'coz-stroke-image-bots',\n          'coz-bg-image-bots',\n          'backdrop-blur-[20px]',\n        ],\n      },\n    },\n  },\n);\n\nconst shortcutCommandTextVariants = cva(['text-lg', 'font-medium'], {\n  variants: {\n    color: {\n      grey: ['coz-fg-primary'],\n      white: ['coz-fg-primary'],\n      blur: ['coz-fg-images-bots'],\n    },\n  },\n});\n\nexport const typeSafeShortcutCommandVariants: (\n  props: Required<VariantProps<typeof shortcutCommandVariants>>,\n) => string = shortcutCommandVariants;\n\nexport const typeSafeShortcutCommandTextVariants: (\n  props: Required<VariantProps<typeof shortcutCommandTextVariants>>,\n) => string = shortcutCommandTextVariants;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, type PropsWithChildren, useState } from 'react';\n\nimport type { ShortCutCommand } from '@coze-agent-ide/tool-config';\nimport { useChatAreaLayout } from '@coze-common/chat-area';\nimport { Tooltip } from '@coze-arch/coze-design';\nimport { Typography } from '@coze-arch/bot-semi';\nimport { Layout } from '@coze-common/chat-uikit-shared';\n\nconst { Paragraph, Text } = Typography;\n\ninterface TooltipWithContentProps {\n  shortcut: ShortCutCommand;\n  toolTipFooterSlot?: React.ReactNode;\n  showBotInfo?: boolean;\n}\n\nexport const TooltipWithContent: FC<\n  PropsWithChildren<TooltipWithContentProps>\n> = ({\n  children,\n  shortcut,\n  toolTipFooterSlot,\n  showBotInfo: propShowBotInfo = false,\n}) => {\n  const layout = useChatAreaLayout();\n  const showTooltip = layout !== Layout.MOBILE;\n  const [visible, setVisible] = useState(false);\n  const { description, command_name } = shortcut;\n  const { icon_url, name } = shortcut.bot_info || {};\n  const showBotInfo = propShowBotInfo && !!(name || icon_url);\n\n  const renderContent = () => (\n    <div className=\"flex flex-col items-start justify-center min-w-9\">\n      {command_name ? (\n        <div className=\"max-w-[250px] mb-1\">\n          <Paragraph ellipsis className=\"coz-fg-plus font-bold text-sm\">\n            {command_name}\n          </Paragraph>\n        </div>\n      ) : null}\n      {description ? (\n        <div className=\"max-w-[250px]\">\n          <div className=\"coz-fg-secondary text-xs\">{description}</div>\n        </div>\n      ) : null}\n      {showBotInfo ? (\n        <div className=\"flex mt-3 gap-1 items-center\">\n          {icon_url ? (\n            <img\n              className=\"rounded-full w-[14px] h-[14px]\"\n              src={icon_url}\n              alt=\"bot_icon\"\n            />\n          ) : null}\n          {name ? (\n            <Text className=\"coz-fg-secondary text-xs\">{name}</Text>\n          ) : null}\n        </div>\n      ) : null}\n      {toolTipFooterSlot}\n    </div>\n  );\n  return (\n    <Tooltip\n      trigger={'custom'}\n      visible={visible}\n      style={{ maxWidth: '283px', padding: '16px' }}\n      content={() => renderContent()}\n    >\n      <div\n        onMouseEnter={() => setVisible(showTooltip)}\n        onMouseLeave={() => setVisible(false)}\n      >\n        {children}\n      </div>\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useRef } from 'react';\n\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\nimport { useIsSendMessageLock } from '@coze-common/chat-area';\nimport { Button } from '@coze-arch/coze-design';\nimport { SendType } from '@coze-arch/bot-api/playground_api';\n\nimport {\n  typeSafeShortcutCommandTextVariants,\n  typeSafeShortcutCommandVariants,\n} from '../variants';\nimport { TooltipWithContent } from '../component';\nimport {\n  type OnBeforeSendQueryShortcutParams,\n  type UIMode,\n} from '../../shortcut-bar/types';\nimport { useSendTextQueryMessage } from '../../hooks/shortcut';\n\ninterface QueryShortcutProps {\n  shortcut: ShortCutCommand;\n  onClick?: () => void;\n  uiMode: UIMode;\n  toolTipFooterSlot?: React.ReactNode;\n  onBeforeSend?: (\n    params: OnBeforeSendQueryShortcutParams,\n  ) => OnBeforeSendQueryShortcutParams;\n  popoverTipShowBotInfo?: boolean;\n}\n\nexport const QueryShortcut: FC<QueryShortcutProps> = props => {\n  const {\n    shortcut,\n    onClick,\n    onBeforeSend,\n    toolTipFooterSlot,\n    popoverTipShowBotInfo = false,\n  } = props;\n  const sendQueryMessage = useSendTextQueryMessage();\n  const commandNameRef = useRef<HTMLDivElement>(null);\n  const isSendMessageLock = useIsSendMessageLock();\n  const onShortcutClick = () => {\n    const { template_query, agent_id, object_id } = shortcut;\n    if (!template_query) {\n      return;\n    }\n    onClick?.();\n    sendQueryMessage({\n      queryTemplate: template_query,\n      options: {\n        extendFiled: {\n          extra: {\n            bot_state: JSON.stringify({\n              agent_id,\n              bot_id: object_id,\n            }),\n          },\n        },\n      },\n      onBeforeSend,\n      shortcut,\n    });\n  };\n\n  if (shortcut.send_type !== SendType.SendTypeQuery) {\n    return null;\n  }\n\n  return (\n    <div className={typeSafeShortcutCommandVariants({ color: props.uiMode })}>\n      {/*Instruction name is not too long, display description*/}\n      <TooltipWithContent\n        shortcut={shortcut}\n        toolTipFooterSlot={toolTipFooterSlot}\n        showBotInfo={popoverTipShowBotInfo}\n      >\n        <Button\n          disabled={isSendMessageLock}\n          data-testid={`chat-area.chat-input-shortcut.shortcut-button-${shortcut.command_name}`}\n          contentClassName={typeSafeShortcutCommandTextVariants({\n            color: props.uiMode,\n          })}\n          onClick={() => onShortcutClick()}\n          color=\"secondary\"\n          icon={\n            shortcut.shortcut_icon?.url ? (\n              <img\n                alt=\"icon\"\n                src={shortcut.shortcut_icon.url}\n                className=\"h-[14px]\"\n              />\n            ) : null\n          }\n        >\n          <div\n            ref={commandNameRef}\n            className=\"max-w-[198px] overflow-hidden text-ellipsis\"\n          >\n            {shortcut.command_name}\n          </div>\n        </Button>\n      </TooltipWithContent>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useRef } from 'react';\n\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\nimport { Button } from '@coze-arch/coze-design';\nimport { IconShortcutComponentTag } from '@coze-arch/bot-icons';\nimport { SendType } from '@coze-arch/bot-api/playground_api';\n\nimport {\n  typeSafeShortcutCommandTextVariants,\n  typeSafeShortcutCommandVariants,\n} from '../variants';\nimport { TooltipWithContent } from '../component';\nimport { enableSendTypePanelHideTemplate } from '../../shortcut-tool/shortcut-edit/method';\nimport { type UIMode } from '../../shortcut-bar/types';\n\ninterface TemplateShortcutProps {\n  shortcut: ShortCutCommand;\n  uiMode: UIMode;\n  toolTipFooterSlot?: React.ReactNode;\n  onClick?: () => void;\n  popoverTipShowBotInfo?: boolean;\n}\n\nexport const TemplateShortcut: FC<TemplateShortcutProps> = props => {\n  const {\n    shortcut,\n    onClick,\n    uiMode,\n    toolTipFooterSlot,\n    popoverTipShowBotInfo = false,\n  } = props;\n  const commandNameRef = useRef<HTMLDivElement>(null);\n  const onShortcutClick = () => {\n    onClick?.();\n  };\n\n  if (shortcut.send_type !== SendType.SendTypePanel) {\n    return null;\n  }\n\n  const hideTemplate = enableSendTypePanelHideTemplate(shortcut);\n\n  return (\n    <div className={typeSafeShortcutCommandVariants({ color: uiMode })}>\n      <TooltipWithContent\n        shortcut={shortcut}\n        toolTipFooterSlot={toolTipFooterSlot}\n        showBotInfo={popoverTipShowBotInfo}\n      >\n        <Button\n          data-testid={`chat-area.chat-input-shortcut.shortcut-button-${shortcut.command_name}`}\n          contentClassName={typeSafeShortcutCommandTextVariants({\n            color: uiMode,\n          })}\n          color=\"secondary\"\n          icon={\n            shortcut.shortcut_icon?.url ? (\n              <img\n                alt=\"icon\"\n                src={shortcut.shortcut_icon.url}\n                className=\"h-[14px]\"\n              />\n            ) : null\n          }\n          iconPosition={'left'}\n          onClick={() => onShortcutClick()}\n        >\n          <div className=\"inline-flex items-center\">\n            <div\n              ref={commandNameRef}\n              className=\"max-w-[176px] overflow-hidden text-ellipsis\"\n            >\n              {shortcut.command_name}\n            </div>\n            {!hideTemplate && (\n              <IconShortcutComponentTag className=\"ml-[10px]\" />\n            )}\n          </div>\n        </Button>\n      </TooltipWithContent>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport cls from 'classnames';\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIButton } from '@coze-arch/bot-semi';\n\nimport style from '../index.module.less';\nimport { type UIMode } from '../../shortcut-bar/types';\nimport ArrowUpIcon from '../../assets/load-more-arrow-up.svg';\nimport ArrowDownIcon from '../../assets/load-more-arrow-down.svg';\n\ninterface TemplateShortcutProps {\n  shortcuts: ShortCutCommand[];\n  uiMode: UIMode;\n  onOpen: () => void;\n  onClose: () => void;\n  isLoadMoreActive: boolean;\n  getPopupContainer: () => HTMLElement | null;\n}\n\nexport const LoadMore: FC<TemplateShortcutProps> = props => {\n  const { onOpen, uiMode, onClose, isLoadMoreActive } = props;\n\n  const onShortcutClick = () => {\n    isLoadMoreActive ? onClose?.() : onOpen?.();\n  };\n\n  return (\n    <div\n      className={cls(style['load-more-shortcut-wrapper'], {\n        [style['shortcut-white'] || '']: uiMode === 'white',\n        [style['shortcut-blur'] || '']: uiMode === 'blur',\n      })}\n    >\n      <UIButton\n        data-testid=\"chat-area.shortcut.load-more-button\"\n        className={cls(style['load-more-button'], style['shortcut-button'], {\n          '!coz-mg-primary-pressed': isLoadMoreActive && uiMode === 'white',\n        })}\n        onClick={onShortcutClick}\n      >\n        <span className=\"mr-1\">{I18n.t('More')}</span>\n        {isLoadMoreActive ? (\n          <img className=\"arraw-icon\" src={ArrowUpIcon} alt=\"up\" />\n        ) : (\n          <img className=\"arraw-icon\" src={ArrowDownIcon} alt=\"down\" />\n        )}\n      </UIButton>\n    </div>\n  );\n};\n","import * as React from \"react\";\nconst SvgLoadMoreArrowUp = props => <svg xmlns=\"http://www.w3.org/2000/svg\" width={12} height={12} fill=\"none\" viewBox=\"0 0 12 12\" {...props}><path fill=\"currentColor\" fillOpacity={0.5} d=\"m6.002 4.825 3.536 3.536a.5.5 0 0 0 .707 0l.354-.354a.5.5 0 0 0 0-.707l-3.89-3.889a1 1 0 0 0-1.414 0l-3.889 3.89a.5.5 0 0 0 0 .706l.354.354a.5.5 0 0 0 .707 0z\" /></svg>;\nexport { SvgLoadMoreArrowUp as ReactComponent };\nexport default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9ImNvel9hcnJvd19kb3duX2ZpbGwiPgo8cGF0aCBpZD0iVW5pb24iIGQ9Ik02LjAwMjQxIDQuODI1MzRMOS41Mzc5NCA4LjM2MDg4QzkuNzMzMiA4LjU1NjE0IDEwLjA0OTggOC41NTYxNCAxMC4yNDUgOC4zNjA4OEwxMC41OTg2IDguMDA3MzJDMTAuNzkzOSA3LjgxMjA2IDEwLjc5MzkgNy40OTU0OCAxMC41OTg2IDcuMzAwMjJMNi43MDk1MSAzLjQxMTEzQzYuMzE4OTkgMy4wMjA2MSA1LjY4NTgyIDMuMDIwNjEgNS4yOTUzIDMuNDExMTNMMS40MDYyMSA3LjMwMDIyQzEuMjEwOTUgNy40OTU0OCAxLjIxMDk1IDcuODEyMDYgMS40MDYyMSA4LjAwNzMyTDEuNzU5NzcgOC4zNjA4OEMxLjk1NTAzIDguNTU2MTQgMi4yNzE2MSA4LjU1NjE0IDIuNDY2ODcgOC4zNjA4OEw2LjAwMjQxIDQuODI1MzRaIiBmaWxsPSJjdXJyZW50Q29sb3IiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjwvZz4KPC9zdmc+Cg==\";","import * as React from \"react\";\nconst SvgLoadMoreArrowDown = props => <svg xmlns=\"http://www.w3.org/2000/svg\" width={12} height={12} fill=\"none\" viewBox=\"0 0 12 12\" {...props}><path fill=\"currentColor\" fillOpacity={0.5} d=\"m6.002 7.175 3.536-3.536a.5.5 0 0 1 .707 0l.354.354a.5.5 0 0 1 0 .707l-3.89 3.889a1 1 0 0 1-1.414 0l-3.889-3.89a.5.5 0 0 1 0-.706l.354-.354a.5.5 0 0 1 .707 0z\" /></svg>;\nexport { SvgLoadMoreArrowDown as ReactComponent };\nexport default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9ImNvel9hcnJvd19kb3duX2ZpbGwiPgo8cGF0aCBpZD0iVW5pb24iIGQ9Ik02LjAwMjQxIDcuMTc0NjZMOS41Mzc5NCAzLjYzOTEyQzkuNzMzMiAzLjQ0Mzg2IDEwLjA0OTggMy40NDM4NiAxMC4yNDUgMy42MzkxMkwxMC41OTg2IDMuOTkyNjhDMTAuNzkzOSA0LjE4Nzk0IDEwLjc5MzkgNC41MDQ1MiAxMC41OTg2IDQuNjk5NzhMNi43MDk1MSA4LjU4ODg3QzYuMzE4OTkgOC45NzkzOSA1LjY4NTgyIDguOTc5MzkgNS4yOTUzIDguNTg4ODdMMS40MDYyMSA0LjY5OTc4QzEuMjEwOTUgNC41MDQ1MiAxLjIxMDk1IDQuMTg3OTQgMS40MDYyMSAzLjk5MjY4TDEuNzU5NzcgMy42MzkxMkMxLjk1NTAzIDMuNDQzODYgMi4yNzE2MSAzLjQ0Mzg2IDIuNDY2ODcgMy42MzkxMkw2LjAwMjQxIDcuMTc0NjZaIiBmaWxsPSJjdXJyZW50Q29sb3IiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjwvZz4KPC9zdmc+Cg==\";","\n      import API from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Quick command bar\nimport { type CSSProperties, type FC, useRef, useState } from 'react';\n\nimport cls from 'classnames';\nimport { useMessageWidth } from '@coze-common/chat-area';\nimport { OverflowList, Popover } from '@coze-arch/bot-semi';\nimport { SendType } from '@coze-arch/bot-api/playground_api';\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\n\nimport {\n  enableSendTypePanelHideTemplate,\n  getFormValueFromShortcut,\n} from '../shortcut-tool/shortcut-edit/method';\nimport { ShortcutTemplate } from '../shortcut-template';\nimport { ShortcutsLoadMoreList } from '../shortcut/load-more/shortcuts-load-more-list';\nimport { TemplateShortcut, LoadMore, QueryShortcut } from '../shortcut';\nimport { useSendUseToolMessage } from '../hooks/shortcut';\nimport { type TValue } from '../components/short-cut-panel/widgets/types';\nimport {\n  type OnBeforeSendQueryShortcutParams,\n  type OnBeforeSendTemplateShortcutParams,\n  type UIMode,\n} from './types';\n\nimport style from './index.module.less';\n\ninterface ChatShortCutBarProps {\n  shortcuts: ShortCutCommand[];\n  onActiveShortcutChange?: (\n    shortcutInfo?: ShortCutCommand,\n    isTemplateShortcutActive?: boolean,\n  ) => void;\n  className?: string;\n  wrapperClassName?: string;\n  uiMode?: UIMode; // The default is white, and it is blurred when there is a background.\n  defaultId?: string;\n  wrapperStyle?: CSSProperties;\n  toolTipFooterSlot?: React.ReactNode;\n  onBeforeSendTemplateShortcut?: (\n    params: OnBeforeSendTemplateShortcutParams & {\n      shortcut: ShortCutCommand;\n    },\n  ) => OnBeforeSendTemplateShortcutParams;\n  onBeforeSendTextMessage?: (\n    params: OnBeforeSendQueryShortcutParams,\n  ) => OnBeforeSendQueryShortcutParams;\n  popoverTipShowBotInfo?: boolean;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function\nexport const ShortcutBar: FC<ChatShortCutBarProps> = props => {\n  const {\n    shortcuts,\n    onActiveShortcutChange,\n    className,\n    wrapperClassName,\n    defaultId,\n    uiMode = 'white',\n    wrapperStyle,\n    toolTipFooterSlot,\n    onBeforeSendTemplateShortcut,\n    onBeforeSendTextMessage,\n    popoverTipShowBotInfo = false,\n  } = props;\n  const overflowListRef = useRef<HTMLDivElement>(null);\n  const [isShowLoadMoreList, setIsShowLoadMoreList] = useState(false);\n  const [activeShortcut, setActiveShortcut] = useState<\n    ShortCutCommand | undefined\n  >(undefined);\n  const [shortcutTemplateVisible, setShortcutTemplateVisible] = useState(false);\n  const sendUseToolMessage = useSendUseToolMessage();\n  const messageWidth = useMessageWidth();\n\n  const handleActiveShortcutChange = (\n    shortcut: ShortCutCommand | undefined,\n    hideTemplate = false,\n  ) => {\n    setActiveShortcut(shortcut);\n\n    const isTemplateShortcutActive =\n      shortcut?.send_type === SendType.SendTypePanel && !hideTemplate;\n\n    onActiveShortcutChange?.(shortcut, isTemplateShortcutActive);\n    setShortcutTemplateVisible(isTemplateShortcutActive);\n  };\n\n  const shortcutClick = (shortcut: ShortCutCommand) => {\n    /**\n     * send_type = SendTypePanel and components_list hide is true\n     * send directly\n     */\n    const hideTemplate = enableSendTypePanelHideTemplate(shortcut);\n\n    if (hideTemplate) {\n      onShortcutTemplateNoParamsSubmit(\n        getFormValueFromShortcut(shortcut),\n        shortcut,\n      );\n    }\n\n    handleActiveShortcutChange(shortcut, hideTemplate);\n\n    setIsShowLoadMoreList(false);\n  };\n\n  const closeShortcutTemplate = () => {\n    setShortcutTemplateVisible(false);\n    handleActiveShortcutChange(undefined);\n  };\n\n  const renderShortcut = (shortcut: ShortCutCommand) => (\n    <>\n      {shortcut.send_type === SendType.SendTypeQuery && (\n        <QueryShortcut\n          uiMode={uiMode}\n          key={shortcut.command_id}\n          shortcut={shortcut}\n          onBeforeSend={onBeforeSendTextMessage}\n          toolTipFooterSlot={toolTipFooterSlot}\n          popoverTipShowBotInfo={popoverTipShowBotInfo}\n          onClick={() => shortcutClick(shortcut)}\n        />\n      )}\n      {shortcut.send_type === SendType.SendTypePanel && (\n        <TemplateShortcut\n          uiMode={uiMode}\n          key={shortcut.command_id}\n          shortcut={shortcut}\n          toolTipFooterSlot={toolTipFooterSlot}\n          popoverTipShowBotInfo={popoverTipShowBotInfo}\n          onClick={() => shortcutClick(shortcut)}\n        />\n      )}\n    </>\n  );\n\n  const onShortcutTemplateSubmit = (\n    componentsFormValues: Record<string, TValue>,\n  ) => {\n    if (!activeShortcut) {\n      return;\n    }\n    const { agent_id, object_id } = activeShortcut;\n    sendUseToolMessage({\n      shortcut: activeShortcut,\n      options: {\n        extendFiled: {\n          extra: {\n            bot_state: JSON.stringify({\n              agent_id,\n              bot_id: object_id,\n            }),\n          },\n        },\n      },\n      componentsFormValues,\n      onBeforeSendTemplateShortcut,\n    });\n    closeShortcutTemplate();\n  };\n\n  /**\n   * sendType = panel supports sending directly without displaying components\n   */\n  const onShortcutTemplateNoParamsSubmit = (\n    componentsFormValues: Record<string, TValue>,\n    shortcut?: ShortCutCommand,\n  ) => {\n    if (!shortcut) {\n      return;\n    }\n\n    const { agent_id, object_id, components_list, tool_info } = shortcut;\n    /**\n     * sendType = panel, useTool = true Send directly without parameters\n     */\n    const withoutComponentsList =\n      !!tool_info?.tool_name && !components_list?.length;\n\n    sendUseToolMessage({\n      shortcut,\n      options: {\n        extendFiled: {\n          extra: {\n            bot_state: JSON.stringify({\n              agent_id,\n              bot_id: object_id,\n            }),\n          },\n        },\n      },\n      componentsFormValues,\n      onBeforeSendTemplateShortcut,\n      withoutComponentsList,\n    });\n    closeShortcutTemplate();\n  };\n\n  if (!shortcuts?.length) {\n    return null;\n  }\n\n  if (shortcutTemplateVisible && activeShortcut) {\n    return (\n      <ShortcutTemplate\n        shortcut={activeShortcut}\n        onSubmit={onShortcutTemplateSubmit}\n        visible={shortcutTemplateVisible}\n        onClose={() => {\n          handleActiveShortcutChange(undefined);\n        }}\n      />\n    );\n  }\n\n  return (\n    <div\n      className={cls(\n        style['shortcut-bar'],\n        className,\n        'flex justify-center items-center w-full',\n      )}\n    >\n      <Popover\n        content={\n          <ShortcutsLoadMoreList\n            defaultId={defaultId}\n            shortcuts={shortcuts}\n            onBeforeSendTextMessage={onBeforeSendTextMessage}\n            onSelect={shortcutClick}\n          />\n        }\n        onVisibleChange={setIsShowLoadMoreList}\n        position={'topLeft'}\n        trigger=\"custom\"\n        visible={isShowLoadMoreList}\n        spacing={{\n          x: 0,\n          y: 9,\n        }}\n        getPopupContainer={() => overflowListRef.current || document.body}\n        onClickOutSide={() => setIsShowLoadMoreList(false)}\n        onEscKeyDown={() => setIsShowLoadMoreList(false)}\n      >\n        <div\n          ref={overflowListRef}\n          className={cls(wrapperClassName, 'relative flex justify-start pb-4')}\n          style={{\n            maxWidth: messageWidth,\n            ...wrapperStyle,\n          }}\n        >\n          <OverflowList\n            style={{\n              width: '100%',\n            }}\n            minVisibleItems={1}\n            items={shortcuts}\n            // @ts-expect-error visibleItemRenderer has a problem\n            visibleItemRenderer={renderShortcut}\n            overflowRenderer={overflowItems => {\n              if (!overflowItems.length) {\n                return null;\n              }\n              return (\n                <LoadMore\n                  uiMode={uiMode}\n                  isLoadMoreActive={isShowLoadMoreList}\n                  shortcuts={shortcuts}\n                  onOpen={() => setIsShowLoadMoreList(true)}\n                  onClose={() => setIsShowLoadMoreList(false)}\n                  getPopupContainer={() => overflowListRef.current}\n                />\n              );\n            }}\n          />\n        </div>\n      </Popover>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { exhaustiveCheckSimple } from '@coze-common/chat-area-utils';\n\nimport { type UIMode } from '../shortcut-bar/types';\n\nexport const getUIModeByBizScene: (props: {\n  bizScene: 'debug' | 'store' | 'home' | 'agentApp' | 'websdk';\n  showBackground: boolean;\n}) => UIMode = ({ bizScene, showBackground }) => {\n  if (bizScene === 'agentApp') {\n    return 'grey';\n  }\n  if (bizScene === 'home') {\n    if (showBackground) {\n      return 'blur';\n    }\n    return 'white';\n  }\n\n  if (bizScene === 'store' || bizScene === 'debug' || bizScene === 'websdk') {\n    if (showBackground) {\n      return 'blur';\n    }\n    return 'grey';\n  }\n  exhaustiveCheckSimple(bizScene);\n  return 'white';\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getFileInfo,\n  type UploadPluginConstructor,\n} from '@coze-common/chat-core';\nimport { useGetRegisteredPlugin } from '@coze-common/chat-area';\n\n// Start simulating upload progress after 1.5s delay\nconst FAKE_PROGRESS_START_DELAY = 1500;\n// Fake progress initial progress\nconst FAKE_PROGRESS_START = 50;\n// maximum progress\nconst FAKE_PROGRESS_MAX = 85;\n// value per step\nconst FAKE_PROGRESS_STEP = 5;\n// Cycle interval\nconst FAKE_PROGRESS_INTERVAL = 100;\n\nexport const useGetUploadPluginInstance = () => {\n  const getRegisteredPlugin = useGetRegisteredPlugin();\n\n  return ({\n    file,\n    onProgress,\n    onError,\n    onSuccess,\n  }: {\n    file: File;\n    onProgress?: (percent: number) => void;\n    onError?: (error: { status: number | undefined }) => void;\n    onSuccess?: (url: string, width: number, height: number) => void;\n  }) => {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    const UploadPlugin: UploadPluginConstructor | null | undefined =\n      getRegisteredPlugin('upload-plugin');\n    if (!UploadPlugin) {\n      return;\n    }\n    const uploader = new UploadPlugin({\n      file,\n      type: getFileInfo(file)?.fileType === 'image' ? 'image' : 'object',\n    });\n    // If the upload progress does not change within 1s, actively trigger fake progress, increase from 50% to 80% within 500ms, ignoring the subsequent real progress\n    let isStartFakeProgress = false;\n    let fakeProgressTimer: number | undefined;\n    let fakeProgress = FAKE_PROGRESS_START;\n    const fakeProgressHandler = () => {\n      if (fakeProgress < FAKE_PROGRESS_MAX) {\n        fakeProgress += FAKE_PROGRESS_STEP;\n        onProgress?.(fakeProgress);\n      }\n    };\n\n    const startFakeProgressTimer = setTimeout(() => {\n      isStartFakeProgress = true;\n      fakeProgressTimer = window.setInterval(\n        fakeProgressHandler,\n        FAKE_PROGRESS_INTERVAL,\n      );\n    }, FAKE_PROGRESS_START_DELAY);\n\n    function clearFakeProgress() {\n      clearTimeout(startFakeProgressTimer);\n      clearInterval(fakeProgressTimer);\n      fakeProgressTimer = undefined;\n      fakeProgressTimer = undefined;\n      isStartFakeProgress = false;\n    }\n    uploader.on('progress', ({ percent }) => {\n      // There is a fake progress, ignore the subsequent real progress.\n      if (isStartFakeProgress) {\n        return;\n      }\n      startFakeProgressTimer && clearFakeProgress();\n      onProgress?.(percent);\n    });\n    uploader.on('error', e => {\n      onError?.({ status: e.extra.errorCode });\n      clearFakeProgress();\n    });\n\n    uploader.on(\n      'complete',\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      ({ uploadResult: { Url, Uri, ImageHeight = 0, ImageWidth = 0 } }) => {\n        {\n          onSuccess?.(Url || Uri || '', ImageWidth, ImageHeight);\n          clearFakeProgress();\n        }\n      },\n    );\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext } from 'react';\n\nexport const ChatAreaStateContext = createContext<{\n  isSendMessageLock: boolean;\n}>({ isSendMessageLock: false });\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { Form, Tooltip, Typography } from '@coze-arch/bot-semi';\nimport { IconInfo } from '@coze-arch/bot-icons';\n\nimport style from './index.module.less';\n\nexport const LabelWithDescription: FC<{\n  name: string;\n  description?: string;\n  required?: boolean;\n}> = ({ name, description, required = true }) => (\n  <div className=\"w-full flex items-center px-2 mb-[2px]\">\n    <Form.Label\n      text={\n        <Typography.Text\n          ellipsis={{ showTooltip: true }}\n          className={style.text}\n        >\n          {name}\n        </Typography.Text>\n      }\n      required={required}\n      className={style.label}\n    />\n    {!!description && (\n      <Tooltip content={description}>\n        <IconInfo className={style.icon} />\n      </Tooltip>\n    )}\n  </div>\n);\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState, useRef, useEffect } from 'react';\n\nimport classnames from 'classnames';\nimport { getFileInfo } from '@coze-common/chat-core';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FileItem } from '@coze-arch/bot-semi/Upload';\nimport {\n  IconButton,\n  Toast,\n  Typography,\n  UIButton,\n  UIInput,\n  Upload,\n  useFieldApi,\n  withField,\n} from '@coze-arch/bot-semi';\nimport {\n  IconAdd,\n  IconClose,\n  IconCloseNoCycle,\n  IconCopyLink,\n} from '@coze-arch/bot-icons';\nimport { type shortcut_command } from '@coze-arch/bot-api/playground_api';\n\nimport {\n  type DSLFormFieldCommonProps,\n  type DSLComponent,\n  type TValue,\n  type TCustomUpload,\n} from '../types';\nimport { LabelWithDescription } from '../label-with-desc';\nimport { getFileInfoByFileType } from '../../../../utils/file-const';\n\nimport style from './index.module.less';\n\nconst UploadContent: FC<{\n  file: FileItem;\n  disabled?: boolean;\n  inputType: shortcut_command.InputType;\n  onRemove: () => void;\n  onRetry: () => void;\n}> = ({ file, disabled, inputType, onRemove, onRetry }) => {\n  const isFailed = file.status === 'uploadFail';\n  const isUploading = file.status === 'uploading';\n  const fileType =\n    file.fileInstance && getFileInfo(file.fileInstance)?.fileType;\n  const fileIcon = fileType && getFileInfoByFileType(fileType)?.icon;\n\n  return (\n    <div\n      className={classnames(\n        style.file,\n        'flex border border-solid rounded-lg items-center w-full coz-stroke-primary',\n        {\n          [style['file-uploading'] || '']: isUploading,\n        },\n      )}\n      style={{\n        // @ts-expect-error ts cannot recognize custom variable\n        '--var-percent': `${file.percent}%`,\n      }}\n    >\n      <img\n        src={fileIcon ?? file.url}\n        className={classnames(\n          'w-6 h-6',\n          fileType === 'image' &&\n            'rounded border border-solid coz-stroke-primary',\n        )}\n      />\n      <Typography.Text ellipsis className=\"mx-2 flex-1 text-sm\">\n        {file.name}\n      </Typography.Text>\n      {isFailed ? (\n        <div\n          onClick={e => {\n            e.stopPropagation();\n            if (!disabled) {\n              onRetry();\n            }\n          }}\n          className={style.retry}\n        >\n          <IconClose className=\"coz-fg-hglt-red\" />\n          <div>{I18n.t('Retry')}</div>\n        </div>\n      ) : null}\n      <IconButton\n        className={classnames('close-btn w-5 h-5', style['delete-btn'])}\n        disabled={disabled}\n        onClick={e => {\n          e.stopPropagation();\n          onRemove();\n        }}\n        theme=\"borderless\"\n        size=\"small\"\n        icon={<IconCloseNoCycle className={style['delete-icon']} />}\n      />\n    </div>\n  );\n};\n\ninterface UploadProps {\n  value?: unknown;\n  name: string;\n  onChange?: (value: TValue) => void;\n  uploadFile?: TCustomUpload;\n  maxSize?: number;\n  accept?: string;\n  disabled?: boolean;\n  validateStatus?: 'error' | 'success';\n  inputType: shortcut_command.InputType;\n}\n\nconst FileUpload: FC<\n  UploadProps & {\n    toggle: () => void;\n  }\n> = ({\n  value,\n  name,\n  uploadFile,\n  onChange,\n  inputType,\n  disabled,\n  toggle,\n  ...props\n}) => {\n  const [file, setFile] = useState<FileItem | undefined>();\n  const fieldApi = useFieldApi(name);\n  const uidRef = useRef<string | undefined>(file?.uid);\n  const onUpload = (newFile: FileItem) => {\n    if (newFile.fileInstance) {\n      setFile({\n        ...newFile,\n        percent: 0,\n        status: 'uploading',\n      });\n      // Immediately clean up the error state\n      fieldApi.setError(true);\n      uidRef.current = newFile?.uid;\n      uploadFile?.({\n        file: newFile.fileInstance,\n        onProgress: percent => {\n          if (uidRef.current !== newFile.uid) {\n            return;\n          }\n          setFile({\n            ...newFile,\n            percent,\n            status: 'uploading',\n          });\n        },\n        onSuccess: (url, width = 0, height = 0) => {\n          if (uidRef.current !== newFile.uid) {\n            return;\n          }\n          onChange?.({\n            fileInstance: newFile.fileInstance,\n            url,\n            width,\n            height,\n          });\n          setFile({\n            ...newFile,\n            response: url,\n            percent: 100,\n            status: 'success',\n          });\n        },\n        onError: () => {\n          if (uidRef.current !== newFile.uid) {\n            return;\n          }\n          // Upload failed, error status triggered\n          fieldApi.setError(false);\n          setFile({\n            ...newFile,\n            status: 'uploadFail',\n          });\n        },\n      });\n    }\n  };\n\n  return (\n    <>\n      <Upload\n        action=\"\"\n        className=\"w-full\"\n        draggable\n        limit={1}\n        {...props}\n        disabled={disabled}\n        onAcceptInvalid={() => {\n          Toast.error(I18n.t('shortcut_Illegal_file_format'));\n        }}\n        onSizeError={() => {\n          if (props.maxSize) {\n            Toast.error(\n              I18n.t('file_too_large', {\n                max_size: `${props.maxSize / 1024}MB`,\n              }),\n            );\n          }\n        }}\n        customRequest={({ onSuccess }) => {\n          // Even if action = \", a request to upload a file to the current URL will still be triggered without customRequest\n          // Here is a mock customRequest to prevent semi default upload behavior\n          onSuccess('');\n        }}\n        showUploadList={false}\n        onChange={({ currentFile }) => {\n          // Semi The same file will trigger multiple onChanges, only the first one is responded here\n          if (\n            uidRef.current !== currentFile.uid &&\n            (!props.maxSize ||\n              (currentFile.fileInstance?.size &&\n                currentFile.fileInstance.size <= props.maxSize * 1024))\n          ) {\n            onUpload(currentFile);\n          }\n        }}\n      >\n        {file ? (\n          <UploadContent\n            file={file}\n            inputType={inputType}\n            onRemove={() => {\n              uidRef.current = undefined;\n              setFile(undefined);\n              onChange?.('');\n              setTimeout(() => {\n                // Delete files, clean up error states to avoid immediate redness\n                fieldApi.setError(true);\n              });\n            }}\n            onRetry={() => {\n              if (file) {\n                onUpload(file);\n              }\n            }}\n          />\n        ) : (\n          <UIButton\n            icon={<IconAdd />}\n            disabled={disabled}\n            className={classnames(style['upload-button'], 'w-full')}\n          >\n            <span className={style['upload-button-text-short']}>\n              {I18n.t('shortcut_component_upload_component_placeholder')}\n            </span>\n          </UIButton>\n        )}\n      </Upload>\n      {!file && (\n        <IconButton\n          disabled={disabled}\n          icon={<IconCopyLink />}\n          onClick={toggle}\n        />\n      )}\n    </>\n  );\n};\n\nconst FileInput: FC<\n  UploadProps & {\n    toggle: () => void;\n  }\n> = ({ disabled, onChange, toggle }) => (\n  <>\n    <UIInput disabled={disabled} onChange={onChange} className={style.input} />\n    <IconButton\n      disabled={disabled}\n      icon={<IconCloseNoCycle />}\n      onClick={toggle}\n    />\n  </>\n);\n\n// To facilitate control of the value passed outward\nconst UploadInner = withField((props: UploadProps) => {\n  const [showInput, setShowInput] = useState(false);\n  const hasError = props.validateStatus === 'error';\n  const fieldApi = useFieldApi(props.name);\n\n  // Avoid flushing red caused by empty input\n  useEffect(() => {\n    setTimeout(() => {\n      props.onChange?.('');\n      // Avoid onchange triggering verification and causing immediate redness\n      setTimeout(() => {\n        fieldApi.setError(true);\n      });\n    });\n  }, [showInput]);\n\n  return (\n    <div\n      className={classnames(\n        'flex items-center justify-start gap-2',\n        style.container,\n        hasError && style['container-error'],\n      )}\n    >\n      {showInput ? (\n        <FileInput\n          toggle={() => {\n            setShowInput(false);\n          }}\n          {...props}\n        />\n      ) : (\n        <FileUpload\n          toggle={() => {\n            setShowInput(true);\n          }}\n          {...props}\n        />\n      )}\n    </div>\n  );\n});\n\nexport const DSLFormUpload: DSLComponent<\n  DSLFormFieldCommonProps & {\n    maxSize?: number;\n    accept?: string;\n    inputType: shortcut_command.InputType;\n  }\n> = ({\n  context: { uploadFile, readonly },\n  props: { name, description, rules, ...props },\n}) => (\n  <div>\n    <LabelWithDescription name={name} description={description} />\n    <UploadInner\n      field={name}\n      noLabel\n      name={name}\n      fieldStyle={{ padding: 0 }}\n      uploadFile={uploadFile}\n      disabled={readonly}\n      rules={readonly ? undefined : rules}\n      {...props}\n    />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type RuleItem } from '@coze-arch/bot-semi/Form';\nimport { Form } from '@coze-arch/bot-semi';\n\nimport { type DSLFormFieldCommonProps, type DSLComponent } from '../types';\nimport { LabelWithDescription } from '../label-with-desc';\n\nconst parseRules = (rules: RuleItem[]): RuleItem[] =>\n  rules.map(rule => {\n    if (rule.required) {\n      return {\n        ...rule,\n        //  Do not enter spaces if required\n        validator: (r, v) => !!v?.trim(),\n      };\n    }\n    return rule;\n  });\n\nexport const DSLFormInput: DSLComponent<DSLFormFieldCommonProps> = ({\n  context: { readonly },\n  props: { name, description, rules, defaultValue, ...props },\n}) => {\n  const required = !defaultValue?.value;\n\n  return (\n    <div>\n      <LabelWithDescription\n        required={required}\n        name={name}\n        description={description}\n      />\n      <Form.Input\n        disabled={readonly}\n        fieldStyle={{ padding: 0 }}\n        placeholder={defaultValue?.value}\n        className=\"w-full\"\n        field={name}\n        noLabel\n        rules={parseRules(rules)}\n        {...props}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { ChatAreaStateContext } from './context';\n\nexport const useChatAreaState = () => useContext(ChatAreaStateContext);\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconButton, useFormState } from '@coze-arch/bot-semi';\nimport { IconSend } from '@coze-arch/bot-icons';\n\nimport {\n  type DSLContext,\n  type DSLComponent,\n  type DSLFormFieldCommonProps,\n} from '../types';\nimport { findInputElementById } from '../../../../utils/dsl-template';\nimport { useChatAreaState } from '../../../../context/chat-area-state';\n\nimport styles from './index.module.less';\n\ninterface DSLSubmitButtonProps {\n  formFields?: string[];\n}\n\nconst useIsSubmitButtonDisable = ({\n  context: { readonly, dsl },\n  props: { formFields = [] },\n}: {\n  context: DSLContext;\n  props: Pick<DSLSubmitButtonProps, 'formFields'>;\n}): boolean => {\n  const formState = useFormState();\n  const disabled = formFields.some(field => {\n    const isEmpty = !formState.values[field];\n    const isError = !!formState.errors?.[field];\n    const inputDefaultValue = findInputElementById(dsl, field)?.props\n      ?.defaultValue as DSLFormFieldCommonProps['defaultValue'];\n\n    if (inputDefaultValue?.value) {\n      return isError;\n    }\n\n    return isError || isEmpty;\n  });\n  const { isSendMessageLock } = useChatAreaState();\n\n  return readonly || disabled || isSendMessageLock;\n};\n\nexport const DSLSubmitButton: DSLComponent<DSLSubmitButtonProps> = ({\n  context,\n  props,\n}) => {\n  const isDisabled = useIsSubmitButtonDisable({ context, props });\n\n  return (\n    <div className=\"flex justify-end\">\n      <IconButton\n        theme=\"borderless\"\n        className={styles.button}\n        htmlType=\"submit\"\n        size=\"small\"\n        disabled={isDisabled}\n        icon={<IconSend />}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DSLFormUpload } from './upload';\nimport { type DSLComponent } from './types';\nimport { DSLFormInput } from './text-input';\nimport { DSLSubmitButton } from './submit-button';\nimport { DSLFormSelect } from './select';\nimport { DSLRoot } from './root';\nimport { DSLPlaceholer } from './placeholder';\nimport { DSLColumnLayout } from './layout';\nimport { DSLForm } from './form';\n\n// Component parameters are determined at run time and cannot be subject to specific type constraints\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const DSLWidgetsMap: Record<string, DSLComponent<any>> = {\n  '@flowpd/cici-components/Input': DSLFormInput,\n  '@flowpd/cici-components/Select': DSLFormSelect,\n  '@flowpd/cici-components/Upload': DSLFormUpload,\n  '@flowpd/cici-components/Placeholder': DSLPlaceholer,\n  '@flowpd/cici-components/ColumnLayout': DSLColumnLayout,\n  '@flowpd/cici-components/Form': DSLForm,\n  '@flowpd/cici-components/PageContainer': DSLRoot,\n  '@flowpd/cici-components/Button': DSLSubmitButton,\n} as const;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SelectProps } from '@coze-arch/bot-semi/Select';\nimport { UIFormSelect } from '@coze-arch/bot-semi';\n\nimport { type DSLFormFieldCommonProps, type DSLComponent } from '../types';\nimport { LabelWithDescription } from '../label-with-desc';\n\nexport const DSLFormSelect: DSLComponent<\n  DSLFormFieldCommonProps & Pick<SelectProps, 'optionList'>\n> = ({\n  context: { readonly },\n  props: { name, description, defaultValue, ...props },\n}) => {\n  const required = !defaultValue?.value;\n\n  return (\n    <div>\n      <LabelWithDescription\n        name={name}\n        description={description}\n        required={required}\n      />\n      <UIFormSelect\n        disabled={readonly}\n        fieldStyle={{ padding: 0 }}\n        className=\"w-full\"\n        field={name}\n        initValue={defaultValue?.value}\n        noLabel\n        {...props}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport const DSLPlaceholer: FC = () => (\n  <div\n    className=\"flex items-center justify-center rounded-lg coz-bg-plus text-center text-xs font-medium coz-fg-secondary \"\n    style={{ height: 58 }}\n  >\n    {I18n.t('shortcut_modal_components')}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { FC, PropsWithChildren } from 'react';\n\n// This issue does not need to support multiple layout analysis\nexport const DSLColumnLayout: FC<PropsWithChildren> = ({ children }) => (\n  <div className=\"flex items-center justify-between w-full mb-3 gap-2\">\n    {children}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport { Form } from '@coze-arch/bot-semi';\n\nimport { type DSLComponent, type TValue } from '../types';\nimport { findInputElementsWithDefault } from '../../../../utils/dsl-template';\n\ntype FormValue = Record<string, TValue>;\nexport const DSLForm: DSLComponent = ({\n  context: { onChange, onSubmit, dsl },\n  children,\n}) => {\n  const formRef = useRef<FormApi>();\n\n  /**\n   * Text type component interaction, support placeholder to represent default value\n   * @param formValues\n   */\n  const onSubmitWrap = (formValues: FormValue) => {\n    if (!onSubmit) {\n      return;\n    }\n    const inputElementsWithDefault = findInputElementsWithDefault(dsl);\n\n    const newValues = Object.entries(formValues).reduce(\n      (prev: Record<string, TValue>, curr) => {\n        const [field, value] = curr;\n        const input = inputElementsWithDefault.find(i => i.id === field);\n\n        if (input && !value) {\n          prev[field] = input.defaultValue;\n        } else {\n          prev[field] = value;\n        }\n\n        return prev;\n      },\n      {},\n    );\n\n    inputElementsWithDefault.forEach(input => {\n      const { id, defaultValue } = input;\n\n      if (id && !(id in newValues)) {\n        newValues[id] = defaultValue;\n      }\n    });\n\n    onSubmit(newValues);\n  };\n\n  return (\n    <Form<FormValue>\n      className=\"w-full\"\n      autoComplete=\"off\"\n      getFormApi={api => (formRef.current = api)}\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      onChange={formState => onChange?.(formState.values!)}\n      onSubmit={onSubmitWrap}\n    >\n      {children}\n    </Form>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { FC, PropsWithChildren } from 'react';\n\nexport const DSLRoot: FC<PropsWithChildren> = ({ children }) => <>{children}</>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { useIsSendMessageLock } from '@coze-common/chat-area';\n\nimport { type DSL } from '../../types';\nimport { ChatAreaStateContext } from '../../context/chat-area-state/context';\nimport { type DSLContext } from './widgets/types';\nimport { DSLWidgetsMap } from './widgets';\n\nconst getChildrenIds = (item: DSL['elements'][string]): string[] =>\n  item.children ??\n  ((item.props?.Columns ?? []) as { children: string[] }[])?.reduce<string[]>(\n    (res, column) => {\n      if (column.children) {\n        res.push(...column.children);\n      }\n      return res;\n    },\n    [],\n  );\n\nconst DSLRender: FC<\n  {\n    elementId: string;\n  } & IShortCutPanelProps\n> = ({ elementId, ...context }) => {\n  const { dsl } = context;\n  const item = dsl?.elements[elementId];\n  const itemType = item?.type || '';\n  const Component = itemType in DSLWidgetsMap ? DSLWidgetsMap[itemType] : null;\n  const childrenIds = item && getChildrenIds(item);\n\n  if (!Component) {\n    // TODO slardar report\n    return null;\n  }\n  return (\n    <Component context={context} props={item?.props}>\n      {childrenIds?.map(childrenId => (\n        <div className=\"flex-1 overflow-hidden\">\n          <DSLRender key={childrenId} elementId={childrenId} {...context} />\n        </div>\n      ))}\n    </Component>\n  );\n};\n\nexport type IShortCutPanelProps = DSLContext;\n\nexport const ShortCutPanel: FC<IShortCutPanelProps> = ({ dsl, ...context }) => {\n  const isSendMessageLock = useIsSendMessageLock();\n\n  return (\n    <ChatAreaStateContext.Provider value={{ isSendMessageLock }}>\n      <DSLRender elementId={dsl.rootID} dsl={dsl} {...context} />\n    </ChatAreaStateContext.Provider>\n  );\n};\n","\n      import API from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Template component for shortcut command replacement\nimport { type FC, useMemo, useRef } from 'react';\n\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\nimport { useMessageWidth } from '@coze-common/chat-area';\nimport { UIIconButton } from '@coze-arch/bot-semi';\nimport { IconShortcutTemplateClose } from '@coze-arch/bot-icons';\n\nimport { getDSLFromComponents } from '../utils/dsl-template';\nimport { useGetUploadPluginInstance } from '../hooks/use-upload-plugin';\nimport { type TValue } from '../components/short-cut-panel/widgets/types';\nimport { ShortCutPanel } from '../components/short-cut-panel';\n\nimport style from './index.module.less';\n\ninterface ShortcutTemplateProps {\n  shortcut: Partial<ShortCutCommand>;\n  visible?: boolean;\n  readonly?: boolean;\n  onClose?: () => void;\n  onSubmit?: (componentsFormValues: Record<string, TValue>) => void;\n}\nexport const ShortcutTemplate: FC<ShortcutTemplateProps> = props => {\n  const { shortcut, onClose, visible, readonly, onSubmit } = props;\n  const shortcutTemplateRef = useRef<HTMLDivElement>(null);\n  const getRegisteredPluginInstance = useGetUploadPluginInstance();\n  const messageWidth = useMessageWidth();\n\n  const dsl = useMemo(() => {\n    const showComponents =\n      shortcut.components_list?.filter(com => !com.hide) ?? [];\n    return getDSLFromComponents(showComponents);\n  }, [shortcut.components_list]);\n\n  const onShortcutPanelSubmit = (values: Record<string, TValue>) => {\n    onSubmit?.(values);\n  };\n\n  if (!visible) {\n    return null;\n  }\n\n  return (\n    <>\n      <div\n        ref={shortcutTemplateRef}\n        className={style['shortcut-template']}\n        style={{\n          width: `calc(${messageWidth} - 48px)`,\n        }}\n      >\n        {/*header*/}\n        <div className=\"flex items-center text-sm coz-fg-primary px-4 py-[6px] coz-bg-primary rounded-t-3xl h-8\">\n          {shortcut.shortcut_icon?.url ? (\n            <img\n              src={shortcut.shortcut_icon.url}\n              alt=\"icon\"\n              className=\"mr-1 h-[14px]\"\n            />\n          ) : null}\n          <div>{shortcut.command_name}</div>\n          <UIIconButton\n            icon={<IconShortcutTemplateClose />}\n            onClick={onClose}\n            wrapperClass=\"ml-auto\"\n          />\n        </div>\n        {/*content*/}\n        <div className=\"p-3\">\n          <ShortCutPanel\n            uploadFile={({ file, onError, onProgress, onSuccess }) => {\n              getRegisteredPluginInstance?.({\n                file,\n                onProgress,\n                onError,\n                onSuccess,\n              });\n            }}\n            readonly={readonly}\n            onSubmit={onShortcutPanelSubmit}\n            dsl={dsl}\n          />\n        </div>\n      </div>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport {\n  InputType,\n  type shortcut_command,\n  type ToolInfo,\n} from '@coze-arch/bot-api/playground_api';\n\nimport { shortid } from '../../../utils/uuid';\nimport { type UploadItemType } from '../../../utils/file-const';\nimport { type ComponentsWithId, type ComponentTypeItem } from './types';\n\nconst MAX_COMPONENTS = 10;\n\nexport const attachIdToComponents = (\n  components: shortcut_command.Components[],\n): ComponentsWithId[] =>\n  components.map(item => ({\n    ...item,\n    id: shortid(),\n  }));\n\nexport const formatSubmitValues = (\n  values: ComponentsWithId[],\n): shortcut_command.Components[] =>\n  values.map(({ id, options, ...value }) => ({\n    ...value,\n    options: value.input_type === InputType.Select ? options : [],\n  }));\n\nexport const checkDuplicateName = (\n  values: ComponentsWithId[],\n  formApi: FormApi,\n) => {\n  const fieldMap: Record<string, number[]> = {};\n  values.forEach((item, index) => {\n    if (item.name) {\n      if (fieldMap[item.name]) {\n        fieldMap[item.name]?.push(index);\n      } else {\n        fieldMap[item.name] = [index];\n      }\n    }\n  });\n  setTimeout(() => {\n    // Avoid being overwritten by the field's own check state immediately after modification\n    Object.entries(fieldMap).forEach(([name, indexArray]) => {\n      const isDuplicated = indexArray.length > 1;\n      indexArray.forEach(index => {\n        formApi.setError(`values.${index}.name`, !isDuplicated);\n      });\n    });\n  });\n  return Object.entries(fieldMap).some(\n    ([name, indexArr]) => indexArr.length > 1,\n  );\n};\n\nexport interface SubmitComponentTypeFields {\n  input_type?: InputType;\n  options?: string[];\n  upload_options?: UploadItemType[];\n}\n\nexport const getComponentTypeSelectFormInitValues = (): ComponentTypeItem => ({\n  type: 'text',\n});\n\n// Define a mapping object that maps the ComponentTypeItem type to the corresponding input_type and other fields\nconst componentTypeHandlers = {\n  text: () => ({ input_type: InputType.TextInput }),\n  select: (value: ComponentTypeItem) => {\n    const { type } = value;\n    if (type !== 'select') {\n      return;\n    }\n    return {\n      input_type: InputType.Select,\n      options: value.options,\n    };\n  },\n  upload: (value: ComponentTypeItem) => {\n    if (value.type !== 'upload') {\n      return;\n    }\n    const { uploadTypes } = value;\n\n    if (uploadTypes.length > 1) {\n      return {\n        input_type: InputType.MixUpload,\n        upload_options: uploadTypes,\n      };\n    }\n    return {\n      input_type: uploadTypes.at(0) as InputType,\n      upload_options: undefined,\n    };\n  },\n};\n\nexport const getSubmitFieldFromComponentTypeForm = (\n  values: ComponentTypeItem,\n): SubmitComponentTypeFields => {\n  const { type } = values;\n\n  const handler = componentTypeHandlers[type];\n\n  const result = handler && handler(values);\n\n  if (result) {\n    return result;\n  }\n\n  // If no handler is found, the default value is returned\n  return { input_type: InputType.TextInput };\n};\n\n// Is it the upload type?\nexport const isUploadType = (\n  type: InputType,\n): type is\n  | InputType.UploadImage\n  | InputType.UploadDoc\n  | InputType.UploadTable\n  | InputType.UploadAudio\n  | InputType.CODE\n  | InputType.ARCHIVE\n  | InputType.PPT\n  | InputType.VIDEO\n  | InputType.TXT\n  | InputType.MixUpload =>\n  [\n    InputType.UploadImage,\n    InputType.UploadDoc,\n    InputType.UploadTable,\n    InputType.UploadAudio,\n    InputType.CODE,\n    InputType.ARCHIVE,\n    InputType.PPT,\n    InputType.VIDEO,\n    InputType.TXT,\n    InputType.MixUpload,\n  ].includes(type);\n\n// Map input_type to the corresponding handler\nconst inputTypeHandlers = {\n  [InputType.TextInput]: () => ({ type: 'text' }),\n  [InputType.Select]: (options: string[] = []) => ({\n    type: 'select' as const,\n    options,\n  }),\n  upload: (uploadTypes: UploadItemType[] = []) => ({\n    type: 'upload' as const,\n    uploadTypes,\n  }),\n};\n\nexport const getComponentTypeFormBySubmitField = (\n  values: SubmitComponentTypeFields,\n): ComponentTypeItem => {\n  const { input_type, options, upload_options } = values;\n\n  if (!input_type) {\n    return getComponentTypeSelectFormInitValues();\n  }\n\n  if (isUploadType(input_type)) {\n    const handler = inputTypeHandlers.upload;\n    return handler(upload_options);\n  }\n\n  const handler = inputTypeHandlers[input_type];\n\n  if (handler) {\n    return handler(options);\n  }\n\n  return getComponentTypeSelectFormInitValues();\n};\n\n/**\n * 1. Modify the hide of the corresponding component in the components list: true\n */\nexport const modifyComponentWhenSwitchChange = ({\n  components,\n  record,\n  checked,\n}: {\n  components: ComponentsWithId[];\n  record: ComponentsWithId;\n  checked: boolean;\n}) =>\n  components.map(item => {\n    if (item.id === record.id) {\n      return {\n        ...item,\n        hide: !checked,\n      };\n    }\n    return item;\n  });\n\n// Components switching disabled\nexport const isSwitchDisabled = ({\n  components,\n  record,\n  toolInfo,\n}: {\n  components: ComponentsWithId[];\n  record: ComponentsWithId;\n  toolInfo: ToolInfo;\n}) => {\n  const { default_value } = record ?? {};\n  const isWithDefaultValue = !!default_value?.value;\n  const isRequired = (() => {\n    if (!toolInfo?.tool_name) {\n      return true;\n    }\n\n    /**\n     * Use tools & required parameters\n     */\n    return !!toolInfo?.tool_params_list?.find(t => t.name === record.parameter)\n      ?.required;\n  })();\n\n  // Components exceed the maximum number and are not allowed to be opened\n  const isMaxCount =\n    record.hide && components.filter(com => !com.hide).length >= MAX_COMPONENTS;\n\n  /** Required and no default value Closure is not allowed */\n  const isFinalRequired = isRequired && !isWithDefaultValue;\n\n  return isFinalRequired || isMaxCount;\n};\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Form } from '@coze-arch/bot-semi';\nimport { InputType } from '@coze-arch/bot-api/playground_api';\n\nimport { type UploadComponentTypeItem } from '../types';\nimport { ACCEPT_UPLOAD_TYPES } from '../../../../utils/file-const';\n\nimport styles from './index.module.less';\n\nexport interface UploadContentProps {\n  value: UploadComponentTypeItem['uploadTypes'] | undefined;\n  onChange?: (value: UploadComponentTypeItem['uploadTypes']) => void;\n}\n\nconst { Checkbox, CheckboxGroup } = Form;\n\nconst DefaultValue = [\n  InputType.UploadImage,\n  InputType.UploadAudio,\n  InputType.UploadDoc,\n  InputType.UploadTable,\n  InputType.CODE,\n  InputType.ARCHIVE,\n  InputType.PPT,\n  InputType.VIDEO,\n  InputType.TXT,\n];\n\nexport const UploadContent = (props: UploadContentProps) => {\n  const { value = DefaultValue, onChange } = props;\n  return (\n    <>\n      <div className=\"coz-fg-plus text-[16px] font-medium\">\n        {I18n.t('shortcut_modal_upload_component_supported_file_formats')}\n      </div>\n      <CheckboxGroup\n        field=\"values.uploadTypes\"\n        onChange={checkedValues => {\n          onChange?.(checkedValues);\n        }}\n        initValue={value}\n        className={cls('flex flex-wrap flex-row', styles['upload-content'])}\n        noLabel\n        noErrorMessage\n        rules={[\n          {\n            validator: (rules, newValue) => !!newValue?.length,\n            message: I18n.t(\n              'shortcut_modal_please_select_file_formats_for_upload_component_tip',\n            ),\n          },\n        ]}\n      >\n        {ACCEPT_UPLOAD_TYPES.map(({ type, label, icon }) => (\n          <div key={type} className=\"flex-1 basis-1/2\">\n            <Checkbox\n              className=\"flex-row-reverse justify-end\"\n              noLabel\n              defaultChecked={value?.includes(type)}\n              value={type}\n            >\n              <div className=\"flex gap-1\">\n                <img src={icon} alt={label} className=\"w-5 h-[25px] mr-2\" />\n                {label}\n              </div>\n            </Checkbox>\n          </div>\n        ))}\n      </CheckboxGroup>\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type Dispatch,\n  type SetStateAction,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  type FC,\n} from 'react';\n\nimport { SortableList } from '@coze-studio/components/sortable-list';\nimport { type TItemRender } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { type CommonFieldProps } from '@coze-arch/bot-semi/Form';\nimport {\n  IconButton,\n  Tooltip,\n  UIButton,\n  UIInput,\n  useFieldApi,\n  useFieldState,\n  withField,\n} from '@coze-arch/bot-semi';\nimport {\n  IconAdd,\n  IconShortcutDisorder,\n  IconShortcutTrash,\n} from '@coze-arch/bot-icons';\n\nimport { shortid } from '../../../../utils/uuid';\n\nexport interface OptionData {\n  value?: string;\n  id: string;\n}\n\nexport interface OptionListProps {\n  options: OptionData[];\n  onChange: Dispatch<SetStateAction<OptionData[]>>;\n}\n\nconst dndType = Symbol.for(\n  'chat-area-plugins-chat-shortcuts-component-options-dnd-list',\n);\n\nexport const OptionsList: FC<OptionListProps> = ({ options, onChange }) => {\n  const sortable = options.length > 1;\n  const itemRender = useMemo<TItemRender<OptionData>>(\n    () =>\n      ({ data, connect }) => {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        const dropRef = useRef<HTMLDivElement>(null);\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        const handleRef = useRef<HTMLDivElement>(null);\n\n        connect(dropRef, handleRef);\n        return (\n          <div ref={dropRef} className=\"flex items-center mb-6 last:mb-0\">\n            <UIInput\n              className=\"flex-1\"\n              value={data.value}\n              maxLength={20}\n              onChange={value => {\n                onChange(_options => {\n                  const index = _options.findIndex(item => item.id === data.id);\n                  _options.splice(index, 1, {\n                    value,\n                    id: data.id,\n                  });\n                  return [..._options];\n                });\n              }}\n            />\n            <div className=\"ml-2\" ref={handleRef}>\n              <IconButton\n                size=\"small\"\n                className={sortable ? 'cursor-grab' : ''}\n                icon={<IconShortcutDisorder />}\n                disabled={!sortable}\n                theme=\"borderless\"\n                type=\"tertiary\"\n              />\n            </div>\n            <div className=\"ml-2\">\n              <Tooltip content={I18n.t('Remove')}>\n                <IconButton\n                  size=\"small\"\n                  icon={<IconShortcutTrash />}\n                  type=\"tertiary\"\n                  theme=\"borderless\"\n                  disabled={options.length <= 1}\n                  onClick={() => {\n                    onChange(_options =>\n                      _options.filter(item => item.id !== data.id),\n                    );\n                  }}\n                />\n              </Tooltip>\n            </div>\n          </div>\n        );\n      },\n    [sortable],\n  );\n  return (\n    <SortableList\n      type={dndType}\n      list={options}\n      itemRender={itemRender}\n      onChange={onChange}\n      enabled={sortable}\n    />\n  );\n};\n\nconst MAX_OPTIONS = 20;\n\nexport interface SelectContentProps {\n  value?: string[];\n  onChange?: (newOptions: string[]) => void;\n  hasError?: boolean;\n}\nexport const SelectContent: FC<SelectContentProps> = ({\n  value: initialValue,\n  onChange,\n  hasError,\n}) => {\n  const [options, setOptions] = useState<OptionData[]>([]);\n\n  useEffect(() => {\n    setOptions(\n      (initialValue?.length ? initialValue : ['']).map<OptionData>(item => ({\n        value: item,\n        id: shortid(),\n      })),\n    );\n  }, []);\n\n  useEffect(() => {\n    const values = options\n      .map(option => option.value?.trim())\n      .filter(value => !!value);\n    onChange?.(values as string[]);\n  }, [options]);\n\n  return (\n    <div className=\"flex flex-col items-start\">\n      <div className=\"coz-fg-plus mb-[14px] font-medium\">\n        {I18n.t('shortcut_modal_selector_component_options')}\n      </div>\n      <div className=\"flex justify-between\">\n        <UIButton\n          size=\"small\"\n          type=\"tertiary\"\n          theme=\"borderless\"\n          disabled={options.length >= MAX_OPTIONS}\n          icon={<IconAdd />}\n          className=\"!coz-fg-hglt text-sm font-medium\"\n          onClick={() => {\n            setOptions([\n              ...options,\n              {\n                value: '',\n                id: shortid(),\n              },\n            ]);\n          }}\n        >\n          {I18n.t('shortcut_modal_selector_component_options')}\n        </UIButton>\n      </div>\n      <div className=\"max-h-40 my-6 overflow-y-auto\">\n        <OptionsList options={options} onChange={setOptions} />\n      </div>\n    </div>\n  );\n};\n\nconst SelectContentFieldInner = withField(SelectContent);\n\nexport const SelectContentField: FC<\n  CommonFieldProps & SelectContentProps\n> = props => {\n  const state = useFieldState(props.field);\n  const api = useFieldApi(props.field);\n  return (\n    <div onMouseEnter={() => api.setError('')}>\n      <SelectContentFieldInner\n        {...props}\n        pure\n        hasError={!!state.error?.length}\n        trigger=\"custom\"\n        rules={[\n          {\n            validator: (rules, value) => !!value?.length,\n            message: I18n.t(\n              'shortcut_modal_selector_component_no_options_error',\n            ),\n          },\n        ]}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentTypeItem } from '../types';\n\nexport const formatComponentTypeForm = (\n  values: ComponentTypeItem,\n): ComponentTypeItem => {\n  const { type } = values;\n  if (type === 'text') {\n    return { type };\n  }\n  if (type === 'select') {\n    return { type, options: values.options };\n  }\n  if (type === 'upload') {\n    return { type, uploadTypes: values.uploadTypes };\n  }\n  return values;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  forwardRef,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\nimport { Toast, UIInput, Popover, Form } from '@coze-arch/bot-semi';\nimport { IconChevronDown } from '@douyinfe/semi-icons';\n\nimport {\n  type ComponentTypeItem,\n  type ComponentTypeSelectContentRadioValueType,\n  type SelectComponentTypeItem,\n  type UploadComponentTypeItem,\n} from '../types';\nimport { UploadContent } from './upload-contnet';\nimport { SelectContentField } from './select-content';\nimport { formatComponentTypeForm } from './method';\n\nconst { RadioGroup, Radio } = Form;\n\nconst SelectTypeAndLableMap: Record<\n  ComponentTypeSelectContentRadioValueType,\n  string\n> = {\n  text: I18n.t('shortcut_component_type_text'),\n  select: I18n.t('shortcut_component_type_selector'),\n  upload: I18n.t('shortcut_modal_components_modal_upload_component'),\n};\n\nexport const ComponentTypeSelectRecordItem = (props: {\n  value: ComponentTypeItem;\n  onSubmit?: (value: ComponentTypeItem) => void;\n  disabled?: boolean;\n}) => {\n  const { value: defaultValue, onSubmit, disabled = false } = props;\n  const [submitValue, setSubmitValue] =\n    useState<ComponentTypeItem>(defaultValue);\n  const [componentType, setComponentType] =\n    useState<ComponentTypeItem>(defaultValue);\n  const [selectPopoverVisible, setSelectPopoverVisible] = useState(false);\n  const componentTypeSelectFormRef = useRef<{\n    formApi: ComponentTypeSelectFormMethods;\n  } | null>(null);\n  const onComponentTypeSelectFormSubmit = async () => {\n    if (await componentTypeSelectFormRef.current?.formApi.validate()) {\n      if (!componentType) {\n        return;\n      }\n      onSubmit?.(componentType);\n      setSubmitValue(componentType);\n      setSelectPopoverVisible(false);\n    }\n  };\n\n  useEffect(() => {\n    setSubmitValue(defaultValue);\n  }, [defaultValue]);\n\n  return (\n    <div className=\"flex items-center\">\n      <div className=\"w-full\">\n        <>\n          <Popover\n            trigger=\"custom\"\n            footer={null}\n            visible={selectPopoverVisible}\n            position=\"topRight\"\n            onClickOutSide={() => setSelectPopoverVisible(false)}\n            content={() => (\n              <div className=\"p-6 w-[288px]\">\n                <ComponentTypeSelectForm\n                  ref={componentTypeSelectFormRef}\n                  value={submitValue}\n                  onChange={setComponentType}\n                />\n                <div className=\"flex justify-end gap-2\">\n                  <Button\n                    color=\"highlight\"\n                    onClick={() => setSelectPopoverVisible(false)}\n                  >\n                    {I18n.t('cancel')}\n                  </Button>\n                  <Button onClick={onComponentTypeSelectFormSubmit}>\n                    {I18n.t('Confirm')}\n                  </Button>\n                </div>\n              </div>\n            )}\n          >\n            <UIInput\n              className={cls('w-full', disabled && '!pointer-events-auto')}\n              suffix={\n                <IconChevronDown\n                  onClick={() => setSelectPopoverVisible(!selectPopoverVisible)}\n                />\n              }\n              placeholder={I18n.t(\n                'shortcut_modal_selector_component_default_text',\n              )}\n              value={SelectTypeAndLableMap[submitValue?.type]}\n              onClick={() => setSelectPopoverVisible(!selectPopoverVisible)}\n              disabled={disabled}\n              readonly\n            />\n          </Popover>\n        </>\n      </div>\n    </div>\n  );\n};\n\nexport interface ComponentTypeSelectFormProps {\n  value: ComponentTypeItem;\n  onChange?: (values: ComponentTypeItem) => void;\n}\n\nexport interface ComponentTypeSelectFormMethods {\n  validate: () => Promise<boolean>;\n}\n\nexport const ComponentTypeSelectForm = forwardRef<\n  { formApi?: ComponentTypeSelectFormMethods },\n  ComponentTypeSelectFormProps\n>((props, ref) => {\n  const { value, onChange } = props;\n  const [selectOption, setSelectOption] =\n    useState<ComponentTypeSelectContentRadioValueType>(value.type);\n  const optionsMap = getComponentTypeOptionMap(value);\n  const formRef = useRef<Form>(null);\n\n  useImperativeHandle(ref, () => ({\n    formApi: {\n      validate: async () => {\n        try {\n          if (selectOption === 'select') {\n            return Boolean(\n              await formRef.current?.formApi.validate(['values.options']),\n            );\n          }\n          if (selectOption === 'upload') {\n            return Boolean(\n              await formRef.current?.formApi.validate(['values.uploadTypes']),\n            );\n          }\n          return true;\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        } catch (errors: any) {\n          if (selectOption === 'select') {\n            const message = errors?.values?.options;\n            message && Toast.error(message);\n          }\n          if (selectOption === 'upload') {\n            const message = errors?.values?.uploadTypes;\n            message && Toast.error(message);\n          }\n          return false;\n        }\n      },\n    },\n  }));\n\n  return (\n    <Form<{ values: ComponentTypeItem }>\n      autoComplete=\"off\"\n      ref={formRef}\n      initValues={{ values: value }}\n      className=\"flex flex-col gap-6\"\n      onValueChange={({ values }) => {\n        onChange?.(formatComponentTypeForm(values));\n      }}\n    >\n      <div className=\"coz-fg-plus text-[16px] font-medium\">\n        {I18n.t('shortcut_modal_components_modal_component_type')}\n      </div>\n      <RadioGroup\n        fieldStyle={{\n          padding: 0,\n        }}\n        className=\"flex flex-col !p-0 gap-3\"\n        defaultValue={selectOption}\n        field=\"values.type\"\n        noLabel\n        onChange={e => {\n          setSelectOption(e.target.value);\n        }}\n      >\n        {Object.entries(optionsMap).map(([key, { label }]) => (\n          <Radio value={key}>{label}</Radio>\n        ))}\n      </RadioGroup>\n      {Object.entries(optionsMap).map(([key, { render }]) => (\n        <div\n          key={key}\n          className={cls({\n            hidden: key !== selectOption,\n          })}\n        >\n          {render?.()}\n        </div>\n      ))}\n    </Form>\n  );\n});\n\nconst getComponentTypeOptionMap = (\n  initValue?: ComponentTypeItem,\n): {\n  [key in ComponentTypeSelectContentRadioValueType]: {\n    label: string;\n    render?: () => React.ReactNode;\n  };\n} => ({\n  text: {\n    label: I18n.t('shortcut_component_type_text'),\n  },\n  select: {\n    label: I18n.t('shortcut_component_type_selector'),\n    render: () => (\n      <SelectContentField\n        field=\"values.options\"\n        value={(initValue as SelectComponentTypeItem)?.options}\n      />\n    ),\n  },\n  upload: {\n    label: I18n.t('shortcut_modal_components_modal_upload_component'),\n    render: () => (\n      <UploadContent\n        value={(initValue as UploadComponentTypeItem)?.uploadTypes}\n      />\n    ),\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\nimport { Typography } from '@coze-arch/bot-semi';\nimport { IconInfo } from '@coze-arch/bot-icons';\nimport { type ToolInfo } from '@coze-arch/bot-api/playground_api';\n\nconst { Text } = Typography;\n\nexport interface ComponentParameterProps {\n  toolInfo: ToolInfo;\n  parameter: string;\n}\nexport const ComponentParameter: FC<ComponentParameterProps> = ({\n  toolInfo,\n  parameter,\n}) => {\n  const { tool_params_list = [] } = toolInfo;\n  const { name, type, required, desc } =\n    tool_params_list.find(item => item.name === parameter) || {};\n  return (\n    <div className=\"px-2 flex items-center justify-center coz-fg-secondary max-w-[86px]\">\n      <Text className=\"mr-1\" ellipsis>\n        {name}\n      </Text>\n      <Tooltip\n        className=\"max-w-[226px]\"\n        content={\n          <div className=\"flex flex-col justify-center\" key={name}>\n            <div className=\"flex items-center\">\n              <Text\n                ellipsis={{\n                  showTooltip: {\n                    opts: {\n                      content: name || '',\n                      position: 'top',\n                    },\n                  },\n                }}\n              >\n                <span className=\"text-sm font-medium mr-[9px]\">\n                  {name || '-'}\n                </span>\n              </Text>\n              <span className=\"rounded coz-mg-primary px-[6px] py-[1px] mr-[3px]\">\n                {type}\n              </span>\n              {Boolean(required) && (\n                <span className=\"rounded coz-mg-primary px-[6px] py-[1px]\">\n                  {I18n.t('workflow_add_parameter_required')}\n                </span>\n              )}\n            </div>\n            <span className=\"mt-[3px] coze-fg-primary text-sm\">\n              {desc || '-'}\n            </span>\n          </div>\n        }\n      >\n        <IconInfo />\n      </Tooltip>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UIInput } from '@coze-arch/bot-semi';\n\nexport const UploadField = () => <UIInput disabled />;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { type CommonFieldProps } from '@coze-arch/bot-semi/Form';\nimport { Select, withField } from '@coze-arch/bot-semi';\nimport { InputType } from '@coze-arch/bot-api/playground_api';\ntype InputWithInputTypeProps = {\n  value?: { type: InputType; value: string };\n  onSelect?: (value: { type: InputType; value: string }) => void;\n} & Omit<React.ComponentProps<typeof Select>, 'value' | 'onSelect'>;\n\nconst SelectWithInputType: FC<InputWithInputTypeProps> = props => {\n  const { value, onSelect, ...rest } = props;\n  return (\n    <Select\n      {...rest}\n      showClear={!!value?.value}\n      onClear={() => {\n        onSelect?.({ type: InputType.TextInput, value: '' });\n      }}\n      value={value?.value}\n      onSelect={selectValue => {\n        const newValue = {\n          type: value?.type || InputType.TextInput,\n          value: selectValue as string,\n        };\n        onSelect?.(newValue);\n        return newValue;\n      }}\n    />\n  );\n};\n\nexport const SelectWithInputTypeField: FC<\n  InputWithInputTypeProps & CommonFieldProps\n> = withField(SelectWithInputType, {\n  valueKey: 'value',\n  onKeyChangeFnName: 'onSelect',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport type { InputProps } from '@coze-arch/bot-semi/Input';\nimport { type CommonFieldProps } from '@coze-arch/bot-semi/Form';\nimport { UIInput, withField } from '@coze-arch/bot-semi';\nimport { InputType } from '@coze-arch/bot-api/playground_api';\n\ntype InputWithInputTypeProps = {\n  value?: { type: InputType; value: string };\n  onChange?: (value: { type: InputType; value: string }) => void;\n} & Omit<InputProps, 'value'>;\n\nconst MaxLength = 100;\n\nconst InputWithInputType: FC<InputWithInputTypeProps> = props => {\n  const { value, onChange, ...rest } = props;\n  return (\n    <UIInput\n      value={value?.value}\n      {...rest}\n      maxLength={MaxLength}\n      onChange={inputValue => {\n        const newValue = {\n          type: value?.type || InputType.TextInput,\n          value: inputValue,\n        };\n        onChange?.(newValue);\n        return newValue;\n      }}\n    />\n  );\n};\n\nexport const InputWithInputTypeField: FC<\n  InputWithInputTypeProps & CommonFieldProps\n> = withField(InputWithInputType, {\n  valueKey: 'value',\n  onKeyChangeFnName: 'onChange',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { InputType } from '@coze-arch/bot-api/playground_api';\n\nimport {\n  type SelectComponentTypeItem,\n  type TextComponentTypeItem,\n  type UploadComponentTypeItem,\n} from '../types';\nimport { type UploadItemType } from '../../../../utils/file-const';\nimport { UploadField } from './upload-field';\nimport { SelectWithInputTypeField } from './select-field';\nimport { InputWithInputTypeField } from './input-field';\n\nexport interface ComponentDefaultChangeValue {\n  type: InputType.TextInput | UploadItemType;\n  value: string;\n}\n\nexport interface ComponentDefaultValueProps {\n  field: string;\n  componentType:\n    | TextComponentTypeItem\n    | SelectComponentTypeItem\n    | UploadComponentTypeItem;\n  disabled?: boolean;\n}\n\nexport const ComponentDefaultValue: FC<ComponentDefaultValueProps> = props => {\n  const { componentType, field, disabled = false } = props;\n  const { type } = componentType;\n\n  if (type === 'text') {\n    return (\n      <InputWithInputTypeField\n        noLabel\n        value={{\n          type: InputType.TextInput,\n          value: '',\n        }}\n        field={field}\n        noErrorMessage\n        placeholder={I18n.t(\n          'shortcut_modal_use_tool_parameter_default_value_placeholder',\n        )}\n        disabled={disabled}\n      />\n    );\n  }\n  if (type === 'select') {\n    return (\n      <SelectWithInputTypeField\n        value={{\n          type: InputType.TextInput,\n          value: '',\n        }}\n        noLabel\n        style={{\n          width: '100%',\n        }}\n        field={field}\n        noErrorMessage\n        optionList={componentType.options.map(option => ({\n          label: option,\n          value: option,\n        }))}\n        disabled={disabled}\n      />\n    );\n  }\n  if (type === 'upload') {\n    // Grey out first, then release the upload default value.\n    return <UploadField />;\n    // return (\n    //   <UploadDefaultValue\n    //     noLabel\n    //     field={field}\n    //     acceptUploadItemTypes={componentType.uploadTypes}\n    //     uploadItemConfig={{\n    //       [InputType.UploadImage]: {\n    //         maxSize: IMAGE_MAX_SIZE,\n    //       },\n    //       [InputType.UploadDoc]: {\n    //         maxSize: FILE_MAX_SIZE,\n    //       },\n    //       [InputType.UploadTable]: {\n    //         maxSize: FILE_MAX_SIZE,\n    //       },\n    //       [InputType.UploadAudio]: {\n    //         maxSize: FILE_MAX_SIZE,\n    //       },\n    //     }}\n    //     onChange={res => {\n    //       const { default_value, default_value_type } = res\n    //         ? convertComponentDefaultValueToFormValues(res)\n    //         : {\n    //             default_value: '',\n    //             default_value_type: undefined,\n    //           };\n    //       return {\n    //         value: default_value,\n    //         type: default_value_type,\n    //       };\n    //     }}\n    //     uploadFile={({ file, onError, onProgress, onSuccess }) => {\n    //       getRegisteredPluginInstance?.({\n    //         file,\n    //         onProgress,\n    //         onError,\n    //         onSuccess,\n    //       });\n    //     }}\n    //   />\n    // );\n  }\n\n  return <></>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type RefObject,\n  useEffect,\n  useRef,\n  type FC,\n  type PropsWithChildren,\n} from 'react';\n\nimport cs from 'classnames';\nimport { useDnDSortableItem } from '@coze-studio/components/sortable-list-hooks';\nimport { type OnMove } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { Switch } from '@coze-arch/coze-design';\nimport { type TooltipProps } from '@coze-arch/bot-semi/Tooltip';\nimport {\n  type ColumnProps,\n  type TableComponents,\n} from '@coze-arch/bot-semi/Table';\nimport { Form, IconButton, Tooltip } from '@coze-arch/bot-semi';\nimport { IconShortcutTrash, IconSvgShortcutDrag } from '@coze-arch/bot-icons';\nimport {\n  shortcut_command,\n  type ToolInfo,\n} from '@coze-arch/bot-api/playground_api';\n\nimport { type UploadItemType } from '../../../utils/file-const';\nimport { type ComponentsWithId } from './types';\nimport {\n  getComponentTypeFormBySubmitField,\n  getSubmitFieldFromComponentTypeForm,\n  isSwitchDisabled,\n  modifyComponentWhenSwitchChange,\n} from './method';\nimport { ComponentTypeSelectRecordItem } from './component-type-select';\nimport { ComponentParameter } from './component-parameter';\nimport { ComponentDefaultValue } from './component-default-value';\n\ntype ColumnPropType = ColumnProps<ComponentsWithId>;\n\nconst TooltipWithDisabled: FC<TooltipProps & { disabled?: boolean }> = ({\n  disabled,\n  children,\n  ...props\n}) => (disabled ? <>{children}</> : <Tooltip {...props}>{children}</Tooltip>);\n\nconst getOperationColumns = ({\n  components,\n  onChange,\n  toolType,\n  disabled,\n  toolInfo,\n}: GetColumnsParams): ColumnPropType => {\n  const deleteable = !disabled;\n  const showDelete = toolType === undefined;\n\n  return {\n    key: 'operation',\n    title: null,\n    width: showDelete ? '80px' : '40px',\n    render: (_, record) => (\n      <div className=\"flex items-center pl-[12px]\">\n        <Switch\n          checked={!record.hide}\n          disabled={isSwitchDisabled({\n            components,\n            record,\n            toolInfo,\n          })}\n          size=\"mini\"\n          onChange={checked =>\n            onChange?.(\n              modifyComponentWhenSwitchChange({\n                components,\n                record,\n                checked,\n              }),\n            )\n          }\n        />\n        {showDelete ? (\n          <div className=\"px-2\">\n            <TooltipWithDisabled\n              content={I18n.t('Remove')}\n              disabled={!deleteable}\n            >\n              <IconButton\n                size=\"small\"\n                theme=\"borderless\"\n                type=\"tertiary\"\n                disabled={!deleteable}\n                icon={<IconShortcutTrash />}\n                onClick={() => {\n                  onChange?.(components.filter(item => item.id !== record.id));\n                }}\n              />\n            </TooltipWithDisabled>\n          </div>\n        ) : null}\n      </div>\n    ),\n  };\n};\n\nconst getColumnsMap = (params: GetColumnsParams) => {\n  const { components, disabled } = params;\n  const sortable = components.length > 1 && !disabled;\n\n  return {\n    name: {\n      key: 'name',\n      title: (\n        <Form.Label\n          className=\"leading-5 p-0 m-0\"\n          text={I18n.t('shortcut_modal_component_name')}\n          required\n        />\n      ),\n      width: 1,\n      render: (_, record, index) => (\n        <div className=\"flex items-center\">\n          <div\n            id={handleId}\n            className={cs(\n              'px-[2px]',\n              sortable ? 'cursor-grab' : 'cursor-not-allowed',\n            )}\n          >\n            <IconSvgShortcutDrag />\n          </div>\n          <Form.Input\n            noLabel\n            maxLength={20}\n            field={`values.[${index}].name`}\n            noErrorMessage\n            placeholder={I18n.t('shortcut_modal_component_name')}\n            rules={[\n              {\n                required: true,\n              },\n            ]}\n            disabled={disabled || record.hide}\n          />\n        </div>\n      ),\n    },\n    description: {\n      key: 'description',\n      title: (\n        <Form.Label\n          className=\"leading-5 p-0 m-0\"\n          text={I18n.t('Description')}\n        />\n      ),\n      width: '190px',\n      render: (_, record, index) => (\n        <div className=\"pl-[2px]\">\n          <Form.Input\n            noLabel\n            maxLength={100}\n            field={`values.[${index}].description`}\n            noErrorMessage\n            placeholder={I18n.t('Description')}\n            disabled={disabled || record.hide}\n          />\n        </div>\n      ),\n    },\n    inputType: {\n      key: 'input_type',\n      title: (\n        <Form.Label\n          className=\"leading-5 p-0 m-0\"\n          text={I18n.t('shortcut_modal_component_type')}\n          required\n        />\n      ),\n      render: (_, record, index) => (\n        <div className=\"pl-[2px]\">\n          <ComponentTypeSelectRecordItem\n            value={getComponentTypeFormBySubmitField({\n              input_type: record.input_type,\n              options: record.options,\n              upload_options: record.upload_options as UploadItemType[],\n            })}\n            disabled={disabled || record.hide}\n            onSubmit={value => {\n              const { input_type, options, upload_options } =\n                getSubmitFieldFromComponentTypeForm(value);\n              params?.onChange?.(\n                params.components.map((item, i) =>\n                  i === index\n                    ? {\n                        ...item,\n                        input_type,\n                        options,\n                        default_value: {\n                          value: '',\n                        },\n                        upload_options,\n                      }\n                    : item,\n                ),\n              );\n            }}\n          />\n        </div>\n      ),\n    },\n    defaultValue: {\n      key: 'default_value',\n      title: (\n        <Form.Label\n          className=\"leading-5 p-0 m-0\"\n          text={I18n.t('shortcut_modal_use_tool_parameter_default_value')}\n        />\n      ),\n      render: (_, record, index) => (\n        <div className=\"pl-[2px] max-w-[136px]\">\n          <ComponentDefaultValue\n            componentType={getComponentTypeFormBySubmitField({\n              input_type: record.input_type,\n              options: record.options,\n              upload_options: record.upload_options as UploadItemType[],\n            })}\n            field={`values.[${index}].default_value`}\n            disabled={disabled || record.hide}\n          />\n        </div>\n      ),\n    },\n    parameter: {\n      key: 'parameter',\n      title: (\n        <Form.Label\n          className=\"leading-5 p-0 m-0\"\n          text={I18n.t('shortcut_modal_component_plugin_wf_parameter')}\n        />\n      ),\n      dataIndex: 'parameter',\n      render: text => (\n        <ComponentParameter toolInfo={params.toolInfo} parameter={text} />\n      ),\n    },\n    operations: getOperationColumns(params),\n  } satisfies Record<string, ColumnPropType>;\n};\n\ninterface GetColumnsParams {\n  components: ComponentsWithId[];\n  onChange?: (values: ComponentsWithId[]) => void;\n  toolType?: shortcut_command.ToolType;\n  disabled: boolean;\n  toolInfo: ToolInfo;\n}\n\nconst assignWidth = (base: ColumnPropType, width: string | number) =>\n  Object.assign({}, base, { width });\n\nexport const getColumns = (params: GetColumnsParams): ColumnPropType[] => {\n  const { toolType } = params;\n  const columnsMap = getColumnsMap(params);\n  if (\n    toolType === shortcut_command.ToolType.ToolTypePlugin ||\n    toolType === shortcut_command.ToolType.ToolTypeWorkFlow\n  ) {\n    return [\n      assignWidth(columnsMap.name, '103px'),\n      assignWidth(columnsMap.description, '103px'),\n      assignWidth(columnsMap.inputType, '103px'),\n      assignWidth(columnsMap.defaultValue, '126px'),\n      assignWidth(columnsMap.parameter, '86px'),\n      columnsMap.operations,\n    ];\n  }\n  return [\n    assignWidth(columnsMap.name, '125px'),\n    assignWidth(columnsMap.description, '125px'),\n    assignWidth(columnsMap.inputType, '125px'),\n    assignWidth(columnsMap.defaultValue, '136px'),\n    columnsMap.operations,\n  ];\n};\n\nconst type = Symbol.for(\n  'chat-area-plugins-chat-shortcuts-components-table-item',\n);\nconst handleId = 'chat-area-plugins-chat-shortcuts-components-drag-handle';\nconst DraggableBodyRow: FC<\n  PropsWithChildren<{\n    id: string;\n    sortable: boolean;\n    onMove: OnMove<string>;\n  }>\n> = ({ id, onMove, children, sortable }) => {\n  // Because the name may be empty, take shortid as a bottom line here.\n  const dropRef = useRef<HTMLElement>(null);\n  const { connect } = useDnDSortableItem<string>({\n    type,\n    id,\n    onMove,\n    enabled: sortable,\n  });\n  useEffect(() => {\n    // In order to avoid complicated cross-component value transfer, here is a little direct manipulation of the DOM, I'm very sorry.\n    const handleRef = {\n      current: (dropRef.current?.querySelector(`#${handleId}`) ??\n        null) as HTMLElement | null,\n    };\n    connect(dropRef, handleRef);\n  }, []);\n  return <tr ref={dropRef as RefObject<HTMLTableRowElement>}>{children}</tr>;\n};\n\nexport const tableComponents = {\n  body: {\n    // The type definition exported by semi-ui is very irresponsible\n    row: DraggableBodyRow,\n  },\n} as unknown as TableComponents;\n","\n      import API from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport styles from './index.module.less';\n\nexport const tableEmpty = (useTool: boolean, selected: boolean) => (\n  <div className={styles.empty}>\n    {useTool\n      ? selected\n        ? I18n.t('shortcut_modal_skill_has_no_param_tip')\n        : I18n.t('shortcut_modal_skill_select_button')\n      : I18n.t('shortcut_modal_form_to_be_filled_up_tip')}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { forwardRef, useImperativeHandle, useRef, useState } from 'react';\n\nimport { DndProvider } from '@coze-studio/components/dnd-provider';\nimport { type OnMove } from '@coze-studio/components';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FormApi } from '@coze-arch/bot-semi/Form';\nimport { Form, Table, Toast, Tooltip } from '@coze-arch/bot-semi';\nimport { IconAdd } from '@coze-arch/bot-icons';\nimport {\n  InputType,\n  ToolType,\n  type ToolInfo,\n  type shortcut_command,\n} from '@coze-arch/bot-api/playground_api';\n\nimport { compTip } from '../components/tip';\nimport FieldLabel from '../components/field-label';\nimport ActionButton from '../components/action-button';\nimport { shortid } from '../../../utils/uuid';\nimport { type ComponentsWithId } from './types';\nimport { getColumns, tableComponents } from './table-components';\nimport {\n  attachIdToComponents,\n  checkDuplicateName,\n  formatSubmitValues,\n} from './method';\nimport { tableEmpty } from './empty';\n\nimport styles from './index.module.less';\n\nexport interface ComponentsTableProps {\n  components: shortcut_command.Components[]; // Variable list\n  onChange?: (components: shortcut_command.Components[]) => void;\n  toolType?: shortcut_command.ToolType;\n  toolInfo: ToolInfo;\n  disabled: boolean;\n}\n\nexport interface ComponentsTableActions {\n  validate: () => Promise<shortcut_command.Components[]>;\n  setValues: (values: shortcut_command.Components[]) => void;\n}\n\nconst MAX_COMPONENTS = 10;\n\n// Semi-controlled component, using initial value + exposed API to facilitate internal maintenance of local ID for dragging and dropping sorting identification data\nexport const ComponentsTable = forwardRef<\n  { formApi?: ComponentsTableActions },\n  ComponentsTableProps\n  // eslint-disable-next-line @coze-arch/max-line-per-function\n>(({ components, onChange, toolType, disabled, toolInfo }, ref) => {\n  const [values, setValues] = useState<ComponentsWithId[]>(\n    attachIdToComponents(components),\n  );\n  const formRef = useRef<FormApi<{ values: ComponentsWithId[] }>>();\n\n  const onChangeInner = (newValues: ComponentsWithId[]) => {\n    setValues(newValues);\n    formRef.current?.setValues({ values: newValues }, { isOverride: true });\n    onChange?.(formatSubmitValues(newValues));\n  };\n\n  useImperativeHandle(ref, () => ({\n    formApi: formRef.current\n      ? {\n          validate: async (...props) => {\n            // It is handled uniformly here to avoid multiple identical fields triggering multiple toasts.\n            if (\n              values.some(\n                component =>\n                  component.input_type === InputType.Select &&\n                  !component.options?.length,\n              )\n            ) {\n              Toast.error(\n                I18n.t('shortcut_modal_selector_component_no_options_error'),\n              );\n              throw Error('shortcut_modal_selector_component_no_options_error');\n            }\n            if (\n              formRef.current &&\n              checkDuplicateName(values, formRef.current)\n            ) {\n              throw Error('duplicated names');\n            }\n\n            const submitValues = await formRef.current?.validate(...props);\n            return formatSubmitValues(submitValues?.values ?? []);\n          },\n          setValues: newComponents => {\n            const newValues = attachIdToComponents(newComponents);\n            setValues(newValues);\n            formRef.current?.setValues(\n              { values: newValues },\n              { isOverride: true },\n            );\n            formRef.current?.setTouched('values', false);\n            formRef.current?.setError('values', '');\n          },\n        }\n      : undefined,\n  }));\n\n  const onMove: OnMove<string> = (sourceId, targetId, isBefore) => {\n    const newValues = [...values];\n    const sourceIndex = newValues.findIndex(source => source.id === sourceId);\n    const errors = formRef.current?.getError('values') || [];\n    const sourceError = errors.splice(sourceIndex, 1)[0];\n    const sourceItem = newValues.splice(sourceIndex, 1)[0];\n    const targetIndex =\n      newValues.findIndex(target => target.id === targetId) +\n      (isBefore ? 0 : 1);\n    sourceItem && newValues.splice(targetIndex, 0, sourceItem);\n    errors.splice(targetIndex, 0, sourceError);\n    // Do not trigger onChange if the index is the same before and after to avoid frequent rerender\n    if (sourceIndex !== targetIndex) {\n      onChangeInner(newValues);\n      // Only after dragging sort, you need to manually update the form value\n      formRef.current?.setValues(\n        {\n          values: newValues,\n        },\n        { isOverride: true },\n      );\n      formRef.current?.setError('values', errors);\n    }\n  };\n\n  const showAdd =\n    toolType === undefined ||\n    ![ToolType.ToolTypeWorkFlow, ToolType.ToolTypePlugin].includes(toolType);\n\n  const selected = !!toolInfo?.tool_name;\n  const oversize = values.length >= MAX_COMPONENTS;\n\n  const addBtn = (\n    <ActionButton\n      icon={<IconAdd />}\n      disabled={oversize || disabled}\n      onClick={() => {\n        onChangeInner([\n          ...values,\n          {\n            id: shortid(),\n            input_type: InputType.TextInput,\n          },\n        ]);\n      }}\n    >\n      {I18n.t('add')}\n    </ActionButton>\n  );\n\n  const tipBtn = oversize ? (\n    <Tooltip\n      content={I18n.t('shortcut_modal_max_component_tip', {\n        maxCount: MAX_COMPONENTS,\n      })}\n    >\n      {addBtn}\n    </Tooltip>\n  ) : (\n    addBtn\n  );\n\n  return (\n    <div className=\"pb-6\">\n      <div className=\"flex items-center justify-between pb-1.5\">\n        <FieldLabel tip={compTip()}>\n          {I18n.t('shortcut_modal_components')}\n        </FieldLabel>\n        {showAdd ? tipBtn : null}\n      </div>\n      <DndProvider>\n        <Form<{ values: ComponentsWithId[] }>\n          initValues={{ values }}\n          // Manually trigger validation to avoid being affected by addition, deletion and drag-and-drop sorting\n          trigger=\"custom\"\n          autoComplete=\"off\"\n          disabled={disabled}\n          getFormApi={api => (formRef.current = api)}\n          onValueChange={(newValues, changedValues) => {\n            const changedKeys = Object.keys(changedValues);\n            if (\n              changedKeys.length === 1 &&\n              // Trigger onChange only in form modification scenarios to avoid infinite loops\n              changedKeys[0]?.startsWith('values.[')\n            ) {\n              onChangeInner([...newValues.values]);\n              // Validation is only triggered for specific fields in the edit form scenario, and verification is not triggered in other scenarios (addition and deletion sorting of entire lines)\n              setTimeout(() => {\n                if (formRef.current) {\n                  checkDuplicateName(newValues.values, formRef.current);\n                }\n                // @ts-expect-error -- The type definition of  semi cannot support multi-segment paths\n                formRef.current?.validate([changedKeys[0]]);\n              });\n            }\n          }}\n        >\n          <div className={styles.table}>\n            <Table<ComponentsWithId>\n              dataSource={values}\n              size=\"small\"\n              columns={getColumns({\n                components: values,\n                onChange: onChangeInner,\n                toolInfo,\n                toolType,\n                disabled,\n              })}\n              components={tableComponents}\n              pagination={false}\n              onRow={item => ({\n                id: item?.id ?? '',\n                sortable: (values?.length ?? 0) > 1 && !disabled,\n                onMove,\n              })}\n              empty={tableEmpty(!showAdd, selected)}\n            />\n          </div>\n        </Form>\n      </DndProvider>\n    </div>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type ReactNode, type PropsWithChildren } from 'react';\n\nimport { UIIconButton } from '@coze-arch/bot-semi';\n\nimport styles from './index.module.less';\n\nconst ActionButton: FC<\n  PropsWithChildren<{\n    icon: ReactNode;\n    onClick?: () => void;\n    disabled?: boolean;\n  }>\n> = ({ onClick, icon, children, disabled }) => (\n  <UIIconButton\n    icon={icon}\n    wrapperClass={styles.btn}\n    onClick={onClick}\n    disabled={disabled}\n  >\n    {children}\n  </UIIconButton>\n);\n\nexport default ActionButton;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, type PropsWithChildren, type ReactNode } from 'react';\n\nimport cs from 'classnames';\nimport { Tooltip, type TooltipProps } from '@coze-arch/coze-design';\nimport { Form } from '@coze-arch/bot-semi';\nimport { IconInfo } from '@coze-arch/bot-icons';\n\nexport const FieldLabel: FC<\n  PropsWithChildren<{\n    className?: string;\n    tooltip?: TooltipProps;\n    tip?: ReactNode;\n    required?: boolean;\n  }>\n> = ({ children, className, tooltip, tip, required = false }) => (\n  <div className=\"flex items-center mb-[6px]\">\n    <Form.Label\n      text={children}\n      className=\"!coz-fg-primary !text-[14px] !leading-[20px] !m-0\"\n      required={required}\n    />\n    {!!tip && (\n      <Tooltip content={tip} {...tooltip}>\n        <IconInfo className={cs('coz-fg-secondary ml-[-12px]', className)} />\n      </Tooltip>\n    )}\n  </div>\n);\n\nexport default FieldLabel;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nconst style = {\n  color: 'var(--semi-color-primary-hover)',\n};\n\nconst getVar = (text: string) => (\n  <span style={style}>\n    {'{{'}\n    {text}\n    {'}}'}\n  </span>\n);\n\nconst var1 = getVar(\n  I18n.t('shortcut_modal_query_message_hover_tip_component_mode_var1'),\n);\nconst var2 = getVar(\n  I18n.t('shortcut_modal_query_message_hover_tip_component_mode_var2'),\n);\n\nexport const queryTip = () => (\n  <div className=\"p[16px] leading-[16px] text-[12px] font-normal coz-fg-secondary\">\n    <h2 className=\"m-0 mb-[12px] text-[14px] font-medium leading-[20px] coz-fg-plus\">\n      {I18n.t('shortcut_modal_query_message_hover_tip_title')}\n    </h2>\n    <ul className=\"pl-[12px]\">\n      <li>\n        {I18n.t('shortcut_modal_query_message_hover_tip_send_query_mode')}\n      </li>\n      <li>\n        {I18n.t('shortcut_modal_query_message_hover_tip_component_mode', {\n          var1,\n          var2,\n        })}\n      </li>\n    </ul>\n    <p>\n      <span className=\"coz-fg-hglt-red w-[12px] inline-block\">*</span>\n      {I18n.t(\n        'shortcut_modal_query_message_hover_tip_how_to_insert_components',\n      )}\n    </p>\n  </div>\n);\n\nexport const compTip = () =>\n  I18n.t('shortcut_modal_components_hover_tip', {\n    var1,\n    var2,\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type Components,\n  InputType,\n  SendType,\n  type ToolParams,\n} from '@coze-arch/bot-api/playground_api';\nimport { type ShortCutCommand } from '@coze-agent-ide/tool-config';\n\nimport type { ShortcutEditFormValues } from '../types';\nimport { initToolEnabledByToolTYpe } from '../../utils/tool-params';\nimport { getDSLFromComponents } from '../../utils/dsl-template';\n\nexport const getSubmitValue = (\n  values: ShortcutEditFormValues,\n): ShortCutCommand => {\n  const newValues = { ...values };\n\n  /**\n   * Execute first, depending on whether components_list is included send_type\n   */\n  mutableSendType(newValues);\n\n  const { send_type, use_tool = false } = newValues;\n\n  mutableFormatCommandName(newValues);\n  mutableSetCardSchemaForForm(newValues);\n\n  if (send_type === SendType.SendTypeQuery && !use_tool) {\n    mutableInitQueryFormValues(newValues);\n  } else {\n    mutableModifyToolParamsWhenComponentChange(newValues);\n  }\n\n  if (!use_tool) {\n    mutableInitNotUseToolFormValues(newValues);\n  }\n  // TODO: hzf killing is unreasonable\n  return newValues as ShortCutCommand;\n};\n\nconst mutableSendType = (value: ShortcutEditFormValues) => {\n  if (value?.components_list?.length) {\n    value.send_type = SendType.SendTypePanel;\n  } else {\n    value.send_type = SendType.SendTypeQuery;\n  }\n};\n\n/**\n * For compatibility, you need to modify the toolParams synchronously when modifying the default_value and hide of the components_list\n * 1.components_list.hide => !toolParams.refer_component\n * 2.components_list.default_value => refer_componentfalse && toolParams.default_value\n */\nconst mutableModifyToolParamsWhenComponentChange = (\n  value: ShortcutEditFormValues,\n): void => {\n  const { components_list, tool_info: { tool_params_list } = {} } = value;\n  if (!components_list || !tool_params_list) {\n    return;\n  }\n  components_list.forEach(com => {\n    const { default_value, hide } = com;\n    const targetToolParams = findToolParamsByComponent(tool_params_list, com);\n    if (!targetToolParams) {\n      return;\n    }\n    targetToolParams.refer_component = !hide;\n    targetToolParams.default_value = hide ? default_value?.value : '';\n  });\n};\n\nexport const findToolParamsByComponent = (\n  params: Array<ToolParams>,\n  component: Components,\n) => params?.find(param => param.name === component.parameter);\n\n// Initialize form parameters for query types\nconst mutableInitQueryFormValues = (values: ShortcutEditFormValues): void => {\n  values.tool_type = undefined;\n  values.plugin_id = '';\n  values.work_flow_id = '';\n  values.plugin_api_name = '';\n  values.plugin_from = undefined;\n  values.tool_info = {\n    tool_name: '',\n    tool_params_list: [],\n  };\n  values.components_list = [];\n  values.card_schema = '';\n};\n\n// Initialize form parameters when using plug-in components\nconst mutableInitNotUseToolFormValues = (\n  values: ShortcutEditFormValues,\n): void => {\n  values.tool_type = undefined;\n  values.plugin_id = '';\n  values.work_flow_id = '';\n  values.plugin_api_name = '';\n  values.plugin_from = undefined;\n  values.tool_info = {\n    tool_name: '',\n    tool_params_list: [],\n  };\n  values.components_list?.forEach(com => {\n    com.parameter = '';\n  });\n};\n\nconst mutableSetCardSchemaForForm = (values: ShortcutEditFormValues): void => {\n  const { components_list } = values;\n  const templateDsl = components_list\n    ? getDSLFromComponents(components_list)\n    : '';\n  values.card_schema = JSON.stringify(templateDsl);\n};\n\nconst mutableFormatCommandName = (values: ShortcutEditFormValues): void => {\n  const { shortcut_command } = values;\n  if (shortcut_command) {\n    values.shortcut_command = `/${shortcut_command.trim()}`;\n  }\n};\n\n/**\n * Filter toolParams exists, variables that do not exist in components\n * And refer_component = false,\n * Converted to components_list\n * For forward compatibility, the default parameters of tool in the old directive are placed in toolParams\n */\nexport const initComponentsListFromToolParams = (\n  components: Components[],\n  toolParams: Array<ToolParams>,\n): Array<Components> => {\n  const newComponents = components.slice();\n  toolParams.forEach(param => {\n    const { name, default_value, desc, refer_component } = param;\n    if (!components.find(com => com.parameter === name)) {\n      newComponents.push({\n        name,\n        description: desc,\n        parameter: name,\n        input_type: InputType.TextInput,\n        hide: !refer_component,\n        default_value: {\n          type: InputType.TextInput,\n          value: default_value,\n        },\n      });\n    }\n  });\n  return newComponents;\n};\n\n/**\n * Compatible with outdated instructions\n * If the InputType is UploadImage, UploadDoc, UploadTable, UploadAudio,\n * Determine if upload_options is empty\n * Is empty, plus the corresponding upload_options\n */\nexport const initComponentsUploadOptions = (\n  components: Components[],\n): Components[] =>\n  components.map(com => {\n    const { input_type, upload_options } = com;\n    if (\n      !upload_options?.length &&\n      input_type &&\n      [\n        InputType.UploadImage,\n        InputType.UploadDoc,\n        InputType.UploadTable,\n        InputType.UploadAudio,\n      ].includes(input_type)\n    ) {\n      return {\n        ...com,\n        upload_options: [input_type],\n      };\n    }\n    return com;\n  });\n\nexport const getInitialValues = (\n  initShortcut?: ShortCutCommand,\n): ShortcutEditFormValues => {\n  // initialization\n  if (!initShortcut) {\n    return {\n      send_type: SendType.SendTypeQuery,\n      use_tool: false,\n    };\n  }\n  // echo\n  const {\n    shortcut_command,\n    tool_type,\n    components_list,\n    tool_info: { tool_params_list = [] } = {},\n  } = initShortcut;\n  const modifyComponentsListByToolParams = initComponentsListFromToolParams(\n    components_list ?? [],\n    tool_params_list,\n  );\n  const modifyComponentsListByUploadOptions = initComponentsUploadOptions(\n    modifyComponentsListByToolParams,\n  );\n\n  return {\n    ...initShortcut,\n    shortcut_command: shortcut_command?.replace(/^\\//, ''),\n    use_tool: initToolEnabledByToolTYpe(tool_type),\n    components_list: modifyComponentsListByUploadOptions,\n  };\n};\n\nexport const enableSendTypePanelHideTemplate = (shortcut?: ShortCutCommand) => {\n  if (shortcut?.send_type !== SendType.SendTypePanel) {\n    return false;\n  }\n\n  const { tool_params_list, tool_name } = shortcut?.tool_info ?? {};\n\n  if (tool_name) {\n    return (\n      !!tool_params_list?.length &&\n      tool_params_list.every(c => !c.refer_component)\n    );\n  }\n\n  return (\n    !!shortcut?.components_list?.length &&\n    shortcut.components_list.every(c => c.hide)\n  );\n};\n\nexport const getFormValueFromShortcut = (shortcut?: ShortCutCommand) => {\n  const { tool_params_list, tool_name } = shortcut?.tool_info ?? {};\n\n  if (tool_name) {\n    if (!tool_params_list?.length) {\n      return {};\n    }\n\n    return tool_params_list.reduce((prev: Record<string, string>, curr) => {\n      const key = curr.name;\n      const defaultValue = curr?.default_value;\n\n      if (!key || !defaultValue) {\n        return prev;\n      }\n\n      prev[key] = defaultValue;\n\n      return prev;\n    }, {});\n  }\n\n  if (!shortcut?.components_list?.length) {\n    return {};\n  }\n\n  return shortcut.components_list.reduce(\n    (prev: Record<string, string>, curr) => {\n      const key = curr.name;\n      const { value } = curr?.default_value ?? {};\n      if (!key || !value) {\n        return prev;\n      }\n\n      prev[key] = value;\n\n      return prev;\n    },\n    {},\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum ElementPropsType {\n  SLOT = 'slot',\n  WORKSPACE_SLOT = 'workspaceSlot',\n  EXPRESSION = 'expression',\n  ACTION = 'action',\n}\n\nexport interface Expression {\n  type?: string;\n  value?: string;\n}\n\nexport interface ElementProps extends Expression {\n  type?: ElementPropsType;\n  children?: string[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- linter-disable-autofix\n  config?: Record<string, any>;\n}\n\nexport enum ElementDirectiveType {\n  EXPRESSION = 'expression',\n}\n\nexport interface ElementDirective extends Expression {\n  type?: ElementDirectiveType;\n  value?: string;\n}\n\nexport interface Element {\n  id: string;\n  name: string;\n  type: string;\n  props?: Record<string, ElementProps | ElementProps[]>;\n  events?: Record<string, string>;\n  directives?: {\n    condition?: unknown;\n    repeat?: unknown;\n  };\n  children?: string[];\n}\n\nexport interface Data {\n  id: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- linter-disable-autofix\n  defaultValue: Record<string, any> | any[];\n}\n\nexport type ActionsData = ElementDirective;\n\nexport interface Actions {\n  id: string;\n  type: 'submit' | 'updateVar';\n  data?: ActionsData;\n  target?: string;\n}\n\nexport interface DSL {\n  elements: {\n    [key: string]: Element;\n  };\n  rootID: string;\n  variables?: Record<string, Data>;\n  actions?: Record<string, Actions>;\n  status?: {\n    disabled?: boolean;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { shortcut_command } from '@coze-arch/bot-api/playground_api';\n\nimport { shortid } from '../uuid';\nimport { getAcceptByUploadItemTypes } from '../file-const';\nimport { type DSL, ElementDirectiveType, ElementPropsType } from '../../types';\n\n// @Fixme DSL type definition needs to be updated\nexport const getDSLTemplate = (): DSL => ({\n  elements: {\n    root: {\n      id: 'root',\n      name: 'Root',\n      type: '@flowpd/cici-components/PageContainer',\n      children: ['form'],\n      directives: {},\n    },\n    form: {\n      id: 'form',\n      name: 'FlowpdCiciComponentsForm', // TODO component name & type can preferably be agreed in advance\n      type: '@flowpd/cici-components/Form',\n      props: {\n        value: {\n          type: ElementPropsType.EXPRESSION,\n          value: '{{formValue}}',\n        },\n        onChange: {\n          type: ElementPropsType.ACTION,\n          value: '{{onChange}}',\n        },\n        ruls: {\n          // some rules value\n        },\n      },\n      children: ['submitButton'], // Generated from variables + layout\n    },\n    // Generate form elements from getFormElementsFromcomponent\n    // ...inputElements,\n    // Generate form element layout with getElementsLayout\n    // ...inputLayoutElements,\n    submitButton: {\n      id: 'submitButton',\n      name: 'FlowpdCiciComponentsButton', // TODO component name & type can preferably be agreed in advance\n      type: '@flowpd/cici-components/Button',\n      props: {\n        onClick: {\n          type: ElementPropsType.ACTION,\n          value: '{{onSubmit}}',\n        },\n      },\n    },\n  },\n  rootID: 'root',\n  variables: {\n    formValue: {\n      id: 'formValue',\n      defaultValue: {}, // No default is required\n    },\n  },\n  actions: {\n    onSubmit: {\n      id: 'onSubmit',\n      type: 'submit',\n      data: {\n        type: ElementDirectiveType.EXPRESSION,\n        value: '{{formValue}}',\n      },\n    },\n    onChange: {\n      id: 'onChange',\n      type: 'updateVar',\n      target: 'formValue',\n    },\n  },\n});\n\ntype DSLElement = DSL['elements'][string];\nexport type GetFormItemTemplate = (\n  component: shortcut_command.Components,\n) => DSLElement;\n\nexport const getInputElementDSL: GetFormItemTemplate = component => ({\n  id: component.name ?? shortid(),\n  name: 'FlowpdCiciComponentsInput', // The TODO component name should preferably be agreed in advance\n  type: '@flowpd/cici-components/Input',\n  props: {\n    name: component.name,\n    description: component.description,\n    defaultValue: component.default_value,\n    rules: [],\n    noErrorMessage: true,\n    // The @FIXME DSL parsing logic actually supports passing arbitrary values as props, but there is no compatible syntax in the type definition\n  } as unknown as DSLElement['props'],\n});\n\nexport const getSelectElementDSL: GetFormItemTemplate = component => ({\n  id: component.name ?? shortid(),\n  name: 'FlowpdCiciComponentsSelect', // The TODO component name should preferably be agreed in advance\n  type: '@flowpd/cici-components/Select',\n  props: {\n    name: component.name,\n    description: component.description,\n    defaultValue: component.default_value,\n    optionList: component.options?.map(value => ({\n      label: value,\n      value,\n    })),\n    rules: [\n      {\n        required: true,\n      },\n    ],\n    noErrorMessage: true,\n    // The @FIXME DSL parsing logic actually supports passing arbitrary values as props, but there is no compatible syntax in the type definition\n  } as unknown as DSLElement['props'],\n});\n\n// Unit kb\nexport const IMAGE_MAX_SIZE = 500 * 1024; // 500 mb\nexport const FILE_MAX_SIZE = 500 * 1024; // 500 mb\n\nconst getAcceptByComponent = (component: shortcut_command.Components) => {\n  let uploadItemTypes = [];\n  const { input_type, upload_options } = component;\n  if (input_type === shortcut_command.InputType.MixUpload) {\n    uploadItemTypes = upload_options ?? [];\n  } else {\n    uploadItemTypes = input_type ? [input_type] : [];\n  }\n  return getAcceptByUploadItemTypes(uploadItemTypes);\n};\n\nexport const getUploadElementDSL: GetFormItemTemplate = component => ({\n  id: component.name ?? shortid(),\n  name: 'FlowpdCiciComponentsUpload', // The TODO component name should preferably be agreed in advance\n  type: '@flowpd/cici-components/Upload',\n  props: {\n    name: component.name,\n    description: component.description,\n    maxSize:\n      component.input_type === shortcut_command.InputType.UploadImage\n        ? IMAGE_MAX_SIZE\n        : FILE_MAX_SIZE,\n    inputType: component.input_type,\n    accept: getAcceptByComponent(component),\n    rules: [\n      {\n        required: true,\n      },\n    ],\n    noErrorMessage: true,\n    // The @FIXME DSL parsing logic actually supports passing arbitrary values as props, but there is no compatible syntax in the type definition\n  } as unknown as DSLElement['props'],\n});\n\n// Configuration & Preview Mode Placeholders\nexport const getFormItemPlaceholderDSL = () => ({\n  id: shortid(),\n  name: 'FlowpdCiciComponentsFormItemPlaceholder',\n  type: '@flowpd/cici-components/Placeholder',\n});\n\nexport const getLayoutDSL = (items: DSLElement[]): DSLElement => ({\n  id: shortid(),\n  name: 'FlowpdCiciComponentsColumnLayout',\n  type: '@flowpd/cici-components/ColumnLayout',\n  props: {\n    // If an odd number appears, the last line is full\n    Columns: items.map(item => ({\n      children: [item.id],\n      config: { vertical: 'top', weight: 1, width: 'weighted' },\n      type: 'slot',\n    })),\n    action: 'enableUrl',\n    backgroundColor: 'transparent',\n    enableClickEvent: false,\n    // @FIXME card-buidler Layout an existing data structure, but the type is actually illegal\n  } as unknown as DSLElement['props'],\n});\nexport const getFormItemDSLMap: Record<\n  shortcut_command.InputType,\n  GetFormItemTemplate\n> = {\n  [shortcut_command.InputType.TextInput]: getInputElementDSL,\n  [shortcut_command.InputType.Select]: getSelectElementDSL,\n  [shortcut_command.InputType.UploadImage]: getUploadElementDSL,\n  [shortcut_command.InputType.UploadDoc]: getUploadElementDSL,\n  [shortcut_command.InputType.UploadTable]: getUploadElementDSL,\n  [shortcut_command.InputType.UploadAudio]: getUploadElementDSL,\n  [shortcut_command.InputType.MixUpload]: getUploadElementDSL,\n  [shortcut_command.InputType.PPT]: getUploadElementDSL,\n  [shortcut_command.InputType.ARCHIVE]: getUploadElementDSL,\n  [shortcut_command.InputType.CODE]: getUploadElementDSL,\n  [shortcut_command.InputType.TXT]: getUploadElementDSL,\n  [shortcut_command.InputType.VIDEO]: getUploadElementDSL,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type shortcut_command } from '@coze-arch/bot-api/playground_api';\n\nimport { type DSL } from '../../types';\nimport { type DSLFormFieldCommonProps } from '../../components/short-cut-panel/widgets/types';\nimport {\n  getDSLTemplate,\n  getFormItemDSLMap,\n  getFormItemPlaceholderDSL,\n  getLayoutDSL,\n} from './templates';\n\n// Generating a complete DSL with Components\nexport const getDSLFromComponents = (\n  params: shortcut_command.Components[],\n): DSL => {\n  const formItemsDSL = params.map(getFormElementFromComponent);\n  const layoutDSL = getElementsLayout(formItemsDSL);\n  const template = getDSLTemplate();\n  template.elements.form?.children?.unshift(...layoutDSL.map(item => item.id));\n  [...formItemsDSL, ...layoutDSL].forEach(\n    item => (template.elements[item.id] = item),\n  );\n  // @ts-expect-error supports direct delivery of props\n  template.elements.submitButton.props.formFields = formItemsDSL.map(\n    item => item.id,\n  );\n  return template;\n};\n\ntype DSLElement = DSL['elements'][string];\n\n// Create the corresponding form element Element in the DSL through Components\nexport const getFormElementFromComponent = (\n  param: shortcut_command.Components,\n): DSLElement => {\n  if (param.input_type !== undefined) {\n    return getFormItemDSLMap[param.input_type](param);\n  }\n  return getFormItemPlaceholderDSL();\n};\n\n// Container elements for generating two-column layouts in DSL syntax\nconst ITEMS_PER_LINE = 2;\nexport const getElementsLayout = (elements: DSLElement[]): DSLElement[] => {\n  const res: DSLElement[] = [];\n  const elementsCopy = [...elements];\n  // If an odd number appears, the last line is full\n  while (elementsCopy.length) {\n    res.push(getLayoutDSL(elementsCopy.splice(0, ITEMS_PER_LINE)));\n  }\n  return res;\n};\n\nexport enum ElementType {\n  Input = '@flowpd/cici-components/Input',\n}\n\nexport const findInputElementsWithDefault = (dsl: DSL) => {\n  if (!dsl?.elements) {\n    return [];\n  }\n\n  return Object.values(dsl.elements)\n    .map(c => {\n      const defaultValue = c?.props\n        ?.defaultValue as DSLFormFieldCommonProps['defaultValue'];\n\n      return {\n        defaultValue: defaultValue?.value,\n        type: c.type,\n        id: c.id,\n      };\n    })\n    .filter(e => e.type === ElementType.Input && !!e.defaultValue);\n};\n\nexport const findInputElementById = (dsl: DSL, id: string) => {\n  if (!dsl?.elements) {\n    return null;\n  }\n\n  return (\n    Object.values(dsl.elements)\n      .filter(e => e.type === ElementType.Input)\n      .find(e => e.id === id) ?? null\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ZipIcon,\n  VideoIcon,\n  TextIcon as TxtIcon,\n  ImageIcon,\n  AudioIcon,\n  CodeIcon,\n  PptIcon,\n  DocxIcon as DocIcon,\n  XlsxIcon as TableIcon,\n} from '@coze-common/chat-uikit';\nimport { FILE_TYPE_CONFIG, FileTypeEnum } from '@coze-common/chat-core';\nimport { I18n } from '@coze-arch/i18n';\nimport { InputType, shortcut_command } from '@coze-arch/bot-api/playground_api';\n\nexport type UploadItemType =\n  | InputType.UploadImage\n  | InputType.UploadDoc\n  | InputType.UploadTable\n  | InputType.UploadAudio\n  | InputType.CODE\n  | InputType.ARCHIVE\n  | InputType.PPT\n  | InputType.VIDEO\n  | InputType.TXT;\n\nexport const ACCEPT_UPLOAD_TYPES: {\n  type: UploadItemType;\n  label: string;\n  icon: string;\n}[] = [\n  {\n    type: InputType.UploadImage,\n    label: I18n.t('shortcut_modal_upload_component_file_format_img'),\n    icon: ImageIcon,\n  },\n  {\n    type: InputType.UploadTable,\n    label: I18n.t('shortcut_modal_upload_component_file_format_table'),\n    icon: TableIcon,\n  },\n  {\n    type: InputType.UploadDoc,\n    label: I18n.t('shortcut_modal_upload_component_file_format_doc'),\n    icon: DocIcon,\n  },\n  {\n    type: InputType.UploadAudio,\n    label: I18n.t('shortcut_modal_upload_component_file_format_audio'),\n    icon: AudioIcon,\n  },\n  {\n    type: InputType.CODE,\n    label: I18n.t('shortcut_modal_upload_component_file_format_code'),\n    icon: CodeIcon,\n  },\n  {\n    type: InputType.ARCHIVE,\n    label: I18n.t('shortcut_modal_upload_component_file_format_zip'),\n    icon: ZipIcon,\n  },\n  {\n    type: InputType.PPT,\n    label: I18n.t('shortcut_modal_upload_component_file_format_ppt'),\n    icon: PptIcon,\n  },\n  {\n    type: InputType.VIDEO,\n    label: I18n.t('shortcut_modal_upload_component_file_format_video'),\n    icon: VideoIcon,\n  },\n  {\n    type: InputType.TXT,\n    label: I18n.t('shortcut_modal_upload_component_file_format_txt'),\n    icon: TxtIcon,\n  },\n];\n\n// Map with file formats supported by chat\nexport const fileTypeToInputTypeMap = {\n  [FileTypeEnum.IMAGE]: shortcut_command.InputType.UploadImage,\n  [FileTypeEnum.AUDIO]: shortcut_command.InputType.UploadAudio,\n  [FileTypeEnum.PDF]: shortcut_command.InputType.UploadDoc,\n  [FileTypeEnum.DOCX]: shortcut_command.InputType.UploadDoc,\n  [FileTypeEnum.EXCEL]: shortcut_command.InputType.UploadTable,\n  [FileTypeEnum.CSV]: shortcut_command.InputType.UploadTable,\n  [FileTypeEnum.VIDEO]: shortcut_command.InputType.VIDEO,\n  [FileTypeEnum.PPT]: shortcut_command.InputType.PPT,\n  [FileTypeEnum.TXT]: shortcut_command.InputType.TXT,\n  [FileTypeEnum.ARCHIVE]: shortcut_command.InputType.ARCHIVE,\n  [FileTypeEnum.CODE]: shortcut_command.InputType.CODE,\n  [FileTypeEnum.DEFAULT_UNKNOWN]: shortcut_command.InputType.UploadDoc,\n};\n\nexport const acceptMap = FILE_TYPE_CONFIG.reduce<{\n  [key in shortcut_command.InputType]?: string;\n}>((acc, cur) => {\n  const inputType = fileTypeToInputTypeMap[cur.fileType];\n  if (inputType) {\n    const preAcc = acc[inputType];\n    if (preAcc) {\n      acc[inputType] = `${preAcc},${cur.accept.join(',')}`;\n    } else {\n      acc[inputType] = cur.accept.join(',');\n    }\n  }\n  return acc;\n}, {});\n\n// Accept based on acceptUploadItemTypes\nexport const getAcceptByUploadItemTypes = (\n  acceptUploadItemTypes: shortcut_command.InputType[],\n) => {\n  const accept: string[] = [];\n  for (const type of acceptUploadItemTypes) {\n    if (!type) {\n      continue;\n    }\n    const acceptStr = acceptMap[type];\n    if (!acceptStr) {\n      continue;\n    }\n    accept.push(...acceptStr.split(','));\n  }\n  return accept.join(',');\n};\n\n// Get the corresponding fileInfo according to fileType\nexport const getFileInfoByFileType = (fileType: FileTypeEnum) => {\n  const inputType = fileTypeToInputTypeMap[fileType];\n  if (!inputType) {\n    return null;\n  }\n  return ACCEPT_UPLOAD_TYPES.find(item => item.type === inputType);\n};\n\n// ACCEPT_UPLOAD_TYPES converted to map\nexport const getAcceptUploadItemTypesMap = () =>\n  ACCEPT_UPLOAD_TYPES.reduce<{\n    [key in shortcut_command.InputType]?: string;\n  }>((acc, cur) => {\n    acc[cur.type] = cur.label;\n    return acc;\n  }, {});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  shortcut_command,\n  type ToolParams,\n} from '@coze-arch/bot-api/playground_api';\n\nimport { type ToolInfo } from '../shortcut-tool/types';\n\n// Get toolInfo by shortcut\nexport const getToolInfoByShortcut = (\n  shortcut: shortcut_command.ShortcutCommand | undefined,\n): ToolInfo => {\n  if (!shortcut) {\n    return {\n      tool_type: '',\n      tool_name: '',\n      plugin_id: '',\n      plugin_api_name: '',\n      plugin_from: undefined,\n      tool_params_list: [],\n    };\n  }\n  const {\n    tool_info: { tool_params_list = [], tool_name = '' } = {},\n    tool_type,\n    plugin_id,\n    plugin_api_name,\n    plugin_from,\n    work_flow_id,\n  } = shortcut;\n  return {\n    tool_type,\n    tool_name,\n    plugin_id,\n    plugin_api_name,\n    plugin_from,\n    tool_params_list,\n    work_flow_id,\n  };\n};\n\n// Check string: number + English + _ & cannot be pure numbers\nexport const validateCmdString = (value: string) =>\n  /^[a-zA-Z0-9_]+$/.test(value) && !/^[0-9]+$/.test(value);\n\n// According to tool_type determine whether the tool is turned on.\nexport const initToolEnabledByToolTYpe = (\n  toolType: shortcut_command.ToolType | undefined,\n) =>\n  toolType !== undefined &&\n  [\n    shortcut_command.ToolType.ToolTypeWorkFlow,\n    shortcut_command.ToolType.ToolTypePlugin,\n  ].includes(toolType);\n\n// Verify that the plugin and workflow parameters are of type string | integer, and do not support complex object types\nexport const validatePluginAndWorkflowParams = (\n  params: ToolParams[],\n  enableEmpty = false,\n): {\n  isSuccess: boolean;\n  inValidType: 'empty' | 'complex' | '';\n} => {\n  if (!params.length) {\n    return {\n      isSuccess: enableEmpty,\n      inValidType: 'empty',\n    };\n  }\n  const isComplex = params.every(param => {\n    const { type } = param;\n    return type !== undefined && !['array', 'object'].includes(type);\n  });\n  return {\n    isSuccess: isComplex,\n    inValidType: isComplex ? '' : 'complex',\n  };\n};\n\n// Check if shortcut_command duplicate\nexport const validateCommandNameRepeat = (\n  checkShortcut: shortcut_command.ShortcutCommand,\n  shortcuts: shortcut_command.ShortcutCommand[],\n): boolean => {\n  const { shortcut_command: shortcutCommand, command_id } = checkShortcut;\n  return !shortcuts.some(\n    shortcut =>\n      command_id !== shortcut.command_id &&\n      shortcut.shortcut_command === shortcutCommand,\n  );\n};\n// Check button name command_name duplicate\nexport const validateButtonNameRepeat = (\n  checkShortcut: shortcut_command.ShortcutCommand,\n  shortcuts: shortcut_command.ShortcutCommand[],\n): boolean => {\n  const { command_name, command_id } = checkShortcut;\n  return !shortcuts.some(\n    shortcut =>\n      command_id !== shortcut.command_id &&\n      shortcut.command_name === command_name,\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Align the logic of card-builder generating ID, make a copy temporarily, and plan to use the underlying capabilities of card-buidler directly in the future\nimport { nanoid, customAlphabet } from 'nanoid';\n\n/**\n * @param prefix - id prefix\n * @Param options - alphabet; length: length, default 10;\n */\nexport const shortid = (\n  prefix = '',\n  options?: {\n    alphabet?: string;\n    length?: number;\n  },\n) => {\n  const {\n    alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',\n    length = 10,\n  } = options || {};\n  const genId = customAlphabet(alphabet, length);\n  return `${prefix}${genId()}`;\n};\n\nexport const uuid = () => nanoid();\n\nexport const id = shortid;\n\nexport const generate = shortid;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Emitter } from 'mitt';\nimport { type GrabNode } from '@coze-common/text-grab';\nimport {\n  type OnLinkElementContext,\n  type MessageSource,\n} from '@coze-common/chat-area';\n\nimport { type SelectionStore } from '../stores/selection';\nimport { type QuoteStore } from '../stores/quote';\nimport { type PreferenceStore } from '../stores/preference';\nimport { type Scene } from '../create';\n\nexport const enum EventNames {\n  OnViewScroll = 'onViewScroll',\n  OnMessageUpdate = 'onMessageUpdate',\n  OnLinkElementMouseEnter = 'onCardLinkElementMouseEnter',\n  OnLinkElementMouseLeave = 'onCardLinkElementMouseLeave',\n}\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-definitions -- as expected\nexport type EventCenter = {\n  [EventNames.OnMessageUpdate]: unknown;\n  [EventNames.OnViewScroll]: unknown;\n  [EventNames.OnLinkElementMouseEnter]: OnLinkElementContext & {\n    type: 'link' | 'image';\n  };\n  [EventNames.OnLinkElementMouseLeave]: OnLinkElementContext & {\n    type: 'link' | 'image';\n  };\n};\n\nexport const enum PublicEventNames {\n  UpdateQuote = 'updateQuote',\n}\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-definitions\nexport type PublicEventCenter = {\n  [PublicEventNames.UpdateQuote]: {\n    grabPluginId: string;\n    quote: GrabNode[] | null;\n  };\n};\n\nexport interface GrabPluginBizContext {\n  grabPluginId: string;\n  storeSet: {\n    useSelectionStore: SelectionStore;\n    useQuoteStore: QuoteStore;\n    usePreferenceStore: PreferenceStore;\n  };\n  eventCallbacks: EventCallbacks;\n  eventCenter: Emitter<EventCenter>;\n  publicEventCenter: Emitter<PublicEventCenter>;\n  unsubscribe: () => void;\n  scene?: Scene;\n}\n\nexport interface EventCallbacks {\n  onQuote?: ({\n    botId,\n    source,\n  }: {\n    botId: string;\n    source: MessageSource | undefined;\n  }) => void;\n  onQuoteChange?: ({ isEmpty }: { isEmpty: boolean }) => void;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\nimport {\n  type SelectionData,\n  type GrabNode,\n  type GrabPosition,\n} from '@coze-common/text-grab';\n\nexport interface SelectionState {\n  humanizedContentText: string;\n  originContentText: string;\n  normalizeSelectionNodeList: GrabNode[];\n  selectionData: SelectionData | null;\n  isFloatMenuVisible: boolean;\n  floatMenuPosition: GrabPosition | null;\n}\n\nexport interface SelectionAction {\n  updateHumanizedContentText: (text: string) => void;\n  updateOriginContentText: (text: string) => void;\n  updateNormalizeSelectionNodeList: (nodeList: GrabNode[]) => void;\n  updateSelectionData: (selectionData: SelectionData | null) => void;\n  updateIsFloatMenuVisible: (visible: boolean) => void;\n  updateFloatMenuPosition: (position: GrabPosition | null) => void;\n  clearStore: () => void;\n}\n\nexport const createSelectionStore = (mark: string) => {\n  const useSelectionStore = create<SelectionState & SelectionAction>()(\n    devtools(\n      (set, get) => ({\n        humanizedContentText: '',\n        originContentText: '',\n        normalizeSelectionNodeList: [],\n        selectionData: null,\n        isFloatMenuVisible: false,\n        floatMenuPosition: null,\n        updateHumanizedContentText: text => {\n          set({\n            humanizedContentText: text,\n          });\n        },\n        updateOriginContentText: text => {\n          set({\n            originContentText: text,\n          });\n        },\n        updateNormalizeSelectionNodeList: nodeList => {\n          set({\n            normalizeSelectionNodeList: nodeList,\n          });\n        },\n        updateIsFloatMenuVisible: visible => {\n          set({\n            isFloatMenuVisible: visible,\n          });\n        },\n        updateSelectionData: selectionData => {\n          set({\n            selectionData,\n          });\n        },\n        updateFloatMenuPosition: position => {\n          set({\n            floatMenuPosition: position,\n          });\n        },\n        clearStore: () => {\n          set({\n            humanizedContentText: '',\n            originContentText: '',\n            normalizeSelectionNodeList: [],\n            selectionData: null,\n          });\n        },\n      }),\n      {\n        name: `botStudio.ChatAreaGrabPlugin.SelectionStore.${mark}`,\n        enabled: IS_DEV_MODE,\n      },\n    ),\n  );\n\n  return useSelectionStore;\n};\n\nexport type SelectionStore = ReturnType<typeof createSelectionStore>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools, subscribeWithSelector } from 'zustand/middleware';\nimport { create } from 'zustand';\nimport { produce } from 'immer';\nimport { type GrabNode } from '@coze-common/text-grab';\n\nimport { type EventCallbacks } from '../types/plugin-biz-context';\n\nexport interface QuoteState {\n  quoteContent: GrabNode[] | null;\n  quoteVisible: boolean;\n  quoteContentMap: Record<string, GrabNode[]>;\n}\n\nexport interface QuoteAction {\n  updateQuoteContent: (quote: GrabNode[] | null) => void;\n  updateQuoteContentMapByImmer: (\n    updater: (quoteContentMap: Record<string, GrabNode[]>) => void,\n  ) => void;\n  updateQuoteVisible: (visible: boolean) => void;\n  clearStore: () => void;\n}\n\nexport const createQuoteStore = (mark: string) => {\n  const useQuoteStore = create<QuoteState & QuoteAction>()(\n    devtools(\n      subscribeWithSelector(set => ({\n        quoteContent: null,\n        quoteVisible: false,\n        quoteContentMap: {},\n        updateQuoteContent: quote => {\n          set({\n            quoteContent: quote,\n          });\n        },\n        updateQuoteContentMapByImmer: updater => {\n          set(produce<QuoteState>(state => updater(state.quoteContentMap)));\n        },\n        updateQuoteVisible: visible => {\n          set({\n            quoteVisible: visible,\n          });\n        },\n        clearStore: () => {\n          set({\n            quoteContent: null,\n            quoteVisible: false,\n          });\n        },\n      })),\n      {\n        name: `botStudio.ChatAreaGrabPlugin.Quote.${mark}`,\n        enabled: IS_DEV_MODE,\n      },\n    ),\n  );\n\n  return useQuoteStore;\n};\n\nexport type QuoteStore = ReturnType<typeof createQuoteStore>;\n\nexport const subscribeQuoteUpdate = (\n  store: {\n    useQuoteStore: QuoteStore;\n  },\n  eventCallbacks: EventCallbacks,\n) => {\n  const { useQuoteStore } = store;\n\n  return useQuoteStore.subscribe(\n    state => state.quoteContent,\n    quoteContent => {\n      const { onQuoteChange } = eventCallbacks;\n      onQuoteChange?.({ isEmpty: !quoteContent });\n    },\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { devtools, subscribeWithSelector } from 'zustand/middleware';\nimport { create } from 'zustand';\n\nexport interface PreferenceState {\n  enableGrab: boolean;\n}\n\nexport interface PreferenceAction {\n  updateEnableGrab: (enable: boolean) => void;\n}\n\nexport const createPreferenceStore = (mark: string) => {\n  const usePreferenceStore = create<PreferenceState & PreferenceAction>()(\n    devtools(\n      subscribeWithSelector(set => ({\n        enableGrab: false,\n        updateEnableGrab: enable => {\n          set({\n            enableGrab: enable,\n          });\n        },\n      })),\n      {\n        name: `botStudio.ChatAreaGrabPlugin.Preference.${mark}`,\n        enabled: IS_DEV_MODE,\n      },\n    ),\n  );\n\n  return usePreferenceStore;\n};\n\nexport type PreferenceStore = ReturnType<typeof createPreferenceStore>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getOriginContentText } from '@coze-common/text-grab';\nimport {\n  ContentType,\n  type OnBeforeAppendSenderMessageIntoStore,\n  WriteableMessageLifeCycleService,\n  type OnAfterAppendSenderMessageIntoStore,\n} from '@coze-common/chat-area';\n\nimport {\n  EventNames,\n  type GrabPluginBizContext,\n} from '../../types/plugin-biz-context';\n\nexport class GrabMessageLifeCycleService extends WriteableMessageLifeCycleService<GrabPluginBizContext> {\n  onBeforeAppendSenderMessageIntoStore(\n    ctx: OnBeforeAppendSenderMessageIntoStore,\n  ) {\n    const { quoteContent, updateQuoteContentMapByImmer } =\n      this.pluginInstance.pluginBizContext.storeSet.useQuoteStore.getState();\n\n    if (!quoteContent || ctx.from === 'shortcut') {\n      return ctx;\n    }\n\n    const originMessage = ctx.message;\n\n    const newContent = {\n      item_list: [\n        {\n          type: 'text',\n          text: originMessage.content,\n        },\n      ],\n      refer_items: [] as unknown[],\n    };\n\n    newContent.refer_items.push({\n      type: ContentType.Text,\n      text: getOriginContentText(quoteContent),\n    });\n\n    const newMessage = {\n      ...originMessage,\n      content_type: ContentType.Mix,\n      content: JSON.stringify(newContent),\n      content_obj: newContent,\n    };\n\n    updateQuoteContentMapByImmer(quoteContentMap => {\n      const localMessageId = newMessage.extra_info.local_message_id;\n      if (!quoteContentMap[localMessageId]) {\n        quoteContentMap[localMessageId] = quoteContent;\n      }\n    });\n\n    return {\n      ...ctx,\n      message: newMessage,\n    };\n  }\n\n  onAfterAppendSenderMessageIntoStore(\n    ctx: OnAfterAppendSenderMessageIntoStore,\n  ) {\n    if (ctx.from === 'shortcut') {\n      return;\n    }\n\n    const { storeSet } = this.pluginInstance.pluginBizContext;\n    const { updateQuoteVisible, updateQuoteContent } =\n      storeSet.useQuoteStore.getState();\n    updateQuoteVisible(false);\n    updateQuoteContent(null);\n\n    return;\n  }\n\n  onAfterProcessReceiveMessage() {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnMessageUpdate);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type OnImageElementContext,\n  WriteableCommandLifeCycleService,\n  type OnLinkElementContext,\n} from '@coze-common/chat-area';\n\nimport {\n  EventNames,\n  type GrabPluginBizContext,\n} from '../../types/plugin-biz-context';\n\nexport class GrabCommandLifeCycleService extends WriteableCommandLifeCycleService<GrabPluginBizContext> {\n  onViewScroll(): void {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnViewScroll);\n  }\n  onCardLinkElementMouseEnter(ctx: OnLinkElementContext) {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnLinkElementMouseEnter, {\n      ...ctx,\n      type: 'image',\n    });\n  }\n  onCardLinkElementMouseLeave(ctx: OnLinkElementContext) {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnLinkElementMouseLeave, {\n      ...ctx,\n      type: 'image',\n    });\n  }\n  onMdBoxImageElementMouseEnter(ctx: OnImageElementContext): void {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnLinkElementMouseEnter, {\n      ...ctx,\n      type: 'image',\n    });\n  }\n  onMdBoxImageElementMouseLeave(ctx: OnImageElementContext): void {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnLinkElementMouseLeave, {\n      ...ctx,\n      type: 'image',\n    });\n  }\n  onMdBoxLinkElementMouseEnter(ctx: OnLinkElementContext): void {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnLinkElementMouseEnter, {\n      ...ctx,\n      type: 'link',\n    });\n  }\n  onMdBoxLinkElementMouseLeave(ctx: OnLinkElementContext): void {\n    const { emit } = this.pluginInstance.pluginBizContext.eventCenter;\n    emit(EventNames.OnLinkElementMouseLeave, {\n      ...ctx,\n      type: 'link',\n    });\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GrabNode } from '@coze-common/text-grab';\nimport { WriteableAppLifeCycleService } from '@coze-common/chat-area';\n\nimport {\n  PublicEventNames,\n  type GrabPluginBizContext,\n} from '../../types/plugin-biz-context';\n\nexport class GrabAppLifeCycleService extends WriteableAppLifeCycleService<GrabPluginBizContext> {\n  onBeforeDestroy(): void {\n    const { unsubscribe, eventCenter, publicEventCenter, scene } =\n      this.pluginInstance.pluginBizContext;\n\n    // There are some problems with the Store history logic, which leads to the situation that destroy is called multiple times but not initialized. Instead of going through the following forced cleaning process, the component life cycle is destroyed.\n    if (scene === 'store') {\n      return;\n    }\n\n    unsubscribe();\n    eventCenter.all.clear();\n    publicEventCenter.all.clear();\n  }\n  onBeforeInitial(): void {\n    const {\n      publicEventCenter,\n      grabPluginId: currentGrabPluginId,\n      storeSet,\n    } = this.pluginInstance.pluginBizContext;\n\n    const { useQuoteStore } = storeSet;\n\n    const { updateQuoteContent, updateQuoteVisible } = useQuoteStore.getState();\n\n    publicEventCenter.on(\n      PublicEventNames.UpdateQuote,\n      ({\n        grabPluginId,\n        quote,\n      }: {\n        grabPluginId: string;\n        quote: GrabNode[] | null;\n      }) => {\n        if (currentGrabPluginId !== grabPluginId) {\n          return;\n        }\n\n        updateQuoteContent(quote);\n        updateQuoteVisible(true);\n      },\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ChatAreaPluginContext,\n  type PluginMode,\n} from '@coze-common/chat-area';\n\nexport const getMessage = ({\n  messageId,\n  chatAreaPluginContext,\n}: {\n  messageId: string;\n  chatAreaPluginContext: ChatAreaPluginContext<PluginMode.Writeable>;\n}) => {\n  if (!messageId) {\n    return;\n  }\n\n  const message =\n    chatAreaPluginContext.readonlyAPI.message.findMessage(messageId);\n\n  return message;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { PluginName, useWriteablePlugin } from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozQuotation } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { getMessage } from '../../utils/get-message';\nimport { type GrabPluginBizContext } from '../../types/plugin-biz-context';\n\nexport interface QuoteButtonProps {\n  onClose?: () => void;\n  onClick?: () => void;\n}\n\nexport const QuoteButton: FC<QuoteButtonProps> = ({ onClose, onClick }) => {\n  const { pluginBizContext, chatAreaPluginContext } =\n    useWriteablePlugin<GrabPluginBizContext>(PluginName.MessageGrab);\n\n  const { onQuote } = pluginBizContext.eventCallbacks;\n\n  const { useQuoteStore, useSelectionStore, usePreferenceStore } =\n    pluginBizContext.storeSet;\n\n  const { updateQuoteContent, updateQuoteVisible } = useQuoteStore(\n    useShallow(state => ({\n      updateQuoteVisible: state.updateQuoteVisible,\n      updateQuoteContent: state.updateQuoteContent,\n    })),\n  );\n\n  const enableGrab = usePreferenceStore(state => state.enableGrab);\n\n  const { useDeleteFile } = chatAreaPluginContext.writeableHook.file;\n  const { getFileStoreInstantValues } =\n    chatAreaPluginContext.readonlyAPI.batchFile;\n\n  const deleteFile = useDeleteFile();\n\n  const deleteAllFile = () => {\n    const { fileIdList } = getFileStoreInstantValues();\n\n    fileIdList.forEach(id => deleteFile(id));\n  };\n\n  const getMessageInfo = () => {\n    const { selectionData } = useSelectionStore.getState();\n\n    const messageId = selectionData?.ancestorAttributeValue;\n\n    if (!messageId) {\n      return;\n    }\n\n    return getMessage({ messageId, chatAreaPluginContext });\n  };\n\n  const handleClick = () => {\n    deleteAllFile();\n\n    if (onClick) {\n      onClick();\n      onClose?.();\n      return;\n    }\n\n    const { normalizeSelectionNodeList } = useSelectionStore.getState();\n\n    updateQuoteContent(normalizeSelectionNodeList);\n\n    updateQuoteVisible(true);\n\n    const message = getMessageInfo();\n\n    onQuote?.({ botId: message?.sender_id ?? '', source: message?.source });\n\n    onClose?.();\n  };\n\n  if (!enableGrab) {\n    return null;\n  }\n\n  return (\n    <Tooltip content={I18n.t('quote_ask_in_chat')} clickToHide={true}>\n      <IconButton\n        icon={<IconCozQuotation className=\"text-lg coz-fg-secondary\" />}\n        color=\"secondary\"\n        onClick={handleClick}\n        size=\"small\"\n        wrapperClass=\"flex justify-center items-center\"\n      />\n    </Tooltip>\n  );\n};\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ReactNode,\n  forwardRef,\n  type CSSProperties,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  type MutableRefObject,\n  useState,\n} from 'react';\n\nimport classNames from 'classnames';\nimport { useEventCallback } from '@coze-common/chat-hooks';\nimport { PluginName, useWriteablePlugin } from '@coze-common/chat-area';\n\nimport {\n  EventNames,\n  type GrabPluginBizContext,\n} from '../../types/plugin-biz-context';\n\nimport s from './index.module.less';\n\ninterface MenuListProps {\n  style?: CSSProperties;\n  children: ReactNode;\n  className?: string;\n  onScroll?: () => void;\n  onMouseEnter?: () => void;\n  onMouseLeave?: () => void;\n}\n\nexport interface MenuListRef {\n  getRef: () => MutableRefObject<HTMLDivElement | null>;\n  refreshOpacity: () => void;\n}\n\nconst GRADIENT_RANGE = 100;\n\nexport const MenuList = forwardRef<MenuListRef, MenuListProps>((props, ref) => {\n  const plugin = useWriteablePlugin<GrabPluginBizContext>(\n    PluginName.MessageGrab,\n  );\n\n  const { useGetScrollView } =\n    plugin.chatAreaPluginContext.readonlyHook.scrollView;\n\n  const { on, off } = plugin.pluginBizContext.eventCenter;\n  const { style, children, onScroll, onMouseEnter, onMouseLeave, className } =\n    props;\n\n  const getScrollView = useGetScrollView();\n\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  const [opacity, setOpacity] = useState(1);\n\n  useImperativeHandle(ref, () => ({\n    getRef: () => menuRef,\n    refreshOpacity,\n  }));\n\n  const refreshOpacity = useEventCallback(() => {\n    onScroll?.();\n\n    const localRect = menuRef.current?.getBoundingClientRect();\n\n    const { rect: scrollRect } = getScrollView().getOriginScrollInfo();\n\n    if (!scrollRect || !localRect) {\n      return;\n    }\n\n    if (localRect.y - GRADIENT_RANGE <= scrollRect.top) {\n      const _opacity = (localRect.y - scrollRect.top) / GRADIENT_RANGE;\n      setOpacity(_opacity < 0 ? 0 : _opacity);\n    } else if (localRect.y + GRADIENT_RANGE >= scrollRect.bottom) {\n      const _opacity = (scrollRect.bottom - localRect.y) / GRADIENT_RANGE;\n      setOpacity(_opacity < 0 ? 0 : _opacity);\n    } else {\n      setOpacity(1);\n    }\n  });\n\n  useEffect(() => {\n    on(EventNames.OnMessageUpdate, refreshOpacity);\n    return () => {\n      off(EventNames.OnMessageUpdate, refreshOpacity);\n    };\n  }, []);\n\n  return (\n    <div\n      className={classNames(\n        'fixed p-[2px] coz-bg-max coz-stroke-primary border-[0.5px] rounded-[8px] overflow-hidden grid grid-flow-col gap-[2px] h-[28px]',\n        s['container-box-shadow'],\n        className,\n      )}\n      style={{\n        ...style,\n        opacity,\n      }}\n      ref={menuRef}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n    >\n      {children}\n    </div>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { messageSource } from '@coze-common/chat-area';\n\nexport const FILTER_MESSAGE_SOURCE: number[] = [messageSource.Notice];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { defer } from 'lodash-es';\nimport classNames from 'classnames';\nimport { type GrabPosition, type SelectionData } from '@coze-common/text-grab';\nimport { useGrab } from '@coze-common/text-grab';\nimport { NO_MESSAGE_ID_MARK } from '@coze-common/chat-uikit';\nimport {\n  PluginName,\n  useWriteablePlugin,\n  type MessageListFloatSlot,\n} from '@coze-common/chat-area';\n\nimport { QuoteButton } from '../quote-button';\nimport { MenuList, type MenuListRef } from '../menu-list';\nimport {\n  EventNames,\n  type GrabPluginBizContext,\n} from '../../types/plugin-biz-context';\nimport { FILTER_MESSAGE_SOURCE } from '../../constants/filter-message';\n\nexport const GrabMenu: MessageListFloatSlot = ({ contentRef }) => {\n  // Get plugin instance\n  const plugin = useWriteablePlugin<GrabPluginBizContext>(\n    PluginName.MessageGrab,\n  );\n\n  // Get business context information for the plug-in\n  const { pluginBizContext } = plugin;\n  const { eventCenter, storeSet } = pluginBizContext;\n  const { usePreferenceStore, useSelectionStore } = storeSet;\n\n  // Event Center Listener Function\n  const { on, off } = eventCenter;\n\n  /**\n   * Floating Menu Ref\n   */\n  const floatMenuRef = useRef<MenuListRef>(null);\n\n  const { isFloatMenuVisible, position, updateFloatMenuPosition } =\n    useSelectionStore(\n      useShallow(state => ({\n        isFloatMenuVisible: state.isFloatMenuVisible,\n        position: state.floatMenuPosition,\n        updateFloatMenuPosition: state.updateFloatMenuPosition,\n      })),\n    );\n\n  /**\n   * Whether to enable the Grab plugin\n   */\n  const enableGrab = usePreferenceStore(state => state.enableGrab);\n\n  /**\n   * Callbacks to handle location information\n   */\n  const handlePositionChange = (_position: GrabPosition | null) => {\n    // Update Floating Menu Data in Store\n    updateFloatMenuPosition(_position);\n\n    // Call the refresh logic after clearing the stack (because the floatMenu is in the hidden state, the rect information obtained through ref is empty, so it needs to be delayed for a while)\n    defer(() => floatMenuRef.current?.refreshOpacity());\n  };\n\n  /**\n   * Handling changes in constituencies\n   */\n  const handleSelectChange = (selectionData: SelectionData | null) => {\n    const {\n      updateHumanizedContentText,\n      updateNormalizeSelectionNodeList,\n      updateOriginContentText,\n      updateSelectionData,\n      updateIsFloatMenuVisible,\n    } = plugin.pluginBizContext.storeSet.useSelectionStore.getState();\n\n    /**\n     * Filtering for special types of messages\n     * Currently only judged by the source messageSource\n     * 1. Notification type (no selection)\n     */\n    if (\n      selectionData &&\n      FILTER_MESSAGE_SOURCE.includes(selectionData.messageSource)\n    ) {\n      return;\n    }\n\n    // Update constituency data\n    updateSelectionData(selectionData);\n\n    // Update the status of displaying the floating menu\n    updateIsFloatMenuVisible(!!selectionData);\n\n    // Get MessageId\n    const messageId = selectionData?.ancestorAttributeValue;\n\n    // Determine whether it is a special message\n    const isSpecialMessage = messageId === NO_MESSAGE_ID_MARK;\n\n    // If you can't get the message ID, it proves that the constituency is not in the message.\n    if (!messageId) {\n      return;\n    }\n\n    // Special processing, you need to determine whether it is a message in the reply.\n    const { is_finish } =\n      plugin.chatAreaPluginContext.readonlyAPI.message.findMessage(messageId) ??\n      {};\n\n    // If the message reply is not completed, and it is not a special message, then it will not be displayed, otherwise it will be displayed\n    if (!is_finish && !isSpecialMessage) {\n      updateIsFloatMenuVisible(false);\n      return;\n    }\n\n    updateHumanizedContentText(selectionData?.humanizedContentText ?? '');\n    updateNormalizeSelectionNodeList(\n      selectionData?.normalizeSelectionNodeList ?? [],\n    );\n    updateOriginContentText(selectionData?.originContentText ?? '');\n  };\n\n  const { clearSelection, isScrolling, computePosition } = useGrab({\n    contentRef,\n    floatMenuRef: floatMenuRef.current?.getRef(),\n    onSelectChange: handleSelectChange,\n    onPositionChange: handlePositionChange,\n  });\n\n  const isShowFloatMenu = !!position && isFloatMenuVisible;\n\n  useEffect(() => {\n    on(EventNames.OnMessageUpdate, computePosition);\n    on(EventNames.OnViewScroll, computePosition);\n\n    return () => {\n      off(EventNames.OnMessageUpdate, computePosition);\n      off(EventNames.OnViewScroll, computePosition);\n    };\n  }, []);\n\n  // If the Grab plugin is not enabled, it will be hidden, of course.\n  if (!enableGrab) {\n    return null;\n  }\n\n  return (\n    <MenuList\n      ref={floatMenuRef}\n      style={{\n        top: position?.y,\n        left: position?.x,\n      }}\n      className={classNames({\n        hidden: !isShowFloatMenu || isScrolling,\n      })}\n    >\n      <QuoteButton onClose={clearSelection} />\n    </MenuList>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MutableRefObject, useEffect, useRef, useState } from 'react';\n\nimport {\n  CONTENT_ATTRIBUTE_NAME,\n  MESSAGE_SOURCE_ATTRIBUTE_NAME,\n  getAncestorAttributeNode,\n} from '@coze-common/text-grab';\n\nimport { FILTER_MESSAGE_SOURCE } from '../constants/filter-message';\n\ninterface HideQuoteProps<T> {\n  containerRef?: MutableRefObject<T | null>;\n}\n\nexport const useHideQuote = <T extends Element>(props?: HideQuoteProps<T>) => {\n  const containerRef = useRef<T | null>(null);\n  const targetRef = useRef<Element | null>(null);\n\n  const usedContainerRef = props?.containerRef?.current\n    ? props.containerRef\n    : containerRef;\n\n  const [forceHidden, setForceHidden] = useState(false);\n\n  useEffect(() => {\n    const target = getAncestorAttributeNode(\n      usedContainerRef.current,\n      CONTENT_ATTRIBUTE_NAME,\n    );\n\n    const messageSource = target?.attributes.getNamedItem(\n      MESSAGE_SOURCE_ATTRIBUTE_NAME,\n    )?.value;\n\n    if (FILTER_MESSAGE_SOURCE.includes(Number(messageSource))) {\n      setForceHidden(true);\n    }\n\n    targetRef.current = target;\n\n    return () => {\n      setForceHidden(false);\n      targetRef.current = null;\n    };\n  }, [usedContainerRef.current]);\n\n  return { targetRef, containerRef: usedContainerRef, forceHidden };\n};\n","import baseDelay from './_baseDelay.js';\nimport baseRest from './_baseRest.js';\nimport toNumber from './toNumber.js';\n\n/**\n * Invokes `func` after `wait` milliseconds. Any additional arguments are\n * provided to `func` when it's invoked.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to delay.\n * @param {number} wait The number of milliseconds to delay invocation.\n * @param {...*} [args] The arguments to invoke `func` with.\n * @returns {number} Returns the timer id.\n * @example\n *\n * _.delay(function(text) {\n *   console.log(text);\n * }, 1000, 'later');\n * // => Logs 'later' after one second.\n */\nvar delay = baseRest(function(func, wait, args) {\n  return baseDelay(func, toNumber(wait) || 0, args);\n});\n\nexport default delay;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GrabPosition } from '@coze-common/text-grab';\n\nconst BUFFER_SIZE = 5;\n\nexport const getMouseNearbyRect = (\n  rects: DOMRect[],\n  mouseInfo: GrabPosition,\n) => {\n  let nearbyRect = rects.at(0);\n  for (const rect of rects) {\n    if (\n      mouseInfo.x >= rect.left - BUFFER_SIZE &&\n      mouseInfo.x <= rect.right + BUFFER_SIZE &&\n      mouseInfo.y >= rect.top - BUFFER_SIZE &&\n      mouseInfo.y <= rect.bottom + BUFFER_SIZE\n    ) {\n      nearbyRect = rect;\n    }\n  }\n\n  return nearbyRect;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from 'react';\n\nimport { defer, delay } from 'lodash-es';\nimport {\n  CONTENT_ATTRIBUTE_NAME,\n  getAncestorAttributeNode,\n  type GrabPosition,\n} from '@coze-common/text-grab';\nimport { NO_MESSAGE_ID_MARK } from '@coze-common/chat-uikit';\nimport { useEventCallback } from '@coze-common/chat-hooks';\nimport {\n  type OnLinkElementContext,\n  type useWriteablePlugin,\n} from '@coze-common/chat-area';\n\nimport { getMouseNearbyRect } from '../utils/get-mouse-nearby-rect';\nimport {\n  EventNames,\n  type GrabPluginBizContext,\n} from '../types/plugin-biz-context';\nimport { type MenuListRef } from '../custom-components/menu-list';\n\nconst DELAY_DISAPPEAR_TIME = 100;\nconst TIMEOUT = 100;\n// eslint-disable-next-line max-lines-per-function, @coze-arch/max-line-per-function\nexport const useFloatMenuListener = ({\n  plugin,\n}: {\n  plugin: ReturnType<typeof useWriteablePlugin<GrabPluginBizContext>>;\n}) => {\n  const floatMenuRef = useRef<MenuListRef>(null);\n\n  const [visible, setVisible] = useState(false);\n\n  const targetElement = useRef<HTMLElement | null>(null);\n  const targetInfo = useRef<{\n    source: string;\n    type: 'image' | 'link';\n    text: string;\n  } | null>(null);\n\n  /**\n   * In Scrolling\n   */\n  const [isScrolling, setIsScrolling] = useState(false);\n\n  /**\n   * Scrolling timer\n   */\n  const scrollingTimer = useRef<NodeJS.Timeout | null>(null);\n\n  const { pluginBizContext } = plugin;\n  const { eventCenter } = pluginBizContext;\n  const { on, off } = eventCenter;\n\n  const isMouseInMenu = useRef(false);\n  const [position, setPosition] = useState<GrabPosition | null>(null);\n  const timer = useRef<number | null>(null);\n\n  const mouseInfo = useRef<GrabPosition>({ x: 0, y: 0 });\n\n  const handleMenuMouseEnter = useEventCallback(() => {\n    isMouseInMenu.current = true;\n    if (timer.current) {\n      clearTimeout(timer.current);\n    }\n  });\n\n  const handleMenuMouseLeave = useEventCallback(() => {\n    isMouseInMenu.current = false;\n    handleCardLinkElementMouseLeave();\n  });\n\n  const isMessageFinished = () => {\n    const target = getAncestorAttributeNode(\n      targetElement.current,\n      CONTENT_ATTRIBUTE_NAME,\n    );\n\n    const messageId = target?.attributes.getNamedItem(\n      CONTENT_ATTRIBUTE_NAME,\n    )?.value;\n\n    const isSpecialMessage = messageId === NO_MESSAGE_ID_MARK;\n\n    if (isSpecialMessage) {\n      return true;\n    }\n\n    if (!messageId) {\n      return false;\n    }\n\n    const { is_finish } =\n      plugin.chatAreaPluginContext.readonlyAPI.message.findMessage(messageId) ??\n      {};\n\n    return is_finish;\n  };\n\n  const handleCardLinkElementMouseEnter = useEventCallback(\n    (ctx: OnLinkElementContext & { type: 'link' | 'image' }) => {\n      if (timer.current) {\n        clearTimeout(timer.current);\n        timer.current = null;\n      }\n      targetElement.current = ctx.element;\n      targetInfo.current = {\n        source: ctx.link,\n        type: ctx.type,\n        text: ctx.element.textContent ?? '',\n      };\n\n      const isFinished = isMessageFinished();\n\n      if (!isFinished) {\n        return;\n      }\n\n      setVisible(true);\n      handleViewScroll();\n\n      defer(() => {\n        floatMenuRef.current?.refreshOpacity();\n      });\n    },\n  );\n\n  const handleCardLinkElementMouseLeave = useEventCallback(() => {\n    timer.current = delay(() => {\n      if (isMouseInMenu.current) {\n        return;\n      }\n      targetElement.current = null;\n      setVisible(false);\n    }, DELAY_DISAPPEAR_TIME);\n  });\n\n  const handleViewScroll = useEventCallback(() => {\n    const menuRef = floatMenuRef.current?.getRef();\n\n    if (\n      !targetElement.current ||\n      !menuRef ||\n      !menuRef.current ||\n      !targetInfo.current\n    ) {\n      return;\n    }\n\n    const target = targetElement.current;\n    const targetRect = target.getBoundingClientRect();\n    const menuRect = menuRef.current.getBoundingClientRect();\n    let x = 0;\n    let y = 0;\n    if (targetInfo.current.type === 'image') {\n      x = targetRect.right;\n      y = targetRect.bottom - targetRect.height / 2 - menuRect.height / 2;\n    } else {\n      const targetRects = target.getClientRects();\n\n      const nearbyRect =\n        getMouseNearbyRect(Array.from(targetRects), mouseInfo.current) ??\n        targetRect;\n\n      x = mouseInfo.current.x;\n      y = nearbyRect.bottom;\n    }\n\n    setPosition({ x, y });\n  });\n\n  const handleMouseMove = useEventCallback((event: MouseEvent) => {\n    const [x, y] = [event.clientX, event.clientY];\n    mouseInfo.current = { x, y };\n  });\n\n  const handleSmartScreenChange = useEventCallback(() => {\n    if (scrollingTimer.current) {\n      clearTimeout(scrollingTimer.current);\n    }\n\n    setIsScrolling(true);\n    scrollingTimer.current = setTimeout(() => {\n      handleViewScroll();\n      setIsScrolling(false);\n    }, TIMEOUT);\n  });\n\n  useEffect(() => {\n    on(EventNames.OnLinkElementMouseEnter, handleCardLinkElementMouseEnter);\n    on(EventNames.OnLinkElementMouseLeave, handleCardLinkElementMouseLeave);\n    on(EventNames.OnViewScroll, handleSmartScreenChange);\n    on(EventNames.OnMessageUpdate, handleSmartScreenChange);\n    window.addEventListener('mousemove', handleMouseMove);\n    window.addEventListener('resize', handleSmartScreenChange);\n    window.addEventListener('wheel', handleSmartScreenChange);\n    window.addEventListener('scroll', handleSmartScreenChange);\n\n    return () => {\n      off(EventNames.OnLinkElementMouseEnter, handleCardLinkElementMouseEnter);\n      off(EventNames.OnLinkElementMouseLeave, handleCardLinkElementMouseLeave);\n      off(EventNames.OnViewScroll, handleSmartScreenChange);\n      off(EventNames.OnMessageUpdate, handleSmartScreenChange);\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('resize', handleSmartScreenChange);\n      window.removeEventListener('wheel', handleSmartScreenChange);\n      window.removeEventListener('scroll', handleSmartScreenChange);\n    };\n  }, []);\n\n  return {\n    handleMenuMouseEnter,\n    handleMenuMouseLeave,\n    targetElement,\n    targetInfo,\n    position,\n    floatMenuRef,\n    visible,\n    setVisible,\n    computePosition: handleSmartScreenChange,\n    isScrolling,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type MutableRefObject,\n  useEffect,\n  useState,\n  type RefObject,\n} from 'react';\n\nimport { defer } from 'lodash-es';\nimport { type GrabPosition } from '@coze-common/text-grab';\n\nimport { type MenuListRef } from '../custom-components/menu-list';\n\nexport const useAutoGetMaxPosition = ({\n  position,\n  messageRef,\n  floatMenuRef,\n}: {\n  position: GrabPosition | null;\n  messageRef: MutableRefObject<Element | null>;\n  floatMenuRef: RefObject<MenuListRef>;\n}) => {\n  const [maxPositionX, setMaxPositionX] = useState(0);\n\n  useEffect(() => {\n    const maxX = messageRef.current?.getBoundingClientRect().right ?? 0;\n    setMaxPositionX(maxX);\n    defer(() => floatMenuRef.current?.refreshOpacity());\n  }, [position, messageRef.current, floatMenuRef.current]);\n\n  return { maxPositionX };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { defer } from 'lodash-es';\nimport classNames from 'classnames';\nimport { isTouchDevice } from '@coze-common/text-grab';\nimport {\n  CONTENT_ATTRIBUTE_NAME,\n  GrabElementType,\n  type GrabNode,\n} from '@coze-common/text-grab';\nimport {\n  PluginName,\n  useWriteablePlugin,\n  type MessageListFloatSlot,\n} from '@coze-common/chat-area';\n\nimport { QuoteButton } from '../quote-button';\nimport { MenuList } from '../menu-list';\nimport { getMessage } from '../../utils/get-message';\nimport {\n  EventNames,\n  type GrabPluginBizContext,\n} from '../../types/plugin-biz-context';\nimport { useHideQuote } from '../../hooks/use-hide-quote';\nimport { useFloatMenuListener } from '../../hooks/use-float-menu-listener';\nimport { useAutoGetMaxPosition } from '../../hooks/use-auto-get-max-position';\n\nexport const FloatMenu: MessageListFloatSlot = () => {\n  const plugin = useWriteablePlugin<GrabPluginBizContext>(\n    PluginName.MessageGrab,\n  );\n  const { chatAreaPluginContext, pluginBizContext } = plugin;\n  const { eventCenter } = pluginBizContext;\n  const { usePreferenceStore } = pluginBizContext.storeSet;\n  const enableGrab = usePreferenceStore(state => state.enableGrab);\n\n  const { on, off } = eventCenter;\n\n  const { useQuoteStore } = pluginBizContext.storeSet;\n  const { updateQuoteContent, updateQuoteVisible } = useQuoteStore(\n    useShallow(state => ({\n      updateQuoteVisible: state.updateQuoteVisible,\n      updateQuoteContent: state.updateQuoteContent,\n    })),\n  );\n\n  const {\n    handleMenuMouseEnter,\n    handleMenuMouseLeave,\n    targetElement,\n    targetInfo,\n    position,\n    floatMenuRef,\n    visible,\n    setVisible,\n    computePosition,\n    isScrolling,\n  } = useFloatMenuListener({\n    plugin,\n  });\n\n  const { targetRef: messageRef, forceHidden } = useHideQuote<HTMLElement>({\n    containerRef: targetElement,\n  });\n\n  const { maxPositionX } = useAutoGetMaxPosition({\n    messageRef,\n    position,\n    floatMenuRef,\n  });\n\n  const isGrabMenuVisible = plugin.pluginBizContext.storeSet.useSelectionStore(\n    state => state.isFloatMenuVisible && !!state.floatMenuPosition,\n  );\n\n  const handleQuoteClick = () => {\n    const { source = '', type = 'link', text = '' } = targetInfo.current ?? {};\n    const target = messageRef.current;\n    const messageId = target?.attributes.getNamedItem(\n      CONTENT_ATTRIBUTE_NAME,\n    )?.value;\n\n    if (!messageId) {\n      return;\n    }\n\n    const message = getMessage({\n      messageId,\n      chatAreaPluginContext,\n    });\n\n    const node: GrabNode =\n      type === 'image'\n        ? {\n            type: GrabElementType.IMAGE,\n            src: source,\n            children: [\n              {\n                text: source,\n              },\n            ],\n          }\n        : {\n            type: GrabElementType.LINK,\n            url: source,\n            children: [\n              {\n                text,\n              },\n            ],\n          };\n\n    updateQuoteContent([node]);\n    updateQuoteVisible(true);\n    pluginBizContext.eventCallbacks.onQuote?.({\n      botId: message?.sender_id ?? '',\n      source: message?.source,\n    });\n  };\n\n  useEffect(() => {\n    on(EventNames.OnMessageUpdate, computePosition);\n    on(EventNames.OnViewScroll, computePosition);\n\n    return () => {\n      off(EventNames.OnMessageUpdate, computePosition);\n      off(EventNames.OnViewScroll, computePosition);\n    };\n  }, []);\n\n  if (!enableGrab || isTouchDevice()) {\n    return null;\n  }\n\n  const top = position?.y;\n  const left =\n    (position?.x ?? 0) > (maxPositionX ?? 0) ? maxPositionX : position?.x;\n\n  return (\n    <>\n      {\n        <MenuList\n          ref={floatMenuRef}\n          className={classNames({\n            hidden: !visible || forceHidden || isGrabMenuVisible || isScrolling,\n          })}\n          style={{\n            top,\n            left,\n          }}\n          onMouseEnter={handleMenuMouseEnter}\n          onMouseLeave={handleMenuMouseLeave}\n        >\n          <QuoteButton\n            onClick={handleQuoteClick}\n            onClose={() => {\n              defer(() => setVisible(false));\n            }}\n          />\n        </MenuList>\n      }\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MessageListFloatSlot } from '@coze-common/chat-area';\n\nimport { GrabMenu } from './grab-menu';\nimport { FloatMenu } from './float-menu';\n\nexport const MessageListFloat: MessageListFloatSlot = props => (\n  <>\n    <GrabMenu {...props} />\n    <FloatMenu {...props} />\n  </>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nconst quoteNodeColorVariants = cva([], {\n  variants: {\n    showBackground: {\n      true: ['text-[#FFFFFF/60]'],\n      false: ['coz-fg-secondary'],\n    },\n  },\n});\n\nexport const typeSafeQuoteNodeColorVariants: (\n  props: Required<VariantProps<typeof quoteNodeColorVariants>>,\n) => string = quoteNodeColorVariants;\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type FC } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  isGrabTextNode,\n  isGrabLink,\n  isGrabImage,\n} from '@coze-common/text-grab';\nimport { type GrabNode } from '@coze-common/text-grab';\nimport { useShowBackGround } from '@coze-common/chat-area';\nimport { Image, ImagePreview } from '@coze-arch/coze-design';\n\nimport { typeSafeQuoteNodeColorVariants } from '../variants';\nimport DefaultImage from '../../assets/image-default.png';\n\nimport styles from './index.module.less';\n\nconst getQuoteNode = ({\n  nodeList,\n  theme,\n  handleClickImage,\n  showBackground,\n}: {\n  nodeList: GrabNode[];\n  theme: 'white' | 'black';\n  handleClickImage: (url: string) => void;\n  showBackground: boolean;\n}): React.ReactNode =>\n  nodeList.map((node, index) => {\n    if (isGrabTextNode(node)) {\n      return (\n        <span\n          className={classNames('text-[14px] align-middle', 'leading-[16px]', {\n            'coz-fg-secondary': theme === 'black',\n            [typeSafeQuoteNodeColorVariants({ showBackground })]:\n              theme === 'white',\n          })}\n          key={index}\n        >\n          {node.text}\n        </span>\n      );\n    }\n\n    if (isGrabImage(node)) {\n      return (\n        <Image\n          className={classNames(\n            styles.image,\n            'w-[24px] h-[24px] leading-[24px] align-middle rounded-[4px] cursor-zoom-in',\n            {\n              'mx-[4px]': index !== 0,\n              'mr-[4px]': index === 0,\n            },\n          )}\n          src={node.src}\n          onClick={() => handleClickImage(node.src)}\n          key={index}\n          fallback={DefaultImage}\n          preview={false}\n        />\n      );\n    }\n\n    if (isGrabLink(node)) {\n      return (\n        <span\n          className={classNames('text-[14px] align-middle', 'leading-[16px]', {\n            'coz-fg-secondary': theme === 'black',\n            [typeSafeQuoteNodeColorVariants({ showBackground })]:\n              theme === 'white',\n          })}\n          key={index}\n        >\n          [\n          {getQuoteNode({\n            nodeList: node.children,\n            theme,\n            handleClickImage,\n            showBackground,\n          })}\n          ]\n        </span>\n      );\n    }\n\n    return null;\n  });\n\nexport const QuoteNode: FC<{\n  nodeList: GrabNode[];\n  theme: 'white' | 'black';\n}> = ({ nodeList, theme }) => {\n  const [previewUrl, setPreviewUrl] = useState('');\n  const showBackground = useShowBackGround();\n  const handleClickImage = (url: string) => {\n    setPreviewUrl(url);\n  };\n\n  return (\n    <>\n      <ImagePreview\n        src={previewUrl}\n        visible={Boolean(previewUrl)}\n        onVisibleChange={() => setPreviewUrl('')}\n      />\n      {getQuoteNode({\n        nodeList,\n        theme,\n        handleClickImage,\n        showBackground,\n      })}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentType, type Message } from '@coze-common/chat-area';\n\nexport const getReferFromMessage = (message: Message<ContentType>) => {\n  if (message.content_type === ContentType.Mix) {\n    const { refer_items } = JSON.parse(message.content) ?? {};\n\n    if (refer_items) {\n      const firstItem = refer_items?.[0];\n\n      if (firstItem?.type === 'text') {\n        return {\n          type: ContentType.Text,\n          text: firstItem?.text,\n        };\n      } else if (firstItem?.type === 'image') {\n        return {\n          type: ContentType.Image,\n          uri: firstItem?.image?.key,\n          url: firstItem?.image?.image_thumb?.url,\n        };\n      }\n    }\n  }\n  return undefined;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\nimport { useShowBackGround } from '@coze-common/chat-area';\nimport { IconCozQuotation } from '@coze-arch/coze-design/icons';\n\nimport { typeSafeQuoteNodeColorVariants } from '../variants';\n\nexport const QuoteTopUI: FC<PropsWithChildren> = ({ children }) => {\n  const showBackground = useShowBackGround();\n  return (\n    <div\n      className={classNames(\n        ['h-auto', 'py-4px'],\n        'flex flex-row items-center select-none w-m-0',\n      )}\n    >\n      <IconCozQuotation\n        className={classNames(\n          typeSafeQuoteNodeColorVariants({ showBackground }),\n          'mr-[8px] shrink-0 w-[12px] h-[12px]',\n        )}\n      />\n      <div\n        className={classNames('flex-1 min-w-0 truncate text-[12px]', [\n          'leading-[16px]',\n          typeSafeQuoteNodeColorVariants({ showBackground }),\n        ])}\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { parseMarkdownToGrabNode } from '@coze-common/text-grab';\nimport {\n  ContentType,\n  type CustomTextMessageInnerTopSlot,\n} from '@coze-common/chat-area';\n\nimport { QuoteNode } from '../quote-node';\nimport { getReferFromMessage } from '../../utils/get-refer-from-message';\nimport { QuoteTopUI } from './quote-top-ui';\n\nexport const RemoteQuoteInnerTopSlot: CustomTextMessageInnerTopSlot = ({\n  message,\n}) => {\n  // It was not sent locally with server level.\n  const refer = getReferFromMessage(message);\n\n  if (!refer) {\n    return null;\n  }\n\n  if (refer.type === ContentType.Image) {\n    return (\n      <QuoteTopUI>\n        <img className=\"w-[24px] h-[24px] rounded-[4px]\" src={refer.url} />\n      </QuoteTopUI>\n    );\n  }\n\n  // Try to parse ast.\n  const nodeList = parseMarkdownToGrabNode(refer.text);\n\n  return (\n    <QuoteTopUI>\n      <QuoteNode nodeList={nodeList} theme=\"white\" />\n    </QuoteTopUI>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  PluginName,\n  useWriteablePlugin,\n  type CustomTextMessageInnerTopSlot,\n} from '@coze-common/chat-area';\n\nimport { QuoteNode } from '../quote-node';\nimport { type GrabPluginBizContext } from '../../types/plugin-biz-context';\nimport { QuoteTopUI } from './quote-top-ui';\n\nexport const LocalQuoteInnerTopSlot: CustomTextMessageInnerTopSlot = ({\n  message,\n}) => {\n  const localMessageId = message.extra_info.local_message_id;\n\n  const plugin = useWriteablePlugin<GrabPluginBizContext>(\n    PluginName.MessageGrab,\n  );\n\n  const { useQuoteStore } = plugin.pluginBizContext.storeSet;\n\n  // Preference is given to locally mapped\n  const localNodeList = useQuoteStore(\n    useShallow(state => state.quoteContentMap[localMessageId]),\n  );\n\n  if (localNodeList) {\n    return (\n      <QuoteTopUI>\n        <QuoteNode nodeList={localNodeList} theme=\"white\" />\n      </QuoteTopUI>\n    );\n  }\n\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  PluginName,\n  useWriteablePlugin,\n  type CustomTextMessageInnerTopSlot,\n} from '@coze-common/chat-area';\n\nimport { type GrabPluginBizContext } from '../../types/plugin-biz-context';\nimport { RemoteQuoteInnerTopSlot } from './remote-slot';\nimport { LocalQuoteInnerTopSlot } from './local-slot';\n\nexport const QuoteMessageInnerTopSlot: CustomTextMessageInnerTopSlot = ({\n  message,\n}) => {\n  const localMessageId = message.extra_info.local_message_id;\n\n  const plugin = useWriteablePlugin<GrabPluginBizContext>(\n    PluginName.MessageGrab,\n  );\n\n  const { useQuoteStore } = plugin.pluginBizContext.storeSet;\n\n  // Preference is given to locally mapped\n  const hasLocal = useQuoteStore(\n    useShallow(state => !!state.quoteContentMap[localMessageId]),\n  );\n\n  if (hasLocal) {\n    return <LocalQuoteInnerTopSlot message={message} />;\n  }\n\n  return <RemoteQuoteInnerTopSlot message={message} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, type FC } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { PluginName, useWriteablePlugin } from '@coze-common/chat-area';\nimport { IconCozCross, IconCozQuotation } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { QuoteNode } from '../quote-node';\nimport { type GrabPluginBizContext } from '../../types/plugin-biz-context';\n\ntype IProps = Record<string, unknown>;\n\nexport const QuoteInputAddonTop: FC<IProps> = () => {\n  const { pluginBizContext, chatAreaPluginContext } =\n    useWriteablePlugin<GrabPluginBizContext>(PluginName.MessageGrab);\n\n  const { useChatInputLayout } = chatAreaPluginContext.readonlyHook.input;\n\n  const { useQuoteStore } = pluginBizContext.storeSet;\n\n  const { quoteVisible, quoteContent, updateQuoteVisible, updateQuoteContent } =\n    useQuoteStore(\n      useShallow(state => ({\n        quoteVisible: state.quoteVisible,\n        quoteContent: state.quoteContent,\n        updateQuoteVisible: state.updateQuoteVisible,\n        updateQuoteContent: state.updateQuoteContent,\n      })),\n    );\n\n  const handleClose = () => {\n    updateQuoteContent(null);\n    updateQuoteVisible(false);\n  };\n\n  const { layoutContainerRef } = useChatInputLayout();\n\n  useEffect(() => {\n    if (!layoutContainerRef?.current) {\n      return;\n    }\n\n    const handleStopPropagation = (e: PointerEvent) => e.stopPropagation();\n\n    layoutContainerRef.current.addEventListener(\n      'pointerup',\n      handleStopPropagation,\n    );\n\n    return () => {\n      layoutContainerRef.current?.removeEventListener(\n        'pointerup',\n        handleStopPropagation,\n      );\n    };\n  }, [layoutContainerRef?.current]);\n\n  if (!quoteContent || !quoteVisible) {\n    return null;\n  }\n\n  return (\n    <div className=\"w-full h-[32px] flex items-center px-[16px] coz-mg-primary\">\n      <IconCozQuotation className=\"coz-fg-secondary mr-[8px] w-[12px] h-[12px]\" />\n      <div className=\"flex flex-row items-center flex-1\">\n        <div className=\"coz-fg-secondary flex-1 min-w-0 w-0 truncate text-[12px] leading-[16px]\">\n          <QuoteNode nodeList={quoteContent} theme=\"black\" />\n        </div>\n        <IconButton\n          icon={<IconCozCross className=\"w-[14px] h-[14px]\" />}\n          onClick={handleClose}\n          color=\"secondary\"\n          size=\"small\"\n          className=\"!rounded-[4px]\"\n          wrapperClass=\"flex item-center justify-center\"\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PluginMode,\n  PluginName,\n  WriteableChatAreaPlugin,\n  createCustomComponents,\n} from '@coze-common/chat-area';\n\nimport { type GrabPublicMethod } from './types/public-methods';\nimport { type GrabPluginBizContext } from './types/plugin-biz-context';\nimport { GrabMessageLifeCycleService } from './services/life-cycle/message';\nimport { GrabCommandLifeCycleService } from './services/life-cycle/command';\nimport { GrabAppLifeCycleService } from './services/life-cycle/app';\nimport { MessageListFloat } from './custom-components/message-list-float-slot';\nimport { QuoteMessageInnerTopSlot } from './custom-components/message-inner-top-slot';\nimport { QuoteInputAddonTop } from './custom-components/input-addon-top';\n\nexport class ChatAreaGrabPlugin extends WriteableChatAreaPlugin<\n  GrabPluginBizContext,\n  GrabPublicMethod\n> {\n  public pluginMode = PluginMode.Writeable;\n  public pluginName = PluginName.MessageGrab;\n\n  public customComponents = createCustomComponents({\n    MessageListFloatSlot: MessageListFloat,\n    TextMessageInnerTopSlot: QuoteMessageInnerTopSlot,\n    InputAddonTop: QuoteInputAddonTop,\n  });\n\n  public lifeCycleServices = {\n    appLifeCycleService: new GrabAppLifeCycleService(this),\n    messageLifeCycleService: new GrabMessageLifeCycleService(this),\n    commandLifeCycleService: new GrabCommandLifeCycleService(this),\n  };\n\n  public publicMethods: GrabPublicMethod = {\n    updateEnableGrab: (enable: boolean) => {\n      if (!this.pluginBizContext) {\n        return;\n      }\n\n      const { updateEnableGrab } =\n        this.pluginBizContext.storeSet.usePreferenceStore.getState();\n\n      updateEnableGrab(enable);\n    },\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport mitt from 'mitt';\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport {\n  type EventCenter,\n  type GrabPluginBizContext,\n  type PublicEventCenter,\n  type EventCallbacks,\n} from './types/plugin-biz-context';\nimport { createSelectionStore } from './stores/selection';\nimport { createQuoteStore, subscribeQuoteUpdate } from './stores/quote';\nimport { createPreferenceStore } from './stores/preference';\nimport { ChatAreaGrabPlugin } from './plugin';\n\ninterface Preference {\n  enableGrab: boolean;\n}\n\nexport type Scene = 'store' | 'other';\n\ntype CreateGrabPluginParams = {\n  preference: Preference;\n  scene?: Scene;\n} & EventCallbacks;\n\nexport const publicEventCenter = mitt<PublicEventCenter>();\n\nexport const createGrabPlugin = (params: CreateGrabPluginParams) => {\n  const { preference, onQuote, onQuoteChange, scene } = params;\n\n  const grabPluginId = nanoid();\n\n  const grabPlugin: PluginRegistryEntry<GrabPluginBizContext> = {\n    createPluginBizContext: () => {\n      const eventCallbacks = {\n        onQuote,\n        onQuoteChange,\n      };\n\n      const storeSet = {\n        useSelectionStore: createSelectionStore('plugin'),\n        useQuoteStore: createQuoteStore('plugin'),\n        usePreferenceStore: createPreferenceStore('plugin'),\n      };\n\n      const eventCenter = mitt<EventCenter>();\n\n      // Default injection preference\n      storeSet.usePreferenceStore\n        .getState()\n        .updateEnableGrab(preference.enableGrab);\n\n      const unsubscribeQuoteStore = subscribeQuoteUpdate(\n        {\n          useQuoteStore: storeSet.useQuoteStore,\n        },\n        eventCallbacks,\n      );\n\n      const ctx = {\n        grabPluginId,\n        storeSet,\n        eventCallbacks,\n        unsubscribe: () => {\n          unsubscribeQuoteStore();\n        },\n        eventCenter,\n        publicEventCenter,\n        scene,\n      };\n\n      return ctx;\n    },\n    Plugin: ChatAreaGrabPlugin,\n  };\n\n  return { grabPlugin, grabPluginId };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useState } from 'react';\n\nimport { type MessageSource } from '@coze-common/chat-area';\n\nimport { type Scene, createGrabPlugin } from '../create';\n\ninterface Params {\n  onQuote?: ({\n    botId,\n    source,\n  }: {\n    botId: string;\n    source: MessageSource | undefined;\n  }) => void;\n  // At present, only the scene of the store needs to be distinguished.\n  scene?: Scene;\n}\nexport const useCreateGrabPlugin = (params?: Params) => {\n  const { onQuote, scene = 'other' } = params ?? {};\n  const [grabEnableUpload, setGrabEnableUpload] = useState(true);\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention -- matches the expected naming\n  const { grabPlugin: GrabPlugin, grabPluginId } = useMemo(\n    () =>\n      createGrabPlugin({\n        preference: {\n          enableGrab: true,\n        },\n        onQuote,\n        onQuoteChange: ({ isEmpty }) => {\n          setGrabEnableUpload(isEmpty);\n        },\n        scene,\n      }),\n    [],\n  );\n\n  return { grabEnableUpload, GrabPlugin, grabPluginId };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const enum GrabElementType {\n  IMAGE = 'image',\n  LINK = 'link',\n}\n\nexport interface GrabText {\n  text: string;\n}\n\nexport interface GrabElement {\n  children: GrabNode[];\n}\n\nexport interface GrabLinkElement extends GrabElement {\n  url: string;\n  type: GrabElementType.LINK;\n}\n\nexport interface GrabImageElement extends GrabElement {\n  src: string;\n  type: GrabElementType.IMAGE;\n}\n\nexport type GrabNode =\n  | GrabElement\n  | GrabLinkElement\n  | GrabImageElement\n  | GrabText;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type getOriginContentText } from '../utils/normalizer/get-origin-content-text';\nimport { type getNormalizeNodeList } from '../utils/normalizer/get-normalize-node-list';\nimport { type getHumanizedContentText } from '../utils/normalizer/get-humanize-content-text';\n\nexport interface SelectionData {\n  humanizedContentText: ReturnType<typeof getHumanizedContentText>;\n  originContentText: ReturnType<typeof getOriginContentText>;\n  normalizeSelectionNodeList: ReturnType<typeof getNormalizeNodeList>;\n  nodesAncestorIsMessageBox: boolean;\n  ancestorAttributeValue: string | null;\n  messageSource: number;\n  direction: Direction;\n}\n\nexport interface GrabPosition {\n  x: number;\n  y: number;\n}\n\nexport const enum Direction {\n  Forward = 'forward',\n  Backward = 'backward',\n  Unknown = 'unknown',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isTouchDevice(): boolean {\n  return 'ontouchend' in document;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const CONTENT_ATTRIBUTE_NAME = 'data-grab-mark';\n\nexport const MESSAGE_SOURCE_ATTRIBUTE_NAME = 'data-grab-source';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Helper function to obtain all nodes in the selection\nexport const getAllNodesInRange = (range: Range): Node[] => {\n  const nodes: Node[] = [];\n  const treeWalker = document.createTreeWalker(\n    range.commonAncestorContainer,\n    NodeFilter.SHOW_ALL,\n    {\n      acceptNode: node =>\n        range.intersectsNode(node)\n          ? NodeFilter.FILTER_ACCEPT\n          : NodeFilter.FILTER_REJECT,\n    },\n  );\n\n  // eslint-disable-next-line prefer-destructuring -- as expected, because the data is to be changed and allowed to be empty\n  let currentNode: Node | null = treeWalker.currentNode;\n\n  while (currentNode) {\n    nodes.push(currentNode);\n    currentNode = treeWalker.nextNode();\n  }\n\n  return nodes;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Find ancestor nodes (including itself) by TagName\n * @param node Node | null\n * @param tagName Target tagName\n * @returns Node | null\n */\nexport const findAncestorNodeByTagName = (\n  node: Node | null,\n  tagName: string,\n): Element | null => {\n  // Convert the tag signature to uppercase, as tag signatures in the DOM are usually uppercase\n  const upperTagName = tagName.toUpperCase();\n\n  // Traverse the node's ancestors until a matching tag is found or the root node is reached\n  while (node) {\n    // Make sure that the current node is an element node and that the tag signatures match\n    if (\n      node.nodeType === Node.ELEMENT_NODE &&\n      (node as Element).tagName === upperTagName\n    ) {\n      return node as Element;\n    }\n    // Move to Parent Node\n    node = node.parentNode;\n  }\n\n  // If no eligible ancestor is found, return null.\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const getAncestorAttributeValue = (\n  node: Node | null,\n  attributeName: string,\n): string | null => {\n  while (node && node !== document) {\n    let attributeValue = null;\n    if (node instanceof Element) {\n      attributeValue = node.attributes.getNamedItem(attributeName)?.value;\n    }\n\n    if (node.nodeType === Node.ELEMENT_NODE && attributeValue) {\n      return attributeValue;\n    }\n    node = node.parentNode;\n  }\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CONTENT_ATTRIBUTE_NAME } from '../constants/range';\nimport { getAllNodesInRange } from './helper/get-all-nodes-in-range';\nimport { findAncestorNodeByTagName } from './helper/find-ancestor-node-by-tag-name';\nimport { getAncestorAttributeValue } from './get-ancestor-attribute-value';\n\nexport const shouldRefineRange = (range: Range): boolean => {\n  // Get all nodes of the selection\n  const nodes = getAllNodesInRange(range);\n\n  let validNodeLength = 0;\n\n  let hasNodeInLink = false;\n\n  // Traverse all nodes to check if their ancestors have a specific class name attribute\n  for (const node of nodes) {\n    const attributeValue = getAncestorAttributeValue(\n      node,\n      CONTENT_ATTRIBUTE_NAME,\n    );\n\n    // If it doesn't exist, you need to overwrite hasNodeInLink and make sure to find a node in the link.\n    if (!hasNodeInLink) {\n      hasNodeInLink = Boolean(findAncestorNodeByTagName(node, 'A'));\n    }\n\n    if (attributeValue) {\n      validNodeLength++;\n    }\n  }\n\n  const { endOffset } = range;\n\n  return validNodeLength !== nodes.length || hasNodeInLink || endOffset === 0;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getAncestorAttributeValue } from '../get-ancestor-attribute-value';\n\n/**\n * Find the last sibling of a node\n * @param node find node\n * @returns\n */\nexport const findLastSiblingNode = ({\n  node,\n  scopeAncestorAttributeName,\n  targetAttributeValue,\n}: {\n  node: Node | null;\n  scopeAncestorAttributeName?: string;\n  targetAttributeValue?: string | null;\n}): Node | null => {\n  let lastValidSibling: Node | null = null;\n  while (node) {\n    if (\n      scopeAncestorAttributeName &&\n      getAncestorAttributeValue(node, scopeAncestorAttributeName) ===\n        targetAttributeValue\n    ) {\n      lastValidSibling = node;\n    }\n    node = node.nextSibling;\n  }\n  return lastValidSibling;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Find the last sub-node of a node\n * @param node Node\n * @returns Node\n */\nexport const findLastChildNode = (node: Node): Node => {\n  while (node.lastChild) {\n    node = node.lastChild;\n  }\n  return node;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Determine the node inclusion relationship\n * Reference document \"https://developer.mozilla.org/zh-CN/docs/Web/API/Node/compareDocumentPosition\"\n * @param nodeA\n * @param nodeB\n *\n */\nexport const compareNodePosition = (nodeA: Node, nodeB: Node) => {\n  const comparison = nodeA.compareDocumentPosition(nodeB);\n\n  // The reason why the condition is inverse to return, please refer to the official documentation, including the relationship showing the B-A relationship\n  if (comparison & Node.DOCUMENT_POSITION_CONTAINED_BY) {\n    return 'contains'; // NodeA contains nodeB\n  } else if (comparison & Node.DOCUMENT_POSITION_CONTAINS) {\n    return 'containedBy'; // NodeA is contained by nodeB\n  } else if (comparison & Node.DOCUMENT_POSITION_FOLLOWING) {\n    return 'before'; // nodeA before nodeB\n  } else if (comparison & Node.DOCUMENT_POSITION_PRECEDING) {\n    return 'after'; // NodeA after nodeB\n  }\n\n  return 'none'; // Nodes are the same or have no comparable relationship\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getAncestorAttributeValue } from '../get-ancestor-attribute-value';\n\nexport const fixStartNode = ({\n  range,\n  targetAttributeName,\n  targetAttributeValue,\n}: {\n  range: Range;\n  targetAttributeName: string;\n  targetAttributeValue: string;\n}) => {\n  let startNode: Node | null = range.startContainer;\n  let { startOffset } = range;\n\n  // Make sure the starting node meets the requirements\n  while (\n    startNode &&\n    !(\n      getAncestorAttributeValue(startNode, targetAttributeName) ===\n      targetAttributeValue\n    )\n  ) {\n    if (startNode.previousSibling) {\n      startNode = startNode.previousSibling;\n      startOffset = 0; // From the starting position of the previous sibling node\n    } else if (startNode.parentNode && startNode.parentNode !== document) {\n      startNode = startNode.parentNode;\n      startOffset = 0; // Start at the beginning of the parent node\n    } else {\n      // No eligible starting nodes\n      startNode = null;\n      break;\n    }\n  }\n\n  return {\n    startNode,\n    startOffset,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const findNearestAnchor = (\n  node: Node | null,\n): HTMLAnchorElement | null => {\n  // Traverse up from the current node\n  while (node) {\n    // If the current node is an element node and is a < a > tag\n    if (node.nodeType === Node.ELEMENT_NODE && node.nodeName === 'A') {\n      // Return this < a > tag\n      return node as HTMLAnchorElement;\n    }\n    // Move up to the parent node\n    node = node.parentNode;\n  }\n  // If the < a > tag is not found at the root node, return null.\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { findNearestAnchor } from '../helper/find-nearest-link-node';\n\nexport const fixLink = (range: Range, startNode: Node, endNode: Node) => {\n  const startAnchor = findNearestAnchor(startNode);\n  const endAnchor = findNearestAnchor(endNode);\n\n  let isFix = false;\n  // If the starting node is within the link, set the starting point of the selection to the start of the link\n  if (startAnchor) {\n    range.setStartBefore(startAnchor);\n    isFix = true;\n  }\n\n  // If the end node is within the link, set the end of the selection to the end of the link\n  if (endAnchor) {\n    range.setEndAfter(endAnchor);\n    isFix = true;\n  }\n\n  return isFix;\n};\n\n/**\n * 1. Link [A... text... link] to B\n * 2. Link A... text [word... link] to B\n * 3.... Text [word, chain] to B\n * 4. Chain [link] B\n */\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { findLastChildNode } from '../helper/find-last-child-node';\nimport { getAncestorAttributeValue } from '../get-ancestor-attribute-value';\n\nexport const fixEndNode = ({\n  range,\n  targetAttributeName,\n  targetAttributeValue,\n}: {\n  range: Range;\n  targetAttributeName: string;\n  targetAttributeValue: string;\n}) => {\n  let endNode: Node | null = range.endContainer;\n  let { endOffset } = range;\n\n  // Make sure the end node meets the conditions\n  while (\n    endNode &&\n    !(\n      getAncestorAttributeValue(endNode, targetAttributeName) ===\n      targetAttributeValue\n    )\n  ) {\n    if (endNode.nextSibling) {\n      endNode = endNode.nextSibling;\n      endOffset = 0; // Start from the starting position of the next sibling node\n    } else if (endNode.parentNode && endNode.parentNode !== document) {\n      endNode = endNode.parentNode;\n      endOffset = endNode\n        ? findLastChildNode(endNode).textContent?.length ?? 0\n        : 0; // Start from the last position of the parent node\n    } else {\n      // No eligible end nodes\n      endNode = null;\n      break;\n    }\n  }\n\n  return {\n    endNode,\n    endOffset,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Helper function to obtain all nodes in the selection\nexport const getAllChildNodesInNode = (node: Node): Node[] => {\n  const nodes: Node[] = [];\n  const treeWalker = document.createTreeWalker(node, NodeFilter.SHOW_ALL, {\n    acceptNode: _node =>\n      node.contains(_node)\n        ? NodeFilter.FILTER_ACCEPT\n        : NodeFilter.FILTER_REJECT,\n  });\n\n  // eslint-disable-next-line prefer-destructuring -- as expected, because the data is to be changed and allowed to be empty\n  let currentNode: Node | null = treeWalker.currentNode;\n\n  while (currentNode) {\n    nodes.push(currentNode);\n    currentNode = treeWalker.nextNode();\n  }\n\n  return nodes;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { compareNodePosition } from './compare-node-position';\n\nexport const findNotContainsPreviousSibling = (\n  node: Node | null,\n): Node | null => {\n  if (!node || node === document) {\n    return null;\n  }\n\n  let sibling: Node | null = node.previousSibling ?? node.parentNode;\n\n  while (sibling) {\n    if (sibling === document) {\n      return null;\n    }\n\n    // Get the relationship between two nodes\n    const relationship = compareNodePosition(sibling, node);\n\n    // If there is no containing relationship between the two nodes, the current sibling is returned\n    if (!['containedBy', 'contains'].includes(relationship)) {\n      return sibling;\n    }\n\n    if (!sibling.previousSibling) {\n      sibling = sibling.parentNode;\n    } else {\n      sibling = sibling.previousSibling;\n    }\n  }\n\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getAllChildNodesInNode } from '../helper/get-all-child-nodes-in-node';\nimport { findNotContainsPreviousSibling } from '../helper/find-not-contains-previous-sibling';\n\nexport const fixEndEmpty = ({\n  range,\n  startNode,\n  endNode,\n  endOffset,\n}: {\n  range: Range;\n  startNode: Node;\n  endNode: Node;\n  endOffset: number;\n}): boolean => {\n  // Check if it needs to be fixed: the end node and the start node are different and the end offset is 0\n  if (startNode === endNode || endOffset !== 0) {\n    return false; // No repair required.\n  }\n\n  // Initializes the current node to the previous sibling of the end node\n  let currentNode: Node | null = findNotContainsPreviousSibling(endNode);\n\n  // Find a valid non-unprecedented sibling node\n  while (currentNode) {\n    if (currentNode.nodeType === Node.TEXT_NODE) {\n      // If it is a text node, check if it is not empty\n      const textContent = currentNode.textContent?.trim();\n      if (textContent && currentNode.textContent?.length) {\n        // Not empty, fix the end of the selection\n        range.setEnd(currentNode, currentNode.textContent.length);\n        return true;\n      }\n    } else if (currentNode.nodeType === Node.ELEMENT_NODE) {\n      // If it is an element node, check if there is any visible content\n      const textContent = currentNode.textContent?.trim();\n      if (textContent) {\n        // With visible content, try to set the end position more precisely\n        // If there is a text node inside the element, try to navigate to the last text node\n        let lastTextNode: Node | null = null;\n\n        const allChildNodes = getAllChildNodesInNode(currentNode);\n\n        for (const child of allChildNodes) {\n          if (child.nodeType === Node.TEXT_NODE && child.textContent?.trim()) {\n            lastTextNode = child as Node;\n          }\n        }\n\n        if (lastTextNode && lastTextNode.textContent) {\n          range.setEnd(lastTextNode, lastTextNode.textContent.length);\n          return true;\n        }\n      }\n    }\n    // If the current node is empty or does not meet the conditions, continue to traverse forward/upward\n    currentNode = findNotContainsPreviousSibling(currentNode);\n  }\n\n  // If no suitable node is found after traversing all previous siblings, return false.\n  return false;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Fix the actual function of the selection\n * @param range Range\n */\nimport { findLastSiblingNode } from '../helper/find-last-sibling-node';\nimport { findLastChildNode } from '../helper/find-last-child-node';\nimport { findAncestorNodeByTagName } from '../helper/find-ancestor-node-by-tag-name';\nimport { compareNodePosition } from '../helper/compare-node-position';\nimport { getAncestorAttributeValue } from '../get-ancestor-attribute-value';\nimport { CONTENT_ATTRIBUTE_NAME } from '../../constants/range';\nimport { fixStartNode } from './fix-start-node';\nimport { fixLink } from './fix-link';\nimport { fixEndNode } from './fix-end-node';\nimport { fixEndEmpty } from './fix-end-empty';\n\n// eslint-disable-next-line complexity\nexport const refineRange = ({ range }: { range: Range }): boolean => {\n  // The initial algorithm only uses StartNode as the starting node of the selection\n  const targetAttributeValue = getAncestorAttributeValue(\n    range.startContainer,\n    CONTENT_ATTRIBUTE_NAME,\n  );\n\n  if (!targetAttributeValue) {\n    return false;\n  }\n\n  const { startNode, startOffset } = fixStartNode({\n    range,\n    targetAttributeName: CONTENT_ATTRIBUTE_NAME,\n    targetAttributeValue,\n  });\n\n  let { endNode, endOffset } = fixEndNode({\n    range,\n    targetAttributeName: CONTENT_ATTRIBUTE_NAME,\n    targetAttributeValue,\n  });\n\n  // If the start node is found, but the end node is not found, then continue to try to fix the selection using the last sibling of the start node\n  if (startNode && !endNode) {\n    const { parentNode } = startNode;\n    let lastSibling: Node | null = null;\n\n    // Try to find the nearest < li > or < a > tag\n    const liParentNode = findAncestorNodeByTagName(parentNode, 'LI');\n    const aParentNode = liParentNode\n      ? findAncestorNodeByTagName(liParentNode, 'A')\n      : findAncestorNodeByTagName(parentNode, 'A');\n    // Find the nearest < div > tag\n    const divParentNode = findAncestorNodeByTagName(parentNode, 'DIV');\n\n    // Determine how to find the last sibling based on the type of node found\n    if (aParentNode) {\n      // If < a > is found, use its parent node\n      lastSibling = findLastSiblingNode({\n        node: aParentNode,\n        scopeAncestorAttributeName: CONTENT_ATTRIBUTE_NAME,\n        targetAttributeValue,\n      });\n    } else if (liParentNode) {\n      // If a < li > is found, use its parent node\n      lastSibling = findLastSiblingNode({\n        node: liParentNode,\n        scopeAncestorAttributeName: CONTENT_ATTRIBUTE_NAME,\n        targetAttributeValue,\n      });\n    } else if (divParentNode) {\n      // If a < div > is found, use its parent node (e.g. in the case of a code block).\n      lastSibling = findLastSiblingNode({\n        node: divParentNode,\n        scopeAncestorAttributeName: CONTENT_ATTRIBUTE_NAME,\n        targetAttributeValue,\n      });\n    } else {\n      // Otherwise, use the starting node\n      lastSibling = findLastSiblingNode({\n        node: startNode,\n        scopeAncestorAttributeName: CONTENT_ATTRIBUTE_NAME,\n        targetAttributeValue,\n      });\n    }\n\n    // If the starting node is the same as the found sibling, then use the parent element of the actual node to find its last node\n    if (startNode === lastSibling) {\n      lastSibling = findLastSiblingNode({\n        node: parentNode,\n        scopeAncestorAttributeName: CONTENT_ATTRIBUTE_NAME,\n        targetAttributeValue,\n      });\n    }\n\n    if (lastSibling) {\n      endNode = lastSibling;\n      endOffset =\n        endNode.nodeType === Node.TEXT_NODE\n          ? (endNode as Text).length\n          : findLastChildNode(endNode).textContent?.length ?? 0;\n    }\n  }\n\n  // If both the start and end nodes are found, correct the selection\n  if (startNode && endNode) {\n    const relation = compareNodePosition(startNode, endNode);\n\n    let isFix = false;\n\n    if (['before', 'none'].includes(relation)) {\n      range.setStart(startNode, startOffset);\n      range.setEnd(endNode, endOffset);\n\n      isFix = true;\n    }\n\n    const isFixLink = fixLink(range, startNode, endNode);\n\n    const isFixEndEmpty = fixEndEmpty({ range, startNode, endNode, endOffset });\n\n    return isFix || isFixLink || isFixEndEmpty;\n  }\n\n  range.collapse(false);\n  return false;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GrabNode, type GrabText } from '../../types/node';\n\nexport const isGrabTextNode = (node: GrabNode): node is GrabText =>\n  node && 'text' in node;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  GrabElementType,\n  type GrabLinkElement,\n  type GrabNode,\n} from '../../types/node';\n\nexport const isGrabLink = (node: GrabNode): node is GrabLinkElement =>\n  node && 'url' in node && 'type' in node && node.type === GrabElementType.LINK;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  GrabElementType,\n  type GrabImageElement,\n  type GrabNode,\n} from '../../types/node';\n\nexport const isGrabImage = (node: GrabNode): node is GrabImageElement =>\n  node &&\n  'src' in node &&\n  'type' in node &&\n  node.type === GrabElementType.IMAGE;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Get formatted SelectionNodeList data\n * Get the text content fed to the large model\n */\nimport { type GrabNode } from '../../types/node';\nimport { isGrabTextNode } from './is-grab-text-node';\nimport { isGrabLink } from './is-grab-link';\nimport { isGrabImage } from './is-grab-image';\n\nexport const getOriginContentText = (normalizeNodeList: GrabNode[]) => {\n  let content = '';\n\n  for (const node of normalizeNodeList) {\n    if (isGrabTextNode(node)) {\n      content += node.text;\n    } else if (isGrabLink(node)) {\n      content += `[${getOriginContentText(node.children)}](${node.url})`;\n    } else if (isGrabImage(node)) {\n      content += `![${getOriginContentText(node.children)}](${node.src})`;\n    } else {\n      content += getOriginContentText(node.children);\n    }\n  }\n\n  return content;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Get URLs in image Node\n * @param node Node\n * @returns string\n */\nexport const getPictureNodeUrl = (node: Node) => {\n  if (!('src' in node) || !(typeof node.src === 'string')) {\n    return;\n  }\n\n  return node.src;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPictureNodeUrl } from './get-picture-node-url';\n\n/**\n * Get a valid node for the node whose TagName is Picture\n * @param childNodes NodeListOf < Node > sub-node list\n * @returns Node | null\n */\nexport const findPictureValidChildNode = (childNodes: NodeListOf<Node>) =>\n  Array.from(childNodes)\n    .filter(node => getPictureNodeUrl(node))\n    .at(0);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { findPictureValidChildNode } from '../find-picture-valid-child-node';\n\n/**\n * Processing special Node data\n * @param node Node\n * @returns node | undefined\n */\nexport const processSpecialNode = (node: Node) => {\n  // Special optimization for picture types\n  if (node.nodeName.toUpperCase() === 'PICTURE') {\n    const pictureNode = findPictureValidChildNode(node.childNodes);\n\n    if (pictureNode) {\n      return pictureNode;\n    }\n  }\n\n  // Special optimization for links\n  if (node.nodeName.toUpperCase() === 'A') {\n    return node;\n  }\n\n  // Special optimization for tables\n  if (['TH', 'TD'].includes(node.nodeName.toUpperCase())) {\n    return node;\n  }\n\n  return;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { processSpecialNode } from '../process-node/process-special-node';\nimport {\n  GrabElementType,\n  type GrabLinkElement,\n  type GrabImageElement,\n  type GrabNode,\n  type GrabText,\n} from '../../types/node';\n\n/**\n * Get formatted NodeList\n * @param childNodeList NodeListOf<Node>\n */\nexport const getNormalizeNodeList = (childNodeList: NodeListOf<Node>) => {\n  const normalizedNodeList: GrabNode[] = [];\n\n  if (!childNodeList.length) {\n    return normalizedNodeList;\n  }\n\n  for (const childNode of childNodeList) {\n    const specialNode = processSpecialNode(childNode);\n\n    if (specialNode) {\n      const grabNode = generateGrabNode(specialNode);\n\n      grabNode && normalizedNodeList.push(grabNode);\n      continue;\n    } else {\n      const grabNode = generateGrabNode(childNode);\n      grabNode && normalizedNodeList.push(grabNode);\n    }\n\n    const normalizedNodeListInLoop = getNormalizeNodeList(childNode.childNodes);\n    normalizedNodeList.push(...normalizedNodeListInLoop);\n  }\n\n  return normalizedNodeList;\n};\n\n/**\n * Generating Grab Nodes\n * @param node Node | null\n */\nexport const generateGrabNode = (node: Node | null) => {\n  if (!node) {\n    return null;\n  }\n\n  const isTable = ['TH', 'TD'].includes(node.nodeName.toUpperCase());\n\n  // text node\n  if (node.nodeType === node.TEXT_NODE || isTable) {\n    return generateGrabText(node, isTable);\n  }\n\n  // element node\n  if (node.nodeType === node.ELEMENT_NODE && node instanceof Element) {\n    return generateGrabElement(node);\n  }\n};\n\n/**\n * Generate Text Node\n * @param node Node | null\n */\nexport const generateGrabText = (node: Node | null, isTable?: boolean) => {\n  if (!node) {\n    return;\n  }\n\n  const safeTextContent = node.textContent ?? '';\n\n  const text = isTable ? ` ${safeTextContent} ` : safeTextContent;\n\n  const grabText: GrabText = {\n    text,\n  };\n\n  return grabText;\n};\n\n/**\n * Generating Element Node\n * @param node Element | null\n */\nexport const generateGrabElement = (node: Element | null) => {\n  if (!node) {\n    return;\n  }\n\n  if (['IMG', 'SOURCE'].includes(node.tagName.toUpperCase())) {\n    const grabText = generateGrabText(node);\n\n    const grabImageElement: GrabImageElement = {\n      type: GrabElementType.IMAGE,\n      src: 'src' in node && typeof node.src === 'string' ? node.src : '',\n      children: grabText ? [grabText] : [],\n    };\n\n    return grabImageElement;\n  }\n\n  if (node.tagName.toUpperCase() === 'A') {\n    const grabText = generateGrabText(node);\n    const grabLinkElement: GrabLinkElement = {\n      type: GrabElementType.LINK,\n      url: 'href' in node && typeof node.href === 'string' ? node.href : '',\n      children: grabText ? [grabText] : [],\n    };\n\n    return grabLinkElement;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GrabNode } from '../../types/node';\nimport { isGrabTextNode } from './is-grab-text-node';\nimport { isGrabLink } from './is-grab-link';\nimport { isGrabImage } from './is-grab-image';\n\n/**\n * Access to user-friendly text content\n */\nexport const getHumanizedContentText = (normalizeNodeList: GrabNode[]) => {\n  let content = '';\n\n  for (const node of normalizeNodeList) {\n    if (isGrabTextNode(node)) {\n      content += node.text;\n    } else if (isGrabLink(node)) {\n      content += `[${getHumanizedContentText(node.children)}]`;\n    } else if (isGrabImage(node)) {\n      content += `![${getHumanizedContentText(node.children)}]`;\n    } else {\n      content += getHumanizedContentText(node.children);\n    }\n  }\n\n  return content;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const hasVisibleSelection = (range: Range): boolean => {\n  // Clone all nodes within the Range\n  const documentFragment = range.cloneContents();\n  const textNodes: Text[] = [];\n\n  // Recursive function to collect all text nodes\n  function collectTextNodes(node: Node) {\n    if (node.nodeType === Node.TEXT_NODE) {\n      textNodes.push(node as Text);\n    } else {\n      node.childNodes.forEach(collectTextNodes);\n    }\n  }\n\n  // Collect text nodes from the root node of the document fragment\n  collectTextNodes(documentFragment);\n\n  // Check for non-blank text in the collected text nodes\n  return textNodes.some(textNode => /\\S/.test(textNode.textContent || ''));\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Direction } from '../../types/selection';\nimport { compareNodePosition } from './compare-node-position';\n\nexport const getSelectionDirection = (selection: Selection): Direction => {\n  // Make sure there are constituencies\n  if (!selection || selection.isCollapsed) {\n    return Direction.Unknown; // No constituencies or constituencies not expanded\n  }\n\n  const { anchorNode } = selection;\n  const { focusNode } = selection;\n\n  // Make sure that neither anchorNode nor focusNode is null\n  if (!anchorNode || !focusNode) {\n    return Direction.Unknown; // Unable to determine direction\n  }\n\n  const { anchorOffset } = selection;\n  const { focusOffset } = selection;\n  // Compare anchor and focus positions\n  if (anchorNode === focusNode) {\n    // If the anchor and focus are on the same node, determine the direction by the offset\n    return anchorOffset <= focusOffset ? Direction.Forward : Direction.Backward;\n  } else {\n    // If not in the same node, use Document Position to determine\n    const position = compareNodePosition(anchorNode, focusNode);\n\n    if (position === 'before') {\n      return Direction.Forward;\n    } else if (position === 'after') {\n      return Direction.Backward;\n    }\n  }\n\n  // If the direction cannot be determined, return'unknown'\n  return Direction.Unknown;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const getAncestorAttributeNode = (\n  node: Node | null,\n  attributeName: string,\n): Element | null => {\n  while (node && node !== document) {\n    let attributeValue = null;\n    if (node instanceof Element) {\n      attributeValue = node.attributes.getNamedItem(attributeName)?.value;\n\n      if (attributeValue) {\n        return node;\n      }\n    }\n\n    node = node.parentNode;\n  }\n  return null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SelectionData } from '../types/selection';\nimport {\n  CONTENT_ATTRIBUTE_NAME,\n  MESSAGE_SOURCE_ATTRIBUTE_NAME,\n} from '../constants/range';\nimport { shouldRefineRange } from './should-refine-range';\nimport { refineRange } from './refine-range/refine-range';\nimport { getOriginContentText } from './normalizer/get-origin-content-text';\nimport { getNormalizeNodeList } from './normalizer/get-normalize-node-list';\nimport { getHumanizedContentText } from './normalizer/get-humanize-content-text';\nimport { hasVisibleSelection } from './helper/is-range-collapsed';\nimport { getSelectionDirection } from './helper/get-selection-direction';\nimport { getAncestorAttributeNode } from './get-ancestor-attribute-node';\n\nexport const getSelectionData = ({\n  selection,\n  hasFix,\n}: {\n  selection: Selection;\n  hasFix?: boolean;\n}): SelectionData | undefined => {\n  if (!selection.rangeCount) {\n    return;\n  }\n\n  const range = selection.getRangeAt(0);\n\n  if (!range) {\n    return;\n  }\n\n  const documentFragment = range.cloneContents();\n\n  const direction = getSelectionDirection(selection);\n\n  /**\n   * Determine whether it is an element that can be selected by getting a specific identifier\n   */\n  const ancestorNodeWithAttribute = getAncestorAttributeNode(\n    range.commonAncestorContainer.parentNode,\n    CONTENT_ATTRIBUTE_NAME,\n  );\n\n  // specific logo\n  const ancestorAttributeValue =\n    ancestorNodeWithAttribute?.attributes.getNamedItem(CONTENT_ATTRIBUTE_NAME)\n      ?.value ?? null;\n\n  // source of information\n  const messageSource = ancestorNodeWithAttribute?.attributes.getNamedItem(\n    MESSAGE_SOURCE_ATTRIBUTE_NAME,\n  )?.value;\n\n  if (!hasFix) {\n    // Try to fix the selection\n    const needFix = shouldRefineRange(range);\n\n    // If repaired, retrieve the execution and return\n    if (needFix) {\n      const isFix = refineRange({ range });\n\n      if (!isFix) {\n        return;\n      }\n\n      return getSelectionData({\n        selection,\n        hasFix: true,\n      });\n    }\n  }\n\n  const hasVisibleSelectionResult = hasVisibleSelection(range);\n\n  if (!hasVisibleSelectionResult) {\n    return;\n  }\n\n  // Formatted Selection NodeList\n  const normalizeSelectionNodeList = getNormalizeNodeList(\n    documentFragment.childNodes,\n  );\n\n  if (!normalizeSelectionNodeList.length) {\n    return;\n  }\n\n  // user-friendly text content\n  const humanizedContentText = getHumanizedContentText(\n    normalizeSelectionNodeList,\n  );\n\n  // raw text content\n  const originContentText = getOriginContentText(normalizeSelectionNodeList);\n\n  // If the repair selection is successful, then their components\n\n  return {\n    humanizedContentText,\n    originContentText,\n    normalizeSelectionNodeList,\n    nodesAncestorIsMessageBox: Boolean(ancestorAttributeValue),\n    ancestorAttributeValue,\n    messageSource: Number(messageSource),\n    direction,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const getRectData = ({ selection }: { selection: Selection }) => {\n  if (!selection.rangeCount) {\n    return;\n  }\n\n  const range = selection.getRangeAt(0);\n\n  if (!range) {\n    return;\n  }\n\n  const rangeRects = range.getClientRects();\n\n  return {\n    rangeRects,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState, type MutableRefObject } from 'react';\n\nimport { defer } from 'lodash-es';\nimport { useEventCallback } from '@coze-common/chat-hooks';\n\nimport { isTouchDevice } from '../utils/is-touch-device';\nimport { getSelectionData } from '../utils/get-selection-data';\nimport { getRectData } from '../utils/get-rect-data';\nimport {\n  Direction,\n  type GrabPosition,\n  type SelectionData,\n} from '../types/selection';\n\nconst MAX_WIDTH = 40;\nconst TIMEOUT = 100;\n\ninterface GrabParams {\n  /**\n   * Select the Ref of the target container\n   */\n  contentRef: MutableRefObject<HTMLDivElement | null>;\n  /**\n   * Floating Menu Ref\n   */\n  floatMenuRef: MutableRefObject<HTMLDivElement | null> | undefined;\n  /**\n   * Select the callback for the event\n   */\n  onSelectChange: (selectionData: SelectionData | null) => void;\n  /**\n   * Callback of location information\n   */\n  onPositionChange: (position: GrabPosition | null) => void;\n  /**\n   * Resize/Scroll/Wheel is the time of throttling\n   */\n  resizeThrottleTime?: number;\n}\n\n// eslint-disable-next-line @coze-arch/max-line-per-function, max-lines-per-function\nexport const useGrab = ({\n  contentRef,\n  floatMenuRef,\n  onSelectChange,\n  onPositionChange,\n}: GrabParams) => {\n  const timeoutRef = useRef<number>();\n\n  /**\n   * Selection object storage (for internal flow state of hooks)\n   */\n  const selection = useRef<Selection | null>(null);\n\n  /**\n   * Data on the final calculation result of the constituency\n   */\n  const selectionData = useRef<SelectionData | null>(null);\n\n  /**\n   * In Scrolling\n   */\n  const [isScrolling, setIsScrolling] = useState(false);\n\n  /**\n   * Scrolling timer\n   */\n  const scrollingTimer = useRef<number | null>(null);\n\n  /**\n   * Is there SelectionData (for optimizing mount logic)\n   */\n  const hasSelectionData = useRef(false);\n\n  /**\n   * Clear internal data + trigger callback\n   */\n  const clearSelection = () => {\n    onSelectChange(null);\n    onPositionChange(null);\n    selection.current?.removeAllRanges();\n    selection.current = null;\n    setIsScrolling(false);\n    hasSelectionData.current = false;\n    if (scrollingTimer.current) {\n      clearTimeout(scrollingTimer.current);\n    }\n  };\n\n  /**\n   * Handle screen changes Scroll + Resize + Wheel + SelectionChange (mobile device)\n   */\n  const handleScreenChange = () => {\n    // Get Constituency\n    const innerSelection = window.getSelection();\n\n    const { direction = Direction.Unknown } = selectionData.current ?? {};\n\n    // If the selection is empty, return\n    if (!innerSelection) {\n      onSelectChange(null);\n      return;\n    }\n\n    const rectData = getRectData({ selection: innerSelection });\n\n    if (!rectData) {\n      onPositionChange(null);\n      return;\n    }\n\n    // Default use to get the location information of the last line of the selection (both Forward cases)\n    const rangeRect = Array.from(rectData.rangeRects).at(\n      direction === Direction.Backward ? 0 : -1,\n    );\n\n    // Returns if the last line of selection information is incorrect\n    if (!rangeRect) {\n      onPositionChange(null);\n      return;\n    }\n\n    let [x, y] = [0, 0];\n    // If the selection is selected from front to back, it is displayed at the end of the last line, otherwise it is displayed at the beginning\n    if (direction === Direction.Backward) {\n      x = rangeRect.left;\n      y = rangeRect.top + rangeRect.height;\n    } else {\n      x = rangeRect.x + rangeRect.width;\n      y = rangeRect.y + rangeRect.height;\n    }\n\n    /**\n     * Added a logic to avoid the screen\n     */\n    const position = {\n      x: x > screen.width - MAX_WIDTH ? x - MAX_WIDTH : x,\n      y:\n        y > screen.height - MAX_WIDTH\n          ? y - MAX_WIDTH\n          : rangeRect.y + rangeRect.height,\n    };\n\n    onPositionChange(position);\n  };\n\n  /**\n   * Smart processing screen changes, there is a timer + scroll notification logic\n   */\n  const handleSmartScreenChange = useEventCallback(() => {\n    if (scrollingTimer.current) {\n      clearTimeout(scrollingTimer.current);\n    }\n\n    setIsScrolling(true);\n    scrollingTimer.current = setTimeout(() => {\n      handleScreenChange();\n      setIsScrolling(false);\n    }, TIMEOUT);\n  });\n\n  /**\n   * Handling the logic of getting the selection\n   */\n  const handleGetSelection = () => {\n    if (!contentRef.current) {\n      onSelectChange(null);\n      return;\n    }\n\n    // Get Constituency\n    // eslint-disable-next-line @typescript-eslint/naming-convention -- internal variable\n    const _selection = window.getSelection();\n\n    // If the selection is empty, return\n    if (!_selection) {\n      onSelectChange(null);\n      return;\n    }\n\n    selection.current = _selection;\n\n    // Get constituency data\n    // eslint-disable-next-line @typescript-eslint/naming-convention -- internal variable\n    const _selectionData = getSelectionData({\n      selection: _selection,\n    });\n\n    // Hide Floating Button if selection is empty\n    if (!_selectionData || !_selectionData.nodesAncestorIsMessageBox) {\n      onSelectChange(null);\n      return;\n    }\n\n    // Set display and location information\n    selectionData.current = _selectionData;\n    hasSelectionData.current = Boolean(_selectionData);\n\n    handleScreenChange();\n    onSelectChange(_selectionData);\n  };\n\n  /**\n   * The action of raising the mouse\n   */\n  const handleMouseUp = useEventCallback(() => {\n    clearTimeout(timeoutRef.current);\n    timeoutRef.current = defer(handleGetSelection);\n  });\n\n  /**\n   * The action of keyboard pressing\n   */\n  const handleKeyDown = useEventCallback((e: KeyboardEvent) => {\n    const forbiddenKeyboardSelect = () => {\n      if ((e.ctrlKey || e.metaKey) && e.key === 'a') {\n        onSelectChange(null);\n      }\n    };\n\n    if (selectionData.current) {\n      forbiddenKeyboardSelect();\n\n      if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\n        handleGetSelection();\n      }\n    }\n  });\n\n  /**\n   * Mouse press.\n   */\n  const handleMouseDown = useEventCallback((e: MouseEvent) => {\n    // Check if there is a constituency, and the target of the click event is not in the constituency\n\n    if (!contentRef.current || !floatMenuRef || !floatMenuRef?.current) {\n      return;\n    }\n\n    const { clientX, clientY } = e;\n\n    const floatMenuRect = floatMenuRef.current.getBoundingClientRect();\n\n    const isInFloatMenu =\n      clientY >= floatMenuRect.top &&\n      clientY <= floatMenuRect.bottom &&\n      clientX >= floatMenuRect.left &&\n      clientX <= floatMenuRect.right;\n\n    if (isInFloatMenu) {\n      return;\n    }\n\n    clearSelection();\n  });\n\n  useEffect(() => {\n    if (!hasSelectionData.current) {\n      return;\n    }\n\n    // Listen for mouse down events\n    window.addEventListener('mousedown', handleMouseDown);\n\n    return () => {\n      window.removeEventListener('mousedown', handleMouseDown);\n    };\n  }, [hasSelectionData.current]);\n\n  // When visible, mount the listening event to optimize listening\n  useEffect(() => {\n    if (!hasSelectionData.current) {\n      return;\n    }\n\n    window.addEventListener('resize', handleSmartScreenChange);\n    window.addEventListener('wheel', handleSmartScreenChange);\n    window.addEventListener('scroll', handleSmartScreenChange);\n    window.addEventListener('keydown', handleKeyDown);\n\n    if (isTouchDevice()) {\n      window.addEventListener('selectionchange', handleSmartScreenChange);\n    }\n\n    return () => {\n      window.removeEventListener('resize', handleSmartScreenChange);\n      window.removeEventListener('wheel', handleSmartScreenChange);\n      window.removeEventListener('scroll', handleSmartScreenChange);\n      window.removeEventListener('keydown', handleKeyDown);\n      window.removeEventListener('selectionchange', handleSmartScreenChange);\n    };\n  }, [hasSelectionData.current]);\n\n  // mount monitor on target\n  useEffect(() => {\n    const target = contentRef.current;\n\n    if (!target) {\n      return;\n    }\n\n    // Monitor selection-related mouse lift events\n    target.addEventListener('pointerup', handleMouseUp);\n\n    if (isTouchDevice()) {\n      target.addEventListener('selectionchange', handleMouseUp);\n    }\n\n    return () => {\n      target.removeEventListener('pointerup', handleMouseUp);\n      target.removeEventListener('selectionchange', handleMouseUp);\n    };\n  }, [contentRef.current]);\n\n  return {\n    /**\n     * Clear built-in state and selection\n     */\n    clearSelection,\n    /**\n     * Is it scrolling?\n     */\n    isScrolling,\n    /**\n     * Recalculate the selection position\n     */\n    computePosition: handleSmartScreenChange,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { parseMarkdownHelper } from '@coze-common/chat-area-utils';\nimport { parseMarkdown } from '@coze-arch/bot-md-box-adapter/lazy';\n\nimport { GrabElementType, type GrabNode } from '../types/node';\n\nconst { isImage, isLink, isParent, isText } = parseMarkdownHelper;\n\n/**\n * Get a GrabNode node\n * @param markdown string\n * @returns GrabNode[]\n */\nexport const parseMarkdownToGrabNode = (markdown: string) => {\n  const ast = parseMarkdown(markdown);\n\n  return getGrabNodeFromAst(ast);\n};\n\n/**\n * Parsing from Markdown's AST to a GrabNode node\n * @param ast markdown ast by parseMarkdown (md-box)\n * @returns GrabNode[]\n */\nexport const getGrabNodeFromAst = (ast: unknown): GrabNode[] => {\n  const normalizedNodeList: GrabNode[] = [];\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- as expected\n  const traverseAst = (_ast: any) => {\n    if (isText(_ast)) {\n      normalizedNodeList.push({\n        text: _ast.value,\n      });\n    } else if (isLink(_ast)) {\n      const children = _ast.children.map(getGrabNodeFromAst).flat(1);\n      normalizedNodeList.push({\n        type: GrabElementType.LINK,\n        url: _ast.url,\n        children,\n      });\n    } else if (isImage(_ast)) {\n      normalizedNodeList.push({\n        type: GrabElementType.IMAGE,\n        src: _ast.url,\n        children: [\n          {\n            text: _ast.alt ?? '',\n          },\n        ],\n      });\n    } else if (isParent(_ast)) {\n      _ast.children.forEach(traverseAst);\n    }\n  };\n\n  traverseAst(ast);\n\n  return normalizedNodeList;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { DndProvider as Provider } from 'react-dnd';\nimport { type ReactNode, createContext, useContext } from 'react';\nconst DnDContext = createContext<{\n  isInProvider: boolean;\n}>({\n  isInProvider: false,\n});\nexport const DndProvider = ({ children }: { children: ReactNode }) => {\n  const context = useContext(DnDContext);\n  return (\n    <DnDContext.Provider\n      value={{\n        isInProvider: true,\n      }}\n    >\n      {context.isInProvider ? (\n        children\n      ) : (\n        <Provider backend={HTML5Backend} context={window}>\n          {children}\n        </Provider>\n      )}\n    </DnDContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useDrag, useDrop } from 'react-dnd';\nimport { useMemo, useRef, type RefObject } from 'react';\n\nexport type OnMove<TId = string | number> = (\n  souceId: TId,\n  targetId: TId,\n  isBefore: boolean,\n) => void; // Since there is no order information, it is necessary to specify whether it is before or after\nexport interface UseDndSortableParams<TId = string | number> {\n  id: TId;\n  type: symbol;\n  onMove: OnMove<TId>;\n  enabled?: boolean;\n  direction?: 'horizontal' | 'verticle';\n}\n\nexport type ConnectDnd = (\n  ref: RefObject<HTMLElement>,\n  handleRef?: RefObject<HTMLElement>,\n) => void;\n\nexport const useDnDSortableItem = <TId = string | number>({\n  id,\n  type,\n  direction = 'verticle',\n  enabled = true,\n  onMove,\n}: UseDndSortableParams<TId>) => {\n  const itemDomRef = useRef<HTMLElement | null>();\n  const enabledRef = useRef<boolean>(enabled);\n  enabledRef.current = enabled;\n  const [{ isHovered }, drop] = useDrop<\n    { id: TId },\n    undefined,\n    {\n      isHovered: boolean;\n    }\n  >({\n    accept: type,\n    collect: monitor => ({\n      isHovered: monitor.isOver(),\n    }),\n    canDrop: () => enabledRef.current,\n    hover: (item, monitor) => {\n      if (!itemDomRef.current || item.id === id) {\n        return;\n      }\n      // The X Y coordinates of the currently dragged element\n      const draggingClient = monitor.getClientOffset();\n      const dropTargetClient = itemDomRef.current?.getBoundingClientRect();\n      let isBefore = false;\n      if (direction === 'verticle') {\n        if (draggingClient?.y === undefined) {\n          return;\n        }\n        const middle = (dropTargetClient.top + dropTargetClient.bottom) / 2;\n        isBefore = draggingClient?.y < middle;\n        onMove(item.id, id, isBefore);\n      }\n      if (direction === 'horizontal') {\n        if (draggingClient?.x === undefined) {\n          return;\n        }\n        const middle = (dropTargetClient.left + dropTargetClient.right) / 2;\n        isBefore = draggingClient?.x < middle;\n        onMove(item.id, id, isBefore);\n      }\n    },\n  });\n  const [{ isDragging }, drag, preview] = useDrag({\n    type,\n    item: () => ({ id }),\n    canDrag: () => enabledRef.current,\n    collect: monitor => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n  const connect = useMemo<ConnectDnd>(\n    () => (ref, handleRef) => {\n      drop(ref);\n      drag(handleRef ?? ref);\n      preview(ref);\n      itemDomRef.current = ref.current;\n    },\n    [drop, drag],\n  );\n  return {\n    isHovered,\n    isDragging,\n    connect,\n  } as const;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type ReactElement } from 'react';\n\nimport { DndProvider } from '../dnd-provider';\nimport {\n  type ConnectDnd,\n  useDnDSortableItem,\n  type UseDndSortableParams,\n} from './hooks';\n\nexport interface ITemRenderProps<TData> {\n  data: TData;\n  connect: ConnectDnd;\n  isHovered?: boolean;\n  isDragging?: boolean;\n}\n\nexport type TItemRender<TData> = FC<ITemRenderProps<TData>>;\n\nconst ItemWrapper = <TData extends object>({\n  id,\n  type,\n  data,\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  itemRender: ItemRender,\n  enabled,\n  onMove,\n  direction,\n}: {\n  data: TData;\n  itemRender: TItemRender<TData>;\n} & UseDndSortableParams) => {\n  const dndSortableProps = useDnDSortableItem({\n    id,\n    type,\n    onMove,\n    enabled,\n    direction,\n  });\n  return <ItemRender {...dndSortableProps} data={data} />;\n};\n\nexport interface SortableListProps<TData>\n  extends Omit<UseDndSortableParams, 'id' | 'onMove'> {\n  list: TData[];\n  getId?: (data: TData) => string | number;\n  onChange: (list: TData[]) => void;\n  itemRender: TItemRender<TData>;\n}\n\nconst defaultGetId = <TData extends { id: string }>(data: TData) => data.id;\n\nexport const SortableList = <TData extends object>({\n  list,\n  type,\n  getId = defaultGetId as NonNullable<SortableListProps<TData>['getId']>,\n  onChange,\n  enabled,\n  itemRender,\n  direction,\n}: SortableListProps<TData>): ReactElement => (\n  <DndProvider>\n    {list.map(item => {\n      const id = getId(item);\n      return (\n        <ItemWrapper<TData>\n          key={id}\n          type={type}\n          id={id}\n          data={item}\n          itemRender={itemRender}\n          enabled={enabled}\n          direction={direction}\n          /**\n           * Raw array [1, 2, target, 4, 5, source, 7, 8]\n           * before = true  j==> [1,2, source, target, 4, 5, 7, 8]\n           * before = false ==> [1,2, target, source, 4, 5, 7, 8]\n           **/\n          onMove={(sourceId, targetId, before) => {\n            const newList = [...list];\n            const sourceIndex = newList.findIndex(\n              source => getId(source) === sourceId,\n            );\n            const sourceItem = newList.splice(sourceIndex, 1)[0];\n            const targetIndex =\n              newList.findIndex(target => getId(target) === targetId) +\n              (before ? 0 : 1);\n            if (sourceIndex === targetIndex) {\n              // Do not trigger onChange if the index is the same before and after to avoid frequent rerender\n              return;\n            }\n            sourceItem && newList.splice(targetIndex, 0, sourceItem);\n            onChange(newList);\n          }}\n        />\n      );\n    })}\n  </DndProvider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { type OpenApiSource } from '@/types/open';\nimport type { Language } from '@/types/i18n';\n\nimport { type OpenUserInfo } from './user';\nexport enum Layout {\n  PC = 'pc',\n  MOBILE = 'mobile',\n}\n\nexport interface FeedbackTag {\n  label: string;\n  isNeedDetail?: boolean;\n}\n\nexport interface FeedbackConfig {\n  isNeedFeedback?: boolean; // false\n  feedbackPanel?: {\n    title?: string;\n    placeholder?: string;\n    tags?: FeedbackTag[];\n  };\n}\ninterface BaseUiProps {\n  icon?: string; // urllogo\n  layout?: Layout;\n  lang?: Language;\n  zIndex?: number;\n}\nexport interface HeaderConfig {\n  isShow?: boolean; //header true\n  isNeedClose?: boolean; // true\n  extra?: ReactNode | false; // \n}\n\nexport interface ConversationsConfig {\n  isNeed?: boolean; //  false\n}\ninterface ChatBotUiProps {\n  title?: string;\n  uploadable?: boolean;\n  isNeedClearContext?: boolean; //  true\n  isNeedClearMessage?: boolean; //true\n  isNeedAddNewConversation?: boolean; // \n  isNeedAudio?: boolean; // true\n  isNeedFunctionCallMessage?: boolean; //true\n  isNeedQuote?: boolean; //  false\n  isNeedConversationAdd?: boolean; //  false\n  feedback?: FeedbackConfig; //\n  // chat\n  width?: number;\n  el?: HTMLElement;\n  onHide?: () => void; // chat\n  onShow?: () => void; // chat\n  onBeforeShow?: () => Promise<boolean> | boolean; //  false\n  onBeforeHide?: () => Promise<boolean> | boolean; //  false\n}\nexport enum ChatType {\n  BOT = 'bot',\n  APP = 'app',\n}\nexport interface AppInfo {\n  appId: string;\n  workflowId: string;\n  conversationName?: string;\n  parameters?: Record<string, unknown>;\n  version?: string;\n}\nexport interface BotInfo {\n  botId?: string;\n  parameters?: Record<string, unknown>;\n}\n//\nexport interface FooterConfig {\n  isShow?: boolean; //\n  expressionText?: string; //  {{name}}\n  linkvars?: Record<\n    string,\n    {\n      text: string;\n      link: string;\n    }\n  >;\n}\nexport interface CozeChatConfig {\n  type?: ChatType; // bot\n  bot_id?: string;\n  appInfo?: AppInfo;\n  botInfo?: BotInfo;\n  source: OpenApiSource;\n  extra?: {\n    webChat: Record<string, string>;\n  };\n  auth?: AuthProps;\n  ui?: {\n    base?: Pick<BaseUiProps, 'icon' | 'lang' | 'layout'>;\n    chatBot?: Pick<\n      ChatBotUiProps,\n      | 'title'\n      | 'uploadable'\n      | 'isNeedClearContext'\n      | 'isNeedClearMessage'\n      | 'isNeedAddNewConversation'\n      | 'isNeedAudio'\n      | 'isNeedFunctionCallMessage'\n      | 'isNeedQuote'\n      | 'feedback'\n    >;\n    footer?: FooterConfig;\n    header?: HeaderConfig;\n    conversations?: ConversationsConfig;\n  };\n  // open SDk\n  conversation_id: string;\n}\n\ninterface ChatComponentProps {\n  layout: Layout;\n  lang: Language;\n  title: string;\n  icon: string;\n  zIndex: number;\n  uploadable: boolean;\n  width: number;\n}\n\n/** @deprecated  */\nexport type ComponentProps = Partial<ChatComponentProps>;\n\n/**  */\nexport enum AuthType {\n  UNAUTH = 'unauth', // \n  TOKEN = 'token', // token\n}\n\nexport interface AuthProps {\n  type?: AuthType;\n  /*\n   * type == refresh_token, tokenrefreshToken\n   */\n  token?: string; // token\n  /*\n   * type == TOKEN_BY_FUNC, tokentokentoken\n   */\n  onRefreshToken?: (token?: string) => Promise<string> | string;\n  connectorId?: string;\n}\n\nexport interface UiProps {\n  base?: BaseUiProps;\n  asstBtn?: {\n    isNeed?: boolean; // true\n  };\n  chatBot?: ChatBotUiProps;\n  footer?: FooterConfig;\n  header?: HeaderConfig;\n  conversations?: ConversationsConfig;\n}\n\nexport enum IframeMessageEvent {\n  GET_IFRAME_PARAMS = 'GET_IFRAME_PARAMS',\n  GET_NEW_TOKEN = 'GET_NEW_TOKEN',\n  THEME_CHANGE = 'THEME_CHANGE',\n}\n\n// \nexport interface IframeParams {\n  // \n  // iframe  =>    message \n  chatClientId: string;\n  chatConfig: CozeChatConfig;\n  userInfo?: OpenUserInfo;\n}\n\nexport enum WebSdkError {\n  // \n  TIMEOUT = -1,\n  // \n  UNKNOWN = -2,\n  // \n  FORBIDDEN = -3,\n\n  // \n  SUCCESS = 0,\n\n  // \n  AUTH_FAILED = 100001,\n  // token\n  AUTH_TOKEN_GET_FAILED = 100002,\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\n// \nexport enum SDKErrorCode {\n  Base = 1000,\n  OpenApiUpload = 1001,\n  NoClearAPI = 1002,\n  StoreProvider = 1003,\n  Iframe = 2000,\n  IframeParams = 2001,\n  Core = 3000,\n  NotError = 4000,\n}\n\nexport class ChatSdkError extends Error {\n  sdkCode: SDKErrorCode;\n\n  constructor(options: { sdkCode: SDKErrorCode } | SDKErrorCode) {\n    super();\n    if (typeof options === 'number') {\n      this.sdkCode = options;\n    } else {\n      this.sdkCode = options.sdkCode;\n    }\n  }\n\n  static wrap(err: Error, code = SDKErrorCode.Base) {\n    const newErr = new ChatSdkError({ sdkCode: code });\n    newErr.message = err.message;\n    newErr.name = err.name;\n    newErr.cause = err.cause;\n    newErr.stack = err.stack;\n\n    return newErr;\n  }\n\n  static create(sdkCode: SDKErrorCode) {\n    return new ChatSdkError({ sdkCode });\n  }\n}\n\nexport interface SDKInitError {\n  code: number;\n  msg: string;\n}\n\nexport enum ServerErrorCode {\n  BotUnbind = 702242003,\n}\n\nexport const specCodeList: number[] = [ServerErrorCode.BotUnbind];\n\nexport const getServerError = (\n  error: SDKInitError,\n): SDKInitError | undefined => {\n  const code = error?.code;\n\n  switch (code) {\n    case ServerErrorCode.BotUnbind:\n      return {\n        code,\n        msg: I18n.t('unbind_notification'),\n      };\n    default:\n  }\n};\n\n// coze api\nexport enum OpenApiError {\n  ERROR_FORBIDDEN = 401,\n  ERROR_INVALID_TOKEN = 4100,\n  ERROR_TOKEN_FORBIDDEN = 4101,\n  ERROR_TOKEN_FAILED = 700012006,\n  BOT_NOT_PUBLISH = 4015,\n}\n\nexport const isAuthError = (errorCode: number) =>\n  [\n    OpenApiError.ERROR_FORBIDDEN,\n    OpenApiError.ERROR_INVALID_TOKEN,\n    OpenApiError.ERROR_TOKEN_FORBIDDEN,\n    OpenApiError.ERROR_TOKEN_FAILED,\n  ].includes(errorCode);\n\nexport enum ChatSdkErrorType {\n  /** botId  */\n  INVALID_BOT_ID = 'INVALID_BOT_ID',\n  /** OpenAPI  */\n  OPEN_API_ERROR = 'OPEN_API_ERROR',\n}\nexport interface ChatSDKErrorData {\n  type: ChatSdkErrorType;\n  code?: number;\n  message?: string;\n}\n\nexport const postErrorMessage = (data: ChatSDKErrorData) => {\n  window.parent.postMessage(\n    {\n      type: 'chat-sdk-error',\n      data,\n    },\n    '*',\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum OpenApiSource {\n  WebSdk = 'web_sdk',\n  ChatFlow = 'chat_flow',\n  MiniProgram = 'mini_program',\n  MiniProgramV2 = 'mini_program_v2',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type Conversation as CozeConversation } from '@coze/api';\n\ndeclare module '@coze/api' {\n  interface Conversation {\n    name?: string;\n    updated_at: number;\n  }\n}\n\nexport enum ConversationSort { // \n  Today = 0,\n  In30days = 1,\n  Others = 999,\n}\n\nexport const conversationSortMap = new Map([\n  [ConversationSort.Today, I18n.t('profile_history_today', {}, '')],\n  [\n    ConversationSort.In30days,\n    I18n.t('log_pay_wall_date_filter_30_days', {}, '30'),\n  ],\n  [ConversationSort.Others, I18n.t('web_sdk_past', {}, '')],\n]);\n\nexport interface SortedConversationItem extends CozeConversation {\n  sort: ConversationSort;\n  name?: string;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { catchParse, catchStringify, STRINGIFY_ERROR } from './json-handle';\n\nexport enum LocalStorageKey {\n  ChatHistory = 'ChatHistory',\n  UID = 'OpenSDKUID',\n}\n\nexport type StorageKey = `coze__${LocalStorageKey}__${string}`;\n\nexport const getStorageKey = (\n  key: LocalStorageKey,\n  suffix?: string,\n): StorageKey => `coze__${key}__${suffix ?? ''}`;\n\nexport const setItem = (key: string, obj: unknown) => {\n  const str = catchStringify(obj);\n  if (str === STRINGIFY_ERROR) {\n    return;\n  }\n\n  if (obj) {\n    localStorage.setItem(key, str);\n  } else {\n    localStorage.removeItem(key);\n  }\n};\n\nexport const getItem = <T = unknown>(key: StorageKey, defaultValue: T) => {\n  const str = localStorage.getItem(key);\n\n  if (!str) {\n    return defaultValue;\n  }\n\n  return catchParse<T>(str, defaultValue);\n};\n\nexport const storageUtil = {\n  setItem,\n  getItem,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CSSProperties, FC, ReactNode } from 'react';\n\nimport { type InputNativeCallbacks } from '@coze-common/chat-uikit-shared';\nimport { type RequestManagerOptions } from '@coze-common/chat-core';\nimport {\n  type MixInitResponse,\n  type ChatAreaEventCallback,\n} from '@coze-common/chat-area';\nimport { type CozeAPI } from '@coze/api';\n\nimport { type SDKInitError } from '@/util/error';\nimport { type OpenBotInfo, type OpenUserInfo } from '@/types/user';\nimport { type CozeChatConfig, type Layout } from '@/types/client';\nimport { type InitErrorFallback } from '@/components/error-fallback';\n\nexport { type CozeChatConfig };\nexport interface ConversationInfo {\n  conversationId: string;\n  sectionId: string;\n}\n\nexport enum EInputMode {\n  Text = 'text',\n  Voice = 'voice',\n  VoiceCall = 'call',\n}\n\nexport interface DebugProps {\n  cozeApiRequestHeader?: Record<string, string>;\n}\n\nexport interface OpenRequestInit {\n  prologue: string;\n  onboardingSuggestions: Array<{\n    id: string;\n    content: string;\n  }>;\n  botInfo: OpenBotInfo;\n  backgroundInfo?: MixInitResponse['backgroundInfo'];\n  conversationId?: string; // conversationId\n  sectionId?: string; // sectionId\n  defaultInputMode?: EInputMode;\n  isCustomBackground?: boolean;\n  /**\n   * @description  openRequestInit  webSDK  botInfo \n   */\n  isBuilderChat?: boolean;\n}\nexport interface AutoBilling {\n  entityType: 'bot' | 'workflow';\n  entityId: string;\n}\nexport interface StudioChatProviderProps {\n  className?: string;\n  spaceId?: string;\n  userInfo?: OpenUserInfo;\n  chatConfig: CozeChatConfig;\n  layout?: Layout;\n  openRequestInit?:\n    | OpenRequestInit\n    | {\n        (cozeApi?: CozeAPI): Promise<OpenRequestInit> | OpenRequestInit;\n      };\n  requestManagerOptions?: RequestManagerOptions; //  coze-sdk\n  onImageClick?: ChatAreaEventCallback['onImageClick'];\n  onMessageLinkClick?: ChatAreaEventCallback['onMessageLinkClick'];\n  /**\n   *  / \n   */\n  onInitStateChange?: (\n    status: 'initSuccess' | 'initFail',\n    errorInfo?: SDKInitError,\n  ) => void;\n  /**\n   * \n   * (onboarding)\n   * or\n   * chatArea \n   *  fallback \n   */\n  initErrorFallbackFC?: FC<InitErrorFallback>;\n\n  /**\n   * : userInfo.nickname && !openRequestInit\n   * replace(prologue, '{{user_name}}', userInfo.nickname)\n   */\n  enableReplacePrologueNicknameWithVar?: boolean;\n  onThemeChange?: (theme: 'bg-theme' | 'light') => void;\n  onDefaultHistoryClear?: () => void;\n  defaultHistoryMessage?: MixInitResponse['messageList'];\n  debug?: DebugProps;\n  isCustomBackground?: boolean;\n  isNeedVoiceCall?: boolean;\n  readonly?: boolean;\n}\n\nexport interface StudioChatAreaProps {\n  className?: string;\n  coreAreaClassName?: string;\n  showInputArea?: boolean;\n  inputPlaceholder?: string;\n  isDisabled?: boolean;\n  inputNativeCallbacks?: InputNativeCallbacks;\n  messageGroupListClassName?: string;\n  isShowClearContextDivider?: boolean;\n  renderChatInputTopSlot?: () => React.ReactNode;\n  headerNode?: React.ReactNode;\n  messageMaxWidth?: string;\n  isMiniScreen?: boolean;\n  enableMultimodalUpload?: boolean;\n}\n\nexport interface WebSdkChatProps {\n  // \n  title: string; // \n  style?: CSSProperties; // style\n  className?: string; // class\n  icon?: string; // Icon\n  headerExtra?: ReactNode; // \n  layout?: Layout; // \n  useInIframe?: boolean; //Iframe\n  chatConfig: CozeChatConfig;\n  userInfo?: OpenUserInfo;\n  onImageClick?: ChatAreaEventCallback['onImageClick'];\n  onThemeChange?: (theme: 'bg-theme' | 'light') => void;\n}\n","import * as __WEBPACK_EXTERNAL_MODULE_axios__ from \"axios\";\nimport * as __WEBPACK_EXTERNAL_MODULE_ws__ from \"ws\";\nimport * as __WEBPACK_EXTERNAL_MODULE_reconnecting_websocket__ from \"reconnecting-websocket\";\nimport * as __WEBPACK_EXTERNAL_MODULE_os__ from \"os\";\nimport * as __WEBPACK_EXTERNAL_MODULE_node_fetch__ from \"node-fetch\";\nimport * as __WEBPACK_EXTERNAL_MODULE_crypto__ from \"crypto\";\nimport * as __WEBPACK_EXTERNAL_MODULE_jsonwebtoken__ from \"jsonwebtoken\";\nclass APIResource {\n    constructor(client){\n        this._client = client;\n    }\n}\n/* eslint-disable @typescript-eslint/no-namespace */ class Bots extends APIResource {\n    /**\n   * Create a new agent. | \n   * @docs en:https://www.coze.com/docs/developer_guides/create_bot?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/create_bot?_lang=zh\n   * @param params - Required The parameters for creating a bot. |  Bot \n   * @param params.space_id - Required The Space ID of the space where the agent is located. | Bot  Space ID\n   * @param params.name - Required The name of the agent. It should be 1 to 20 characters long. | Bot \n   * @param params.description - Optional The description of the agent. It can be 0 to 500 characters long. | Bot \n   * @param params.icon_file_id - Optional The file ID for the agent's avatar. |  ID\n   * @param params.prompt_info - Optional The personality and reply logic of the agent. | Bot \n   * @param params.onboarding_info - Optional The settings related to the agent's opening remarks. | Bot \n   * @returns Information about the created bot. |  Bot \n   */ async create(params, options) {\n        const apiUrl = '/v1/bot/create';\n        const result = await this._client.post(apiUrl, params, false, options);\n        return result.data;\n    }\n    /**\n   * Update the configuration of an agent. | \n   * @docs en:https://www.coze.com/docs/developer_guides/update_bot?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/update_bot?_lang=zh\n   * @param params - Required The parameters for updating a bot. |  Bot \n   * @param params.bot_id - Required The ID of the agent that the API interacts with. | ID\n   * @param params.name - Optional The name of the agent. | Bot \n   * @param params.description - Optional The description of the agent. | Bot \n   * @param params.icon_file_id - Optional The file ID for the agent's avatar. |  ID\n   * @param params.prompt_info - Optional The personality and reply logic of the agent. | Bot \n   * @param params.onboarding_info - Optional The settings related to the agent's opening remarks. | Bot \n   * @param params.knowledge - Optional Knowledge configurations of the agent. | Bot \n   * @returns Undefined | \n   */ async update(params, options) {\n        const apiUrl = '/v1/bot/update';\n        const result = await this._client.post(apiUrl, params, false, options);\n        return result.data;\n    }\n    /**\n   * Get the agents published as API service. |  Agent as API \n   * @docs en:https://www.coze.com/docs/developer_guides/published_bots_list?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/published_bots_list?_lang=zh\n   * @param params - Required The parameters for listing bots. |  Bot \n   * @param params.space_id - Required The ID of the space. | Bot  Space ID\n   * @param params.page_size - Optional Pagination size. | \n   * @param params.page_index - Optional Page number for paginated queries. | \n   * @returns List of published bots. |  Bot \n   * @deprecated Use listNew instead.\n   */ async list(params, options) {\n        const apiUrl = '/v1/space/published_bots_list';\n        const result = await this._client.get(apiUrl, params, false, options);\n        return result.data;\n    }\n    /**\n   * Get bots list. | \n   */ async listNew(params, options) {\n        const apiUrl = '/v1/bots';\n        const result = await this._client.get(apiUrl, params, false, options);\n        return result.data;\n    }\n    /**\n   * Publish the specified agent as an API service. | \n   * @docs en:https://www.coze.com/docs/developer_guides/publish_bot?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/publish_bot?_lang=zh\n   * @param params - Required The parameters for publishing a bot. |  Bot \n   * @param params.bot_id - Required The ID of the agent that the API interacts with. | ID\n   * @param params.connector_ids - Required The list of publishing channel IDs for the agent. |  ID \n   * @returns Undefined | \n   */ async publish(params, options) {\n        const apiUrl = '/v1/bot/publish';\n        const result = await this._client.post(apiUrl, params, false, options);\n        return result.data;\n    }\n    /**\n   * Get the configuration information of the agent. | \n   * @docs en:https://www.coze.com/docs/developer_guides/get_metadata?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/get_metadata?_lang=zh\n   * @param params - Required The parameters for retrieving a bot. |  Bot \n   * @param params.bot_id - Required The ID of the agent that the API interacts with. | ID\n   * @returns Information about the bot. | Bot \n   * @deprecated Use retrieveNew instead.\n   */ async retrieve(params, options) {\n        const apiUrl = '/v1/bot/get_online_info';\n        const result = await this._client.get(apiUrl, params, false, options);\n        return result.data;\n    }\n    /**\n   * Get the configuration information of the agent. | \n   * @param botId - Required The ID of the agent that the API interacts with. | ID\n   * @param params\n   * @param options\n   * @returns\n   */ async retrieveNew(botId, params, options) {\n        const apiUrl = `/v1/bots/${botId}`;\n        const result = await this._client.get(apiUrl, params, false, options);\n        return result.data;\n    }\n}\nvar bots_SuggestReplyMode = /*#__PURE__*/ function(SuggestReplyMode) {\n    /**\n   * The bot does not suggest replies.\n   */ SuggestReplyMode[\"DISABLE\"] = \"disable\";\n    /**\n   * The bot suggests replies.\n   */ SuggestReplyMode[\"ENABLE\"] = \"enable\";\n    /**\n   * The bot suggests replies based on the customized prompt.\n   */ SuggestReplyMode[\"CUSTOMIZED\"] = \"customized\";\n    return SuggestReplyMode;\n}({});\nvar bots_VariableType = /*#__PURE__*/ function(VariableType) {\n    /**\n   * The variable is a key-value pair.\n   */ VariableType[\"KVVariable\"] = \"KVVariable\";\n    /**\n   * The variable is a list.\n   */ VariableType[\"ListVariable\"] = \"ListVariable\";\n    return VariableType;\n}({});\nvar bots_VariableChannel = /*#__PURE__*/ function(VariableChannel) {\n    /**\n   * The variable is a custom variable.\n   */ VariableChannel[\"Custom\"] = \"custom\";\n    /**\n   * The variable is a system variable.\n   */ VariableChannel[\"System\"] = \"system\";\n    /**\n   * The variable is a location variable.\n   */ VariableChannel[\"Location\"] = \"location\";\n    /**\n   * The variable is a Feishu variable.\n   */ VariableChannel[\"Feishu\"] = \"feishu\";\n    /**\n   * The variable is an app variable.\n   */ VariableChannel[\"APP\"] = \"app\";\n    return VariableChannel;\n}({});\n/* eslint-disable security/detect-object-injection */ /* eslint-disable @typescript-eslint/no-explicit-any */ function safeJsonParse(jsonString) {\n    let defaultValue = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : '';\n    try {\n        return JSON.parse(jsonString);\n    } catch (error) {\n        return defaultValue;\n    }\n}\nfunction sleep(ms) {\n    return new Promise((resolve)=>{\n        setTimeout(resolve, ms);\n    });\n}\nfunction isUniApp() {\n    return 'undefined' != typeof uni;\n}\nfunction isBrowser() {\n    return 'undefined' != typeof window;\n}\nfunction isPlainObject(obj) {\n    if ('object' != typeof obj || null === obj) return false;\n    const proto = Object.getPrototypeOf(obj);\n    if (null === proto) return true;\n    let baseProto = proto;\n    while(null !== Object.getPrototypeOf(baseProto))baseProto = Object.getPrototypeOf(baseProto);\n    return proto === baseProto;\n}\nfunction mergeConfig() {\n    for(var _len = arguments.length, objects = new Array(_len), _key = 0; _key < _len; _key++)objects[_key] = arguments[_key];\n    return objects.reduce((result, obj)=>{\n        if (void 0 === obj) return result || {};\n        for(const key in obj)if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            if (isPlainObject(obj[key]) && !Array.isArray(obj[key])) result[key] = mergeConfig(result[key] || {}, obj[key]);\n            else result[key] = obj[key];\n        }\n        return result;\n    }, {});\n}\nfunction isPersonalAccessToken(token) {\n    return !!(null == token ? void 0 : token.startsWith('pat_'));\n}\nfunction buildWebsocketUrl(path, params) {\n    const queryString = Object.entries(params || {}).filter((param)=>{\n        let [_, value] = param;\n        return null != value && '' !== value;\n    }).map((param)=>{\n        let [key, value] = param;\n        return `${key}=${value}`;\n    }).join('&');\n    return `${path}${queryString ? `?${queryString}` : ''}`;\n}\nconst isBrowserExtension = ()=>'undefined' != typeof chrome && !!chrome.runtime && !!chrome.runtime.id;\n/* eslint-disable max-params */ class CozeError extends Error {\n}\nclass APIError extends CozeError {\n    static makeMessage(status, errorBody, message, headers) {\n        if (!errorBody && message) return message;\n        if (errorBody) {\n            const list = [];\n            const { code, msg, error } = errorBody;\n            if (code) list.push(`code: ${code}`);\n            if (msg) list.push(`msg: ${msg}`);\n            if ((null == error ? void 0 : error.detail) && msg !== error.detail) list.push(`detail: ${error.detail}`);\n            const logId = (null == error ? void 0 : error.logid) || (null == headers ? void 0 : headers['x-tt-logid']);\n            if (logId) list.push(`logid: ${logId}`);\n            return list.join(', ');\n        }\n        if (status) return `http status code: ${status} (no body)`;\n        return '(no status code or body)';\n    }\n    static generate(status, errorResponse, message, headers) {\n        if (!status) return new APIConnectionError({\n            cause: castToError(errorResponse)\n        });\n        const error = errorResponse;\n        // https://www.coze.cn/docs/developer_guides/coze_error_codes\n        if (400 === status || (null == error ? void 0 : error.code) === 4000) return new BadRequestError(status, error, message, headers);\n        if (401 === status || (null == error ? void 0 : error.code) === 4100) return new AuthenticationError(status, error, message, headers);\n        if (403 === status || (null == error ? void 0 : error.code) === 4101) return new PermissionDeniedError(status, error, message, headers);\n        if (404 === status || (null == error ? void 0 : error.code) === 4200) return new NotFoundError(status, error, message, headers);\n        if (429 === status || (null == error ? void 0 : error.code) === 4013) return new RateLimitError(status, error, message, headers);\n        if (408 === status) return new TimeoutError(status, error, message, headers);\n        if (502 === status) return new GatewayError(status, error, message, headers);\n        if (status >= 500) return new InternalServerError(status, error, message, headers);\n        return new APIError(status, error, message, headers);\n    }\n    constructor(status, error, message, headers){\n        var _error_detail, _error_error;\n        super(`${APIError.makeMessage(status, error, message, headers)}`);\n        this.status = status;\n        this.headers = headers;\n        this.logid = (null == error ? void 0 : null === (_error_detail = error.detail) || void 0 === _error_detail ? void 0 : _error_detail.logid) || (null == headers ? void 0 : headers['x-tt-logid']);\n        // this.error = error;\n        this.code = null == error ? void 0 : error.code;\n        this.msg = null == error ? void 0 : error.msg;\n        this.detail = null == error ? void 0 : null === (_error_error = error.error) || void 0 === _error_error ? void 0 : _error_error.detail;\n        this.rawError = error;\n    }\n}\nclass APIConnectionError extends APIError {\n    constructor({ message }){\n        super(void 0, void 0, message || 'Connection error.', void 0), this.status = void 0;\n    // if (cause) {\n    //   this.cause = cause;\n    // }\n    }\n}\nclass APIUserAbortError extends APIError {\n    constructor(message){\n        super(void 0, void 0, message || 'Request was aborted.', void 0), this.name = 'UserAbortError', this.status = void 0;\n    }\n}\nclass BadRequestError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'BadRequestError', this.status = 400;\n    }\n}\nclass AuthenticationError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'AuthenticationError', this.status = 401;\n    }\n}\nclass PermissionDeniedError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'PermissionDeniedError', this.status = 403;\n    }\n}\nclass NotFoundError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'NotFoundError', this.status = 404;\n    }\n}\nclass TimeoutError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'TimeoutError', this.status = 408;\n    }\n}\nclass RateLimitError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'RateLimitError', this.status = 429;\n    }\n}\nclass InternalServerError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'InternalServerError', this.status = 500;\n    }\n}\nclass GatewayError extends APIError {\n    constructor(...args){\n        super(...args), this.name = 'GatewayError', this.status = 502;\n    }\n}\nconst castToError = (err)=>{\n    if (err instanceof Error) return err;\n    return new Error(err);\n};\nclass JSONParseError extends Error {\n    constructor({ message, cause }){\n        super(message);\n        this.cause = cause;\n    }\n}\nclass Messages extends APIResource {\n    /**\n   * Get the list of messages in a chat. | \n   * @docs en:https://www.coze.com/docs/developer_guides/chat_message_list?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/chat_message_list?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. |  ID\n   * @param chat_id - Required The ID of the chat. |  ID\n   * @returns An array of chat messages. | \n   */ async list(conversation_id, chat_id, options) {\n        const apiUrl = `/v3/chat/message/list?conversation_id=${conversation_id}&chat_id=${chat_id}`;\n        const result = await this._client.get(apiUrl, void 0, false, options);\n        return result.data;\n    }\n}\nconst uuid = ()=>(Math.random() * new Date().getTime()).toString();\nconst handleAdditionalMessages = (additional_messages)=>null == additional_messages ? void 0 : additional_messages.map((i)=>({\n            ...i,\n            content: 'object' == typeof i.content ? JSON.stringify(i.content) : i.content\n        }));\nconst handleParameters = (parameters)=>{\n    if (parameters) {\n        for (const [key, value] of Object.entries(parameters))if ('object' == typeof value) parameters[key] = JSON.stringify(value);\n    }\n    return parameters;\n};\nclass Chat extends APIResource {\n    /**\n   * Call the Chat API to send messages to a published Coze agent. | \n   * @docs en:https://www.coze.com/docs/developer_guides/chat_v3?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/chat_v3?_lang=zh\n   * @param params - Required The parameters for creating a chat session. | \n   * @param params.bot_id - Required The ID of the agent. |  Bot ID\n   * @param params.user_id - Optional The ID of the user interacting with the Bot. |  Bot \n   * @param params.additional_messages - Optional Additional messages for the conversation. | \n   * @param params.custom_variables - Optional Variables defined in the Bot. | Bot \n   * @param params.auto_save_history - Optional Whether to automatically save the conversation history. | \n   * @param params.meta_data - Optional Additional metadata for the message. | \n   * @param params.conversation_id - Optional The ID of the conversation. | \n   * @param params.extra_params - Optional Extra parameters for the conversation. | \n   * @param params.shortcut_command - Optional The shortcut command information. | \n   * @param params.parameters - Optional custom parameters. | \n   * @returns The data of the created chat. | \n   */ async create(params, options) {\n        if (!params.user_id) params.user_id = uuid();\n        const { conversation_id, ...rest } = params;\n        const apiUrl = `/v3/chat${conversation_id ? `?conversation_id=${conversation_id}` : ''}`;\n        const payload = {\n            ...rest,\n            additional_messages: handleAdditionalMessages(params.additional_messages),\n            shortcut_command: params.shortcut_command ? {\n                ...params.shortcut_command,\n                parameters: handleParameters(params.shortcut_command.parameters)\n            } : void 0,\n            stream: false\n        };\n        const result = await this._client.post(apiUrl, payload, false, options);\n        return result.data;\n    }\n    /**\n   * Call the Chat API to send messages to a published Coze agent. | \n   * @docs en:https://www.coze.com/docs/developer_guides/chat_v3?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/chat_v3?_lang=zh\n   * @param params - Required The parameters for creating a chat session. | \n   * @param params.bot_id - Required The ID of the agent. |  Bot ID\n   * @param params.user_id - Optional The ID of the user interacting with the Bot. |  Bot \n   * @param params.additional_messages - Optional Additional messages for the conversation. | \n   * @param params.custom_variables - Optional Variables defined in the Bot. | Bot \n   * @param params.auto_save_history - Optional Whether to automatically save the conversation history. | \n   * @param params.meta_data - Optional Additional metadata for the message. | \n   * @param params.conversation_id - Optional The ID of the conversation. | \n   * @param params.extra_params - Optional Extra parameters for the conversation. | \n   * @param params.shortcut_command - Optional The shortcut command information. | \n   * @param params.parameters - Optional custom parameters. | \n   * @returns\n   */ async createAndPoll(params, options) {\n        if (!params.user_id) params.user_id = uuid();\n        const { conversation_id, ...rest } = params;\n        const apiUrl = `/v3/chat${conversation_id ? `?conversation_id=${conversation_id}` : ''}`;\n        const payload = {\n            ...rest,\n            additional_messages: handleAdditionalMessages(params.additional_messages),\n            shortcut_command: params.shortcut_command ? {\n                ...params.shortcut_command,\n                parameters: handleParameters(params.shortcut_command.parameters)\n            } : void 0,\n            stream: false\n        };\n        const result = await this._client.post(apiUrl, payload, false, options);\n        const chatId = result.data.id;\n        const conversationId = result.data.conversation_id;\n        let chat;\n        while(true){\n            await sleep(100);\n            chat = await this.retrieve(conversationId, chatId);\n            if ('completed' === chat.status || 'failed' === chat.status || 'requires_action' === chat.status) break;\n        }\n        const messageList = await this.messages.list(conversationId, chatId);\n        return {\n            chat,\n            messages: messageList\n        };\n    }\n    /**\n   * Call the Chat API to send messages to a published Coze agent with streaming response. | \n   * @docs en:https://www.coze.com/docs/developer_guides/chat_v3?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/chat_v3?_lang=zh\n   * @param params - Required The parameters for streaming a chat session. | \n   * @param params.bot_id - Required The ID of the agent. |  Bot ID\n   * @param params.user_id - Optional The ID of the user interacting with the Bot. |  Bot \n   * @param params.additional_messages - Optional Additional messages for the conversation. | \n   * @param params.custom_variables - Optional Variables defined in the Bot. | Bot \n   * @param params.auto_save_history - Optional Whether to automatically save the conversation history. | \n   * @param params.meta_data - Optional Additional metadata for the message. | \n   * @param params.conversation_id - Optional The ID of the conversation. | \n   * @param params.extra_params - Optional Extra parameters for the conversation. | \n   * @param params.shortcut_command - Optional The shortcut command information. | \n   * @param params.parameters - Optional custom parameters. | \n   * @returns A stream of chat data. | \n   */ async *stream(params, options) {\n        if (!params.user_id) params.user_id = uuid();\n        const { conversation_id, ...rest } = params;\n        const apiUrl = `/v3/chat${conversation_id ? `?conversation_id=${conversation_id}` : ''}`;\n        const payload = {\n            ...rest,\n            additional_messages: handleAdditionalMessages(params.additional_messages),\n            shortcut_command: params.shortcut_command ? {\n                ...params.shortcut_command,\n                parameters: handleParameters(params.shortcut_command.parameters)\n            } : void 0,\n            stream: true\n        };\n        const result = await this._client.post(apiUrl, payload, true, options);\n        for await (const message of result)if (\"done\" === message.event) {\n            const ret = {\n                event: message.event,\n                data: '[DONE]'\n            };\n            yield ret;\n        } else try {\n            const ret = {\n                event: message.event,\n                data: JSON.parse(message.data)\n            };\n            yield ret;\n        } catch (error) {\n            throw new CozeError(`Could not parse message into JSON:${message.data}`);\n        }\n    }\n    /**\n   * Get the detailed information of the chat. | \n   * @docs en:https://www.coze.com/docs/developer_guides/retrieve_chat?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/retrieve_chat?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. |  ID\n   * @param chat_id - Required The ID of the chat. |  ID\n   * @returns The data of the retrieved chat. | \n   */ async retrieve(conversation_id, chat_id, options) {\n        const apiUrl = `/v3/chat/retrieve?conversation_id=${conversation_id}&chat_id=${chat_id}`;\n        const result = await this._client.post(apiUrl, void 0, false, options);\n        return result.data;\n    }\n    /**\n   * Cancel a chat session. | \n   * @docs en:https://www.coze.com/docs/developer_guides/cancel_chat?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/cancel_chat?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. |  ID\n   * @param chat_id - Required The ID of the chat. |  ID\n   * @returns The data of the canceled chat. | \n   */ async cancel(conversation_id, chat_id, options) {\n        const apiUrl = '/v3/chat/cancel';\n        const payload = {\n            conversation_id,\n            chat_id\n        };\n        const result = await this._client.post(apiUrl, payload, false, options);\n        return result.data;\n    }\n    /**\n   * Submit tool outputs for a chat session. | \n   * @docs en:https://www.coze.com/docs/developer_guides/chat_submit_tool_outputs?_lang=en\n   * @docs zh:https://www.coze.cn/docs/developer_guides/chat_submit_tool_outputs?_lang=zh\n   * @param params - Required Parameters for submitting tool outputs. | \n   * @param params.conversation_id - Required The ID of the conversation. |  ID\n   * @param params.chat_id - Required The ID of the chat. |  ID\n   * @param params.tool_outputs - Required The outputs of the tool. | \n   * @param params.stream - Optional Whether to use streaming response. | \n   * @returns The data of the submitted tool outputs or a stream of chat data. | \n   */ async *submitToolOutputs(params, options) {\n        const { conversation_id, chat_id, ...rest } = params;\n        const apiUrl = `/v3/chat/submit_tool_outputs?conversation_id=${params.conversation_id}&chat_id=${params.chat_id}`;\n        const payload = {\n            ...rest\n        };\n        if (false === params.stream) {\n            const response = await this._client.post(apiUrl, payload, false, options);\n            return response.data;\n        }\n        {\n            const result = await this._client.post(apiUrl, payload, true, options);\n            for await (const message of result)if (\"done\" === message.event) {\n                const ret = {\n                    event: message.event,\n                    data: '[DONE]'\n                };\n                yield ret;\n            } else try {\n                const ret = {\n                    event: message.event,\n                    data: JSON.parse(message.data)\n                };\n                yield ret;\n            } catch (error) {\n                throw new CozeError(`Could not parse message into JSON:${message.data}`);\n            }\n        }\n    }\n    constructor(...args){\n        super(...args), this.messages = new Messages(this._client);\n    }\n}\nvar chat_ChatStatus = /*#__PURE__*/ function(ChatStatus) {\n    ChatStatus[\"CREATED\"] = \"created\";\n    ChatStatus[\"IN_PROGRESS\"] = \"in_progress\";\n    ChatStatus[\"COMPLETED\"] = \"completed\";\n    ChatStatus[\"FAILED\"] = \"failed\";\n    ChatStatus[\"REQUIRES_ACTION\"] = \"requires_action\";\n    ChatStatus[\"CANCELED\"] = \"canceled\";\n    ChatStatus[\"UNKNOWN\"] = \"unknown\";\n    return ChatStatus;\n}({});\nvar chat_ChatEventType = /*#__PURE__*/ function(ChatEventType) {\n    ChatEventType[\"CONVERSATION_CHAT_CREATED\"] = \"conversation.chat.created\";\n    ChatEventType[\"CONVERSATION_CHAT_IN_PROGRESS\"] = \"conversation.chat.in_progress\";\n    ChatEventType[\"CONVERSATION_CHAT_COMPLETED\"] = \"conversation.chat.completed\";\n    ChatEventType[\"CONVERSATION_CHAT_FAILED\"] = \"conversation.chat.failed\";\n    ChatEventType[\"CONVERSATION_CHAT_REQUIRES_ACTION\"] = \"conversation.chat.requires_action\";\n    ChatEventType[\"CONVERSATION_MESSAGE_DELTA\"] = \"conversation.message.delta\";\n    ChatEventType[\"CONVERSATION_MESSAGE_COMPLETED\"] = \"conversation.message.completed\";\n    ChatEventType[\"CONVERSATION_AUDIO_DELTA\"] = \"conversation.audio.delta\";\n    ChatEventType[\"DONE\"] = \"done\";\n    ChatEventType[\"ERROR\"] = \"error\";\n    return ChatEventType;\n}({});\nvar chat_RoleType = /*#__PURE__*/ function(RoleType) {\n    RoleType[\"User\"] = \"user\";\n    RoleType[\"Assistant\"] = \"assistant\";\n    return RoleType;\n}({});\nclass messages_Messages extends APIResource {\n    /**\n   * Create a message and add it to the specified conversation. | \n   * @docs en: https://www.coze.com/docs/developer_guides/create_message?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/create_message?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @param params - Required The parameters for creating a message | \n   * @param params.role - Required The entity that sent this message. Possible values: user, assistant. | user, assistant\n   * @param params.content - Required The content of the message. | \n   * @param params.content_type - Required The type of the message content. | \n   * @param params.meta_data - Optional Additional information when creating a message. | \n   * @returns Information about the new message. | \n   */ async create(conversation_id, params, options) {\n        const apiUrl = `/v1/conversation/message/create?conversation_id=${conversation_id}`;\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Modify a message, supporting the modification of message content, additional content, and message type. | \n   * @docs en: https://www.coze.com/docs/developer_guides/modify_message?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/modify_message?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @param message_id - Required The ID of the message. | Message ID\n   * @param params - Required The parameters for modifying a message | \n   * @param params.meta_data - Optional Additional information when modifying a message. | \n   * @param params.content - Optional The content of the message. | \n   * @param params.content_type - Optional The type of the message content. | \n   * @returns Information about the modified message. | \n   */ // eslint-disable-next-line max-params\n    async update(conversation_id, message_id, params, options) {\n        const apiUrl = `/v1/conversation/message/modify?conversation_id=${conversation_id}&message_id=${message_id}`;\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.message;\n    }\n    /**\n   * Get the detailed information of specified message. | \n   * @docs en: https://www.coze.com/docs/developer_guides/retrieve_message?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/retrieve_message?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @param message_id - Required The ID of the message. | Message ID\n   * @returns Information about the message. | \n   */ async retrieve(conversation_id, message_id, options) {\n        const apiUrl = `/v1/conversation/message/retrieve?conversation_id=${conversation_id}&message_id=${message_id}`;\n        const response = await this._client.get(apiUrl, null, false, options);\n        return response.data;\n    }\n    /**\n   * List messages in a conversation. | \n   * @docs en: https://www.coze.com/docs/developer_guides/message_list?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/message_list?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @param params - Optional The parameters for listing messages | \n   * @param params.order - Optional The order of the messages. | \n   * @param params.chat_id - Optional The ID of the chat. |  ID\n   * @param params.before_id - Optional The ID of the message before which to list. |  ID\n   * @param params.after_id - Optional The ID of the message after which to list. |  ID\n   * @param params.limit - Optional The maximum number of messages to return. | \n   * @returns A list of messages. | \n   */ async list(conversation_id, params, options) {\n        const apiUrl = `/v1/conversation/message/list?conversation_id=${conversation_id}`;\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response;\n    }\n    /**\n   * Call the API to delete a message within a specified conversation. | \n   * @docs en: https://www.coze.com/docs/developer_guides/delete_message?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/delete_message?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @param message_id - Required The ID of the message. | Message ID\n   * @returns Details of the deleted message. | \n   */ async delete(conversation_id, message_id, options) {\n        const apiUrl = `/v1/conversation/message/delete?conversation_id=${conversation_id}&message_id=${message_id}`;\n        const response = await this._client.post(apiUrl, void 0, false, options);\n        return response.data;\n    }\n}\nclass Conversations extends APIResource {\n    /**\n   * Create a conversation. Conversation is an interaction between an agent and a user, including one or more messages. | \n   * @docs en: https://www.coze.com/docs/developer_guides/create_conversation?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/create_conversation?_lang=zh\n   * @param params - Required The parameters for creating a conversation | \n   * @param params.messages - Optional Messages in the conversation. | \n   * @param params.meta_data - Optional Additional information when creating a message. | \n   * @param params.bot_id - Optional Bind and isolate conversation on different bots. | Bot\n   * @returns Information about the created conversation. | \n   */ async create(params, options) {\n        const apiUrl = '/v1/conversation/create';\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Get the information of specific conversation. |  ID \n   * @docs en: https://www.coze.com/docs/developer_guides/retrieve_conversation?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/retrieve_conversation?_lang=zh\n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @returns Information about the conversation. | \n   */ async retrieve(conversation_id, options) {\n        const apiUrl = `/v1/conversation/retrieve?conversation_id=${conversation_id}`;\n        const response = await this._client.get(apiUrl, null, false, options);\n        return response.data;\n    }\n    /**\n   * List all conversations. |  Bot \n   * @param params\n   * @param params.bot_id - Required Bot ID. | Bot ID\n   * @param params.page_num - Optional The page number. |  1\n   * @param params.page_size - Optional The number of conversations per page. |  50\n   * @returns Information about the conversations. | \n   */ async list(params, options) {\n        const apiUrl = '/v1/conversations';\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Clear a conversation. | \n   * @param conversation_id - Required The ID of the conversation. | Conversation ID\n   * @returns Information about the conversation session. |  ID\n   */ async clear(conversation_id, options) {\n        const apiUrl = `/v1/conversations/${conversation_id}/clear`;\n        const response = await this._client.post(apiUrl, null, false, options);\n        return response.data;\n    }\n    constructor(...args){\n        super(...args), this.messages = new messages_Messages(this._client);\n    }\n}\nclass Files extends APIResource {\n    /**\n   * Upload files to Coze platform. | \n   * @docs en: https://www.coze.com/docs/developer_guides/upload_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/upload_files?_lang=zh\n   * @param params - Required The parameters for file upload | \n   * @param params.file - Required The file to be uploaded. | \n   * @returns Information about the new file. | \n   */ async upload(params, options) {\n        const apiUrl = '/v1/files/upload';\n        const response = await this._client.post(apiUrl, (0, __WEBPACK_EXTERNAL_MODULE_axios__.toFormData)(params), false, options);\n        return response.data;\n    }\n    /**\n   * Get the information of the specific file uploaded to Coze platform. | \n   * @docs en: https://www.coze.com/docs/developer_guides/retrieve_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/retrieve_files?_lang=zh\n   * @param file_id - Required The ID of the uploaded file. |  ID\n   * @returns Information about the uploaded file. | \n   */ async retrieve(file_id, options) {\n        const apiUrl = `/v1/files/retrieve?file_id=${file_id}`;\n        const response = await this._client.get(apiUrl, null, false, options);\n        return response.data;\n    }\n}\nclass Runs extends APIResource {\n    /**\n   * Initiates a workflow run. | \n   * @docs en: https://www.coze.com/docs/developer_guides/workflow_run?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/workflow_run?_lang=zh\n   * @param params.workflow_id - Required The ID of the workflow to run. |   ID\n   * @param params.bot_id - Optional The ID of the bot associated with the workflow. |   ID\n   * @param params.parameters - Optional Parameters for the workflow execution. |  \n   * @param params.ext - Optional Additional information for the workflow execution. |  \n   * @param params.execute_mode - Optional The mode in which to execute the workflow. |  \n   * @param params.connector_id - Optional The ID of the connector to use for the workflow. |   ID\n   * @param params.app_id - Optional The ID of the app.  |   App ID\n   * @returns RunWorkflowData | \n   */ async create(params, options) {\n        const apiUrl = '/v1/workflow/run';\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response;\n    }\n    /**\n   * Streams the workflow run events. | \n   * @docs en: https://www.coze.com/docs/developer_guides/workflow_stream_run?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/workflow_stream_run?_lang=zh\n   * @param params.workflow_id - Required The ID of the workflow to run. |   ID\n   * @param params.bot_id - Optional The ID of the bot associated with the workflow. |   ID\n   * @param params.parameters - Optional Parameters for the workflow execution. |  \n   * @param params.ext - Optional Additional information for the workflow execution. |  \n   * @param params.execute_mode - Optional The mode in which to execute the workflow. |  \n   * @param params.connector_id - Optional The ID of the connector to use for the workflow. |   ID\n   * @param params.app_id - Optional The ID of the app.  |   App ID\n   * @returns Stream<WorkflowEvent, { id: string; event: string; data: string }> | \n   */ async *stream(params, options) {\n        const apiUrl = '/v1/workflow/stream_run';\n        const result = await this._client.post(apiUrl, params, true, options);\n        for await (const message of result)try {\n            if (\"Done\" === message.event) yield new WorkflowEvent(Number(message.id), \"Done\");\n            else yield new WorkflowEvent(Number(message.id), message.event, JSON.parse(message.data));\n        } catch (error) {\n            throw new CozeError(`Could not parse message into JSON:${message.data}`);\n        }\n    }\n    /**\n   * Resumes a paused workflow run. | \n   * @docs en: https://www.coze.com/docs/developer_guides/workflow_resume?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/workflow_resume?_lang=zh\n   * @param params.workflow_id - Required The ID of the workflow to resume. |   ID\n   * @param params.event_id - Required The ID of the event to resume from. |   ID\n   * @param params.resume_data - Required Data needed to resume the workflow. |  \n   * @param params.interrupt_type - Required The type of interruption to resume from. |  \n   * @returns AsyncGenerator<WorkflowEvent, { id: string; event: string; data: string }> | \n   */ async *resume(params, options) {\n        const apiUrl = '/v1/workflow/stream_resume';\n        const result = await this._client.post(apiUrl, params, true, options);\n        for await (const message of result)try {\n            if (\"Done\" === message.event) yield new WorkflowEvent(Number(message.id), \"Done\");\n            else yield new WorkflowEvent(Number(message.id), message.event, JSON.parse(message.data));\n        } catch (error) {\n            throw new CozeError(`Could not parse message into JSON:${message.data}`);\n        }\n    }\n    /**\n   * Get the workflow run history | \n   * @docs zh: https://www.coze.cn/open/docs/developer_guides/workflow_history\n   * @param workflowId - Required The ID of the workflow. |   ID\n   * @param executeId - Required The ID of the workflow execution. |   ID\n   * @returns WorkflowExecuteHistory[] | \n   */ async history(workflowId, executeId, options) {\n        const apiUrl = `/v1/workflows/${workflowId}/run_histories/${executeId}`;\n        const response = await this._client.get(apiUrl, void 0, false, options);\n        return response.data;\n    }\n}\nvar runs_WorkflowEventType = /*#__PURE__*/ function(WorkflowEventType) {\n    // The output message from the workflow node, such as the output message from\n    // the message node or end node. You can view the specific message content in data.\n    WorkflowEventType[\"MESSAGE\"] = \"Message\";\n    // An error has occurred. You can view the error_code and error_message in data to\n    // troubleshoot the issue.\n    //  data  error_code  error_message\n    WorkflowEventType[\"ERROR\"] = \"Error\";\n    // End. Indicates the end of the workflow execution, where data is empty.\n    //  data \n    WorkflowEventType[\"DONE\"] = \"Done\";\n    // Interruption. Indicates the workflow has been interrupted, where the data field\n    // contains specific interruption information.\n    //  data \n    WorkflowEventType[\"INTERRUPT\"] = \"Interrupt\";\n    return WorkflowEventType;\n}({});\nclass WorkflowEvent {\n    constructor(id, event, data){\n        this.id = id;\n        this.event = event;\n        this.data = data;\n    }\n}\nclass WorkflowChat extends APIResource {\n    /**\n   * Execute a chat workflow. | \n   * @docs en: https://www.coze.cn/docs/developer_guides/workflow_chat?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/workflow_chat?_lang=zh\n   * @param params.workflow_id - Required The ID of the workflow to chat with. |   ID\n   * @param params.additional_messages - Required Array of messages for the chat. |  \n   * @param params.parameters - Optional  Parameters for the workflow execution. |  \n   * @param params.app_id - Optional The ID of the app. |   ID\n   * @param params.bot_id - Optional The ID of the bot. |  Bot ID\n   * @param params.conversation_id - Optional The ID of the conversation. |   ID\n   * @param params.ext - Optional Additional information for the chat. |  \n   * @returns AsyncGenerator<StreamChatData> | \n   */ async *stream(params, options) {\n        const apiUrl = '/v1/workflows/chat';\n        const payload = {\n            ...params,\n            additional_messages: handleAdditionalMessages(params.additional_messages)\n        };\n        const result = await this._client.post(apiUrl, payload, true, options);\n        for await (const message of result)if (message.event === chat_ChatEventType.DONE) {\n            const ret = {\n                event: message.event,\n                data: '[DONE]'\n            };\n            yield ret;\n        } else try {\n            const ret = {\n                event: message.event,\n                data: JSON.parse(message.data)\n            };\n            yield ret;\n        } catch (error) {\n            throw new CozeError(`Could not parse message into JSON:${message.data}`);\n        }\n    }\n}\nclass Workflows extends APIResource {\n    constructor(...args){\n        super(...args), this.runs = new Runs(this._client), this.chat = new WorkflowChat(this._client);\n    }\n}\nclass WorkSpaces extends APIResource {\n    /**\n   * View the list of workspaces that the current Coze user has joined. | \n   * @docs en: https://www.coze.com/docs/developer_guides/list_workspace?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/list_workspace?_lang=zh\n   * @param params.page_num - Optional The page number for paginated queries. Default is 1.\n   * |   1\n   * @param params.page_size - Optional The size of pagination. Default is 10. Maximum is 50. |   10 50\n   * @returns OpenSpaceData | \n   */ async list(params, options) {\n        const apiUrl = '/v1/workspaces';\n        const response = await this._client.get(apiUrl, params, false, options);\n        return safeJsonParse(response, response).data;\n    }\n}\n// Required header for knowledge APIs\nconst documents_headers = {\n    'agw-js-conv': 'str'\n};\nclass Documents extends APIResource {\n    /**\n   * @deprecated  The method is deprecated and will be removed in a future version. Please use 'client.datasets.documents.list' instead.\n   *\n   * View the file list of a specified knowledge base, which includes lists of documents, spreadsheets, or images.\n   * | \n   * @docs en: https://www.coze.com/docs/developer_guides/list_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/list_knowledge_files?_lang=zh\n   * @param params.dataset_id - Required The ID of the knowledge base. |   ID\n   * @param params.page - Optional The page number for paginated queries. Default is 1. |   1\n   * @param params.page_size - Optional The size of pagination. Default is 10. |   10\n   * @returns ListDocumentData | \n   */ list(params, options) {\n        const apiUrl = '/open_api/knowledge/document/list';\n        const response = this._client.get(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_headers\n        }));\n        return response;\n    }\n    /**\n   * @deprecated  The method is deprecated and will be removed in a future version. Please use 'client.datasets.documents.create' instead.\n   *\n   * Upload files to the specific knowledge. | \n   * @docs en: https://www.coze.com/docs/developer_guides/create_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/create_knowledge_files?_lang=zh\n   * @param params.dataset_id - Required The ID of the knowledge. |   ID\n   * @param params.document_bases - Required The metadata information of the files awaiting upload. |  \n   * @param params.chunk_strategy - Required when uploading files to a new knowledge for the first time. Chunk strategy.\n   * |  \n   * @returns DocumentInfo[] | \n   */ async create(params, options) {\n        const apiUrl = '/open_api/knowledge/document/create';\n        const response = await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_headers\n        }));\n        return response.document_infos;\n    }\n    /**\n   * @deprecated  The method is deprecated and will be removed in a future version. Please use 'client.datasets.documents.delete' instead.\n   *\n   * Delete text, images, sheets, and other files in the knowledge base, supporting batch deletion.\n   * | \n   * @docs en: https://www.coze.com/docs/developer_guides/delete_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/delete_knowledge_files?_lang=zh\n   * @param params.document_ids - Required The list of knowledge base files to be deleted. |   ID\n   * @returns void | \n   */ async delete(params, options) {\n        const apiUrl = '/open_api/knowledge/document/delete';\n        await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_headers\n        }));\n    }\n    /**\n   * @deprecated  The method is deprecated and will be removed in a future version. Please use 'client.datasets.documents.update' instead.\n   *\n   * Modify the knowledge base file name and update strategy. | \n   * @docs en: https://www.coze.com/docs/developer_guides/modify_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/modify_knowledge_files?_lang=zh\n   * @param params.document_id - Required The ID of the knowledge base file. |   ID\n   * @param params.document_name - Optional The new name of the knowledge base file. |  \n   * @param params.update_rule - Optional The update strategy for online web pages. |  \n   * @returns void | \n   */ async update(params, options) {\n        const apiUrl = '/open_api/knowledge/document/update';\n        await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_headers\n        }));\n    }\n}\nclass Knowledge extends APIResource {\n    constructor(...args){\n        super(...args), /**\n   * @deprecated\n   */ this.documents = new Documents(this._client);\n    }\n}\n// Required header for knowledge APIs\nconst documents_documents_headers = {\n    'agw-js-conv': 'str'\n};\nclass documents_Documents extends APIResource {\n    /**\n   * View the file list of a specified knowledge base, which includes lists of documents, spreadsheets, or images.\n   * | \n   * @docs en: https://www.coze.com/docs/developer_guides/list_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/list_knowledge_files?_lang=zh\n   * @param params.dataset_id - Required The ID of the knowledge base. |   ID\n   * @param params.page - Optional The page number for paginated queries. Default is 1. |   1\n   * @param params.page_size - Optional The size of pagination. Default is 10. |   10\n   * @returns ListDocumentData | \n   */ async list(params, options) {\n        const apiUrl = '/open_api/knowledge/document/list';\n        const response = await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_documents_headers\n        }));\n        return response;\n    }\n    /**\n   * Upload files to the specific knowledge. | \n   * @docs en: https://www.coze.com/docs/developer_guides/create_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/create_knowledge_files?_lang=zh\n   * @param params.dataset_id - Required The ID of the knowledge. |   ID\n   * @param params.document_bases - Required The metadata information of the files awaiting upload. |  \n   * @param params.chunk_strategy - Required when uploading files to a new knowledge for the first time. Chunk strategy.\n   * |  \n   * @returns DocumentInfo[] | \n   */ async create(params, options) {\n        const apiUrl = '/open_api/knowledge/document/create';\n        const response = await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_documents_headers\n        }));\n        return response.document_infos;\n    }\n    /**\n   * Delete text, images, sheets, and other files in the knowledge base, supporting batch deletion.\n   * | \n   * @docs en: https://www.coze.com/docs/developer_guides/delete_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/delete_knowledge_files?_lang=zh\n   * @param params.document_ids - Required The list of knowledge base files to be deleted. |   ID\n   * @returns void | \n   */ async delete(params, options) {\n        const apiUrl = '/open_api/knowledge/document/delete';\n        await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_documents_headers\n        }));\n    }\n    /**\n   * Modify the knowledge base file name and update strategy. | \n   * @docs en: https://www.coze.com/docs/developer_guides/modify_knowledge_files?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/modify_knowledge_files?_lang=zh\n   * @param params.document_id - Required The ID of the knowledge base file. |   ID\n   * @param params.document_name - Optional The new name of the knowledge base file. |  \n   * @param params.update_rule - Optional The update strategy for online web pages. |  \n   * @returns void | \n   */ async update(params, options) {\n        const apiUrl = '/open_api/knowledge/document/update';\n        await this._client.post(apiUrl, params, false, mergeConfig(options, {\n            headers: documents_documents_headers\n        }));\n    }\n}\nclass Images extends APIResource {\n    /**\n   * Update the description of an image in the knowledge base | \n   * @docs en: https://www.coze.com/docs/developer_guides/developer_guides/update_image_caption?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/developer_guides/update_image_caption?_lang=zh\n   * @param datasetId - The ID of the dataset |   ID\n   * @param documentId - The ID of the document |   ID\n   * @param params - The parameters for updating the image\n   * @param params.caption - Required. The description of the image |  \n   * @returns undefined\n   */ // eslint-disable-next-line max-params\n    async update(datasetId, documentId, params, options) {\n        const apiUrl = `/v1/datasets/${datasetId}/images/${documentId}`;\n        await this._client.put(apiUrl, params, false, options);\n    }\n    /**\n   * List images in the knowledge base | \n   * @docs en: https://www.coze.com/docs/developer_guides/developer_guides/get_images?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/developer_guides/get_images?_lang=zh\n   * @param datasetId - The ID of the dataset |   ID\n   * @param params - The parameters for listing images\n   * @param params.page_num - Optional. Page number for pagination, minimum value is 1, defaults to 1 |   1\n   * @param params.page_size - Optional. Number of items per page, range 1-299, defaults to 10 |   10\n   * @param params.keyword - Optional. Search keyword for image descriptions |  \n   * @param params.has_caption - Optional. Filter for images with/without captions |  /\n   */ async list(datasetId, params, options) {\n        const apiUrl = `/v1/datasets/${datasetId}/images`;\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n}\nclass Datasets extends APIResource {\n    /**\n   * Creates a new dataset | \n   * @docs en: https://www.coze.com/docs/developer_guides/create_dataset?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/create_dataset?_lang=zh\n   * @param params - The parameters for creating a dataset\n   * @param {string} params.name - Required. Dataset name, maximum length of 100 characters |   100 \n   * @param {string} params.space_id - Required. Space ID where the dataset belongs |   ID\n   * @param {number} params.format_type - Required. Dataset type (0: Text type, 2: Image type) |   (0: , 2: )\n   * @param {string} [params.description] - Optional. Dataset description |  \n   * @param {string} [params.file_id] - Optional. Dataset icon file ID from file upload\n   */ async create(params, options) {\n        const apiUrl = '/v1/datasets';\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Lists all datasets in a space | \n   * @docs en: https://www.coze.com/docs/developer_guides/list_dataset?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/list_dataset?_lang=zh\n   * @param params - The parameters for listing datasets | \n   * @param {string} params.space_id - Required. Space ID where the datasets belong |   ID\n   * @param {string} [params.name] - Optional. Dataset name for fuzzy search |  \n   * @param {number} [params.format_type] - Optional. Dataset type (0: Text type, 2: Image type) |   (0: , 2: )\n   * @param {number} [params.page_num] - Optional. Page number for pagination (default: 1) |   1\n   * @param {number} [params.page_size] - Optional. Number of items per page (default: 10) |   10\n   */ async list(params, options) {\n        const apiUrl = '/v1/datasets';\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Updates a dataset | \n   * @docs en: https://www.coze.com/docs/developer_guides/update_dataset?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/update_dataset?_lang=zh\n   * @param dataset_id - Required. The ID of the dataset to update |   ID\n   * @param params - Required. The parameters for updating the dataset |  \n   * @param params.name - Required. Dataset name, maximum length of 100 characters. |   100 \n   * @param params.file_id - Optional. Dataset icon, should pass the file_id obtained from the file upload interface. |   file_id\n   * @param params.description - Optional. Dataset description. |  \n   */ async update(dataset_id, params, options) {\n        const apiUrl = `/v1/datasets/${dataset_id}`;\n        await this._client.put(apiUrl, params, false, options);\n    }\n    /**\n   * Deletes a dataset | \n   * @docs en: https://www.coze.com/docs/developer_guides/delete_dataset?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/delete_dataset?_lang=zh\n   * @param dataset_id - Required. The ID of the dataset to delete |   ID\n   */ async delete(dataset_id, options) {\n        const apiUrl = `/v1/datasets/${dataset_id}`;\n        await this._client.delete(apiUrl, false, options);\n    }\n    /**\n   * Views the progress of dataset upload | \n   * @docs en: https://www.coze.com/docs/developer_guides/get_dataset_progress?_lang=en\n   * @docs zh: https://www.coze.cn/docs/developer_guides/get_dataset_progress?_lang=zh\n   * @param dataset_id - Required. The ID of the dataset to process |   ID\n   * @param params - Required. The parameters for processing the dataset |  \n   * @param params.dataset_ids - Required. List of dataset IDs |   ID \n   */ async process(dataset_id, params, options) {\n        const apiUrl = `/v1/datasets/${dataset_id}/process`;\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n    constructor(...args){\n        super(...args), this.documents = new documents_Documents(this._client), this.images = new Images(this._client);\n    }\n}\nclass Voices extends APIResource {\n    /**\n   * @description Clone a voice | \n   * @param params\n   * @param params.voice_name - Required. Voice name, cannot be empty and must be longer than 6 characters\n   * |  6\n   * @param params.file - Required. Audio file | \n   * @param params.audio_format - Required. Only supports \"wav\", \"mp3\", \"ogg\", \"m4a\", \"aac\", \"pcm\" formats\n   * |  \"wav\", \"mp3\", \"ogg\", \"m4a\", \"aac\", \"pcm\" \n   * @param params.language - Optional. Only supports \"zh\", \"en\" \"ja\" \"es\" \"id\" \"pt\" languages\n   * |  \"zh\", \"en\" \"ja\" \"es\" \"id\" \"pt\" \n   * @param params.voice_id - Optional. If provided, will train on existing voice and override previous training\n   * | \n   * @param params.preview_text - Optional. If provided, will generate preview audio based on this text, otherwise uses default text\n   * | \n   * @param params.text - Optional. Users can read this text, service will compare audio with text. Returns error if difference is too large\n   * | \n   * @param params.space_id - Optional.  The space id of the voice. | ID\n   * @param params.description- Optional. The description of the voice. | \n   * @param options - Request options\n   * @returns Clone voice data\n   */ async clone(params, options) {\n        const apiUrl = '/v1/audio/voices/clone';\n        const response = await this._client.post(apiUrl, (0, __WEBPACK_EXTERNAL_MODULE_axios__.toFormData)(params), false, options);\n        return response.data;\n    }\n    /**\n   * @description List voices | \n   * @param params\n   * @param params.filter_system_voice - Optional. Whether to filter system voices, default is false\n   * | , \n   * @param params.page_num - Optional. Starts from 1 by default, value must be > 0\n   * |  1  > 0\n   * @param params.page_size - Optional. Default is 100, value must be (0, 100]\n   * |  100 (0, 100]\n   * @param params.model_type - Optional. The type of the voice model, if not filled, all will be returned.\n   * @param options - Request options\n   * @returns List voices data\n   */ async list(params, options) {\n        const apiUrl = '/v1/audio/voices';\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n}\nclass Transcriptions extends APIResource {\n    /**\n   * ASR voice to text | ASR \n   * @param params - Required The parameters for file upload | \n   * @param params.file - Required The audio file to be uploaded. | \n   */ async create(params, options) {\n        const apiUrl = '/v1/audio/transcriptions';\n        const response = await this._client.post(apiUrl, (0, __WEBPACK_EXTERNAL_MODULE_axios__.toFormData)(params), false, options);\n        return response.data;\n    }\n}\nclass Speech extends APIResource {\n    /**\n   * @description Speech synthesis | \n   * @param params\n   * @param params.input - Required. Text to generate audio | \n   * @param params.voice_id - Required. Voice ID |  ID\n   * @param params.response_format - Optional. Audio encoding format,\n   * supports \"wav\", \"pcm\", \"ogg\", \"opus\", \"mp3\", default is \"mp3\"\n   * |  \"wav\", \"pcm\", \"ogg\", \"opus\", \"mp3\" \"mp3\"\n   * @param options - Request options\n   * @returns Speech synthesis data\n   */ async create(params, options) {\n        const apiUrl = '/v1/audio/speech';\n        const response = await this._client.post(apiUrl, {\n            ...params,\n            sample_rate: params.sample_rate || 24000\n        }, false, mergeConfig(options, {\n            responseType: 'arraybuffer'\n        }));\n        return response;\n    }\n}\nclass Rooms extends APIResource {\n    async create(params, options) {\n        const apiUrl = '/v1/audio/rooms';\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n}\nvar rooms_RoomMode = /*#__PURE__*/ function(RoomMode) {\n    RoomMode[\"Default\"] = \"default\";\n    RoomMode[\"S2S\"] = \"s2s\";\n    RoomMode[\"Podcast\"] = \"podcast\";\n    RoomMode[\"Translate\"] = \"translate\";\n    return RoomMode;\n}({});\nclass VoiceprintFeature extends APIResource {\n    /**\n   * Create voiceprint feature\n   */ async create(groupId, params, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}/features`;\n        const response = await this._client.post(apiUrl, (0, __WEBPACK_EXTERNAL_MODULE_axios__.toFormData)(params), false, options);\n        return response.data;\n    }\n    /**\n   * Update voiceprint feature\n   */ // eslint-disable-next-line max-params\n    async update(groupId, featureId, params, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}/features/${featureId}`;\n        const response = await this._client.put(apiUrl, (0, __WEBPACK_EXTERNAL_MODULE_axios__.toFormData)(params), false, options);\n        return response.data;\n    }\n    /**\n   * Delete voiceprint feature\n   */ async delete(groupId, featureId, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}/features/${featureId}`;\n        const response = await this._client.delete(apiUrl, false, options);\n        return response.data;\n    }\n    /**\n   * Get voiceprint feature list\n   */ async list(groupId, params, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}/features`;\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Speaker identification\n   */ async speakerIdentify(groupId, params, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}/speaker_identify`;\n        const response = await this._client.post(apiUrl, (0, __WEBPACK_EXTERNAL_MODULE_axios__.toFormData)(params), false, options);\n        return response.data;\n    }\n}\nclass VoiceprintGroups extends APIResource {\n    /**\n   * Create voiceprint group\n   */ async create(params, options) {\n        const apiUrl = '/v1/audio/voiceprint_groups';\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Get voiceprint group list\n   */ async list(params, options) {\n        const apiUrl = '/v1/audio/voiceprint_groups';\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Update voiceprint group\n   */ async update(groupId, params, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}`;\n        const response = await this._client.put(apiUrl, params, false, options);\n        return response.data;\n    }\n    /**\n   * Delete voiceprint group\n   */ async delete(groupId, options) {\n        const apiUrl = `/v1/audio/voiceprint_groups/${groupId}`;\n        const response = await this._client.delete(apiUrl, false, options);\n        return response.data;\n    }\n    constructor(...args){\n        super(...args), this.features = new VoiceprintFeature(this._client);\n    }\n}\nclass Live extends APIResource {\n    /**\n   *  \n   */ async retrieve(liveId, options) {\n        const apiUrl = `/v1/audio/live/${liveId}`;\n        const response = await this._client.get(apiUrl, void 0, false, options);\n        return response.data;\n    }\n}\nvar live_LiveType = /*#__PURE__*/ function(LiveType) {\n    LiveType[\"Origin\"] = \"origin\";\n    LiveType[\"Translation\"] = \"translation\";\n    return LiveType;\n}({});\nclass Audio extends APIResource {\n    constructor(...args){\n        super(...args), this.rooms = new Rooms(this._client), this.live = new Live(this._client), this.voices = new Voices(this._client), this.speech = new Speech(this._client), this.transcriptions = new Transcriptions(this._client), this.voiceprintGroups = new VoiceprintGroups(this._client);\n    }\n}\nclass Templates extends APIResource {\n    /**\n   * Duplicate a template. | \n   * @param templateId - Required. The ID of the template to duplicate. |  ID\n   * @param params - Optional. The parameters for the duplicate operation. | \n   * @param params.workspace_id - Required. The ID of the workspace to duplicate the template into. |  ID\n   * @param params.name - Optional. The name of the new template. | \n   * @returns TemplateDuplicateRes | \n   */ async duplicate(templateId, params, options) {\n        const apiUrl = `/v1/templates/${templateId}/duplicate`;\n        const response = await this._client.post(apiUrl, params, false, options);\n        return response.data;\n    }\n}\nvar templates_TemplateEntityType = /*#__PURE__*/ function(TemplateEntityType) {\n    TemplateEntityType[\"AGENT\"] = \"agent\";\n    return TemplateEntityType;\n}({});\nclass chat_Chat extends APIResource {\n    async create(req, options) {\n        const apiUrl = buildWebsocketUrl('/v1/chat', req);\n        return await this._client.makeWebsocket(apiUrl, options);\n    }\n}\nclass transcriptions_Transcriptions extends APIResource {\n    async create(req, options) {\n        const apiUrl = buildWebsocketUrl('/v1/audio/transcriptions', req);\n        return await this._client.makeWebsocket(apiUrl, options);\n    }\n}\nclass speech_Speech extends APIResource {\n    async create(req, options) {\n        const apiUrl = buildWebsocketUrl('/v1/audio/speech', req);\n        return await this._client.makeWebsocket(apiUrl, options);\n    }\n}\nclass SimultInterpretation extends APIResource {\n    async create(options) {\n        const apiUrl = '/v1/audio/simult_interpretation';\n        return await this._client.makeWebsocket(apiUrl, options);\n    }\n}\nclass audio_Audio extends APIResource {\n    constructor(...args){\n        super(...args), this.speech = new speech_Speech(this._client), this.transcriptions = new transcriptions_Transcriptions(this._client), this.simultInterpretation = new SimultInterpretation(this._client);\n    }\n}\n// Common types (not exported)\n// Keep all existing exports but use the base types where applicable\nvar types_WebsocketsEventType = /*#__PURE__*/ function(WebsocketsEventType) {\n    // Common\n    /** SDK error */ WebsocketsEventType[\"CLIENT_ERROR\"] = \"client_error\";\n    /** Connection closed */ WebsocketsEventType[\"CLOSED\"] = \"closed\";\n    /** All events */ WebsocketsEventType[\"ALL\"] = \"all\";\n    // Error\n    /** Received error event */ WebsocketsEventType[\"ERROR\"] = \"error\";\n    // v1/audio/speech\n    /** Send text to server */ WebsocketsEventType[\"INPUT_TEXT_BUFFER_APPEND\"] = \"input_text_buffer.append\";\n    /** No text to send, after audio all received, can close connection */ WebsocketsEventType[\"INPUT_TEXT_BUFFER_COMPLETE\"] = \"input_text_buffer.complete\";\n    /** Send speech config to server */ WebsocketsEventType[\"SPEECH_UPDATE\"] = \"speech.update\";\n    /** Received `speech.updated` event */ WebsocketsEventType[\"SPEECH_UPDATED\"] = \"speech.updated\";\n    /** After speech created */ WebsocketsEventType[\"SPEECH_CREATED\"] = \"speech.created\";\n    /** Received `input_text_buffer.complete` event */ WebsocketsEventType[\"INPUT_TEXT_BUFFER_COMPLETED\"] = \"input_text_buffer.completed\";\n    /** Received `speech.update` event */ WebsocketsEventType[\"SPEECH_AUDIO_UPDATE\"] = \"speech.audio.update\";\n    /** All audio received, can close connection */ WebsocketsEventType[\"SPEECH_AUDIO_COMPLETED\"] = \"speech.audio.completed\";\n    // v1/audio/transcriptions\n    /** Send audio to server */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_APPEND\"] = \"input_audio_buffer.append\";\n    /** No audio to send, after text all received, can close connection */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_COMPLETE\"] = \"input_audio_buffer.complete\";\n    /** Send transcriptions config to server */ WebsocketsEventType[\"TRANSCRIPTIONS_UPDATE\"] = \"transcriptions.update\";\n    /** Send `input_audio_buffer.clear` event */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_CLEAR\"] = \"input_audio_buffer.clear\";\n    /** After transcriptions created */ WebsocketsEventType[\"TRANSCRIPTIONS_CREATED\"] = \"transcriptions.created\";\n    /** Received `input_audio_buffer.complete` event */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_COMPLETED\"] = \"input_audio_buffer.completed\";\n    /** Received `transcriptions.update` event */ WebsocketsEventType[\"TRANSCRIPTIONS_MESSAGE_UPDATE\"] = \"transcriptions.message.update\";\n    /** All audio received, can close connection */ WebsocketsEventType[\"TRANSCRIPTIONS_MESSAGE_COMPLETED\"] = \"transcriptions.message.completed\";\n    /** Received `input_audio_buffer.cleared` event */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_CLEARED\"] = \"input_audio_buffer.cleared\";\n    /** Received `transcriptions.updated` event */ WebsocketsEventType[\"TRANSCRIPTIONS_UPDATED\"] = \"transcriptions.updated\";\n    // v1/chat\n    /** Send chat config to server */ WebsocketsEventType[\"CHAT_UPDATE\"] = \"chat.update\";\n    /** Send tool outputs to server */ WebsocketsEventType[\"CONVERSATION_CHAT_SUBMIT_TOOL_OUTPUTS\"] = \"conversation.chat.submit_tool_outputs\";\n    /** After chat created */ WebsocketsEventType[\"CHAT_CREATED\"] = \"chat.created\";\n    /** After chat updated */ WebsocketsEventType[\"CHAT_UPDATED\"] = \"chat.updated\";\n    /** Audio AST completed, chat started */ WebsocketsEventType[\"CONVERSATION_CHAT_CREATED\"] = \"conversation.chat.created\";\n    /** Message created */ WebsocketsEventType[\"CONVERSATION_MESSAGE_CREATE\"] = \"conversation.message.create\";\n    /** Clear conversation */ WebsocketsEventType[\"CONVERSATION_CLEAR\"] = \"conversation.clear\";\n    /** Chat in progress */ WebsocketsEventType[\"CONVERSATION_CHAT_IN_PROGRESS\"] = \"conversation.chat.in_progress\";\n    /** Get agent text message update */ WebsocketsEventType[\"CONVERSATION_MESSAGE_DELTA\"] = \"conversation.message.delta\";\n    /** Need plugin submit */ WebsocketsEventType[\"CONVERSATION_CHAT_REQUIRES_ACTION\"] = \"conversation.chat.requires_action\";\n    /** Message completed */ WebsocketsEventType[\"CONVERSATION_MESSAGE_COMPLETED\"] = \"conversation.message.completed\";\n    /** Get agent audio message update */ WebsocketsEventType[\"CONVERSATION_AUDIO_DELTA\"] = \"conversation.audio.delta\";\n    /** Audio message completed */ WebsocketsEventType[\"CONVERSATION_AUDIO_COMPLETED\"] = \"conversation.audio.completed\";\n    /** All message received, can close connection */ WebsocketsEventType[\"CONVERSATION_CHAT_COMPLETED\"] = \"conversation.chat.completed\";\n    /** Chat failed */ WebsocketsEventType[\"CONVERSATION_CHAT_FAILED\"] = \"conversation.chat.failed\";\n    /** Received `conversation.cleared` event */ WebsocketsEventType[\"CONVERSATION_CLEARED\"] = \"conversation.cleared\";\n    /** Speech started */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_SPEECH_STARTED\"] = \"input_audio_buffer.speech_started\";\n    /** Speech stopped */ WebsocketsEventType[\"INPUT_AUDIO_BUFFER_SPEECH_STOPPED\"] = \"input_audio_buffer.speech_stopped\";\n    /** Chat interrupted by client */ WebsocketsEventType[\"CONVERSATION_CHAT_CANCEL\"] = \"conversation.chat.cancel\";\n    /** Chat canceled */ WebsocketsEventType[\"CONVERSATION_CHAT_CANCELED\"] = \"conversation.chat.canceled\";\n    /** Audio transcript update */ WebsocketsEventType[\"CONVERSATION_AUDIO_TRANSCRIPT_UPDATE\"] = \"conversation.audio_transcript.update\";\n    /** Audio transcript completed */ WebsocketsEventType[\"CONVERSATION_AUDIO_TRANSCRIPT_COMPLETED\"] = \"conversation.audio_transcript.completed\";\n    /** Audio sentence start */ WebsocketsEventType[\"CONVERSATION_AUDIO_SENTENCE_START\"] = \"conversation.audio.sentence_start\";\n    /** Audio dump */ WebsocketsEventType[\"DUMP_AUDIO\"] = \"dump.audio\";\n    // v1/audio/simult_interpretation\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_UPDATE\"] = \"simult_interpretation.update\";\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_CREATED\"] = \"simult_interpretation.created\";\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_UPDATED\"] = \"simult_interpretation.updated\";\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_AUDIO_DELTA\"] = \"simult_interpretation.audio.delta\";\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_TRANSCRIPTION_DELTA\"] = \"simult_interpretation.transcription.delta\";\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_TRANSLATION_DELTA\"] = \"simult_interpretation.translation.delta\";\n    WebsocketsEventType[\"SIMULT_INTERPRETATION_MESSAGE_COMPLETED\"] = \"simult_interpretation.message.completed\";\n    return WebsocketsEventType;\n}({});\nclass Websockets extends APIResource {\n    constructor(...args){\n        super(...args), this.audio = new audio_Audio(this._client), this.chat = new chat_Chat(this._client);\n    }\n}\nclass Variables extends APIResource {\n    /**\n   * Set values for user variables\n   * @docs en: https://www.coze.com/open/docs/developer_guides/update_variable\n   * @docs zh: https://www.coze.cn/open/docs/developer_guides/update_variable\n   * @param params - The parameters for the variable update\n   * @param options - Optional request options\n   */ async update(params, options) {\n        const apiUrl = '/v1/variables';\n        await this._client.put(apiUrl, params, false, options);\n    }\n    /**\n   * Get the values of user variables\n   * @docs en: https://www.coze.com/open/docs/developer_guides/read_variable\n   * @docs zh: https://www.coze.cn/open/docs/developer_guides/read_variable\n   * @param params - The parameters for the variable retrieval\n   * @param options - Optional request options\n   */ async retrieve(params, options) {\n        const apiUrl = '/v1/variables';\n        const response = await this._client.get(apiUrl, params, false, options);\n        return response.data;\n    }\n}\n/**\n * Users client for interacting with user-related APIs\n */ class Users extends APIResource {\n    /**\n   * Get information about the authenticated user.\n   * @param options - Optional request configuration options.\n   * @returns Information about the authenticated user.\n   */ async me(options) {\n        const apiUrl = '/v1/users/me';\n        const result = await this._client.get(apiUrl, void 0, false, options);\n        return result.data;\n    }\n}\nclass WebSocketAPI {\n    // Standard WebSocket properties\n    get readyState() {\n        return this.rws.readyState;\n    }\n    // Standard WebSocket methods\n    send(data) {\n        return this.rws.send(JSON.stringify(data));\n    }\n    close(code, reason) {\n        return this.rws.close(code, reason);\n    }\n    reconnect(code, reason) {\n        return this.rws.reconnect(code, reason);\n    }\n    // Event listener methods\n    addEventListener(type, listener) {\n        this.rws.addEventListener(type, listener);\n    }\n    removeEventListener(type, listener) {\n        this.rws.removeEventListener(type, listener);\n    }\n    constructor(url, options = {}){\n        // Event handler methods\n        this.onmessage = null;\n        this.onopen = null;\n        this.onclose = null;\n        this.onerror = null;\n        const separator = url.includes('?') ? '&' : '?';\n        const { authorization } = options.headers || {};\n        // Get the appropriate WebSocket implementation\n        let WebSocketImpl;\n        if (isUniApp()) {\n            // Use MiniApp WebSocket implementation\n            const factory = 'function' == typeof getMiniAppWebSocketFactory ? getMiniAppWebSocketFactory() : null;\n            WebSocketImpl = factory ? factory.getWebSocketImplementation() : window.WebSocket;\n        } else // Use browser's native WebSocket\n        WebSocketImpl = isBrowser() ? window.WebSocket : class extends __WEBPACK_EXTERNAL_MODULE_ws__[\"default\"] {\n            constructor(url2, protocols){\n                super(url2, protocols, {\n                    headers: options.headers\n                });\n            }\n        };\n        this.rws = new __WEBPACK_EXTERNAL_MODULE_reconnecting_websocket__[\"default\"](`${url}${separator}authorization=${authorization}`, [], {\n            WebSocket: WebSocketImpl,\n            ...options\n        });\n        this.rws.addEventListener('message', (event)=>{\n            try {\n                var _this_onmessage, _this;\n                const data = JSON.parse(event.data);\n                null === (_this_onmessage = (_this = this).onmessage) || void 0 === _this_onmessage || _this_onmessage.call(_this, data, event);\n            } catch (error) {\n                console.error('WebSocketAPI onmessage error', error);\n            }\n        });\n        this.rws.addEventListener('open', (event)=>{\n            var _this_onopen, _this;\n            null === (_this_onopen = (_this = this).onopen) || void 0 === _this_onopen || _this_onopen.call(_this, event);\n        });\n        this.rws.addEventListener('close', (event)=>{\n            var _this_onclose, _this;\n            null === (_this_onclose = (_this = this).onclose) || void 0 === _this_onclose || _this_onclose.call(_this, event);\n        });\n        this.rws.addEventListener('error', (event)=>{\n            var _event_target__req_res, _event_target__req, _event_target, _event_target__req_res1, _event_target__req1, _event_target1, _this_onerror, _this;\n            const { readyState } = this.rws;\n            if (3 === readyState) return;\n            const statusCode = null === (_event_target = event.target) || void 0 === _event_target ? void 0 : null === (_event_target__req = _event_target._req) || void 0 === _event_target__req ? void 0 : null === (_event_target__req_res = _event_target__req.res) || void 0 === _event_target__req_res ? void 0 : _event_target__req_res.statusCode;\n            const rawHeaders = (null === (_event_target1 = event.target) || void 0 === _event_target1 ? void 0 : null === (_event_target__req1 = _event_target1._req) || void 0 === _event_target__req1 ? void 0 : null === (_event_target__req_res1 = _event_target__req1.res) || void 0 === _event_target__req_res1 ? void 0 : _event_target__req_res1.rawHeaders) || [];\n            const logidIndex = rawHeaders.findIndex((header)=>'X-Tt-Logid' === header);\n            const logid = -1 !== logidIndex ? rawHeaders[logidIndex + 1] : void 0;\n            const error = {\n                id: '0',\n                event_type: types_WebsocketsEventType.ERROR,\n                data: {\n                    code: -1,\n                    msg: 'WebSocket error'\n                },\n                detail: {\n                    logid\n                }\n            };\n            if (401 === statusCode) {\n                error.data.code = 401;\n                error.data.msg = 'Unauthorized';\n            } else if (403 === statusCode) {\n                error.data.code = 403;\n                error.data.msg = 'Forbidden';\n            } else {\n                error.data.code = 500;\n                var _event_error;\n                error.data.msg = String(null !== (_event_error = null == event ? void 0 : event.error) && void 0 !== _event_error ? _event_error : '') || 'WebSocket error';\n            }\n            null === (_this_onerror = (_this = this).onerror) || void 0 === _this_onerror || _this_onerror.call(_this, error, event);\n        });\n    }\n}\nvar package_namespaceObject = JSON.parse('{\"name\":\"@coze/api\",\"version\":\"1.3.5\",\"description\":\"Official Coze Node.js SDK for seamless AI integration into your applications |  Node.js SDK AI \",\"keywords\":[\"coze\",\"ai\",\"nodejs\",\"sdk\",\"chatbot\",\"typescript\"],\"homepage\":\"https://github.com/coze-dev/coze-js/tree/main/packages/coze-js\",\"bugs\":{\"url\":\"https://github.com/coze-dev/coze-js/issues\"},\"repository\":{\"type\":\"git\",\"url\":\"https://github.com/coze-dev/coze-js.git\",\"directory\":\"packages/coze-js\"},\"license\":\"MIT\",\"author\":\"Leeight <leeight@gmail.com>\",\"exports\":{\".\":\"./src/index.ts\",\"./ws-tools\":\"./src/ws-tools/index.ts\"},\"main\":\"src/index.ts\",\"unpkg\":\"dist/umd/index.js\",\"module\":\"src/index.ts\",\"browser\":{\"crypto\":false,\"os\":false,\"jsonwebtoken\":false,\"node-fetch\":false,\"ws\":false},\"typesVersions\":{\"*\":{\".\":[\"dist/types/index.d.ts\"],\"ws-tools\":[\"dist/types/ws-tools/ws-tools/index.d.ts\"]}},\"files\":[\"dist\",\"LICENSE\",\"README.md\",\"README.zh-CN.md\"],\"scripts\":{\"build\":\"rslib build\",\"format\":\"prettier --write .\",\"lint\":\"eslint ./ --cache --quiet\",\"start\":\"rslib build -w\",\"test\":\"vitest\",\"test:cov\":\"vitest --coverage --run\"},\"dependencies\":{\"agora-extension-ai-denoiser\":\"^1.0.0\",\"agora-rtc-sdk-ng\":\"4.23.2-1\",\"agora-rte-extension\":\"^1.2.4\",\"jsonwebtoken\":\"^9.0.2\",\"node-fetch\":\"^2.x\",\"opus-encdec\":\"^0.1.1\",\"reconnecting-websocket\":\"^4.4.0\",\"uuid\":\"^10.0.0\",\"ws\":\"^8.11.0\"},\"devDependencies\":{\"@coze-infra/eslint-config\":\"workspace:*\",\"@coze-infra/ts-config\":\"workspace:*\",\"@coze-infra/vitest-config\":\"workspace:*\",\"@rslib/core\":\"0.0.18\",\"@swc/core\":\"^1.3.14\",\"@types/jsonwebtoken\":\"^9.0.0\",\"@types/node\":\"^20\",\"@types/node-fetch\":\"^2.x\",\"@types/uuid\":\"^9.0.1\",\"@types/whatwg-fetch\":\"^0.0.33\",\"@types/ws\":\"^8.5.1\",\"@vitest/coverage-v8\":\"~2.1.9\",\"axios\":\"^1.7.7\",\"typescript\":\"^5.5.3\",\"vitest\":\"~2.1.9\"},\"peerDependencies\":{\"axios\":\"^1.7.1\"},\"publishConfig\":{\"access\":\"public\",\"registry\":\"https://registry.npmjs.org\"},\"cozePublishConfig\":{\"exports\":{\".\":{\"require\":\"./dist/cjs/index.js\",\"import\":\"./dist/esm/index.mjs\",\"types\":\"./dist/types/index.d.ts\"},\"./ws-tools\":{\"require\":\"./dist/cjs/ws-tools/index.js\",\"import\":\"./dist/esm/ws-tools/index.mjs\",\"types\":\"./dist/types/ws-tools/ws-tools/index.d.ts\"}},\"main\":\"dist/cjs/index.js\",\"module\":\"dist/esm/index.mjs\",\"types\":\"dist/types/index.d.ts\"},\"overrides\":{\"agora-extension-ai-denoiser\":{\"agora-rtc-sdk-ng\":\"$agora-rtc-sdk-ng\"}}}'); // CONCATENATED MODULE: ./src/version.ts\nconst { version: version_version } = package_namespaceObject;\nconst getEnv = ()=>{\n    const nodeVersion = process.version.slice(1); // Remove 'v' prefix\n    const { platform } = process;\n    let osName = platform.toLowerCase();\n    let osVersion = __WEBPACK_EXTERNAL_MODULE_os__[\"default\"].release();\n    if ('darwin' === platform) {\n        osName = 'macos';\n        // Try to parse the macOS version\n        try {\n            const darwinVersion = __WEBPACK_EXTERNAL_MODULE_os__[\"default\"].release().split('.');\n            if (darwinVersion.length >= 2) {\n                const majorVersion = parseInt(darwinVersion[0], 10);\n                if (!isNaN(majorVersion) && majorVersion >= 9) {\n                    const macVersion = majorVersion - 9;\n                    osVersion = `10.${macVersion}.${darwinVersion[1]}`;\n                }\n            }\n        } catch (error) {\n        // Keep the default os.release() value if parsing fails\n        }\n    } else if ('win32' === platform) {\n        osName = 'windows';\n        osVersion = __WEBPACK_EXTERNAL_MODULE_os__[\"default\"].release();\n    } else if ('linux' === platform) {\n        osName = 'linux';\n        osVersion = __WEBPACK_EXTERNAL_MODULE_os__[\"default\"].release();\n    }\n    return {\n        osName,\n        osVersion,\n        nodeVersion\n    };\n};\nconst getUserAgent = ()=>{\n    const { nodeVersion, osName, osVersion } = getEnv();\n    return `coze-js/${version_version} node/${nodeVersion} ${osName}/${osVersion}`.toLowerCase();\n};\nconst getNodeClientUserAgent = ()=>{\n    const { osVersion, nodeVersion, osName } = getEnv();\n    const ua = {\n        version: version_version,\n        lang: 'node',\n        lang_version: nodeVersion,\n        os_name: osName,\n        os_version: osVersion\n    };\n    return JSON.stringify(ua);\n};\nconst getBrowserClientUserAgent = ()=>{\n    const browserInfo = {\n        name: 'unknown',\n        version: 'unknown'\n    };\n    const osInfo = {\n        name: 'unknown',\n        version: 'unknown'\n    };\n    const { userAgent } = navigator;\n    if (userAgent) {\n        // \n        if (userAgent.indexOf('Windows') > -1) {\n            var _userAgent_match;\n            osInfo.name = 'windows';\n            const windowsVersion = (null === (_userAgent_match = userAgent.match(/Windows NT ([0-9.]+)/)) || void 0 === _userAgent_match ? void 0 : _userAgent_match[1]) || 'unknown';\n            osInfo.version = windowsVersion;\n        } else if (userAgent.indexOf('Mac OS X') > -1) {\n            var _userAgent_match1;\n            osInfo.name = 'macos';\n            //  10_15_7  10.15.7\n            osInfo.version = ((null === (_userAgent_match1 = userAgent.match(/Mac OS X ([0-9_]+)/)) || void 0 === _userAgent_match1 ? void 0 : _userAgent_match1[1]) || 'unknown').replace(/_/g, '.');\n        } else if (userAgent.indexOf('Linux') > -1) {\n            var _userAgent_match2;\n            osInfo.name = 'linux';\n            osInfo.version = (null === (_userAgent_match2 = userAgent.match(/Linux ([0-9.]+)/)) || void 0 === _userAgent_match2 ? void 0 : _userAgent_match2[1]) || 'unknown';\n        }\n        // \n        if (userAgent.indexOf('Chrome') > -1) {\n            var _userAgent_match3;\n            browserInfo.name = 'chrome';\n            browserInfo.version = (null === (_userAgent_match3 = userAgent.match(/Chrome\\/([0-9.]+)/)) || void 0 === _userAgent_match3 ? void 0 : _userAgent_match3[1]) || 'unknown';\n        } else if (userAgent.indexOf('Firefox') > -1) {\n            var _userAgent_match4;\n            browserInfo.name = 'firefox';\n            browserInfo.version = (null === (_userAgent_match4 = userAgent.match(/Firefox\\/([0-9.]+)/)) || void 0 === _userAgent_match4 ? void 0 : _userAgent_match4[1]) || 'unknown';\n        } else if (userAgent.indexOf('Safari') > -1) {\n            var _userAgent_match5;\n            browserInfo.name = 'safari';\n            browserInfo.version = (null === (_userAgent_match5 = userAgent.match(/Version\\/([0-9.]+)/)) || void 0 === _userAgent_match5 ? void 0 : _userAgent_match5[1]) || 'unknown';\n        }\n    }\n    const ua = {\n        version: version_version,\n        browser: browserInfo.name,\n        browser_version: browserInfo.version,\n        os_name: osInfo.name,\n        os_version: osInfo.version\n    };\n    return JSON.stringify(ua);\n};\n// Get UniApp client user agent\nconst getUniAppClientUserAgent = ()=>{\n    // Get system info\n    if (!(null == uni ? void 0 : uni.getSystemInfoSync)) return JSON.stringify({});\n    const systemInfo = uni.getSystemInfoSync();\n    const platformInfo = {\n        name: 'unknown',\n        version: 'unknown'\n    };\n    const osInfo = {\n        name: 'unknown',\n        version: 'unknown'\n    };\n    // Handle operating system info\n    if ('android' === systemInfo.platform) {\n        osInfo.name = 'android';\n        osInfo.version = systemInfo.system || 'unknown';\n    } else if ('ios' === systemInfo.platform) {\n        osInfo.name = 'ios';\n        osInfo.version = systemInfo.system || 'unknown';\n    } else if ('windows' === systemInfo.platform) {\n        osInfo.name = 'windows';\n        osInfo.version = systemInfo.system || 'unknown';\n    } else if ('mac' === systemInfo.platform) {\n        osInfo.name = 'macos';\n        osInfo.version = systemInfo.system || 'unknown';\n    } else {\n        // Other platforms use platform name directly\n        osInfo.name = systemInfo.platform;\n        osInfo.version = systemInfo.system || 'unknown';\n    }\n    // Handle app/platform info\n    if (systemInfo.AppPlatform) {\n        // App environment\n        platformInfo.name = systemInfo.AppPlatform.toLowerCase();\n        platformInfo.version = systemInfo.appVersion || 'unknown';\n    } else if (systemInfo.uniPlatform) {\n        // UniApp recognized platform\n        platformInfo.name = systemInfo.uniPlatform;\n        platformInfo.version = systemInfo.SDKVersion || 'unknown';\n    } else {\n        // Try to determine platform type from environment\n        const { appName, appVersion } = systemInfo;\n        if (appName) {\n            platformInfo.name = appName.toLowerCase();\n            platformInfo.version = appVersion || 'unknown';\n        }\n    }\n    const ua = {\n        version: version_version,\n        framework: 'uniapp',\n        platform: platformInfo.name,\n        platform_version: platformInfo.version,\n        os_name: osInfo.name,\n        os_version: osInfo.version,\n        screen_width: systemInfo.screenWidth,\n        screen_height: systemInfo.screenHeight,\n        device_model: systemInfo.model,\n        device_brand: systemInfo.brand\n    };\n    return JSON.stringify(ua);\n};\n/**\n * default coze  base URL is api.coze.com\n */ const COZE_COM_BASE_URL = 'https://api.coze.com';\n/**\n * change to api.coze.cn if you use https://coze.cn\n */ const COZE_CN_BASE_URL = 'https://api.coze.cn';\n/**\n * default base websocket URL is wss://ws.coze.com\n */ const COZE_COM_BASE_WS_URL = 'wss://ws.coze.com';\n/**\n * change to wss://ws.coze.cn if you use https://coze.cn\n */ const COZE_CN_BASE_WS_URL = 'wss://ws.coze.cn';\nconst POLL_INTERVAL = 5000;\nconst MAX_POLL_INTERVAL = 30000;\n/* eslint-disable @typescript-eslint/no-explicit-any */ const handleError = (error)=>{\n    if (!error.isAxiosError && (!error.code || !error.message)) return APIError.generate(500, void 0, `Unexpected error: ${error.message}`, void 0);\n    if ('ECONNABORTED' === error.code && error.message.includes('timeout') || 'ETIMEDOUT' === error.code) {\n        var _error_response;\n        return new TimeoutError(408, void 0, `Request timed out: ${error.message}`, null === (_error_response = error.response) || void 0 === _error_response ? void 0 : _error_response.headers);\n    }\n    if ('ERR_CANCELED' === error.code) return new APIUserAbortError(error.message);\n    else {\n        var _error_response1, _error_response2, _error_response3;\n        return APIError.generate((null === (_error_response1 = error.response) || void 0 === _error_response1 ? void 0 : _error_response1.status) || 500, null === (_error_response2 = error.response) || void 0 === _error_response2 ? void 0 : _error_response2.data, error.message, null === (_error_response3 = error.response) || void 0 === _error_response3 ? void 0 : _error_response3.headers);\n    }\n};\n// node-fetch is used for streaming requests\nconst adapterFetch = async (options)=>{\n    const response = await (0, __WEBPACK_EXTERNAL_MODULE_node_fetch__[\"default\"])(options.url, {\n        body: options.data,\n        ...options\n    });\n    return {\n        data: response.body,\n        ...response\n    };\n};\nconst isSupportNativeFetch = ()=>{\n    if (isBrowser() || isBrowserExtension() || isUniApp()) return true;\n    // native fetch is supported in node 18.0.0 or higher\n    const version = process.version.slice(1);\n    return compareVersions(version, '18.0.0') >= 0;\n};\nasync function fetchAPI(url) {\n    let options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n    const axiosInstance = options.axiosInstance || __WEBPACK_EXTERNAL_MODULE_axios__[\"default\"];\n    // Add version check for streaming requests\n    if (options.isStreaming && isAxiosStatic(axiosInstance)) {\n        const axiosVersion = axiosInstance.VERSION || __WEBPACK_EXTERNAL_MODULE_axios__[\"default\"].VERSION;\n        if (!axiosVersion || compareVersions(axiosVersion, '1.7.1') < 0) throw new CozeError('Streaming requests require axios version 1.7.1 or higher. Please upgrade your axios version.');\n    }\n    // Check for 4101 authentication error\n    // If BaseURL is set to overseas address, provide a warning to try setting it to the domestic address\n    const checkError = ()=>{\n        if (url.startsWith(COZE_COM_BASE_URL)) console.warn(`\n baseURL  ${COZE_CN_BASE_URL} \nnew CozeAPI({\n  // ...\n  baseURL: COZE_CN_BASE_URL\n})`);\n    };\n    const response = await axiosInstance({\n        url,\n        responseType: options.isStreaming ? 'stream' : 'json',\n        adapter: options.isStreaming ? isSupportNativeFetch() ? 'fetch' : adapterFetch : void 0,\n        ...options\n    }).catch((error)=>{\n        if ((null == error ? void 0 : error.status) === 401) checkError();\n        throw handleError(error);\n    });\n    return {\n        async *stream () {\n            try {\n                const stream = response.data;\n                const reader = stream[Symbol.asyncIterator] ? stream[Symbol.asyncIterator]() : stream.getReader();\n                const decoder = new TextDecoder();\n                const fieldValues = {};\n                let buffer = '';\n                while(true){\n                    const { done, value } = await (reader.next ? reader.next() : reader.read());\n                    if (done) {\n                        if (buffer) {\n                            // If the stream ends without a newline, it means an error occurred\n                            fieldValues.event = 'error';\n                            fieldValues.data = buffer;\n                            try {\n                                const error = JSON.parse(buffer);\n                                if ((null == error ? void 0 : error.code) === 4101) checkError();\n                            // eslint-disable-next-line no-empty\n                            } catch (e) {}\n                            yield fieldValues;\n                        }\n                        break;\n                    }\n                    buffer += decoder.decode(value, {\n                        stream: true\n                    });\n                    const lines = buffer.split('\\n');\n                    for(let i = 0; i < lines.length - 1; i++){\n                        const line = lines[i];\n                        const index = line.indexOf(':');\n                        if (-1 !== index) {\n                            const field = line.substring(0, index).trim();\n                            const content = line.substring(index + 1).trim();\n                            fieldValues[field] = content;\n                            if ('data' === field) yield fieldValues;\n                        }\n                    }\n                    buffer = lines[lines.length - 1]; // Keep the last incomplete line in the buffer\n                }\n            } catch (error) {\n                handleError(error);\n            }\n        },\n        json: ()=>response.data,\n        response\n    };\n}\n// Add version comparison utility\nfunction compareVersions(v1, v2) {\n    const v1Parts = v1.split('.').map(Number);\n    const v2Parts = v2.split('.').map(Number);\n    for(let i = 0; i < 3; i++){\n        const part1 = v1Parts[i] || 0;\n        const part2 = v2Parts[i] || 0;\n        if (part1 > part2) return 1;\n        if (part1 < part2) return -1;\n    }\n    return 0;\n}\nfunction isAxiosStatic(instance) {\n    return !!(null == instance ? void 0 : instance.Axios);\n}\n/* eslint-disable max-params */ class APIClient {\n    async getToken() {\n        if ('function' == typeof this.token) return await this.token();\n        return this.token;\n    }\n    async buildOptions(method, body, options) {\n        const token = await this.getToken();\n        const headers = {\n            authorization: `Bearer ${token}`\n        };\n        if (isUniApp()) headers['X-Coze-Client-User-Agent'] = getUniAppClientUserAgent();\n        else if (isBrowser() || isBrowserExtension()) headers['X-Coze-Client-User-Agent'] = getBrowserClientUserAgent();\n        else {\n            headers['User-Agent'] = getUserAgent();\n            headers['X-Coze-Client-User-Agent'] = getNodeClientUserAgent();\n        }\n        const config = mergeConfig(this.axiosOptions, options, {\n            headers\n        }, {\n            headers: this.headers || {}\n        });\n        config.method = method;\n        config.data = body;\n        return config;\n    }\n    async buildWebsocketOptions(options) {\n        const token = await this.getToken();\n        const headers = {\n            authorization: `Bearer ${token}`\n        };\n        if (isUniApp()) headers['X-Coze-Client-User-Agent'] = getUniAppClientUserAgent();\n        else if (isBrowser()) headers['X-Coze-Client-User-Agent'] = getBrowserClientUserAgent();\n        else {\n            headers['User-Agent'] = getUserAgent();\n            headers['X-Coze-Client-User-Agent'] = getNodeClientUserAgent();\n        }\n        var _this__config_debug;\n        const config = mergeConfig({\n            debug: null !== (_this__config_debug = this._config.debug) && void 0 !== _this__config_debug && _this__config_debug\n        }, this._config.websocketOptions, options, {\n            headers\n        }, {\n            headers: this.headers || {}\n        });\n        return config;\n    }\n    async makeRequest(apiUrl, method, body, isStream, options) {\n        const fullUrl = `${this.baseURL}${apiUrl}`;\n        try {\n            const fetchOptions = await this.buildOptions(method, body, options);\n            fetchOptions.isStreaming = isStream;\n            fetchOptions.axiosInstance = this.axiosInstance;\n            this.debugLog(null == options ? void 0 : options.debug, `--- request url: ${fullUrl}`);\n            this.debugLog(null == options ? void 0 : options.debug, '--- request options:', fetchOptions);\n            const { response, stream, json } = await fetchAPI(fullUrl, fetchOptions);\n            this.debugLog(null == options ? void 0 : options.debug, `--- response status: ${response.status}`);\n            this.debugLog(null == options ? void 0 : options.debug, '--- response headers: ', response.headers);\n            var _response_headers;\n            // Taro use `header`\n            const contentType = (null !== (_response_headers = response.headers) && void 0 !== _response_headers ? _response_headers : response.header)['content-type'];\n            if (isStream) {\n                if (contentType && contentType.includes('application/json')) {\n                    const result = await json();\n                    const { code, msg } = result;\n                    if (0 !== code && void 0 !== code) throw APIError.generate(response.status, result, msg, response.headers);\n                }\n                return stream();\n            }\n            if (!(contentType && contentType.includes('application/json'))) return await response.data;\n            {\n                const result = await json();\n                const { code, msg } = result;\n                if (0 !== code && void 0 !== code) throw APIError.generate(response.status, result, msg, response.headers);\n                return result;\n            }\n        } catch (error) {\n            var _this__config;\n            // Call the onApiError callback if provided\n            // This handles network errors and other exceptions not caught above\n            const onApiError = (null == options ? void 0 : options.onApiError) || (null === (_this__config = this._config) || void 0 === _this__config ? void 0 : _this__config.onApiError);\n            if (onApiError) onApiError(error);\n            // Re-throw the error after calling the callback\n            throw error;\n        }\n    }\n    async post(apiUrl, body) {\n        let isStream = arguments.length > 2 && void 0 !== arguments[2] && arguments[2], options = arguments.length > 3 ? arguments[3] : void 0;\n        return this.makeRequest(apiUrl, 'POST', body, isStream, options);\n    }\n    async get(apiUrl, param, isStream, options) {\n        // \n        const queryString = Object.entries(param || {}).filter((param)=>{\n            let [_, value] = param;\n            return null != value;\n        }).map((param)=>{\n            let [key, value] = param;\n            return `${key}=${value}`;\n        }).join('&');\n        return this.makeRequest(queryString ? `${apiUrl}${apiUrl.includes('?') ? '&' : '?'}${queryString}` : apiUrl, 'GET', void 0, isStream, options);\n    }\n    async put(apiUrl, body, isStream, options) {\n        return this.makeRequest(apiUrl, 'PUT', body, isStream, options);\n    }\n    async delete(apiUrl, isStream, options) {\n        return this.makeRequest(apiUrl, 'DELETE', void 0, isStream, options);\n    }\n    async makeWebsocket(apiUrl, options) {\n        const fullUrl = `${this.baseWsURL}${apiUrl}`;\n        const websocketOptions = await this.buildWebsocketOptions(options);\n        this.debugLog(null == options ? void 0 : options.debug, `--- websocket url: ${fullUrl}`);\n        this.debugLog(null == options ? void 0 : options.debug, '--- websocket options:', websocketOptions);\n        const ws = new WebSocketAPI(fullUrl, websocketOptions);\n        return ws;\n    }\n    getConfig() {\n        return this._config;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    debugLog() {\n        let forceDebug = arguments.length > 0 && void 0 !== arguments[0] && arguments[0];\n        for(var _len = arguments.length, msgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++)msgs[_key - 1] = arguments[_key];\n        if (this.debug || forceDebug) console.debug(...msgs);\n    }\n    constructor(config){\n        this._config = config;\n        this.baseURL = config.baseURL || COZE_COM_BASE_URL;\n        this.baseWsURL = config.baseWsURL || COZE_CN_BASE_WS_URL;\n        this.token = config.token;\n        this.axiosOptions = config.axiosOptions || {};\n        this.axiosInstance = config.axiosInstance;\n        this.debug = config.debug || false;\n        this.allowPersonalAccessTokenInBrowser = config.allowPersonalAccessTokenInBrowser || false;\n        this.headers = config.headers;\n        if (isBrowser() && 'function' != typeof this.token && isPersonalAccessToken(this.token) && !this.allowPersonalAccessTokenInBrowser) throw new CozeError('Browser environments do not support authentication using Personal Access Token (PAT) by default.\\nas it may expose secret API keys. \\n\\nPlease use OAuth2.0 authentication mechanism. see:\\nhttps://www.coze.com/docs/developer_guides/oauth_apps?_lang=en \\n\\nIf you need to force use, please set the `allowPersonalAccessTokenInBrowser` option to `true`. \\n\\ne.g new CozeAPI({ token, allowPersonalAccessTokenInBrowser: true });\\n\\n');\n    }\n}\nAPIClient.APIError = APIError;\nAPIClient.BadRequestError = BadRequestError;\nAPIClient.AuthenticationError = AuthenticationError;\nAPIClient.PermissionDeniedError = PermissionDeniedError;\nAPIClient.NotFoundError = NotFoundError;\nAPIClient.RateLimitError = RateLimitError;\nAPIClient.InternalServerError = InternalServerError;\nAPIClient.GatewayError = GatewayError;\nAPIClient.TimeoutError = TimeoutError;\nAPIClient.UserAbortError = APIUserAbortError;\nconst getCrypto = ()=>{\n    if (isUniApp()) return {\n        getRandomValues: uni.getRandomValues,\n        subtle: {\n            // TODO Currently not supporting uniapp, will provide support later if needed\n            digest: ()=>{\n                console.error('digest is not supported in uniapp');\n                throw new Error('digest is not supported in uniapp');\n            }\n        }\n    };\n    if (isBrowser() || isBrowserExtension()) {\n        if ('undefined' != typeof self && self.crypto) return self.crypto;\n        if ('undefined' != typeof window && window.crypto) return window.crypto;\n    }\n    // #ifndef MP\n    return {\n        getRandomValues: (array)=>__WEBPACK_EXTERNAL_MODULE_crypto__.randomFillSync(array),\n        subtle: __WEBPACK_EXTERNAL_MODULE_crypto__.subtle\n    };\n// #endif\n};\nconst generateRandomString = ()=>{\n    const array = new Uint8Array(32);\n    getCrypto().getRandomValues(array);\n    return Array.from(array, (byte)=>byte.toString(16).padStart(2, '0')).join('');\n};\nconst getWebAuthenticationUrl = (config)=>{\n    var _config_baseURL;\n    const baseUrl = (null !== (_config_baseURL = config.baseURL) && void 0 !== _config_baseURL ? _config_baseURL : COZE_COM_BASE_URL).replace('https://api', 'https://www');\n    var _config_state;\n    const params = new URLSearchParams({\n        response_type: 'code',\n        client_id: config.clientId,\n        redirect_uri: config.redirectUrl,\n        state: null !== (_config_state = config.state) && void 0 !== _config_state ? _config_state : ''\n    });\n    if (config.workspaceId) return `${baseUrl}/api/permission/oauth2/workspace_id/${config.workspaceId}/authorize?${params.toString()}`;\n    return `${baseUrl}/api/permission/oauth2/authorize?${params.toString()}`;\n};\nconst getPKCEAuthenticationUrl = async (config)=>{\n    var _config_baseURL;\n    const baseUrl = (null !== (_config_baseURL = config.baseURL) && void 0 !== _config_baseURL ? _config_baseURL : COZE_COM_BASE_URL).replace('https://api', 'https://www');\n    const crypto = getCrypto();\n    // Generate code_challenge from code_verifier\n    const generateCodeChallenge = async (codeVerifier)=>{\n        const encoder = new TextEncoder();\n        const data = encoder.encode(codeVerifier);\n        const hash = await crypto.subtle.digest('SHA-256', data);\n        return btoa(String.fromCharCode(...new Uint8Array(hash))).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n    };\n    // Generate a random code_verifier\n    const codeVerifier = generateRandomString();\n    const codeChallenge = await generateCodeChallenge(codeVerifier);\n    var _config_state;\n    const params = new URLSearchParams({\n        response_type: 'code',\n        client_id: config.clientId,\n        redirect_uri: config.redirectUrl,\n        state: null !== (_config_state = config.state) && void 0 !== _config_state ? _config_state : '',\n        code_challenge: codeChallenge,\n        code_challenge_method: config.code_challenge_method || 'S256'\n    });\n    if (config.workspaceId) return {\n        url: `${baseUrl}/api/permission/oauth2/workspace_id/${config.workspaceId}/authorize?${params.toString()}`,\n        codeVerifier\n    };\n    return {\n        url: `${baseUrl}/api/permission/oauth2/authorize?${params.toString()}`,\n        codeVerifier\n    };\n};\nconst getWebOAuthToken = async (config, options)=>{\n    const api = new APIClient({\n        token: config.clientSecret,\n        baseURL: config.baseURL\n    });\n    const apiUrl = '/api/permission/oauth2/token';\n    const payload = {\n        grant_type: 'authorization_code',\n        client_id: config.clientId,\n        redirect_uri: config.redirectUrl,\n        code: config.code\n    };\n    const result = await api.post(apiUrl, payload, false, options);\n    return result;\n};\nconst getPKCEOAuthToken = async (config, options)=>{\n    const api = new APIClient({\n        token: '',\n        baseURL: config.baseURL\n    });\n    const apiUrl = '/api/permission/oauth2/token';\n    const payload = {\n        grant_type: 'authorization_code',\n        client_id: config.clientId,\n        redirect_uri: config.redirectUrl,\n        code: config.code,\n        code_verifier: config.codeVerifier\n    };\n    const result = await api.post(apiUrl, payload, false, options);\n    return result;\n};\nconst refreshOAuthToken = async (config, options)=>{\n    const api = new APIClient({\n        token: config.clientSecret || '',\n        baseURL: config.baseURL\n    });\n    const apiUrl = '/api/permission/oauth2/token';\n    const payload = {\n        grant_type: 'refresh_token',\n        client_id: config.clientId,\n        refresh_token: config.refreshToken\n    };\n    const result = await api.post(apiUrl, payload, false, options);\n    return result;\n};\nconst getDeviceCode = async (config, options)=>{\n    if (isBrowser()) throw new Error('getDeviceCode is not supported in browser');\n    const api = new APIClient({\n        token: '',\n        baseURL: config.baseURL\n    });\n    let apiUrl;\n    apiUrl = config.workspaceId ? `/api/permission/oauth2/workspace_id/${config.workspaceId}/device/code` : '/api/permission/oauth2/device/code';\n    const payload = {\n        client_id: config.clientId\n    };\n    const result = await api.post(apiUrl, payload, false, options);\n    return result;\n};\nconst _getDeviceToken = async (config, options)=>{\n    const api = new APIClient({\n        token: '',\n        baseURL: config.baseURL\n    });\n    const apiUrl = '/api/permission/oauth2/token';\n    const payload = {\n        grant_type: 'urn:ietf:params:oauth:grant-type:device_code',\n        client_id: config.clientId,\n        device_code: config.deviceCode\n    };\n    const result = await api.post(apiUrl, payload, false, options);\n    return result;\n};\nconst getDeviceToken = async (config, options)=>{\n    if (isBrowser()) throw new Error('getDeviceToken is not supported in browser');\n    if (!config.poll) return _getDeviceToken(config, options);\n    let interval = POLL_INTERVAL;\n    while(true)try {\n        // Attempt to get the device token\n        const deviceToken = await _getDeviceToken(config, options);\n        return deviceToken;\n    } catch (error) {\n        if (error instanceof APIError) {\n            var _error_rawError, _error_rawError1;\n            // If the error is authorization_pending, continue polling\n            if ((null == error ? void 0 : null === (_error_rawError = error.rawError) || void 0 === _error_rawError ? void 0 : _error_rawError.error) === \"authorization_pending\") {\n                await sleep(interval);\n                continue;\n            // If the error is slow_down, increase the interval\n            }\n            if ((null == error ? void 0 : null === (_error_rawError1 = error.rawError) || void 0 === _error_rawError1 ? void 0 : _error_rawError1.error) === \"slow_down\") {\n                if (interval < MAX_POLL_INTERVAL) interval += POLL_INTERVAL;\n                await sleep(interval);\n                continue;\n            }\n        }\n        // For any other error, throw it\n        throw error;\n    }\n};\nconst _getJWTToken = async (config, options)=>{\n    const api = new APIClient({\n        token: config.token,\n        baseURL: config.baseURL\n    });\n    let apiUrl;\n    apiUrl = config.accountId ? `/api/permission/oauth2/account/${config.accountId}/token` : '/api/permission/oauth2/token';\n    var _config_durationSeconds;\n    const payload = {\n        grant_type: 'urn:ietf:params:oauth:grant-type:jwt-bearer',\n        duration_seconds: null !== (_config_durationSeconds = config.durationSeconds) && void 0 !== _config_durationSeconds ? _config_durationSeconds : 900,\n        scope: config.scope\n    };\n    const result = await api.post(apiUrl, payload, false, options);\n    return result;\n};\nconst getJWTToken = async (config, options)=>{\n    if (isBrowser()) throw new Error('getJWTToken is not supported in browser');\n    // Validate private key format\n    const keyFormat = config.privateKey.includes('BEGIN RSA PRIVATE KEY') ? 'RSA' : config.privateKey.includes('BEGIN PRIVATE KEY') ? 'PKCS8' : null;\n    if (!keyFormat) throw APIError.generate(400, void 0, 'Invalid private key format. Expected PEM format (RSA or PKCS8)', void 0);\n    // Prepare the payload for the JWT\n    const now = Math.floor(Date.now() / 1000);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const payload = {\n        iss: config.appId,\n        aud: config.aud,\n        iat: now,\n        exp: now + 3600,\n        jti: generateRandomString()\n    };\n    if (config.sessionName) payload.session_name = config.sessionName;\n    return new Promise((resolve, reject)=>{\n        var _config_algorithm;\n        __WEBPACK_EXTERNAL_MODULE_jsonwebtoken__[\"default\"].sign(payload, config.privateKey, {\n            algorithm: null !== (_config_algorithm = config.algorithm) && void 0 !== _config_algorithm ? _config_algorithm : 'RS256',\n            keyid: config.keyid\n        }, async (err, token)=>{\n            if (err || !token) {\n                reject(err);\n                return;\n            }\n            // Exchange the JWT for an OAuth token\n            try {\n                const result = await _getJWTToken({\n                    ...config,\n                    token\n                }, options);\n                resolve(result);\n            } catch (err2) {\n                reject(err2);\n            }\n        });\n    });\n};\nvar auth_PKCEAuthErrorType = /*#__PURE__*/ function(PKCEAuthErrorType) {\n    PKCEAuthErrorType[\"AUTHORIZATION_PENDING\"] = \"authorization_pending\";\n    PKCEAuthErrorType[\"SLOW_DOWN\"] = \"slow_down\";\n    PKCEAuthErrorType[\"ACCESS_DENIED\"] = \"access_denied\";\n    PKCEAuthErrorType[\"EXPIRED_TOKEN\"] = \"expired_token\";\n    return PKCEAuthErrorType;\n}({});\nclass CozeAPI extends APIClient {\n    constructor(...args){\n        super(...args), this.bots = new Bots(this), this.chat = new Chat(this), this.conversations = new Conversations(this), this.files = new Files(this), /**\n   * @deprecated\n   */ this.knowledge = new Knowledge(this), this.datasets = new Datasets(this), this.workflows = new Workflows(this), this.workspaces = new WorkSpaces(this), this.audio = new Audio(this), this.templates = new Templates(this), this.websockets = new Websockets(this), this.variables = new Variables(this), this.users = new Users(this);\n    }\n}\nexport { APIConnectionError, APIError, APIUserAbortError, Audio, AuthenticationError, BadRequestError, Bots, COZE_CN_BASE_URL, COZE_CN_BASE_WS_URL, COZE_COM_BASE_URL, COZE_COM_BASE_WS_URL, Chat, chat_ChatEventType as ChatEventType, chat_ChatStatus as ChatStatus, Conversations, CozeAPI, CozeError, Datasets, documents_Documents as Documents, Files, GatewayError, Images, InternalServerError, JSONParseError, Knowledge, Live, live_LiveType as LiveType, MAX_POLL_INTERVAL, messages_Messages as Messages, NotFoundError, Documents as OldDocuments, auth_PKCEAuthErrorType as PKCEAuthErrorType, POLL_INTERVAL, PermissionDeniedError, RateLimitError, chat_RoleType as RoleType, rooms_RoomMode as RoomMode, Rooms, Runs, bots_SuggestReplyMode as SuggestReplyMode, templates_TemplateEntityType as TemplateEntityType, Templates, TimeoutError, Transcriptions, Users, bots_VariableChannel as VariableChannel, bots_VariableType as VariableType, Variables, VoiceprintFeature, VoiceprintGroups, Voices, WebSocketAPI, Websockets, types_WebsocketsEventType as WebsocketsEventType, WorkSpaces, WorkflowChat, WorkflowEvent, runs_WorkflowEventType as WorkflowEventType, Workflows, _getJWTToken, adapterFetch, castToError, fetchAPI, getDeviceCode, getDeviceToken, getJWTToken, getPKCEAuthenticationUrl, getPKCEOAuthToken, getWebAuthenticationUrl, getWebOAuthToken, handleAdditionalMessages, handleParameters, refreshOAuthToken };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { type UserSenderInfo } from '@coze-common/chat-area';\n\nimport { useChatAppStore } from '../store';\nexport const useUserInfo = () => {\n  const userInfo = useChatAppStore(s => s.userInfo);\n\n  return useMemo<UserSenderInfo | null>(() => {\n    const openUserInfo = userInfo;\n    if (!openUserInfo) {\n      return {\n        id: nanoid(),\n        nickname: '',\n        url: '',\n        userUniqueName: '',\n        userLabel: null,\n      };\n    }\n\n    const areaUserInfo: UserSenderInfo = {\n      ...openUserInfo,\n      userUniqueName: '',\n      userLabel: null,\n    };\n\n    return areaUserInfo;\n  }, [userInfo]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useCallback, useEffect } from 'react';\n\nimport { useRequest } from 'ahooks';\n\ninterface PaginationParams {\n  page_num?: number;\n  page_size?: number;\n  [key: string]: unknown;\n}\n\ninterface PaginationResponse<T> {\n  data: T[];\n  has_more?: boolean;\n  total?: number;\n  [key: string]: unknown;\n}\n\ninterface UsePaginationRequestParams<T, P extends PaginationParams> {\n  requestFn: (params: P) => Promise<PaginationResponse<T>>;\n  requestParams: Omit<P, 'page_num' | 'page_size'>;\n  pageSize?: number;\n  initialPageNum?: number;\n  autoLoad?: boolean;\n  dataKey?: string;\n  hasMoreKey?: string;\n}\n\ninterface UsePaginationRequestReturn<T> {\n  data: T[];\n  loading: boolean;\n  error: Error | undefined;\n  hasMore: boolean;\n  currentPage: number;\n  loadMore: () => Promise<void>;\n  refresh: () => Promise<void>;\n  setPageNum: (pageNum: number) => void;\n  reset: () => Promise<void>;\n}\n\nexport const usePaginationRequest = <T, P extends PaginationParams>({\n  requestFn,\n  requestParams,\n  pageSize = 20,\n  initialPageNum = 1,\n  autoLoad = true,\n}: UsePaginationRequestParams<T, P>): UsePaginationRequestReturn<T> => {\n  const [currentPage, setCurrentPage] = useState(initialPageNum);\n  const [allData, setAllData] = useState<T[]>([]);\n  const [hasMore, setHasMore] = useState(true);\n\n  const { loading, error, run } = useRequest(\n    async (pageNum?: number) => {\n      const targetPage = pageNum ?? currentPage;\n      const params = {\n        ...requestParams,\n        page_size: pageSize,\n        page_num: targetPage,\n      };\n\n      const res = await requestFn(params as P);\n      return res;\n    },\n    {\n      manual: true,\n      onSuccess: (res, [pageNum]) => {\n        const targetPage = pageNum ?? currentPage;\n        const responseData = res.data;\n        const responseHasMore = !!res.has_more;\n\n        if (targetPage === 1) {\n          // \n          setAllData(responseData);\n        } else {\n          // \n          setAllData(prev => [...prev, ...responseData]);\n        }\n\n        setHasMore(responseHasMore);\n        setCurrentPage(targetPage);\n      },\n      onError: err => {\n        console.error(':', err);\n      },\n    },\n  );\n\n  const loadMore = useCallback(async () => {\n    if (!loading && hasMore) {\n      await run(currentPage + 1);\n    }\n  }, [loading, hasMore, currentPage, run]);\n\n  const refresh = useCallback(async () => {\n    setAllData([]);\n    setCurrentPage(1);\n    await run(1);\n  }, [run]);\n\n  const setPageNum = useCallback(\n    async (pageNum: number) => {\n      if (pageNum >= 1) {\n        await run(pageNum);\n      }\n    },\n    [run],\n  );\n\n  const reset = useCallback(async () => {\n    setAllData([]);\n    setCurrentPage(initialPageNum);\n    await setHasMore(false);\n  }, [initialPageNum]);\n\n  // \n  useEffect(() => {\n    if (autoLoad) {\n      run(initialPageNum);\n    }\n  }, [autoLoad, initialPageNum, run]);\n\n  return {\n    data: allData,\n    loading,\n    error,\n    hasMore,\n    currentPage,\n    loadMore,\n    refresh,\n    setPageNum,\n    reset,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useMemo } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport dayjs from 'dayjs';\nimport { type Conversation, type ListConversationReq } from '@coze/api';\n\nimport {\n  ConversationSort,\n  type SortedConversationItem,\n} from '@/types/conversations';\n\nimport { type ChatState } from '../store/store';\nimport { useChatAppProps, useChatAppStore } from '../store';\nimport { useUserInfo } from './use-user-info';\nimport { usePaginationRequest } from './use-pagination-request';\n\n// ListConversationReqPaginationParams\ntype ExtendedListConversationReq = ListConversationReq & {\n  sort_field: 'created_at' | 'updated_at';\n  user_id?: string; // \n  [key: string]: unknown;\n};\n\ninterface UseConversationListParams {\n  pageSize?: number;\n  initialPageNum?: number;\n  order?: ExtendedListConversationReq['sort_field'];\n}\n\ninterface UseConversationListReturn {\n  conversations: Conversation[];\n  loading: boolean;\n  hasMore: boolean;\n  loadMore: () => Promise<void>;\n}\n\nexport const useConversationList = (\n  conversationListParams?: UseConversationListParams,\n): UseConversationListReturn => {\n  const {\n    pageSize = 20,\n    initialPageNum = 1,\n    order = 'updated_at',\n  } = conversationListParams ?? {};\n  const {\n    chatConfig: { bot_id: botId, auth: { connectorId } = {} },\n  } = useChatAppProps();\n\n  const {\n    cozeApiSdk,\n    currentConversationInfo,\n    updateCurrentConversationInfo,\n    conversations,\n    updateConversations,\n  } = useChatAppStore(\n    useShallow(state => ({\n      cozeApiSdk: state.cozeApi,\n      conversations: state.conversations,\n      updateCurrentConversationInfo: state.updateCurrentConversationInfo,\n      currentConversationInfo: state.currentConversationInfo,\n      updateConversations: state.updateConversations,\n    })),\n  );\n\n  const userInfo = useUserInfo();\n\n  const { data, hasMore, loadMore, loading } = usePaginationRequest<\n    Conversation,\n    ExtendedListConversationReq\n  >({\n    requestFn: async params => {\n      if (!cozeApiSdk || !botId) {\n        return { data: [], has_more: false };\n      }\n      try {\n        const result = await cozeApiSdk.conversations.list(params);\n        return {\n          data: result.conversations,\n          has_more: result.has_more,\n        };\n      } catch (e) {\n        console.error(e);\n        return { data: [], has_more: false };\n      }\n    },\n    requestParams: {\n      bot_id: botId,\n      connector_id: connectorId,\n      sort_field: order,\n      user_id: IS_OPEN_SOURCE ? userInfo?.id : undefined,\n    },\n    pageSize,\n    initialPageNum,\n    autoLoad: !!cozeApiSdk && !!botId,\n  });\n\n  useEffect(() => {\n    if (data) {\n      updateConversations(data, 'replace');\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if (!currentConversationInfo && data.length > 0) {\n      const chatContainer = document.querySelector('.coze-chat-sdk');\n      let info: ChatState['currentConversationInfo'] = {\n        ...data[0],\n        conversationListVisible: false,\n        isLargeWidth: false,\n      };\n      if (chatContainer && (chatContainer as HTMLElement).offsetWidth >= 780) {\n        info = {\n          ...info,\n          conversationListVisible: true,\n          isLargeWidth: true,\n        };\n      }\n      updateCurrentConversationInfo(info);\n    }\n  }, [currentConversationInfo, data]);\n\n  return {\n    conversations,\n    loading,\n    hasMore,\n    loadMore,\n  };\n};\n\nexport const useGroupedConversations = (conversations: Conversation[]) => {\n  const sortedConversations: SortedConversationItem[] = useMemo(() => {\n    const today = new Date();\n    const oneDay = 24 * 60 * 60 * 1000;\n    const thirtyDays = 30 * oneDay;\n\n    const newConversationList = conversations\n      .map(item => {\n        const dateString = item.updated_at || item.created_at || 0;\n        const date = dayjs.unix(Number(dateString)).toDate();\n        const diff = today.getTime() - date.getTime();\n\n        if (today.toLocaleDateString() === date.toLocaleDateString()) {\n          return {\n            ...item,\n            sort: ConversationSort.Today,\n          };\n        } else if (diff < thirtyDays) {\n          return {\n            ...item,\n            sort: ConversationSort.In30days,\n          };\n        } else {\n          return {\n            ...item,\n            sort: ConversationSort.Others,\n          };\n        }\n      })\n      .sort((a, b) => {\n        if (a.sort !== b.sort) {\n          return a.sort - b.sort;\n        } else {\n          return (\n            dayjs.unix(Number(b.updated_at || b.created_at || 0)).valueOf() -\n            dayjs.unix(Number(a.updated_at || a.created_at || 0)).valueOf()\n          );\n        }\n      });\n\n    return newConversationList;\n  }, [conversations]);\n\n  const groupedConversations = useMemo(() => {\n    const groups = new Map<ConversationSort, SortedConversationItem[]>();\n    sortedConversations.forEach(conversation => {\n      if (!groups.has(conversation.sort)) {\n        groups.set(conversation.sort, []);\n      }\n      groups.get(conversation.sort)?.push(conversation);\n    });\n    return groups;\n  }, [sortedConversations]);\n\n  return groupedConversations;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit, IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nexport const MobileConversationOperate = ({\n  onRename,\n  onDelete,\n  visible,\n  children,\n}: {\n  onRename: () => void;\n  onDelete: () => void;\n  visible: boolean;\n  children: React.ReactNode;\n}) => (\n  <>\n    <Menu\n      trigger=\"custom\"\n      position=\"bottom\"\n      visible={visible}\n      render={\n        <Menu.SubMenu mode=\"menu\">\n          <Menu.Item\n            onClick={(_, e) => {\n              e.stopPropagation();\n              e.preventDefault();\n              onRename();\n            }}\n            icon={<IconCozEdit />}\n          >\n            {I18n.t('workflow_detail_node_rename', {}, '')}\n          </Menu.Item>\n          <Menu.Item\n            onClick={(_, e) => {\n              e.stopPropagation();\n              e.preventDefault();\n              onDelete();\n            }}\n            icon={<IconCozTrashCan color=\"var(--coz-fg-hglt-red)\" />}\n          >\n            <span style={{ color: 'var(--coz-fg-hglt-red)' }}>\n              {I18n.t('web_sdk_delete', {}, '')}\n            </span>\n          </Menu.Item>\n        </Menu.SubMenu>\n      }\n    >\n      {children}\n    </Menu>\n  </>\n);\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useRef, useState } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/coze-design';\nimport { type Conversation } from '@coze/api';\n\nimport {\n  conversationSortMap,\n  type SortedConversationItem,\n} from '@/types/conversations';\n\nimport { MobileConversationOperate } from './operate';\n\nimport s from './index.module.less';\n\nexport const MobileConversationItem = ({\n  isActive,\n  item,\n  shouldDisplayTime,\n  onConversationChange,\n  onRename,\n  onDelete,\n}: {\n  isActive: boolean;\n  item: SortedConversationItem;\n  shouldDisplayTime: boolean;\n  onConversationChange: (conversation: Conversation) => void;\n  onRename: (conversation: Conversation) => void;\n  onDelete: (conversation: Conversation) => void;\n}) => {\n  const [visible, setVisible] = useState(false);\n  const [isTouched, setIsTouched] = useState(false);\n  const longPressTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const longClickTimerRef = useRef<NodeJS.Timeout | null>(null);\n  // \n  const LONG_PRESS_DURATION = 500;\n  const LONG_CLICK_DURATION = 300;\n\n  const closeOperate = () => {\n    setVisible(false);\n    setIsTouched(false);\n  };\n\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    longPressTimerRef.current = setTimeout(() => {\n      setVisible(true);\n    }, LONG_PRESS_DURATION);\n    longClickTimerRef.current = setTimeout(() => {\n      setIsTouched(true);\n    }, LONG_CLICK_DURATION);\n  }, []);\n\n  const handleTouchEnd = useCallback((e: React.TouchEvent) => {\n    if (longClickTimerRef.current) {\n      clearTimeout(longClickTimerRef.current);\n      longClickTimerRef.current = null;\n    }\n    if (longPressTimerRef.current) {\n      clearTimeout(longPressTimerRef.current);\n      longPressTimerRef.current = null;\n    }\n  }, []);\n\n  const handleTouchMove = useCallback(() => {\n    if (longClickTimerRef.current) {\n      clearTimeout(longClickTimerRef.current);\n      longClickTimerRef.current = null;\n    }\n    // \n    if (longPressTimerRef.current) {\n      clearTimeout(longPressTimerRef.current);\n      closeOperate();\n      longPressTimerRef.current = null;\n    }\n  }, []);\n\n  return (\n    <div className={s['conversation-item']}>\n      {shouldDisplayTime ? (\n        <div className={s['conversation-item-time']}>\n          {conversationSortMap.get(item.sort)}\n        </div>\n      ) : null}\n      <MobileConversationOperate\n        onRename={() => {\n          onRename(item);\n          closeOperate();\n        }}\n        onDelete={() => {\n          onDelete(item);\n          closeOperate();\n        }}\n        visible={visible}\n      >\n        <div\n          className={cls(s['conversation-item-content'], {\n            [s['conversation-item-content-active']]: isActive,\n            [s['conversation-item-content-touched']]: isTouched,\n            [s['conversation-item-content-operate-visible']]: visible,\n          })}\n          onClick={() => {\n            if (visible) {\n              return;\n            }\n            onConversationChange(item);\n          }}\n          onTouchStart={handleTouchStart}\n          onTouchEnd={handleTouchEnd}\n          onTouchMove={handleTouchMove}\n          onContextMenu={e => {\n            e.preventDefault();\n          }}\n        >\n          <Typography.Text\n            style={{\n              flex: 1,\n            }}\n            ellipsis={{\n              showTooltip: {\n                opts: {\n                  content: item.name,\n                  style: {\n                    wordBreak: 'break-all',\n                  },\n                  position: 'top',\n                  spacing: 4,\n                },\n              },\n            }}\n          >\n            {item.name ||\n              I18n.t('web_sdk_conversation_default_name', {}, '')}\n          </Typography.Text>\n        </div>\n      </MobileConversationOperate>\n      {visible ? (\n        <div\n          onClick={e => {\n            e.stopPropagation();\n            e.preventDefault();\n            closeOperate();\n          }}\n          className={s['conversation-item-mask']}\n        ></div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEdit, IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { Menu } from '@coze-arch/coze-design';\n\nexport const Operate = ({\n  children,\n  onRename,\n  onDelete,\n  visible,\n  setVisible,\n}: {\n  children: React.ReactNode;\n  onRename: () => void;\n  onDelete: () => void;\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n}) => (\n  <Menu\n    trigger=\"custom\"\n    position=\"bottomLeft\"\n    visible={visible}\n    onClickOutSide={() => setVisible(false)}\n    render={\n      <Menu.SubMenu mode=\"menu\">\n        <Menu.Item\n          onClick={(_, e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            onRename();\n          }}\n          icon={<IconCozEdit />}\n        >\n          {I18n.t('workflow_detail_node_rename', {}, '')}\n        </Menu.Item>\n        <Menu.Item\n          onClick={(_, e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            onDelete();\n          }}\n          icon={<IconCozTrashCan color=\"var(--coz-fg-hglt-red)\" />}\n        >\n          <span style={{ color: 'var(--coz-fg-hglt-red)' }}>\n            {I18n.t('web_sdk_delete', {}, '')}\n          </span>\n        </Menu.Item>\n      </Menu.SubMenu>\n    }\n  >\n    {children}\n  </Menu>\n);\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozMore } from '@coze-arch/coze-design/icons';\nimport { IconButton, Typography } from '@coze-arch/coze-design';\nimport { type Conversation } from '@coze/api';\n\nimport {\n  conversationSortMap,\n  type SortedConversationItem,\n} from '@/types/conversations';\n\nimport { Operate } from './operate';\n\nimport s from './index.module.less';\n\nexport const PcConversationItem = ({\n  isActive,\n  item,\n  shouldDisplayTime,\n  onConversationChange,\n  onRename,\n  onDelete,\n}: {\n  isActive: boolean;\n  item: SortedConversationItem;\n  shouldDisplayTime: boolean;\n  onConversationChange: (conversation: Conversation) => void;\n  onRename: (conversation: Conversation) => void;\n  onDelete: (conversation: Conversation) => void;\n}) => {\n  const [visible, setVisible] = useState(false);\n\n  const handleClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n    setVisible(true);\n  };\n\n  return (\n    <div className={s['conversation-item']}>\n      {shouldDisplayTime ? (\n        <div className={s['conversation-item-time']}>\n          {conversationSortMap.get(item.sort)}\n        </div>\n      ) : null}\n      <div\n        className={cls(s['conversation-item-content'], {\n          [s['conversation-item-content-active']]: isActive,\n        })}\n        onClick={() => onConversationChange(item)}\n      >\n        <Typography.Text\n          style={{\n            flex: 1,\n          }}\n          ellipsis={{\n            showTooltip: {\n              opts: {\n                content: item.name,\n                style: {\n                  wordBreak: 'break-all',\n                },\n                position: 'top',\n                spacing: 4,\n              },\n            },\n          }}\n        >\n          {item.name ||\n            I18n.t('web_sdk_conversation_default_name', {}, '')}\n        </Typography.Text>\n        <Operate\n          onRename={() => {\n            onRename(item);\n            setVisible(false);\n          }}\n          onDelete={() => {\n            onDelete(item);\n            setVisible(false);\n          }}\n          visible={visible}\n          setVisible={setVisible}\n        >\n          <IconButton\n            className={s['conversation-operate']}\n            onClick={handleClick}\n            size=\"small\"\n            icon={<IconCozMore />}\n            color=\"secondary\"\n          />\n        </Operate>\n      </div>\n    </div>\n  );\n};\n","\n      import API from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useMemo,\n  useRef,\n  useState,\n  forwardRef,\n  useImperativeHandle,\n  useEffect,\n} from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus, IconCozSideNav } from '@coze-arch/coze-design/icons';\nimport { Button, IconButton, Spin, Toast } from '@coze-arch/coze-design';\nimport { type Conversation } from '@coze/api';\n\nimport {\n  type ConversationSort,\n  type SortedConversationItem,\n} from '@/types/conversations';\nimport { Layout } from '@/types/client';\nimport { useUserInfo } from '@/components/studio-open-chat/hooks';\n\nimport {\n  PcConversationItem,\n  MobileConversationItem,\n} from '../conversation-item';\nimport { type ChatState } from '../../studio-open-chat/store/store';\nimport { useChatAppProps, useChatAppStore } from '../../studio-open-chat/store';\n\nimport s from './index.module.less';\n\nexport interface ConversationListSiderRef {\n  getConversationInfo: () =>\n    | {\n        conversationId: string;\n        sectionId?: string;\n      }\n    | undefined;\n  handleCreateConversation: () => Promise<void>;\n  handleDeleteConversation: (conversation: Conversation) => Promise<Boolean>;\n}\n\nexport const ConversationList = forwardRef<\n  ConversationListSiderRef,\n  {\n    onRename: (conversation: Conversation) => void;\n    onDelete: (conversation: Conversation) => void;\n    loading: boolean;\n    groupedConversations: Map<ConversationSort, SortedConversationItem[]>;\n    conversations: Conversation[];\n    hasMore: boolean;\n    loadMore: () => Promise<void>;\n  }\n>(\n  (\n    {\n      onRename,\n      onDelete,\n      loading,\n      groupedConversations,\n      conversations,\n      hasMore,\n      loadMore,\n    },\n    ref,\n  ) => {\n    const {\n      currentConversationInfo,\n      updateCurrentConversationInfo,\n      cozeApi,\n      updateConversations,\n    } = useChatAppStore(\n      useShallow(state => ({\n        currentConversationInfo: state.currentConversationInfo,\n        updateCurrentConversationInfo: state.updateCurrentConversationInfo,\n        cozeApi: state.cozeApi,\n        updateConversations: state.updateConversations,\n      })),\n    );\n\n    const userInfo = useUserInfo();\n\n    const conversationRef = useRef<ChatState['currentConversationInfo']>();\n    const [addLoading, setAddLoading] = useState(false);\n    const {\n      layout,\n      chatConfig: { bot_id: botId, auth: { connectorId } = {} },\n    } = useChatAppProps();\n\n    const isMobile = useMemo(() => layout === Layout.MOBILE, [layout]);\n\n    const listContainerRef = useRef<HTMLDivElement>(null);\n    const loadMoreRef = useRef<HTMLDivElement>(null);\n\n    const handleCreateConversation = async () => {\n      if (!currentConversationInfo) {\n        return;\n      }\n      try {\n        const res = await cozeApi?.conversations.create({\n          bot_id: botId,\n          // @ts-expect-error:  openapi \n          connector_id: connectorId,\n          user_id: IS_OPEN_SOURCE ? userInfo?.id : undefined,\n        });\n        if (res?.id) {\n          conversationRef.current = {\n            ...currentConversationInfo,\n            id: res.id,\n            last_section_id: res.last_section_id,\n          };\n          updateConversations([res], 'add');\n          updateCurrentConversationInfo({\n            ...currentConversationInfo,\n            ...res,\n            name: '',\n          });\n          Toast.info({\n            content: I18n.t('web_sdk_create_conversation', {}, ''),\n            showClose: false,\n          });\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    const handleConversationChange = (conversation: Conversation) => {\n      if (\n        !currentConversationInfo ||\n        conversation.id === currentConversationInfo?.id\n      ) {\n        return;\n      }\n      const c = {\n        ...currentConversationInfo,\n        ...conversation,\n        id: conversation.id,\n        sectionId: conversation.last_section_id,\n      };\n      conversationRef.current = c;\n      updateCurrentConversationInfo(c);\n    };\n\n    const handleDeleteConversation = async (conversation: Conversation) => {\n      try {\n        const res = (await cozeApi?.delete(\n          `/v1/conversations/${conversation.id}`,\n        )) as {\n          code: number;\n        };\n        if (res.code !== 0) {\n          return false;\n        }\n        await updateConversations([conversation], 'remove');\n        return true;\n      } catch (error) {\n        console.error(error);\n        return false;\n      }\n    };\n\n    useImperativeHandle(ref, () => ({\n      getConversationInfo: () => {\n        if (conversationRef.current) {\n          return {\n            conversationId: conversationRef.current.id,\n            sectionId: conversationRef.current.last_section_id,\n          };\n        } else if (conversations.length > 0) {\n          return {\n            conversationId: conversations[0].id,\n            sectionId: conversations[0].last_section_id,\n          };\n        }\n        return undefined;\n      },\n      handleCreateConversation,\n      handleDeleteConversation,\n    }));\n\n    useEffect(() => {\n      const observer = new IntersectionObserver(\n        entries => {\n          const [entry] = entries;\n          if (entry.isIntersecting && hasMore && !loading) {\n            loadMore();\n          }\n        },\n        {\n          root: listContainerRef.current,\n          rootMargin: '100px',\n          threshold: 0.01,\n        },\n      );\n\n      if (loadMoreRef.current) {\n        observer.observe(loadMoreRef.current);\n      }\n\n      return () => {\n        if (loadMoreRef.current) {\n          observer.unobserve(loadMoreRef.current);\n        }\n      };\n    }, [hasMore, loading, loadMore]);\n\n    return (\n      <div className={s.conversations}>\n        <div className={s['conversations-header']}>\n          <span className={s['conversations-header-title']}>\n            {I18n.t('web_sdk_conversation_history', {}, '')}\n          </span>\n          <IconButton\n            color=\"secondary\"\n            onClick={() => {\n              if (currentConversationInfo) {\n                updateCurrentConversationInfo({\n                  ...currentConversationInfo,\n                  conversationListVisible: false,\n                });\n              }\n            }}\n            icon={<IconCozSideNav width=\"18px\" height=\"18px\" />}\n          />\n        </div>\n        <Button\n          size=\"large\"\n          icon={<IconCozPlus />}\n          iconPosition=\"left\"\n          color=\"highlight\"\n          className={s['conversations-create-button']}\n          onClick={async () => {\n            setAddLoading(true);\n            await handleCreateConversation();\n            setAddLoading(false);\n          }}\n          loading={addLoading}\n        >\n          {I18n.t('web_sdk_add_new_conversation', {}, '')}\n        </Button>\n        <div ref={listContainerRef} className={s['conversations-list']}>\n          {Array.from(groupedConversations.entries()).map(\n            ([sort, conversationList]) => (\n              <div key={sort} className={s['conversations-list-group']}>\n                {conversationList.map((conversation, index) =>\n                  isMobile ? (\n                    <MobileConversationItem\n                      isActive={conversation.id === currentConversationInfo?.id}\n                      key={conversation.id}\n                      item={conversation}\n                      shouldDisplayTime={index === 0}\n                      onConversationChange={handleConversationChange}\n                      onRename={onRename}\n                      onDelete={onDelete}\n                    />\n                  ) : (\n                    <PcConversationItem\n                      isActive={conversation.id === currentConversationInfo?.id}\n                      key={conversation.id}\n                      item={conversation}\n                      shouldDisplayTime={index === 0}\n                      onConversationChange={handleConversationChange}\n                      onRename={onRename}\n                      onDelete={onDelete}\n                    />\n                  ),\n                )}\n              </div>\n            ),\n          )}\n          <div ref={loadMoreRef} style={{ height: '10px', flexShrink: 0 }} />\n          {loading ? (\n            <Spin\n              style={{\n                width: '100%',\n              }}\n            ></Spin>\n          ) : null}\n        </div>\n      </div>\n    );\n  },\n);\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport {\n  Fragment,\n  type ReactNode,\n  useState,\n  forwardRef,\n  useRef,\n  useImperativeHandle,\n} from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozSideNav } from '@coze-arch/coze-design/icons';\nimport { Input, Modal, SideSheet } from '@coze-arch/coze-design';\nimport { type Conversation } from '@coze/api';\n\nimport { useChatAppStore } from '../studio-open-chat/store';\nimport {\n  useConversationList,\n  useGroupedConversations,\n} from '../studio-open-chat/hooks/use-conversation-list';\nimport {\n  ConversationList,\n  type ConversationListSiderRef,\n} from './conversation-list';\n\nimport s from './index.module.less';\n\nexport const ConversationListSider = forwardRef<\n  Pick<ConversationListSiderRef, 'getConversationInfo'>,\n  {\n    children: ReactNode;\n  }\n>(({ children }, ref) => {\n  const conversationListRef = useRef<ConversationListSiderRef>(null);\n  const { currentConversationInfo, updateConversations, cozeApi } =\n    useChatAppStore(\n      useShallow(state => ({\n        currentConversationInfo: state.currentConversationInfo,\n        updateConversations: state.updateConversations,\n        cozeApi: state.cozeApi,\n      })),\n    );\n\n  const { loading, conversations, hasMore, loadMore } = useConversationList();\n\n  const groupedConversations = useGroupedConversations(conversations);\n\n  const [isModalLoading, setIsModalLoading] = useState(false);\n  const [modalInfo, setModalInfo] = useState<{\n    visible: boolean;\n    type: 'rename' | 'delete';\n    conversation: Conversation;\n  } | null>(null);\n\n  const handleOpenRenameModal = (conversation: Conversation) => {\n    setModalInfo({\n      visible: true,\n      type: 'rename',\n      conversation,\n    });\n  };\n\n  const handleOpenDeleteModal = (conversation: Conversation) => {\n    setModalInfo({\n      visible: true,\n      type: 'delete',\n      conversation,\n    });\n  };\n\n  const handleUpdateConversationName = async (conversation: Conversation) => {\n    try {\n      const res = (await cozeApi?.put(`/v1/conversations/${conversation.id}`, {\n        name: conversation.name,\n      })) as {\n        data: Conversation;\n        code: number;\n      };\n      if (res.code !== 0) {\n        return;\n      }\n      await updateConversations([res.data], 'update');\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  useImperativeHandle(ref, () => ({\n    getConversationInfo: () => {\n      if (conversationListRef.current) {\n        return conversationListRef.current.getConversationInfo();\n      }\n      return undefined;\n    },\n  }));\n\n  const handleModalOk = async () => {\n    if (!modalInfo) {\n      return;\n    }\n    setIsModalLoading(true);\n    try {\n      if (modalInfo?.type === 'rename') {\n        await handleUpdateConversationName(modalInfo.conversation);\n      } else {\n        if (modalInfo.conversation.id === currentConversationInfo?.id) {\n          if (\n            await conversationListRef.current?.handleDeleteConversation(\n              modalInfo.conversation,\n            )\n          ) {\n            await conversationListRef.current?.handleCreateConversation();\n          }\n        } else {\n          await conversationListRef.current?.handleDeleteConversation(\n            modalInfo.conversation,\n          );\n        }\n      }\n      setIsModalLoading(false);\n      setModalInfo(null);\n    } catch (error) {\n      console.error(error);\n      setIsModalLoading(false);\n    }\n  };\n\n  return (\n    <div className={s['conversations-container']}>\n      {currentConversationInfo?.conversationListVisible &&\n      currentConversationInfo?.isLargeWidth ? (\n        <ConversationList\n          ref={conversationListRef}\n          onRename={handleOpenRenameModal}\n          onDelete={handleOpenDeleteModal}\n          loading={loading}\n          groupedConversations={groupedConversations}\n          conversations={conversations}\n          hasMore={hasMore}\n          loadMore={loadMore}\n        />\n      ) : null}\n\n      <Fragment key={currentConversationInfo?.id}>{children}</Fragment>\n\n      <SideSheet\n        visible={\n          currentConversationInfo?.conversationListVisible &&\n          !currentConversationInfo?.isLargeWidth\n        }\n        closeIcon={<IconCozSideNav />}\n        closable={false}\n        closeOnEsc={false}\n        maskClosable={false}\n        getPopupContainer={() =>\n          document.querySelector('.coze-chat-sdk') as HTMLElement\n        }\n        placement=\"left\"\n        width={320}\n        className={s['conversations-side-sheet']}\n        headerStyle={{\n          display: 'none',\n        }}\n        bodyStyle={{\n          padding: 0,\n          height: '100%',\n        }}\n      >\n        <ConversationList\n          ref={conversationListRef}\n          onRename={handleOpenRenameModal}\n          onDelete={handleOpenDeleteModal}\n          loading={loading}\n          groupedConversations={groupedConversations}\n          conversations={conversations}\n          hasMore={hasMore}\n          loadMore={loadMore}\n        />\n      </SideSheet>\n      <Modal\n        getPopupContainer={() =>\n          document.querySelector('.coze-chat-sdk') as HTMLElement\n        }\n        okButtonProps={{\n          loading: isModalLoading,\n        }}\n        visible={modalInfo?.visible}\n        onCancel={() => setModalInfo(null)}\n        title={\n          modalInfo?.type === 'delete'\n            ? I18n.t('web_sdk_delete_conversation', {}, '')\n            : I18n.t('web_sdk_rename_conversation', {}, '')\n        }\n        onOk={handleModalOk}\n        okText={\n          modalInfo?.type === 'delete'\n            ? I18n.t('web_sdk_delete', {}, '')\n            : I18n.t('web_sdk_confirm', {}, '')\n        }\n        cancelText={I18n.t('web_sdk_cancel', {}, '')}\n        okButtonColor={modalInfo?.type === 'delete' ? 'red' : 'brand'}\n        closable={false}\n        maskClosable={false}\n        style={{\n          maxWidth: '80%',\n        }}\n      >\n        {modalInfo?.type === 'rename' ? (\n          <Input\n            placeholder={I18n.t(\n              'web_sdk_conversation_placeholder',\n              {},\n              '',\n            )}\n            value={modalInfo.conversation.name}\n            maxLength={100}\n            onChange={value =>\n              setModalInfo({\n                ...modalInfo,\n                conversation: {\n                  ...modalInfo.conversation,\n                  name: value,\n                },\n              })\n            }\n          />\n        ) : (\n          <span className={s['conversations-list-delete-modal-text']}>\n            {I18n.t(\n              'web_sdk_conversation_delete_content',\n              {},\n              '',\n            )}\n          </span>\n        )}\n      </Modal>\n    </div>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const STRINGIFY_ERROR = Symbol();\n\nexport const catchStringify = (obj: unknown) => {\n  try {\n    return JSON.stringify(obj);\n  } catch (err) {\n    console.log('catchStringify error', err);\n    return STRINGIFY_ERROR;\n  }\n};\n\nexport const catchParse = <T = unknown>(objStr: string, defaultValue?: T) => {\n  try {\n    return JSON.parse(objStr) as T;\n  } catch (err) {\n    console.log('catchParse error', err);\n  }\n\n  return defaultValue;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\nimport { devtools, subscribeWithSelector } from 'zustand/middleware';\nimport { create } from 'zustand';\nimport { nanoid } from 'nanoid';\nimport { produce } from 'immer';\nimport { type Conversation, type CozeAPI } from '@coze/api';\nimport { type ShortCutCommand } from '@coze-common/chat-area-plugins-chat-shortcuts';\nimport { type MixInitResponse } from '@coze-common/chat-area';\n\nimport { type SDKInitError } from '@/util/error';\nimport { getStorageKey, LocalStorageKey, storageUtil } from '@/util';\nimport { type OpenUserInfo } from '@/types/user';\nimport { EInputMode, type CozeChatConfig } from '@/types/props';\nimport { AuthType } from '@/types/client';\n\ntype ErrorState = boolean | SDKInitError;\n/** store  */\nexport interface ChatState {\n  userInfo?: OpenUserInfo;\n  token?: string;\n  isNeedToken?: boolean;\n  isNeedStopRespond?: boolean;\n  initError?: ErrorState;\n  voiceCallClose?: boolean;\n  defaultInputMode?: EInputMode;\n  isStartBotVoiceCall?: boolean;\n  backgroundInfo: MixInitResponse['backgroundInfo'];\n  feedbackInfo: {\n    [itemId: string]: 'thumbUp' | 'thumbDown' | 'default';\n  };\n  lastGroupFeedbackInfo: {\n    messageId?: string;\n    isShowCustomPanel: boolean;\n  };\n  shortcuts: ShortCutCommand[];\n  /**\n   * @description  id  id \n   */\n  currentConversationInfo?: Conversation & {\n    conversationListVisible: boolean;\n    isLargeWidth: boolean;\n  };\n  conversations: Conversation[];\n  cozeApi?: CozeAPI;\n  hasRefusedCallByUser?: boolean;\n}\n\nexport interface ChatAction {\n  setUserId: (userId: string) => void;\n  setToken: (token: string) => void;\n  refreshToken: () => Promise<string>;\n  setUserInfo: (userInfo: OpenUserInfo) => void;\n  setInitError: (error: ErrorState) => void;\n  setDefaultInputMode: (defaultInputMode: EInputMode) => void;\n  setVoiceCallClose: (voiceCallClose: boolean) => void;\n  setIsStartBotVoiceCall: (isStartBotVoiceCall?: boolean) => void;\n  setHasRefusedCallByUser: (hasRefusedCallByUser: boolean) => void;\n  updateFeedbackInfo: (\n    itemId: string,\n    feedbackType: 'thumbUp' | 'thumbDown' | 'default',\n  ) => void;\n  updateLastGroupFeedbackInfo: (\n    messageId: string,\n    isShowCustomPanel: boolean,\n  ) => void;\n  updateShortcuts: (shortcuts: ShortCutCommand[]) => void;\n  updateBackgroundInfo: (info: MixInitResponse['backgroundInfo']) => void;\n  /**\n   * @description  query \n   * @param currentConversationInfo  isNeedConversationAdd \n   */\n  updateCurrentConversationInfo: (\n    currentConversationInfo: ChatState['currentConversationInfo'],\n  ) => void;\n  /**\n   * @description  query \n   * @param name \n   */\n  updateCurrentConversationNameByMessage: (name: string) => Promise<boolean>;\n  updateConversations: (\n    conversations: Conversation[],\n    operate: 'replace' | 'add' | 'remove' | 'update',\n  ) => void;\n  setCozeApi: (cozeApi: CozeAPI) => void;\n}\nexport type ChatStateAction = ChatState & ChatAction;\n\nconst getDefaultUserInfo = (userInfo?: OpenUserInfo) => {\n  if (userInfo?.id) {\n    return userInfo;\n  }\n  const userIdKey = getStorageKey(LocalStorageKey.UID);\n  return {\n    id: storageUtil.getItem(userIdKey, '') || nanoid(),\n    nickname: '',\n    url: '',\n  };\n};\n\nexport const createChatStore = (\n  chatConfig: CozeChatConfig,\n  userInfo?: OpenUserInfo,\n) => {\n  const isNeedToken = chatConfig?.auth?.type === AuthType.TOKEN;\n  const token = isNeedToken ? chatConfig?.auth?.token : '';\n  return create<ChatStateAction>()(\n    devtools(\n      subscribeWithSelector((set, get) => ({\n        userInfo: getDefaultUserInfo(userInfo),\n        token,\n        isNeedToken,\n        voiceCallClose: true,\n        isStartBotVoiceCall: false,\n        isNeedStopRespond: true,\n        initError: false,\n        voiceInfoList: [],\n        lastGroupFeedbackInfo: {\n          cozeApiMessageId: '',\n          isShowCustomPanel: false,\n        },\n        backgroundInfo: {},\n        shortcuts: [],\n        defaultInputMode: EInputMode.Text,\n        feedbackInfo: {},\n        currentConversationInfo: undefined,\n        conversations: [],\n        cozeApi: undefined,\n        hasRefusedCallByUser: false,\n        setHasRefusedCallByUser: (hasRefusedCallByUser: boolean) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.hasRefusedCallByUser = hasRefusedCallByUser;\n            }),\n          );\n        },\n        refreshToken: async () => {\n          const tokenOld = get().token || '';\n          const newToken = await chatConfig?.auth?.onRefreshToken?.(tokenOld);\n          if (newToken) {\n            set(\n              produce<ChatStateAction>(s => {\n                s.token = newToken;\n              }),\n            );\n          }\n          return newToken || '';\n        },\n        setUserInfo: userInfoIn => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.userInfo = getDefaultUserInfo(userInfoIn);\n            }),\n          );\n        },\n        setUserId: (userId: string) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.userInfo = {\n                id: userId,\n                nickname: '',\n                url: '',\n              };\n            }),\n          );\n        },\n        setToken: (tokenNew: string) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.token = tokenNew;\n            }),\n          );\n        },\n        setInitError: (error: ErrorState) => {\n          const { initError } = get();\n          if (error && initError && typeof initError !== 'boolean') {\n            return;\n          }\n          set(\n            produce<ChatStateAction>(s => {\n              s.initError = error;\n            }),\n          );\n        },\n        setDefaultInputMode: (defaultInputMode: EInputMode) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.defaultInputMode = defaultInputMode;\n            }),\n          );\n        },\n        updateLastGroupFeedbackInfo: (\n          messageId: string,\n          isShowCustomPanel: boolean,\n        ) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.lastGroupFeedbackInfo = {\n                messageId,\n                isShowCustomPanel,\n              };\n            }),\n          );\n        },\n        updateFeedbackInfo: (\n          itemId: string,\n          feedbackType: 'thumbUp' | 'thumbDown' | 'default',\n        ) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.feedbackInfo[itemId] = feedbackType;\n            }),\n          );\n        },\n        updateShortcuts(shortcuts: ShortCutCommand[]) {\n          set(\n            produce<ChatStateAction>(s => {\n              s.shortcuts = shortcuts;\n            }),\n          );\n        },\n        updateBackgroundInfo(info: MixInitResponse['backgroundInfo']) {\n          set(\n            produce<ChatStateAction>(s => {\n              s.backgroundInfo = info;\n            }),\n          );\n        },\n        setVoiceCallClose(voiceCallClose: boolean) {\n          set(\n            produce<ChatStateAction>(s => {\n              s.voiceCallClose = voiceCallClose;\n            }),\n          );\n        },\n        setIsStartBotVoiceCall(isStartBotVoiceCall?: boolean) {\n          set(\n            produce<ChatStateAction>(s => {\n              s.isStartBotVoiceCall = isStartBotVoiceCall;\n            }),\n          );\n        },\n        updateCurrentConversationInfo: currentConversationInfo => {\n          set(\n            produce<ChatStateAction>(s => {\n              if (!currentConversationInfo) {\n                s.currentConversationInfo = currentConversationInfo;\n              } else {\n                s.currentConversationInfo = {\n                  ...s.currentConversationInfo,\n                  ...currentConversationInfo,\n                };\n              }\n            }),\n          );\n        },\n        updateCurrentConversationNameByMessage: async (name: string) => {\n          const {\n            currentConversationInfo,\n            updateCurrentConversationInfo,\n            updateConversations,\n            cozeApi,\n          } = get();\n          if (!currentConversationInfo || currentConversationInfo.name) {\n            return Promise.resolve(false);\n          }\n          try {\n            const res = (await cozeApi?.put(\n              `/v1/conversations/${currentConversationInfo.id}`,\n              {\n                name,\n              },\n            )) as {\n              data: Conversation;\n              code: number;\n            };\n            if (res.code !== 0) {\n              return Promise.resolve(false);\n            }\n            updateCurrentConversationInfo({\n              ...currentConversationInfo,\n              name,\n            });\n            await updateConversations([res.data], 'update');\n            return true;\n          } catch (error) {\n            console.error(error);\n            return Promise.resolve(false);\n          }\n        },\n        updateConversations: (conversations, operate) => {\n          set(\n            produce<ChatStateAction>(s => {\n              if (operate === 'replace') {\n                s.conversations = conversations;\n              } else if (operate === 'add') {\n                s.conversations = [...s.conversations, ...conversations];\n              } else if (operate === 'remove') {\n                conversations.forEach(conversation => {\n                  const index = s.conversations.findIndex(\n                    c => c.id === conversation.id,\n                  );\n                  if (index !== -1) {\n                    s.conversations.splice(index, 1);\n                  }\n                });\n              } else if (operate === 'update') {\n                conversations.forEach(conversation => {\n                  const index = s.conversations.findIndex(\n                    c => c.id === conversation.id,\n                  );\n                  if (index !== -1) {\n                    s.conversations[index] = {\n                      ...s.conversations[index],\n                      ...conversation,\n                    };\n                  }\n                });\n              }\n            }),\n          );\n        },\n        setCozeApi: (cozeApi: CozeAPI) => {\n          set(\n            produce<ChatStateAction>(s => {\n              s.cozeApi = cozeApi;\n            }),\n          );\n        },\n      })),\n      {\n        enabled: IS_DEV_MODE,\n        name: 'CozeChatApp.global',\n      },\n    ),\n  );\n};\n\nexport type ChatStore = ReturnType<typeof createChatStore>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createContext,\n  type FC,\n  type ReactNode,\n  useContext,\n  useState,\n  useMemo,\n  useRef,\n} from 'react';\n\nimport { useStoreWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { nanoid } from 'nanoid';\nimport { merge } from 'lodash-es';\nimport { useUpdateEffect } from 'ahooks';\n\nimport { ChatSdkError, SDKErrorCode } from '@/util/error';\nimport {\n  type CozeChatConfig,\n  type StudioChatProviderProps,\n} from '@/types/props';\nimport { OpenApiSource } from '@/types/open';\nimport { ChatType, Layout } from '@/types/client';\nimport { type ConversationListSiderRef } from '@/components/conversation-list-sider/conversation-list';\nimport { ConversationListSider } from '@/components/conversation-list-sider';\n\nimport { createChatStore, type ChatStore, type ChatStateAction } from './store';\n\nexport const ChatPropsContext = createContext<{\n  appProps?: StudioChatProviderProps;\n  store?: ChatStore;\n}>({});\ninterface CProps extends StudioChatProviderProps {\n  chatConfig: CozeChatConfig;\n}\nexport const ChatPropsProvider: FC<{\n  children: ReactNode;\n  appProps: StudioChatProviderProps;\n}> = ({ children, appProps }) => {\n  const defaultChatConfig = useMemo(\n    () => ({\n      conversation_id: nanoid(),\n      source: OpenApiSource.WebSdk,\n    }),\n    [],\n  );\n\n  const conversationRef = useRef<\n    Pick<ConversationListSiderRef, 'getConversationInfo'>\n  >({\n    getConversationInfo: () => undefined,\n  });\n\n  {\n    /* app  UI  */\n  }\n  const isShowConversations =\n    appProps.chatConfig.ui?.conversations?.isNeed &&\n    appProps.chatConfig.type !== ChatType.APP;\n\n  const appPropsState = useMemo(() => {\n    //  openRequestInit  id   id\n    const openRequestInit: StudioChatProviderProps['openRequestInit'] =\n      async cozeApi => {\n        let res;\n        if (typeof appProps.openRequestInit === 'function') {\n          res = await appProps.openRequestInit(cozeApi);\n        } else if (appProps.openRequestInit) {\n          res = appProps.openRequestInit;\n        }\n        return {\n          ...res,\n          ...conversationRef.current?.getConversationInfo(), //  ChatType.APP  ChatSDK  botInfo \n        };\n      };\n    const state = {\n      ...appProps,\n      openRequestInit,\n      chatConfig: merge({}, defaultChatConfig, appProps.chatConfig),\n    };\n    state.chatConfig.conversation_id =\n      state.chatConfig.conversation_id || defaultChatConfig.conversation_id;\n    return state;\n  }, [appProps]);\n\n  const [store] = useState<ChatStore>(() =>\n    createChatStore(appProps.chatConfig, appProps.userInfo),\n  );\n  useUpdateEffect(() => {\n    if (appProps.userInfo) {\n      store.getState().setUserInfo(appProps.userInfo);\n    }\n  }, [appProps.userInfo]);\n  return (\n    <ChatPropsContext.Provider\n      value={{\n        appProps: appPropsState,\n        store,\n      }}\n    >\n      {isShowConversations ? (\n        <ConversationListSider ref={conversationRef}>\n          {children}\n        </ConversationListSider>\n      ) : (\n        children\n      )}\n    </ChatPropsContext.Provider>\n  );\n};\n\nexport const useChatAppProps = (): CProps => {\n  const { appProps } = useContext(ChatPropsContext);\n\n  const {\n    chatConfig = {\n      conversation_id: nanoid(),\n      source: OpenApiSource.WebSdk,\n      bot_id: '',\n    },\n    layout = Layout.PC,\n    enableReplacePrologueNicknameWithVar = false,\n  } = appProps ?? {};\n\n  return {\n    ...appProps,\n    chatConfig,\n    layout,\n    enableReplacePrologueNicknameWithVar,\n  };\n};\n\nexport const useChatAppStore: <T>(\n  selector: (store: ChatStateAction) => T,\n) => T = selector => {\n  const { store } = useContext(ChatPropsContext);\n  if (!store) {\n    throw ChatSdkError.create(SDKErrorCode.StoreProvider);\n  }\n  return useStoreWithEqualityFn(store, selector, shallow);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useChatAppProps, useChatAppStore } from '../store';\n\nexport const useIsShowBackground = () => {\n  const backgroundInfo = useChatAppStore(s => s.backgroundInfo);\n  const { isCustomBackground } = useChatAppProps();\n\n  // \n  return (\n    isCustomBackground ||\n    !!backgroundInfo?.mobile_background_image?.origin_image_url ||\n    false\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useIsShowBackground } from './use-is-show-background';\n\nexport const useGetTheme = () => {\n  const isShowBackground = useIsShowBackground();\n  return isShowBackground ? 'bg-theme' : 'light';\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  ShortcutBar as ChatAreaShortcutBar,\n  getUIModeByBizScene,\n  type ShortCutCommand,\n} from '@coze-common/chat-area-plugins-chat-shortcuts';\nimport { type ChatInputIntegrationController } from '@coze-common/chat-area';\nimport { ToolType } from '@coze-arch/idl/playground_api';\n\nimport { useChatAppStore } from '../../store';\nimport { useIsShowBackground } from '../../hooks/use-is-show-background';\n\nexport interface ShortcutBarRenderProps {\n  controller: ChatInputIntegrationController;\n  onShortcutActive?: (shortcut: ShortCutCommand | undefined) => void;\n}\n\nexport const ShortcutBar = ({\n  controller,\n  onShortcutActive,\n}: ShortcutBarRenderProps) => {\n  const activeShortcutRef = useRef<ShortCutCommand | undefined>(undefined);\n\n  const showBackground = useIsShowBackground();\n  const shortcuts = useChatAppStore(store => store.shortcuts);\n  const defaultId = shortcuts.at(0)?.command_id;\n\n  if (!shortcuts?.length) {\n    return null;\n  }\n  return (\n    <ChatAreaShortcutBar\n      shortcuts={shortcuts}\n      wrapperClassName={classNames('w-full pl-[68px] pr-[24px] pb-[10px]')}\n      uiMode={getUIModeByBizScene({\n        bizScene: 'websdk',\n        showBackground,\n      })}\n      defaultId={defaultId}\n      onActiveShortcutChange={(shortcutInfo, isTemplateShortcutActive) => {\n        activeShortcutRef.current = shortcutInfo;\n        // template&bar\n        const chatInputSlotVisible = !isTemplateShortcutActive;\n        controller.setChatInputSlotVisible(chatInputSlotVisible);\n        onShortcutActive?.(shortcutInfo);\n      }}\n      onBeforeSendTemplateShortcut={({ message, options, shortcut }) => {\n        const parameters = {};\n        Object.entries(\n          (\n            options?.extendFiled?.toolList as Array<{\n              plugin_id: string;\n              plugin_api_name: string;\n              parameters: Record<\n                string,\n                {\n                  value: string;\n                  resource_type: 'uri' | '';\n                }\n              >;\n            }>\n          )?.[0]?.parameters || {},\n        ).map(item => {\n          const [key, value] = item;\n          parameters[key] = value.value;\n        });\n\n        const optionsNew = options || {};\n\n        if (!optionsNew.extendFiled) {\n          optionsNew.extendFiled = {};\n        }\n        if (\n          shortcut.tool_type === ToolType.ToolTypePlugin ||\n          shortcut.tool_type === ToolType.ToolTypeWorkFlow\n        ) {\n          optionsNew.extendFiled.shortcut_command = {\n            command_id: shortcut.command_id,\n            parameters,\n          };\n        }\n\n        return {\n          message,\n          options,\n        };\n      }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport Icon from '@douyinfe/semi-icons';\nexport const IconAddNewConversation: FC<{\n  className?: string;\n  width?: string;\n  height?: string;\n}> = ({ width, height, className }) => (\n  <Icon\n    svg={\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"18\"\n        height=\"18\"\n        viewBox=\"0 0 18 18\"\n        fill=\"currentColor\"\n      >\n        <path\n          d=\"M13.4997 16.5H4.49881C2.84338 16.5 1.5 15.1574 1.5 13.5013V4.50088C1.5 2.84333 2.84338 1.5 4.49881 1.5H13.4997C15.158 1.5 16.5 2.84331 16.5 4.50088V13.5013C16.5 15.1574 15.158 16.5 13.4997 16.5ZM15.0013 5.25092C15.0013 4.00792 13.9919 3.00008 12.7496 3.00008H5.24889C4.00657 3.00008 2.99864 4.00792 2.99864 5.25092V12.7498C2.99864 13.9943 4.00657 15.0007 5.24889 15.0007H12.7496C13.9919 15.0007 15.0013 13.9943 15.0013 12.7498V5.25092ZM9.74933 11.9997C9.74933 12.414 9.41351 12.7498 8.99925 12.7498C8.585 12.7498 8.24918 12.414 8.24918 11.9997V9.75115H5.99967C5.58503 9.75115 5.24889 9.41502 5.24889 9.00037C5.24889 8.58572 5.58503 8.24958 5.99967 8.24958H8.24918V6.00099C8.24918 5.58674 8.585 5.25092 8.99925 5.25092C9.41351 5.25092 9.74933 5.58674 9.74933 6.001V8.24958H11.9988C12.4135 8.24958 12.7496 8.58572 12.7496 9.00037C12.7496 9.41502 12.4135 9.75115 11.9988 9.75115H9.74933V11.9997Z\"\n          fill=\"currentColor\"\n        />\n      </svg>\n    }\n    className={className}\n    style={{\n      width,\n      height,\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport {\n  useBuiltinButtonStatus,\n  useChatAreaController,\n  useClearContext,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozBroom, IconCozChatPlus } from '@coze-arch/coze-design/icons';\n\nimport { IconAddNewConversation } from '@/components/icon/add-new-conversation';\n\nimport { useChatAppProps } from '../store';\n\nexport type ChatOp = 'clearContext' | 'clearMessage' | 'addNewConversation';\nexport interface ButtonProps {\n  icon?: React.ReactNode;\n  text?: string | React.ReactNode;\n  disabled?: boolean;\n  onClick?: (event?: React.MouseEvent) => void;\n}\nexport const useChatOpInfo = () => {\n  const { chatConfig } = useChatAppProps();\n  const chatInputLeftOps: ChatOp[] = [];\n  const headerTopLeftOps: ChatOp[] = [];\n  console.log('useChatOpInfo:', chatConfig);\n  if (chatConfig?.ui?.header?.isShow) {\n    if (chatConfig?.ui?.chatBot?.isNeedClearContext) {\n      chatInputLeftOps.push('clearContext');\n\n      if (chatConfig?.ui?.chatBot?.isNeedClearMessage) {\n        headerTopLeftOps.push('clearMessage');\n      } else if (chatConfig?.ui?.chatBot?.isNeedAddNewConversation) {\n        headerTopLeftOps.push('addNewConversation');\n      }\n    } else {\n      //  clearMessage  addNewConversation \n      if (chatConfig?.ui?.chatBot?.isNeedClearMessage) {\n        chatInputLeftOps.push('clearMessage');\n      } else if (chatConfig?.ui?.chatBot?.isNeedAddNewConversation) {\n        chatInputLeftOps.push('addNewConversation');\n      }\n    }\n  } else {\n    if (chatConfig?.ui?.chatBot?.isNeedClearContext) {\n      chatInputLeftOps.push('clearContext');\n    }\n    //  clearMessage  addNewConversation \n    if (chatConfig?.ui?.chatBot?.isNeedClearMessage) {\n      chatInputLeftOps.push('clearMessage');\n    } else if (chatConfig?.ui?.chatBot?.isNeedAddNewConversation) {\n      chatInputLeftOps.push('addNewConversation');\n    }\n  }\n  return {\n    chatInputLeftOps,\n    headerTopLeftOps,\n  };\n};\nexport const useChatChatButtonInfo = (opList: ChatOp[]) => {\n  const { isClearHistoryButtonDisabled, isClearContextButtonDisabled } =\n    useBuiltinButtonStatus({});\n  const { readonly } = useChatAppProps();\n  const { clearHistory } = useChatAreaController();\n  const clearContext = useClearContext();\n  const buttonList = useMemo<ButtonProps[]>(\n    () =>\n      opList.map(item => {\n        if (item === 'addNewConversation') {\n          return {\n            icon: <IconAddNewConversation width=\"18px\" height=\"18px\" />,\n            text: I18n.t('web_sdk_add_new_conversation'),\n            disabled: isClearHistoryButtonDisabled || readonly,\n            onClick: () => {\n              clearHistory?.();\n            },\n          };\n        } else if (item === 'clearContext') {\n          return {\n            icon: <IconCozChatPlus width=\"18px\" height=\"18px\" />,\n            text: I18n.t('store_start_new_chat'),\n            disabled: isClearContextButtonDisabled || readonly,\n            onClick: () => {\n              clearContext();\n            },\n          };\n        } else {\n          return {\n            icon: <IconCozBroom width=\"18px\" height=\"18px\" />,\n            text: I18n.t('coze_home_delete_btn'),\n            disabled: isClearHistoryButtonDisabled || readonly,\n            onClick: () => {\n              clearHistory?.();\n            },\n          };\n        }\n      }),\n    [\n      opList,\n      isClearContextButtonDisabled,\n      isClearHistoryButtonDisabled,\n      readonly,\n      clearHistory,\n      clearContext,\n    ],\n  );\n  return buttonList;\n};\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useEffect, useState } from 'react';\n\nimport cls from 'classnames';\nimport { OutlinedIconButton, UIKitTooltip } from '@coze-common/chat-uikit';\nimport { IconCozMore } from '@coze-arch/coze-design/icons';\nimport { Button, Popover, Space } from '@coze-arch/coze-design';\n\nimport { Layout } from '@/types/client';\n\nimport { useChatAppProps } from '../../store';\nimport { useIsShowBackground } from '../../hooks/use-is-show-background';\nimport {\n  type ButtonProps,\n  useChatChatButtonInfo,\n  useChatOpInfo,\n} from '../../hooks/use-chat-op-info';\n\nimport styles from './index.module.less';\n\nconst MoreBtn: FC<{\n  buttonList: ButtonProps[];\n}> = ({ buttonList }) => {\n  const showBackground = useIsShowBackground();\n  const [visible, setVisible] = useState(false);\n  const { readonly } = useChatAppProps();\n  useEffect(() => {\n    document.addEventListener('click', () => {\n      setVisible(false);\n    });\n    return () => {\n      setVisible(false);\n    };\n  }, []);\n  return (\n    <Popover\n      content={\n        <Space className={styles.container} vertical spacing={0}>\n          {buttonList?.map((item, index) => (\n            <Button\n              color=\"secondary\"\n              className={styles.button}\n              icon={item?.icon}\n              iconPosition=\"left\"\n              onClick={item?.onClick}\n              disabled={item?.disabled}\n              key={index}\n            >\n              {item?.text}\n            </Button>\n          ))}\n        </Space>\n      }\n      trigger=\"custom\"\n      visible={visible}\n      position=\"topLeft\"\n      style={{\n        borderRadius: '4px',\n      }}\n    >\n      <OutlinedIconButton\n        data-testid=\"bot-edit-debug-chat-clear-button\"\n        showBackground={showBackground}\n        disabled={readonly}\n        icon={<IconCozMore className=\"text-18px\" />}\n        size=\"default\"\n        onClick={e => {\n          e.stopPropagation();\n          setVisible(visibleTemp => !visibleTemp);\n        }}\n        className={cls('mr-12px', '!rounded-full')}\n      />\n    </Popover>\n  );\n};\n\nexport const ChatInputLeftSlot = () => {\n  const { chatInputLeftOps } = useChatOpInfo();\n  const showBackground = useIsShowBackground();\n  const { chatConfig } = useChatAppProps();\n  const isMobile = chatConfig.ui?.base?.layout === Layout.MOBILE;\n  const buttonClass = showBackground ? '!coz-fg-images-white' : '';\n\n  const buttonList = useChatChatButtonInfo(chatInputLeftOps);\n  if (chatInputLeftOps.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className={styles['chat-input-left-slot']}>\n      {buttonList.length > 1 ? <MoreBtn buttonList={buttonList} /> : null}\n      {buttonList.length === 1 ? (\n        <UIKitTooltip content={buttonList[0].text} hideToolTip={isMobile}>\n          <OutlinedIconButton\n            data-testid=\"bot-edit-debug-chat-clear-button\"\n            showBackground={showBackground}\n            disabled={buttonList[0].disabled}\n            icon={buttonList[0].icon}\n            onClick={e => {\n              buttonList[0].onClick?.();\n            }}\n            className={cls('mr-12px', '!rounded-full', buttonClass, {\n              [styles.disabled]: buttonList[0].disabled,\n            })}\n          />\n        </UIKitTooltip>\n      ) : null}\n    </div>\n  );\n};\n","\n      import API from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, useEffect, useMemo, useRef } from 'react';\n\nimport cs from 'classnames';\nimport {\n  ChatFlowRender,\n  WorkflowRender,\n} from '@coze-common/chat-workflow-render';\nimport {\n  ChatArea,\n  useInitStatus,\n  type ComponentTypesMap,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n/intl';\n\nimport { type StudioChatAreaProps } from '@/types/props';\nimport { OpenApiSource } from '@/types/open';\nimport { Layout } from '@/types/client';\n\nimport { useChatAppProps } from '../store';\nimport { ShortcutBar } from '../components/shortcut-bar';\nimport { ChatInputLeftSlot } from '../components/chat-input-let-slot';\n\nimport styles from './index.module.less';\n\n// eslint-disable-next-line complexity\nexport const StudioChatArea: FC<StudioChatAreaProps> = ({\n  coreAreaClassName,\n  className,\n  showInputArea = true,\n  inputPlaceholder,\n  inputNativeCallbacks,\n  messageGroupListClassName,\n  renderChatInputTopSlot,\n  isShowClearContextDivider,\n  headerNode,\n  messageMaxWidth,\n  isMiniScreen,\n  enableMultimodalUpload = false,\n}) => {\n  const initStatus = useInitStatus();\n  const { layout, onInitStateChange, chatConfig } = useChatAppProps();\n  const refContainer = useRef<HTMLDivElement>(null);\n  const { readonly } = useChatAppProps();\n\n  const { source } = chatConfig;\n\n  const contentBox = useMemo(\n    () => (source === OpenApiSource.ChatFlow ? ChatFlowRender : WorkflowRender),\n    [source],\n  );\n\n  const chatAreaComponentTypes: Partial<ComponentTypesMap> = useMemo(\n    () => ({\n      chatInputIntegration: {\n        renderChatInputTopSlot: controller => (\n          <>\n            {renderChatInputTopSlot?.()}\n            <ShortcutBar controller={controller} />\n          </>\n        ),\n      },\n      contentBox,\n    }),\n    [renderChatInputTopSlot, contentBox],\n  );\n  useEffect(() => {\n    switch (initStatus) {\n      case 'initSuccess':\n      case 'initFail':\n        onInitStateChange?.(initStatus);\n        break;\n      default:\n    }\n  }, [initStatus, onInitStateChange]);\n\n  if (initStatus !== 'initSuccess') {\n    return null;\n  }\n  const uploadable = chatConfig?.ui?.chatBot?.uploadable ?? true;\n  const enableLegacyUploadFlag = !enableMultimodalUpload && uploadable;\n  const enableMultimodalUploadFlag = enableMultimodalUpload && uploadable;\n  return (\n    <div\n      className={cs(styles.area, className, {\n        [styles.disabled]: readonly,\n      })}\n      tabIndex={1000}\n      ref={refContainer}\n    >\n      <ChatArea\n        classname={coreAreaClassName}\n        layout={layout === Layout.PC ? undefined : layout}\n        showInputArea={showInputArea}\n        newMessageInterruptScenario=\"never\"\n        messageGroupListClassName={messageGroupListClassName}\n        showClearContextDivider={\n          isShowClearContextDivider ||\n          chatConfig?.ui?.chatBot?.isNeedClearContext\n        }\n        messageMaxWidth={messageMaxWidth}\n        showStopRespond={true}\n        enableLegacyUpload={enableLegacyUploadFlag}\n        enableMultimodalUpload={enableMultimodalUploadFlag}\n        fileLimit={enableMultimodalUploadFlag ? 6 : undefined}\n        textareaPlaceholder={inputPlaceholder || I18n.t('chatInputPlaceholder')}\n        enableMessageBoxActionBar={true}\n        chatInputProps={{\n          wrapperClassName: styles.chatInput,\n          inputNativeCallbacks,\n          safeAreaClassName:\n            chatConfig?.ui?.footer?.isShow !== false ? styles['safe-area'] : '',\n          leftActions: <ChatInputLeftSlot />,\n        }}\n        componentTypes={chatAreaComponentTypes}\n        readonly={readonly}\n        uiKitChatInputButtonConfig={{\n          isClearContextButtonVisible: false,\n          isClearHistoryButtonVisible: false,\n        }}\n        isMiniScreen={isMiniScreen}\n        headerNode={headerNode}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableRenderLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const renderLifeCycleServiceGenerator: WriteableRenderLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableMessageLifeCycleServiceGenerator } from '@coze-common/chat-area';\nimport { Toast } from '@coze-arch/bot-semi';\n\nimport { catchParse } from '@/util';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const messageLifeCycleServiceGenerator: WriteableMessageLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  onSendMessageError: ctx => {\n    const { error } = ctx;\n    if (error instanceof Error) {\n      const res = catchParse<{ code?: number; msg?: string }>(\n        error.message,\n        {},\n      );\n      if (res?.code && res?.msg) {\n        Toast.error(res.msg);\n      }\n    }\n  },\n  onBeforeSendMessage: ctx => {\n    const { options = {} } = ctx;\n    const optionNew = Object.assign({}, options, {\n      extendFiled: {\n        ...options?.extendFiled,\n        extra: {\n          ...(options?.extendFiled?.extra || {}),\n          ...(plugin.pluginBizContext.extraBody || {}),\n        },\n      },\n    });\n    return { ...ctx, options: optionNew };\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableCommandLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const commandLifeCycleServiceGenerator: WriteableCommandLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  /*onImageClick: async ctx => {\n    const url = ctx.url;\n    plugin.pluginBizContext.onImageClick?.({\n      url\n    });\n  }*/\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableAppLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const appLifeCycleServiceGenerator: WriteableAppLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  onInitialError: () => {\n    plugin.pluginBizContext.onInitialError();\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\nimport { renderLifeCycleServiceGenerator } from './render';\nimport { messageLifeCycleServiceGenerator } from './message';\nimport { commandLifeCycleServiceGenerator } from './command';\nimport { appLifeCycleServiceGenerator } from './app';\n\nexport const bizLifeCycleServiceGenerator: WriteableLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  appLifeCycleService: appLifeCycleServiceGenerator(plugin),\n  messageLifeCycleService: messageLifeCycleServiceGenerator(plugin),\n  commandLifeCycleService: commandLifeCycleServiceGenerator(plugin),\n  renderLifeCycleService: renderLifeCycleServiceGenerator(plugin),\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PluginMode,\n  PluginName,\n  WriteableChatAreaPlugin,\n  createWriteableLifeCycleServices,\n} from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { bizLifeCycleServiceGenerator } from './services/life-cycle';\n\nexport class BizPlugin extends WriteableChatAreaPlugin<PluginBizContext> {\n  /**\n   * \n   * PluginMode.Readonly = \n   * PluginMode.Writeable = \n   */\n  public pluginMode = PluginMode.Writeable;\n  /**\n   * \n   *  PluginName \n   */\n  public pluginName = PluginName.WebsdkChatCommonPlugin;\n\n  /**\n   * \n   */\n  public lifeCycleServices = createWriteableLifeCycleServices(\n    this,\n    bizLifeCycleServiceGenerator,\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { BizPlugin } from './plugin';\n\nexport type ChatCommonPlugin = PluginRegistryEntry<PluginBizContext>;\nexport const getChatCommonPlugin = (props: PluginBizContext) => {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const WebsdkChatCommonPlugin: ChatCommonPlugin = {\n    /**\n     * \n     */\n    createPluginBizContext() {\n      return { ...props };\n    },\n    /**\n     * \n     */\n    Plugin: BizPlugin,\n  };\n  return WebsdkChatCommonPlugin;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport {\n  type UploadPluginInterface,\n  type FileType,\n} from '@coze-common/chat-core';\nimport { FileStatus } from '@coze-common/chat-area';\n\nimport { type OpenApiSource } from '@/types/open';\nimport { type EventPayloadMap } from '@/types/core';\n\nexport interface UploadFileData {\n  uri: string;\n  url: string;\n}\n\nexport type UploadFileApi = (props: {\n  file: File;\n  botId: string;\n  source: OpenApiSource;\n  token?: string;\n  onProgress?: (percent: number) => void;\n}) => Promise<UploadFileData>;\n\nexport const createSDKUploadPluginClass = ({\n  botId,\n  source,\n  token,\n  uploadFile,\n}: {\n  botId: string;\n  source: OpenApiSource;\n  token?: string;\n  uploadFile: UploadFileApi;\n}) =>\n  class SDKUploadPlugin implements UploadPluginInterface {\n    file: File;\n    fileType: FileType;\n    eventBus = new EventEmitter();\n    /**\n     *   core&area \n     */\n    // @ts-expect-error -- linter-disable-autofix\n    userId: string;\n    // @ts-expect-error -- linter-disable-autofix\n    abortController: AbortController;\n\n    constructor(props: { file: File; type: FileType; userId: string }) {\n      this.file = props.file;\n      this.fileType = props.type;\n\n      this.upload()\n        .then(meta => {\n          this.eventBus.emit('complete', {\n            percent: 100,\n            status: FileStatus.Success,\n            uploadResult: {\n              Uri: meta.uri,\n              Url: meta.url,\n            },\n            type: 'success',\n          });\n        })\n        .catch(err => {\n          this.eventBus.emit('error');\n        });\n    }\n\n    start() {\n      return;\n    }\n\n    on<T extends keyof EventPayloadMap>(\n      eventName: T,\n      callback: (info: EventPayloadMap[T]) => void,\n    ) {\n      this.eventBus.on(eventName, callback);\n    }\n\n    pause() {\n      return;\n    }\n\n    cancel() {\n      return;\n    }\n\n    async upload() {\n      this.eventBus.emit('ready', {\n        percent: 0,\n        status: FileStatus.Uploading,\n      });\n\n      const result = await uploadFile({\n        source,\n        botId,\n        file: this.file,\n        token,\n        onProgress: percent => {\n          this.eventBus.emit('progress', {\n            percent,\n            status: FileStatus.Uploading,\n          });\n        },\n      });\n\n      return result;\n    }\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createMinimalBrowserClient } from '@coze-studio/slardar-adapter';\nimport { getSlardarEnv } from '@coze-common/chat-core';\nimport { Reporter } from '@coze-arch/logger';\n\nimport { ChatSdkError, SDKErrorCode } from '@/util/error';\nimport { eventMeta } from '@/util/env';\n\nconst slardarInstance = createMinimalBrowserClient();\nslardarInstance.init({\n  bid: 'bot_studio_sdk',\n  /**\n   * core bid_env\n   */\n  env: getSlardarEnv({\n    env: 'thirdPart',\n    deployVersion: 'release',\n  }),\n});\nslardarInstance.start();\n\nconst eventPrefix = 'open_sdk_custom_event_';\nconst errorPrefix = 'open_sdk_custom_error_';\n\nconst enum OpenReportEvent {\n  IframeLoaded = 'IframeLoaded',\n  ClientInit = 'ClientInit',\n}\n\nclass OpenReporter extends Reporter {\n  openSdkEvent(eventName: OpenReportEvent, meta: Record<string, unknown>) {\n    this.event({\n      eventName: eventPrefix + eventName,\n      meta: {\n        ...(meta ?? {}),\n        ...eventMeta,\n      },\n    });\n  }\n\n  openSdkError(error: Error | unknown, code = SDKErrorCode.Base) {\n    if (!(error instanceof Error)) {\n      this.errorEvent({\n        eventName: errorPrefix + SDKErrorCode.NotError,\n        error: ChatSdkError.create(SDKErrorCode.NotError),\n        meta: {\n          error,\n        },\n      });\n      return;\n    }\n\n    this.errorEvent({\n      eventName: errorPrefix + code,\n      error,\n      meta: eventMeta,\n    });\n  }\n}\n\nexport const studioOpenClientReporter = new OpenReporter();\n\nstudioOpenClientReporter.init(slardarInstance);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { isEqual } from 'lodash-es';\nimport { useChatAreaStoreSet } from '@coze-common/chat-area';\n\nimport { useChatAppStore } from '../store';\n\nexport const useUpdateConversationNameByMessage = () => {\n  const currentConversationNameRef = useRef<string>();\n  const { updateCurrentConversationNameByMessage, currentConversationInfo } =\n    useChatAppStore(\n      useShallow(s => ({\n        updateCurrentConversationNameByMessage:\n          s.updateCurrentConversationNameByMessage,\n        currentConversationInfo: s.currentConversationInfo,\n      })),\n    );\n\n  const { useMessagesStore } = useChatAreaStoreSet();\n\n  const messages = useMessagesStore(s => s.messages, isEqual);\n\n  useEffect(() => {\n    currentConversationNameRef.current = currentConversationInfo?.name;\n  }, [currentConversationInfo]);\n\n  useEffect(() => {\n    const message = messages[messages.length - 1];\n    const name = message?.content.slice(0, 100);\n    if (message && !currentConversationNameRef.current) {\n      updateCurrentConversationNameByMessage(name);\n      currentConversationNameRef.current = name;\n    }\n  }, [messages]);\n};\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\n\nvar Event = /** @class */ (function () {\r\n    function Event(type, target) {\r\n        this.target = target;\r\n        this.type = type;\r\n    }\r\n    return Event;\r\n}());\r\nvar ErrorEvent = /** @class */ (function (_super) {\r\n    __extends(ErrorEvent, _super);\r\n    function ErrorEvent(error, target) {\r\n        var _this = _super.call(this, 'error', target) || this;\r\n        _this.message = error.message;\r\n        _this.error = error;\r\n        return _this;\r\n    }\r\n    return ErrorEvent;\r\n}(Event));\r\nvar CloseEvent = /** @class */ (function (_super) {\r\n    __extends(CloseEvent, _super);\r\n    function CloseEvent(code, reason, target) {\r\n        if (code === void 0) { code = 1000; }\r\n        if (reason === void 0) { reason = ''; }\r\n        var _this = _super.call(this, 'close', target) || this;\r\n        _this.wasClean = true;\r\n        _this.code = code;\r\n        _this.reason = reason;\r\n        return _this;\r\n    }\r\n    return CloseEvent;\r\n}(Event));\n\n/*!\r\n * Reconnecting WebSocket\r\n * by Pedro Ladaria <pedro.ladaria@gmail.com>\r\n * https://github.com/pladaria/reconnecting-websocket\r\n * License MIT\r\n */\r\nvar getGlobalWebSocket = function () {\r\n    if (typeof WebSocket !== 'undefined') {\r\n        // @ts-ignore\r\n        return WebSocket;\r\n    }\r\n};\r\n/**\r\n * Returns true if given argument looks like a WebSocket class\r\n */\r\nvar isWebSocket = function (w) { return typeof w !== 'undefined' && !!w && w.CLOSING === 2; };\r\nvar DEFAULT = {\r\n    maxReconnectionDelay: 10000,\r\n    minReconnectionDelay: 1000 + Math.random() * 4000,\r\n    minUptime: 5000,\r\n    reconnectionDelayGrowFactor: 1.3,\r\n    connectionTimeout: 4000,\r\n    maxRetries: Infinity,\r\n    maxEnqueuedMessages: Infinity,\r\n    startClosed: false,\r\n    debug: false,\r\n};\r\nvar ReconnectingWebSocket = /** @class */ (function () {\r\n    function ReconnectingWebSocket(url, protocols, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        this._listeners = {\r\n            error: [],\r\n            message: [],\r\n            open: [],\r\n            close: [],\r\n        };\r\n        this._retryCount = -1;\r\n        this._shouldReconnect = true;\r\n        this._connectLock = false;\r\n        this._binaryType = 'blob';\r\n        this._closeCalled = false;\r\n        this._messageQueue = [];\r\n        /**\r\n         * An event listener to be called when the WebSocket connection's readyState changes to CLOSED\r\n         */\r\n        this.onclose = null;\r\n        /**\r\n         * An event listener to be called when an error occurs\r\n         */\r\n        this.onerror = null;\r\n        /**\r\n         * An event listener to be called when a message is received from the server\r\n         */\r\n        this.onmessage = null;\r\n        /**\r\n         * An event listener to be called when the WebSocket connection's readyState changes to OPEN;\r\n         * this indicates that the connection is ready to send and receive data\r\n         */\r\n        this.onopen = null;\r\n        this._handleOpen = function (event) {\r\n            _this._debug('open event');\r\n            var _a = _this._options.minUptime, minUptime = _a === void 0 ? DEFAULT.minUptime : _a;\r\n            clearTimeout(_this._connectTimeout);\r\n            _this._uptimeTimeout = setTimeout(function () { return _this._acceptOpen(); }, minUptime);\r\n            _this._ws.binaryType = _this._binaryType;\r\n            // send enqueued messages (messages sent before websocket open event)\r\n            _this._messageQueue.forEach(function (message) { return _this._ws.send(message); });\r\n            _this._messageQueue = [];\r\n            if (_this.onopen) {\r\n                _this.onopen(event);\r\n            }\r\n            _this._listeners.open.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._handleMessage = function (event) {\r\n            _this._debug('message event');\r\n            if (_this.onmessage) {\r\n                _this.onmessage(event);\r\n            }\r\n            _this._listeners.message.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._handleError = function (event) {\r\n            _this._debug('error event', event.message);\r\n            _this._disconnect(undefined, event.message === 'TIMEOUT' ? 'timeout' : undefined);\r\n            if (_this.onerror) {\r\n                _this.onerror(event);\r\n            }\r\n            _this._debug('exec error listeners');\r\n            _this._listeners.error.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n            _this._connect();\r\n        };\r\n        this._handleClose = function (event) {\r\n            _this._debug('close event');\r\n            _this._clearTimeouts();\r\n            if (_this._shouldReconnect) {\r\n                _this._connect();\r\n            }\r\n            if (_this.onclose) {\r\n                _this.onclose(event);\r\n            }\r\n            _this._listeners.close.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._url = url;\r\n        this._protocols = protocols;\r\n        this._options = options;\r\n        if (this._options.startClosed) {\r\n            this._shouldReconnect = false;\r\n        }\r\n        this._connect();\r\n    }\r\n    Object.defineProperty(ReconnectingWebSocket, \"CONNECTING\", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"OPEN\", {\r\n        get: function () {\r\n            return 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"CLOSING\", {\r\n        get: function () {\r\n            return 2;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"CLOSED\", {\r\n        get: function () {\r\n            return 3;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CONNECTING\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CONNECTING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"OPEN\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.OPEN;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CLOSING\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CLOSING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CLOSED\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CLOSED;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"binaryType\", {\r\n        get: function () {\r\n            return this._ws ? this._ws.binaryType : this._binaryType;\r\n        },\r\n        set: function (value) {\r\n            this._binaryType = value;\r\n            if (this._ws) {\r\n                this._ws.binaryType = value;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"retryCount\", {\r\n        /**\r\n         * Returns the number or connection retries\r\n         */\r\n        get: function () {\r\n            return Math.max(this._retryCount, 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"bufferedAmount\", {\r\n        /**\r\n         * The number of bytes of data that have been queued using calls to send() but not yet\r\n         * transmitted to the network. This value resets to zero once all queued data has been sent.\r\n         * This value does not reset to zero when the connection is closed; if you keep calling send(),\r\n         * this will continue to climb. Read only\r\n         */\r\n        get: function () {\r\n            var bytes = this._messageQueue.reduce(function (acc, message) {\r\n                if (typeof message === 'string') {\r\n                    acc += message.length; // not byte size\r\n                }\r\n                else if (message instanceof Blob) {\r\n                    acc += message.size;\r\n                }\r\n                else {\r\n                    acc += message.byteLength;\r\n                }\r\n                return acc;\r\n            }, 0);\r\n            return bytes + (this._ws ? this._ws.bufferedAmount : 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"extensions\", {\r\n        /**\r\n         * The extensions selected by the server. This is currently only the empty string or a list of\r\n         * extensions as negotiated by the connection\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.extensions : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"protocol\", {\r\n        /**\r\n         * A string indicating the name of the sub-protocol the server selected;\r\n         * this will be one of the strings specified in the protocols parameter when creating the\r\n         * WebSocket object\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.protocol : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"readyState\", {\r\n        /**\r\n         * The current state of the connection; this is one of the Ready state constants\r\n         */\r\n        get: function () {\r\n            if (this._ws) {\r\n                return this._ws.readyState;\r\n            }\r\n            return this._options.startClosed\r\n                ? ReconnectingWebSocket.CLOSED\r\n                : ReconnectingWebSocket.CONNECTING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"url\", {\r\n        /**\r\n         * The URL as resolved by the constructor\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.url : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Closes the WebSocket connection or connection attempt, if any. If the connection is already\r\n     * CLOSED, this method does nothing\r\n     */\r\n    ReconnectingWebSocket.prototype.close = function (code, reason) {\r\n        if (code === void 0) { code = 1000; }\r\n        this._closeCalled = true;\r\n        this._shouldReconnect = false;\r\n        this._clearTimeouts();\r\n        if (!this._ws) {\r\n            this._debug('close enqueued: no ws instance');\r\n            return;\r\n        }\r\n        if (this._ws.readyState === this.CLOSED) {\r\n            this._debug('close: already closed');\r\n            return;\r\n        }\r\n        this._ws.close(code, reason);\r\n    };\r\n    /**\r\n     * Closes the WebSocket connection or connection attempt and connects again.\r\n     * Resets retry counter;\r\n     */\r\n    ReconnectingWebSocket.prototype.reconnect = function (code, reason) {\r\n        this._shouldReconnect = true;\r\n        this._closeCalled = false;\r\n        this._retryCount = -1;\r\n        if (!this._ws || this._ws.readyState === this.CLOSED) {\r\n            this._connect();\r\n        }\r\n        else {\r\n            this._disconnect(code, reason);\r\n            this._connect();\r\n        }\r\n    };\r\n    /**\r\n     * Enqueue specified data to be transmitted to the server over the WebSocket connection\r\n     */\r\n    ReconnectingWebSocket.prototype.send = function (data) {\r\n        if (this._ws && this._ws.readyState === this.OPEN) {\r\n            this._debug('send', data);\r\n            this._ws.send(data);\r\n        }\r\n        else {\r\n            var _a = this._options.maxEnqueuedMessages, maxEnqueuedMessages = _a === void 0 ? DEFAULT.maxEnqueuedMessages : _a;\r\n            if (this._messageQueue.length < maxEnqueuedMessages) {\r\n                this._debug('enqueue', data);\r\n                this._messageQueue.push(data);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Register an event handler of a specific event type\r\n     */\r\n    ReconnectingWebSocket.prototype.addEventListener = function (type, listener) {\r\n        if (this._listeners[type]) {\r\n            // @ts-ignore\r\n            this._listeners[type].push(listener);\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype.dispatchEvent = function (event) {\r\n        var e_1, _a;\r\n        var listeners = this._listeners[event.type];\r\n        if (listeners) {\r\n            try {\r\n                for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\r\n                    var listener = listeners_1_1.value;\r\n                    this._callEventListener(event, listener);\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Removes an event listener\r\n     */\r\n    ReconnectingWebSocket.prototype.removeEventListener = function (type, listener) {\r\n        if (this._listeners[type]) {\r\n            // @ts-ignore\r\n            this._listeners[type] = this._listeners[type].filter(function (l) { return l !== listener; });\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._debug = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (this._options.debug) {\r\n            // not using spread because compiled version uses Symbols\r\n            // tslint:disable-next-line\r\n            console.log.apply(console, __spread(['RWS>'], args));\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._getNextDelay = function () {\r\n        var _a = this._options, _b = _a.reconnectionDelayGrowFactor, reconnectionDelayGrowFactor = _b === void 0 ? DEFAULT.reconnectionDelayGrowFactor : _b, _c = _a.minReconnectionDelay, minReconnectionDelay = _c === void 0 ? DEFAULT.minReconnectionDelay : _c, _d = _a.maxReconnectionDelay, maxReconnectionDelay = _d === void 0 ? DEFAULT.maxReconnectionDelay : _d;\r\n        var delay = 0;\r\n        if (this._retryCount > 0) {\r\n            delay =\r\n                minReconnectionDelay * Math.pow(reconnectionDelayGrowFactor, this._retryCount - 1);\r\n            if (delay > maxReconnectionDelay) {\r\n                delay = maxReconnectionDelay;\r\n            }\r\n        }\r\n        this._debug('next delay', delay);\r\n        return delay;\r\n    };\r\n    ReconnectingWebSocket.prototype._wait = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            setTimeout(resolve, _this._getNextDelay());\r\n        });\r\n    };\r\n    ReconnectingWebSocket.prototype._getNextUrl = function (urlProvider) {\r\n        if (typeof urlProvider === 'string') {\r\n            return Promise.resolve(urlProvider);\r\n        }\r\n        if (typeof urlProvider === 'function') {\r\n            var url = urlProvider();\r\n            if (typeof url === 'string') {\r\n                return Promise.resolve(url);\r\n            }\r\n            if (!!url.then) {\r\n                return url;\r\n            }\r\n        }\r\n        throw Error('Invalid URL');\r\n    };\r\n    ReconnectingWebSocket.prototype._connect = function () {\r\n        var _this = this;\r\n        if (this._connectLock || !this._shouldReconnect) {\r\n            return;\r\n        }\r\n        this._connectLock = true;\r\n        var _a = this._options, _b = _a.maxRetries, maxRetries = _b === void 0 ? DEFAULT.maxRetries : _b, _c = _a.connectionTimeout, connectionTimeout = _c === void 0 ? DEFAULT.connectionTimeout : _c, _d = _a.WebSocket, WebSocket = _d === void 0 ? getGlobalWebSocket() : _d;\r\n        if (this._retryCount >= maxRetries) {\r\n            this._debug('max retries reached', this._retryCount, '>=', maxRetries);\r\n            return;\r\n        }\r\n        this._retryCount++;\r\n        this._debug('connect', this._retryCount);\r\n        this._removeListeners();\r\n        if (!isWebSocket(WebSocket)) {\r\n            throw Error('No valid WebSocket class provided');\r\n        }\r\n        this._wait()\r\n            .then(function () { return _this._getNextUrl(_this._url); })\r\n            .then(function (url) {\r\n            // close could be called before creating the ws\r\n            if (_this._closeCalled) {\r\n                return;\r\n            }\r\n            _this._debug('connect', { url: url, protocols: _this._protocols });\r\n            _this._ws = _this._protocols\r\n                ? new WebSocket(url, _this._protocols)\r\n                : new WebSocket(url);\r\n            _this._ws.binaryType = _this._binaryType;\r\n            _this._connectLock = false;\r\n            _this._addListeners();\r\n            _this._connectTimeout = setTimeout(function () { return _this._handleTimeout(); }, connectionTimeout);\r\n        });\r\n    };\r\n    ReconnectingWebSocket.prototype._handleTimeout = function () {\r\n        this._debug('timeout event');\r\n        this._handleError(new ErrorEvent(Error('TIMEOUT'), this));\r\n    };\r\n    ReconnectingWebSocket.prototype._disconnect = function (code, reason) {\r\n        if (code === void 0) { code = 1000; }\r\n        this._clearTimeouts();\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._removeListeners();\r\n        try {\r\n            this._ws.close(code, reason);\r\n            this._handleClose(new CloseEvent(code, reason, this));\r\n        }\r\n        catch (error) {\r\n            // ignore\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._acceptOpen = function () {\r\n        this._debug('accept open');\r\n        this._retryCount = 0;\r\n    };\r\n    ReconnectingWebSocket.prototype._callEventListener = function (event, listener) {\r\n        if ('handleEvent' in listener) {\r\n            // @ts-ignore\r\n            listener.handleEvent(event);\r\n        }\r\n        else {\r\n            // @ts-ignore\r\n            listener(event);\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._removeListeners = function () {\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._debug('removeListeners');\r\n        this._ws.removeEventListener('open', this._handleOpen);\r\n        this._ws.removeEventListener('close', this._handleClose);\r\n        this._ws.removeEventListener('message', this._handleMessage);\r\n        // @ts-ignore\r\n        this._ws.removeEventListener('error', this._handleError);\r\n    };\r\n    ReconnectingWebSocket.prototype._addListeners = function () {\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._debug('addListeners');\r\n        this._ws.addEventListener('open', this._handleOpen);\r\n        this._ws.addEventListener('close', this._handleClose);\r\n        this._ws.addEventListener('message', this._handleMessage);\r\n        // @ts-ignore\r\n        this._ws.addEventListener('error', this._handleError);\r\n    };\r\n    ReconnectingWebSocket.prototype._clearTimeouts = function () {\r\n        clearTimeout(this._connectTimeout);\r\n        clearTimeout(this._uptimeTimeout);\r\n    };\r\n    return ReconnectingWebSocket;\r\n}());\n\nexport default ReconnectingWebSocket;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport axios, { type AxiosInstance, type AxiosResponse } from 'axios';\nimport { CozeAPI, type ClientOptions } from '@coze/api';\n\nimport { isAuthError } from '@/util/error';\n\ntype OnRefreshToken = (oldToken?: string) => Promise<string> | string;\n\nexport class CozeApiCustom extends CozeAPI {\n  private onRefreshToken?: OnRefreshToken;\n  private refreshTokenPromise?: Promise<string> | string;\n  constructor({\n    onRefreshToken,\n    axiosOptions,\n    ...config\n  }: ClientOptions & {\n    onRefreshToken?: OnRefreshToken;\n  }) {\n    super({\n      ...config,\n      axiosOptions: {\n        ...(axiosOptions || {}),\n        timeout: 10 * 60 * 1000,\n        validateStatus: () => true,\n      },\n    });\n    this.onRefreshToken = onRefreshToken;\n    this.axiosInstance = axios.create();\n    this.useAuthError();\n  }\n  setRefreshToken(onRefreshToken?: OnRefreshToken) {\n    this.onRefreshToken = onRefreshToken;\n  }\n  useAuthError() {\n    const authInterceptor = async response => {\n      const { code } = response?.data || {};\n      if (isAuthError(code || response.status)) {\n        //  \n        const oldToken = this.getTokenFromHeaderAuth(\n          String(response.config.headers.getAuthorization() || ''),\n        );\n        const token = await this.refreshToken(oldToken);\n        if (token) {\n          const config = { ...response.config };\n          config.headers = { ...response.config.headers };\n          response.config.headers.Authorization = `Bearer ${token}`;\n          return await axios.request(response.config);\n        }\n      }\n      return response;\n    };\n    this.useResponseInterceptors(authInterceptor, authInterceptor);\n  }\n  getTokenFromHeaderAuth(authorization: string) {\n    return authorization.replace(/^\\s*Bearer\\s*/, '').replace(/\\s+$/, '');\n  }\n  async refreshToken(oldToken: string): Promise<string> {\n    if (this.refreshTokenPromise) {\n      return this.refreshTokenPromise;\n    }\n    if (oldToken !== this.token) {\n      // token\n      return this.token as string;\n    }\n    this.refreshTokenPromise = this.onRefreshToken?.(this.token);\n    const token = await this.refreshTokenPromise;\n    this.refreshTokenPromise = undefined;\n    this.token = token || '';\n    return this.token;\n  }\n  useResponseInterceptors(\n    responseInterceptor:\n      | ((response: AxiosResponse) => AxiosResponse | Promise<AxiosResponse>)\n      | undefined,\n    rejectResponseInterceptor:\n      | ((response: AxiosResponse) => AxiosResponse | Promise<AxiosResponse>)\n      | undefined,\n  ) {\n    this.getAxiosInstance().interceptors.response.use(\n      responseInterceptor,\n      rejectResponseInterceptor,\n    );\n  }\n  getAxiosInstance() {\n    return this.axiosInstance as AxiosInstance;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useMemo } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { useMemoizedFn } from 'ahooks';\nimport { TokenManager } from '@coze-common/chat-core';\n\nimport { openApiHostByRegionWithToken } from '@/util/env';\n\nimport { useChatAppStore, useChatAppProps } from '../../store';\nimport { CozeApiCustom } from './helper/coze-api-custom';\nexport const useApiClient = () => {\n  const { debug } = useChatAppProps();\n\n  const {\n    token = '',\n    refreshToken: refreshTokenRaw,\n    setToken,\n    setCozeApi,\n  } = useChatAppStore(\n    useShallow(s => ({\n      token: s.token,\n      setToken: s.setToken,\n      refreshToken: s.refreshToken,\n      setCozeApi: s.setCozeApi,\n    })),\n  );\n\n  const tokenManagerClient = useMemo<TokenManager>(\n    () =>\n      new TokenManager({\n        apiKey: token,\n      }),\n    [],\n  );\n\n  // coze Api \n  const cozeApiClient = useMemo<CozeApiCustom>(\n    () =>\n      new CozeApiCustom({\n        token,\n        allowPersonalAccessTokenInBrowser: true,\n        baseURL: openApiHostByRegionWithToken,\n        axiosOptions: {\n          headers: {\n            ...(debug?.cozeApiRequestHeader || {}),\n          },\n        },\n      }),\n    [],\n  );\n  // token\n  // clienttoken\n  const updateToken = useMemoizedFn(newToken => {\n    tokenManagerClient?.updateApiKey(newToken);\n    cozeApiClient.token = newToken;\n  });\n  // token\n  const refreshToken = useMemoizedFn(async () => {\n    const newToken = await refreshTokenRaw?.();\n    if (newToken) {\n      updateToken(newToken);\n      setToken(newToken);\n    }\n    return newToken;\n  });\n\n  cozeApiClient.setRefreshToken(refreshToken);\n\n  useEffect(() => {\n    updateToken(token);\n  }, [token]);\n\n  useEffect(() => {\n    setCozeApi(cozeApiClient);\n  }, [cozeApiClient]);\n\n  return {\n    tokenManagerClient,\n    cozeApiClient,\n    refreshToken,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useContext,\n  createContext,\n  type ReactNode,\n  useRef,\n  type FC,\n} from 'react';\n\nimport { type TokenManager } from '@coze-common/chat-core';\nimport { type CozeAPI } from '@coze/api';\n\nimport { useApiClient } from './use-api-client';\n\ninterface ContextValue {\n  cozeApiSdk: CozeAPI;\n  tokenManager: TokenManager;\n  refreshToken?: () => Promise<string>;\n  refMessageListLeft?: React.RefObject<Record<string, unknown>>;\n}\n// @ts-expect-error: \nexport const ChatCozeSdkContext = createContext<ContextValue>({});\nexport const ChatCozeSdkProvider: FC<{ children: ReactNode }> = ({\n  children,\n}) => {\n  const refMessageListLeft = useRef<Record<string, unknown>>({});\n  const { tokenManagerClient, cozeApiClient, refreshToken } = useApiClient();\n\n  return (\n    <ChatCozeSdkContext.Provider\n      value={{\n        cozeApiSdk: cozeApiClient,\n        tokenManager: tokenManagerClient,\n        refMessageListLeft,\n        refreshToken,\n      }}\n    >\n      {children}\n    </ChatCozeSdkContext.Provider>\n  );\n};\n\nexport const useChatCozeSdk = (): ContextValue => {\n  const { cozeApiSdk, tokenManager, refMessageListLeft, refreshToken } =\n    useContext(ChatCozeSdkContext);\n  return {\n    cozeApiSdk,\n    tokenManager,\n    refMessageListLeft,\n    refreshToken,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { type UploadFileApi } from '@/helper';\n\nimport { useChatCozeSdk } from './context';\nexport const useUploadFileApi = (): UploadFileApi => {\n  const { cozeApiSdk } = useChatCozeSdk();\n  return useCallback(\n    async ({ file }) => {\n      const result = await cozeApiSdk?.files.upload({\n        file,\n      });\n\n      return {\n        uri: result?.id || '',\n        url: '',\n      };\n    },\n    [cozeApiSdk],\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ShortCutCommand } from '@coze-common/chat-area-plugins-chat-shortcuts';\nimport { SendType, ToolType, InputType } from '@coze-arch/idl/playground_api';\n\nconst refInputTypeMap = {\n  text: InputType.TextInput,\n  select: InputType.Select,\n  file: InputType.MixUpload,\n  image: InputType.UploadImage,\n  audio: InputType.UploadAudio,\n  doc: InputType.UploadDoc,\n  table: InputType.UploadTable,\n  code: InputType.CODE,\n  zip: InputType.ARCHIVE,\n  ppt: InputType.PPT,\n  video: InputType.VIDEO,\n  txt: InputType.TXT,\n};\nexport interface ShortcutCommandInOpenApi {\n  id: string;\n  name: string;\n  command: string;\n  description: string;\n  query_template: string;\n  icon_url: string;\n  components?: Array<{\n    name: string;\n    description: string;\n    type: 'text' | 'file' | 'select';\n    tool_parameter: string;\n    is_hide: boolean;\n    options: Array<string>;\n    default_value: string;\n  }>;\n  tool?: {\n    name: string;\n    type: 'plugin' | 'workflow';\n    plugin_id: string;\n    plugin_api_name: string;\n    workflow_id: string;\n    params?: Array<{\n      name: string;\n      is_required: boolean;\n      description: string;\n      type: string;\n      default_value: string;\n      is_refer_component: boolean;\n    }>;\n  };\n  send_type: 'panel' | 'query';\n  card_schema: string;\n}\n\nexport const convertShortcutData = (\n  shortcutCommands?: ShortcutCommandInOpenApi[],\n  botInfo?: {\n    name?: string;\n    iconUrl?: string;\n    id?: string;\n  },\n): ShortCutCommand[] =>\n  //@ts-expect-error: \n  shortcutCommands?.map(item => {\n    const sendType =\n      item.send_type &&\n      (item.send_type === 'panel'\n        ? SendType.SendTypePanel\n        : SendType.SendTypeQuery);\n\n    let componentsList;\n    let toolType;\n    if (sendType !== SendType.SendTypeQuery) {\n      componentsList =\n        item.components?.map(componentItem => ({\n          name: componentItem.name,\n          description: componentItem.description,\n          parameter: componentItem.tool_parameter,\n          hide: componentItem.is_hide,\n          options:\n            (componentItem.type === 'select' && componentItem.options) || [],\n\n          input_type: refInputTypeMap[componentItem.type],\n          upload_options:\n            (componentItem.type === 'file' &&\n              componentItem.options?.map(option => refInputTypeMap[option])) ||\n            [],\n\n          default_value: {\n            value: componentItem.default_value || '',\n            type: 0,\n          },\n        })) || [];\n      if (item?.tool?.type && ['plugin', 'workflow'].includes(item.tool.type)) {\n        toolType =\n          item.tool.type === 'plugin'\n            ? ToolType.ToolTypePlugin\n            : ToolType.ToolTypeWorkFlow;\n      }\n    }\n\n    return {\n      object_id: botInfo?.id || '',\n      command_name: item.name,\n      shortcut_command: item.command,\n      description: item.description,\n      send_type: sendType,\n      tool_type: toolType,\n      work_flow_id: item?.tool?.workflow_id || '',\n      plugin_id: item?.tool?.plugin_id || '',\n      plugin_api_name: item?.tool?.name || '',\n      template_query: item.query_template,\n      components_list: componentsList,\n      card_schema: item.card_schema,\n      command_id: item.id,\n      tool_info: {\n        tool_name: item.tool?.name,\n        tool_params_list:\n          item.tool?.params?.map(param => ({\n            name: param.name,\n            required: param.is_required,\n            desc: param.description,\n            type: param.type,\n            default_value: param.default_value,\n            refer_component: param.is_refer_component,\n          })) || [],\n      },\n      shortcut_icon: {\n        url: item.icon_url,\n      },\n      bot_info: {\n        icon_url: botInfo?.iconUrl || '',\n        name: botInfo?.name || '',\n      },\n    };\n  }) || [];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentType, type MessageContent } from '@coze-common/chat-core';\nimport { type ShortCutCommand } from '@coze-common/chat-area-plugins-chat-shortcuts';\nimport { type MixInitResponse, type ChatMessage } from '@coze-common/chat-area';\nimport {\n  type EnterMessage,\n  type RoleType,\n  type ContentType as CozeApiContentType,\n  type ObjectStringItem,\n} from '@coze/api';\n\nimport { catchParse } from '@/util';\nimport { type OpenUserInfo } from '@/types/user';\n\nclass MessageConverterToSdk {\n  public convertRequestBody({\n    body,\n    userInfo,\n    connectorId,\n    parameters,\n    shortcuts,\n  }: {\n    body: string;\n    userInfo?: OpenUserInfo;\n    connectorId?: string;\n    parameters?: Record<string, unknown>;\n    shortcuts?: ShortCutCommand[];\n  }): string {\n    const messageBody: Record<string, string> = catchParse(body) || {};\n    const contentType = messageBody.content_type as ContentType;\n    const content = messageBody.query as string;\n    const shortcutCommand = messageBody.shortcut_command as string;\n    return JSON.stringify({\n      bot_id: messageBody.bot_id,\n      user_id: userInfo?.id,\n      stream: true,\n      connector_id: connectorId,\n      additional_messages: [this.convertRequestMessage(contentType, content)],\n      parameters,\n      shortcut_command: this.convertShortcuts(shortcuts || [], shortcutCommand),\n      enable_card: true,\n    });\n  }\n  //  chat message\n  private convertRequestMessage(contentType: ContentType, content: string) {\n    return {\n      role: 'user',\n      ...this.convertContent(contentType, content),\n    };\n  }\n  private convertContent(\n    contentType: ContentType,\n    content: string,\n    isNeedFileUrl = false,\n  ) {\n    switch (contentType) {\n      case ContentType.Text:\n        return {\n          content_type: 'text',\n          content,\n        };\n      case ContentType.Card:\n        return {\n          content_type: 'card',\n          content,\n        };\n      case ContentType.Image:\n      case ContentType.File:\n      case ContentType.Mix: {\n        return this.convertMixContent(content, isNeedFileUrl);\n      }\n      default: {\n        throw new Error('Error: unknown content Type');\n      }\n    }\n  }\n  private convertMixContent(content: string, isNeedFileUrl = false) {\n    const contentObj = catchParse(content) as MessageContent<ContentType.Mix> &\n      MessageContent<ContentType.File> &\n      MessageContent<ContentType.Image>;\n    if (!contentObj) {\n      return;\n    }\n    let mixObjectList: MessageContent<ContentType.Mix>['item_list'] = [\n      ...(contentObj?.item_list || []),\n    ];\n    const mixReferObjectList: MessageContent<ContentType.Mix>['item_list'] = [\n      // @ts-expect-error -- linter-disable-autofix\n      ...(contentObj?.refer_items || []),\n    ];\n    mixObjectList = mixObjectList.concat(\n      (contentObj?.image_list || []).map(item => ({\n        type: ContentType.Image,\n        image: item,\n      })),\n    );\n    mixObjectList = mixObjectList.concat(\n      (contentObj?.file_list || []).map(item => ({\n        type: ContentType.File,\n        file: item,\n      })),\n    );\n    mixObjectList = mixObjectList.concat(\n      (mixReferObjectList || []).map(item => ({\n        ...item,\n        is_refer: true,\n      })),\n    );\n\n    return {\n      content_type: 'object_string',\n      content: JSON.stringify(\n        mixObjectList\n          .map(item => {\n            switch (item.type) {\n              case ContentType.Text:\n                return {\n                  type: 'text',\n                  text: item.text,\n                  // @ts-expect-error -- linter-disable-autofix\n                  is_refer: item.is_refer || undefined,\n                };\n              case ContentType.Image: {\n                return {\n                  type: 'image',\n                  file_id: item.image.key,\n                  file_url:\n                    isNeedFileUrl || !item.image.key\n                      ? item.image.image_ori?.url\n                      : undefined,\n                  // @ts-expect-error -- linter-disable-autofix\n                  is_refer: item.is_refer || undefined,\n                };\n              }\n              case ContentType.File: {\n                return {\n                  type: 'file',\n                  file_id: item.file.file_key || !item.file.file_key,\n                  file_url: isNeedFileUrl ? item.file?.file_url : undefined,\n                  // @ts-expect-error -- linter-disable-autofix\n                  is_refer: item.is_refer || undefined,\n                };\n              }\n              default: {\n                return null;\n              }\n            }\n          })\n          .filter(item => !!item),\n      ),\n    };\n  }\n  public convertMessageListResponse(\n    messageList: MixInitResponse['messageList'],\n  ) {\n    return messageList\n      ?.reverse()\n      .map(item => {\n        const cozeMessage = this.convertMessage(item);\n        //(alias) type CozeApiContentType = \"text\" | \"card\" | \"object_string\"\n\n        if (cozeMessage?.content_type === 'object_string') {\n          const contentObj = catchParse(\n            cozeMessage.content as unknown as string,\n          ) as ObjectStringItem[];\n          const contentTemp = contentObj?.map(item2 => {\n            if (item2.type === 'image' || item2.type === 'file') {\n              return {\n                type: 'text',\n                text: item2.file_url,\n              };\n            }\n            return item2;\n          });\n          if (contentTemp?.length === 1 && contentTemp[0]?.type === 'text') {\n            cozeMessage.content_type = 'text' as CozeApiContentType;\n            cozeMessage.content = contentTemp[0].text;\n          } else if (contentTemp?.length > 0) {\n            cozeMessage.content = JSON.stringify(contentTemp);\n          } else {\n            return null;\n          }\n        }\n        return cozeMessage;\n      })\n      .filter(item => !!item);\n  }\n  private convertMessage(message: ChatMessage): EnterMessage | null {\n    if (\n      message.type &&\n      ['ack', 'answer', 'question'].includes(message.type) &&\n      message.role &&\n      ['user', 'assistant'].includes(message.role) &&\n      message.content_type &&\n      ['card', 'image', 'text', 'object_string', 'file'].includes(\n        message.content_type,\n      ) &&\n      message.content\n    ) {\n      // @ts-expect-error -- linter-disable-autofix\n      const sdkMessage: EnterMessage = {\n        role: message.role as RoleType,\n        ...this.convertContent(\n          message.content_type as ContentType,\n          message.content || '',\n          true,\n        ),\n      };\n      return sdkMessage;\n    }\n    return null;\n  }\n  private convertShortcuts(\n    shortcuts: ShortCutCommand[],\n    commandStr:\n      | string\n      | {\n          command_id: string;\n          parameters: Record<string, unknown>;\n        },\n  ) {\n    let command;\n    if (typeof commandStr === 'string') {\n      command = catchParse(commandStr);\n    } else if (typeof commandStr === 'object') {\n      command = commandStr;\n    } else {\n      return commandStr;\n    }\n    const currentShortcut = shortcuts.find(\n      item => item.command_id === command.command_id,\n    );\n\n    if (currentShortcut?.components_list) {\n      const toolParameterMap = new Map(\n        currentShortcut.components_list\n          .filter(c => c.parameter && c.name)\n          .map(c => [c.parameter, c.name]),\n      );\n\n      Object.keys(command.parameters).forEach(key => {\n        const compName = toolParameterMap.get(key);\n        const val = command.parameters[key];\n        if (compName) {\n          delete command.parameters[key];\n          command.parameters[compName] = val;\n        }\n      });\n    }\n\n    return command;\n  }\n}\nexport const messageConverterToSdk = new MessageConverterToSdk();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { getFileInfo, FileTypeEnum } from '@coze-studio/file-kit/logic';\nimport { ContentType } from '@coze-common/chat-core';\nimport {\n  type ChatV3Message,\n  type ContentType as SdkContentType,\n  type ListMessageData,\n} from '@coze/api';\n\nimport { catchParse } from '@/util';\n\ninterface ObjectStringItem {\n  type: 'text' | 'image' | 'file';\n  text?: string;\n  file_id?: string;\n  file_url?: string;\n}\nconst microSeconds = 1000;\n//  Coze\nclass MessageConverseToCoze {\n  public convertMessageListResponse(res: ListMessageData, botId = '') {\n    const {\n      data: messageList = [],\n      has_more: hasMore,\n      first_id: firstId,\n      last_id: lastId,\n    } = res;\n    const messageListForCoze =\n      messageList\n        .map(item => this.convertMessage(item, botId))\n        .filter(item => !!item.message_id) || [];\n    console.log('messageListForCoze', messageListForCoze);\n    return {\n      code: 0,\n      message_list: messageListForCoze,\n      hasmore: hasMore,\n      cursor: lastId,\n      next_cursor: firstId,\n    };\n  }\n  public convertMessage(message: ChatV3Message, botId = '') {\n    const { content_type, content } =\n      this.convertContent(message.content_type, message.content as string) ||\n      {};\n    const isQuestion = message.type === ('question' as ChatV3Message['type']);\n    const replyId = message.chat_id || `--custom-replyId--${nanoid()}`;\n    const messageId = isQuestion\n      ? replyId\n      : message.id || `--custom-messageId-${nanoid()}`; // messageId\n\n    const senderId = isQuestion ? '' : message.bot_id || botId;\n    if (!content_type || !messageId || !replyId) {\n      return {};\n    }\n    let pluginName = '';\n    if (message.type === 'function_call') {\n      const contentObj = catchParse<{ plugin: string }>(\n        message.content as string,\n      );\n      pluginName = contentObj?.plugin || '';\n    }\n\n    return {\n      // @ts-expect-error -- linter-disable-autofix, sdk\n      reasoning_content: message.reasoning_content,\n      content,\n      content_time: (message.created_at || 0) * microSeconds,\n      content_type,\n      message_id: messageId,\n      reply_id: replyId,\n      role: message.role,\n\n      // @ts-expect-error -- linter-disable-autofix, sdk\n      section_id: message.section_id,\n      sender_id: senderId, // todo id\n      source: 0, //...\n      status: '',\n      extra_info: {\n        local_message_id: '',\n        plugin: pluginName,\n        coze_api_message_id: message.id,\n        coze_api_chat_id: message.chat_id,\n      },\n      type: message.type,\n    };\n  }\n  public convertContent(contentType: SdkContentType, content: string) {\n    switch (contentType) {\n      case 'object_string': {\n        return {\n          content_type: ContentType.Mix,\n          content: this.convertMixContent(content),\n        };\n      }\n      case 'card': {\n        return {\n          content_type: ContentType.Card,\n          content,\n        };\n      }\n      case 'text': {\n        return {\n          content_type: ContentType.Text,\n          content,\n        };\n      }\n      default: {\n        return;\n      }\n    }\n  }\n  private convertMixContent(content: string) {\n    const contentObj = catchParse<ObjectStringItem[]>(content);\n    if (!contentObj) {\n      return;\n    }\n    const itemList = contentObj\n      ?.map(item => {\n        switch (item.type) {\n          case 'text': {\n            return {\n              type: ContentType.Text,\n              text: item.text || '',\n              // @ts-expect-error -- linter-disable-autofix\n              is_refer: item.is_refer || undefined,\n            };\n          }\n          case 'image': {\n            return {\n              type: ContentType.Image,\n              image: {\n                key: item?.file_id || '',\n                image_ori: {\n                  height: undefined,\n                  width: undefined,\n                  url: item?.file_url,\n                },\n                image_thumb: {\n                  height: undefined,\n                  width: undefined,\n                  url: item?.file_url,\n                },\n              },\n              // @ts-expect-error -- linter-disable-autofix\n              is_refer: item.is_refer || undefined,\n            };\n          }\n          case 'file': {\n            const { fileType = FileTypeEnum.DEFAULT_UNKNOWN } =\n              // @ts-expect-error -- linter-disable-autofix, sdk\n              getFileInfo(new File([], item?.name)) || {};\n            return {\n              type: ContentType.File,\n              file: {\n                file_key: item.file_id || '',\n\n                // @ts-expect-error -- linter-disable-autofix, sdk\n                file_name: item?.name,\n                // @ts-expect-error -- linter-disable-autofix, sdk\n                file_size: item?.size,\n                file_type: fileType,\n                file_url: item?.file_url,\n              },\n              // @ts-expect-error -- linter-disable-autofix\n              is_refer: item.is_refer || undefined,\n            };\n          }\n          default: {\n            return;\n          }\n        }\n      })\n      .filter(item => !!item);\n    const contentResult = {\n      item_list: itemList.filter(item => !item.is_refer),\n      refer_items: itemList.filter(item => item.is_refer),\n    };\n    return JSON.stringify(contentResult);\n  }\n}\nexport const messageConverterToCoze = new MessageConverseToCoze();\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useMemo } from 'react';\n\nimport { type SceneConfig } from '@coze-common/chat-core';\nimport { type MixInitResponse } from '@coze-common/chat-area';\n\nimport { useChatCozeSdk } from '../context';\nimport { useChatAppProps } from '../../../store';\nimport { messageConverterToCoze } from './message';\n\ntype ChatMessageList = MixInitResponse['messageList'];\nexport const useMessageList = (): SceneConfig => {\n  const getMessageListByPairs = useGetMessageListByPairs();\n  const { chatConfig } = useChatAppProps();\n  const { bot_id: botId } = chatConfig || {};\n  const { refMessageListLeft } = useChatCozeSdk();\n  return useMemo(() => {\n    const onAfterResponse = [\n      response => {\n        const { data } = response;\n        const conversationId = response.config?.params?.conversation_id;\n        const lastMessageList =\n          (refMessageListLeft?.current?.[conversationId] as ChatMessageList) ||\n          [];\n        const lastAnswerChatId =\n          lastMessageList[lastMessageList.length - 1]?.reply_id;\n        if (lastAnswerChatId) {\n          if (\n            data.data?.[0].type === 'question' &&\n            !data.message_list?.[0].chatId\n          ) {\n            data.data[0].chat_id = lastAnswerChatId;\n          }\n        }\n        const dataForCoze = messageConverterToCoze.convertMessageListResponse(\n          data,\n          botId,\n        );\n\n        return {\n          ...response,\n          data: {\n            ...dataForCoze,\n            message_list: getMessageListByPairs(\n              conversationId,\n              dataForCoze.message_list,\n            ),\n          },\n        };\n      },\n    ];\n    return {\n      url: '/v1/conversation/message/list',\n      hooks: {\n        onBeforeRequest: [\n          requestConfig => {\n            const conversationId = requestConfig.data.conversation_id;\n            const data = {\n              after_id: requestConfig.data.cursor,\n              limit: requestConfig.data.count,\n            };\n\n            return {\n              ...requestConfig,\n              data,\n              params: {\n                conversation_id: conversationId,\n              },\n            };\n          },\n        ],\n        onErrorResponse: onAfterResponse,\n        onAfterResponse,\n      },\n    };\n  }, [botId]);\n};\n\n//      \nexport const useGetMessageListByPairs = () => {\n  const { refMessageListLeft } = useChatCozeSdk();\n  return useCallback(\n    (conversationId: string, messageList: ChatMessageList = []) => {\n      const messageListLeft: ChatMessageList = []; // \n      const messageListResponse: ChatMessageList = []; // \n      for (let i = 0; i < messageList.length; i++) {\n        if (messageList[i].type !== 'question') {\n          messageListLeft.push(messageList[i]);\n        } else {\n          messageListResponse.push(...messageListLeft);\n          messageListLeft.splice(0, messageListLeft.length);\n          messageListResponse.push(messageList[i]);\n        }\n      }\n      const lastMessageList =\n        (refMessageListLeft?.current?.[conversationId] as ChatMessageList) ||\n        [];\n      // \n      if (lastMessageList.length) {\n        if (lastMessageList[0]?.reply_id === messageListResponse[0]?.reply_id) {\n          messageListResponse.unshift(...lastMessageList);\n        }\n      }\n\n      // \n      if (refMessageListLeft?.current) {\n        refMessageListLeft.current[conversationId] = messageListLeft;\n      }\n      return messageListResponse;\n    },\n    [],\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { type ShortCutCommand } from '@coze-common/chat-area-plugins-chat-shortcuts';\nimport {\n  type UserSenderInfo,\n  type MixInitResponse,\n} from '@coze-common/chat-area';\nimport i18n from '@coze-arch/i18n/intl';\nimport { type BotInfo, type CozeAPI } from '@coze/api';\n\nimport { type OpenRequestInit, EInputMode } from '@/types/props';\n\nimport { useChatAppProps, useChatAppStore } from '../../store';\nimport { useUserInfo } from '../../hooks';\nimport {\n  convertShortcutData,\n  type ShortcutCommandInOpenApi,\n} from './helper/convert-shortcut-data';\nimport { useChatCozeSdk } from './context';\nimport {\n  messageConverterToCoze,\n  messageConverterToSdk,\n  useGetMessageListByPairs,\n} from './api-adapter';\nconst messageGetLimit = 10;\ninterface GetRequestInfoProps {\n  botId: string;\n  cozeApiSdk: CozeAPI;\n}\n\ntype BotInfoResp = BotInfo & {\n  default_user_input_type?: string;\n  media_config?: {\n    is_voice_call_closed?: boolean;\n  };\n};\nconst getBotOnlineInfo = async ({\n  botId,\n  cozeApiSdk,\n}: GetRequestInfoProps & { connectorId: string }): Promise<\n  Pick<\n    MixInitResponse,\n    | 'prologue'\n    | 'onboardingSuggestions'\n    | 'botVersion'\n    | 'botInfoMap'\n    | 'backgroundInfo'\n  > & {\n    defaultInputMode?: EInputMode;\n    shortcuts?: ShortCutCommand[];\n    isCustomBackground?: boolean;\n    voiceCallClose?: boolean;\n  }\n> => {\n  const botRes = await cozeApiSdk.get<\n    undefined,\n    {\n      code: number;\n      data: BotInfoResp;\n    }\n  >(`/v1/bots/${botId}`, undefined, false, {\n    headers: {\n      'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n    },\n  });\n  const botInfo = botRes?.data;\n  const backgroundInfo: MixInitResponse['backgroundInfo'] =\n    botInfo.background_image_info || {};\n\n  // \n  if (backgroundInfo?.web_background_image?.image_url) {\n    backgroundInfo.web_background_image.origin_image_url =\n      backgroundInfo.web_background_image.origin_image_url ||\n      backgroundInfo.web_background_image.image_url;\n  }\n  if (backgroundInfo?.mobile_background_image?.image_url) {\n    backgroundInfo.mobile_background_image.origin_image_url =\n      backgroundInfo.mobile_background_image.origin_image_url ||\n      backgroundInfo.mobile_background_image.image_url;\n  }\n  return {\n    prologue: botInfo.onboarding_info.prologue,\n    onboardingSuggestions:\n      botInfo.onboarding_info?.suggested_questions?.map((question, index) => ({\n        id: `${index}`,\n        content: question,\n      })) || [],\n    botVersion: botInfo.version,\n    botInfoMap: {\n      [botInfo.bot_id]: {\n        url: botInfo.icon_url,\n        nickname: botInfo.name,\n        id: botInfo.bot_id,\n        allowMention: false,\n      },\n    },\n    backgroundInfo,\n    defaultInputMode:\n      botInfo.default_user_input_type === 'voice'\n        ? EInputMode.Voice\n        : botInfo.default_user_input_type === 'call'\n          ? EInputMode.VoiceCall\n          : EInputMode.Text,\n    shortcuts:\n      convertShortcutData(\n        botInfo.shortcut_commands as unknown as ShortcutCommandInOpenApi[],\n        {\n          id: botId,\n          name: botInfo.name,\n          iconUrl: botInfo.icon_url,\n        },\n      ) || [],\n    voiceCallClose: botInfo.media_config?.is_voice_call_closed ?? true,\n  };\n};\nconst getConversationInfo = async ({\n  botId,\n  cozeApiSdk,\n  conversationId: conversationIdIn,\n  sectionId: sectionIdIn,\n  connectorId,\n  defaultHistoryMessage,\n  onDefaultHistoryClear,\n  userInfo,\n}: GetRequestInfoProps & {\n  conversationId?: string;\n  sectionId?: string;\n  connectorId: string;\n  defaultHistoryMessage?: MixInitResponse['messageList'];\n  onDefaultHistoryClear?: () => void;\n  userInfo: UserSenderInfo | null;\n}): Promise<\n  Pick<\n    MixInitResponse,\n    | 'conversationId'\n    | 'messageList'\n    | 'hasMore'\n    | 'cursor'\n    | 'next_cursor'\n    | 'lastSectionId'\n  >\n> => {\n  let conversationId: string = conversationIdIn || '';\n  let sectionId: string = sectionIdIn || '';\n  if (!conversationId) {\n    const { data: conversationRes } = (await cozeApiSdk.get(\n      '/v1/conversations',\n      {\n        bot_id: botId,\n        connector_id: connectorId,\n        page_num: 1,\n        page_size: 1,\n        user_id: IS_OPEN_SOURCE ? userInfo?.id : undefined,\n      },\n    )) as {\n      data: {\n        conversations: {\n          id: string;\n          last_section_id: string;\n        }[];\n      };\n    };\n    let { id: conversationIdNew, last_section_id: sectionIdNew } =\n      conversationRes?.conversations?.[0] || {};\n    if (!conversationIdNew) {\n      const historyMessage = messageConverterToSdk.convertMessageListResponse(\n        defaultHistoryMessage,\n      );\n\n      try {\n        const { id: conversationIdCreated, last_section_id: sectionIdCreated } =\n          await cozeApiSdk.conversations.create(\n            {\n              bot_id: botId,\n              messages: historyMessage,\n              // @ts-expect-error: connector_id is not in the type\n              connector_id: connectorId,\n              user_id: IS_OPEN_SOURCE ? userInfo?.id : undefined,\n            },\n            {\n              headers: {\n                'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n              },\n            },\n          );\n        conversationIdNew = conversationIdCreated;\n        sectionIdNew = sectionIdCreated || '';\n\n        onDefaultHistoryClear?.();\n      } catch (err) {\n        ///historyMessage \n        const { id: conversationIdCreated, last_section_id: sectionIdCreated } =\n          await cozeApiSdk.conversations.create(\n            {\n              bot_id: botId,\n              // @ts-expect-error: connector_id is not in the type\n              connector_id: connectorId,\n              user_id: IS_OPEN_SOURCE ? userInfo?.id : undefined,\n            },\n            {\n              headers: {\n                'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n              },\n            },\n          );\n        conversationIdNew = conversationIdCreated;\n        sectionIdNew = sectionIdCreated || '';\n      }\n    }\n    conversationId = conversationIdNew;\n    sectionId = sectionIdNew;\n  }\n\n  const resMessage = await cozeApiSdk.conversations.messages.list(\n    conversationId,\n    {\n      limit: messageGetLimit,\n    },\n  );\n  const {\n    message_list: messageList,\n    hasmore: hasMore,\n    cursor,\n    next_cursor: nextCursor,\n  } = messageConverterToCoze.convertMessageListResponse(resMessage, botId);\n\n  return {\n    lastSectionId: sectionId,\n    conversationId,\n    messageList,\n    hasMore,\n    cursor,\n    next_cursor: nextCursor,\n  };\n};\nconst getCustomInitInfo = async ({\n  cozeApiSdk,\n  openRequestInit,\n}: {\n  cozeApiSdk: CozeAPI;\n  openRequestInit?:\n    | OpenRequestInit\n    | {\n        (cozeApi?: CozeAPI): Promise<OpenRequestInit> | OpenRequestInit;\n      };\n}) => {\n  let result: OpenRequestInit;\n  if (openRequestInit) {\n    if (typeof openRequestInit === 'function') {\n      result = await openRequestInit(cozeApiSdk);\n    } else {\n      result = openRequestInit;\n    }\n    if (result.isBuilderChat) {\n      return {\n        botOnlineInfo: {\n          prologue: result.prologue,\n          onboardingSuggestions: result.onboardingSuggestions,\n          botInfoMap: {\n            [result.botInfo.id]: result.botInfo,\n          },\n          backgroundInfo: result.backgroundInfo,\n          defaultInputMode: result.defaultInputMode,\n          shortcuts: [],\n          isCustomBackground: result.isCustomBackground,\n        },\n        conversationId: result.conversationId,\n        sectionId: result.sectionId,\n      };\n    }\n    return {\n      conversationId: result.conversationId,\n      sectionId: result.sectionId,\n    };\n  }\n  return null;\n};\n\nexport const useRequestInit = () => {\n  const {\n    chatConfig,\n    openRequestInit,\n    defaultHistoryMessage = [],\n    onDefaultHistoryClear,\n  } = useChatAppProps();\n\n  const { cozeApiSdk } = useChatCozeSdk();\n  const setInitError = useChatAppStore(s => s.setInitError);\n  const setDefaultInputMode = useChatAppStore(s => s.setDefaultInputMode);\n  const updateShortcuts = useChatAppStore(s => s.updateShortcuts);\n  const setIsStartBotVoiceCall = useChatAppStore(s => s.setIsStartBotVoiceCall);\n  const updateBackgroundInfo = useChatAppStore(s => s.updateBackgroundInfo);\n\n  const getMessageListByPairs = useGetMessageListByPairs();\n\n  const connectorId = chatConfig?.auth?.connectorId || '';\n  const { bot_id: botId = '' } = chatConfig;\n  const userInfo = useUserInfo();\n  const requestToInit = useCallback<\n    () => Promise<MixInitResponse>\n    // @ts-expect-error -- linter-disable-autofix\n  >(async () => {\n    if (!cozeApiSdk) {\n      return {};\n    }\n    try {\n      const { conversationId, sectionId, botOnlineInfo } =\n        (await getCustomInitInfo({\n          cozeApiSdk,\n          openRequestInit,\n        })) || {};\n\n      const [requestDataBotInfo, requestDataConversationInfo] =\n        await Promise.all([\n          botOnlineInfo || getBotOnlineInfo({ botId, cozeApiSdk, connectorId }),\n          getConversationInfo({\n            botId,\n            cozeApiSdk,\n            conversationId,\n            sectionId,\n            connectorId,\n            onDefaultHistoryClear,\n            defaultHistoryMessage,\n            userInfo,\n          }),\n        ]);\n      const prologue = (requestDataBotInfo.prologue || '').replaceAll(\n        '{{user_name}}',\n        userInfo?.nickname || '',\n      );\n      setIsStartBotVoiceCall(\n        requestDataBotInfo.defaultInputMode === EInputMode.VoiceCall,\n      );\n      setDefaultInputMode(\n        requestDataBotInfo.defaultInputMode || EInputMode.Text,\n      );\n      updateShortcuts(requestDataBotInfo.shortcuts || []);\n      console.log(\n        'requestDataBotInfo.shortcuts:',\n        requestDataBotInfo.shortcuts,\n      );\n\n      updateBackgroundInfo(requestDataBotInfo.backgroundInfo);\n      if (requestDataBotInfo.isCustomBackground) {\n        requestDataBotInfo.backgroundInfo = undefined;\n      }\n      console.log('[result]2:', requestDataBotInfo);\n      return {\n        ...requestDataBotInfo,\n        ...requestDataConversationInfo,\n        prologue,\n        messageList: getMessageListByPairs(\n          requestDataConversationInfo.conversationId || '',\n          requestDataConversationInfo.messageList,\n        ),\n        userInfoMap: userInfo?.id\n          ? {\n              [userInfo?.id]: userInfo,\n            }\n          : undefined,\n      };\n    } catch (e) {\n      console.error('useRequestInit error', e);\n      const { code } = (e as { code: number; message: string }) || {};\n      if (code) {\n        setInitError({ code, msg: '' });\n      } else {\n        setInitError({ code: -1, msg: '' });\n      }\n    }\n  }, [botId, cozeApiSdk, defaultHistoryMessage, onDefaultHistoryClear]);\n  return requestToInit;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type SceneConfig } from '@coze-common/chat-core';\n\nexport const useClearMessageContextAdapter = (): SceneConfig =>\n  useMemo(() => {\n    const onAfterResponse = [\n      response => {\n        const { data } = response;\n        const { code, data: res } = data;\n        return {\n          ...response,\n          data: {\n            code,\n            new_section_id: res.id,\n          },\n        };\n      },\n    ];\n    return {\n      url: '/v1/conversations/:conversation_id/clear',\n      hooks: {\n        onBeforeRequest: [\n          requestConfig => {\n            const conversationId = requestConfig.data.conversation_id;\n            const url = `/v1/conversations/${conversationId}/clear`;\n            return {\n              ...requestConfig,\n              url,\n              data: { conversation_id: conversationId },\n            };\n          },\n        ],\n        onErrorResponse: onAfterResponse,\n        onAfterResponse,\n      },\n    };\n  }, []);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport {\n  ContentType,\n  type RequestManagerOptions,\n  type ParsedEvent,\n} from '@coze-common/chat-core';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport { safeJSONParse } from '@coze-arch/bot-utils';\nimport { type CreateChatData, type ChatV3Message } from '@coze/api';\n\nimport { catchParse } from '@/util';\nimport { type OpenUserInfo } from '@/types/user';\n\nimport { messageConverterToCoze } from './message-convert-to-coze';\n\ntype MessageParserFunc = ReturnType<\n  Required<Required<RequestManagerOptions>['hooks']>['onGetMessageStreamParser']\n>;\n// coze\nenum ChunkEvent {\n  ERROR = 'error',\n  DONE = 'done',\n  MESSAGE_DELTA = 'conversation.message.delta',\n  MESSAGE_COMPLETED = 'conversation.message.completed',\n  // \n  CHAT_COMPLETED = 'conversation.chat.completed',\n  CHAT_CREATED = 'conversation.chat.created',\n  CHAT_FAILED = 'conversation.chat.failed',\n}\n\nexport class MessageParser {\n  private seqNo = 0; //\n  private indexNo = 0; //\n  private indexNoMap: Record<string, number> = {};\n  private conversationId = '';\n  private localMessageId = '';\n  private sendMessageContent = '';\n  private sendMessageContentType = '';\n  private botId = '';\n  private sectionId = '';\n  private botVersion = '';\n  private userInfo?: OpenUserInfo;\n  constructor({\n    requestMessageRawBody,\n    userInfo,\n    sectionId,\n  }: {\n    requestMessageRawBody: Record<string, unknown>;\n    userInfo?: OpenUserInfo;\n    sectionId?: string;\n  }) {\n    this.conversationId = requestMessageRawBody.conversation_id as string;\n    this.localMessageId = requestMessageRawBody.local_message_id as string;\n    this.sendMessageContent = requestMessageRawBody.query as string;\n    this.sendMessageContentType = requestMessageRawBody.content_type as string;\n    this.botId = requestMessageRawBody.bot_id as string;\n    this.botVersion = requestMessageRawBody.bot_version as string;\n    this.userInfo = userInfo;\n    this.sectionId = sectionId || '';\n  }\n  public parse(\n    parseEvent: Partial<ParsedEvent>,\n    { terminate }: { terminate: () => void },\n  ): ParsedEvent | undefined {\n    const { data, event } = parseEvent;\n    switch (event) {\n      case ChunkEvent.CHAT_CREATED: {\n        return this.createAckMessage(data as string) as unknown as ParsedEvent;\n      }\n      case ChunkEvent.MESSAGE_DELTA: {\n        const message = this.createMessage(data as string);\n        if (!message) {\n          return;\n        }\n        return message as unknown as ParsedEvent;\n      }\n      case ChunkEvent.MESSAGE_COMPLETED: {\n        return this.createMessage(\n          data as string,\n          true,\n        ) as unknown as ParsedEvent;\n      }\n      case ChunkEvent.CHAT_COMPLETED:\n      case ChunkEvent.DONE: {\n        terminate();\n        return;\n      }\n      // token \n      case ChunkEvent.CHAT_FAILED: {\n        const messageError = safeJSONParse(data) as CreateChatData;\n        const errorMsg = messageError.last_error?.msg || I18n.t('sendFailed');\n\n        Toast.error(errorMsg);\n        throw new Error('Chat stream error');\n      }\n      case ChunkEvent.ERROR: {\n        const messageError = safeJSONParse(data) as {\n          code: number;\n          msg: string;\n        };\n        const errorMsg = messageError?.msg || I18n.t('sendFailed');\n        Toast.error(errorMsg);\n        throw new Error('Chat stream error');\n      }\n      default:\n        return;\n    }\n  }\n\n  private createMessage(data: string, isComplete = false) {\n    const dataValue = catchParse<ChatV3Message>(data);\n    if (!dataValue) {\n      return;\n    }\n    const messageType = dataValue?.type || '';\n    dataValue.chat_id =\n      !dataValue.chat_id || dataValue.chat_id === '0' ? '' : dataValue.chat_id;\n    dataValue.id = !dataValue.id || dataValue.id === '0' ? '' : dataValue.id;\n\n    const message = messageConverterToCoze.convertMessage(\n      dataValue,\n      this.botId,\n    );\n    if (!message) {\n      return;\n    }\n    if (\n      isComplete &&\n      message.content_type === ContentType.Text &&\n      message.type === 'answer'\n    ) {\n      message.content = '';\n    }\n    message.section_id = message.section_id || this.sectionId;\n    return {\n      event: 'message',\n      data: {\n        conversation_id: this.conversationId,\n        index: this.getIndexNo(messageType),\n        is_finish: isComplete,\n        seq_id: this.getSeqNo(),\n        message: { ...message, sender: this.botId },\n      },\n    };\n  }\n  private createAckMessage(data: string) {\n    const messageType = 'ack';\n    const dataValue = catchParse<CreateChatData & { execute_id?: string }>(\n      data,\n    );\n    if (!dataValue) {\n      return;\n    }\n    const chatId = dataValue?.id === '0' || !dataValue?.id ? '' : dataValue?.id;\n    const replyId = chatId || `--custom-replyId--${nanoid()}`;\n    // @ts-expect-error -- linter-disable-autofix, sdk\n    const messageId = dataValue.inserted_additional_messages?.lastItem?.id;\n\n    return {\n      event: 'message',\n      data: {\n        conversation_id: this.conversationId,\n        index: this.getIndexNo(messageType),\n        is_finish: true,\n        message: {\n          content: this.sendMessageContent,\n          content_time: (dataValue?.created_at || 0) * 1000,\n          content_type: this.sendMessageContentType,\n          extra_info: {\n            local_message_id: this.localMessageId,\n            chatflow_execute_id: dataValue?.execute_id,\n            coze_api_message_id: messageId,\n            coze_api_chat_id: chatId,\n          },\n          message_id: replyId,\n          reply_id: replyId,\n          role: 'user',\n          // @ts-expect-error -- linter-disable-autofix, sdk\n          section_id: dataValue?.section_id || this.sectionId, //todo \n          sender_id: this.userInfo?.id,\n          source: 0, //...\n          status: '',\n          type: messageType,\n        },\n        seq_id: this.getSeqNo(),\n      },\n    };\n  }\n\n  private getSeqNo() {\n    return this.seqNo++;\n  }\n  private getIndexNo(messageType: string) {\n    if (!this.indexNoMap[messageType]) {\n      this.indexNoMap[messageType] = this.indexNo++;\n    }\n    return this.indexNoMap[messageType];\n  }\n\n  static getMessageParser({\n    requestMessageRawBody,\n    userInfo,\n    sectionId,\n  }: {\n    requestMessageRawBody: Record<string, unknown>;\n    userInfo?: OpenUserInfo;\n    sectionId?: string;\n  }): MessageParserFunc {\n    let parser: MessageParser | undefined = new MessageParser({\n      requestMessageRawBody,\n      userInfo,\n      sectionId,\n    });\n    const destroy = () => {\n      parser = undefined;\n    };\n    return (parseEvent, method) => {\n      const { terminate } = method;\n      const { type, event } = parseEvent as ParsedEvent & { type: string };\n      if (type === 'event') {\n        //\n        const result = parser?.parse(parseEvent as ParsedEvent, { terminate });\n        if (\n          [ChunkEvent.DONE, ChunkEvent.ERROR, ChunkEvent.CHAT_FAILED].includes(\n            event as ChunkEvent,\n          )\n        ) {\n          destroy();\n        }\n        return result;\n      }\n    };\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { type SceneConfig } from '@coze-common/chat-core';\nimport { type UserSenderInfo } from '@coze-common/chat-area';\nimport i18n from '@coze-arch/i18n/intl';\n\nimport { openApiHostByRegionWithToken } from '@/util/env';\nimport { catchParse } from '@/util';\nimport {\n  useChatAppProps,\n  useChatAppStore,\n} from '@/components/studio-open-chat/store';\n\nimport { type ChatProviderFunc } from '../type';\nimport { messageConverterToSdk, MessageParser } from './message';\n\nexport const useSendMessageAdapter = (\n  userInfo?: UserSenderInfo,\n  refChatFunc?: React.MutableRefObject<ChatProviderFunc | undefined>,\n): SceneConfig => {\n  const { debug, chatConfig } = useChatAppProps();\n  const { shortcuts } = useChatAppStore(\n    useShallow(state => ({\n      shortcuts: state.shortcuts,\n    })),\n  );\n\n  const refChatConfig = useRef(chatConfig);\n  const refConnectorId = useRef('');\n  const shortcutsRef = useRef(shortcuts);\n  shortcutsRef.current = shortcuts;\n  refConnectorId.current = chatConfig?.auth?.connectorId || '';\n  refChatConfig.current = chatConfig;\n  return {\n    url: '/v3/chat',\n    hooks: {\n      onBeforeSendMessage: [\n        requestConfig => {\n          const messageBody: Record<string, string> =\n            catchParse(requestConfig.body) || {};\n          const url = `${openApiHostByRegionWithToken}/v3/chat?conversation_id=${messageBody.conversation_id}`;\n          const body = messageConverterToSdk.convertRequestBody({\n            body: requestConfig.body,\n            userInfo,\n            connectorId: refConnectorId.current,\n            parameters: refChatConfig.current.botInfo?.parameters,\n            shortcuts: shortcutsRef.current,\n          });\n          Object.keys(debug?.cozeApiRequestHeader || {}).forEach(key => {\n            requestConfig.headers.push([\n              key,\n              debug?.cozeApiRequestHeader?.[key] || '',\n            ]);\n          });\n          requestConfig.headers.push([\n            'Accept-Language',\n            i18n.language === 'zh-CN' ? 'zh' : 'en',\n          ]);\n          return { ...requestConfig, body, url };\n        },\n      ],\n      onGetMessageStreamParser: requestMessageRawBody =>\n        MessageParser.getMessageParser({\n          requestMessageRawBody,\n          userInfo,\n          sectionId: refChatFunc?.current?.getSectionId(),\n        }),\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useRef } from 'react';\n\nimport { type SceneConfig } from '@coze-common/chat-core';\n\nimport { OpenApiSource } from '@/types/open';\nimport { useChatAppProps } from '@/components/studio-open-chat/store';\nimport { useUserInfo } from '@/components/studio-open-chat/hooks';\n\nimport { type ChatProviderFunc } from '../type';\nexport const useClearHistoryAdapter = ({\n  refChatFunc,\n}: {\n  refChatFunc?: React.MutableRefObject<ChatProviderFunc | undefined>;\n}): SceneConfig => {\n  const { chatConfig } = useChatAppProps();\n  const refConnectorId = useRef('');\n  const userInfo = useUserInfo();\n  refConnectorId.current = chatConfig?.auth?.connectorId || '';\n\n  return useMemo(() => {\n    const onAfterResponse = [\n      response => {\n        const { data: resCreateConversation } = response;\n        const { code, data: conversationData } = resCreateConversation;\n        const { id: conversationId, last_section_id: sectionId } =\n          conversationData || {};\n        refChatFunc?.current?.setConversationId(conversationId, sectionId);\n        return {\n          ...response,\n          data: {\n            code,\n            new_section_id: sectionId,\n          },\n        };\n      },\n    ];\n    const config = {\n      url:\n        IS_OPEN_SOURCE && chatConfig.source === OpenApiSource.ChatFlow\n          ? '/v1/workflow/conversation/create'\n          : '/v1/conversation/create',\n      method: 'POST',\n      hooks: {\n        onBeforeRequest: [\n          requestConfig => {\n            const botId = requestConfig.data.bot_id;\n            return {\n              ...requestConfig,\n              data: {\n                bot_id: botId,\n                connector_id: refConnectorId.current,\n                user_id: IS_OPEN_SOURCE ? userInfo?.id : undefined,\n              },\n            };\n          },\n        ],\n        onErrorResponse: onAfterResponse,\n        onAfterResponse,\n      },\n    };\n    return config;\n  }, []);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport axios from 'axios';\nimport { type RequestManagerOptions } from '@coze-common/chat-core';\n\nimport { isAuthError } from '@/util/error';\nimport { useChatAppProps } from '@/components/studio-open-chat/store';\n\nexport const useCommonOnBeforeRequestHooks =\n  (): Required<RequestManagerOptions>['hooks']['onBeforeRequest'] => {\n    const { debug } = useChatAppProps();\n    return [\n      // \n      requestConfig => {\n        requestConfig.headers.delete('x-requested-with');\n        Object.keys(debug?.cozeApiRequestHeader || {}).forEach(key => {\n          requestConfig.headers.set(\n            key,\n            debug?.cozeApiRequestHeader?.[key] || '',\n          );\n        });\n        return requestConfig;\n      },\n    ];\n  };\nconst handleCommonError = async (\n  response,\n  refreshToken?: () => Promise<string>,\n) => {\n  const { code } = response?.response?.data || {};\n  let responseOut = response;\n  if (isAuthError(code)) {\n    const token = await refreshToken?.();\n    if (token) {\n      const config = { ...response.config };\n      config.headers = { ...config.headers };\n      config.headers.Authorization = `Bearer ${token}`;\n      responseOut = await axios.request(config);\n    }\n  }\n\n  return responseOut;\n};\n\nexport const useCommonErrorResponseHooks = (\n  refreshToken?: () => Promise<string>,\n): Required<RequestManagerOptions>['hooks']['onErrorResponse'] =>\n  useMemo(\n    () => [async response => handleCommonError(response, refreshToken)],\n    [refreshToken],\n  );\nexport const useCommonOnAfterResponseHooks = (\n  refreshToken?: () => Promise<string>,\n): Required<RequestManagerOptions>['hooks']['onAfterResponse'] =>\n  useMemo(\n    () => [\n      // \n      async response => handleCommonError(response, refreshToken),\n      // Url\n      response => {\n        if (\n          response.config.url &&\n          /^\\/v1\\/conversations\\/[^\\\\]+\\/clear$/.test(response.config.url)\n        ) {\n          return {\n            ...response,\n            config: {\n              ...response.config,\n              url: '/v1/conversations/:conversation_id/clear',\n            },\n          };\n        }\n        return response;\n      },\n    ],\n    [refreshToken],\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type SceneConfig } from '@coze-common/chat-core';\n\nexport const useBreakMessage = (): SceneConfig =>\n  useMemo(() => {\n    const config = {\n      url: '/v3/chat/cancel',\n      method: 'POST',\n      hooks: {\n        onBeforeRequest: [\n          requestConfig => {\n            const conversationId = requestConfig.data.conversation_id;\n            const chatId = requestConfig.data.query_message_id;\n            return {\n              ...requestConfig,\n              data: { conversation_id: conversationId, chat_id: chatId },\n            };\n          },\n        ],\n      },\n    };\n    return config;\n  }, []);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { mergeWith, isArray } from 'lodash-es';\nimport {\n  RequestScene,\n  type RequestManagerOptions,\n} from '@coze-common/chat-core';\n\nimport { openApiHostByRegionWithToken } from '@/util/env';\n\nimport { useChatAppProps } from '../../store';\nimport { useUserInfo } from '../../hooks';\nimport { type ChatProviderFunc } from './type';\nimport { useChatCozeSdk } from './context';\nimport {\n  useClearMessageContextAdapter,\n  useSendMessageAdapter,\n  useClearHistoryAdapter,\n  useCommonOnAfterResponseHooks,\n  useCommonOnBeforeRequestHooks,\n  useCommonErrorResponseHooks,\n  useMessageList,\n  useBreakMessage,\n} from './api-adapter';\n\nexport const useCoreManager = ({\n  refChatFunc,\n}: {\n  refChatFunc?: React.MutableRefObject<ChatProviderFunc | undefined>;\n}): RequestManagerOptions => {\n  const userInfo = useUserInfo();\n  const { refreshToken } = useChatCozeSdk();\n  const clearMessageContextAdapter = useClearMessageContextAdapter();\n  const sendMessageAdapter = useSendMessageAdapter(\n    userInfo || undefined,\n    refChatFunc,\n  );\n  const clearHistoryAdapter = useClearHistoryAdapter({ refChatFunc });\n  const commonOnBeforeRequestHooks = useCommonOnBeforeRequestHooks();\n  const commonOnAfterResponseHooks =\n    useCommonOnAfterResponseHooks(refreshToken);\n  const commonErrorResponseHooks = useCommonErrorResponseHooks(refreshToken);\n  const messageListAdapter = useMessageList();\n  const { requestManagerOptions } = useChatAppProps();\n  const breakMessageAdapter = useBreakMessage();\n  return useMemo(\n    () =>\n      mergeWith(\n        {\n          baseURL: openApiHostByRegionWithToken,\n          scenes: {\n            [RequestScene.SendMessage]: sendMessageAdapter,\n            [RequestScene.ClearMessageContext]: clearMessageContextAdapter,\n            [RequestScene.ClearHistory]: clearHistoryAdapter,\n            [RequestScene.GetMessage]: messageListAdapter,\n            [RequestScene.BreakMessage]: breakMessageAdapter,\n          },\n          hooks: {\n            onBeforeRequest: commonOnBeforeRequestHooks,\n            onAfterResponse: commonOnAfterResponseHooks,\n            onErrorResponse: commonErrorResponseHooks,\n          },\n        },\n        requestManagerOptions,\n        (objValue, srcValue) => {\n          if (isArray(objValue)) {\n            return objValue.concat(srcValue);\n          }\n        },\n      ),\n    [\n      sendMessageAdapter,\n      clearMessageContextAdapter,\n      clearHistoryAdapter,\n      commonOnBeforeRequestHooks,\n      commonOnAfterResponseHooks,\n    ],\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type CreateChatCoreOverrideConfig } from '@coze-common/chat-area';\n\nimport { useChatAppProps } from '../../store';\nimport { useCoreManager } from './use-core-manager';\nimport { type ChatProviderFunc } from './type';\nimport { useChatCozeSdk } from './context';\n\nexport const useCoreOverrideConfig = ({\n  refChatFunc,\n}: {\n  refChatFunc?: React.MutableRefObject<ChatProviderFunc | undefined>;\n}) => {\n  const { chatConfig } = useChatAppProps();\n  const { tokenManager } = useChatCozeSdk();\n  const requestManagerOptions = useCoreManager({ refChatFunc });\n  return useMemo(() => {\n    const config: CreateChatCoreOverrideConfig = {\n      env: 'thirdPart',\n      biz: 'third_part',\n      deployVersion: 'inhouse',\n      requestManagerOptions,\n      tokenManager,\n    };\n\n    return config;\n  }, [chatConfig]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableRenderLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const renderLifeCycleServiceGenerator: WriteableRenderLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ChatCoreError } from '@coze-common/chat-core';\nimport { type WriteableMessageLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { isAuthError } from '@/util/error';\n\nimport { type PluginBizContext } from '../../types/biz-context';\nexport const messageLifeCycleServiceGenerator: WriteableMessageLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => {\n  let lastRetryId = '';\n  return {\n    onSendMessageError: async ctx => {\n      const error = ctx.error as ChatCoreError;\n\n      if (isAuthError(error?.ext?.code || 0) || error?.stack?.includes('401')) {\n        await plugin.pluginBizContext?.refreshToken?.();\n        const newRetryId =\n          ctx.message.message_id || ctx.message?.extra_info?.local_message_id;\n        if (newRetryId !== lastRetryId) {\n          lastRetryId = newRetryId;\n          plugin.pluginBizContext?.regenerateMessageByUserMessageId(newRetryId);\n        }\n      }\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableCommandLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const commandLifeCycleServiceGenerator: WriteableCommandLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableAppLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const appLifeCycleServiceGenerator: WriteableAppLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\nimport { renderLifeCycleServiceGenerator } from './render';\nimport { messageLifeCycleServiceGenerator } from './message';\nimport { commandLifeCycleServiceGenerator } from './command';\nimport { appLifeCycleServiceGenerator } from './app';\n\nexport const bizLifeCycleServiceGenerator: WriteableLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  appLifeCycleService: appLifeCycleServiceGenerator(plugin),\n  messageLifeCycleService: messageLifeCycleServiceGenerator(plugin),\n  commandLifeCycleService: commandLifeCycleServiceGenerator(plugin),\n  renderLifeCycleService: renderLifeCycleServiceGenerator(plugin),\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport {\n  type MessageGroup,\n  useChatAreaStoreSet,\n} from '@coze-common/chat-area';\n\nimport { useChatAppStore } from '@/components/studio-open-chat/store';\nexport const useMessageGroupFooterInfo = (messageGroup: MessageGroup) => {\n  const feedbackInfo = useChatAppStore(s => s.feedbackInfo);\n  const { useMessagesStore } = useChatAreaStoreSet();\n  const { findMessage } = useMessagesStore.getState();\n\n  const lastGroupFeedbackInfo = useChatAppStore(s => s.lastGroupFeedbackInfo);\n  const { messageId } = lastGroupFeedbackInfo;\n  const messageInfo = findMessage(messageId || '');\n  // @ts-expect-error -- linter-disable-autofix, \n  const cozeApiMessageId = messageInfo?.extra_info?.coze_api_message_id;\n\n  const isShowFeedbackInLastGroup = useMemo(() => {\n    if (\n      lastGroupFeedbackInfo.isShowCustomPanel &&\n      messageId &&\n      feedbackInfo[cozeApiMessageId] === 'thumbDown'\n    ) {\n      // message\n\n      return messageGroup.memberSet.llmAnswerMessageIdList.includes(messageId);\n    }\n    return false;\n  }, [feedbackInfo, lastGroupFeedbackInfo, messageGroup]);\n  return { isShowFeedbackInLastGroup, cozeApiMessageId };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type CustomComponent } from '@coze-common/chat-area';\n\nimport { useMessageGroupFooterInfo } from './use-message-group-footer-info';\nexport const UIKitMessageGroupFooterPlugin: CustomComponent['MessageGroupFooter'] =\n  ({ messageGroup }) => {\n    const { isLatest } = messageGroup;\n    const { isShowFeedbackInLastGroup, cozeApiMessageId } =\n      useMessageGroupFooterInfo(messageGroup);\n\n    if (!isLatest || !isShowFeedbackInLastGroup || !cozeApiMessageId) {\n      return null;\n    }\n    return <div className=\"ml-[24px] mr-[24px]\"></div>;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMessageBoxContext } from '@coze-common/chat-area';\n\nimport { useChatAppProps } from '@/components/studio-open-chat/store';\n\nexport const useCurMessageInfo = () => {\n  const { message } = useMessageBoxContext();\n  const { chatConfig } = useChatAppProps();\n\n  // @ts-expect-error -- linter-disable-autofix, \n  const cozeApiMessageId = message.extra_info.coze_api_message_id;\n  // @ts-expect-error -- linter-disable-autofix, \n  const cozeApiChatId = message.extra_info.coze_api_chatId_id;\n  return {\n    messageId: message.message_id,\n    cozeApiMessageId,\n    cozeApiChatId,\n    isShowDelete: false, // \n    isNeedQuote: chatConfig.ui?.chatBot?.isNeedQuote ?? false,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useChatActionLockService } from '@coze-common/chat-area/context/chat-action-lock';\nimport { useChatAreaStoreSet } from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { useChatCozeSdk } from '../../context';\n\nexport const useDeleteMessage = () => {\n  const storeSet = useChatAreaStoreSet();\n  const chatActionLockService = useChatActionLockService();\n  const { cozeApiSdk } = useChatCozeSdk();\n\n  return async (conversationId: string, messageId: string) => {\n    if (!messageId || !conversationId) {\n      return;\n    }\n\n    const { useMessagesStore, useSuggestionsStore } = storeSet;\n    const { findMessage, isLastMessageGroup } = useMessagesStore.getState();\n    const { clearSuggestions } = useSuggestionsStore.getState();\n\n    const messageInfo = findMessage(messageId);\n    const groupId = messageInfo?.reply_id;\n    // @ts-expect-error -- linter-disable-autofix, \n    const cozeApiMessageId = messageInfo?.extra_info?.coze_api_message_id;\n    if (!messageInfo || !groupId) {\n      throw new Error(`message not found, id: ${messageId}`);\n    }\n\n    if (\n      chatActionLockService.answerAction.getIsLock(\n        groupId,\n        'deleteMessageGroup',\n      )\n    ) {\n      return;\n    }\n\n    chatActionLockService.answerAction.lock(groupId, 'deleteMessageGroup');\n\n    const isLast = isLastMessageGroup(groupId);\n\n    const { deleteMessageById } = useMessagesStore.getState();\n\n    try {\n      await cozeApiSdk?.conversations.messages.delete(\n        conversationId,\n        cozeApiMessageId,\n      );\n      deleteMessageById(messageId);\n      if (isLast) {\n        clearSuggestions();\n      }\n    } catch (e) {\n      console.error(e);\n      Toast.error(I18n.t('Delete_failed'));\n    } finally {\n      chatActionLockService.answerAction.unlock(groupId, 'deleteMessageGroup');\n    }\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps, type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useChatAreaStoreSet,\n  useIsDeleteMessageLock,\n  useMessageBoxContext,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozTrashCan } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { Layout } from '@/types/client';\nimport { useChatAppProps } from '@/components/studio-open-chat/store';\n\nimport { useDeleteMessage } from '../../hooks/use-delete-message';\nimport { useCurMessageInfo } from '../../hooks/use-cur-message-info';\n\ntype DeleteMessageProps = Omit<\n  ComponentProps<typeof IconButton>,\n  'icon' | 'iconSize' | 'onClick'\n>;\n\nexport const DeleteMessage: React.FC<PropsWithChildren<DeleteMessageProps>> = ({\n  className,\n  ...props\n}) => {\n  const storeSet = useChatAreaStoreSet();\n  const { useGlobalInitStore } = storeSet;\n  const { groupId } = useMessageBoxContext();\n  const isDeleteMessageLock = useIsDeleteMessageLock(groupId);\n  const { chatConfig } = useChatAppProps();\n  const deleteMessage = useDeleteMessage();\n  const conversationId = useGlobalInitStore(state => state.conversationId);\n  const { messageId, cozeApiMessageId, isShowDelete } = useCurMessageInfo();\n  const trigger =\n    chatConfig.ui?.base?.layout === Layout.MOBILE ? 'custom' : 'hover';\n\n  if (!cozeApiMessageId || !isShowDelete || !messageId) {\n    // cozeApiMessageId openApi\n    return null;\n  }\n\n  return (\n    <Tooltip trigger={trigger} content={I18n.t('Delete')}>\n      <IconButton\n        data-testid=\"chat-area.answer-action.delete-message-button\"\n        disabled={isDeleteMessageLock}\n        size=\"small\"\n        icon={\n          <IconCozTrashCan\n            className={classNames(\n              'coz-fg-hglt-red',\n              className,\n              'w-[14px] h-[14px]',\n            )}\n          />\n        }\n        onClick={() => {\n          //  groupId \n\n          deleteMessage(conversationId || '', messageId);\n        }}\n        color=\"secondary\"\n        {...props}\n      />\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MixMessageContent } from '@coze-common/chat-core/message/types';\nimport {\n  useMessageBoxContext,\n  getIsTextMessage,\n  ContentType,\n} from '@coze-common/chat-area';\n\nimport { catchParse } from '@/util';\n\nexport const useMessageHoverInfo = () => {\n  const { meta, message } = useMessageBoxContext();\n  const isNeedHoverAnswer =\n    message.type === 'answer' &&\n    (!meta.isFromLatestGroup || !meta.isGroupLastAnswerMessage);\n\n  let showHoverText: string | undefined;\n  let isMultiMessage = false;\n  if (message.type === 'question' || message.type === 'ack') {\n    // question mixtext\n    if (getIsTextMessage(message)) {\n      showHoverText = message.content;\n    } else if (message?.content_type === ContentType.Mix) {\n      const contentObj = catchParse<MixMessageContent>(message.content);\n      showHoverText = contentObj?.item_list\n        .map(item => (item.type === 'text' && item.text) || '')\n        .filter(item => !!item)\n        .join('\\n');\n\n      isMultiMessage = (contentObj?.item_list?.length || 0) > 1;\n    }\n  } else if (isNeedHoverAnswer) {\n    if (getIsTextMessage(message)) {\n      showHoverText = message.content;\n    }\n  }\n  return {\n    showHoverText,\n    isMultiMessage,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useRef } from 'react';\n\nimport cls from 'classnames';\nimport { useSize } from 'ahooks';\nimport { useMessageBoxContext } from '@coze-common/chat-area';\nimport {\n  ActionBarHoverContainer,\n  CopyTextMessage,\n  QuoteMessage,\n} from '@coze-common/chat-answer-action';\n\nimport { useChatAppProps } from '@/components/studio-open-chat/store';\n\nimport { useCurMessageInfo } from '../../hooks/use-cur-message-info';\nimport { DeleteMessage } from '../../components/delete-message';\nimport { useMessageHoverInfo } from './use-message-hover-info';\n\n// messagemessage groupanswerhoveranswer actions\nexport const UIKitMessageBoxHoverSlot: React.FC = () => {\n  const { meta } = useMessageBoxContext();\n  const { message } = useMessageBoxContext();\n  const { readonly } = useChatAppProps();\n\n  const isLastGroupMessage =\n    meta.isGroupLastMessage &&\n    meta.isFromLatestGroup &&\n    message?.type === 'answer';\n\n  if (isLastGroupMessage || readonly) {\n    /*\n     * footer\n     *  message\n     *  message\n     *  message\n     */\n    return null;\n  }\n  return <UIKitMessageBoxHoverSlotContent />;\n};\n\nconst UIKitMessageBoxHoverSlotContent = () => {\n  const popoverContainerRef = useRef<HTMLDivElement>(null);\n  const actionBarRef = useRef<HTMLDivElement>(null);\n  const { message } = useMessageBoxContext();\n  const { showHoverText, isMultiMessage } = useMessageHoverInfo();\n  const { isShowDelete, isNeedQuote } = useCurMessageInfo();\n  const isShowHoverContainer = isShowDelete || !!showHoverText;\n\n  const isShowQuote =\n    message.type === 'answer' && !!showHoverText && isNeedQuote;\n  const { width: actionBarSize } = useSize(actionBarRef) || {};\n  const actionBarLeft = useMemo(() => {\n    let containerSize = actionBarRef.current?.closest(\n      '.coze-chat-hover-message-wrapper',\n    )?.clientWidth;\n\n    if (containerSize && isMultiMessage) {\n      containerSize += 44;\n      return actionBarSize && containerSize && actionBarSize > containerSize\n        ? actionBarSize - containerSize\n        : 0;\n    }\n    return 0;\n  }, [actionBarSize]);\n  if (!isShowHoverContainer) {\n    return null;\n  }\n\n  console.log('actionBarSize:', {\n    actionBarSize,\n    actionBarLeft,\n  });\n  const wrapperClass = 'flex justify-center items-center';\n  // messagemessage group hoveranswer actions\n  return (\n    <>\n      <div\n        className={cls(\n          'w-full flex',\n          isMultiMessage ? 'justify-start' : 'justify-end',\n        )}\n        style={{}}\n      >\n        <ActionBarHoverContainer\n          style={{\n            width: 'fit-content',\n            zIndex: 2,\n            position: 'relative',\n            left: actionBarLeft,\n          }}\n          ref={actionBarRef}\n        >\n          {showHoverText ? (\n            <CopyTextMessage\n              wrapperClass={wrapperClass}\n              isUseExternalContent={true}\n              externalContent={showHoverText}\n              isMustGroupLastAnswerMessage={false}\n            />\n          ) : null}\n          {isShowDelete ? <DeleteMessage /> : null}\n          {isShowQuote ? <QuoteMessage /> : null}\n        </ActionBarHoverContainer>\n      </div>\n      {/** popoverpopover */}\n\n      <div\n        ref={popoverContainerRef}\n        style={{ width: 0, height: 0, position: 'relative' }}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { isEqual } from 'lodash-es';\nimport {\n  useMessageBoxContext,\n  useChatAreaStoreSet,\n  getIsTextMessage,\n} from '@coze-common/chat-area';\n\nexport const useMessageFooterInfo = () => {\n  const { groupId } = useMessageBoxContext();\n  const { useMessagesStore } = useChatAreaStoreSet();\n\n  const messageGroupList = useMessagesStore(s => s.messageGroupList, isEqual);\n  const messages = useMessagesStore(s => s.messages, isEqual);\n  const findMessage = useMessagesStore(s => s.findMessage, isEqual);\n\n  const lastMessageText = useMemo(() => {\n    const messageGroup = messageGroupList.find(\n      group => group.groupId === groupId,\n    );\n    return messageGroup?.memberSet.llmAnswerMessageIdList\n      .map(item => {\n        const messageItem = findMessage(item);\n        if (getIsTextMessage(messageItem)) {\n          return messageItem.content;\n        }\n        return '';\n      })\n      .filter(item => !!item)\n      .reverse()\n      .join('\\n');\n  }, [messageGroupList, messages, findMessage, groupId]);\n  return {\n    lastMessageText,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  type ComponentTypesMap,\n  useMessageBoxContext,\n  useChatAreaStoreSet,\n} from '@coze-common/chat-area';\nimport {\n  ActionBarContainer,\n  CopyTextMessage,\n  QuoteMessage,\n} from '@coze-common/chat-answer-action';\n\nimport { useChatAppProps } from '@/components/studio-open-chat/store';\nimport { useIsShowBackground } from '@/components/studio-open-chat/hooks/use-is-show-background';\n\nimport { useCurMessageInfo } from '../../hooks/use-cur-message-info';\nimport { DeleteMessage } from '../../components/delete-message';\nimport { useMessageFooterInfo } from './use-message-footer-info';\n\nconst ChatMessageFooterContent = () => {\n  const { lastMessageText } = useMessageFooterInfo();\n  const showBackground = useIsShowBackground();\n  const { isShowDelete, isNeedQuote } = useCurMessageInfo();\n  const buttonClass = showBackground ? '!coz-fg-images-white' : '';\n  const isShowMessageFooter = !!lastMessageText || isShowDelete;\n  if (!isShowMessageFooter) {\n    return null;\n  }\n  return (\n    <ActionBarContainer\n      leftContent={[\n        !!lastMessageText && (\n          <CopyTextMessage\n            key=\"copy\"\n            className={buttonClass}\n            isUseExternalContent={true}\n            externalContent={lastMessageText}\n          />\n        ),\n        isShowDelete && (\n          <DeleteMessage key=\"delete\" className={classNames(buttonClass)} />\n        ),\n        !!lastMessageText && isNeedQuote && (\n          <QuoteMessage className={classNames(buttonClass)} />\n        ),\n      ]}\n      rightContent={[]}\n    />\n  );\n};\n\nexport const UIKitMessageBoxFooter: ComponentTypesMap['messageActionBarFooter'] =\n  ({ refreshContainerWidth }) => {\n    const { meta } = useMessageBoxContext();\n    const { message } = useMessageBoxContext();\n    const { useWaitingStore } = useChatAreaStoreSet();\n    const { readonly } = useChatAppProps();\n\n    const waiting = useWaitingStore(state => !!state.waiting);\n    const isAnswerMessage = message.type === 'answer';\n    const isLastGroupMessage =\n      meta.isGroupLastMessage && meta.isFromLatestGroup;\n\n    useEffect(() => {\n      refreshContainerWidth();\n    }, []);\n\n    if (!isLastGroupMessage || !isAnswerMessage || waiting || readonly) {\n      /*\n       * footer\n       *  message\n       *  message\n       *  message\n       */\n      return null;\n    }\n    return <ChatMessageFooterContent />;\n  };\n","\n      import API from \"!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cls from 'classnames';\nimport { MessageBox as UIKitMessageBox } from '@coze-common/chat-uikit';\nimport { type CustomComponent } from '@coze-common/chat-area';\n\nimport styles from './index.module.less';\n// coze-chat-message-wrapper coze-chat-hover-message-wrapper element\nexport const UIKitMessageBoxPlugin: CustomComponent['UIKitMessageBoxPlugin'] =\n  ({ messageType, classname, ...props }) => (\n    <UIKitMessageBox\n      {...props}\n      classname={cls(classname, 'w-full')}\n      isHoverShowUserInfo={false}\n      messageBoxWrapperClassname={cls(\n        'coze-chat-message-wrapper',\n        styles['message-box-wrapper'],\n      )}\n      messageHoverWrapperClassName={\n        'w-full flex justify-end right-[0px] coze-chat-hover-message-wrapper'\n      }\n    />\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PluginMode,\n  PluginName,\n  WriteableChatAreaPlugin,\n  createWriteableLifeCycleServices,\n  createCustomComponents,\n} from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { bizLifeCycleServiceGenerator } from './services/life-cycle';\nimport { UIKitMessageGroupFooterPlugin } from './custom-components/message-group-footer';\nimport { UIKitMessageBoxHoverSlot } from './custom-components/message-box-hover-slot';\nimport { UIKitMessageBoxFooter } from './custom-components/message-box-footer';\nimport { UIKitMessageBoxPlugin } from './custom-components/message-box';\nexport class BizPlugin extends WriteableChatAreaPlugin<PluginBizContext> {\n  /**\n   * \n   * PluginMode.Readonly = \n   * PluginMode.Writeable = \n   */\n  public pluginMode = PluginMode.Writeable;\n  /**\n   * \n   *  PluginName \n   */\n  public pluginName = PluginName.WebsdkChatCozeSdkPlugin;\n\n  /**\n   * \n   */\n  public lifeCycleServices = createWriteableLifeCycleServices(\n    this,\n    bizLifeCycleServiceGenerator,\n  );\n  public customComponents = createCustomComponents({\n    UIKitMessageBoxPlugin,\n    MessageGroupFooter: UIKitMessageGroupFooterPlugin,\n    MessageBoxFooter: UIKitMessageBoxFooter,\n    MessageBoxHoverSlot: UIKitMessageBoxHoverSlot,\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { BizPlugin } from './plugin';\n\nexport const getCozeSdkPlugin = (props: PluginBizContext) => {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const WebsdkChatExtraBodyPlugin: PluginRegistryEntry<PluginBizContext> = {\n    /**\n     * \n     */\n    createPluginBizContext() {\n      return { ...props };\n    },\n    /**\n     * \n     */\n    Plugin: BizPlugin,\n  };\n  return WebsdkChatExtraBodyPlugin;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useMemo } from 'react';\n\nimport {\n  createChatBackgroundPlugin,\n  ChatBackgroundEventName,\n} from '@coze-common/chat-area-plugin-chat-background';\n\nimport {\n  useChatAppProps,\n  useChatAppStore,\n} from '@/components/studio-open-chat/store';\nexport const useBgBackgroundPlugin = () => {\n  const { ChatBackgroundPlugin, chatBackgroundEvent } = useMemo(\n    () => createChatBackgroundPlugin(),\n    [],\n  );\n  const { isCustomBackground } = useChatAppProps();\n\n  const backgroundInfo = useChatAppStore(s => s.backgroundInfo);\n  const backgroundInfoToShow = isCustomBackground ? undefined : backgroundInfo;\n  useEffect(() => {\n    // \n    chatBackgroundEvent.emit(\n      ChatBackgroundEventName.OnBackgroundChange,\n      backgroundInfoToShow || {\n        mobile_background_image: {},\n        web_background_image: {},\n      },\n    );\n  }, [backgroundInfoToShow]);\n\n  return {\n    ChatBackgroundPlugin,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  type FC,\n  useMemo,\n  type PropsWithChildren,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  useEffect,\n} from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport copy from 'copy-to-clipboard';\nimport { useMemoizedFn } from 'ahooks';\nimport { isFile } from '@coze-common/chat-uikit';\nimport { Scene } from '@coze-common/chat-core';\nimport { ReasoningPluginRegistry } from '@coze-common/chat-area-plugin-reasoning';\nimport {\n  type GrabPublicMethod,\n  useCreateGrabPlugin,\n} from '@coze-common/chat-area-plugin-message-grab';\nimport {\n  allIgnorableMessageTypes,\n  ChatAreaProvider,\n  useChatAreaStoreSet,\n  type PluginRegistryEntry,\n  useRegenerateMessageByUserMessageId,\n  usePluginPublicMethods,\n  PluginName,\n} from '@coze-common/chat-area';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIToast } from '@coze-arch/bot-semi';\nimport { type Conversation } from '@coze/api';\n\nimport { type SDKInitError, isAuthError } from '@/util/error';\nimport { ChatType } from '@/types/client';\nimport { studioOpenClientReporter, createSDKUploadPluginClass } from '@/helper';\n\nimport { useChatAppProps, useChatAppStore } from '../../store';\nimport { useUpdateConversationNameByMessage } from '../../hooks/use-update-conversation-name-by-message';\nimport { useIsShowBackground } from '../../hooks/use-is-show-background';\nimport { useUserInfo } from '../../hooks';\nimport { useUploadFileApi } from './use-upload-file-api';\nimport { useRequestInit } from './use-request-init';\nimport { useCoreOverrideConfig } from './use-core-override-config';\nimport { type ChatProviderFunc } from './type';\nimport { getCozeSdkPlugin } from './plugin';\nimport { useBgBackgroundPlugin } from './hooks/use-bg-background-plugin';\nimport { ChatCozeSdkProvider, useChatCozeSdk } from './context';\nconst ChatProviderFuncComp = forwardRef<\n  ChatProviderFunc | undefined,\n  PropsWithChildren\n>(({ children }, ref) => {\n  const { chatConfig } = useChatAppProps();\n  const {\n    updateCurrentConversationInfo,\n    currentConversationInfo,\n    updateConversations,\n  } = useChatAppStore(\n    useShallow(s => ({\n      updateCurrentConversationInfo: s.updateCurrentConversationInfo,\n      currentConversationInfo: s.currentConversationInfo,\n      updateConversations: s.updateConversations,\n    })),\n  );\n  const { useGlobalInitStore, useSectionIdStore } = useChatAreaStoreSet();\n  const setConversationIdInArea = useGlobalInitStore(\n    state => state.setConversationId,\n  );\n  const conversationId = useGlobalInitStore(state => state.conversationId);\n  const sectionId = useSectionIdStore(state => state.latestSectionId);\n  const chatCore = useGlobalInitStore(state => state.chatCore);\n  const setConversationId = useMemoizedFn(\n    (conversationIdNew: string, sectionIdNew: string) => {\n      const isConversations =\n        chatConfig.ui?.conversations?.isNeed &&\n        chatConfig.type !== ChatType.APP;\n      if (isConversations && currentConversationInfo) {\n        const timestamp = Math.floor(Date.now() / 1000);\n        const newConversation: Conversation = {\n          id: conversationIdNew,\n          last_section_id: sectionIdNew,\n          updated_at: timestamp,\n          created_at: timestamp,\n          meta_data: {},\n        };\n        updateCurrentConversationInfo({\n          ...currentConversationInfo,\n          ...newConversation,\n        });\n        updateConversations([newConversation], 'add');\n      } else {\n        setConversationIdInArea(conversationIdNew);\n        chatCore?.updateConversationId(conversationIdNew);\n      }\n    },\n  );\n  const getConversationId = useMemoizedFn(() => conversationId || '');\n  const getSectionId = useMemoizedFn(() => sectionId || '');\n\n  useUpdateConversationNameByMessage();\n\n  const regenerateMessageByUserMessageId =\n    useRegenerateMessageByUserMessageId();\n  useImperativeHandle(\n    ref,\n    () => ({\n      regenerateMessageByUserMessageId,\n      setConversationId,\n      getConversationId,\n      getSectionId,\n    }),\n    [\n      regenerateMessageByUserMessageId,\n      setConversationId,\n      getConversationId,\n      getSectionId,\n    ],\n  );\n\n  const grabPluginPublicMethods = usePluginPublicMethods<GrabPublicMethod>(\n    PluginName.MessageGrab,\n  );\n  useEffect(() => {\n    if (!grabPluginPublicMethods) {\n      return;\n    }\n\n    grabPluginPublicMethods.updateEnableGrab(true);\n  }, []);\n  return <>{children}</>;\n});\n\nconst ChatProviderImpl: FC<{\n  children: React.ReactNode;\n  plugins?: PluginRegistryEntry<unknown>[];\n}> = ({ children, plugins }) => {\n  const refLastIsError = useRef(false);\n  const { refreshToken } = useChatCozeSdk();\n  const { initError, setInitError } = useChatAppStore(\n    useShallow(s => ({\n      initError: s.initError,\n      setInitError: s.setInitError,\n    })),\n  );\n  const refChatFunc = useRef<ChatProviderFunc>();\n  const {\n    chatConfig,\n    onImageClick,\n    initErrorFallbackFC: ErrorFallback,\n  } = useChatAppProps();\n  const userInfo = useUserInfo();\n  const requestToInit = useRequestInit();\n  const createChatCoreOverrideConfig = useCoreOverrideConfig({\n    refChatFunc,\n  });\n  const { GrabPlugin } = useCreateGrabPlugin({\n    scene: 'store',\n  });\n  const uploadFileApi = useUploadFileApi();\n  const isShowBackground = useIsShowBackground();\n  const { ChatBackgroundPlugin } = useBgBackgroundPlugin();\n  // plugin\n  const cozeSdkChatPlugin = getCozeSdkPlugin({\n    refreshToken,\n    regenerateMessageByUserMessageId: id => {\n      refChatFunc.current?.regenerateMessageByUserMessageId?.(id);\n    },\n  });\n\n  const SDKUploadPlugin = useMemo(\n    () =>\n      createSDKUploadPluginClass({\n        botId: chatConfig.bot_id || '',\n        source: chatConfig.source,\n        uploadFile: uploadFileApi,\n      }),\n    [chatConfig, uploadFileApi],\n  );\n  useEffect(() => {\n    if (!initError) {\n      return;\n    }\n    if (refLastIsError.current) {\n      return;\n    }\n    (async () => {\n      try {\n        if (isAuthError((initError as SDKInitError).code)) {\n          await refreshToken?.();\n          setInitError(false);\n        }\n      } catch (err) {\n        console.error(err);\n      }\n      refLastIsError.current = true;\n    })();\n  }, [initError]);\n\n  if (initError) {\n    if (ErrorFallback) {\n      return (\n        <ErrorFallback\n          error={initError === true ? null : initError}\n          refresh={async () => {\n            if (isAuthError((initError as SDKInitError).code)) {\n              await refreshToken?.();\n              setInitError(false);\n            } else {\n              location.reload();\n            }\n          }}\n        />\n      );\n    }\n\n    return null;\n  }\n\n  return (\n    <ChatAreaProvider\n      botId={chatConfig.bot_id}\n      userInfo={userInfo}\n      scene={Scene.OpenAipSdk}\n      reporter={studioOpenClientReporter}\n      requestToInit={requestToInit}\n      enableChatActionLock\n      createChatCoreOverrideConfig={createChatCoreOverrideConfig}\n      eventCallback={{\n        onImageClick,\n        onInitSuccess: () => {\n          refLastIsError.current = false;\n        },\n        onCopyUpload: ({ message: msg, extra: { fileIndex } }) => {\n          if (isFile(msg.content_obj)) {\n            copy(msg.content_obj.file_list[fileIndex ?? 0]?.file_key ?? '');\n            UIToast.success({\n              content: I18n.t('copy_success') ?? 'Copy Successfully',\n            });\n          }\n        },\n      }}\n      configs={{\n        showFunctionCallDetail: false,\n        uploadPlugin: SDKUploadPlugin,\n        ignoreMessageConfigList: allIgnorableMessageTypes,\n        isShowFunctionCallBox:\n          chatConfig?.ui?.chatBot?.isNeedFunctionCallMessage ?? true,\n      }}\n      pluginRegistryList={[\n        cozeSdkChatPlugin,\n        ReasoningPluginRegistry,\n        ChatBackgroundPlugin,\n        GrabPlugin,\n        ...(plugins || []),\n      ]}\n      showBackground={isShowBackground}\n      enableDragUpload={false}\n    >\n      <ChatProviderFuncComp ref={refChatFunc}>{children}</ChatProviderFuncComp>\n    </ChatAreaProvider>\n  );\n};\n\nexport const ChatProvider: FC<{\n  children: React.ReactNode;\n  plugins?: PluginRegistryEntry<unknown>[];\n}> = ({ children, plugins }) => (\n  <ChatCozeSdkProvider>\n    <ChatProviderImpl plugins={plugins}>{children}</ChatProviderImpl>\n  </ChatCozeSdkProvider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, type FC } from 'react';\n\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport { type StudioChatProviderProps } from '@/types/props';\n\nimport { ChatPropsProvider } from '../store/context';\nimport { useChatAppProps, useChatAppStore } from '../store';\nimport { getChatCommonPlugin } from '../plugin';\nimport { useGetTheme } from '../hooks/use-get-theme';\nimport { ChatProvider as ChatProviderCozeSdk } from './coz-sdk/chat-provider';\n\nconst ChatProvider: FC<{\n  children: React.ReactNode;\n  plugins?: PluginRegistryEntry<unknown>[];\n}> = ({ children, plugins }) => {\n  const { chatConfig, onImageClick, onThemeChange } = useChatAppProps();\n  const setInitError = useChatAppStore(s => s.setInitError);\n  // plugin\n  const commonChatPlugin = getChatCommonPlugin({\n    onImageClick,\n    onInitialError: () => {\n      setInitError(true);\n    },\n    extraBody: chatConfig.extra?.webChat,\n  });\n  const theme = useGetTheme();\n  useEffect(() => {\n    onThemeChange?.(theme);\n  }, [theme]);\n  return (\n    <ChatProviderCozeSdk\n      plugins={[\n        commonChatPlugin as PluginRegistryEntry<unknown>,\n        ...(plugins || []),\n      ]}\n    >\n      {children}\n    </ChatProviderCozeSdk>\n  );\n};\n\nexport const OpenChatProvider: FC<\n  StudioChatProviderProps & {\n    children: React.ReactNode;\n    plugins?: PluginRegistryEntry<unknown>[];\n  }\n> = ({ children, plugins, ...props }) => (\n  <ChatPropsProvider appProps={props}>\n    <ChatProvider plugins={plugins}>{children}</ChatProvider>\n  </ChatPropsProvider>\n);\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Spin } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\nexport const Loading = () => (\n  <div className={styles.loading}>\n    <Spin size=\"large\" />\n  </div>\n);\n","\n      import API from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport cls from 'classnames';\nimport { IconCozSideNav } from '@coze-arch/coze-design/icons';\nimport { Button, IconButton } from '@coze-arch/coze-design';\nimport { Typography } from '@coze-arch/bot-semi';\n\nimport { useChatAppStore } from '@/components/studio-open-chat/store';\nimport {\n  useChatChatButtonInfo,\n  useChatOpInfo,\n} from '@/components/studio-open-chat/hooks/use-chat-op-info';\nimport CozeLogoPng from '@/assets/coze-logo.png';\n\nimport { type ChatHeaderProps } from '../type';\n\nimport styles from './index.module.less';\n\nconst ChatHeader = ({\n  iconUrl = CozeLogoPng,\n  title = 'Coze Bot',\n  extra,\n  theme,\n  isShowConversations,\n}: ChatHeaderProps) => {\n  const { headerTopLeftOps } = useChatOpInfo();\n  const buttonList = useChatChatButtonInfo(headerTopLeftOps);\n  const { updateCurrentConversationInfo, currentConversationInfo } =\n    useChatAppStore(\n      useShallow(s => ({\n        updateCurrentConversationInfo: s.updateCurrentConversationInfo,\n        currentConversationInfo: s.currentConversationInfo,\n      })),\n    );\n  // \n  return (\n    <header\n      className={cls(styles.header, {\n        [styles['bg-theme']]: theme === 'bg-theme',\n      })}\n    >\n      {currentConversationInfo?.conversationListVisible ||\n      !isShowConversations ? null : (\n        <IconButton\n          color=\"secondary\"\n          icon={<IconCozSideNav width=\"18px\" height=\"18px\" />}\n          className={styles['conversation-list-btn']}\n          onClick={() => {\n            if (!currentConversationInfo) {\n              return;\n            }\n            updateCurrentConversationInfo({\n              ...currentConversationInfo,\n              conversationListVisible: true,\n            });\n          }}\n        />\n      )}\n      <img className={styles.avatar} src={iconUrl} alt=\"avatar\" />\n      <Typography.Text\n        className={styles.title}\n        ellipsis={{\n          showTooltip: {\n            opts: { style: { wordBreak: 'break-word' }, position: 'bottom' },\n            type: 'tooltip',\n          },\n          rows: 1,\n        }}\n      >\n        {title}\n      </Typography.Text>\n      {buttonList?.map(\n        item => (\n          <Button\n            color=\"secondary\"\n            icon={item.icon}\n            className={styles['icon-btn']}\n            disabled={item.disabled}\n            onClick={() => {\n              item.onClick?.();\n            }}\n          />\n        ),\n        /*\n        if (item === 'clearMessage') {\n          return (\n            <Button\n              color=\"secondary\"\n              icon={<IconCozBroom width=\"18px\" height=\"18px\" />}\n              className={styles['icon-btn']}\n              onClick={() => {\n                clearHistory();\n              }}\n            />\n          );\n        } else if (item === 'addNewConversation') {\n          return (\n            <Button\n              color=\"secondary\"\n              icon={<IconAddNewConversation width=\"18px\" height=\"18px\" />}\n              className={styles['icon-btn']}\n              onClick={() => {\n                clearHistory();\n              }}\n            />\n          );\n        }\n        return null;*/\n      )}\n\n      {!!extra && extra}\n    </header>\n  );\n};\n\nexport default ChatHeader;\n","\n      import API from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport cls from 'classnames';\nimport { IconCozSideNav } from '@coze-arch/coze-design/icons';\nimport { Button, IconButton } from '@coze-arch/coze-design';\nimport { Typography } from '@coze-arch/bot-semi';\n\nimport { useChatAppStore } from '@/components/studio-open-chat/store';\nimport {\n  useChatChatButtonInfo,\n  useChatOpInfo,\n} from '@/components/studio-open-chat/hooks/use-chat-op-info';\nimport CozeLogoPng from '@/assets/coze-logo.png';\n\nimport { type ChatHeaderProps } from '../type';\n\nimport styles from './index.module.less';\n\nconst ChatHeaderMobile = ({\n  iconUrl = CozeLogoPng,\n  title = 'Coze Bot',\n  extra,\n  theme,\n  isShowConversations,\n}: ChatHeaderProps) => {\n  const { headerTopLeftOps } = useChatOpInfo();\n  const buttonList = useChatChatButtonInfo(headerTopLeftOps);\n\n  const { updateCurrentConversationInfo, currentConversationInfo } =\n    useChatAppStore(\n      useShallow(s => ({\n        updateCurrentConversationInfo: s.updateCurrentConversationInfo,\n        currentConversationInfo: s.currentConversationInfo,\n      })),\n    );\n\n  return (\n    <header\n      className={cls(styles.header, {\n        [styles['bg-theme']]: theme === 'bg-theme',\n      })}\n    >\n      {currentConversationInfo?.conversationListVisible ||\n      !isShowConversations ? null : (\n        <IconButton\n          color=\"secondary\"\n          icon={<IconCozSideNav width=\"18px\" height=\"18px\" />}\n          className={styles['conversation-list-btn']}\n          onClick={() => {\n            if (!currentConversationInfo) {\n              return;\n            }\n            updateCurrentConversationInfo({\n              ...currentConversationInfo,\n              conversationListVisible: true,\n            });\n          }}\n        />\n      )}\n      <img className={styles.avatar} src={iconUrl} alt=\"avatar\" />\n      <Typography.Text\n        className={styles.title}\n        ellipsis={{\n          rows: 1,\n        }}\n      >\n        {title}\n      </Typography.Text>\n      {buttonList?.map(item => (\n        <Button\n          color=\"secondary\"\n          icon={item.icon}\n          className={styles['icon-btn']}\n          disabled={item.disabled}\n          onClick={() => {\n            item.onClick?.();\n          }}\n        />\n      ))}\n\n      {!!extra && extra}\n    </header>\n  );\n};\n\nexport default ChatHeaderMobile;\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowRightFill } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useChatAppStore } from '../studio-open-chat/store';\nimport { type ChatHeaderProps } from './type';\nimport ChatHeaderPC from './pc';\nimport ChatHeaderMobile from './mobile';\n\nimport styles from './index.module.less';\n\nconst FloatBtn = () => {\n  const { updateCurrentConversationInfo, currentConversationInfo } =\n    useChatAppStore(\n      useShallow(s => ({\n        updateCurrentConversationInfo: s.updateCurrentConversationInfo,\n        currentConversationInfo: s.currentConversationInfo,\n      })),\n    );\n  return currentConversationInfo?.conversationListVisible ? null : (\n    <Tooltip content={I18n.t('web_sdk_open_conversations')}>\n      <IconButton\n        className={styles['float-open-conversations-btn']}\n        size=\"small\"\n        style={{\n          height: '32px',\n          borderTopLeftRadius: 'unset',\n          borderBottomLeftRadius: 'unset',\n        }}\n        icon={<IconCozArrowRightFill />}\n        onClick={() => {\n          if (!currentConversationInfo) {\n            return;\n          }\n          updateCurrentConversationInfo({\n            ...currentConversationInfo,\n            conversationListVisible: true,\n          });\n        }}\n      ></IconButton>\n    </Tooltip>\n  );\n};\n\nexport const ChatHeader: FC<ChatHeaderProps & { isMobile?: boolean }> = ({\n  isMobile,\n  ...props\n}) => {\n  const { isShowConversations, isShowHeader } = props;\n  if (!isShowHeader) {\n    return isShowConversations ? <FloatBtn /> : null;\n  }\n  return isMobile ? (\n    <ChatHeaderMobile {...props} />\n  ) : (\n    <ChatHeaderPC {...props} />\n  );\n};\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, Fragment } from 'react';\n\nimport cls from 'classnames';\nimport { cozeOfficialHost } from '@coze-studio/open-env-adapter';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type FooterConfig } from '@/types/client';\n\nimport styles from './index.module.less';\n\nconst getDefaultText = () =>\n  I18n.t('web_sdk_official_banner', {\n    docs_link: (\n      <a\n        key=\"web_sdk_official_banner\"\n        className={styles.link}\n        href={cozeOfficialHost}\n        target=\"_blank\"\n      >\n        {I18n.t('web_sdk_official_banner_link')}\n      </a>\n    ),\n  });\n\nconst getTextByExpress = (\n  expressionText: string,\n  linkvars?: Record<\n    string,\n    {\n      text: string;\n      link: string;\n    }\n  >,\n) => {\n  const arrLinks: React.ReactNode[] = [];\n  const splitLinkTag = '{{{link}}}';\n  const textWithLinkTags = expressionText.replace(\n    /\\{\\{\\s*(\\w+)\\s*\\}\\}/g,\n    (_, key) => {\n      const { link, text: linkText } = linkvars?.[key] || {};\n      if (link && linkText) {\n        arrLinks.push(\n          <a className={styles.link} href={link} target=\"_blank\">\n            {linkText}\n          </a>,\n        );\n        return splitLinkTag;\n      } else {\n        arrLinks.push(linkText || '');\n      }\n      return splitLinkTag;\n    },\n  );\n  return textWithLinkTags.split(splitLinkTag).map((item, index) => (\n    <Fragment key={`text_link_${index}`}>\n      {item}\n      {arrLinks[index]}\n    </Fragment>\n  ));\n};\n\nconst ChatFooter: FC<\n  FooterConfig & {\n    footerClassName?: string;\n    textClassName?: string;\n    theme?: 'bg-theme' | 'light';\n  }\n> = ({\n  isShow = true,\n  expressionText,\n  linkvars,\n  footerClassName,\n  textClassName,\n  theme,\n}) =>\n  isShow ? (\n    <footer\n      className={cls(styles.footer, footerClassName, {\n        [styles['bg-theme']]: theme === 'bg-theme',\n      })}\n    >\n      <span className={cls(styles.text, textClassName)}>\n        {expressionText\n          ? getTextByExpress(expressionText, linkvars)\n          : getDefaultText()}\n      </span>\n    </footer>\n  ) : null;\n\nexport default ChatFooter;\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport { Button } from '@coze-arch/coze-design';\n\nimport {\n  getServerError,\n  type SDKInitError,\n  ServerErrorCode,\n  specCodeList,\n} from '@/util/error';\nimport ErrorUnbindPng from '@/assets/error-unbind.png';\nimport ErrorDefaultPng from '@/assets/error-default.png';\n\nimport styles from './index.module.less';\n\nexport interface InitErrorFallback {\n  /**\n   * null \n   */\n  error: SDKInitError | null;\n  onBeforeRetry?: () => void;\n  refresh?: () => void;\n}\n\nconst ErrorFallback: FC<InitErrorFallback> = ({\n  error,\n  onBeforeRetry,\n  refresh,\n}) => {\n  let msg = I18n.t('overview_bi_assistant_system_error');\n  if (error) {\n    msg = error.msg;\n    const wrapError = getServerError(error);\n\n    if (wrapError) {\n      msg = wrapError.msg;\n    }\n  }\n  const defaultError = I18n.t('web_sdk_retry_notification');\n\n  const hideExtra = !!error?.code && specCodeList.includes(error.code);\n\n  return (\n    <div className={styles.wrapper}>\n      <img className={styles.icon} src={getErrorIcon(error)} />\n      <div className={styles.message}>{msg}</div>\n      {!hideExtra && (\n        <div className={styles.extra}>\n          {I18n.t(\n            `web_sdk_api_error_${error?.code}` as I18nKeysNoOptionsType,\n            {},\n            defaultError,\n          )}\n        </div>\n      )}\n      <Button\n        className={styles.btn}\n        onClick={() => {\n          onBeforeRetry?.();\n          if (refresh) {\n            refresh?.();\n          } else {\n            location.reload();\n          }\n        }}\n      >\n        {I18n.t('retry')}\n      </Button>\n    </div>\n  );\n};\n\nexport default ErrorFallback;\n\nexport const getErrorIcon = (error: SDKInitError | null) => {\n  switch (error?.code) {\n    case ServerErrorCode.BotUnbind:\n      return ErrorUnbindPng;\n    default:\n      return ErrorDefaultPng;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, type PropsWithChildren } from 'react';\n\nimport { ErrorBoundary as FlowErrorBoundary } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/bot-semi';\n\nimport { studioOpenClientReporter } from '@/helper';\n\nconst { Title, Text } = Typography;\n\nconst FallbackComponent: FC = () => (\n  <div>\n    <Title>{I18n.t('404_title')}</Title>\n    <Text>{I18n.t('404_content')}</Text>\n  </div>\n);\n\nexport const ErrorBoundary: FC<PropsWithChildren> = ({ children }) => (\n  <FlowErrorBoundary\n    errorBoundaryName=\"ErrorBoundary\"\n    logger={studioOpenClientReporter.getLogger()}\n    FallbackComponent={FallbackComponent}\n  >\n    {children}\n  </FlowErrorBoundary>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableRenderLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const renderLifeCycleServiceGenerator: WriteableRenderLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableMessageLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const messageLifeCycleServiceGenerator: WriteableMessageLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => {\n  let hasInit = false;\n  let lastMessageId = '';\n  let nowReceivingReplyId = '';\n  return {\n    onBeforeMessageGroupListUpdate: ctx => {\n      const { messages } =\n        plugin.chatAreaPluginContext.readonlyAPI.message.getMessagesStoreInstantValues();\n      const latestMessage = messages?.[0];\n      if (!hasInit || lastMessageId === latestMessage?.message_id) {\n        hasInit = true;\n        return ctx;\n      }\n      plugin.pluginBizContext.eventCallbacks?.onMessageChanged?.();\n      lastMessageId = latestMessage?.message_id;\n\n      if (\n        (latestMessage?.type === 'answer' &&\n          latestMessage?.is_finish === true) ||\n        !lastMessageId\n      ) {\n        plugin.pluginBizContext?.eventCallbacks?.onMessageReceivedFinish?.();\n      }\n      return ctx;\n    },\n    onAfterSendMessage: ctx => {\n      const chatflowExecuteId: string =\n        // @ts-expect-error -- linter-disable-autofix, \n        ctx?.message?.extra_info?.chatflow_execute_id || '';\n      if (chatflowExecuteId) {\n        plugin.pluginBizContext?.eventCallbacks?.onGetChatFlowExecuteId?.(\n          chatflowExecuteId,\n        );\n      }\n      plugin.pluginBizContext?.eventCallbacks?.onMessageSended?.();\n    },\n    onBeforeReceiveMessage: ctx => {\n      if (nowReceivingReplyId === ctx.message.reply_id) {\n        return;\n      }\n      nowReceivingReplyId = ctx.message.reply_id;\n      plugin.pluginBizContext?.eventCallbacks?.onMessageReceivedStart?.();\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableCommandLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const commandLifeCycleServiceGenerator: WriteableCommandLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableAppLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\n\nexport const appLifeCycleServiceGenerator: WriteableAppLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WriteableLifeCycleServiceGenerator } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from '../../types/biz-context';\nimport { renderLifeCycleServiceGenerator } from './render';\nimport { messageLifeCycleServiceGenerator } from './message';\nimport { commandLifeCycleServiceGenerator } from './command';\nimport { appLifeCycleServiceGenerator } from './app';\n\nexport const bizLifeCycleServiceGenerator: WriteableLifeCycleServiceGenerator<\n  PluginBizContext\n> = plugin => ({\n  appLifeCycleService: appLifeCycleServiceGenerator(plugin),\n  messageLifeCycleService: messageLifeCycleServiceGenerator(plugin),\n  commandLifeCycleService: commandLifeCycleServiceGenerator(plugin),\n  renderLifeCycleService: renderLifeCycleServiceGenerator(plugin),\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  PluginMode,\n  PluginName,\n  WriteableChatAreaPlugin,\n  createWriteableLifeCycleServices,\n} from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { bizLifeCycleServiceGenerator } from './services/life-cycle';\n\nexport class BizPlugin extends WriteableChatAreaPlugin<PluginBizContext> {\n  /**\n   * \n   * PluginMode.Readonly = \n   * PluginMode.Writeable = \n   */\n  public pluginMode = PluginMode.Writeable;\n  /**\n   * \n   *  PluginName \n   */\n  public pluginName = PluginName.UIBuilderEventcallbackPlugin;\n\n  /**\n   * \n   */\n  public lifeCycleServices = createWriteableLifeCycleServices(\n    this,\n    bizLifeCycleServiceGenerator,\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PluginRegistryEntry } from '@coze-common/chat-area';\n\nimport { type PluginBizContext } from './types/biz-context';\nimport { BizPlugin } from './plugin';\n\nexport type UIBuilderEventCallbackPlugin =\n  PluginRegistryEntry<PluginBizContext>;\nexport const getBuilderEventCallbackPlugin = (\n  props: PluginBizContext,\n): PluginRegistryEntry<unknown> => {\n  const uiBuilderEventCallbackPlugin: UIBuilderEventCallbackPlugin = {\n    /**\n     * \n     */\n    createPluginBizContext() {\n      return { ...props };\n    },\n    /**\n     * \n     */\n    Plugin: BizPlugin,\n  };\n  return uiBuilderEventCallbackPlugin as PluginRegistryEntry<unknown>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { webSdkDefaultConnectorId, chatflowDraftConnectorId } from '@/util';\n\nimport { type IBuilderChatProps } from '../type';\n\nexport const getConnectorId = (props: IBuilderChatProps) => {\n  const { project } = props;\n  const { mode, connectorId } = project || {};\n  if (!connectorId) {\n    if (mode === 'websdk') {\n      return webSdkDefaultConnectorId;\n    } else if (mode === 'draft') {\n      return chatflowDraftConnectorId;\n    }\n  }\n  return connectorId;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const webSdkDefaultConnectorId = '999';\nexport const chatflowDraftConnectorId = '10000010';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport i18n from '@coze-arch/i18n/intl';\nimport { type CozeAPI } from '@coze/api';\n\nimport { EInputMode } from '@/types/props';\nimport ChatFlowUserIcon from '@/assets/chatflow-logo.png';\n\nimport { type IBuilderChatProps } from '../type';\nimport { getConnectorId } from '../helper/get-connector-id';\nimport {\n  type ProjectInfoResp,\n  type WorkflowInfoResp,\n  type InitData,\n  type CozeApiFullFilledRes,\n} from '../data-type';\nconst getFormatAppData = (\n  appData?: ProjectInfoResp['data'],\n  workflowData?: WorkflowInfoResp['role'],\n  props?: IBuilderChatProps,\n): InitData => {\n  const appInfoResult: InitData = {\n    prologue: workflowData?.onboarding_info?.prologue || '',\n    onboardingSuggestions:\n      workflowData?.onboarding_info?.suggested_questions?.map(\n        (item, index) => ({\n          id: index.toString(),\n          content: item,\n        }),\n      ) || [],\n    displayAllSuggest: workflowData?.onboarding_info?.display_all_suggestions,\n    botInfo: {\n      url: workflowData?.avatar?.image_url || appData?.icon_url || '',\n      nickname:\n        workflowData?.name || appData?.name || props?.project.defaultName || '',\n      id: props?.project?.id || '',\n    },\n    suggestPromoteInfo: {\n      suggestReplyMode: workflowData?.suggest_reply_info?.suggest_reply_mode,\n      customizedSuggestPrompt:\n        workflowData?.suggest_reply_info?.customized_suggest_prompt,\n    },\n    backgroundInfo: workflowData?.background_image_info,\n    defaultInputMode:\n      workflowData?.user_input_config?.default_input_mode === 2\n        ? EInputMode.Voice\n        : EInputMode.Text,\n  };\n\n  // origin_image_urlorigin_image_url image_url\n  if (appInfoResult.backgroundInfo?.web_background_image) {\n    appInfoResult.backgroundInfo.web_background_image.origin_image_url =\n      appInfoResult.backgroundInfo.web_background_image.image_url;\n  }\n  if (appInfoResult.backgroundInfo?.mobile_background_image) {\n    appInfoResult.backgroundInfo.mobile_background_image.origin_image_url =\n      appInfoResult.backgroundInfo.mobile_background_image.image_url;\n  }\n\n  return appInfoResult;\n};\n\nexport const combineAppDataWithProps = (\n  appInfoResultRaw: InitData,\n  props?: IBuilderChatProps,\n): InitData => {\n  const appInfoResult = cloneDeep(appInfoResultRaw);\n\n  if (props?.project?.id) {\n    appInfoResult.botInfo.id = props?.project?.id;\n  }\n  if (props?.project?.name) {\n    appInfoResult.botInfo.nickname = props?.project?.name;\n  }\n  if (props?.project?.iconUrl) {\n    appInfoResult.botInfo.url = props?.project?.iconUrl;\n  }\n\n  if (props?.project?.onBoarding?.prologue) {\n    appInfoResult.prologue = props?.project?.onBoarding?.prologue;\n  }\n  if (props?.project?.onBoarding?.suggestions?.length) {\n    appInfoResult.onboardingSuggestions =\n      props?.project?.onBoarding?.suggestions.map((item, index) => ({\n        id: index.toString(),\n        content: item,\n      })) || [];\n  }\n  if (props?.project?.onBoarding?.displayAllSuggest) {\n    appInfoResult.displayAllSuggest =\n      props?.project?.onBoarding?.displayAllSuggest;\n  }\n\n  if (!appInfoResult.displayAllSuggest) {\n    appInfoResult.onboardingSuggestions =\n      appInfoResult.onboardingSuggestions.slice(0, 3);\n  }\n\n  if (props?.project?.suggestPromoteInfo?.suggestReplyMode) {\n    appInfoResult.suggestPromoteInfo = {\n      suggestReplyMode: props?.project?.suggestPromoteInfo?.suggestReplyMode,\n      customizedSuggestPrompt:\n        props?.project?.suggestPromoteInfo?.customizedSuggestPrompt,\n    };\n  }\n\n  if (props?.areaUi?.bgInfo?.imgUrl) {\n    // backgroundInfo \n    appInfoResult.customBgInfo = props?.areaUi?.bgInfo;\n  } else {\n    appInfoResult.customBgInfo = undefined;\n  }\n  return appInfoResult;\n};\n\nexport const getBotInfo = async (\n  apiSdk: CozeAPI | undefined,\n  props: IBuilderChatProps,\n) => {\n  const connectorId = getConnectorId(props);\n  const isWebSdk = props?.project?.mode === 'websdk';\n  const workflowId = props?.workflow?.id;\n  const isDebugParam = props?.project?.mode === 'draft' ? 'true' : '';\n  const callerParam = props?.project?.caller || '';\n  const lang = i18n.language;\n  console.log('i18n.language', lang);\n  const [appRes, workflowRes] = await Promise.allSettled([\n    isWebSdk\n      ? apiSdk?.get<unknown, ProjectInfoResp>(\n          `/v1/apps/${props?.project?.id}?version=${props?.project?.version || ''}&connector_id=${connectorId}`,\n          {},\n          false,\n          {\n            headers: {\n              'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n            },\n          },\n        )\n      : null,\n\n    workflowId\n      ? apiSdk?.get<unknown, { data: WorkflowInfoResp }>(\n          `/v1/workflows/${workflowId}?${[\n            `connector_id=${connectorId}`,\n            `is_debug=${isDebugParam}`,\n            `caller=${callerParam}`,\n          ].join('&')}`,\n          {},\n          false,\n          {\n            headers: {\n              'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n            },\n          },\n        )\n      : null,\n  ]);\n  const appData =\n    appRes?.status === 'fulfilled' ? appRes?.value?.data : undefined;\n  const workflowData =\n    workflowRes?.status === 'fulfilled'\n      ? workflowRes?.value?.data?.role\n      : undefined;\n  if (isWebSdk && !appData) {\n    throw { code: (appRes as CozeApiFullFilledRes)?.reason?.code, message: '' };\n  }\n  const appInfo = getFormatAppData(appData, workflowData, props);\n  if (props?.workflow?.id && !appInfo.botInfo.url) {\n    appInfo.botInfo.url = ChatFlowUserIcon;\n  }\n\n  return appInfo;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport i18n from '@coze-arch/i18n/intl';\nimport { type CozeAPI } from '@coze/api';\n\nimport { type IBuilderChatProps } from '../type';\nimport { getConnectorId } from '../helper/get-connector-id';\nexport const createOrGetConversation = async (\n  apiSdk: CozeAPI | undefined,\n  props: IBuilderChatProps,\n) => {\n  let conversationId = '';\n  let sectionId = '';\n\n  try {\n    if (props?.project?.type === 'bot') {\n      const res = await apiSdk?.conversations.create(\n        {\n          // @ts-expect-error -- linter-disable-autofix\n          connector_id: getConnectorId(props),\n        },\n        {\n          headers: {\n            'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n          },\n        },\n      );\n      conversationId = res?.id || '';\n      // @ts-expect-error -- linter-disable-autofix\n      sectionId = res.last_section_id;\n    } else {\n      if (IS_OPEN_SOURCE) {\n        const res = (await apiSdk?.post(\n          '/v1/workflow/conversation/create',\n          {\n            app_id: props.project?.id,\n            conversation_name: props?.project?.conversationName,\n            get_or_create: true,\n            draft_mode: props?.project?.mode === 'draft',\n            workflow_id: props?.workflow?.id,\n            connector_id: getConnectorId(props),\n          },\n          false,\n          {\n            headers: {\n              'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n            },\n          },\n        )) as {\n          data: {\n            id: string;\n            last_section_id: string;\n          };\n        };\n        conversationId = res?.data?.id || '';\n        sectionId = res?.data?.last_section_id || '';\n      } else {\n        const res = await apiSdk?.conversations.create(\n          {\n            // @ts-expect-error -- linter-disable-autofix\n            app_id: props.project?.id,\n            conversation_name: props?.project?.conversationName,\n            get_or_create: true,\n            draft_mode: props?.project?.mode === 'draft',\n            workflow_id: props?.workflow?.id,\n            connector_id: getConnectorId(props),\n          },\n          {\n            headers: {\n              'Accept-Language': i18n.language === 'zh-CN' ? 'zh' : 'en',\n            },\n          },\n        );\n        conversationId = res?.id || '';\n        sectionId = res?.last_section_id || '';\n      }\n    }\n    return { conversationId, sectionId };\n  } catch (error) {\n    throw {\n      code: -1002,\n      message: '',\n    };\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createContext,\n  type FC,\n  type PropsWithChildren,\n  useContext,\n} from 'react';\n\nimport { useUpdateEffect } from 'ahooks';\n\nimport { type IBuilderChatProps } from '../type';\nimport { combineAppDataWithProps } from '../services/get-bot-info';\nimport { type InitData } from '../data-type';\n\ninterface BuilderChatContextValue {\n  appDataFromOnLine?: InitData | null;\n  appDataCombineWithProps?: InitData | null;\n}\ntype BuilderChatContextProps = BuilderChatContextValue & {\n  setAppDataFromOnLine?: (appDataFromOnLint: InitData | null) => void;\n  setAppDataCombineWithProps?: (\n    appDataCombineWithProps: InitData | null,\n  ) => void;\n};\nconst BuilderChatContext = createContext<BuilderChatContextProps>({\n  appDataFromOnLine: null,\n  appDataCombineWithProps: null,\n});\n\nexport const BuilderChatProvider: FC<\n  PropsWithChildren<BuilderChatContextProps>\n> = ({ children, ...props }) => (\n  <BuilderChatContext.Provider value={props} children={children} />\n);\n\nexport const useGetAppDataFromOnLine = () => {\n  const { appDataFromOnLine } = useContext(BuilderChatContext);\n  return appDataFromOnLine;\n};\n\nexport const useGetAppDataCombineWithProps = () => {\n  const { appDataCombineWithProps } = useContext(BuilderChatContext);\n  return appDataCombineWithProps;\n};\n\nexport const useSetAppDataFromOnLine = () => {\n  const { setAppDataFromOnLine } = useContext(BuilderChatContext);\n  return setAppDataFromOnLine;\n};\nexport const useUpdateAppDataCombineWithProps = (props: IBuilderChatProps) => {\n  const { appDataFromOnLine, setAppDataCombineWithProps } =\n    useContext(BuilderChatContext);\n  useUpdateEffect(() => {\n    if (appDataFromOnLine) {\n      const formatAPPInfo = combineAppDataWithProps(appDataFromOnLine, props);\n      setAppDataCombineWithProps?.(formatAPPInfo);\n    }\n  }, [appDataFromOnLine, props]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useRef } from 'react';\n\nimport { type CozeAPI } from '@coze/api';\n\nimport { type OpenRequestInit } from '@/types/props';\n\nimport { type IBuilderChatProps } from '../type';\nimport { combineAppDataWithProps, getBotInfo } from '../services/get-bot-info';\nimport { createOrGetConversation } from '../services/create-conversation';\nimport { useSetAppDataFromOnLine } from '../context/builder-chat-context';\n\n// conversationIdsectionId \nexport const useRequestInit = (props: IBuilderChatProps) => {\n  const refProps = useRef(props);\n  refProps.current = props;\n  const setAppDataFromOnLine = useSetAppDataFromOnLine();\n\n  const openRequestInit = useCallback(\n    async (apiSdk?: CozeAPI): Promise<OpenRequestInit> => {\n      const getBotInfoPrm = getBotInfo(apiSdk || undefined, refProps.current);\n      const createOrGetConversationPrm = createOrGetConversation(\n        apiSdk || undefined,\n        refProps.current,\n      );\n      const botInfo = await getBotInfoPrm;\n      const conversationInfo = await createOrGetConversationPrm;\n\n      setAppDataFromOnLine?.(botInfo || null);\n      const formatAPPInfo = combineAppDataWithProps(botInfo, refProps.current);\n      return {\n        ...formatAPPInfo,\n        ...conversationInfo,\n        isCustomBackground: !!formatAPPInfo.customBgInfo?.imgUrl,\n        isBuilderChat: true,\n      };\n    },\n    [],\n  );\n  return openRequestInit;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useUpdateEffect } from 'ahooks';\nimport { useChatArea } from '@coze-common/chat-area';\n\nimport { useGetAppDataCombineWithProps } from '../context/builder-chat-context';\n\n// conversationIdsectionId \nexport const useOnboardingUpdate = () => {\n  const { partialUpdateOnboardingData } = useChatArea();\n  const appInfoResult = useGetAppDataCombineWithProps();\n\n  useUpdateEffect(() => {\n    partialUpdateOnboardingData(\n      appInfoResult?.prologue,\n      appInfoResult?.onboardingSuggestions,\n    );\n  }, [appInfoResult?.prologue, appInfoResult?.onboardingSuggestions]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { useUpdateEffect } from 'ahooks';\nimport { patPermissionApi } from '@coze-arch/bot-api';\n\nimport { type StudioChatProviderProps } from '@/types/props';\nimport { OpenApiSource } from '@/types/open';\nimport { AuthType } from '@/types/client';\n\nimport { type IBuilderChatProps } from '../type';\nimport { getConnectorId } from '../helper/get-connector-id';\n\nconst getToken = async () => {\n  try {\n    const res = await patPermissionApi.ImpersonateCozeUser({});\n    return res.data?.access_token ?? '';\n  } catch (_err) {\n    return '';\n  }\n};\nconst checkParam = (props: IBuilderChatProps) => {\n  let error: Error | undefined;\n  if (props?.project?.type === 'bot') {\n    if (props?.project?.mode !== 'draft') {\n      error = new Error('mode must be draft when project type is bot');\n    }\n  } else {\n    if (props?.auth?.type !== 'internal') {\n      if (!props?.auth?.token) {\n        error = new Error('token is required when auth type is not internal');\n      }\n    }\n  }\n  return error;\n};\n\n// botId  token\nexport const useInitChat = (\n  props: IBuilderChatProps,\n): {\n  chatProps?: StudioChatProviderProps;\n  hasReady: boolean;\n  error: Error | null;\n  refresh: () => void;\n} => {\n  const [hasReady, setHasReady] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [chatProps, setChatProps] = useState<StudioChatProviderProps>();\n  const { project: projectInfo, userInfo } = props;\n\n  useEffect(() => {\n    if (error || hasReady) {\n      return;\n    }\n    const errorTemp = checkParam(props);\n    if (errorTemp) {\n      setError(errorTemp);\n      return;\n    }\n    (async () => {\n      let token = props.auth?.token;\n      let refreshToken = props.auth?.refreshToken;\n      if (props.auth?.type === 'internal') {\n        token = await getToken();\n        refreshToken = getToken;\n      }\n\n      if (token) {\n        setChatProps({\n          chatConfig: {\n            bot_id: projectInfo.id,\n            auth: {\n              type: AuthType.TOKEN,\n              token,\n              onRefreshToken: refreshToken,\n              connectorId: getConnectorId(props),\n            },\n            ui: {\n              base: {\n                layout: projectInfo.layout,\n              },\n              chatBot: {\n                uploadable: props.areaUi.uploadable,\n                isNeedClearContext: props.areaUi.isNeedClearContext,\n                isNeedClearMessage: props.areaUi.isNeedClearMessage,\n                isNeedAddNewConversation:\n                  props.areaUi.isNeedAddNewConversation ?? false, // false\n                isNeedAudio: props.areaUi.input?.isNeedAudio ?? !IS_OVERSEA,\n                isNeedQuote: props.areaUi.isNeedQuote ?? false, // false\n                isNeedFunctionCallMessage:\n                  props.areaUi.isNeedFunctionCallMessage,\n                feedback: props.areaUi.feedback,\n              },\n            },\n            conversation_id: '', // \n            source: OpenApiSource.ChatFlow,\n          },\n          layout: projectInfo.layout,\n          userInfo: {\n            id: nanoid(),\n            url: '',\n            nickname: '',\n            ...(userInfo || {}),\n          },\n        });\n        setHasReady(true);\n      } else {\n        setError(new Error('token is empty'));\n      }\n    })();\n  }, [error, hasReady]);\n  useUpdateEffect(() => {\n    setHasReady(false);\n    setError(null);\n  }, [\n    projectInfo?.id,\n    projectInfo?.type,\n    projectInfo?.conversationName,\n    projectInfo?.conversationId,\n    projectInfo?.mode,\n    projectInfo?.conversationId,\n    props?.workflow?.id,\n  ]);\n\n  if (chatProps) {\n    chatProps.chatConfig.ui = chatProps.chatConfig.ui || {};\n    chatProps.chatConfig.ui.chatBot = chatProps.chatConfig.ui.chatBot || {};\n    chatProps.chatConfig.ui.chatBot.isNeedClearMessage =\n      props?.areaUi?.isNeedClearMessage;\n    chatProps.chatConfig.ui.chatBot.uploadable = props.areaUi?.uploadable;\n    chatProps.chatConfig.ui.chatBot.feedback = props.areaUi?.feedback;\n  }\n  return {\n    hasReady,\n    chatProps,\n    error,\n    refresh: () => {\n      setError(null);\n      setHasReady(false);\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useRef } from 'react';\n\nimport {\n  RequestScene,\n  type RequestManagerOptions,\n} from '@coze-common/chat-core';\n\nimport { openApiHostByRegionWithToken } from '@/util/env';\n\nimport { type IBuilderChatProps } from '../type';\nimport { getConnectorId } from '../helper/get-connector-id';\nimport { useGetAppDataCombineWithProps } from '../context/builder-chat-context';\n\nexport const useCoreManager = (\n  props: IBuilderChatProps,\n): RequestManagerOptions => {\n  const refProps = useRef(props);\n  const appData = useGetAppDataCombineWithProps();\n  const refAppData = useRef(appData);\n  refProps.current = props;\n  refAppData.current = appData;\n  return useMemo(\n    () => ({\n      scenes: {\n        [RequestScene.SendMessage]: {\n          hooks: {\n            onBeforeSendMessage: [\n              requestConfig => {\n                const { body } = requestConfig;\n\n                const bodyDataOld = JSON.parse(body);\n                const bodyData: Record<string, unknown> = {};\n                bodyData.additional_messages =\n                  bodyDataOld.additional_messages || [];\n                bodyData.connector_id = bodyDataOld.connector_id;\n                bodyData.workflow_id = refProps?.current?.workflow?.id;\n                bodyData.parameters = refProps?.current?.workflow?.parameters;\n                bodyData.version =\n                  refProps?.current?.project?.version || undefined;\n                bodyData.execute_mode =\n                  refProps?.current?.project?.mode === 'draft'\n                    ? 'DEBUG'\n                    : undefined;\n                bodyData.app_id =\n                  refProps?.current?.project?.type === 'app'\n                    ? refProps?.current?.project?.id\n                    : undefined;\n                bodyData.bot_id =\n                  refProps?.current?.project?.type === 'bot'\n                    ? refProps?.current?.project?.id\n                    : undefined;\n                bodyData.conversation_id = new URL(\n                  requestConfig.url,\n                ).searchParams.get('conversation_id');\n                bodyData.connector_id = getConnectorId(refProps?.current);\n                bodyData.ext = {\n                  _caller: refProps?.current?.project?.caller,\n                  user_id: bodyDataOld.user_id,\n                };\n                bodyData.suggest_reply_info = refAppData.current\n                  ?.suggestPromoteInfo\n                  ? {\n                      suggest_reply_mode:\n                        refAppData.current?.suggestPromoteInfo\n                          ?.suggestReplyMode,\n                      customized_suggest_prompt:\n                        refAppData.current?.suggestPromoteInfo\n                          ?.customizedSuggestPrompt,\n                    }\n                  : undefined;\n                requestConfig.body = JSON.stringify(bodyData);\n                requestConfig.url = `${openApiHostByRegionWithToken}/v1/workflows/chat`;\n                requestConfig.headers.push(\n                  ...Object.entries(refProps.current?.workflow?.header || {}),\n                );\n\n                return {\n                  ...requestConfig,\n                };\n              },\n            ],\n          },\n        },\n        [RequestScene.ClearHistory]: {\n          hooks: {\n            onBeforeRequest: [\n              requestConfig => {\n                if (props?.project?.type === 'bot') {\n                  requestConfig.data = {\n                    connector_id: getConnectorId(props),\n                  };\n                } else {\n                  requestConfig.data = {\n                    app_id: refProps?.current.project?.id,\n                    conversation_name:\n                      refProps?.current?.project?.conversationName,\n                    get_or_create: false,\n                    workflow_id: refProps?.current?.workflow?.id,\n                    draft_mode: refProps?.current?.project?.mode === 'draft',\n                    connector_id: getConnectorId(props),\n                  };\n                }\n\n                return {\n                  ...requestConfig,\n                };\n              },\n            ],\n          },\n        },\n      },\n    }),\n    [],\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useUpdateEffect } from 'ahooks';\nimport { useBotInfo, useChatArea } from '@coze-common/chat-area';\n\nimport { useGetAppDataCombineWithProps } from '../context/builder-chat-context';\n\n// conversationIdsectionId \nexport const useBotAndUserUpdate = () => {\n  const { updateBotInfo } = useBotInfo();\n  const { recordBotInfo } = useChatArea();\n  const appInfoResult = useGetAppDataCombineWithProps();\n  useUpdateEffect(() => {\n    const id = appInfoResult?.botInfo?.id || '';\n    recordBotInfo({\n      name: appInfoResult?.botInfo?.nickname || '',\n      avatar: appInfoResult?.botInfo?.url || '',\n    });\n    updateBotInfo(() => ({\n      [id]: {\n        url: appInfoResult?.botInfo?.url || '',\n        nickname: appInfoResult?.botInfo?.nickname || '',\n        id: appInfoResult?.botInfo?.id || '',\n        allowMention: false,\n      },\n    }));\n  }, [\n    appInfoResult?.botInfo?.nickname,\n    appInfoResult?.botInfo?.url,\n    appInfoResult?.botInfo?.id,\n  ]);\n};\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useRef } from 'react';\n\nimport styles from './index.module.less';\n\nexport const Background: FC<{\n  bgInfo?: {\n    imgUrl: string;\n    themeColor: string; // \n  };\n}> = props => {\n  const targetRef = useRef(null);\n  const { bgInfo } = props;\n\n  if (!bgInfo || !bgInfo?.imgUrl) {\n    return null;\n  }\n  const { themeColor = 'transparent', imgUrl } = bgInfo;\n\n  return (\n    <div\n      ref={targetRef}\n      className={styles['bg-image']}\n      style={{\n        backgroundColor: themeColor,\n      }}\n    >\n      <div className={styles.mask} />\n      <div className={styles['img-container']}>\n        {imgUrl ? <img src={imgUrl} className={styles.img} /> : null}\n      </div>\n    </div>\n  );\n};\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type PropsWithChildren } from 'react';\n\nimport { type IBuilderChatProps } from '../../type';\n\nimport styles from './index.module.less';\nconst LabelValue: FC<PropsWithChildren<{ label: string }>> = ({\n  label,\n  children,\n}) => (\n  <div className={styles['label-value']}>\n    <div className={styles.label}>{label}:</div>\n    <div className={styles.value}>{children}</div>\n  </div>\n);\n\nexport const AuditPanel: FC<IBuilderChatProps> = props => (\n  <div className={styles.container}>\n    <LabelValue label=\"Bot\">{props?.project?.name}</LabelValue>\n    <LabelValue label=\"BotIcon\">\n      <img src={props?.project?.iconUrl} className={styles.img} />\n    </LabelValue>\n    <LabelValue label=\"\">\n      {props?.project?.onBoarding?.prologue}\n    </LabelValue>\n    <LabelValue label=\"\">\n      {(props?.project?.onBoarding?.suggestions || []).map((item, index) => (\n        <div key={`${index}`}>{item}</div>\n      ))}\n    </LabelValue>\n    <LabelValue label=\"\">{props?.userInfo?.nickname}</LabelValue>\n    <LabelValue label=\"\">\n      <img src={props?.userInfo?.url} className={styles.img} />\n    </LabelValue>\n    <LabelValue label=\"placholder\">\n      {props?.areaUi?.input?.placeholder}{' '}\n    </LabelValue>\n    <LabelValue label=\"\">\n      {props?.areaUi?.input?.defaultText}{' '}\n    </LabelValue>\n  </div>\n);\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  type FC,\n  forwardRef,\n  type Ref,\n  useRef,\n  type PropsWithChildren,\n  useState,\n  memo,\n} from 'react';\n\nimport cls from 'classnames';\nimport { type InputController } from '@coze-common/chat-uikit-shared';\nimport { ContentType } from '@coze-common/chat-core/message/types';\nimport {\n  useSendTextMessage,\n  useSendNormalizedMessage,\n} from '@coze-common/chat-area/hooks/messages/use-send-message';\nimport { useClearContext } from '@coze-common/chat-area/hooks/messages/use-clear-context';\nimport { useInitStatus } from '@coze-common/chat-area/hooks/context/use-init-status';\nimport { I18n } from '@coze-arch/i18n';\n\nimport type { StudioChatProviderProps } from '@/types/props';\nimport { Layout } from '@/types/client';\nimport { useGetTheme } from '@/components/studio-open-chat/hooks/use-get-theme';\nimport {\n  OpenChatProvider,\n  StudioChatArea,\n} from '@/components/studio-open-chat';\nimport { Loading } from '@/components/loading';\nimport { ChatHeader } from '@/components/header';\nimport ChatFooter from '@/components/footer';\nimport ErrorFallback, {\n  type InitErrorFallback,\n} from '@/components/error-fallback';\nimport { ErrorBoundary } from '@/components/error-boundary';\n\nimport {\n  type IBuilderChatProps,\n  type MessageType,\n  type BuilderChatRef,\n} from './type';\nimport { getBuilderEventCallbackPlugin } from './plugins/event-callback';\nimport { useRequestInit } from './hooks/use-request-init';\nimport { useOnboardingUpdate } from './hooks/use-on-boarding-update';\nimport { useInitChat } from './hooks/use-init-chat';\nimport { useCoreManager } from './hooks/use-core-manager';\nimport { useBotAndUserUpdate } from './hooks/use-bot-user-update';\nimport { type InitData } from './data-type';\nimport {\n  BuilderChatProvider,\n  useGetAppDataCombineWithProps,\n  useUpdateAppDataCombineWithProps,\n} from './context/builder-chat-context';\nimport { Background } from './components/background';\nimport { AuditPanel } from './components/audit-panel';\n\nimport styles from './index.module.less';\n\nexport { type BuilderChatRef };\n\nexport const BuilderChatContent = forwardRef(\n  (\n    {\n      uiBuilderProps,\n      chatProps,\n    }: {\n      chatProps: StudioChatProviderProps;\n      uiBuilderProps: IBuilderChatProps;\n    },\n    ref: Ref<BuilderChatRef>,\n  ) => {\n    const refHasInitController = useRef(false);\n    const refInputController = useRef<InputController>();\n    const { areaUi } = uiBuilderProps;\n    const handleClearContext = useClearContext();\n    const sendMessage = useSendNormalizedMessage();\n    const sendTextMessage = useSendTextMessage();\n    useOnboardingUpdate();\n    useBotAndUserUpdate();\n    useImperativeHandle(\n      ref,\n      () => ({\n        sendMessage: (message: MessageType) => {\n          if (message.type === ContentType.Text) {\n            sendTextMessage({ text: message.text, mentionList: [] }, 'other');\n          } else if (message.type === ContentType.Image) {\n            sendMessage(\n              {\n                payload: {\n                  contentType: ContentType.Image,\n                  contentObj: {\n                    image_list: [message.value],\n                  },\n                  mention_list: [],\n                },\n              },\n              'other',\n            );\n          } else if (message.type === 'file') {\n            sendMessage(\n              {\n                payload: {\n                  contentType: ContentType.File,\n                  contentObj: {\n                    file_list: [message.value],\n                  },\n                  mention_list: [],\n                },\n              },\n              'other',\n            );\n          }\n        },\n        clearContext: () => {\n          handleClearContext?.();\n        },\n      }),\n      [handleClearContext, sendTextMessage, sendMessage],\n    );\n    useEffect(() => {\n      refInputController.current?.setInputText?.(\n        areaUi?.input?.defaultText || '',\n      );\n    }, [areaUi?.input?.defaultText]);\n    const renderChatInputTopSlot = areaUi?.input?.renderChatInputTopSlot\n      ? () => areaUi?.input?.renderChatInputTopSlot?.(false)\n      : undefined;\n    const isMobile = uiBuilderProps.project?.layout === Layout.MOBILE;\n    const theme = useGetTheme();\n    const { header } = uiBuilderProps.areaUi || {};\n\n    return (\n      <StudioChatArea\n        {...chatProps}\n        {...(areaUi || {})}\n        coreAreaClassName={styles['core-area']}\n        inputPlaceholder={\n          areaUi?.input?.placeholder || I18n.t('chatInputPlaceholder')\n        }\n        messageMaxWidth={\n          uiBuilderProps?.project?.mode !== 'websdk' ? '600px' : undefined\n        }\n        enableMultimodalUpload={true}\n        showInputArea={areaUi?.input?.isShow}\n        messageGroupListClassName={styles['scroll-view']}\n        renderChatInputTopSlot={renderChatInputTopSlot}\n        isShowClearContextDivider={true}\n        headerNode={\n          <ChatHeader\n            title={header?.title || ''}\n            iconUrl={header?.icon}\n            extra={header?.extra}\n            theme={theme}\n            isMobile={isMobile}\n            isShowConversations={false} // app \n            isShowHeader={header?.isShow}\n          />\n        }\n        isMiniScreen={areaUi?.uiTheme === 'chatFlow' ? true : false}\n        inputNativeCallbacks={{\n          getController: inputControllerIn => {\n            refInputController.current = inputControllerIn;\n            if (!refHasInitController.current) {\n              refInputController.current?.setInputText?.(\n                areaUi?.input?.defaultText || '',\n              );\n              refHasInitController.current = true;\n            }\n          },\n        }}\n      />\n    );\n  },\n);\n\nconst getErrorCallbackComp =\n  (props: IBuilderChatProps & { refresh: () => void }): FC<InitErrorFallback> =>\n  ({ error, onBeforeRetry }) => (\n    <>\n      <ErrorFallback\n        error={error}\n        onBeforeRetry={onBeforeRetry}\n        refresh={props.refresh}\n      />\n      {props.areaUi?.input?.renderChatInputTopSlot?.(true)}\n    </>\n  );\nconst BuilderChatWrap: FC<PropsWithChildren<IBuilderChatProps>> = ({\n  children,\n  ...props\n}) => {\n  const initStatus = useInitStatus();\n  const theme = useGetTheme();\n  const { footer } = props.areaUi || {};\n  const isMobile = props.project?.layout === Layout.MOBILE;\n  const appInfoResult = useGetAppDataCombineWithProps();\n\n  const footerConfig = {\n    ...(footer || {\n      expressionText: '',\n    }),\n  };\n\n  if (props.project?.mode !== 'websdk') {\n    if (!footerConfig.expressionText) {\n      footerConfig.expressionText = I18n.t('chat_GenAI_tips');\n    }\n  }\n  if (initStatus !== 'initSuccess') {\n    return props?.areaUi?.renderLoading?.() || <Loading />;\n  }\n  return (\n    <div\n      className={cls(styles.content, {\n        [styles.mobile]: isMobile,\n        [styles['bg-theme']]: theme === 'bg-theme',\n      })}\n      style={props.style}\n    >\n      <div\n        className={cls(styles.area, {\n          [styles['chat-flow-area']]: props.areaUi?.uiTheme === 'chatFlow',\n          [styles['chat-ui-builder']]: props.areaUi?.uiTheme === 'uiBuilder',\n        })}\n      >\n        <Background bgInfo={appInfoResult?.customBgInfo} />\n        {children}\n      </div>\n      <ChatFooter {...footerConfig} theme={theme} />\n    </div>\n  );\n};\nconst BuilderChatContainer = memo(\n  forwardRef((props: IBuilderChatProps, ref: Ref<BuilderChatRef>) => {\n    const { chatProps, hasReady, error, refresh } = useInitChat(props);\n    const openRequestInit = useRequestInit(props);\n\n    const builderEventCallbackPlugin = getBuilderEventCallbackPlugin({\n      eventCallbacks: props.eventCallbacks,\n    });\n    const appInfoResult = useGetAppDataCombineWithProps();\n    useUpdateAppDataCombineWithProps(props);\n    const plugins = [builderEventCallbackPlugin];\n\n    const requestManagerOptions = useCoreManager(props);\n\n    const userInfo = useMemo(\n      () => ({\n        url: '',\n        nickname: '',\n        ...(props.userInfo || {}),\n        id: props?.userInfo?.id || chatProps?.userInfo?.id || '',\n      }),\n      [props?.userInfo, chatProps],\n    );\n    const ErrorFallbackComp = getErrorCallbackComp({ ...props, refresh });\n    if (props?.project?.mode === 'audit') {\n      return <AuditPanel {...props} />;\n    }\n    if (error) {\n      return <ErrorFallbackComp error={null} refresh={refresh} />;\n    }\n    if (!chatProps || !hasReady) {\n      return props?.areaUi?.renderLoading?.() || <Loading />;\n    }\n    const isCustomBackground = !!appInfoResult?.customBgInfo?.imgUrl || false;\n    console.log(\n      '[result] isCustomBackground:',\n      isCustomBackground,\n      appInfoResult?.customBgInfo,\n    );\n\n    return (\n      <OpenChatProvider\n        {...chatProps}\n        userInfo={userInfo}\n        openRequestInit={openRequestInit}\n        plugins={plugins}\n        requestManagerOptions={requestManagerOptions}\n        initErrorFallbackFC={ErrorFallbackComp}\n        onImageClick={props.eventCallbacks?.onImageClick}\n        debug={props.debug}\n        isCustomBackground={isCustomBackground}\n        onThemeChange={props?.eventCallbacks?.onThemeChange}\n        readonly={props?.areaUi?.isDisabled}\n        spaceId={props?.spaceId}\n      >\n        <BuilderChatWrap {...props}>\n          <BuilderChatContent\n            ref={ref}\n            uiBuilderProps={props}\n            chatProps={chatProps}\n          />\n        </BuilderChatWrap>\n      </OpenChatProvider>\n    );\n  }),\n);\nexport const BuilderChatWeb = forwardRef(\n  (props: IBuilderChatProps, ref: Ref<BuilderChatRef>) => {\n    const [appDataFromOnLine, setAppDataFromOnLine] = useState<InitData | null>(\n      null,\n    );\n    const [appDataCombineWithProps, setAppDataCombineWithProps] =\n      useState<InitData | null>(null);\n\n    return (\n      <ErrorBoundary>\n        <BuilderChatProvider\n          {...{\n            appDataFromOnLine,\n            setAppDataFromOnLine,\n            appDataCombineWithProps,\n            setAppDataCombineWithProps,\n          }}\n        >\n          <BuilderChatContainer ref={ref} {...props} />\n        </BuilderChatProvider>\n      </ErrorBoundary>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n//import { TaroBuilderChat } from './taro-chat';\nimport { BuilderChatWeb } from './coze-chat';\nexport type {\n  BuilderChatRef,\n  IWorkflow,\n  IProject,\n  IBuilderChatProps,\n} from './type';\n\nexport const BuilderChat = BuilderChatWeb;\n","\n      import API from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport cs from 'classnames';\nimport { useInitStatus } from '@coze-common/chat-area';\n\nimport { webSdkDefaultConnectorId } from '@/util';\nimport {\n  type StudioChatProviderProps,\n  type WebSdkChatProps,\n} from '@/types/props';\nimport { OpenApiSource } from '@/types/open';\nimport { ChatType, Layout } from '@/types/client';\nimport { useGetTheme } from '@/components/studio-open-chat/hooks/use-get-theme';\nimport {\n  OpenChatProvider,\n  StudioChatArea,\n} from '@/components/studio-open-chat';\nimport { Loading } from '@/components/loading';\nimport { ChatHeader } from '@/components/header';\nimport ChatFooter from '@/components/footer';\nimport ErrorFallback from '@/components/error-fallback';\nimport { ErrorBoundary } from '@/components/error-boundary';\n\nimport styles from './index.module.less';\n\nexport const WebSdkChat: FC<WebSdkChatProps> = ({\n  useInIframe = true,\n  ...props\n}) => {\n  const { chatConfig } = props ?? {};\n  if (!chatConfig?.bot_id) {\n    return null;\n  }\n  if (chatConfig.auth) {\n    chatConfig.auth.connectorId =\n      chatConfig.auth.connectorId || webSdkDefaultConnectorId;\n  }\n  return <CozeChat {...props} useInIframe={useInIframe} />;\n};\n\nconst CozeChat: FC<WebSdkChatProps> = props => {\n  const {\n    layout,\n    className,\n    useInIframe = false,\n    chatConfig,\n    userInfo,\n    style,\n    onImageClick,\n    onThemeChange,\n  } = props;\n  if (!chatConfig.ui) {\n    chatConfig.ui = {};\n  }\n  if (!chatConfig.ui.chatBot) {\n    chatConfig.ui.chatBot = {};\n  }\n  if (chatConfig.auth?.type === 'token') {\n    chatConfig.ui.chatBot.isNeedClearMessage = false;\n    // chatConfig.ui.chatBot.isNeedAddNewConversation \n    chatConfig.ui.chatBot.isNeedAddNewConversation =\n      chatConfig.ui.chatBot.isNeedAddNewConversation ?? true;\n    chatConfig.ui.chatBot.isNeedClearContext =\n      chatConfig.ui.chatBot.isNeedClearContext ?? true;\n  } else {\n    // \n    chatConfig.ui.chatBot.isNeedClearMessage = true;\n    chatConfig.ui.chatBot.isNeedAddNewConversation = false;\n    chatConfig.ui.chatBot.isNeedClearContext = false;\n  }\n\n  const chatProps: StudioChatProviderProps = {\n    chatConfig: {\n      ...chatConfig,\n      source: OpenApiSource.WebSdk,\n    },\n    layout,\n    userInfo,\n    initErrorFallbackFC: ErrorFallback,\n    onImageClick,\n  };\n\n  return (\n    <ErrorBoundary>\n      <div\n        className={cs(\n          styles.cozeChatApp,\n          !useInIframe && styles.bordered,\n          className,\n        )}\n        style={style}\n      >\n        <OpenChatProvider {...chatProps} onThemeChange={onThemeChange}>\n          <WebSdkChatArea chatProps={chatProps} webSdkProps={props} />\n        </OpenChatProvider>\n      </div>\n    </ErrorBoundary>\n  );\n};\n\nconst WebSdkChatArea: FC<{\n  chatProps: StudioChatProviderProps;\n  webSdkProps: WebSdkChatProps;\n}> = ({ chatProps, webSdkProps }) => {\n  const { layout, title, headerExtra, icon, chatConfig } = webSdkProps;\n  const initStatus = useInitStatus();\n  const isMobile = layout === Layout.MOBILE;\n  const { header: headerConf, conversations } = chatConfig?.ui || {};\n  const theme = useGetTheme();\n  const isShowConversations =\n    conversations?.isNeed && chatConfig.type !== ChatType.APP;\n\n  if (initStatus !== 'initSuccess') {\n    return <Loading />;\n  }\n  return (\n    <div className={styles.content}>\n      <StudioChatArea\n        {...chatProps}\n        enableMultimodalUpload={true}\n        headerNode={\n          <ChatHeader\n            title={title}\n            extra={headerExtra}\n            iconUrl={icon}\n            theme={theme}\n            isMobile={isMobile}\n            isShowConversations={isShowConversations}\n            isShowHeader={headerConf?.isShow !== false}\n          />\n        }\n      />\n      <ChatFooter {...(chatConfig?.ui?.footer || {})} theme={theme} />\n    </div>\n  );\n};\n","\n      import API from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/style-loader/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/index.js??ruleSet[1].rules[10].use[1]!builtin:lightningcss-loader??ruleSet[1].rules[10].use[2]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/postcss-loader/index.js??ruleSet[1].rules[10].use[3]!../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+plugin-less@1.1.1_@rsbuild+core@1.1.13/node_modules/@rsbuild/plugin-less/compiled/less-loader/index.js??ruleSet[1].rules[10].use[4]!./index.module.less\";\n       export default content && content.locals ? content.locals : undefined;\n","import * as React from \"react\";\nconst SvgShortcutIconDefault = props => <svg xmlns=\"http://www.w3.org/2000/svg\" width={16} height={16} fill=\"none\" viewBox=\"0 0 16 16\" {...props}><path fill=\"#060709\" fillOpacity={0.3} d=\"M.667 8a7.333 7.333 0 1 0 14.667 0A7.333 7.333 0 0 0 .667 8m11.078 4.688a6 6 0 0 1-8.433-8.433zm.943-.943L4.255 3.312a6 6 0 0 1 8.433 8.433\" /></svg>;\nexport { SvgShortcutIconDefault as ReactComponent };\nexport default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9ImNvel9iYW4iPgo8cGF0aCBpZD0iVW5pb24iIGQ9Ik0wLjY2Njk5MiA4LjAwMDA4QzAuNjY2OTkyIDEyLjA1MDIgMy45NTAyNCAxNS4zMzM0IDguMDAwMzMgMTUuMzMzNEMxMi4wNTA0IDE1LjMzMzQgMTUuMzMzNyAxMi4wNTAyIDE1LjMzMzcgOC4wMDAwOEMxNS4zMzM3IDMuOTQ5OTkgMTIuMDUwNCAwLjY2Njc0OCA4LjAwMDMzIDAuNjY2NzQ4QzMuOTUwMjQgMC42NjY3NDggMC42NjY5OTIgMy45NDk5OSAwLjY2Njk5MiA4LjAwMDA4Wk0xMS43NDUzIDEyLjY4ODFDMTAuNzE4OSAxMy41MDkxIDkuNDE2OTQgMTQuMDAwMSA4LjAwMDMzIDE0LjAwMDFDNC42ODY2MiAxNC4wMDAxIDIuMDAwMzMgMTEuMzEzOCAyLjAwMDMzIDguMDAwMDhDMi4wMDAzMyA2LjU4MzQ2IDIuNDkxMjcgNS4yODE1MSAzLjMxMjI5IDQuMjU1MDhMMTEuNzQ1MyAxMi42ODgxWk0xMi42ODgyIDExLjc0NTNMNC4yNTUwOCAzLjMxMjI1QzUuMjgxNTQgMi40OTExIDYuNTgzNTkgMi4wMDAwOCA4LjAwMDMzIDIuMDAwMDhDMTEuMzE0IDIuMDAwMDggMTQuMDAwMyA0LjY4NjM3IDE0LjAwMDMgOC4wMDAwOEMxNC4wMDAzIDkuNDE2ODEgMTMuNTA5MyAxMC43MTg5IDEyLjY4ODIgMTEuNzQ1M1oiIGZpbGw9IiMwNjA3MDkiIGZpbGwtb3BhY2l0eT0iMC4zIi8+CjwvZz4KPC9zdmc+Cg==\";","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.container-ZlqdDL{flex-direction:column;display:flex}.container-ZlqdDL .icon-container-ZKWWFq{justify-content:space-between;align-items:center;width:100%;padding:4px;display:flex}.container-ZlqdDL .icon-container-ZKWWFq .left-content-yzqflv{flex-shrink:0;align-items:center;gap:4px;display:flex}.container-ZlqdDL .icon-container-ZKWWFq .right-content-eCEyc9{align-items:center;gap:4px;margin-left:8px;display:flex}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container\": `container-ZlqdDL`,\n\t\"icon-container\": `icon-container-ZKWWFq`,\n\t\"iconContainer\": `icon-container-ZKWWFq`,\n\t\"left-content\": `left-content-yzqflv`,\n\t\"leftContent\": `left-content-yzqflv`,\n\t\"right-content\": `right-content-eCEyc9`,\n\t\"rightContent\": `right-content-eCEyc9`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.container-PyPGZJ{border-style:solid;border-width:1px;border-radius:8px;align-items:center;gap:4px;width:100%;height:32px;padding:4px;display:flex;box-shadow:0 2px 8px rgba(0,0,0,.1)}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container\": `container-PyPGZJ`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `@keyframes trigger-config-button-slider-in-u23_nT{0%{opacity:0;transform:translate(30px)}to{opacity:1;transform:translate(0)}}.slide-in-bSKNxI{animation:.5s linear trigger-config-button-slider-in-u23_nT}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"slide-in\": `slide-in-bSKNxI`,\n\t\"slideIn\": `slide-in-bSKNxI`,\n\t\"trigger-config-button-slider-in\": `trigger-config-button-slider-in-u23_nT`,\n\t\"triggerConfigButtonSliderIn\": `trigger-config-button-slider-in-u23_nT`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.frown-upon-container-e7qriC{border:1px solid rgba(10,17,61,.06);flex-direction:column;width:100%;margin-top:12px;padding:12px;display:flex}.frown-upon-container-e7qriC .header-CqdMLJ{justify-content:space-between;width:100%;margin-bottom:12px;line-height:20px;display:flex}.frown-upon-container-e7qriC .header-CqdMLJ .title-A0VXpN{color:rgba(6,7,9,.96);font-size:14px;font-style:normal;font-weight:600}.frown-upon-container-e7qriC .reasons-Ts7gky{gap:8px;margin-bottom:8px;display:flex}.frown-upon-container-e7qriC .reasons-Ts7gky .item-PJyIoR{cursor:pointer;background-color:rgba(6,7,9,.05);border-radius:6px;padding:8px 16px;font-size:14px;font-style:normal;font-weight:400}.frown-upon-container-e7qriC .reasons-Ts7gky .item-PJyIoR:hover{background-color:rgba(128,138,255,.2)}.frown-upon-container-e7qriC .reasons-Ts7gky .item-PJyIoR.selected-Nbfd_0{background-color:rgba(128,138,255,.4)}.frown-upon-container-e7qriC .textarea-NxEDVd{margin-bottom:12px}.frown-upon-container-e7qriC .footer-mbJE4E{text-align:right}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"frown-upon-container\": `frown-upon-container-e7qriC`,\n\t\"frownUponContainer\": `frown-upon-container-e7qriC`,\n\t\"header\": `header-CqdMLJ`,\n\t\"title\": `title-A0VXpN`,\n\t\"reasons\": `reasons-Ts7gky`,\n\t\"item\": `item-PJyIoR`,\n\t\"selected\": `selected-Nbfd_0`,\n\t\"textarea\": `textarea-NxEDVd`,\n\t\"footer\": `footer-mbJE4E`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.mask-O9yckq{pointer-events:none;z-index:10;background:linear-gradient(rgba(99,99,99,.4) 0%,rgba(99,99,99,0) 100%);width:100%;height:216px;position:absolute}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"mask\": `mask-O9yckq`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.label-EGd0FD{width:-moz-fit-content;width:fit-content;max-width:calc(100 - 16px);margin-bottom:0;padding-right:0;overflow-x:hidden}.label-EGd0FD .semi-form-field-label-text{flex-wrap:nowrap;align-items:center;width:100%;display:flex}.text-jFeyry{font-size:12px;font-weight:500;line-height:18px}.icon-e_5XAg{margin-left:2px;padding:2px}.icon-e_5XAg svg{width:12px;height:12px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"label\": `label-EGd0FD`,\n\t\"text\": `text-jFeyry`,\n\t\"icon\": `icon-e_5XAg`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, ``, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.upload-button-j_N2aN{border-style:dashed;min-width:0;padding:8px}button.delete-btn-AnPfvd{border-radius:6px;height:20px;line-height:1}.delete-icon-mdYMxp svg{width:12px;height:12px}.file-Zr1dqc{padding:3px;position:relative}.file-Zr1dqc *{z-index:1}.file-Zr1dqc:focus{border-color:#4e40e5}.file-uploading-TYAuNW:after{content:\"\";width:var(--var-percent);background-color:#e6e8ff;min-width:15%;height:100%;display:block;position:absolute;top:0;left:0}.container-qVoNiR.container-error-Hv4JUS .upload-button-j_N2aN,.container-qVoNiR.container-error-Hv4JUS .input-UjOMGP,.container-qVoNiR.container-error-Hv4JUS .file-Zr1dqc{border-color:#f22435}.retry-f5xqQB{cursor:pointer;color:#4e40e5;flex-wrap:nowrap;flex-shrink:0;justify-content:flex-start;align-items:center;gap:8px;margin-right:12px;font-size:12px;font-weight:500;line-height:16px;display:flex}.retry-f5xqQB svg{width:12px;height:12px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"upload-button\": `upload-button-j_N2aN`,\n\t\"uploadButton\": `upload-button-j_N2aN`,\n\t\"delete-btn\": `delete-btn-AnPfvd`,\n\t\"deleteBtn\": `delete-btn-AnPfvd`,\n\t\"delete-icon\": `delete-icon-mdYMxp`,\n\t\"deleteIcon\": `delete-icon-mdYMxp`,\n\t\"file\": `file-Zr1dqc`,\n\t\"file-uploading\": `file-uploading-TYAuNW`,\n\t\"fileUploading\": `file-uploading-TYAuNW`,\n\t\"container\": `container-qVoNiR`,\n\t\"container-error\": `container-error-Hv4JUS`,\n\t\"containerError\": `container-error-Hv4JUS`,\n\t\"input\": `input-UjOMGP`,\n\t\"retry\": `retry-f5xqQB`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.shortcut-bar-GBIFuC{justify-content:center;display:flex;position:relative}.shortcut-bar-GBIFuC .semi-portal-inner{width:100%;min-width:100%;max-width:100%}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"shortcut-bar\": `shortcut-bar-GBIFuC`,\n\t\"shortcutBar\": `shortcut-bar-GBIFuC`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.shortcut-template-elqd1g{background:#fff;border:1px solid #4e40e5;border-radius:24px;margin:0 24px 36px}.template-icon-GeCg8R{margin-right:4px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"shortcut-template\": `shortcut-template-elqd1g`,\n\t\"shortcutTemplate\": `shortcut-template-elqd1g`,\n\t\"template-icon\": `template-icon-GeCg8R`,\n\t\"templateIcon\": `template-icon-GeCg8R`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.upload-content-JO3W6X .semi-checkbox-content{flex:0 auto}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"upload-content\": `upload-content-JO3W6X`,\n\t\"uploadContent\": `upload-content-JO3W6X`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.table-ZYZeGN{border:1px solid var(--coz-stroke-primary);border-radius:8px;padding:0 12px}.table-ZYZeGN .semi-table-placeholder{border-bottom:0}.table-ZYZeGN .semi-form-field{padding:4px 0}.table-ZYZeGN .semi-table-tbody tr:first-child td{padding-top:8px}.table-ZYZeGN .semi-table-tbody tr:last-child td{padding-bottom:12px}.empty-zuidnN{color:var(--coz-fg-dim);text-align:left}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"table\": `table-ZYZeGN`,\n\t\"empty\": `empty-zuidnN`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.btn-X0DO7p .semi-icon{color:var(--coz-fg-secondary)}.btn-X0DO7p button{padding:2px 8px}.btn-X0DO7p .semi-button-content-right{color:var(--coz-fg-secondary);margin-left:4px;font-weight:500}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"btn\": `btn-X0DO7p`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.shortcut-command-x7FRSg{margin-right:10px}.shortcut-button-LeKg4K{box-sizing:border-box;border-radius:99px;height:32px;padding:4px 12px;font-size:14px;font-style:normal;font-weight:400;line-height:16px;min-width:unset!important}.shortcut-button-LeKg4K .semi-button-content-left{margin-right:0}.shortcut-white-wiNLQs .shortcut-button-LeKg4K{-webkit-backdrop-filter:blur(3.45px);backdrop-filter:blur(3.45px);border:1px solid var(--coz-stroke-primary);background-color:rgba(6,7,9,.04);color:rgba(6,7,9,.8)!important}.shortcut-white-wiNLQs .shortcut-button-LeKg4K:hover{background:linear-gradient(0deg,rgba(0,0,0,.06) 0%,rgba(0,0,0,.06) 100%),var(--coz-bg-primary);border:1px solid var(--coz-stroke-primary)}.shortcut-blur-rU8W5q .shortcut-button-LeKg4K{color:var(--coze-fg-image-bots,rgba(6,7,9,.8));background-color:var(--coze-bg-image-bots,rgba(249,249,249,.8));-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid var(--coze-stroke-image-bots,rgba(6,7,9,.1));border-radius:12px}.shortcut-blur-rU8W5q .shortcut-button-LeKg4K:hover{border:1px solid var(--coze-stroke-image-bots,rgba(6,7,9,.1));background:rgba(224,224,224,.6)}.shortcut-blur-rU8W5q .shortcut-button-LeKg4K .semi-typography{color:rgba(255,255,255,.79)}.load-more-shortcut-wrapper-AJfy38{position:relative}.load-more-shortcut-wrapper-AJfy38 .load-more-button-RrtRtC{border-radius:12px;justify-content:center;align-items:center;gap:4px;height:32px;padding:4px 12px;display:flex}.load-more-list-FCD1Es::-webkit-scrollbar-thumb{background:rgba(29,28,35,.3);border-radius:3px}.load-more-list-FCD1Es::-webkit-scrollbar{background:0 0;width:6px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"shortcut-command\": `shortcut-command-x7FRSg`,\n\t\"shortcutCommand\": `shortcut-command-x7FRSg`,\n\t\"shortcut-button\": `shortcut-button-LeKg4K`,\n\t\"shortcutButton\": `shortcut-button-LeKg4K`,\n\t\"shortcut-white\": `shortcut-white-wiNLQs`,\n\t\"shortcutWhite\": `shortcut-white-wiNLQs`,\n\t\"shortcut-blur\": `shortcut-blur-rU8W5q`,\n\t\"shortcutBlur\": `shortcut-blur-rU8W5q`,\n\t\"load-more-shortcut-wrapper\": `load-more-shortcut-wrapper-AJfy38`,\n\t\"loadMoreShortcutWrapper\": `load-more-shortcut-wrapper-AJfy38`,\n\t\"load-more-button\": `load-more-button-RrtRtC`,\n\t\"loadMoreButton\": `load-more-button-RrtRtC`,\n\t\"load-more-list\": `load-more-list-FCD1Es`,\n\t\"loadMoreList\": `load-more-list-FCD1Es`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.container-box-shadow-ftVmyf{z-index:1;box-shadow:0 2px 6px rgba(0,0,0,.08),0 4px 12px rgba(0,0,0,.04)}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container-box-shadow\": `container-box-shadow-ftVmyf`,\n\t\"containerBoxShadow\": `container-box-shadow-ftVmyf`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.image-W6L0lo img{-o-object-fit:cover;object-fit:cover;width:100%;height:100%}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"image\": `image-W6L0lo`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.container-qBle38{padding:20px}.container-qBle38 .label-value-Q7qNy_{width:100%;margin-bottom:10px;font-size:14px;display:flex}.container-qBle38 .label-value-Q7qNy_ .label-AfYmFD{width:150px}.container-qBle38 .label-value-Q7qNy_ .value-GRVn_S{flex:1}.container-qBle38 .label-value-Q7qNy_ .img-ai5gLW{max-width:200px;height:auto}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container\": `container-qBle38`,\n\t\"label-value\": `label-value-Q7qNy_`,\n\t\"labelValue\": `label-value-Q7qNy_`,\n\t\"label\": `label-AfYmFD`,\n\t\"value\": `value-GRVn_S`,\n\t\"img\": `img-ai5gLW`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.bg-image-n2I6TI{z-index:0;box-sizing:border-box;width:100%;height:100%;position:absolute;top:0;left:0;overflow:hidden}.bg-image-n2I6TI .mask-dxGRY4{z-index:3;background-color:rgba(0,0,0,.12);width:100%;height:100%;position:absolute;top:0;left:0}.bg-image-n2I6TI .mask-dxGRY4:after{content:\"\";z-index:10;background:linear-gradient(rgba(99,99,99,.4),rgba(99,99,99,0));width:100%;height:216px;display:block;position:relative}.bg-image-n2I6TI .img-container-IBtg0x{z-index:2;width:100%;height:100%;position:relative;left:50%;overflow:hidden;transform:translate(-50%)}.bg-image-n2I6TI .img-NLiMbt{-o-object-fit:cover;object-fit:cover;width:100%;height:100%;position:relative;left:50%;transform:translate(-50%)}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"bg-image\": `bg-image-n2I6TI`,\n\t\"bgImage\": `bg-image-n2I6TI`,\n\t\"mask\": `mask-dxGRY4`,\n\t\"img-container\": `img-container-IBtg0x`,\n\t\"imgContainer\": `img-container-IBtg0x`,\n\t\"img\": `img-NLiMbt`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.content-qwJhfi{flex-direction:column;width:100%;height:100%;display:flex;position:relative;overflow:hidden}.content-qwJhfi .semi-upload-hidden-input{display:none}.content-qwJhfi .semi-upload-hidden-input-replace{display:none}.content-qwJhfi .-translate-x-1\\\\/2{--tw-translate-x:-50%}.content-qwJhfi .-translate-y-1\\\\/2{--tw-translate-y:-50%}.content-qwJhfi .area-q60DKJ{flex:1;overflow:hidden}.content-qwJhfi .area-q60DKJ .loading-wrap-U8e8HA{width:100%;height:100%}.content-qwJhfi .area-q60DKJ.chat-flow-area-ONrKTy{margin:0 -12px}.content-qwJhfi .area-q60DKJ.chat-flow-area-ONrKTy .loading-wrap-U8e8HA{margin:0 12px}.content-qwJhfi .scroll-view-PwFV47{padding-left:0;padding-right:0}.content-qwJhfi .chat-uikit-card-content{min-width:auto}.content-qwJhfi .footer-AuhQsp{background:0 0;width:100%;position:absolute;bottom:2px}.content-qwJhfi .footer-AuhQsp .footer-text-a23yTn{color:rgba(48,59,94,.47);font-size:12px;font-style:normal;font-weight:400;line-height:16px}.content-qwJhfi.bg-theme-WwKnEd .footer-AuhQsp .footer-text-a23yTn{color:rgba(255,255,255,.6)}.content-qwJhfi.mobile-smqdlM .scroll-view-PwFV47{padding:0 12px}.content-qwJhfi.mobile-smqdlM .footer-AuhQsp{position:relative}.content-qwJhfi.mobile-smqdlM .chat-ui-builder-empNuf .core-area-jUeqiX{width:100%}.chat-slot-OZ3YhK{padding:0 30px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"content\": `content-qwJhfi`,\n\t\"area\": `area-q60DKJ`,\n\t\"loading-wrap\": `loading-wrap-U8e8HA`,\n\t\"loadingWrap\": `loading-wrap-U8e8HA`,\n\t\"chat-flow-area\": `chat-flow-area-ONrKTy`,\n\t\"chatFlowArea\": `chat-flow-area-ONrKTy`,\n\t\"scroll-view\": `scroll-view-PwFV47`,\n\t\"scrollView\": `scroll-view-PwFV47`,\n\t\"footer\": `footer-AuhQsp`,\n\t\"footer-text\": `footer-text-a23yTn`,\n\t\"footerText\": `footer-text-a23yTn`,\n\t\"bg-theme\": `bg-theme-WwKnEd`,\n\t\"bgTheme\": `bg-theme-WwKnEd`,\n\t\"mobile\": `mobile-smqdlM`,\n\t\"chat-ui-builder\": `chat-ui-builder-empNuf`,\n\t\"chatUiBuilder\": `chat-ui-builder-empNuf`,\n\t\"core-area\": `core-area-jUeqiX`,\n\t\"coreArea\": `core-area-jUeqiX`,\n\t\"chat-slot\": `chat-slot-OZ3YhK`,\n\t\"chatSlot\": `chat-slot-OZ3YhK`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.coze-chat-app-NHE0Hb{box-sizing:border-box;flex-direction:column;display:flex}.coze-chat-app-NHE0Hb *{box-sizing:border-box}.coze-chat-app-NHE0Hb.bordered-drh32r{border-radius:8px;box-shadow:0 6px 8px rgba(29,28,35,.06),0 0 2px rgba(29,28,35,.18)}.coze-chat-app-NHE0Hb .content-VAF6I7{flex:auto;min-height:0}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"coze-chat-app\": `coze-chat-app-NHE0Hb`,\n\t\"cozeChatApp\": `coze-chat-app-NHE0Hb`,\n\t\"bordered\": `bordered-drh32r`,\n\t\"content\": `content-VAF6I7`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.conversation-item-CpzeF6{flex-direction:column;display:flex}.conversation-item-time-kuhu7R{color:var(--coz-fg-secondary);margin-top:4px;padding:8px 8px 0;font-size:14px;font-weight:400;line-height:20px}.conversation-item-content-pivoIn{border-radius:var(--mini,5px);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;align-self:stretch;align-items:center;height:40px;padding:4px 8px;display:flex}.conversation-item-content-active-ZTuJvS{background:var(--coz-mg-secondary-hovered)}.conversation-item-mask-BZYCh1{-webkit-backdrop-filter:blur(2.5px)saturate(1.2);backdrop-filter:blur(2.5px)saturate(1.2);width:100%;height:100%;z-index:calc(var(--chat-z-index-input) + 2);background:rgba(255,255,255,.25);position:fixed;top:0;left:0}.conversation-item-content-touched-ftZGzD{will-change:transform;border:1px solid var(--coz-stroke-primary);animation:.7s cubic-bezier(.4,0,.2,1) jelly-XPC18J}.conversation-item-content-operate-visible-bnVhbI{z-index:calc(var(--chat-z-index-input) + 3);background:var(--coz-bg-max);border:1px solid var(--coz-stroke-primary);box-shadow:0 0 8px 1px rgba(0,0,0,.2)}@keyframes jelly-XPC18J{0%{transform:scale(1)}70%{transform:scale(1.08)}to{transform:scale(1)}}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"conversation-item\": `conversation-item-CpzeF6`,\n\t\"conversationItem\": `conversation-item-CpzeF6`,\n\t\"conversation-item-time\": `conversation-item-time-kuhu7R`,\n\t\"conversationItemTime\": `conversation-item-time-kuhu7R`,\n\t\"conversation-item-content\": `conversation-item-content-pivoIn`,\n\t\"conversationItemContent\": `conversation-item-content-pivoIn`,\n\t\"conversation-item-content-active\": `conversation-item-content-active-ZTuJvS`,\n\t\"conversationItemContentActive\": `conversation-item-content-active-ZTuJvS`,\n\t\"conversation-item-mask\": `conversation-item-mask-BZYCh1`,\n\t\"conversationItemMask\": `conversation-item-mask-BZYCh1`,\n\t\"conversation-item-content-touched\": `conversation-item-content-touched-ftZGzD`,\n\t\"conversationItemContentTouched\": `conversation-item-content-touched-ftZGzD`,\n\t\"jelly\": `jelly-XPC18J`,\n\t\"conversation-item-content-operate-visible\": `conversation-item-content-operate-visible-bnVhbI`,\n\t\"conversationItemContentOperateVisible\": `conversation-item-content-operate-visible-bnVhbI`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.conversation-item-gabqzx{flex-direction:column;display:flex}.conversation-item-time-Rk3IRP{color:var(--coz-fg-secondary);margin-top:4px;padding:8px 8px 0;font-size:14px;font-weight:400;line-height:20px}.conversation-item-content-T8kW0o{border-radius:var(--mini,5px);cursor:pointer;align-self:stretch;align-items:center;height:40px;padding:4px 8px;display:flex}.conversation-item-content-T8kW0o .conversation-operate-gnn5XD{display:none}.conversation-item-content-T8kW0o:hover{background:var(--coz-mg-secondary-hovered)}.conversation-item-content-T8kW0o:hover .conversation-operate-gnn5XD{display:block}.conversation-item-content-active-QSn_hy{background:var(--coz-mg-secondary-hovered)}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"conversation-item\": `conversation-item-gabqzx`,\n\t\"conversationItem\": `conversation-item-gabqzx`,\n\t\"conversation-item-time\": `conversation-item-time-Rk3IRP`,\n\t\"conversationItemTime\": `conversation-item-time-Rk3IRP`,\n\t\"conversation-item-content\": `conversation-item-content-T8kW0o`,\n\t\"conversationItemContent\": `conversation-item-content-T8kW0o`,\n\t\"conversation-operate\": `conversation-operate-gnn5XD`,\n\t\"conversationOperate\": `conversation-operate-gnn5XD`,\n\t\"conversation-item-content-active\": `conversation-item-content-active-QSn_hy`,\n\t\"conversationItemContentActive\": `conversation-item-content-active-QSn_hy`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.conversations-cW0Mcw{flex-direction:column;min-width:320px;height:100%;display:flex}.conversations-header-xkzEom{justify-content:space-between;align-items:center;padding:12px 16px;display:flex}.conversations-header-title-PYl6cp{color:var(--coz-fg-primary);font-size:16px;font-weight:600;line-height:22px}.conversations-create-button-gqS2MX{width:calc(100% - 32px);margin:0 16px}.conversations-list-RdQ6d4{flex-direction:column;flex:1;gap:4px;margin-bottom:10px;display:flex;overflow-y:auto}.conversations-list-group-V4Rq24{flex-direction:column;padding:0 8px;display:flex}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"conversations\": `conversations-cW0Mcw`,\n\t\"conversations-header\": `conversations-header-xkzEom`,\n\t\"conversationsHeader\": `conversations-header-xkzEom`,\n\t\"conversations-header-title\": `conversations-header-title-PYl6cp`,\n\t\"conversationsHeaderTitle\": `conversations-header-title-PYl6cp`,\n\t\"conversations-create-button\": `conversations-create-button-gqS2MX`,\n\t\"conversationsCreateButton\": `conversations-create-button-gqS2MX`,\n\t\"conversations-list\": `conversations-list-RdQ6d4`,\n\t\"conversationsList\": `conversations-list-RdQ6d4`,\n\t\"conversations-list-group\": `conversations-list-group-V4Rq24`,\n\t\"conversationsListGroup\": `conversations-list-group-V4Rq24`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.conversations-container-OGF1vq{width:100%;height:100%;display:flex}.conversations-side-sheet-Ale4fq{z-index:calc(var(--chat-z-index-input) + 1);padding:0}.conversations-list-delete-modal-text-lR2egX{color:var(--coz-fg-secondary);font-size:14px;font-weight:400;line-height:20px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"conversations-container\": `conversations-container-OGF1vq`,\n\t\"conversationsContainer\": `conversations-container-OGF1vq`,\n\t\"conversations-side-sheet\": `conversations-side-sheet-Ale4fq`,\n\t\"conversationsSideSheet\": `conversations-side-sheet-Ale4fq`,\n\t\"conversations-list-delete-modal-text\": `conversations-list-delete-modal-text-lR2egX`,\n\t\"conversationsListDeleteModalText\": `conversations-list-delete-modal-text-lR2egX`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.wrapper-aRUEQ6{flex-direction:column;flex:1;justify-content:center;align-items:center;height:100%;display:flex}.icon-PM1LyT{width:48px;height:48px}.message-b_dQv0{color:rgba(6,7,9,.8);margin-top:10px;font-size:16px;font-weight:500;line-height:22px}.extra-ENlpHa{color:rgba(6,7,9,.3);margin-top:4px;font-size:12px;line-height:16px}.btn-WZwXBA{margin-top:28px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"wrapper\": `wrapper-aRUEQ6`,\n\t\"icon\": `icon-PM1LyT`,\n\t\"message\": `message-b_dQv0`,\n\t\"extra\": `extra-ENlpHa`,\n\t\"btn\": `btn-WZwXBA`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.footer-nP6SsK{z-index:50;background:0 0;flex:none;justify-content:center;align-items:center;width:100%;height:32px;font-size:12px;font-weight:400;display:flex;position:absolute;bottom:2px}.footer-nP6SsK>.text-F2ZbvJ{color:rgba(48,59,94,.47);font-size:12px;font-style:normal;font-weight:400;line-height:16px}.footer-nP6SsK>.text-F2ZbvJ>.link-aJnpEC{color:#4d53e8;text-decoration:none}.footer-nP6SsK.bg-theme-b_fojJ>.text-F2ZbvJ{color:rgba(255,255,255,.6)}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"footer\": `footer-nP6SsK`,\n\t\"text\": `text-F2ZbvJ`,\n\t\"link\": `link-aJnpEC`,\n\t\"bg-theme\": `bg-theme-b_fojJ`,\n\t\"bgTheme\": `bg-theme-b_fojJ`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.float-open-conversations-btn-s8kQxJ{position:absolute;top:20px;left:0}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"float-open-conversations-btn\": `float-open-conversations-btn-s8kQxJ`,\n\t\"floatOpenConversationsBtn\": `float-open-conversations-btn-s8kQxJ`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.header-XJy8DU{flex:none;align-items:center;height:72px;padding:24px 16px 16px;display:flex}.header-XJy8DU .conversation-list-btn-Low_Kd{margin-right:8px}.header-XJy8DU .avatar-qrhZrw{width:28px;height:28px;margin-right:15px}.header-XJy8DU .title-Bn3oBZ{color:rgba(0,0,0,.85);flex:auto;margin-right:12px;font-size:20px;font-weight:700}.header-XJy8DU .icon-btn-asXah6{width:32px;height:32px}.header-XJy8DU.bg-theme-sFJQ59 .icon-btn-asXah6,.header-XJy8DU.bg-theme-sFJQ59 .title-Bn3oBZ{color:#fff}.header-XJy8DU.bg-theme-sFJQ59 .icon-btn-asXah6:disabled,.header-XJy8DU.bg-theme-sFJQ59 .icon-btn-asXah6:hover{color:rgba(255,255,255,.8)!important}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"header\": `header-XJy8DU`,\n\t\"conversation-list-btn\": `conversation-list-btn-Low_Kd`,\n\t\"conversationListBtn\": `conversation-list-btn-Low_Kd`,\n\t\"avatar\": `avatar-qrhZrw`,\n\t\"title\": `title-Bn3oBZ`,\n\t\"icon-btn\": `icon-btn-asXah6`,\n\t\"iconBtn\": `icon-btn-asXah6`,\n\t\"bg-theme\": `bg-theme-sFJQ59`,\n\t\"bgTheme\": `bg-theme-sFJQ59`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.header-c2GY3w{border-bottom:1px solid rgba(29,28,35,.08);flex:none;align-items:center;height:56px;padding:0 16px;display:flex}.header-c2GY3w .conversation-list-btn-pfVenk{margin-right:8px}.header-c2GY3w .avatar-VBKBWU{width:24px;height:24px;margin-right:8px}.header-c2GY3w .title-doPV6I{color:#1c1d23;flex:auto;margin-right:12px;font-size:18px;font-weight:600}.header-c2GY3w .icon-btn-XW5hXV{width:32px;height:32px}.header-c2GY3w.bg-theme-k2iRN_ .icon-btn-XW5hXV,.header-c2GY3w.bg-theme-k2iRN_ .title-doPV6I{color:#fff}.header-c2GY3w.bg-theme-k2iRN_ .icon-btn-XW5hXV:disabled,.header-c2GY3w.bg-theme-k2iRN_ .icon-btn-XW5hXV:hover{color:rgba(255,255,255,.8)!important}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"header\": `header-c2GY3w`,\n\t\"conversation-list-btn\": `conversation-list-btn-pfVenk`,\n\t\"conversationListBtn\": `conversation-list-btn-pfVenk`,\n\t\"avatar\": `avatar-VBKBWU`,\n\t\"title\": `title-doPV6I`,\n\t\"icon-btn\": `icon-btn-XW5hXV`,\n\t\"iconBtn\": `icon-btn-XW5hXV`,\n\t\"bg-theme\": `bg-theme-k2iRN_`,\n\t\"bgTheme\": `bg-theme-k2iRN_`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.loading-juzNfh{justify-content:center;align-items:center;width:100%;height:100%;display:flex}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"loading\": `loading-juzNfh`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.chat-input-MD2hnr{padding:10px 0}.area-Vifkit{flex-direction:column;flex:auto;width:100%;height:100%;min-height:0;display:flex}.area-Vifkit *{box-sizing:border-box}.area-Vifkit .chat-uikit-on-boarding-pc>div{padding-left:14px;padding-right:14px}.area-Vifkit .safe-area-Hj5Boc{height:24px}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"chat-input\": `chat-input-MD2hnr`,\n\t\"chatInput\": `chat-input-MD2hnr`,\n\t\"area\": `area-Vifkit`,\n\t\"safe-area\": `safe-area-Hj5Boc`,\n\t\"safeArea\": `safe-area-Hj5Boc`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.container-MAaKnd{background-color:rgba(var(--coze-bg-3),var(--coze-bg-3-alpha));border-radius:4px;padding:4px}.container-MAaKnd .button-reMmTH{text-align:left;width:100%;color:rgba(var(--coze-fg-3),var(--coze-fg-3-alpha));border-radius:4px;justify-content:flex-start;padding-left:8px;padding-right:8px;font-weight:400}.container-MAaKnd .button-reMmTH.coz-btn-secondary{color:rgba(var(--coze-fg-3),var(--coze-fg-3-alpha))}.popover-cntL5v{border-radius:4px}.chat-input-left-slot-TEgGKm .disabled-AeV9HE{color:rgba(55,67,106,.38)!important;background-color:rgba(249,249,249,.8)!important}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container\": `container-MAaKnd`,\n\t\"button\": `button-reMmTH`,\n\t\"popover\": `popover-cntL5v`,\n\t\"chat-input-left-slot\": `chat-input-left-slot-TEgGKm`,\n\t\"chatInputLeftSlot\": `chat-input-left-slot-TEgGKm`,\n\t\"disabled\": `disabled-AeV9HE`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../../../../../../../common/temp/default/node_modules/.pnpm/@rsbuild+core@1.1.13/node_modules/@rsbuild/core/compiled/css-loader/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.message-box-wrapper-TZhKV8 .coz-fg-images-user-name{color:var(--coze-fg-image-user-name)}`, \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"message-box-wrapper\": `message-box-wrapper-TZhKV8`,\n\t\"messageBoxWrapper\": `message-box-wrapper-TZhKV8`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * The base implementation of `_.delay` and `_.defer` which accepts `args`\n * to provide to `func`.\n *\n * @private\n * @param {Function} func The function to delay.\n * @param {number} wait The number of milliseconds to delay invocation.\n * @param {Array} args The arguments to provide to `func`.\n * @returns {number|Object} Returns the timer id or timeout object.\n */\nfunction baseDelay(func, wait, args) {\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  return setTimeout(function() { func.apply(undefined, args); }, wait);\n}\n\nexport default baseDelay;\n","import baseDelay from './_baseDelay.js';\nimport baseRest from './_baseRest.js';\n\n/**\n * Defers invoking the `func` until the current call stack has cleared. Any\n * additional arguments are provided to `func` when it's invoked.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to defer.\n * @param {...*} [args] The arguments to invoke `func` with.\n * @returns {number} Returns the timer id.\n * @example\n *\n * _.defer(function(text) {\n *   console.log(text);\n * }, 'deferred');\n * // => Logs 'deferred' after one millisecond.\n */\nvar defer = baseRest(function(func, args) {\n  return baseDelay(func, 1, args);\n});\n\nexport default defer;\n"],"names":["ReportEventNames","options","undefined","ActionBarContainer","leftContent","rightContent","children","s","ActionBarHoverContainer","forwardRef","ref","style","classNames","getIsPushedMessage","message","getIsTriggerMessage","getIsNotificationMessage","getIsAsyncResultMessage","getIsLastGroup","isFromLatestGroup","sectionId","latestSectionId","getShowRegenerate","meta","useTooltipTrigger","defaultTrigger","layout","useChatAreaLayout","Layout","RegenerateMessage","className","props","regenerateMessage","useMessageBoxContext","useLatestSectionId","trigger","Tooltip","I18n","IconButton","IconCozRefresh","DeleteMessage","groupId","isDeleteMessageLock","useIsDeleteMessageLock","deleteMessageGroup","useDeleteMessageGroup","IconCozTrashCan","CopyTextMessage","isMustGroupLastAnswerMessage","isUseExternalContent","externalContent","reporter","useChatArea","content","isCopySuccessful","setIsCopySuccessful","useState","getIsTextMessage","iconClassNames","IconCozCheckMark","IconCozCopy","copy","setTimeout","COUNT_DOWN_TIME","Toast","getReportError","useQuotePlugin","useWriteablePlugin","PluginName","e","QuoteMessage","plugin","messageSource","QuoteMessageImpl","chatAreaPluginContext","pluginBizContext","useDeleteFile","getFileStoreInstantValues","useQuoteStore","onQuote","updateQuoteContent","updateQuoteVisible","content_type","deleteFile","deleteAllFile","fileIdList","id","isTextMessage","isImageMessage","getIsImageMessage","IconCozQuotation","ContentType","_message_sender_id","_contentObj_image_list_map","contentObj","typeSafeJsonParseEnhanced","_content","Object","error","safeAsyncThrow","img","GrabElementType","parseMarkdownToGrabNode","renderLifeCycleServiceGenerator","messageLifeCycleServiceGenerator","commandLifeCycleServiceGenerator","appLifeCycleServiceGenerator","bizLifeCycleServiceGenerator","BizMessageInnerAddonBottom","memo","p","reasoningFinished","setReasoningFinished","useRef","useEffect","MdBoxLazy","prev","next","BizPlugin","ReadonlyChatAreaPlugin","PluginMode","createReadonlyLifeCycleServices","createCustomComponents","ReasoningPluginRegistry","isWorkflowNodeData","value","isObject","isInputWorkflowNodeContent","isInputWorkflowNodeContentLikelyArray","Array","NodeWrapperUI","QuestionNodeRender","data","onCardSendMsg","readonly","isDisable","disabled","Space","Typography","option","index","Button","InputNodeRender","inputData","setInputData","hasSend","setHasSend","parsedContent","typeSafeJsonParse","noop","validContent","item","Input","produce","draft","WorkflowRenderEntry","restProps","prevProps","nextProps","isEqual","omitBy","isFunction","defaultEnable","WorkflowRender","customTextMessageInnerTopSlotList","usePluginCustomComponents","enhancedContentConfigList","_contentConfigs_ContentBoxType_CARD","contentType","contentConfigs","isCardEnable","ContentBoxType","eventCallbacks","isCardDisabled","ContentBox","pluginName","Component","PluginScopeContextProvider","extractChatflowMessage","_contentStruct_x_properties","contentStruct","safeJSONParse","workflowDataStr","cardData","_data_question_card_data","_data_question_card_data_Options","_data_input_card_data","chatflowNodeData","useMemo","ChatFlowRender","ChatBackgroundEventName","createBackgroundImageStore","mark","create","devtools","set","info","IS_DEV_MODE","bizAppLifeCycleService","chatBackgroundEvent","storeSet","setBackgroundInfo","backgroundInfo","ctx","clearBackgroundStore","ctxBackgroundInfo","ChatBackgroundUI","_backgroundImageInfo_mobile_background_image","headerNode","useChatBackgroundContext","useReadonlyPlugin","backgroundImageInfo","useShallow","state","isBackgroundMode","styles","WithRuleImgBackground","mitt","createChatBackgroundPlugin","ChatBackgroundPlugin","useImperativeLayoutEffect","effect","deps","effectValue","setEffectValue","paramRef","effectRef","useLayoutEffect","params","args","pre","useLoadMore","getId","listRef","getMoreListService","defaultList","activeId","setActiveId","loadingMore","loading","loadMore","useInfiniteScroll","currentData","d","resultData","_data_list","_data_list1","list","focusTo","toItem","findItem","scrollIntoView","_listRef_current","itemId","itemRef","focusFirst","firstItem","scrollToFirst","goNext","curItem","nextItem","reachLimit","getNextActiveItem","goPrev","prevItem","getPreviousItem","getTargetItemAndIndex","target","targetIndex","targetItem","nextIndex","nextIdx","LoadMoreList","onSelect","itemRender","onActiveId","defaultId","listTopSlot","mouseMovingCancelIdRef","mouseMovingRef","activeItemRef","useUpdateEffect","defaultItem","clearTimeout","event","selectItem","IconSpin","getQueryFromTemplate","templateQuery","values","query","key","RegExp","useSendTextQueryMessage","sendTextMessage","useSendTextMessage","_shortcut_components_list","queryTemplate","onBeforeSend","inputOptions","shortcut","tool_type","useTool","ToolType","pluginParams","getPluginDefaultParams","merge","String","websocketManager","newMessage","newOptions","sendTeaEvent","EVENT_NAMES","enableSendTypePanelHideTemplate","useSendUseToolMessage","sendMultimodalMessage","useSendMultimodalMessage","_handledParams_message","componentsFormValues","onBeforeSendTemplateShortcut","withoutComponentsList","sendQuery","getTemplateQuery","getPluginParams","imageAndFileList","getImageAndFileList","handledParams","cloneDeep","plugin_id","plugin_api_name","components_list","tool_params_list","filterImagesValues","filterComponentFormValues","fileInstance","url","runPluginVariables","acc","cur","_components_list_find","default_value","name","refer_component","targetComponentName","com","componentValue","template_query","Error","componentListValue","getComponentListValue","setImageAndFileValue","setTextValue","isComponentFile","isComponentImage","_getFileInfo","Boolean","componentsList","filterValues","_value_fileInstance","_default_value_value","hide","shortcutIconAndNameVisibleControl","bot_info","iconVisible","nameVisible","splitLineVisible","Text","ShortcutsLoadMoreList","shortcuts","onBeforeSendTextMessage","sendQueryMessage","cls","Promise","SendType","_shortcut_shortcut_icon","_shortcut_bot_info","_shortcut_bot_info1","_shortcut_bot_info2","DefaultShortcutIcon","shortcutCommandVariants","cva","shortcutCommandTextVariants","Paragraph","TooltipWithContent","toolTipFooterSlot","propShowBotInfo","showTooltip","visible","setVisible","description","command_name","icon_url","showBotInfo","renderContent","QueryShortcut","onClick","popoverTipShowBotInfo","commandNameRef","isSendMessageLock","useIsSendMessageLock","onShortcutClick","agent_id","object_id","JSON","typeSafeShortcutCommandVariants","typeSafeShortcutCommandTextVariants","TemplateShortcut","uiMode","hideTemplate","IconShortcutComponentTag","LoadMore","onOpen","onClose","isLoadMoreActive","UIButton","ShortcutBar","onActiveShortcutChange","wrapperClassName","wrapperStyle","overflowListRef","isShowLoadMoreList","setIsShowLoadMoreList","activeShortcut","setActiveShortcut","shortcutTemplateVisible","setShortcutTemplateVisible","sendUseToolMessage","messageWidth","useMessageWidth","handleActiveShortcutChange","isTemplateShortcutActive","shortcutClick","onShortcutTemplateNoParamsSubmit","getFormValueFromShortcut","closeShortcutTemplate","tool_info","ShortcutTemplate","Popover","document","OverflowList","overflowItems","getUIModeByBizScene","bizScene","showBackground","exhaustiveCheckSimple","useGetUploadPluginInstance","getRegisteredPlugin","useGetRegisteredPlugin","fakeProgressTimer","file","onProgress","onError","onSuccess","UploadPlugin","uploader","isStartFakeProgress","fakeProgress","fakeProgressHandler","startFakeProgressTimer","window","percent","clearFakeProgress","Url","Uri","ImageHeight","ImageWidth","clearInterval","ChatAreaStateContext","createContext","LabelWithDescription","required","Form","IconInfo","UploadContent","_getFileInfoByFileType","inputType","onRemove","onRetry","isFailed","isUploading","fileType","fileIcon","classnames","IconClose","IconCloseNoCycle","FileUpload","uploadFile","onChange","toggle","setFile","fieldApi","useFieldApi","uidRef","onUpload","newFile","width","height","Upload","_currentFile_fileInstance","currentFile","IconAdd","IconCopyLink","FileInput","UIInput","UploadInner","withField","showInput","setShowInput","hasError","parseRules","rules","rule","r","v","useChatAreaState","useContext","useIsSubmitButtonDisable","dsl","formFields","formState","useFormState","field","_formState_errors","_findInputElementById_props","isEmpty","isError","inputDefaultValue","DSLWidgetsMap","defaultValue","UIFormSelect","onSubmit","formRef","api","formValues","inputElementsWithDefault","findInputElementsWithDefault","newValues","curr","input","i","context","isDisabled","IconSend","getChildrenIds","_this","_item_children","res","column","DSLRender","elementId","itemType","childrenIds","childrenId","ShortCutPanel","shortcutTemplateRef","getRegisteredPluginInstance","_shortcut_components_list_filter","showComponents","getDSLFromComponents","UIIconButton","IconShortcutTemplateClose","attachIdToComponents","components","shortid","formatSubmitValues","InputType","checkDuplicateName","formApi","fieldMap","_fieldMap_item_name","indexArray","isDuplicated","indexArr","getComponentTypeSelectFormInitValues","componentTypeHandlers","type","uploadTypes","getSubmitFieldFromComponentTypeForm","handler","result","isUploadType","inputTypeHandlers","getComponentTypeFormBySubmitField","input_type","upload_options","handler1","modifyComponentWhenSwitchChange","record","checked","isSwitchDisabled","_toolInfo_tool_params_list_find","toolInfo","isWithDefaultValue","isRequired","t","isMaxCount","isFinalRequired","Checkbox","CheckboxGroup","DefaultValue","checkedValues","newValue","ACCEPT_UPLOAD_TYPES","label","icon","dndType","Symbol","OptionsList","sortable","connect","dropRef","handleRef","_options","IconShortcutDisorder","IconShortcutTrash","SortableList","SelectContentFieldInner","initialValue","setOptions","_option_value","SelectContentField","_state_error","useFieldState","formatComponentTypeForm","RadioGroup","Radio","SelectTypeAndLableMap","ComponentTypeSelectRecordItem","submitValue","setSubmitValue","componentType","setComponentType","selectPopoverVisible","setSelectPopoverVisible","componentTypeSelectFormRef","onComponentTypeSelectFormSubmit","_componentTypeSelectFormRef_current","ComponentTypeSelectForm","IconChevronDown","selectOption","setSelectOption","optionsMap","getComponentTypeOptionMap","useImperativeHandle","_formRef_current","_formRef_current1","errors","_errors_values","_errors_values1","message1","render","initValue","ComponentParameter","parameter","desc","UploadField","SelectWithInputTypeField","rest","Select","selectValue","InputWithInputTypeField","inputValue","ComponentDefaultValue","TooltipWithDisabled","getOperationColumns","toolType","deleteable","showDelete","_","Switch","getColumnsMap","handleId","cs","IconSvgShortcutDrag","text","assignWidth","base","getColumns","columnsMap","shortcut_command","tableComponents","onMove","useDnDSortableItem","_dropRef_current_querySelector","tableEmpty","selected","ComponentsTable","setValues","onChangeInner","_submitValues_values","component","_component_options","submitValues","newComponents","_formRef_current2","sourceId","targetId","isBefore","sourceIndex","source","sourceError","sourceItem","showAdd","oversize","addBtn","ActionButton","tipBtn","FieldLabel","compTip","DndProvider","changedValues","_changedKeys_","changedKeys","Table","_item_id","_values_length","tooltip","tip","getVar","var1","var2","queryTip","getSubmitValue","mutableSendType","send_type","use_tool","mutableFormatCommandName","mutableSetCardSchemaForForm","mutableModifyToolParamsWhenComponentChange","mutableInitQueryFormValues","mutableInitNotUseToolFormValues","_value_components_list","targetToolParams","findToolParamsByComponent","param","_values_components_list","templateDsl","initComponentsListFromToolParams","toolParams","initComponentsUploadOptions","getInitialValues","initShortcut","modifyComponentsListByUploadOptions","initToolEnabledByToolTYpe","_shortcut_tool_info","tool_name","c","_curr_default_value","ElementPropsType","ElementDirectiveType","getDSLTemplate","getAcceptByComponent","uploadItemTypes","getAcceptByUploadItemTypes","getUploadElementDSL","_component_name","getFormItemPlaceholderDSL","getLayoutDSL","items","getFormItemDSLMap","_template_elements_form_children","formItemsDSL","getFormElementFromComponent","layoutDSL","getElementsLayout","template","elements","elementsCopy","_c_props","findInputElementById","_Object_values_filter_find","ImageIcon","TableIcon","DocIcon","AudioIcon","CodeIcon","ZipIcon","PptIcon","VideoIcon","TxtIcon","fileTypeToInputTypeMap","FileTypeEnum","acceptMap","FILE_TYPE_CONFIG","preAcc","acceptUploadItemTypes","accept","acceptStr","getFileInfoByFileType","getToolInfoByShortcut","plugin_from","work_flow_id","validateCmdString","validatePluginAndWorkflowParams","enableEmpty","isComplex","validateCommandNameRepeat","checkShortcut","shortcutCommand","command_id","validateButtonNameRepeat","prefix","alphabet","length","genId","customAlphabet","EventNames","PublicEventNames","createSelectionStore","get","nodeList","selectionData","position","createQuoteStore","subscribeWithSelector","quote","updater","subscribeQuoteUpdate","store","quoteContent","onQuoteChange","createPreferenceStore","enable","GrabMessageLifeCycleService","WriteableMessageLifeCycleService","updateQuoteContentMapByImmer","originMessage","newContent","getOriginContentText","quoteContentMap","localMessageId","emit","GrabCommandLifeCycleService","WriteableCommandLifeCycleService","GrabAppLifeCycleService","WriteableAppLifeCycleService","unsubscribe","eventCenter","publicEventCenter","scene","currentGrabPluginId","grabPluginId","getMessage","messageId","QuoteButton","useSelectionStore","usePreferenceStore","enableGrab","getMessageInfo","normalizeSelectionNodeList","MenuList","useGetScrollView","on","off","onScroll","onMouseEnter","onMouseLeave","getScrollView","menuRef","opacity","setOpacity","refreshOpacity","useEventCallback","_menuRef_current","localRect","scrollRect","_opacity","_opacity1","FILTER_MESSAGE_SOURCE","GrabMenu","_floatMenuRef_current","contentRef","floatMenuRef","isFloatMenuVisible","updateFloatMenuPosition","clearSelection","isScrolling","computePosition","useGrab","_plugin_chatAreaPluginContext_readonlyAPI_message_findMessage","_selectionData_humanizedContentText","_selectionData_normalizeSelectionNodeList","_selectionData_originContentText","updateHumanizedContentText","updateNormalizeSelectionNodeList","updateOriginContentText","updateSelectionData","updateIsFloatMenuVisible","isSpecialMessage","NO_MESSAGE_ID_MARK","is_finish","_position","defer","isShowFloatMenu","useHideQuote","_props_containerRef","containerRef","targetRef","usedContainerRef","forceHidden","setForceHidden","_target_attributes_getNamedItem","getAncestorAttributeNode","CONTENT_ATTRIBUTE_NAME","MESSAGE_SOURCE_ATTRIBUTE_NAME","Number","func","wait","toNumber","getMouseNearbyRect","rects","mouseInfo","nearbyRect","rect","useFloatMenuListener","targetElement","targetInfo","setIsScrolling","scrollingTimer","isMouseInMenu","setPosition","timer","handleMenuMouseEnter","handleMenuMouseLeave","handleCardLinkElementMouseLeave","isMessageFinished","handleCardLinkElementMouseEnter","_ctx_element_textContent","handleViewScroll","delay","targetRect","menuRect","x","y","_getMouseNearbyRect","handleMouseMove","handleSmartScreenChange","useAutoGetMaxPosition","messageRef","maxPositionX","setMaxPositionX","_messageRef_current_getBoundingClientRect_right","FloatMenu","_position_x","isGrabMenuVisible","isTouchDevice","top","left","_pluginBizContext_eventCallbacks","_targetInfo_current","MessageListFloat","quoteNodeColorVariants","getQuoteNode","theme","handleClickImage","node","isGrabTextNode","typeSafeQuoteNodeColorVariants","isGrabImage","Image","isGrabLink","QuoteNode","previewUrl","setPreviewUrl","useShowBackGround","ImagePreview","getReferFromMessage","refer_items","_JSON_parse","_firstItem_image","_firstItem_image_image_thumb","QuoteTopUI","RemoteQuoteInnerTopSlot","refer","LocalQuoteInnerTopSlot","localNodeList","QuoteMessageInnerTopSlot","QuoteInputAddonTop","useChatInputLayout","quoteVisible","layoutContainerRef","handleStopPropagation","_layoutContainerRef_current","IconCozCross","ChatAreaGrabPlugin","WriteableChatAreaPlugin","updateEnableGrab","createGrabPlugin","preference","nanoid","grabPlugin","unsubscribeQuoteStore","useCreateGrabPlugin","grabEnableUpload","setGrabEnableUpload","GrabPlugin","Direction","getAllNodesInRange","range","nodes","treeWalker","NodeFilter","currentNode","findAncestorNodeByTagName","tagName","upperTagName","Node","getAncestorAttributeValue","attributeName","_node_attributes_getNamedItem","attributeValue","Element","shouldRefineRange","validNodeLength","hasNodeInLink","endOffset","findLastSiblingNode","scopeAncestorAttributeName","targetAttributeValue","lastValidSibling","findLastChildNode","compareNodePosition","nodeA","nodeB","comparison","fixStartNode","targetAttributeName","startNode","startOffset","findNearestAnchor","fixLink","endNode","startAnchor","endAnchor","isFix","fixEndNode","_findLastChildNode_textContent_length","getAllChildNodesInNode","_node","findNotContainsPreviousSibling","_node_previousSibling","sibling","fixEndEmpty","textContent","_currentNode_textContent","_currentNode_textContent1","textContent1","_currentNode_textContent2","_child_textContent","lastTextNode","child","refineRange","parentNode","lastSibling","liParentNode","aParentNode","divParentNode","relation","isFixLink","isFixEndEmpty","normalizeNodeList","getPictureNodeUrl","findPictureValidChildNode","childNodes","processSpecialNode","pictureNode","getNormalizeNodeList","childNodeList","normalizedNodeList","childNode","specialNode","grabNode","generateGrabNode","grabNode1","normalizedNodeListInLoop","isTable","generateGrabText","generateGrabElement","_node_textContent","safeTextContent","grabText","grabText1","getHumanizedContentText","hasVisibleSelection","documentFragment","textNodes","collectTextNodes","textNode","getSelectionDirection","selection","anchorNode","focusNode","anchorOffset","focusOffset","getSelectionData","_ancestorNodeWithAttribute_attributes_getNamedItem_value","_ancestorNodeWithAttribute_attributes_getNamedItem1","hasFix","direction","ancestorNodeWithAttribute","ancestorAttributeValue","humanizedContentText","originContentText","getRectData","rangeRects","onSelectChange","onPositionChange","timeoutRef","hasSelectionData","_selection_current","handleScreenChange","_selectionData_current","innerSelection","rectData","rangeRect","screen","handleGetSelection","_selection","_selectionData","handleMouseUp","handleKeyDown","handleMouseDown","clientX","clientY","floatMenuRect","isImage","isLink","isParent","isText","parseMarkdownHelper","markdown","getGrabNodeFromAst","parseMarkdown","ast","traverseAst","_ast","_ast_alt","DnDContext","Provider","HTML5Backend","enabled","itemDomRef","enabledRef","isHovered","drop","useDrop","monitor","_itemDomRef_current","draggingClient","dropTargetClient","middle","middle1","isDragging","drag","preview","useDrag","ItemWrapper","ItemRender","dndSortableProps","defaultGetId","before","newList","ChatType","AuthType","SDKErrorCode","ServerErrorCode","OpenApiError","ChatSdkErrorType","OpenApiSource","ConversationSort","LocalStorageKey","EInputMode","ChatEventType","WebsocketsEventType","ChatSdkError","err","code","newErr","sdkCode","specCodeList","getServerError","isAuthError","errorCode","postErrorMessage","conversationSortMap","Map","useUserInfo","userInfo","useChatAppStore","openUserInfo","usePaginationRequest","requestFn","requestParams","pageSize","initialPageNum","autoLoad","currentPage","setCurrentPage","allData","setAllData","hasMore","setHasMore","run","useRequest","pageNum","targetPage","responseData","responseHasMore","console","useCallback","refresh","setPageNum","reset","useConversationList","conversationListParams","order","botId","connectorId","useChatAppProps","cozeApiSdk","currentConversationInfo","updateCurrentConversationInfo","conversations","updateConversations","chatContainer","useGroupedConversations","sortedConversations","today","Date","thirtyDays","dateString","date","dayjs","diff","a","b","groups","conversation","_groups_get","MobileConversationOperate","onRename","onDelete","Menu","IconCozEdit","MobileConversationItem","isActive","shouldDisplayTime","onConversationChange","isTouched","setIsTouched","longPressTimerRef","longClickTimerRef","closeOperate","handleTouchStart","handleTouchEnd","handleTouchMove","Operate","PcConversationItem","IconCozMore","ConversationList","groupedConversations","cozeApi","conversationRef","addLoading","setAddLoading","isMobile","listContainerRef","loadMoreRef","handleCreateConversation","handleConversationChange","handleDeleteConversation","observer","IntersectionObserver","entries","entry","IconCozSideNav","IconCozPlus","sort","conversationList","Spin","ConversationListSider","conversationListRef","isModalLoading","setIsModalLoading","modalInfo","setModalInfo","handleOpenRenameModal","handleOpenDeleteModal","handleUpdateConversationName","handleModalOk","_conversationListRef_current","_conversationListRef_current1","_conversationListRef_current2","Fragment","SideSheet","Modal","STRINGIFY_ERROR","catchStringify","obj","catchParse","objStr","getStorageKey","suffix","str","localStorage","getDefaultUserInfo","userIdKey","storageUtil","createChatStore","chatConfig","_chatConfig_auth","_chatConfig_auth1","isNeedToken","token","hasRefusedCallByUser","tokenOld","newToken","userInfoIn","userId","tokenNew","initError","defaultInputMode","isShowCustomPanel","feedbackType","voiceCallClose","isStartBotVoiceCall","operate","ChatPropsContext","ChatPropsProvider","_appProps_chatConfig_ui_conversations","appProps","defaultChatConfig","isShowConversations","appPropsState","openRequestInit","_conversationRef_current","enableReplacePrologueNicknameWithVar","selector","useStoreWithEqualityFn","shallow","useIsShowBackground","_backgroundInfo_mobile_background_image","isCustomBackground","useGetTheme","isShowBackground","_shortcuts_at","controller","onShortcutActive","activeShortcutRef","ChatAreaShortcutBar","shortcutInfo","_options_extendFiled_toolList_","_options_extendFiled_toolList","parameters","optionsNew","IconAddNewConversation","Icon","useChatOpInfo","_chatConfig_ui_header","_chatConfig_ui_chatBot","_chatConfig_ui_chatBot1","_chatConfig_ui_chatBot2","_chatConfig_ui_chatBot3","_chatConfig_ui_chatBot4","_chatConfig_ui_chatBot5","_chatConfig_ui_chatBot6","_chatConfig_ui_chatBot7","chatInputLeftOps","headerTopLeftOps","useChatChatButtonInfo","opList","isClearHistoryButtonDisabled","isClearContextButtonDisabled","useBuiltinButtonStatus","clearHistory","useChatAreaController","clearContext","useClearContext","IconCozChatPlus","IconCozBroom","MoreBtn","buttonList","OutlinedIconButton","visibleTemp","ChatInputLeftSlot","_chatConfig_ui_base","UIKitTooltip","_buttonList_","StudioChatArea","_chatConfig_ui_chatBot_uploadable","_chatConfig_ui_footer","coreAreaClassName","showInputArea","inputPlaceholder","inputNativeCallbacks","messageGroupListClassName","renderChatInputTopSlot","isShowClearContextDivider","messageMaxWidth","isMiniScreen","enableMultimodalUpload","initStatus","useInitStatus","onInitStateChange","refContainer","contentBox","chatAreaComponentTypes","uploadable","enableLegacyUploadFlag","enableMultimodalUploadFlag","ChatArea","_options_extendFiled","optionNew","createWriteableLifeCycleServices","getChatCommonPlugin","createSDKUploadPluginClass","SDKUploadPlugin","eventName","callback","FileStatus","EventEmitter","slardarInstance","createMinimalBrowserClient","getSlardarEnv","errorPrefix","OpenReporter","Reporter","eventPrefix","eventMeta","studioOpenClientReporter","useUpdateConversationNameByMessage","currentConversationNameRef","updateCurrentConversationNameByMessage","useMessagesStore","useChatAreaStoreSet","messages","extendStatics","__extends","__","_super","ErrorEvent","CloseEvent","reason","getGlobalWebSocket","WebSocket","DEFAULT","Math","Infinity","ReconnectingWebSocket","protocols","_a","minUptime","listener","bytes","Blob","maxEnqueuedMessages","e_1","listeners","o","m","listeners_1","listeners_1_1","e_1_1","l","_i","arguments","__spread","ar","__read","n","_b","reconnectionDelayGrowFactor","_c","minReconnectionDelay","_d","maxReconnectionDelay","resolve","urlProvider","w","maxRetries","connectionTimeout","APIResource","client","Bots","apiUrl","isUniApp","uni","isBrowser","mergeConfig","_len","objects","_key","isPlainObject","proto","baseProto","buildWebsocketUrl","path","queryString","isBrowserExtension","chrome","CozeError","APIError","status","errorBody","headers","msg","logId","errorResponse","BadRequestError","AuthenticationError","PermissionDeniedError","NotFoundError","RateLimitError","TimeoutError","GatewayError","InternalServerError","APIConnectionError","castToError","_error_detail","_error_error","APIUserAbortError","Messages","conversation_id","chat_id","uuid","handleAdditionalMessages","additional_messages","handleParameters","Chat","payload","chat","chatId","conversationId","ret","response","chat_ChatEventType","messages_Messages","message_id","Conversations","Files","file_id","Runs","WorkflowEvent","workflowId","executeId","WorkflowChat","Workflows","WorkSpaces","safeJsonParse","jsonString","documents_headers","Documents","Knowledge","documents_documents_headers","documents_Documents","Images","datasetId","documentId","Datasets","dataset_id","Voices","Transcriptions","Speech","Rooms","VoiceprintFeature","featureId","VoiceprintGroups","Live","liveId","Audio","Templates","templateId","chat_Chat","req","transcriptions_Transcriptions","speech_Speech","SimultInterpretation","audio_Audio","types_WebsocketsEventType","Websockets","Variables","Users","WebSocketAPI","WebSocketImpl","separator","authorization","factory","getMiniAppWebSocketFactory","url2","_this_onmessage","_this_onopen","_this_onclose","_event_target__req_res","_event_target__req","_event_target","_event_target__req_res1","_event_target__req1","_event_target1","_this_onerror","_event_error","readyState","statusCode","rawHeaders","logidIndex","header","logid","version_version","getEnv","nodeVersion","process","platform","osName","osVersion","darwinVersion","majorVersion","parseInt","isNaN","getUserAgent","getNodeClientUserAgent","getBrowserClientUserAgent","browserInfo","osInfo","userAgent","navigator","_userAgent_match","_userAgent_match1","_userAgent_match2","_userAgent_match3","_userAgent_match4","_userAgent_match5","windowsVersion","getUniAppClientUserAgent","systemInfo","platformInfo","appName","appVersion","COZE_COM_BASE_URL","handleError","_error_response","_error_response1","_error_response2","_error_response3","adapterFetch","isSupportNativeFetch","compareVersions","fetchAPI","axiosInstance","isAxiosStatic","instance","axiosVersion","checkError","stream","reader","decoder","TextDecoder","fieldValues","buffer","done","lines","line","v1","v2","v1Parts","v2Parts","part1","part2","APIClient","method","body","config","_this__config_debug","isStream","_response_headers","_this__config","fullUrl","fetchOptions","json","onApiError","websocketOptions","forceDebug","msgs","CozeAPI","CozeApiCustom","onRefreshToken","authInterceptor","oldToken","axios","_this1","responseInterceptor","rejectResponseInterceptor","_param","axiosOptions","useApiClient","debug","refreshTokenRaw","setToken","setCozeApi","tokenManagerClient","TokenManager","cozeApiClient","openApiHostByRegionWithToken","updateToken","useMemoizedFn","refreshToken","ChatCozeSdkContext","ChatCozeSdkProvider","refMessageListLeft","useChatCozeSdk","tokenManager","useUploadFileApi","refInputTypeMap","convertShortcutData","shortcutCommands","botInfo","_item_tool","_item_tool1","_item_tool2","_item_tool3","_item_tool_params","_item_components","_item_tool5","sendType","componentItem","_componentItem_options","messageConverterToSdk","MessageConverterToSdk","messageBody","isNeedFileUrl","mixObjectList","mixReferObjectList","_item_image_image_ori","_item_file","messageList","cozeMessage","_contentTemp_","contentTemp","item2","commandStr","command","currentShortcut","toolParameterMap","compName","val","messageConverterToCoze","MessageConverseToCoze","firstId","lastId","messageListForCoze","isQuestion","replyId","senderId","itemList","getFileInfo","File","useMessageList","getMessageListByPairs","useGetMessageListByPairs","onAfterResponse","_response_config_params","_refMessageListLeft_current","_lastMessageList_","_data_data","_data_message_list","lastMessageList","lastAnswerChatId","dataForCoze","requestConfig","_messageListResponse_","messageListLeft","messageListResponse","getBotOnlineInfo","_backgroundInfo_web_background_image","_botInfo_onboarding_info_suggested_questions","_botInfo_media_config_is_voice_call_closed","botRes","i18n","question","getConversationInfo","conversationIdIn","sectionIdIn","defaultHistoryMessage","onDefaultHistoryClear","_conversationRes_conversations","conversationRes","conversationIdNew","sectionIdNew","historyMessage","conversationIdCreated","sectionIdCreated","conversationIdCreated1","sectionIdCreated1","resMessage","cursor","nextCursor","getCustomInitInfo","useRequestInit","setInitError","setDefaultInputMode","updateShortcuts","setIsStartBotVoiceCall","updateBackgroundInfo","botOnlineInfo","requestDataBotInfo","requestDataConversationInfo","prologue","useClearMessageContextAdapter","MessageParser","parseEvent","terminate","_messageError_last_error","errorMsg","messageError1","errorMsg1","isComplete","dataValue","messageType","_dataValue_inserted_additional_messages_lastItem","_this_userInfo","requestMessageRawBody","parser","destroy","useSendMessageAdapter","refChatFunc","refChatConfig","refConnectorId","shortcutsRef","_refChatConfig_current_botInfo","_debug_cozeApiRequestHeader","_refChatFunc_current","useClearHistoryAdapter","resCreateConversation","conversationData","IS_OPEN_SOURCE","useCommonOnBeforeRequestHooks","handleCommonError","_response_response","responseOut","useCommonErrorResponseHooks","useCommonOnAfterResponseHooks","useBreakMessage","useCoreManager","clearMessageContextAdapter","sendMessageAdapter","clearHistoryAdapter","commonOnBeforeRequestHooks","commonOnAfterResponseHooks","commonErrorResponseHooks","messageListAdapter","requestManagerOptions","breakMessageAdapter","mergeWith","RequestScene","objValue","srcValue","isArray","useCoreOverrideConfig","lastRetryId","_error_ext","_error_stack","_plugin_pluginBizContext","_ctx_message_extra_info","_plugin_pluginBizContext1","newRetryId","useMessageGroupFooterInfo","messageGroup","_messageInfo_extra_info","feedbackInfo","findMessage","lastGroupFeedbackInfo","messageInfo","cozeApiMessageId","isShowFeedbackInLastGroup","UIKitMessageGroupFooterPlugin","isLatest","useCurMessageInfo","_chatConfig_ui_chatBot_isNeedQuote","cozeApiChatId","useDeleteMessage","chatActionLockService","useChatActionLockService","useSuggestionsStore","isLastMessageGroup","clearSuggestions","isLast","deleteMessageById","useGlobalInitStore","deleteMessage","isShowDelete","useMessageHoverInfo","isNeedHoverAnswer","isMultiMessage","showHoverText","_contentObj_item_list","UIKitMessageBoxHoverSlot","isLastGroupMessage","UIKitMessageBoxHoverSlotContent","popoverContainerRef","actionBarRef","isNeedQuote","isShowHoverContainer","isShowQuote","actionBarSize","useSize","actionBarLeft","_actionBarRef_current_closest","containerSize","useMessageFooterInfo","messageGroupList","lastMessageText","group","messageItem","ChatMessageFooterContent","buttonClass","UIKitMessageBoxFooter","refreshContainerWidth","useWaitingStore","waiting","isAnswerMessage","UIKitMessageBoxPlugin","classname","UIKitMessageBox","getCozeSdkPlugin","useBgBackgroundPlugin","backgroundInfoToShow","ChatProviderFuncComp","useSectionIdStore","setConversationIdInArea","chatCore","setConversationId","_chatConfig_ui_conversations","isConversations","timestamp","newConversation","getConversationId","getSectionId","regenerateMessageByUserMessageId","useRegenerateMessageByUserMessageId","grabPluginPublicMethods","usePluginPublicMethods","ChatProviderImpl","_chatConfig_ui_chatBot_isNeedFunctionCallMessage","plugins","refLastIsError","onImageClick","ErrorFallback","requestToInit","createChatCoreOverrideConfig","uploadFileApi","cozeSdkChatPlugin","location","ChatAreaProvider","Scene","_msg_content_obj_file_list__file_key","_I18n_t","fileIndex","isFile","UIToast","allIgnorableMessageTypes","ChatProvider","_chatConfig_extra","onThemeChange","commonChatPlugin","ChatProviderCozeSdk","OpenChatProvider","Loading","iconUrl","CozeLogoPng","title","extra","FloatBtn","IconCozArrowRightFill","ChatHeader","isShowHeader","ChatHeaderMobile","ChatHeaderPC","getDefaultText","cozeOfficialHost","getTextByExpress","expressionText","linkvars","arrLinks","splitLinkTag","textWithLinkTags","link","linkText","isShow","footerClassName","textClassName","onBeforeRetry","wrapError","defaultError","hideExtra","getErrorIcon","ErrorUnbindPng","ErrorDefaultPng","Title","FallbackComponent","ErrorBoundary","FlowErrorBoundary","hasInit","lastMessageId","nowReceivingReplyId","_plugin_pluginBizContext_eventCallbacks","_plugin_pluginBizContext_eventCallbacks1","latestMessage","chatflowExecuteId","getBuilderEventCallbackPlugin","getConnectorId","project","mode","getFormatAppData","appData","workflowData","_workflowData_onboarding_info","_workflowData_onboarding_info_suggested_questions","_workflowData_onboarding_info2","_workflowData_avatar","_props_project","_workflowData_suggest_reply_info","_workflowData_suggest_reply_info1","_workflowData_user_input_config","_appInfoResult_backgroundInfo","_appInfoResult_backgroundInfo1","appInfoResult","combineAppDataWithProps","appInfoResultRaw","_props_project1","_props_project2","_props_project_onBoarding","_props_project_onBoarding_suggestions","_props_project_onBoarding2","_props_project_suggestPromoteInfo","_props_areaUi_bgInfo","_props_project7","_props_project8","_props_project9","_props_project_onBoarding3","_props_project_onBoarding4","_props_project_onBoarding5","_props_project_suggestPromoteInfo1","_props_project_suggestPromoteInfo2","_props_areaUi1","getBotInfo","apiSdk","_props_workflow","_props_project3","_props_project4","_appRes_value","_workflowRes_value_data","_props_workflow1","_appRes_reason","isWebSdk","isDebugParam","callerParam","appRes","workflowRes","appInfo","ChatFlowUserIcon","createOrGetConversation","_res_data","_res_data1","res1","BuilderChatContext","BuilderChatProvider","useGetAppDataCombineWithProps","appDataCombineWithProps","useSetAppDataFromOnLine","setAppDataFromOnLine","useUpdateAppDataCombineWithProps","appDataFromOnLine","setAppDataCombineWithProps","formatAPPInfo","refProps","_formatAPPInfo_customBgInfo","getBotInfoPrm","createOrGetConversationPrm","conversationInfo","useOnboardingUpdate","partialUpdateOnboardingData","getToken","_res_data_access_token","patPermissionApi","_err","checkParam","_props_auth","_props_auth1","useInitChat","_props_areaUi","_props_areaUi2","hasReady","setHasReady","setError","chatProps","setChatProps","projectInfo","errorTemp","_props_auth2","_props_areaUi_input_isNeedAudio","_props_areaUi_isNeedAddNewConversation","_props_areaUi_isNeedQuote","refAppData","_refProps_current_workflow","_refProps_current_workflow1","_refProps_current_project","_refProps_current_project1","_refProps_current_project2","_refProps_current_project3","_refProps_current_project4","_refProps_current_project5","_refProps_current_project6","_refAppData_current","_refAppData_current_suggestPromoteInfo","_refAppData_current_suggestPromoteInfo1","_refProps_current_workflow2","bodyDataOld","bodyData","URL","useBotAndUserUpdate","_appInfoResult_botInfo","_appInfoResult_botInfo1","_appInfoResult_botInfo2","updateBotInfo","useBotInfo","recordBotInfo","Background","bgInfo","themeColor","imgUrl","LabelValue","AuditPanel","_props_project_onBoarding1","_props_userInfo","_props_userInfo1","_props_areaUi_input","_props_areaUi_input1","BuilderChatContent","_areaUi_input","_areaUi_input1","_uiBuilderProps_project","_areaUi_input2","_uiBuilderProps_project1","_areaUi_input3","uiBuilderProps","refHasInitController","refInputController","areaUi","handleClearContext","sendMessage","useSendNormalizedMessage","_refInputController_current","inputControllerIn","getErrorCallbackComp","BuilderChatWrap","footer","footerConfig","ChatFooter","BuilderChatContainer","_appInfoResult_customBgInfo","_props_eventCallbacks","_props_eventCallbacks1","builderEventCallbackPlugin","_chatProps_userInfo","ErrorFallbackComp","BuilderChat","WebSdkChat","useInIframe","CozeChat","_chatConfig_ui_chatBot_isNeedAddNewConversation","_chatConfig_ui_chatBot_isNeedClearContext","WebSdkChatArea","_chatConfig_ui","webSdkProps","headerExtra","headerConf","___CSS_LOADER_EXPORT___","module","TypeError"],"mappings":"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"}