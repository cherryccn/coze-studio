{"version":3,"file":"static/js/async/5752.36406c39.js","sources":["webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/question-limit/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/radio/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/setting-on-error/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/slider/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/use-normalize-value-with-role-list.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/value-display.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/use-get-role-speaker-datasource.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/use-get-nickname-speaker-datasource.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/context.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/speaker-select.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/message-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/message-set-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/speaker-message-set.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/speaker-message-set-array/speaker-message-set-array.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/sql/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/sql/auto-generate/use-nl2sql-mutation.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/sql/auto-generate/result.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/sql/auto-generate/button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/sql/auto-generate/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/sql/sql/auto-generate/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/switch/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/system-prompt/system-prompt-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/system-prompt/expand-sheet-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/system-prompt/prompt-kit-bar.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/system-prompt/prompt-editor-with-kit.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/system-prompt/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/temperature/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/text-area/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/text-display/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/timezone/const.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/timezone/utils/timezone.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/timezone/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/to-standard-setter.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/trigger-bind-workflow/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/trigger-list/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/trigger-parameter-title/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/value-expression-input/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/variable-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/setters/view-variable-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form-extensions/validators/value-expression-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/utils/base-field-to-field.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/required-star.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/icon-info.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/label.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/field-layout.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/feedback.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/field-array.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/utils/base-field-array-to-field-array.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/icon-remove.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/field-array-item.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/field-array-list.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/field-empty.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/section.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/add-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/column-titles.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/sortable-item.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/sortable-list.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/components/select.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/contexts/form-context.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/contexts/field-context.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/contexts/field-array-context.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/input-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/input-number-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/select-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/checkbox-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/switch-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/slider-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/textarea-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/fields/radio-group-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hocs/with-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hocs/with-field-array.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hooks/use-form.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hooks/use-field.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hooks/use-field-array.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hooks/use-watch.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/form/hooks/use-section-ref.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-latest-workflow-json.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-workflow-run-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-test-run-reporter-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-scroll-to-node.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-scroll-to-line.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-node-render-data.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-redo-undo.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-input-variables.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-role-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-variable-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-test-form-state.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-open-trace-list-panel.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-dependency-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-dataset-info.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-save-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-database-node-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-current-database-id.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-current-database-query.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-new-database-query.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-related-bot-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-workflow-preset.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-workflow-models.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/node-version/use-node-version-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-add-node-modal/helper.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-add-node-modal/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-add-node.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-biz-ide-state.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-editor-theme-state.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-exec-state-entity.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-float-layout-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-get-scene-flow-params.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-get-workflow-mode.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-global-state.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-line-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-node-render-scene.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-node-side-sheet-store.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-ref-input/use-ref-input-props.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-ref-input/use-ref-input-node.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-ref-input/use-ref-input.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-resizable-side-panel-store.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-space-id.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-template-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-test-run.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-update-sorted-port-lines.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/constant.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/use-upload.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/utils/format-bytes.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/utils/get-accept.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/utils/get-file-extension.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/validate/size-validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/utils/get-image-size.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/validate/image-size-validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/validate/accept-validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-upload/validate/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-validate-workflow.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-workflow-operation.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-workflow-references.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/hooks/use-add-node-visible.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/validators/batch-input-name/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/validators/batch-input-name/get-batch-input-names.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/validators/batch-output-name/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/validators/batch-output-name/get-batch-output-names.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/validators/batch-input-value/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/fields/batch-concurrent-size/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/fields/batch-inputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/fields/batch-outputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/fields/batch-size/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/fields/loop-settings-section/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/batch-function/relation.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/batch-function/create-batch-function-json.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/batch-function/create-batch-function-lines.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/batch-function/create-batch-function-template-data.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/batch-function/create-batch-function.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/batch-content/loop-port.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/batch/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/break/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/break/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/break/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/break/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/break/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/components/code-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/validators/create-code-inputs-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/validators/code-empty-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/code/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/header.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/node-config-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/data-type-tag.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/image-model-select-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/expression-editor-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/notify/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/timezone/const.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/timezone/utils/timezone.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/timezone/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/cronjob-select/fix-cronjob.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/cronjob-select/ai-cronjob.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/cronjob-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/components/dynamic-form/dynamic-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/effects/provide-loop-inputs-variables.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/effects/provide-loop-outputs-variables.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-parameters-field/inputs-tree-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/value-expression-input.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-parameters-field/node-input-name/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-parameters-field/node-input-name/node-input-name.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-parameters-field/inputs-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-parameters-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-parameters-field/create-inputs-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/setting-on-error/setting-on-error-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/setting-on-error/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/parameters-input-group/parameters-input-group-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/parameters-input-group/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/model-select-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/radio-setter-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/expression-editor-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/checkbox-with-tips-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/outputs-display-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/switch-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/answer-content-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/loop-outputs-field/loop-output-select-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/loop-outputs-field/loop-outputs-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/batch-mode-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-kv-field/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/inputs-kv-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/outputs/outputs.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/fields/outputs/output-tree-meta-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/hocs/with-node-config-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/utils/custom-setter-helpers.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/utils/with-setting-on-error.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/utils/nodes-v2-registry-utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/validators/create-input-tree-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/validators/create-outputs-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/common/validators/create-answer-content-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/continue/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/continue/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/continue/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/continue/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/continue/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/components/terminate-plan-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/end/types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/hooks/use-variable-with-node.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/components/else/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/components/condition/multi-condition.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/components/condition/hidden-condition.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/components/condition/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/if/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/components/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-canvas/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/input/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/validator/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/outputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/model-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/mode-radio/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/intents/option-item/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/intents/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/inputs-parameters/chat-history/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/inputs-parameters/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/components/advanced-setting/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/effects/intent-mode-effect.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/intent/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/components/inputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/json-stringify/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-function/relation.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-function/create-loop-function-template-data.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-function/create-loop-function-lines.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-function/create-loop-function-json.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-function/create-loop-function.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-input-name/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-input-name/get-loop-input-names.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-input-value/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-output-name/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-output-name/get-loop-output-names.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/hooks/use-loop-type.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-array/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-count/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-outputs/format-loop-output-name.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-outputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-settings-section/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-type/options.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-type/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-fields/loop-variables/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-array-name/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/validators/loop-array-value/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-content/loop-array.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-content/loop-port.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/loop-content/loop-variables.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/loop/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/components/history-switch-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/components/history-round-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/components/inputs.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/ltm/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/output/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/output/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/output/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/output/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/output/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/output/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/utils/api-node-checker.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/utils/get-api-node-identifier.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/utils/extract-api-node-data.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/utils/api-node-version.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/utils/api-node-error-setting.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/hooks/use-plugin-node-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/components/view-example.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/hooks/use-plugin-detail.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/components/plugin-link.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/plugin/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/utils/get-left-right-variable.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/fields/mutable-variable-assign.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/fields/set-variable.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/validators/variable-assign-left.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/validators/variable-assign-right.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/content/set-tags/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/content/set-tags/use-set-tags.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/set-variable/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/utils/trigger-submit.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/hooks/use-trigger.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/start/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/utils/get-input-default-value.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/utils/get-identifier.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/hooks/use-subworkflow-node-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/components/sub-workflow-link.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/utils/sync-to-latest-release.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/services/subworkflow-node-store.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/sub-workflow/services/subworkflow-node-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-delete/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-read/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-read/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-read/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-read/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-read/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-read/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/components/fixed-input-parameter-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/components/trigger-list-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/components/trigger-bind-workflow-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/utils/trigger-form.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/trigger-upsert/utils/validators.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/variable/node-content.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/radio/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/batch-mode/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/batch/batch-setting-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/batch/batch.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/expression-editor/hooks.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/expression-editor/container/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/expression-editor/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/form-item-feedback/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/helpers.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/input-label/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/node-input-name/node-input-name.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/node-input-name/validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/outputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/validation/with-validation.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/value-expression-input/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/hooks/use-default-node-meta.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/hooks/use-readonly.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/skill-knowledge-sider/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/auth/create-auth-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/get-matched-variable-types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/get-variable-view-type.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/validators/group-name-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/effects/variables-change-effects.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/node-header/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/node-meta/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/info-icon/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/merge-strategy-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/tooltip-with-disabled/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-variables/use-variables-filter.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-variables/group-variables-item.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-variables/use-is-output-variable.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-variables/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-type-tag/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-type-tag/use-group-type-alias.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/get-group-type-alias.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/get-variable-type-alias.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/delete-group-button/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-header/group-name.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-header/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/group-header/use-edit-name.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/to-field-error.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/add-group-button/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/generate-group-name.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/merge-groups-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/components/variable-merge-form/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/variable-merge-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/validators/variable-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/is-variable-type-matched.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/validators/variables-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/validators/merge-groups-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/variable-merge-node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/output-single-text/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/global-variable-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-assign/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-assign/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-assign/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/chat-history/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/setting-on-error/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/add-icon/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/hooks/use-model-type.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/utils/is-vision-input.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/components/vision-value-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/components/vision-name-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/components/vision-input-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/components/vision.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/hooks/use-model-enabled-types.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/vision/utils/is-vision-equal.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/cot/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/cot/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/cot/provide-reasoning-content.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/validators/llm-output-tree-meta-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/user-prompt/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/system-prompt-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/use-libraries-store.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/expand-sheet-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/prompt-kit-bar.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/prompt-editor-with-kit.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/system-prompt/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/system-prompt/use-skill-libraries.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/system-prompt/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/use-query-latest-fc-settings.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/output-params-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/input-params-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/use-table-scroll.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/plugin-setting-form-modal.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/workflow-setting.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/plugin-setting.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/knowledge-setting-form-modal.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/knowledge-setting.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/empty-skill.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/bound-item-card.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/skill-modal.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/add-skill.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/use-model-skill-disabled.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/llm-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/validators/llm-input-name-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/llm-node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/comment/constant.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/comment/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/utils/get-outputs-default-value.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-context.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/components/select-fields-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-add-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-section.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-item.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-list.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-columns-title.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/select-and-set-fields-field/select-and-set-fields-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/database-select.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/outputs.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-logic-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-right-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-operator-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/get-condition-operator-options.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-left-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-item-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/use-condition-left-data-type.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-list.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-add-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/fields/condition-field/condition-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-base/components/sql-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-base/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-base/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-base/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-base/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-base/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/validators/create-condition-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/validators/create-database-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/validators/create-select-and-set-fields-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/hooks/use-current-database-field.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/hooks/use-reset-condition.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-create/database-create-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/common/hooks/use-reset-select-and-set-fields.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-create/database-create-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-create/database-create-node-registry.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-create/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-delete/database-delete-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-delete/database-delete-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-delete/database-delete-node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-delete/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-limit-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields-add-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields-section.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields-item.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields-list.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields-column-titles.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/query-fields-field/query-fields-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/use-query-field-ids.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/use-validate-order-by-fields.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/order-by-add-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/use-query-fields.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/order-by-section.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/ace-or-desc-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/order-by-item-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/order-by-list.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/order-by.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/order-by-field/order-by-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/database-query-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/use-reset-fields.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/database-query-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/database-query-node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-query/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-update/database-update-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-update/use-reset-select-and-set-fields.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-update/database-update-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-update/database-update-node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/database/database-update/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/common/componets/dataset-select-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/common/componets/dataset-params-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-search/components/dataset-setting-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-search/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-search/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-search/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-search/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-search/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/components/dataset-write-parser-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/components/dataset-write-chunk-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/components/dataset-write-setting.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/dataset/dataset-write/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/hooks/use-keyboard.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/variable-subfix-widget.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/variable-prefix-widget.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/variable-deleted-widget.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/hooks/use-variable-injector.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/hooks/use-keyboard-actions.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/hooks/use-options-operations.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/variable-extension.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/hooks/use-interpolation-content.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/variable-support/hooks/use-selection.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/hooks/use-variable-tree.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/base-editor/json-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/base-editor/raw-text-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/base-editor/bash-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/raw-text-editor/inner-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/raw-text-editor/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/api/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/api/curl-expand-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/api/curl-import.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/api/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/json-import-editor/inner-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/json-import-editor/json-import-components/json-expand-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/json-import-editor/json-import-components/json-import.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/json-import-editor/json-import-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/json-import-editor/json-editor-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/fields/body-type-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/body/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/auth/add-to-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/setters/auth/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/components/base-editor/validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/http/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/model-setting-field/ratio-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/model-setting-field/create-model-options.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/model-setting-field/model-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/model-setting-field/model-setting-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/references-field/create-preprocessor-options.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/references-field/references-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/components/prompt-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-generate/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/image-reference/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/slider-with-input-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/question-limit.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/question-outputs.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/answer-option-field/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/answer-option-field/answer-item.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/answer-option-field/add-option-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/components/answer-option-field/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/effects/sync-question-answer-type.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/effects/sync-question-option-type.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/effects/sync-question-outputs.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/question/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/method-selector/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/inputs/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/inputs/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/concat-setting/setting-form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/concat-setting/setting-button.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/concat-setting/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/components/delimiter-selector-field.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/form.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/data-transformer.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/effects/handle-method-change-effect.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/node-registries/text-process/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/transform-on-submit.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/transform-on-init.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/sync-conversation-name-effect.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/components/fixed-input-parameters/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-message-list/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-message-list/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-message-list/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-message-list/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-message-list/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-conversation/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-conversation/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-conversation/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-conversation/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-conversation/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/clear-conversation-history/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/clear-conversation-history/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/clear-conversation-history/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/clear-conversation-history/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/clear-conversation-history/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-conversation/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-conversation/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-conversation/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-conversation/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-conversation/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-conversation/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-conversation/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-conversation/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-conversation/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-conversation/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-list/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-list/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-list/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-list/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-list/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-history/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-history/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-history/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-history/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/query-conversation-history/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-message/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-message/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-message/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-message/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/create-message/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-message/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-message/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-message/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-message/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/update-message/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-message/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-message/form-meta.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-message/form-render.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-message/node-registry.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/chat/delete-message/node-test.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/constants.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/use-query-setting-detail.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/promise-limiter.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/llm/skills/utils.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/materials/create-value-expression-input-validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/materials/fire-node-title-change.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/materials/node-meta-validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/materials/provide-node-batch-variable.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/materials/provide-node-output-variables.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/materials/setting-on-error-validate.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/nodes-v2/variable-merge/utils/is-output-variable.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/options/workflow-document-custom-options.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/database-node-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-edit-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/chatflow-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-validation-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/value-expression-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/value-expression-service-impl.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/database-node-service-impl.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/node-version-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/plugin-node-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/related-case-data-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/role-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/test-run-reporter-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/trigger-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-dependency-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-drag-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-float-layout-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-line-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-models-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-operation-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-run-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/services/workflow-save-service.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/utils/unique-workflow.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/layout/quad-tree.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/constant.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/utils/register.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/utils/safe-fn.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/base-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/api-node-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/cross-space-node-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/drop-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/loop-context-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/nested-loop-batch-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/same-space-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/same-workflow-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/scene-node-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/sub-workflow-self-ref-validator.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/validators/validation-chain.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/is-valid-node.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/is-valid-data.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/paste/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/layout/sub-canvas-handler.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/layout/comment-node-handler.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/layout/get-follow-node.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/layout/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/copy/is-system-nodes.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/delete/is-valid.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/delete/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/copy/get-valid-nodes.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/copy/is-valid.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/copy/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/zoom/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/export/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/load/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/shortcuts/contributions/select-all/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/generate-input-to-field.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/generate-parameters-to-properties.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/generate-form-node-field.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/generate-env-to-related-context-properties.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/generate-form-related-field.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/generate-form-schema.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/get-node-execute-history-input.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/utils/get-related-info.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/hooks/use-form-default-values.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/test-run-kit/hooks/use-open-workflow.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/typing/index.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/ui-components/add-operation/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/ui-components/auto-size-tooltip/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/ui-components/workflow-sl-input/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/use-workflow-playground.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/create-slots/use-force-update.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/create-slots/index.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/get-is-init-workflow.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/get-workflow-inner-side-sheet-holder.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/get-workflow-url.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/node-template.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/curl-parser.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/get-canvas-offset.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/utils/get-workflow-version.ts","webpack://@coze-studio/app/../../packages/workflow/playground/src/workflow-playground-context.ts","webpack://@coze-studio/app/../../packages/workflow/render/src/utils/shortcuts-utils.ts","webpack://@coze-studio/app/../../packages/workflow/render/src/utils/selection-utils.ts","webpack://@coze-studio/app/../../packages/workflow/render/src/layer/hover-layer.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/layer/shortcuts-layer.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/layer/background-layer.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/components/selector-bounds/index.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/workflow-render-contribution.ts","webpack://@coze-studio/app/../../packages/workflow/render/src/workflow-render-container-module.ts","webpack://@coze-studio/app/../../packages/workflow/render/src/workflow-loader.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/workflow-render-provider.tsx","webpack://@coze-studio/app/../../packages/workflow/playground/src/workflow-playground.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/components/workflow-port-render/warning.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/components/workflow-port-render/cross-hair.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/components/workflow-port-render/index.tsx","webpack://@coze-studio/app/../../packages/workflow/render/src/constants/points.ts","webpack://@coze-studio/app/../../packages/workflow/render/src/workflow-shorcuts-contribution.ts","webpack://@coze-studio/app/../../packages/workflow/setters/src/string/string.tsx","webpack://@coze-studio/app/../../packages/workflow/setters/src/number/number.tsx","webpack://@coze-studio/app/../../packages/workflow/setters/src/boolean/boolean.tsx","webpack://@coze-studio/app/../../packages/workflow/setters/src/enum/enum.tsx","webpack://@coze-studio/app/../../packages/workflow/setters/src/array/array-context.ts","webpack://@coze-studio/app/../../packages/workflow/setters/src/enum-image-model/enum-image-model-label.tsx","webpack://@coze-studio/app/../../packages/workflow/setters/src/enum-image-model/enum-image-model.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/constants/index.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/fields/create-schema-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/typings/idl.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/consts/basic.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/consts/index.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/constants.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/utils/generate-field-validator.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/shared/components-context.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/shared/form-schema.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/shared/schema-context.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/hooks/use-create-form.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/hooks/use-field-schema.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/hooks/use-field-ui-state.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/hooks/use-components.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/hooks/use-form-schema.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/hooks/use-form-ui-state.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/fields/object-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/fields/reactive-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/fields/general-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/fields/recursion-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/form-engine/fields/schema-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/input-number/input-number.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/components/json-editor/base.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/components/json-editor/json-editor.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/utils/debug-url.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/utils/safe-format-json-string.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/utils/safe-json-parse.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/components/bottom-panel/use-resize.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/shared/src/components/bottom-panel/panel.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/input-json/json.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/field-item/item.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/group-collapse/collapse.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/test-run-form/test-run-form.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/input-string/input.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/form-materials/input-number/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/form-materials/input-integer/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/input-time/time.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/select-boolean/select.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/base-form-materials/select-voice/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/components/form-materials/field-item/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/context/form.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/utils/generate-field-component.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/utils/generate-field.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/utils/is-property-empty.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/form/src/utils/stringify-form-values-from-backed.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/utils.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/focus-button/focus-button.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/utils/time.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/utils/basic.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/consts/graph.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/trace-tree/context.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/trace-tree/graph-render.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/utils/graph.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/common/tree/util.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/common/tree/config.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/common/tree/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/trace-tree/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/common/flamethread/config.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/common/flamethread/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/trace-flame-thread/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/utils/index.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/custom-json-viewer/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/common/message-title/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/observation-components/message-panel/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/contexts/trace-list/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-graph/use-trace.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-graph/template.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-graph/table.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-graph/graph.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-select/use-options.ts","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-select/status-select.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/status-tag/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-select/select-option.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-select/date-picker.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-select/trace-select.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-list-panel/header.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-list-panel/list-panel.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-detail-panel/pay-block.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run-next/trace/src/components/trace-detail-panel/trace-detail-panel.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-icon/constants.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-icon/utils.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-icon/file-icon.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-engine/form-core.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-engine/lazy-form-core.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/input/input.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-upload/utils.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-upload/constants.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-upload/use-upload.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/file-upload/file-upload.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/file-upload/file-upload.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/switch/switch.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/input-number/base-input-number.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/input-number/input-integer.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/input-number/input-number.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/voice-select/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/text-area/text-area.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/full-input/full-input.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/form-item/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/form-section/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-materials/input-time/time.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-panel/form-panel-layout.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/test-button/base-test-button.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/resizable-panel/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/resizable-panel/use-resize.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/resizable-panel/base-panel.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/node-event-info/node-event-info.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/pagination/page-item.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/pagination/more-selector.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/pagination/page-selector.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/pagination/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/log-fields/log-field.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/log-fields/empty.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/log-fields/index.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/log-detail.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/log-detail/hooks/use-get-current-result.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/testset/edit-panel/use-edit-form-schemas.ts","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/testset/edit-panel/name-input.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/testset/edit-panel/edit-form-section.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/testset/edit-panel/edit-form.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/testset/edit-panel/chat-flow-edit-form.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/testset/edit-panel/edit-panel.tsx","webpack://@coze-studio/app/../../packages/workflow/test-run/src/components/form-empty/index.tsx"],"sourcesContent":["/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { QuestionLimit as BaseQuestionLimit } from '../../components/question-limit';\n\ntype CheckboxProps = SetterComponentProps;\n\nexport const QuestionLimit: FC<CheckboxProps> = props => (\n  <BaseQuestionLimit {...props} />\n);\n\nexport const questionLimit = {\n  key: 'question-limit',\n  component: QuestionLimit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { Radio as BaseRadio, type RadioProps } from '../../components/radio';\n\nimport styles from './index.module.less';\n\nexport const Radio: FC<RadioProps> = props => (\n  <div className={styles['workflow-node-setter-radio']}>\n    <BaseRadio {...props} />\n  </div>\n);\n\nexport const radio = {\n  key: 'Radio',\n  component: Radio,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  type SetterComponentProps,\n  type SetterExtension,\n} from '@flowgram-adapter/free-layout-editor';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Select as UISelect } from '@coze-arch/coze-design';\n\nimport { type AnyValue } from '../../setters/typings';\n\ntype SelectProps = SetterComponentProps<string>;\n\nconst Select = ({ value, onChange, options, readonly }: SelectProps) => {\n  const {\n    options: selectOptions,\n    size = 'small',\n    style = {},\n    emptyContent,\n  } = options;\n\n  const { getNodeSetterId, concatTestId } = useNodeTestId();\n  const testId = concatTestId(getNodeSetterId('select'), value);\n\n  const onSelect = React.useCallback((selectedOption: AnyValue) => {\n    onChange(selectedOption);\n  }, []);\n\n  return (\n    <>\n      <UISelect\n        size={size}\n        value={value}\n        style={{\n          width: '100%',\n          ...style,\n          pointerEvents: readonly ? 'none' : 'auto',\n        }}\n        onChange={onSelect}\n        defaultValue={selectOptions?.[0]}\n        optionList={selectOptions}\n        emptyContent={emptyContent || I18n.t('workflow_detail_node_nodata')}\n        data-testid={testId}\n      ></UISelect>\n    </>\n  );\n};\n\nexport const select: SetterExtension = {\n  key: 'Select',\n  component: Select,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { SettingOnError } from '@/form-extensions/components/setting-on-error';\n\nimport { withValidation } from '../../components/validation';\n\nconst SettingOnErrorWithValidation = withValidation(\n  ({ value, onChange, readonly, context, options }: SetterComponentProps) => (\n    <SettingOnError\n      value={value}\n      onChange={onChange}\n      readonly={readonly}\n      context={context}\n      options={options}\n    ></SettingOnError>\n  ),\n);\n\nexport const settingOnErrorSetter = {\n  key: 'SettingOnError',\n  component: SettingOnErrorWithValidation,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { isNil } from 'lodash-es';\nimport {\n  type SetterComponentProps,\n  type SetterExtension,\n} from '@flowgram-adapter/free-layout-editor';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { Slider as UISlider } from '@coze-arch/coze-design';\n\ntype SelectProps = SetterComponentProps;\n\nexport const Slider = ({ value, onChange, options, readonly }: SelectProps) => {\n  const { max, min, step, marks } = options;\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <div className=\"pb-1\">\n      <UISlider\n        data-testid={getNodeSetterId('slider')}\n        marks={marks}\n        step={step}\n        max={max}\n        min={min}\n        value={isNil(value) ? undefined : Number(value)}\n        onChange={val => onChange(val)}\n        readonly={readonly}\n        disabled={readonly}\n      />\n    </div>\n  );\n};\n\nexport const slider: SetterExtension = {\n  key: 'Slider',\n  component: Slider,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { type RoleType } from '@coze-arch/idl/social_api';\n\nexport enum MessageGenerateMode {\n  FixedContent = 0,\n  GenerateByAgent = 1,\n}\n\nexport interface OtherMessageSetValue {\n  generate_mode: MessageGenerateMode;\n  content: string;\n}\nexport type RoleMessageSetValue = RoleSpeakerValue & OtherMessageSetValue;\nexport type NicknameVariableMessageSetValue = NicknameSpeakerValue &\n  OtherMessageSetValue;\n\nexport type SpeakerMessageSetValue =\n  | RoleMessageSetValue\n  | NicknameVariableMessageSetValue;\n\nexport interface RoleSpeakerValue {\n  biz_role_id: string;\n  role: string;\n  nickname?: string;\n  role_type: RoleType;\n}\nexport interface NicknameSpeakerValue {\n  biz_role_id: '';\n  role: '';\n  nickname: string;\n  role_type: undefined;\n}\n\nexport type SpeakerSelectValue = RoleSpeakerValue | NicknameSpeakerValue;\n\nexport interface RoleSpeaker extends RoleSpeakerValue {\n  role: string;\n}\nexport interface NicknameSpeaker extends NicknameSpeakerValue {\n  role: '';\n}\n\nexport interface SpeakerSelectOption {\n  label: ReactNode;\n  value: string;\n  biz_role_id: string;\n  role: string;\n  nickname: string;\n  extra: RoleSpeakerValue | NicknameSpeakerValue;\n  role_type?: string;\n}\n\nexport type SpeakerSelectDataSource = Array<SpeakerSelectOption>;\n\nexport enum SpeakerType {\n  Role = '1',\n  Nickname = '2',\n}\n\nexport interface Feedback {\n  success: boolean;\n  error?: Array<{\n    code: string;\n    message: string;\n  }>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useGetSceneFlowRoleList } from '../../../hooks/use-get-scene-flow-params';\nimport { type SpeakerMessageSetValue } from './types';\n\nexport const useNormalizeValueWithRoleList = (\n  remoteValue: Array<SpeakerMessageSetValue | undefined> | undefined,\n) => {\n  const { isLoading, data: roleList } = useGetSceneFlowRoleList();\n  if (!remoteValue || isLoading) {\n    return [];\n  }\n\n  return remoteValue.map(item => {\n    // If there is no biz_role_id, it means it is a nickname variable and will not be processed here\n    if (!item?.biz_role_id) {\n      return item;\n    }\n\n    const role = roleList?.find(\n      _role => _role.biz_role_id === item?.biz_role_id,\n    );\n\n    // If the corresponding role is not found, it means that it has been deleted, and it will not be processed here. The error prompt outside has expired.\n    if (!role) {\n      return item;\n    }\n\n    // If both the nickname saved by value and the character list are available, the character list shall prevail\n    if (role?.nickname && item.nickname) {\n      return {\n        ...item,\n        role: role.role,\n        nickname: role.nickname,\n      } as unknown as SpeakerMessageSetValue;\n    }\n\n    return item;\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode, type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { VariableTypeTag } from '../../components/variable-type-tag';\nimport {\n  MessageGenerateMode,\n  type NicknameVariableMessageSetValue,\n  type RoleMessageSetValue,\n} from './types';\n\ninterface ValueDisplayProps {\n  label: ReactNode;\n  content: ReactNode;\n}\n\nconst ValueDisplay: FC<ValueDisplayProps> = props => (\n  <div className=\"h-full w-full flex items-center\">\n    <div className=\"font-medium pr-2 whitespace-nowrap\">{props.label} : </div>\n    <div className=\"flex-1 flex-nowrap overflow-hidden\">{props.content}</div>\n  </div>\n);\n\nconst ContentDisplay: FC<{\n  value: RoleMessageSetValue | NicknameVariableMessageSetValue;\n}> = props => {\n  const { value } = props;\n  if (value.generate_mode === MessageGenerateMode.FixedContent) {\n    return (\n      <Tooltip content={value.content}>\n        <div className=\"truncate\">{value.content}</div>\n      </Tooltip>\n    );\n  } else {\n    return (\n      <VariableTypeTag className=\"!inline\">\n        {I18n.t(\n          'scene_workflow_chat_node_conversation_content_speaker_generate',\n          {},\n          'Generate by Agent',\n        )}\n      </VariableTypeTag>\n    );\n  }\n};\n\nexport const RoleMessageSetValueDisplay: FC<{\n  value: RoleMessageSetValue;\n}> = props => {\n  const { value } = props;\n\n  if (value) {\n    return (\n      <ValueDisplay\n        label={\n          <>\n            {value.role}\n            {value.nickname\n              ? `(${value.nickname})`\n              : `(${I18n.t(\n                  'scene_edit_roles_list_nickname_empty_seat',\n                  {},\n                  '',\n                )})`}\n          </>\n        }\n        content={<ContentDisplay value={value} />}\n      />\n    );\n  } else {\n    return null;\n  }\n};\n\nexport const NicknameMessageSetValueDisplay: FC<{\n  value: NicknameVariableMessageSetValue;\n}> = props => {\n  const { value } = props;\n  return (\n    <ValueDisplay\n      label={value.nickname}\n      content={<ContentDisplay value={value} />}\n    />\n  );\n};\n\nexport const Placeholder = () => (\n  <div className=\"text-[var(--semi-color-text-0)] opacity-30\">\n    {I18n.t(\n      'scene_workflow_chat_message_content_placeholder',\n      {},\n      'This is a sample message, click to edit.',\n    )}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type RoleMessageSetValue,\n  type NicknameVariableMessageSetValue,\n  type RoleSpeakerValue,\n  type NicknameSpeakerValue,\n} from './types';\n\nexport const isRoleMessageSetValue = (\n  value: RoleMessageSetValue | NicknameVariableMessageSetValue,\n): value is RoleMessageSetValue => value.biz_role_id !== '';\n\nexport const isRoleSpeakerValue = (\n  value: RoleSpeakerValue | NicknameSpeakerValue,\n): value is RoleSpeakerValue => (value as RoleSpeakerValue).biz_role_id !== '';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Space, Tooltip } from '@coze-arch/coze-design';\n\nimport { VariableTypeTag } from '../../components/variable-type-tag';\nimport { useGetSceneFlowRoleList } from '../../../hooks/use-get-scene-flow-params';\nimport {\n  type SpeakerSelectOption,\n  type SpeakerSelectDataSource,\n} from './types';\n\nexport const useGetRoleSpeakerDataSource = (): SpeakerSelectDataSource => {\n  const { data: roleList = [] } = useGetSceneFlowRoleList();\n\n  let emptyNickNameIdx = 1;\n  return roleList.map((item: SpeakerSelectOption) => ({\n    label: (\n      <Space className=\"overflow-hidden\">\n        <Tooltip content={item.role}>\n          <div className=\"overflow-hidden truncate\">{item.role}</div>\n        </Tooltip>\n        <VariableTypeTag>\n          {item.nickname\n            ? item.nickname\n            : `${I18n.t(\n                'scene_edit_roles_list_nickname_empty_seat',\n                {},\n                '',\n              )}${emptyNickNameIdx++}`}\n        </VariableTypeTag>\n      </Space>\n    ),\n    value: item.biz_role_id,\n    biz_role_id: item.biz_role_id,\n    role: item.role,\n    nickname: item.nickname ?? '',\n    extra: {\n      biz_role_id: item.biz_role_id as '',\n      role: item.role as '',\n      nickname: item.nickname as string,\n      role_type: item.role_type,\n    },\n  }));\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  VARIABLE_TYPE_ALIAS_MAP,\n  ViewVariableType,\n} from '@coze-workflow/base/types';\nimport { Space, Tooltip } from '@coze-arch/coze-design';\n\nimport { useGetCurrentInputsParameters } from '../../hooks/use-get-current-input-parameters';\nimport { VariableTypeTag } from '../../components/variable-type-tag';\nimport {\n  type SpeakerSelectDataSource,\n  type SpeakerSelectOption,\n} from './types';\n\nexport const useGetNicknameSpeakerDataSource = (): SpeakerSelectDataSource => {\n  const inputsParameters = useGetCurrentInputsParameters();\n\n  return inputsParameters\n    .filter(item => item.type === ViewVariableType.String)\n    .map<SpeakerSelectOption>(item => ({\n      label: (\n        <Space className=\"overflow-hidden\">\n          <Tooltip content={item.name}>\n            <div className=\"overflow-hidden truncate\">{item.name}</div>\n          </Tooltip>\n          <VariableTypeTag>\n            {VARIABLE_TYPE_ALIAS_MAP[item.type]}\n          </VariableTypeTag>\n        </Space>\n      ),\n      value: item.name,\n      biz_role_id: '',\n      role: '',\n      nickname: item.name,\n      // labelTag: VARIABLE_TYPE_ALIAS_MAP[item.type],\n      extra: {\n        biz_role_id: '',\n        role: '',\n        nickname: item.name,\n        role_type: undefined,\n      },\n    }));\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type SpeakerMessageSetValue } from './types';\nconst SpeakerMessageSetArrayContext = createContext<{\n  value?: Array<SpeakerMessageSetValue | undefined>;\n  readonly?: boolean;\n  testId: string;\n}>({\n  testId: '',\n});\n\nexport const SpeakerMessageSetArrayContextProvider =\n  SpeakerMessageSetArrayContext.Provider;\nexport const useSpeakerMessageSetContext = () =>\n  useContext(SpeakerMessageSetArrayContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState, useEffect } from 'react';\n\nimport { concatTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Select, RadioGroup, Radio, withField } from '@coze-arch/coze-design';\n\nimport { isRoleSpeakerValue } from './utils';\nimport { useGetRoleSpeakerDataSource } from './use-get-role-speaker-datasource';\nimport { useGetNicknameSpeakerDataSource } from './use-get-nickname-speaker-datasource';\nimport {\n  type NicknameSpeakerValue,\n  type RoleSpeakerValue,\n  SpeakerType,\n  type SpeakerSelectDataSource,\n} from './types';\nimport { useSpeakerMessageSetContext } from './context';\n\nimport styles from './speaker-select.module.less';\n\ninterface SpeakerSelectProps {\n  value: RoleSpeakerValue | NicknameSpeakerValue;\n  onChange?: (value: RoleSpeakerValue | NicknameSpeakerValue) => void;\n}\n\nconst OriginSpeakerSelect: FC<SpeakerSelectProps> = props => {\n  const { value, onChange } = props;\n\n  const { value: arrayValue, testId } = useSpeakerMessageSetContext();\n\n  const roleDataSource = useGetRoleSpeakerDataSource();\n  const nicknameDataSource = useGetNicknameSpeakerDataSource();\n\n  const [selectValue, setSelectValue] = useState<string>();\n  const [speakerType, setSpeakerType] = useState<SpeakerType>(SpeakerType.Role);\n\n  const handleSpeakerTypeChange = e => {\n    setSpeakerType(e.target.value);\n  };\n\n  useEffect(() => {\n    if (!value) {\n      setSelectValue(value);\n      return;\n    }\n\n    if (isRoleSpeakerValue(value)) {\n      setSelectValue(value.biz_role_id);\n      setSpeakerType(SpeakerType.Role);\n    } else {\n      setSelectValue((value as NicknameSpeakerValue).nickname);\n      setSpeakerType(SpeakerType.Nickname);\n    }\n  }, [value]);\n\n  const outerTopSlotNode = (\n    <RadioGroup\n      className={`${styles['speaker-type-radio']} w-full mb-4`}\n      type=\"button\"\n      value={speakerType}\n      onChange={handleSpeakerTypeChange}\n    >\n      <Radio\n        value={SpeakerType.Role}\n        className=\"w-[50%]\"\n        data-testid={concatTestId(\n          testId,\n          'messageSet',\n          'speakerSlect',\n          'type',\n          'player',\n        )}\n      >\n        {I18n.t(\n          'scene_workflow_chat_node_conversation_visibility_custom_roles',\n          {},\n          'Player',\n        )}\n      </Radio>\n      <Radio\n        value={SpeakerType.Nickname}\n        className=\"w-[50%]\"\n        data-testid={concatTestId(\n          testId,\n          'messageSet',\n          'speakerSlect',\n          'type',\n          'nickname',\n        )}\n      >\n        {I18n.t(\n          'scene_workflow_chat_node_conversation_visibility_custom_variable',\n          {},\n          'Nickname Variables',\n        )}\n      </Radio>\n    </RadioGroup>\n  );\n\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const handleSelect = (value, record) => {\n    onChange?.({\n      ...record?.extra,\n    });\n  };\n\n  function normalizeDataSource(\n    dataSource: SpeakerSelectDataSource,\n    key: string,\n  ) {\n    const arrayValueWithoutSelectValue = arrayValue?.filter(\n      _value => _value?.[key] !== selectValue,\n    );\n\n    return dataSource.map(item => {\n      if (\n        arrayValueWithoutSelectValue?.find(\n          _value => item?.[key] === _value?.[key],\n        )\n      ) {\n        return {\n          ...item,\n          disabled: true,\n        };\n      } else {\n        return item;\n      }\n    });\n  }\n\n  const dataSource =\n    speakerType === SpeakerType.Role\n      ? normalizeDataSource(roleDataSource, 'biz_role_id')\n      : normalizeDataSource(nicknameDataSource, 'nickname');\n\n  return (\n    <Select\n      value={selectValue}\n      className=\"w-full\"\n      dropdownMatchSelectWidth\n      outerTopSlot={outerTopSlotNode}\n      dropdownStyle={{\n        width: 320,\n      }}\n      placeholder={I18n.t(\n        'scene_workflow_chat_node_conversation_content_speaker_placeholder',\n        {},\n        '',\n      )}\n      onSelect={handleSelect}\n      data-testid={concatTestId(testId, 'messageSet', 'speakerSelect')}\n      emptyContent={I18n.t('workflow_detail_node_nodata')}\n    >\n      {dataSource.map(item => (\n        <Select.Option\n          key={item.value}\n          {...item}\n          data-testid={concatTestId(\n            testId,\n            'messageSet',\n            'speakerSelect',\n            'option',\n            item.value,\n          )}\n        >\n          {item.label}\n        </Select.Option>\n      ))}\n    </Select>\n  );\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const SpeakerSelect: any = withField(OriginSpeakerSelect);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { withField } from '@coze-arch/coze-design';\n\nimport { ExpressionEditorContainer } from '../expression-editor/container';\n\nconst MessageContent = props => {\n  const { value, onChange, context, placeholder, validateStatus } = props;\n\n  return (\n    <ExpressionEditorContainer\n      onChange={onChange}\n      value={value}\n      context={context}\n      placeholder={placeholder}\n      isError={validateStatus === 'error'}\n    />\n  );\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const MessageContentField: any = withField(MessageContent);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useRef, useState } from 'react';\n\nimport classnames from 'classnames';\nimport { type SetterOrDecoratorContext } from '@flowgram-adapter/free-layout-editor';\nimport { concatTestId } from '@coze-workflow/base';\nimport { RoleType } from '@coze-arch/idl/social_api';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Space, Form } from '@coze-arch/coze-design';\n\nimport {\n  MessageGenerateMode,\n  type SpeakerMessageSetValue,\n  type SpeakerSelectValue,\n  type OtherMessageSetValue,\n} from './types';\nimport { SpeakerSelect } from './speaker-select';\nimport { MessageContentField } from './message-content';\nimport { useSpeakerMessageSetContext } from './context';\n\nimport styles from './message-set-form.module.less';\n\nconst { Radio, RadioGroup } = Form;\n\ntype MessageSetFormValue = Partial<\n  {\n    speaker: SpeakerSelectValue;\n  } & OtherMessageSetValue\n>;\n\ninterface MessageSetFormProps {\n  setterContext: SetterOrDecoratorContext;\n  initialValue: SpeakerMessageSetValue | undefined;\n  onSubmit: (value: SpeakerMessageSetValue) => void;\n  onCancel: () => void;\n}\n\nconst formatInitialValue = (\n  initValue: SpeakerMessageSetValue | undefined,\n): MessageSetFormValue | undefined => {\n  if (!initValue) {\n    return initValue;\n  }\n\n  return {\n    speaker: {\n      biz_role_id: initValue.biz_role_id,\n      nickname: initValue.nickname,\n      role: initValue.role,\n      role_type: initValue.role_type as RoleType,\n    },\n    generate_mode: initValue.generate_mode,\n    content: initValue.content,\n  };\n};\n\nexport const MessageSetForm: FC<MessageSetFormProps> = props => {\n  const { testId } = useSpeakerMessageSetContext();\n  const { initialValue, onSubmit, onCancel, setterContext } = props;\n  const formRef = useRef<Form<MessageSetFormValue>>(null);\n\n  const [formValue, setFormValue] = useState<MessageSetFormValue | undefined>(\n    formatInitialValue(initialValue),\n  );\n\n  const handleGenerateModeChange = e => {\n    if (e.target.value === MessageGenerateMode.GenerateByAgent) {\n      formRef.current?.formApi.setValue('content', '');\n    }\n  };\n\n  const handleOnValueChange = (values: MessageSetFormValue) => {\n    setFormValue({ ...values });\n  };\n\n  const handleSubmit = (values: MessageSetFormValue) => {\n    const { speaker = {}, ...others } = values || {};\n    onSubmit?.({\n      ...speaker,\n      ...others,\n    } as unknown as SpeakerMessageSetValue);\n  };\n\n  const handleSpeakerChange = (speaker: SpeakerSelectValue | undefined) => {\n    if (typeof speaker === 'undefined') {\n      return;\n    }\n    if (!speaker.biz_role_id || (speaker.biz_role_id && !speaker.nickname)) {\n      if (\n        formRef.current?.formApi.getValue('generate_mode') ===\n        MessageGenerateMode.FixedContent\n      ) {\n        formRef.current.formApi.setValue(\n          'generate_mode',\n          MessageGenerateMode.GenerateByAgent,\n        );\n        formRef.current.formApi.setValue('content', undefined);\n      }\n    }\n  };\n\n  return (\n    <div className=\"w-[480px] p-6\">\n      <Form<MessageSetFormValue>\n        initValues={formatInitialValue(initialValue)}\n        onSubmit={handleSubmit}\n        onValueChange={handleOnValueChange}\n        ref={formRef}\n        className={styles['speaker-message-set-form']}\n      >\n        <SpeakerSelect\n          field=\"speaker\"\n          label={I18n.t(\n            'scene_workflow_chat_node_conversation_content_speaker',\n            {},\n            'Speaker',\n          )}\n          rules={[\n            {\n              required: true,\n              message: I18n.t(\n                'scene_workflow_chat_node_conversation_batch_empty',\n                {},\n                '',\n              ),\n            },\n          ]}\n          onChange={handleSpeakerChange}\n        />\n        <RadioGroup\n          field=\"generate_mode\"\n          label={I18n.t(\n            'scene_workflow_chat_node_conversation_content_speaker_message_type',\n            {},\n            'Message type',\n          )}\n          rules={[{ required: true }]}\n          onChange={handleGenerateModeChange}\n        >\n          <Radio\n            value={MessageGenerateMode.FixedContent}\n            disabled={\n              formValue?.speaker\n                ? !formValue?.speaker?.biz_role_id ||\n                  (!!formValue.speaker.biz_role_id &&\n                    !formValue.speaker.nickname)\n                : false\n            }\n            data-testid={concatTestId(testId, 'messageSet', 'contentMode')}\n          >\n            {I18n.t(\n              'scene_workflow_chat_node_conversation_content_speaker_fixed',\n              {},\n              'Fixed content',\n            )}\n          </Radio>\n          <Radio\n            value={MessageGenerateMode.GenerateByAgent}\n            disabled={formValue?.speaker?.role_type === RoleType.Host}\n          >\n            {I18n.t(\n              'scene_workflow_chat_node_conversation_content_speaker_generate',\n              {},\n              'Generate by Agent',\n            )}\n          </Radio>\n        </RadioGroup>\n        <MessageContentField\n          field=\"content\"\n          fieldClassName={classnames({\n            '!block':\n              formValue?.generate_mode === MessageGenerateMode.FixedContent,\n            hidden: true,\n          })}\n          label={I18n.t(\n            'scene_workflow_chat_node_conversation_content_speaker_fixed_content',\n            {},\n            'Content',\n          )}\n          context={setterContext}\n          placeholder={I18n.t(\n            'scene_workflow_chat_node_conversation_content_speaker_fixed_placeholder',\n            {},\n            'You can use the {variable name}} method to introduce variables from the input parameters.',\n          )}\n          rules={[\n            {\n              required:\n                formValue?.generate_mode === MessageGenerateMode.FixedContent\n                  ? true\n                  : false,\n            },\n          ]}\n          fieldStyle={{\n            overflow: 'visible',\n          }}\n        />\n        <div className=\"flex justify-end mt-6\">\n          <Space>\n            <Button\n              color=\"primary\"\n              onClick={onCancel}\n              data-testid={concatTestId(testId, 'messageSet', 'cancel')}\n            >\n              {I18n.t('cancel')}\n            </Button>\n            <Button\n              color=\"hgltplus\"\n              htmlType=\"submit\"\n              className=\"btn-margin-right\"\n              onClick={() => formRef.current?.formApi.submitForm()}\n              data-testid={concatTestId(testId, 'messageSet', 'submit')}\n            >\n              {I18n.t('confirm', {}, 'Confirm')}\n            </Button>\n          </Space>\n        </div>\n      </Form>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\n// import { useArraySetterItemContext } from '@coze-workflow/setters';\nimport classnames from 'classnames';\nimport { type SetterOrDecoratorContext } from '@flowgram-adapter/free-layout-editor';\nimport { concatTestId } from '@coze-workflow/base';\nimport { Popover } from '@coze-arch/coze-design';\n// import { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { ValidationErrorWrapper } from '@/form-extensions/components/validation';\n\nimport {\n  RoleMessageSetValueDisplay,\n  NicknameMessageSetValueDisplay,\n  Placeholder,\n} from './value-display';\nimport { isRoleMessageSetValue } from './utils';\nimport { type Feedback, type SpeakerMessageSetValue } from './types';\nimport { MessageSetForm } from './message-set-form';\nimport { useSpeakerMessageSetContext } from './context';\n\nexport const SpeakerMessageSet: FC<{\n  value: SpeakerMessageSetValue | undefined;\n  onChange: (value: SpeakerMessageSetValue) => void;\n  onVisibleChange?: () => void;\n  defaultFocused?: boolean;\n  setterContext: SetterOrDecoratorContext;\n  feedback?: Feedback;\n  index: number;\n}> = props => {\n  const { readonly, testId } = useSpeakerMessageSetContext();\n  const {\n    value,\n    onChange,\n    defaultFocused,\n    setterContext,\n    onVisibleChange,\n    index,\n  } = props;\n\n  const [popupVisible, setPopupVisible] = useState(defaultFocused);\n\n  const handleSubmit = (data: SpeakerMessageSetValue) => {\n    onChange?.(data);\n    setPopupVisible(false);\n  };\n\n  const handleVisibleChange = (visible: boolean) => {\n    setPopupVisible(visible);\n    onVisibleChange?.();\n  };\n\n  return (\n    <div className=\"flex-1 overflow-hidden\">\n      <ValidationErrorWrapper\n        path={`[${index}]`}\n        errorCompClassName={'output-param-name-error-type'}\n      >\n        {options => (\n          <Popover\n            visible={popupVisible}\n            onVisibleChange={handleVisibleChange}\n            trigger=\"click\"\n            content={\n              <MessageSetForm\n                setterContext={setterContext}\n                initialValue={value}\n                onSubmit={values => {\n                  options.onChange();\n                  handleSubmit(values);\n                }}\n                onCancel={() => setPopupVisible(false)}\n              />\n            }\n          >\n            <div\n              className={classnames(\n                'rounded-lg coz-bg-max h-[32px] cursor-pointer px-3 py-[6px] flex  items-center gap-2 overflow-hidden border-solid border',\n                {\n                  'pointer-events-none': readonly,\n                  'border-[var(--semi-color-danger)]': options.showError,\n                  'border-white': !options.showError,\n                },\n              )}\n              data-testid={concatTestId(testId, 'selectedSpeaker')}\n              onBlur={options.onBlur}\n            >\n              <div className=\"flex-1 overflow-hidden\">\n                {value ? (\n                  isRoleMessageSetValue(value) ? (\n                    <RoleMessageSetValueDisplay value={value} />\n                  ) : (\n                    <NicknameMessageSetValueDisplay value={value} />\n                  )\n                ) : (\n                  <Placeholder />\n                )}\n              </div>\n            </div>\n          </Popover>\n        )}\n      </ValidationErrorWrapper>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { z } from 'zod';\nimport { workflowQueryClient } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport { SocialApi } from '@coze-arch/bot-api';\n\nimport { SpeakerMessageSetArray } from './speaker-message-set-array';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const speakerMessageSetArray: any = {\n  key: 'SpeakerMessageSetArray',\n  component: SpeakerMessageSetArray,\n  validator: async ({ value, context }) => {\n    const { playgroundContext } = context;\n    const { globalState } = playgroundContext;\n\n    const res = await workflowQueryClient.fetchQuery({\n      queryKey: ['scene_flow_role_list'],\n      staleTime: Infinity,\n      queryFn: () =>\n        SocialApi.GetMetaRoleList({\n          meta_id: globalState.bindBizID as string,\n        }),\n    });\n\n    const speakerMessageSetSchema = z\n      .object({\n        biz_role_id: z.string(),\n        role: z.string(),\n        nickname: z.string(),\n        generate_mode: z.number(),\n        content: z.string().optional(),\n      })\n      .nullish()\n      .refine(\n        val => {\n          if (!val) {\n            return false;\n          } else {\n            return true;\n          }\n        },\n        {\n          message: I18n.t(\n            'scene_workflow_chat_message_error_content_empty',\n            {},\n            '',\n          ),\n        },\n      )\n      .refine(\n        val => {\n          // If there is no biz_role_id, it means it is a nickname variable, no verification is done\n          if (!val?.biz_role_id) {\n            return true;\n          }\n          const existRole = res.role_list.find(\n            role => role.biz_role_id === val?.biz_role_id,\n          );\n\n          // If the corresponding role is not found, it means that it has been deleted and the role has expired\n          if (!existRole) {\n            return false;\n          }\n\n          // If there is no nickname, it means that the original character has become an empty character, and the prompt here has expired\n          if (val?.nickname && !existRole.nickname) {\n            return false;\n          }\n\n          return true;\n        },\n        {\n          message: I18n.t('scene_workflow_invalid', {}, ''),\n        },\n      );\n\n    if (!value?.length) {\n      return true;\n    }\n\n    const parseResult = value.map((item, index) => {\n      const itemParseResult = speakerMessageSetSchema.safeParse(item);\n\n      if (!itemParseResult.success) {\n        return {\n          success: itemParseResult.success,\n          ...JSON.parse(itemParseResult.error.message)?.[0],\n          path: [index],\n        };\n      } else {\n        return {\n          success: itemParseResult.success,\n        };\n      }\n    });\n    if (parseResult.every(item => item.success)) {\n      return true;\n    } else {\n      return JSON.stringify({\n        name: 'ZodError',\n        issues: parseResult.reduce((buf, item) => {\n          if (!item.success) {\n            buf.push(item);\n          }\n          return buf;\n        }, []),\n        errors: parseResult,\n      });\n    }\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Ref, useRef } from 'react';\n\nimport classnames from 'classnames';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { concatTestId, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconNo, IconAdd } from '@coze-arch/bot-icons';\nimport { Button, IconButton } from '@coze-arch/coze-design';\n\nimport { withValidation } from '@/form-extensions/components/validation';\n\nimport { SortableList, DragHandle } from '../../../components/sortable-list';\nimport { useNormalizeValueWithRoleList } from './use-normalize-value-with-role-list';\nimport { type SpeakerMessageSetValue } from './types';\nimport { SpeakerMessageSet } from './speaker-message-set';\nimport { SpeakerMessageSetArrayContextProvider } from './context';\n\nexport interface SpeakerMessageSetArrayOptions {\n  sortable?: boolean;\n}\n\nconst MAX_LENGTH = 10;\n\ntype SpeakerMessageSetArrayProps = SetterComponentProps<\n  Array<SpeakerMessageSetValue | undefined> | undefined,\n  SpeakerMessageSetArrayOptions\n>;\nexport const SpeakerMessageSetArray =\n  withValidation<SpeakerMessageSetArrayProps>(props => {\n    const { value: remoteValue, onChange, context, options, readonly } = props;\n\n    const value = useNormalizeValueWithRoleList(remoteValue);\n\n    const { getNodeSetterId } = useNodeTestId();\n\n    const testId = getNodeSetterId(context.path);\n\n    const { sortable } = options;\n\n    const currentAddIndexRef = useRef<number | undefined>();\n\n    const node = useCurrentEntity();\n\n    const handleItemChange =\n      (index: number) => (data: SpeakerMessageSetValue) => {\n        currentAddIndexRef.current = undefined;\n        onChange?.(\n          value.map((_item, _index) => {\n            if (_index === index) {\n              return data;\n            } else {\n              return _item;\n            }\n          }),\n        );\n      };\n\n    const handleAddItem = () => {\n      currentAddIndexRef.current = value.length;\n      onChange?.([...(value ?? []), undefined]);\n    };\n    const handleDeleteItem = index => () => {\n      currentAddIndexRef.current = undefined;\n      onChange?.(value.filter((_item, _index) => _index !== index));\n    };\n    const handleSortableChange = data => {\n      currentAddIndexRef.current = undefined;\n      onChange?.(data);\n    };\n\n    const handleVisibleChange = () => {\n      currentAddIndexRef.current = undefined;\n    };\n\n    return (\n      <SpeakerMessageSetArrayContextProvider\n        value={{\n          value,\n          readonly,\n          testId,\n        }}\n      >\n        <div>\n          <div className=\"flex flex-col gap-3\">\n            {sortable && !readonly ? (\n              <SortableList\n                value={value}\n                onChange={handleSortableChange}\n                renderItem={(item, index, dragOption) => (\n                  <div className=\"flex gap-3 items-start\">\n                    {sortable ? (\n                      <DragHandle\n                        ref={dragOption?.dragRef as Ref<HTMLElement>}\n                        testId={concatTestId(testId, 'drag')}\n                        className=\"pt-2\"\n                      />\n                    ) : null}\n                    <SpeakerMessageSet\n                      setterContext={context}\n                      value={item}\n                      onChange={handleItemChange(index)}\n                      defaultFocused={index === currentAddIndexRef.current}\n                      onVisibleChange={handleVisibleChange}\n                      index={index}\n                    />\n                    <IconButton\n                      color=\"secondary\"\n                      size=\"small\"\n                      icon={<IconNo />}\n                      onClick={handleDeleteItem(index)}\n                      data-testid={concatTestId(testId, 'remove')}\n                      style={{\n                        marginTop: 4,\n                      }}\n                    ></IconButton>\n                  </div>\n                )}\n              />\n            ) : (\n              <>\n                {value.map((item, index) => (\n                  <div className=\"flex gap-3 items-start\">\n                    <SpeakerMessageSet\n                      setterContext={context}\n                      value={item}\n                      onChange={handleItemChange(index)}\n                      onVisibleChange={handleVisibleChange}\n                      defaultFocused={index === currentAddIndexRef.current}\n                      index={index}\n                    />\n                    <IconButton\n                      className={classnames({\n                        'pointer-events-none': readonly,\n                      })}\n                      color=\"secondary\"\n                      size=\"small\"\n                      icon={<IconNo />}\n                      onClick={handleDeleteItem(index)}\n                      data-testid={concatTestId(testId, 'remove')}\n                      style={{\n                        marginTop: 4,\n                      }}\n                    ></IconButton>\n                  </div>\n                ))}\n              </>\n            )}\n          </div>\n          <Button\n            className={classnames('mt-3', {\n              'cursor-pointer': value.length < MAX_LENGTH,\n              'cursor-not-allowed': value.length === MAX_LENGTH,\n              'pointer-events-none': readonly,\n            })}\n            color=\"highlight\"\n            icon={<IconAdd />}\n            onClick={handleAddItem}\n            data-testid={`playground.node.${node?.id}.${context.path}.addbutton`}\n            disabled={value.length === MAX_LENGTH}\n          >\n            {I18n.t('workflow_add_input')}\n          </Button>\n        </div>\n      </SpeakerMessageSetArrayContextProvider>\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { SetterExtension } from '@flowgram-adapter/free-layout-editor';\n\nimport { Sql } from './sql';\n\nexport const sql: SetterExtension = {\n  key: 'sql',\n  component: Sql,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { ExpressionEditor } from '../../expression-editor';\nimport { AutoGenerate } from './auto-generate';\n\nimport styles from './index.module.less';\n\nexport const Sql: FC<SetterComponentProps<string>> = props => {\n  const { onChange, readonly } = props;\n  const [key, setKey] = useState<number>(0);\n\n  function handleSubmit(newValue) {\n    onChange(newValue);\n    setKey(key + 1);\n  }\n\n  return (\n    <div className={styles.container}>\n      {!readonly && (\n        <AutoGenerate\n          className={styles['auto-generate']}\n          onSubmit={handleSubmit}\n        />\n      )}\n\n      <ExpressionEditor\n        key={key}\n        {...props}\n        options={{\n          key: '',\n          placeholder: I18n.t('workflow_240218_12'),\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMutation, type DefaultError } from '@tanstack/react-query';\nimport { MemoryApi } from '@coze-arch/bot-api';\n\nimport { useCurrentDatabaseID } from '@/hooks';\n\nexport const useNl2SqlMutation = () => {\n  const databaseID = useCurrentDatabaseID();\n  const {\n    data: sql,\n    mutate: nl2sql,\n    isPending: isFetching,\n  } = useMutation<string, DefaultError, { text: string }>({\n    mutationFn: async ({ text }) => {\n      const data = await MemoryApi.GetNL2SQL({\n        // There is a problem with the back-end interface definition bot_id must be passed, but it is not actually needed. Communicate with the back-end and pass 0 processing here.\n        bot_id: 0,\n        database_id: databaseID,\n        text,\n        table_type: 1,\n      });\n      return data.sql;\n    },\n  });\n\n  return {\n    sql,\n    nl2sql,\n    isFetching,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Spin } from '@coze-arch/coze-design';\n\nimport styles from './result.module.less';\n\ninterface ResultProps {\n  isFetching?: boolean;\n  value?: string;\n  testId?: string;\n}\n\nexport const Result: React.FC<ResultProps> = ({\n  value,\n  isFetching,\n  testId,\n}) => (\n  <Spin\n    wrapperClassName={styles.result}\n    tip=\"Optimizing Prompt...\"\n    spinning={isFetching}\n    data-testid={testId}\n  >\n    {value}\n  </Spin>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { IconCozAiFill } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\ninterface AutoGenerateButtonProps {\n  className?: string;\n  onClick?: () => void;\n  disabled?: boolean;\n}\n\nexport const AutoGenerateButton: React.FC<AutoGenerateButtonProps> = ({\n  onClick,\n  className,\n  disabled = false,\n}) => (\n  <IconButton\n    color=\"highlight\"\n    size=\"small\"\n    className={`${className}`}\n    disabled={disabled}\n    onClick={onClick}\n    icon={<IconCozAiFill />}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useState } from 'react';\n\nimport { IconClose } from '@douyinfe/semi-icons';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FormState } from '@coze-arch/bot-semi/Form';\nimport { Button, Space, Form as BotSemiForm } from '@coze-arch/coze-design';\n\nimport { useNl2SqlMutation } from './use-nl2sql-mutation';\nimport { Result } from './result';\nimport { AutoGenerateButton } from './button';\n\nimport styles from './form.module.less';\n\ninterface FormProps {\n  onSubmit: (value: string) => void;\n  onCancel: () => void;\n}\n\ninterface FormValues {\n  text?: string;\n  sql?: string;\n}\n\nexport const Form: React.FC<FormProps> = ({ onSubmit, onCancel }) => {\n  const formRef = useRef<BotSemiForm>(null);\n  const [formValues = {}, setFormValues] = useState<FormValues | undefined>();\n  const { text } = formValues;\n  const isAutoGenerateEnabled = !!text;\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const { sql, isFetching, nl2sql } = useNl2SqlMutation();\n  const useEnabled = !!sql;\n\n  const handleFormChange = (formState: FormState<FormValues>) => {\n    const values = formState?.values;\n    setFormValues({ ...values });\n  };\n\n  const handleClickAutoGenerate = () => {\n    if (isAutoGenerateEnabled) {\n      nl2sql({ text });\n    }\n  };\n\n  const handleClickUse = () => {\n    if (useEnabled) {\n      onSubmit(sql);\n    }\n  };\n\n  return (\n    // Prevent trigger node selection\n    <div onClick={e => e.stopPropagation()}>\n      <header className={styles.header}>\n        <span className={styles.title}>{I18n.t('workflow_240218_11')}</span>\n        <IconClose\n          className={styles.close}\n          onClick={onCancel}\n          data-testid={getNodeSetterId('popover-close')}\n        />\n      </header>\n\n      <BotSemiForm<FormValues>\n        className={styles.form}\n        ref={formRef}\n        layout=\"vertical\"\n        onChange={handleFormChange}\n      >\n        <BotSemiForm.TextArea\n          field=\"text\"\n          label={I18n.t('workflow_240218_15')}\n          placeholder={I18n.t('workflow_240218_16')}\n          onFocus={e => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n          onClick={e => e.stopPropagation()}\n          data-testid={getNodeSetterId('popover-textarea')}\n        />\n        <BotSemiForm.Slot\n          label={\n            <div className={styles['text-label']}>\n              {I18n.t('workflow_240218_09')}\n              <AutoGenerateButton\n                disabled={!isAutoGenerateEnabled}\n                className={styles['auto-generate-button']}\n                onClick={handleClickAutoGenerate}\n                data-testid={getNodeSetterId('popover-generate-btn')}\n              />\n            </div>\n          }\n        >\n          <Result\n            isFetching={isFetching}\n            value={sql}\n            testId={getNodeSetterId('popover-result')}\n          />\n        </BotSemiForm.Slot>\n      </BotSemiForm>\n\n      <footer className={styles.footer}>\n        <Space spacing={12}>\n          <Button\n            color=\"primary\"\n            onClick={onCancel}\n            data-testid={getNodeSetterId('popover-cancel-btn')}\n          >\n            {I18n.t('workflow_240218_17')}\n          </Button>\n          <Button\n            color=\"hgltplus\"\n            theme=\"solid\"\n            type=\"primary\"\n            onClick={handleClickUse}\n            disabled={!useEnabled}\n            data-testid={getNodeSetterId('popover-use-btn')}\n          >\n            {I18n.t('workflow_240218_18')}\n          </Button>\n        </Space>\n      </footer>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState } from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { Popover } from '@coze-arch/coze-design';\n\nimport { useCurrentDatabaseID } from '@/hooks';\n\nimport { Form } from './form';\nimport { AutoGenerateButton } from './button';\n\nimport styles from './index.module.less';\n\nexport interface AutoGenerateProps {\n  onSubmit: (value: string) => void;\n  className?: string;\n}\n\nexport const AutoGenerate: React.FC<AutoGenerateProps> = ({\n  onSubmit,\n  className,\n}) => {\n  const { getNodeSetterId } = useNodeTestId();\n  const [visible, setVisible] = useState(false);\n  const databaseID = useCurrentDatabaseID();\n  const disabled = !databaseID;\n\n  const handleClickButton = () => {\n    setVisible(prev => !prev);\n  };\n\n  const handleSubmit = (value: string) => {\n    onSubmit(value);\n    setVisible(false);\n  };\n\n  const handleCancel = () => {\n    setVisible(false);\n  };\n\n  return (\n    <Popover\n      keepDOM={true}\n      visible={visible}\n      className={styles.popover}\n      trigger=\"custom\"\n      content={<Form onSubmit={handleSubmit} onCancel={handleCancel} />}\n      position={'leftBottom'}\n      onClickOutSide={() => setVisible(false)}\n      style={{ marginLeft: 44 }}\n    >\n      <div\n        className={className}\n        onClick={handleClickButton}\n        data-testid={getNodeSetterId('auto-generate-button')}\n      >\n        <AutoGenerateButton disabled={disabled} />\n      </div>\n    </Popover>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useMemo } from 'react';\n\nimport { Switch as UISwitch } from '@coze-arch/coze-design';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\ntype SwitchProps = SetterComponentProps;\n\nconst Switch = ({ value, onChange, options, readonly }: SwitchProps) => {\n  const { size = 'default', style = {} } = options;\n\n  const onValueChange = useCallback((checked: boolean) => {\n    onChange(checked);\n  }, []);\n\n  const memoStyle = useMemo(\n    () => ({ ...style, verticalAlign: 'bottom' }),\n    [style],\n  );\n\n  return (\n    <UISwitch\n      disabled={readonly}\n      size={size}\n      checked={value}\n      style={memoStyle}\n      onChange={onValueChange}\n    />\n  );\n};\n\nexport const switchSetter = {\n  key: 'Switch',\n  component: Switch,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/bot-semi';\nimport {\n  PromptEditorRender,\n  type PromptEditorRenderProps,\n} from '@coze-common/prompt-kit-base/editor';\n\nimport { WORKFLOW_PLAYGROUND_CONTENT_ID } from '@/constants';\n\ninterface EditorWithPromptKitProps extends PromptEditorRenderProps {\n  wrapperClassName?: string;\n  wrapperStyle?: React.CSSProperties;\n}\n\nexport const SystemPromptEditor: FC<EditorWithPromptKitProps> = props => {\n  const {\n    defaultValue,\n    wrapperClassName = '',\n    wrapperStyle,\n    readonly,\n    placeholder,\n    value,\n    onChange,\n    isControled,\n    dataTestID,\n    onFocus,\n    onBlur,\n  } = props;\n\n  const [isFocused, setIsFocused] = useState(false);\n\n  const handleOnFocus = () => {\n    setIsFocused(true);\n    onFocus?.();\n  };\n\n  const handleOnBlur = () => {\n    setIsFocused(false);\n    onBlur?.();\n  };\n\n  return (\n    <Tooltip\n      content={I18n.t('db_table_0129_003')}\n      trigger=\"custom\"\n      position=\"top\"\n      autoAdjustOverflow={false}\n      visible={isFocused && readonly}\n      getPopupContainer={() =>\n        document.getElementById(WORKFLOW_PLAYGROUND_CONTENT_ID) ?? document.body\n      }\n    >\n      <div\n        className={wrapperClassName}\n        style={wrapperStyle}\n        onMouseEnter={() => {\n          setIsFocused(true);\n        }}\n        onMouseLeave={() => {\n          setIsFocused(false);\n        }}\n      >\n        <PromptEditorRender\n          defaultValue={defaultValue ?? value}\n          value={value}\n          onChange={onChange}\n          readonly={readonly}\n          placeholder={placeholder}\n          options={{\n            minHeight: 112,\n          }}\n          dataTestID={dataTestID}\n          isControled={isControled}\n          onFocus={handleOnFocus}\n          onBlur={handleOnBlur}\n        />\n      </div>\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useMemo } from 'react';\n\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport { LibraryBlockWidget } from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport {\n  Completion,\n  Validation,\n  HighlightExpressionOnActive,\n} from '@coze-common/editor-plugins/expression';\nimport { InsertInputSlotAction } from '@coze-common/editor-plugins/actions';\nimport { ActionBar } from '@coze-common/editor-plugins/action-bar';\nimport {\n  NLPromptButton,\n  NLPromptModal,\n  NlPromptAction,\n  NlPromptShortcut,\n} from '@coze-workflow/resources-adapter';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { type EditorAPI, useEditor } from '@coze-common/prompt-kit-base/editor';\nimport { RecommendPannel } from '@coze-common/prompt-kit/prompt-recommend';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIIconButton } from '@coze-arch/bot-semi';\nimport { IconCozCrossFill } from '@coze-arch/coze-design/icons';\n\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\nimport { useGlobalState } from '@/hooks';\nimport { type ExpressionEditorProps } from '@/form-extensions/setters/expression-editor';\nimport { useLLMPromptHistory } from '@/form-extensions/hooks';\nimport { useTestRunResult } from '@/components/test-run/img-log/use-test-run-result';\n\nimport { useVariableTree } from '../expression-editor/hooks';\nimport { SystemPromptEditor } from './system-prompt-editor';\n\nimport styles from './index.module.less';\nexport const ExpandSheetEditor: FC<ExpressionEditorProps> = props => {\n  const { getNodeSetterId } = useNodeTestId();\n  const dataTestID = getNodeSetterId(props.context.path);\n\n  const variableTree: ExpressionEditorTreeNode[] = useVariableTree();\n  const editor = useEditor<EditorAPI>();\n  const prompt = editor?.getValue();\n\n  const { setFullscreenPanel } = useNodeFormPanelState();\n\n  const {\n    spaceId,\n    info: { name = '', desc = '' },\n  } = useGlobalState();\n\n  const testRunResult = useTestRunResult();\n  const contextHistory = useLLMPromptHistory(props?.value, testRunResult);\n\n  const getConversationId = () => '';\n  const getPromptContextInfo = useMemo(\n    () => () => ({\n      // No need to pass bot_id workflow scenario\n      botId: '',\n      name,\n      description: desc,\n      contextHistory,\n    }),\n    [contextHistory, name, desc],\n  );\n  return (\n    <div className=\"relative w-full h-full bg-[#FCFCFF] py-[12px] rounded-[8px]\">\n      <div className=\"w-full flex justify-between mb-[12px] px-[20px]\">\n        <div className=\"flex items-center gap-[8px]\">\n          <div\n            className=\"text-[16px] leading-[22px] font-medium\"\n            style={{\n              color: 'var(--Fg-COZ-fg-plus, rgba(6, 7, 9, 0.96))',\n            }}\n          >\n            {I18n.t('workflow_LLM_node_sp_title')}\n          </div>\n        </div>\n        <div className=\"flex items-center gap-[8px]\">\n          <NLPromptButton disabled={props?.readonly}>\n            {I18n.t('prompt_optimization_button')}\n          </NLPromptButton>\n          <UIIconButton\n            onClick={() => setFullscreenPanel(null)}\n            icon={<IconCozCrossFill color=\"#060709CC\" />}\n          />\n        </div>\n      </div>\n      <div\n        className=\"w-full pl-[8px] pr-[20px]\"\n        style={{ height: 'calc(100% - 25px)' }}\n      >\n        <SystemPromptEditor\n          defaultValue={props?.value}\n          onChange={props?.onChange}\n          readonly={props?.readonly}\n          placeholder={(props?.options?.placeholder as () => string)?.()}\n          wrapperClassName={styles['prompt-editor']}\n          wrapperStyle={{\n            height: '100%',\n          }}\n          dataTestID={dataTestID}\n        />\n\n        <InputSlotWidget mode=\"input\" />\n        <LibraryBlockWidget librarys={[]} readonly spaceId={spaceId} />\n        <NlPromptShortcut shortcutKey=\"/\" />\n\n        <HighlightExpressionOnActive />\n        <Completion variableTree={variableTree} />\n        <Validation variableTree={variableTree} />\n\n        {!props?.readonly && (\n          <>\n            <ActionBar>\n              <NlPromptAction />\n              <InsertInputSlotAction />\n            </ActionBar>\n            {prompt?.length === 0 ? (\n              <RecommendPannel\n                source=\"app_detail_page\"\n                tabs={['Recommended', 'Team']}\n                importPromptWhenEmpty={props?.value}\n                spaceId={spaceId}\n                getConversationId={getConversationId}\n                getPromptContextInfo={getPromptContextInfo}\n                onInsertPrompt={insertPrompt => {\n                  props?.onChange?.(insertPrompt);\n                }}\n                listContainerClassName=\"h-[211px]\"\n                cardClassName=\"w-[240xp]\"\n              />\n            ) : null}\n          </>\n        )}\n      </div>\n      <NLPromptModal\n        getConversationId={getConversationId}\n        getPromptContextInfo={getPromptContextInfo}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { NLPromptButton } from '@coze-workflow/resources-adapter';\nimport { PromptEditorProvider } from '@coze-common/prompt-kit-base/editor';\nimport { I18n } from '@coze-arch/i18n';\nimport { UIIconButton, Tooltip } from '@coze-arch/bot-semi';\nimport {\n  IconCozExpand,\n  IconCozKnowledge,\n  IconCozMinimize,\n} from '@coze-arch/coze-design/icons';\n\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\n\nimport { ExpandSheetEditor } from './expand-sheet-editor';\n\nimport styles from './index.module.less';\n\nconst DISABLED_OPICITY = 0.5;\n\nexport const PromptKitBar = props => {\n  const { openPromptLibrary, readonly } = props;\n  const { fullscreenPanel, setFullscreenPanel } = useNodeFormPanelState();\n  const fullscreenPanelVisible = !!fullscreenPanel;\n\n  const handleExpandClick = () => {\n    setFullscreenPanel(\n      fullscreenPanelVisible ? null : (\n        <PublicScopeProvider>\n          <PromptEditorProvider>\n            <ExpandSheetEditor {...props} />\n          </PromptEditorProvider>\n        </PublicScopeProvider>\n      ),\n    );\n  };\n\n  return (\n    <div\n      className={`flex justify-between items-center gap-[8px] h-[28px] ${styles['kit-button-container']}`}\n    >\n      <Tooltip content={I18n.t('workflow_prompt_editor_view_library')}>\n        <UIIconButton\n          onClick={e => {\n            e.stopPropagation();\n            openPromptLibrary();\n          }}\n          icon={\n            <IconCozKnowledge\n              color={`rgba(107, 109, 117, ${readonly ? DISABLED_OPICITY : 1})`}\n            />\n          }\n          disabled={readonly}\n        />\n      </Tooltip>\n\n      <Tooltip\n        content={I18n.t(\n          fullscreenPanelVisible ? 'collapse' : 'workflow_prompt_editor_expand',\n        )}\n      >\n        <UIIconButton\n          onClick={handleExpandClick}\n          icon={\n            fullscreenPanelVisible ? (\n              <IconCozMinimize color=\"#6B6D75\" />\n            ) : (\n              <IconCozExpand color=\"#6B6D75\" />\n            )\n          }\n          color=\"#6B6D75\"\n        />\n      </Tooltip>\n\n      <Tooltip content={I18n.t('prompt_optimization_button_hover_tooltip')}>\n        <div>\n          <NLPromptButton\n            disabled={readonly}\n            onlyIcon\n            className=\"!h-6 !p-1 !rounded-lg\"\n            style={{ minWidth: '24px' }}\n          />\n        </div>\n      </Tooltip>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState, useRef } from 'react';\n\nimport classNames from 'classnames';\nimport { NLPromptModal } from '@coze-workflow/resources-adapter';\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { usePromptLibraryModal } from '@coze-common/prompt-kit';\nimport { LibraryBlockWidget } from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport {\n  Completion,\n  Validation,\n  HighlightExpressionOnActive,\n} from '@coze-common/editor-plugins/expression';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useGlobalState } from '@/hooks';\nimport { FormCard } from '@/form-extensions/components/form-card';\n\nimport { useVariableTree } from '../expression-editor/hooks';\nimport { type ExpressionEditorProps } from '../expression-editor';\nimport { SystemPromptEditor } from './system-prompt-editor';\nimport { PromptKitBar } from './prompt-kit-bar';\n\nimport s from './index.module.less';\n\ninterface EditorWithPromptKitProps extends ExpressionEditorProps {\n  getConversationId: () => string;\n  getPromptContextInfo: () => {\n    botId?: string | undefined;\n    name: string;\n    description: string;\n  };\n}\n\nexport const EditorWithPromptKit: FC<EditorWithPromptKitProps> = props => {\n  const {\n    context,\n    feedbackText,\n    feedbackStatus,\n    getConversationId,\n    getPromptContextInfo,\n    readonly,\n    options: { placeholder },\n    value,\n    onChange,\n  } = props;\n\n  const { getNodeSetterId } = useNodeTestId();\n  const dataTestID = getNodeSetterId(context.path);\n\n  const { spaceId, projectId, workflowId } = useGlobalState();\n  const variableTree: ExpressionEditorTreeNode[] = useVariableTree();\n  const [isFocused, setIsFocused] = useState(false);\n\n  const editor = useEditor<EditorAPI>();\n\n  const promptValue = useRef<string>(value || '');\n\n  const { open, node: PromptLibrary } = usePromptLibraryModal({\n    spaceId,\n    getConversationId,\n    source: 'app_detail_page',\n    projectId,\n    workflowId,\n    editor,\n    getPromptContextInfo,\n    onInsertPrompt: prompt => props?.onChange(prompt),\n  });\n\n  const handleOnFocus = () => {\n    setIsFocused(true);\n  };\n\n  const handleOnBlur = () => {\n    setIsFocused(false);\n  };\n\n  return (\n    <div className={s.container} onBlur={() => onChange?.(promptValue.current)}>\n      <FormCard\n        defaultExpand\n        showBottomBorder\n        noPadding\n        header={I18n.t('workflow_LLM_node_sp_title')}\n        tooltip={I18n.t('workflow_detail_llm_sys_prompt_content_tips')}\n        contentClassName={classNames(s['code-content'], {\n          [s['code-content-focus']]: isFocused,\n        })}\n        feedbackText={feedbackText}\n        feedbackStatus={feedbackStatus}\n        actionButton={\n          <PromptKitBar\n            {...props}\n            getConversationId={getConversationId}\n            getPromptContextInfo={getPromptContextInfo}\n            onInsertPrompt={prompt => {\n              props?.onChange(prompt);\n            }}\n            openPromptLibrary={open}\n          />\n        }\n      >\n        <SystemPromptEditor\n          defaultValue={value}\n          value={value}\n          onChange={v => (promptValue.current = v)}\n          readonly={readonly}\n          placeholder={(placeholder as () => string)?.()}\n          isControled\n          dataTestID={dataTestID}\n          onFocus={handleOnFocus}\n          onBlur={handleOnBlur}\n        />\n\n        <InputSlotWidget mode=\"input\" />\n        <LibraryBlockWidget librarys={[]} readonly spaceId={spaceId} />\n        <HighlightExpressionOnActive />\n        <Completion variableTree={variableTree} />\n        <Validation variableTree={variableTree} />\n      </FormCard>\n      <NLPromptModal\n        getConversationId={getConversationId}\n        getPromptContextInfo={getPromptContextInfo}\n      />\n      {PromptLibrary}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport { NLPromptProvider } from '@coze-workflow/resources-adapter';\nimport { PromptEditorProvider } from '@coze-common/prompt-kit-base/editor';\n\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\nimport { useGlobalState } from '@/hooks';\nimport { useLLMPromptHistory } from '@/form-extensions/hooks';\nimport { useTestRunResult } from '@/components/test-run/img-log/use-test-run-result';\n\nimport { type ExpressionEditorProps } from '../expression-editor';\nimport { EditorWithPromptKit } from './prompt-editor-with-kit';\n\nexport const SystemPrompt: FC<ExpressionEditorProps> = props => {\n  const { readonly, value } = props;\n  const { fullscreenPanel } = useNodeFormPanelState();\n  const fullscreenPanelVisible = !!fullscreenPanel;\n\n  const {\n    info: { name = '', desc = '' },\n  } = useGlobalState();\n\n  const testRunResult = useTestRunResult();\n  const contextHistory = useLLMPromptHistory(value, testRunResult);\n\n  const getConversationId = () => '';\n  const getPromptContextInfo = useMemo(\n    () => () => ({\n      // No need to pass bot_id workflow scenario\n      botId: '',\n      name,\n      description: desc,\n      contextHistory,\n    }),\n    [name, desc, contextHistory],\n  );\n\n  return (\n    <PromptEditorProvider>\n      <NLPromptProvider>\n        <EditorWithPromptKit\n          {...props}\n          readonly={(readonly || fullscreenPanelVisible) as boolean}\n          getConversationId={getConversationId}\n          getPromptContextInfo={getPromptContextInfo}\n        />\n      </NLPromptProvider>\n    </PromptEditorProvider>\n  );\n};\n\nexport const systemPrompt = {\n  key: 'SystemPrompt',\n  component: SystemPrompt,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { InputNumber } from '@coze-arch/coze-design';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\ntype TemperatureProps = SetterComponentProps;\n\nexport const Temperature = ({ value, onChange }: TemperatureProps) => (\n  <InputNumber min={0.1} max={1} step={0.1} value={value} onChange={onChange} />\n);\n\nexport const temperature = {\n  key: 'Temperature',\n  component: Temperature,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { TextArea as UITextArea } from '@coze-arch/coze-design';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype TextAreaProps = SetterComponentProps<any, { max?: number }>;\n\nexport const TextArea = ({\n  value,\n  onChange,\n  options,\n  readonly,\n}: TextAreaProps) => {\n  const { key, max, ...others } = options;\n\n  return (\n    <UITextArea\n      {...others}\n      readonly={readonly}\n      value={value}\n      onChange={onChange}\n      maxCount={max}\n      maxLength={max}\n    />\n  );\n};\n\nexport const textArea = {\n  key: 'TextArea',\n  component: TextArea,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { Text } from '../../components/text';\n\nexport const TextDisplay: FC<SetterComponentProps<string>> = props => {\n  const { value } = props;\n  return <Text className=\"h-8 leading-8\" text={value} />;\n};\n\nexport const textDisplay = {\n  key: 'TextDisplay',\n  component: TextDisplay,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Default time zone, currently used by the task module\n *\n * Domestic: UTC + 8\n * Overseas: UTC + 0\n */\nexport const DEFAULT_TIME_ZONE = IS_OVERSEA ? 'Etc/GMT+0' : 'Asia/Shanghai';\nexport const DEFAULT_TIME_ZONE_OFFSET = IS_OVERSEA ? 'UTC+00:00' : 'UTC+08:00';\n// Unknown time zone for compatibility\nexport const UNKNOWN_TIME_ZONE_OFFSET = 'Others';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { groupBy, toPairs, find, orderBy } from 'lodash-es';\nimport dayjsUTC from 'dayjs/plugin/utc';\nimport dayjsTimezone from 'dayjs/plugin/timezone';\nimport quartersOfYear from 'dayjs/plugin/quarterOfYear';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport dayjs from 'dayjs';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { type CascaderData } from '@coze-arch/bot-semi/Cascader';\n\nimport { DEFAULT_TIME_ZONE, DEFAULT_TIME_ZONE_OFFSET } from '../const';\n\n// dependent on utc plugin\ndayjs.extend(isoWeek); // Attention: The registration order of plugins here cannot be changed at will, and repeated registration of plugins may have bugs.\ndayjs.extend(quartersOfYear);\ndayjs.extend(dayjsUTC);\ndayjs.extend(dayjsTimezone);\n\nexport const dayjsForTimezone = dayjs;\n\nexport interface ITimezoneItem {\n  value: string;\n  label?: string;\n  offset: string;\n  utcOffset?: number;\n}\n\n// Get a list of time zones\nexport const generatedTimezones = () => {\n  let timezoneOptions: CascaderData[] = [];\n  let timezoneMap: ITimezoneItem[] = [];\n  try {\n    // The current international environment\n    const locale = I18n.language ?? 'en-US';\n    /**\n     * List of all time zones\n     * (Intl as any) The typescript version of the project does not contain the supportedValuesOf method, and an error will be reported when compiled\n     */\n    const options = (Intl as any)\n      .supportedValuesOf('timeZone')\n      .map((item: any) => {\n        const formatDateParts = new Intl.DateTimeFormat(locale, {\n          timeZone: item,\n          timeZoneName: 'longGeneric',\n        }).formatToParts(new Date());\n        const { value: timeZoneName } = find(formatDateParts, [\n          'type',\n          'timeZoneName',\n        ]) as Intl.DateTimeFormatPart;\n        const targetTime = dayjs().tz(item);\n        return {\n          value: item,\n          label: `${timeZoneName} - ${item}`,\n          offset: `UTC${targetTime.format('Z')}`,\n          utcOffset: targetTime.utcOffset(),\n        };\n      });\n    timezoneOptions = orderBy(\n      toPairs(groupBy(options, 'offset')),\n      item => {\n        const [offset] = item;\n        return find(options, ['offset', offset])?.utcOffset;\n      },\n      ['asc'],\n    ).map(item => {\n      const [itemKey, itemValue] = item;\n      return {\n        value: itemKey,\n        label: itemKey,\n        children: orderBy(itemValue, ['label'], ['asc']),\n      };\n    });\n    timezoneMap = options;\n  } catch (error: any) {\n    timezoneOptions = [\n      {\n        value: DEFAULT_TIME_ZONE_OFFSET,\n        label: DEFAULT_TIME_ZONE_OFFSET,\n        children: [{ value: DEFAULT_TIME_ZONE, label: DEFAULT_TIME_ZONE }],\n      },\n    ];\n    timezoneMap = [\n      { value: DEFAULT_TIME_ZONE, offset: DEFAULT_TIME_ZONE_OFFSET },\n    ];\n    // If the time zone information cannot be obtained, report the exception to slardar.\n    logger.persist.error({\n      message: 'Custom Error: Unable to obtain accurate time zone list',\n      error,\n    });\n  }\n  return { timezoneOptions, timezoneMap };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport { cloneDeep, find, noop } from 'lodash-es';\nimport classNames from 'classnames';\nimport {\n  type SetterComponentProps,\n  type SetterExtension,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type LiteralExpression } from '@coze-workflow/base';\nimport { ValueExpressionType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport {\n  Cascader,\n  Highlight,\n  type CascaderData,\n  type FilterRenderProps,\n} from '@coze-arch/coze-design';\n\nimport { generatedTimezones } from './utils/timezone';\nimport { UNKNOWN_TIME_ZONE_OFFSET } from './const';\n\nimport styles from './index.module.less';\n\ninterface IProps {\n  className?: string;\n  showClear?: boolean; // Can it be emptied?\n  defaultValue?: string; // default value\n}\ntype TimezoneCascaderProps = SetterComponentProps<string, IProps>;\n\nexport const TimezoneCascader: FC<TimezoneCascaderProps> = props => {\n  const { options, value: _value, onChange = noop, readonly } = props;\n  const { className, showClear = false, defaultValue } = options;\n  const value = ((_value as unknown as LiteralExpression)?.content ??\n    _value ??\n    defaultValue) as string;\n\n  // time zone list\n  const { timezoneOptions: TIME_ZONE_OPTIONS, timezoneMap: TIME_ZOME_MAP } =\n    useMemo(() => generatedTimezones(), []);\n\n  // Time zone selector option generation logic\n  const [timezoneOptions, timezoneMap] = useMemo(() => {\n    const timezoneOptionsBase = cloneDeep(TIME_ZONE_OPTIONS);\n    const timezoneMapBase = cloneDeep(TIME_ZOME_MAP);\n    // When the user has selected a time zone, but the current environment does not support compatibility with the corresponding time zone, insert the unknown time zone option Compatible at the end of the option\n    if (value && timezoneMapBase.every(e => e.value !== value)) {\n      timezoneOptionsBase.push({\n        value: UNKNOWN_TIME_ZONE_OFFSET,\n        label: UNKNOWN_TIME_ZONE_OFFSET,\n        children: [{ value, label: value }],\n      });\n      timezoneMapBase.push({\n        value,\n        offset: UNKNOWN_TIME_ZONE_OFFSET,\n      });\n    }\n    return [timezoneOptionsBase, timezoneMapBase];\n  }, []);\n\n  const timezoneValue = useMemo(() => {\n    const item = find(timezoneMap, ['value', value]);\n    if (item) {\n      return [item.offset, item.value];\n    } else {\n      return undefined;\n    }\n  }, [value, timezoneMap]);\n\n  // Traverse query time zone offset\n  const findTimezoneValue = (nodes: string[], key: string) => {\n    if (Array.isArray(nodes) && nodes.length > 1) {\n      const [offsetValue, timezoneLabel] = nodes;\n      const item = find(timezoneOptions, ['value', offsetValue]);\n      if (item && Array.isArray(item.children)) {\n        const option = find(item.children, [key, timezoneLabel]);\n        if (option && option.value) {\n          return option.value as string;\n        }\n      }\n    }\n  };\n\n  const filterSorter = (\n    first: CascaderData,\n    second: CascaderData,\n    inputValue: string,\n  ) => {\n    if (\n      Array.isArray(first) &&\n      first.length > 1 &&\n      Array.isArray(second) &&\n      second.length > 1\n    ) {\n      const keyword: string = (inputValue || '').toLowerCase();\n      const firstLabelLowerCase: string = (first[1].label || '').toLowerCase();\n      const secondLabelLowerCase: string = (\n        second[1].label || ''\n      ).toLowerCase();\n      const firstLabelArray = firstLabelLowerCase.split(' ');\n      const secondLabelArray = secondLabelLowerCase.split(' ');\n      if (firstLabelArray.findIndex(e => e === keyword) === 0) {\n        return -1;\n      }\n      if (secondLabelArray.findIndex(e => e === keyword) === 0) {\n        return 1;\n      }\n      if (firstLabelLowerCase.includes(keyword)) {\n        return -1;\n      }\n      if (secondLabelLowerCase.includes(keyword)) {\n        return 1;\n      }\n    }\n    return 0;\n  };\n\n  // custom highlighting logic\n  const filterRender = (filterRenderProps: FilterRenderProps) => {\n    const { className: cls, inputValue, data, onClick } = filterRenderProps;\n    // Put together the copy of the multi-level options\n    const labelString = data.map(e => e.label).join(' / ');\n    return (\n      <li\n        role=\"menuitem\"\n        className={classNames('semi-cascader-option-flatten', cls)}\n        onClick={onClick}\n      >\n        <span className=\"semi-cascader-option-label\">\n          <span\n            aria-hidden=\"true\"\n            className=\"semi-cascader-option-icon semi-cascader-option-icon-empty\"\n          ></span>\n          <Highlight\n            sourceString={labelString}\n            searchWords={[inputValue]}\n            highlightStyle={{\n              color: 'var(--light-usage-primary-color-primary, #4d53e8)',\n              backgroundColor: 'transparent',\n            }}\n          />\n        </span>\n      </li>\n    );\n  };\n\n  return (\n    <Cascader\n      size=\"small\"\n      className={`${className} w-full`}\n      dropdownClassName={styles.dropdown}\n      showClear={showClear}\n      filterTreeNode\n      filterSorter={filterSorter}\n      filterRender={filterRender}\n      disabled={readonly}\n      placeholder={I18n.t('task_preset_timezone')}\n      treeData={timezoneOptions}\n      value={timezoneValue}\n      onChange={nodes => {\n        const newTimezone = findTimezoneValue(nodes as string[], 'value');\n        onChange({\n          type: ValueExpressionType.LITERAL,\n          content: newTimezone,\n        });\n        if (newTimezone) {\n          sendTeaEvent(EVENT_NAMES.select_scheduled_tasks_timezone, {\n            timezone: newTimezone,\n          });\n        }\n      }}\n      displayRender={nodes => findTimezoneValue(nodes as string[], 'label')}\n    />\n  );\n};\n\nexport const timezone: SetterExtension = {\n  key: 'Timezone',\n  component: TimezoneCascader,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\nimport { useNodeTestId } from '@coze-workflow/base';\n\nimport { feedbackStatus2ValidateStatus } from '../components/utils';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function toStandardSetter(Setter) {\n  // Fix an issue where expressions passed to setters do not respond\n  const ObserverSetter = Setter;\n  return function StandardSetter(props: SetterComponentProps) {\n    const {\n      value,\n      onChange,\n      readonly = false,\n      options,\n      feedbackStatus,\n    } = props;\n\n    const { getNodeSetterId } = useNodeTestId();\n    const setterTestId = getNodeSetterId('');\n    const validateStatus = feedbackStatus2ValidateStatus(feedbackStatus);\n\n    return (\n      <ObserverSetter\n        value={value}\n        onChange={onChange}\n        {...options}\n        readonly={readonly || options.readonly}\n        testId={setterTestId}\n        validateStatus={validateStatus}\n      />\n    );\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ModalI18nKey } from '@coze-workflow/components/workflow-modal';\nimport {\n  WorkflowModalFrom,\n  useOpenWorkflowDetail,\n  useWorkflowModal,\n  type BotPluginWorkFlowItem,\n} from '@coze-workflow/components';\nimport { WorkflowMode } from '@coze-arch/idl/developer_api';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { useGlobalState } from '@/hooks';\nimport { IconNameDescCard } from '@/form-extensions/components/icon-name-desc-card';\n\ntype TriggerBindWorkflowProps = SetterComponentProps<\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  any,\n  {\n    selectedWorkflowInfo?: BotPluginWorkFlowItem;\n  }\n>;\n\nexport const TriggerBindWorkflow = ({\n  value,\n  onChange,\n  options,\n  readonly,\n}: TriggerBindWorkflowProps) => {\n  const { selectedWorkflowInfo } = options;\n\n  const { projectId, workflowId, spaceId, getProjectApi, playgroundProps } =\n    useGlobalState();\n\n  const projectApi = getProjectApi();\n\n  const openWorkflowDetail = useOpenWorkflowDetail();\n\n  const sourceTitle = I18n.t('workflow_241119_01');\n\n  const {\n    node: workflowModal,\n    open: openWorkflow,\n    close: closeWorkflow,\n  } = useWorkflowModal({\n    from: WorkflowModalFrom.ProjectWorkflowAddNode,\n    flowMode: WorkflowMode.Workflow,\n    onAdd: (item, config) => {\n      onChange?.(item.workflow_id);\n      closeWorkflow();\n    },\n    onRemove: item => {\n      onChange?.(undefined);\n      closeWorkflow();\n    },\n    onCreateSuccess: val => {\n      closeWorkflow();\n      playgroundProps?.refetchProjectResourceList?.();\n      openWorkflowDetail({\n        workflowId: val.workflowId,\n        spaceId: val.spaceId,\n        projectId,\n        ideNavigate: projectApi?.navigate,\n      });\n    },\n    i18nMap: {\n      [ModalI18nKey.ListItemRemove]: {\n        key: 'scene_workflow_delete_workflow_button',\n        options: { source: sourceTitle },\n      },\n      [ModalI18nKey.ListItemRemoveConfirmTitle]: {\n        key: 'scene_workflow_delete_workflow_popup_title',\n        options: { source: sourceTitle },\n      },\n      [ModalI18nKey.ListItemRemoveConfirmDescription]: {\n        key: 'scene_workflow_delete_workflow_popup_subtitle',\n        options: { source: sourceTitle },\n      },\n    },\n    hiddenLibrary: true,\n    projectId,\n    excludedWorkflowIds: [workflowId],\n    workFlowList: selectedWorkflowInfo ? [selectedWorkflowInfo] : [],\n  });\n\n  const isWfInvalid = !selectedWorkflowInfo;\n  const isLibraryWf = selectedWorkflowInfo && !selectedWorkflowInfo?.project_id;\n  return (\n    <div className=\"relative\">\n      {readonly ? (\n        <></>\n      ) : (\n        <div className=\"absolute right-[0px] top-[-28px]\">\n          <IconButton\n            onClick={openWorkflow}\n            // theme=\"borderless\"\n            icon={<IconCozPlus className=\"text-sm\" />}\n            color=\"highlight\"\n            size=\"small\"\n          />\n        </div>\n      )}\n      {value ? (\n        <>\n          <IconNameDescCard\n            readonly={readonly}\n            name={\n              isWfInvalid\n                ? I18n.t(\n                    'worklfow_trigger_bind_delete',\n                    {},\n                    '',\n                  )\n                : selectedWorkflowInfo?.name\n            }\n            description={selectedWorkflowInfo?.desc}\n            icon={selectedWorkflowInfo?.icon}\n            onRemove={() => {\n              onChange?.(undefined);\n            }}\n            onClick={() => {\n              if (!isLibraryWf) {\n                projectApi?.navigate(`/workflow/${value}`);\n              } else {\n                window.open(\n                  `/work_flow?space_id=${spaceId}&workflow_id=${value}`,\n                  '_blank',\n                );\n              }\n            }}\n          />\n          {isLibraryWf ? (\n            <div className=\"mt-[-4px] text-[12px] coz-fg-hglt-red\">\n              {I18n.t(\n                'workflow_trigger_bindwf_lib_error',\n                {},\n                '',\n              )}\n            </div>\n          ) : (\n            <></>\n          )}\n        </>\n      ) : (\n        <div className=\"text-[12px] coz-fg-secondary\">\n          {I18n.t(\n            'workflow_trigger_user_create_bind_tooltips',\n            {},\n            '',\n          )}\n        </div>\n      )}\n      {workflowModal}\n    </div>\n  );\n};\n\nexport const triggerBindWorkflow = {\n  key: 'TriggerBindWorkflow',\n  component: TriggerBindWorkflow,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useState } from 'react';\n\nimport dayjs from 'dayjs';\nimport classnames from 'classnames';\nimport { useLatest } from 'ahooks';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\nimport { cronJobTranslator } from '@coze-workflow/components';\nimport { TriggerSetType, workflowApi } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozIllusEmpty,\n  IconCozIllusEmptyDark,\n} from '@coze-arch/coze-design/illustrations';\nimport {\n  IconCozEye,\n  IconCozPlayCircle,\n  IconCozRefresh,\n  IconCozTrashCan,\n  IconCozTrigger,\n} from '@coze-arch/coze-design/icons';\nimport {\n  Button,\n  EmptyState,\n  IconButton,\n  Modal,\n  Table,\n  Toast,\n} from '@coze-arch/coze-design';\n\nimport { useGlobalState } from '@/hooks';\nimport { IconNameDescCard } from '@/form-extensions/components/icon-name-desc-card';\n\nimport { Notify } from '../notify';\n\nimport styles from './index.module.less';\n\ntype TriggerListProps = SetterComponentProps<\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  any,\n  {\n    bindWorkflowId?: string;\n  }\n>;\n\ninterface TriggerInfo {\n  triggerId?: string;\n  triggerName?: string;\n  createTime?: string;\n  triggerTime?: string;\n  useId?: string;\n}\n\nexport const TriggerListSetter = ({\n  value,\n  onChange,\n  options,\n  readonly,\n}: TriggerListProps) => {\n  // const { bindWorkflowId } = options;\n  const { spaceId, projectId, getProjectApi } = useGlobalState();\n  const projectApi = getProjectApi();\n  const [currentPage, setPage] = useState(1);\n  const pageSize = 10;\n  const [loading, setLoading] = useState(false);\n  const [visible, setVisible] = useState(false);\n  const [list, setList] = useState<{\n    list: TriggerInfo[];\n    total: number;\n  }>({\n    list: [],\n    total: 0,\n  });\n\n  const latestLoading = useLatest(loading);\n  const loadTriggerList = useCallback(async (page = 1) => {\n    if (latestLoading.current) {\n      return;\n    }\n    try {\n      setLoading(true);\n      setPage(page);\n      const triggerList = await workflowApi.ListTriggers({\n        project_id: projectId ?? '',\n        space_id: spaceId,\n        // workflow_id: bindWorkflowId,\n        trigger_id: '',\n        set_type: TriggerSetType.DEBUG_USERSET,\n        page_size: pageSize,\n        page_num: page,\n      });\n\n      setList({\n        list:\n          triggerList?.data?.trigger_list?.map(d => ({\n            triggerId: d.trigger_id,\n            triggerName: d.name,\n            createTime: dayjs(d.create_time).format('YYYY-MM-DD HH:mm:ss'),\n            triggerTime: JSON.parse(d.config ?? '{}')?.crontab,\n            useId: `${d.user_id}`,\n          })) ?? [],\n        total: Number(triggerList?.data?.total ?? 0),\n      });\n    } catch (e) {\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const [testRunning, setTestRunning] = useState(false);\n  const testRun = async (d: TriggerInfo) => {\n    try {\n      setTestRunning(true);\n\n      const result = await workflowApi.TestRunTrigger({\n        space_id: spaceId,\n        project_id: projectId ?? '',\n        trigger_id: d.triggerId ?? '',\n      });\n\n      projectApi?.sendMsgOpenWidget(`/workflow/${result?.data?.workflow_id}`, {\n        name: 'process',\n        data: { executeId: result?.data?.execute_id },\n      });\n      setVisible(false);\n    } finally {\n      setTestRunning(false);\n    }\n  };\n\n  const columns = [\n    {\n      title: I18n.t('workflow_trigger_user_create_id', {}, 'id'),\n      dataIndex: 'triggerId',\n      // width: 400,\n      render: d => `${d}`,\n    },\n    {\n      title: I18n.t('workflow_trigger_user_create_name', {}, ''),\n      dataIndex: 'triggerName',\n      render: d => `${d}`,\n    },\n    {\n      title: I18n.t('workflow_trigger_user_create_time', {}, ''),\n      dataIndex: 'createTime',\n      render: d => `${d}`,\n    },\n    {\n      title: I18n.t('workflow_trigger_user_create_schedula', {}, ''),\n      dataIndex: 'triggerTime',\n      render: d => (\n        <>\n          <div>{`${d}`}</div>\n          <div>{cronJobTranslator(d)}</div>\n        </>\n      ),\n    },\n    {\n      title: I18n.t('workflow_trigger_user_create_userid', {}, 'id'),\n      dataIndex: 'useId',\n      render: d => `${d}`,\n    },\n    {\n      title: I18n.t('workflow_trigger_user_create_action', {}, ''),\n      width: 120,\n      render: d => (\n        <div className=\"flex flex-row gap-[8px] justify-end\">\n          <IconButton\n            color=\"secondary\"\n            icon={<IconCozPlayCircle />}\n            loading={testRunning}\n            onClick={() => {\n              testRun(d);\n            }}\n          />\n          {readonly ? (\n            <></>\n          ) : (\n            <IconButton\n              color=\"secondary\"\n              icon={<IconCozTrashCan />}\n              onClick={async () => {\n                try {\n                  await workflowApi.DeleteTrigger({\n                    space_id: spaceId,\n                    project_id: projectId ?? '',\n                    trigger_id: d.triggerId ?? '',\n                    set_type: TriggerSetType.DEBUG_USERSET,\n                  });\n\n                  loadTriggerList(currentPage);\n                } catch (e) {\n                  Toast.error(e.message);\n                }\n              }}\n            />\n          )}\n        </div>\n      ),\n    },\n  ];\n\n  return (\n    <div className=\"!p-0\">\n      <div className=\"\">\n        <IconNameDescCard\n          icon={\n            <div className=\"h-[32px] w-[32px] flex flex-row items-center justify-center rounded-[4px] bg-[#8E4EFF]\">\n              <IconCozTrigger className=\"text-white\" />\n            </div>\n          }\n          name={I18n.t('workflow_trigger_user_create_list', {}, '')}\n          description={I18n.t(\n            'workflow_user_trigger_list_descr',\n            {},\n            '',\n          )}\n          readonly={readonly || IS_BOT_OP}\n          showDeleteBtn={false}\n          alwaysShowActions={true}\n          actions={\n            <div className=\"flex flex-row gap-[2px] items-center\">\n              <IconCozEye />\n              <Button\n                color=\"secondary\"\n                theme=\"borderless\"\n                onClick={() => {\n                  setVisible(true);\n                  loadTriggerList(1);\n                }}\n                className=\"!p-0\"\n              >\n                {I18n.t('workflow_trigger_user_create_list_read', {}, '')}\n              </Button>\n            </div>\n          }\n        />\n      </div>\n      <Modal\n        title={I18n.t('workflow_trigger_user_create_list', {}, '')}\n        width={'80%'}\n        visible={visible}\n        onCancel={() => {\n          setVisible(false);\n        }}\n        footer={\n          <div className=\"flex flex-row gap-[8px] justify-end\">\n            <Button\n              color=\"primary\"\n              onClick={() => {\n                setVisible(false);\n              }}\n              loading={loading}\n            >\n              {I18n.t('workflow_trigger_user_create_close', {}, '')}\n            </Button>\n            <Button\n              icon={<IconCozRefresh />}\n              color=\"primary\"\n              onClick={() => {\n                loadTriggerList(1);\n              }}\n              className=\"!ml-0\"\n            >\n              {I18n.t('workflow_trigger_user_create_refresh', {}, '')}\n            </Button>\n          </div>\n        }\n      >\n        <div className={classnames(styles['trigger-list'], 'flex flex-col')}>\n          <div className=\"coz-bg-max sticky top-0 z-10 pb-[16px]\">\n            <Notify\n              align=\"left\"\n              className=\"rounded-[8px]\"\n              isBreakLine\n              text={I18n.t(\n                'workflow_user_trigger_banner',\n                {},\n                '',\n              )}\n            />\n          </div>\n          {list?.list?.length === 0 ? (\n            <div className=\"w-full flex-1 flex flex-col justify-center\">\n              <EmptyState\n                size=\"full_screen\"\n                icon={<IconCozIllusEmpty />}\n                darkModeIcon={<IconCozIllusEmptyDark />}\n                title={I18n.t(\n                  'workflow_trigger_user_create_nodata',\n                  {},\n                  '',\n                )}\n                description={I18n.t(\n                  'workflow_trigger_user_create_advice',\n                  {},\n                  '',\n                )}\n              />\n            </div>\n          ) : (\n            <Table\n              tableProps={{\n                columns,\n                dataSource: list.list,\n                loading,\n                pagination: {\n                  currentPage,\n                  pageSize,\n                  total: list.total,\n                  onPageChange: loadTriggerList,\n                },\n              }}\n            />\n          )}\n        </div>\n      </Modal>\n    </div>\n  );\n};\nexport const triggerList = {\n  key: 'TriggerList',\n  component: TriggerListSetter,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\n\ntype IProps = SetterComponentProps<\n  unknown,\n  {\n    nameLabel?: string;\n    valueLabel?: string;\n    nameWidth?: string;\n  }\n>;\n\nconst TriggerParameterTitleSetter = ({ options }: IProps) => {\n  const { nameLabel, valueLabel, nameWidth } = options;\n\n  return (\n    <div className=\"flex flex-row\">\n      <div\n        className=\"coz-fg-secondary\"\n        style={{\n          width: nameWidth,\n        }}\n      >\n        {nameLabel}\n      </div>\n      <div className=\"flex-1 coz-fg-secondary\">{valueLabel}</div>\n    </div>\n  );\n};\n\nexport const triggerParameterTitle = {\n  key: 'TriggerParameterTitle',\n  component: TriggerParameterTitleSetter,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  type SetterComponentProps,\n  type SetterExtension,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type ViewVariableType, useNodeTestId } from '@coze-workflow/base';\nimport { type SelectProps } from '@coze-arch/coze-design';\n\nimport { useRefInputProps } from '@/hooks/use-ref-input';\n\nimport { valueExpressionValidator } from '../../validators/value-expression-validator';\nimport { ValueExpressionInput as ValueExpressionInputComponent } from '../../components/value-expression-input';\ntype ValueExpressionInputProps = SetterComponentProps;\n\nconst ValueExpressionInput = (props: ValueExpressionInputProps) => {\n  const {\n    value,\n    onChange,\n    options,\n    feedbackStatus,\n    readonly: globalReadonly,\n    context,\n  } = props;\n\n  const {\n    style,\n    literalStyle,\n    disabledTypes,\n    availableFileTypes,\n    literalDisabled = false,\n    refDisabled = false,\n    showClear = false,\n    hideDeleteIcon = false,\n    hideSettingIcon = false,\n    variableTagStyle,\n    readonly: setterReadonly,\n    inputType,\n    constantType,\n    customFilterVar,\n    literalConfig = {},\n    inputPlaceholder,\n  } = options;\n\n  const readonly = globalReadonly || setterReadonly;\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const targetInputType = inputType;\n\n  const { variablesDataSource, validateStatus } = useRefInputProps({\n    disabledTypes,\n    value,\n    onChange,\n    node: context.node,\n    feedbackStatus,\n  });\n\n  return (\n    <ValueExpressionInputComponent\n      testId={getNodeSetterId(context.path)}\n      readonly={readonly}\n      value={value}\n      onChange={onChange}\n      inputType={constantType ?? targetInputType}\n      variablesDatasource={variablesDataSource}\n      validateStatus={validateStatus as SelectProps['validateStatus']}\n      style={style}\n      disabledTypes={disabledTypes as ViewVariableType[]}\n      availableFileTypes={availableFileTypes}\n      literalDisabled={literalDisabled}\n      refDisabled={refDisabled}\n      showClear={showClear}\n      customFilterVar={customFilterVar}\n      literalConfig={literalConfig}\n      literalStyle={literalStyle}\n      hideDeleteIcon={hideDeleteIcon}\n      hideSettingIcon={hideSettingIcon}\n      variableTagStyle={variableTagStyle}\n      inputPlaceholder={inputPlaceholder}\n    />\n  );\n};\n\nexport const valueExpressionInput: SetterExtension = {\n  key: 'ValueExpressionInput',\n  component: ValueExpressionInput,\n  validator: ({ value, context }) => {\n    const { meta, playgroundContext, node } = context;\n    const { required } = meta;\n    return valueExpressionValidator({\n      value,\n      playgroundContext,\n      node,\n      required,\n    });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { get } from 'lodash-es';\nimport { type SetterComponentProps } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type ViewVariableType,\n  type RefExpression,\n  ValueExpressionType,\n} from '@coze-workflow/base';\n\nimport { VariableSelector } from '../../components/tree-variable-selector';\n\nimport styles from './index.module.less';\n\ninterface VariableSelectOptions {\n  disabledTypes?: Array<ViewVariableType>;\n  forArrayItem?: boolean;\n}\n\nfunction VariableSelectSetter({\n  value,\n  onChange,\n  options,\n}: SetterComponentProps<RefExpression, VariableSelectOptions>): JSX.Element {\n  const { disabledTypes, forArrayItem } = options;\n  const handleOnChange = (innerValue: string[] | undefined) => {\n    if (innerValue !== undefined) {\n      onChange?.({\n        type: ValueExpressionType.REF,\n        content: {\n          keyPath: innerValue,\n        },\n      });\n    }\n  };\n  return (\n    <VariableSelector\n      className={styles['variable-select-setter']}\n      value={get(value, 'content.keyPath') as string[]}\n      onChange={handleOnChange}\n      disabledTypes={disabledTypes}\n      forArrayItem={forArrayItem}\n    />\n  );\n}\n\nexport const variableSelect = {\n  key: 'VariableSelect',\n  component: VariableSelectSetter,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type CSSProperties, useCallback, useState } from 'react';\n\nimport { get } from 'lodash-es';\nimport {\n  type SetterComponentProps,\n  type ValidatorProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  useVariableChange,\n  type ViewVariableType,\n  WorkflowVariableService,\n} from '@coze-workflow/variable';\nimport {\n  type RefExpression,\n  ValueExpressionType,\n  useNodeTestId,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { type CascaderProps } from '@coze-arch/bot-semi/Cascader';\n\nimport { valueExpressionValidator } from '../../validators';\nimport { VariableSelector } from '../../components/tree-variable-selector';\n\nimport styles from './index.module.less';\n\ninterface ViewVariableSelectSetterOptions {\n  disabledTypes?: ViewVariableType[];\n  style?: CSSProperties;\n  forArrayItem?: boolean;\n}\n\ntype ViewVariableSelectSetterProps = SetterComponentProps<\n  RefExpression,\n  ViewVariableSelectSetterOptions\n>;\n\nfunction ViewVariableSelectSetter(\n  props: ViewVariableSelectSetterProps,\n): JSX.Element {\n  const { value, onChange, readonly, options, context } = props;\n  const { disabledTypes = [], style = {}, forArrayItem = false } = options;\n  const [validation, setValidation] = useState<{\n    status: CascaderProps['validateStatus'];\n    message?: string;\n  }>({\n    status: 'default',\n  });\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const variableService: WorkflowVariableService = useService(\n    WorkflowVariableService,\n  );\n\n  const node = useCurrentEntity();\n\n  const keyPath = get(value, 'content.keyPath') as string[];\n\n  useVariableChange({\n    keyPath,\n    onChange: ({ variableMeta }) => {\n      if (!variableMeta) {\n        setValidation({\n          status: 'error',\n          message: I18n.t('card_builder_userVar_list_search_empty'),\n        });\n        onChange({ type: ValueExpressionType.REF });\n        return;\n      }\n\n      // Disable type, clear\n      if (disabledTypes.includes(variableMeta.type)) {\n        setValidation({ status: 'error' });\n        onChange({ type: ValueExpressionType.REF });\n        return;\n      }\n\n      setValidation({\n        status: 'success',\n      });\n    },\n  });\n\n  const handleOnChange = (newValue: string[] | undefined) => {\n    if (newValue !== undefined) {\n      onChange?.({\n        type: ValueExpressionType.REF,\n        content: {\n          keyPath: newValue,\n        },\n      });\n      setValidation({\n        status: 'success',\n      });\n    }\n  };\n\n  const optionFilter = useCallback(\n    (v: string[]) => {\n      const subVariableMeta = variableService.getViewVariableByKeyPath(v, {\n        node,\n      });\n      if (\n        subVariableMeta?.type &&\n        !disabledTypes.includes(subVariableMeta.type)\n      ) {\n        return true;\n      }\n      return false;\n    },\n    [variableService],\n  );\n\n  return (\n    <VariableSelector\n      className={styles['view-variable-select-setter']}\n      value={keyPath}\n      readonly={readonly}\n      onChange={handleOnChange}\n      disabledTypes={disabledTypes}\n      forArrayItem={forArrayItem}\n      validateStatus={validation.status}\n      invalidContent={validation.message}\n      optionFilter={optionFilter}\n      style={style}\n      testId={getNodeSetterId(context.path)}\n    />\n  );\n}\n\nexport const viewVariableSelect = {\n  key: 'ViewVariableSelect',\n  component: ViewVariableSelectSetter,\n  validator: ({ value, context }: ValidatorProps) => {\n    const { meta, playgroundContext, node } = context;\n    const { required } = meta;\n    return valueExpressionValidator({\n      value,\n      playgroundContext,\n      node,\n      required,\n    });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type PlaygroundContext } from '@coze-workflow/nodes';\nimport { ValueExpression, ValueExpressionType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nexport interface ValueExpressionValidatorProps {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any;\n  /**\n   * Is it required?\n   */\n  required?: boolean;\n  /**\n   * ValueExpression node\n   */\n  node: WorkflowNodeEntity;\n  playgroundContext: PlaygroundContext;\n  emptyErrorMessage?: string;\n}\n\nexport const valueExpressionValidator = ({\n  value,\n  playgroundContext,\n  node,\n  required,\n  emptyErrorMessage = I18n.t('workflow_detail_node_error_empty'),\n}: ValueExpressionValidatorProps) => {\n  const { variableValidationService } = playgroundContext;\n\n  // check null value\n  if (ValueExpression.isEmpty(value)) {\n    if (!required) {\n      return;\n    }\n\n    return emptyErrorMessage;\n  }\n\n  if (value.type === ValueExpressionType.REF) {\n    return variableValidationService.isRefVariableEligible(value, node);\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { FormProvider } from '../contexts';\n\ntype FormProps = PropsWithChildren & {\n  readonly?: boolean;\n};\n\nexport function Form({ children, readonly = false }: FormProps) {\n  return <FormProvider value={{ readonly }}>{children}</FormProvider>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type FieldInstance,\n  type BaseFieldInstance,\n  type BaseFieldState,\n} from '../type';\n\nexport function baseFieldToField<T = unknown>(\n  baseField: BaseFieldInstance<T>,\n  baseFieldState?: BaseFieldState,\n  readonly = false,\n): FieldInstance<T> {\n  const field: FieldInstance<T> = {\n    key: baseField.key,\n    value: baseField.value,\n    name: baseField.name,\n    onBlur: () => baseField.onBlur?.(),\n    onFocus: () => baseField.onFocus?.(),\n\n    readonly,\n    errors: baseFieldState?.errors,\n    onChange: (value?: T) => {\n      if (readonly) {\n        return;\n      }\n\n      baseField?.onChange(value as T);\n    },\n  };\n\n  return field;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function RequiredStar() {\n  return <span className=\"coz-fg-hglt-red\">*</span>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tooltip } from '@coze-arch/coze-design';\n\ninterface IconInfoProps {\n  tooltip: string | React.ReactNode;\n}\n\nexport function IconInfo({ tooltip }: IconInfoProps) {\n  return (\n    <Tooltip content={tooltip}>\n      <IconCozInfoCircle className=\"text-lg coz-fg-secondary\" />\n    </Tooltip>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { RequiredStar } from './required-star';\nimport { IconInfo } from './icon-info';\n\nexport interface LabelProps {\n  className?: String;\n  required?: Boolean;\n  tooltip?: String | React.ReactNode;\n  extra?: React.ReactNode;\n}\n\nexport function Label({\n  className,\n  required = false,\n  tooltip,\n  extra,\n  children,\n}: PropsWithChildren<LabelProps>) {\n  return (\n    <div className={`flex gap-[4px] items-center ${className} h-[24px]`}>\n      <div className=\"flex text-[12px]\">\n        {children}\n        {required ? <RequiredStar /> : null}\n      </div>\n\n      {tooltip ? <IconInfo tooltip={tooltip} /> : null}\n      {extra}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { Label } from './label';\n\nexport interface FieldLayoutProps {\n  label?: ReactNode;\n  labelExtra?: ReactNode;\n  tooltip?: ReactNode;\n  required?: boolean;\n  layout?: 'vertical' | 'horizontal';\n  children: ReactNode;\n}\n\nexport const FieldLayout = ({\n  label,\n  labelExtra,\n  tooltip,\n  required = false,\n  layout = 'horizontal',\n  children,\n}: FieldLayoutProps) =>\n  label ? (\n    <div className={layout === 'horizontal' ? 'flex gap-[4px] min-w-0' : ''}>\n      <Label\n        className={layout === 'horizontal' ? 'w-[148px]' : ''}\n        required={required}\n        tooltip={tooltip}\n        extra={labelExtra}\n      >\n        {label}\n      </Label>\n      <div className=\"last:flex-1 min-w-0\">{children}</div>\n    </div>\n  ) : (\n    children\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nexport interface FeedbackProps {\n  className?: string;\n  text?: string;\n}\n\nexport function Feedback({ text, className }: FeedbackProps) {\n  return text ? (\n    <div className={`${className} text-[12px] leading-[16px] text-[#ff441e]`}>\n      {text}\n    </div>\n  ) : null;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Field as BaseField } from '@flowgram-adapter/free-layout-editor';\n\nimport { baseFieldToField } from '../utils';\nimport { type FieldName, type FieldInstance } from '../type';\nimport { FieldProvider, useFormContext } from '../contexts';\nimport { FieldLayout, type FieldLayoutProps } from './field-layout';\nimport { Feedback } from './feedback';\n\nexport interface FieldProps<T = unknown>\n  extends Omit<FieldLayoutProps, 'children'> {\n  name: string;\n  layout?: 'vertical' | 'horizontal';\n  deps?: FieldName[];\n  defaultValue?: T;\n  hasFeedback?: boolean;\n  children?: ((field: FieldInstance<T>) => React.ReactNode) | React.ReactNode;\n  readonly?: boolean;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const Field = <T = any,>({\n  label,\n  labelExtra,\n  name,\n  tooltip,\n  required = false,\n  hasFeedback = true,\n  children,\n  layout = 'horizontal',\n  deps,\n  defaultValue,\n  readonly = false,\n}: FieldProps<T>) => {\n  let field: FieldInstance<T> | undefined = undefined;\n  const { readonly: formReadonly } = useFormContext();\n\n  return (\n    <BaseField name={name} deps={deps} defaultValue={defaultValue}>\n      {({ field: baseField, fieldState }) => {\n        field = baseFieldToField(\n          baseField,\n          fieldState,\n          readonly || formReadonly,\n        );\n\n        if (!children) {\n          return <></>;\n        }\n\n        return (\n          <FieldProvider value={field as FieldInstance<unknown>}>\n            <FieldLayout\n              label={label}\n              labelExtra={labelExtra}\n              tooltip={tooltip}\n              required={required}\n              layout={layout}\n            >\n              {typeof children === 'function' ? children(field) : children}\n              {hasFeedback ? (\n                <Feedback text={field.errors?.[0]?.message} />\n              ) : null}\n            </FieldLayout>\n          </FieldProvider>\n        );\n      }}\n    </BaseField>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FieldArray as BaseFieldArray } from '@flowgram-adapter/free-layout-editor';\n\nimport { baseFieldArrayToFieldArray } from '../utils';\nimport { type BaseFieldArrayInstance, type FieldArrayInstance } from '../type';\nimport { FieldArrayProvider, useFormContext } from '../contexts';\nimport { type FieldProps } from './field';\n\nexport interface FieldArrayProps<T = unknown>\n  extends Omit<FieldProps<T[]>, 'label' | 'children'> {\n  children:\n    | ((fieldArray: FieldArrayInstance<T>) => React.ReactNode)\n    | React.ReactNode;\n  readonly?: boolean;\n}\n\n/**\n * @deprecated\n * This component will cause the index to be confused after the array list entry is deleted, please use it directly:\n *\n * `import { FieldArray } from '@flowgram-adapter/free-layout-editor'`\n */\nexport const FieldArray = <T = unknown,>({\n  name,\n  children,\n  defaultValue,\n  readonly = false,\n  deps,\n}: FieldArrayProps<T>) => {\n  let fieldArray: FieldArrayInstance<T> | undefined = undefined;\n  const { readonly: formReadonly } = useFormContext();\n  return (\n    <BaseFieldArray name={name} defaultValue={defaultValue} deps={deps}>\n      {({ field, fieldState }) => {\n        fieldArray = baseFieldArrayToFieldArray<T>(\n          field as unknown as BaseFieldArrayInstance<T>,\n          fieldState,\n          readonly || formReadonly,\n        );\n\n        return (\n          <FieldArrayProvider value={fieldArray as FieldArrayInstance<unknown>}>\n            {typeof children === 'function' ? children(fieldArray) : children}\n          </FieldArrayProvider>\n        );\n      }}\n    </BaseFieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type FieldArrayInstance,\n  type BaseFieldArrayInstance,\n  type BaseFieldState,\n  type BaseFieldInstance,\n} from '../type';\nimport { baseFieldToField } from './base-field-to-field';\n\nexport function baseFieldArrayToFieldArray<T = unknown>(\n  baseField: BaseFieldArrayInstance<T>,\n  baseFieldState?: BaseFieldState,\n  readonly = false,\n): FieldArrayInstance<T> {\n  const fieldArray = baseFieldToField(\n    baseField as unknown as BaseFieldInstance<T[]>,\n    baseFieldState,\n    readonly,\n  ) as FieldArrayInstance<T>;\n\n  fieldArray.remove = (index: number) => baseField?.delete(index);\n  fieldArray.delete = (index: number) => baseField?.delete(index);\n  fieldArray.append = (newItem: T) => {\n    baseField?.append(newItem);\n  };\n  fieldArray.move = (from: number, to: number) => baseField?.move(from, to);\n\n  return fieldArray;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconCozMinus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\ninterface IconRemoveProps {\n  className?: string;\n  onClick?: () => void;\n  disabled?: boolean;\n  testId?: string;\n}\n\nexport function IconRemove({\n  className = '',\n  onClick,\n  disabled = false,\n  testId = '',\n}: IconRemoveProps) {\n  return (\n    <IconButton\n      className={`${className} !block`}\n      icon={<IconCozMinus />}\n      color=\"secondary\"\n      onClick={onClick}\n      disabled={disabled}\n      size=\"small\"\n      data-testid={testId}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport classNames from 'classnames';\n\nimport { IconRemove } from './icon-remove';\n\nimport styles from './field-array-item.module.less';\n\ninterface FieldArrayItemProps {\n  /** @deprecated */\n  disableDelete?: boolean;\n  disableRemove?: boolean;\n  /** @deprecated */\n  hiddenDelete?: boolean;\n  hiddenRemove?: boolean;\n  className?: string;\n  containerClassName?: string;\n  removeIconClassName?: string;\n  /** @deprecated */\n  onDelete?: () => void;\n  onRemove?: () => void;\n  removeTestId?: string;\n}\n\nexport function FieldArrayItem({\n  className = '',\n  containerClassName,\n  removeIconClassName,\n  disableDelete = false,\n  hiddenDelete = false,\n  onDelete,\n  disableRemove = false,\n  hiddenRemove = false,\n  onRemove,\n  children,\n  removeTestId,\n}: PropsWithChildren<FieldArrayItemProps>) {\n  return (\n    <div\n      className={classNames(containerClassName, 'flex items-start gap-[8px]')}\n    >\n      <div\n        className={classNames(\n          `flex gap-[4px] items-start flex-1 ${styles.content} min-w-0 min-w-0`,\n          className,\n        )}\n      >\n        {children}\n      </div>\n      {!hiddenRemove && !hiddenDelete && (\n        <IconRemove\n          className={removeIconClassName}\n          disabled={disableRemove || disableDelete}\n          onClick={onRemove || onDelete}\n          testId={removeTestId}\n        />\n      )}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nexport function FieldArrayList({ children }: PropsWithChildren) {\n  return <div className=\"flex flex-col gap-[8px]\">{children}</div>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { IconCozEmpty } from '@coze-arch/coze-design/icons';\n\nexport interface FieldEmptyProps {\n  text?: string;\n  isEmpty?: boolean;\n}\n\nexport function FieldEmpty({\n  text = '',\n  isEmpty = false,\n  children,\n}: PropsWithChildren<FieldEmptyProps>) {\n  return (\n    <>\n      {isEmpty ? (\n        <div className=\"flex flex-col items-center justify-center h-[95px]\">\n          <IconCozEmpty className=\"mb-[4px] w-[32px] h-[32px] coz-fg-dim\" />\n          <div className=\"text-center text-[12px] leading-[16px] coz-fg-dim\">\n            {text}\n          </div>\n        </div>\n      ) : (\n        children\n      )}\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type PropsWithChildren,\n  forwardRef,\n  useRef,\n  useImperativeHandle,\n} from 'react';\n\nimport {\n  FormCard,\n  type ContentRef,\n} from '@/form-extensions/components/form-card';\n\nimport { FieldEmpty } from './field-empty';\n\nexport interface SectionProps {\n  title?: React.ReactNode;\n  tooltip?: React.ReactNode;\n  tooltipClassName?: string;\n  actions?: React.ReactNode[];\n  isEmpty?: boolean;\n  emptyText?: string;\n  collapsible?: boolean;\n  noPadding?: boolean;\n  headerClassName?: string;\n  testId?: string;\n}\n\n/**\n * form grouping\n */\nexport const Section = forwardRef(\n  (\n    {\n      title,\n      tooltip,\n      tooltipClassName,\n      actions,\n      children,\n      isEmpty = false,\n      emptyText,\n      collapsible,\n      noPadding,\n      headerClassName,\n      testId,\n    }: PropsWithChildren<SectionProps>,\n    ref,\n  ) => {\n    const formCardRef = useRef<ContentRef>(null);\n\n    useImperativeHandle(ref, () => ({\n      open: () => formCardRef?.current?.setOpen?.(true),\n      close: () => formCardRef?.current?.setOpen?.(false),\n    }));\n\n    return (\n      <FormCard\n        header={title}\n        tooltip={tooltip}\n        tooltipClassName={tooltipClassName}\n        onRef={formCardRef}\n        collapsible={collapsible}\n        noPadding={noPadding}\n        testId={testId}\n        headerClassName={headerClassName}\n        actionButton={\n          <div className=\"flex gap-[8px] items-center\">{actions}</div>\n        }\n      >\n        <FieldEmpty isEmpty={isEmpty} text={emptyText}>\n          {children}\n        </FieldEmpty>\n      </FormCard>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MouseEventHandler } from 'react';\n\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\ninterface AddButtonProps {\n  onClick?: MouseEventHandler<HTMLButtonElement> | undefined;\n  disabled?: boolean;\n  className?: string;\n  dataTestId?: string;\n  children?: React.ReactNode;\n}\n\nexport function AddButton({\n  onClick,\n  disabled = false,\n  className,\n  dataTestId,\n  children,\n}: AddButtonProps) {\n  return (\n    <IconButton\n      data-testid={dataTestId}\n      color=\"highlight\"\n      onClick={onClick}\n      icon={<IconCozPlus />}\n      size=\"small\"\n      className={className}\n      disabled={disabled}\n      children={children}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nexport interface Column {\n  label: string;\n  style?: React.CSSProperties;\n  required?: boolean;\n}\n\ninterface ColumnTitlesProps {\n  columns: Column[];\n}\n\nexport const ColumnTitles: FC<ColumnTitlesProps> = ({ columns }) => (\n  <div className=\"flex gap-1 items-center text-xs font-normal leading-4 text-[rgba(28,29,35,0.35)] tracking-[0.12px] mb-[8px]\">\n    {columns.map(({ label, style, required = false }, index) => (\n      <div key={index} style={style}>\n        {label}\n        {required ? (\n          <span style={{ color: '#f93920', paddingLeft: 2 }}>*</span>\n        ) : null}\n      </div>\n    ))}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport classNames from 'classnames';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { IconCozHandle } from '@coze-arch/coze-design/icons';\n\nimport { getCanvasOffset } from '@/utils';\nimport { useGlobalState } from '@/hooks';\n\ninterface SortableItemProps {\n  children: React.ReactNode;\n  sortableID: string | number;\n  index: number;\n  containerClassName?: string;\n  hanlderClassName?: string;\n}\n\nexport const SortableItem: React.FC<SortableItemProps> = ({\n  children,\n  sortableID,\n  index,\n  containerClassName,\n  hanlderClassName,\n}) => {\n  const { isInIDE } = useGlobalState();\n  const { getNodeSetterId, concatTestId } = useNodeTestId();\n\n  return (\n    <Draggable draggableId={`${sortableID}`} index={index}>\n      {(provided, snapshot) => {\n        // In the IDE, when dragging a node, you need to subtract the offset of the canvas\n        if (snapshot.isDragging && isInIDE) {\n          const offset = getCanvasOffset();\n          const x = provided.draggableProps.style.left - offset.x;\n          const y = provided.draggableProps.style.top - offset.y;\n          provided.draggableProps.style.left = x;\n          provided.draggableProps.style.top = y;\n        }\n\n        return (\n          <div\n            ref={provided.innerRef}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n          >\n            <div className={classNames(containerClassName, 'flex w-full')}>\n              <div\n                className={classNames(\n                  hanlderClassName,\n                  'flex items-center h-[24px] mr-[4px] pt-[8px] coz-fg-secondary',\n                )}\n                data-testid={concatTestId(\n                  getNodeSetterId('answer-option-item-handle'),\n                  (sortableID as string) || '',\n                )}\n              >\n                <IconCozHandle className=\"cursor-grab\" />\n              </div>\n              <div className=\"flex-1\">{children}</div>\n            </div>\n          </div>\n        );\n      }}\n    </Draggable>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DragDropContext, Droppable } from 'react-beautiful-dnd';\nimport { type PropsWithChildren } from 'react';\n\nexport function SortableList({\n  children,\n  onSortEnd,\n}: PropsWithChildren<{\n  onSortEnd: ({ from, to }: { from: number; to: number }) => void;\n}>) {\n  return (\n    <DragDropContext\n      onDragEnd={result => {\n        onSortEnd({ from: result.source.index, to: result.destination.index });\n      }}\n    >\n      <Droppable droppableId=\"droppable\">\n        {provided => (\n          <div ref={provided.innerRef} {...provided.droppableProps}>\n            {children}\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Select as BaseSelect, type SelectProps } from '@coze-arch/coze-design';\n\nexport { type SelectProps } from '@coze-arch/coze-design';\n\nexport const Select = (props: SelectProps) => (\n  <BaseSelect size=\"small\" {...props} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { createContext, useContext } from 'react';\n\nexport interface FormContextType {\n  /**\n   * When set to true, form fields should be read-only\n   */\n  readonly?: boolean;\n}\n\nexport const FormContext = createContext<FormContextType | undefined>(\n  undefined,\n);\n\nexport const FormProvider = FormContext.Provider;\n\nexport function useFormContext() {\n  const context = useContext(FormContext);\n  if (context === undefined) {\n    throw new Error('useFormContext must be used within a FormProvider');\n  }\n  return context;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { createContext, useContext } from 'react';\n\nimport { type FieldInstance } from '../type';\n\nexport const FieldContext = createContext<FieldInstance | undefined>(undefined);\n\nexport const FieldProvider = FieldContext.Provider;\n\nexport function useFieldContext() {\n  const context = useContext(FieldContext);\n  if (context === undefined) {\n    throw new Error('useFieldContext must be used within a FieldProvider');\n  }\n  return context;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { createContext, useContext } from 'react';\n\nimport { type FieldArrayInstance } from '../type';\n\nexport const FieldArrayContext = createContext<FieldArrayInstance | undefined>(\n  undefined,\n);\n\nexport const FieldArrayProvider = FieldArrayContext.Provider;\n\nexport function useFieldArrayContext() {\n  const context = useContext(FieldArrayContext);\n  if (context === undefined) {\n    throw new Error(\n      'useFieldArrayContext must be used within a FieldArrayProvider',\n    );\n  }\n  return context;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Input,\n  type InputProps as BaseInputProps,\n} from '@coze-arch/coze-design';\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\nimport { type FieldProps } from '../components';\n\ntype InputProps = Omit<\n  BaseInputProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus'\n>;\n\nexport const InputField: React.FC<InputProps & FieldProps> =\n  withField<InputProps>(props => {\n    const { value, onChange, onBlur, errors } = useField<string>();\n\n    return (\n      <Input\n        {...props}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        size=\"small\"\n        error={errors && errors.length > 0}\n      />\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport {\n  CozInputNumber,\n  type InputNumberProps as BaseInputNumberProps,\n} from '@coze-arch/coze-design';\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\nimport { type FieldProps } from '../components';\n\ntype InputNumberProps = Omit<\n  BaseInputNumberProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus'\n>;\n\nexport const InputNumberField: React.FC<InputNumberProps & FieldProps> =\n  withField<InputNumberProps>(props => {\n    const { name, value, onChange, onBlur, errors, readonly } = useField<\n      number | string\n    >();\n    const { getNodeSetterId } = useNodeTestId();\n\n    return (\n      <CozInputNumber\n        {...props}\n        disabled={readonly}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        size=\"small\"\n        error={errors && errors.length > 0}\n        data-testid={getNodeSetterId(name)}\n      />\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\nimport {\n  type FieldProps,\n  Select,\n  type SelectProps as BaseSelectProps,\n} from '../components';\n\ntype SelectProps = Omit<\n  BaseSelectProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus' | 'hasError'\n>;\n\nexport const SelectField: React.FC<SelectProps & FieldProps> =\n  withField<SelectProps>(props => {\n    const { value, onChange, onBlur, errors, readonly } = useField<\n      string | number\n    >();\n\n    return (\n      <Select\n        {...props}\n        disabled={readonly}\n        value={value}\n        onChange={v => onChange(v as string | number)}\n        onBlur={onBlur}\n        hasError={errors && errors.length > 0}\n      />\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Checkbox,\n  type CheckboxProps as BaseCheckboxProps,\n} from '@coze-arch/coze-design';\n\nimport { withField, useField } from '@/form';\n\ntype CheckboxProps = Omit<\n  BaseCheckboxProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus'\n>;\n\nexport const CheckboxField = withField<CheckboxProps>(props => {\n  const { value, onChange } = useField<boolean>();\n\n  return (\n    <div className=\"flex h-[24px] items-center\">\n      <Checkbox\n        {...props}\n        value={value}\n        onChange={e => onChange(!!e.target.checked)}\n      />\n    </div>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Switch,\n  type SwitchProps as BaseSwitchProps,\n} from '@coze-arch/coze-design';\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\nimport { type FieldProps } from '../components';\n\ntype SwitchProps = Omit<\n  BaseSwitchProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus'\n>;\n\nexport const SwitchField: React.FC<SwitchProps & FieldProps> =\n  withField<SwitchProps>(props => {\n    const { value, onChange, readonly } = useField<boolean>();\n\n    return (\n      <Switch\n        {...props}\n        disabled={readonly}\n        checked={value}\n        onChange={onChange}\n      />\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Slider } from '@coze-arch/coze-design';\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\n\ntype SliderProps = Omit<\n  React.ComponentProps<typeof Slider>,\n  'value' | 'onChange'\n>;\n\nexport const SliderField = withField<SliderProps>(props => {\n  const { value, onChange } = useField<number | number[]>();\n\n  return <Slider value={value} onChange={onChange} {...props} />;\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cx from 'classnames';\nimport { TextArea, type TextAreaProps } from '@coze-arch/coze-design';\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\n\ntype TextareaProps = Omit<TextAreaProps, 'value' | 'onChange'>;\n\nexport const TextareaField = withField(\n  ({ className = '', ...props }: TextareaProps) => {\n    const { value, onChange, readonly = false } = useField<string>();\n\n    return (\n      <TextArea\n        className={cx(\n          className,\n          'w-full',\n          readonly ? 'pointer-events-none' : '',\n        )}\n        value={value}\n        onChange={v => onChange?.(v)}\n        {...props}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport {\n  Radio,\n  RadioGroup,\n  type RadioGroupProps as BaseRadioGroupProps,\n} from '@coze-arch/coze-design';\n\nimport { useField } from '../hooks';\nimport { withField } from '../hocs';\nimport { type FieldProps } from '../components';\n\ntype RadioGroupGroup = Omit<\n  BaseRadioGroupProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus'\n>;\n\nexport const RadioGroupField: React.FC<RadioGroupGroup & FieldProps> =\n  withField<RadioGroupGroup>(props => {\n    const { name, value, onChange, readonly } = useField<string>();\n    const { options, ...rest } = props;\n\n    const { getNodeSetterId, concatTestId } = useNodeTestId();\n\n    return (\n      <RadioGroup\n        {...rest}\n        value={value}\n        disabled={!!readonly}\n        onChange={e => onChange(e.target.value)}\n      >\n        {options?.map(item => (\n          <Radio\n            className={item.className}\n            value={item.value}\n            data-testid={concatTestId(getNodeSetterId(name), `${item.value}`)}\n          >\n            {item.label}\n          </Radio>\n        ))}\n      </RadioGroup>\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Field, type FieldProps } from '../components';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function withField<T = {}, V = any>(\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Cpt: React.ComponentType<T>,\n  config: Omit<FieldProps<V>, 'name' | 'children'> = {},\n) {\n  const Component = (props: T & FieldProps<V>) => {\n    const innerProps = {\n      ...config,\n      ...props,\n    };\n\n    const {\n      label,\n      required,\n      tooltip,\n      layout,\n      defaultValue,\n      name,\n      deps,\n      labelExtra,\n      hasFeedback,\n      ...rest\n    } = innerProps;\n\n    return (\n      <Field<V>\n        name={name}\n        label={label}\n        required={required}\n        tooltip={tooltip}\n        layout={layout}\n        defaultValue={defaultValue}\n        deps={deps}\n        labelExtra={labelExtra}\n        hasFeedback={hasFeedback}\n      >\n        <Cpt {...(rest as T & React.JSX.IntrinsicAttributes)} />\n      </Field>\n    );\n  };\n\n  Component.displayName = `withField(${Cpt.displayName || 'Anonymous'})`;\n\n  return Component;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FieldArray, type FieldArrayProps } from '../components';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function withFieldArray<ComponentProps = {}, FieldArrayItemValue = any>(\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Cpt: React.ComponentType<ComponentProps>,\n) {\n  return (\n    props: ComponentProps &\n      Omit<FieldArrayProps<FieldArrayItemValue>, 'children'>,\n  ) => {\n    const { name, defaultValue, deps, ...rest } = props;\n\n    return (\n      <FieldArray<FieldArrayItemValue>\n        name={name}\n        defaultValue={defaultValue}\n        deps={deps}\n      >\n        <Cpt {...(rest as ComponentProps & React.JSX.IntrinsicAttributes)} />\n      </FieldArray>\n    );\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useForm as useBaseForm } from '@flowgram-adapter/free-layout-editor';\n\nimport { type FormInstance } from '../type';\nimport { useFormContext } from '../contexts';\n\nexport function useForm<T = unknown>() {\n  const baseForm = useBaseForm();\n  const { readonly } = useFormContext();\n\n  const form: FormInstance<T> = {\n    getValueIn: baseForm.getValueIn.bind(baseForm),\n    setValueIn: baseForm.setValueIn.bind(baseForm),\n    validate: baseForm.validate?.bind(baseForm),\n    values: baseForm.values,\n    initialValues: baseForm.initialValues,\n    state: baseForm.state,\n\n    readonly,\n    getFieldValue: baseForm.getValueIn.bind(baseForm),\n    setFieldValue: baseForm.setValueIn.bind(baseForm),\n  };\n\n  return form;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FieldInstance } from '../type';\nimport { useFieldContext } from '../contexts';\n\nexport function useField<T = unknown>() {\n  const field = useFieldContext() as FieldInstance<T>;\n\n  return field;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FieldArrayInstance } from '../type';\nimport { useFieldArrayContext } from '../contexts';\n\nexport function useFieldArray<T = unknown>() {\n  const fieldArray = useFieldArrayContext() as FieldArrayInstance<T>;\n\n  return fieldArray;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWatch as useBaseWatch } from '@flowgram-adapter/free-layout-editor';\n\nimport { type FieldName } from '../type';\n\n/**\n * Monitors the value of the specified field.\n *\n * @Param name field name.\n * @Returns the value of the field.\n */\nexport function useWatch<Value = unknown>(\n  name: FieldName | { name: FieldName },\n) {\n  const value = useBaseWatch(\n    typeof name === 'string' ? name : name.name,\n  ) as Value;\n\n  return value;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport { type SectionRefType } from '../type';\n\nexport function useSectionRef() {\n  const ref = useRef<SectionRefType>();\n\n  return ref;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  type WorkflowJSON,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowSaveService } from '../services';\n\nexport const useLatestWorkflowJson = () => {\n  const workflowDocument = useService<WorkflowDocument>(WorkflowDocument);\n\n  const saveService = useService<WorkflowSaveService>(WorkflowSaveService);\n\n  const getLatestWorkflowJson = async (): Promise<WorkflowJSON> => {\n    await saveService.waitSaving();\n\n    return workflowDocument.toJSON() as WorkflowJSON;\n  };\n\n  return { getLatestWorkflowJson };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowRunService } from '../services';\n\nexport const useWorkflowRunService = () =>\n  useService<WorkflowRunService>(WorkflowRunService);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { TestRunReporterService } from '@/services';\n\nexport const useTestRunReporterService = () =>\n  useService<TestRunReporterService>(TestRunReporterService);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  useService,\n  usePlayground,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowSelectService } from '@flowgram-adapter/free-layout-editor';\n\nexport const useScrollToNode = () => {\n  const selectServices = useService<WorkflowSelectService>(\n    WorkflowSelectService,\n  );\n\n  const playground = usePlayground();\n\n  const scrollToNode = async (nodeId: string) => {\n    let success = false;\n    const node = playground.entityManager.getEntityById<FlowNodeEntity>(nodeId);\n\n    if (node) {\n      await selectServices.selectNodeAndScrollToView(node, true);\n      success = true;\n    }\n    return success;\n  };\n\n  return scrollToNode;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  usePlayground,\n  SelectionService,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type PlaygroundConfigRevealOpts } from '@flowgram-adapter/free-layout-editor';\nimport { Rectangle, SizeSchema } from '@flowgram-adapter/common';\n\nimport { useLineService } from './use-line-service';\n\nexport const useScrollToLine = () => {\n  const lineService = useLineService();\n  const playground = usePlayground();\n\n  const selectionService = useService<SelectionService>(SelectionService);\n\n  const scrollToLine = async (fromId: string, toId: string) => {\n    const line = lineService.getLine(fromId, toId);\n    let success = false;\n    if (line) {\n      const bounds = Rectangle.enlarge([line.bounds]).pad(30, 30);\n\n      const viewport = playground.config.getViewport(false);\n      const zoom = SizeSchema.fixSize(bounds, viewport);\n\n      const scrollConfig: PlaygroundConfigRevealOpts = {\n        bounds,\n        zoom,\n        scrollToCenter: true,\n        easing: true,\n      };\n\n      selectionService.selection = [line];\n\n      await playground.config.scrollToView(scrollConfig);\n      success = true;\n    }\n    return success;\n  };\n\n  return scrollToLine;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport { pick } from 'lodash-es';\nimport { FlowNodeRenderData } from '@flowgram-adapter/free-layout-editor';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\ntype SimpleNodeRenderData = Pick<FlowNodeRenderData, 'expanded' | 'node'>;\n\nconst pickSimpleNodeRenderData = (data: FlowNodeRenderData) =>\n  pick(data, 'expanded', 'node');\n\n/**\n * @deprecated\n * Get the rendering data of the current node, including expanded and other rendering-related states\n */\nexport const useNodeRenderData = () => {\n  const node = useCurrentEntity();\n  const initialRenderData =\n    node.getData<FlowNodeRenderData>(FlowNodeRenderData);\n  const [nodeRenderData, setNodeRenderData] = useState<SimpleNodeRenderData>(\n    pickSimpleNodeRenderData(initialRenderData),\n  );\n\n  useEffect(() => {\n    const disposable = initialRenderData.onDataChange(data => {\n      setNodeRenderData(pickSimpleNodeRenderData(data as FlowNodeRenderData));\n    });\n\n    return () => {\n      disposable?.dispose();\n    };\n  }, []);\n\n  return {\n    ...nodeRenderData,\n    expanded: true, // Coze V2 has no node folding\n    toggleNodeExpand: initialRenderData.toggleExpand.bind(initialRenderData),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { HistoryService, WorkflowHistoryConfig } from '@coze-workflow/history';\n\nexport const useRedoUndo = () => {\n  const historyService = useService<HistoryService>(HistoryService);\n  const config = useService<WorkflowHistoryConfig>(WorkflowHistoryConfig);\n\n  return {\n    start: () => {\n      historyService.start();\n      config.disabled = false;\n    },\n    stop: () => {\n      historyService.stop();\n      config.disabled = true;\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport { useThrottleEffect } from 'ahooks';\nimport { ExpressionEditorTreeHelper } from '@coze-workflow/components';\nimport {\n  type InputVariable,\n  useWorkflowNode,\n  type ViewVariableType,\n} from '@coze-workflow/base';\n\nimport { useNodeAvailableVariablesWithNode } from '../form-extensions/hooks';\n\nconst useInputs = (): {\n  name: string;\n  id?: string;\n  keyPath?: string[];\n}[] => {\n  const workflowNode = useWorkflowNode();\n  const inputs = (\n    (workflowNode?.inputParameters || []) as {\n      name: string;\n      input: {\n        content: {\n          keyPath: string[];\n        };\n      };\n    }[]\n  ).map(i => ({\n    ...i,\n    keyPath: [...(i.input?.content?.keyPath || [])], // Deep copy\n  }));\n  return inputs;\n};\n\nexport const useInputVariables = (props?: {\n  needNullName?: boolean;\n  needNullType?: boolean;\n}) => {\n  const { needNullName = true, needNullType = false } = props ?? {};\n  const availableVariables = useNodeAvailableVariablesWithNode();\n  const inputs = useInputs();\n  const inputsWithVariables = ExpressionEditorTreeHelper.findAvailableVariables(\n    {\n      variables: availableVariables,\n      inputs,\n    },\n  );\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const _variables = inputsWithVariables.map((v, i) => ({\n    name: v.name,\n    id: inputs[i].id,\n    type: v.variable?.type as ViewVariableType,\n    index: i,\n  }));\n\n  const [variables, setVariables] = useState<InputVariable[]>();\n\n  useThrottleEffect(\n    () => {\n      setVariables(\n        _variables.filter(\n          v =>\n            (needNullName ? true : !!v.name) &&\n            (needNullType ? true : !!v.type),\n        ),\n      );\n    },\n    [\n      _variables.map(d => `${d.name}${d.type}`).join(''),\n      needNullName,\n      needNullType,\n    ],\n    {\n      wait: 300,\n    },\n  );\n\n  return variables;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { RoleService, type RoleServiceState } from '@/services/role-service';\n\nexport const useRoleService = () => useService<RoleService>(RoleService);\n\nexport const useRoleServiceStore = <T>(\n  selector: (s: RoleServiceState) => T,\n) => {\n  const roleService = useRoleService();\n\n  return roleService.store(selector);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowVariableService } from '@coze-workflow/variable';\n\nexport function useVariableService() {\n  const variableService = useService<WorkflowVariableService>(\n    WorkflowVariableService,\n  );\n\n  return variableService;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useConfigEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowTestFormStateEntity } from '../entities';\n\nexport const useTestFormState = () => {\n  const entity = useConfigEntity<WorkflowTestFormStateEntity>(\n    WorkflowTestFormStateEntity,\n    true,\n  );\n\n  return entity;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { LayoutPanelKey } from '@/constants';\n\nimport { useFloatLayoutService } from './use-float-layout-service';\n\ninterface OpenOptions {\n  defaultTab?: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n\nexport const useOpenTraceListPanel = () => {\n  const floatLayoutService = useFloatLayoutService();\n\n  const open = useCallback(\n    (options?: OpenOptions) => {\n      floatLayoutService.open(LayoutPanelKey.TraceList, 'bottom', options);\n    },\n    [floatLayoutService],\n  );\n\n  return { open };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useConfigEntity,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowDependencyService } from '@/services/workflow-dependency-service';\nimport { WorkflowDependencyStateEntity } from '@/entities';\n\nexport const useDependencyService = () =>\n  useService<WorkflowDependencyService>(WorkflowDependencyService);\n\nexport const useDependencyEntity = () => {\n  const entity = useConfigEntity<WorkflowDependencyStateEntity>(\n    WorkflowDependencyStateEntity,\n    true,\n  );\n  return entity;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\n\nimport { MessageBizType } from '@coze-arch/idl/workflow_api';\nimport { type Dataset } from '@coze-arch/bot-api/knowledge';\nimport { type Disposable } from '@flowgram-adapter/common';\n\nimport { useGlobalState } from './use-global-state';\nimport { useDependencyService } from './use-dependency-service';\n\nexport const useDataSetInfos = ({ ids }: { ids: string[] }) => {\n  const [dataSets, setDataSets] = useState<Dataset[]>([]);\n  const [isReady, setReady] = useState(false);\n  const { spaceId, sharedDataSetStore } = useGlobalState();\n  const dependencyService = useDependencyService();\n\n  const disposeRef: React.MutableRefObject<Disposable | null> =\n    useRef<Disposable>(null);\n\n  const getDataSetInfos = useCallback(\n    async (_ids: string[]) => {\n      try {\n        const _dataSets = await sharedDataSetStore.getDataSetInfosByIds(\n          _ids,\n          spaceId,\n        );\n        setDataSets(_dataSets);\n      } catch (e) {\n        console.error(e);\n      } finally {\n        setReady(true);\n      }\n    },\n    [spaceId],\n  );\n\n  useEffect(() => {\n    getDataSetInfos(ids);\n    if (!disposeRef.current) {\n      disposeRef.current = dependencyService.onDependencyChange(source => {\n        if (source?.bizType === MessageBizType.Dataset) {\n          getDataSetInfos(ids);\n        }\n      });\n    }\n\n    return () => {\n      disposeRef?.current?.dispose?.();\n      disposeRef.current = null;\n    };\n  }, [ids.join('')]);\n\n  return {\n    dataSets,\n    isReady,\n    cacheDataSetInfo: sharedDataSetStore.addDataSetInfo,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowSaveService } from '@/services';\n\nexport const useSaveService = () =>\n  useService<WorkflowSaveService>(WorkflowSaveService);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { type DatabseNodeStore } from '@/services/database-node-service-impl';\nimport { DatabaseNodeService } from '@/services/database-node-service';\n\nexport function useDatabaseNodeService() {\n  const databaseNodeService =\n    useService<DatabaseNodeService>(DatabaseNodeService);\n\n  return databaseNodeService;\n}\n\nexport const useDatabaseServiceStore = <T>(\n  selector: (s: DatabseNodeStore) => T,\n) => {\n  const databaseNodeService = useDatabaseNodeService();\n\n  return databaseNodeService.store(selector);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWorkflowNode } from '@coze-workflow/base';\n\n/**\n * Get the database ID selected by the database node\n * Returns the current database ID\n */\nexport function useCurrentDatabaseID() {\n  const { data } = useWorkflowNode();\n  const databaseList = data?.databaseInfoList ?? data?.inputs?.databaseInfoList;\n  return databaseList?.[0]?.databaseInfoID;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef } from 'react';\n\nimport { MessageBizType } from '@coze-arch/idl/workflow_api';\nimport type { Disposable } from '@flowgram-adapter/common';\n\nimport { useNewDatabaseQuery } from './use-new-database-query';\nimport { useDependencyService } from './use-dependency-service';\nimport { useDatabaseNodeService } from './use-database-node-service';\nimport { useCurrentDatabaseID } from './use-current-database-id';\n\n/**\n * Get the query for the current database\n * @Returns database query results\n *  - data: returns the database object when the query is successful, returns undefined when there is no data\n *  - isLoading: Loading status\n *  - error: the error object when the query fails\n */\nexport function useCurrentDatabaseQuery() {\n  const currentDatabaseID = useCurrentDatabaseID();\n  const { data, isLoading, error } = useNewDatabaseQuery(currentDatabaseID);\n  const disposeRef: React.MutableRefObject<Disposable | null> =\n    useRef<Disposable>(null);\n  const databaseNodeService = useDatabaseNodeService();\n  const dependencyService = useDependencyService();\n\n  useEffect(() => {\n    databaseNodeService.load(currentDatabaseID);\n    if (!disposeRef.current) {\n      disposeRef.current = dependencyService.onDependencyChange(source => {\n        if (source?.bizType === MessageBizType.Database) {\n          // When a database resource is updated, rerequest the interface\n          databaseNodeService.load(currentDatabaseID);\n        }\n      });\n    }\n    return () => {\n      disposeRef?.current?.dispose?.();\n      disposeRef.current = null;\n    };\n  }, [currentDatabaseID]);\n\n  return { data, isLoading, error };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { type WorkflowDatabase, ViewVariableType } from '@coze-workflow/base';\nimport { FieldItemType, type DatabaseInfo } from '@coze-arch/bot-api/memory';\n\nimport { useDatabaseServiceStore } from './use-database-node-service';\n\n/**\n * Hooks to query database information\n * @param id\n * The returned object contains:\n *  - data: returns database information when the query is successful, returns undefined when there is no data\n *  - isLoading: Loading status\n *  - error: the error object when the query fails\n */\nexport function useNewDatabaseQuery(id?: string) {\n  const { getDatabaseDetail, isLoading, getError } = useDatabaseServiceStore(\n    useShallow(state => ({\n      getDatabaseDetail: state.getData,\n      isLoading: state.loading,\n      getError: state.getError,\n    })),\n  );\n  const rawData = getDatabaseDetail(id);\n  const data = transformRawDatabaseToDatabase(rawData?.database_info);\n\n  return { data, isLoading, error: getError(id) };\n}\n\nfunction transformRawDatabaseToDatabase(\n  rawDatabase?: DatabaseInfo,\n): WorkflowDatabase | undefined {\n  if (!rawDatabase) {\n    return undefined;\n  }\n\n  return {\n    id: rawDatabase.id as string,\n    fields: rawDatabase.field_list?.map(field => ({\n      id: field.alterId as number,\n      name: field.name,\n      // @ts-expect-error fix me late\n      type: fieldItemTypeToViewVariableType(field.type),\n      required: field.must_required,\n      description: field.desc,\n      isSystemField: field.name\n        ? ['id', 'uuid', 'bstudio_create_time'].includes(field.name)\n        : false,\n    })),\n    iconUrl: rawDatabase.icon_url,\n    tableName: rawDatabase.table_name,\n  };\n}\n\nfunction fieldItemTypeToViewVariableType(type?: FieldItemType) {\n  const typeMap = {\n    [FieldItemType.Text]: ViewVariableType.String,\n    [FieldItemType.Number]: ViewVariableType.Integer,\n    [FieldItemType.Float]: ViewVariableType.Number,\n    [FieldItemType.Boolean]: ViewVariableType.Boolean,\n    [FieldItemType.Date]: ViewVariableType.Time,\n  };\n\n  if (!type) {\n    return undefined;\n  }\n\n  return typeMap[type] || undefined;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { RelatedCaseDataService } from '@/services';\n\nexport const useRelatedBotService = () =>\n  useService<RelatedCaseDataService>(RelatedCaseDataService);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { createMinimapPlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createHistoryNodePlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createFreeSnapPlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createFreeNodePanelPlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createFreeLinesPlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createContainerNodePlugin } from '@flowgram-adapter/free-layout-editor';\nimport {\n  EntityManager,\n  type PluginContext,\n} from '@flowgram-adapter/free-layout-editor';\nimport { createWorkflowVariablePlugins } from '@coze-workflow/variable';\nimport { createTestRunPlugin } from '@coze-workflow/test-run';\nimport {\n  createFreeHistoryPlugin,\n  createOperationReportPlugin,\n} from '@coze-workflow/history';\nimport { createWorkflowEncapsulatePlugin } from '@coze-workflow/feature-encapsulate';\nimport { type StandardNodeType } from '@coze-workflow/base';\n\nimport { WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { type WorkflowPlaygroundProps } from '@/typing';\nimport { RelatedCaseDataService } from '@/services';\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\nimport { NodePanel } from '../components/node-panel';\nimport { LineAddButton } from '../components/line-add-button';\n\nconst createEncapsulatePlugin = (props?: WorkflowPlaygroundProps) =>\n  createWorkflowEncapsulatePlugin({\n    getGlobalState: (ctx: PluginContext) =>\n      ctx\n        .get<EntityManager>(EntityManager)\n        .getEntity<WorkflowGlobalStateEntity>(\n          WorkflowGlobalStateEntity,\n        ) as WorkflowGlobalStateEntity,\n    getNodeTemplate: (ctx: PluginContext) => (type: StandardNodeType) =>\n      ctx\n        .get<WorkflowPlaygroundContext>(WorkflowPlaygroundContext)\n        .getNodeTemplateInfoByType(type),\n    onEncapsulate: async (res, ctx) => {\n      if (!res.success) {\n        return;\n      }\n\n      if (res.projectId) {\n        // Refresh process list in project and rename to newly created process\n        await props?.refetchProjectResourceList?.();\n        await props?.renameProjectResource?.(res.workflowId);\n      } else {\n        // Update the Bot information bound by the generation process in the resource library\n        const relatedCaseDataService = ctx.get<RelatedCaseDataService>(\n          RelatedCaseDataService,\n        );\n        relatedCaseDataService.updateRelatedBot(\n          relatedCaseDataService.getRelatedBotValue(),\n          res.workflowId,\n        );\n      }\n    },\n  });\n\nexport const useWorkflowPreset = (props?: WorkflowPlaygroundProps) => {\n  const preset = useCallback(\n    () => [\n      createFreeLinesPlugin({\n        renderInsideLine: LineAddButton,\n      }),\n      ...createWorkflowVariablePlugins(),\n      createFreeHistoryPlugin({\n        enable: true,\n        limit: 50,\n      }),\n      createOperationReportPlugin({}),\n      createMinimapPlugin({\n        disableLayer: true,\n        canvasStyle: {\n          canvasWidth: 182,\n          canvasHeight: 102,\n          canvasPadding: 50,\n          canvasBackground: 'rgba(245, 245, 245, 1)',\n          canvasBorderRadius: 10,\n          viewportBackground: 'rgba(235, 235, 235, 1)',\n          viewportBorderRadius: 4,\n          viewportBorderColor: 'rgba(201, 201, 201, 1)',\n          viewportBorderWidth: 1,\n          viewportBorderDashLength: 2,\n          nodeColor: 'rgba(255, 255, 255, 1)',\n          nodeBorderRadius: 2,\n          nodeBorderWidth: 0.145,\n          nodeBorderColor: 'rgba(6, 7, 9, 0.10)',\n          overlayColor: 'rgba(255, 255, 255, 0)',\n        },\n        inactiveDebounceTime: 1,\n      }),\n      createFreeSnapPlugin({\n        edgeColor: '#00B2B2',\n        alignColor: '#00B2B2',\n        edgeLineWidth: 1,\n        alignLineWidth: 1,\n        alignCrossWidth: 8,\n      }),\n      createFreeNodePanelPlugin({\n        renderer: NodePanel,\n      }),\n      createHistoryNodePlugin({}),\n      createContainerNodePlugin({}),\n      createTestRunPlugin({}),\n      createEncapsulatePlugin(props),\n    ],\n    [],\n  );\n  return preset;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { type MessageBizType } from '@coze-workflow/base';\nimport type { Model } from '@coze-arch/bot-api/developer_api';\n\nimport { bizTypeToDependencyTypeMap } from '@/services/workflow-dependency-service';\nimport { DependencySourceType } from '@/constants';\n\nimport { WorkflowModelsService } from '../services';\nimport { useDependencyService } from './use-dependency-service';\n\n/**\n * Uniformly obtain the model data entry, monitor the change of model resources, and update the model data\n */\nexport const useWorkflowModels = () => {\n  const modelsService = useService<WorkflowModelsService>(\n    WorkflowModelsService,\n  );\n  const dependencyService = useDependencyService();\n  const [models, setModels] = useState<Model[]>(\n    modelsService?.getModels() ?? [],\n  );\n\n  useEffect(() => {\n    const disposable = dependencyService.onDependencyChange(source => {\n      if (\n        bizTypeToDependencyTypeMap[source?.bizType as MessageBizType] ===\n        DependencySourceType.LLM\n      ) {\n        const curModels = modelsService?.getModels() ?? [];\n        setModels(curModels);\n      }\n    });\n\n    return () => {\n      disposable?.dispose?.();\n    };\n  }, []);\n\n  return { models };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { NodeVersionService } from '@/services';\n\nexport const useNodeVersionService = () =>\n  useService<NodeVersionService>(NodeVersionService);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport semver from 'semver';\nimport { type ApiNodeDataDTO } from '@coze-workflow/nodes';\nimport { type BotPluginWorkFlowItem } from '@coze-workflow/components';\nimport { BlockInput } from '@coze-workflow/base';\nimport { type PluginFrom } from '@coze-arch/bot-api/playground_api';\n\ninterface PluginApi {\n  name: string;\n  plugin_name: string;\n  api_id: string;\n  plugin_id: string;\n  plugin_icon: string;\n  desc: string;\n  plugin_product_status: number;\n  version_name?: string;\n  version_ts?: string;\n  plugin_from?: PluginFrom;\n}\n\nexport const createApiNodeInfo = (\n  apiParams: Partial<PluginApi> | undefined,\n  templateIcon?: string,\n): ApiNodeDataDTO => {\n  const {\n    name,\n    plugin_name,\n    api_id,\n    plugin_id,\n    desc,\n    version_ts,\n    plugin_from,\n  } = apiParams || {};\n\n  const result: ApiNodeDataDTO = {\n    data: {\n      nodeMeta: {\n        title: name,\n        icon: templateIcon,\n        subtitle: `${plugin_name}:${name}`,\n        description: desc,\n      },\n      inputs: {\n        apiParam: [\n          BlockInput.create('apiID', api_id),\n          BlockInput.create('apiName', name),\n          BlockInput.create('pluginID', plugin_id),\n          BlockInput.create('pluginName', plugin_name),\n          BlockInput.create('pluginVersion', version_ts || ''),\n          BlockInput.create('tips', ''),\n          BlockInput.create('outDocLink', ''),\n        ],\n      },\n    },\n  };\n\n  //  Coze.cn  pluginSource  1\n  if (IS_OPEN_SOURCE) {\n    result.data.inputs.pluginFrom = plugin_from;\n  }\n\n  return result;\n};\n\nexport const createSubWorkflowNodeInfo = ({\n  workflowItem,\n  spaceId,\n  templateIcon,\n  isImageflow,\n}: {\n  workflowItem: BotPluginWorkFlowItem | undefined;\n  spaceId: string;\n  isImageflow: boolean;\n  templateIcon?: string;\n}) => {\n  const { name, workflow_id, desc, version_name } = workflowItem || {};\n\n  const nodeJson = {\n    data: {\n      nodeMeta: {\n        title: name,\n        description: desc,\n        icon: templateIcon,\n        isImageflow,\n      },\n      inputs: {\n        workflowId: workflow_id,\n        spaceId,\n        workflowVersion: semver.valid(version_name) ? version_name : '',\n      },\n    },\n  };\n\n  return nodeJson;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodesService } from '@coze-workflow/nodes';\nimport {\n  isSelectProjectCategory,\n  useOpenWorkflowDetail,\n  useWorkflowModal,\n  WorkflowModalFrom,\n  type WorkFlowModalModeProps,\n} from '@coze-workflow/components';\nimport { type Workflow } from '@coze-workflow/base/api';\nimport {\n  StandardNodeType,\n  WorkflowMode,\n  type WorkflowNodeJSON,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Space, Toast, Typography } from '@coze-arch/coze-design';\nimport { From } from '@coze-agent-ide/plugin-shared';\nimport { usePluginApisModal } from '@coze-agent-ide/bot-plugin/components/plugin-apis/use-plugin-apis-modal';\n\nimport { WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { WorkflowEditService } from '@/services';\nimport { useSpaceId } from '@/hooks/use-space-id';\nimport { useGlobalState } from '@/hooks/use-global-state';\nimport { useNodeVersionService } from '@/hooks';\n\nimport { createApiNodeInfo, createSubWorkflowNodeInfo } from './helper';\n\nconst { Text } = Typography;\n\n/**\n * Result when subprocess, plug-in node is closed\n */\nexport enum AddNodeModalCloseResult {\n  /**\n   * Added node successfully\n   */\n  NodeAdded = 'node-added',\n  /**\n   * cancel\n   */\n  Cancel = 'cancel',\n  /**\n   * Open a new tab for the project\n   */\n  OpenNewTab = 'new-tab',\n}\n\nexport type AddNodeCallback = (params: {\n  nodeType: StandardNodeType;\n  nodeJSON: Partial<WorkflowNodeJSON>;\n}) => void;\nexport const useAddNodeModal = (prevAddNodeRef: {\n  current: { x: number; y: number; isDrag: boolean };\n}) => {\n  const spaceId = useSpaceId();\n  const globalState = useGlobalState();\n  const playgroundContext = useService<WorkflowPlaygroundContext>(\n    WorkflowPlaygroundContext,\n  );\n\n  const nodeVersionService = useNodeVersionService();\n\n  const projectApi = globalState.getProjectApi();\n\n  const addNodeCallbackRef = useRef<AddNodeCallback>();\n  const onCloseRef = useRef<(result?: AddNodeModalCloseResult) => void>();\n  const addNodeModalCloseResultRef = useRef<AddNodeModalCloseResult>();\n  const editService = useService<WorkflowEditService>(WorkflowEditService);\n  const nodesService = useService<WorkflowNodesService>(WorkflowNodesService);\n  const openWorkflowDetail = useOpenWorkflowDetail();\n  const createOpenWorkflowModalCallback =\n    (isImageflow): WorkFlowModalModeProps['onAdd'] =>\n    async (val, config) => {\n      if (!val) {\n        return false;\n      }\n\n      if (\n        !(await nodeVersionService.addSubWorkflowCheck(\n          val.workflow_id,\n          val.version_name,\n        ))\n      ) {\n        return false;\n      }\n\n      const { name } = val;\n\n      const templateIcon = playgroundContext.getTemplateList([\n        isImageflow ? StandardNodeType.Imageflow : StandardNodeType.SubWorkflow,\n      ])?.[0]?.icon_url;\n\n      const nodeJSON = createSubWorkflowNodeInfo({\n        workflowItem: val,\n        spaceId,\n        templateIcon,\n        isImageflow,\n      });\n\n      const position = {\n        clientX: prevAddNodeRef.current.x,\n        clientY: prevAddNodeRef.current.y,\n      };\n      const { isDrag } = prevAddNodeRef.current;\n\n      if (addNodeCallbackRef.current) {\n        addNodeCallbackRef.current({\n          nodeType: StandardNodeType.SubWorkflow,\n          nodeJSON,\n        });\n      } else {\n        // This may fail, the underlying call released_workflows interface\n        editService.addNode(\n          StandardNodeType.SubWorkflow,\n          nodeJSON,\n          position,\n          isDrag,\n        );\n      }\n      Toast.success({\n        content: (\n          <Space spacing={6}>\n            <Text>\n              {isImageflow\n                ? I18n.t('workflow_add_imageflow_toast_success', { name })\n                : I18n.t('wf_node_add_wf_modal_toast_wf_added', {\n                    workflowName: name,\n                  })}\n            </Text>\n            {config.isDup ? (\n              <Button\n                color=\"primary\"\n                onClick={() => {\n                  window.open(\n                    `/work_flow?space_id=${spaceId}&workflow_id=${val.workflow_id}`,\n                  );\n                }}\n              >\n                {I18n.t('workflowstore_continue_editing')}\n              </Button>\n            ) : null}\n          </Space>\n        ),\n      });\n    };\n\n  const openWorkflowModalCallback = createOpenWorkflowModalCallback(false);\n  const openImageflowModalCallback = createOpenWorkflowModalCallback(true);\n  const onCloseModal = () => {\n    onCloseRef.current?.(addNodeModalCloseResultRef.current);\n    addNodeModalCloseResultRef.current = undefined;\n  };\n  //  Workflow Add pop-up window\n  const workflowModalFrom = globalState.projectId\n    ? WorkflowModalFrom.ProjectWorkflowAddNode\n    : WorkflowModalFrom.WorkflowAddNode;\n  const {\n    node: workflowModal,\n    open: openWorkflow,\n    close: closeWorkflow,\n  } = useWorkflowModal({\n    from: workflowModalFrom,\n    flowMode: WorkflowMode.Workflow,\n    onAdd: openWorkflowModalCallback,\n    bindBizId: globalState.config?.bindBizID,\n    bindBizType: globalState.config?.bindBizType,\n    excludedWorkflowIds: [globalState.workflowId],\n    projectId: globalState.projectId,\n    onDupSuccess: () => null,\n    onClose: onCloseModal,\n    onCreateSuccess: val => {\n      addNodeModalCloseResultRef.current = AddNodeModalCloseResult.OpenNewTab;\n      closeWorkflow();\n      if (workflowModalFrom === WorkflowModalFrom.ProjectWorkflowAddNode) {\n        globalState.playgroundProps.refetchProjectResourceList?.();\n      }\n      openWorkflowDetail({\n        workflowId: val.workflowId,\n        spaceId: val.spaceId,\n        projectId: globalState.projectId,\n        ideNavigate: projectApi?.navigate,\n      });\n    },\n    onItemClick: ({ item }, modalState) => {\n      if (isSelectProjectCategory(modalState)) {\n        addNodeModalCloseResultRef.current = AddNodeModalCloseResult.OpenNewTab;\n        closeWorkflow();\n        projectApi?.navigate?.(`/workflow/${(item as Workflow).workflow_id}`);\n        return { handled: true };\n      }\n      return { handled: false };\n    },\n  });\n\n  // image stream pop-up\n  const {\n    node: imageFlowModal,\n    open: openImageflow,\n    close: closeImageflow,\n  } = useWorkflowModal({\n    from: WorkflowModalFrom.WorkflowAddNode,\n    flowMode: WorkflowMode.Imageflow,\n    onAdd: openImageflowModalCallback,\n    excludedWorkflowIds: [globalState.workflowId],\n    onDupSuccess: () => null,\n    onClose: onCloseModal,\n  });\n\n  // Plugin Add pop-up window\n  const pluginModalFrom = globalState.projectId\n    ? From.ProjectWorkflow\n    : From.WorkflowAddNode;\n  const {\n    node: pluginModal,\n    open: openPlugin,\n    close: closePlugin,\n  } = usePluginApisModal({\n    from: pluginModalFrom,\n    projectId: globalState.projectId,\n    closeCallback: onCloseModal,\n    clickProjectPluginCallback: pluginInfo => {\n      addNodeModalCloseResultRef.current = AddNodeModalCloseResult.OpenNewTab;\n      closePlugin();\n      projectApi?.navigate(`/plugin/${pluginInfo?.id}`);\n    },\n    openModeCallback: async val => {\n      if (!val) {\n        return false;\n      }\n\n      if (\n        !(await nodeVersionService.addApiCheck(val.plugin_id, val.version_ts))\n      ) {\n        return false;\n      }\n\n      const templateIcon = playgroundContext.getNodeTemplateInfoByType(\n        StandardNodeType.Api,\n      )?.icon;\n      const nodeJSON = createApiNodeInfo(val, templateIcon);\n      const position = {\n        clientX: prevAddNodeRef.current.x,\n        clientY: prevAddNodeRef.current.y,\n      };\n      const { isDrag } = prevAddNodeRef.current;\n\n      // Plugin panel pop-up - click Add Plugin, request the api-detail interface in advance, get the plugin details, and call the handleSelectNode method of panel.tsx.\n      if (addNodeCallbackRef.current) {\n        addNodeCallbackRef.current({\n          nodeType: StandardNodeType.Api,\n          nodeJSON,\n        });\n      } else {\n        // Dragging the \"plug-in\", or the \"subprocess\" node itself, will follow the logic here, at which point isDrag is true\n        editService.addNode(StandardNodeType.Api, nodeJSON, position, isDrag);\n      }\n      Toast.success(\n        I18n.t('bot_edit_tool_added_toast', {\n          api_name: val?.name,\n        }) as string,\n      );\n    },\n    onCreateSuccess:\n      pluginModalFrom === From.ProjectWorkflow\n        ? val => {\n            addNodeModalCloseResultRef.current =\n              AddNodeModalCloseResult.OpenNewTab;\n            closePlugin();\n            if (val?.pluginId && pluginModalFrom === From.ProjectWorkflow) {\n              globalState.playgroundProps.refetchProjectResourceList?.();\n              projectApi?.navigate(`/plugin/${val.pluginId}`);\n            }\n          }\n        : undefined,\n  });\n  const wrapOpenFunc = function <T>(\n    openFunc: (modalProps?: T) => void,\n    closeFunc?: () => void,\n  ) {\n    return ({\n      onAdd,\n      closeOnAdd,\n      onClose,\n      modalProps,\n    }: {\n      onAdd?: AddNodeCallback;\n      onClose?: (closeResult?: AddNodeModalCloseResult) => void;\n      closeOnAdd?: boolean;\n      modalProps?: T;\n    } = {}) => {\n      if (onAdd) {\n        addNodeCallbackRef.current = (...args) => {\n          const nodeJSON = args?.[0]?.nodeJSON as WorkflowNodeJSON<\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            Record<string, any>\n          >;\n          if (nodeJSON?.data?.nodeMeta?.title) {\n            nodeJSON.data.nodeMeta.title = nodesService.createUniqTitle(\n              nodeJSON.data.nodeMeta.title,\n            );\n          }\n          addNodeModalCloseResultRef.current =\n            AddNodeModalCloseResult.NodeAdded;\n          onAdd?.(...args);\n          closeOnAdd ? closeFunc?.() : null;\n        };\n      } else {\n        addNodeCallbackRef.current = undefined;\n      }\n      onCloseRef.current = onClose;\n      openFunc?.(modalProps);\n    };\n  };\n  return {\n    workflowModal,\n    openWorkflow: wrapOpenFunc(openWorkflow, closeWorkflow),\n\n    imageFlowModal,\n    openImageflow: wrapOpenFunc(openImageflow, closeImageflow),\n\n    pluginModal,\n    openPlugin: wrapOpenFunc(openPlugin, closePlugin),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef } from 'react';\n\nimport { set } from 'lodash-es';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { getWorkflowVersionByPluginId } from '@/utils';\nimport { type HandleAddNode } from '@/typing';\nimport { WorkflowEditService } from '@/services';\nimport { useNodeVersionService, useGlobalState } from '@/hooks';\n\nimport { useAddNodeModal } from './use-add-node-modal';\n\nexport interface AddNodeProps {\n  x: number;\n  y: number;\n  isDrag: boolean;\n}\nexport const useAddNode = () => {\n  const prevAddNodeRef = useRef<{ x: number; y: number; isDrag: boolean }>({\n    x: 0,\n    y: 0,\n    isDrag: false,\n  });\n\n  const updateAddNodePosition = (props: AddNodeProps) => {\n    prevAddNodeRef.current = props;\n  };\n\n  const {\n    openPlugin,\n    openWorkflow,\n    openImageflow,\n    pluginModal,\n    workflowModal,\n    imageFlowModal,\n  } = useAddNodeModal(prevAddNodeRef);\n\n  const editService = useService<WorkflowEditService>(WorkflowEditService);\n  const nodeVersionService = useNodeVersionService();\n  const { spaceId } = useGlobalState();\n\n  const handleAddSubWorkflow: HandleAddNode = async (\n    item,\n    coord = { x: 0, y: 0 },\n    isDrag = false,\n  ) => {\n    const { nodeType, nodeJson, nodeVersionInfo } = item;\n    if (nodeJson) {\n      const { workflowId, pluginId } = nodeVersionInfo;\n      const versionName = await getWorkflowVersionByPluginId({\n        spaceId,\n        pluginId,\n      });\n      versionName && set(nodeJson, 'data.inputs.workflowVersion', versionName);\n\n      if (\n        !(await nodeVersionService.addSubWorkflowCheck(workflowId, versionName))\n      ) {\n        return;\n      }\n      editService.addNode(\n        nodeType,\n        nodeJson,\n        { clientX: coord?.x || 0, clientY: coord?.y || 0 },\n        isDrag,\n      );\n      return;\n    }\n    // Record the historical location and open the subprocess pop-up window\n    prevAddNodeRef.current = {\n      x: coord.x,\n      y: coord.y,\n      isDrag,\n    };\n    openWorkflow();\n    return;\n  };\n  const handleAddPlugin: HandleAddNode = async (\n    item,\n    coord = { x: 0, y: 0 },\n    isDrag = false,\n  ) => {\n    const { nodeType, nodeJson, modalProps, nodeVersionInfo } = item;\n\n    if (nodeJson) {\n      const { pluginId, version } = nodeVersionInfo;\n      if (!(await nodeVersionService.addApiCheck(pluginId, version))) {\n        return;\n      }\n      // Node add panel, drag and drop to add specific plug-in node logic\n      editService.addNode(\n        nodeType,\n        nodeJson,\n        { clientX: coord?.x || 0, clientY: coord?.y || 0 },\n        isDrag,\n      );\n      return;\n    }\n    // Record the historical location and open the plug-in pop-up window.\n    prevAddNodeRef.current = {\n      x: coord.x,\n      y: coord.y,\n      isDrag,\n    };\n\n    // Open the plug-in pop-up window to add a node\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    openPlugin({ modalProps: modalProps as any });\n  };\n\n  const handleAddNode: HandleAddNode = (\n    item,\n    coord = { x: 0, y: 0 },\n    isDrag = false,\n  ) => {\n    const { nodeType } = item;\n\n    if (nodeType === StandardNodeType.Api) {\n      // Node add panel, drag and drop to add specific child plugins\n      return handleAddPlugin(item, coord, isDrag);\n    }\n\n    if (nodeType === StandardNodeType.SubWorkflow) {\n      // Node add panel, drag and drop to add specific sub-processes\n      return handleAddSubWorkflow(item, coord, isDrag);\n    }\n\n    // Node add panel, drag and drop to add ordinary nodes\n    editService.addNode(\n      item.nodeType,\n      item.nodeJson,\n      { clientX: coord?.x || 0, clientY: coord?.y || 0 },\n      isDrag,\n    );\n  };\n\n  return {\n    handleAddNode,\n    openPlugin,\n    openWorkflow,\n    openImageflow,\n    updateAddNodePosition,\n    modals: [workflowModal, pluginModal, imageFlowModal],\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Global hook to manage the state of the Biz IDE and interact with React components\n */\n\nimport { create } from 'zustand';\nimport { I18n } from '@coze-arch/i18n';\nimport { Modal } from '@coze-arch/bot-semi';\nimport { IconWarningInfo } from '@coze-arch/bot-icons';\n\nimport { useSingletonInnerSideSheet } from '../components/workflow-inner-side-sheet';\n\n// TODO: Change to UIModal\n\nimport styles from './use-biz-ide-state.module.less';\n\ninterface BizIDEState {\n  /**\n   * The currently enabled BizIDE unique identifier\n   */\n  uniqueId: string | null;\n  /**\n   * Is BizIDE currently turned on?\n   */\n  isBizIDEOpen: boolean;\n  /**\n   * Is the currently enabled BizIDE in the test run?\n   */\n  isBizIDETesting: boolean;\n}\n\ninterface BizIDEStateStore extends BizIDEState {\n  setUniqueId: (uniqueId: string) => void;\n  setIsBizIDEOpen: (isBizIDEOpen: boolean) => void;\n  setIsBizIDETesting: (isBizIDETesting: boolean) => void;\n  setData: (data: Partial<BizIDEState>) => void;\n}\n\nconst useBizIDEStateStore = create<BizIDEStateStore>(set => ({\n  uniqueId: null,\n  setUniqueId: uniqueId => set({ uniqueId }),\n  isBizIDEOpen: false,\n  setIsBizIDEOpen: isBizIDEOpen => set({ isBizIDEOpen }),\n  isBizIDETesting: false,\n  setIsBizIDETesting: isBizIDETesting => set({ isBizIDETesting }),\n  setData: (data: Partial<BizIDEState>) => set(data),\n}));\n\nexport const useBizIDEState = () => {\n  const {\n    uniqueId,\n    isBizIDEOpen,\n    isBizIDETesting,\n    setUniqueId,\n    setIsBizIDEOpen,\n    setIsBizIDETesting,\n    setData,\n  } = useBizIDEStateStore(state => state);\n\n  const {\n    handleOpen: openSideSheet,\n    handleClose: closeSideSheet,\n    visible,\n    forceClose,\n  } = useSingletonInnerSideSheet(uniqueId || '');\n\n  const openBizIDE = async id => {\n    const opened = await openSideSheet(id);\n    if (opened) {\n      setUniqueId(id);\n      setIsBizIDEOpen(true);\n    }\n  };\n\n  const closeBizIDE = async () => {\n    const closed = await closeSideSheet();\n    if (closed) {\n      setData({\n        uniqueId: null,\n        isBizIDEOpen: false,\n        isBizIDETesting: false,\n      });\n    }\n    return closed;\n  };\n\n  const closeConfirm = async (id?: string): Promise<boolean> => {\n    // When passing in the id, it means to close the pop-up window of the specified id. When the id is inconsistent with the current nodeId, it means that it has been closed\n    if (id && id !== uniqueId) {\n      return true;\n    }\n\n    if (!isBizIDEOpen || !isBizIDETesting) {\n      return true;\n    }\n\n    return new Promise(resolve => {\n      Modal.warning({\n        icon: (\n          <IconWarningInfo\n            className={styles.warningIcon}\n            style={{\n              width: 22,\n              height: 22,\n            }}\n          />\n        ),\n        title: I18n.t('workflow_detail_code_is_running'),\n        content: I18n.t('workflow_detail_code_is_terminate_execution'),\n        okType: 'warning',\n        okText: I18n.t('Confirm'),\n        cancelText: I18n.t('Cancel'),\n        onOk: () => {\n          setData({\n            uniqueId: null,\n            isBizIDEOpen: false,\n            isBizIDETesting: false,\n          });\n          resolve(true);\n        },\n        onCancel: () => {\n          resolve(false);\n        },\n      });\n    });\n  };\n\n  const forceCloseBizIDE = () => {\n    if (visible) {\n      forceClose();\n    }\n\n    setData({\n      uniqueId: null,\n      isBizIDEOpen: false,\n      isBizIDETesting: false,\n    });\n  };\n\n  return {\n    uniqueId,\n    isBizIDEOpen,\n    isBizIDETesting,\n    setBizIDEUniqueId: setUniqueId,\n    setIsBizIDEOpen,\n    setIsBizIDETesting,\n    /**\n      * Close Biz IDE\n      * Check whether it is running, including the appearance of the confirm dialog box is also encapsulated here\n      * You only need to call this hook externally.\n      * In three cases it resolves true and closes BizIDE.\n      *   1. BizIDE is not opened\n          2. BizIDE is open, but not running\n          3. BizIDE is running, but the user clicks confirm to confirm\n      */\n    closeBizIDE,\n    /**\n     * Force shutdown of Biz IDE, whether running or not\n     */\n    openBizIDE,\n    forceCloseBizIDE,\n    closeConfirm,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nexport enum EditorTheme {\n  Light = 'light',\n  Dark = 'dark',\n}\n\ninterface EditorThemeState {\n  editorTheme: EditorTheme;\n  setEditorTheme: (next: EditorTheme) => void;\n  isDarkTheme: boolean;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const EditorThemeContext = createContext<EditorThemeState>({\n  editorTheme: EditorTheme.Light,\n  setEditorTheme: _next => {\n    console.log(_next);\n  },\n  isDarkTheme: false,\n});\n\nexport const useEditorThemeState = () => useContext(EditorThemeContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowExecStateEntity } from '../entities/workflow-exec-state-entity';\n\nexport const useExecStateEntity = () => {\n  const entity = useEntity<WorkflowExecStateEntity>(WorkflowExecStateEntity);\n\n  return entity;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowFloatLayoutService } from '@/services/workflow-float-layout-service';\n\nexport const useFloatLayoutService = () => {\n  const floatLayoutService = useService(WorkflowFloatLayoutService);\n  return floatLayoutService;\n};\n\nexport const useFloatLayoutSize = () => {\n  const floatLayoutService = useFloatLayoutService();\n  const [size, setSize] = useState(floatLayoutService.size);\n\n  useEffect(() => {\n    const disposable = floatLayoutService.onSizeChange(setSize);\n    return () => disposable.dispose();\n  }, [floatLayoutService, setSize]);\n\n  return size;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { throttle, once } from 'lodash-es';\nimport { useQuery } from '@tanstack/react-query';\nimport {\n  type GetMetaRoleListResponse,\n  RoleType,\n} from '@coze-arch/idl/social_api';\nimport { Toast } from '@coze-arch/coze-design';\nimport { SocialApi } from '@coze-arch/bot-api';\n\nimport { useGlobalState } from './use-global-state';\nimport { useGetWorkflowMode } from './use-get-workflow-mode';\n\nconst warn = once(\n  throttle(() => Toast.warning(''), 10 * 1000),\n);\n\nconst useQuerySceneFlowMetaRole = () => {\n  const globalState = useGlobalState();\n  const { isSceneFlow } = useGetWorkflowMode();\n  const { bindBizID } = globalState;\n  if (isSceneFlow && !bindBizID) {\n    warn();\n  }\n\n  return useQuery({\n    queryKey: ['scene_flow_role_list'],\n    staleTime: 10 * 1000,\n    queryFn: () =>\n      SocialApi.GetMetaRoleList({\n        meta_id: bindBizID as string,\n      }),\n    placeholderData: {\n      role_list: [],\n    } as unknown as GetMetaRoleListResponse,\n    enabled: isSceneFlow && !!bindBizID,\n  });\n};\n\nexport const useGetSceneFlowRoleList = () => {\n  const { data: res, isLoading } = useQuerySceneFlowMetaRole();\n\n  return {\n    isLoading,\n    data: res?.role_list.map(item => ({\n      biz_role_id: item.biz_role_id as string,\n      role: item.name,\n      nickname: item.nickname,\n      role_type: item.role_type,\n      description: item.description,\n    })),\n  };\n};\n\nexport const useGetSceneFlowBot = () => {\n  const { data: res, isLoading } = useQuerySceneFlowMetaRole();\n  if (isLoading) {\n    return null;\n  } else {\n    const host = res?.role_list?.find(item => item.role_type === RoleType.Host);\n    return {\n      name: host?.name,\n      participantId: host?.participant_id,\n    };\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This hooks are used to quickly determine the type of workflow\n */\n\nimport { useEntity } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowMode } from '@coze-workflow/base/api';\n\nimport { WorkflowGlobalStateEntity } from '../typing';\n\nexport const useGetWorkflowMode = () => {\n  const globalState = useEntity<WorkflowGlobalStateEntity>(\n    WorkflowGlobalStateEntity,\n  );\n\n  const isImageFlow = globalState.flowMode === WorkflowMode.Imageflow;\n  const isSceneFlow = globalState.flowMode === WorkflowMode.SceneFlow;\n  const isChatflow = globalState.flowMode === WorkflowMode.ChatFlow;\n  // const isSceneFlow = true;\n\n  return {\n    isImageFlow,\n    isSceneFlow,\n    isChatflow,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useConfigEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowGlobalStateEntity } from '../entities';\n\n/** Get global state */\nexport const useGlobalState = (\n  listenChange = true,\n): WorkflowGlobalStateEntity => {\n  const globalState = useConfigEntity<WorkflowGlobalStateEntity>(\n    WorkflowGlobalStateEntity,\n    listenChange,\n  );\n  return globalState;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowLinesService } from '../services/workflow-line-service';\n\nexport const useLineService = () => {\n  const lineService = useService<WorkflowLinesService>(WorkflowLinesService);\n\n  return lineService;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { NodeRenderSceneContext } from '@/contexts/node-render-context';\n\nexport function useNodeRenderScene() {\n  const scene = useContext(NodeRenderSceneContext);\n\n  return {\n    isNewNodeRender: scene === 'new-node-render',\n    isOldNodeRender: scene === 'old-node-render',\n    isNodeSideSheet: scene === 'node-side-sheet',\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext, type ReactNode } from 'react';\n\nimport { create } from 'zustand';\n\ninterface NodeSideSheetStore {\n  leftPanelVisible?: boolean;\n  leftPanelWidth?: number;\n  leftPanelContent?: ReactNode;\n  leftPanelContentId?: string;\n  openLeftPanel: (options: { content: ReactNode; contentId?: string }) => void;\n  updateLeftPanel: (options: { content: ReactNode }) => void;\n  closeLeftPanel: () => void;\n  rightPanelVisible?: boolean;\n  rightPanelWidth: number;\n  rightPanelContent?: ReactNode;\n  openRightPanel: (options: { content: ReactNode }) => void;\n  closeRightPanel: () => void;\n  isNodeSideSheetVisible: boolean;\n  openNodeSideSheet: (options?: { width?: number }) => void;\n  mainPanelWidth?: number;\n  setMainPanelWidth: (width: number) => void;\n  closeNodeSideSheet: () => void;\n  closeAllExtraSheets: () => void;\n}\n\nexport const useNodeSideSheetStore = create<NodeSideSheetStore>(set => ({\n  isNodeSideSheetVisible: false,\n  leftPanelVisible: false,\n  mainPanelWidth: 360,\n  setMainPanelWidth: width => set({ mainPanelWidth: width }),\n  openNodeSideSheet: options =>\n    set(state => ({\n      isNodeSideSheetVisible: true,\n      width: options?.width || state.mainPanelWidth,\n    })),\n  closeNodeSideSheet: () => {\n    set({\n      isNodeSideSheetVisible: false,\n      leftPanelVisible: false,\n      leftPanelContent: undefined,\n      rightPanelVisible: false,\n      rightPanelContent: undefined,\n    });\n  },\n  openLeftPanel: options =>\n    set({\n      leftPanelVisible: true,\n      leftPanelContent: options.content,\n      leftPanelContentId: options.contentId,\n    }),\n\n  updateLeftPanel: options =>\n    set({\n      leftPanelContent: options.content,\n    }),\n\n  closeLeftPanel: () =>\n    set({\n      leftPanelVisible: false,\n      leftPanelContent: undefined,\n      leftPanelContentId: '',\n    }),\n  rightPanelWidth: 360,\n  openRightPanel: options =>\n    set({\n      rightPanelVisible: true,\n      rightPanelContent: options.content,\n    }),\n  closeRightPanel: () =>\n    set({\n      rightPanelVisible: false,\n      rightPanelContent: undefined,\n    }),\n  closeAllExtraSheets: () => {\n    set({\n      leftPanelVisible: false,\n      leftPanelContent: undefined,\n      rightPanelVisible: false,\n      rightPanelContent: undefined,\n    });\n  },\n}));\n\ninterface NodeFormPanelState {\n  fullscreenPanel: React.ReactNode;\n  setFullscreenPanel: (next: React.ReactNode) => void;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const NodeFormPanelContext = createContext(\n  {} as unknown as NodeFormPanelState,\n);\n\nexport const useNodeFormPanelState = () => useContext(NodeFormPanelContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { get } from 'lodash-es';\nimport { type FeedbackStatus } from '@flowgram-adapter/free-layout-editor';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowVariableService,\n  useVariableTypeChange,\n} from '@coze-workflow/variable';\nimport {\n  ValueExpressionType,\n  type ValueExpression,\n  type ViewVariableType,\n} from '@coze-workflow/base';\n\nimport { useNodeAvailableVariablesWithNode } from '@/form-extensions/hooks';\nimport { feedbackStatus2ValidateStatus } from '@/form-extensions/components/utils';\nimport { formatWithNodeVariables } from '@/form-extensions/components/tree-variable-selector/utils';\n\nexport const useRefInputProps = ({\n  disabledTypes,\n  value,\n  onChange,\n  node,\n  feedbackStatus,\n}: {\n  disabledTypes?: ViewVariableType[];\n  value?: ValueExpression;\n  onChange: (v: ValueExpression) => void;\n  node: FlowNodeEntity;\n  feedbackStatus?: FeedbackStatus;\n}) => {\n  const availableVariables = useNodeAvailableVariablesWithNode();\n\n  const variableService: WorkflowVariableService = useService(\n    WorkflowVariableService,\n  );\n  const variablesDataSource = formatWithNodeVariables(\n    availableVariables,\n    disabledTypes || [],\n  );\n\n  const keyPath = get(value, 'content.keyPath') as unknown as string[];\n\n  // Monitor changes in linkage variables to re-trigger the effect\n  useEffect(() => {\n    const hasDisabledTypes =\n      Array.isArray(disabledTypes) && disabledTypes.length > 0;\n\n    if (!keyPath || !hasDisabledTypes) {\n      return;\n    }\n\n    const listener = variableService.onListenVariableTypeChange(\n      keyPath,\n      v => {\n        // If the variable type changes and is located in disabledTypes, it needs to be cleared\n        if (v && (disabledTypes || []).includes(v.type)) {\n          onChange({\n            type: ValueExpressionType.REF,\n          });\n        }\n      },\n      { node },\n    );\n\n    return () => {\n      listener?.dispose();\n    };\n  }, [keyPath, disabledTypes]);\n\n  useVariableTypeChange({\n    keyPath,\n    onTypeChange: ({ variableMeta: v }) => {\n      const hasDisabledTypes =\n        Array.isArray(disabledTypes) && disabledTypes.length > 0;\n      if (!hasDisabledTypes) {\n        return;\n      }\n\n      if (v && (disabledTypes || []).includes(v.type)) {\n        onChange({\n          type: ValueExpressionType.REF,\n        });\n      }\n    },\n  });\n\n  return {\n    variablesDataSource,\n    validateStatus: feedbackStatus2ValidateStatus(feedbackStatus),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useCallback,\n  type ReactNode,\n  type CSSProperties,\n  useState,\n} from 'react';\n\nimport classNames from 'classnames';\nimport {\n  ValueExpression,\n  ValueExpressionType,\n  type RefExpression,\n  type ViewVariableType,\n} from '@coze-workflow/base';\nimport { type TreeNodeData } from '@coze-arch/bot-semi/Tree';\nimport { IconCozApply } from '@coze-arch/coze-design/icons';\nimport { IconButton, type TreeSelectProps } from '@coze-arch/coze-design';\n\nimport {\n  RefValueDisplay,\n  type RefTagColor,\n  type RefValueDisplayProps,\n} from '@/form-extensions/components/value-expression-input/ref-value-display';\nimport {\n  type CustomFilterVar,\n  type VariableTreeDataNode,\n  type RenderDisplayVarName,\n} from '@/form-extensions/components/tree-variable-selector/types';\nimport {\n  VariableSelector,\n  type VariableSelectorProps,\n} from '@/form-extensions/components/tree-variable-selector';\nexport const useRefInputNode = ({\n  value,\n  onChange,\n  onBlur,\n  disabled,\n  variablesDataSource,\n  validateStatus,\n  readonly,\n  invalidContent,\n  renderDisplayVarName,\n  testId,\n  disabledTypes,\n  showClear = false,\n  customFilterVar,\n  setFocused,\n  style,\n  refTagColor,\n  hideDeleteIcon,\n  variableTagStyle,\n  optionFilter,\n  renderExtraOption,\n  enableSelectNode,\n  popoverStyle,\n  handleDataSource,\n  variableTypeConstraints,\n}: {\n  value?: ValueExpression;\n  onChange: (v: ValueExpression | undefined) => void;\n  onBlur?: () => void;\n  disabled?: boolean;\n  variablesDataSource?: VariableTreeDataNode[];\n  validateStatus?: TreeSelectProps['validateStatus'];\n  readonly?: boolean;\n  testId?: string;\n  disabledTypes?: ViewVariableType[];\n  showClear?: boolean;\n  invalidContent?: string;\n  renderDisplayVarName?: RenderDisplayVarName;\n  customFilterVar?: CustomFilterVar;\n  setFocused?: (focused: boolean) => void;\n  style?: CSSProperties;\n  refTagColor?: RefTagColor;\n  hideDeleteIcon?: boolean;\n  variableTagStyle?: CSSProperties;\n  optionFilter?: VariableSelectorProps['optionFilter'];\n  handleDataSource?: VariableSelectorProps['handleDataSource'];\n  renderExtraOption?: (\n    data?: TreeNodeData[],\n    action?: {\n      hiddenPopover: () => void;\n    },\n  ) => ReactNode;\n  enableSelectNode?: boolean;\n  popoverStyle?: CSSProperties;\n  /* Type restrictions, when the reference type does not meet the restrictions, a warning message is displayed */\n  variableTypeConstraints?: RefValueDisplayProps['variableTypeConstraints'];\n}) => {\n  const onRefChange = useCallback(\n    (v: string[] | undefined): void => {\n      if (v === undefined) {\n        onChange(undefined);\n      } else {\n        onChange({\n          type: ValueExpressionType.REF,\n          content: { keyPath: v as string[] },\n        });\n      }\n    },\n    [onChange],\n  );\n\n  const handleRefRemove = () => {\n    onChange?.(undefined);\n    onBlur?.();\n  };\n\n  const [focused, setStateFocused] = useState(false);\n  const _setFocused = useCallback(\n    (v: boolean) => {\n      setStateFocused(v);\n      setFocused?.(v);\n    },\n    [setFocused],\n  );\n\n  const renderVariableSelect = (trigger: ReactNode) =>\n    readonly && trigger ? (\n      trigger\n    ) : (\n      <VariableSelector\n        testId={testId}\n        disabled={disabled}\n        disabledTypes={disabledTypes}\n        dataSource={variablesDataSource}\n        value={\n          value && ValueExpression.isRef(value)\n            ? (value.content?.keyPath as VariableSelectorProps['value'])\n            : undefined\n        }\n        onChange={onRefChange}\n        onBlur={onBlur}\n        validateStatus={validateStatus}\n        readonly={readonly}\n        showClear={showClear}\n        customFilterVar={customFilterVar}\n        onPopoverVisibleChange={_setFocused}\n        trigger={trigger}\n        style={style}\n        invalidContent={invalidContent}\n        renderDisplayVarName={renderDisplayVarName}\n        optionFilter={optionFilter}\n        renderExtraOption={renderExtraOption}\n        enableSelectNode={enableSelectNode}\n        popoverStyle={popoverStyle}\n        handleDataSource={handleDataSource}\n      />\n    );\n\n  const renderVariableDisplay = (props?: { needWrapper?: boolean }) =>\n    props?.needWrapper ? (\n      <div\n        className={classNames(\n          'w-full max-w-[100%] h-[24px] pr-[4px]',\n          'flex flex-row items-center justify-between',\n          'bg-transparent hover:bg-background-5 active:bg-background-6',\n          'rounded-lg border border-solid coz-stroke-plus hover:coz-mg-secondary-hovered active:coz-mg-secondary-pressed',\n          {\n            'semi-input-wrapper-error': validateStatus === 'error',\n            'coz-stroke-primary': validateStatus !== 'error',\n            '!coz-stroke-hglt': focused,\n            'pointer-events-none': readonly,\n          },\n        )}\n      >\n        {renderVariableDisplay()}\n        <div>\n          {renderVariableSelect(\n            <IconButton\n              size=\"mini\"\n              color=\"secondary\"\n              icon={<IconCozApply className=\"text-[16px]\" />}\n            />,\n          )}\n        </div>\n      </div>\n    ) : (\n      renderVariableSelect(\n        <div\n          className={classNames(\n            'cursor-pointer w-full overflow-hidden flex items-center pl-0.5',\n          )}\n        >\n          <RefValueDisplay\n            value={value as RefExpression}\n            onClose={handleRefRemove}\n            tagColor={refTagColor}\n            closable={!hideDeleteIcon}\n            style={variableTagStyle}\n            variableTypeConstraints={variableTypeConstraints}\n            readonly={readonly}\n          />\n        </div>,\n      )\n    );\n  return {\n    renderVariableSelect,\n    renderVariableDisplay,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type CSSProperties } from 'react';\n\nimport { type FeedbackStatus } from '@flowgram-adapter/free-layout-editor';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type ValueExpression,\n  type ViewVariableType,\n} from '@coze-workflow/base/types';\nimport { type TreeSelectProps } from '@coze-arch/coze-design';\n\nimport {\n  type CustomFilterVar,\n  type RenderDisplayVarName,\n} from '@/form-extensions/components/tree-variable-selector/types';\n\nimport { useRefInputProps } from './use-ref-input-props';\nimport { useRefInputNode } from './use-ref-input-node';\n\nexport const useRefInput = ({\n  node,\n  feedbackStatus,\n  value,\n  onChange,\n  onBlur,\n  disabled,\n  readonly,\n  testId,\n  disabledTypes,\n  showClear = false,\n  customFilterVar,\n  setFocused,\n  style,\n  invalidContent,\n  renderDisplayVarName,\n}: {\n  node: FlowNodeEntity;\n  feedbackStatus?: FeedbackStatus;\n  value?: ValueExpression;\n  onChange: (v: ValueExpression | undefined) => void;\n  onBlur?: () => void;\n  disabled?: boolean;\n  readonly?: boolean;\n  invalidContent?: string;\n  renderDisplayVarName?: RenderDisplayVarName;\n  testId?: string;\n  disabledTypes?: ViewVariableType[];\n  showClear?: boolean;\n  customFilterVar?: CustomFilterVar;\n  style?: CSSProperties;\n  setFocused?: (focused: boolean) => void;\n}) => {\n  const { variablesDataSource, validateStatus } = useRefInputProps({\n    disabledTypes,\n    value,\n    onChange,\n    node,\n    feedbackStatus,\n  });\n\n  const { renderVariableSelect, renderVariableDisplay } = useRefInputNode({\n    value,\n    onChange,\n    onBlur,\n    disabled,\n    variablesDataSource,\n    validateStatus: validateStatus as TreeSelectProps['validateStatus'],\n    readonly,\n    testId,\n    disabledTypes,\n    invalidContent,\n    renderDisplayVarName,\n    showClear,\n    customFilterVar,\n    setFocused,\n    style,\n  });\n  return {\n    renderVariableSelect,\n    renderVariableDisplay,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { persist, devtools } from 'zustand/middleware';\nimport { create } from 'zustand';\n\ninterface ResizableSidePanelStoreState {\n  width: number;\n}\n\ninterface ResizableSidePanelStoreActions {\n  setWidth: (width: number) => void;\n}\n\ntype ResizableSidePanelStore = ResizableSidePanelStoreState &\n  ResizableSidePanelStoreActions;\n\nconst NAME = 'workflow-resizable-side-panel';\n\n/**\n * Adjustable width side window state, requires persistence\n */\nexport const useResizableSidePanelStore = create<ResizableSidePanelStore>()(\n  devtools(\n    persist(\n      set => ({\n        width: 0,\n        setWidth: width => set({ width }),\n      }),\n      {\n        name: NAME,\n      },\n    ),\n    {\n      enabled: IS_DEV_MODE,\n      name: NAME,\n    },\n  ),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useGlobalState } from './use-global-state';\n\nexport const useSpaceId = (): string => {\n  const globalState = useGlobalState();\n  return globalState.spaceId;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useConfigEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowTemplateStateEntity } from '@/entities';\n\nexport const useTemplateService = () => {\n  const entity = useConfigEntity<WorkflowTemplateStateEntity>(\n    WorkflowTemplateStateEntity,\n    true,\n  );\n\n  return entity;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef } from 'react';\n\nimport { type GetWorkFlowProcessData } from '@coze-arch/idl/workflow_api';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { TestRunState } from '../services/workflow-run-service';\nimport { WorkflowRunService } from '../services';\nimport { useTestRunFlow } from '../components/test-run/hooks/use-test-run-flow';\nimport { useExecStateEntity } from './use-exec-state-entity';\n\nexport interface TestRunInstanceAction {\n  /* Trigger full process testrun */\n  handleTestRun: () => Promise<void>;\n  cancelTestRun: () => Promise<void>;\n  pauseTestRun: () => void;\n  continueTestRun: () => void;\n\n  getTestRunHistory: (config: {\n    /** Whether to display node results */\n    showNodeResults?: boolean;\n    /** Specify the execution ID, if not, the last run result will be displayed */\n    executeId?: string;\n  }) => Promise<GetWorkFlowProcessData>;\n}\n\nexport interface TestRunInstanceState {\n  /* Is it in progress? */\n  isExecuting: boolean;\n  /* Was the execution successful? */\n  isSucceed: boolean;\n  /* Whether the execution failed */\n  isFailed: boolean;\n  /* Whether to cancel the execution */\n  isCanceled: boolean;\n  /* Whether to pause */\n  isPaused: boolean;\n  /* Is the run over? */\n  isEnd: boolean;\n}\n\nexport interface TestRunInstanceCallback {\n  /** Callback before testRun execution */\n  onBeforeTestRun?: () => void;\n  /** testRun starts executing callbacks */\n  onTestRunStart?: (executeId: string, isSingleMode?: boolean) => void;\n  /** testRun cancels callback */\n  onTestRunCanceled?: (executeId: string) => void;\n  /** testRun failed callback */\n  onTestRunFailed?: (executeId: string) => void;\n  /** testRun successful callback */\n  onTestRunSucceed?: (executeId: string) => void;\n  /** testRun end callback */\n  onTestRunEnd?: (testRunState: TestRunState, executeId: string) => void;\n}\n\nexport type TestRunInstance = TestRunInstanceAction & TestRunInstanceState;\n\nexport const useTestRun = (props?: {\n  callbacks?: TestRunInstanceCallback;\n}): TestRunInstance => {\n  const { callbacks = {} } = props || {};\n  const {\n    onBeforeTestRun,\n    onTestRunStart,\n    onTestRunEnd,\n    onTestRunFailed,\n    onTestRunCanceled,\n    onTestRunSucceed,\n  } = callbacks;\n\n  const runService = useService<WorkflowRunService>(WorkflowRunService);\n\n  const {\n    config: { executeId, isSingleMode },\n  } = useExecStateEntity();\n\n  const isSingleModeRef = useRef(isSingleMode);\n  isSingleModeRef.current = isSingleMode;\n\n  const { onTestRunStateChange, testRunState } = runService;\n\n  const { testRunFlow } = useTestRunFlow();\n\n  const testRunInstance: TestRunInstance = {\n    handleTestRun: async () => {\n      onBeforeTestRun?.();\n      await testRunFlow();\n    },\n    cancelTestRun: runService.cancelTestRun,\n    pauseTestRun: () => runService.pauseTestRun(),\n    continueTestRun: () => runService.continueTestRun(),\n    getTestRunHistory: config => runService.getProcessResult(config),\n\n    isExecuting: testRunState === TestRunState.Executing,\n    isSucceed: testRunState === TestRunState.Succeed,\n    isFailed: testRunState === TestRunState.Failed,\n    isCanceled: testRunState === TestRunState.Canceled,\n    isPaused: testRunState === TestRunState.Paused,\n    isEnd: [\n      TestRunState.Succeed,\n      TestRunState.Failed,\n      TestRunState.Canceled,\n    ].includes(testRunState),\n  };\n\n  useEffect(() => {\n    // Handling testRun callbacks\n    const dispose = onTestRunStateChange(({ prevState, curState }) => {\n      if (\n        [\n          TestRunState.Succeed,\n          TestRunState.Failed,\n          TestRunState.Canceled,\n        ].includes(curState)\n      ) {\n        onTestRunEnd?.(curState, executeId);\n\n        switch (curState) {\n          case TestRunState.Failed:\n            onTestRunFailed?.(executeId);\n            break;\n          case TestRunState.Succeed:\n            onTestRunSucceed?.(executeId);\n            break;\n          case TestRunState.Canceled:\n            onTestRunCanceled?.(executeId);\n            break;\n          default:\n            break;\n        }\n      }\n\n      if (\n        prevState === TestRunState.Idle &&\n        curState === TestRunState.Executing\n      ) {\n        onTestRunStart?.(executeId, isSingleModeRef.current);\n      }\n    });\n\n    return () => dispose.dispose();\n  }, [callbacks, executeId]);\n\n  return testRunInstance;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  WorkflowNodePortsData,\n  useCurrentEntity,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { useLineService } from './use-line-service';\n\n/**\n * After the port ordering is updated, it needs to be reconnected.\n *\n * In the case of multiple ports, index is used as the portId instead of the uid.\n *\n * When the port ordering changes, the index does not change. If you want the connection and data to remain consistent, you can only reconnect.\n *\n * */\nexport const useUpdateSortedPortLines = (\n  calcPortId: (index: number) => string,\n) => {\n  const node = useCurrentEntity();\n\n  const lineService = useLineService();\n\n  /**\n   *  Reconnect all the connections between gastIndex and endIndex\n   *  Interacting in pairs, for example:\n   *\n   *  0 1 2\n   *\n   *  1 0 2\n   *\n   *  1 2 0\n   * */\n  const updateSortedPortLines = (startIndex: number, endIndex: number) => {\n    if (startIndex === endIndex) {\n      return;\n    }\n\n    const step = startIndex < endIndex ? 1 : -1;\n\n    for (let i = startIndex; i !== endIndex; i += step) {\n      const oldPortInfo = {\n        from: node.id,\n        fromPort: calcPortId(i),\n      };\n      const newPortInfo = {\n        from: node.id,\n        fromPort: calcPortId(i + step),\n      };\n      lineService.replaceLineByPort(oldPortInfo, newPortInfo);\n    }\n\n    // After the drag ends, the portId corresponding to the port dom changes and needs to be updated.\n    node\n      .getData<WorkflowNodePortsData>(WorkflowNodePortsData)\n      .updateDynamicPorts();\n  };\n\n  return updateSortedPortLines;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Image types that support preview\nexport const PREVIEW_IMAGE_TYPE = ['jpg', 'jpeg', 'png', 'webp', 'svg'];\n\nexport const MAX_IMAGE_SIZE = 1024 * 1024 * 5;\n/**\n * File expansion to 500MB\n */\nexport const MAX_FILE_SIZE = 1024 * 1024 * 500;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum FileItemStatus {\n  Success = 'success',\n  UploadFail = 'uploadFail',\n  ValidateFail = 'validateFail',\n  Validating = 'validating',\n  Uploading = 'uploading',\n  Wait = 'wait',\n}\n\nexport interface FileItem extends File {\n  // unique identifier\n  uid?: string;\n  // File address\n  url?: string;\n  // upload progress\n  percent?: number;\n  // verification information\n  validateMessage?: string;\n  status?: FileItemStatus;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\nimport { useState } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { workflowApi } from '@coze-workflow/base/api';\nimport { type ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { upLoadFile } from '@coze-arch/bot-utils';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { validate } from './validate';\nimport { FileItemStatus, type FileItem } from './types';\nimport { MAX_IMAGE_SIZE, MAX_FILE_SIZE } from './constant';\n\nexport interface UploadConfig {\n  initialValue?: FileItem[];\n  customValidate?: (file: FileItem) => Promise<string | undefined>;\n  timeout?: number;\n  fileType?: 'object' | 'image';\n  multiple?: boolean;\n  maxSize?: number;\n  inputType?: ViewVariableType;\n  accept?: string;\n  maxFileCount?: number;\n}\n\nexport const useUpload = (props?: UploadConfig) => {\n  const {\n    initialValue = [],\n    customValidate,\n    timeout,\n    fileType,\n    multiple = true,\n    maxSize,\n    accept,\n    maxFileCount = 20,\n  } = props || {};\n  const [fileList, setFileList] = useState(initialValue);\n  const isUploading = fileList.some(\n    file => file.status === FileItemStatus.Uploading,\n  );\n\n  const updateFileItemProps = (uid, fileItemProps) => {\n    setFileList(prevList => {\n      const newList = [...prevList];\n      const index = newList.findIndex(item => item.uid === uid);\n      if (index !== -1) {\n        Object.keys(fileItemProps).forEach(key => {\n          newList[index][key] = fileItemProps[key];\n        });\n      }\n\n      return newList;\n    });\n  };\n\n  const uploadFileWithProgress = async file => {\n    let progressTimer;\n\n    try {\n      const doUpload = async () =>\n        await upLoadFile({\n          biz: 'workflow',\n          fileType,\n          file,\n          getProgress: percent => {\n            updateFileItemProps(file.uid, {\n              percent,\n            });\n          },\n        });\n\n      if (timeout) {\n        progressTimer = setTimeout(() => {\n          throw new Error('Upload timed out');\n        }, timeout);\n      }\n\n      const uri = await doUpload();\n\n      if (!uri) {\n        throw new CustomError('normal_error', 'no uri');\n      }\n\n      // Upload complete, clear timeout timer\n      clearTimeout(progressTimer);\n\n      // Add uri and get the url.\n      const { url } = await workflowApi.SignImageURL(\n        {\n          uri,\n        },\n        {\n          __disableErrorToast: true,\n        },\n      );\n\n      if (!url) {\n        throw new Error(I18n.t('imageflow_upload_error'));\n      }\n\n      updateFileItemProps(file.uid, {\n        url,\n        status: FileItemStatus.Success,\n      });\n\n      return url;\n    } catch (error) {\n      updateFileItemProps(file.uid, {\n        validateMessage: error.message || 'upload failed',\n        status: FileItemStatus.ValidateFail,\n      });\n      clearTimeout(progressTimer);\n    }\n  };\n\n  const validateFile = async (file: FileItem): Promise<string | undefined> => {\n    const validateMsg = await validate(file, {\n      customValidate,\n      maxSize: maxSize ?? fileType === 'image' ? MAX_IMAGE_SIZE : MAX_FILE_SIZE,\n      accept,\n    });\n    if (validateMsg) {\n      return validateMsg;\n    }\n  };\n\n  const upload = async (file: FileItem) => {\n    file.status = FileItemStatus.Uploading;\n    if (!file.uid) {\n      file.uid = nanoid();\n    }\n\n    const errorInfo = await validateFile(file);\n\n    if (errorInfo) {\n      Toast.error(errorInfo);\n      return;\n    }\n\n    if (!multiple && fileList[0]) {\n      setFileList([]);\n    }\n\n    let canUpload = true;\n\n    setFileList(prevList => {\n      if (prevList.length >= maxFileCount) {\n        Toast.warning(I18n.t('plugin_file_max'));\n        canUpload = false;\n        return prevList;\n      }\n      return [...prevList, file];\n    });\n\n    if (canUpload) {\n      await uploadFileWithProgress(file);\n    }\n  };\n\n  const deleteFile = (uid?: string) => {\n    const index = fileList.findIndex(item => uid === item.uid);\n\n    if (index !== -1 && uid) {\n      setFileList(prevList => {\n        const newList = [...prevList];\n        newList.splice(index, 1);\n        return newList;\n      });\n    }\n  };\n\n  return {\n    fileList,\n    upload,\n    isUploading,\n    deleteFile,\n    setFileList: _fileList => setFileList(_fileList),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Format file size\n * @param bytes file size\n * @Param decimals, default 2 digits\n * @example\n * formatBytes(1024);       // 1KB\n * formatBytes('1024');     // 1KB\n * formatBytes(1234);       // 1.21KB\n * formatBytes(1234, 3);    // 1.205KB\n */\nexport function formatBytes(bytes: number, decimals = 2) {\n  if (bytes === 0) {\n    return '0 Bytes';\n  }\n  const k = 1024,\n    dm = decimals,\n    sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],\n    i = Math.floor(Math.log(bytes) / Math.log(k));\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))}${sizes[i]}`;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\n\nexport const ACCEPT_MAP = {\n  // [ViewVariableType.File]: ['*'],\n\n  [ViewVariableType.Image]: ['image/*'],\n\n  [ViewVariableType.Doc]: ['.docx', '.doc', '.pdf'],\n\n  [ViewVariableType.Audio]: [\n    '.mp3',\n    '.wav',\n    '.aac',\n    '.flac',\n    '.ogg',\n    '.wma',\n    '.alac',\n    '.mid',\n    '.midi',\n    '.ac3',\n    '.dsd',\n  ],\n\n  [ViewVariableType.Excel]: ['.xls', '.xlsx', '.csv'],\n\n  [ViewVariableType.Video]: ['.mp4', '.avi', '.mov', '.wmv', '.flv', '.mkv'],\n\n  [ViewVariableType.Zip]: ['.zip', '.rar', '.7z', '.tar', '.gz', '.bz2'],\n\n  [ViewVariableType.Code]: ['.py', '.java', '.c', '.cpp', '.js', '.css'],\n\n  [ViewVariableType.Txt]: ['.txt'],\n\n  [ViewVariableType.Ppt]: ['.ppt', '.pptx'],\n\n  [ViewVariableType.Svg]: ['.svg'],\n};\n\nexport const getAccept = (\n  inputType: ViewVariableType,\n  availableFileTypes?: ViewVariableType[],\n) => {\n  let accept: string;\n  const itemType = ViewVariableType.isArrayType(inputType)\n    ? ViewVariableType.getArraySubType(inputType)\n    : inputType;\n\n  if (itemType === ViewVariableType.File) {\n    if (availableFileTypes?.length) {\n      accept = availableFileTypes\n        .map(type => ACCEPT_MAP[type]?.join(','))\n        .join(',');\n    } else {\n      accept = Object.values(ACCEPT_MAP)\n        .map(items => items.join(','))\n        .join(',');\n    }\n  } else {\n    accept = (ACCEPT_MAP[itemType] || []).join(',');\n  }\n\n  return accept;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** Get filename suffix */\nexport function getFileExtension(name?: string) {\n  if (!name) {\n    return '';\n  }\n  const index = name.lastIndexOf('.');\n  return name.slice(index + 1).toLowerCase();\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { formatBytes } from '../utils/format-bytes';\n\nconst DEFAULT_MAX_SIZE = 1024 * 1024 * 20;\n\n/** file size verification  */\nexport const sizeValidate = (\n  size: number,\n  maxSize: number = DEFAULT_MAX_SIZE,\n): string | undefined => {\n  if (maxSize && size > maxSize) {\n    return I18n.t('imageflow_upload_exceed', {\n      size: formatBytes(maxSize),\n    });\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FileItem } from '../types';\n\n/**\n * Get the width and height of the image\n */\nexport async function getImageSize(\n  file: FileItem,\n): Promise<{ width: number; height: number }> {\n  const url = URL.createObjectURL(file);\n\n  return new Promise((resolve, reject) => {\n    const img = new window.Image();\n    img.onload = () => {\n      resolve({\n        width: img.naturalWidth,\n        height: img.naturalHeight,\n      });\n    };\n    img.onerror = e => {\n      reject(e);\n    };\n    img.src = url;\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNil } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { getImageSize } from '../utils/get-image-size';\nimport { type FileItem } from '../types';\n\nexport interface ImageSizeRule {\n  maxWidth?: number;\n  minWidth?: number;\n  maxHeight?: number;\n  minHeight?: number;\n  aspectRatio?: number;\n}\n\n/** image width check  */\n// eslint-disable-next-line complexity\nexport const imageSizeValidate = async (\n  file: FileItem,\n  rule?: ImageSizeRule,\n): Promise<string | undefined> => {\n  const { maxWidth, minWidth, maxHeight, minHeight, aspectRatio } = rule || {};\n\n  // No validation when undefined\n  if (isNil(maxWidth || minWidth || maxHeight || minHeight || aspectRatio)) {\n    return;\n  }\n\n  const { width, height } = await getImageSize(file);\n\n  if (maxWidth && width > maxWidth) {\n    return I18n.t('imageflow_upload_error5', {\n      value: `${maxWidth}px`,\n    });\n  }\n\n  if (minWidth && width < minWidth) {\n    return I18n.t('imageflow_upload_error3', {\n      value: `${minWidth}px`,\n    });\n  }\n\n  if (maxHeight && height > maxHeight) {\n    return I18n.t('imageflow_upload_error4', {\n      value: `${maxHeight}px`,\n    });\n  }\n\n  if (minHeight && height < minHeight) {\n    return I18n.t('imageflow_upload_error2', {\n      value: `${minHeight}px`,\n    });\n  }\n  if (aspectRatio && width / height > aspectRatio) {\n    return I18n.t('imageflow_upload_error1');\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport mime from 'mime-types';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { getFileExtension } from '../utils';\n\nexport const acceptValidate = (fileName: string, accept?: string) => {\n  if (!accept) {\n    return;\n  }\n  const acceptList = accept.split(',');\n\n  const fileExtension = getFileExtension(fileName);\n  const mimeType = mime.lookup(fileExtension);\n\n  // Image/* matches all image types\n  if (acceptList.includes('image/*') && mimeType?.startsWith?.('image/')) {\n    return undefined;\n  }\n\n  if (!acceptList.includes(`.${fileExtension}`)) {\n    return I18n.t('imageflow_upload_error_type', {\n      type: `${acceptList.filter(Boolean).join('/')}`,\n    });\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FileItem } from '../types';\nimport { sizeValidate } from './size-validate';\nimport { imageSizeValidate, type ImageSizeRule } from './image-size-validate';\nimport { acceptValidate } from './accept-validate';\n\ninterface UploadValidateRule {\n  maxSize?: number;\n  imageSize?: ImageSizeRule;\n  accept?: string;\n  customValidate?: (file: FileItem) => Promise<string | undefined>;\n}\n\nexport const validate = async (file: FileItem, rules?: UploadValidateRule) => {\n  const { size, name } = file;\n\n  const { maxSize, imageSize, accept, customValidate } = rules || {};\n\n  const validators = [\n    async () => await customValidate?.(file),\n    () => sizeValidate(size, maxSize),\n    async () => await imageSizeValidate(file, imageSize),\n    () => acceptValidate(name, accept),\n  ];\n\n  for await (const validator of validators) {\n    const errorMsg = await validator();\n    if (errorMsg) {\n      return errorMsg;\n    }\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect } from 'react';\n\nimport { debounce } from 'lodash-es';\nimport { useMemoizedFn } from 'ahooks';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { DisposableCollection } from '@flowgram-adapter/common';\nimport { GlobalVariableService } from '@coze-workflow/variable';\nimport { useValidationService } from '@coze-workflow/base/services';\n\nimport { useLineService, useGlobalState } from '@/hooks';\n\nexport const useValidateWorkflow = () => {\n  const lineService = useLineService();\n  const validationService = useValidationService();\n  const globalState = useGlobalState();\n\n  const feValidate = useCallback(async () => {\n    const { hasError, nodeErrorMap: feErrorMap } =\n      await validationService.validateWorkflow();\n    if (hasError && feErrorMap) {\n      validationService.setErrorsV2({\n        [globalState.workflowId]: {\n          workflowId: globalState.workflowId,\n          errors: feErrorMap,\n        },\n      });\n    }\n    return hasError;\n  }, [validationService, globalState]);\n\n  const beValidate = useCallback(async () => {\n    const { hasError, errors } = await validationService.validateSchemaV2();\n    if (hasError) {\n      validationService.setErrorsV2(errors);\n    }\n\n    return hasError;\n  }, [validationService]);\n\n  const validate = useCallback(async () => {\n    validationService.validating = true;\n    try {\n      const feHasError = await feValidate();\n      if (feHasError) {\n        return feHasError;\n      }\n      const beHasError = await beValidate();\n      if (!feHasError && !beHasError) {\n        validationService.clearErrors();\n      }\n      lineService.validateAllLine();\n      return beHasError;\n    } finally {\n      validationService.validating = false;\n    }\n  }, [feValidate, beValidate, validationService, lineService]);\n\n  return { validate };\n};\n\n/**\n * trigger frequency of validation\n */\nconst DEBOUNCE_TIME = 2000;\n\nexport const useWatchValidateWorkflow = () => {\n  const { isInIDE } = useGlobalState();\n\n  const { validate } = useValidateWorkflow();\n  const workflowDocument = useService<WorkflowDocument>(WorkflowDocument);\n\n  const debounceValidate = useMemoizedFn(debounce(validate, DEBOUNCE_TIME));\n\n  const globalVariableService = useService<GlobalVariableService>(\n    GlobalVariableService,\n  );\n\n  useEffect(() => {\n    const globalVariableDispose = new DisposableCollection();\n\n    globalVariableDispose.push(\n      globalVariableService.onLoaded(() => {\n        if (!isInIDE) {\n          debounceValidate();\n        }\n      }),\n    );\n\n    const contentChangeDispose = workflowDocument.onContentChange(() => {\n      debounceValidate();\n    });\n\n    return () => {\n      contentChangeDispose.dispose();\n      globalVariableDispose.dispose();\n    };\n  }, [workflowDocument, isInIDE]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowOperationService } from '../services';\n\nexport const useWorkflowOperation = () => {\n  const operation = useService<WorkflowOperationService>(\n    WorkflowOperationService,\n  );\n\n  return operation;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Gets which other workflows or bots are referenced by the current workflow\n * At present, bots has no data, only workflow.\n */\nimport {\n  useQuery,\n  type RefetchOptions,\n  type QueryObserverResult,\n} from '@tanstack/react-query';\nimport { type Workflow } from '@coze-workflow/base/api';\n\nimport { useWorkflowOperation } from './use-workflow-operation';\nimport { useGlobalState } from './use-global-state';\n\ninterface WorkflowReferences {\n  workflowList: Workflow[];\n}\n\nexport const useWorkflowReferences = (): {\n  references: WorkflowReferences | undefined;\n  refetchReferences: (options?: RefetchOptions | undefined) => Promise<\n    QueryObserverResult<\n      {\n        workflowList: Workflow[];\n      },\n      Error\n    >\n  >;\n} => {\n  const { spaceId, workflowId } = useGlobalState();\n\n  const operation = useWorkflowOperation();\n\n  const getWorkflowReferences = async () => {\n    const workflowList = await operation.getReference();\n\n    return { workflowList };\n  };\n\n  const { data, refetch } = useQuery({\n    queryKey: ['workflow_references', spaceId, workflowId],\n    queryFn: getWorkflowReferences,\n  });\n\n  return {\n    references: data,\n    refetchReferences: refetch,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Add the display hidden state of the node panel on the left, which needs to be consumed elsewhere, so it is abstracted into a global state.\n */\n\nimport { create } from 'zustand';\n\ninterface AddNodeVisibleStore {\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n}\n\nexport const useAddNodeVisibleStore = create<AddNodeVisibleStore>(set => ({\n  visible: true,\n  setVisible: visible => set({ visible }),\n}));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\n/* eslint-disable @typescript-eslint/no-shadow */\n\nexport const BatchSize = {\n  width: 360,\n  height: 139.86,\n};\n\nexport const BatchFunctionSize = {\n  width: BatchSize.width,\n  height: (BatchSize.width * 3) / 5,\n};\n\nexport const BatchOutputsSuffix = '_list';\n\nexport enum BatchPath {\n  ConcurrentSize = 'inputs.concurrentSize',\n  BatchSize = 'inputs.batchSize',\n  Inputs = 'inputs.inputParameters',\n  Outputs = 'outputs',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { I18n } from '@coze-arch/i18n';\nimport { getBatchInputNames } from './get-batch-input-names';\n\nexport const BatchInputNameValidator = createNodeInputNameValidate({\n  getNames: getBatchInputNames,\n  invalidValues: {\n    index: I18n.t('workflow_loop_name_no_index_wrong'),\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { BatchPath } from '../../constants';\n\nexport const getBatchInputNames = ({ value, formValues }): string[] => {\n  const batchInputs: InputValueVO[] = get(formValues, BatchPath.Inputs) ?? [];\n  return batchInputs.map(input => input.name).filter(Boolean) as string[];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { getBatchOutputNames } from './get-batch-output-names';\n\nexport const BatchOutputNameValidator = createNodeInputNameValidate({\n  getNames: getBatchOutputNames,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { BatchPath } from '../../constants';\n\nexport const getBatchOutputNames = ({ value, formValues }): string[] => {\n  const batchOutputs: InputValueVO[] = get(formValues, BatchPath.Outputs) ?? [];\n  return batchOutputs.map(input => input.name).filter(Boolean) as string[];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\n\nexport const BatchInputValueValidator = createValueExpressionInputValidate({\n  required: true,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useNodeTestId,\n  type ValueExpression,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInput } from '@/form-extensions/components/value-expression-input';\nimport { FormItem } from '@/form-extensions/components/form-item';\nimport { useField, withField } from '@/form';\n\ninterface BatchConcurrentSizeFieldProps {\n  title?: string;\n  tooltip?: string;\n  testId?: string;\n}\n\nexport const BatchConcurrentSizeField = withField<\n  BatchConcurrentSizeFieldProps,\n  ValueExpression\n>(\n  ({\n    title = I18n.t('workflow_maximum_parallel_runs'),\n    tooltip = I18n.t('workflow_maximum_parallel_runs_tips'),\n    testId,\n  }) => {\n    const { name, value, onChange, readonly } = useField<ValueExpression>();\n    const { getNodeSetterId } = useNodeTestId();\n\n    return (\n      <FormItem\n        label={title}\n        tooltip={tooltip}\n        layout=\"vertical\"\n        style={{\n          marginTop: 12,\n        }}\n        labelStyle={{\n          fontSize: 12,\n          fontWeight: 600,\n          color: 'var(--coz-fg-secondary, rgba(6, 7, 9, 0.50))',\n        }}\n      >\n        <ValueExpressionInput\n          value={value}\n          onChange={onChange}\n          testId={testId ?? getNodeSetterId(name)}\n          disabledTypes={ViewVariableType.getComplement([\n            ViewVariableType.Integer,\n          ])}\n          readonly={readonly}\n          inputType={ViewVariableType.Integer}\n          literalConfig={{\n            min: 1,\n            max: 10,\n          }}\n          literalStyle={{\n            width: '100%',\n          }}\n        />\n      </FormItem>\n    );\n  },\n  {\n    defaultValue: { type: ValueExpressionType.LITERAL, content: 10 },\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { type FC } from 'react';\n\nimport { type InputValueVO, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { InputsField } from '@/node-registries/common/fields';\n\nimport { BatchPath } from '../../constants';\n\ninterface BatchInputsFieldProps {\n  name?: string;\n}\n\nexport const BatchInputsField: FC<BatchInputsFieldProps> = ({ name }) => (\n  <InputsField\n    name={name ?? BatchPath.Inputs}\n    title={I18n.t('workflow_batch_inputs')}\n    tooltip={I18n.t('workflow_batch_inputs_tooltips')}\n    defaultValue={[{ name: 'input' } as InputValueVO]}\n    nthCannotDeleted={1}\n    inputProps={{\n      hideDeleteIcon: true,\n      disabledTypes: ViewVariableType.getComplement(\n        ViewVariableType.getAllArrayType(),\n      ),\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { type FC } from 'react';\n\nimport { type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { LoopOutputsField } from '@/node-registries/common/fields';\n\nimport { BatchOutputsSuffix, BatchPath } from '../../constants';\n\ninterface BatchOutputsFieldProps {\n  name?: string;\n  title?: string;\n  tooltip?: string;\n}\n\nexport const BatchOutputsField: FC<BatchOutputsFieldProps> = ({\n  name = BatchPath.Outputs,\n  title = I18n.t('workflow_batch_outputs'),\n  tooltip = I18n.t('workflow_batch_outputs_tooltips'),\n}) => (\n  <LoopOutputsField\n    name={name}\n    title={title}\n    tooltip={tooltip}\n    defaultValue={[{ name: 'output' } as InputValueVO]}\n    nameProps={{\n      initValidate: true,\n      suffix: BatchOutputsSuffix,\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useNodeTestId,\n  type ValueExpression,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInput } from '@/form-extensions/components/value-expression-input';\nimport { FormItem } from '@/form-extensions/components/form-item';\nimport { useField, withField } from '@/form';\n\ninterface BatchSizeFieldProps {\n  title?: string;\n  tooltip?: string;\n  testId?: string;\n}\n\nexport const BatchSizeField = withField<BatchSizeFieldProps, ValueExpression>(\n  ({\n    title = I18n.t('workflow_maximum_run_count'),\n    tooltip = I18n.t('workflow_maximum_run_count_tips'),\n    testId,\n  }) => {\n    const { name, value, onChange, readonly } = useField<ValueExpression>();\n    const { getNodeSetterId } = useNodeTestId();\n\n    return (\n      <FormItem\n        label={title}\n        tooltip={tooltip}\n        layout=\"vertical\"\n        style={{\n          marginTop: 12,\n        }}\n        labelStyle={{\n          fontSize: 12,\n          fontWeight: 600,\n          color: 'var(--coz-fg-secondary, rgba(6, 7, 9, 0.50))',\n        }}\n      >\n        <ValueExpressionInput\n          value={value}\n          onChange={onChange}\n          testId={testId ?? getNodeSetterId(name)}\n          disabledTypes={ViewVariableType.getComplement([\n            ViewVariableType.Integer,\n          ])}\n          readonly={readonly}\n          inputType={ViewVariableType.Integer}\n          literalConfig={{\n            min: 1,\n            max: 200,\n          }}\n          literalStyle={{\n            width: '100%',\n          }}\n        />\n      </FormItem>\n    );\n  },\n  {\n    defaultValue: { type: ValueExpressionType.LITERAL, content: 100 },\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { FC, ReactNode } from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section } from '@/form';\n\ninterface BatchSettingsFieldProps {\n  title?: string;\n  tooltip?: string;\n  testId?: string;\n  children?: ReactNode | ReactNode[];\n}\n\nexport const BatchSettingsSection: FC<BatchSettingsFieldProps> = ({\n  title = I18n.t('workflow_loop_title'),\n  tooltip,\n  testId,\n  children,\n}) => {\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <Section\n      title={title}\n      tooltip={tooltip}\n      testId={getNodeSetterId(testId ?? '')}\n    >\n      {children}\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PrivateScopeProvider } from '@coze-workflow/variable';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport {\n  BatchConcurrentSizeField,\n  BatchInputsField,\n  BatchOutputsField,\n  BatchSettingsSection,\n  BatchSizeField,\n} from './fields';\nimport { BatchPath } from './constants';\n\nexport const BatchFormRender = () => (\n  <NodeConfigForm>\n    <PrivateScopeProvider>\n      <BatchSettingsSection>\n        <BatchConcurrentSizeField name={BatchPath.ConcurrentSize} />\n        <BatchSizeField name={BatchPath.BatchSize} />\n      </BatchSettingsSection>\n      <BatchInputsField name={BatchPath.Inputs} />\n    </PrivateScopeProvider>\n    <BatchOutputsField name={BatchPath.Outputs} />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  fireNodeTitleChange,\n  provideLoopInputsVariablesEffect,\n  provideLoopOutputsVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport {\n  BatchInputNameValidator,\n  BatchInputValueValidator,\n  BatchOutputNameValidator,\n} from './validators';\nimport { type FormData } from './types';\nimport { BatchFormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { BatchPath } from './constants';\n\nexport const BATCH_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <BatchFormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    [`${BatchPath.Inputs}.*.name`]: BatchInputNameValidator,\n    [`${BatchPath.Inputs}.*.input`]: BatchInputValueValidator,\n    [`${BatchPath.Outputs}.*.name`]: BatchOutputNameValidator,\n    [`${BatchPath.Outputs}.*.input`]: BatchInputValueValidator,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    inputs: provideLoopInputsVariablesEffect,\n    outputs: provideLoopOutputsVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { set } from 'lodash-es';\nimport { variableUtils } from '@coze-workflow/variable';\nimport { type NodeDataDTO } from '@coze-workflow/base';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (formData: any, ctx: any) => {\n  const inputParameters = formData?.inputs?.inputParameters;\n  const outputValues = formData?.outputs;\n  const concurrentSize = formData?.inputs?.concurrentSize;\n  const batchSize = formData?.inputs?.batchSize;\n\n  if (!Array.isArray(inputParameters) || inputParameters?.length === 0) {\n    set(formData, 'inputs.inputParameters', [{ name: 'input' }]);\n  }\n\n  if (outputValues && Array.isArray(outputValues)) {\n    outputValues.map((outputValue, index) => {\n      set(\n        outputValues,\n        index,\n        variableUtils.inputValueToVO(\n          outputValue,\n          ctx.playgroundContext.variableService,\n        ),\n      );\n    });\n  }\n\n  if (concurrentSize) {\n    set(\n      formData,\n      'inputs.concurrentSize',\n      variableUtils.valueExpressionToVO(\n        concurrentSize,\n        ctx.playgroundContext.variableService,\n      ),\n    );\n  }\n\n  if (batchSize) {\n    set(\n      formData,\n      'inputs.batchSize',\n      variableUtils.valueExpressionToVO(\n        batchSize,\n        ctx.playgroundContext.variableService,\n      ),\n    );\n  }\n\n  return formData;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (formData: any, ctx: any): NodeDataDTO => {\n  const outputValues = formData?.outputs;\n  const concurrentSize = formData?.inputs?.concurrentSize;\n  const batchSize = formData?.inputs?.batchSize;\n\n  if (outputValues && Array.isArray(outputValues)) {\n    outputValues.map((outputValue, index) => {\n      const dto = variableUtils.inputValueToDTO(\n        outputValue,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      );\n\n      // Custom logic: If a variable inside the loop is selected, a list of the type of the output variable is set\n      if (\n        outputValue?.input?.content?.keyPath?.[0] !== ctx.node.id &&\n        dto?.input\n      ) {\n        set(dto, 'input.schema', {\n          type: dto.input?.type,\n          schema: dto.input?.schema,\n        });\n        set(dto, 'input.type', 'list');\n      }\n\n      set(outputValues, index, dto);\n    });\n    set(formData, 'outputs', outputValues.filter(Boolean));\n  }\n\n  if (concurrentSize) {\n    set(\n      formData,\n      'inputs.concurrentSize',\n      variableUtils.valueExpressionToDTO(\n        concurrentSize,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      ),\n    );\n  }\n\n  if (batchSize) {\n    set(\n      formData,\n      'inputs.batchSize',\n      variableUtils.valueExpressionToDTO(\n        batchSize,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      ),\n    );\n  }\n\n  return formData;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nexport const BatchFunctionIDPrefix = 'BatchFunction_';\nexport const getBatchFunctionID = (batchID: string) =>\n  BatchFunctionIDPrefix + batchID;\nexport const getBatchID = (batchFunctionID: string) =>\n  batchFunctionID.replace(BatchFunctionIDPrefix, '');\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  WorkflowNodeEntity,\n  WorkflowSubCanvas,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  FlowNodeBaseType,\n  FlowNodeTransformData,\n} from '@flowgram-adapter/free-layout-editor';\nimport { FlowRendererKey } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type IPoint,\n  type PaddingSchema,\n  type PositionSchema,\n} from '@flowgram-adapter/common';\nimport type { WorkflowNodeJSON } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { BatchFunctionSize } from '../constants';\nimport { getBatchID } from './relation';\n\nexport const createBatchFunctionJSON = (\n  id: string,\n  position: IPoint,\n): WorkflowNodeJSON => ({\n  id,\n  type: FlowNodeBaseType.SUB_CANVAS,\n  data: {},\n  meta: {\n    isContainer: true,\n    position,\n    nodeDTOType: FlowNodeBaseType.SUB_CANVAS,\n    useDynamicPort: true,\n    renderKey: FlowRendererKey.SUB_CANVAS,\n    size: {\n      width: BatchFunctionSize.width,\n      height: BatchFunctionSize.height,\n    },\n    defaultPorts: [\n      { type: 'input', portID: 'batch-function-input', disabled: true },\n      { type: 'input', portID: 'batch-function-inline-input' },\n      { type: 'output', portID: 'batch-function-inline-output' },\n    ],\n    padding: (transform: FlowNodeTransformData): PaddingSchema => ({\n      top: 100,\n      bottom: 60,\n      left: 100,\n      right: 100,\n    }),\n    selectable(node: WorkflowNodeEntity, mousePos?: PositionSchema): boolean {\n      if (!mousePos) {\n        return true;\n      }\n      const transform = node.getData<FlowNodeTransformData>(\n        FlowNodeTransformData,\n      );\n      // The mouse can only be selected when the starting position does not include the current node\n      return !transform.bounds.contains(mousePos.x, mousePos.y);\n    },\n    renderSubCanvas: () => ({\n      title: I18n.t('workflow_batch_canvas_title'),\n      tooltip: I18n.t('workflow_batch_canvas_tooltips'),\n      style: {\n        minWidth: BatchFunctionSize.width,\n        minHeight: BatchFunctionSize.height,\n      },\n      renderPorts: [\n        {\n          id: 'batch-function-input',\n          type: 'input',\n          style: {\n            position: 'absolute',\n            left: '50%',\n            top: '0',\n          },\n        },\n        {\n          id: 'batch-function-inline-input',\n          type: 'input',\n          style: {\n            position: 'absolute',\n            right: '0',\n            top: '50%',\n            transform: 'translateY(20px)',\n          },\n        },\n        {\n          id: 'batch-function-inline-output',\n          type: 'output',\n          style: {\n            position: 'absolute',\n            left: '0',\n            top: '50%',\n            transform: 'translateY(20px)',\n          },\n        },\n      ],\n    }),\n    subCanvas: (node: WorkflowNodeEntity): WorkflowSubCanvas | undefined => {\n      const canvasNode = node;\n      const parentNodeID = getBatchID(canvasNode.id);\n      const parentNode = node.document.getNode(parentNodeID);\n      if (!parentNode) {\n        return undefined;\n      }\n      const subCanvas: WorkflowSubCanvas = {\n        isCanvas: true,\n        parentNode,\n        canvasNode,\n      };\n      return subCanvas;\n    },\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { delay } from '@flowgram-adapter/common';\n\n/** connect generation */\nexport const createBatchFunctionLines = async (params: {\n  document: WorkflowDocument;\n  batchId: string;\n  batchFunctionId: string;\n}) => {\n  await delay(30); // Wait for the node to be created\n  const { document, batchId, batchFunctionId } = params;\n  document.linesManager.createLine({\n    from: batchId,\n    to: batchFunctionId,\n    fromPort: 'batch-output-to-function',\n    toPort: 'batch-function-input',\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type NodeData, WorkflowNodeData } from '@coze-workflow/nodes';\nimport type { BasicStandardNodeTypes } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\n/** Synchronize node template data */\nexport const createBatchFunctionTemplateData = (\n  batchNode: WorkflowNodeEntity,\n  batchFunctionNode: WorkflowNodeEntity,\n) => {\n  const batchNodeDataEntity =\n    batchNode.getData<WorkflowNodeData>(WorkflowNodeData);\n  const batchFunctionNodeDataEntity =\n    batchFunctionNode.getData<WorkflowNodeData>(WorkflowNodeData);\n  const batchNodeData = batchNodeDataEntity.getNodeData<keyof NodeData>();\n  if (!batchNodeData) {\n    return;\n  }\n  batchFunctionNodeDataEntity.setNodeData<BasicStandardNodeTypes>({\n    title: I18n.t('workflow_batch_canvas_title'),\n    description: I18n.t('workflow_batch_canvas_tooltips'),\n    icon: batchNodeData.icon,\n    mainColor: batchNodeData.mainColor,\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  WorkflowDocument,\n  WorkflowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type IPoint } from '@flowgram-adapter/common';\nimport type { WorkflowNodeJSON } from '@coze-workflow/base';\n\nimport { BatchFunctionIDPrefix } from './relation';\nimport { createBatchFunctionTemplateData } from './create-batch-function-template-data';\nimport { createBatchFunctionLines } from './create-batch-function-lines';\nimport { createBatchFunctionJSON } from './create-batch-function-json';\n\n/** Create Batch loop body node */\nexport const createBatchFunction = async (\n  batchNode: WorkflowNodeEntity,\n  batchJson: WorkflowNodeJSON,\n) => {\n  const document = batchNode.document as WorkflowDocument;\n  const id = `${BatchFunctionIDPrefix}${batchNode.id}`;\n  const batchPosition: IPoint = {\n    x: batchJson.meta?.position?.x || 0,\n    y: batchJson.meta?.position?.y || 0,\n  };\n  const offset: IPoint = {\n    x: 0,\n    y: 200,\n  };\n  const position = {\n    x: batchPosition.x + offset.x,\n    y: batchPosition.y + offset.y,\n  };\n  const batchFunctionJSON = createBatchFunctionJSON(id, position);\n  const batchFunctionNode = await document.createWorkflowNode(\n    batchFunctionJSON,\n  );\n  createBatchFunctionTemplateData(batchNode, batchFunctionNode);\n  createBatchFunctionLines({\n    document,\n    batchId: batchNode.id,\n    batchFunctionId: batchFunctionNode.id,\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  WorkflowNodeEntity,\n  WorkflowSubCanvas,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeJSON,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { BATCH_FORM_META } from './form-meta';\nimport { BatchPath, BatchSize } from './constants';\nimport { createBatchFunction, getBatchFunctionID } from './batch-function';\n\nexport const BATCH_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Batch,\n  meta: {\n    nodeDTOType: StandardNodeType.Batch,\n    style: {\n      width: BatchSize.width,\n    },\n    size: BatchSize,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: BatchPath.Inputs, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    useDynamicPort: true,\n    defaultPorts: [\n      { type: 'input' },\n      { type: 'output', portID: 'batch-output' },\n      { type: 'output', portID: 'batch-output-to-function', disabled: true },\n    ],\n    subCanvas: (node: WorkflowNodeEntity): WorkflowSubCanvas | undefined => {\n      const parentNode = node;\n      const canvasNodeID = getBatchFunctionID(parentNode.id);\n      const canvasNode = node.document.getNode(canvasNodeID);\n      if (!canvasNode) {\n        return undefined;\n      }\n      const subCanvas: WorkflowSubCanvas = {\n        isCanvas: false,\n        parentNode,\n        canvasNode,\n      };\n      return subCanvas;\n    },\n    test,\n    helpLink: '/open/docs/guides/batch_node',\n  },\n  variablesMeta: {\n    outputsPathList: [],\n    inputsPathList: [\n      BatchPath.Inputs,\n      // 'Outputs',//WARNING: Adding outputs will cause this data to be cleared\n    ],\n  },\n  formMeta: BATCH_FORM_META,\n  onCreate(node, json) {\n    createBatchFunction(node, json as unknown as WorkflowNodeJSON);\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  getRelatedInfo,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  async generateRelatedContext(_, context) {\n    const { isInProject, workflowId, spaceId } = context;\n    if (isInProject) {\n      return {};\n    }\n    const related = await getRelatedInfo({ workflowId, spaceId });\n    return generateEnvToRelatedContextProperties(related);\n  },\n  generateFormSettingProperties(node) {\n    const { formModel } = node.getData(FlowNodeFormData);\n    const data = formModel.getFormItemValueByPath('/inputs');\n    return generateParametersToProperties(\n      [\n        {\n          name: 'concurrentSize',\n          title: I18n.t('workflow_maximum_parallel_runs'),\n          input: data.concurrentSize,\n        },\n        {\n          name: 'batchSize',\n          title: I18n.t('workflow_maximum_run_count'),\n          input: data.batchSize,\n        },\n      ],\n      { node },\n    );\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputs?.inputParameters;\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Port } from '@/components/node-render/node-render-new/fields/port';\n\nexport const BatchPort = () => (\n  <>\n    <Port\n      id={'batch-output-to-function'}\n      type=\"output\"\n      style={{\n        position: 'absolute',\n        width: 20,\n        height: 20,\n        right: 'unset',\n        top: 'unset',\n        bottom: 0,\n        left: '50%',\n        transform: 'translate(-50%, 50%)',\n      }}\n    />\n    <Port\n      id={'batch-output'}\n      type=\"output\"\n      style={{\n        position: 'absolute',\n        right: '0',\n      }}\n    />\n  </>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PrivateScopeProvider } from '@coze-workflow/variable';\n\nimport {\n  InputParameters,\n  Outputs,\n} from '@/components/node-render/node-render-new/fields';\n\nimport { BatchPort } from './batch-content';\n\nexport const BatchContent = () => (\n  <PrivateScopeProvider>\n    <InputParameters />\n    <Outputs />\n    <BatchPort />\n  </PrivateScopeProvider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nexport const FormRender = () => <NodeConfigForm />;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { fireNodeTitleChange } from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const BREAK_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeDataDTO } from '@coze-workflow/base';\n\nimport { type FormData } from './types';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (value: NodeDataDTO) => value;\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData): NodeDataDTO =>\n  value as unknown as NodeDataDTO;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DEFAULT_NODE_META_PATH } from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { BREAK_FORM_META } from './form-meta';\n\nexport const BREAK_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.Break,\n  meta: {\n    isNodeEnd: true,\n    hideTest: true,\n    nodeDTOType: StandardNodeType.Break,\n    defaultPorts: [{ type: 'input' }],\n    size: { width: 360, height: 67.86 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n  },\n  formMeta: BREAK_FORM_META,\n  getOutputPoints: () => [], // Broken node has no output\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function BreakContent() {\n  return <></>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\n// path\nexport const INPUT_PATH = 'inputParameters';\nexport const CODE_PATH = 'codeParams';\nexport const OUTPUT_PATH = 'outputs';\n\n// default value\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'key0',\n    type: ViewVariableType.String,\n  },\n  {\n    key: nanoid(),\n    name: 'key1',\n    type: ViewVariableType.ArrayString,\n  },\n  {\n    key: nanoid(),\n    name: 'key2',\n    type: ViewVariableType.Object,\n    children: [\n      {\n        key: nanoid(),\n        name: 'key21',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n\nexport const DEFAULT_INPUTS = [{ name: 'input' }];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO, type OutputValueVO } from '@coze-workflow/base';\nimport { ConfigProvider } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type CodeEditorValue } from '@/form-extensions/setters/code/types';\nimport { type InputParams } from '@/form-extensions/setters/code/hooks/use-ide-input-output-type';\nimport { CodeSetterContext } from '@/form-extensions/setters/code/context';\nimport { CodeEditorWithBizIDE } from '@/form-extensions/setters/code/code-with-biz-ide';\nimport { useField, withField } from '@/form';\n\nexport const CodeField = withField(\n  ({\n    tooltip,\n    outputParams,\n    inputParams,\n  }: {\n    tooltip?: string;\n    outputParams?: OutputValueVO[];\n    inputParams?: InputValueVO[];\n  }) => {\n    const { value, onChange, errors } = useField<CodeEditorValue>();\n    const readonly = useReadonly();\n\n    const feedbackText = errors?.[0]?.message || '';\n    const feedbackStatus = feedbackText ? 'error' : undefined;\n    const flowNodeEntity = useCurrentEntity();\n\n    return (\n      <ConfigProvider getPopupContainer={() => document.body}>\n        <CodeSetterContext.Provider\n          value={{\n            readonly,\n            flowNodeEntity,\n          }}\n        >\n          <CodeEditorWithBizIDE\n            feedbackStatus={feedbackStatus}\n            feedbackText={feedbackText}\n            inputParams={inputParams as InputParams}\n            onChange={onChange}\n            outputParams={outputParams}\n            outputPath={'/outputs'}\n            tooltip={tooltip}\n            value={value}\n          />\n        </CodeSetterContext.Provider>\n      </ConfigProvider>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { useForm } from '@flowgram-adapter/free-layout-editor';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport { OutputsField, InputsParametersField } from '../common/fields';\nimport { CODE_PATH, INPUT_PATH, OUTPUT_PATH } from './constants';\nimport { CodeField } from './components';\n\nexport const FormRender = () => {\n  const form = useForm();\n  return (\n    <NodeConfigForm>\n      <InputsParametersField\n        name={INPUT_PATH}\n        tooltip={I18n.t('workflow_detail_code_input_tooltip')}\n        isTree={true}\n      />\n\n      <CodeField\n        name={CODE_PATH}\n        tooltip={I18n.t('workflow_detail_code_code_tooltip')}\n        inputParams={form.getValueIn(INPUT_PATH)}\n        outputParams={form.getValueIn(OUTPUT_PATH)}\n        hasFeedback={false}\n      />\n\n      <OutputsField\n        title={I18n.t('workflow_detail_node_output')}\n        tooltip={I18n.t('workflow_detail_code_output_tooltip')}\n        jsonImport={false}\n        id=\"code-node-outputs\"\n        name={OUTPUT_PATH}\n        hasFeedback={false}\n      />\n    </NodeConfigForm>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { outputTreeMetaValidator } from '../common/fields/outputs';\nimport { createCodeInputsValidator } from './validators/create-code-inputs-validator';\nimport { codeEmptyValidator } from './validators/code-empty-validator';\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { CODE_PATH, OUTPUT_PATH } from './constants';\n\nexport const CODE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ...createCodeInputsValidator(),\n    [CODE_PATH]: codeEmptyValidator,\n    [OUTPUT_PATH]: outputTreeMetaValidator,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { createInputTreeValidator } from '../../common/validators/create-input-tree-validator';\n\nexport function createCodeInputsValidator(): { [key: string]: Validate } {\n  return {\n    inputParameters: createInputTreeValidator(),\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nexport const codeEmptyValidator: Validate = ({ value }) => {\n  const code = value?.code;\n  if (!code) {\n    return I18n.t('workflow_running_results_error_code');\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeContext } from '@flowgram-adapter/free-layout-editor';\nimport { type NodeDataDTO } from '@coze-workflow/base';\n\nimport { getDefaultValue } from '@/form-extensions/setters/code/defaults';\n\nimport { type FormData } from './types';\nimport { DEFAULT_INPUTS, DEFAULT_OUTPUTS } from './constants';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: NodeDataDTO | undefined,\n  context: NodeContext,\n) => {\n  const { globalState } = context.playgroundContext;\n  const { isBindDouyin } = globalState;\n  const defaultCodeParams = getDefaultValue({ isBindDouyin });\n  // initial value setting\n  const initValue = value || {\n    inputs: {\n      inputParameters: DEFAULT_INPUTS,\n      ...defaultCodeParams,\n    },\n    outputs: DEFAULT_OUTPUTS,\n  };\n\n  const { inputs = {}, ...others } = initValue;\n  return {\n    ...others,\n    inputParameters: inputs.inputParameters,\n    codeParams: {\n      code: inputs.code,\n      language: inputs.language,\n    },\n    nodeMeta: value?.nodeMeta,\n  };\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData) => ({\n  nodeMeta: value.nodeMeta,\n  inputs: {\n    inputParameters: value.inputParameters,\n    ...value.codeParams,\n  },\n  outputs: value.outputs,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { CODE_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const CODE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Code,\n  meta: {\n    nodeDTOType: StandardNodeType.Code,\n    size: DEFAULT_NODE_SIZE,\n    style: {\n      width: 484,\n    },\n    test,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    enableCopilotGenerateTestNodeForm: true,\n    helpLink: '/open/docs/guides/code_node',\n  },\n  formMeta: CODE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputParameters;\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputParameters, Outputs } from '../common/components';\n\nexport function CodeContent() {\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport {\n  Field,\n  type FieldRenderProps,\n  useCurrentEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNode } from '@coze-workflow/base';\n\nimport { useDefaultNodeMeta } from '@/nodes-v2/hooks/use-default-node-meta';\nimport { type NodeHeaderValue } from '@/nodes-v2/components/node-header';\nimport { NodeHeader } from '@/nodes-v2';\nimport { useGlobalState } from '@/hooks';\nimport { useWatch } from '@/form';\n\nexport function Header({\n  extraOperation,\n  nodeDisabled,\n  readonlyAllowDeleteOperation,\n}: {\n  extraOperation?: React.ReactNode;\n  nodeDisabled?: boolean;\n  readonlyAllowDeleteOperation?: boolean;\n}) {\n  const defaultNodeMeta = useDefaultNodeMeta();\n  const node = useCurrentEntity();\n  const { projectId } = useGlobalState();\n  const wrappedNode = useMemo(() => new WorkflowNode(node), [node]);\n  const triggerIsOpen = useWatch<Boolean>('trigger.isOpen');\n\n  const showTrigger = useMemo(\n    () => wrappedNode.registry?.meta?.showTrigger?.({ projectId }),\n    [projectId],\n  );\n  return (\n    <Field\n      name={'nodeMeta'}\n      deps={['outputs', 'batchMode']}\n      defaultValue={defaultNodeMeta as unknown as NodeHeaderValue}\n    >\n      {({ field, fieldState }: FieldRenderProps<NodeHeaderValue>) => (\n        <NodeHeader\n          {...field}\n          showErrorIgnore\n          errors={fieldState?.errors || []}\n          hideTest={wrappedNode.registry?.meta?.hideTest}\n          readonly={wrappedNode.registry?.meta?.headerReadonly}\n          showTrigger={showTrigger}\n          triggerIsOpen={triggerIsOpen}\n          extraOperation={extraOperation}\n          nodeDisabled={nodeDisabled}\n          readonlyAllowDeleteOperation={readonlyAllowDeleteOperation}\n        />\n      )}\n    </Field>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { useIsSettingOnError } from '@coze-workflow/nodes';\n\nimport { useGlobalState } from '@/hooks';\nimport { Form } from '@/form';\n\nimport { SettingOnError } from '../fields';\nimport { Header } from './header';\n\ntype NodeConfigFormProps = PropsWithChildren<{\n  extraOperation?: React.ReactNode;\n  batchModePath?: string;\n  nodeDisabled?: boolean;\n  readonlyAllowDeleteOperation?: boolean;\n}>;\n\n/**\n * NodeConfigForm component\n * Used to display node configuration forms\n * @Param children - child component for rendering form content\n */\nexport function NodeConfigForm({\n  children,\n  extraOperation,\n  batchModePath,\n  nodeDisabled,\n  readonlyAllowDeleteOperation,\n}: NodeConfigFormProps) {\n  const { readonly } = useGlobalState();\n  const isSettingOnError = useIsSettingOnError();\n\n  return (\n    <>\n      <Header\n        extraOperation={extraOperation}\n        nodeDisabled={nodeDisabled}\n        readonlyAllowDeleteOperation={readonlyAllowDeleteOperation}\n      />\n      <PublicScopeProvider>\n        <Form readonly={readonly}>\n          {children}\n          {isSettingOnError ? (\n            <SettingOnError batchModePath={batchModePath} />\n          ) : null}\n        </Form>\n      </PublicScopeProvider>\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { Tag } from '@coze-arch/coze-design';\n\nconst ViewDataTypeMap = {\n  [ViewVariableType.String]: 'String',\n  [ViewVariableType.Integer]: 'Integer',\n  [ViewVariableType.Boolean]: 'Boolean',\n  [ViewVariableType.Number]: 'Number',\n  [ViewVariableType.Time]: 'Time',\n  [ViewVariableType.File]: 'File',\n  [ViewVariableType.Image]: 'File/Image',\n  [ViewVariableType.Doc]: 'File/Doc',\n  [ViewVariableType.Excel]: 'File/Excel',\n  [ViewVariableType.Code]: 'File/Code',\n  [ViewVariableType.Ppt]: 'File/PPT',\n  [ViewVariableType.Txt]: 'File/Text',\n  [ViewVariableType.Audio]: 'File/Audio',\n  [ViewVariableType.Zip]: 'File/ZIP',\n  [ViewVariableType.Video]: 'File/Video',\n  [ViewVariableType.Svg]: 'File/SVG',\n  [ViewVariableType.Voice]: 'File/Voice',\n};\n\ninterface DataTypeTagProps {\n  type?: ViewVariableType;\n  disabled?: boolean;\n}\n\nexport function DataTypeTag({ type, disabled }: DataTypeTagProps) {\n  return (\n    <Tag color=\"primary\" size=\"mini\" disabled={disabled}>\n      {type === undefined ? 'undefined' : ViewDataTypeMap[type]}\n    </Tag>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ComponentProps } from 'react';\n\nimport { EnumImageModel } from '@coze-workflow/setters';\n\nimport { withField, useField } from '@/form';\n\ntype ImageModelSelectProps = Omit<\n  ComponentProps<typeof EnumImageModel>,\n  'value' | 'onChange'\n>;\n\n/**\n * Image model selector\n */\nexport const ImageModelSelectField = withField<ImageModelSelectProps>(props => {\n  const { value, readonly, onChange, errors } = useField<number>();\n\n  return (\n    <EnumImageModel\n      value={value}\n      readonly={readonly}\n      onChange={newValue => onChange?.(newValue as number)}\n      validateStatus={errors && errors.length > 0 ? 'error' : undefined}\n      {...props}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ExpressionEditor,\n  type ExpressionEditorProps,\n} from '@/nodes-v2/components/expression-editor';\nimport { withField, useField } from '@/form';\n\nexport const ExpressionEditorField = withField<\n  Omit<ExpressionEditorProps, 'value' | 'onChange'> & {\n    testIDSuffix?: string;\n  }\n>(props => {\n  const { name, value, onChange, errors, onFocus, onBlur } = useField<string>();\n  const {\n    placeholder,\n    minRows,\n    maxLength,\n    disableSuggestion,\n    disableCounter,\n    // The old logic used name as the testID suffix, the new version of the node name path may change (such as xxx - > inputs.xxx) need to be specified externally\n    testIDSuffix = name,\n  } = props;\n\n  return (\n    <ExpressionEditor\n      name={testIDSuffix}\n      value={value}\n      onChange={newValue => onChange(newValue as string)}\n      key={name}\n      placeholder={placeholder}\n      minRows={minRows}\n      maxLength={maxLength}\n      isError={errors && errors?.length > 0}\n      disableSuggestion={disableSuggestion}\n      disableCounter={disableCounter}\n      onFocus={onFocus}\n      onBlur={onBlur}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport classnames from 'classnames';\n\nimport { Text } from '@/form-extensions/components/text';\n\nexport const Notify: FC<{\n  text: string;\n  align?: 'left' | 'center' | 'right';\n  className?: string;\n  isBreakLine?: boolean;\n}> = ({ text, align = 'center', className = '', isBreakLine = false }) => (\n  <div\n    className={classnames(\n      'w-full !px-[8px] !py-[6px] flex flex-row items-center coz-mg-hglt-secondary text-[14px]',\n\n      {\n        'justify-center': align === 'center',\n        'justify-end': align === 'right',\n        'justify-start': align === 'left',\n      },\n      className,\n    )}\n  >\n    {isBreakLine ? text : <Text text={text} />}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Default time zone, currently used by the task module\n *\n * Domestic: UTC + 8\n * Overseas: UTC + 0\n */\nexport const DEFAULT_TIME_ZONE = IS_OVERSEA ? 'Etc/GMT+0' : 'Asia/Shanghai';\nexport const DEFAULT_TIME_ZONE_OFFSET = IS_OVERSEA ? 'UTC+00:00' : 'UTC+08:00';\n// Unknown time zone for compatibility\nexport const UNKNOWN_TIME_ZONE_OFFSET = 'Others';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { groupBy, toPairs, find, orderBy } from 'lodash-es';\nimport dayjsUTC from 'dayjs/plugin/utc';\nimport dayjsTimezone from 'dayjs/plugin/timezone';\nimport quartersOfYear from 'dayjs/plugin/quarterOfYear';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport dayjs from 'dayjs';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { type CascaderData } from '@coze-arch/bot-semi/Cascader';\n\nimport { DEFAULT_TIME_ZONE, DEFAULT_TIME_ZONE_OFFSET } from '../const';\n\n// dependent on utc plugin\ndayjs.extend(isoWeek); // Attention: The registration order of plugins here cannot be changed at will, and repeated registration of plugins may have bugs.\ndayjs.extend(quartersOfYear);\ndayjs.extend(dayjsUTC);\ndayjs.extend(dayjsTimezone);\n\nexport const dayjsForTimezone = dayjs;\n\nexport interface ITimezoneItem {\n  value: string;\n  label?: string;\n  offset: string;\n  utcOffset?: number;\n}\n\n// Get a list of time zones\nexport const generatedTimezones = () => {\n  let timezoneOptions: CascaderData[] = [];\n  let timezoneMap: ITimezoneItem[] = [];\n  try {\n    // The current international environment\n    const locale = I18n.language ?? 'en-US';\n    /**\n     * List of all time zones\n     * (Intl as any) The typescript version of the project does not contain the supportedValuesOf method, and an error will be reported when compiled\n     */\n    const options = (Intl as any)\n      .supportedValuesOf('timeZone')\n      .map((item: any) => {\n        const formatDateParts = new Intl.DateTimeFormat(locale, {\n          timeZone: item,\n          timeZoneName: 'longGeneric',\n        }).formatToParts(new Date());\n        const { value: timeZoneName } = find(formatDateParts, [\n          'type',\n          'timeZoneName',\n        ]) as Intl.DateTimeFormatPart;\n        const targetTime = dayjs().tz(item);\n        return {\n          value: item,\n          label: `${timeZoneName} - ${item}`,\n          offset: `UTC${targetTime.format('Z')}`,\n          utcOffset: targetTime.utcOffset(),\n        };\n      });\n    timezoneOptions = orderBy(\n      toPairs(groupBy(options, 'offset')),\n      item => {\n        const [offset] = item;\n        return find(options, ['offset', offset])?.utcOffset;\n      },\n      ['asc'],\n    ).map(item => {\n      const [itemKey, itemValue] = item;\n      return {\n        value: itemKey,\n        label: itemKey,\n        children: orderBy(itemValue, ['label'], ['asc']),\n      };\n    });\n    timezoneMap = options;\n  } catch (error: any) {\n    timezoneOptions = [\n      {\n        value: DEFAULT_TIME_ZONE_OFFSET,\n        label: DEFAULT_TIME_ZONE_OFFSET,\n        children: [{ value: DEFAULT_TIME_ZONE, label: DEFAULT_TIME_ZONE }],\n      },\n    ];\n    timezoneMap = [\n      { value: DEFAULT_TIME_ZONE, offset: DEFAULT_TIME_ZONE_OFFSET },\n    ];\n    // If the time zone information cannot be obtained, report the exception to slardar.\n    logger.persist.error({\n      message: 'Custom Error: Unable to obtain accurate time zone list',\n      error,\n    });\n  }\n  return { timezoneOptions, timezoneMap };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport { cloneDeep, find, noop } from 'lodash-es';\nimport classNames from 'classnames';\nimport { type LiteralExpression } from '@coze-workflow/base';\nimport { ValueExpressionType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\nimport {\n  Cascader,\n  Highlight,\n  type CascaderData,\n  type FilterRenderProps,\n} from '@coze-arch/coze-design';\n\nimport { type DynamicComponentProps } from '../dynamic-form';\nimport { generatedTimezones } from './utils/timezone';\nimport { UNKNOWN_TIME_ZONE_OFFSET } from './const';\n\nimport styles from './index.module.less';\n\ntype TimezoneProps = DynamicComponentProps<string> & {\n  className?: string;\n  showClear?: boolean; // Can it be emptied?\n  defaultValue?: string; // default value\n};\n\nexport const Timezone: FC<TimezoneProps> = ({\n  className,\n  showClear = false,\n  defaultValue,\n  value: _value,\n  onChange = noop,\n  readonly,\n}) => {\n  const value = ((_value as unknown as LiteralExpression)?.content ??\n    _value ??\n    defaultValue) as string;\n\n  // time zone list\n  const { timezoneOptions: TIME_ZONE_OPTIONS, timezoneMap: TIME_ZOME_MAP } =\n    useMemo(() => generatedTimezones(), []);\n\n  // Time zone selector option generation logic\n  const [timezoneOptions, timezoneMap] = useMemo(() => {\n    const timezoneOptionsBase = cloneDeep(TIME_ZONE_OPTIONS);\n    const timezoneMapBase = cloneDeep(TIME_ZOME_MAP);\n    // When the user has selected a time zone, but the current environment does not support compatibility with the corresponding time zone, insert the unknown time zone option Compatible at the end of the option\n    if (value && timezoneMapBase.every(e => e.value !== value)) {\n      timezoneOptionsBase.push({\n        value: UNKNOWN_TIME_ZONE_OFFSET,\n        label: UNKNOWN_TIME_ZONE_OFFSET,\n        children: [{ value, label: value }],\n      });\n      timezoneMapBase.push({\n        value,\n        offset: UNKNOWN_TIME_ZONE_OFFSET,\n      });\n    }\n    return [timezoneOptionsBase, timezoneMapBase];\n  }, []);\n\n  const timezoneValue = useMemo(() => {\n    const item = find(timezoneMap, ['value', value]);\n    if (item) {\n      return [item.offset, item.value];\n    } else {\n      return undefined;\n    }\n  }, [value, timezoneMap]);\n\n  // Traverse query time zone offset\n  const findTimezoneValue = (nodes: string[], key: string) => {\n    if (Array.isArray(nodes) && nodes.length > 1) {\n      const [offsetValue, timezoneLabel] = nodes;\n      const item = find(timezoneOptions, ['value', offsetValue]);\n      if (item && Array.isArray(item.children)) {\n        const option = find(item.children, [key, timezoneLabel]);\n        if (option && option.value) {\n          return option.value as string;\n        }\n      }\n    }\n  };\n\n  const filterSorter = (\n    first: CascaderData,\n    second: CascaderData,\n    inputValue: string,\n  ) => {\n    if (\n      Array.isArray(first) &&\n      first.length > 1 &&\n      Array.isArray(second) &&\n      second.length > 1\n    ) {\n      const keyword: string = (inputValue || '').toLowerCase();\n      const firstLabelLowerCase: string = (first[1].label || '').toLowerCase();\n      const secondLabelLowerCase: string = (\n        second[1].label || ''\n      ).toLowerCase();\n      const firstLabelArray = firstLabelLowerCase.split(' ');\n      const secondLabelArray = secondLabelLowerCase.split(' ');\n      if (firstLabelArray.findIndex(e => e === keyword) === 0) {\n        return -1;\n      }\n      if (secondLabelArray.findIndex(e => e === keyword) === 0) {\n        return 1;\n      }\n      if (firstLabelLowerCase.includes(keyword)) {\n        return -1;\n      }\n      if (secondLabelLowerCase.includes(keyword)) {\n        return 1;\n      }\n    }\n    return 0;\n  };\n\n  // custom highlighting logic\n  const filterRender = (filterRenderProps: FilterRenderProps) => {\n    const { className: cls, inputValue, data, onClick } = filterRenderProps;\n    // Put together the copy of the multi-level options\n    const labelString = data.map(e => e.label).join(' / ');\n    return (\n      <li\n        role=\"menuitem\"\n        className={classNames('semi-cascader-option-flatten', cls)}\n        onClick={onClick}\n      >\n        <span className=\"semi-cascader-option-label\">\n          <span\n            aria-hidden=\"true\"\n            className=\"semi-cascader-option-icon semi-cascader-option-icon-empty\"\n          ></span>\n          <Highlight\n            sourceString={labelString}\n            searchWords={[inputValue]}\n            highlightStyle={{\n              color: 'var(--light-usage-primary-color-primary, #4d53e8)',\n              backgroundColor: 'transparent',\n            }}\n          />\n        </span>\n      </li>\n    );\n  };\n\n  return (\n    <Cascader\n      size=\"small\"\n      className={`${className} w-full`}\n      dropdownClassName={styles.dropdown}\n      showClear={showClear}\n      filterTreeNode\n      filterSorter={filterSorter}\n      filterRender={filterRender}\n      disabled={readonly}\n      placeholder={I18n.t('task_preset_timezone')}\n      treeData={timezoneOptions}\n      value={timezoneValue}\n      onChange={nodes => {\n        const newTimezone = findTimezoneValue(nodes as string[], 'value');\n        onChange({\n          type: ValueExpressionType.LITERAL,\n          content: newTimezone,\n        });\n        if (newTimezone) {\n          sendTeaEvent(EVENT_NAMES.select_scheduled_tasks_timezone, {\n            timezone: newTimezone,\n          });\n        }\n      }}\n      displayRender={nodes => findTimezoneValue(nodes as string[], 'label')}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef, type ReactNode, useCallback } from 'react';\n\nimport { isUndefined } from 'lodash-es';\nimport CronGenerator from 'cron-string-generator';\nimport {\n  type ValueExpression,\n  ValueExpressionType,\n} from '@coze-workflow/base/types';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { Cascader, type CascaderData } from '@coze-arch/coze-design';\n\nconst hoursSize = 24;\nconst padStart = 2;\nconst hoursLeaf: CascaderData[] = Array.from(new Array(hoursSize).keys()).map(\n  i => ({\n    label: i.toString().padStart(padStart, '0').concat(':00'),\n    value: i,\n    isLeaf: true,\n  }),\n);\nconst weekDaysNode: () => CascaderData[] = () => {\n  const size = 7;\n  return Array.from({ length: size }).map((item, index) => ({\n    label: I18n.t('bot_task_preset_day_of_week', { day: index }),\n    value: index,\n    children: hoursLeaf,\n  }));\n};\n\nconst monthDaysNode: () => CascaderData[] = () => {\n  const size = 31;\n  return Array.from({ length: size }).map((item, index) => ({\n    label: I18n.t('bot_task_preset_day_of_month', { day: index + 1 }),\n    value: index + 1,\n    children: hoursLeaf,\n  }));\n};\n\nconst intervalDaysNode: () => CascaderData[] = () => {\n  const size = 5;\n  const offset = 2;\n  return Array.from({ length: size }).map((item, index) => ({\n    label: I18n.t('bot_task_preset_day_of_month', { day: index + offset }),\n    value: index + offset,\n    children: hoursLeaf,\n  }));\n};\n\nconst triggeredEveryday = () => I18n.t('bot_task_preset_triggered_everyday');\nconst triggeredEveryweek = () => I18n.t('bot_task_preset_triggered_everyweek');\nconst triggeredMonthly = () => I18n.t('bot_task_preset_triggered_monthly');\nconst triggeredInterval = () => I18n.t('bot_task_preset_triggered_interval');\n\nconst treeData: () => CascaderData[] = () => [\n  {\n    label: triggeredEveryday(),\n    value: 'daily',\n    children: hoursLeaf,\n  },\n  {\n    label: triggeredEveryweek(),\n    value: 'weekly',\n    children: weekDaysNode(),\n  },\n  {\n    label: triggeredMonthly(),\n    value: 'monthly',\n    children: monthDaysNode(),\n  },\n  {\n    label: triggeredInterval(),\n    value: 'intervalDaily',\n    children: intervalDaysNode(),\n  },\n];\n\ntype TaskSchedule = [string, number] | [string, number, number];\n\nconst createCron = (schedule: TaskSchedule) => {\n  const head = schedule[0];\n  const cronGenerator = new CronGenerator();\n\n  if (head === 'daily') {\n    const hour = schedule[1];\n    return cronGenerator.every(1).days().atHour(hour).atMinute(0).toString();\n  }\n  const day = schedule[1];\n  const hour = schedule[2];\n  if (isUndefined(hour)) {\n    throw new CustomError(\n      ReportEventNames.parmasValidation,\n      'invalid schedule',\n    );\n  }\n  if (head === 'weekly') {\n    return cronGenerator.atHour(hour).atMinute(0).onDaysOfWeek(day).toString();\n  }\n  if (head === 'monthly') {\n    return cronGenerator.atHour(hour).atMinute(0).onDaysOfMonth(day).toString();\n  }\n  return cronGenerator.every(day).days().atHour(hour).atMinute(0).toString();\n};\nexport const parseCron: (cron: string) => TaskSchedule = cronExpr => {\n  // The current demand is only 5, minutes, hours, day of month, month, day of week\n  // Bytescheduler only supports 6 bits, seconds, minutes, hours, day of month, month, day of week\n  const cronUnits = cronExpr?.split?.(' ').slice?.(1);\n  const hour = cronUnits?.at(1);\n  const dayOfMonthIndex = 2;\n  const dayOfMonth = cronUnits?.at(dayOfMonthIndex);\n  const dayOfWeek = cronExpr?.at(-1);\n\n  const numberHour = Number(hour);\n  // wild-card\n  const wildcard = '*';\n  if (dayOfWeek !== wildcard) {\n    return ['weekly', Number(dayOfWeek), numberHour];\n  }\n  if (dayOfMonth !== wildcard) {\n    if (dayOfMonth?.startsWith(wildcard)) {\n      return ['intervalDaily', Number(dayOfMonth.split('/').at(1)), numberHour];\n    }\n    return ['monthly', Number(dayOfMonth), numberHour];\n  }\n  return ['daily', numberHour];\n};\n\n// Convert key to corresponding copy\n// export const getOptionNodeText = (val: TaskSchedule): string[] => {\n//   let resultData = treeData();\n//   const nodeList = val?.map(item => {\n//     const findData = resultData.find(data => data.value === item);\n//     if (findData) {\n//       resultData = findData?.children || [];\n//       return String(findData.label) ?? '';\n//     } else {\n//       return '';\n//     }\n//   });\n//   return nodeList;\n// };\n\nconst renderDisplay = (nodeList: string[]) => {\n  const head = nodeList.at(0);\n  const formatHours = (hours?: string) => {\n    const formattedHours = hours?.startsWith?.('0') ? hours.slice?.(1) : hours;\n    return formattedHours;\n  };\n  if (head === triggeredEveryday()) {\n    const hours = nodeList.at(1);\n    return I18n.t('bot_task_preset_everyday_task', {\n      time: formatHours(hours),\n    });\n  }\n\n  const numberRegx = /[0-9]+/;\n  const dayNode = nodeList.at(1);\n  const days = Number(dayNode?.match?.(numberRegx)?.[0]);\n  const hoursIndex = 2;\n  const hours = nodeList.at(hoursIndex);\n\n  const formattedHours = formatHours(hours);\n  if (head === triggeredEveryweek()) {\n    return I18n.t('bot_task_preset_everyweek_task', {\n      day: dayNode,\n      time: formattedHours,\n    });\n  }\n  if (head === triggeredMonthly()) {\n    return I18n.t('bot_task_preset_monthly_task', {\n      day: days,\n      time: formattedHours,\n    });\n  }\n  if (head === triggeredInterval()) {\n    return I18n.t('bot_task_preset_interval_task', {\n      day: days,\n      time: formattedHours,\n    });\n  }\n  return '';\n};\n\ninterface FixCronjobSelectProps {\n  value?: ValueExpression;\n  onChange?: (e: ValueExpression) => void;\n  readonly?: boolean;\n  hasError?: boolean;\n}\n\n/** Select time and time zone components */\nexport const FixCronjobSelect: React.FC<FixCronjobSelectProps> = ({\n  value: _value,\n  onChange: _onChange,\n  readonly,\n  hasError,\n}) => {\n  const displayText = useRef<ReactNode>('');\n  const value = _value?.content as string;\n\n  const onChange = useCallback(\n    (v: string) => {\n      _onChange?.({\n        type: ValueExpressionType.LITERAL,\n        content: v,\n      });\n    },\n    [_onChange],\n  );\n\n  return (\n    <>\n      <Cascader\n        hasError={hasError}\n        size=\"small\"\n        className=\"w-full\"\n        disabled={readonly}\n        showClear={false}\n        placeholder={I18n.t('task_preset_trigger_time')}\n        value={value ? parseCron(value) : void 0}\n        onChange={v => {\n          if (Array.isArray(v) && v.length) {\n            // The resulting cron expression is 5 bits, but 6 bits are required\n            const cronExpr = `0 ${createCron(v as TaskSchedule)}`;\n            onChange?.(cronExpr);\n            return;\n          }\n          onChange?.('');\n        }}\n        treeData={treeData()}\n        displayRender={nodes => {\n          if (Array.isArray(nodes)) {\n            displayText.current = renderDisplay(nodes);\n            return displayText.current;\n          }\n        }}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useRef, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  workflowApi,\n  CopilotType,\n  ValueExpression,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozStopCircle, IconCozApply } from '@coze-arch/coze-design/icons';\nimport {\n  AIButton,\n  Button,\n  IconButton,\n  Input,\n  Popconfirm,\n} from '@coze-arch/coze-design';\n\nimport { useRefInput } from '@/hooks/use-ref-input';\nimport { useGlobalState } from '@/hooks';\n\nimport style from './index.module.less';\n\ninterface AICronjobSelectProps {\n  value?: ValueExpression;\n  onChange: (v: ValueExpression | undefined) => void;\n  readonly?: boolean;\n  node: FlowNodeEntity;\n  needRefInput?: boolean;\n  hasError?: boolean;\n}\n\nconst Suffix = ({ onChange }: { onChange: (v: string) => void }) => {\n  const [visible, setVisible] = useState(false);\n  const [prompt, setPrompt] = useState('');\n  const [cronjob, setCronjob] = useState('');\n  const [aiGenerating, setAIGenerating] = useState(false);\n  const cancelRequest = useRef<(reason?: unknown) => void>();\n\n  const { spaceId, projectId, workflowId } = useGlobalState();\n  return (\n    <>\n      <Popconfirm\n        className=\"w-[330px]\"\n        title={I18n.t('workflow_start_trigger_cron_ai', {}, ' AI ')}\n        trigger=\"custom\"\n        stopPropagation\n        onClickOutSide={() => {\n          setVisible(false);\n        }}\n        content={\n          <div className=\"mt-[12px] flex flex-col gap-[12px] text-[12px]\">\n            <div className=\"flex flex-col gap-[4px] p-[8px] rounded-mini coz-mg-hglt\">\n              {/* <div className=\"font-medium coz-fg-plus\">Sample i18n</div> */}\n              <div className=\"coz-fg-primary\">\n                {I18n.t(\n                  'workflow_trigger_cron_gen_sample_placeholder',\n                  {},\n                  '18Cron 0 18 * * *  18 ',\n                )}\n              </div>\n            </div>\n\n            <div className=\"flex flex-col gap-[4px]\">\n              <div className=\"flex justify-between\">\n                <div className=\"text-[14px] font-medium coz-fg-plus\">\n                  {I18n.t('Imageflow_prompt', {}, 'Prompt')}\n                </div>\n                {!aiGenerating ? (\n                  <AIButton\n                    size=\"small\"\n                    disabled={!prompt}\n                    onClick={async () => {\n                      try {\n                        setAIGenerating(true);\n\n                        const rs = await workflowApi.CopilotGenerate({\n                          space_id: spaceId,\n                          project_id: projectId ?? '',\n                          copilot_type: CopilotType.CRONTAB,\n                          query: prompt,\n                          workflow_id: workflowId,\n                        });\n\n                        setCronjob(rs?.data?.content ?? '');\n                      } finally {\n                        setAIGenerating(false);\n                      }\n                    }}\n                    color=\"aihglt\"\n                  >\n                    {I18n.t('workflow_start_trigger_cron_gen', {}, '')}\n                  </AIButton>\n                ) : (\n                  <IconButton\n                    size=\"small\"\n                    onClick={() => {\n                      try {\n                        cancelRequest.current?.('cancel');\n                      } finally {\n                        setAIGenerating(false);\n                      }\n                    }}\n                    icon={<IconCozStopCircle />}\n                    color=\"aihglt\"\n                  >\n                    {I18n.t('workflow_start_trigger_cron_gen_stop', {}, '')}\n                  </IconButton>\n                )}\n              </div>\n              <Input\n                size=\"small\"\n                value={prompt}\n                placeholder={I18n.t(\n                  'workflow_trigger_cron_gen_prompt_placeholder',\n                  {},\n                  '18',\n                )}\n                onChange={setPrompt}\n              ></Input>\n            </div>\n\n            <div className=\"flex flex-col gap-[4px]\">\n              <div className=\"text-[14px] font-medium coz-fg-plus\">\n                {I18n.t(\n                  'workflow_start_trigger_cron_generated',\n                  {},\n                  ' Cron ',\n                )}\n              </div>\n              <div className=\"flex flex-row gap-[8px]\">\n                <Input\n                  loading={aiGenerating}\n                  size=\"small\"\n                  disabled\n                  value={cronjob}\n                  onChange={setCronjob}\n                ></Input>\n                <Button\n                  size=\"small\"\n                  loading={aiGenerating}\n                  disabled={!cronjob}\n                  onClick={() => {\n                    if (cronjob) {\n                      onChange(cronjob);\n                      setVisible(false);\n                    }\n                  }}\n                >\n                  {I18n.t('workflow_start_trigger_cron_fillin', {}, '')}\n                </Button>\n              </div>\n            </div>\n          </div>\n        }\n        visible={visible}\n        onVisibleChange={v => {\n          setVisible(v);\n        }}\n        onCancel={() => {\n          setVisible(false);\n        }}\n        okText={''}\n        cancelText={I18n.t('workflow_start_trigger_cron_cancel', {}, '')}\n      >\n        <div>\n          <AIButton\n            size=\"mini\"\n            onClick={() => setVisible(true)}\n            color=\"aihglt\"\n            onlyIcon\n          />\n        </div>\n      </Popconfirm>\n    </>\n  );\n};\n\nexport const AICronjobSelect = ({\n  value,\n  onChange: _onChange,\n  readonly,\n  node,\n  needRefInput = false,\n  hasError,\n}: AICronjobSelectProps) => {\n  const onLiteralChange = useCallback(\n    (v: string) => {\n      _onChange({\n        type: ValueExpressionType.LITERAL,\n        content: v,\n      });\n    },\n    [_onChange],\n  );\n\n  const isRef = value?.type && ValueExpression.isRef(value);\n\n  const { renderVariableSelect, renderVariableDisplay } = useRefInput({\n    value,\n    onChange: _onChange,\n    readonly,\n    node,\n    style: { width: '100%' },\n    disabledTypes: ViewVariableType.getComplement([ViewVariableType.String]),\n  });\n  return (\n    <div className=\"w-full flex flex-row gap-[4px]\">\n      {isRef ? (\n        renderVariableDisplay({ needWrapper: true })\n      ) : (\n        <Input\n          error={hasError}\n          size=\"small\"\n          disabled={readonly}\n          className={classNames(['w-full flex-1', style.input])}\n          value={value?.content as string}\n          placeholder={I18n.t(\n            'workflow_start_trigger_cron_ai_sample',\n            {},\n            ' cron 0 18 * * *  18 ',\n          )}\n          onChange={onLiteralChange}\n          suffix={\n            <div className=\"flex flex-row gap-[4px]\">\n              <Suffix onChange={onLiteralChange} />\n              {needRefInput ? (\n                <div>\n                  {renderVariableSelect(\n                    <IconButton\n                      size=\"mini\"\n                      color=\"secondary\"\n                      icon={<IconCozApply className=\"text-[16px]\" />}\n                    />,\n                  )}\n                </div>\n              ) : undefined}\n            </div>\n          }\n        ></Input>\n      )}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport { useWatchFormErrors } from '@flowgram-adapter/free-layout-editor';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { cronJobTranslator } from '@coze-workflow/components';\nimport { CronJobType, type CronJobValue } from '@coze-workflow/nodes';\nimport { ValueExpressionType, ValueExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Select } from '@coze-arch/coze-design';\n\nimport { Text } from '@/form-extensions/components/text';\n\nimport { type DynamicComponentProps } from '../dynamic-form';\nimport { FixCronjobSelect } from './fix-cronjob';\nimport { AICronjobSelect } from './ai-cronjob';\n\ntype CronJobSelectProps = DynamicComponentProps<CronJobValue> & {\n  needRefInput?: boolean;\n  className?: string;\n};\n\nexport const CronJobSelect: FC<CronJobSelectProps> = ({\n  needRefInput,\n  className = '',\n  value = {\n    type: CronJobType.Selecting,\n    content: {\n      type: ValueExpressionType.LITERAL,\n      content: '',\n    },\n  },\n  onChange: _onChange,\n  readonly,\n}) => {\n  const node = useCurrentEntity();\n  const errors = useWatchFormErrors(node);\n  const hasError = (errors ?? []).length > 0;\n\n  const type = value.type ?? CronJobType.Selecting;\n  const onChange = (content: ValueExpression | undefined) => {\n    _onChange({\n      type,\n      content: content ?? {\n        type: ValueExpressionType.LITERAL,\n      },\n    });\n  };\n\n  const cronjobTranslateText = useMemo(() => {\n    if (\n      hasError ||\n      type === CronJobType.Selecting ||\n      (value.content && ValueExpression.isRef(value.content))\n    ) {\n      return '';\n    }\n\n    return cronJobTranslator(value.content?.content as unknown as string);\n  }, [hasError, value.content, type]);\n\n  return (\n    <div className={className}>\n      <div className=\"flex flex-row gap-[2px]\">\n        <Select\n          size=\"small\"\n          value={type}\n          className=\"w-fit mb-[4px]\"\n          disabled={readonly}\n          onChange={v => {\n            _onChange({\n              type: v as CronJobType,\n              content: {\n                type: ValueExpressionType.LITERAL,\n              },\n            });\n          }}\n          optionList={[\n            {\n              label: I18n.t(\n                'workflow_start_trigger_cron_option',\n                {},\n                '',\n              ),\n              value: CronJobType.Selecting,\n            },\n            {\n              label: I18n.t(\n                'workflow_start_trigger_cron_job',\n                {},\n                'Cron',\n              ),\n              value: CronJobType.Cronjob,\n            },\n          ]}\n        ></Select>\n\n        <div className=\"flex-1 overflow-hidden\">\n          {type === CronJobType.Selecting ? (\n            <FixCronjobSelect\n              hasError={hasError}\n              value={value.content}\n              onChange={onChange}\n              readonly={readonly}\n            />\n          ) : (\n            <AICronjobSelect\n              hasError={hasError}\n              value={value.content}\n              onChange={onChange}\n              readonly={readonly}\n              node={node}\n              needRefInput={needRefInput}\n            />\n          )}\n        </div>\n      </div>\n      {cronjobTranslateText ? (\n        <div className=\"coz-mg-primary w-full h-[24px] flex flex-row items-center justify-center rounded-[4px]\">\n          <Text text={cronjobTranslateText} className=\"text-[12px]\" />\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport { Field } from '@/form';\n\nimport { type DynamicComponentProps, type FormMeta } from './types';\n\nexport interface DynamicFormProps {\n  formMeta: FormMeta;\n  name: string;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  components: Record<string, FC<DynamicComponentProps<any>>>;\n  // Disable trigger\n  onChange?: () => void;\n}\n\nexport const DynamicForm: FC<DynamicFormProps> = ({\n  formMeta,\n  name,\n  components,\n  onChange,\n}) => {\n  const fields = useMemo(\n    () =>\n      formMeta.map(field => {\n        const Component =\n          components[field.setter] ??\n          (() => <div>component {field.setter} not exist</div>);\n\n        return (\n          <Field\n            {...field}\n            key={field.name}\n            name={`${name}.${field.name}`}\n            layout={field.layout ?? 'vertical'}\n          >\n            {({ value, onChange: _onChange, readonly }) => (\n              <Component\n                {...field.setterProps}\n                value={value}\n                onChange={(...args) => {\n                  _onChange(...args);\n                  onChange?.();\n                }}\n                readonly={readonly}\n              />\n            )}\n          </Field>\n        );\n      }),\n    [formMeta, name, components],\n  );\n  return <>{fields}</>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createEffectFromVariableProvider } from '@coze-workflow/variable/src/utils/variable-provider';\nimport { provideLoopInputsVariables } from '@coze-workflow/variable/src/form-extensions/variable-providers/provide-loop-input-variables';\n\nexport const provideLoopInputsVariablesEffect =\n  createEffectFromVariableProvider(provideLoopInputsVariables);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createEffectFromVariableProvider } from '@coze-workflow/variable/src/utils/variable-provider';\nimport { provideLoopOutputsVariables } from '@coze-workflow/variable/src/form-extensions/variable-providers/provide-loop-output-variables';\n\nexport const provideLoopOutputsVariablesEffect =\n  createEffectFromVariableProvider(provideLoopOutputsVariables);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type ValidationProps } from '@/nodes-v2/components/validation/with-validation';\nimport { withValidation } from '@/nodes-v2/components/validation';\nimport {\n  InputTree,\n  type InputTreeProps,\n} from '@/form-extensions/components/input-tree';\nimport { useField, withField, type FieldProps } from '@/form';\n\ninterface InputsTreeFieldProps extends FieldProps<InputValueVO[]> {\n  title?: string;\n  customReadonly?: boolean;\n  testId?: string;\n}\n\nconst InputTreeWithValidation = withValidation(\n  (props: InputTreeProps & ValidationProps) => <InputTree {...props} />,\n);\n\nexport const InputsTreeField = withField(\n  ({ title, tooltip, customReadonly, testId }: InputsTreeFieldProps) => {\n    const { value, onChange, errors } = useField<InputValueVO[]>();\n    const formReadonly = useReadonly();\n    const readonly = formReadonly || customReadonly;\n    return (\n      <InputTreeWithValidation\n        value={value}\n        title={title}\n        titleTooltip={tooltip}\n        readonly={readonly}\n        onChange={onChange}\n        errors={errors}\n        testId={testId}\n      />\n    );\n  },\n  {\n    hasFeedback: false,\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport { type ValueExpression, useNodeTestId } from '@coze-workflow/base';\n\nimport {\n  ValueExpressionInput as ValueExpressionInputLegacy,\n  type ValueExpressionInputProps as ValueExpressionInputLegacyProps,\n} from '@/nodes-v2/components/value-expression-input';\nimport { useField, withField } from '@/form';\n\nexport type ValueExpressionInputProps = Pick<\n  ValueExpressionInputLegacyProps,\n  | 'style'\n  | 'inputType'\n  | 'disabledTypes'\n  | 'availableFileTypes'\n  | 'customFilterVar'\n  | 'selectStyle'\n  | 'literalConfig'\n  | 'hideDeleteIcon'\n  | 'literalDisabled'\n> & {\n  testId?: string;\n  className?: string;\n  inputPlaceholder?: string;\n  literalDisabled?: boolean;\n  customReadonly?: boolean;\n};\n\nfunction ValueExpressionInput({\n  style,\n  inputType,\n  disabledTypes,\n  availableFileTypes,\n  testId,\n  customFilterVar,\n  selectStyle,\n  className,\n  inputPlaceholder,\n  literalConfig,\n  hideDeleteIcon,\n  literalDisabled,\n  customReadonly,\n}: ValueExpressionInputProps) {\n  const { name, value, onChange, errors, onBlur, readonly } =\n    useField<ValueExpression>();\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <div\n      className={classNames('flex flex-col items-start', className)}\n      data-testid={getNodeSetterId(name)}\n      style={{\n        ...style,\n        pointerEvents: readonly ? 'none' : 'auto',\n      }}\n    >\n      <ValueExpressionInputLegacy\n        value={value}\n        onChange={v => onChange(v as ValueExpression)}\n        name={testId ?? name}\n        isError={errors && errors?.length > 0}\n        onBlur={onBlur}\n        inputType={inputType}\n        disabledTypes={disabledTypes}\n        availableFileTypes={availableFileTypes}\n        customFilterVar={customFilterVar}\n        selectStyle={selectStyle}\n        inputPlaceholder={inputPlaceholder}\n        literalDisabled={literalDisabled}\n        literalConfig={literalConfig}\n        hideDeleteIcon={hideDeleteIcon}\n        readonly={customReadonly}\n      />\n    </div>\n  );\n}\n\nexport const ValueExpressionInputField =\n  withField<ValueExpressionInputProps>(ValueExpressionInput);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { withField } from '@/form';\n\nimport { NodeInputName } from './node-input-name';\n\nexport const NodeInputNameField = withField(NodeInputName);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useState } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  useCurrentEntity,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowVariableFacadeService } from '@coze-workflow/variable';\nimport { type RefExpression, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Input, Tooltip, Typography } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport {\n  getUniqueName,\n  getVariableName,\n} from '@/form-extensions/setters/node-input-name/utils';\nimport { useField } from '@/form';\n\nimport type { NodeInputNameProps } from './type';\n\nexport const NodeInputName = ({\n  style,\n  input,\n  inputParameters,\n  initValidate = false,\n  isPureText = false,\n  prefix = '',\n  suffix = '',\n  placeholder = I18n.t('workflow_detail_node_input_entername'),\n  format,\n  tooltip,\n  readonly: customReadonly,\n}: NodeInputNameProps) => {\n  const { name, value, onChange, onBlur, errors } = useField<string>();\n\n  const [initialized, setInitialized] = useState<boolean>(false);\n  const [userEdited, setUserEdited] = useState<boolean>(false);\n  const [variableName, setVariableName] = useState<string | undefined>(value);\n  const [text, setText] = useState<string | undefined>(value);\n  const formReadonly = useReadonly();\n  const readonly = formReadonly || customReadonly;\n\n  const node = useCurrentEntity();\n  const variableService = useService(WorkflowVariableFacadeService);\n  const { getNodeSetterId } = useNodeTestId();\n\n  // The text state is controlled (the value of the linked text when deleting a node)\n  useEffect(() => {\n    if (value !== text) {\n      setText(value);\n    }\n  }, [value]);\n\n  const computedVariableName = getVariableName({\n    input: input as RefExpression,\n    prefix,\n    suffix,\n    format,\n    node,\n    variableService,\n  });\n\n  const onInputChange = useCallback((newInputValue: string): void => {\n    setUserEdited(true);\n    setText(newInputValue || '');\n    setVariableName(undefined);\n  }, []);\n\n  const handleOnBlur = () => {\n    onChange(text || '');\n    onBlur?.();\n  };\n\n  useEffect(() => {\n    if (initValidate) {\n      // Initialize write value to trigger verification\n      onChange(value as string);\n    }\n    if (value) {\n      setUserEdited(true);\n    }\n    setInitialized(true);\n  }, []);\n\n  if (initialized && !readonly && !userEdited) {\n    if (computedVariableName && computedVariableName !== variableName) {\n      const computedUniqueName = getUniqueName({\n        variableName: computedVariableName,\n        inputParameters,\n      });\n      onChange(computedUniqueName);\n      setVariableName(computedVariableName);\n      setText(computedUniqueName);\n    } else if (!computedVariableName && variableName) {\n      setVariableName(undefined);\n      setText(undefined);\n    }\n  }\n\n  return (\n    <div\n      className=\"flex flex-col items-start\"\n      style={{\n        ...style,\n        pointerEvents: readonly ? 'none' : 'auto',\n      }}\n    >\n      {isPureText ? (\n        <>\n          <Typography.Text className=\"h-8 leading-8 overflow-hidden whitespace-nowrap text-ellipsis\">\n            {value}\n          </Typography.Text>\n          {tooltip ? (\n            <Tooltip content={tooltip}>\n              <IconCozInfoCircle\n                className=\"ml-1\"\n                style={{\n                  fontSize: 12,\n                }}\n              />\n            </Tooltip>\n          ) : null}\n        </>\n      ) : (\n        <>\n          <Input\n            className={classNames({\n              'semi-input-wrapper-error': errors?.length,\n            })}\n            size={'small'}\n            data-testid={getNodeSetterId(name)}\n            value={text}\n            onChange={onInputChange}\n            onBlur={handleOnBlur}\n            validateStatus={errors?.length ? 'error' : undefined}\n            placeholder={placeholder}\n            readonly={readonly}\n          />\n          {tooltip ? (\n            <Tooltip content={tooltip}>\n              <IconCozInfoCircle\n                className=\"ml-1\"\n                style={{\n                  fontSize: 12,\n                }}\n              />\n            </Tooltip>\n          ) : null}\n        </>\n      )}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FieldArray,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport type { ViewVariableType, InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\nimport {\n  AddButton,\n  FieldArrayItem,\n  FieldRows,\n  Section,\n  type FieldProps,\n} from '@/form';\n\nimport {\n  ValueExpressionInputField,\n  type ValueExpressionInputProps,\n} from '../value-expression-input';\nimport { type NodeInputNameProps } from './node-input-name/type';\nimport { NodeInputNameField } from './node-input-name';\n\ninterface InputsFieldProps extends FieldProps<InputValueVO[]> {\n  title?: string;\n  paramsTitle?: string;\n  expressionTitle?: string;\n  disabledTypes?: ViewVariableType[];\n  onAppend?: () => InputValueVO;\n  inputPlaceholder?: string;\n  literalDisabled?: boolean;\n  showEmptyText?: boolean;\n  nthCannotDeleted?: number;\n  nameProps?: Partial<NodeInputNameProps>;\n  inputProps?: ValueExpressionInputProps;\n  customReadonly?: boolean;\n  testId?: string;\n}\n\nexport const InputsField = ({\n  name,\n  defaultValue,\n  title,\n  tooltip,\n  paramsTitle,\n  expressionTitle,\n  disabledTypes,\n  inputPlaceholder,\n  literalDisabled,\n  onAppend,\n  nthCannotDeleted,\n  showEmptyText = true,\n  nameProps = {},\n  inputProps = {},\n  customReadonly,\n  testId,\n}: InputsFieldProps) => {\n  const formReadonly = useReadonly();\n  const readonly = formReadonly || customReadonly;\n  return (\n    <FieldArray<InputValueVO> name={name} defaultValue={defaultValue}>\n      {({ field }: FieldArrayRenderProps<InputValueVO>) => {\n        const { value = [], delete: remove, append } = field;\n        const length = value?.length ?? 0;\n        const isEmpty = !length;\n        const disableRemove = nthCannotDeleted === length;\n        return (\n          <Section\n            title={title}\n            tooltip={tooltip}\n            actions={\n              !readonly\n                ? [\n                    <AddButton\n                      dataTestId={`${testId}.add-button`}\n                      onClick={() => {\n                        const newValue = (onAppend?.() ?? {\n                          name: '',\n                        }) as InputValueVO;\n                        append(newValue);\n                      }}\n                    />,\n                  ]\n                : []\n            }\n            isEmpty={showEmptyText && isEmpty}\n            emptyText={I18n.t('workflow_inputs_empty')}\n          >\n            <ColumnsTitleWithAction\n              columns={[\n                {\n                  title:\n                    paramsTitle ??\n                    I18n.t('workflow_detail_node_parameter_name'),\n                  style: { flex: 2 },\n                },\n                {\n                  title:\n                    expressionTitle ??\n                    I18n.t('workflow_detail_end_output_value'),\n                  style: { flex: 3 },\n                },\n              ]}\n              readonly={readonly}\n              className=\"mb-[8px]\"\n              style={{\n                display: isEmpty ? 'none' : 'flex',\n              }}\n            />\n            <FieldRows>\n              {field.map((item, index) => (\n                <FieldArrayItem\n                  key={item.key}\n                  disableRemove={disableRemove}\n                  hiddenRemove={readonly}\n                  onRemove={() => remove(index)}\n                >\n                  <div style={{ flex: 2 }}>\n                    <NodeInputNameField\n                      name={`${item.name}.name`}\n                      placeholder={I18n.t(\n                        'workflow_detail_node_input_entername',\n                      )}\n                      input={item.value.input}\n                      inputParameters={value}\n                      {...nameProps}\n                    />\n                  </div>\n                  <div style={{ flex: 3 }}>\n                    <ValueExpressionInputField\n                      name={`${name}.${index}.input`}\n                      disabledTypes={disabledTypes}\n                      inputPlaceholder={inputPlaceholder}\n                      literalDisabled={literalDisabled}\n                      customReadonly={customReadonly}\n                      {...inputProps}\n                    />\n                  </div>\n                </FieldArrayItem>\n              ))}\n            </FieldRows>\n          </Section>\n        );\n      }}\n    </FieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ViewVariableType, type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type FieldProps } from '@/form';\n\nimport { type NodeInputNameProps } from './node-input-name/type';\nimport { InputsTreeField } from './inputs-tree-field';\nimport { InputsField } from './inputs-field';\n\ninterface InputsSectionProps extends FieldProps<InputValueVO[]> {\n  title?: string;\n  tooltip?: React.ReactNode;\n  isTree?: boolean;\n  paramsTitle?: string;\n  expressionTitle?: string;\n  testId?: string;\n  disabledTypes?: ViewVariableType[];\n  onAppend?: () => InputValueVO;\n  inputPlaceholder?: string;\n  literalDisabled?: boolean;\n  nameProps?: Partial<NodeInputNameProps>;\n  customReadonly?: boolean;\n}\n\nexport const InputsParametersField = ({\n  name = 'inputs.inputParameters',\n  title = I18n.t('workflow_detail_node_parameter_input'),\n  tooltip = I18n.t('workflow_240218_07'),\n  paramsTitle,\n  expressionTitle,\n  disabledTypes,\n  defaultValue,\n  onAppend,\n  inputPlaceholder,\n  literalDisabled,\n  isTree,\n  nameProps,\n  customReadonly,\n  testId,\n}: InputsSectionProps) =>\n  isTree ? (\n    <InputsTreeField\n      name={name}\n      defaultValue={defaultValue}\n      title={title}\n      tooltip={tooltip}\n      customReadonly={customReadonly}\n      testId={testId}\n    />\n  ) : (\n    <InputsField\n      name={name}\n      defaultValue={defaultValue}\n      title={title}\n      tooltip={tooltip}\n      paramsTitle={paramsTitle}\n      expressionTitle={expressionTitle}\n      disabledTypes={disabledTypes}\n      onAppend={onAppend}\n      inputPlaceholder={inputPlaceholder}\n      literalDisabled={literalDisabled}\n      nameProps={nameProps}\n      customReadonly={customReadonly}\n      testId={testId}\n    />\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\n\nimport { createInputTreeValidator } from '../../validators/create-input-tree-validator';\n\nexport function createInputsValidator(isTree: boolean): {\n  [key: string]: Validate;\n} {\n  if (isTree) {\n    return {\n      'inputs.inputParameters': createInputTreeValidator(),\n    };\n  }\n\n  return {\n    'inputs.inputParameters.*.name': createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'inputs.inputParameters') || []).map(\n          item => item.name,\n        ),\n    }),\n    'inputs.inputParameters.*.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type SettingOnErrorValue } from '@coze-workflow/nodes';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { SettingOnError as SettingOnErrorComp } from '@/form-extensions/components/setting-on-error';\nimport { withField, useField } from '@/form';\n\ninterface Props {\n  batchModePath?: string;\n  outputsPath?: string;\n  noPadding?: boolean;\n}\n\nexport const SettingOnErrorField = withField(\n  ({ batchModePath, outputsPath, noPadding }: Props) => {\n    const field = useField<SettingOnErrorValue>();\n    const readonly = useReadonly();\n    return (\n      <SettingOnErrorComp\n        {...field}\n        readonly={readonly}\n        value={field.value as SettingOnErrorValue}\n        batchModePath={batchModePath}\n        outputsPath={outputsPath}\n        noPadding={noPadding}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SettingOnErrorField } from './setting-on-error-field';\n\nexport const SettingOnError = ({\n  name = 'settingOnError',\n  batchModePath = 'batchMode',\n  outputsPath = 'outputs',\n  noPadding = false,\n}) => (\n  <SettingOnErrorField\n    name={name}\n    batchModePath={batchModePath}\n    outputsPath={outputsPath}\n    noPadding={noPadding}\n    hasFeedback={false}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport classNames from 'classnames';\nimport {\n  FieldArray,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  type ViewVariableType,\n  type InputTypeValueVO,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport InputLabel from '@/nodes-v2/components/input-label';\nimport { DataTypeTag } from '@/node-registries/common/components';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\nimport type { Column } from '@/form-extensions/components/columns-title';\nimport { FieldArrayItem, FieldRows, FieldEmpty, type FieldProps } from '@/form';\n\nimport { ValueExpressionInputField } from '../value-expression-input';\nimport { NodeInputNameField as InputNameField } from '../inputs-parameters-field/node-input-name';\n\nimport styles from './index.module.less';\n\ninterface ParametersInputGroupFieldProps\n  extends FieldProps<InputTypeValueVO[]> {\n  name: string;\n  columns?: Column[];\n  nameReadonly?: boolean;\n  fieldEditable?: boolean;\n  hiddenRemove?: boolean;\n  hiddenTypes?: boolean;\n  hiddenTypeTag?: boolean;\n  /**\n   * Text box default type, but does not restrict optional variable types\n   */\n  inputType?: ViewVariableType;\n  disabledTypes?: ViewVariableType[];\n}\n\nexport const ParametersInputGroupField = ({\n  name,\n  columns,\n  nameReadonly,\n  fieldEditable,\n  hiddenRemove,\n  hiddenTypeTag = false,\n  defaultValue,\n  inputType,\n  disabledTypes,\n}: ParametersInputGroupFieldProps) => {\n  const readonly = useReadonly();\n  return (\n    <FieldArray<InputTypeValueVO> name={name} defaultValue={defaultValue}>\n      {({ field }: FieldArrayRenderProps<InputTypeValueVO>) => {\n        const { value = [], delete: remove } = field;\n        return (\n          <FieldEmpty\n            isEmpty={!value || value?.length === 0}\n            text={I18n.t('workflow_inputs_empty')}\n          >\n            {columns?.length ? (\n              <ColumnsTitleWithAction\n                columns={columns}\n                readonly={readonly}\n                className={classNames(\n                  'mb-[8px]',\n                  readonly\n                    ? styles.parametersTitleReadonly\n                    : styles.parametersTitle,\n                )}\n              />\n            ) : null}\n            <FieldRows>\n              {field.map((item, index) => (\n                <FieldArrayItem\n                  key={item.key}\n                  onRemove={() => remove(index)}\n                  disableRemove={!fieldEditable}\n                  hiddenRemove={hiddenRemove}\n                >\n                  <div\n                    className=\"leading-[24px]\"\n                    style={{\n                      flex: 2,\n                    }}\n                  >\n                    {nameReadonly ? (\n                      <>\n                        <InputLabel label={item.value.name} />\n                        {!hiddenTypeTag && (\n                          <DataTypeTag type={item.value.type} />\n                        )}\n                      </>\n                    ) : (\n                      <InputNameField\n                        name={`${item.name}.name`}\n                        placeholder={I18n.t(\n                          'workflow_detail_node_input_entername',\n                        )}\n                        input={item.value.input}\n                        inputParameters={value}\n                      />\n                    )}\n                  </div>\n                  <div\n                    style={{\n                      flex: 3,\n                    }}\n                  >\n                    <ValueExpressionInputField\n                      name={`${item.name}.input`}\n                      deps={[`${item.name}.type`]}\n                      inputType={inputType}\n                      key={item.value.type}\n                      disabledTypes={disabledTypes}\n                    />\n                  </div>\n                </FieldArrayItem>\n              ))}\n            </FieldRows>\n          </FieldEmpty>\n        );\n      }}\n    </FieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValueExpressionType,\n  ViewVariableType,\n  type InputTypeValueVO,\n} from '@coze-workflow/base';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport type { Column } from '@/form-extensions/components/columns-title';\nimport { FieldArray, type FieldProps, Section, AddButton } from '@/form';\n\nimport { ParametersInputGroupField } from './parameters-input-group-field';\n\ninterface ParametersInputGroupProps extends FieldProps<InputTypeValueVO[]> {\n  name: string;\n  columns?: Column[];\n  title?: string;\n  tooltip?: React.ReactNode;\n  nameReadonly?: boolean;\n  fieldEditable?: boolean;\n  defaultAppendValue?: InputTypeValueVO;\n  hiddenTypes?: boolean;\n  inputType?: ViewVariableType;\n  disabledTypes?: ViewVariableType[];\n}\n\nexport const ParametersInputGroup = ({\n  name,\n  title,\n  tooltip,\n  columns,\n  defaultValue,\n  nameReadonly,\n  fieldEditable = true,\n  defaultAppendValue = {\n    name: '',\n    type: ViewVariableType.String,\n    input: { type: ValueExpressionType.LITERAL, content: '' },\n  },\n  inputType,\n  hiddenTypes,\n  disabledTypes,\n}: ParametersInputGroupProps) => {\n  const readonly = useReadonly();\n\n  return (\n    <Section\n      title={title}\n      tooltip={tooltip}\n      actions={\n        fieldEditable && !readonly\n          ? [\n              <FieldArray name={name}>\n                {({ append }) => (\n                  <AddButton\n                    onClick={() => {\n                      append(defaultAppendValue);\n                    }}\n                  />\n                )}\n              </FieldArray>,\n            ]\n          : []\n      }\n    >\n      <ParametersInputGroupField\n        name={name}\n        columns={columns}\n        defaultValue={defaultValue}\n        nameReadonly={nameReadonly}\n        fieldEditable={fieldEditable && !readonly}\n        hiddenTypes={hiddenTypes}\n        inputType={inputType}\n        disabledTypes={disabledTypes}\n      />\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport type { IModelValue } from '@/typing';\nimport { Section, useField, withField } from '@/form';\nimport { ModelSelect } from '@/components/model-select';\n\nfunction ModelSelectComp({\n  title,\n  tooltip,\n}: {\n  title?: string;\n  tooltip?: string;\n}) {\n  const { value, onChange, readonly, name } = useField<IModelValue>();\n  return (\n    <Section title={title} tooltip={tooltip}>\n      <ModelSelect\n        name={name}\n        value={value}\n        onChange={e => onChange(e as IModelValue)}\n        readonly={readonly}\n      />\n    </Section>\n  );\n}\n\nexport const ModelSelectField = withField(ModelSelectComp);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { Radio as BaseRadio } from '@/form-extensions/components/radio';\nimport { useField, withField } from '@/form';\n\nimport styles from './index.module.less';\n\nconst Radio = ({\n  options,\n  customReadonly,\n}: {\n  options;\n  customReadonly?: boolean;\n}) => {\n  const { name, value, onChange, readonly } = useField<string | number>();\n  const context = {\n    meta: {\n      name,\n    },\n  };\n  return (\n    <div className={styles['workflow-node-setter-radio']}>\n      <BaseRadio\n        value={value}\n        onChange={onChange}\n        options={options}\n        readonly={!!readonly || customReadonly}\n        context={context}\n      />\n    </div>\n  );\n};\n\nexport const RadioSetterField = withField(Radio);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  ExpressionEditor as ExpressionEditorLeagcy,\n  type ExpressionEditorProps,\n} from '@/nodes-v2/components/expression-editor';\nimport { useField, withField } from '@/form';\n\ntype ExpressionEditorFieldProps = Omit<\n  ExpressionEditorProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus'\n> & {\n  dataTestName?: string;\n};\n\nfunction ExpressionEditor(props: ExpressionEditorFieldProps) {\n  const { name, value, onChange, errors, onBlur, readonly } =\n    useField<string>();\n\n  return (\n    <ExpressionEditorLeagcy\n      {...props}\n      name={props?.dataTestName ?? name}\n      value={value as string}\n      onChange={e => onChange(e as string)}\n      isError={errors && errors?.length > 0}\n      onBlur={onBlur}\n      disableSuggestion={readonly}\n    />\n  );\n}\n\nexport const ExpressionEditorField = withField(ExpressionEditor);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { Checkbox } from '@/form-extensions/components/checkbox';\nimport { useField, withField } from '@/form';\n\nexport const CheckboxWithTipsField = withField(\n  ({ text, itemTooltip }: { text: string; itemTooltip?: string }) => {\n    const { name, value, onChange, readonly } = useField<boolean>();\n    const context = { meta: { name } };\n    const options = {\n      text,\n      itemTooltip,\n    };\n    return (\n      <Checkbox\n        options={options}\n        context={context}\n        value={!!value}\n        onChange={(v: boolean) => onChange(v)}\n        readonly={!!readonly}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  VARIABLE_TYPE_ALIAS_MAP,\n  type ViewVariableType,\n} from '@coze-workflow/base';\n\nimport { OutputsParamDisplay } from '@/form-extensions/components/output-param-display';\nimport { withField, useField } from '@/form';\n\nexport interface OutputsProps {\n  id: string;\n  name: string;\n  settingOnErrorPath?: string;\n  topLevelReadonly?: boolean;\n  disabledTypes?: ViewVariableType[];\n  title?: string;\n  tooltip?: React.ReactNode;\n  disabled?: boolean;\n  customReadonly?: boolean;\n  hiddenTypes?: ViewVariableType[];\n  noCard?: boolean;\n  jsonImport?: boolean;\n  allowAppendRootData?: boolean;\n  withDescription?: boolean;\n  withRequired?: boolean;\n}\n\nexport const OutputsDisplayField = withField<OutputsProps>(() => {\n  const { value } = useField<\n    {\n      name: string;\n      type: string;\n      required?: boolean;\n    }[]\n  >();\n\n  return (\n    <OutputsParamDisplay\n      options={{\n        outputInfo: value?.map(item => ({\n          ...item,\n          label: item.name ?? '',\n          type: VARIABLE_TYPE_ALIAS_MAP[item.type],\n        })),\n      }}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { IconInfo } from '@coze-arch/bot-icons';\nimport { Switch } from '@coze-arch/coze-design';\n\nimport AutoSizeTooltip from '@/ui-components/auto-size-tooltip';\nimport { withField, useField } from '@/form';\n\nimport styles from './index.module.less';\nexport interface SwitchFieldProps {\n  customLabel?: string;\n  customTooltip?: string;\n  testId?: string;\n  customStyles?: React.CSSProperties;\n  labelStyles?: React.CSSProperties;\n  switchCustomStyles?: React.CSSProperties;\n}\nexport const SwitchField = withField<SwitchFieldProps, boolean>(\n  ({\n    testId,\n    customLabel,\n    customTooltip,\n    customStyles,\n    labelStyles,\n    switchCustomStyles,\n  }) => {\n    const { getNodeSetterId } = useNodeTestId();\n    const { value, onChange, readonly } = useField<boolean>();\n    return (\n      <div className={styles.switchContainer} style={customStyles}>\n        {customLabel ? (\n          <div className={styles.label} style={labelStyles}>\n            {customLabel}\n          </div>\n        ) : null}\n        {customTooltip ? (\n          <AutoSizeTooltip\n            showArrow\n            position=\"top\"\n            className={styles.popover}\n            content={customTooltip}\n          >\n            <IconInfo className={styles.icon} />\n          </AutoSizeTooltip>\n        ) : null}\n        <Switch\n          data-testid={getNodeSetterId(testId ?? '')}\n          disabled={readonly}\n          size=\"mini\"\n          checked={value}\n          onChange={onChange}\n          style={switchCustomStyles}\n        />\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { type InputValueVO, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section } from '@/form';\n\nimport { SwitchField } from '../switch-field';\nimport { ExpressionEditorField } from '../expression-editor-field';\nexport interface AnswerContentFieldProps {\n  enableStreamingOutput?: boolean;\n  editorFieldName: string;\n  switchFieldName?: string;\n  title?: string;\n  tooltip?: string;\n  switchLabel?: string;\n  switchTooltip?: string;\n  switchTestId?: string;\n  inputParameters?: InputValueVO[];\n  testId?: string;\n}\nexport const AnswerContentField: FC<AnswerContentFieldProps> = ({\n  title,\n  tooltip,\n  switchLabel,\n  switchTooltip,\n  enableStreamingOutput,\n  editorFieldName,\n  switchFieldName,\n  switchTestId,\n  inputParameters,\n  testId,\n}) => {\n  const { concatTestId, getNodeSetterId } = useNodeTestId();\n\n  return (\n    <Section\n      title={title}\n      tooltip={tooltip}\n      actions={[\n        enableStreamingOutput && switchFieldName ? (\n          <SwitchField\n            name={switchFieldName}\n            customLabel={switchLabel}\n            customTooltip={switchTooltip}\n            testId={concatTestId(testId ?? '', switchTestId ?? '')}\n          />\n        ) : null,\n      ]}\n      testId={getNodeSetterId(testId ?? '')}\n    >\n      <ExpressionEditorField\n        name={editorFieldName}\n        placeholder={I18n.t('workflow_detail_end_answer_example')}\n        inputParameters={inputParameters}\n        testId={testId}\n      />\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { type RefExpression, useNodeTestId } from '@coze-workflow/base';\n\nimport { LoopOutputSelect } from '@/form-extensions/components/loop-output-select';\nimport { useField, withField } from '@/form';\n\ninterface LoopOutputSelectFieldProps {}\n\nexport const LoopOutputSelectField = withField<\n  LoopOutputSelectFieldProps,\n  RefExpression\n>(() => {\n  const { name, value, onChange, readonly } = useField<RefExpression>();\n  const { getNodeSetterId } = useNodeTestId();\n  const testId = getNodeSetterId(name);\n\n  return (\n    <LoopOutputSelect\n      value={value}\n      onChange={onChange}\n      readonly={readonly}\n      testId={testId}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FieldArray,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { NodeInputNameField } from '@/node-registries/common/fields/inputs-parameters-field/node-input-name';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\nimport {\n  AddButton,\n  FieldArrayItem,\n  FieldRows,\n  Section,\n  type FieldProps,\n} from '@/form';\n\nimport { type NodeInputNameProps } from '../inputs-parameters-field/node-input-name/type';\nimport { LoopOutputSelectField } from './loop-output-select-field';\n\ninterface LoopOutputsFieldProps extends FieldProps<InputValueVO[]> {\n  title?: string;\n  tooltip?: string;\n  nameProps?: Partial<NodeInputNameProps>;\n}\n\nexport const LoopOutputsField = ({\n  name,\n  defaultValue,\n  title,\n  tooltip,\n  nameProps = {},\n}: LoopOutputsFieldProps) => {\n  const readonly = useReadonly();\n  return (\n    <FieldArray<InputValueVO> name={name} defaultValue={defaultValue}>\n      {({ field }: FieldArrayRenderProps<InputValueVO>) => {\n        const { value = [], delete: remove, append } = field;\n        return (\n          <Section\n            title={title}\n            tooltip={tooltip}\n            actions={\n              !readonly\n                ? [\n                    <AddButton\n                      onClick={() => {\n                        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n                        append({} as InputValueVO);\n                      }}\n                    />,\n                  ]\n                : []\n            }\n            isEmpty={!value || value?.length === 0}\n            emptyText={I18n.t('workflow_inputs_empty')}\n          >\n            <ColumnsTitleWithAction\n              columns={[\n                {\n                  title: I18n.t('workflow_detail_node_parameter_name'),\n                  style: {\n                    flex: 2,\n                    minWidth: 0,\n                  },\n                },\n                {\n                  title: I18n.t('workflow_detail_node_parameter_value'),\n                  style: {\n                    flex: 3,\n                    minWidth: 0,\n                  },\n                },\n                {\n                  title: I18n.t('workflow_detail_start_variable_type'),\n                  style: {\n                    width: 90,\n                  },\n                },\n              ]}\n              readonly={readonly}\n              className=\"mb-[8px]\"\n            />\n            <FieldRows>\n              {field.map((item, index) => (\n                <FieldArrayItem\n                  key={item.key}\n                  hiddenRemove={readonly}\n                  onRemove={() => remove(index)}\n                >\n                  <div style={{ flex: 2 }}>\n                    <NodeInputNameField\n                      name={`${item.name}.name`}\n                      placeholder={I18n.t(\n                        'workflow_detail_node_input_entername',\n                      )}\n                      input={item.value.input}\n                      inputParameters={value}\n                      {...nameProps}\n                    />\n                  </div>\n                  <div style={{ flex: '3 1 90px', overflow: 'hidden' }}>\n                    <LoopOutputSelectField name={`${item.name}.input`} />\n                  </div>\n                </FieldArrayItem>\n              ))}\n            </FieldRows>\n          </Section>\n        );\n      }}\n    </FieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { BatchMode } from '@/nodes-v2/components/batch-mode';\nimport { useField, withField } from '@/form';\n\nexport const BatchModeField = withField<{}, string>(() => {\n  const { name: fieldName, value, onChange, onBlur } = useField<string>();\n  return (\n    <BatchMode\n      name={fieldName}\n      value={value}\n      onChange={e => {\n        onChange?.((e as React.ChangeEvent<HTMLInputElement>).target.value);\n        onBlur?.();\n      }}\n      onBlur={onBlur}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport const COLUMNS = [\n  {\n    label: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 148 },\n  },\n  { label: I18n.t('workflow_detail_end_output_value') },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type PropsWithChildren } from 'react';\n\nimport { generateInputJsonSchema } from '@coze-workflow/variable';\nimport {\n  getInputType,\n  getSortedInputParameters,\n  type ApiNodeDetailDTO,\n} from '@coze-workflow/nodes';\nimport {\n  useNodeTestId,\n  type InputValueVO,\n  type VariableMetaDTO,\n  type DTODefine,\n} from '@coze-workflow/base';\nimport { reporter } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport {\n  Section,\n  useField,\n  ColumnTitles,\n  withField,\n  SelectField,\n  SliderField,\n  FieldLayout,\n} from '@/form';\n\nimport { getCustomSetterProps } from '../../utils';\nimport { COLUMNS } from './constants';\n\ninterface InputsProps {\n  inputsDef: ApiNodeDetailDTO['inputs'];\n}\n\nconst CUSTOM_SETTER_MAP = {\n  Select: SelectField,\n  Slider: SliderField,\n};\n\nconst CUSTOM_SETTER_STYLE = {\n  Select: {\n    width: '100%',\n  },\n};\n\nconst renderCustomSetter = (\n  fieldDef: ApiNodeDetailDTO['inputs'][number],\n  customSetterProps: Record<string, unknown> & { key: string },\n  fieldName: string,\n) => {\n  const { title, name, required, description, label } = fieldDef;\n  const { key, ...setterProps } = customSetterProps;\n  const CustomSetter = CUSTOM_SETTER_MAP[key];\n\n  if (!CustomSetter) {\n    return null;\n  }\n\n  return (\n    <FieldLayout\n      label={title || label || name}\n      tooltip={description}\n      required={required}\n    >\n      <CustomSetter\n        {...setterProps}\n        name={`${fieldName}.${name}`}\n        style={CUSTOM_SETTER_STYLE[key]}\n      />\n    </FieldLayout>\n  );\n};\n\nexport const InputsKVField = withField(\n  ({ inputsDef }: InputsProps & PropsWithChildren) => {\n    const { name: fieldName } = useField<InputValueVO>();\n    const { getNodeSetterId } = useNodeTestId();\n\n    return (\n      <Section\n        title={I18n.t('workflow_detail_node_input')}\n        tooltip={I18n.t('workflow_detail_api_input_tooltip')}\n        testId={getNodeSetterId(fieldName)}\n        actions={[]}\n      >\n        <ColumnTitles columns={COLUMNS} />\n\n        <div className=\"flex flex-col gap-[8px]\">\n          {getSortedInputParameters(inputsDef)?.map(fieldDef => {\n            const { title, name, required, description, label } = fieldDef;\n\n            const { inputType, disabledTypes } = getInputType(\n              fieldDef as DTODefine.InputVariableDTO,\n            );\n\n            let jsonSchema: ReturnType<typeof generateInputJsonSchema>;\n            try {\n              jsonSchema = generateInputJsonSchema(fieldDef as VariableMetaDTO);\n            } catch (error) {\n              jsonSchema = undefined;\n              reporter.error({\n                message: 'workflow_plugin_generate_input_json_schema_error',\n                error,\n              });\n            }\n\n            const customSetterProps = getCustomSetterProps(fieldDef);\n            if (customSetterProps?.key) {\n              return renderCustomSetter(fieldDef, customSetterProps, fieldName);\n            }\n\n            return (\n              <ValueExpressionInputField\n                key={`${fieldName}.${name}`}\n                label={title || label || name}\n                tooltip={description}\n                required={required}\n                inputType={inputType}\n                disabledTypes={disabledTypes}\n                name={`${fieldName}.${name}`}\n                literalConfig={jsonSchema ? { jsonSchema } : undefined}\n              />\n            );\n          })}\n        </div>\n      </Section>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ViewVariableType } from '@coze-workflow/base';\n\nimport { Outputs } from '@/nodes-v2/components/outputs';\nimport { withField, useField, useWatch } from '@/form';\n\nexport interface OutputsProps {\n  id?: string;\n  name: string;\n  settingOnErrorPath?: string;\n  topLevelReadonly?: boolean;\n  disabledTypes?: ViewVariableType[];\n  title?: string;\n  tooltip?: React.ReactNode;\n  disabled?: boolean;\n  disabledTooltip?: string;\n  customReadonly?: boolean;\n  hiddenTypes?: ViewVariableType[];\n  noCard?: boolean;\n  jsonImport?: boolean;\n  allowAppendRootData?: boolean;\n  withDescription?: boolean;\n  withRequired?: boolean;\n  addItemTitle?: string;\n  allowDeleteLast?: boolean;\n  emptyPlaceholder?: string;\n  defaultCollapse?: boolean;\n  batchMode?: string;\n  needAppendChildWhenNodeIsPreset?: boolean;\n  /**\n   * Can the default value be configured?\n   */\n  withDefaultValue?: boolean;\n  /**\n   * Default expanded parameter name\n   */\n  defaultExpandParams?: string[];\n  /**\n   * Column widths such as 6:4 represent 6 copies of the name and 4 copies of the type\n   */\n  columnsRatio?: string;\n  maxLimit?: number;\n}\n\nexport const OutputsField = withField<OutputsProps>(\n  ({\n    id = 'outputs',\n    topLevelReadonly = false,\n    settingOnErrorPath = 'settingOnError.settingOnErrorIsOpen',\n    disabledTypes = [],\n    hiddenTypes,\n    title,\n    tooltip,\n    disabled,\n    customReadonly = false,\n    noCard,\n    jsonImport,\n    allowAppendRootData,\n    withDescription = true,\n    withRequired,\n    batchMode,\n    ...props\n  }: OutputsProps) => {\n    const { value, onChange, readonly, onBlur, errors } = useField();\n    const settingOnErrorIsOpen = useWatch(settingOnErrorPath);\n\n    return (\n      <Outputs\n        id={id}\n        value={value}\n        onChange={v => {\n          onChange?.(v);\n          // Guarantee that the verification is triggered when blur, and directly passing onBlur does not take effect\n          onBlur?.();\n        }}\n        title={title}\n        titleTooltip={tooltip}\n        topLevelReadonly={topLevelReadonly}\n        disabledTypes={disabledTypes}\n        hiddenTypes={hiddenTypes}\n        readonly={readonly || customReadonly}\n        disabled={disabled}\n        needErrorBody={settingOnErrorIsOpen}\n        noCard={noCard}\n        batchMode={batchMode}\n        jsonImport={jsonImport}\n        allowAppendRootData={allowAppendRootData}\n        withDescription={withDescription}\n        withRequired={withRequired}\n        errors={errors}\n        {...props}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { z } from 'zod';\nimport { type ZodError } from 'zod';\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\n/** Variable Naming Validation Rules */\nconst outputTreeValidationRule =\n  /^(?!.*\\b(true|false|and|AND|or|OR|not|NOT|null|nil|If|Switch)\\b)[a-zA-Z_][a-zA-Z_$0-9]*$/;\n\n/** check logic */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst OutputTreeMetaSchema = z.lazy(() =>\n  z\n    .object({\n      name: z\n        .string({\n          required_error: I18n.t('workflow_detail_node_error_name_empty'),\n        })\n        .min(1, I18n.t('workflow_detail_node_error_name_empty'))\n        .regex(\n          outputTreeValidationRule,\n          I18n.t('workflow_detail_node_error_format'),\n        ),\n      children: z.array(OutputTreeMetaSchema).optional(),\n    })\n    .passthrough(),\n);\n\nconst omitErrorBody = (value, isBatch) => {\n  // Batch, remove errorBody from children\n  if (isBatch) {\n    return value?.map(v => ({\n      ...v,\n      children: v?.children?.filter(c => c?.name !== 'errorBody'),\n    }));\n  }\n  // Single, remove errorBody from value\n  return value?.filter(v => v?.name !== 'errorBody');\n};\n\nexport const outputTreeMetaValidator: Validate = ({ value, formValues }) => {\n  /**\n   * Determine whether the error exception handling is turned on. If it is turned on, you need to filter out the errorBody and check it.\n   */\n  const { settingOnErrorIsOpen = false } = (get(formValues, 'settingOnError') ??\n    {}) as { settingOnErrorIsOpen?: boolean };\n\n  /**\n   * According to the batch data, whether it is currently in the batch state\n   */\n  const batchValue = get(formValues, 'batchMode');\n  const isBatch = batchValue === 'batch';\n\n  const parsed = z\n    .array(OutputTreeMetaSchema)\n    .safeParse(settingOnErrorIsOpen ? omitErrorBody(value, isBatch) : value);\n\n  if (!parsed.success) {\n    const errorText = JSON.stringify((parsed as { error: ZodError }).error);\n    return errorText;\n  }\n\n  return undefined;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { NodeConfigForm } from '../components';\n\n/**\n * Higher order component to add wrapper for node configuration form to component\n * This HOC provides a wrapper for the configuration form for the workflow node\n *\n * @Param Component - Component that needs to be wrapped by the configuration form\n * Returns a new component wrapped in NodeConfigForm\n */\nexport function withNodeConfigForm<\n  ComponentProps extends React.JSX.IntrinsicAttributes = {},\n>(Component: React.ComponentType<ComponentProps>) {\n  return function WithNodeConfigForm(props: ComponentProps) {\n    return (\n      <NodeConfigForm>\n        <Component {...props} />\n      </NodeConfigForm>\n    );\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNil } from 'lodash-es';\nimport { variableUtils } from '@coze-workflow/variable';\nimport { type ApiNodeDetailDTO } from '@coze-workflow/nodes';\nimport {\n  ValueExpressionType,\n  type ValueExpression,\n  ViewVariableType,\n} from '@coze-workflow/base';\n\n/**\n * Get the value of a custom setter\n * @param value\n * @param field\n * @returns\n */\nexport const getCustomVal = (\n  value: ValueExpression,\n  // Extracting the type of a single input item by number\n  field: ApiNodeDetailDTO['inputs'][number],\n) => {\n  if (!field?.type) {\n    return undefined;\n  }\n\n  if (value.type === ValueExpressionType.REF || value.content === undefined) {\n    return undefined;\n  }\n  const fieldType = variableUtils.DTOTypeToViewType(field.type, {\n    arrayItemType: field.schema?.type,\n    assistType: field.schema?.assistType,\n  });\n\n  if ([ViewVariableType.Number, ViewVariableType.Integer].includes(fieldType)) {\n    return Number(value.content);\n  }\n\n  if (ViewVariableType.Boolean === fieldType) {\n    return Boolean(value.content) || value.content !== 'false';\n  }\n\n  return value.content;\n};\n\n/**\n * Get the properties of the custom setter according to the plugin extension protocol\n */\nexport const getCustomSetterProps = (\n  input: ApiNodeDetailDTO['inputs'][number],\n) => {\n  const {\n    minimum,\n    maximum,\n    exclusiveMinimum,\n    exclusiveMaximum,\n    bizExtend,\n    enum: inputEnum,\n    enumVarNames,\n    defaultValue,\n  } = input || {};\n\n  const isEnum = !!inputEnum;\n  const isSlider = !isNil(minimum) && !isNil(maximum);\n\n  // For example, this plugin: cutout: store/plugin/7438917083918024738\n  if (isEnum) {\n    return {\n      key: 'Select',\n      optionList: inputEnum.map((item, index) => ({\n        value: item,\n        label: enumVarNames?.[index] || `${item}`,\n      })),\n      defaultValue,\n    };\n  }\n\n  // For example, this plugin: change: store/plugin/7438921446090637312\n  if (isSlider) {\n    let step = 1;\n    try {\n      step = JSON.parse(bizExtend || '{}').step;\n    } catch {\n      return undefined;\n    }\n    const min = exclusiveMinimum ? minimum + step : minimum;\n    const max = exclusiveMaximum ? maximum - step : maximum;\n    return {\n      key: 'Slider',\n      min,\n      max,\n      step,\n      defaultValue: defaultValue || min,\n    };\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { set } from 'lodash-es';\nimport {\n  type NodeContext,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  settingOnErrorInit,\n  settingOnErrorSave,\n  isSettingOnError,\n  isSettingOnErrorV2,\n} from '@coze-workflow/nodes';\nimport {\n  type StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { settingOnErrorValidate } from '@/nodes-v2/materials/setting-on-error-validate';\n\nconst updateNodeValidate = (node: WorkflowNodeRegistry) => {\n  set(node, 'formMeta.validate.settingOnError', settingOnErrorValidate);\n  return node;\n};\n\nconst updateNodePorts = (node: WorkflowNodeRegistry) => {\n  if (!isSettingOnErrorV2(node.type as StandardNodeType)) {\n    return node;\n  }\n\n  const meta = node.meta || {};\n\n  // It needs to be transformed into a dynamic channel.\n  if (!meta.useDynamicPort) {\n    set(node, 'meta', {\n      ...meta,\n      ...{\n        useDynamicPort: true,\n        defaultPorts: [{ type: 'input' }, { type: 'output' }],\n      },\n    });\n  }\n\n  return node;\n};\n\nconst updateNodeFormat = (node: WorkflowNodeRegistry) => {\n  const formMeta = node.formMeta as FormMetaV2;\n  const formatOnInit = formMeta?.formatOnInit;\n  const formatOnSubmit = formMeta?.formatOnSubmit;\n\n  set(node, 'formMeta.formatOnInit', (value, context: NodeContext) => {\n    const formated = formatOnInit ? formatOnInit(value, context) : value;\n\n    // Null value returned directly\n    if (!formated) {\n      return formated;\n    }\n\n    return {\n      ...formated,\n      ...settingOnErrorInit(value, context),\n    };\n  });\n\n  set(node, 'formMeta.formatOnSubmit', (_value, context: NodeContext) => {\n    const value = { ..._value };\n    const formated = formatOnSubmit ? formatOnSubmit(value, context) : value;\n    set(\n      formated,\n      'inputs.settingOnError',\n      settingOnErrorSave(value, context).settingOnError,\n    );\n    return formated;\n  });\n  return node;\n};\n\nexport const withSettingOnError = (\n  node: WorkflowNodeRegistry,\n): WorkflowNodeRegistry => {\n  if (!isSettingOnError(node.type as StandardNodeType)) {\n    return node;\n  }\n\n  updateNodeValidate(node);\n  updateNodeFormat(node);\n  updateNodePorts(node);\n\n  return node;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeRegistry } from '@coze-workflow/base';\n\nimport { withSettingOnError } from './with-setting-on-error';\n\nconst compose =\n  <T>(...fns: Array<(arg: T) => T>) =>\n  (x: T) =>\n    fns.reduce((v, f) => f(v), x);\n\nexport const nodeV2RegistryUtils = {\n  processNodeRegistry(node: WorkflowNodeRegistry) {\n    return compose(nodeV2RegistryUtils.setNodeSettingOnError)(node);\n  },\n  setNodeSettingOnError(node: WorkflowNodeRegistry) {\n    return withSettingOnError(node);\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport { inputTreeValidator } from '@coze-workflow/nodes';\n\n/**\n * tree input validator\n * @param param0\n * @returns\n */\nexport const createInputTreeValidator: () => Validate =\n  () =>\n  ({ value, context }) => {\n    const res = inputTreeValidator({\n      value,\n      context,\n      options: {},\n    });\n\n    if (res === true) {\n      return;\n    }\n\n    return res;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport { outputTreeValidator } from '@coze-workflow/nodes';\nimport { type ViewVariableMeta } from '@coze-workflow/base';\nexport interface OutputsValidatorOptions {\n  uniqueName?: boolean;\n}\nexport const createOutputsValidator =\n  (options: OutputsValidatorOptions): Validate<ViewVariableMeta[]> =>\n  ({ value, context }) =>\n    outputTreeValidator({\n      value,\n      options,\n      context,\n    }) as ReturnType<Validate<ViewVariableMeta[]>>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nexport interface CreateAnswerContentValidatorOptions {\n  fieldEnabled?: (...props: Parameters<Validate>) => boolean;\n}\nexport const createAnswerContentValidator =\n  (options?: CreateAnswerContentValidatorOptions): Validate<string> =>\n  props => {\n    if (options?.fieldEnabled && !options?.fieldEnabled?.(props)) {\n      return;\n    }\n    const { value } = props;\n    if (!value) {\n      return I18n.t('workflow_detail_node_error_empty');\n    }\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nexport const FormRender = () => <NodeConfigForm />;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { fireNodeTitleChange } from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const CONTINUE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeDataDTO } from '@coze-workflow/base';\n\nimport { type FormData } from './types';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (value: NodeDataDTO) => value;\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData): NodeDataDTO =>\n  value as unknown as NodeDataDTO;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DEFAULT_NODE_META_PATH } from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { CONTINUE_FORM_META } from './form-meta';\n\nexport const CONTINUE_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.Continue,\n  meta: {\n    isNodeEnd: true,\n    hideTest: true,\n    nodeDTOType: StandardNodeType.Continue,\n    defaultPorts: [{ type: 'input' }],\n    size: { width: 360, height: 67.86 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n  },\n  formMeta: CONTINUE_FORM_META,\n  getOutputPoints: () => [], // Continue node has no output\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function ContinueContent() {\n  return <></>;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { TerminatePlan } from './types';\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\nexport const TERMINATE_PLAN_PATH = 'inputs.terminatePlan';\nexport const ANSWER_CONTENT_PATH = 'inputs.content';\nexport const STREAMING_OUTPUT_PATH = 'inputs.streamingOutput';\nexport const defaultTerminalPlanOptions = [\n  {\n    value: TerminatePlan.ReturnVariables,\n    label: I18n.t('workflow_241111_02'),\n  },\n  {\n    value: TerminatePlan.UseAnswerContent,\n    label: I18n.t('workflow_241111_03'),\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TERMINATE_PLAN_PATH, defaultTerminalPlanOptions } from '../constants';\nimport { RadioSetterField } from '../../common/fields';\n\nexport const TerminatePlanField = () => (\n  <RadioSetterField\n    name={TERMINATE_PLAN_PATH}\n    options={{\n      direction: 'horizontal',\n      mode: 'button',\n      options: defaultTerminalPlanOptions,\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId, type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useWatch } from '@/form';\n\nimport { InputsParametersField, AnswerContentField } from '../common/fields';\nimport { TerminatePlan } from './types';\nimport {\n  INPUT_PATH,\n  TERMINATE_PLAN_PATH,\n  ANSWER_CONTENT_PATH,\n  STREAMING_OUTPUT_PATH,\n} from './constants';\nimport { TerminatePlanField } from './components/terminate-plan-field';\n\nexport const FormRender = withNodeConfigForm(() => {\n  const terminatePlan = useWatch<TerminatePlan>(TERMINATE_PLAN_PATH);\n  const inputParameters = useWatch<InputValueVO[]>(INPUT_PATH);\n\n  const { getNodeSetterId } = useNodeTestId();\n  const setterTestId = getNodeSetterId('');\n  return (\n    <>\n      <TerminatePlanField />\n      <InputsParametersField\n        name={INPUT_PATH}\n        title={I18n.t('workflow_detail_end_output')}\n        tooltip={I18n.t('workflow_detail_end_output_tooltip')}\n        isTree={true}\n        testId={setterTestId}\n      />\n      {terminatePlan === TerminatePlan.UseAnswerContent ? (\n        <AnswerContentField\n          editorFieldName={ANSWER_CONTENT_PATH}\n          switchFieldName={STREAMING_OUTPUT_PATH}\n          title={I18n.t('workflow_detail_end_answer')}\n          tooltip={I18n.t('workflow_detail_end_answer_tooltip')}\n          enableStreamingOutput\n          switchLabel={I18n.t('workflow_message_streaming_name')}\n          switchTooltip={I18n.t('workflow_message_streaming_tooltips')}\n          // Adapt to the old testId format\n          testId={`/${ANSWER_CONTENT_PATH.split('.').join('/')}`}\n          switchTestId={STREAMING_OUTPUT_PATH.split('.')?.at(-1)}\n          inputParameters={inputParameters}\n        />\n      ) : null}\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createAnswerContentValidator } from '@/node-registries/common/validators';\nimport { fireNodeTitleChange } from '@/node-registries/common/effects';\n\nimport { createInputsValidator } from '../common/fields';\nimport { type FormData, TerminatePlan } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nexport const END_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ...createInputsValidator(true),\n    ['inputs.content']: createAnswerContentValidator({\n      fieldEnabled: ({ formValues }) => {\n        const terminatePlan = get(formValues, 'inputs.terminatePlan');\n        return terminatePlan === TerminatePlan.UseAnswerContent;\n      },\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, set } from 'lodash-es';\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport { VariableTypeDTO } from '@coze-workflow/base';\n\nimport { type FormData, type NodeDataDTO, TerminatePlan } from './types';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: NodeDataDTO,\n  { playgroundContext }: NodeFormContext,\n) => {\n  const { isChatflow } = playgroundContext.globalState;\n\n  const finalValue = {\n    ...value,\n    inputs: {\n      ...value?.inputs,\n      content: get(value, 'inputs.content.value.content') as string | undefined,\n    },\n  };\n  // Set the initial value of each field\n  if (typeof finalValue.inputs.inputParameters === 'undefined') {\n    set(finalValue, 'inputs.inputParameters', [{ name: 'output' }]);\n  }\n  if (typeof finalValue.inputs.streamingOutput === 'undefined') {\n    set(finalValue, 'inputs.streamingOutput', isChatflow);\n  }\n  if (typeof finalValue.inputs.terminatePlan === 'undefined') {\n    set(\n      finalValue,\n      'inputs.terminatePlan',\n      isChatflow\n        ? TerminatePlan.UseAnswerContent\n        : TerminatePlan.ReturnVariables,\n    );\n  }\n  return finalValue;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData) => {\n  const nodeMeta = get(value, 'nodeMeta');\n  const { terminatePlan, inputParameters, streamingOutput, content } =\n    value.inputs ?? {};\n  if (terminatePlan === TerminatePlan.ReturnVariables) {\n    return {\n      nodeMeta,\n      inputs: {\n        terminatePlan,\n        inputParameters,\n      },\n    };\n  }\n  return {\n    nodeMeta,\n    inputs: {\n      terminatePlan,\n      streamingOutput,\n      inputParameters,\n      content: {\n        type: VariableTypeDTO.string,\n        value: {\n          type: 'literal',\n          content,\n        },\n      },\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DEFAULT_NODE_META_PATH } from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { END_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const END_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.End,\n  meta: {\n    isNodeEnd: true,\n    deleteDisable: true,\n    copyDisable: true,\n    headerReadonly: true,\n    nodeDTOType: StandardNodeType.End,\n    size: { width: 360, height: 78.2 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    defaultPorts: [{ type: 'input' }],\n    helpLink: '/open/docs/guides/start_end_node',\n  },\n  formMeta: END_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { InputParameters } from '../common/components';\nimport { TerminatePlanContent } from './components/terminate-plan-content';\n\nexport function EndContent() {\n  return (\n    <>\n      <InputParameters label={I18n.t('workflow_detail_node_output')} />\n      <TerminatePlanContent />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type InputValueVO,\n  type InputValueDTO,\n  type ValueExpressionDTO,\n  type NodeDataDTO as BaseNodeDataDTO,\n} from '@coze-workflow/base';\n\nexport enum TerminatePlan {\n  ReturnVariables = 'returnVariables',\n  UseAnswerContent = 'useAnswerContent',\n}\n\nexport type FormData = {\n  inputs: {\n    inputParameters: InputValueVO[];\n    terminatePlan?: TerminatePlan;\n    streamingOutput?: boolean;\n    content?: string;\n  };\n} & Pick<BaseNodeDataDTO, 'nodeMeta'>;\n\nexport interface NodeDataDTO {\n  inputs: {\n    inputParameters?: InputValueDTO[];\n    terminatePlan?: TerminatePlan;\n    streamingOutput?: boolean;\n    content?: ValueExpressionDTO;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum MenuType {\n  Nodes = 'nodes',\n  Variables = 'variables',\n}\n\nexport enum DropdownType {\n  /**\n   * user input evocation\n   */\n  Input = 'Input',\n  /**\n   * click variable arousal\n   */\n  Update = 'Update',\n}\n\nexport const iconCozWarningCircleFillPaletteSvg = (\n  color: string,\n) => `<svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" fill=\"none\"  xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M7.0026 13.4154C10.5464 13.4154 13.4193 10.5425 13.4193 6.9987C13.4193 3.45487 10.5464 0.582031 7.0026 0.582031C3.45878 0.582031 0.585938 3.45487 0.585938 6.9987C0.585938 10.5425 3.45878 13.4154 7.0026 13.4154Z\" fill=\"#FF7300\"/>\n<path d=\"M6.9974 4.08203C6.67523 4.08203 6.41406 4.3432 6.41406 4.66536V7.58203C6.41406 7.9042 6.67523 8.16536 6.9974 8.16536C7.31956 8.16536 7.58073 7.9042 7.58073 7.58203V4.66536C7.58073 4.3432 7.31956 4.08203 6.9974 4.08203Z\" fill=\"white\"/>\n<path d=\"M6.9974 8.7487C6.67523 8.7487 6.41406 9.00987 6.41406 9.33203C6.41406 9.6542 6.67523 9.91537 6.9974 9.91537C7.31956 9.91537 7.58073 9.6542 7.58073 9.33203C7.58073 9.00987 7.31956 8.7487 6.9974 8.7487Z\" fill=\"white\"/>\n</svg>\n`;\n\nexport const iconCozFolderUrlSvg = (\n  color: string,\n) => `<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\"  xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M2.00008 1.33301C1.2637 1.33301 0.666748 1.92996 0.666748 2.66634V12.6663C0.666748 13.4027 1.2637 13.9997 2.00008 13.9997H14.0001C14.7365 13.9997 15.3334 13.4027 15.3334 12.6663V3.99967C15.3334 3.26329 14.7365 2.66634 14.0001 2.66634H8.00008L7.05727 1.72353C6.80722 1.47348 6.46809 1.33301 6.11446 1.33301H2.00008ZM8.00008 3.99967C7.64646 3.99967 7.30732 3.8592 7.05727 3.60915L6.11446 2.66634L2.00008 2.66634L2.00008 12.6663H14.0001V3.99967H8.00008Z\" fill=\"${color}\" fill-opacity=\"0.9\" style=\"fill:${color};fill-opacity:0.9;\"/>\n</svg>\n`;\n\nexport const iconCozPeopleUrlSvg = (\n  color: string,\n) => `<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\"  xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M6 8.66634H10C11.841 8.66634 14 9.95205 14 12.2663V13.333C14 14.0663 13.4 14.6663 12.6667 14.6663H3.33333C2.6 14.6663 2 14.0663 2 13.333V12.2663C2 9.95399 4.15905 8.66634 6 8.66634ZM12.6667 13.333V12.2219C12.6667 10.8209 11.2473 9.99967 10 9.99967H6C4.77998 9.99967 3.33333 10.7808 3.33333 12.2219V13.333H12.6667ZM8 7.99967C6.15905 7.99967 4.66667 6.50729 4.66667 4.66634C4.66667 2.82539 6.15905 1.33301 8 1.33301C9.84095 1.33301 11.3333 2.82539 11.3333 4.66634C11.3333 6.50729 9.84095 7.99967 8 7.99967ZM8 6.66634C9.10457 6.66634 10 5.77091 10 4.66634C10 3.56177 9.10457 2.66634 8 2.66634C6.89543 2.66634 6 3.56177 6 4.66634C6 5.77091 6.89543 6.66634 8 6.66634Z\" fill=\"${color}\" fill-opacity=\"0.9\" style=\"fill:${color};fill-opacity:0.9;\"/>\n</svg>\n`;\nexport const iconCozSettingUrlSvg = (\n  color: string,\n) => `<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2.88563 13.156L2.67821 12.9301C1.95205 12.1391 1.40724 11.1957 1.08784 10.1654L0.997803 9.875L2.36317 8.00027L0.997803 6.12554L1.08784 5.83509C1.40724 4.80479 1.95205 3.86139 2.67821 3.07043L2.88563 2.84451L5.18017 3.0953L6.11215 0.970749L6.41099 0.90347C6.92883 0.786888 7.46082 0.727539 8.00006 0.727539C8.5393 0.727539 9.07129 0.786888 9.58912 0.90347L9.88797 0.970749L10.8199 3.0953L13.1145 2.84451L13.3219 3.07043C14.0481 3.86139 14.5929 4.80479 14.9123 5.83509L15.0023 6.12554L13.6369 8.00027L15.0023 9.875L14.9123 10.1654C14.5929 11.1957 14.0481 12.1391 13.3219 12.9301L13.1145 13.156L10.8199 12.9052L9.88797 15.0298L9.58912 15.0971C9.07129 15.2136 8.5393 15.273 8.00006 15.273C7.46082 15.273 6.92883 15.2136 6.41099 15.0971L6.11215 15.0298L5.18017 12.9052L2.88563 13.156ZM5.20903 11.6827C5.63977 11.6356 6.05124 11.8735 6.22531 12.2704L6.97227 13.9731C7.30917 14.0313 7.65258 14.0608 8.00006 14.0608C8.34754 14.0608 8.69095 14.0313 9.02785 13.9731L9.77481 12.2704C9.94888 11.8735 10.3603 11.6356 10.7911 11.6827L12.6272 11.8834C13.0707 11.3496 13.4204 10.7431 13.659 10.0895L12.5628 8.58427C12.3093 8.23618 12.3093 7.76428 12.5628 7.41619L13.659 5.91097C13.4204 5.25737 13.0707 4.65084 12.6272 4.11707L10.7911 4.31776C10.3603 4.36484 9.94888 4.12691 9.77481 3.7301L9.02785 2.02731C8.69095 1.96913 8.34754 1.93962 8.00006 1.93962C7.65258 1.93962 7.30917 1.96913 6.97227 2.02731L6.22531 3.7301C6.05124 4.12691 5.63977 4.36484 5.20903 4.31776L3.37288 4.11707C2.92942 4.65084 2.57977 5.25737 2.34108 5.91097L3.43733 7.41619C3.69085 7.76428 3.69085 8.23618 3.43733 8.58427L2.34108 10.0895C2.57977 10.7431 2.92942 11.3496 3.37288 11.8834L5.20903 11.6827ZM8.00006 11.0306C6.3322 11.0306 4.9813 9.6732 4.9813 8.00026C4.9813 6.32732 6.3322 4.96996 8.00006 4.96996C9.66792 4.96996 11.0188 6.32732 11.0188 8.00026C11.0188 9.6732 9.66792 11.0306 8.00006 11.0306ZM8.00006 9.81849C8.99719 9.81849 9.8067 9.0051 9.8067 8.0003C9.8067 6.9955 8.99719 6.18212 8.00006 6.18212C7.00293 6.18212 6.19342 6.9955 6.19342 8.0003C6.19342 9.0051 7.00293 9.81849 8.00006 9.81849Z\" fill=\"${color}\" fill-opacity=\"0.9\" style=\"fill:${color};fill-opacity:0.9;\"/>\n</svg>\n`;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MutableRefObject, useRef } from 'react';\n\nimport { last } from 'lodash-es';\nimport type { WorkflowVariableFacade } from '@coze-workflow/variable/src/core/workflow-variable-facade';\nimport {\n  allGlobalVariableKeys,\n  TRANS_WORKFLOW_VARIABLE_SOURCE,\n  GlobalVariableKey,\n} from '@coze-workflow/variable';\nimport type { SelectionEnlargerSpec } from '@coze-editor/editor';\nimport type { EditorState, Transaction } from '@codemirror/state';\nimport { syntaxTree } from '@codemirror/language';\n\nimport type { VariableWithNodeInfo, InputVariableInfo } from './types';\nimport {\n  iconCozWarningCircleFillPaletteSvg,\n  iconCozFolderUrlSvg,\n  iconCozPeopleUrlSvg,\n  iconCozSettingUrlSvg,\n} from './constants';\n\nexport function findInputVariable(\n  availableVariables: VariableWithNodeInfo[],\n  fieldPartInfo: {\n    nodePart: string;\n    globalVariableKey: string;\n    /**\n     * Process variable field name\n     */\n    fieldPart: string;\n    /**\n     * Global variable field name\n     */\n    parsedKeyPath: string[];\n  },\n  matchedVariable?: WorkflowVariableFacade,\n): InputVariableInfo {\n  const { globalVariableKey, nodePart, fieldPart, parsedKeyPath } =\n    fieldPartInfo;\n  const isValid = !!matchedVariable;\n  const res = {\n    iconUrl: '',\n    nodeTitle: '',\n    isValid,\n    globalVariableKey,\n    parsedKeyPath: '',\n    isVariableExist: false,\n  };\n\n  availableVariables.forEach(variable => {\n    const nodePartEqual = variable.expressionPath.source === nodePart;\n    if ((!res.iconUrl || !res.nodeTitle) && nodePartEqual) {\n      res.iconUrl = variable.iconUrl;\n      res.nodeTitle = variable.nodeTitle;\n      res.isVariableExist = true;\n    }\n\n    const curParsedKeyPath = parsedKeyPath?.join('.');\n\n    res.parsedKeyPath = globalVariableKey ? curParsedKeyPath : fieldPart;\n  });\n\n  return res;\n}\n\nexport function getVariableRanges(state: EditorState) {\n  const ranges: SelectionEnlargerSpec[] = [];\n\n  const tree = syntaxTree(state);\n  const cursor = tree.cursor();\n\n  do {\n    if (\n      cursor.name === 'Interpolation' &&\n      cursor.node.firstChild?.name === '{{' &&\n      cursor.node.lastChild?.name === '}}'\n    ) {\n      const from = cursor.node.firstChild.to;\n      const to = cursor.node.lastChild.from;\n      const content = state.sliceDoc(from, to);\n      let matches = content.match(\n        `^(${TRANS_WORKFLOW_VARIABLE_SOURCE}\\\\d+)\\\\.?`,\n      );\n      allGlobalVariableKeys?.forEach((varKey: string) => {\n        const globalVariableRegexStr = `^(${varKey})`;\n        const curMatch = content.match(globalVariableRegexStr);\n        if (curMatch) {\n          matches = curMatch;\n        }\n      });\n\n      if (matches) {\n        const { length } = matches[0];\n\n        ranges.push({\n          source: {\n            from: cursor.from,\n            to: from + length,\n          },\n          target: {\n            from: cursor.from,\n            to: cursor.to,\n          },\n        });\n\n        ranges.push({\n          source: {\n            from: to,\n            to: cursor.node.lastChild.to,\n          },\n          target: {\n            from: cursor.from,\n            to: cursor.to,\n          },\n        });\n      }\n    }\n  } while (cursor.next());\n\n  return ranges;\n}\n\n/**\n * Convert string path to key path array\n * - Enter: '[\"Ob +.\\\" .j \"] [\" child \"]'\n * - Output: ['Ob +. \".j', 'child']\n */\nexport function convertStrPathToKeyPath(str: string): string[] {\n  // Remove square brackets at both ends of string\n  str = str.slice(2, -2);\n  const parts = str.split('\"][\"');\n\n  return parts.map(part => `${part}`);\n}\n\nconst SELECTED_OPTION_CLASSNAME = 'coz-mg-primary';\ninterface OptionsInfo {\n  elements: Element[];\n  selectedIndex: number;\n  selectedElement?: Element;\n}\nexport function getOptionInfoFromDOM(\n  root: Element | null,\n  classNames?: string,\n): OptionsInfo | undefined {\n  if (!root) {\n    return;\n  }\n\n  // Get all option elements\n  const foundNodes = root.querySelectorAll(classNames ?? '.semi-list-item');\n\n  if (foundNodes.length === 0) {\n    return;\n  }\n\n  const optionElements = [...foundNodes];\n\n  // Find the currently highlighted option\n  const selectedIndex = optionElements.findIndex(element =>\n    element.classList.contains(SELECTED_OPTION_CLASSNAME),\n  );\n\n  return {\n    elements: optionElements,\n    selectedIndex,\n    selectedElement: optionElements[selectedIndex],\n  };\n}\n\nexport function selectNodeByIndex(elements: Element[], index: number) {\n  const newSelectedElement = elements[index];\n\n  if (!newSelectedElement) {\n    return;\n  }\n\n  // remove old selected class\n  elements.forEach(element => {\n    if (element.classList.contains(SELECTED_OPTION_CLASSNAME)) {\n      element.classList.remove(SELECTED_OPTION_CLASSNAME);\n    }\n  });\n\n  newSelectedElement.classList.add(SELECTED_OPTION_CLASSNAME);\n\n  newSelectedElement.scrollIntoView({\n    behavior: 'smooth',\n    block: 'nearest',\n  });\n}\n\nexport function useLatest<T>(value: T): MutableRefObject<T> {\n  const ref = useRef(value);\n  ref.current = value;\n\n  return ref;\n}\n\nconst SKIP_SELECTION_CHANGE_USER_EVENT = 'api.skip-selection-change';\n\nexport function isSkipSelectionChangeUserEvent(tr: Transaction) {\n  return tr.isUserEvent(SKIP_SELECTION_CHANGE_USER_EVENT);\n}\n\nexport function getVariableInfoFromExpression(expression: string): {\n  nodeId: string;\n  nodeName: string;\n  /**\n   * Variable names containing., used only for process variables\n   */\n  nodeNameWithDot: string;\n  fieldPart: string;\n  fieldKeyPath: string[];\n  parsedKeyPath: string[];\n  globalVariableKey: string;\n} {\n  let globalVariableKey = '';\n\n  let nodeName = '';\n  let nodeNameWithDot = '';\n  let fieldPart;\n  let fieldKeyPath;\n  let parsedKeyPath;\n\n  // block_output_ specialised prefix for process variables, converted from block-output_\n  let matches = expression.match(\n    `^(${TRANS_WORKFLOW_VARIABLE_SOURCE}\\\\d+)\\\\.?`,\n  );\n  // Global variable format {{global_variable_app [\"aaa\"] [\"bbb\"]}}\n  allGlobalVariableKeys?.forEach((varKey: string) => {\n    const globalVariableRegexStr = `^(${varKey})`;\n    const curMatch = expression.match(globalVariableRegexStr);\n    if (curMatch) {\n      matches = curMatch;\n      globalVariableKey = varKey;\n    }\n  });\n  nodeNameWithDot = matches?.[0] as string;\n  nodeName = matches?.[1] as string;\n\n  const nodeId = last(nodeName?.split('_')) as string;\n\n  if (matches) {\n    fieldPart = expression.slice(nodeNameWithDot.length, expression.length);\n    parsedKeyPath = globalVariableKey ? convertStrPathToKeyPath(fieldPart) : [];\n\n    fieldKeyPath = globalVariableKey\n      ? [nodeName].concat(parsedKeyPath)\n      : [nodeId].concat(fieldPart.split('.'));\n  }\n\n  return {\n    nodeId,\n    nodeName,\n    nodeNameWithDot,\n    fieldPart,\n    fieldKeyPath,\n    parsedKeyPath,\n    globalVariableKey,\n  };\n}\n\nexport const getIconSvgString = (color = '#080D1E') => ({\n  delete: iconCozWarningCircleFillPaletteSvg(color),\n  [GlobalVariableKey.App]: iconCozFolderUrlSvg(color),\n  [GlobalVariableKey.System]: iconCozPeopleUrlSvg(color),\n  [GlobalVariableKey.User]: iconCozSettingUrlSvg(color),\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowVariableFacade } from '@coze-workflow/variable/src/core/workflow-variable-facade';\nimport { TRANS_WORKFLOW_VARIABLE_SOURCE } from '@coze-workflow/variable';\n\nimport { type VariableWithNodeInfo } from '../../components/variable-support/types';\n\ninterface ViewMetaWithUniqKey {\n  children: ViewMetaWithUniqKey[];\n  key: string;\n}\n\nexport const getVariableFieldKeys = ({ variable }): string => {\n  let keysString = '';\n\n  function traverse(obj: ViewMetaWithUniqKey) {\n    if (obj?.key) {\n      keysString += `${obj.key} `;\n    }\n    if (obj?.children && obj?.children?.length > 0) {\n      obj.children.forEach(child => traverse(child));\n    }\n  }\n\n  traverse(variable?.viewMetaWithUniqKey);\n  return keysString;\n};\n\nexport function useVariableWithNodeInfo(\n  variables: WorkflowVariableFacade[],\n  getNodeInfoInVariableMeta,\n): VariableWithNodeInfo[] {\n  return variables.map(variable => {\n    const nodeEntity: FlowNodeEntity = variable.node;\n    const nodeId = variable.groupInfo.key;\n    let nodeTitle = variable.groupInfo.label;\n    const iconUrl = variable.groupInfo.icon;\n    if (!variable.globalVariableKey) {\n      // The node name obtained here is the latest\n      const variableMeta = getNodeInfoInVariableMeta(nodeEntity);\n      nodeTitle = variableMeta?.nodeTitle ?? '';\n    }\n\n    // Process variable specialization logic because block-output is not a valid variable name\n    const source = variable.globalVariableKey\n      ? variable.expressionPath.source\n      : TRANS_WORKFLOW_VARIABLE_SOURCE +\n        (variable.expressionPath.keyPath?.[0] ?? '');\n\n    return {\n      keyString: getVariableFieldKeys({ variable }),\n      expressionPath: {\n        ...variable.expressionPath,\n        source,\n      },\n      nodeId,\n      iconUrl,\n      nodeTitle,\n      globalVariableKey: variable.globalVariableKey ?? '',\n    };\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum HttpMethod {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n  DELETE = 'DELETE',\n  PATCH = 'PATCH',\n  HEAD = 'HEAD',\n}\n\nexport enum AuthType {\n  BasicAuth = 'BASIC_AUTH',\n  Bearer = 'BEARER_AUTH',\n  Custom = 'CUSTOM_AUTH',\n}\n\nexport const authTypeToLabelKey = {\n  [AuthType.BasicAuth]: 'node_http_auth_basic',\n  [AuthType.Bearer]: 'node_http_auth_bearer',\n  [AuthType.Custom]: 'node_http_auth_custom',\n};\n\nexport const authTypeToField = {\n  [AuthType.BasicAuth]: 'basicAuthData',\n  [AuthType.Bearer]: 'bearerTokenData',\n  [AuthType.Custom]: 'customData',\n};\n\nexport enum CustomAuthAddToType {\n  Header = 'header',\n  Query = 'query',\n}\n\nexport enum BodyType {\n  Empty = 'EMPTY',\n  Json = 'JSON',\n  FormData = 'FORM_DATA',\n  FormUrlEncoded = 'FORM_URLENCODED',\n  RawText = 'RAW_TEXT',\n  Binary = 'BINARY',\n}\n\nexport const bodyTypeToField = {\n  [BodyType.Empty]: 'empty',\n  [BodyType.Json]: 'json',\n  [BodyType.FormData]: 'formData',\n  [BodyType.FormUrlEncoded]: 'formURLEncoded',\n  [BodyType.RawText]: 'rawText',\n  [BodyType.Binary]: 'binary',\n};\n\nexport const bodyTypeToLabel = {\n  [BodyType.Empty]: 'node_http_body_none',\n  [BodyType.Json]: 'node_http_body_json',\n  [BodyType.FormData]: 'node_http_body_form_data',\n  [BodyType.FormUrlEncoded]: 'node_http_body_form_urlencoded',\n  [BodyType.RawText]: 'node_http_body_raw_text',\n  [BodyType.Binary]: 'node_http_body_binary',\n};\n\nexport const contentTypeToBodyType = {\n  'text/plain': BodyType.RawText,\n  'multipart/form-data': BodyType.FormData,\n  'application/json': BodyType.Json,\n  'application/x-www-form-urlencoded': BodyType.FormUrlEncoded,\n  'application/octet-stream': BodyType.RawText,\n  Empty: BodyType.Empty,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\nexport const CONDITION_PATH = 'condition';\nexport const ELSE_PATH = 'else';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'outputList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'id',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { withField } from '@/form';\n\nexport const ElseField = withField(() => (\n  <FormCard\n    key={'FormCard'}\n    collapsible={false}\n    portInfo={{ portID: 'false', portType: 'output' }}\n    style={{\n      border: '1px solid rgba(var(--coze-stroke-6),var(--coze-stroke-6-alpha))',\n      background: 'rgba(var(--coze-bg-3),1)',\n      borderRadius: 8,\n      paddingLeft: 12,\n      margin: 0,\n    }}\n    headerStyle={{\n      marginBottom: 0,\n    }}\n    header={I18n.t('workflow_detail_condition_else')}\n  ></FormCard>\n));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState, useCallback } from 'react';\n\nimport { isEqual } from 'lodash-es';\nimport update from 'immutability-helper';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { useAutoSyncRenameData } from '@coze-workflow/variable';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONDITION_PATH } from '@/node-registries/if/constants';\nimport { useNodeRenderData, useUpdateSortedPortLines } from '@/hooks';\nimport { useConditionValidate } from '@/form-extensions/setters/condition/multi-condition/validate/use-condition-validate';\nimport {\n  type ConditionValue,\n  Logic,\n  type ConditionValueWithUid,\n  type ConditionBranchValueWithUid,\n} from '@/form-extensions/setters/condition/multi-condition/types';\nimport { CustomDragLayer } from '@/form-extensions/setters/condition/multi-condition/draggable/custom-drag-layer';\nimport { ConditionDraggableContainer } from '@/form-extensions/setters/condition/multi-condition/draggable/container';\nimport { DraggableConditionBranchPreview } from '@/form-extensions/setters/condition/multi-condition/draggable/condition-branch-preview';\nimport { DraggableConditionBranch } from '@/form-extensions/setters/condition/multi-condition/draggable/condition-branch';\nimport { ConditionContextProvider } from '@/form-extensions/setters/condition/multi-condition/context';\nimport { ConditionHeader } from '@/form-extensions/setters/condition/multi-condition/condition-header';\n\ninterface ConditionProps {\n  value: ConditionValue;\n  readonly: boolean;\n  onChange: (v: ConditionValue) => void;\n}\n\nconst CONDITION_PORT_ID_PREFIX = 'true';\n\nexport function MultiCondition(props: ConditionProps): JSX.Element {\n  const { value = [], onChange, readonly } = props;\n  const node = useCurrentEntity();\n\n  const { getNodeTestId, concatTestId } = useNodeTestId();\n\n  const [branches, setBranches] = useState<ConditionValueWithUid>(\n    (value ?? []).map((item, index) => ({\n      ...item,\n      uid: index,\n    })),\n  );\n\n  const [draggingBranchUid, setDraggingBranchUid] = useState<\n    number | undefined\n  >();\n  const { expanded } = useNodeRenderData();\n\n  const calcPortId = (index: number) => {\n    if (index === 0) {\n      return CONDITION_PORT_ID_PREFIX;\n    } else {\n      return `${CONDITION_PORT_ID_PREFIX}_${index}`;\n    }\n  };\n\n  const updateSortedPortLines = useUpdateSortedPortLines(calcPortId);\n\n  const {\n    validateResults,\n    initValidateResultsWithBranches,\n    validateAllBranches,\n  } = useConditionValidate();\n\n  useEffect(() => {\n    initValidateResultsWithBranches(value || []);\n  }, []);\n\n  // TODO Supplement Validated\n  // useEffect(() => {\n  //   //Monitor the canvas to save the form submission and perform an overall verification\n  //   const disposable = onFormValidate(() => {\n  //     validateAllBranches(branches);\n  //   });\n  //   return () => {\n  //     disposable.dispose();\n  //   };\n  // }, [branches]);\n\n  useEffect(() => {\n    if (typeof draggingBranchUid === 'undefined') {\n      validateAllBranches(branches);\n      onChange?.(\n        branches.map(item => ({\n          condition: item.condition,\n        })),\n      );\n    } else {\n      validateAllBranches(branches);\n    }\n  }, [branches, draggingBranchUid]);\n\n  useEffect(() => {\n    // Here we need to determine whether the external value is consistent with the branches in the state\n    // Update branches only when they are inconsistent to avoid endless loops\n    if (\n      !isEqual(\n        value,\n        branches.map(item => ({\n          condition: item.condition,\n        })),\n      )\n    ) {\n      setBranches(\n        (value ?? []).map((item, index) => ({\n          ...item,\n          uid: index,\n        })),\n      );\n    }\n  }, [value]);\n\n  useAutoSyncRenameData(branches, {\n    onDataRenamed: _branches => {\n      setBranches(_branches);\n    },\n  });\n\n  const handleBranchChange =\n    (index: number) => (branch: ConditionBranchValueWithUid) => {\n      setBranches(\n        branches.map((item, innerIndex) => {\n          if (innerIndex === index) {\n            return branch;\n          } else {\n            return item;\n          }\n        }),\n      );\n    };\n\n  const calcUid = () => {\n    const uidArr = (branches ?? []).reduce<number[]>((buf, branch) => {\n      const { uid } = branch;\n      if (uid) {\n        buf.push(uid);\n      }\n      return buf;\n    }, []);\n\n    return uidArr.length ? Math.max(...uidArr) + 1 : 1;\n  };\n\n  const handleAddBranch = () => {\n    setBranches(\n      branches.concat([\n        {\n          uid: calcUid(),\n          condition: {\n            logic: Logic.AND,\n            conditions: [\n              {\n                left: undefined,\n                operator: undefined,\n                right: undefined,\n              },\n            ],\n          },\n        },\n      ]),\n    );\n  };\n\n  const handleDeleteBranch = index => () => {\n    // Move the port to be deleted to the end so that the deletion does not affect other connection sequences\n    updateSortedPortLines(index, value.length);\n    setBranches(branches.filter((item, innerIndex) => innerIndex !== index));\n  };\n\n  const handleMoveBranch = useCallback(\n    (dragIndex: number, hoverIndex: number) => {\n      setBranches(prevBranches =>\n        update(prevBranches, {\n          $splice: [\n            [dragIndex, 1],\n            [hoverIndex, 0, prevBranches[dragIndex]],\n          ],\n        }),\n      );\n    },\n    [],\n  );\n\n  const handleDragEnd = (startIndex: number, endIndex: number) => {\n    setDraggingBranchUid(undefined);\n    // When the connection service recalculates the port, the dom may not have been updated yet, so add a delay here to ensure that the dom has been updated when the recalculation is completed\n    setTimeout(() => {\n      updateSortedPortLines(startIndex, endIndex);\n    }, 0);\n  };\n\n  const draggingBranch = (branches ?? []).find(\n    branch => branch.uid === draggingBranchUid,\n  );\n  const draggingIndex = (branches ?? []).findIndex(\n    branch => branch.uid === draggingBranchUid,\n  );\n\n  return (\n    <div className=\"mt-3\" style={{ borderBottomWidth: 0, paddingBottom: 0 }}>\n      <ConditionContextProvider\n        value={{\n          flowNodeEntity: node,\n          readonly,\n          expanded,\n          setterPath: concatTestId(getNodeTestId(), `/${CONDITION_PATH}`),\n        }}\n      >\n        {expanded ? <ConditionHeader onAdd={handleAddBranch} /> : null}\n        <ConditionDraggableContainer>\n          {branches?.map((branch, index) => (\n            <DraggableConditionBranch\n              key={branch.uid}\n              index={index}\n              isFirstBranch={index === 0}\n              showDraggable={branches.length > 1}\n              priority={branches.length > 1 ? index + 1 : undefined}\n              prefixName={\n                index === 0\n                  ? I18n.t('worklfow_condition_if', {}, 'If')\n                  : I18n.t('worklfow_condition_else_if', {}, 'Else if')\n              }\n              portId={calcPortId(index)}\n              branch={branch}\n              onChange={handleBranchChange(index)}\n              onDelete={handleDeleteBranch(index)}\n              deletable={branches.length > 1}\n              branchValidateResult={validateResults[index]}\n              onDragStart={setDraggingBranchUid}\n              onDragEnd={handleDragEnd}\n              onMoveBranch={handleMoveBranch}\n            />\n          ))}\n          <CustomDragLayer\n            preview={\n              typeof draggingBranchUid === 'undefined' ||\n              !draggingBranch ? null : (\n                <DraggableConditionBranchPreview\n                  index={draggingIndex}\n                  priority={draggingIndex + 1}\n                  prefixName={\n                    draggingIndex === 0\n                      ? I18n.t('worklfow_condition_if', {}, 'If')\n                      : I18n.t('worklfow_condition_else_if', {}, 'Else if')\n                  }\n                  portId={calcPortId(draggingIndex)}\n                  branch={draggingBranch}\n                />\n              )\n            }\n          />\n        </ConditionDraggableContainer>\n      </ConditionContextProvider>\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport {\n  type ConditionItem,\n  type ConditionValue,\n} from '@/form-extensions/setters/condition/multi-condition/types';\nimport { HiddenConditionItem } from '@/form-extensions/setters/condition/hidden-condition/condition-item';\n\ninterface ConditionProps {\n  value: ConditionValue;\n  onChange?: (v?: ConditionValue) => void;\n}\n\nexport const HiddenCondition: FC<ConditionProps> = props => {\n  const { value, onChange } = props;\n\n  const handleConditionItemChange: (\n    branchIndex: number,\n    conditionItemIndex: number,\n  ) => (data: ConditionItem) => void =\n    (branchIndex, conditionItemIndex) => conditionItem => {\n      const activeBranch = value?.[branchIndex];\n\n      const newConditions = activeBranch?.condition?.conditions?.map(\n        (item, subIndex) => {\n          if (subIndex === conditionItemIndex) {\n            return {\n              ...conditionItem,\n            };\n          } else {\n            return item;\n          }\n        },\n      );\n\n      onChange?.(\n        value?.map((branch, index) => {\n          if (index === branchIndex) {\n            return {\n              condition: {\n                ...branch.condition,\n                conditions: newConditions,\n              },\n            };\n          } else {\n            return branch;\n          }\n        }),\n      );\n    };\n\n  return (\n    <>\n      {value?.map((branch, branchIndex) =>\n        branch.condition.conditions.map((item, conditionItemIndex) => (\n          <HiddenConditionItem\n            data={item}\n            onDataChange={handleConditionItemChange(\n              branchIndex,\n              conditionItemIndex,\n            )}\n          />\n        )),\n      )}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useNodeRenderScene } from '@/hooks';\nimport type { ConditionValue } from '@/form-extensions/setters/condition/multi-condition/types';\nimport { useField, withField } from '@/form';\n\nimport { MultiCondition } from './multi-condition';\nimport { HiddenCondition } from './hidden-condition';\n\nexport const ConditionField = withField(() => {\n  const { value, onChange, readonly } = useField<ConditionValue>();\n\n  const { isNewNodeRender } = useNodeRenderScene();\n\n  if (isNewNodeRender) {\n    return <HiddenCondition value={value} onChange={onChange} />;\n  } else {\n    return (\n      <MultiCondition\n        value={value}\n        onChange={onChange}\n        readonly={readonly ?? false}\n      />\n    );\n  }\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport { OutputsField } from '../common/fields';\nimport { CONDITION_PATH, ELSE_PATH } from './constants';\nimport { ElseField } from './components/else';\nimport { ConditionField } from './components/condition';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <ConditionField name={CONDITION_PATH} hasFeedback={false} />\n\n    <ElseField name={ELSE_PATH} />\n\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('node_http_response_data')}\n      id=\"if-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { flatten } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\nimport { validateAllBranches } from '@/form-extensions/setters/condition/multi-condition/validate/validate';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { CONDITION_PATH } from './constants';\n\nexport const IF_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    [CONDITION_PATH]: ({ value, context }) => {\n      const { node, playgroundContext } = context;\n\n      const res = validateAllBranches(value, node, playgroundContext);\n\n      const msg = flatten(res).reduce((previousValue, currentValue) => {\n        let _previousValue = previousValue;\n        if (currentValue?.left?.message) {\n          _previousValue = _previousValue\n            ? `${_previousValue};${currentValue?.left?.message}`\n            : currentValue?.left?.message;\n        }\n\n        if (currentValue?.operator?.message) {\n          _previousValue = _previousValue\n            ? `${_previousValue};${currentValue?.operator?.message}`\n            : currentValue?.operator?.message;\n        }\n\n        if (currentValue?.right?.message) {\n          _previousValue = _previousValue\n            ? `${_previousValue};${currentValue?.right?.message}`\n            : currentValue?.right?.message;\n        }\n\n        return _previousValue;\n      }, '');\n\n      return msg ? msg : undefined;\n    },\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isEmpty, isNil } from 'lodash-es';\nimport type { NodeContext } from '@flowgram-adapter/free-layout-editor';\nimport { nodeUtils } from '@coze-workflow/nodes';\nimport { type NodeDataDTO, type ValueExpression } from '@coze-workflow/base';\n\nimport { type FormData } from './types';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (value: FormData, context: NodeContext) => {\n  if (!value) {\n    return {\n      condition: [\n        {\n          condition: {\n            logic: 2,\n            conditions: [\n              {\n                left: undefined,\n                operator: undefined,\n                right: undefined,\n              },\n            ],\n          },\n        },\n      ],\n    };\n  }\n\n  const { inputs, ...others } = value || {};\n\n  return {\n    ...others,\n    condition: !isNil(inputs?.branches)\n      ? (inputs?.branches ?? []).map((branch, index) => ({\n          condition: {\n            logic: branch.condition.logic,\n            conditions:\n              branch.condition?.conditions?.map(item => {\n                if (!('right' in item)) {\n                  return {\n                    operator: item.operator\n                      ? Number(item.operator)\n                      : item.operator,\n                    left: nodeUtils.refExpressionDTOToVO(item.left, context),\n                  };\n                }\n\n                return {\n                  operator: item.operator\n                    ? Number(item.operator)\n                    : item.operator,\n                  left: nodeUtils.refExpressionDTOToVO(item.left, context),\n                  right: nodeUtils.refExpressionDTOToVO(item.right, context),\n                };\n              }) || [],\n          },\n        }))\n      : undefined,\n  };\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (\n  value: FormData,\n  context: NodeContext,\n): NodeDataDTO => {\n  const { condition, ...others } = value || {};\n\n  const newValue: NodeDataDTO = {\n    ...(others as NodeDataDTO),\n  };\n\n  newValue.inputs = {};\n\n  if (condition && !isEmpty(condition)) {\n    newValue.inputs.branches = condition.map(branch => ({\n      condition: {\n        logic: branch.condition.logic,\n        conditions: branch.condition?.conditions?.map(item => {\n          const left = nodeUtils.refExpressionToValueDTO(\n            item.left as ValueExpression,\n            context,\n          );\n          const right = nodeUtils.refExpressionToValueDTO(\n            item.right as ValueExpression,\n            context,\n          );\n          return {\n            operator: item.operator,\n            left,\n            right,\n          };\n        }),\n      },\n    }));\n  }\n\n  return newValue;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { IF_FORM_META } from './form-meta';\n\nexport const IF_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.If,\n  meta: {\n    nodeDTOType: StandardNodeType.If,\n    style: {\n      width: 850,\n    },\n    size: { width: DEFAULT_NODE_SIZE.width, height: 116.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    useDynamicPort: true,\n    defaultPorts: [{ type: 'input' }],\n    helpLink: '/open/docs/guides/condition_node',\n  },\n  formMeta: IF_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Conditions } from '@/components/node-render/node-render-new/fields';\n\nexport function IfContent() {\n  return <Conditions />;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'data',\n    type: ViewVariableType.Image,\n  },\n  {\n    key: nanoid(),\n    name: 'msg',\n    type: ViewVariableType.String,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Suspense, lazy } from 'react';\n\nimport { useInputVariables } from '@/hooks';\nimport { withField } from '@/form';\n\nconst CanvasLazy = lazy(async () => {\n  const { Canvas: CanvasNode } = await import('./canvas/components/canvas');\n  return {\n    default: CanvasNode,\n  };\n});\n\nexport const Canvas = withField(props => {\n  /**\n   * useInputVariables internally uses useContext\n   * lazyLoad will cause context changes that cannot be monitored\n   * Get the variables in advance\n   */\n  const variables = useInputVariables({\n    needNullType: true,\n    needNullName: true,\n  });\n\n  return (\n    <Suspense fallback={<div>canvas loading...</div>}>\n      <CanvasLazy {...props} variables={variables} />\n    </Suspense>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { type InputValueVO, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Section } from '@/form';\n\nimport { InputsParametersField, OutputsField } from '../common/fields';\nimport { INPUT_PATH } from './constants';\nimport { Canvas } from './components';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <InputsParametersField\n      name={INPUT_PATH}\n      title={I18n.t('imageflow_canvas_element_set')}\n      tooltip={I18n.t('imageflow_canvas_elment_tooltip')}\n      paramsTitle={I18n.t('imageflow_canvas_element_name')}\n      expressionTitle={I18n.t('imageflow_canvas_element_desc')}\n      defaultValue={[]}\n      onAppend={() =>\n        ({\n          id: nanoid(),\n        } as unknown as InputValueVO)\n      }\n      disabledTypes={ViewVariableType.getComplement([\n        ViewVariableType.String,\n        ViewVariableType.Image,\n      ])}\n      // inputPlaceholder={inputPlaceholder}\n      literalDisabled={true}\n    />\n\n    <Section\n      title={I18n.t('imageflow_canvas_edit')}\n      tooltip={I18n.t('imageflow_canvas_desc')}\n    >\n      <Canvas name=\"inputs.canvasSchema\" />\n    </Section>\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('node_http_response_data')}\n      id=\"imageCanvas-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport {\n  variableUtils,\n  type WorkflowVariableService,\n} from '@coze-workflow/variable';\nimport {\n  type InputValueDTO,\n  type InputValueVO,\n  type NodeDataDTO,\n  type ValueExpression,\n  type ValueExpressionDTO,\n} from '@coze-workflow/base';\n\nimport { type FormData } from './types';\nimport { OUTPUTS } from './constants';\n\nexport const initialValue = {\n  width: 1920,\n  height: 1080,\n  objects: [],\n  backgroundColor: '#ffffffff',\n  background: '#ffffffff',\n  version: '6.0.0-rc2',\n};\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: NodeDataDTO,\n  context: NodeFormContext,\n) => {\n  if (!value) {\n    return {\n      inputs: {\n        inputParameters: [],\n        canvasSchema: JSON.stringify(initialValue),\n      },\n      outputs: OUTPUTS,\n    };\n  }\n  if (value?.inputs?.inputParameters) {\n    const { variableService } = context.playgroundContext;\n    const variableDTOToVO = (\n      dto?: ValueExpressionDTO,\n    ): ValueExpression | undefined =>\n      dto\n        ? variableUtils?.valueExpressionToVO(\n            dto,\n            variableService as WorkflowVariableService,\n          )\n        : undefined;\n\n    value.inputs.inputParameters = value.inputs.inputParameters.map(d => ({\n      ...d,\n      input: variableDTOToVO(d.input),\n    })) as unknown as InputValueDTO[];\n  }\n  return value;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (\n  value: FormData,\n  context: NodeFormContext,\n): NodeDataDTO => {\n  if (value?.inputs?.inputParameters) {\n    const { variableService } = context.playgroundContext;\n\n    const variableVOToDTO = (\n      name: string,\n      vo: ValueExpression,\n      id: string,\n    ): InputValueDTO =>\n      ({\n        name,\n        input: variableUtils.valueExpressionToDTO(\n          vo as unknown as ValueExpression,\n          variableService as WorkflowVariableService,\n          {\n            node: context?.node,\n          },\n        ),\n        id,\n      } as unknown as InputValueDTO);\n    value.inputs.inputParameters = value.inputs.inputParameters.map(d =>\n      variableVOToDTO(\n        d.name ?? '',\n        d.input,\n        (d as unknown as { id: string }).id,\n      ),\n    ) as unknown as InputValueVO[];\n  }\n  return value as unknown as NodeDataDTO;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const IMAGE_CANVAS_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    'inputs.inputParameters.*.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { IMAGE_CANVAS_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const IMAGE_CANVAS_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.ImageCanvas,\n  meta: {\n    nodeDTOType: StandardNodeType.ImageCanvas,\n    size: { width: 360, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    test,\n    helpLink: '/open/docs/guides/canvas_node',\n  },\n  formMeta: IMAGE_CANVAS_FORM_META,\n  variablesMeta: {\n    inputsPathList: [],\n    outputsPathList: ['outputs'],\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputs?.inputParameters;\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputParameters, Outputs } from '../common/components';\n\nexport function ImageCanvasContent() {\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\n\nimport { OutputsField } from '../common/fields';\n\nexport const FormRender = withNodeConfigForm(() => (\n  <OutputsField\n    id=\"input-node-output\"\n    name=\"outputs\"\n    title={I18n.t('workflow_detail_node_parameter_input')}\n    tooltip={I18n.t('workflow_241120_01')}\n    addItemTitle={I18n.t('workflow_add_input')}\n    withDescription\n    withRequired\n    allowDeleteLast\n    emptyPlaceholder={I18n.t('workflow_start_no_parameter')}\n    maxLimit={20}\n    hasFeedback={false}\n  />\n));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'input',\n    type: ViewVariableType.String,\n    required: true,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createOutputsValidator } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnSubmit } from './data-transformer';\nimport { OUTPUTS } from './constants';\n\nexport const INPUT_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    outputs: createOutputsValidator({ uniqueName: true }),\n  },\n\n  defaultValues: {\n    outputs: OUTPUTS,\n  } as any,\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { variableUtils } from '@coze-workflow/variable';\n\nimport { type FormData, type NodeDataDTO } from './types';\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData): NodeDataDTO =>\n  ({\n    ...value,\n    inputs: {\n      outputSchema: JSON.stringify(\n        value.outputs?.map(o => variableUtils.viewMetaToDTOMeta(o)) || [],\n      ),\n    },\n  } as unknown as NodeDataDTO);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n  WorkflowNodeVariablesMeta,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { INPUT_FORM_META } from './form-meta';\n\nexport const INPUT_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Input,\n  meta: {\n    nodeDTOType: StandardNodeType.Input,\n    size: { width: 360, height: 78.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    test,\n    helpLink: '/open/docs/guides/input_node',\n  },\n  variablesMeta: WorkflowNodeVariablesMeta.DEFAULT,\n  formMeta: INPUT_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties() {\n    return {};\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Outputs } from '../common/components';\n\nexport function InputContent() {\n  return <Outputs label={I18n.t('workflow_detail_node_parameter_input')} />;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, isNil } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\n\nconst MAX_LENGTH = 1000;\n\nexport const validateIntentsName = (\n  value?: { name?: string; id?: string },\n  intents?: { name?: string; id?: string }[],\n  name?: string,\n) => {\n  const data = get(value, 'name');\n  const namePath = name?.split('.') || [];\n  const idx = namePath[namePath.length - 1];\n  const names = intents?.map(item => item?.name);\n  if (!isNil(idx)) {\n    names?.splice(Number(idx), 1);\n  }\n\n  if (!data || data.trim() === '') {\n    return I18n.t('workflow_intent_matchlist_error1');\n  }\n\n  if (data.length > MAX_LENGTH) {\n    return I18n.t('workflow_intent_matchlist_error2');\n  }\n\n  if (names && names.includes(name)) {\n    return I18n.t(\n      'workflow_ques_ans_testrun_dulpicate',\n      {},\n      '',\n    );\n  }\n\n  return undefined;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { OutputsField } from '@/node-registries/common/fields';\n\nexport default function Outputs() {\n  return (\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('workflow_intent_output_tooltips')}\n      id=\"intent-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\nimport { INTENT_NODE_MODE } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\nexport const INPUT_CHAT_HISTORY_SETTING_ENABLE =\n  'inputs.chatHistorySetting.enableChatHistory';\n\nexport const INPUT_CHAT_HISTORY_SETTING_ROUND =\n  'inputs.chatHistorySetting.chatHistoryRound';\n\nexport const INTENT_MODE = 'intentMode';\n\nexport const MODEL = 'model';\n\nexport const INTENTS = 'intents';\nexport const QUICK_INTENTS = 'quickIntents';\nexport const SYSTEM_PROMPT = 'systemPrompt';\n\nexport const COLUMNS = [\n  {\n    label: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 148 },\n  },\n  { label: I18n.t('workflow_detail_end_output_value') },\n];\n\nexport const getDefaultOutputs = (intentMode: string) =>\n  [\n    {\n      key: nanoid(),\n      name: 'classificationId',\n      type: ViewVariableType.Integer,\n    },\n    intentMode === INTENT_NODE_MODE.STANDARD\n      ? {\n          key: nanoid(),\n          name: 'reason',\n          type: ViewVariableType.String,\n        }\n      : '',\n  ].filter(Boolean);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { INTENT_NODE_MODE } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { INTENT_MODE, MODEL } from '@/node-registries/intent/constants';\nimport { ModelSelectField } from '@/node-registries/common/fields';\nimport { useWatch } from '@/form';\n\nexport default function ModelSelect() {\n  const intentMode = useWatch({ name: INTENT_MODE });\n  const isShow = intentMode === INTENT_NODE_MODE.STANDARD;\n\n  return (\n    isShow && (\n      <ModelSelectField\n        required\n        name={MODEL}\n        title={I18n.t('workflow_detail_llm_model')}\n      />\n    )\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { INTENT_NODE_MODE } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { INTENT_MODE } from '@/node-registries/intent/constants';\nimport { RadioSetterField } from '@/node-registries/common/fields';\nexport default function ModeRadio() {\n  // will support soon\n  if (IS_OPEN_SOURCE) {\n    return null;\n  }\n\n  return (\n    <RadioSetterField\n      required\n      name={INTENT_MODE}\n      defaultValue={INTENT_NODE_MODE.MINIMAL}\n      options={{\n        key: 'questionParams.answer_type',\n        options: [\n          {\n            label: I18n.t('workflow_250117_03'),\n            value: INTENT_NODE_MODE.MINIMAL,\n          },\n          {\n            label: I18n.t('workflow_250117_04'),\n            value: INTENT_NODE_MODE.STANDARD,\n          },\n        ],\n      }}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { forwardRef } from 'react';\n\nimport classNames from 'classnames';\nimport { type FieldError } from '@flowgram-adapter/free-layout-editor';\nimport { IconHandle } from '@douyinfe/semi-icons';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { IconCozMinusCircle } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { ExpressionEditor } from '@/nodes-v2/components/expression-editor';\nimport { useField, withField } from '@/form';\n\nimport styles from '../index.module.less';\n\nexport interface OptionItemProps {\n  index?: number;\n  optionName: string;\n  content: string;\n  portId?: string;\n  canDrag?: boolean;\n  readonly?: boolean;\n  className?: string;\n  disableDelete?: boolean;\n  showOptionName?: boolean;\n  optionPlaceholder?: string;\n  optionEnableInterpolation?: boolean;\n  onChange?: (val: string) => void;\n  onDelete?: () => void;\n  errors?: FieldError[];\n  name?: string;\n  onFocus?: () => void;\n  onBlur?: () => void;\n  isField?: boolean;\n  testIdPath?: string;\n}\n\nconst Item = (props: OptionItemProps) => {\n  const {\n    content,\n    portId,\n    readonly = false,\n    disableDelete,\n    onChange,\n    onDelete,\n    optionPlaceholder,\n    optionEnableInterpolation,\n    errors,\n    onFocus,\n    onBlur,\n    testIdPath,\n    name = '',\n  } = props;\n\n  const { getNodeSetterId, concatTestId } = useNodeTestId();\n\n  return (\n    <div className=\"w-full\">\n      <div className=\"flex items-center space-x-1 w-full min-h-[24px]\">\n        {!readonly ? (\n          <ExpressionEditor\n            name={name}\n            testId={testIdPath}\n            value={content}\n            onChange={val => {\n              onChange?.(val);\n            }}\n            onFocus={() => onFocus?.()}\n            onBlur={() => onBlur?.()}\n            isError={errors && errors?.length > 0}\n            readonly={readonly}\n            minRows={1}\n            placeholder={optionPlaceholder}\n            disableSuggestion={!optionEnableInterpolation}\n            className=\"!p-[4px]\"\n            containerClassName={classNames(\n              '!rounded-[6px]',\n              styles['option-expression-editor'],\n              !optionEnableInterpolation\n                ? styles['expression-editor-no-interpolation']\n                : '',\n            )}\n          />\n        ) : (\n          <div className=\"w-full\">{content}</div>\n        )}\n\n        <div>\n          {onDelete && !readonly ? (\n            <IconButton\n              size=\"small\"\n              color=\"secondary\"\n              data-testid={concatTestId(\n                getNodeSetterId('answer-option-item-delete'),\n                portId || '',\n              )}\n              className={classNames('flex', {\n                'cursor-pointer': !disableDelete,\n                'cursor-not-allowed': disableDelete,\n                'text-[--semi-color-tertiary-active]': disableDelete,\n              })}\n              onClick={() => {\n                if (disableDelete) {\n                  return;\n                }\n                onDelete();\n              }}\n              icon={<IconCozMinusCircle className=\"text-sm\" />}\n            />\n          ) : null}\n        </div>\n      </div>\n\n      <FormItemFeedback errors={errors} />\n    </div>\n  );\n};\n\nconst ItemField = withField((props: OptionItemProps) => {\n  const { onBlur, onFocus, errors } = useField();\n\n  return <Item {...props} errors={errors} onFocus={onFocus} onBlur={onBlur} />;\n});\n\nexport const OptionItem = forwardRef<HTMLDivElement, OptionItemProps>(\n  (props, dragRef) => {\n    const {\n      canDrag,\n      portId,\n      readonly = false,\n      className,\n      optionName,\n      showOptionName,\n      isField,\n      name,\n    } = props;\n\n    const { getNodeSetterId, concatTestId } = useNodeTestId();\n\n    return (\n      <div\n        className={classNames('flex items-start space-x-1 text-xs', className)}\n      >\n        <div className=\"flex w-4 min-w-4 shrink-0 mt-[4px]\">\n          {canDrag ? (\n            <IconHandle\n              data-testid={concatTestId(\n                getNodeSetterId('answer-option-item-handle'),\n                portId || '',\n              )}\n              data-disable-node-drag=\"true\"\n              className={classNames({\n                'cursor-move': !readonly,\n                'pointer-events-none': readonly,\n              })}\n              ref={dragRef}\n              style={{ color: '#aaa' }}\n            />\n          ) : null}\n        </div>\n        {showOptionName ? (\n          <div className=\"break-keep min-w-[75px] mt-[5px]\">{optionName}</div>\n        ) : null}\n\n        {isField && name ? (\n          <ItemField {...props} name={name} hasFeedback={false} />\n        ) : (\n          <Item {...props} />\n        )}\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { isNil } from 'lodash-es';\nimport update from 'immutability-helper';\nimport classNames from 'classnames';\nimport {\n  MINIMAL_INTENT_ITEMS,\n  STANDARD_INTENT_ITEMS,\n  INTENT_NODE_MODE,\n} from '@coze-workflow/nodes';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport {\n  INTENT_MODE,\n  INTENTS,\n  QUICK_INTENTS,\n} from '@/node-registries/intent/constants';\nimport { useUpdateSortedPortLines } from '@/hooks';\nimport {\n  calcPortId,\n  convertNumberToLetters,\n} from '@/form-extensions/setters/answer-option/utils';\nimport { useField, withField, Section, useWatch } from '@/form';\nimport { SortableList } from '@/components/sortable-list';\n\nimport { type IntentsType } from '../../types';\nimport { OptionItem } from './option-item';\n\ninterface Props {\n  /** Whether to display the title line */\n  showTitleRow?: boolean;\n\n  /** Whether to display option labels */\n  showOptionName?: boolean;\n\n  /** Option placeholder */\n  optionPlaceholder?: string;\n\n  /** Default branch name */\n  defaultOptionText?: string;\n\n  /** Option whether to allow interpolation */\n  optionEnableInterpolation?: boolean;\n\n  /** Option maximum quantity limit, default value is integer maximum */\n  maxItems?: number;\n\n  /** New button style */\n  addButtonClassName?: string;\n\n  /** Display Forbid Add Tooltip */\n  showDisableAddTooltip?: boolean;\n  customDisabledAddTooltip?: string;\n  customClassName?: string;\n}\n\nconst IntentsField = withField((props: Props) => {\n  const { value, onChange, readonly, name } = useField<IntentsType>();\n\n  const {\n    showTitleRow = true,\n    showOptionName = true,\n    optionPlaceholder = '',\n    defaultOptionText = '',\n    optionEnableInterpolation,\n    maxItems = Number.MAX_SAFE_INTEGER,\n    addButtonClassName = '',\n    showDisableAddTooltip = true,\n    customDisabledAddTooltip,\n    customClassName,\n  } = props;\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const handleChange = val => {\n    onChange(val);\n  };\n\n  const updateSortedPortLines = useUpdateSortedPortLines(calcPortId);\n\n  const onItemDelete = (index: number) => {\n    // Move the port to be deleted to the end so that the deletion does not affect other connection sequences\n    updateSortedPortLines(index, value.length);\n\n    const newVal = update(value, { $splice: [[index, 1]] });\n    handleChange(newVal);\n  };\n\n  const onItemChange = (val: string, index: number) => {\n    const newVal = update(value, {\n      [index]: {\n        name: { $set: val },\n      },\n    });\n\n    handleChange(newVal);\n  };\n\n  const AddActionButton = (\n    <IconButton\n      className={classNames('absolute right-3 top-3', {\n        [addButtonClassName]: addButtonClassName,\n      })}\n      color=\"highlight\"\n      size=\"small\"\n      disabled={readonly || value.length >= maxItems}\n      data-testid={getNodeSetterId('answer-option-add-btn')}\n      // Solve the problem that onClick does not trigger due to Button displacement\n      onMouseDown={() => {\n        handleChange([...value, { name: '' }]);\n      }}\n      icon={<IconCozPlus className=\"text-sm\" />}\n    />\n  );\n\n  return (\n    <div\n      className={\n        !isNil(customClassName)\n          ? classNames({\n              [customClassName]: customClassName,\n            })\n          : undefined\n      }\n    >\n      {showTitleRow ? (\n        <div className=\"flex items-center text-xs text-[#1D1C23] opacity-60 h-7\">\n          <div className={'ml-1 w-[71px]'}>\n            {I18n.t('workflow_ques_ans_type_option_title', {}, 'options')}\n          </div>\n          <div className={'ml-6'}>\n            {I18n.t('workflow_ques_ans_type_option_content', {}, 'content')}\n          </div>\n        </div>\n      ) : null}\n\n      <SortableList\n        value={value}\n        onChange={handleChange}\n        onDragEnd={updateSortedPortLines}\n        renderItem={(item, index, dragOption) => {\n          const { dragRef, isPreview } = dragOption || {};\n\n          return (\n            <OptionItem\n              name={`${name}.${index}`}\n              testIdPath={`/${name}`}\n              ref={dragRef}\n              index={index}\n              content={item.name}\n              onChange={val => onItemChange(val, index)}\n              portId={isPreview ? undefined : calcPortId(index)}\n              optionName={convertNumberToLetters(index)}\n              onDelete={!isPreview ? () => onItemDelete(index) : undefined}\n              disableDelete={value.length <= 1}\n              canDrag\n              readonly={readonly}\n              showOptionName={showOptionName}\n              optionPlaceholder={optionPlaceholder}\n              optionEnableInterpolation={optionEnableInterpolation}\n              isField\n            />\n          );\n        }}\n      />\n      <OptionItem\n        className=\"mt-2\"\n        content={defaultOptionText}\n        optionName={I18n.t('workflow_ques_ans_type_option_other', {}, 'other')}\n        portId=\"default\"\n        readonly\n        showOptionName={showOptionName}\n        optionPlaceholder={optionPlaceholder}\n      />\n\n      <div className=\"mt-2 answer-option-add-button\">\n        {showDisableAddTooltip && value.length >= maxItems ? (\n          <Tooltip\n            content={\n              customDisabledAddTooltip ||\n              I18n.t('workflow_250117_05', { maxCount: maxItems })\n            }\n          >\n            <div className=\"absolute right-3 top-3 background w-[24px] h-[24px] coz-mg-hglt coz-fg-hglt-dim p-[5px] rounded-[5px] flex items-center cursor-not-allowed\">\n              <IconCozPlus className=\"text-sm\" />\n            </div>\n          </Tooltip>\n        ) : (\n          AddActionButton\n        )}\n      </div>\n    </div>\n  );\n});\n\nexport const Intents = () => {\n  const intentMode = useWatch({ name: INTENT_MODE });\n  const isShow = intentMode === INTENT_NODE_MODE.STANDARD;\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    isShow && (\n      <Section\n        title={I18n.t('workflow_intent_matchlist_title')}\n        tooltip={I18n.t('workflow_intent_matchlist_tooltips')}\n        testId={getNodeSetterId(`/${INTENTS}`)}\n      >\n        <IntentsField\n          name={INTENTS}\n          showTitleRow={false}\n          showOptionName={false}\n          optionPlaceholder={I18n.t('workflow_intent_matchlist_placeholder')}\n          defaultOptionText={I18n.t('workflow_intent_matchlist_else')}\n          optionEnableInterpolation={false}\n          maxItems={STANDARD_INTENT_ITEMS}\n          customDisabledAddTooltip={I18n.t('workflow_250117_02')}\n          hasFeedback={false}\n        />\n      </Section>\n    )\n  );\n};\n\nexport const QuickIntents = () => {\n  const intentMode = useWatch({ name: INTENT_MODE });\n  const isShow = intentMode === INTENT_NODE_MODE.MINIMAL;\n  const { getNodeSetterId } = useNodeTestId();\n  return (\n    isShow && (\n      <Section\n        testId={getNodeSetterId(`/${QUICK_INTENTS}`)}\n        title={I18n.t('workflow_intent_matchlist_title')}\n        tooltip={I18n.t('workflow_intent_matchlist_tooltips')}\n      >\n        <IntentsField\n          name={QUICK_INTENTS}\n          showTitleRow={false}\n          showOptionName={false}\n          optionPlaceholder={I18n.t('workflow_intent_matchlist_placeholder')}\n          defaultOptionText={I18n.t('workflow_intent_matchlist_else')}\n          optionEnableInterpolation={false}\n          maxItems={MINIMAL_INTENT_ITEMS}\n          customDisabledAddTooltip={I18n.t('workflow_250117_01')}\n          hasFeedback={false}\n        />\n      </Section>\n    )\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Switch, Tooltip } from '@coze-arch/coze-design';\n\nimport { INPUT_CHAT_HISTORY_SETTING_ENABLE } from '@/node-registries/intent/constants';\nimport {\n  OutputTree,\n  type OutputTreeProps,\n} from '@/form-extensions/components/output-tree';\nimport { withField, useField, useWatch } from '@/form';\nimport { ChatHistoryRound } from '@/components/chat-history-round';\n\nimport styles from './index.module.less';\n\nexport interface SwitchFieldProps {\n  testId?: string;\n}\n\nexport const ChatHistoryEnableSwitch = withField<SwitchFieldProps, boolean>(\n  ({ testId }) => {\n    const { value, onChange, readonly } = useField<boolean>();\n    return (\n      <Tooltip content={I18n.t('wf_chatflow_125')} position=\"right\">\n        <div className=\"flex items-center gap-1\">\n          <div className={styles['chat-history-text']}>\n            {I18n.t('wf_chatflow_124')}\n          </div>\n\n          <Switch\n            data-testid={testId}\n            disabled={readonly}\n            size=\"mini\"\n            checked={value}\n            onChange={onChange}\n          />\n        </div>\n      </Tooltip>\n    );\n  },\n);\n\nconst VALUE = [\n  {\n    key: nanoid(),\n    name: 'chatHistory',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'role',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n] as OutputTreeProps['value'];\n\nexport const ChatHistoryPanel = withField(() => {\n  const enableChatHistory = useWatch({\n    name: INPUT_CHAT_HISTORY_SETTING_ENABLE,\n  });\n  const { value, onChange, readonly } = useField<number>();\n\n  return enableChatHistory ? (\n    <div className=\"relative\">\n      <OutputTree\n        id=\"chat-history\"\n        readonly\n        value={VALUE}\n        defaultCollapse\n        onChange={() => {\n          console.log('OutputTree change');\n        }}\n        withDescription={false}\n        withRequired={false}\n        noCard\n      />\n      <div className={styles.line} />\n\n      <ChatHistoryRound\n        value={value}\n        readonly={readonly}\n        onChange={w => {\n          onChange(Number(w));\n        }}\n      />\n    </div>\n  ) : null;\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { type InputValueVO, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { useGlobalState } from '@/hooks';\nimport {\n  ColumnTitles,\n  FieldArrayItem,\n  FieldArrayList,\n  Section,\n  useFieldArray,\n  withFieldArray,\n} from '@/form';\n\nimport {\n  INPUT_CHAT_HISTORY_SETTING_ENABLE,\n  INPUT_CHAT_HISTORY_SETTING_ROUND,\n  COLUMNS,\n  INPUT_PATH,\n} from '../../constants';\nimport { ChatHistoryEnableSwitch, ChatHistoryPanel } from './chat-history';\n\nconst InputsParametersField = withFieldArray(() => {\n  const { name: fieldName, value } = useFieldArray<InputValueVO>();\n  const safeValue = value || [];\n  const { getNodeSetterId } = useNodeTestId();\n  const { isChatflow } = useGlobalState();\n\n  return (\n    <Section\n      title={I18n.t('workflow_detail_node_parameter_input')}\n      tooltip={I18n.t('workflow_intent_input_tooltips')}\n      testId={getNodeSetterId(fieldName)}\n      actions={\n        isChatflow\n          ? [\n              <ChatHistoryEnableSwitch\n                name={INPUT_CHAT_HISTORY_SETTING_ENABLE}\n                testId={getNodeSetterId('chatHistorySetting')}\n              />,\n            ]\n          : []\n      }\n    >\n      {isChatflow ? (\n        <ChatHistoryPanel name={INPUT_CHAT_HISTORY_SETTING_ROUND} />\n      ) : null}\n\n      <ColumnTitles columns={COLUMNS} />\n\n      <FieldArrayList>\n        {safeValue?.map(({ name }, index) => (\n          <FieldArrayItem hiddenRemove>\n            <ValueExpressionInputField\n              key={index}\n              label={name}\n              required\n              name={`${fieldName}.${index}.input`}\n            />\n          </FieldArrayItem>\n        ))}\n      </FieldArrayList>\n    </Section>\n  );\n});\n\nexport default function InputsParameters() {\n  return (\n    <InputsParametersField\n      name={INPUT_PATH}\n      defaultValue={[{ name: 'query' }]}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { INTENT_NODE_MODE } from '@coze-workflow/nodes';\nimport type { InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  INTENT_MODE,\n  SYSTEM_PROMPT,\n  INPUT_PATH,\n} from '@/node-registries/intent/constants';\nimport { ExpressionEditorField } from '@/node-registries/common/fields';\nimport { Section, useWatch } from '@/form';\n\nimport styles from './index.module.less';\n\nexport default function AdvancedSetting() {\n  const intentMode = useWatch({ name: INTENT_MODE });\n  const isShow = intentMode === INTENT_NODE_MODE.STANDARD;\n  const inputParameters = useWatch<InputValueVO[]>(INPUT_PATH);\n\n  return (\n    isShow && (\n      <Section\n        title={I18n.t('workflow_LLM_node_sp_title')}\n        tooltip={I18n.t('workflow_intent_advance_set_tooltips')}\n      >\n        <ExpressionEditorField\n          className={'!p-[4px]'}\n          required={false}\n          name={SYSTEM_PROMPT}\n          placeholder={I18n.t('workflow_intent_advance_set_placeholder')}\n          inputParameters={inputParameters}\n          testId={`/${SYSTEM_PROMPT.split('.').join('/')}`}\n          containerClassName={styles['option-expression-editor']}\n        />\n      </Section>\n    )\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport Outputs from './components/outputs';\nimport ModelSelect from './components/model-select';\nimport ModeRadio from './components/mode-radio';\nimport { Intents, QuickIntents } from './components/intents';\nimport InputsParameters from './components/inputs-parameters';\nimport AdvancedSetting from './components/advanced-setting';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <ModelSelect />\n    <ModeRadio />\n    <InputsParameters />\n    <Intents />\n    <QuickIntents />\n    <AdvancedSetting />\n    <Outputs />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport {\n  type Effect,\n  FlowNodeFormData,\n} from '@flowgram-adapter/free-layout-editor';\nimport { INTENT_NODE_MODE, DEFAULT_OUTPUTS_PATH } from '@coze-workflow/nodes';\n\nimport { WorkflowLinesService } from '@/services/workflow-line-service';\nimport { getDefaultOutputs } from '@/node-registries/intent/constants';\n\n/** After the form is created, reassign the value and wait for a delay. */\nconst DELAY_TIME = 200;\nconst MAX_COUNT_IN_MINIMAL_MODE = 10;\n\nconst isEmptyIntents = (intents: { name: string }[]) =>\n  intents.every(intent => !intent.name);\n\nexport const handleIntentModeChange: Effect = props => {\n  const { value, context } = props;\n  const isMinimal = value === INTENT_NODE_MODE.MINIMAL;\n\n  if (!context?.node) {\n    return;\n  }\n\n  // formData is the formatted backend data\n  const formData = context.node.getData(FlowNodeFormData);\n  const lineService =\n    context.node?.getService<WorkflowLinesService>(WorkflowLinesService);\n\n  const lines = lineService.getAllLines();\n\n  // Get all connections originating from this node\n  const linesFrom = lines.filter(line => line.from.id === context.node.id);\n\n  setTimeout(() => {\n    const outputsFormItem =\n      formData.formModel.getFormItemByPath(DEFAULT_OUTPUTS_PATH);\n\n    // Synchronous output, standard mode and minimalist mode are inconsistent\n    if (outputsFormItem) {\n      outputsFormItem.value = getDefaultOutputs(value);\n    }\n\n    const intentsFormItem = formData.formModel.getFormItemByPath('/intents');\n\n    const quickIntentsFormItem =\n      formData.formModel.getFormItemByPath('/quickIntents');\n\n    // Switch from standard mode to minimalist mode, if the number of intents originally set is greater than the maximum value of minimalist mode, it needs to be truncated\n    if (\n      quickIntentsFormItem &&\n      isMinimal &&\n      Array.isArray(quickIntentsFormItem.value)\n    ) {\n      const quickIntentsLength = quickIntentsFormItem.value.length;\n      if (\n        quickIntentsLength <= 1 &&\n        isEmptyIntents(quickIntentsFormItem.value)\n      ) {\n        // Quick Mode, if the current Quick Mode has no intent, is taken from the intent of the full mode\n        quickIntentsFormItem.value = cloneDeep(\n          intentsFormItem?.value.slice(0, MAX_COUNT_IN_MINIMAL_MODE),\n        );\n\n        // Reconnect\n        linesFrom.forEach(line => {\n          lineService.createLine({\n            from: line.from.id,\n            to: line.to?.id,\n            fromPort: line.info?.fromPort,\n            toPort: line.info?.toPort,\n          });\n        });\n      }\n    }\n\n    if (intentsFormItem && !isMinimal && Array.isArray(intentsFormItem.value)) {\n      const intentsLength = intentsFormItem.value.length;\n      if (intentsLength <= 1 && isEmptyIntents(intentsFormItem.value)) {\n        // Full mode, if the current full mode has no intention, it is taken from the intent of the minimalist mode\n        intentsFormItem.value = cloneDeep(quickIntentsFormItem?.value);\n\n        // Reconnect\n        linesFrom.forEach(line => {\n          lineService.createLine({\n            from: line.from.id,\n            to: line.to?.id,\n            fromPort: line.info?.fromPort,\n            toPort: line.info?.toPort,\n          });\n        });\n      }\n    }\n\n    // Trigger a validation\n    formData.formModel.validate();\n  }, DELAY_TIME);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n  DataEvent,\n} from '@flowgram-adapter/free-layout-editor';\nimport { INTENT_NODE_MODE } from '@coze-workflow/nodes';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { validateIntentsName } from '@/node-registries/intent/validator';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { handleIntentModeChange } from './effects/intent-mode-effect';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { INTENT_MODE, INTENTS, QUICK_INTENTS } from './constants';\nexport const INTENT_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    'inputs.inputParameters.0.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n    [`${INTENTS}.*`]: ({ value, formValues, name }) => {\n      if (get(formValues, INTENT_MODE) === INTENT_NODE_MODE.STANDARD) {\n        return validateIntentsName(value, get(formValues, INTENTS), name);\n      }\n\n      return undefined;\n    },\n    [`${QUICK_INTENTS}.*`]: ({ value, formValues, name }) => {\n      if (get(formValues, INTENT_MODE) === INTENT_NODE_MODE.MINIMAL) {\n        return validateIntentsName(value, get(formValues, QUICK_INTENTS), name);\n      }\n      return undefined;\n    },\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n    [INTENT_MODE]: [\n      {\n        effect: handleIntentModeChange,\n        event: DataEvent.onValueChange,\n      },\n    ],\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, isNil, omit } from 'lodash-es';\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  formatModelData,\n  getDefaultLLMParams,\n  INTENT_NODE_MODE,\n} from '@coze-workflow/nodes';\nimport { type NodeDataDTO, type ValueExpression } from '@coze-workflow/base';\n\nimport { type FormData } from './types';\nimport { getDefaultOutputs } from './constants';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: NodeDataDTO,\n  context: NodeFormContext,\n) => {\n  const { playgroundContext } = context || {};\n  const { inputs, nodeMeta, outputs } = value || {};\n\n  let llmParam: Record<string, unknown> | undefined = get(\n    inputs,\n    'llmParam',\n  ) as Record<string, unknown>;\n\n  const { models } = playgroundContext;\n\n  // When first dragged into the canvas: Parse out the default value from the backend return value.\n  if (!llmParam) {\n    llmParam = getDefaultLLMParams(models);\n  }\n\n  const model: { [k: string]: unknown } = { ...llmParam };\n  const isNewCreateInInit = isNil(inputs);\n  const inputParameters = get(inputs, 'inputParameters', []);\n\n  // - If it is a new node, the default is fast mode, otherwise it is determined according to the backend return value (if there is no backend mode field, it means it is historical data, then it is standard mode)\n  // - will support soon\n  const intentModeInInit =\n    isNewCreateInInit && !IS_OPEN_SOURCE\n      ? INTENT_NODE_MODE.MINIMAL\n      : (get(inputs, 'mode') as string) || INTENT_NODE_MODE.STANDARD;\n  const isMinimalMode = intentModeInInit === INTENT_NODE_MODE.MINIMAL;\n  const emptyIntent = [{ name: '' }];\n\n  const intentsValue = get(inputs, 'intents', emptyIntent);\n\n  return {\n    nodeMeta,\n    outputs: outputs || getDefaultOutputs(intentModeInInit),\n\n    model: omit(model, [\n      'enableChatHistory',\n      'systemPrompt',\n      'chatHistoryRound',\n    ]) as { [k: string]: unknown },\n\n    // The open-source version only supports standard mode\n    intentMode: intentModeInInit,\n\n    intents: isMinimalMode ? emptyIntent : intentsValue,\n\n    quickIntents: isMinimalMode ? intentsValue : emptyIntent,\n\n    inputs: {\n      chatHistorySetting: {\n        enableChatHistory: llmParam.enableChatHistory || false,\n        chatHistoryRound: llmParam.chatHistoryRound || 3,\n      },\n      inputParameters:\n        inputParameters.length === 0 ? [{ name: 'query' }] : inputParameters,\n    },\n    systemPrompt:\n      (llmParam?.systemPrompt as Record<string, Record<string, unknown>>)?.value\n        ?.content ?? '',\n  };\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (\n  value: FormData,\n  context: NodeFormContext,\n): NodeDataDTO => {\n  const { playgroundContext } = context || {};\n  const {\n    model,\n    inputs,\n    intents,\n    quickIntents,\n    intentMode,\n    systemPrompt,\n    nodeMeta,\n    outputs,\n  } = value || {};\n  const { chatHistorySetting, inputParameters } = inputs || {};\n  const { enableChatHistory, chatHistoryRound } = chatHistorySetting || {};\n\n  const { models, globalState, variableService, node } =\n    playgroundContext || {};\n\n  const { isChatflow } = globalState || {};\n\n  const modelMeta = models.find(m => m.model_type === model.modelType);\n\n  const promptItem = {\n    type: 'literal',\n    content: '{{query}}',\n  };\n  const systemPromptItem = {\n    type: 'literal',\n    content: intentMode === INTENT_NODE_MODE.MINIMAL ? '' : systemPrompt,\n  };\n\n  const formattedValue: Record<string, unknown> = {\n    nodeMeta,\n    outputs,\n    inputs: {\n      ...(inputs || {}),\n      inputParameters,\n      llmParam: {\n        ...formatModelData(model, modelMeta),\n        modelName: modelMeta?.name ?? '',\n        prompt: variableUtils.valueExpressionToDTO(\n          promptItem as ValueExpression,\n          variableService,\n          {\n            node,\n          },\n        ),\n        systemPrompt: variableUtils.valueExpressionToDTO(\n          systemPromptItem as ValueExpression,\n          variableService,\n          {\n            node,\n          },\n        ),\n\n        // If it is a workflow, the history is closed by default when submitting, and the dialog flow is submitted according to the actual value of the user.\n        enableChatHistory: isChatflow ? Boolean(enableChatHistory) : false,\n\n        // History rounds\n        chatHistoryRound,\n      },\n      intents: intentMode === INTENT_NODE_MODE.MINIMAL ? quickIntents : intents,\n      mode: intentMode,\n    },\n  };\n\n  return formattedValue as unknown as NodeDataDTO;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { INTENT_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const INTENT_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Intent,\n  meta: {\n    nodeDTOType: StandardNodeType.Intent,\n    size: { width: DEFAULT_NODE_SIZE.width, height: 156.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    useDynamicPort: true,\n    getLLMModelIdsByNodeJSON: nodeJSON =>\n      nodeJSON?.data?.inputs?.llmParam?.modelType,\n    defaultPorts: [{ type: 'input' }],\n    test,\n    helpLink: '/open/docs/guides/intent_recognition_node',\n  },\n  formMeta: INTENT_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject, isChatflow } = context;\n    /** Not in session flow, LLM nodes do not need to be associated with the environment */\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const enableChatHistory =\n      formData?.inputs?.chatHistorySetting?.enableChatHistory;\n    if (!isChatflow || !enableChatHistory) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: !isInProject,\n      isNeedConversation: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputs?.inputParameters;\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Intents } from '@/components/node-render/node-render-new/fields';\n\nimport { InputParameters, Outputs } from '../common/components';\n\nexport function IntentContent() {\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n      <Intents />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'output',\n    type: ViewVariableType.String,\n  },\n];\n\nexport const DEFAULT_INPUTS = [{ name: 'input' }];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FieldArray,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport type { ViewVariableType, InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { FieldArrayItem, FieldRows, Section, type FieldProps } from '@/form';\n\ninterface InputsFieldProps extends FieldProps<InputValueVO[]> {\n  title?: string;\n  paramsTitle?: string;\n  expressionTitle?: string;\n  disabledTypes?: ViewVariableType[];\n  onAppend?: () => InputValueVO;\n  inputPlaceholder?: string;\n  literalDisabled?: boolean;\n  showEmptyText?: boolean;\n  nthCannotDeleted?: number;\n}\n\nexport const InputsField = ({\n  name,\n  defaultValue,\n  title,\n  tooltip,\n  disabledTypes,\n  inputPlaceholder,\n  literalDisabled,\n  showEmptyText = true,\n}: InputsFieldProps) => {\n  const readonly = useReadonly();\n  return (\n    <FieldArray<InputValueVO> name={name} defaultValue={defaultValue}>\n      {({ field }: FieldArrayRenderProps<InputValueVO>) => {\n        const { value = [] } = field;\n        const length = value?.length ?? 0;\n        const isEmpty = !length;\n        return (\n          <Section\n            title={title}\n            tooltip={tooltip}\n            isEmpty={showEmptyText && isEmpty}\n            emptyText={I18n.t('workflow_inputs_empty')}\n          >\n            <FieldRows>\n              {field.map((item, index) => (\n                <FieldArrayItem key={item.key} disableRemove hiddenRemove>\n                  <div style={{ flex: 3 }}>\n                    <ValueExpressionInputField\n                      name={`${name}.${index}.input`}\n                      disabledTypes={disabledTypes}\n                      readonly={readonly}\n                      inputPlaceholder={inputPlaceholder}\n                      literalDisabled={literalDisabled}\n                    />\n                  </div>\n                </FieldArrayItem>\n              ))}\n            </FieldRows>\n          </Section>\n        );\n      }}\n    </FieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport { OutputsField } from '../common/fields';\nimport { INPUT_PATH } from './constants';\nimport { InputsField } from './components/inputs';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <InputsField\n      name={INPUT_PATH}\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      defaultValue={[{ name: 'input' } as any]}\n      title={I18n.t('node_http_request_params')}\n      tooltip={I18n.t('workflow_250429_03')}\n      required={false}\n      layout=\"horizontal\"\n    />\n\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('node_http_response_data')}\n      id=\"jsonStringify-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const JSON_STRINGIFY_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    // Required\n    'inputs.inputParameters.0.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeDataDTO } from '@coze-workflow/base';\n\nimport { type FormData } from './types';\nimport { OUTPUTS } from './constants';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (value: NodeDataDTO) => ({\n  ...(value ?? {}),\n  outputs: value?.outputs ?? OUTPUTS,\n});\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData): NodeDataDTO =>\n  value as unknown as NodeDataDTO;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { test, type NodeTestMeta } from './node-test';\nimport { JSON_STRINGIFY_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const JSON_STRINGIFY_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.JsonStringify,\n    meta: {\n      nodeDTOType: StandardNodeType.JsonStringify,\n      size: { width: 360, height: 130.7 },\n      nodeMetaPath: DEFAULT_NODE_META_PATH,\n      outputsPath: DEFAULT_OUTPUTS_PATH,\n      inputParametersPath: INPUT_PATH,\n      test,\n    },\n    formMeta: JSON_STRINGIFY_FORM_META,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  type NodeTestMeta,\n  generateParametersToProperties,\n} from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputs?.inputParameters;\n\n    return generateParametersToProperties(parameters, {\n      node,\n    });\n  },\n};\nexport type { NodeTestMeta };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputParameters, Outputs } from '../common/components';\n\nexport function JsonStringifyContent() {\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nexport const LoopSize = {\n  width: 360,\n  height: 139.86,\n};\n\nexport const LoopFunctionSize = {\n  width: LoopSize.width,\n  height: (LoopSize.width * 3) / 5,\n};\n\nexport const LoopVariablePrefix = 'var_';\nexport const LoopOutputsSuffix = '_list';\n\nexport enum LoopPath {\n  LoopType = 'inputs.loopType',\n  LoopCount = 'inputs.loopCount',\n  LoopArray = 'inputs.inputParameters',\n  LoopVariables = 'inputs.variableParameters',\n  LoopOutputs = 'outputs',\n}\n\nexport enum LoopType {\n  Array = 'array',\n  Count = 'count',\n  Infinite = 'infinite',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nexport const LoopFunctionIDPrefix = 'LoopFunction_';\nexport const getLoopFunctionID = (loopID: string) =>\n  LoopFunctionIDPrefix + loopID;\nexport const getLoopID = (loopFunctionID: string) =>\n  loopFunctionID.replace(LoopFunctionIDPrefix, '');\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type NodeData, WorkflowNodeData } from '@coze-workflow/nodes';\nimport type { BasicStandardNodeTypes } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\n/** Synchronize node template data */\nexport const createLoopFunctionTemplateData = (\n  loopNode: WorkflowNodeEntity,\n  loopFunctionNode: WorkflowNodeEntity,\n) => {\n  const loopNodeDataEntity =\n    loopNode.getData<WorkflowNodeData>(WorkflowNodeData);\n  const loopFunctionNodeDataEntity =\n    loopFunctionNode.getData<WorkflowNodeData>(WorkflowNodeData);\n  const loopNodeData = loopNodeDataEntity.getNodeData<keyof NodeData>();\n  if (!loopNodeData) {\n    return;\n  }\n  loopFunctionNodeDataEntity.setNodeData<BasicStandardNodeTypes>({\n    title: I18n.t('workflow_loop_body_canva'),\n    description: I18n.t('workflow_loop_body_canva_tips'),\n    icon: loopNodeData.icon,\n    mainColor: loopNodeData.mainColor,\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { delay } from '@flowgram-adapter/common';\n\n/** connect generation */\nexport const createLoopFunctionLines = async (params: {\n  document: WorkflowDocument;\n  loopId: string;\n  loopFunctionId: string;\n}) => {\n  await delay(30); // Wait for the node to be created\n  const { document, loopId, loopFunctionId } = params;\n  document.linesManager.createLine({\n    from: loopId,\n    to: loopFunctionId,\n    fromPort: 'loop-output-to-function',\n    toPort: 'loop-function-input',\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  WorkflowNodeEntity,\n  WorkflowSubCanvas,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  FlowNodeBaseType,\n  FlowNodeTransformData,\n} from '@flowgram-adapter/free-layout-editor';\nimport { FlowRendererKey } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type IPoint,\n  type PaddingSchema,\n  type PositionSchema,\n} from '@flowgram-adapter/common';\nimport type { WorkflowNodeJSON } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { LoopFunctionSize } from '../constants';\nimport { getLoopID } from './relation';\n\nexport const createLoopFunctionJSON = (params: {\n  id: string;\n  position: IPoint;\n  loopNode: WorkflowNodeEntity;\n}): WorkflowNodeJSON => {\n  const { id, position } = params;\n  return {\n    id,\n    type: FlowNodeBaseType.SUB_CANVAS,\n    data: {},\n    meta: {\n      isContainer: true,\n      position,\n      nodeDTOType: FlowNodeBaseType.SUB_CANVAS,\n      useDynamicPort: true,\n      disableSideSheet: true,\n      renderKey: FlowRendererKey.SUB_CANVAS,\n      size: {\n        width: LoopFunctionSize.width,\n        height: LoopFunctionSize.height,\n      },\n      defaultPorts: [\n        { type: 'input', portID: 'loop-function-input', disabled: true },\n        { type: 'input', portID: 'loop-function-inline-input' },\n        { type: 'output', portID: 'loop-function-inline-output' },\n      ],\n      padding: (transform: FlowNodeTransformData): PaddingSchema => ({\n        top: 100,\n        bottom: 60,\n        left: 100,\n        right: 100,\n      }),\n      selectable(node: WorkflowNodeEntity, mousePos?: PositionSchema): boolean {\n        if (!mousePos) {\n          return true;\n        }\n        const transform = node.getData<FlowNodeTransformData>(\n          FlowNodeTransformData,\n        );\n        // The mouse can only be selected when the starting position does not include the current node\n        return !transform.bounds.contains(mousePos.x, mousePos.y);\n      },\n      renderSubCanvas: () => ({\n        title: I18n.t('workflow_loop_body_canva'),\n        tooltip: I18n.t('workflow_loop_body_canva_tips'),\n        style: {\n          minWidth: LoopFunctionSize.width,\n          minHeight: LoopFunctionSize.height,\n        },\n        renderPorts: [\n          {\n            id: 'loop-function-input',\n            type: 'input',\n            style: {\n              position: 'absolute',\n              left: '50%',\n              top: '0',\n            },\n          },\n          {\n            id: 'loop-function-inline-input',\n            type: 'input',\n            style: {\n              position: 'absolute',\n              right: '0',\n              top: '50%',\n              transform: 'translateY(20px)',\n            },\n          },\n          {\n            id: 'loop-function-inline-output',\n            type: 'output',\n            style: {\n              position: 'absolute',\n              left: '0',\n              top: '50%',\n              transform: 'translateY(20px)',\n            },\n          },\n        ],\n      }),\n      subCanvas: (node: WorkflowNodeEntity): WorkflowSubCanvas | undefined => {\n        const canvasNode = node;\n        const parentNodeID = getLoopID(canvasNode.id);\n        const parentNode = node.document.getNode(parentNodeID);\n        if (!parentNode) {\n          return undefined;\n        }\n        const subCanvas: WorkflowSubCanvas = {\n          isCanvas: true,\n          parentNode,\n          canvasNode,\n        };\n        return subCanvas;\n      },\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  WorkflowDocument,\n  WorkflowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type IPoint } from '@flowgram-adapter/common';\nimport type { WorkflowNodeJSON } from '@coze-workflow/base';\n\nimport { LoopFunctionIDPrefix } from './relation';\nimport { createLoopFunctionTemplateData } from './create-loop-function-template-data';\nimport { createLoopFunctionLines } from './create-loop-function-lines';\nimport { createLoopFunctionJSON } from './create-loop-function-json';\n\n/** Create Loop Body Node */\nexport const createLoopFunction = async (\n  loopNode: WorkflowNodeEntity,\n  loopJson: WorkflowNodeJSON,\n) => {\n  const document = loopNode.document as WorkflowDocument;\n  const id = `${LoopFunctionIDPrefix}${loopNode.id}`;\n  const loopPosition: IPoint = {\n    x: loopJson.meta?.position?.x || 0,\n    y: loopJson.meta?.position?.y || 0,\n  };\n  const offset: IPoint = {\n    x: 0,\n    y: 200,\n  };\n  const position = {\n    x: loopPosition.x + offset.x,\n    y: loopPosition.y + offset.y,\n  };\n  const loopFunctionJSON = createLoopFunctionJSON({ id, position, loopNode });\n  const loopFunctionNode = await document.createWorkflowNode(loopFunctionJSON);\n  createLoopFunctionTemplateData(loopNode, loopFunctionNode);\n  createLoopFunctionLines({\n    document,\n    loopId: loopNode.id,\n    loopFunctionId: loopFunctionNode.id,\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { I18n } from '@coze-arch/i18n';\nimport { getLoopInputNames } from './get-loop-input-names';\n\nexport const LoopInputNameValidator = createNodeInputNameValidate({\n  getNames: getLoopInputNames,\n  invalidValues: {\n    index: I18n.t('workflow_loop_name_no_index_wrong'),\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { LoopPath } from '../../constants';\n\nexport const getLoopInputNames = ({ value, formValues }): string[] => {\n  const loopArray: InputValueVO[] = get(formValues, LoopPath.LoopArray) ?? [];\n  const loopVariables = get(formValues, LoopPath.LoopVariables) ?? [];\n  const loopInputs = [...loopArray, ...loopVariables];\n  return loopInputs.map(input => input.name).filter(Boolean) as string[];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\n\nexport const LoopInputValueValidator = createValueExpressionInputValidate({\n  required: true,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { getLoopOutputNames } from './get-loop-output-names';\n\nexport const LoopOutputNameValidator = createNodeInputNameValidate({\n  getNames: getLoopOutputNames,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { LoopPath } from '../../constants';\n\nexport const getLoopOutputNames = ({ value, formValues }): string[] => {\n  const loopOutputs: InputValueVO[] =\n    get(formValues, LoopPath.LoopOutputs) ?? [];\n  return loopOutputs.map(input => input.name).filter(Boolean) as string[];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { useEffect, useLayoutEffect, useState } from 'react';\nimport { LoopPath, LoopType } from '../constants';\n\nexport const useLoopType = () => {\n  const [loopType, setLoopType] = useState<LoopType | undefined>();\n\n  const node = useCurrentEntity();\n  const formModel = node.getData(FlowNodeFormData).getFormModel<FormModelV2>();\n  const getLoopType = () =>\n    formModel.getValueIn<LoopType>(LoopPath.LoopType) ?? LoopType.Array;\n\n  // Synchronized form value initialization\n  useLayoutEffect(() => {\n    setLoopType(getLoopType());\n  }, [formModel]);\n\n  // Synchronize form external value changes: undo/redo/synergy\n  useEffect(() => {\n    const disposer = formModel.onFormValuesChange(({ name }) => {\n      if (name !== LoopPath.LoopType) {\n        return;\n      }\n      setLoopType(getLoopType());\n    });\n    return () => disposer.dispose();\n  }, [formModel]);\n\n  return loopType;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { type FC } from 'react';\n\nimport { type InputValueVO, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { InputsField } from '@/node-registries/common/fields';\n\nimport { useLoopType } from '../../hooks';\nimport { LoopPath, LoopType } from '../../constants';\n\ninterface LoopArrayFieldProps {\n  name?: string;\n}\n\nexport const LoopArrayField: FC<LoopArrayFieldProps> = ({ name }) => {\n  const loopType = useLoopType();\n\n  if (loopType !== LoopType.Array) {\n    return null;\n  }\n\n  return (\n    <InputsField\n      name={name ?? LoopPath.LoopArray}\n      title={I18n.t('workflow_loop_loop_times')}\n      tooltip={I18n.t('workflow_loop_loop_times_tips')}\n      defaultValue={[{ name: 'input' } as InputValueVO]}\n      nthCannotDeleted={1}\n      inputProps={{\n        hideDeleteIcon: true,\n        disabledTypes: ViewVariableType.getComplement(\n          ViewVariableType.getAllArrayType(),\n        ),\n      }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useNodeTestId,\n  type ValueExpression,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInput } from '@/form-extensions/components/value-expression-input';\nimport { FormItem } from '@/form-extensions/components/form-item';\nimport { useField, withField } from '@/form';\n\nimport { useLoopType } from '../../hooks';\nimport { LoopType } from '../../constants';\n\ninterface LoopCountFieldProps {\n  title?: string;\n  tooltip?: string;\n  testId?: string;\n}\n\nexport const LoopCountField = withField<LoopCountFieldProps, ValueExpression>(\n  ({\n    title = I18n.t('workflow_loop_count'),\n    tooltip = I18n.t('workflow_loop_count_tooltips'),\n    testId,\n  }) => {\n    const { value, onChange, readonly } = useField<ValueExpression>();\n    const { getNodeSetterId } = useNodeTestId();\n    const loopType = useLoopType();\n\n    if (loopType !== LoopType.Count) {\n      return null;\n    }\n\n    return (\n      <FormItem\n        label={title}\n        tooltip={tooltip}\n        layout=\"vertical\"\n        style={{\n          marginTop: 12,\n        }}\n        labelStyle={{\n          fontSize: 12,\n          fontWeight: 600,\n          color: 'var(--coz-fg-secondary, rgba(6, 7, 9, 0.50))',\n        }}\n      >\n        <ValueExpressionInput\n          value={value}\n          onChange={onChange}\n          testId={testId ?? getNodeSetterId('loopCount')}\n          disabledTypes={ViewVariableType.getComplement([\n            ViewVariableType.Integer,\n          ])}\n          readonly={readonly}\n          inputType={ViewVariableType.Integer}\n          literalConfig={{\n            min: 1,\n            max: 1000,\n          }}\n          literalStyle={{\n            width: '100%',\n          }}\n        />\n      </FormItem>\n    );\n  },\n  {\n    defaultValue: { type: ValueExpressionType.LITERAL, content: 10 },\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { ValueExpressionType, type ValueExpression } from '@coze-workflow/base';\n\nimport { LoopVariablePrefix } from '../../constants';\n\nexport const formatLoopOutputName = (params: {\n  name: string;\n  prefix: string;\n  suffix: string;\n  input: ValueExpression;\n  node: WorkflowNodeEntity;\n}): string => {\n  const { name, prefix, suffix, input, node } = params;\n\n  // Non-reference type or non-node own variable, returning the loop body variable name\n  if (\n    input.type !== ValueExpressionType.REF ||\n    input.content?.keyPath?.[0] !== node.id\n  ) {\n    return `${prefix}${name}${suffix}`;\n  }\n\n  // The node itself variable, after removing the prefix, returns\n  return name.startsWith(LoopVariablePrefix)\n    ? name.slice(LoopVariablePrefix.length)\n    : name;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { type FC } from 'react';\n\nimport { type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { LoopOutputsField as LoopOutputsCommonField } from '@/node-registries/common/fields';\n\nimport { LoopOutputsSuffix, LoopPath } from '../../constants';\nimport { formatLoopOutputName } from './format-loop-output-name';\n\ninterface LoopOutputsFieldProps {\n  name?: string;\n  title?: string;\n  tooltip?: string;\n}\n\nexport const LoopOutputsField: FC<LoopOutputsFieldProps> = ({\n  name = LoopPath.LoopOutputs,\n  title = I18n.t('workflow_loop_output'),\n  tooltip = I18n.t('workflow_loop_output_tips'),\n}) => (\n  <LoopOutputsCommonField\n    name={name}\n    title={title}\n    tooltip={tooltip}\n    defaultValue={[{ name: 'output' } as InputValueVO]}\n    nameProps={{\n      initValidate: true,\n      suffix: LoopOutputsSuffix,\n      format: formatLoopOutputName,\n    }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { FC, ReactNode } from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section } from '@/form';\n\ninterface LoopSettingsFieldProps {\n  title?: string;\n  tooltip?: string;\n  testId?: string;\n  children?: ReactNode | ReactNode[];\n}\n\nexport const LoopSettingsSection: FC<LoopSettingsFieldProps> = ({\n  title = I18n.t('workflow_loop_title'),\n  tooltip,\n  testId,\n  children,\n}) => {\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <Section\n      title={title}\n      tooltip={tooltip}\n      testId={getNodeSetterId(testId ?? '')}\n    >\n      {children}\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { I18n } from '@coze-arch/i18n';\nimport { LoopType } from '../../constants';\n\nexport const LoopTypeOptions = [\n  {\n    value: LoopType.Array,\n    label: I18n.t('workflow_loop_type_array'),\n  },\n  {\n    value: LoopType.Count,\n    label: I18n.t('workflow_loop_type_count'),\n  },\n  {\n    value: LoopType.Infinite,\n    label: I18n.t('workflow_loop_type_infinite'),\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Select } from '@coze-arch/coze-design';\n\nimport { FormItem } from '@/form-extensions/components/form-item';\nimport { useField, withField } from '@/form';\n\nimport { LoopType } from '../../constants';\nimport { LoopTypeOptions } from './options';\n\ninterface LoopTypeFieldProps {\n  title?: string;\n  tooltip?: string;\n  testId?: string;\n  emptyContent?: string;\n}\n\nexport const LoopTypeField = withField<LoopTypeFieldProps, LoopType>(\n  ({\n    title = I18n.t('workflow_loop_type'),\n    tooltip = I18n.t('workflow_loop_type_tooltips'),\n    emptyContent = I18n.t('workflow_detail_node_nodata'),\n    testId,\n  }) => {\n    const { value, onChange, readonly } = useField<LoopType>();\n\n    const { getNodeSetterId, concatTestId } = useNodeTestId();\n    const computedTestId = concatTestId(getNodeSetterId('select'), value);\n\n    const onSelect = useCallback((selectedOption: unknown) => {\n      onChange(selectedOption as LoopType);\n    }, []);\n\n    return (\n      <FormItem\n        label={title}\n        tooltip={tooltip}\n        layout=\"vertical\"\n        labelStyle={{\n          fontSize: 12,\n          fontWeight: 600,\n          color: 'var(--coz-fg-secondary, rgba(6, 7, 9, 0.50))',\n        }}\n      >\n        <Select\n          size=\"small\"\n          value={value}\n          optionList={LoopTypeOptions}\n          style={{\n            width: '100%',\n            pointerEvents: readonly ? 'none' : 'auto',\n          }}\n          onChange={onSelect}\n          data-testid={testId ?? computedTestId}\n          emptyContent={emptyContent}\n        />\n      </FormItem>\n    );\n  },\n  {\n    defaultValue: LoopType.Array,\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputsField } from '@/node-registries/common/fields';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FC } from 'react';\nimport { LoopPath, LoopVariablePrefix } from '../../constants';\n\ninterface LoopVariableFieldProps {\n  name?: string;\n}\n\nexport const LoopVariablesField: FC<LoopVariableFieldProps> = ({ name }) => (\n  <InputsField\n    name={name ?? LoopPath.LoopVariables}\n    title={I18n.t('workflow_loop_loop_variables')}\n    tooltip={I18n.t('workflow_loop_loop_variables_tips')}\n    defaultValue={[]}\n    showEmptyText={false}\n    nameProps={{ prefix: LoopVariablePrefix }}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PrivateScopeProvider } from '@coze-workflow/variable';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport {\n  LoopArrayField,\n  LoopCountField,\n  LoopOutputsField,\n  LoopSettingsSection,\n  LoopTypeField,\n  LoopVariablesField,\n} from './loop-fields';\nimport { LoopPath } from './constants';\n\nexport const LoopFormRender = () => (\n  <NodeConfigForm>\n    <PrivateScopeProvider>\n      <LoopSettingsSection>\n        <LoopTypeField name={LoopPath.LoopType} />\n        <LoopCountField name={LoopPath.LoopCount} />\n      </LoopSettingsSection>\n      <LoopArrayField name={LoopPath.LoopArray} />\n      <LoopVariablesField name={LoopPath.LoopVariables} />\n    </PrivateScopeProvider>\n    <LoopOutputsField name={LoopPath.LoopOutputs} />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  fireNodeTitleChange,\n  provideLoopInputsVariablesEffect,\n  provideLoopOutputsVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport {\n  LoopArrayNameValidator,\n  LoopArrayValueValidator,\n  LoopInputNameValidator,\n  LoopInputValueValidator,\n  LoopOutputNameValidator,\n} from './validators';\nimport { type FormData } from './types';\nimport { LoopFormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { LoopPath } from './constants';\n\nexport const LOOP_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <LoopFormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    [`${LoopPath.LoopArray}.*.name`]: LoopArrayNameValidator,\n    [`${LoopPath.LoopArray}.*.input`]: LoopArrayValueValidator,\n    [`${LoopPath.LoopVariables}.*.name`]: LoopInputNameValidator,\n    [`${LoopPath.LoopVariables}.*.input`]: LoopInputValueValidator,\n    [`${LoopPath.LoopOutputs}.*.name`]: LoopOutputNameValidator,\n    [`${LoopPath.LoopOutputs}.*.input`]: LoopInputValueValidator,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    inputs: provideLoopInputsVariablesEffect,\n    outputs: provideLoopOutputsVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport { get } from 'lodash-es';\nimport { LoopPath, LoopType } from '../../constants';\nimport { LoopInputNameValidator } from '../loop-input-name';\n\nexport const LoopArrayNameValidator: Validate<string> = params => {\n  const { formValues } = params;\n  const loopType = get(formValues, LoopPath.LoopType);\n  if (loopType !== LoopType.Array) {\n    return;\n  }\n  return LoopInputNameValidator(params);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { get } from 'lodash-es';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport { type ValueExpression } from '@coze-workflow/base';\n\nimport { LoopInputValueValidator } from '../loop-input-value';\nimport { LoopPath, LoopType } from '../../constants';\n\nexport const LoopArrayValueValidator: Validate<ValueExpression> = params => {\n  const { formValues } = params;\n  const loopType = get(formValues, LoopPath.LoopType);\n  if (loopType !== LoopType.Array) {\n    return;\n  }\n  return LoopInputValueValidator(params);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { set } from 'lodash-es';\nimport { variableUtils } from '@coze-workflow/variable';\nimport { type NodeDataDTO } from '@coze-workflow/base';\n\nimport { LoopType } from './constants';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (formData: any, ctx: any) => {\n  const inputParameters = formData?.inputs?.inputParameters;\n  const outputValues = formData?.outputs;\n  const loopCount = formData?.inputs?.loopCount;\n\n  if (!Array.isArray(inputParameters) || inputParameters?.length === 0) {\n    set(formData, 'inputs.inputParameters', [{ name: 'input' }]);\n  }\n\n  if (outputValues && Array.isArray(outputValues)) {\n    outputValues.map((outputValue, index) => {\n      set(\n        outputValues,\n        index,\n        variableUtils.inputValueToVO(\n          outputValue,\n          ctx.playgroundContext.variableService,\n        ),\n      );\n    });\n  }\n\n  if (loopCount) {\n    set(\n      formData,\n      'inputs.loopCount',\n      variableUtils.valueExpressionToVO(\n        loopCount,\n        ctx.playgroundContext.variableService,\n      ),\n    );\n  }\n\n  return formData;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (formData: any, ctx: any): NodeDataDTO => {\n  const outputValues = formData?.outputs;\n  const loopCount = formData?.inputs?.loopCount;\n  const loopType: LoopType = formData?.inputs?.loopType;\n\n  if (outputValues && Array.isArray(outputValues)) {\n    outputValues.map((outputValue, index) => {\n      const dto = variableUtils.inputValueToDTO(\n        outputValue,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      );\n\n      // Custom logic: If a variable inside the loop is selected, a list of the type of the output variable is set\n      if (\n        outputValue?.input?.content?.keyPath?.[0] !== ctx.node.id &&\n        dto?.input\n      ) {\n        set(dto, 'input.schema', {\n          type: dto.input?.type,\n          schema: dto.input?.schema,\n        });\n        set(dto, 'input.type', 'list');\n      }\n\n      set(outputValues, index, dto);\n    });\n    set(formData, 'outputs', outputValues.filter(Boolean));\n  }\n\n  if (loopCount) {\n    set(\n      formData,\n      'inputs.loopCount',\n      variableUtils.valueExpressionToDTO(\n        loopCount,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      ),\n    );\n  }\n\n  if (loopType !== LoopType.Array) {\n    set(formData, 'inputs.inputParameters', []);\n  }\n\n  return formData;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  WorkflowNodeEntity,\n  WorkflowSubCanvas,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeJSON,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { createLoopFunction, getLoopFunctionID } from './loop-function';\nimport { LOOP_FORM_META } from './form-meta';\nimport { LoopPath, LoopSize } from './constants';\n\nexport const LOOP_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Loop,\n  meta: {\n    nodeDTOType: StandardNodeType.Loop,\n    style: {\n      width: LoopSize.width,\n    },\n    size: LoopSize,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: LoopPath.LoopArray, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    useDynamicPort: true,\n    defaultPorts: [\n      { type: 'input' },\n      { type: 'output', portID: 'loop-output' },\n      { type: 'output', portID: 'loop-output-to-function', disabled: true },\n    ],\n    test,\n    subCanvas: (node: WorkflowNodeEntity): WorkflowSubCanvas | undefined => {\n      const parentNode = node;\n      const canvasNodeID = getLoopFunctionID(parentNode.id);\n      const canvasNode = node.document.getNode(canvasNodeID);\n      if (!canvasNode) {\n        return undefined;\n      }\n      const subCanvas: WorkflowSubCanvas = {\n        isCanvas: false,\n        parentNode,\n        canvasNode,\n      };\n      return subCanvas;\n    },\n    helpLink: '/open/docs/guides/loop_node',\n  },\n  variablesMeta: {\n    outputsPathList: [],\n    inputsPathList: [\n      LoopPath.LoopArray,\n      LoopPath.LoopVariables,\n      // 'Outputs',//WARNING: Adding outputs will cause this data to be cleared\n    ],\n  },\n  formMeta: LOOP_FORM_META,\n  onCreate(node, json) {\n    createLoopFunction(node, json as unknown as WorkflowNodeJSON);\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  getRelatedInfo,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { LoopType } from './constants';\n\nexport const test: NodeTestMeta = {\n  async generateRelatedContext(_, context) {\n    const { isInProject, workflowId, spaceId } = context;\n    if (isInProject) {\n      return {};\n    }\n    const related = await getRelatedInfo({ workflowId, spaceId });\n    return generateEnvToRelatedContextProperties(related);\n  },\n  generateFormSettingProperties(node) {\n    const { formModel } = node.getData(FlowNodeFormData);\n    const data = formModel.getFormItemValueByPath('/inputs');\n    if (data?.loopType === LoopType.Count && data?.loopCount) {\n      return generateParametersToProperties(\n        [\n          {\n            name: 'loopCount',\n            title: I18n.t('workflow_loop_count'),\n            /** Cycle count is required */\n            required: true,\n            input: data.loopCount,\n          },\n        ],\n        { node },\n      );\n    }\n    return {};\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputs?.inputParameters;\n    const variable = formData?.inputs?.variableParameters;\n    const properties = {\n      // Input when specifying the number of cycles\n      ...(formData?.inputs?.loopType === LoopType.Array\n        ? generateParametersToProperties(parameters, { node })\n        : {}),\n      /** intermediate variable */\n      ...generateParametersToProperties(variable, { node }),\n    };\n    return properties;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWorkflowNode } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { VariableTagList } from '@/components/node-render/node-render-new/fields/variable-tag-list';\nimport { useInputParametersVariableTags } from '@/components/node-render/node-render-new/fields/use-input-parameters-variable-tags';\nimport { Field } from '@/components/node-render/node-render-new/fields';\n\nimport { useLoopType } from '../hooks';\nimport { LoopType } from '../constants';\n\ninterface InputParametersProps {\n  label?: string;\n}\n\nexport const LoopArray = ({\n  label = I18n.t('workflow_detail_node_parameter_input'),\n}: InputParametersProps) => {\n  const workflowNode = useWorkflowNode();\n  const loopType = useLoopType();\n  const visible = loopType === LoopType.Array;\n\n  const loopArrayParameters = workflowNode.inputParameters;\n  const variableTags = useInputParametersVariableTags(loopArrayParameters);\n\n  const isEmpty = !variableTags || variableTags.length === 0;\n\n  if (!visible) {\n    return <></>;\n  }\n\n  return (\n    <Field label={label} isEmpty={isEmpty}>\n      <VariableTagList value={variableTags} />\n    </Field>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Port } from '@/components/node-render/node-render-new/fields/port';\n\nexport const LoopPort = () => (\n  <>\n    <Port\n      id={'loop-output-to-function'}\n      type=\"output\"\n      style={{\n        position: 'absolute',\n        width: 20,\n        height: 20,\n        right: 'unset',\n        top: 'unset',\n        bottom: 0,\n        left: '50%',\n        transform: 'translate(-50%, 50%)',\n      }}\n    />\n    <Port\n      id={'loop-output'}\n      type=\"output\"\n      style={{\n        position: 'absolute',\n        right: '0',\n      }}\n    />\n  </>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType, useWorkflowNode } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { VariableTagList } from '@/components/node-render/node-render-new/fields/variable-tag-list';\nimport { useInputParametersVariableTags } from '@/components/node-render/node-render-new/fields/use-input-parameters-variable-tags';\nimport { Field } from '@/components/node-render/node-render-new/fields';\n\nexport const LoopVariables = () => {\n  const { data, type } = useWorkflowNode();\n  const variableTags = useInputParametersVariableTags(\n    data?.inputs?.variableParameters,\n  );\n\n  // Non-Loop nodes have no variable definitions\n  if (type !== StandardNodeType.Loop) {\n    return null;\n  }\n\n  const label = I18n.t('workflow_loop_loop_variables');\n\n  const isEmpty = !variableTags || variableTags.length === 0;\n\n  return (\n    <Field label={label} isEmpty={isEmpty}>\n      <VariableTagList value={variableTags} />\n    </Field>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PrivateScopeProvider } from '@coze-workflow/variable';\n\nimport { Outputs } from '@/components/node-render/node-render-new/fields';\n\nimport { LoopArray, LoopPort, LoopVariables } from './loop-content';\n\nexport const LoopContent = () => (\n  <PrivateScopeProvider>\n    <LoopArray />\n    <LoopVariables />\n    <Outputs />\n    <LoopPort />\n  </PrivateScopeProvider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'outputList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'output',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'date',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n\nexport const COLUMNS = [\n  {\n    label: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 148 },\n  },\n  { label: I18n.t('workflow_detail_end_output_value') },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Switch, Tooltip } from '@coze-arch/coze-design';\n\nimport { useField, withField } from '@/form';\n\nexport const HistorySwitchField = withField(() => {\n  const { name, value, onChange, readonly } = useField<boolean>();\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <Tooltip content={I18n.t('wf_chatflow_125')} position=\"right\">\n      <div className=\"flex items-center gap-1\">\n        <div className={'text-[12px]'}>{I18n.t('wf_chatflow_124')}</div>\n        <Switch\n          size=\"mini\"\n          checked={value}\n          data-testid={getNodeSetterId(name)}\n          onChange={checked => {\n            onChange?.(checked);\n          }}\n          disabled={readonly}\n        />\n      </div>\n    </Tooltip>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/base';\n\nimport {\n  OutputTree,\n  type OutputTreeProps,\n} from '@/form-extensions/components/output-tree';\nimport { useField, withField } from '@/form';\nimport { ChatHistoryRound } from '@/components/chat-history-round';\n\nconst DEFAULT_VALUE = [\n  {\n    key: nanoid(),\n    name: 'chatHistory',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'role',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n] as OutputTreeProps['value'];\n\nexport const HistoryRoundField = withField(\n  ({ showLine }: { showLine: boolean }) => {\n    const { value, onChange, readonly } = useField<number>();\n\n    return (\n      <div className=\"relative\">\n        <OutputTree\n          id=\"chat-history\"\n          readonly\n          value={DEFAULT_VALUE}\n          defaultCollapse\n          // eslint-disable-next-line @typescript-eslint/no-empty-function\n          onChange={() => {}}\n          withDescription={false}\n          withRequired={false}\n          noCard\n        />\n        {showLine ? (\n          <div className=\"h-px -mt-[3px] mb-[14px] bg-[#FFF]\" />\n        ) : null}\n\n        <ChatHistoryRound\n          value={value}\n          readonly={readonly}\n          onChange={w => {\n            onChange(Number(w));\n          }}\n        />\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type PropsWithChildren } from 'react';\n\nimport {\n  useNodeTestId,\n  type InputValueVO,\n  type ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { getFlags } from '@coze-arch/bot-flags';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { useGlobalState } from '@/hooks';\nimport {\n  Section,\n  useFieldArray,\n  ColumnTitles,\n  FieldArrayList,\n  FieldArrayItem,\n  withFieldArray,\n  useWatch,\n} from '@/form';\n\nimport { COLUMNS } from '../constants';\nimport { HistorySwitchField } from './history-switch-field';\nimport { HistoryRoundField } from './history-round-field';\n\ninterface InputsProps {\n  inputType?: ViewVariableType;\n  disabledTypes?: ViewVariableType[];\n}\n\nexport const Inputs = withFieldArray(\n  ({ inputType, disabledTypes }: InputsProps & PropsWithChildren) => {\n    const { name: fieldName, value } = useFieldArray<InputValueVO>();\n    const safeValue = value || [];\n    const { getNodeSetterId } = useNodeTestId();\n    const { isChatflow } = useGlobalState();\n    const enableChatHistory = useWatch<boolean>(\n      'inputs.historySetting.enableChatHistory',\n    );\n    const FLAGS = getFlags();\n\n    return (\n      <Section\n        title={I18n.t('workflow_detail_node_parameter_input')}\n        tooltip={I18n.t('ltm_240826_01')}\n        testId={getNodeSetterId(fieldName)}\n        actions={[\n          // Support soon, so stay tuned.\n          isChatflow && FLAGS['bot.automation.ltm_enhance'] ? (\n            <HistorySwitchField name=\"inputs.historySetting.enableChatHistory\" />\n          ) : null,\n        ]}\n      >\n        <ColumnTitles columns={COLUMNS} />\n\n        <FieldArrayList>\n          {safeValue?.map(({ name }, index) => (\n            <FieldArrayItem hiddenRemove>\n              <ValueExpressionInputField\n                key={index}\n                label={name}\n                required\n                inputType={inputType}\n                disabledTypes={disabledTypes}\n                name={`${fieldName}.${index}.input`}\n              />\n            </FieldArrayItem>\n          ))}\n        </FieldArrayList>\n\n        {isChatflow ? (\n          <div className=\"mt-[4px]\">\n            {enableChatHistory ? (\n              <HistoryRoundField\n                name=\"inputs.historySetting.chatHistoryRound\"\n                showLine\n              />\n            ) : null}\n          </div>\n        ) : null}\n      </Section>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport { OutputsField } from '../common/fields';\nimport { INPUT_PATH } from './constants';\nimport { Inputs } from './components';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <div className=\"relative\">\n      <Inputs\n        name={INPUT_PATH}\n        inputType={ViewVariableType.String}\n        disabledTypes={ViewVariableType.getComplement([\n          ViewVariableType.String,\n        ])}\n        defaultValue={[{ name: 'Query' }]}\n      />\n    </div>\n\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('ltm_240826_02')}\n      id=\"ltm-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValueExpressionType,\n  type LiteralExpression,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { getFlags } from '@coze-arch/bot-flags';\n\nimport { type FormData, type DTODataWhenInit } from './types';\nimport { OUTPUTS } from './constants';\n\nconst HISTORY_FIELDS = ['enableChatHistory', 'chatHistoryRound'];\nconst DEFAULT_VALUE = [\n  { name: 'Query', input: { type: ValueExpressionType.REF } },\n];\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (value: DTODataWhenInit): FormData => {\n  // Drag into node with null value\n  // Create a copy, value.input.inputParameters array is empty\n  const inputParameters = value?.inputs?.inputParameters ?? [];\n  const inputParametersWithNoHistoryFields = inputParameters.filter(\n    v => !HISTORY_FIELDS.includes(v.name || ''),\n  );\n  const historySwitchItem = inputParameters.find(\n    v => v.name === 'enableChatHistory',\n  )?.input as LiteralExpression;\n\n  const historyRoundItem = inputParameters.find(\n    v => v.name === 'chatHistoryRound',\n  )?.input as LiteralExpression;\n\n  return {\n    nodeMeta: value?.nodeMeta,\n    inputs: {\n      inputParameters:\n        inputParametersWithNoHistoryFields.length === 0\n          ? DEFAULT_VALUE\n          : inputParametersWithNoHistoryFields,\n\n      // historical session settings\n      historySetting: {\n        // Whether to open a historical session\n        enableChatHistory: Boolean(historySwitchItem?.content),\n\n        // Number of session rounds in history, default is 3\n        chatHistoryRound: (historyRoundItem?.content as number) ?? 3,\n      },\n    },\n\n    outputs: value?.outputs ?? OUTPUTS,\n  };\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData): DTODataWhenInit => {\n  const { inputParameters, historySetting } = value.inputs;\n\n  if (getFlags()['bot.automation.ltm_enhance']) {\n    inputParameters.push({\n      name: 'enableChatHistory',\n      input: {\n        content: historySetting.enableChatHistory,\n        type: ValueExpressionType.LITERAL,\n        rawMeta: {\n          type: ViewVariableType.Boolean,\n        },\n      },\n    });\n\n    inputParameters.push({\n      name: 'chatHistoryRound',\n      input: {\n        content: historySetting.chatHistoryRound,\n        type: ValueExpressionType.LITERAL,\n        rawMeta: {\n          type: ViewVariableType.Integer,\n        },\n      },\n    });\n  }\n\n  const result = {\n    nodeMeta: value?.nodeMeta,\n    inputs: {\n      inputParameters,\n    },\n    outputs: value?.outputs,\n  };\n\n  return result;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const LTM_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    'inputs.inputParameters.0.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { LTM_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const LTM_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.LTM,\n  meta: {\n    nodeDTOType: StandardNodeType.LTM,\n    size: { width: 360, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    test,\n    helpLink: '/open/docs/guides/ltm_node',\n  },\n  formMeta: LTM_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(_, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasLTMNode: true,\n      disableProject: true,\n      disableProjectTooltip: I18n.t('wf_chatflow_142'),\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputs.inputParameters;\n\n    return generateParametersToProperties(inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputParameters, Outputs } from '../common/components';\n\nexport function LtmContent() {\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\nexport const ANSWER_CONTENT_PATH = 'inputs.content';\nexport const STREAMING_OUTPUT_PATH = 'inputs.streamingOutput';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useWatch } from '@/form';\n\nimport { InputsParametersField, AnswerContentField } from '../common/fields';\nimport {\n  INPUT_PATH,\n  ANSWER_CONTENT_PATH,\n  STREAMING_OUTPUT_PATH,\n} from './constants';\n\nexport const FormRender = withNodeConfigForm(() => {\n  const inputParameters = useWatch<InputValueVO[]>(INPUT_PATH);\n  return (\n    <>\n      <InputsParametersField\n        key={INPUT_PATH}\n        name={INPUT_PATH}\n        title={I18n.t('workflow_detail_end_output')}\n        tooltip={I18n.t('workflow_message_variable_tooltips')}\n        isTree={true}\n      />\n      <AnswerContentField\n        key={ANSWER_CONTENT_PATH}\n        editorFieldName={ANSWER_CONTENT_PATH}\n        switchFieldName={STREAMING_OUTPUT_PATH}\n        title={I18n.t('workflow_241111_01')}\n        tooltip={I18n.t('workflow_message_anwser_tooltips')}\n        enableStreamingOutput\n        switchLabel={I18n.t('workflow_message_streaming_name')}\n        switchTooltip={I18n.t('workflow_message_streaming_tooltips')}\n        // Adapt to the old testId format\n        testId={`/${ANSWER_CONTENT_PATH.split('.').join('/')}`}\n        switchTestId={STREAMING_OUTPUT_PATH.split('.')?.at(-1)}\n        inputParameters={inputParameters}\n      />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { fireNodeTitleChange } from '@/node-registries/common/effects';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { createInputsValidator } from '../common/fields';\n\nexport const OUTPUT_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ...createInputsValidator(true),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormData, type NodeDataDTO } from './types';\nimport { get, set } from 'lodash-es';\nimport { VariableTypeDTO } from '@coze-workflow/base';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (value: NodeDataDTO) => {\n  const finalValue = {\n    ...value,\n    inputs: {\n      ...value?.inputs,\n      content: get(value, 'inputs.content.value.content') as string | undefined,\n    },\n  };\n  // Set the initial value of each field\n  if (typeof finalValue.inputs.inputParameters === 'undefined') {\n    set(finalValue, 'inputs.inputParameters', [{ name: 'output' }]);\n  }\n  return finalValue;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData) => {\n  return {\n    ...value,\n    inputs: {\n      ...value.inputs,\n      content: {\n        type: VariableTypeDTO.string,\n        value: {\n          type: 'literal',\n          content: value.inputs.content,\n        },\n      },\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DEFAULT_NODE_META_PATH } from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { OUTPUT_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const OUTPUT_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.Output,\n  meta: {\n    hideTest: true,\n    nodeDTOType: StandardNodeType.Output,\n    size: { width: 360, height: 78.2 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    helpLink: '/open/docs/guides/message_node',\n  },\n  formMeta: OUTPUT_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputParameters } from '../common/components';\nimport { useFlags } from '@coze-arch/bot-flags';\nimport { MessageContent as OutputContentOld } from '@/components/node-render/node-render-new/content/message-content';\nimport { OutputTextContent } from './components/output-text-content';\nimport { I18n } from '@coze-arch/i18n';\n\nexport function OutputContent() {\n  const [FLAGS] = useFlags();\n  // The community edition does not support this function for the time being\n  if (!FLAGS['bot.automation.output_node_v2']) {\n    return <OutputContentOld />;\n  }\n  return (\n    <>\n      <InputParameters label={I18n.t('workflow_detail_node_output')} />\n      <OutputTextContent />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { keyBy, set, sortBy, cloneDeep } from 'lodash-es';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  ERROR_BODY_NAME,\n  IS_SUCCESS_NAME,\n  type ApiNodeDetailDTO,\n} from '@coze-workflow/nodes';\nimport {\n  BatchMode,\n  BlockInput,\n  ViewVariableType,\n  type InputValueVO,\n  type ViewVariableTreeNode,\n} from '@coze-workflow/base';\n\nimport { type ApiNodeDTODataWhenOnInit } from '../types';\n\n/**\n * Check if plug-in outputs have changed\n * @param prevOutputs\n * @param nextOutputs\n * @returns boolean\n */\nexport function isApiOutputsChanged(\n  prevOutputs: ViewVariableTreeNode[] | undefined,\n  nextOutputs: ViewVariableTreeNode[] | undefined,\n) {\n  if (!prevOutputs && !nextOutputs) {\n    return false;\n  }\n\n  if ((prevOutputs || []).length !== (nextOutputs || []).length) {\n    return true;\n  }\n\n  const sortedPrevOutputs = sortBy(prevOutputs, 'name');\n  const sortedNextOutputs = sortBy(nextOutputs, 'name');\n\n  let isChanged = false;\n\n  for (let i = 0; i < sortedPrevOutputs.length; i++) {\n    const prevOutput = sortedPrevOutputs[i];\n    const nextOutput = sortedNextOutputs[i];\n\n    if (\n      prevOutput.name !== nextOutput.name ||\n      prevOutput.type !== nextOutput.type\n    ) {\n      isChanged = true;\n    } else {\n      isChanged = isApiOutputsChanged(prevOutput.children, nextOutput.children);\n    }\n\n    if (isChanged) {\n      break;\n    }\n  }\n\n  return isChanged;\n}\n\n/**\n * Verify whether the plugin has changed. If there is a change, return true, otherwise return false.\n * @param params api basic parameter list\n * @param inputParameters imported parameters\n * @param apiNodeDetail plugin latest value\n * @returns\n */\nexport function checkPluginUpdated({\n  params,\n  inputParameters,\n  outputs,\n  apiNodeDetail,\n  isBatchMode,\n}: {\n  params: BlockInput[];\n  inputParameters: InputValueVO[];\n  outputs: ViewVariableTreeNode[]; // The outputs parameter has been converted to the front-end variable format\n  isBatchMode: boolean;\n  apiNodeDetail: ApiNodeDetailDTO;\n}): boolean {\n  const oldApiNameParam = params?.find(\n    (item: BlockInput) => item.name === 'apiName',\n  );\n  const oldApiName = oldApiNameParam\n    ? BlockInput.toLiteral(oldApiNameParam)\n    : '';\n  const isApiNameChanged = oldApiName !== apiNodeDetail.apiName;\n\n  // The name of the required parameter that is actually saved (if the optional parameter is filled in, it will also be included)\n  const oldParamNames = (inputParameters || []).map(v => v.name);\n\n  // API-defined parameter names\n  const newParamNames = (apiNodeDetail.inputs || [])?.map(v => v.name);\n\n  // Imported parameter detection currently only detects deleted parameter scenes, and incremental scenes are temporarily difficult to detect\n  const isInputParamsChanged = !oldParamNames.every(paramName =>\n    newParamNames.includes(paramName || ''),\n  );\n\n  const isOutputsChanged = isApiOutputsChanged(\n    // In batch mode, the outermost layer of the variable will wrap an outputList variable\n    // Therefore, if it is batch mode, it is necessary to compare the children of the outputList here.\n    isBatchMode ? outputs?.[0]?.children : outputs,\n    // API output parameters need to be converted into front-end variable format\n    (apiNodeDetail.outputs || []).map(variableUtils.dtoMetaToViewMeta),\n  );\n\n  return isApiNameChanged || isInputParamsChanged || isOutputsChanged;\n}\n\n/**\n * Update the values of apiParam related parameters\n * @param apiParams\n * @param paramName\n * @param updateValue\n */\nfunction updateApiParamValue(\n  apiParams: BlockInput[],\n  paramName: string,\n  updateValue: string,\n) {\n  const apiNameParam = (apiParams || [])?.find(\n    (item: BlockInput) => item.name === paramName,\n  );\n\n  if (apiNameParam) {\n    set(apiNameParam, 'input.value.content', updateValue);\n  }\n}\n\n/**\n * Synchronize plug-in input parameters\n * @param draft current form\n * @Param inputs plugin latest input parameters\n */\nfunction syncInputParameters(\n  draft: ApiNodeDTODataWhenOnInit,\n  inputs: ApiNodeDetailDTO['inputs'],\n) {\n  // Update imported parameters, mainly remove redundant parameters\n  if (draft?.inputs?.inputParameters) {\n    // Get the latest parameter definitions\n    const paramMap = keyBy(inputs, 'name');\n\n    // Only those that exist in the parameter definition are preserved\n    draft.inputs.inputParameters = draft?.inputs?.inputParameters.filter(\n      param => paramMap[param.name || ''],\n    );\n  }\n}\n\n/**\n * Synchronization plug-in output parameters\n * @param draft current form\n * @Param outputs plugin latest output parameters\n */\nfunction syncOutputs(\n  draft: ApiNodeDTODataWhenOnInit,\n  outputs: ApiNodeDetailDTO['outputs'],\n) {\n  const isBatchMode = Boolean(draft.inputs?.batch?.batchEnable);\n\n  // In batch mode, the outermost layer of the variable will wrap an outputList variable\n  // Therefore, if it is batch mode, it is necessary to compare the children of the outputList here.\n  const originOutputs = isBatchMode\n    ? draft.outputs?.[0]?.children\n    : draft.outputs;\n\n  const isOutputChanged = isApiOutputsChanged(\n    (originOutputs || []).filter(\n      v => ![ERROR_BODY_NAME, IS_SUCCESS_NAME].includes(v.name),\n    ),\n    outputs?.map(variableUtils.dtoMetaToViewMeta),\n  );\n\n  if (isOutputChanged) {\n    // Synchronized exported parameters\n    if (outputs) {\n      const outputVal = outputs.map(variableUtils.dtoMetaToViewMeta);\n\n      // Batch mode, regenerate it (reference: packages/workflow/variable/src/legacy/workflow-batch-service)\n      if (isBatchMode) {\n        draft.outputs = [\n          {\n            key: nanoid(),\n            type: ViewVariableType.ArrayObject,\n            name: variableUtils.DEFAULT_OUTPUT_NAME[BatchMode.Batch],\n            children: outputVal,\n          },\n        ];\n      } else {\n        draft.outputs = outputVal;\n      }\n    } else {\n      // There are no exported parameters, you need to delete the original exported parameters.\n      draft.outputs = [];\n    }\n  }\n}\n\n/**\n * If there is an update to the plugin, then synchronize the latest value of the plugin\n * @param value current form\n * @param apiNodeDetail plugin latest value\n * @Returns the updated form\n */\nexport function syncToLatestValue(\n  value: ApiNodeDTODataWhenOnInit,\n  apiNodeDetail: ApiNodeDetailDTO,\n) {\n  const { apiName, updateTime, inputs, outputs } = apiNodeDetail;\n  const draft = cloneDeep(value);\n  const apiParams = draft?.inputs?.apiParam || [];\n  updateApiParamValue(apiParams, 'apiName', apiName);\n  updateApiParamValue(apiParams, 'updateTime', updateTime as string);\n\n  syncInputParameters(draft, inputs);\n  syncOutputs(draft, outputs);\n\n  return draft;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNil } from 'lodash-es';\nimport { type ApiNodeIdentifier } from '@coze-workflow/nodes';\nimport { BlockInput } from '@coze-workflow/base';\n\nexport function getApiNodeIdentifier(\n  apiParam: BlockInput[],\n): ApiNodeIdentifier {\n  // Define the fields to be extracted and how they are converted\n  const fieldsToExtract = [\n    { name: 'apiName', key: 'apiName' },\n    { name: 'pluginID', key: 'pluginID' },\n    { name: 'apiID', key: 'api_id', optional: true },\n    { name: 'pluginVersion', key: 'plugin_version', optional: true },\n  ];\n\n  // Using reduce to build the resulting object\n  return fieldsToExtract.reduce((result, field) => {\n    const blockInput = apiParam.find(\n      (item: BlockInput) => item.name === field.name,\n    );\n\n    if (blockInput) {\n      const value = BlockInput.toLiteral<string>(blockInput);\n      if (!isNil(value)) {\n        result[field.key] = value;\n      }\n    }\n    return result;\n  }, {} as unknown as ApiNodeIdentifier);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { pick } from 'lodash-es';\nimport { type ApiNodeDetailDTO } from '@coze-workflow/nodes';\n\nexport const extractApiNodeData = (\n  apiDetailData: ApiNodeDetailDTO,\n): Partial<ApiNodeDetailDTO> => ({\n  ...pick(apiDetailData, [\n    'icon',\n    'description',\n    'apiName',\n    'pluginID',\n    'pluginProductStatus',\n    'pluginProductUnlistType',\n    'pluginType',\n    'spaceID',\n    'inputs',\n    'outputs',\n    'updateTime',\n    'plugin_from',\n  ]),\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ApiDetailData } from '@coze-arch/bot-api/workflow_api';\n\nexport const computeNodeVersion = (data: ApiDetailData) => {\n  if (!data) {\n    return {};\n  }\n  const isInProject = !!data.projectID;\n\n  if (isInProject) {\n    return {};\n  }\n\n  const {\n    latest_version: latestVersionTs,\n    latest_version_name: latestVersionName,\n    version_name: versionName,\n  } = data;\n\n  return {\n    latestVersionTs,\n    latestVersionName,\n    versionName,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport {\n  ERROR_BODY_NAME,\n  generateErrorBodyMeta,\n  generateIsSuccessMeta,\n  IS_SUCCESS_NAME,\n  type ViewVariableTreeNode,\n} from '@coze-workflow/nodes';\n\nimport { type ApiNodeDTODataWhenOnInit } from '../types';\n\ninterface ErrorSetting {\n  name: string;\n  generate: () => ViewVariableTreeNode;\n}\n\nconst errorSettings: ErrorSetting[] = [\n  {\n    name: ERROR_BODY_NAME,\n    generate: generateErrorBodyMeta,\n  },\n  {\n    name: IS_SUCCESS_NAME,\n    generate: generateIsSuccessMeta,\n  },\n];\n\n/**\n * If the exception switch is turned on, you need to ensure that the errorBody exists in the outputs\n */\nexport function withErrorBody(\n  originValue: ApiNodeDTODataWhenOnInit,\n  value: ApiNodeDTODataWhenOnInit,\n) {\n  const draft = cloneDeep(value);\n\n  const isBatchMode = Boolean(draft.inputs?.batch?.batchEnable);\n  const isSettingOnError = Boolean(draft.inputs?.settingOnError?.switch);\n\n  // In batch mode, the outermost layer of the variable will wrap an outputList variable\n  // Therefore, if it is batch mode, it is necessary to compare the children of the outputList here.\n  const originOutputs =\n    (isBatchMode ? draft.outputs?.[0]?.children : draft.outputs) || [];\n\n  if (isSettingOnError) {\n    errorSettings.forEach(errorSetting =>\n      addErrorSetting(originValue, originOutputs, errorSetting),\n    );\n  }\n\n  return draft;\n}\n\nfunction addErrorSetting(\n  originValue: ApiNodeDTODataWhenOnInit,\n  originOutputs: ApiNodeDTODataWhenOnInit['outputs'],\n  errorSetting: ErrorSetting,\n) {\n  // Find the original errorBody and attach it.\n  const originErrorBody = originValue?.outputs?.find(\n    v => v.name === errorSetting.name,\n  );\n  const hasErrorBody = !!originOutputs.find(v => v.name === errorSetting.name);\n\n  // If there is dirty data, the exception switch is turned on, but errorBody does not exist, you need to add errorBody data\n  // If there is an errorBody in the original outputs, use the original variable data, otherwise regenerate a new one\n  if (!hasErrorBody) {\n    originOutputs.push(originErrorBody ?? errorSetting.generate());\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { PluginNodeService, type PluginNodeStore } from '@/services';\n\nexport const usePluginNodeService = () =>\n  useService<PluginNodeService>(PluginNodeService);\n\nexport const usePluginNodeServiceStore = <T>(\n  selector: (s: PluginNodeStore) => T,\n) => {\n  const pluginService = usePluginNodeService();\n\n  return pluginService.store(selector);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport const INPUTS_PATH = 'inputs';\nexport const OUTPUTS_PATH = 'outputs';\n\nexport const API_PARAMS_KEY = 'apiParam';\nexport const INPUT_PARAMS_KEY = 'inputParameters';\nexport const BATCH_INPUTS_LIST_KEY = 'inputLists';\n\nexport const INPUT_PARAMS_PATH = `${INPUTS_PATH}.${INPUT_PARAMS_KEY}`;\nexport const API_PARAMS_PATH = `${INPUTS_PATH}.${API_PARAMS_KEY}`;\nexport const BATCH_MODE_KEY = 'batchMode';\nexport const BATCH_MODE_PATH = `${INPUTS_PATH}.${BATCH_MODE_KEY}`;\n\nexport const BATCH_KEY = 'batch';\nexport const BATCH_PATH = `${INPUTS_PATH}.${BATCH_KEY}`;\nexport const BATCH_INPUT_LIST_PATH = `${BATCH_PATH}.${BATCH_INPUTS_LIST_KEY}`;\n\nexport const COLUMNS = [\n  {\n    label: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 148 },\n  },\n  { label: I18n.t('workflow_detail_end_output_value') },\n];\n\nexport const NOT_FREE_PLUGINS_APINAME_DOC_MAP = {\n  add_text_to_image: '/open/docs/guides/add_text_to_image_plugin',\n  sd_better_prompt: '/open/docs/guides/better_prompt_plugin',\n  cut_image: '/open/docs/guides/cut_image_plugin',\n  add_image_to_image: '/open/docs/guides/add_image_to_image_plugin',\n  resize: '/open/docs/guides/resize_image_plugin',\n  image_rotate: '/open/docs/guides/rotate_image_plugin',\n  FacePretty: '/open/docs/guides/facepretty_plugin',\n  change: '/open/docs/guides/change_image_plugin',\n  text2image: '/open/docs/guides/byteartist_plugin',\n  background_change: '/open/docs/guides/change_background_plugin',\n  spring_pets_image: '/open/docs/guides/pet_image_plugin',\n  gen_image: '/open/docs/guides/doubao_image_plugin',\n  style_transfer: '/open/docs/guides/style_transfer_plugin',\n  light: '/open/docs/guides/light_plugin',\n  image_quality_improve: '/open/docs/guides/improve_image_quality_plugin',\n  image_change: '/open/docs/guides/instruction_editing_plugin',\n  swap_face: '/open/docs/guides/swap_face_plugin',\n  cutout: '/open/docs/guides/cutout_plugin',\n  intelligentImageExpansion:\n    '/open/docs/guides/intelligent_image_expansion_plugin',\n  gen_song: '/open/docs/guides/doubao_song_plugin',\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { type ApiNodeDetailDTO } from '@coze-workflow/nodes';\nimport { type DebugExample } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { useViewExample } from '@coze-agent-ide/bot-plugin-tools/useViewExample';\nimport { Typography, ConfigProvider } from '@coze-arch/coze-design';\n\ninterface Props {\n  debugExample: DebugExample;\n  inputs: ApiNodeDetailDTO['inputs'];\n}\n\nexport const ViewExample = (props: Props) => {\n  const { debugExample, inputs } = props;\n\n  const { exampleNode, doShowExample } = useViewExample();\n\n  const handleClick = () => {\n    doShowExample({\n      scene: 'workflow',\n      requestParams: inputs,\n      debugExample,\n    });\n  };\n\n  if (!debugExample) {\n    return null;\n  }\n\n  // The special thing about workflow is that at the node level, the popupcontainer is set on the node rather than the canvas\n  // Therefore, you need to configure the popupContainer through the ConfigProvider, overriding the ConfigProvider on the NodeRender.\n  // Otherwise it will not be displayed at the node level\n  return (\n    <ConfigProvider getPopupContainer={() => document.body}>\n      {exampleNode}\n\n      <Typography.Text\n        className=\"cursor-pointer absolute top-[16px] right-[10px] text-xs\"\n        onClick={handleClick}\n        link\n      >\n        {I18n.t('plugin_edit_tool_view_example')}\n      </Typography.Text>\n    </ConfigProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useQuery } from '@tanstack/react-query';\nimport { ProductEntityType } from '@coze-arch/bot-api/product_api';\nimport { ProductApi } from '@coze-arch/bot-api';\n\ninterface Params {\n  pluginId: string;\n  /** Do you need to request the store ID? If it is a locally developed plug-in, it is not on the shelves. You don't need to request it, just return the pluginId directly. */\n  needQuery: boolean;\n}\n\n/** Internal cache, key is pluginID, value is pluginId productId in store */\nconst cache = new Map<string, string>();\n\nexport function usePluginDetail({ pluginId, needQuery }: Params) {\n  const { isLoading, data } = useQuery({\n    queryKey: ['plugin-detail', pluginId],\n    // Failed Try again to avoid jitter\n    retry: 1,\n    queryFn: async () => {\n      if (!needQuery) {\n        return pluginId;\n      }\n\n      // If the cache is hit\n      if (cache.get(pluginId)) {\n        return cache.get(pluginId);\n      }\n\n      const res = await ProductApi.PublicGetProductDetail(\n        {\n          entity_type: ProductEntityType.Plugin,\n          entity_id: pluginId,\n          need_audit_failed: true,\n          product_id: '',\n        },\n        {\n          __disableErrorToast: true,\n        },\n      );\n\n      const id = res?.data?.meta_info?.id;\n      if (id) {\n        cache.set(pluginId, id);\n      }\n\n      return id;\n    },\n  });\n\n  return { isLoading, storePluginId: data };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useSearchParams } from 'react-router-dom';\nimport React from 'react';\n\nimport { type ApiNodeIdentifier } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozLoading, IconCozExit } from '@coze-arch/coze-design/icons';\nimport { PluginFrom } from '@coze-arch/bot-api/playground_api';\nimport { PluginProductStatus } from '@coze-arch/bot-api/developer_api';\n\nimport { useGlobalState } from '@/hooks';\n\nimport { usePluginDetail } from '../hooks/use-plugin-detail';\nimport { usePluginNodeServiceStore } from '../hooks';\n\nfunction getJumpDetailText() {\n  return I18n.t('mkpl_plugin_detail', {}, 'Plugin Detail');\n}\n\nexport const PluginLink = ({\n  identifier,\n}: {\n  identifier: ApiNodeIdentifier;\n}) => {\n  const { getApiNodeDetail } = usePluginNodeServiceStore(state => ({\n    getApiNodeDetail: state.getData,\n  }));\n  const { getProjectApi } = useGlobalState();\n  const [searchParams] = useSearchParams();\n  const spaceIdFromUrl = searchParams.get('space_id');\n  const apiNodeDetail = getApiNodeDetail(identifier);\n\n  const {\n    spaceID: spaceId,\n    pluginID: pluginId,\n    projectID: projectId,\n    pluginProductStatus,\n    plugin_from,\n  } = apiNodeDetail || {};\n\n  // In the same space, and the status is to be submitted plug-ins, jump directly /space/xxx/plugin/yyy\n  const noNeedQuery =\n    spaceIdFromUrl === spaceId &&\n    pluginProductStatus === PluginProductStatus.Default;\n\n  const { isLoading, storePluginId } = usePluginDetail({\n    pluginId: pluginId || '',\n    needQuery: !noNeedQuery,\n  });\n\n  // The operation and maintenance platform does not need to display plug-ins, jump links\n  if (IS_BOT_OP) {\n    return null;\n  }\n\n  if (isLoading) {\n    return <IconCozLoading className=\"animate-spin text-xs coz-fg-dim\" />;\n  }\n\n  const handleClick = (e: React.MouseEvent<HTMLSpanElement, MouseEvent>) => {\n    const ideNavigate = getProjectApi()?.navigate;\n    if (IS_OPEN_SOURCE && plugin_from === PluginFrom.FromSaas) {\n      const url = window.atob('aHR0cHM6Ly93d3cuY296ZS5jbg==');\n      window.open(`${url}/store/plugin/${pluginId}?plugin_id=true`, '_blank');\n    } else if (projectId && projectId !== '0' && ideNavigate) {\n      ideNavigate(`/plugin/${pluginId}`);\n    } else {\n      const url =\n        storePluginId && !noNeedQuery\n          ? `/store/plugin/${storePluginId}` // Other status (on the shelves, off the shelves, under review)\n          : `/space/${spaceId}/plugin/${pluginId}`; // Not on the shelves\n      window.open(url, '_blank');\n    }\n    e.stopPropagation();\n  };\n\n  return (\n    <span\n      className=\"cursor-pointer flex items-center w-full justify-between\"\n      onClick={handleClick}\n    >\n      {getJumpDetailText()}\n      <IconCozExit className=\"text-xs\" />\n    </span>\n  );\n};\n\nexport const createPluginLink = (identifier: ApiNodeIdentifier) => (\n  <PluginLink identifier={identifier} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FormRenderProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { Batch } from '@/nodes-v2/components/batch/batch';\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { useWatch } from '@/form';\n\nimport { InputsKVField, OutputsField, BatchModeField } from '../common/fields';\nimport { getApiNodeIdentifier } from './utils';\nimport type { ApiNodeFormData } from './types';\nimport { usePluginNodeServiceStore } from './hooks/use-plugin-node-service';\nimport { BATCH_MODE_PATH, INPUT_PARAMS_PATH } from './constants';\nimport { ViewExample } from './components/view-example';\nimport { PluginLink } from './components/plugin-link';\n\nexport const FormRender = ({ form }: FormRenderProps<ApiNodeFormData>) => {\n  const { loading, getApiNodeDetail } = usePluginNodeServiceStore(\n    useShallow(s => ({\n      loading: s.loading,\n      getApiNodeDetail: s.getData,\n    })),\n  );\n\n  const indentifier = getApiNodeIdentifier(\n    form.initialValues?.inputs?.apiParam || [],\n  );\n\n  const apiDetail = getApiNodeDetail(indentifier);\n  const inputsDef = apiDetail?.inputs ?? [];\n\n  const batchMode = useWatch<string>(BATCH_MODE_PATH);\n\n  if (loading) {\n    return null;\n  }\n\n  return (\n    <NodeConfigForm\n      extraOperation={<PluginLink identifier={indentifier} />}\n      batchModePath={BATCH_MODE_PATH}\n    >\n      <BatchModeField name={BATCH_MODE_PATH} />\n\n      <Batch batchModeName={BATCH_MODE_PATH} name={'inputs.batch'} />\n\n      <InputsKVField\n        name={INPUT_PARAMS_PATH}\n        inputsDef={inputsDef}\n        hasFeedback={false}\n      />\n\n      <div className=\"relative node-v2-outputs\">\n        <OutputsField\n          title={I18n.t('workflow_detail_node_output')}\n          tooltip={I18n.t('node_http_response_data')}\n          id=\"plugin-node-outputs\"\n          name=\"outputs\"\n          batchMode={batchMode}\n          topLevelReadonly={true}\n          customReadonly\n        />\n\n        <ViewExample\n          inputs={inputsDef}\n          debugExample={apiDetail?.debug_example}\n        />\n      </div>\n    </NodeConfigForm>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  nodeUtils,\n  getSortedInputParameters,\n  type ApiNodeDetailDTO,\n  WorkflowNodeData,\n} from '@coze-workflow/nodes';\nimport {\n  ValueExpressionType,\n  StandardNodeType,\n  type ValueExpression,\n} from '@coze-workflow/base';\n\nimport { type WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { type NodeMeta } from '@/typing';\nimport { PluginNodeService } from '@/services';\n\nimport { getCustomSetterProps, getCustomVal } from '../common/utils';\nimport {\n  checkPluginUpdated,\n  syncToLatestValue,\n} from './utils/api-node-checker';\nimport {\n  extractApiNodeData,\n  getApiNodeIdentifier,\n  computeNodeVersion,\n  withErrorBody,\n} from './utils';\nimport type { ApiNodeDTODataWhenOnInit, ApiNodeFormData } from './types';\n\nconst getPluginNodeService = (context: WorkflowPlaygroundContext) =>\n  context.entityManager.getService<PluginNodeService>(PluginNodeService);\n\nconst getApiDetailApiParam = (nodeJson: ApiNodeDTODataWhenOnInit) =>\n  nodeJson?.inputs?.apiParam || [];\n\nconst getApiDetail = (\n  nodeJson: ApiNodeDTODataWhenOnInit,\n  context: WorkflowPlaygroundContext,\n) => {\n  const pluginService = getPluginNodeService(context);\n  const identifier = getApiNodeIdentifier(getApiDetailApiParam(nodeJson));\n  return pluginService.getApiDetail(identifier);\n};\n\nconst syncToApiNodeData = ({\n  node,\n  context,\n  apiDetail,\n  nodeMeta,\n}: {\n  node: FlowNodeEntity;\n  context: WorkflowPlaygroundContext;\n  apiDetail: ApiNodeDetailDTO;\n  nodeMeta: NodeMeta;\n}) => {\n  const { getNodeTemplateInfoByType } = context;\n  const nodeDataEntity = node.getData<WorkflowNodeData>(WorkflowNodeData);\n\n  // For plugins, initializing the form data also requires resetting the nodeData data reset\n  nodeDataEntity.init();\n\n  // Here, if the plugin is deleted, you also need to set nodeMeta to display specific error messages.\n  if (!apiDetail && nodeMeta) {\n    nodeDataEntity.setNodeData<StandardNodeType.Api>({\n      ...nodeMeta,\n    });\n    return;\n  }\n\n  /**\n   * Extract some NodeData of the API node from apiDetail and set it into NodeDataEntity.\n   */\n  const apiNodeData = extractApiNodeData(apiDetail);\n\n  nodeDataEntity.setNodeData<StandardNodeType.Api>({\n    ...apiNodeData,\n    ...computeNodeVersion(apiDetail),\n\n    // This is the default description of the plugin. The newly modified description needs to be obtained from nodeMeta.description.\n    description: apiDetail.desc || '',\n    title: apiDetail.name || '',\n    icon: apiDetail.icon || '',\n    mainColor: getNodeTemplateInfoByType(StandardNodeType.Api)?.mainColor ?? '',\n    // Here some historical data depends on the projectId, such as use-node-origination.ts\n    projectId: apiDetail.projectID,\n  });\n};\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: ApiNodeDTODataWhenOnInit,\n  context: NodeFormContext,\n): ApiNodeFormData => {\n  const { node, playgroundContext } = context;\n  const apiDetail = getApiDetail(value, playgroundContext);\n\n  // Synchronize apiDetail data to WorkflowNodeData, where a lot of business logic fetches data, including the error interface\n  syncToApiNodeData({\n    node,\n    context: playgroundContext,\n    apiDetail,\n    nodeMeta: value.nodeMeta,\n  });\n\n  if (!apiDetail) {\n    return value as unknown as ApiNodeFormData;\n  }\n\n  // Check if the plugin has been updated (apiName, inputs, outputs)\n  const isUpdated = checkPluginUpdated({\n    params: value?.inputs?.apiParam ?? [],\n    inputParameters: value.inputs.inputParameters ?? [],\n    outputs: value.outputs,\n    isBatchMode: Boolean(value.inputs?.batch?.batchEnable),\n    apiNodeDetail: apiDetail,\n  });\n\n  // There is an update, update the inPluginUpdated value, after the practice runs, reset the value of inPluginUpdated\n  if (isUpdated) {\n    context.playgroundContext.globalState.inPluginUpdated = true;\n  }\n\n  // If there is an update, synchronize the latest data (apiName, inputs, outputs)\n  let latestValue = isUpdated ? syncToLatestValue(value, apiDetail) : value;\n\n  // In the previous method syncOutputs to synchronize the plug-in output data, if the plug-in output parameters are changed, the errorBody parameter will be ignored\n  // Here, add the errorBody again. In fact, it is better to put this logic in syncOutputs.\n  latestValue = withErrorBody(value, latestValue);\n\n  const { inputs } = latestValue || {};\n  const inputParameters = inputs?.inputParameters || [];\n\n  const { inputs: pluginInputs, outputs: pluginOutputs } = apiDetail;\n\n  // Since variables that are not filled in will be filtered out during commit, the default value needs to be added during initialization\n  // See also: packages/workflow/nodes/src/workflow-json-format: 241\n  const refillInputParamters = getSortedInputParameters(pluginInputs).map(\n    inputParam => {\n      const { key, defaultValue } = getCustomSetterProps(inputParam) || {};\n      const isCustomSetter = !!key;\n\n      const newValue = {\n        name: inputParam.name,\n        input: isCustomSetter\n          ? defaultValue\n          : {\n              type: ValueExpressionType.REF,\n            },\n      };\n\n      const target = inputParameters.find(\n        item => item.name === inputParam.name,\n      );\n\n      if (target) {\n        // Custom component correction custom value\n        if (isCustomSetter) {\n          // The value of a custom component does not need to be formatted in ValueExpression\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          target.input = getCustomVal(target.input, inputParam) as any;\n        }\n\n        return target;\n      }\n      return newValue;\n    },\n  );\n\n  const inputParametersMap = refillInputParamters.reduce((acc, cur) => {\n    if (cur.name) {\n      acc[cur.name] = cur.input;\n    }\n    return acc;\n  }, {});\n\n  const result = {\n    nodeMeta: latestValue?.nodeMeta,\n    inputs: {\n      ...inputs,\n      batchMode: inputs?.batch?.batchEnable ? 'batch' : 'single',\n      batch: inputs?.batch?.batchEnable\n        ? nodeUtils.batchToVO(inputs.batch, context)\n        : undefined,\n\n      inputParameters: inputParametersMap,\n    },\n    outputs:\n      latestValue?.outputs ??\n      (pluginOutputs ?? []).map(variableUtils.dtoMetaToViewMeta),\n  };\n\n  return result;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (\n  value: ApiNodeFormData,\n  context: NodeFormContext,\n): ApiNodeDTODataWhenOnInit => {\n  const { node } = context;\n\n  const apiDetail = node\n    .getData<WorkflowNodeData>(WorkflowNodeData)\n    .getNodeData<StandardNodeType.Api>();\n\n  const isBatch = value?.inputs?.batchMode === 'batch';\n  const batchDTO = nodeUtils.batchToDTO(value?.inputs?.batch, context);\n\n  const submitValue = {\n    nodeMeta: value?.nodeMeta,\n    inputs: {\n      ...value?.inputs,\n\n      batchMode: undefined,\n      batch:\n        isBatch && batchDTO\n          ? {\n              batchEnable: true,\n              ...batchDTO,\n            }\n          : undefined,\n\n      inputParameters: Object.entries(value?.inputs?.inputParameters || {})\n        .map(([key, innerValue]) => {\n          const inputDef = apiDetail?.inputs?.find(item => item.name === key);\n          const customSetterProps = inputDef\n            ? getCustomSetterProps(inputDef)\n            : { key: undefined };\n          const isCustomSetter = !!customSetterProps?.key;\n          const customProps: ValueExpression = {\n            type: ValueExpressionType.LITERAL,\n            content: `${innerValue}`,\n          };\n          return {\n            name: key,\n            input: isCustomSetter ? customProps : innerValue,\n          };\n        })\n        .filter(item => item.name),\n    },\n    outputs: value?.outputs,\n  };\n  return submitValue;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n  type FlowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport { type StandardNodeType } from '@coze-workflow/base';\n\nimport { createProvideNodeBatchVariables } from '@/nodes-v2/materials/provide-node-batch-variable';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type ApiNodeFormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { BATCH_INPUT_LIST_PATH, BATCH_MODE_PATH } from './constants';\n\nexport const PLUGIN_FORM_META: FormMetaV2<ApiNodeFormData> = {\n  // Node form rendering\n  render: props => <FormRender {...props} />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n\n    // Verify imported parameters\n    'inputs.inputParameters.*': createValueExpressionInputValidate({\n      // Whether it is required or not needs to be calculated according to the function to obtain the required value of the corresponding field\n      required: ({ name, context }) => {\n        const { node } = context;\n\n        const apiDetail = (node as FlowNodeEntity)\n          .getData<WorkflowNodeData>(WorkflowNodeData)\n          .getNodeData<StandardNodeType.Api>();\n\n        const fieldName = (name as string).replace(\n          'inputs.inputParameters.',\n          '',\n        );\n\n        const inputDef = apiDetail?.inputs?.find(v => v.name === fieldName);\n        return Boolean(inputDef?.required);\n      },\n    }),\n\n    // Verify the names of batch imported parameters\n    'inputs.batch.inputLists.*.name': createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'batch.inputLists') || []).map(item => item.name),\n      skipValidate: ({ formValues }) =>\n        formValues?.inputs?.batchMode === 'single',\n    }),\n\n    // Validation of batch imported parameters\n    'inputs.batch.inputLists.*.input': createValueExpressionInputValidate({\n      required: true,\n      skipValidate: ({ formValues }) =>\n        formValues?.inputs?.batchMode === 'single',\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n\n    [BATCH_MODE_PATH]: createProvideNodeBatchVariables(\n      BATCH_MODE_PATH,\n      BATCH_INPUT_LIST_PATH,\n    ),\n\n    [BATCH_INPUT_LIST_PATH]: createProvideNodeBatchVariables(\n      BATCH_MODE_PATH,\n      BATCH_INPUT_LIST_PATH,\n    ),\n\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n  DEFAULT_BATCH_PATH,\n  type ApiNodeDataDTO,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeJSON,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\nimport { PluginFrom } from '@coze-arch/bot-api/playground_api';\n\nimport { type WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { type NodeTestMeta } from '@/test-run-kit';\nimport { PluginNodeService } from '@/services';\n\nimport { getApiNodeIdentifier } from './utils';\nimport { type ApiNodeFormData } from './types';\nimport { test } from './node-test';\nimport { PLUGIN_FORM_META } from './form-meta';\nimport {\n  INPUT_PARAMS_PATH,\n  NOT_FREE_PLUGINS_APINAME_DOC_MAP,\n} from './constants';\nimport { createPluginLink } from './components/plugin-link';\n\ntype ApiNodeData = WorkflowNodeJSON<ApiNodeDataDTO['data']>;\n\nconst getPluginNodeService = (context: WorkflowPlaygroundContext) =>\n  context.entityManager.getService<PluginNodeService>(PluginNodeService);\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst getApiDetailApiParam = (nodeJson: any) =>\n  nodeJson.data?.inputs?.apiParam || nodeJson?.inputs?.apiParam || [];\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst getPluginFrom = (nodeJson: any) =>\n  nodeJson.data?.inputs?.pluginFrom || nodeJson?.inputs?.pluginFrom;\n\nexport const PLUGIN_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Api,\n  meta: {\n    nodeDTOType: StandardNodeType.Api,\n    size: { width: 360, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    batchPath: DEFAULT_BATCH_PATH,\n    inputParametersPath: INPUT_PARAMS_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    test,\n    helpLink: ({ apiName }) =>\n      NOT_FREE_PLUGINS_APINAME_DOC_MAP[apiName] ||\n      '/open/docs/guides/plugin_node',\n  },\n  formMeta: PLUGIN_FORM_META,\n\n  onInit: async (nodeJson, context: WorkflowPlaygroundContext) => {\n    if (!nodeJson) {\n      return;\n    }\n\n    const pluginService = getPluginNodeService(context);\n    const pluginFrom = getPluginFrom(nodeJson);\n    const identifier = getApiNodeIdentifier(\n      getApiDetailApiParam(nodeJson as ApiNodeData),\n    );\n    await pluginService.load(identifier, pluginFrom);\n  },\n\n  checkError: (nodeJson, context: WorkflowPlaygroundContext) => {\n    if (!nodeJson) {\n      return undefined;\n    }\n    const pluginService = getPluginNodeService(context);\n    const identifier = getApiNodeIdentifier(\n      getApiDetailApiParam(nodeJson as ApiNodeData),\n    );\n    return pluginService.getApiError(identifier);\n  },\n\n  getHeaderExtraOperation: (formValues: ApiNodeFormData) => {\n    const identifier = getApiNodeIdentifier(formValues?.inputs?.apiParam ?? []);\n\n    if (\n      IS_OPEN_SOURCE &&\n      formValues?.inputs?.pluginFrom !== PluginFrom.FromSaas\n    ) {\n      return null;\n    }\n\n    return createPluginLink(identifier);\n  },\n\n  onDispose: (nodeJson, context: WorkflowPlaygroundContext) => {\n    if (!nodeJson) {\n      return;\n    }\n    const pluginService = getPluginNodeService(context);\n    const identifier = getApiNodeIdentifier(\n      getApiDetailApiParam(nodeJson as ApiNodeData),\n    );\n    pluginService.clearApiError(identifier);\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport { type StandardNodeType } from '@coze-workflow/base';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormBatchProperties(node) {\n    const batchModePath = '/inputs/batchMode';\n    const batchMode = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath(batchModePath);\n    const path = node.getNodeMeta()?.batchPath;\n    if (batchMode !== 'batch' || !path) {\n      return {};\n    }\n    const batchData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath(path);\n    return generateParametersToProperties(batchData, { node });\n  },\n  generateFormInputProperties(node) {\n    const nodeData = node.getData<WorkflowNodeData>(WorkflowNodeData);\n    const detail = nodeData.getNodeData<StandardNodeType.Api>();\n    const inputs = detail?.inputs;\n    if (!inputs || !Array.isArray(inputs)) {\n      return {};\n    }\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputData = formData?.inputs?.inputParameters || {};\n    const inputParameters = inputs.map(i => ({\n      input: inputData[i.name],\n      name: i.name,\n      required: i.required,\n    }));\n\n    return generateParametersToProperties(inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { useWorkflowNode } from '@coze-workflow/base';\n\nimport { useDependencyService } from '@/hooks';\n\nimport { InputParameters, Outputs } from '../common/components';\nimport { getApiNodeIdentifier } from './utils';\nimport { usePluginNodeService } from './hooks';\n\nexport function PluginContent() {\n  const { data } = useWorkflowNode();\n  const pluginService = usePluginNodeService();\n  const indentifier = getApiNodeIdentifier(data?.inputs?.apiParam || []);\n  const node = useCurrentEntity();\n  const dependencyService = useDependencyService();\n\n  useEffect(() => {\n    if (!indentifier) {\n      return;\n    }\n\n    const disposable = dependencyService.onDependencyChange(props => {\n      if (!props?.extra?.nodeIds?.includes(node.id)) {\n        return;\n      }\n      pluginService.load(indentifier);\n    });\n\n    return () => {\n      disposable?.dispose?.();\n    };\n  }, [indentifier]);\n\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  PlaygroundContext,\n  WorkflowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  type RefExpression,\n  type ViewVariableMeta,\n  type ViewVariableType,\n  WorkflowNode,\n} from '@coze-workflow/base';\n\nexport const getLeftRightVariable = (params: {\n  node: WorkflowNodeEntity;\n  name: string;\n  playgroundContext: PlaygroundContext;\n}): {\n  left: ViewVariableMeta;\n  right: ViewVariableMeta;\n  leftPath?: string[];\n  rightPath?: string[];\n  leftType?: ViewVariableType;\n  rightType?: ViewVariableType;\n} => {\n  const { node, playgroundContext, name } = params;\n  const workflowNode = new WorkflowNode(node);\n\n  const index = Number(name.slice(23, 24));\n\n  const left = workflowNode.getValueByPath<RefExpression>(\n    `inputs.inputParameters.${index}.left`,\n  );\n  const right = workflowNode.getValueByPath<RefExpression>(\n    `inputs.inputParameters.${index}.right`,\n  );\n  const leftKeyPath = left?.content?.keyPath ?? [];\n  const rightKeyPath = right?.content?.keyPath ?? [];\n\n  const leftVariable =\n    playgroundContext.variableService.getViewVariableByKeyPath(leftKeyPath, {\n      node,\n    });\n\n  const rightVariable =\n    playgroundContext.variableService.getViewVariableByKeyPath(rightKeyPath, {\n      node,\n    });\n\n  return {\n    left: leftVariable,\n    right: rightVariable,\n    leftPath: left?.content?.keyPath,\n    rightPath: right?.content?.keyPath,\n    leftType: left.rawMeta?.type ?? leftVariable?.type,\n    rightType: right.rawMeta?.type ?? rightVariable?.type,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type RefExpression, useNodeTestId } from '@coze-workflow/base';\n\nimport { MutableVariableAssign } from '@/form-extensions/components/mutable-variable-assign';\nimport { useField, withField } from '@/form';\n\nimport type { SetVariableItem } from '../types';\n\ninterface MutableVariableAssignFieldProps {\n  right: RefExpression;\n  inputParameters: SetVariableItem[];\n  index: number;\n}\n\nexport const MutableVariableAssignField =\n  withField<MutableVariableAssignFieldProps>(\n    ({ right, inputParameters, index }) => {\n      const node = useCurrentEntity();\n      const { name, value, onChange, readonly } = useField<RefExpression>();\n      const { getNodeSetterId } = useNodeTestId();\n      const testId = getNodeSetterId(name);\n\n      return (\n        <MutableVariableAssign\n          value={value}\n          onChange={onChange}\n          readonly={readonly}\n          right={right}\n          inputParameters={inputParameters}\n          index={index}\n          node={node}\n          testId={testId}\n        />\n      );\n    },\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport {\n  FieldArray,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type RefExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\nimport {\n  AddButton,\n  FieldArrayItem,\n  FieldRows,\n  Section,\n  type FieldProps,\n} from '@/form';\n\nimport { type SetVariableItem } from '../types';\nimport { MutableVariableAssignField } from './mutable-variable-assign';\n\ninterface SetVariableFieldProps extends FieldProps<SetVariableItem[]> {\n  title?: string;\n  nthCannotDeleted?: number;\n}\n\nexport const SetVariableField = ({\n  name,\n  defaultValue,\n  title = I18n.t('workflow_loop_set_variable_set'),\n  tooltip,\n  nthCannotDeleted = 1,\n}: SetVariableFieldProps) => {\n  const readonly = useReadonly();\n  return (\n    <FieldArray<SetVariableItem> name={name} defaultValue={defaultValue ?? []}>\n      {({ field }: FieldArrayRenderProps<SetVariableItem>) => {\n        const { value = [], delete: remove, append } = field;\n        const length = value?.length ?? 0;\n        const isEmpty = !length;\n        const disableRemove = nthCannotDeleted === length;\n        return (\n          <Section\n            title={title}\n            tooltip={tooltip}\n            actions={\n              !readonly\n                ? [\n                    <AddButton\n                      onClick={() => {\n                        append({\n                          left: {} as RefExpression,\n                          right: {} as RefExpression,\n                        });\n                      }}\n                    />,\n                  ]\n                : []\n            }\n            isEmpty={isEmpty}\n            emptyText={I18n.t('workflow_inputs_empty')}\n          >\n            <ColumnsTitleWithAction\n              columns={[\n                {\n                  title: I18n.t('workflow_loop_set_variable_loopvariable'),\n                  style: {\n                    width: '50%',\n                  },\n                },\n                {\n                  title: I18n.t('workflow_loop_set_variable_variable'),\n                  style: {\n                    width: '50%',\n                  },\n                },\n              ]}\n              readonly={readonly}\n              className=\"mb-[8px]\"\n              style={{\n                display: isEmpty ? 'none' : 'flex',\n              }}\n            />\n            <FieldRows>\n              {field.map((item, index) => (\n                <FieldArrayItem\n                  key={item.key}\n                  disableRemove={disableRemove}\n                  hiddenRemove={readonly}\n                  onRemove={() => remove(index)}\n                >\n                  <div style={{ width: '50%' }}>\n                    <MutableVariableAssignField\n                      name={`${item.name}.left`}\n                      right={item.value.right}\n                      inputParameters={value}\n                      index={index}\n                    />\n                  </div>\n                  <div style={{ width: '50%' }}>\n                    <ValueExpressionInputField\n                      name={`${item.name}.right`}\n                      literalDisabled={true}\n                    />\n                  </div>\n                </FieldArrayItem>\n              ))}\n            </FieldRows>\n          </Section>\n        );\n      }}\n    </FieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport { INPUT_PATH } from './constants';\nimport { SetVariableField } from './fields';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <SetVariableField name={INPUT_PATH} />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport {\n  VariableAssignLeftValidator,\n  VariableAssignRightValidator,\n} from './validators';\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const SET_VARIABLE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputs.inputParameters.*.left': VariableAssignLeftValidator,\n    'inputs.inputParameters.*.right': VariableAssignRightValidator,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport type { RefExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { valueExpressionValidator } from '@/form-extensions/validators';\n\nimport { getLeftRightVariable } from '../utils';\n\nexport const VariableAssignLeftValidator: Validate<RefExpression> = (params => {\n  const { context, value, name } = params;\n  const { playgroundContext, node } = context;\n  const valueExpressionValid = valueExpressionValidator({\n    value,\n    playgroundContext,\n    node,\n    required: true,\n  });\n\n  if (valueExpressionValid) {\n    return valueExpressionValid;\n  }\n\n  const { left, right, leftPath, rightPath, leftType, rightType } =\n    getLeftRightVariable({\n      node,\n      name,\n      playgroundContext,\n    });\n\n  if (!left) {\n    return I18n.t('workflow_detail_node_error_empty');\n  }\n\n  if (right && leftType !== rightType) {\n    return I18n.t('workflow_loop_set_variable_typewrong');\n  }\n\n  if (leftPath && rightPath && leftPath.join('.') === rightPath.join('.')) {\n    return I18n.t('workflow_loop_set_variable_samewrong');\n  }\n\n  return true;\n}) as Validate<RefExpression>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable  @typescript-eslint/naming-convention*/\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport type { RefExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { valueExpressionValidator } from '@/form-extensions/validators';\n\nimport { getLeftRightVariable } from '../utils';\n\nexport const VariableAssignRightValidator: Validate<RefExpression> =\n  (params => {\n    const { context, value, name } = params;\n    const { playgroundContext, node } = context;\n    const valueExpressionValid = valueExpressionValidator({\n      value,\n      playgroundContext,\n      node,\n      required: true,\n    });\n\n    if (valueExpressionValid) {\n      return valueExpressionValid;\n    }\n\n    const { right } = getLeftRightVariable({ node, name, playgroundContext });\n\n    if (!right) {\n      return I18n.t('workflow_detail_node_error_empty');\n    }\n\n    return true;\n  }) as Validate<RefExpression>;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  ValueExpressionType,\n  type NodeDataDTO,\n  type RefExpression,\n  type ValueExpression,\n  type ValueExpressionDTO,\n} from '@coze-workflow/base';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (formData: any, ctx: any) => {\n  const inputParameterDTOs: {\n    left: ValueExpressionDTO;\n    right: ValueExpressionDTO;\n  }[] = formData?.inputs?.inputParameters ?? [];\n\n  const inputParameterVOs: {\n    left: ValueExpression;\n    right: ValueExpression;\n  }[] = inputParameterDTOs\n    .map(inputParameterDTO => {\n      const leftVariableDTO = inputParameterDTO?.left;\n      const rightVariableDTO = inputParameterDTO?.right;\n\n      if (!leftVariableDTO || !rightVariableDTO) {\n        return;\n      }\n\n      const leftVariableVO = variableUtils.valueExpressionToVO(\n        leftVariableDTO,\n        ctx.playgroundContext.variableService,\n      );\n      const rightVariableVO = variableUtils.valueExpressionToVO(\n        rightVariableDTO,\n        ctx.playgroundContext.variableService,\n      );\n\n      return {\n        left: leftVariableVO,\n        right: rightVariableVO,\n      };\n    })\n    .filter(Boolean) as {\n    left: ValueExpression;\n    right: ValueExpression;\n  }[];\n\n  const defaultInputParameterVOs = [\n    {\n      left: {\n        type: ValueExpressionType.REF,\n      },\n      right: {\n        type: ValueExpressionType.REF,\n      },\n    },\n  ];\n\n  return {\n    ...(formData ?? {}),\n    inputs: {\n      ...(formData?.inputs ?? {}),\n      inputParameters:\n        inputParameterVOs.length === 0\n          ? defaultInputParameterVOs\n          : inputParameterVOs,\n    },\n  };\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (formData: any, ctx: any): NodeDataDTO => {\n  const inputParameterVOs: {\n    left: ValueExpression;\n    right: ValueExpression;\n  }[] = formData?.inputs?.inputParameters ?? [];\n\n  const inputParameterDTOs: {\n    left: ValueExpressionDTO;\n    right: ValueExpressionDTO;\n  }[] = inputParameterVOs\n    .map(inputParameterVO => {\n      const leftVariableVO = inputParameterVO?.left as RefExpression;\n      const rightVariableVO = inputParameterVO?.right as RefExpression;\n\n      if (!leftVariableVO || !rightVariableVO) {\n        return;\n      }\n\n      const leftKeyPath = leftVariableVO.content?.keyPath;\n      const rightKeyPath = rightVariableVO.content?.keyPath;\n\n      if (\n        !leftKeyPath ||\n        !rightKeyPath ||\n        !leftKeyPath[0] ||\n        !rightKeyPath[0]\n      ) {\n        return;\n      }\n\n      const leftVariableDTO = variableUtils.valueExpressionToDTO(\n        leftVariableVO,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      );\n      const rightVariableDTO = variableUtils.valueExpressionToDTO(\n        rightVariableVO,\n        ctx.playgroundContext.variableService,\n        { node: ctx.node },\n      );\n\n      if (!leftVariableDTO || !rightVariableDTO) {\n        return;\n      }\n\n      return {\n        left: leftVariableDTO,\n        right: rightVariableDTO,\n      };\n    })\n    .filter(Boolean) as {\n    left: ValueExpressionDTO;\n    right: ValueExpressionDTO;\n  }[];\n\n  return {\n    ...(formData ?? {}),\n    inputs: {\n      ...(formData?.inputs ?? {}),\n      inputParameters: inputParameterDTOs,\n    },\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { SET_VARIABLE_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const SET_VARIABLE_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.SetVariable,\n  meta: {\n    hideTest: true,\n    nodeDTOType: StandardNodeType.SetVariable,\n    size: { width: 360, height: 87.86 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n  },\n  variablesMeta: {\n    outputsPathList: [],\n    inputsPathList: [],\n  },\n  formMeta: SET_VARIABLE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWorkflowNode } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { VariableTagList } from '@/components/node-render/node-render-new/fields/variable-tag-list';\nimport { Field } from '@/components/node-render/node-render-new/fields';\n\nimport { useSetTags } from './use-set-tags';\n\nexport function SetTags() {\n  const { inputParameters } = useWorkflowNode();\n  const variableTags = useSetTags(inputParameters);\n\n  const isEmpty = !variableTags || variableTags.length === 0;\n\n  return (\n    <Field label={I18n.t('workflow_loop_set_variable_set')} isEmpty={isEmpty}>\n      <VariableTagList value={variableTags} />\n    </Field>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO, type RefExpression } from '@coze-workflow/base';\n\nimport { useVariableService } from '@/hooks';\nimport { type VariableTagProps } from '@/components/node-render/node-render-new/fields/variable-tag-list';\n\nexport function useSetTags(\n  inputParameters: InputValueVO[] | Record<string, InputValueVO['input']> = [],\n): VariableTagProps[] {\n  const node = useCurrentEntity();\n  const variableService = useVariableService();\n  if (!Array.isArray(inputParameters)) {\n    return [];\n  }\n  const setVariableInputs = inputParameters as unknown as {\n    left: RefExpression;\n    right: RefExpression;\n  }[];\n  return setVariableInputs\n    .map(({ left }) => {\n      const variable = variableService.getWorkflowVariableByKeyPath(\n        left?.content?.keyPath,\n        { node, checkScope: true },\n      );\n      if (!variable) {\n        const pathLabel = left?.content?.keyPath[1];\n        if (pathLabel) {\n          // Value but no variable found\n          return {\n            label: pathLabel,\n            invalid: true,\n          };\n        } else {\n          // No value\n          return;\n        }\n      }\n      const viewType = left?.rawMeta?.type ?? variable.viewType;\n      const variableTag: VariableTagProps = {\n        label: variable.viewMeta?.name ?? variable.keyPath[1],\n        type: viewType,\n      };\n      return variableTag;\n    })\n    .filter(Boolean) as VariableTagProps[];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SetTags } from './content';\n\nexport function SetVariableContent() {\n  return (\n    <>\n      <SetTags />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { debounce, isUndefined } from 'lodash-es';\nimport {\n  type LiteralExpression,\n  type OutputValueVO,\n} from '@coze-workflow/base/types';\nimport { workflowApi } from '@coze-workflow/base';\nimport { TriggerStatus } from '@coze-arch/idl/workflow_api';\n\nimport { TriggerForm } from '@/node-registries/trigger-upsert/types';\n\nconst submit = async ({\n  workflowId,\n  projectId,\n  spaceId,\n  eventId,\n  config,\n  parameters,\n  isOpen,\n  triggerId,\n}: {\n  workflowId?: string;\n  projectId?: string;\n  spaceId?: string;\n  eventId?: string;\n  config?: Record<string, unknown>;\n  parameters?: Record<string, unknown>;\n  isOpen?: boolean;\n  triggerId?: string;\n}) => {\n  const data = await workflowApi.SaveTrigger({\n    workflow_id: workflowId ?? '',\n    project_id: projectId ?? '',\n    space_id: spaceId ?? '',\n    event_id: eventId ?? '',\n    trigger_id: triggerId ?? '',\n    config: JSON.stringify(config),\n    payload: JSON.stringify(parameters),\n    status: isOpen ? TriggerStatus.Open : TriggerStatus.Close,\n  });\n\n  return data?.trigger_id;\n};\n\nconst requestDelay = 1000 * 1;\nconst submitThrottle = debounce(submit, requestDelay);\n\nexport interface TriggerSubmitOptions {\n  parameters?: Record<string, unknown>;\n  dynamicInputs?: Record<string, unknown>;\n  outputs?: OutputValueVO[];\n  workflowId?: string;\n  projectId?: string;\n  spaceId?: string;\n  eventId?: string;\n  triggerId?: string;\n  isOpen?: boolean;\n}\nexport async function triggerSubmit({\n  parameters,\n  dynamicInputs,\n  outputs,\n  workflowId,\n  projectId,\n  spaceId,\n  eventId,\n  triggerId,\n  isOpen,\n}: TriggerSubmitOptions): Promise<string | undefined> {\n  const _parameters = {};\n  outputs?.forEach(d => {\n    const key = TriggerForm.getVariableName(d);\n    if (!isUndefined(parameters?.[key])) {\n      _parameters[d.name] = (parameters[key] as LiteralExpression)?.content;\n    }\n  });\n\n  const config: Record<string, unknown> = {\n    endTime: 4070880000,\n    startTime: -1,\n    schedulerType: 'custom',\n  };\n\n  Object.entries(dynamicInputs ?? {}).forEach(([k, v]) => {\n    config[k] = (v as { content?: string })?.content ?? v;\n  });\n\n  config[TriggerForm.TriggerFormCronjobName] = (\n    dynamicInputs?.[TriggerForm.TriggerFormCronjobName] as {\n      content?: { content?: string };\n    }\n  )?.content?.content;\n\n  config[TriggerForm.TriggerFormCronjobTypeName] = (\n    dynamicInputs?.[TriggerForm.TriggerFormCronjobName] as { type: string }\n  )?.type;\n\n  const _triggerId = await submitThrottle({\n    workflowId,\n    projectId,\n    spaceId,\n    eventId,\n    config,\n    parameters: _parameters,\n    isOpen,\n    triggerId,\n  });\n\n  return _triggerId;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { debounce } from 'lodash-es';\nimport { useLatest } from 'ahooks';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { TriggerForm } from '@coze-workflow/nodes';\nimport {\n  ValueExpressionType,\n  type ViewVariableTreeNode,\n} from '@coze-workflow/base';\n\nimport { TriggerService } from '@/services';\nimport { useGlobalState } from '@/hooks';\nimport { useForm, useWatch } from '@/form';\n\nimport {\n  triggerSubmit,\n  type TriggerSubmitOptions,\n} from '../utils/trigger-submit';\n\nexport const useTrigger = () => {\n  const triggerService = useService<TriggerService>(TriggerService);\n\n  const { dynamicFormMeta, eventId } = useMemo(() => {\n    const formMeta = triggerService.getTriggerDynamicFormMeta();\n\n    return {\n      dynamicFormMeta: formMeta?.startNodeFormMeta,\n      eventId: formMeta?.[TriggerForm.TriggerFormEventIdName],\n    };\n  }, []);\n\n  const formValue = triggerService.getStartNodeFormValues();\n  const { triggerId } = (formValue ?? {}) as {\n    triggerId?: string;\n  };\n\n  const outputs = useWatch<ViewVariableTreeNode[]>('outputs');\n\n  const triggerIsOpen = useWatch<boolean>('trigger.isOpen');\n  const form = useForm();\n  const setTriggerIsOpen = useCallback(\n    (_isOpen: boolean) => {\n      form.setValueIn('trigger.isOpen', _isOpen);\n      onDynamicFormChange();\n    },\n    [form],\n  );\n\n  const triggerValues = useWatch<{\n    dynamicInputs: Record<string, unknown>;\n    parameters: Record<string, unknown>;\n  }>('trigger');\n\n  const latestTriggerValues = useLatest(triggerValues);\n\n  const triggerValueSubmitProps = useRef<Partial<TriggerSubmitOptions>>({});\n  const { workflowId, projectId, spaceId } = useGlobalState();\n  useEffect(() => {\n    triggerValueSubmitProps.current = {\n      triggerId,\n      outputs,\n      workflowId,\n      projectId,\n      spaceId,\n      eventId,\n    };\n  }, [workflowId, projectId, spaceId, triggerId, outputs, eventId]);\n\n  const onDynamicFormChange = useCallback(async () => {\n    if (latestTriggerValues.current) {\n      triggerService.setStartNodeFormValues({\n        ...latestTriggerValues.current,\n        parameters: form.getValueIn('trigger.parameters'),\n        dynamicInputs: form.getValueIn('trigger.dynamicInputs'),\n        isOpen: form.getValueIn('trigger.isOpen'),\n      });\n      const _triggerId = await triggerSubmit({\n        ...triggerValueSubmitProps.current,\n        parameters: form.getValueIn('trigger.parameters'),\n        dynamicInputs: form.getValueIn('trigger.dynamicInputs'),\n        isOpen: form.getValueIn('trigger.isOpen'),\n      });\n      if (!triggerValueSubmitProps.current?.triggerId) {\n        triggerValueSubmitProps.current.triggerId = _triggerId;\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    outputs?.map(d => {\n      const k = TriggerForm.getVariableName(d);\n      if (!form.getValueIn(`trigger.parameters.${k}`)) {\n        form.setValueIn(`trigger.parameters.${k}`, {\n          type: ValueExpressionType.LITERAL,\n        });\n      }\n    });\n  }, [outputs?.map(d => TriggerForm.getVariableName(d)).join('')]);\n\n  return {\n    triggerIsOpen,\n    setTriggerIsOpen,\n    triggerId,\n    dynamicFormMeta,\n    outputs,\n    onDynamicFormChange: debounce(onDynamicFormChange, 100),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TriggerForm } from '@coze-workflow/nodes';\nimport { FILE_TYPES, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Switch } from '@coze-arch/coze-design';\nimport { useFlags } from '@coze-arch/bot-flags';\n\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useGlobalState } from '@/hooks';\nimport { Section, useWatch } from '@/form';\nimport { TriggerTestRunButton } from '@/components/test-run/test-run-button';\n\nimport { FixedInputParameter } from '../trigger-upsert/components/fixed-input-parameter-field';\nimport { OutputsField, RadioSetterField, SwitchField } from '../common/fields';\nimport {\n  CronJobSelect,\n  DynamicForm,\n  Notify,\n  Timezone,\n} from '../common/components';\nimport { useTrigger } from './hooks/use-trigger';\n\nexport const FormRender = withNodeConfigForm(() => {\n  const { isBindDouyin, isChatflow, projectId } = useGlobalState();\n  const [FLAGS] = useFlags();\n\n  let hiddenTypes = isBindDouyin ? FILE_TYPES : [];\n\n  if (IS_OPEN_SOURCE) {\n    hiddenTypes = [ViewVariableType.Voice, ViewVariableType.ArrayVoice];\n  }\n\n  const tabName = useWatch<string>('trigger.tab');\n\n  const {\n    triggerIsOpen,\n    setTriggerIsOpen,\n    triggerId,\n    dynamicFormMeta,\n    outputs,\n    onDynamicFormChange,\n  } = useTrigger();\n\n  return (\n    <>\n      {tabName === TriggerForm.Tab.Trigger && triggerIsOpen ? (\n        <Notify\n          isBreakLine\n          className=\"!border-b-0 !m-0 !mt-2.5 rounded-lg\"\n          text={I18n.t(\n            'workflow_user_trigger_banner',\n            {},\n            '',\n          )}\n        />\n      ) : null}\n\n      {/* will support soon */}\n      {(projectId || IS_BOT_OP) && !IS_OPEN_SOURCE ? (\n        <RadioSetterField\n          name={'trigger.tab'}\n          defaultValue={TriggerForm.Tab.Basic}\n          options={{\n            key: TriggerForm.TabName,\n            mode: 'button',\n            direction: 'horizontal',\n            options: [\n              {\n                label: I18n.t('worklfow_start_basic_setting', {}, ''),\n                value: TriggerForm.Tab.Basic,\n              },\n              {\n                label: I18n.t(\n                  'workflow_start_trigger_setting',\n                  {},\n                  '',\n                ),\n                value: TriggerForm.Tab.Trigger,\n              },\n            ],\n            ignoreReadonly: true,\n          }}\n        />\n      ) : null}\n      {(tabName ?? TriggerForm.Tab.Basic) === TriggerForm.Tab.Basic ? (\n        <>\n          <OutputsField\n            id=\"start-node-output\"\n            name=\"outputs\"\n            title={I18n.t('workflow_detail_node_parameter_input')}\n            tooltip={I18n.t('workflow_detail_start_input_tooltip')}\n            addItemTitle={I18n.t('workflow_add_input')}\n            withDescription\n            withRequired\n            allowDeleteLast\n            emptyPlaceholder={I18n.t('workflow_start_no_parameter')}\n            hiddenTypes={hiddenTypes}\n            defaultCollapse={false}\n            needAppendChildWhenNodeIsPreset={undefined}\n            withDefaultValue\n            columnsRatio=\"4:3\"\n            hasFeedback={false}\n          />\n\n          {/* Support soon, so stay tuned. */}\n          {isChatflow && FLAGS['bot.automation.message_auto_write'] ? (\n            <Section title={I18n.t('basic_setting')} tooltip=\"\">\n              <SwitchField\n                customLabel={I18n.t('workflow_250407_001', {}, '')}\n                customTooltip={I18n.t('workflow_250407_002')}\n                name=\"inputs.auto_save_history\"\n                customStyles={{\n                  display: 'grid',\n                  gridTemplateColumns: 'auto auto 1fr',\n                }}\n                labelStyles={{\n                  fontSize: '12px',\n                  fontWeight: 'normal',\n                }}\n                switchCustomStyles={{\n                  justifySelf: 'end',\n                }}\n              />\n            </Section>\n          ) : null}\n        </>\n      ) : null}\n      {tabName === TriggerForm.Tab.Trigger ? (\n        <>\n          <>\n            <Section\n              title={I18n.t('workflow_start_trigger_setting', {}, '')}\n              tooltip={I18n.t(\n                'workflow_start_trigger_setting_tooltips',\n                {},\n                '',\n              )}\n              actions={[\n                triggerIsOpen ? (\n                  <TriggerTestRunButton triggerId={triggerId} />\n                ) : (\n                  false\n                ),\n                <Switch\n                  checked={triggerIsOpen}\n                  onChange={setTriggerIsOpen}\n                  size=\"mini\"\n                />,\n              ].filter(Boolean)}\n            >\n              {triggerIsOpen ? (\n                <div className=\"flex flex-col gap-[8px]\">\n                  <DynamicForm\n                    name={'trigger.dynamicInputs'}\n                    formMeta={dynamicFormMeta}\n                    components={{\n                      Timezone,\n                      CronJobSelect,\n                    }}\n                    onChange={onDynamicFormChange}\n                  />\n                </div>\n              ) : null}\n            </Section>\n            {triggerIsOpen ? (\n              <Section title={I18n.t('parameters', {}, '')} actions={[]}>\n                <div className=\"flex flex-col gap-[8px]\">\n                  <FixedInputParameter\n                    name={'trigger.parameters'}\n                    layout=\"horizontal\"\n                    refDisabled\n                    fieldConfig={outputs\n                      ?.filter(d => d.type)\n                      ?.map(d => ({\n                        label: d?.name,\n                        description: d?.description ?? '',\n                        name: TriggerForm.getVariableName(d),\n                        required: !!d?.required,\n                        type: d.type,\n                      }))}\n                    onChange={onDynamicFormChange}\n                    inputPlaceholder={I18n.t(\n                      'workflow_trigger_creat_name_placeholder',\n                    )}\n                  />\n                </div>\n              </Section>\n            ) : null}\n          </>\n        </>\n      ) : null}\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { TriggerForm } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { TriggerService } from '@/services';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createOutputsValidator } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nexport const START_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    outputs: createOutputsValidator({\n      uniqueName: true,\n    }),\n\n    'trigger.dynamicInputs.*': ({ value, formValues, context, name }) => {\n      console.log('gjy dynamicInputs', value, name);\n      if (formValues?.trigger?.isOpen) {\n        const triggerService =\n          context.node.getService<TriggerService>(TriggerService);\n\n        const { startNodeFormMeta } =\n          triggerService.getTriggerDynamicFormMeta();\n        const required = startNodeFormMeta.find(\n          d => d.name === name?.replace('trigger.dynamicInputs.', ''),\n        )?.required;\n\n        if (required) {\n          let isEmpty = false;\n          // (Specialized) crontab structure special\n          if (name === 'trigger.dynamicInputs.crontab') {\n            isEmpty = !value?.content?.content;\n          } else {\n            isEmpty = !value?.content;\n          }\n          return isEmpty\n            ? I18n.t('workflow_detail_node_error_empty', {}, '')\n            : undefined;\n        }\n      }\n      return undefined;\n    },\n    'trigger.parameters.*': ({ value, formValues, name }) => {\n      if (formValues?.trigger?.isOpen) {\n        const inUseKeys = formValues.outputs.map(d =>\n          TriggerForm.getVariableName(d),\n        );\n        if (inUseKeys.includes(name.replace('trigger.parameters.', ''))) {\n          return !value?.content\n            ? I18n.t('workflow_detail_node_error_empty', {}, '')\n            : undefined;\n        }\n      }\n      return undefined;\n    },\n  },\n\n  // defaultValues: {\n  //   [TriggerForm.TabName]: TriggerForm.Tab.Basic,\n  // } as any,\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { omit, isUndefined } from 'lodash-es';\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  isPresetStartParams,\n  type OutputValueVO,\n  type LiteralExpression,\n  type VariableMetaDTO,\n} from '@coze-workflow/base';\nimport { getFlags } from '@coze-arch/bot-flags';\n\nimport { TriggerService } from '@/services';\n\nimport { TriggerForm } from '../trigger-upsert/types';\nimport { type FormData, type NodeDataDTO } from './types';\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: NodeDataDTO,\n  context: NodeFormContext,\n): FormData & { trigger?: unknown } => {\n  const { playgroundContext } = context;\n  const { isChatflow, readonly, projectId } = playgroundContext.globalState;\n  const { outputs, inputs } = value || {};\n\n  let trigger;\n\n  // will support soon\n  if (projectId && !IS_OPEN_SOURCE) {\n    const triggerService =\n      context.node.getService<TriggerService>(TriggerService);\n\n    // The key of the trigger parameter should be turned, name - > key + type\n    const { parameters, dynamicInputs, ...rest } =\n      triggerService.getStartNodeFormValues();\n\n    const _parameters: Record<string, unknown> = {};\n    Object.keys(parameters as Record<string, unknown>).forEach(key => {\n      const d = outputs?.find(item =>\n        [\n          item.name,\n          TriggerForm.getVariableName(d as unknown as OutputValueVO),\n        ].includes(key),\n      );\n      if (!d) {\n        return;\n      }\n      _parameters[TriggerForm.getVariableName(d as unknown as OutputValueVO)] =\n        (parameters as Record<string, unknown>)[key];\n    });\n\n    const { startNodeFormMeta, startNodeDefaultFormValue } =\n      triggerService.getTriggerDynamicFormMeta();\n    const _dynamicInputs: Record<string, unknown> = {};\n    startNodeFormMeta.forEach(item => {\n      _dynamicInputs[item.name] =\n        dynamicInputs?.[item.name] ?? startNodeDefaultFormValue?.[item.name];\n    });\n    trigger = {\n      ...rest,\n      dynamicInputs: _dynamicInputs,\n      parameters: _parameters,\n    };\n  }\n\n  const formValue = {\n    ...(value ?? {}),\n    trigger,\n    outputs: ((outputs as unknown as FormData['outputs']) || []).map(item => {\n      if (isPresetStartParams(item.name)) {\n        item.isPreset = isChatflow;\n        item.enabled = true;\n        // Preview state does not modify required data\n        if (!readonly) {\n          item.required = false;\n        }\n      }\n      return item;\n    }),\n  };\n\n  const flags = getFlags();\n  // auto_save_history parameters only work in chatflow\n  if (isChatflow && flags['bot.automation.message_auto_write']) {\n    formValue.inputs = {\n      // If the backend has not defined auto_save_history this field, the default is set to true\n      auto_save_history: isUndefined(inputs?.auto_save_history)\n        ? true\n        : Boolean(inputs?.auto_save_history),\n    };\n  }\n\n  return formValue;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (_value: FormData): NodeDataDTO => {\n  const value: NodeDataDTO = _value as any;\n\n  const outputsViewMeta = _value.outputs;\n  // The trigger parameters of the start node need to be saved to the schema (VariableMetaDTO), for human review. The front and back ends are not consumed anywhere else\n  value.trigger_parameters = outputsViewMeta\n    ?.map<VariableMetaDTO | undefined>(viewMeta => {\n      const dtoMeta = variableUtils.viewMetaToDTOMeta(viewMeta);\n      const v = (\n        value as {\n          trigger?: {\n            parameters?: {\n              [k: string]: LiteralExpression;\n            };\n          };\n        }\n      )?.trigger?.parameters?.[TriggerForm.getVariableName(viewMeta)];\n\n      if (!isUndefined(v)) {\n        let literalContent = (v as LiteralExpression)?.content;\n        if (\n          typeof literalContent !== 'string' &&\n          typeof literalContent !== undefined\n        ) {\n          // Multi-file list serialized into json string\n          literalContent = JSON.stringify(literalContent);\n        }\n        return {\n          ...dtoMeta,\n          defaultValue: literalContent,\n        };\n      }\n      return;\n    })\n    ?.filter((item): item is VariableMetaDTO => Boolean(item));\n\n  const { outputs } = value;\n  return {\n    ...omit(value, 'trigger'),\n    outputs: (outputs || []).map(item =>\n      omit(item, ['isPreset', 'enabled']),\n    ) as VariableMetaDTO[],\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n  WorkflowNodeVariablesMeta,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { START_FORM_META } from './form-meta';\n\nexport const START_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Start,\n  meta: {\n    isStart: true,\n    nodeDTOType: StandardNodeType.Start,\n    size: { width: 360, height: 78.7 },\n    deleteDisable: true,\n    copyDisable: true,\n    headerReadonly: true,\n    showTrigger: ({ projectId }) =>\n      // will support soon\n      (!!projectId || IS_BOT_OP) && !IS_OPEN_SOURCE,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    // No input port\n    defaultPorts: [{ type: 'output' }],\n    helpLink: '/open/docs/guides/start_end_node',\n    test,\n  },\n  variablesMeta: WorkflowNodeVariablesMeta.DEFAULT,\n  formMeta: START_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport {\n  generateInputJsonSchema,\n  ViewVariableType,\n} from '@coze-workflow/variable';\nimport { getSortedInputParameters } from '@coze-workflow/nodes';\n\nimport {\n  generateField,\n  type IFormSchema,\n  getRelatedInfo,\n  generateEnvToRelatedContextProperties,\n  type NodeTestMeta,\n} from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  testset: true,\n  async generateRelatedContext(node, context) {\n    const { spaceId, workflowId, isChatflow, isInProject } = context;\n    // No need to associate in the project\n    if (isInProject) {\n      return generateEnvToRelatedContextProperties({\n        isNeedBot: false,\n      });\n    }\n    const related = await getRelatedInfo({ spaceId, workflowId });\n\n    /**\n     * Full process testing without selecting a session\n     * 1. The workflow itself does not require\n     * 2. chatflow selects the session in the session component, no need to select in the form\n     */\n    related.isNeedConversation = false;\n    /** Chatflow that is not in the project forces the need for an associated environment */\n    if (isChatflow && !isInProject) {\n      related.isNeedBot = true;\n    }\n    return generateEnvToRelatedContextProperties(related);\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = (formData?.outputs || [])\n      .filter(i => !i.isPreset)\n      .map(item => {\n        const variable =\n          node.context.variableService.getWorkflowVariableByKeyPath([\n            node.id,\n            item.name,\n          ]);\n        const { dtoMeta } = variable;\n        const jsonSchema = generateInputJsonSchema(dtoMeta);\n        return {\n          name: item.name,\n          title: item.name,\n          type: variable.viewType || ViewVariableType.String,\n          defaultValue: item.defaultValue,\n          description: item.description,\n          required: item.required,\n          validateJsonSchema: jsonSchema,\n          extra: {\n            ['x-dto-meta']: dtoMeta,\n          },\n        };\n      });\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const properties: IFormSchema['properties'] = getSortedInputParameters<any>(\n      inputParameters,\n    ).reduce((value, item) => {\n      if (item.name) {\n        value[item.name] = generateField(item);\n      }\n      return value;\n    }, {});\n    return properties;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Outputs } from '../common/components';\n\nexport function StartContent() {\n  return <Outputs label={I18n.t('workflow_detail_node_parameter_input')} />;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  type DTODefine,\n  ValueExpressionType,\n  VariableTypeDTO,\n  type ValueExpression,\n  type LiteralExpression,\n} from '@coze-workflow/base';\n\nconst parseUploadURLFileName = (url: string) => {\n  try {\n    return new URL(url)?.searchParams?.get('x-wf-file_name') ?? 'unknown';\n  } catch (e) {\n    console.error(e);\n    return '';\n  }\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst getFileDefaultValue = (input: any): LiteralExpression => {\n  const { defaultValue, assistType, type } = input;\n  return {\n    type: ValueExpressionType.LITERAL,\n    content: defaultValue,\n    rawMeta: {\n      type: variableUtils.DTOTypeToViewType(type as VariableTypeDTO, {\n        assistType,\n      }),\n      fileName: parseUploadURLFileName(defaultValue),\n    },\n  };\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst getFileListDefaultValue = (input: any): LiteralExpression => {\n  const { defaultValue, type, schema } = input;\n  const fileList = JSON.parse(defaultValue as string) as string[];\n\n  return {\n    type: ValueExpressionType.LITERAL,\n    content: fileList,\n    rawMeta: {\n      type: variableUtils.DTOTypeToViewType(type as VariableTypeDTO, {\n        arrayItemType: schema?.type,\n        assistType: schema?.assistType,\n      }),\n      fileName: fileList.map(parseUploadURLFileName),\n    },\n  };\n};\n\n/**\n * Get the default value of the imported parameter of the child workflow node, and define the defaultValue of the parameter in the child workflow start node\n * @Param input workflow parameter definition\n * @returns\n */\nexport const getInputDefaultValue = (\n  input: DTODefine.InputVariableDTO,\n): ValueExpression => {\n  const { defaultValue } = input;\n  if (!defaultValue) {\n    return {\n      type: ValueExpressionType.REF,\n    };\n  }\n  // Array<File>\n  if (input.type === VariableTypeDTO.list && input.schema?.assistType) {\n    return getFileListDefaultValue(input);\n    // File\n  } else if (input.type === VariableTypeDTO.string && input.assistType) {\n    return getFileDefaultValue(input);\n  } else if (\n    input.type === VariableTypeDTO.list ||\n    input.type === VariableTypeDTO.object\n  ) {\n    return {\n      type: ValueExpressionType.REF,\n    };\n  } else {\n    return {\n      type: ValueExpressionType.LITERAL,\n      content: variableUtils.getLiteralValueWithType(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        input.type as any,\n\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        input.defaultValue as any,\n      ) as string | number | boolean,\n    };\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { SubWorkflowNodeDTOData } from '../types';\n\nexport const getIdentifier = (inputs: SubWorkflowNodeDTOData['inputs']) => ({\n  workflowId: inputs?.workflowId ?? '',\n  workflowVersion: inputs?.workflowVersion ?? '',\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { SubWorkflowNodeService, type SubWorkflowNodeStore } from '../services';\n\nexport const useSubWorkflowNodeService = () =>\n  useService<SubWorkflowNodeService>(SubWorkflowNodeService);\n\nexport const useSubWorkflowNodeStore = <T>(\n  selector: (s: SubWorkflowNodeStore) => T,\n) => {\n  const subWorkflowService = useSubWorkflowNodeService();\n  return subWorkflowService.store(selector);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\nexport const BATCH_MODE_PATH = 'inputs.batchMode';\nexport const BATCH_INPUT_LIST_PATH = 'inputs.batch.inputLists';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'outputList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'id',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n\nexport const COLUMNS = [\n  {\n    label: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 148 },\n  },\n  { label: I18n.t('workflow_detail_end_output_value') },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo, type FC } from 'react';\n\nimport { type WorkflowDetailInfoData } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozExit } from '@coze-arch/coze-design/icons';\n\nimport { useGlobalState } from '@/hooks';\n\nimport { type SubWorkflowDetailDTO, type Identifier } from '../types';\n\nexport const SubWorkflowLink: FC<{\n  workflowDetail: SubWorkflowDetailDTO;\n  identifier: Identifier;\n}> = props => {\n  const { workflowDetail, identifier } = props;\n  const { workflowId } = identifier;\n  const { getProjectApi, spaceId } = useGlobalState();\n  const projectApi = getProjectApi();\n  const isProjectWorkflow = Boolean(\n    (workflowDetail as WorkflowDetailInfoData)?.project_id,\n  );\n\n  const subWorkflowProjectId = isProjectWorkflow\n    ? (workflowDetail as WorkflowDetailInfoData)?.project_id\n    : undefined;\n\n  // Get the latest commitId\n  const commitId = useMemo(() => {\n    /** The process from the repository requires obtaining the latest version number */\n    const latestVersion = isProjectWorkflow\n      ? undefined\n      : workflowDetail.latest_flow_version;\n\n    const { workflowVersion } = identifier;\n\n    /** Is it the latest version of the subprocess? */\n    const isLatest = !workflowVersion || workflowVersion === latestVersion;\n    return isLatest ? undefined : workflowDetail.commit_id;\n  }, [workflowDetail, isProjectWorkflow]);\n\n  const handleClick = (e: React.MouseEvent<HTMLSpanElement>) => {\n    if (IS_BOT_OP) {\n      window.open(\n        `${window.location.pathname}?workflow_id=${workflowId}`,\n        '_blank',\n      );\n      e.stopPropagation();\n      return;\n    }\n    // When there is a project id, it is the workflow within the referenced project.\n    if (subWorkflowProjectId && projectApi?.navigate) {\n      projectApi?.navigate(`/workflow/${workflowId}`);\n    } else {\n      let url = `/work_flow?space_id=${spaceId}&workflow_id=${workflowId}`;\n      if (commitId) {\n        url += `&version=${commitId}`;\n      }\n      window.open(url, '_blank');\n    }\n  };\n\n  return (\n    <span\n      className=\"cursor-pointer flex items-center w-full justify-between\"\n      onClick={e => handleClick(e)}\n    >\n      {I18n.t('workflow_subwf_jump_detail', {}, 'Workflow Detail')}\n      <IconCozExit className=\"text-xs\" />\n    </span>\n  );\n};\n\nexport const createSubWorkflowLink = (\n  workflowDetail: SubWorkflowDetailDTO,\n  identifier: Identifier,\n) => (\n  <SubWorkflowLink workflowDetail={workflowDetail} identifier={identifier} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useShallow } from 'zustand/react/shallow';\nimport {\n  type FormRenderProps,\n  useWatch,\n} from '@flowgram-adapter/free-layout-editor';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Batch } from '@/nodes-v2/components/batch/batch';\nimport { NodeConfigForm } from '@/node-registries/common/components';\n\nimport {\n  OutputsField,\n  BatchModeField,\n  SettingOnError,\n  InputsKVField,\n} from '../common/fields';\nimport { type SubWorkflowNodeFormData } from './types';\nimport { useSubWorkflowNodeStore } from './hooks/use-subworkflow-node-service';\nimport { BATCH_MODE_PATH, INPUT_PATH } from './constants';\nimport { SubWorkflowLink } from './components';\n\nexport const FormRender = ({\n  form,\n}: FormRenderProps<SubWorkflowNodeFormData>) => {\n  const { loading, getSubWorkflow } = useSubWorkflowNodeStore(\n    useShallow(s => ({\n      loading: s.loading,\n      getSubWorkflow: s.getData,\n    })),\n  );\n\n  const identifier = {\n    workflowId: form?.initialValues?.inputs?.workflowId ?? '',\n    workflowVersion: form?.initialValues?.inputs?.workflowVersion ?? '',\n  };\n\n  const workflowDetail = getSubWorkflow(identifier);\n  const inputsDef = workflowDetail?.inputs ?? [];\n\n  const batchMode = useWatch<string>(BATCH_MODE_PATH);\n\n  if (loading) {\n    return null;\n  }\n\n  return (\n    <NodeConfigForm\n      extraOperation={\n        <SubWorkflowLink\n          workflowDetail={workflowDetail}\n          identifier={identifier}\n        />\n      }\n    >\n      <BatchModeField name={BATCH_MODE_PATH} />\n\n      <Batch batchModeName={BATCH_MODE_PATH} name={'inputs.batch'} />\n\n      <InputsKVField\n        name={INPUT_PATH}\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        inputsDef={inputsDef as any}\n        hasFeedback={false}\n      />\n\n      <OutputsField\n        title={I18n.t('workflow_detail_node_output')}\n        tooltip={I18n.t('node_http_response_data')}\n        id=\"subWorkflow-node-outputs\"\n        name=\"outputs\"\n        batchMode={batchMode}\n        topLevelReadonly={true}\n        customReadonly\n      />\n\n      <SettingOnError name=\"settingOnError\" batchModePath={BATCH_MODE_PATH} />\n\n      <div className=\"text-[12px] coz-fg-dim hidden\">\n        Powered by Flow Engine V2\n      </div>\n    </NodeConfigForm>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, omit } from 'lodash-es';\nimport {\n  type FlowNodeEntity,\n  type NodeFormContext,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowNodeData,\n  getSortedInputParameters,\n  nodeUtils,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  ValueExpressionType,\n  type WorkflowDetailInfoData,\n} from '@coze-workflow/base';\n\nimport { type WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { type NodeMeta } from '@/typing';\n\nimport { getInputDefaultValue, syncToLatestReleaseState } from './utils';\nimport {\n  type SubWorkflowDetailDTO,\n  type SubWorkflowNodeDTODataWhenOnInit,\n  type SubWorkflowNodeFormData,\n  type Identifier,\n  type SubWorkflowNodeDTOData,\n} from './types';\nimport { SubWorkflowNodeService } from './services';\n\nconst getSubWorkflowService = (context: WorkflowPlaygroundContext) =>\n  context.entityManager.getService<SubWorkflowNodeService>(\n    SubWorkflowNodeService,\n  );\n\nconst getSubWorkflowDetail = (\n  identifier: Identifier,\n  context: WorkflowPlaygroundContext,\n) => {\n  const subWorkflowService = getSubWorkflowService(context);\n  return subWorkflowService.getApiDetail(identifier);\n};\n\nconst syncToSubWorkflowNodeData = ({\n  node,\n  context,\n  workflow,\n  nodeMeta,\n}: {\n  node: FlowNodeEntity;\n  context: WorkflowPlaygroundContext;\n  workflow: SubWorkflowDetailDTO;\n  nodeMeta: NodeMeta;\n  identifier: Identifier;\n}) => {\n  const { getNodeTemplateInfoByType } = context;\n  const nodeDataEntity = node.getData<WorkflowNodeData>(WorkflowNodeData);\n\n  // For plugins, initializing the form data also requires resetting the nodeData data reset\n  nodeDataEntity.init();\n\n  // Here, if the plugin is deleted, you also need to set nodeMeta to display specific error messages.\n  if (!workflow && nodeMeta) {\n    nodeDataEntity.setNodeData<StandardNodeType.Api>({\n      ...nodeMeta,\n    });\n    return;\n  }\n\n  const isProjectWorkflow = Boolean(\n    (workflow as WorkflowDetailInfoData)?.project_id,\n  );\n  /** The process from the repository requires obtaining the latest version number */\n  const latestVersion = isProjectWorkflow\n    ? undefined\n    : workflow.latest_flow_version;\n\n  const subWorkflowProjectId = isProjectWorkflow\n    ? (workflow as WorkflowDetailInfoData)?.project_id\n    : undefined;\n\n  /**\n   * Extract some NodeData of the SubWorkflow node from the workflow data and set it into NodeDataEntity.\n   */\n  nodeDataEntity.setNodeData<StandardNodeType.SubWorkflow>({\n    ...nodeMeta,\n    ...omit(workflow, ['inputs', 'outputs', 'project_id']),\n    // Preserve subprocess input definition\n    inputsDefinition: workflow?.inputs ?? [],\n    description: workflow.desc || '',\n    projectId: subWorkflowProjectId,\n    flow_mode: workflow.flow_mode,\n    latestVersion,\n    mainColor:\n      getNodeTemplateInfoByType(StandardNodeType.SubWorkflow)?.mainColor ?? '',\n  });\n};\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: SubWorkflowNodeDTODataWhenOnInit,\n  context: NodeFormContext,\n) => {\n  const { node, playgroundContext } = context;\n  const identifier = {\n    workflowId: value?.inputs?.workflowId ?? '',\n    workflowVersion: value?.inputs?.workflowVersion ?? '',\n  };\n\n  const subWorkflowDetail = getSubWorkflowDetail(identifier, playgroundContext);\n\n  // Synchronize apiDetail data to WorkflowNodeData, where a lot of business logic fetches data, including the error interface\n  syncToSubWorkflowNodeData({\n    node,\n    context: playgroundContext,\n    workflow: subWorkflowDetail,\n    nodeMeta: value.nodeMeta,\n    identifier,\n  });\n\n  if (!subWorkflowDetail) {\n    return value as unknown as SubWorkflowNodeFormData;\n  }\n\n  syncToLatestReleaseState(value, subWorkflowDetail);\n\n  const inputParameters = value?.inputs?.inputParameters ?? [];\n\n  // Since variables that are not filled in will be filtered out during commit, the default value needs to be added during initialization\n  // See also: packages/workflow/nodes/src/workflow-json-format: 241\n  const refillInputParamters = getSortedInputParameters(\n    subWorkflowDetail.inputs,\n  ).map(inputParam => {\n    const newValue = {\n      name: inputParam.name,\n      input: {\n        type: ValueExpressionType.REF,\n      },\n    };\n\n    const target = inputParameters.find(item => item.name === inputParam.name);\n\n    if (target) {\n      // If there is\n      return target;\n    }\n\n    // Read the default value of the parameter and backfill it\n    newValue.input = getInputDefaultValue(inputParam);\n\n    return newValue;\n  });\n\n  value.inputs = {\n    ...value.inputs,\n    inputParameters: refillInputParamters,\n  };\n\n  value = nodeUtils.dtoToformValue(value, context);\n\n  return value;\n};\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (\n  value: SubWorkflowNodeFormData,\n  context: NodeFormContext,\n): SubWorkflowNodeDTOData => {\n  const { playgroundContext } = context;\n\n  const identifier = {\n    workflowId: value?.inputs?.workflowId ?? '',\n    workflowVersion: value?.inputs?.workflowVersion ?? '',\n  };\n\n  const workflow = getSubWorkflowDetail(identifier, playgroundContext);\n\n  if (!get(workflow, 'outputs')) {\n    value.outputs = [];\n  }\n\n  value = nodeUtils.formValueToDto(value, context);\n  return value as unknown as SubWorkflowNodeDTOData;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n  type FlowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport { type StandardNodeType } from '@coze-workflow/base';\n\nimport { settingOnErrorValidate } from '@/nodes-v2/materials/setting-on-error-validate';\nimport { createProvideNodeBatchVariables } from '@/nodes-v2/materials/provide-node-batch-variable';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { BATCH_INPUT_LIST_PATH, BATCH_MODE_PATH } from './constants';\n\nexport const SUB_WORKFLOW_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: props => <FormRender {...props} />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Verify imported parameters\n    'inputs.inputParameters.*': createValueExpressionInputValidate({\n      // Whether it is required or not needs to be calculated according to the function to obtain the required value of the corresponding field\n      required: ({ name, context }) => {\n        const { node } = context;\n\n        const subWorkflow = (node as FlowNodeEntity)\n          .getData<WorkflowNodeData>(WorkflowNodeData)\n          .getNodeData<StandardNodeType.SubWorkflow>();\n\n        const fieldName = (name as string).replace(\n          'inputs.inputParameters.',\n          '',\n        );\n\n        const inputDef = subWorkflow?.inputsDefinition?.find(\n          v => v.name === fieldName,\n        );\n        return Boolean(inputDef?.required);\n      },\n    }),\n\n    // Verify the names of batch imported parameters\n    'inputs.batch.inputLists.*.name': createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'batch.inputLists') || []).map(item => item.name),\n      skipValidate: ({ formValues }) =>\n        formValues?.inputs?.batchMode === 'single',\n    }),\n\n    // Validation of batch imported parameters\n    'inputs.batch.inputLists.*.input': createValueExpressionInputValidate({\n      required: true,\n      skipValidate: ({ formValues }) =>\n        formValues?.inputs?.batchMode === 'single',\n    }),\n\n    settingOnError: settingOnErrorValidate,\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n\n    [BATCH_MODE_PATH]: createProvideNodeBatchVariables(\n      BATCH_MODE_PATH,\n      BATCH_INPUT_LIST_PATH,\n    ),\n\n    [BATCH_INPUT_LIST_PATH]: createProvideNodeBatchVariables(\n      BATCH_MODE_PATH,\n      BATCH_INPUT_LIST_PATH,\n    ),\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { get } from 'lodash-es';\nimport { ViewVariableType, variableUtils } from '@coze-workflow/variable';\n\nfunction syncNodeMeta(value, workflow) {\n  const { desc } = workflow;\n  if (!value.nodeMeta.description) {\n    value.nodeMeta.description = desc;\n  }\n}\n\nfunction syncInputs(value, workflow) {\n  const inputNames = new Set(workflow?.inputs?.map(input => input.name));\n\n  if (value?.inputs?.inputParameters) {\n    value.inputs.inputParameters = value.inputs.inputParameters.filter(input =>\n      inputNames.has(input.name),\n    );\n  }\n}\n\nfunction syncHiddenFields(value, workflow) {\n  const { workflow_id, end_type, space_id, inputs: inputDefs } = workflow;\n  value.inputs.workflowId = workflow_id;\n  value.inputs.spaceId = space_id;\n  value.inputs.inputDefs = inputDefs;\n  value.inputs.type = end_type;\n}\n\nfunction syncOutputValueKeys(currentOutputsValue, prevOutputsValue) {\n  // Synchronize key output with same name to prevent reference invalidation\n  currentOutputsValue.map(item => {\n    const sameNameItem = prevOutputsValue.find(\n      prevItem => prevItem.name === item.name,\n    );\n    if (sameNameItem) {\n      item.key = sameNameItem.key;\n      if (item.children && sameNameItem.children) {\n        syncOutputValueKeys(item.children, sameNameItem.children);\n      }\n    }\n    return item;\n  });\n}\n\nfunction syncOutputs(value, workflow) {\n  const workflowOutputs = get(workflow, 'outputs');\n  const workflowOutputsExisted = !!workflowOutputs;\n  const valueOutputsExisted = !!get(value, 'outputs');\n  const isBatchMode = get(value, 'inputs.batch.batchEnable');\n\n  if (!workflowOutputsExisted || workflowOutputs.length === 0) {\n    /**\n     * If there is no output, assign an empty array\n     * Ps: cannot be assigned to undefined, the new form engine will not trigger side effects that cause the variable engine not to update\n     */\n    value.outputs = [];\n    return;\n  }\n\n  if (!valueOutputsExisted) {\n    if (isBatchMode) {\n      value.outputs = [\n        {\n          name: 'outputList',\n          type: ViewVariableType.ArrayObject,\n          key: nanoid(),\n          children: [],\n        },\n      ];\n    } else {\n      value.outputs = [];\n    }\n  }\n\n  const { outputs } = workflow;\n  const outputsValue = outputs.map(variableUtils.dtoMetaToViewMeta);\n\n  // If exception handling is enabled, you need to put the errorbody back together\n  const errorIgnoreIsOpen = get(value, 'inputs.settingOnError.switch');\n  if (errorIgnoreIsOpen) {\n    let errorBody = get(value, 'outputs')?.find(\n      item => item.name === 'errorBody',\n    );\n\n    if (isBatchMode) {\n      errorBody = get(value, 'outputs[0].children')?.find(\n        item => item.name === 'errorBody',\n      );\n    }\n    if (errorBody) {\n      outputsValue.push(errorBody);\n    }\n  }\n\n  const prevOutputsValue = isBatchMode\n    ? value.outputs[0].children\n    : value.outputs;\n\n  if (prevOutputsValue) {\n    syncOutputValueKeys(outputsValue, prevOutputsValue);\n  }\n\n  if (isBatchMode) {\n    value.outputs[0].children = outputsValue;\n  } else {\n    value.outputs = outputsValue;\n  }\n}\n\nexport function syncToLatestReleaseState(value, workflow) {\n  syncNodeMeta(value, workflow);\n  syncInputs(value, workflow);\n  syncHiddenFields(value, workflow);\n  syncOutputs(value, workflow);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { cloneDeep } from 'lodash-es';\nimport {\n  type FlowNodeEntity,\n  FlowNodeFormData,\n  type FormModelV2,\n  PlaygroundContext,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  DEFAULT_BATCH_PATH,\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n  WorkflowNodeData,\n} from '@coze-workflow/nodes';\nimport {\n  CONVERSATION_NAME,\n  StandardNodeType,\n  ValueExpression,\n  WorkflowMode,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { getIdentifier } from './utils';\nimport type { SubWorkflowNodeDTOData } from './types';\nimport { SubWorkflowNodeService } from './services';\nimport { test } from './node-test';\nimport { SUB_WORKFLOW_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\nimport { createSubWorkflowLink } from './components';\n\nconst getSubWorkflowService = (context: WorkflowPlaygroundContext) =>\n  context.entityManager.getService<SubWorkflowNodeService>(\n    SubWorkflowNodeService,\n  );\n\nexport const SUB_WORKFLOW_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.SubWorkflow,\n  meta: {\n    nodeDTOType: StandardNodeType.SubWorkflow,\n    size: { width: 360, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    batchPath: DEFAULT_BATCH_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    test,\n    helpLink: '/open/docs/guides/workflow_node',\n  },\n  formMeta: SUB_WORKFLOW_FORM_META,\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  onInit: async (nodeJson: any, context: WorkflowPlaygroundContext) => {\n    if (!nodeJson) {\n      return;\n    }\n\n    const { inputs, nodeMeta } = nodeJson.data || nodeJson;\n    const subWorkflowService = getSubWorkflowService(context);\n    const identifier = getIdentifier(inputs);\n    await subWorkflowService.load(identifier, nodeMeta?.title);\n  },\n\n  checkError: (nodeJson, context: WorkflowPlaygroundContext) => {\n    if (!nodeJson) {\n      return undefined;\n    }\n\n    const { inputs } = nodeJson.data || nodeJson;\n    const subWorkflowService = getSubWorkflowService(context);\n    const identifier = getIdentifier(inputs);\n    return subWorkflowService.getApiError(identifier);\n  },\n\n  onDispose: (nodeJson, context: WorkflowPlaygroundContext) => {\n    if (!nodeJson) {\n      return;\n    }\n    const { inputs } = nodeJson.data || nodeJson;\n    const subWorkflowService = getSubWorkflowService(context);\n    const identifier = getIdentifier(inputs);\n    subWorkflowService.clearApiError(identifier);\n  },\n\n  getHeaderExtraOperation: (\n    formValues: SubWorkflowNodeDTOData,\n    node: FlowNodeEntity,\n  ) => {\n    const identifier = getIdentifier(formValues?.inputs ?? []);\n\n    const subWorkflowService = node.getService<SubWorkflowNodeService>(\n      SubWorkflowNodeService,\n    );\n    const subWorkflow = subWorkflowService.getApiDetail(identifier);\n    return createSubWorkflowLink(subWorkflow, identifier);\n  },\n\n  onCreate(node: FlowNodeEntity, _json: unknown) {\n    const formModel = node\n      .getData(FlowNodeFormData)\n      .getFormModel<FormModelV2>();\n    const playgroundContext =\n      node.getService<PlaygroundContext>(PlaygroundContext);\n    const { variableService, nodesService } = playgroundContext;\n    const startNode = nodesService.getStartNode();\n\n    const DELAY_TIME = 1000;\n    setTimeout(() => {\n      if (!node) {\n        return;\n      }\n\n      const nodeData = node.getData<WorkflowNodeData>(WorkflowNodeData);\n      const subWorkflowDetail =\n        nodeData?.getNodeData<StandardNodeType.SubWorkflow>();\n\n      const nodeIsChatflow =\n        subWorkflowDetail?.flow_mode === WorkflowMode.ChatFlow;\n\n      const startConversationNameVar =\n        variableService.getWorkflowVariableByKeyPath(\n          [startNode.id, CONVERSATION_NAME],\n          {\n            node,\n            checkScope: true,\n          },\n        );\n\n      // If you can find the CONVERSATION_NAME parameters of the start node\n      if (startConversationNameVar && nodeIsChatflow && formModel) {\n        const inputParameters = formModel.getValueIn('inputs.inputParameters');\n        if (inputParameters) {\n          const originValue = cloneDeep(inputParameters);\n\n          if (\n            originValue[CONVERSATION_NAME] &&\n            ValueExpression.isEmpty(originValue[CONVERSATION_NAME])\n          ) {\n            // Backfill if CONVERSATION_NAME is empty\n            originValue[CONVERSATION_NAME] = {\n              type: 'ref',\n              content: {\n                keyPath: [startNode.id, CONVERSATION_NAME],\n              },\n            };\n\n            formModel.setValueIn('inputs.inputParameters', originValue);\n          }\n        }\n      }\n      // This delay time needs to be relatively long, so set it to 1s for the time being.\n    }, DELAY_TIME);\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport {\n  CONVERSATION_NAME,\n  type StandardNodeType,\n  ValueExpression,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { WorkflowMode } from '@coze-arch/bot-api/workflow_api';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n  getRelatedInfo,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  async generateRelatedContext(node, context) {\n    const { isInProject, workflowId, spaceId } = context;\n    const nodeData = node.getData<WorkflowNodeData>(WorkflowNodeData);\n    const detail = nodeData.getNodeData<StandardNodeType.SubWorkflow>();\n    const isChatflowNode = detail?.flow_mode === WorkflowMode.ChatFlow;\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputData = formData?.inputs?.inputParameters || {};\n    const conversationName = inputData?.[CONVERSATION_NAME];\n    /** Session name with reference */\n    const isConversationNameRef =\n      conversationName && ValueExpression.isRef(conversationName);\n    if (isInProject) {\n      return generateEnvToRelatedContextProperties({\n        isNeedBot: false,\n        isNeedConversation: isChatflowNode && isConversationNameRef,\n      });\n    }\n    const related = await getRelatedInfo({ workflowId, spaceId });\n    if (isChatflowNode) {\n      // If it is a chatflow, you must apply a selector and a session selector\n      related.isNeedBot = true;\n      related.isNeedConversation = true;\n      // Chatflow cannot select bot as associated environment\n      related.disableBot = true;\n      related.disableBotTooltip = I18n.t('wf_chatflow_141');\n    }\n    return generateEnvToRelatedContextProperties(related);\n  },\n  generateFormBatchProperties(node) {\n    const batchModePath = '/inputs/batchMode';\n    const batchMode = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath(batchModePath);\n    const path = node.getNodeMeta()?.batchPath;\n    if (batchMode !== 'batch' || !path) {\n      return {};\n    }\n    const batchData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath(path);\n    return generateParametersToProperties(batchData, { node });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputDefs = formData?.inputs?.inputDefs;\n    if (!inputDefs || !Array.isArray(inputDefs)) {\n      return {};\n    }\n\n    const nodeData = node.getData<WorkflowNodeData>(WorkflowNodeData);\n    const detail = nodeData.getNodeData<StandardNodeType.SubWorkflow>();\n    const isChatflowNode = detail?.flow_mode === WorkflowMode.ChatFlow;\n\n    const inputData = formData?.inputs?.inputParameters || {};\n    const inputParameters = inputDefs\n      // CONVERSATION_NAME parameters in chatflow do not need to be extracted, and a dedicated session selection component is required\n      .filter(i => (isChatflowNode ? i.name !== CONVERSATION_NAME : true))\n      .map(i => ({\n        input: inputData[i.name],\n        name: i.name,\n        required: i.required,\n      }));\n\n    return generateParametersToProperties(inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport {\n  useCurrentEntity,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport {\n  type StandardNodeType,\n  useWorkflowNode,\n  type WorkflowDetailInfoData,\n} from '@coze-workflow/base';\n\nimport { WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { recreateNodeForm } from '@/services/node-version-service';\nimport { useDependencyService } from '@/hooks';\n\nimport { InputParameters, Outputs } from '../common/components';\nimport { getIdentifier } from './utils';\nimport { useSubWorkflowNodeService } from './hooks';\n\nexport function SubWorkflowContent() {\n  const dependencyService = useDependencyService();\n  const playgroundContext = useService<WorkflowPlaygroundContext>(\n    WorkflowPlaygroundContext,\n  );\n  const { data } = useWorkflowNode();\n  const node = useCurrentEntity();\n  const nodeDataEntity = node?.getData<WorkflowNodeData>(WorkflowNodeData);\n  const nodeData = nodeDataEntity.getNodeData<StandardNodeType.SubWorkflow>();\n\n  const identifier = getIdentifier(data?.inputs);\n  const subWorkflowService = useSubWorkflowNodeService();\n\n  useEffect(() => {\n    if (!identifier) {\n      return;\n    }\n\n    const disposable = dependencyService.onDependencyChange(async props => {\n      if (!props?.extra?.nodeIds?.includes(data?.inputs?.workflowId)) {\n        return;\n      }\n      await subWorkflowService.load(identifier, data?.nodeMeta?.title);\n      const subWorkflowDetail = subWorkflowService.getApiDetail(\n        identifier,\n      ) as WorkflowDetailInfoData;\n      // The workflow in the application does not have a version, or in other cases without a version number, it is directly refreshed\n      if (subWorkflowDetail?.project_id || !subWorkflowDetail?.flow_version) {\n        recreateNodeForm(node, playgroundContext);\n        return;\n      }\n      nodeDataEntity.init();\n      nodeDataEntity.setNodeData<StandardNodeType.SubWorkflow>({\n        ...nodeData,\n        latest_flow_version: subWorkflowDetail?.latest_flow_version,\n        latest_flow_version_desc: subWorkflowDetail?.latest_flow_version_desc,\n        latestVersion: subWorkflowDetail?.latest_flow_version,\n      });\n      dependencyService.onSubWrokflowVersionChangeEmitter.fire({\n        subWorkflowId: data?.inputs?.workflowId,\n      });\n    });\n\n    return () => {\n      disposable?.dispose?.();\n    };\n  }, [identifier, data?.inputs?.workflowId]);\n\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\n\nimport { type SubWorkflowDetailDTO, type Identifier } from '../types';\n\ninterface SubWorkflowNodeServiceState {\n  loading: boolean;\n\n  /**\n   * Sub-process node data, key is the unique identifier of the specific tool of the sub-process, and value is the sub-process node data\n   */\n  data: Record<string, SubWorkflowDetailDTO>;\n\n  /**\n   * The sub-process node data loads the error message, the key is the unique identifier of the specific tool of the sub-process, and the value is the error message.\n   */\n  error: Record<string, string | undefined>;\n}\n\ninterface SubWorkflowNodeServiceAction {\n  getData: (identifier: Identifier) => SubWorkflowDetailDTO;\n  setData: (identifier: Identifier, value: SubWorkflowDetailDTO) => void;\n  getError: (identifier: Identifier) => string | undefined;\n  setError: (identifier: Identifier, value: string | undefined) => void;\n  clearError: (identifier: Identifier) => void;\n}\n\nexport function getCacheKey(identifier: Identifier): string {\n  return `${identifier.workflowId}_${identifier.workflowVersion}`;\n}\n\nexport type SubWorkflowNodeStore = SubWorkflowNodeServiceState &\n  SubWorkflowNodeServiceAction;\n\nexport const createStore = () =>\n  createWithEqualityFn<SubWorkflowNodeStore>(\n    (set, get) => ({\n      loading: false,\n      data: {},\n      error: {},\n\n      getData(identifier) {\n        const key = getCacheKey(identifier);\n        return get().data[key];\n      },\n\n      setData(identifier, value) {\n        const key = getCacheKey(identifier);\n        set({\n          data: {\n            ...get().data,\n            [key]: value,\n          },\n        });\n      },\n\n      getError(identifier) {\n        const key = getCacheKey(identifier);\n        return get().error[key];\n      },\n\n      setError(identifier, value) {\n        const key = getCacheKey(identifier);\n        set({\n          error: {\n            ...get().error,\n            [key]: value,\n          },\n        });\n      },\n\n      clearError(identifier) {\n        const key = getCacheKey(identifier);\n        set({\n          error: {\n            ...get().error,\n            [key]: undefined,\n          },\n        });\n      },\n    }),\n    shallow,\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { workflowApi } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\nimport { type SubWorkflowDetailDTO, type Identifier } from '../types';\nimport { createStore } from './subworkflow-node-store';\n\n@injectable()\nexport class SubWorkflowNodeService {\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n\n  store = createStore();\n\n  set loading(v: boolean) {\n    this.store.setState({\n      loading: v,\n    });\n  }\n\n  get state() {\n    return this.store.getState();\n  }\n\n  getApiDetail(identifier: Identifier) {\n    return this.state.getData(identifier);\n  }\n\n  getApiError(identifier: Identifier) {\n    return this.state.getError(identifier);\n  }\n\n  clearApiError(identifier: Identifier) {\n    this.state.clearError(identifier);\n  }\n\n  async fetchData(\n    identifier: Identifier,\n  ): Promise<SubWorkflowDetailDTO | undefined> {\n    const { spaceId } = this.globalState;\n    const { workflowId, workflowVersion } = identifier;\n\n    const resp = await workflowApi.GetWorkflowDetailInfo(\n      {\n        space_id: spaceId,\n        workflow_filter_list: [\n          {\n            workflow_id: workflowId,\n            workflow_version: workflowVersion ? workflowVersion : undefined,\n          },\n        ],\n      },\n      {\n        __disableErrorToast: true,\n      },\n    );\n\n    const workflowInfo = resp?.data?.[0] as SubWorkflowDetailDTO;\n    return workflowInfo\n      ? {\n          ...workflowInfo,\n          // Unpublished workflows may have parameters that do not have a name entered and need to be filtered out\n          inputs: workflowInfo.inputs?.filter(i => i.name),\n        }\n      : undefined;\n  }\n\n  async load(identifier: Identifier, workflowTitle: string) {\n    let subWorkflowDetail: SubWorkflowDetailDTO | undefined = undefined;\n    let errorMessage = '';\n\n    try {\n      this.loading = true;\n      const response = await this.fetchData(identifier);\n      if (response) {\n        subWorkflowDetail = response;\n      }\n    } catch (error) {\n      errorMessage = error.message;\n    } finally {\n      this.loading = false;\n    }\n\n    if (errorMessage) {\n      this.state.setError(identifier, errorMessage);\n    }\n\n    if (!subWorkflowDetail) {\n      const notFoundMessage = I18n.t('workflow_node_lose_efficacy_wf', {\n        name: workflowTitle,\n      });\n      this.state.setError(identifier, errorMessage || notFoundMessage);\n      return;\n    } else {\n      this.state.setData(identifier, {\n        ...subWorkflowDetail,\n      });\n    }\n\n    return subWorkflowDetail;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'success',\n    type: ViewVariableType.Boolean,\n  },\n  {\n    key: nanoid(),\n    name: 'numberOfDeletions',\n    type: ViewVariableType.Number,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { omit } from 'lodash-es';\nimport { nodeUtils } from '@coze-workflow/nodes';\nimport {\n  type ValueExpression,\n  type NodeDataDTO,\n  ValueExpressionType,\n} from '@coze-workflow/base';\n\nimport { getInputIsEmpty } from '../trigger-upsert/utils';\nimport { type FormData } from './types';\nimport { OUTPUTS } from './constants';\n\nexport const createTransformOnInit =\n  outputs => (value: NodeDataDTO, context) => {\n    if (!value) {\n      return {\n        inputs: {\n          inputParameters: {\n            triggerId: {\n              type: ValueExpressionType.LITERAL,\n            },\n            userId: {\n              type: ValueExpressionType.LITERAL,\n            },\n          },\n        },\n        outputs,\n      };\n    }\n    const { inputs } = value;\n    const inputParameters = {};\n\n    (inputs?.inputParameters ?? []).forEach(item => {\n      inputParameters[item.name as string] = nodeUtils.refExpressionDTOToVO(\n        item,\n        context,\n      );\n    });\n    return {\n      ...(value ?? {}),\n      outputs: value?.outputs ?? outputs,\n      inputs: {\n        ...omit(value.inputs ?? {}, ['inputParameters']),\n        inputParameters,\n      },\n    };\n  };\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = createTransformOnInit(OUTPUTS);\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData, context): NodeDataDTO => {\n  const { inputs, ...rest } = value;\n  return {\n    ...rest,\n    inputs: {\n      ...omit(value.inputs ?? {}, ['inputParameters']),\n      inputParameters: Object.entries(inputs.inputParameters ?? {})\n        .filter(([k, v]) => !!getInputIsEmpty(v))\n        .map(([k, v]) => ({\n          name: k,\n          input: nodeUtils.refExpressionToValueDTO(\n            v as unknown as ValueExpression,\n            context,\n          )?.input,\n        })),\n    },\n  } as unknown as NodeDataDTO;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section } from '@/form';\n\nimport { FixedInputParameter } from '../trigger-upsert/components/fixed-input-parameter-field';\nimport { withNodeConfigForm } from '../common/hocs';\nimport { OutputsField } from '../common/fields';\nimport { INPUT_PATH } from './constants';\n\nexport const FormRender = withNodeConfigForm(() => (\n  <>\n    <Section title={I18n.t('workflow_detail_node_input', {}, '')}>\n      <div className=\"flex flex-col gap-[8px]\">\n        <FixedInputParameter\n          layout=\"horizontal\"\n          name={INPUT_PATH}\n          fieldConfig={[\n            {\n              description: '',\n              name: 'triggerId',\n              label: I18n.t('workflow_trigger_user_create_id', {}, 'id'),\n              required: false,\n              type: ViewVariableType.String,\n            },\n            {\n              label: I18n.t(\n                'workflow_trigger_user_create_userid',\n                {},\n                'userId',\n              ),\n              description: I18n.t(\n                'workflow_trigger_user_create_userid_tooltips',\n                {},\n                '-sys_uuid',\n              ),\n              name: 'userId',\n              required: true,\n              type: ViewVariableType.String,\n            },\n          ]}\n        />\n      </div>\n    </Section>\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('node_http_response_data')}\n      id=\"triggerDelete-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  </>\n));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const TRIGGER_DELETE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    'inputs.inputParameters.userId': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { TRIGGER_DELETE_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const TRIGGER_DELETE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.TriggerDelete,\n    meta: {\n      nodeDTOType: StandardNodeType.TriggerDelete,\n      size: { width: 360, height: 130.7 },\n      nodeMetaPath: DEFAULT_NODE_META_PATH,\n      outputsPath: DEFAULT_OUTPUTS_PATH,\n      inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n      test,\n      helpLink: '/open/docs/guides/delete_timed_trigger',\n    },\n    variablesMeta: {\n      inputsPathList: [],\n      outputsPathList: ['outputs'],\n    },\n    formMeta: TRIGGER_DELETE_FORM_META,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const labelMap = {\n      userId: I18n.t('workflow_trigger_user_create_userid'),\n    };\n    const requiredKeys = ['userId'];\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputs?.inputParameters;\n\n    return generateParametersToProperties(\n      Object.entries(inputParameters || {}).map(([key, value]) => ({\n        name: key,\n        title: labelMap[key] || key,\n        required: requiredKeys.includes(key),\n        input: value,\n      })),\n      { node },\n    );\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWorkflowNode, ValueExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { VariableTagList } from '@/components/node-render/node-render-new/fields/variable-tag-list';\nimport { useInputParametersVariableTags } from '@/components/node-render/node-render-new/fields/use-input-parameters-variable-tags';\nimport { Field } from '@/components/node-render/node-render-new/fields';\n\nimport { Outputs } from '../common/components';\n\nexport function TriggerDeleteContent() {\n  const { data } = useWorkflowNode();\n  const variableTags = useInputParametersVariableTags({\n    [I18n.t('workflow_trigger_user_create_id', {}, 'id')]:\n      ValueExpression.isEmpty(data?.inputs?.inputParameters?.triggerId)\n        ? undefined\n        : data?.inputs?.inputParameters?.triggerId,\n    [I18n.t('workflow_trigger_user_create_userid', {}, 'userId')]:\n      ValueExpression.isEmpty(data?.inputs?.inputParameters?.userId)\n        ? undefined\n        : data?.inputs?.inputParameters?.userId,\n  });\n\n  return (\n    <>\n      <Field label={I18n.t('workflow_detail_node_parameter_input')}>\n        <VariableTagList value={variableTags} />\n      </Field>\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs.inputParameters';\n\n// Define fixed exported parameters\nexport const OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'outputList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'triggerId',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'triggerName',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'createTime',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'triggerTime',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'userId',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Field, Section } from '@/form';\n\nimport { FixedInputParameter } from '../trigger-upsert/components/fixed-input-parameter-field';\nimport { OutputsField } from '../common/fields';\nimport { INPUT_PATH } from './constants';\n\nexport const FormRender = () => (\n  <NodeConfigForm>\n    <Section title={I18n.t('workflow_detail_node_input', {}, '')}>\n      <Field name={INPUT_PATH}>\n        <div className=\"flex flex-col gap-[8px]\">\n          <FixedInputParameter\n            layout=\"horizontal\"\n            name={INPUT_PATH}\n            fieldConfig={[\n              {\n                description: '',\n                name: 'triggerId',\n                label: I18n.t('workflow_trigger_user_create_id', {}, 'id'),\n                required: false,\n                type: ViewVariableType.String,\n              },\n              {\n                label: I18n.t(\n                  'workflow_trigger_user_create_userid',\n                  {},\n                  'userId',\n                ),\n                description: I18n.t(\n                  'workflow_trigger_user_create_userid_tooltips',\n                  {},\n                  '-sys_uuid',\n                ),\n                name: 'userId',\n                required: true,\n                type: ViewVariableType.String,\n              },\n            ]}\n          />\n        </div>\n      </Field>\n    </Section>\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('node_http_response_data')}\n      id=\"triggerDelete-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      customReadonly\n    />\n  </NodeConfigForm>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createTransformOnInit,\n  transformOnSubmit,\n} from '../trigger-delete/data-transformer';\nimport { OUTPUTS } from './constants';\n\nconst transformOnInit = createTransformOnInit(OUTPUTS);\nexport { transformOnSubmit, transformOnInit };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const TRIGGER_READ_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // Required\n    'inputs.inputParameters.userId': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { TRIGGER_READ_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const TRIGGER_READ_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.TriggerRead,\n  meta: {\n    nodeDTOType: StandardNodeType.TriggerRead,\n    size: { width: 360, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    test,\n    helpLink: '/open/docs/guides/query_timed_trigger',\n  },\n  variablesMeta: {\n    inputsPathList: [],\n    outputsPathList: ['outputs'],\n  },\n  formMeta: TRIGGER_READ_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const labelMap = {\n      userId: I18n.t('workflow_trigger_user_create_userid'),\n    };\n    const requiredKeys = ['userId'];\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputs?.inputParameters;\n\n    return generateParametersToProperties(\n      Object.entries(inputParameters || {}).map(([key, value]) => ({\n        name: key,\n        title: labelMap[key] || key,\n        required: requiredKeys.includes(key),\n        input: value,\n      })),\n      { node },\n    );\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport capitalize from 'lodash-es/capitalize';\nimport classnames from 'classnames';\nimport {\n  Field,\n  type FieldRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType, type ValueExpression } from '@coze-workflow/base';\n\nimport { ValueExpressionInput } from '@/nodes-v2/components/value-expression-input';\nimport InputLabel from '@/nodes-v2/components/input-label';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { VariableTypeTag } from '@/form-extensions/components/variable-type-tag';\n\nexport interface FixedInputParametersProps {\n  fieldConfig: {\n    label: string;\n    description: string;\n    name: string;\n    required: boolean;\n    type: ViewVariableType;\n  }[];\n  name: string;\n  layout?: 'horizontal' | 'vertical';\n  showColumnHeader?: boolean;\n  refDisabled?: boolean;\n  onChange?: () => void;\n  inputPlaceholder?: string;\n}\n\nexport const FixedInputParameter = (props: FixedInputParametersProps) => {\n  const {\n    fieldConfig = [],\n    name: parentName,\n    layout = 'vertical',\n    refDisabled = false,\n    onChange,\n    inputPlaceholder,\n  } = props;\n\n  return (\n    <>\n      {fieldConfig.map(_field => (\n        <div\n          key={`${_field.name}`}\n          className={classnames({\n            'flex flex-row': layout === 'horizontal',\n          })}\n        >\n          <div className={'w-full h-[20px] leading-[20px] mb-[4px]'}>\n            <InputLabel\n              required={_field?.required}\n              label={_field?.label}\n              className=\"!items-center\"\n              tooltip={_field?.description}\n              tootipIconClassName=\"coz-fg-secondary\"\n              tag={\n                _field?.type ? (\n                  <VariableTypeTag className=\"!inline-flex\" size=\"xs\">\n                    {capitalize(ViewVariableType.getLabel(_field.type))}\n                  </VariableTypeTag>\n                ) : null\n              }\n            />\n          </div>\n\n          <Field name={`${parentName}.${_field?.name}`}>\n            {({\n              field: childField,\n              fieldState: childState,\n            }: FieldRenderProps<ValueExpression | undefined>) => (\n              <div className=\"w-full\">\n                <ValueExpressionInput\n                  {...childField}\n                  onChange={(...args) => {\n                    childField.onChange(...args);\n                    onChange?.();\n                  }}\n                  inputPlaceholder={inputPlaceholder}\n                  refDisabled={refDisabled}\n                  inputType={_field.type}\n                  disabledTypes={ViewVariableType.getComplement([_field.type])}\n                  isError={!!childState?.errors?.length}\n                />\n                <FormItemFeedback errors={childState?.errors} />\n              </div>\n            )}\n          </Field>\n        </div>\n      ))}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport {\n  type ViewVariableMeta,\n  ViewVariableType,\n} from '@coze-workflow/variable';\n\n// Imported parameter path, practice running and other functions rely on this path to extract parameters\nexport const INPUT_PATH = 'inputs';\n\n// Define fixed exported parameters\nexport const OUTPUTS: ViewVariableMeta[] = [\n  {\n    key: nanoid(),\n    name: 'triggerId',\n    type: ViewVariableType.String,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useState } from 'react';\n\nimport dayjs from 'dayjs';\nimport classnames from 'classnames';\nimport { useLatest } from 'ahooks';\nimport { cronJobTranslator } from '@coze-workflow/components';\nimport { workflowApi, TriggerSetType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozIllusEmpty,\n  IconCozIllusEmptyDark,\n} from '@coze-arch/coze-design/illustrations';\nimport {\n  IconCozEye,\n  IconCozPlayCircle,\n  IconCozRefresh,\n  IconCozTrashCan,\n  IconCozTrigger,\n} from '@coze-arch/coze-design/icons';\nimport {\n  Button,\n  EmptyState,\n  IconButton,\n  Modal,\n  Table,\n  Toast,\n} from '@coze-arch/coze-design';\n\nimport { Notify } from '@/node-registries/common/components';\nimport { useGlobalState } from '@/hooks';\nimport { IconNameDescCard } from '@/form-extensions/components/icon-name-desc-card';\nimport { withField, useField } from '@/form';\n\nimport styles from './index.module.less';\n\ninterface TriggerListProps {\n  bindWorkflowId?: string;\n}\n\ninterface TriggerInfo {\n  triggerId?: string;\n  triggerName?: string;\n  createTime?: string;\n  triggerTime?: string;\n  useId?: string;\n}\n\nexport const TriggerListField = withField<TriggerListProps>(\n  ({ bindWorkflowId }) => {\n    const { readonly } = useField<string>();\n    const { spaceId, projectId, getProjectApi } = useGlobalState();\n    const projectApi = getProjectApi();\n    const [currentPage, setPage] = useState(1);\n    const pageSize = 10;\n    const [loading, setLoading] = useState(false);\n    const [visible, setVisible] = useState(false);\n    const [list, setList] = useState<{\n      list: TriggerInfo[];\n      total: number;\n    }>({\n      list: [],\n      total: 0,\n    });\n\n    const latestLoading = useLatest(loading);\n    const loadTriggerList = useCallback(async (page = 1) => {\n      if (latestLoading.current) {\n        return;\n      }\n      try {\n        setLoading(true);\n        setPage(page);\n        const triggerList = await workflowApi.ListTriggers({\n          project_id: projectId ?? '',\n          space_id: spaceId,\n          // workflow_id: bindWorkflowId,\n          trigger_id: '',\n          set_type: TriggerSetType.DEBUG_USERSET,\n          page_size: pageSize,\n          page_num: page,\n        });\n\n        setList({\n          list:\n            triggerList?.data?.trigger_list?.map(d => ({\n              triggerId: d.trigger_id,\n              triggerName: d.name,\n              createTime: dayjs(d.create_time).format('YYYY-MM-DD HH:mm:ss'),\n              triggerTime: JSON.parse(d.config ?? '{}')?.crontab,\n              useId: `${d.user_id}`,\n            })) ?? [],\n          total: Number(triggerList?.data?.total ?? 0),\n        });\n      } catch (e) {\n        console.error(e);\n      } finally {\n        setLoading(false);\n      }\n    }, []);\n\n    const [testRunning, setTestRunning] = useState(false);\n    const testRun = async (d: TriggerInfo) => {\n      try {\n        setTestRunning(true);\n\n        const result = await workflowApi.TestRunTrigger({\n          space_id: spaceId,\n          project_id: projectId ?? '',\n          trigger_id: d.triggerId ?? '',\n        });\n\n        projectApi?.sendMsgOpenWidget(\n          `/workflow/${result?.data?.workflow_id}`,\n          {\n            name: 'process',\n            data: { executeId: result?.data?.execute_id },\n          },\n        );\n        setVisible(false);\n      } finally {\n        setTestRunning(false);\n      }\n    };\n\n    const columns = [\n      {\n        title: I18n.t('workflow_trigger_user_create_id', {}, 'id'),\n        dataIndex: 'triggerId',\n        // width: 400,\n        render: d => `${d}`,\n      },\n      {\n        title: I18n.t('workflow_trigger_user_create_name', {}, ''),\n        dataIndex: 'triggerName',\n        render: d => `${d}`,\n      },\n      {\n        title: I18n.t('workflow_trigger_user_create_time', {}, ''),\n        dataIndex: 'createTime',\n        render: d => `${d}`,\n      },\n      {\n        title: I18n.t('workflow_trigger_user_create_schedula', {}, ''),\n        dataIndex: 'triggerTime',\n        render: d => (\n          <>\n            <div>{`${d}`}</div>\n            <div>{cronJobTranslator(d)}</div>\n          </>\n        ),\n      },\n      {\n        title: I18n.t('workflow_trigger_user_create_userid', {}, 'id'),\n        dataIndex: 'useId',\n        render: d => `${d}`,\n      },\n      {\n        title: I18n.t('workflow_trigger_user_create_action', {}, ''),\n        width: 120,\n        render: d => (\n          <div className=\"flex flex-row gap-[8px] justify-end\">\n            <IconButton\n              color=\"secondary\"\n              icon={<IconCozPlayCircle />}\n              loading={testRunning}\n              onClick={() => {\n                testRun(d);\n              }}\n            />\n            {readonly ? (\n              <></>\n            ) : (\n              <IconButton\n                color=\"secondary\"\n                icon={<IconCozTrashCan />}\n                onClick={async () => {\n                  try {\n                    await workflowApi.DeleteTrigger({\n                      space_id: spaceId,\n                      project_id: projectId ?? '',\n                      trigger_id: d.triggerId ?? '',\n                      set_type: TriggerSetType.DEBUG_USERSET,\n                    });\n\n                    loadTriggerList(currentPage);\n                  } catch (e) {\n                    Toast.error(e.message);\n                  }\n                }}\n              />\n            )}\n          </div>\n        ),\n      },\n    ];\n\n    return (\n      <div className=\"!p-0\">\n        <div className=\"\">\n          <IconNameDescCard\n            icon={\n              <div className=\"h-[32px] w-[32px] flex flex-row items-center justify-center rounded-[4px] bg-[#8E4EFF]\">\n                <IconCozTrigger className=\"text-white\" />\n              </div>\n            }\n            name={I18n.t('workflow_trigger_user_create_list', {}, '')}\n            description={I18n.t(\n              'workflow_user_trigger_list_descr',\n              {},\n              '',\n            )}\n            readonly={readonly || IS_BOT_OP}\n            showDeleteBtn={false}\n            alwaysShowActions={true}\n            actions={\n              <div className=\"flex flex-row gap-[2px] items-center\">\n                <IconCozEye />\n                <Button\n                  color=\"secondary\"\n                  theme=\"borderless\"\n                  onClick={() => {\n                    setVisible(true);\n                    loadTriggerList(1);\n                  }}\n                  className=\"!p-0\"\n                >\n                  {I18n.t('workflow_trigger_user_create_list_read', {}, '')}\n                </Button>\n              </div>\n            }\n          />\n        </div>\n        <Modal\n          title={I18n.t('workflow_trigger_user_create_list', {}, '')}\n          width={'80%'}\n          visible={visible}\n          onCancel={() => {\n            setVisible(false);\n          }}\n          footer={\n            <div className=\"flex flex-row gap-[8px] justify-end\">\n              <Button\n                color=\"primary\"\n                onClick={() => {\n                  setVisible(false);\n                }}\n                loading={loading}\n              >\n                {I18n.t('workflow_trigger_user_create_close', {}, '')}\n              </Button>\n              <Button\n                icon={<IconCozRefresh />}\n                color=\"primary\"\n                onClick={() => {\n                  loadTriggerList(1);\n                }}\n                className=\"!ml-0\"\n              >\n                {I18n.t('workflow_trigger_user_create_refresh', {}, '')}\n              </Button>\n            </div>\n          }\n        >\n          <div className={classnames(styles['trigger-list'], 'flex flex-col')}>\n            <div className=\"coz-bg-max sticky top-0 z-10 pb-[16px]\">\n              <Notify\n                align=\"left\"\n                className=\"rounded-[8px]\"\n                isBreakLine\n                text={I18n.t(\n                  'workflow_user_trigger_banner',\n                  {},\n                  '',\n                )}\n              />\n            </div>\n            {list?.list?.length === 0 ? (\n              <div className=\"w-full flex-1 flex flex-col justify-center\">\n                <EmptyState\n                  size=\"full_screen\"\n                  icon={<IconCozIllusEmpty />}\n                  darkModeIcon={<IconCozIllusEmptyDark />}\n                  title={I18n.t(\n                    'workflow_trigger_user_create_nodata',\n                    {},\n                    '',\n                  )}\n                  description={I18n.t(\n                    'workflow_trigger_user_create_advice',\n                    {},\n                    '',\n                  )}\n                />\n              </div>\n            ) : (\n              <Table\n                tableProps={{\n                  columns,\n                  dataSource: list.list,\n                  loading,\n                  pagination: {\n                    currentPage,\n                    pageSize,\n                    total: list.total,\n                    onPageChange: loadTriggerList,\n                  },\n                }}\n              />\n            )}\n          </div>\n        </Modal>\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ModalI18nKey } from '@coze-workflow/components/workflow-modal';\nimport {\n  WorkflowModalFrom,\n  useOpenWorkflowDetail,\n  useWorkflowModal,\n  type BotPluginWorkFlowItem,\n} from '@coze-workflow/components';\nimport { WorkflowMode } from '@coze-arch/idl/developer_api';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { useGlobalState } from '@/hooks';\nimport { IconNameDescCard } from '@/form-extensions/components/icon-name-desc-card';\nimport { withField, useField } from '@/form';\n\ninterface TriggerBindWorkflowFieldProps {\n  selectedWorkflowInfo?: BotPluginWorkFlowItem;\n  className?: string;\n}\n\nexport const TriggerBindWorkflowField =\n  withField<TriggerBindWorkflowFieldProps>(\n    ({ selectedWorkflowInfo, className }) => {\n      const { value, onChange, readonly } = useField();\n\n      const { projectId, workflowId, spaceId, getProjectApi, playgroundProps } =\n        useGlobalState();\n\n      const projectApi = getProjectApi();\n\n      const openWorkflowDetail = useOpenWorkflowDetail();\n\n      const sourceTitle = I18n.t('workflow_241119_01');\n\n      const {\n        node: workflowModal,\n        open: openWorkflow,\n        close: closeWorkflow,\n      } = useWorkflowModal({\n        from: WorkflowModalFrom.ProjectWorkflowAddNode,\n        flowMode: WorkflowMode.Workflow,\n        onAdd: (item, config) => {\n          onChange?.(item.workflow_id);\n          closeWorkflow();\n        },\n        onRemove: item => {\n          onChange?.(undefined);\n          closeWorkflow();\n        },\n        onCreateSuccess: val => {\n          closeWorkflow();\n          playgroundProps?.refetchProjectResourceList?.();\n          openWorkflowDetail({\n            workflowId: val.workflowId,\n            spaceId: val.spaceId,\n            projectId,\n            ideNavigate: projectApi?.navigate,\n          });\n        },\n        i18nMap: {\n          [ModalI18nKey.ListItemRemove]: {\n            key: 'scene_workflow_delete_workflow_button',\n            options: { source: sourceTitle },\n          },\n          [ModalI18nKey.ListItemRemoveConfirmTitle]: {\n            key: 'scene_workflow_delete_workflow_popup_title',\n            options: { source: sourceTitle },\n          },\n          [ModalI18nKey.ListItemRemoveConfirmDescription]: {\n            key: 'scene_workflow_delete_workflow_popup_subtitle',\n            options: { source: sourceTitle },\n          },\n        },\n        hiddenLibrary: true,\n        projectId,\n        excludedWorkflowIds: [workflowId],\n        workFlowList: selectedWorkflowInfo ? [selectedWorkflowInfo] : [],\n      });\n\n      const isWfInvalid = !selectedWorkflowInfo;\n      const isLibraryWf =\n        selectedWorkflowInfo && !selectedWorkflowInfo?.project_id;\n      return (\n        <div className={`${className} relative`}>\n          {readonly ? (\n            <></>\n          ) : (\n            <div className=\"absolute right-[0px] top-[-28px]\">\n              <IconButton\n                onClick={openWorkflow}\n                // theme=\"borderless\"\n                icon={<IconCozPlus className=\"text-sm\" />}\n                color=\"highlight\"\n                size=\"small\"\n              />\n            </div>\n          )}\n          {value ? (\n            <>\n              <IconNameDescCard\n                readonly={readonly}\n                name={\n                  isWfInvalid\n                    ? I18n.t(\n                        'worklfow_trigger_bind_delete',\n                        {},\n                        '',\n                      )\n                    : selectedWorkflowInfo?.name\n                }\n                description={selectedWorkflowInfo?.desc}\n                icon={selectedWorkflowInfo?.icon}\n                onRemove={() => {\n                  onChange?.(undefined);\n                }}\n                onClick={() => {\n                  if (!isLibraryWf) {\n                    projectApi?.navigate(`/workflow/${value}`);\n                  } else {\n                    window.open(\n                      `/work_flow?space_id=${spaceId}&workflow_id=${value}`,\n                      '_blank',\n                    );\n                  }\n                }}\n              />\n              {isLibraryWf ? (\n                <div className=\"mt-[-4px] text-[12px] coz-fg-hglt-red\">\n                  {I18n.t(\n                    'workflow_trigger_bindwf_lib_error',\n                    {},\n                    '',\n                  )}\n                </div>\n              ) : (\n                <></>\n              )}\n            </>\n          ) : (\n            <div className=\"text-[12px] coz-fg-secondary\">\n              {I18n.t(\n                'workflow_trigger_user_create_bind_tooltips',\n                {},\n                '',\n              )}\n            </div>\n          )}\n          {workflowModal}\n        </div>\n      );\n    },\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useState } from 'react';\n\nimport { useAsyncEffect } from 'ahooks';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { type BotPluginWorkFlowItem } from '@coze-workflow/components';\nimport {\n  ValueExpressionType,\n  variableUtils,\n  ViewVariableType,\n} from '@coze-workflow/variable';\nimport type { OutputValueVO, VariableMetaDTO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { TriggerService } from '@/services';\nimport {\n  OutputsField,\n  ValueExpressionInputField,\n} from '@/node-registries/common/fields';\nimport {\n  CronJobSelect,\n  DataTypeTag,\n  DynamicForm,\n  Notify,\n  Timezone,\n} from '@/node-registries/common/components';\nimport { ColumnTitles, Section, useForm, useWatch } from '@/form';\n\nimport { withNodeConfigForm } from '../common/hocs';\nimport { INPUT_PATH } from './constants';\nimport { TriggerListField } from './components/trigger-list-field';\nimport { TriggerBindWorkflowField } from './components/trigger-bind-workflow-field';\nimport { FixedInputParameter } from './components/fixed-input-parameter-field';\n\nexport const FormRender = withNodeConfigForm(value => {\n  const bindWorkflowId = useWatch<string>({\n    name: 'inputs.bindWorkflowId',\n  });\n\n  const triggerService = useService<TriggerService>(TriggerService);\n\n  const [bindWorkflowInfo, setBindWorkflowInfo] = useState<{\n    workflowInfo?: BotPluginWorkFlowItem;\n    workflowParameters?: OutputValueVO[];\n  }>({});\n\n  const { dynamicFormMeta } = useMemo(() => {\n    const formMeta = triggerService.getTriggerDynamicFormMeta();\n    return {\n      dynamicFormMeta: formMeta.triggerNodeFormMeta,\n    };\n  }, []);\n\n  const form = useForm();\n\n  useAsyncEffect(async () => {\n    let _workflowParameters: OutputValueVO[] = [];\n    let _workflowInfo;\n    if (bindWorkflowId) {\n      await triggerService.setBindWorkflowInfo(bindWorkflowId);\n      _workflowInfo = triggerService.getBindWorkflowInfo(bindWorkflowId);\n      _workflowParameters = (\n        (_workflowInfo?.inputs ?? []) as OutputValueVO[]\n      ).map(d => ({\n        ...d,\n        type: variableUtils.dtoMetaToViewMeta(d as unknown as VariableMetaDTO)\n          .type,\n      }));\n    }\n\n    setBindWorkflowInfo({\n      workflowInfo: _workflowInfo as BotPluginWorkFlowItem,\n      workflowParameters: _workflowParameters,\n    });\n\n    _workflowParameters.map(d => {\n      if (!form.getValueIn(`${INPUT_PATH}.payload.${d.name}`)) {\n        form.setValueIn(`${INPUT_PATH}.payload.${d.name}`, {\n          type: ValueExpressionType.LITERAL,\n        });\n      }\n    });\n  }, [bindWorkflowId]);\n\n  return (\n    <>\n      <Notify\n        isBreakLine\n        className=\"!border-b-0 !m-0 !mt-2.5 rounded-lg\"\n        text={I18n.t(\n          'workflow_user_trigger_banner',\n          {},\n          '',\n        )}\n      />\n      <Section\n        title={I18n.t('workflow_trigger_user_create_list', {}, '')}\n      >\n        <TriggerListField name=\"\" bindWorkflowId={bindWorkflowId} />\n      </Section>\n\n      <Section title={I18n.t('workflow_detail_node_input', {}, '')}>\n        <div className=\"flex flex-col gap-[8px]\">\n          <FixedInputParameter\n            name={`${INPUT_PATH}.fixedInputs`}\n            fieldConfig={[\n              {\n                description: I18n.t(\n                  'workflow_trigger_user_create_id_tooltips',\n                  {},\n                  'id',\n                ),\n                name: 'triggerId',\n                label: I18n.t('workflow_trigger_user_create_id', {}, 'id'),\n                required: false,\n                type: ViewVariableType.String,\n              },\n              {\n                label: I18n.t(\n                  'workflow_trigger_user_create_userid',\n                  {},\n                  'userId',\n                ),\n                description: I18n.t(\n                  'workflow_trigger_user_create_userid_tooltips',\n                  {},\n                  '-sys_uuid',\n                ),\n                name: 'userId',\n                required: true,\n                type: ViewVariableType.String,\n              },\n              {\n                label: I18n.t('workflow_trigger_user_create_name', {}, ''),\n                description: I18n.t(\n                  'workflow_trigger_user_create_name_tooltips',\n                  {},\n                  '',\n                ),\n                name: 'triggerName',\n                required: true,\n                type: ViewVariableType.String,\n              },\n            ]}\n          />\n\n          <DynamicForm\n            name={`${INPUT_PATH}.dynamicInputs`}\n            formMeta={dynamicFormMeta}\n            components={{\n              Timezone,\n              CronJobSelect,\n            }}\n          />\n\n          <TriggerBindWorkflowField\n            className=\"mb-[8px]\"\n            name={`${INPUT_PATH}.bindWorkflowId`}\n            label=\"\"\n            layout=\"vertical\"\n            tooltip=\"cronjob\"\n            required\n            selectedWorkflowInfo={bindWorkflowInfo.workflowInfo}\n          />\n\n          {bindWorkflowInfo.workflowParameters?.length ? (\n            <div className=\"coz-mg-card p-[8px] rounded-[6px] border border-solid coz-stroke-primary\">\n              <ColumnTitles\n                columns={[\n                  {\n                    label: I18n.t('workflow_detail_node_parameter_name'),\n                    style: { width: 148 },\n                  },\n                  { label: I18n.t('workflow_detail_end_output_value') },\n                ]}\n              />\n\n              <div className=\"flex flex-col gap-[8px]\">\n                {bindWorkflowInfo.workflowParameters?.map(field => (\n                  <ValueExpressionInputField\n                    label={field?.name}\n                    required={field?.required}\n                    tooltip={field?.description}\n                    labelExtra={\n                      field?.type && <DataTypeTag type={field.type} />\n                    }\n                    name={`${INPUT_PATH}.payload.${field?.name}`}\n                    inputType={field?.type}\n                    disabledTypes={ViewVariableType.getComplement([\n                      field?.type,\n                    ])}\n                  />\n                ))}\n              </div>\n            </div>\n          ) : null}\n        </div>\n      </Section>\n\n      <OutputsField\n        title={I18n.t('workflow_detail_node_output')}\n        tooltip={I18n.t('node_http_response_data')}\n        id=\"triggerUpsert-node-outputs\"\n        name=\"outputs\"\n        topLevelReadonly={true}\n        customReadonly\n      />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { get, omit, pick } from 'lodash-es';\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport {\n  variableUtils,\n  type WorkflowVariableService,\n} from '@coze-workflow/variable';\nimport {\n  BlockInput,\n  type InputValueDTO,\n  type NodeDataDTO,\n  ValueExpression,\n  type ValueExpressionDTO,\n} from '@coze-workflow/base';\n\nimport { TriggerService } from '@/services';\n\nimport {\n  CronJobType,\n  type DynamicInputsVO,\n  type NodeDataVO,\n  TriggerForm,\n} from './types';\n\nconst fixedInputKeys = ['triggerId', 'userId', 'triggerName'];\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  data: NodeDataDTO,\n  context: NodeFormContext,\n) => {\n  // Initialize to undefined and return directly. The defaultValue logic will be hit.\n  if (!data) {\n    return undefined;\n  }\n\n  const triggerService =\n    context.node.getService<TriggerService>(TriggerService);\n\n  const { triggerNodeFormMeta } = triggerService.getTriggerDynamicFormMeta();\n\n  const { variableService } = context.playgroundContext;\n  const { inputs, ...rest } = data;\n  const { config, payload } = inputs ?? {};\n\n  const DTOToVO = (dto?: ValueExpressionDTO): ValueExpression | undefined =>\n    dto\n      ? variableUtils?.valueExpressionToVO(\n          dto,\n          variableService as WorkflowVariableService,\n        )\n      : undefined;\n\n  const arrayDTOToObjVO = (\n    dto: InputValueDTO[],\n  ): Record<string, ValueExpression> =>\n    dto.reduce((acc, cur) => {\n      const { name = '', input } = cur;\n      acc[name] = DTOToVO(input);\n      return acc;\n    }, {});\n\n  // Handling Fixed Input\n  const fixedInputsVO: Record<string, ValueExpression> = {\n    ...arrayDTOToObjVO(\n      (config as InputValueDTO[]).filter(\n        c => c?.name && fixedInputKeys.includes(c.name),\n      ),\n    ),\n  };\n\n  // Handling dynamic form input\n  const dynamicInputsKeys = triggerNodeFormMeta\n    .filter(\n      d =>\n        ![\n          TriggerForm.TriggerFormCronjobName,\n          TriggerForm.TriggerFormCronjobTypeName,\n        ].includes(d.name),\n    )\n    ?.map(d => d.name);\n\n  const dynamicInputsVO: DynamicInputsVO = {\n    ...arrayDTOToObjVO(\n      (config as InputValueDTO[]).filter(\n        c => c?.name && dynamicInputsKeys.includes(c.name),\n      ),\n    ),\n  };\n\n  // Hacking cronjob structure in dynamic form\n  dynamicInputsVO[TriggerForm.TriggerFormCronjobName] = {\n    type: ((config as InputValueDTO[])?.find(\n      c => c?.name === TriggerForm.TriggerFormCronjobTypeName,\n    )?.input?.value?.content ?? CronJobType.Selecting) as CronJobType,\n    content: DTOToVO(\n      (config as InputValueDTO[])?.find(\n        c => c?.name === TriggerForm.TriggerFormCronjobName,\n      )?.input,\n    ),\n  };\n\n  // Handle binding flow input\n  const payloadVO: Record<string, ValueExpression> = {\n    ...arrayDTOToObjVO(payload as InputValueDTO[]),\n  };\n\n  const bindWorkflowId = (data.inputs?.meta as { workflowId?: string })\n    ?.workflowId;\n\n  return {\n    inputs: {\n      bindWorkflowId,\n      fixedInputs: fixedInputsVO,\n      dynamicInputs: dynamicInputsVO,\n      payload: payloadVO,\n    },\n    ...rest,\n  };\n};\n\nexport const transformOnSubmit = (\n  formData: NodeDataVO,\n  context: NodeFormContext,\n): NodeDataDTO => {\n  const { variableService } = context.playgroundContext;\n\n  const triggerService =\n    context.node.getService<TriggerService>(TriggerService);\n\n  const {\n    [TriggerForm.TriggerFormEventIdName]: eventId,\n    [TriggerForm.TriggerFormAppIdName]: appId,\n  } = triggerService.getTriggerDynamicFormMeta();\n\n  const outputs = get(formData, 'outputs', []) as any;\n  const { inputs, nodeMeta } = formData;\n  const { fixedInputs, dynamicInputs, bindWorkflowId, payload } = inputs ?? {};\n\n  const VOToDTO = (\n    name: string,\n    vo: ValueExpression | string,\n  ): InputValueDTO => {\n    if (!ValueExpression.isExpression(vo as unknown as ValueExpression)) {\n      return BlockInput.createString(name, vo as unknown as string);\n    } else {\n      return {\n        name,\n        input: variableUtils.valueExpressionToDTO(\n          vo as unknown as ValueExpression,\n          variableService as WorkflowVariableService,\n          {\n            node: context?.node,\n          },\n        ),\n      };\n    }\n  };\n  const objVOToArrayDTO = (\n    obj: Record<string, ValueExpression>,\n  ): InputValueDTO[] =>\n    Object.entries(obj ?? {})?.map(([name, vo]) => VOToDTO(name, vo));\n\n  const config: InputValueDTO[] = [];\n  // Handling Fixed Input\n  config.push(...objVOToArrayDTO(fixedInputs));\n\n  // Handling dynamic form input\n  // Hack cronjob type: fixed selection/manual input\n  config.push(\n    BlockInput.createString(\n      TriggerForm.TriggerFormCronjobTypeName,\n      dynamicInputs?.[TriggerForm.TriggerFormCronjobName]?.type ??\n        CronJobType.Selecting,\n    ),\n  );\n\n  // Hack cronjob content\n  if (dynamicInputs?.[TriggerForm.TriggerFormCronjobName]?.content) {\n    config.push(\n      VOToDTO(\n        TriggerForm.TriggerFormCronjobName,\n        dynamicInputs?.[TriggerForm.TriggerFormCronjobName]?.content,\n      ),\n    );\n  }\n\n  // Handling dynamic form input\n  config.push(\n    ...objVOToArrayDTO(\n      omit(dynamicInputs, [TriggerForm.TriggerFormCronjobName]),\n    ),\n  );\n\n  //  Handle binding flow input\n  const _payload: InputValueDTO[] = [];\n  if (bindWorkflowId) {\n    const bindWorkflowInfo = triggerService.getBindWorkflowInfo(bindWorkflowId);\n    const needSavePayloadKeys = (\n      bindWorkflowInfo?.inputs as {\n        name: string;\n      }[]\n    )?.map(d => d.name);\n    _payload.push(...objVOToArrayDTO(pick(payload ?? {}, needSavePayloadKeys)));\n  }\n\n  const meta = {\n    [TriggerForm.TriggerFormAppIdName]: appId,\n    [TriggerForm.TriggerFormEventIdName]: eventId,\n    workflowId: bindWorkflowId,\n    triggerType: 'CRONJOB',\n  };\n\n  return {\n    nodeMeta,\n    inputs: {\n      meta,\n      config,\n      payload: _payload,\n    },\n    outputs,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention */\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { TriggerService } from '@/services';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { undefinedChecker } from './utils';\nimport { type NodeDataVO } from './types';\nimport { FormRender } from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { OUTPUTS } from './constants';\n\nexport const TRIGGER_UPSERT_FORM_META: FormMetaV2<Partial<NodeDataVO>> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  defaultValues: context => {\n    const triggerService =\n      context.node.getService<TriggerService>(TriggerService);\n    const { triggerNodeDefaultFormValue } =\n      triggerService.getTriggerDynamicFormMeta();\n\n    return {\n      inputs: {\n        fixedInputs: {},\n        dynamicInputs: triggerNodeDefaultFormValue,\n        payload: {},\n      },\n      outputs: OUTPUTS,\n    };\n  },\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputs.fixedInputs.userId': createValueExpressionInputValidate({\n      required: true,\n    }),\n    'inputs.fixedInputs.triggerName': createValueExpressionInputValidate({\n      required: true,\n    }),\n    'inputs.bindWorkflowId': ({ value }) => undefinedChecker(value),\n    // Required\n    'inputs.dynamicInputs.timeZone': createValueExpressionInputValidate({\n      required: true,\n    }),\n    'inputs.dynamicInputs.crontab': props =>\n      createValueExpressionInputValidate({\n        required: true,\n      })({\n        ...props,\n        value: props.value?.content,\n      }),\n\n    'inputs.payload.*': ({ value, formValues, context, name }) => {\n      const bindWorkflowId = formValues?.inputs?.bindWorkflowId;\n      if (!bindWorkflowId) {\n        return undefined;\n      }\n      const triggerService =\n        context.node.getService<TriggerService>(TriggerService);\n      const bindWorkflowInfo =\n        triggerService.getBindWorkflowInfo(bindWorkflowId);\n      const required = (\n        bindWorkflowInfo?.inputs as { name: string; required: boolean }[]\n      )?.find(d => d.name === name?.replace('inputs.payload.', ''))?.required;\n      if (required) {\n        return undefinedChecker(value);\n      }\n    },\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { TRIGGER_UPSERT_FORM_META } from './form-meta';\nimport { INPUT_PATH } from './constants';\n\nexport const TRIGGER_UPSERT_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.TriggerUpsert,\n    meta: {\n      nodeDTOType: StandardNodeType.TriggerUpsert,\n      size: { width: 360, height: 130.7 },\n      nodeMetaPath: DEFAULT_NODE_META_PATH,\n      outputsPath: DEFAULT_OUTPUTS_PATH,\n      inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n      test,\n      helpLink: '/open/docs/guides/set_timed_trigger',\n    },\n    variablesMeta: {\n      inputsPathList: [],\n      outputsPathList: ['outputs'],\n    },\n    formMeta: TRIGGER_UPSERT_FORM_META,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { type IFormSchema } from '@coze-workflow/test-run-next';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const labelMap = {\n      triggerName: I18n.t('workflow_trigger_user_create_name'),\n      triggerId: I18n.t('workflow_trigger_user_create_id'),\n      userId: I18n.t('workflow_trigger_user_create_userid'),\n    };\n    const requiredKeys = ['triggerName', 'userId'];\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const fixedInputs = formData?.inputs?.fixedInputs;\n    const configProperties = generateParametersToProperties(\n      Object.entries(fixedInputs || {}).map(([key, value]) => ({\n        name: `__trigger_config_${key}`,\n        title: labelMap[key] || key,\n        required: requiredKeys.includes(key),\n        input: value,\n      })),\n      { node },\n    );\n    const crontab = formData?.inputs?.dynamicInputs?.crontab;\n\n    let crontabProperties: IFormSchema = {};\n    if (crontab?.type === 'cronjob') {\n      crontabProperties = generateParametersToProperties(\n        [\n          {\n            name: '__trigger_config_crontab',\n            title: I18n.t('workflow_trigger_user_create_schedula'),\n            required: true,\n            input: crontab?.content,\n          },\n        ],\n        { node },\n      );\n    }\n    const payload = formData?.inputs?.payload;\n    const payloadProperties = generateParametersToProperties(\n      Object.entries(payload || {}).map(([key, value]) => {\n        const parameterKey = key?.split(',')[1] || key;\n        return {\n          name: `__trigger_payload_${parameterKey}`,\n          title: parameterKey,\n          input: value,\n        };\n      }),\n      { node },\n    );\n    return {\n      ...configProperties,\n      ...crontabProperties,\n      ...payloadProperties,\n    };\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  useWorkflowNode,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { TriggerService } from '@/services';\nimport { VariableTagList } from '@/components/node-render/node-render-new/fields/variable-tag-list';\nimport { useInputParametersVariableTags } from '@/components/node-render/node-render-new/fields/use-input-parameters-variable-tags';\nimport { Field } from '@/components/node-render/node-render-new/fields';\n\nimport { Outputs } from '../common/components';\nimport { TriggerForm, type NodeDataVO } from './types';\n\nexport const TriggerUpsertContent = () => {\n  const { inputParameters } = useWorkflowNode();\n  const triggerService = useService<TriggerService>(TriggerService);\n  const { triggerNodeFormMeta } = triggerService.getTriggerDynamicFormMeta();\n\n  const { fixedInputs, dynamicInputs, bindWorkflowId } =\n    inputParameters as unknown as NodeDataVO;\n\n  const dynamicKeys = triggerNodeFormMeta.reduce((acc, d) => {\n    // Cronjob needs to be specialized, take the content\n    if (d.name === TriggerForm.TriggerFormCronjobName) {\n      acc[d.label] = dynamicInputs?.[d.name]?.content;\n    } else {\n      acc[d.label] = dynamicInputs?.[d.name];\n    }\n    return acc;\n  }, {});\n  const variableTags = useInputParametersVariableTags({\n    [I18n.t('workflow_trigger_user_create_id', {}, 'id')]:\n      fixedInputs?.triggerId,\n    [I18n.t('workflow_trigger_user_create_userid', {}, 'userId')]:\n      fixedInputs?.userId,\n    [I18n.t('workflow_trigger_user_create_name', {}, '')]:\n      fixedInputs?.triggerName,\n    ...dynamicKeys,\n    [I18n.t('workflow_trigger_user_create_bind', {}, '')]: {\n      content: bindWorkflowId,\n      rawMeta: {\n        type: ViewVariableType.String,\n      },\n      type: ValueExpressionType.LITERAL,\n    },\n  });\n\n  return (\n    <>\n      <Field label={I18n.t('workflow_detail_node_parameter_input')}>\n        <VariableTagList value={variableTags} />\n      </Field>\n      <Outputs />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport {\n  type OutputValueVO,\n  type ValueExpression,\n  type ViewVariableMeta,\n} from '@coze-workflow/base/types';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nexport interface FormData {\n  inputs: { inputParameters: InputValueVO[] };\n}\n\nimport {\n  type FormItemMeta as _FormItemMeta,\n  type FormMeta as _FormMeta,\n} from '@/node-registries/common/components/dynamic-form';\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace TriggerForm {\n  export const TriggerFormName = 'trigger';\n  export const TriggerFormIsOpenName = 'isOpen';\n  export const TriggerFormEventTypeName = 'event';\n  export const TriggerFormEventIdName = 'eventID';\n  export const TriggerFormAppIdName = 'appID';\n  export const TriggerFormParametersName = 'parameters';\n  export const TriggerFormCronjobName = 'crontab';\n  export const TriggerFormCronjobTypeName = 'crontabType';\n  export const TriggerFormBindWorkflowName = 'workflowId';\n\n  export const getVariableName = (variable: OutputValueVO): string =>\n    `${variable?.type},${variable?.key ?? variable?.name}`;\n\n  export type FormItemMeta = _FormItemMeta;\n\n  export type FormMeta = _FormMeta;\n\n  // form value\n}\n\nexport enum CronJobType {\n  Cronjob = 'cronjob',\n  Selecting = 'selecting',\n}\n\nexport interface CronJobValue {\n  type?: CronJobType;\n  content?: ValueExpression;\n}\n\nexport type DynamicInputsVO = Record<string, ValueExpression> & {\n  [TriggerForm.TriggerFormCronjobName]?: {\n    type?: CronJobType;\n    content?: ValueExpression;\n  };\n};\nexport interface NodeDataVO {\n  [k: string]: any;\n  inputs: {\n    fixedInputs: Record<string, ValueExpression>;\n    dynamicInputs: DynamicInputsVO;\n    payload?: Record<string, ValueExpression>;\n    bindWorkflowId?: string;\n  };\n  nodeMeta: any;\n  outputs: ViewVariableMeta[];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\n\nimport { isUndefined, omit } from 'lodash-es';\nimport { QueryClient } from '@tanstack/react-query';\nimport {\n  ValueExpression,\n  ValueExpressionType,\n  type OutputValueVO,\n} from '@coze-workflow/base/types';\nimport { TriggerSetType, TriggerStatus } from '@coze-workflow/base/api';\nimport { workflowApi } from '@coze-workflow/base';\nimport { logger } from '@coze-arch/logger';\n\nimport { CronJobType, TriggerForm } from '../types';\n\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      staleTime: Infinity,\n    },\n  },\n});\n\ninterface ResponseData {\n  [k: string]: TriggerForm.FormItemMeta & { order: number };\n}\n\nconst responseFormat = (data: ResponseData): TriggerForm.FormMeta =>\n  Object.entries(data)\n    .map(([k, v]) => ({\n      ...v,\n      name: k,\n    }))\n    .sort((a, b) => a.order - b.order);\n\nexport interface TriggerFormMeta {\n  startNodeFormMeta: TriggerForm.FormMeta;\n  startNodeDefaultFormValue: Record<string, unknown>;\n  triggerNodeFormMeta: TriggerForm.FormMeta;\n  triggerNodeDefaultFormValue: Record<string, unknown>;\n  [TriggerForm.TriggerFormEventIdName]?: string;\n  [TriggerForm.TriggerFormAppIdName]?: string;\n}\n\nexport const fetchTriggerFormMeta = async ({\n  spaceId,\n  projectId,\n}: {\n  spaceId?: string;\n  projectId?: string;\n  workflowId?: string;\n  outputs?: OutputValueVO[];\n}): Promise<TriggerFormMeta> => {\n  try {\n    const data = await queryClient.fetchQuery({\n      queryKey: ['get-trigger-form'],\n      queryFn: async () => {\n        const metaResponse = await workflowApi.ListTriggerAppEvents({\n          space_id: spaceId ?? '',\n          project_id: projectId ?? '',\n        });\n\n        const metas = JSON.parse(\n          metaResponse.data?.trigger_apps?.[0]?.events?.[0].input_schema ??\n            '{}',\n        );\n\n        const startNodeFormMeta = responseFormat(\n          metas?.schema?.properties?.start_node,\n        );\n\n        const triggerNodeFormMeta = responseFormat(\n          metas?.schema?.properties?.trigger_node,\n        );\n\n        const getDefaultValue = (k, v) => {\n          if (k === TriggerForm.TriggerFormCronjobName) {\n            return {\n              type: CronJobType.Selecting,\n              content: {\n                type: ValueExpressionType.LITERAL,\n                content: v ?? '0 0 0 * * *',\n              },\n            };\n          } else {\n            return {\n              type: ValueExpressionType.LITERAL,\n              content: v,\n            };\n          }\n        };\n\n        const startNodeDefaultFormValue: Record<string, unknown> = {};\n        startNodeFormMeta.forEach(item => {\n          startNodeDefaultFormValue[item.name] = getDefaultValue(\n            item.name,\n            item.setterProps?.defaultValue as string,\n          );\n        });\n\n        const triggerNodeDefaultFormValue: Record<string, unknown> = {};\n        triggerNodeFormMeta.forEach(item => {\n          if (!isUndefined(item.setterProps?.defaultValue)) {\n            triggerNodeDefaultFormValue[item.name] = getDefaultValue(\n              item.name,\n              item.setterProps.defaultValue as string,\n            );\n          }\n        });\n\n        return {\n          startNodeFormMeta,\n          startNodeDefaultFormValue,\n          triggerNodeFormMeta,\n          triggerNodeDefaultFormValue,\n          [TriggerForm.TriggerFormEventIdName]:\n            metaResponse.data?.trigger_apps?.[0]?.events?.[0].id,\n          [TriggerForm.TriggerFormAppIdName]:\n            metaResponse.data?.trigger_apps?.[0]?.app_id,\n        };\n      },\n    });\n    return data;\n  } catch (error) {\n    console.error(error);\n    logger.error({\n      error: error as Error,\n      eventName: '/api/workflow_api/list_trigger_events fetch error',\n    });\n    return {\n      startNodeFormMeta: [],\n      startNodeDefaultFormValue: {},\n      triggerNodeFormMeta: [],\n      triggerNodeDefaultFormValue: {},\n      [TriggerForm.TriggerFormEventIdName]: '',\n      [TriggerForm.TriggerFormAppIdName]: '',\n    };\n  }\n};\n\nexport const fetchStartNodeTriggerFormValue = async ({\n  spaceId,\n  projectId,\n  workflowId,\n  outputs,\n  projectVersion,\n}: {\n  spaceId?: string;\n  projectId?: string;\n  workflowId?: string;\n  projectVersion?: string;\n  outputs?: OutputValueVO[];\n}): Promise<{\n  formValue: Record<string, unknown>;\n  triggerId?: string;\n}> => {\n  try {\n    const formValueResponse = await workflowApi.GetTrigger({\n      space_id: spaceId ?? '',\n      project_id: projectId ?? '',\n      workflow_id: workflowId ?? '',\n      project_version: projectVersion,\n      /** Delivery DEBUG_PRESET */\n      set_type: TriggerSetType.DEBUG_PRESET,\n    });\n\n    const config = JSON.parse(formValueResponse?.data?.config ?? '{}');\n\n    const formValue = {\n      isOpen: formValueResponse.data?.status === TriggerStatus.Open,\n      // ...config,\n    };\n    Object.keys(\n      omit(config, [\n        TriggerForm.TriggerFormCronjobName,\n        TriggerForm.TriggerFormCronjobTypeName,\n      ]),\n    ).forEach(k => {\n      formValue[k] = {\n        type: ValueExpressionType.LITERAL,\n        content: config[k],\n      };\n    });\n\n    /**\n     * The cronjob data structure needs to be transformed\n     *\n     * {crontab:'0 0 0 * * *',crontabType:'selecting'}\n     *\n     * to\n     *\n     * {\n     *   type:\"selecting\",\n     *   content:{\n     *     type:ValueExpressionType.LITERAL,\n     *     content:\"0 0 0 * * *\"\n     *   }\n     * }\n     */\n    if (config[TriggerForm.TriggerFormCronjobName]) {\n      formValue[TriggerForm.TriggerFormCronjobName] = {\n        type: config[TriggerForm.TriggerFormCronjobTypeName],\n        content: {\n          type: ValueExpressionType.LITERAL,\n          content: config[TriggerForm.TriggerFormCronjobName],\n        },\n      };\n    }\n\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    const _parameters = JSON.parse(formValueResponse?.data?.payload ?? '{}');\n    const parameters: Record<string, unknown> = {};\n    outputs?.forEach(d => {\n      if (!isUndefined(_parameters[d.name])) {\n        parameters[d.name] = {\n          type: ValueExpressionType.LITERAL,\n          content: _parameters[d.name],\n        };\n      }\n    });\n    formValue[TriggerForm.TriggerFormParametersName] = parameters;\n\n    return {\n      formValue,\n      triggerId: formValueResponse?.data?.trigger_id,\n    };\n  } catch (error) {\n    logger.error({\n      error: error as Error,\n      eventName: 'api/workflow_api/get_trigger fetch error',\n    });\n    return {\n      formValue: {},\n    };\n  }\n};\n\nexport const getInputIsEmpty = v =>\n  (!v || ValueExpression.isEmpty(v as ValueExpression)\n    ? undefined\n    : v) as ValueExpression;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isUndefined } from 'lodash-es';\nimport { ValueExpression } from '@coze-workflow/base/types';\nimport { I18n } from '@coze-arch/i18n';\n\nexport const undefinedChecker = value => {\n  let rs = true;\n  if (isUndefined(value) || value === '') {\n    rs = false;\n  }\n\n  if (\n    ValueExpression.isExpression(value as ValueExpression) &&\n    ValueExpression.isEmpty(value as ValueExpression)\n  ) {\n    rs = false;\n  }\n\n  /**\n   * Verify that the value of cronjob is empty\n   * {\n   *   type: 'selecting',\n   *   content: ValueExpression\n   * }\n   */\n  if (\n    (\n      value as {\n        content: ValueExpression;\n      }\n    )?.content &&\n    ValueExpression.isExpression(\n      (\n        value as {\n          content: ValueExpression;\n        }\n      )?.content as ValueExpression,\n    ) &&\n    ValueExpression.isEmpty(\n      (\n        value as {\n          content: ValueExpression;\n        }\n      )?.content as ValueExpression,\n    )\n  ) {\n    rs = false;\n  }\n  return rs\n    ? undefined\n    : I18n.t('workflow_detail_node_error_empty', {}, '');\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nexport const DEFAULT_SUCCESS_OUTPUT = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n    required: true,\n    description: I18n.t(\n      'workflow_detail_variable_set_output_tooltip',\n      {},\n      '',\n    ),\n  },\n];\n\nexport const DEFAULT_GET_OUTPUT = [\n  {\n    key: nanoid(),\n    name: '',\n    type: ViewVariableType.String,\n    required: true,\n  },\n];\n\nexport enum ModeValue {\n  Get = 'get',\n  Set = 'set',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { useWatch } from '@/form';\n\nimport {\n  InputsParametersField,\n  OutputsField,\n  RadioSetterField,\n} from '../common/fields';\nimport { ModeValue } from './constants';\n\nconst Render = () => {\n  const mode = useWatch('mode');\n  const isSetMode = mode === ModeValue.Set;\n\n  return (\n    <NodeConfigForm nodeDisabled readonlyAllowDeleteOperation>\n      <RadioSetterField\n        name=\"mode\"\n        defaultValue={ModeValue.Set}\n        options={{\n          key: 'mode',\n          mode: 'button',\n          options: [\n            {\n              value: ModeValue.Set,\n              label: I18n.t(\n                'workflow_detail_variable_set_title',\n                {},\n                '',\n              ),\n            },\n            {\n              value: ModeValue.Get,\n              label: I18n.t(\n                'workflow_detail_variable_get_title',\n                {},\n                '',\n              ),\n            },\n          ],\n        }}\n        customReadonly\n      />\n      <InputsParametersField\n        name=\"inputParameters\"\n        tooltip={I18n.t(\n          'workflow_detail_variable_subtitle',\n          {},\n          '',\n        )}\n        nameProps={{ isPureText: !isSetMode, readonly: true }}\n        customReadonly\n      />\n      <OutputsField\n        title={I18n.t('workflow_detail_node_output')}\n        tooltip={I18n.t('workflow_detail_variable_set_output_tooltip')}\n        id=\"variable-node-outputs\"\n        name=\"outputs\"\n        topLevelReadonly={true}\n        customReadonly={isSetMode}\n      />\n    </NodeConfigForm>\n  );\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\n\nimport type { FormData } from './types';\nimport FormRender from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nconst INPUT_PARAMETERS_FIELD_NAME = 'inputParameters.*.name';\n\nexport const VARIABLE_NODE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    [INPUT_PARAMETERS_FIELD_NAME]: ({ value }) => {\n      if (/^.+$/.test(value)) {\n        return undefined;\n      }\n      return I18n.t('bot_edit_variable_field_required_error');\n    },\n    'inputParameters.*.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport { ViewVariableType } from '@coze-workflow/nodes';\nimport { type InputValueDTO, type InputValueVO } from '@coze-workflow/base';\n\nimport { ModeValue } from './constants';\n\nexport function transformOnInit(value, context) {\n  const { playgroundContext } = context;\n  const { variableService } = playgroundContext;\n  const { inputs = {}, outputs = [], nodeMeta } = value || {};\n\n  const { mode = ModeValue.Set, inputParameters = [] } = inputs;\n\n  // Processing input parameters\n  const formattedInputParameters: InputValueVO[] = [];\n  inputParameters.forEach(input => {\n    if (!input) {\n      return;\n    }\n    formattedInputParameters.push(\n      variableUtils.inputValueToVO(input, variableService),\n    );\n  });\n\n  const isSetMode = mode === ModeValue.Set;\n\n  // Processing output parameters\n  const formattedOutputs =\n    outputs.length > 0\n      ? outputs\n      : [\n          {\n            key: nanoid(),\n            name: isSetMode ? 'isSuccess' : '',\n            type: isSetMode\n              ? ViewVariableType.Boolean\n              : ViewVariableType.String,\n          },\n        ];\n\n  return {\n    nodeMeta,\n    mode,\n    inputParameters: formattedInputParameters,\n    outputs: formattedOutputs,\n  };\n}\n\nexport function transformOnSubmit(value, context) {\n  const { playgroundContext, node } = context;\n  const { variableService } = playgroundContext;\n\n  const { nodeMeta, mode, inputParameters, outputs } = value;\n\n  // Processing input parameters\n  const formattedInputParameters: InputValueDTO[] = [];\n  inputParameters.forEach(input => {\n    if (!input) {\n      return;\n    }\n    const inputValue = variableUtils.inputValueToDTO(input, variableService, {\n      node,\n    }) as InputValueDTO;\n    formattedInputParameters.push(inputValue);\n  });\n\n  return {\n    nodeMeta,\n    inputs: {\n      mode,\n      inputParameters: formattedInputParameters,\n    },\n    outputs,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  DEFAULT_OUTPUTS_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { test, type NodeTestMeta } from './node-test';\nimport { VARIABLE_NODE_FORM_META } from './form-meta';\n\nexport const VARIABLE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Variable,\n  meta: {\n    nodeDTOType: StandardNodeType.Variable,\n    headerReadonly: true,\n    headerReadonlyAllowDeleteOperation: true,\n    size: { width: DEFAULT_NODE_SIZE.width, height: 156.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    useDynamicPort: true,\n    inputParametersPath: '/inputParameters',\n    test,\n  },\n  variablesMeta: {\n    outputsPathList: ['outputs'],\n    inputsPathList: [],\n  },\n  formMeta: VARIABLE_NODE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasVariableAssignNode: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameter = formData?.inputParameters;\n    return generateParametersToProperties(inputParameter, { node });\n  },\n};\nexport type { NodeTestMeta };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { InputParameters, Outputs } from '../common/components';\n\nexport function VariableContent() {\n  return (\n    <>\n      <InputParameters />\n      <Outputs />\n    </>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useMemo } from 'react';\n\nimport classNames from 'classnames';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport type {\n  OptionItem,\n  RadioChangeEvent,\n  RadioType,\n} from '@coze-arch/bot-semi/Radio';\nimport { Radio as RadioUI, RadioGroup } from '@coze-arch/bot-semi';\n\nimport { type ComponentProps } from '@/nodes-v2/components/types';\n\nimport { useReadonly } from '../../hooks/use-readonly';\n\nimport styles from './index.module.less';\n\ntype RadioItem = OptionItem & {\n  disabled?: boolean;\n};\n\ntype RadioProps = ComponentProps<string> & {\n  name: string;\n  mode: RadioType;\n  options: RadioItem[];\n};\n\nexport const Radio: FC<RadioProps> = props => {\n  const { value, onChange, options = [], mode, name } = props;\n\n  const { getNodeSetterId, concatTestId } = useNodeTestId();\n  const readonly = useReadonly();\n\n  const uiOptions = useMemo(\n    () =>\n      options.map(item => (\n        <RadioUI\n          className={classNames({\n            'border-[#1C1F23]/[8%]': mode === 'card' && item.value !== value,\n            'bg-[--semi-color-bg-0]': mode === 'card' && item.value !== value,\n          })}\n          key={item.value}\n          value={item.value}\n          disabled={item.disabled}\n          data-testid={concatTestId(getNodeSetterId(name), `${item.value}`)}\n        >\n          {item.label}\n        </RadioUI>\n      )),\n    [options, mode, value, concatTestId, getNodeSetterId, name],\n  );\n\n  return (\n    <RadioGroup\n      style={{\n        pointerEvents: readonly ? 'none' : 'auto',\n      }}\n      className={styles.workflowNodeSetterRadio}\n      type={mode}\n      value={value}\n      onChange={onChange as unknown as (event: RadioChangeEvent) => void}\n    >\n      {uiOptions}\n    </RadioGroup>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport {\n  useForm,\n  type FlowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport {\n  useEntityFromContext,\n  usePlayground,\n} from '@flowgram-adapter/free-layout-editor';\nimport { SettingOnErrorProcessType } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { type ComponentProps } from '@/nodes-v2/components/types';\nimport { Radio } from '@/nodes-v2/components/radio';\nimport { FormCard } from '@/form-extensions/components/form-card';\n\nexport const BatchMode = ({\n  name,\n  value,\n  onChange,\n  onBlur,\n}: ComponentProps<string>) => {\n  const node = useEntityFromContext() as FlowNodeEntity;\n\n  const playground = usePlayground();\n  const { isBatchV2 } = playground.context.schemaGray;\n  const form = useForm();\n  const processType = form.getValueIn('settingOnError.processType');\n\n  const options = useMemo(() => {\n    const isExceptionSetting =\n      processType === SettingOnErrorProcessType.EXCEPTION;\n    const isBatchDisabled =\n      node.parent?.flowNodeType === FlowNodeBaseType.SUB_CANVAS ||\n      isExceptionSetting;\n    const disabledTooltip = isExceptionSetting\n      ? I18n.t(\n          'workflow_250416_05',\n          undefined,\n          '',\n        )\n      : '';\n\n    return [\n      {\n        value: 'single',\n        label: I18n.t('workflow_batch_tab_single_radio'),\n      },\n      {\n        value: 'batch',\n        label: disabledTooltip ? (\n          <Tooltip content={disabledTooltip}>\n            <div>{I18n.t('workflow_batch_tab_batch_radio')}</div>\n          </Tooltip>\n        ) : (\n          I18n.t('workflow_batch_tab_batch_radio')\n        ),\n        disabled: isBatchDisabled,\n      },\n    ];\n  }, [node, processType]);\n\n  if (isBatchV2) {\n    return <></>;\n  }\n\n  return (\n    <FormCard collapsible={false}>\n      <Radio\n        name={name}\n        mode={'button'}\n        options={options}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n      />\n    </FormCard>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useRef, useEffect } from 'react';\n\nimport { debounce } from 'lodash-es';\nimport {\n  BATCH_SIZE_MAX,\n  BATCH_SIZE_MIN,\n  BATCH_CONCURRENT_SIZE_MIN,\n  BATCH_CONCURRENT_SIZE_MAX,\n} from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\nimport { type FormState } from '@coze-arch/bot-semi/Form';\nimport { Form as BotSemiForm, Typography } from '@coze-arch/bot-semi';\nimport { InputSlider } from '@coze-agent-ide/space-bot/input-slider';\n\nimport { LabelWithTooltip } from '@/form-extensions/components/label-with-tooltip';\n\nimport s from './batch-setting-form.module.less';\n\ninterface BatchSetting {\n  batchSize: number;\n  concurrentSize: number;\n}\n\nexport type BatchSettingOnChangeValue = FormState<BatchSetting>;\n\nexport interface BatchSettingProps {\n  readonly?: boolean;\n  value: BatchSetting;\n  onChange: (value: FormState<BatchSetting>) => void;\n}\n\nconst DELAY_TIME = 10;\n\nexport const BatchSettingForm = ({\n  value,\n  readonly = false,\n  onChange,\n}: BatchSettingProps) => {\n  const formRef = useRef<BotSemiForm>(null);\n  const isSemiFormDestroyed = useRef(false);\n  const debouncedChange = debounce((v: BatchSettingOnChangeValue) => {\n    // The semi form will trigger an additional onChange when it is destroyed, thereby polluting the data. This situation is avoided here\n    if (isSemiFormDestroyed.current) {\n      return;\n    }\n    onChange(v);\n  }, DELAY_TIME);\n\n  const commonSliderProps = {\n    useRcSlider: true,\n    fieldClassName: s['form-field'],\n    disabled: readonly,\n    decimalPlaces: 0,\n    step: 1,\n  };\n\n  useEffect(\n    () => () => {\n      isSemiFormDestroyed.current = true;\n    },\n    [],\n  );\n\n  return (\n    // Prevent trigger node selection\n    <div\n      className={s['workflow-batch-setting-panel']}\n      onClick={e => e.stopPropagation()}\n    >\n      <Typography.Title className={s['workflow-batch-setting-panel-title']}>\n        {I18n.t('workflow_batch_settings')}\n      </Typography.Title>\n\n      <BotSemiForm<BatchSetting>\n        ref={formRef}\n        initValues={value}\n        onChange={debouncedChange}\n      >\n        <InputSlider\n          {...commonSliderProps}\n          field=\"batchSize\"\n          label={\n            <LabelWithTooltip\n              label={I18n.t('workflow_maximum_run_count')}\n              tooltip={I18n.t('workflow_maximum_run_count_tips')}\n            ></LabelWithTooltip>\n          }\n          max={BATCH_SIZE_MAX}\n          min={BATCH_SIZE_MIN}\n        />\n\n        <InputSlider\n          {...commonSliderProps}\n          field=\"concurrentSize\"\n          label={\n            <LabelWithTooltip\n              label={I18n.t('workflow_maximum_parallel_runs')}\n              tooltip={I18n.t('workflow_maximum_parallel_runs_tips')}\n            ></LabelWithTooltip>\n          }\n          max={BATCH_CONCURRENT_SIZE_MAX}\n          min={BATCH_CONCURRENT_SIZE_MIN}\n        />\n      </BotSemiForm>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { get } from 'lodash-es';\nimport {\n  useField,\n  FieldArray,\n  type FieldRenderProps,\n  type FieldArrayRenderProps,\n  useForm,\n  Field,\n  usePlayground,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  DEFAULT_BATCH_CONCURRENT_SIZE,\n  DEFAULT_BATCH_SIZE,\n} from '@coze-workflow/nodes';\nimport {\n  type BatchVOInputList,\n  concatTestId,\n  type RefExpression,\n  type ValueExpression,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Popover } from '@coze-arch/bot-semi';\nimport { IconSetting } from '@coze-arch/bot-icons';\nimport { IconCozMinus, IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ValueExpressionInput } from '@/nodes-v2/components/value-expression-input';\nimport { NodeInputName } from '@/nodes-v2/components/node-input-name';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\n\nimport {\n  BatchSettingForm,\n  type BatchSettingOnChangeValue,\n} from './batch-setting-form';\n\nimport s from './index.module.less';\n\ninterface BatchProps {\n  batchModeName: string;\n  name: string;\n}\n\nexport const Batch = ({ batchModeName, name }: BatchProps) => {\n  const batchMode = useField(batchModeName)?.value;\n  const readonly = useReadonly();\n\n  const form = useForm();\n  const playground = usePlayground();\n  const { isBatchV2 } = playground.context.schemaGray;\n\n  const actionButtonContent = useMemo(\n    () => (\n      <div className={s.actionButtonContent}>\n        <Popover\n          keepDOM\n          stopPropagation\n          trigger=\"click\"\n          position=\"bottomRight\"\n          content={\n            <BatchSettingForm\n              readonly={readonly}\n              value={{\n                batchSize:\n                  form.getValueIn(`${name}.batchSize`) ?? DEFAULT_BATCH_SIZE,\n                concurrentSize:\n                  form.getValueIn(`${name}.concurrentSize`) ??\n                  DEFAULT_BATCH_CONCURRENT_SIZE,\n              }}\n              onChange={(value: BatchSettingOnChangeValue) => {\n                form.setValueIn(\n                  `${name}.batchSize`,\n                  get(value.values, 'batchSize'),\n                );\n                form.setValueIn(\n                  `${name}.concurrentSize`,\n                  get(value.values, 'concurrentSize'),\n                );\n              }}\n            />\n          }\n        >\n          <IconButton\n            color=\"secondary\"\n            size={'small'}\n            icon={<IconSetting size=\"small\" />}\n            style={{ marginRight: 26 }}\n          />\n        </Popover>\n      </div>\n    ),\n    [form, name, readonly],\n  );\n\n  if (isBatchV2) {\n    return <></>;\n  }\n\n  return batchMode === 'batch' ? (\n    <div className={s['batch-container']}>\n      <FieldArray\n        name={`${name}.inputLists`}\n        defaultValue={[\n          { name: 'item1', input: { type: ValueExpressionType.REF }, id: '0' },\n        ]}\n      >\n        {({ field }: FieldArrayRenderProps<BatchVOInputList>) => {\n          const disableDelete = field.value && field.value.length < 2;\n          return (\n            <FormCard\n              className={s['batch-content']}\n              header={I18n.t('workflow_detail_node_batch')}\n              tooltip={I18n.t('workflow_detail_node_batch_tooltip')}\n              actionButton={actionButtonContent}\n            >\n              <div className={s['columns-title']}>\n                <ColumnsTitleWithAction\n                  columns={[\n                    {\n                      title: I18n.t('workflow_detail_variable_input_name'),\n                      style: {\n                        flex: 2,\n                      },\n                    },\n                    {\n                      title: I18n.t('workflow_detail_variable_input_value'),\n                      style: {\n                        flex: 3,\n                      },\n                    },\n                  ]}\n                  readonly={readonly}\n                />\n              </div>\n              {field.map((child, index) => (\n                <div key={child.key} className={s['input-item']}>\n                  <Field name={`${child.name}.name`}>\n                    {({\n                      field: childNameField,\n                      fieldState: childNameState,\n                    }: FieldRenderProps<string>) => (\n                      <div\n                        style={{\n                          flex: 2,\n                        }}\n                      >\n                        <NodeInputName\n                          {...childNameField}\n                          input={form.getValueIn<RefExpression>(\n                            `${child.name}.input`,\n                          )}\n                          inputParameters={field.value || []}\n                          isError={!!childNameState?.errors?.length}\n                        />\n                        <FormItemFeedback errors={childNameState?.errors} />\n                      </div>\n                    )}\n                  </Field>\n                  <Field name={`${child.name}.input`}>\n                    {({\n                      field: childInputField,\n                      fieldState: childInputState,\n                    }: FieldRenderProps<ValueExpression | undefined>) => (\n                      <div style={{ flex: 3, overflow: 'hidden' }}>\n                        <ValueExpressionInput\n                          {...childInputField}\n                          key=\"ValueExpressionInput\"\n                          literalDisabled={false}\n                          disabledTypes={ViewVariableType.getComplement(\n                            ViewVariableType.getAllArrayType(),\n                          )}\n                        />\n                        <FormItemFeedback errors={childInputState?.errors} />\n                      </div>\n                    )}\n                  </Field>\n                  {readonly ? (\n                    <></>\n                  ) : (\n                    <div className=\"leading-none\">\n                      <IconButton\n                        size=\"small\"\n                        color=\"secondary\"\n                        disabled={disableDelete}\n                        data-testid={concatTestId(child.name, 'remove')}\n                        icon={<IconCozMinus />}\n                        onClick={() => {\n                          if (disableDelete) {\n                            return;\n                          }\n                          field.delete(index);\n                        }}\n                      />\n                    </div>\n                  )}\n                </div>\n              ))}\n\n              <div className={s['input-add-icon']}>\n                <IconButton\n                  className=\"!block\"\n                  color=\"highlight\"\n                  size=\"small\"\n                  icon={<IconCozPlus />}\n                  onClick={() => {\n                    field.append({\n                      id: `${field.value?.length ?? 0}`,\n                      name: '',\n                      input: { type: ValueExpressionType.REF },\n                    });\n                  }}\n                />\n              </div>\n            </FormCard>\n          );\n        }}\n      </FieldArray>\n    </div>\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport {\n  type ExpressionEditorTreeNode,\n  ExpressionEditorTreeHelper,\n} from '@coze-workflow/components';\nimport { useWorkflowNode } from '@coze-workflow/base';\n\nimport { convertInputs } from '@/form-extensions/setters/expression-editor/utils/convert-inputs';\nimport { useNodeAvailableVariablesWithNode } from '@/form-extensions/hooks';\n\nconst useInputs = (): {\n  name: string;\n  keyPath?: string[];\n}[] => {\n  const workflowNode = useWorkflowNode();\n  const inputs = workflowNode?.inputParameters ?? [];\n  return convertInputs(inputs);\n};\n\nexport const useVariableTree = (): ExpressionEditorTreeNode[] => {\n  const variables = useNodeAvailableVariablesWithNode();\n  const inputs = useInputs();\n\n  const availableVariables = ExpressionEditorTreeHelper.findAvailableVariables({\n    variables,\n    inputs,\n  });\n\n  const variableTree =\n    ExpressionEditorTreeHelper.createVariableTree(availableVariables);\n  return variableTree;\n};\n\nexport const useParseText = (\n  text?: string | (() => string),\n): string | undefined =>\n  useMemo((): string | undefined => {\n    if (!text) {\n      return;\n    }\n    if (typeof text === 'string') {\n      return text;\n    }\n    if (typeof text === 'function') {\n      return text();\n    }\n    return;\n  }, [text]);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  type FC,\n} from 'react';\n\nimport { debounce } from 'lodash-es';\nimport classNames from 'classnames';\nimport { SelectorBoxConfigEntity } from '@flowgram-adapter/free-layout-editor';\nimport { useEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  ExpressionEditorCounter,\n  ExpressionEditorEvent,\n  ExpressionEditorModel,\n  type ExpressionEditorTreeNode,\n  Expression,\n} from '@coze-workflow/components';\nimport { type InputValueVO, useNodeTestId } from '@coze-workflow/base';\n\nimport { useParseText, useVariableTree } from '../hooks';\n\nimport styles from './index.module.less';\n\nexport interface ExpressionEditorContainerProps {\n  name: string;\n  value: string;\n  key?: string;\n  placeholder?: string | (() => string);\n  readonly?: boolean;\n  disableSuggestion?: boolean;\n  disableCounter?: boolean;\n  onChange?: (value: string) => void;\n  minRows?: number;\n  maxLength?: number;\n  onBlur?: () => void;\n  onFocus?: () => void;\n  isError?: boolean;\n  inputParameters?: InputValueVO[];\n  className?: string;\n  containerClassName?: string;\n  shouldUseContainerRef?: boolean;\n  testId?: string;\n  onChangeTrigger?: 'onChange' | 'onBlur';\n}\n\n/**\n * Aggregation layer for business logic and editor logic\n */\nexport const ExpressionEditorContainer: FC<\n  ExpressionEditorContainerProps\n> = props => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const {\n    name,\n    key,\n    onChange,\n    onBlur,\n    onFocus,\n    isError,\n    readonly = false,\n    disableSuggestion = false,\n    disableCounter = true,\n    minRows = 4,\n    className,\n    containerClassName,\n    shouldUseContainerRef,\n    testId,\n    onChangeTrigger = 'onBlur',\n  } = props;\n  const maxLength = undefined; // Temporary Disable\n  const variableTree: ExpressionEditorTreeNode[] = useVariableTree();\n  const [focus, _setFocus] = useState<boolean>(false);\n  const { getNodeSetterId } = useNodeTestId();\n\n  const selectorBoxConfig = useEntity<SelectorBoxConfigEntity>(\n    SelectorBoxConfigEntity,\n  );\n\n  const [curEditorVal, setCurEditorVal] = useState<string>(props.value || '');\n\n  const placeholder = useParseText(props.placeholder);\n  const dataTestID = getNodeSetterId(testId ?? name);\n  const formValue: string = props.value || '';\n  const [model] = useState<ExpressionEditorModel>(\n    () => new ExpressionEditorModel(formValue),\n  );\n  model.setVariableTree(variableTree);\n  model.setFocus(focus);\n\n  // Set anti-shake to prevent onFocus/onBlur from shaking when clicked\n  const setFocus = useCallback(\n    debounce((newFocusValue: boolean) => {\n      _setFocus(newFocusValue);\n    }, 50),\n    [],\n  );\n\n  const overflow = useMemo(() => {\n    if (typeof maxLength !== 'number') {\n      return false;\n    }\n    return model.value.length > maxLength;\n  }, [model.value.length, maxLength]);\n\n  useEffect(() => {\n    const disposer = model.on<ExpressionEditorEvent.Change>(\n      ExpressionEditorEvent.Change,\n      params => {\n        onChange && onChange(params.value);\n      },\n    );\n    return () => {\n      disposer();\n    };\n  }, [onChange]);\n\n  function handlePopoverVisibilityChange(visible: boolean) {\n    if (visible) {\n      selectorBoxConfig.disabled = true;\n    } else {\n      selectorBoxConfig.disabled = false;\n    }\n  }\n\n  /**\n   * There is a situation where value and editor.getValue () are always inconsistent when entering Chinese, resulting in re-rendering\n   * So update the form data when changing to onBlur\n   */\n  const handleOnBlur = () => {\n    if (onChangeTrigger === 'onBlur') {\n      onChange?.(curEditorVal);\n    }\n    setFocus(false);\n    onBlur?.();\n  };\n\n  return (\n    <div\n      key={key}\n      className={classNames(\n        containerClassName,\n        styles['expression-editor-container'],\n        {\n          [styles['expression-editor-focused']]: focus,\n          [styles['expression-editor-error']]: isError || overflow,\n        },\n      )}\n      onFocus={() => {\n        setFocus(true);\n        onFocus?.();\n      }}\n      onBlur={handleOnBlur}\n      ref={containerRef}\n    >\n      <Expression.EditorProvider>\n        <Expression.Renderer\n          value={formValue}\n          variableTree={variableTree}\n          className={classNames(\n            className,\n            styles['editor-render'],\n            styles['editor-render-cm-content'],\n            styles[`editor-render-cmMinRows-${minRows}`],\n            {\n              [styles['editor-render-bottom-padding']]:\n                !disableCounter || overflow,\n            },\n          )}\n          readonly={readonly}\n          placeholder={placeholder}\n          dataTestID={dataTestID}\n          onChange={v => {\n            onChangeTrigger === 'onBlur' ? setCurEditorVal(v) : onChange?.(v);\n          }}\n        />\n        {readonly || disableSuggestion ? null : (\n          <Expression.Popover\n            variableTree={variableTree}\n            getPopupContainer={() =>\n              shouldUseContainerRef\n                ? containerRef.current ?? document.body\n                : document.body\n            }\n            onVisibilityChange={handlePopoverVisibilityChange}\n          />\n        )}\n      </Expression.EditorProvider>\n\n      <ExpressionEditorCounter\n        model={model}\n        maxLength={maxLength}\n        disabled={disableCounter && !overflow}\n        isError={overflow}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type ComponentProps } from '@/nodes-v2/components/types';\n\nimport {\n  ExpressionEditorContainer,\n  type ExpressionEditorContainerProps,\n} from './container';\n\nexport type ExpressionEditorProps = ComponentProps<string> &\n  ExpressionEditorContainerProps;\n\nexport const ExpressionEditor = (props: ExpressionEditorProps) => {\n  const readonly = useReadonly();\n\n  return <ExpressionEditorContainer {...props} readonly={readonly} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classnames from 'classnames';\nimport {\n  type FieldState,\n  type FieldError,\n  type FieldWarning,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type WithCustomStyle } from '@coze-workflow/base/types';\n\nimport s from './index.module.less';\n\nexport interface FormItemErrorProps extends WithCustomStyle {\n  errors?: FieldState['errors'];\n  // Coze has no warnings\n  // warnings?: FieldState['warnings'];\n}\n\nexport const FormItemFeedback = ({\n  errors,\n  className,\n  style,\n}: FormItemErrorProps) => {\n  const renderFeedbacks = (fs: FieldError[] | FieldWarning[]) =>\n    fs.map(f => <span key={f.field}>{f.message}</span>);\n  return errors ? (\n    <div className={classnames(s.formItemError, className)} style={style}>\n      {renderFeedbacks(errors)}\n    </div>\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const nameValidationRule =\n  /^(?!.*\\b(true|false|and|AND|or|OR|not|NOT|null|nil|If|Switch)\\b)[a-zA-Z_][a-zA-Z_$0-9]*$/;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode, type CSSProperties } from 'react';\n\nimport classNames from 'classnames';\nimport { IconInfo } from '@coze-arch/bot-icons';\n\nimport AutoSizeTooltip from '@/ui-components/auto-size-tooltip';\n\nexport interface InputLabelProps {\n  required?: boolean;\n  hideRequiredTag?: boolean;\n  label: ReactNode;\n  tooltip?: ReactNode;\n  tag?: ReactNode;\n  className?: string;\n  labelStyle?: CSSProperties;\n  labelClassName?: string;\n  tootipPopoverClassName?: string;\n  tootipIconClassName?: string;\n}\n\nconst InputLabel = ({\n  required,\n  hideRequiredTag = false,\n  label,\n  tooltip,\n  tag,\n  labelStyle = {\n    fontSize: 12,\n    marginRight: 0,\n  },\n  className,\n  labelClassName,\n  tootipPopoverClassName,\n  tootipIconClassName,\n}: InputLabelProps) => (\n  <div className={classNames('flex mr-2 items-baseline', className)}>\n    <div className=\"flex overflow-hidden\">\n      <AutoSizeTooltip\n        content={label}\n        showArrow\n        position=\"top\"\n        className=\"flex-1 grow-1 truncate\"\n      >\n        <span\n          className={classNames('flex-1 grow-1 truncate', labelClassName)}\n          style={labelStyle}\n        >\n          {label}\n        </span>\n      </AutoSizeTooltip>\n\n      {required && !hideRequiredTag ? (\n        <span\n          style={{ color: 'var(--light-usage-danger-color-danger,#f93920)' }}\n        >\n          *\n        </span>\n      ) : null}\n      {tooltip ? (\n        <div className=\"ml-[4px] mt-[2px]\">\n          <AutoSizeTooltip\n            showArrow\n            position=\"top\"\n            className={tootipPopoverClassName}\n            content={tooltip}\n          >\n            <IconInfo className={tootipIconClassName} />\n          </AutoSizeTooltip>\n        </div>\n      ) : null}\n    </div>\n    {tag ? <div className=\"flex-1 shrink-0 grow-1\">{tag}</div> : null}\n  </div>\n);\n\nexport default InputLabel;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useEffect, useState } from 'react';\n\nimport {\n  useCurrentEntity,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowVariableFacadeService } from '@coze-workflow/variable';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tooltip, Input, Typography } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport {\n  getVariableName,\n  getUniqueName,\n} from '@/form-extensions/setters/node-input-name/utils';\n\nimport type { NodeInputNameProps } from './type';\n\n// eslint-disable-next-line complexity\nexport const NodeInputName = ({\n  value,\n  onChange,\n  onBlur,\n  name,\n  style,\n  input,\n  inputParameters,\n  initValidate = false,\n  isPureText = false,\n  prefix = '',\n  suffix = '',\n  format,\n  tooltip,\n  isError,\n  inputPrefix,\n  disabled,\n}: NodeInputNameProps) => {\n  const [initialized, setInitialized] = useState<boolean>(false);\n  const [userEdited, setUserEdited] = useState<boolean>(false);\n  const [variableName, setVariableName] = useState<string | undefined>(value);\n  const [text, setText] = useState<string | undefined>(value);\n  const readonly = useReadonly();\n\n  const node = useCurrentEntity();\n  const variableService = useService(WorkflowVariableFacadeService);\n  const { getNodeSetterId } = useNodeTestId();\n\n  // The text state is controlled (the value of the linked text when deleting a node)\n  useEffect(() => {\n    if (value !== text) {\n      setText(value);\n    }\n  }, [value]);\n\n  const computedVariableName = getVariableName({\n    input,\n    prefix,\n    suffix,\n    format,\n    node,\n    variableService,\n  });\n\n  const onInputChange = useCallback((newInputValue: string): void => {\n    setUserEdited(true);\n    setText(newInputValue || '');\n    setVariableName(undefined);\n  }, []);\n\n  const handleOnBlur = () => {\n    onChange(text || '');\n    onBlur?.();\n  };\n\n  useEffect(() => {\n    if (initValidate) {\n      // Initialize write value to trigger verification\n      onChange(value);\n      onBlur?.();\n    }\n    if (value) {\n      setUserEdited(true);\n    }\n    setInitialized(true);\n  }, [initValidate, onChange, value]);\n\n  if (initialized && !readonly && !userEdited) {\n    if (computedVariableName && computedVariableName !== variableName) {\n      const computedUniqueName = getUniqueName({\n        variableName: computedVariableName,\n        inputParameters,\n      });\n      onChange(computedUniqueName);\n      setVariableName(computedVariableName);\n      setText(computedUniqueName);\n    } else if (!computedVariableName && variableName) {\n      setVariableName(undefined);\n      setText(undefined);\n    }\n  }\n\n  return (\n    <div\n      className=\"flex items-center\"\n      style={{\n        ...style,\n        pointerEvents: readonly ? 'none' : 'auto',\n      }}\n    >\n      {isPureText ? (\n        <>\n          <Typography.Text className=\"h-8 leading-8\">{value}</Typography.Text>\n          {tooltip ? (\n            <Tooltip content={tooltip}>\n              <IconCozInfoCircle\n                className=\"ml-1\"\n                style={{\n                  fontSize: 12,\n                }}\n              />\n            </Tooltip>\n          ) : null}\n        </>\n      ) : (\n        <>\n          <Input\n            size={'small'}\n            data-testid={getNodeSetterId(name)}\n            value={text}\n            onChange={onInputChange}\n            onBlur={handleOnBlur}\n            validateStatus={isError ? 'error' : undefined}\n            placeholder={I18n.t('workflow_detail_node_input_entername')}\n            prefix={inputPrefix}\n            disabled={disabled}\n          />\n          {tooltip ? (\n            <Tooltip content={tooltip}>\n              <IconCozInfoCircle\n                className=\"ml-1\"\n                style={{\n                  fontSize: 12,\n                }}\n              />\n            </Tooltip>\n          ) : null}\n        </>\n      )}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { nameValidationRule } from '../helpers';\n\nexport interface CreateNodeInputNameValidateOptions {\n  getNames?: ({ value, formValues }) => string[];\n  validatorConfig?: {\n    rule?: RegExp;\n    errorMessage?: string;\n  };\n  invalidValues?: Record<string, string>;\n  skipValidate?: ({ value, formValues }) => boolean;\n}\n\nconst defaultGetNames = ({ formValues }) =>\n  formValues.inputParameters.map(item => item.name);\n\nexport const createNodeInputNameValidate =\n  (options?: CreateNodeInputNameValidateOptions): Validate =>\n  ({ value, formValues }) => {\n    const {\n      getNames = defaultGetNames,\n      validatorConfig,\n      invalidValues,\n      skipValidate,\n    } = options || {};\n    if (skipValidate?.({ value, formValues })) {\n      return;\n    }\n\n    const validatorRule = validatorConfig?.rule ?? nameValidationRule;\n    const validatorErrorMessage =\n      validatorConfig?.errorMessage ??\n      I18n.t('workflow_detail_node_error_format');\n\n    /** name check */\n    if (!validatorRule.test(value)) {\n      return validatorErrorMessage;\n    }\n\n    /** Illegal value verification */\n    if (invalidValues?.[value]) {\n      return invalidValues[value];\n    }\n\n    const names: string[] = getNames({ value, formValues });\n\n    const foundSames = names.filter((name: string) => name === value);\n\n    return foundSames.length > 1\n      ? I18n.t('workflow_detail_node_input_duplicated')\n      : undefined;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { useEffect, useMemo, useRef } from 'react';\n\nimport { useForm, useRefresh } from '@flowgram-adapter/free-layout-editor';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowBatchService } from '@coze-workflow/variable';\nimport { sortErrorBody, useIsSettingOnErrorV2 } from '@coze-workflow/nodes';\nimport { HistoryService } from '@coze-workflow/history';\nimport { BatchMode, type ViewVariableTreeNode } from '@coze-workflow/base';\nimport { useNodeTestId } from '@coze-workflow/base';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type ValidationProps } from '@/nodes-v2/components/validation/with-validation';\nimport { type ComponentProps } from '@/nodes-v2/components/types';\nimport {\n  OutputTree,\n  type OutputTreeProps,\n} from '@/form-extensions/components/output-tree';\n\nimport { withValidation } from '../validation';\n\ntype OutputTreeValue = Array<ViewVariableTreeNode> | undefined;\ntype SortValue = (\n  value?: ViewVariableTreeNode[] | undefined,\n  isBatch?: boolean,\n) => ViewVariableTreeNode[] | undefined;\ninterface OutputTreeOptions {\n  id: string;\n  batchMode?: BatchMode;\n  withDescription?: boolean;\n  withRequired?: boolean;\n  disabled?: boolean;\n  disabledTooltip?: string;\n  readonly?: boolean;\n  topLevelReadonly?: boolean;\n  allowDeleteLast?: boolean;\n  emptyPlaceholder?: string;\n  showResponseFormat?: boolean;\n  needErrorBody?: boolean;\n  hide?: boolean;\n  defaultCollapse?: boolean;\n  needAppendChildWhenNodeIsPreset?: boolean;\n  noCard?: boolean;\n  sortValue?: SortValue; // sorting function\n}\ntype OutputsProps = ComponentProps<OutputTreeValue> &\n  OutputTreeOptions &\n  Pick<\n    OutputTreeProps,\n    | 'hiddenTypes'\n    | 'addItemTitle'\n    | 'withDefaultValue'\n    | 'defaultExpandParams'\n    | 'columnsRatio'\n    | 'maxLimit'\n  > &\n  ValidationProps;\n\nexport const Outputs = withValidation<OutputsProps>((props: OutputsProps) => {\n  const {\n    name,\n    value,\n    onChange,\n    id,\n    disabled = false,\n    batchMode,\n    withDescription = false,\n    withRequired = false,\n    readonly = false,\n    topLevelReadonly = false,\n    allowDeleteLast = false,\n    emptyPlaceholder,\n    hiddenTypes,\n    showResponseFormat = false,\n    needErrorBody = false,\n    hide = false,\n    defaultCollapse,\n    needAppendChildWhenNodeIsPreset,\n    noCard,\n    sortValue,\n  } = props || {};\n\n  const form = useForm();\n\n  const workflowReadonly = useReadonly();\n\n  const isBatch = batchMode === BatchMode.Batch;\n  const historyService = useService<HistoryService>(HistoryService);\n  const refresh = useRefresh();\n  const isSettingOnErrorV2 = useIsSettingOnErrorV2();\n\n  // Record current batchMode\n  const curBatchMode = useRef<BatchMode>();\n\n  // Changes do not record history\n  const onChangeWithoutHistory = (outputTreeValue: OutputTreeValue) => {\n    historyService.stop();\n    onChange(outputTreeValue);\n    historyService.start();\n  };\n\n  useEffect(() => {\n    /**\n     * When initializing, assign curBatchMode, but do not modify the value\n     */\n    if (!curBatchMode.current) {\n      curBatchMode.current = batchMode;\n      return;\n    }\n\n    /**\n     * To switch batch mode, you need to wrap the output of single mode into a list, or remove the list layer from the outputList of batch mode\n     */\n    if (batchMode !== curBatchMode.current) {\n      curBatchMode.current = batchMode;\n\n      if (batchMode === BatchMode.Batch) {\n        onChangeWithoutHistory(\n          WorkflowBatchService.singleOutputMetasToList(value),\n        );\n        return;\n      }\n      if (batchMode === BatchMode.Single) {\n        onChangeWithoutHistory(\n          WorkflowBatchService.listOutputMetasToSingle(value),\n        );\n        return;\n      }\n    }\n  }, [batchMode, onChange]);\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  // To sort value, ensure that the errorbody property is at the bottom\n  const _value = useMemo(() => {\n    const sortedValue = sortValue ? sortValue(value, isBatch) : value;\n    if (needErrorBody) {\n      return sortErrorBody({\n        value: sortedValue as ViewVariableTreeNode[],\n        isBatch,\n        isSettingOnErrorV2,\n      });\n    }\n    return sortedValue;\n  }, [value, needErrorBody, isBatch, isSettingOnErrorV2]);\n\n  if (hide) {\n    return null;\n  }\n\n  return (\n    <OutputTree\n      {...props}\n      id={id}\n      testId={getNodeSetterId(name)}\n      responseFormat={{\n        visible: showResponseFormat,\n        value: form.getValueIn('model.responseFormat'),\n        readonly: needErrorBody,\n        onChange: v => {\n          const model = form.getValueIn('model');\n          if (model) {\n            form.setValueIn('model', {\n              ...model,\n              responseFormat: v,\n            });\n          }\n          refresh();\n        },\n      }}\n      readonly={readonly || workflowReadonly}\n      disabled={disabled}\n      value={_value as any}\n      onChange={onChange as any}\n      isBatch={isBatch}\n      withDescription={withDescription}\n      withRequired={withRequired}\n      topLevelReadonly={topLevelReadonly}\n      allowDeleteLast={allowDeleteLast}\n      emptyPlaceholder={emptyPlaceholder}\n      hiddenTypes={hiddenTypes}\n      defaultCollapse={defaultCollapse}\n      needAppendChildWhenNodeIsPreset={needAppendChildWhenNodeIsPreset}\n      noCard={noCard}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  type FieldError,\n  useEntityFromContext,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { ValidationProvider } from '@/form-extensions/components/validation';\n\nexport interface ValidationProps {\n  errors?: FieldError[];\n}\n\nexport function withValidation<T extends ValidationProps>(\n  component: React.ComponentType<T>,\n) {\n  const Comp = component;\n\n  return props => {\n    const { errors: fieldErrors } = props;\n    const errors = fieldErrors?.length\n      ? JSON.parse(fieldErrors[0].message || '').issues\n      : undefined;\n\n    const node = useEntityFromContext();\n    const formModel = node\n      .getData<FlowNodeFormData>(FlowNodeFormData)\n      .getFormModel<FormModelV2>();\n\n    return (\n      <ValidationProvider\n        errors={errors}\n        onTestRunValidate={callback => {\n          const { dispose } = formModel.onValidate(callback);\n          return dispose;\n        }}\n      >\n        <Comp {...props} />\n      </ValidationProvider>\n    );\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { get } from 'lodash-es';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  useVariableTypeChange,\n  WorkflowVariableService,\n} from '@coze-workflow/variable';\nimport {\n  type ViewVariableType,\n  ValueExpressionType,\n  useNodeTestId,\n  type ValueExpression,\n} from '@coze-workflow/base';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type ComponentProps } from '@/nodes-v2/components/types';\nimport { useNodeAvailableVariablesWithNode } from '@/form-extensions/hooks';\nimport { type InputType } from '@/form-extensions/components/value-expression-input/InputField';\nimport {\n  ValueExpressionInput as ValueExpressionInputComponent,\n  type ValueExpressionInputProps as ValueExpressionInputComponentProps,\n} from '@/form-extensions/components/value-expression-input';\nimport {\n  formatWithNodeVariables,\n  formatVariableDataByMatchType,\n} from '@/form-extensions/components/tree-variable-selector/utils';\n\ninterface ValueExpressionInputOptions\n  extends Pick<\n    ValueExpressionInputComponentProps,\n    | 'style'\n    | 'variableTagStyle'\n    | 'disabledTypes'\n    | 'availableFileTypes'\n    | 'literalDisabled'\n    | 'refDisabled'\n    | 'hideDeleteIcon'\n    | 'hideSettingIcon'\n    | 'showClear'\n    | 'readonly'\n    | 'customFilterVar'\n    | 'placeholder'\n    | 'refTagColor'\n    | 'selectStyle'\n    | 'literalStyle'\n    | 'forbidTypeCast'\n    | 'defaultInputType'\n    | 'inputType'\n    | 'inputTypes'\n    | 'inputPlaceholder'\n    | 'literalConfig'\n  > {\n  isError?: boolean;\n  matchType?: ViewVariableType;\n}\n\nexport type ValueExpressionInputProps = ComponentProps<\n  ValueExpression | undefined\n> &\n  ValueExpressionInputOptions;\n\nexport const ValueExpressionInput = (props: ValueExpressionInputProps) => {\n  const {\n    value,\n    onChange,\n    onBlur,\n    style,\n    selectStyle,\n    literalStyle,\n    disabledTypes,\n    availableFileTypes = [],\n    literalDisabled = false,\n    refDisabled = false,\n    showClear = false,\n    hideDeleteIcon = false,\n    hideSettingIcon = false,\n    readonly: setterReadonly,\n    inputType,\n    inputTypes,\n    customFilterVar,\n    name,\n    isError,\n    placeholder,\n    inputPlaceholder,\n    refTagColor,\n    matchType,\n    forbidTypeCast,\n    defaultInputType,\n    literalConfig,\n  } = props;\n\n  const globalReadonly = useReadonly();\n\n  const readonly = globalReadonly || setterReadonly;\n\n  const availableVariables = useNodeAvailableVariablesWithNode();\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const variableService: WorkflowVariableService = useService(\n    WorkflowVariableService,\n  );\n  const variablesDataSource = formatWithNodeVariables(\n    availableVariables,\n    disabledTypes || [],\n  );\n\n  const variablesMatchedDataSource = formatVariableDataByMatchType(\n    variablesDataSource,\n    matchType,\n  );\n\n  const keyPath = get(value, 'content.keyPath') as string[] | undefined;\n\n  // Monitor changes in linkage variables to re-trigger the effect\n  useEffect(() => {\n    const hasDisabledTypes =\n      Array.isArray(disabledTypes) && disabledTypes.length > 0;\n\n    if (!keyPath || !hasDisabledTypes) {\n      return;\n    }\n\n    const listener = variableService.onListenVariableTypeChange(\n      keyPath,\n      v => {\n        // If the variable type changes and is located in disabledTypes, it needs to be cleared\n        if (v && (disabledTypes || []).includes(v.type)) {\n          onChange({\n            type: ValueExpressionType.REF,\n          });\n        }\n      },\n      {},\n    );\n\n    return () => {\n      listener?.dispose();\n    };\n  }, [keyPath, disabledTypes, variableService, onChange]);\n\n  useVariableTypeChange({\n    keyPath,\n    onTypeChange: ({ variableMeta: v }) => {\n      const hasDisabledTypes =\n        Array.isArray(disabledTypes) && disabledTypes.length > 0;\n      if (!hasDisabledTypes) {\n        return;\n      }\n\n      if (v && (disabledTypes || []).includes(v.type)) {\n        onChange({\n          type: ValueExpressionType.REF,\n        });\n      }\n    },\n  });\n  const targetInputType = inputType;\n\n  return (\n    <ValueExpressionInputComponent\n      testId={getNodeSetterId(name)}\n      readonly={readonly}\n      value={value}\n      onChange={onChange}\n      onBlur={onBlur}\n      inputType={targetInputType as InputType}\n      inputTypes={inputTypes}\n      variablesDatasource={variablesMatchedDataSource}\n      validateStatus={isError ? 'error' : undefined}\n      style={style}\n      selectStyle={selectStyle}\n      literalStyle={literalStyle}\n      disabledTypes={disabledTypes as ViewVariableType[]}\n      availableFileTypes={availableFileTypes}\n      literalDisabled={literalDisabled}\n      refDisabled={refDisabled}\n      showClear={showClear}\n      customFilterVar={customFilterVar}\n      placeholder={placeholder}\n      inputPlaceholder={inputPlaceholder}\n      refTagColor={refTagColor}\n      hideDeleteIcon={hideDeleteIcon}\n      hideSettingIcon={hideSettingIcon}\n      forbidTypeCast={forbidTypeCast}\n      defaultInputType={defaultInputType}\n      literalConfig={literalConfig}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport {\n  useEntityFromContext,\n  type FlowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type StandardNodeType } from '@coze-workflow/base';\n\nimport { WorkflowPlaygroundContext } from '@/workflow-playground-context';\nexport function useDefaultNodeMeta() {\n  const node = useEntityFromContext() as FlowNodeEntity;\n  const playgroundContext = node.getService<WorkflowPlaygroundContext>(\n    WorkflowPlaygroundContext,\n  );\n\n  return useMemo(() => {\n    const meta = playgroundContext.getNodeTemplateInfoByType(\n      node.flowNodeType as StandardNodeType,\n    );\n    const { nodesService } = playgroundContext as WorkflowPlaygroundContext;\n\n    if (!meta) {\n      return undefined;\n    }\n\n    return {\n      ...meta,\n      title: nodesService.createUniqTitle(meta.title, node),\n    };\n  }, []);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport {\n  PlaygroundConfigEntity,\n  useConfigEntity,\n  useRefresh,\n} from '@flowgram-adapter/free-layout-editor';\nexport function useReadonly() {\n  const playgroundConfig = useConfigEntity<PlaygroundConfigEntity>(\n    PlaygroundConfigEntity,\n  );\n\n  const refresh = useRefresh();\n\n  useEffect(() => {\n    const disposable = playgroundConfig.onReadonlyOrDisabledChange(() => {\n      refresh();\n    });\n\n    return () => {\n      disposable.dispose();\n    };\n  }, []);\n\n  return playgroundConfig.readonly;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IDataSetInfo } from '@coze-data/knowledge-modal-base';\nimport {\n  type FCPluginSetting,\n  type APIParameter,\n  type FCWorkflowSetting,\n} from '@coze-arch/idl/workflow_api';\nimport { type PluginFrom } from '@coze-arch/idl/playground_api';\n\nexport enum SkillType {\n  Plugin = 'plugin',\n  Workflow = 'workflow',\n  Knowledge = 'knowledge',\n}\n\nexport type PluginFCParamsSetting = APIParameter;\n\nexport type FCRequestParamsSetting = PluginFCParamsSetting;\nexport type FCResponseParamsSetting = PluginFCParamsSetting;\nexport interface FCResponseStyleSetting {\n  mode: number;\n}\n\nexport type PluginFCSetting = FCPluginSetting;\nexport type WorkflowFCSetting = FCWorkflowSetting;\n\nexport interface BoundWorkflowItem {\n  plugin_id: string;\n  workflow_id: string;\n  // If it is a project, fill in the project version, and fill in the plugin version in the resource library.\n  plugin_version: string;\n  workflow_version: string;\n  // Fill in true if it is project, false for resource library\n  is_draft: boolean;\n  fc_setting?: WorkflowFCSetting;\n}\n\nexport interface BoundPluginItem {\n  plugin_id: string;\n  api_id: string;\n  api_name: string;\n  // If it is a project, fill in the project version, and fill in the plugin version in the resource library.\n  plugin_version: string;\n  // Fill in true if it is project, false for resource library\n  is_draft: boolean;\n  fc_setting?: PluginFCSetting;\n  plugin_from?: PluginFrom;\n}\n\nexport interface BoundKnowledgeItem {\n  id: string;\n  name: string;\n}\n\nexport type KnowledgeGlobalSetting = Omit<IDataSetInfo, 'recall_strategy'> & {\n  use_rerank: boolean;\n  use_rewrite: boolean;\n  use_nl2_sql: boolean;\n};\n\nexport interface BoundSkills {\n  workflowFCParam?: {\n    workflowList?: Array<BoundWorkflowItem>;\n  };\n  pluginFCParam?: {\n    pluginList?: Array<BoundPluginItem>;\n  };\n  knowledgeFCParam?: {\n    knowledgeList?: Array<BoundKnowledgeItem>;\n    global_setting?: KnowledgeGlobalSetting;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozKnowledgeFill } from '@coze-arch/coze-design/icons';\n\nexport enum SkillKnowledgeSiderCategory {\n  Library = 'library',\n  Project = 'project',\n}\n\ninterface Props {\n  projectId?: string;\n  category?: string;\n  setCategory?: (category: SkillKnowledgeSiderCategory) => void;\n}\n\ninterface SiderCategoryProps {\n  label: string;\n  selected: boolean;\n\n  onClick?: React.MouseEventHandler<HTMLDivElement>;\n}\n\nconst SiderCategory = ({ label, onClick, selected }: SiderCategoryProps) => (\n  <div\n    onClick={onClick}\n    className={classNames([\n      'flex items-center gap-[8px] px-[12px]',\n      'px-[12px] py-[6px] rounded-[8px]',\n      'cursor-pointer',\n      'hover:text-[var(--light-usage-text-color-text-0,#1c1f23)]',\n      'hover:bg-[var(--light-usage-fill-color-fill-0,rgba(46,50,56,5%))]',\n      selected &&\n        'text-[var(--light-usage-text-color-text-0,#1c1d23)] bg-[var(--light-usage-fill-color-fill-0,rgba(46,47,56,5%))]',\n    ])}\n  >\n    <IconCozKnowledgeFill />\n    {label}\n  </div>\n);\n\nexport const SkillKnowledgeSider: React.FC<Props> = ({\n  projectId,\n  category = SkillKnowledgeSiderCategory.Library,\n  setCategory,\n}) => (\n  <>\n    <SiderCategory\n      label={I18n.t('project_resource_modal_library_resources', {\n        resource: I18n.t('resource_type_knowledge'),\n      })}\n      onClick={() => {\n        setCategory?.(SkillKnowledgeSiderCategory.Library);\n      }}\n      selected={category === SkillKnowledgeSiderCategory.Library}\n    />\n    {projectId ? (\n      <SiderCategory\n        label={I18n.t('project_resource_modal_project_resources', {\n          resource: I18n.t('resource_type_knowledge'),\n        })}\n        onClick={() => {\n          setCategory?.(SkillKnowledgeSiderCategory.Project);\n        }}\n        selected={category === SkillKnowledgeSiderCategory.Project}\n      />\n    ) : null}\n  </>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nexport enum JsonEditorTheme {\n  Light = 'coze-light',\n  Dark = 'coze-dark',\n}\n\nexport const PARAMS_COLUMNS = [\n  {\n    title: I18n.t('workflow_detail_node_parameter_name'),\n    style: {\n      flex: 2,\n    },\n  },\n  {\n    title: I18n.t('card_builder_api_http_params_columns_type'),\n    style: {\n      flex: 2,\n    },\n  },\n  {\n    title: I18n.t('workflow_detail_node_parameter_value'),\n    style: {\n      flex: 3,\n    },\n  },\n];\n\nexport const INPUT_VALUE_COLUMNS = [\n  {\n    title: I18n.t('workflow_detail_node_parameter_name'),\n    style: {\n      flex: 2,\n    },\n  },\n  {\n    title: I18n.t('workflow_detail_node_parameter_value'),\n    style: {\n      flex: 3,\n    },\n  },\n];\n\nexport enum DTOFieldType {\n  File = 'file',\n  String = 'string',\n}\n\n/**\n * Backend Data Types - > Frontend Data Types\n */\nexport const fileTypeDTOToVO = {\n  [DTOFieldType.File]: ViewVariableType.File,\n  [DTOFieldType.String]: ViewVariableType.String,\n};\n\n/**\n * Front-end data types - > Back-end data types\n */\nexport const fileTypeVOToDTO = {\n  [ViewVariableType.File]: DTOFieldType.File,\n  [ViewVariableType.String]: DTOFieldType.String,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\n\nimport { valueExpressionValidator } from '@/form-extensions/validators';\n\nimport { AuthType, authTypeToField } from '../constants';\n\nexport function createAuthValidator() {\n  const validators = {};\n  Object.keys(AuthType).forEach(key => {\n    const subPath = key === 'Custom' ? '.data.*.input' : '.*.input';\n    const pathName = `inputs.auth.authData.${\n      authTypeToField[AuthType[key]] + subPath\n    }`;\n    validators[pathName] = ({ value, formValues, context }) => {\n      const authOpen = get(formValues, 'inputs.auth.authOpen');\n      const authType: AuthType = get(formValues, 'inputs.auth.authType');\n      if (!authOpen || authType !== AuthType[key]) {\n        return undefined;\n      }\n      const { playgroundContext, node } = context;\n\n      return valueExpressionValidator({\n        value,\n        playgroundContext,\n        node,\n        required: true,\n      });\n    };\n  });\n  return validators;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport enum StringMethod {\n  Concat = 'concat',\n  Split = 'split',\n}\n\nexport const PREFIX_STR = 'String';\n\n/** Maximum number of custom separators/splices */\nexport const MAX_CUSTOM_LENGTH = 20;\n\n/** The maximum number of delimiter characters displayed in the drop-down box */\nexport const MAX_TAG_SIZE = 4;\n\n/** Front-end form field name */\nexport const FIELD_NAME_MAP = {\n  method: 'method',\n  concatResult: 'concatResult',\n  delimiter: 'delimiter',\n  concatChar: 'concatChar',\n  outputs: 'outputs',\n};\n\n/** backend field name */\nexport const BACK_END_NAME_MAP = {\n  delimiters: 'delimiters',\n  allDelimiters: 'allDelimiters',\n  allArrayItemConcatChars: 'allArrayItemConcatChars',\n  arrayItemConcatChar: 'arrayItemConcatChar',\n};\n\n/** Collection of string handling methods */\nexport const STRING_METHOD_OPTIONS = [\n  {\n    label: I18n.t('workflow_stringprocess_node_method_concat'),\n    value: StringMethod.Concat,\n  },\n  {\n    label: I18n.t('workflow_stringprocess_node_method_sep'),\n    value: StringMethod.Split,\n  },\n];\n\n/** separator option */\nexport const OPTION_SCHEMA = {\n  type: 'object',\n  schema: [\n    {\n      type: 'string',\n      name: 'label',\n      required: true,\n    },\n    {\n      type: 'string',\n      name: 'value',\n      required: true,\n    },\n    {\n      type: 'boolean',\n      name: 'isDefault',\n      required: true,\n    },\n  ],\n};\n\n/** Default parameters in splicing mode */\nexport const CONCAT_DEFAULT_INPUTS = [\n  { name: `${PREFIX_STR}1`, input: { type: 'ref' } },\n];\n\n/** Splicing method, component option settings */\nexport const CONCAT_CHAR_SETTINGS = {\n  key: '',\n\n  /** Only one splice can be selected. */\n  multiple: false,\n\n  /** Allow customization */\n  enableCustom: true,\n\n  /** Maximum number of customizations */\n  maxCustomLength: MAX_CUSTOM_LENGTH,\n\n  /** maximum number of impressions */\n  maxTagCount: MAX_TAG_SIZE,\n\n  /** drop-down box prompt */\n  placeholder: I18n.t('workflow_stringprocess_delimiter_option'),\n\n  /** Text box prompt */\n  inputPlaceholder: I18n.t('workflow_textprocess_custom_shading'),\n};\n\n/** Separation method, component option settings */\nexport const SPLIT_CHAR_SETTING = {\n  key: '',\n\n  /** Multiple separators can be selected */\n  multiple: true,\n\n  /** Allow customization */\n  enableCustom: true,\n\n  /** Maximum number of customizations */\n  maxCustomLength: MAX_CUSTOM_LENGTH,\n\n  /** maximum number of impressions */\n  maxTagCount: MAX_TAG_SIZE,\n\n  /** drop-down box prompt */\n  placeholder: I18n.t('workflow_stringprocess_delimiter_option'),\n\n  /** Text box prompt */\n  inputPlaceholder: I18n.t('workflow_stringprocess_delimiter_option'),\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\n\nexport const GROUP_NAME_PREFIX = 'Group';\n\nexport const MATCHED_VARIABLE_TYPES: ViewVariableType[][] = [\n  [ViewVariableType.Number, ViewVariableType.Integer],\n];\n\n/**\n * Maximum number of group names\n */\nexport const MAX_GROUP_NAME_COUNT = 20;\n/**\n * Maximum number of groups\n */\nexport const MAX_GROUP_COUNT = 50;\n/**\n * Maximum number of grouped variables\n */\nexport const MAX_GROUP_VARIABLE_COUNT = 50;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ViewVariableType } from '@coze-workflow/base';\n\nimport { MATCHED_VARIABLE_TYPES } from '../constants';\n\n/**\n * Get the matching type\n * @param viewType\n * @returns\n */\nexport function getMatchedVariableTypes(\n  viewType: ViewVariableType | undefined,\n) {\n  if (!viewType) {\n    return [];\n  }\n  return (\n    MATCHED_VARIABLE_TYPES.find(types => types.includes(viewType)) || [viewType]\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type WorkflowVariableService,\n  variableUtils,\n  type ValueExpression,\n} from '@coze-workflow/variable';\n\n/**\n * Get variable type\n */\nexport function getVariableViewType(\n  variable: ValueExpression | undefined,\n  variableService: WorkflowVariableService,\n  node: WorkflowNodeEntity,\n) {\n  if (!variable) {\n    return undefined;\n  }\n  return variableUtils.getValueExpressionViewType(variable, variableService, {\n    node,\n  });\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { nameValidationRule } from '@/nodes-v2/components/helpers';\n\nimport { MAX_GROUP_NAME_COUNT } from '../constants';\n\nexport const groupNameValidator: Validate = ({ value, formValues }) => {\n  const names = (get(formValues, 'inputs.mergeGroups') || []).map(\n    item => item.name,\n  );\n\n  return validateGroupName(value, names);\n};\n\nexport function validateGroupName(name: string, names: string[]) {\n  /** naming rule validation */\n  if (!nameValidationRule.test(name)) {\n    return I18n.t('workflow_detail_node_error_format');\n  }\n\n  if (name.length > MAX_GROUP_NAME_COUNT) {\n    return I18n.t('workflow_var_merge_name_lengthmax');\n  }\n\n  // duplicate name verification\n  if (names.filter(item => item === name).length > 1) {\n    return I18n.t('workflow_var_merge_output_namedul');\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createEffectOptions,\n  DataEvent,\n  type Effect,\n  type FlowNodeEntity,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowVariableService } from '@coze-workflow/variable';\n\nexport const variablesChangeEffects = [\n  createEffectOptions<Effect>(DataEvent.onValueChange, params => {\n    const { node } = params.context as {\n      node: FlowNodeEntity;\n      playgroundContext: { variableService: WorkflowVariableService };\n    };\n    const formModel = node\n      ?.getData(FlowNodeFormData)\n      ?.getFormModel<FormModelV2>()?.nativeFormModel;\n\n    if (!formModel) {\n      return;\n    }\n\n    // Todo any type requires sdk export\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (formModel.getField(params.name) as any)?.map(child => {\n      child?.validate();\n    });\n  }),\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Components migrated from packages/workflow/playground/src/form-extensions/setters/node-header\n * Only the interface adaptation of the new version of the node engine has been done.\n */\nimport React from 'react';\n\nimport { type FieldError } from '@flowgram-adapter/free-layout-editor';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type ComponentProps } from '@/nodes-v2/components/types';\nimport { useGlobalState, useNodeRenderScene } from '@/hooks';\nimport { NodeHeader as NodeHeaderComponent } from '@/form-extensions/components/node-header';\n\nimport { withValidation } from '../validation';\n\nexport interface NodeHeaderValue {\n  title: string;\n  icon: string;\n  subTitle: string;\n  description: string;\n}\nexport type NodeHeaderProps = ComponentProps<NodeHeaderValue> & {\n  errors?: FieldError[];\n  readonly?: boolean;\n  hideTest?: boolean;\n  batchModePath?: string;\n  outputsPath?: string;\n  extraOperation?: React.ReactNode;\n  showTrigger?: boolean;\n  triggerIsOpen?: boolean;\n  nodeDisabled?: boolean;\n  readonlyAllowDeleteOperation?: boolean;\n};\n\nexport const NodeHeader = withValidation<NodeHeaderProps>(\n  ({\n    value,\n    onChange,\n    onBlur,\n    readonly = false,\n    hideTest = false,\n    extraOperation,\n    showTrigger = false,\n    triggerIsOpen = false,\n    nodeDisabled,\n    readonlyAllowDeleteOperation,\n  }: NodeHeaderProps) => {\n    const { title, icon, subTitle, description } = value || {};\n    const workflowReadonly = useReadonly();\n    const { projectId, projectCommitVersion } = useGlobalState();\n    const { isNodeSideSheet } = useNodeRenderScene();\n\n    return (\n      <NodeHeaderComponent\n        title={title}\n        subTitle={subTitle}\n        // If it is the new version of coze2.0 node rendering, hide the description.\n        description={description}\n        logo={icon}\n        onTitleChange={newTitle => {\n          onChange({ ...value, title: newTitle });\n          onBlur?.();\n        }}\n        onDescriptionChange={desc => {\n          onChange({ ...value, description: desc });\n        }}\n        readonly={readonly || workflowReadonly}\n        readonlyAllowDeleteOperation={\n          workflowReadonly ? false : readonlyAllowDeleteOperation\n        }\n        hideTest={\n          hideTest || IS_BOT_OP || !!(projectId && projectCommitVersion)\n        }\n        showTrigger={showTrigger}\n        triggerIsOpen={triggerIsOpen}\n        extraOperation={extraOperation}\n        showCloseButton={isNodeSideSheet}\n        nodeDisabled={nodeDisabled}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Field,\n  type FieldRenderProps,\n  useCurrentEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNode } from '@coze-workflow/base';\n\nimport { useDefaultNodeMeta } from '@/nodes-v2/hooks/use-default-node-meta';\nimport { type NodeHeaderValue } from '@/nodes-v2/components/node-header';\nimport { NodeHeader } from '@/nodes-v2/components/node-header';\n\ninterface NodeMetaProps {\n  fieldName?: string;\n  deps?: string[];\n  outputsPath?: string;\n  batchModePath?: string;\n}\n\nconst NodeMeta = ({\n  fieldName = 'nodeMeta',\n  deps,\n  outputsPath,\n  batchModePath,\n}: NodeMetaProps) => {\n  const defaultNodeMeta = useDefaultNodeMeta();\n  const node = useCurrentEntity();\n  const wrappedNode = new WorkflowNode(node);\n\n  return (\n    <Field\n      name={fieldName}\n      deps={deps}\n      defaultValue={defaultNodeMeta as unknown as NodeHeaderValue}\n    >\n      {({ field, fieldState }: FieldRenderProps<NodeHeaderValue>) => (\n        <NodeHeader\n          {...field}\n          outputsPath={outputsPath}\n          batchModePath={batchModePath}\n          hideTest={!!wrappedNode?.registry?.meta?.hideTest}\n          errors={fieldState?.errors || []}\n        />\n      )}\n    </Field>\n  );\n};\n\nexport default NodeMeta;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tooltip } from '@coze-arch/coze-design';\n\ninterface Props {\n  tooltip: string;\n}\n\nexport const InfoIcon: FC<Props> = ({ tooltip }) => (\n  <Tooltip content={tooltip}>\n    <IconCozInfoCircle className=\"text-lg coz-fg-secondary shrink-0\" />\n  </Tooltip>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Select, Tooltip } from '@coze-arch/coze-design';\n\nimport { InfoIcon } from '../info-icon';\n\n/**\n * Variable aggregation strategy\n * @param param0\n * @returns\n */\nexport const MergeStrategyField = ({\n  readonly = false,\n}: {\n  readonly: boolean;\n}) => (\n  <p className=\"pb-4\">\n    <div className=\"flex items-center text-xs font-medium gap-1\">\n      <span>{I18n.t('workflow_var_merge_strategy')}</span>\n      <InfoIcon\n        tooltip={I18n.t('workflow_var_merge_ strategy_tooltips')}\n      ></InfoIcon>\n    </div>\n\n    <Tooltip content={I18n.t('workflow_var_merge_strategy_hovertips')}>\n      <div className=\"w-full mt-1\">\n        <Select\n          disabled={readonly}\n          optionList={[]}\n          size=\"small\"\n          className=\"w-full\"\n        >\n          <Select.Option>\n            {I18n.t('workflow_var_merge_ strategy_returnnotnull')}\n          </Select.Option>\n        </Select>\n      </div>\n    </Tooltip>\n  </p>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { Tooltip, type TooltipProps } from '@coze-arch/coze-design';\n\ninterface Props extends TooltipProps {\n  disabled?: boolean;\n}\n\nexport const TooltipWithDisabled: FC<Props> = ({ disabled, ...props }) => {\n  if (disabled) {\n    return <>{props.children}</>;\n  }\n\n  return <Tooltip {...props}></Tooltip>;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  ViewVariableType,\n  type RefExpression,\n  ValueExpression,\n} from '@coze-workflow/base';\n\nimport { useVariableService } from '@/hooks';\nimport { type CustomFilterVar } from '@/form-extensions/components/tree-variable-selector/types';\n\nimport { getVariableViewType } from '../../utils/get-variable-view-type';\nimport { getMatchedVariableTypes } from '../../utils/get-matched-variable-types';\n/**\n * variable filtering\n */\nexport const useVariablesFilter = (\n  variables: ValueExpression[],\n): {\n  customFilterVar: CustomFilterVar;\n  disabledTypes: ViewVariableType[];\n  viewType?: ViewVariableType;\n} => {\n  const variableService = useVariableService();\n  const node = useCurrentEntity();\n  const viewType = getVariableViewType(\n    variables[0] as RefExpression,\n    variableService,\n    node,\n  );\n\n  // Only variables of the same type as the first variable are allowed to be selected\n  const matchedTypes = getMatchedVariableTypes(viewType);\n  const disabledTypes =\n    matchedTypes.length > 0 ? ViewVariableType.getComplement(matchedTypes) : [];\n\n  const paths = variables\n    .filter(variable => ValueExpression.isRef(variable))\n    .map(variable => variable.content?.keyPath)\n    .filter(Boolean)\n    .map(path => (path as string[]).join('.'));\n\n  // Variables that have been selected are not allowed to be selected again\n  const customFilterVar: CustomFilterVar = ({ meta: _meta, path }) =>\n    !paths.includes((path || []).join('.'));\n\n  return {\n    customFilterVar,\n    disabledTypes,\n    viewType,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, type Ref } from 'react';\n\nimport classnames from 'classnames';\nimport {\n  type FieldArrayRenderProps,\n  type FieldRenderProps,\n  Field,\n} from '@flowgram-adapter/free-layout-editor';\nimport { IconHandle } from '@douyinfe/semi-icons';\nimport {\n  type ViewVariableType,\n  type ValueExpression,\n} from '@coze-workflow/variable';\nimport { IconCozMinus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { RefTagColor } from '@/form-extensions/components/value-expression-input/ref-value-display';\nimport { type CustomFilterVar } from '@/form-extensions/components/tree-variable-selector/types';\n\nimport { ValueExpressionInput } from '../../../components/value-expression-input';\nimport { FormItemFeedback } from '../../../components/form-item-feedback';\nimport { useIsOutputVariable } from './use-is-output-variable';\n\ninterface Props {\n  variablesField: FieldArrayRenderProps<ValueExpression>['field'];\n  index: number;\n  groupIndex: number;\n  variableField: FieldRenderProps<ValueExpression>['field'];\n  dragRef: Ref<HTMLElement>;\n  readonly?: boolean;\n  disabledTypes?: ViewVariableType[];\n  customFilterVar?: CustomFilterVar;\n  disableDrag?: boolean;\n}\n\n/**\n * Group Variable Item\n * @param param0\n * @returns\n */\nexport const GroupVariablesItem: FC<Props> = ({\n  variablesField,\n  readonly,\n  groupIndex,\n  index,\n  variableField,\n  dragRef,\n  disabledTypes,\n  customFilterVar,\n  disableDrag,\n}) => {\n  const isOutput = useIsOutputVariable(groupIndex, index);\n  return (\n    <Field name={variableField.name}>\n      {({ field, fieldState }: FieldRenderProps<ValueExpression>) => (\n        <>\n          <div key={index} className=\"flex w-full items-center\">\n            <span\n              className={classnames(\n                'flex items-center',\n                disableDrag ? 'cursor-not-allowed' : 'cursor-move',\n              )}\n            >\n              <IconHandle\n                ref={dragRef}\n                className={classnames(\n                  'px-1 mr-1 coz-fg-secondary',\n                  disableDrag ? 'pointer-events-none' : '',\n                )}\n              />\n            </span>\n\n            <ValueExpressionInput\n              {...field}\n              readonly={readonly}\n              disabledTypes={disabledTypes}\n              customFilterVar={customFilterVar}\n              onChange={v => {\n                if (!v) {\n                  variablesField.delete(index);\n                  return;\n                }\n                field.onChange(v as ValueExpression);\n              }}\n              style={{ flex: 1 }}\n              literalDisabled={false}\n              isError={!!(fieldState?.errors && fieldState.errors.length)}\n              refTagColor={isOutput ? RefTagColor.Green : RefTagColor.Primary}\n              hideDeleteIcon\n              forbidTypeCast\n            />\n\n            <IconButton\n              className=\"relative top-[-1px] ml-1\"\n              disabled={readonly}\n              color=\"secondary\"\n              size=\"small\"\n              icon={<IconCozMinus className=\"text-lg\" />}\n              onClick={() => variablesField.delete(index)}\n            ></IconButton>\n          </div>\n          {fieldState?.errors && fieldState.errors.length ? (\n            <div className=\"pl-7\">\n              <FormItemFeedback errors={fieldState?.errors} />\n            </div>\n          ) : null}\n        </>\n      )}\n    </Field>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { useExecStateEntity } from '@/hooks';\n\nimport { isOutputVariable } from '../../utils/is-output-variable';\n\n/**\n * Determine whether a variable is an output variable\n */\nexport function useIsOutputVariable(groupIndex: number, variableIndex: number) {\n  const execEntity = useExecStateEntity();\n  const node = useCurrentEntity();\n  const executeNodeResult = execEntity.getNodeExecResult(node.id);\n\n  return isOutputVariable(groupIndex, variableIndex, executeNodeResult);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC, useState, type Ref, useRef } from 'react';\n\nimport {\n  type FieldArrayRenderProps,\n  type FieldState,\n} from '@flowgram-adapter/free-layout-editor';\nimport { ValueExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { SortableList } from '@/components/sortable-list';\n\nimport { TooltipWithDisabled } from '../tooltip-with-disabled';\nimport { MAX_GROUP_VARIABLE_COUNT } from '../../constants';\nimport { ValueExpressionInput } from '../../../components/value-expression-input';\nimport { FormItemFeedback } from '../../../components/form-item-feedback';\nimport { useVariablesFilter } from './use-variables-filter';\nimport { GroupVariablesItem } from './group-variables-item';\n\ninterface Props {\n  variablesField: FieldArrayRenderProps<ValueExpression>['field'];\n  groupIndex: number;\n  readonly?: boolean;\n  errors?: FieldState['errors'];\n}\n\n/**\n * grouping variables\n * @param param0\n * @returns\n */\nexport const GroupVariables: FC<Props> = ({\n  groupIndex,\n  variablesField,\n  readonly,\n  errors,\n}) => {\n  const { disabledTypes, customFilterVar } = useVariablesFilter(\n    variablesField.value || [],\n  );\n  const variablesError = (errors || [])?.filter(\n    error => error.name === variablesField.name,\n  );\n  const variablesLength = (variablesField?.value || []).length;\n  const isEmpty = !variablesLength;\n  const [variableFieldCandidate, setVariableFieldCandidate] =\n    useState<ValueExpression>();\n  const variableFieldCandidateRef = useRef<ValueExpression>();\n\n  const updateVariableFieldCandidate = (val: ValueExpression | undefined) => {\n    setVariableFieldCandidate(val);\n    variableFieldCandidateRef.current = val;\n  };\n\n  const [refreshKey, refresh] = useState(1);\n  return (\n    <>\n      <SortableList\n        className=\"space-y-1 mt-1\"\n        value={variablesField.map(variableField => variableField)}\n        onChange={sortedFields => {\n          variablesField.onChange(\n            sortedFields.map(variableField => variableField.value),\n          );\n        }}\n        renderItem={(variableField, variablesIndex, dragOption) => (\n          <GroupVariablesItem\n            variablesField={variablesField}\n            groupIndex={groupIndex}\n            index={variablesIndex}\n            variableField={variableField}\n            dragRef={dragOption?.dragRef as Ref<HTMLElement>}\n            readonly={readonly}\n            disabledTypes={disabledTypes}\n            customFilterVar={customFilterVar}\n            disableDrag={variablesLength === 1}\n          ></GroupVariablesItem>\n        )}\n      ></SortableList>\n      {readonly ? null : (\n        <TooltipWithDisabled\n          disabled={variablesLength < MAX_GROUP_VARIABLE_COUNT}\n          content={I18n.t('workflow_var_merge_var_number_max')}\n        >\n          <div className=\"flex w-full mt-1\">\n            {!isEmpty ? <div className=\"w-6 mr-1 shrink-0\"></div> : null}\n\n            <ValueExpressionInput\n              key={refreshKey}\n              value={variableFieldCandidate}\n              style={{ flex: 1 }}\n              name={''}\n              onChange={v => {\n                const val = v as ValueExpression;\n\n                // If it is a literal or null value, it is cached to variableFieldCandidate\n                if (\n                  ValueExpression.isLiteral(val) ||\n                  ValueExpression.isEmpty(val)\n                ) {\n                  updateVariableFieldCandidate(val);\n                } else {\n                  // Non-empty ref variable, append to variablesField\n                  updateVariableFieldCandidate(undefined);\n                  variablesField.append(val);\n                }\n              }}\n              onBlur={() => {\n                // Literal variable, when out of focus, append to variablesField if variableFieldCandidate have a value\n                if (\n                  variableFieldCandidateRef.current &&\n                  ValueExpression.isLiteral(variableFieldCandidateRef.current)\n                ) {\n                  variablesField.append(variableFieldCandidateRef.current);\n                  updateVariableFieldCandidate(undefined);\n                  refresh(prev => prev + 1);\n                }\n              }}\n              placeholder={I18n.t('workflow_var_merge_var_placeholder')}\n              literalDisabled={false}\n              disabledTypes={disabledTypes}\n              customFilterVar={customFilterVar}\n              readonly={variablesLength >= MAX_GROUP_VARIABLE_COUNT}\n              isError={variablesError.length > 0}\n            />\n\n            {!isEmpty ? <div className=\"w-6 shrink-0 ml-1\"></div> : null}\n          </div>\n        </TooltipWithDisabled>\n      )}\n      <FormItemFeedback errors={variablesError} />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { Tag } from '@coze-arch/coze-design';\n\nimport { type MergeGroup } from '../../types';\nimport { useGroupTypeAlias } from './use-group-type-alias';\n\ninterface Props {\n  mergeGroup: MergeGroup;\n}\n\nexport const GroupTypeTag: FC<Props> = ({ mergeGroup }) => {\n  const alias = useGroupTypeAlias(mergeGroup);\n  return alias ? (\n    <Tag size=\"mini\" color=\"primary\" className=\"shrink-0 font-medium\">\n      {alias}\n    </Tag>\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowVariableService } from '@coze-workflow/variable';\n\nimport { useVariableService } from '@/hooks';\n\nimport { getGroupTypeAlias } from '../../utils/get-group-type-alias';\nimport { type MergeGroup } from '../../types';\n\n/**\n * Get group type alias\n */\nexport function useGroupTypeAlias(mergeGroup: MergeGroup) {\n  const variableService: WorkflowVariableService = useVariableService();\n  const node = useCurrentEntity();\n\n  return getGroupTypeAlias(mergeGroup, variableService, node);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowVariableService } from '@coze-workflow/variable';\n\nimport { type MergeGroup } from '../types';\nimport { getVariableTypeAlias } from './get-variable-type-alias';\n\n/**\n * Get group type alias\n */\nexport function getGroupTypeAlias(\n  mergeGroup: MergeGroup,\n  variableService: WorkflowVariableService,\n  node: WorkflowNodeEntity,\n) {\n  return getVariableTypeAlias(\n    mergeGroup?.variables?.[0],\n    variableService,\n    node,\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowVariableService } from '@coze-workflow/variable';\nimport {\n  type ValueExpression,\n  VARIABLE_TYPE_ALIAS_MAP,\n} from '@coze-workflow/base';\n\nimport { getVariableViewType } from './get-variable-view-type';\n\n/**\n * Get variable alias\n */\nexport function getVariableTypeAlias(\n  variable: ValueExpression | undefined,\n  variableService: WorkflowVariableService,\n  node: WorkflowNodeEntity,\n) {\n  const viewType = getVariableViewType(variable, variableService, node);\n\n  if (!viewType) {\n    return '';\n  }\n\n  return VARIABLE_TYPE_ALIAS_MAP[viewType] || '';\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozMinus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\nimport { type FieldArrayRenderProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { TooltipWithDisabled } from '../tooltip-with-disabled';\nimport { type MergeGroup } from '../../types';\n\ninterface Props {\n  mergeGroupsField: FieldArrayRenderProps<MergeGroup>['field'];\n  index: number;\n  readonly?: boolean;\n}\n\n/**\n * Delete group button\n * @param param0\n * @returns\n */\nexport const DeleteGroupButton: FC<Props> = ({\n  mergeGroupsField,\n  index,\n  readonly,\n}) => {\n  const canDelete = (mergeGroupsField.value || []).length > 1;\n\n  return (\n    <TooltipWithDisabled\n      content={I18n.t('workflow_var_merge_delete_limit')}\n      disabled={canDelete}\n    >\n      <IconButton\n        style={{ position: 'relative', top: '-1px' }}\n        size=\"small\"\n        disabled={readonly || !canDelete}\n        color=\"secondary\"\n        onClick={() => {\n          mergeGroupsField.delete(index);\n        }}\n        icon={<IconCozMinus className=\"text-lg\" />}\n      ></IconButton>\n    </TooltipWithDisabled>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState, useRef } from 'react';\n\nimport { Input, type InputProps } from '@coze-arch/coze-design';\n\nimport { MAX_GROUP_NAME_COUNT } from '../../constants';\n\ninterface Props {\n  value?: string;\n  onChange: InputProps['onChange'];\n  onBlur: InputProps['onBlur'];\n  readonly?: boolean;\n  disableEdit?: boolean;\n}\n\n/**\n * Group name, support double-click editing\n * @param props\n * @returns\n */\nexport const GroupName: FC<Props> = props => {\n  const { value, onChange, readonly, disableEdit, onBlur } = props;\n\n  const [isEdit, setIsEdit] = useState(false);\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const handleClick = () => {\n    if (readonly || disableEdit) {\n      return;\n    }\n\n    setIsEdit(true);\n    setTimeout(() => {\n      inputRef.current?.focus();\n    }, 0);\n  };\n\n  const handleBlur = e => {\n    onBlur?.(e);\n    setIsEdit(false);\n  };\n\n  if (isEdit) {\n    return (\n      <Input\n        value={value}\n        ref={inputRef}\n        onBlur={handleBlur}\n        onChange={onChange}\n        size=\"small\"\n        className=\"w-full\"\n        maxLength={MAX_GROUP_NAME_COUNT}\n      />\n    );\n  } else {\n    return (\n      <div\n        className=\"text-xs font-medium coz-fg-primary hover:coz-mg-secondary-hovered cursor-pointer p-0.5 rounded-[4px] truncate\"\n        onClick={handleClick}\n      >\n        {value}\n      </div>\n    );\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport {\n  type FieldRenderProps,\n  type FieldArrayRenderProps,\n  type FieldError,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { InfoIcon } from '../info-icon';\nimport { GroupTypeTag } from '../group-type-tag';\nimport { DeleteGroupButton } from '../delete-group-button';\nimport { type MergeGroup } from '../../types';\nimport { FormItemFeedback } from '../../../components/form-item-feedback';\nimport { useEditName } from './use-edit-name';\nimport { GroupName } from './group-name';\n\ninterface Props {\n  nameField: FieldRenderProps<string>['field'];\n  nameFieldErrors: FieldError[];\n  tooltip: string;\n  mergeGroupsField: FieldArrayRenderProps<MergeGroup>['field'];\n  mergeGroupField: FieldRenderProps<MergeGroup>['field'];\n  index: number;\n  mergeGroup: MergeGroup;\n  readonly?: boolean;\n}\n\n/**\n * Packet header\n * @param param0\n * @returns\n */\nexport const GroupHeader: FC<Props> = ({\n  nameField,\n  nameFieldErrors,\n  tooltip,\n  mergeGroupsField,\n  mergeGroupField,\n  mergeGroup,\n  index,\n  readonly,\n}) => {\n  const { editName, handleChange, handleBlur, editErrors } = useEditName({\n    nameField,\n    mergeGroupField,\n    mergeGroupsField,\n  });\n\n  return (\n    <>\n      <div className=\"w-full flex items-center h-6\">\n        <div className=\"flex-1 overflow-hidden pr-6\">\n          <div className=\"w-full flex items-center gap-1\">\n            <GroupName\n              value={editName}\n              readonly={readonly}\n              onChange={handleChange}\n              onBlur={handleBlur}\n            />\n            <GroupTypeTag mergeGroup={mergeGroup} />\n            {mergeGroup?.variables?.length ? (\n              <InfoIcon tooltip={tooltip} />\n            ) : null}\n          </div>\n        </div>\n        <DeleteGroupButton\n          mergeGroupsField={mergeGroupsField}\n          index={index}\n          readonly={readonly}\n        />\n      </div>\n      {editErrors.length || nameFieldErrors.length ? (\n        <FormItemFeedback\n          errors={editErrors.length ? editErrors : nameFieldErrors}\n        />\n      ) : null}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState } from 'react';\n\nimport {\n  type FieldRenderProps,\n  type FieldArrayRenderProps,\n  type FieldError,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { validateGroupName } from '../../validators/group-name-validator';\nimport { toFieldError } from '../../utils/to-field-error';\nimport { type MergeGroup } from '../../types';\n\ninterface Props {\n  nameField: FieldRenderProps<string>['field'];\n  mergeGroupsField: FieldArrayRenderProps<MergeGroup>['field'];\n  mergeGroupField: FieldRenderProps<MergeGroup>['field'];\n}\n\n/**\n * name edit\n * @param props\n * @returns\n */\nexport function useEditName(props: Props) {\n  const { nameField, mergeGroupsField, mergeGroupField } = props;\n  const [editName, setEditName] = useState<string | undefined>(\n    nameField?.value,\n  );\n  const [editErrors, setEditErrors] = useState<FieldError[]>([]);\n\n  const validateName = (name: string) => {\n    const names = mergeGroupsField.map(field =>\n      field.name === mergeGroupField.name ? name : field?.value?.name,\n    );\n    const res = validateGroupName(name, names);\n    return res;\n  };\n\n  const handleChange = value => {\n    const error = validateName(value);\n    setEditName(value);\n\n    setEditErrors(\n      error ? [toFieldError(`${mergeGroupField.name}.name`, error)] : [],\n    );\n  };\n\n  const handleBlur = e => {\n    const value = e.target?.value;\n    if (value && !validateName(value)) {\n      nameField?.onChange(value);\n    } else {\n      setEditName(nameField.value);\n    }\n\n    setEditErrors([]);\n  };\n\n  return {\n    handleBlur,\n    handleChange,\n    editName,\n    editErrors,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FieldError } from '@flowgram-adapter/free-layout-editor';\n\n/**\n * Convert to Filed Error\n * @param name\n * @param message\n * @returns\n */\nexport function toFieldError(name: string, message: string): FieldError {\n  return {\n    name,\n    level: 'error',\n    message,\n  } as unknown as FieldError;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport classnames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { type FieldArrayRenderProps } from '@flowgram-adapter/free-layout-editor';\n\nimport { TooltipWithDisabled } from '../tooltip-with-disabled';\nimport { generateGroupName } from '../../utils/generate-group-name';\nimport { type MergeGroup } from '../../types';\nimport { MAX_GROUP_COUNT } from '../../constants';\n\ninterface Props {\n  mergeGroupsField: FieldArrayRenderProps<MergeGroup>['field'];\n  readonly?: boolean;\n}\n\n/**\n * Add group button\n * @param param0\n * @returns\n */\nexport const AddGroupButton: FC<Props> = ({ mergeGroupsField, readonly }) => {\n  if (readonly) {\n    return null;\n  }\n\n  const disabled = (mergeGroupsField.value || []).length >= MAX_GROUP_COUNT;\n  return (\n    <TooltipWithDisabled\n      content={I18n.t('workflow_var_merge_number_max')}\n      disabled={!disabled}\n    >\n      <div\n        onClick={() => {\n          if (disabled) {\n            return;\n          }\n          mergeGroupsField.append({\n            name: generateGroupName(mergeGroupsField.value),\n            variables: [],\n          });\n        }}\n        className={classnames(\n          'flex justify-center items-center gap-1 w-full h-8 rounded-[8px] select-none bg-[var(--coz-mg-hglt)] hover:bg-[var(--coz-mg-hglt-hovered)]',\n          disabled\n            ? 'cursor-not-allowed  text-[var(--coz-fg-hglt-dim)]'\n            : 'cursor-pointer text-[var(--coz-fg-hglt)]',\n        )}\n      >\n        <div className=\"flex items-center justify-center\">\n          <IconCozPlus />\n        </div>\n        <p className=\"text-[14px] font-medium text-nowrap\">\n          {I18n.t('workflow_var_merge_addGroup')}\n        </p>\n      </div>\n    </TooltipWithDisabled>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type MergeGroup } from '../types';\nimport { GROUP_NAME_PREFIX } from '../constants';\n\n/**\n * Generate variable group name\n */\nexport function generateGroupName(mergeGroups: MergeGroup[] | undefined) {\n  const groups: MergeGroup[] = mergeGroups || [];\n\n  const names = groups.map(mergeGroup => mergeGroup.name);\n\n  let index = 1;\n  let newTitle;\n\n  while (true) {\n    newTitle = `${GROUP_NAME_PREFIX}${index}`;\n    if (!names.includes(newTitle)) {\n      break;\n    }\n    index += 1;\n  }\n  return newTitle;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport {\n  Field,\n  FieldArray,\n  type FieldRenderProps,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type ValueExpression } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { GroupVariables } from '../group-variables';\nimport { GroupHeader } from '../group-header';\nimport { AddGroupButton } from '../add-group-button';\nimport { type MergeGroup } from '../../types';\n\ninterface Props {\n  readonly?: boolean;\n}\n\n/**\n * variable aggregation grouping\n * @param param0\n * @returns\n */\nexport const MergeGroupsField: FC<Props> = ({ readonly }) => (\n  <FieldArray name=\"inputs.mergeGroups\">\n    {({ field: mergeGroupsField }: FieldArrayRenderProps<MergeGroup>) => (\n      <div>\n        {mergeGroupsField.map((mergeGroupField, groupIndex) => (\n          <div\n            key={mergeGroupField.name}\n            className=\"border border-solid border-[var(--coz-stroke-plus)] rounded-[8px] p-2 mb-3 coz-bg-max\"\n          >\n            <Field name={`${mergeGroupField.name}.name`}>\n              {({ field, fieldState }: FieldRenderProps<string>) => (\n                <GroupHeader\n                  tooltip={I18n.t('workflow_var_merge_group_tooltips')}\n                  mergeGroup={mergeGroupField.value}\n                  mergeGroupsField={mergeGroupsField}\n                  mergeGroupField={mergeGroupField}\n                  index={groupIndex}\n                  readonly={readonly}\n                  nameField={field}\n                  nameFieldErrors={fieldState?.errors || []}\n                />\n              )}\n            </Field>\n\n            <FieldArray\n              name={`${mergeGroupField.name}.variables`}\n              defaultValue={[]}\n            >\n              {({\n                field: variablesField,\n                fieldState: variablesFieldState,\n              }: FieldArrayRenderProps<ValueExpression>) => (\n                <>\n                  <GroupVariables\n                    variablesField={variablesField}\n                    readonly={readonly}\n                    errors={variablesFieldState?.errors}\n                    groupIndex={groupIndex}\n                  />\n                </>\n              )}\n            </FieldArray>\n          </div>\n        ))}\n        <AddGroupButton\n          mergeGroupsField={mergeGroupsField}\n          readonly={readonly}\n        />\n      </div>\n    )}\n  </FieldArray>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Field,\n  type FormRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { Outputs } from '@/nodes-v2/components/outputs';\nimport NodeMeta from '@/nodes-v2/components/node-meta';\n\nimport { MergeStrategyField } from '../merge-strategy-field';\nimport { MergeGroupsField } from '../merge-groups-field';\nimport { type VariableMergeFormData } from '../../types';\n\n/**\n * variable aggregation form\n * @param param0\n * @returns\n */\nexport const VariableMergeForm = ({\n  form,\n}: FormRenderProps<VariableMergeFormData>) => {\n  const readonly = useReadonly();\n\n  return (\n    <PublicScopeProvider>\n      <>\n        <NodeMeta />\n\n        <div>\n          <MergeStrategyField readonly={readonly} />\n          <MergeGroupsField readonly={readonly} />\n        </div>\n\n        <Field name={'outputs'} deps={['inputs.mergeGroups']} defaultValue={[]}>\n          {({ field, fieldState }) => (\n            <Outputs\n              id={'llm-node-output'}\n              readonly={true}\n              value={field.value}\n              titleTooltip={I18n.t('workflow_var_merge_output_tooltips')}\n              errors={fieldState?.errors}\n            />\n          )}\n        </Field>\n      </>\n    </PublicScopeProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { set } from 'lodash-es';\nimport {\n  type FormMetaV2,\n  ValidateTrigger,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  variableUtils,\n  provideMergeGroupVariablesEffect,\n} from '@coze-workflow/variable';\n\nimport { nodeMetaValidate } from '../materials/node-meta-validate';\nimport { variablesValidator } from './validators/variables-validator';\nimport { variableValidator } from './validators/variable-validator';\nimport { mergeGroupsValidator } from './validators/merge-groups-validator';\nimport { groupNameValidator } from './validators/group-name-validator';\nimport { variablesChangeEffects } from './effects/variables-change-effects';\nimport { VariableMergeForm } from './components/variable-merge-form';\n\nexport const VARIABLE_MERGE_FORM_META: FormMetaV2<FormData> = {\n  effect: {\n    'inputs.mergeGroups': provideMergeGroupVariablesEffect,\n    'inputs.mergeGroups.*.variables': variablesChangeEffects,\n  },\n  render: props => <VariableMergeForm {...props} />,\n  // validation\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputs.mergeGroups.*.name': groupNameValidator,\n    'inputs.mergeGroups.*.variables.*': variableValidator,\n    'inputs.mergeGroups.*.variables': variablesValidator,\n    'inputs.mergeGroups': mergeGroupsValidator,\n  },\n  formatOnInit(value, context) {\n    const { playgroundContext } = context;\n    const { variableService } = playgroundContext;\n\n    // initial value setting\n    // Failure to set the initial value here will not trigger the form's onValueInit time\n    const initValue = value || {\n      inputs: {\n        mergeGroups: [\n          {\n            name: 'Group1',\n            variables: [],\n          },\n        ],\n      },\n      outputs: [],\n    };\n\n    if (initValue?.inputs?.mergeGroups) {\n      initValue.inputs.mergeGroups.forEach(_mergeGroup => {\n        if (_mergeGroup?.variables) {\n          set(\n            _mergeGroup,\n            'variables',\n            _mergeGroup.variables.map(_expr =>\n              variableUtils.valueExpressionToVO(_expr, variableService),\n            ),\n          );\n        }\n      });\n    }\n\n    return initValue;\n  },\n  formatOnSubmit(value, context) {\n    const { node, playgroundContext } = context;\n    const { variableService } = playgroundContext;\n\n    if (value?.inputs?.mergeGroups) {\n      value.inputs.mergeGroups.forEach(_mergeGroup => {\n        if (_mergeGroup?.variables) {\n          set(\n            _mergeGroup,\n            'variables',\n            _mergeGroup.variables.map(_expr =>\n              variableUtils.valueExpressionToDTO(_expr, variableService, {\n                node,\n              }),\n            ),\n          );\n        }\n      });\n    }\n    return value;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, isUndefined } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { isVariableTypeMatched } from '../utils/is-variable-type-matched';\nimport { getVariableViewType } from '../utils/get-variable-view-type';\nimport { createValueExpressionInputValidate } from '../../materials/create-value-expression-input-validate';\n\nexport const variableValidator: Validate = options => {\n  // Todo currently deletes the element of the form engine and will pass an undefined one. The verification is skipped first, and the subsequent node engine fixes the removal.\n  if (isUndefined(options?.value)) {\n    return;\n  }\n  // check expression\n  const validator = createValueExpressionInputValidate({\n    required: true,\n  });\n\n  const error = validator(options);\n  if (error) {\n    return error;\n  }\n\n  const paths = get(options, 'name', '').split('.');\n  const index = paths.pop();\n\n  // The first item does not require verification\n  if (index === '0') {\n    return;\n  }\n\n  // Verify that the variable type is consistent with the first item\n  const { node } = options.context;\n  const { variableService } = options.context.playgroundContext;\n  const variables = get(options.formValues, paths);\n\n  const firstVariableType = getVariableViewType(\n    variables[0],\n    variableService,\n    node,\n  );\n\n  const variableType = getVariableViewType(\n    options.value,\n    variableService,\n    node,\n  );\n\n  if (\n    !firstVariableType ||\n    !variableType ||\n    !isVariableTypeMatched(firstVariableType, variableType)\n  ) {\n    return I18n.t('workflow_var_merge_var_err_sametype');\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ViewVariableType } from '@coze-workflow/base';\n\nimport { getMatchedVariableTypes } from './get-matched-variable-types';\n\n/**\n * Does the variable type match?\n * @param viewType1\n * @param viewType2\n * @returns\n */\nexport function isVariableTypeMatched(\n  viewType1: ViewVariableType,\n  viewType2: ViewVariableType,\n) {\n  return getMatchedVariableTypes(viewType1).includes(viewType2);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { MAX_GROUP_VARIABLE_COUNT } from '../constants';\n\nexport const variablesValidator: Validate = ({ value }) => {\n  const { length } = value || [];\n  if (length === 0) {\n    return I18n.t('workflow_var_merge_var_err_noempty');\n  }\n\n  if (length > MAX_GROUP_VARIABLE_COUNT) {\n    return `variables should not be more than ${MAX_GROUP_VARIABLE_COUNT}`;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { MAX_GROUP_COUNT } from '../constants';\n\nexport const mergeGroupsValidator: Validate = ({ value }) => {\n  const { length } = value || [];\n  if (length === 0) {\n    return 'merge groups should not be empty';\n  }\n\n  if (length > MAX_GROUP_COUNT) {\n    return `merge groups should not be more than ${MAX_GROUP_COUNT}`;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { VARIABLE_MERGE_FORM_META } from './variable-merge-form-meta';\n\nexport const VARIABLE_MERGE_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.VariableMerge,\n  meta: {\n    nodeDTOType: StandardNodeType.VariableMerge,\n    style: {\n      width: 360,\n    },\n    size: { width: 360, height: 130.7 },\n    hideTest: true,\n    helpLink: '/open/docs/guides/variable_merge_node',\n  },\n  formMeta: VARIABLE_MERGE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type CSSProperties } from 'react';\n\nimport { Tag } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\ninterface Props {\n  label?: string;\n  type?: string;\n  required?: boolean;\n  style?: CSSProperties;\n}\n\nexport const OutputSingleText = ({ label, type, required, style }: Props) => (\n  <p className={styles.content} style={style}>\n    <span>{label}</span>\n    {required ? <span style={{ color: '#f93920' }}>*</span> : null}\n    {type ? <Tag className={styles.tag}>{type}</Tag> : null}\n  </p>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  type CSSProperties,\n  useEffect,\n  useMemo,\n  useCallback,\n  useRef,\n} from 'react';\n\nimport { get } from 'lodash-es';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type RefExpression,\n  WorkflowVariableService,\n  useGlobalVariableServiceState,\n  isGlobalVariableKey,\n} from '@coze-workflow/variable';\nimport {\n  type ViewVariableType,\n  ValueExpressionType,\n  VARIABLE_TYPE_ALIAS_MAP,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Select as SemiSelect } from '@coze-arch/bot-semi';\nimport {\n  IconCozCross,\n  IconCozEmpty,\n  IconCozWarningCircle,\n} from '@coze-arch/coze-design/icons';\nimport { Select, Tag, Typography } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { useGlobalState } from '@/hooks';\nimport { type VariableMetaWithNode } from '@/form-extensions/typings';\nimport { useNodeAvailableVariablesWithNode } from '@/form-extensions/hooks';\nimport { BotProjectVariableSelect } from '@/components/test-run/bot-project-variable-select';\nimport { VARIABLE_TYPE_ICON_MAP } from '@/components/node-render/node-render-new/fields/constants';\n\nimport s from './index.module.less';\n\nconst { Text } = Typography;\n\ninterface Props {\n  value?: RefExpression;\n  onChange?: (value?: RefExpression) => void;\n  disabled?: boolean;\n  readonly?: boolean;\n  style?: CSSProperties;\n  onBlur?: () => void;\n  name?: string;\n  placeholder?: string;\n  disabledTypes?: ViewVariableType[];\n  isError?: boolean;\n  variablesFilter?: (\n    variables: VariableMetaWithNode[],\n  ) => VariableMetaWithNode[];\n  useMatchType?: boolean;\n  matchType?: ViewVariableType;\n}\n\ntype ValueType = string[];\n\nconst encodeValue = (data?: ValueType) =>\n  data ? JSON.stringify(data) : undefined;\n\nconst decodeValue = (data: string) =>\n  data ? (JSON.parse(data) as ValueType) : undefined;\n\nconst getIconByType = (type?: ViewVariableType) =>\n  type ? (\n    VARIABLE_TYPE_ICON_MAP[type] || <IconCozWarningCircle />\n  ) : (\n    <IconCozWarningCircle />\n  );\n\nexport const GlobalVariableSelect = (props: Props) => {\n  const {\n    value,\n    onChange,\n    onBlur,\n    readonly: setterReadonly,\n    placeholder = I18n.t('variable_assignment_node_select_placeholder'),\n    disabledTypes,\n    isError,\n    variablesFilter = data => data,\n    matchType,\n    useMatchType,\n  } = props;\n\n  const selectRef = useRef<SemiSelect | null>(null);\n\n  const globalReadonly = useReadonly();\n  const readonly = globalReadonly || setterReadonly;\n\n  const { projectId } = useGlobalState();\n  const { type } = useGlobalVariableServiceState();\n\n  const isProject = Boolean(projectId);\n  const isSelectedBotOrProject = !isProject && Boolean(type);\n\n  const useNewGlobalVariableCache = !isProject;\n\n  const availableVariables = useNodeAvailableVariablesWithNode();\n\n  const variableService: WorkflowVariableService = useService(\n    WorkflowVariableService,\n  );\n\n  const keyPath = get(value, 'content.keyPath') as string[] | undefined;\n\n  // Monitor changes in linkage variables to re-trigger the effect\n  useEffect(() => {\n    const hasDisabledTypes =\n      Array.isArray(disabledTypes) && disabledTypes.length > 0;\n\n    if (!keyPath || !hasDisabledTypes) {\n      return;\n    }\n\n    const listener = variableService.onListenVariableTypeChange(\n      keyPath,\n      v => {\n        // If the variable type changes and is located in disabledTypes, it needs to be cleared\n        if (v && (disabledTypes || []).includes(v.type)) {\n          onChange?.({\n            type: ValueExpressionType.REF,\n          });\n        }\n      },\n      {},\n    );\n\n    return () => {\n      listener?.dispose();\n    };\n  }, [keyPath, variableService, onChange, disabledTypes]);\n\n  const optionList = useMemo(\n    () =>\n      variablesFilter(\n        availableVariables.filter(\n          item => item.nodeId && isGlobalVariableKey(item.nodeId),\n        ),\n      ).map(item => ({\n        value: encodeValue([item.nodeId as string, item.key]),\n        disabled: useMatchType && matchType && matchType !== item.type,\n        ...item,\n      })),\n    [availableVariables, variablesFilter, matchType, useMatchType],\n  );\n\n  const handleChange = useCallback(\n    (v): void => {\n      const data = v ? decodeValue(v) : undefined;\n\n      if (data === undefined) {\n        onChange?.(undefined);\n      } else {\n        onChange?.({\n          type: ValueExpressionType.REF,\n          content: { keyPath: data },\n        });\n      }\n    },\n    [onChange],\n  );\n\n  const emptyContent = useMemo(() => {\n    const getEmptyMsg = () => {\n      if (isProject) {\n        return I18n.t('variable_select_empty_appide_tips');\n      }\n\n      if (isSelectedBotOrProject) {\n        return I18n.t('variable_select_empty_library_tips_02');\n      }\n\n      return I18n.t('variable_select_empty_library_tips');\n    };\n\n    return (\n      <div className={s['empty-block']}>\n        <IconCozEmpty\n          style={{ fontSize: '32px', color: 'rgba(52, 60, 87, 0.72)' }}\n        />\n        <span className={s.text}>{getEmptyMsg()}</span>\n      </div>\n    );\n  }, [isProject, isSelectedBotOrProject]);\n\n  const handleVariableSelect = useCallback(\n    (v?: string) => {\n      handleChange(v);\n      selectRef.current?.close();\n    },\n    [handleChange],\n  );\n\n  return (\n    <Select\n      ref={selectRef}\n      hasError={isError}\n      dropdownStyle={{\n        width: useNewGlobalVariableCache ? '326px' : '228px',\n      }}\n      showClear\n      size={'small'}\n      disabled={readonly}\n      clearIcon={<IconCozCross style={{ fontSize: '12px' }} />}\n      emptyContent={useNewGlobalVariableCache ? null : emptyContent}\n      value={encodeValue(value?.content?.keyPath)}\n      onChange={handleChange}\n      onBlur={onBlur}\n      style={{\n        width: '100%',\n      }}\n      placeholder={placeholder}\n      renderSelectedItem={item => {\n        const selectedItem = optionList.find(op => op.value === item.value);\n\n        return (\n          <div className={'flex items-center'}>\n            <span\n              className={'flex items-center mr-4px'}\n              style={{\n                fontSize: '14px',\n                color: selectedItem?.name\n                  ? 'rgba(var(--coze-fg-1),var(--coze-fg-1-alpha))'\n                  : 'rgba(var(--coze-yellow-5), 1)',\n              }}\n            >\n              {getIconByType(selectedItem?.type)}\n            </span>\n            <span\n              style={{\n                color: selectedItem?.name\n                  ? 'rgba(var(--coze-fg-3),var(--coze-fg-3-alpha))'\n                  : 'rgba(var(--coze-yellow-5), 1)',\n              }}\n            >\n              {selectedItem?.name || I18n.t('workflow_variable_undefined')}\n            </span>\n          </div>\n        );\n      }}\n      outerBottomSlot={\n        useNewGlobalVariableCache ? (\n          <BotProjectVariableSelect\n            onVariableSelect={handleVariableSelect}\n            variableValue={encodeValue(value?.content?.keyPath)}\n            variablesFormatter={arr =>\n              variablesFilter(\n                arr.map(item => ({\n                  value: encodeValue([item.nodeId as string, item.key]),\n                  disabled:\n                    useMatchType && matchType && matchType !== item.type,\n                  ...item,\n                })),\n              )\n            }\n          />\n        ) : undefined\n      }\n    >\n      {useNewGlobalVariableCache\n        ? null\n        : optionList.map(option => (\n            <Select.Option\n              // Disabled Change Option will not be re-rendered. Please set the key to be compatible first.\n              key={`${option.value}-${option.disabled}`}\n              value={option.value}\n              className={s['global-var-option']}\n              disabled={option.disabled}\n            >\n              <div\n                className={\n                  'flex w-full items-center justify-between pl-8px pr-8px'\n                }\n              >\n                <Text\n                  disabled={option.disabled}\n                  ellipsis={{ showTooltip: true }}\n                  style={{ flex: 1 }}\n                >\n                  {option.name}\n                </Text>\n                <Tag\n                  disabled={option.disabled}\n                  className={s.tag}\n                  size={'small'}\n                >\n                  {VARIABLE_TYPE_ALIAS_MAP[option.type]}\n                </Tag>\n              </div>\n            </Select.Option>\n          ))}\n    </Select>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { get, isNil } from 'lodash-es';\nimport {\n  Field,\n  type FieldArrayRenderProps,\n  FieldArray,\n  type FieldRenderProps,\n  type FormMetaV2,\n  type FormRenderProps,\n  ValidateTrigger,\n} from '@flowgram-adapter/free-layout-editor';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  PublicScopeProvider,\n  type RefExpression,\n  type ValueExpression,\n  type ValueExpressionDTO,\n  ValueExpressionType,\n  variableUtils,\n  ViewVariableType,\n} from '@coze-workflow/variable';\nimport { concatTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus, IconCozMinus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { OutputSingleText } from '@/nodes-v2/components/output-single-text';\nimport { GlobalVariableSelect } from '@/nodes-v2/components/global-variable-select';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { useVariableService } from '@/hooks';\nimport { type VariableMetaWithNode } from '@/form-extensions/typings';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\n\nimport { nodeMetaValidate } from '../materials/node-meta-validate';\nimport { ValueExpressionInput } from '../components/value-expression-input';\nimport NodeMeta from '../components/node-meta';\n\nimport styles from './index.module.less';\n\nfunction getInputParametersHeaderColumns() {\n  return [\n    {\n      title: I18n.t('workflow_detail_variable_input_name'),\n      style: {\n        flex: 2,\n      },\n    },\n    {\n      title: I18n.t('workflow_detail_variable_input_value'),\n      style: {\n        flex: 3,\n      },\n    },\n  ];\n}\n\ninterface InputValueVO {\n  left: ValueExpression;\n  right: ValueExpression;\n}\n\ninterface FormData {\n  $$input_decorator$$: {\n    inputParameters?: InputValueVO[];\n  };\n}\n\nconst getDefaultInputValue = () => ({\n  left: { type: ValueExpressionType.REF },\n  right: { type: ValueExpressionType.REF },\n});\n\nconst Render = ({ form }: FormRenderProps<FormData>) => {\n  const readonly = useReadonly();\n\n  const variableService = useVariableService();\n  const node = useCurrentEntity();\n  const getFieldType = (valuePath: string) => {\n    const value = form.getValueIn(valuePath);\n    return variableUtils.getValueExpressionViewType(value, variableService, {\n      node,\n    });\n  };\n\n  const genGlobalVariablesFilter = (valuePath: string) => {\n    const currentValue: RefExpression = form.getValueIn(valuePath) || {};\n    const selectedValue: InputValueVO[] =\n      form.getValueIn('$$input_decorator$$.inputParameters') || [];\n\n    return (variables: VariableMetaWithNode[]) => {\n      const currentValueKeyPathStr = currentValue?.content?.keyPath?.join('.');\n      const selectedValueKeyPathStrArr = selectedValue\n        .map(item => (item.left as RefExpression)?.content?.keyPath?.join('.'))\n        .filter(keyPathStr => currentValueKeyPathStr !== keyPathStr);\n\n      return variables\n        .filter(item => !item.readonly)\n        .filter(\n          item =>\n            !selectedValueKeyPathStrArr.includes(\n              [item.nodeId, item.key].join('.'),\n            ),\n        );\n    };\n  };\n\n  return (\n    <PublicScopeProvider>\n      <>\n        <NodeMeta deps={['outputs']} outputsPath={'outputs'} />\n\n        <FieldArray\n          name={'$$input_decorator$$.inputParameters'}\n          defaultValue={[getDefaultInputValue()]}\n        >\n          {({ field: fieldArray }: FieldArrayRenderProps<InputValueVO>) => (\n            <FormCard\n              header={I18n.t('workflow_detail_node_input')}\n              tooltip={I18n.t('workflow_detail_variable_subtitle')}\n            >\n              <div className={styles['columns-title']}>\n                <ColumnsTitleWithAction\n                  columns={getInputParametersHeaderColumns()}\n                />\n              </div>\n              {fieldArray.map((child, index) => (\n                <div\n                  key={child.key}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'flex-start',\n                    paddingBottom: 4,\n                    gap: 4,\n                  }}\n                >\n                  <Field name={`${child.name}.left`}>\n                    {({\n                      field: childNameField,\n                      fieldState: nameFieldState,\n                    }: FieldRenderProps<RefExpression | undefined>) => (\n                      <div\n                        style={{\n                          flex: 2,\n                          minWidth: 0,\n                          flexShrink: 0,\n                          display: 'flex',\n                          flexDirection: 'column',\n                        }}\n                      >\n                        <GlobalVariableSelect\n                          {...childNameField}\n                          variablesFilter={genGlobalVariablesFilter(\n                            `${child.name}.left`,\n                          )}\n                          isError={!!nameFieldState?.errors?.length}\n                          disabled={readonly}\n                          useMatchType={\n                            !childNameField.value?.content?.keyPath?.[0]\n                          }\n                          matchType={getFieldType(`${child.name}.right`)}\n                        />\n\n                        <FormItemFeedback errors={nameFieldState?.errors} />\n                      </div>\n                    )}\n                  </Field>\n                  <Field name={`${child.name}.right`}>\n                    {({\n                      field: childInputField,\n                      fieldState: inputFieldState,\n                    }: FieldRenderProps<ValueExpression | undefined>) => {\n                      const matchLeftType = getFieldType(`${child.name}.left`);\n\n                      return (\n                        <div style={{ flex: 3, overflow: 'hidden' }}>\n                          <ValueExpressionInput\n                            {...childInputField}\n                            inputType={matchLeftType}\n                            matchType={matchLeftType}\n                            isError={!!inputFieldState?.errors?.length}\n                            readonly={readonly}\n                          />\n                          <FormItemFeedback errors={inputFieldState?.errors} />\n                        </div>\n                      );\n                    }}\n                  </Field>\n                  {readonly ? (\n                    <></>\n                  ) : (\n                    <div>\n                      <IconButton\n                        size=\"small\"\n                        color=\"secondary\"\n                        data-testid={concatTestId(child.name, 'remove')}\n                        icon={<IconCozMinus />}\n                        onClick={() => {\n                          fieldArray.delete(index);\n                        }}\n                      />\n                    </div>\n                  )}\n                </div>\n              ))}\n              {readonly ? (\n                <></>\n              ) : (\n                <div className={styles['input-add-icon']}>\n                  <IconButton\n                    className=\"!block\"\n                    color=\"highlight\"\n                    size=\"small\"\n                    icon={<IconCozPlus />}\n                    onClick={() => {\n                      fieldArray.append(getDefaultInputValue());\n                    }}\n                  />\n                </div>\n              )}\n            </FormCard>\n          )}\n        </FieldArray>\n\n        <Field name={'outputs'}>\n          <FormCard\n            header={I18n.t('workflow_detail_node_output')}\n            tooltip={I18n.t('workflow_detail_variable_set_output_tooltip')}\n          >\n            <OutputSingleText label={'isSuccess'} type={'boolean'} />\n          </FormCard>\n        </Field>\n      </>\n    </PublicScopeProvider>\n  );\n};\n\nexport const VARIABLE_ASSIGN_FORM_META: FormMetaV2<FormData> = {\n  render: props => <Render {...props} />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    '$$input_decorator$$.inputParameters.*.left':\n      createValueExpressionInputValidate({\n        required: true,\n        emptyErrorMessage: I18n.t('variable_assignment_node_select_empty'),\n      }),\n    '$$input_decorator$$.inputParameters.*.right':\n      createValueExpressionInputValidate({ required: true }),\n  },\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n  formatOnInit(value, context) {\n    const inputParameters = get(value, 'inputs.inputParameters');\n\n    const inputParameterDTOs: {\n      left: ValueExpressionDTO;\n      input: ValueExpressionDTO;\n    }[] = inputParameters ?? [];\n\n    const inputParameterVOs: {\n      left: ValueExpression;\n      right: ValueExpression;\n    }[] = inputParameterDTOs\n      .map(inputParameterDTO => {\n        const leftVariableDTO = inputParameterDTO?.left;\n        const rightVariableDTO = inputParameterDTO?.input;\n\n        if (!leftVariableDTO || !rightVariableDTO) {\n          return;\n        }\n\n        const leftVariableVO = variableUtils.valueExpressionToVO(\n          leftVariableDTO,\n          context.playgroundContext.variableService,\n        );\n\n        const rightVariableVO = variableUtils.valueExpressionToVO(\n          rightVariableDTO,\n          context.playgroundContext.variableService,\n        );\n\n        return {\n          left: leftVariableVO,\n          right: rightVariableVO,\n        };\n      })\n      .filter(Boolean) as {\n      left: ValueExpression;\n      right: ValueExpression;\n    }[];\n\n    const initValue = {\n      nodeMeta: value?.nodeMeta,\n      $$input_decorator$$: {\n        inputParameters: inputParameterVOs?.length\n          ? inputParameterVOs\n          : [getDefaultInputValue()],\n      },\n      outputs: [{ name: 'isSuccess', type: ViewVariableType.Boolean }],\n    };\n\n    return initValue;\n  },\n  formatOnSubmit(value, context) {\n    const inputParameters = get(value, '$$input_decorator$$.inputParameters');\n\n    const formattedValue: Record<string, unknown> = {\n      nodeMeta: value?.nodeMeta || {},\n      inputs: {\n        inputParameters: inputParameters?.map(input => {\n          const leftVariableVO = input?.left as RefExpression;\n          const rightVariableVO = input?.right as RefExpression;\n\n          const leftVariableDTO = variableUtils.valueExpressionToDTO(\n            leftVariableVO,\n            context.playgroundContext.variableService,\n            { node: context.node },\n          );\n\n          const rightVariableDTO = variableUtils.valueExpressionToDTO(\n            rightVariableVO,\n            context.playgroundContext.variableService,\n            { node: context.node },\n          );\n\n          return {\n            name: leftVariableVO?.content?.keyPath?.slice(1).join('.'),\n            left: leftVariableVO?.content ? leftVariableDTO : undefined,\n            input: !isNil(rightVariableVO?.content)\n              ? rightVariableDTO\n              : undefined,\n          };\n        }),\n        variableTypeMap: inputParameters.reduce((acc, cur) => {\n          const type = cur?.left?.content?.keyPath?.[0];\n          const key = cur?.left?.content?.keyPath?.slice(1).join('.');\n\n          if (!acc[key]) {\n            acc[key] = type;\n          }\n\n          return acc;\n        }, {}),\n      },\n\n      outputs: [{ name: 'isSuccess', type: 'boolean' }],\n    };\n\n    return formattedValue;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DEFAULT_NODE_META_PATH } from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { VARIABLE_ASSIGN_FORM_META } from './form-meta';\n\nexport const VARIABLE_ASSIGN_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.VariableAssign,\n    meta: {\n      nodeDTOType: StandardNodeType.VariableAssign,\n      style: {\n        width: 360,\n      },\n      size: { width: 360, height: 130.7 },\n      nodeMetaPath: DEFAULT_NODE_META_PATH,\n      inputParametersPath: '/$$input_decorator$$/inputParameters',\n      test,\n      helpLink: '/open/docs/guides/variable_assign_node',\n    },\n    variablesMeta: {\n      outputsPathList: [],\n      inputsPathList: [],\n    },\n    formMeta: VARIABLE_ASSIGN_FORM_META,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasVariableAssignNode: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.$$input_decorator$$?.inputParameters?.map(\n      e => ({\n        input: e?.right,\n        name: e?.left?.content?.keyPath?.[1],\n      }),\n    );\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type FC } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Switch, Tooltip } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { type ComponentProps } from '@/nodes-v2/components/types';\nimport {\n  OutputTree,\n  type OutputTreeProps,\n} from '@/form-extensions/components/output-tree';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { ChatHistoryRound } from '@/components/chat-history-round';\n\nimport styles from './index.module.less';\n\nconst VALUE = [\n  {\n    key: nanoid(),\n    name: 'chatHistory',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'role',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n] as OutputTreeProps['value'];\n\nexport interface ChatHistoryValue {\n  enableChatHistory: boolean;\n  chatHistoryRound: number;\n}\n\nexport const ChatHistory: FC<\n  ComponentProps<ChatHistoryValue> & {\n    style: React.CSSProperties;\n    showLine?: boolean;\n  }\n> = ({ value, onChange, name, style, showLine = true }) => {\n  const { getNodeSetterId } = useNodeTestId();\n  const readonly = useReadonly();\n\n  return (\n    <>\n      <FormCard.Action>\n        <Tooltip content={I18n.t('wf_chatflow_125')} position=\"right\">\n          <div className=\"flex items-center gap-1\" style={style}>\n            <div className={styles['chat-history-text']}>\n              {I18n.t('wf_chatflow_124')}\n            </div>\n            <Switch\n              size=\"mini\"\n              checked={value.enableChatHistory}\n              data-testid={getNodeSetterId(name)}\n              onChange={checked => {\n                if (value.enableChatHistory === checked) {\n                  return;\n                }\n\n                onChange?.({\n                  ...value,\n                  enableChatHistory: checked,\n                });\n              }}\n              disabled={readonly}\n            />\n          </div>\n        </Tooltip>\n      </FormCard.Action>\n      {value.enableChatHistory ? (\n        <div className=\"relative\">\n          <OutputTree\n            id=\"chat-history\"\n            readonly\n            value={VALUE}\n            defaultCollapse\n            // eslint-disable-next-line @typescript-eslint/no-empty-function\n            onChange={() => {}}\n            withDescription={false}\n            withRequired={false}\n            noCard\n          />\n          {showLine ? <div className={styles.line} /> : null}\n\n          <ChatHistoryRound\n            value={value.chatHistoryRound}\n            readonly={readonly}\n            onChange={w => {\n              onChange({\n                ...value,\n                chatHistoryRound: Number(w),\n              });\n            }}\n          />\n        </div>\n      ) : null}\n    </>\n  );\n};\n\nexport const chatHistory = {\n  key: 'ChatHistory',\n  component: ChatHistory,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Field,\n  type FieldRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type SettingOnErrorValue } from '@coze-workflow/nodes';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { SettingOnError as SettingOnErrorComp } from '@/form-extensions/components/setting-on-error';\n\ninterface Props {\n  fieldName?: string;\n  batchModePath?: string;\n  outputsPath?: string;\n}\n\nexport const SettingOnError = ({\n  fieldName = 'settingOnError',\n  batchModePath,\n  outputsPath,\n}: Props) => {\n  const readonly = useReadonly();\n\n  return (\n    <Field name={fieldName}>\n      {({ field }: FieldRenderProps<SettingOnErrorValue>) => (\n        <SettingOnErrorComp\n          {...field}\n          batchModePath={batchModePath}\n          outputsPath={outputsPath}\n          readonly={readonly}\n        />\n      )}\n    </Field>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\ninterface AddIconProps {\n  disabledTooltip?: string;\n  onClick?: (e) => void;\n}\n\nexport const AddIcon: FC<AddIconProps> = ({ disabledTooltip, onClick }) =>\n  disabledTooltip ? (\n    <Tooltip content={disabledTooltip}>\n      <IconButton\n        disabled={!!disabledTooltip}\n        color=\"highlight\"\n        size=\"small\"\n        icon={<IconCozPlus className=\"text-sm\" />}\n        onClick={onClick}\n      />\n    </Tooltip>\n  ) : (\n    <IconButton\n      color=\"highlight\"\n      size=\"small\"\n      icon={<IconCozPlus className=\"text-sm\" />}\n      onClick={onClick}\n    />\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useForm } from '@flowgram-adapter/free-layout-editor';\n\n/**\n * Get model type\n */\nexport function useModelType() {\n  const form = useForm();\n\n  const modelType = form.getValueIn('model')?.modelType;\n  return modelType;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type InputValueVO } from '@coze-workflow/base';\n\n/**\n * Is it visually comprehensible input?\n */\nexport const isVisionInput = (value: InputValueVO): boolean =>\n  !!value?.input?.rawMeta?.isVision;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ValueExpression, ValueExpressionType } from '@coze-workflow/base';\n\nexport const DEFUALT_VISION_INPUT: ValueExpression = {\n  type: ValueExpressionType.REF,\n  rawMeta: { isVision: true },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport {\n  Field,\n  type FieldRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type ValueExpression, ViewVariableType } from '@coze-workflow/base';\n\nimport { ValueExpressionInput } from '@/nodes-v2/components/value-expression-input';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\n\nimport { DEFUALT_VISION_INPUT } from '../constants';\n\ninterface VisionProps {\n  name: string;\n  enabledTypes: ViewVariableType[];\n}\n\n/**\n * input value field\n * @returns */\nexport const VisionValueField: FC<VisionProps> = ({ enabledTypes, name }) => {\n  const disabledTypes = ViewVariableType.getComplement([\n    ...enabledTypes,\n    ViewVariableType.String,\n  ]);\n\n  return (\n    <Field name={name}>\n      {({\n        field: childInputField,\n        fieldState: inputFieldState,\n      }: FieldRenderProps<ValueExpression | undefined>) => (\n        <div className=\"flex-[3] min-w-0\">\n          <ValueExpressionInput\n            {...childInputField}\n            isError={!!inputFieldState?.errors?.length}\n            disabledTypes={disabledTypes}\n            defaultInputType={enabledTypes[0]}\n            inputTypes={enabledTypes}\n            onChange={v => {\n              const expression = v as ValueExpression;\n              if (!expression) {\n                // The default value needs to be accompanied by raw meta, otherwise it is impossible to distinguish whether it is visual understanding or not.\n                childInputField?.onChange(DEFUALT_VISION_INPUT);\n                return;\n              }\n              const newExpression: ValueExpression = {\n                ...expression,\n                rawMeta: {\n                  ...(expression.rawMeta || {}),\n                  isVision: true,\n                },\n              };\n              childInputField?.onChange(newExpression);\n            }}\n          />\n          <FormItemFeedback errors={inputFieldState?.errors} />\n        </div>\n      )}\n    </Field>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport classNames from 'classnames';\nimport {\n  Field,\n  useForm,\n  type FieldArrayRenderProps,\n  type FieldRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType, type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { NodeInputName } from '@/nodes-v2/components/node-input-name';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\n\nimport styles from './index.module.less';\n\ninterface VisionNameFieldProps {\n  inputField: FieldRenderProps<InputValueVO>['field'];\n  inputsField: FieldArrayRenderProps<InputValueVO>['field'];\n  enabledTypes: ViewVariableType[];\n}\n\n/**\n * Enter name field\n */\nexport const VisionNameField: FC<VisionNameFieldProps> = ({\n  inputField,\n  inputsField,\n  enabledTypes,\n}) => {\n  const form = useForm();\n  const input = form.getValueIn(`${inputField.name}.input`);\n\n  const disabledTooltip = useMemo(() => {\n    if (!enabledTypes.length) {\n      return I18n.t('workflow_250310_05', undefined, '');\n    }\n\n    const type = input?.rawMeta?.type;\n    if (!type || [...enabledTypes, ViewVariableType.String].includes(type)) {\n      return '';\n    }\n\n    return type === ViewVariableType.Image\n      ? I18n.t('workflow_250320_01', undefined, '')\n      : I18n.t('workflow_250320_02', undefined, '');\n  }, [enabledTypes, input?.rawMeta?.type]);\n\n  return (\n    <Field name={`${inputField.name}.name`}>\n      {({\n        field: childNameField,\n        fieldState: nameFieldState,\n      }: FieldRenderProps<string>) => (\n        <div\n          className={classNames(\n            'flex-[2] min-w-0 relative',\n            styles['vision-name-container'],\n          )}\n        >\n          <NodeInputName\n            {...childNameField}\n            input={input}\n            inputParameters={inputsField.value || []}\n            isError={!!nameFieldState?.errors?.length}\n            inputPrefix={\n              disabledTooltip ? (\n                <Tooltip content={disabledTooltip}>\n                  <IconCozInfoCircle className=\"coz-fg-hglt-yellow cursor-pointer text-sm\" />\n                </Tooltip>\n              ) : null\n            }\n          />\n          <FormItemFeedback errors={nameFieldState?.errors} />\n        </div>\n      )}\n    </Field>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport {\n  type FieldRenderProps,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO, type ViewVariableType } from '@coze-workflow/base';\nimport { IconCozMinus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { isVisionInput } from '../utils/index';\nimport { VisionValueField } from './vision-value-field';\nimport { VisionNameField } from './vision-name-field';\n\ninterface VisionInputFieldProps {\n  inputField: FieldRenderProps<InputValueVO>['field'];\n  inputsField: FieldArrayRenderProps<InputValueVO>['field'];\n  index: number;\n  readonly?: boolean;\n  form;\n  enabledTypes: ViewVariableType[];\n}\n\n/**\n * input field\n */\nexport const VisionInputField: FC<VisionInputFieldProps> = ({\n  readonly,\n  inputField,\n  inputsField,\n  index,\n  enabledTypes,\n}) => {\n  if (!isVisionInput(inputField?.value)) {\n    return null;\n  }\n  return (\n    <div className={'flex items-start pb-1 gap-1'}>\n      <VisionNameField\n        inputField={inputField}\n        inputsField={inputsField}\n        enabledTypes={enabledTypes}\n      />\n      <VisionValueField\n        name={`${inputField.name}.input`}\n        enabledTypes={enabledTypes}\n      />\n      {readonly ? (\n        <></>\n      ) : (\n        <div className=\"leading-none\">\n          <IconButton\n            size=\"small\"\n            color=\"secondary\"\n            icon={<IconCozMinus className=\"text-sm\" />}\n            onClick={() => {\n              inputsField.delete(index);\n            }}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport {\n  FieldArray,\n  useForm,\n  type FieldArrayRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO, ValueExpressionType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { AddIcon } from '@/nodes-v2/components/add-icon';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\n\nimport { useModelEnabledTypes } from '../hooks/use-model-enabled-types';\nimport { VisionInputField } from './vision-input-field';\n\nimport styles from './index.module.less';\n\ninterface VisionProps {\n  readonly?: boolean;\n}\n\n/**\n * Visual understanding configuration\n */\nexport const Vision: FC<VisionProps> = () => {\n  const enabledTypes = useModelEnabledTypes();\n  const disabledTooltip = !enabledTypes.length\n    ? I18n.t('workflow_250310_05', undefined, '')\n    : '';\n  const form = useForm();\n  const readonly = useReadonly();\n\n  return (\n    <FieldArray name={'$$input_decorator$$.inputParameters'}>\n      {({ field }: FieldArrayRenderProps<InputValueVO>) => (\n        <FormCard\n          header={I18n.t('workflow_250310_04', undefined, '')}\n          tooltip={I18n.t(\n            'workflow_250320_03',\n            undefined,\n            'orurlPrompt',\n          )}\n        >\n          <div className={styles['vision-title']}>\n            <ColumnsTitleWithAction\n              columns={[\n                {\n                  title: I18n.t('workflow_detail_variable_input_name'),\n                  style: {\n                    flex: 2,\n                  },\n                },\n                {\n                  title: I18n.t('workflow_detail_variable_input_value'),\n                  style: {\n                    flex: 3,\n                  },\n                },\n              ]}\n              readonly={readonly}\n            />\n          </div>\n          {field.map((child, index) => (\n            <VisionInputField\n              inputField={child}\n              inputsField={field}\n              index={index}\n              readonly={readonly}\n              form={form}\n              enabledTypes={enabledTypes}\n              key={child.key}\n            ></VisionInputField>\n          ))}\n          {readonly ? (\n            <></>\n          ) : (\n            <div className={styles['vision-add-icon']}>\n              <AddIcon\n                disabledTooltip={disabledTooltip}\n                onClick={() => {\n                  field.append({\n                    name: '',\n                    input: {\n                      type: ValueExpressionType.REF,\n                      rawMeta: { isVision: true },\n                    },\n                  });\n                }}\n              />\n            </div>\n          )}\n        </FormCard>\n      )}\n    </FieldArray>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType } from '@coze-workflow/base';\n\nimport { WorkflowModelsService } from '@/services';\n\nimport { useModelType } from '../../hooks/use-model-type';\n\n/**\n * Data types supported by the model\n */\nexport function useModelEnabledTypes() {\n  const modelType = useModelType();\n  const modelsService = useService(WorkflowModelsService);\n  const modelAbility = modelsService.getModelAbility(modelType);\n  const enabledTypes: ViewVariableType[] = [];\n\n  if (modelAbility?.image_understanding) {\n    enabledTypes.push(ViewVariableType.Image);\n  }\n\n  if (modelAbility?.video_understanding) {\n    enabledTypes.push(ViewVariableType.Video);\n  }\n\n  return enabledTypes;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { isVisionInput } from './is-vision-input';\n\n/**\n * Determine if they are the same input type\n * @param value1\n * @param value2\n * @returns\n */\nexport const isVisionEqual = (\n  value1: InputValueVO,\n  value2: InputValueVO,\n): boolean => isVisionInput(value1) === isVisionInput(value2);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const REASONING_CONTENT_NAME = 'reasoning_content';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from '@flowgram-adapter/free-layout-editor';\nimport {\n  ViewVariableType,\n  type ViewVariableTreeNode,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type WorkflowModelsService } from '@/services';\n\nimport { REASONING_CONTENT_NAME } from './constants';\n\nconst readonlyTooltip = I18n.t(\n  'workflow_250217_02',\n  undefined,\n  '',\n);\n\ninterface ViewVariableTreeNodeWithReadonly extends ViewVariableTreeNode {\n  readonly?: boolean;\n  readonlyTooltip?: string;\n}\n\nconst generateReasoningContent = () => ({\n  key: nanoid(),\n  name: REASONING_CONTENT_NAME,\n  type: ViewVariableType.String,\n  readonly: true,\n  readonlyTooltip,\n});\n\nconst isReasoningContent = (node: ViewVariableTreeNodeWithReadonly) =>\n  node.name === REASONING_CONTENT_NAME;\n\nexport const isSystemReasoningContent = (\n  node: ViewVariableTreeNodeWithReadonly,\n) => !!(isReasoningContent(node) && node.readonly);\n\nconst excludeReasoningContent = (nodes?: ViewVariableTreeNode[]) =>\n  (nodes ?? []).filter(node => !isSystemReasoningContent(node));\n\nconst includeReasoningContent = (nodes?: ViewVariableTreeNode[]) =>\n  (nodes ?? []).filter(node => isSystemReasoningContent(node));\n\nconst addReasoningContent = (\n  value?: ViewVariableTreeNode[],\n  isBatch?: boolean,\n) => {\n  if (!value) {\n    return value;\n  }\n\n  if (isBatch) {\n    return [\n      {\n        ...value[0],\n        children: [\n          ...excludeReasoningContent(value[0]?.children),\n          generateReasoningContent(),\n        ],\n      },\n    ];\n  }\n\n  return [...excludeReasoningContent(value), generateReasoningContent()];\n};\n\nconst removeReasoningContent = (\n  value?: ViewVariableTreeNode[],\n  isBatch?: boolean,\n) => {\n  if (!value) {\n    return value;\n  }\n  if (isBatch) {\n    const [one, ...rest] = value;\n    return [\n      {\n        ...one,\n        children: excludeReasoningContent(one?.children),\n      },\n      ...rest,\n    ];\n  } else {\n    return [...excludeReasoningContent(value)];\n  }\n};\n\nfunction findReasoningContent(\n  outputs: ViewVariableTreeNodeWithReadonly[] | undefined,\n  isBatch: boolean,\n  fn: (node) => boolean,\n): ViewVariableTreeNodeWithReadonly | undefined {\n  if (!outputs) {\n    return undefined;\n  }\n\n  if (isBatch) {\n    return outputs[0]?.children?.find(node => fn(node));\n  }\n  return outputs.find(node => fn(node));\n}\n\n/**\n * Output attribute sort to ensure that the reasoning content is at the bottom\n */\nexport const sortOutputs = (\n  value: ViewVariableTreeNode[] | undefined,\n  isBatch?: boolean,\n) => {\n  if (!value) {\n    return value;\n  }\n\n  if (isBatch) {\n    const [one, ...rest] = value;\n    return [\n      {\n        ...one,\n        children: [\n          ...excludeReasoningContent(one?.children),\n          ...includeReasoningContent(one?.children),\n        ],\n      },\n      ...rest,\n    ];\n  }\n  return [...excludeReasoningContent(value), ...includeReasoningContent(value)];\n};\n\n/**\n * Get output based on model type\n * @param modelType\n * @param outputs\n * @param isBatch\n * @returns\n */\nexport function getOutputs({\n  modelType,\n  outputs,\n  isBatch,\n  modelsService,\n}: {\n  modelType: number | undefined;\n  outputs: ViewVariableTreeNode[] | undefined;\n  isBatch: boolean;\n  modelsService: WorkflowModelsService;\n}) {\n  if (!modelType) {\n    return outputs;\n  }\n\n  if (modelsService.isCoTModel(modelType)) {\n    outputs = addReasoningContent(outputs, isBatch);\n  } else {\n    outputs = removeReasoningContent(outputs, isBatch);\n  }\n  return outputs;\n}\n\n/**\n * Format inference content as read-only during initialization\n * @param outputs\n * @param isBatch\n * @returns\n */\nexport function formatReasoningContentOnInit({\n  outputs,\n  isBatch,\n  modelType,\n  modelsService,\n}: {\n  outputs: ViewVariableTreeNode[] | undefined;\n  isBatch: boolean;\n  modelType?: number;\n  modelsService: WorkflowModelsService;\n}) {\n  if (!outputs) {\n    return outputs;\n  }\n\n  let newOutputs: ViewVariableTreeNode[] | undefined = outputs;\n  if (modelType && modelsService.isCoTModel(modelType)) {\n    // There is no readonly field returned by the backend, which needs to be processed by the front end. Take the first type that is string reasoning_content\n    const reasoningContent = findReasoningContent(\n      outputs,\n      isBatch,\n      item => isReasoningContent(item) && item.type === ViewVariableType.String,\n    );\n    if (reasoningContent) {\n      reasoningContent.readonly = true;\n      reasoningContent.readonlyTooltip = readonlyTooltip;\n    } else {\n      // The existing data is compatible, if it is an inference model, add the inference content field\n      newOutputs = addReasoningContent(outputs, isBatch);\n    }\n  }\n\n  return newOutputs;\n}\n\n/**\n * Format inference content on commit Remove readonly\n * @param outputs\n * @param isBatch\n * @returns\n */\nexport function formatReasoningContentOnSubmit(\n  outputs: ViewVariableTreeNodeWithReadonly[] | undefined,\n  isBatch: boolean,\n) {\n  if (!outputs) {\n    return outputs;\n  }\n\n  const reasoningContent = findReasoningContent(\n    outputs,\n    isBatch,\n    isSystemReasoningContent,\n  );\n  if (reasoningContent?.readonly) {\n    delete reasoningContent.readonly;\n  }\n\n  if (reasoningContent?.readonlyTooltip) {\n    delete reasoningContent.readonlyTooltip;\n  }\n\n  return outputs;\n}\n\n/**\n * Remove the reasoning_content in outputs for readonly\n */\nexport const omitSystemReasoningContent = (\n  value: ViewVariableTreeNodeWithReadonly[] | undefined,\n  isBatch?: boolean,\n) => {\n  // Batch, remove from children, for readonly reasoning_content\n  if (isBatch) {\n    return value?.map(v => ({\n      ...v,\n      children: v?.children?.filter(c => !isSystemReasoningContent(c)),\n    }));\n  }\n  // Single, remove the reasoning_content in value for readonly\n  return value?.filter(v => !isSystemReasoningContent(v));\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type Effect,\n  DataEvent,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type ViewVariableTreeNode } from '@coze-workflow/base';\n\nimport { WorkflowModelsService } from '@/services';\n\nimport { getOutputs } from './utils';\n\nfunction createEffect(): Effect {\n  return ({ value, context: { node } }) => {\n    const modelType = value?.modelType;\n\n    const form = node\n      ?.getData(FlowNodeFormData)\n      ?.getFormModel<FormModelV2>()?.nativeFormModel;\n\n    if (!form || !modelType) {\n      return;\n    }\n\n    const outputs = form.getValueIn<ViewVariableTreeNode[] | undefined>(\n      'outputs',\n    );\n\n    const isBatch = form.getValueIn('batchMode') === 'batch';\n    const modelsService = node.getService(WorkflowModelsService);\n\n    form.setValueIn(\n      'outputs',\n      getOutputs({ modelType, outputs, isBatch, modelsService }),\n    );\n  };\n}\n\nexport const provideReasoningContentEffect = [\n  {\n    effect: createEffect(),\n    event: DataEvent.onValueChange,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { z } from 'zod';\nimport { type ZodError } from 'zod';\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\n\nimport { omitSystemReasoningContent, REASONING_CONTENT_NAME } from '../cot';\n\n/** Variable Naming Validation Rules */\nconst outputTreeValidationRule =\n  /^(?!.*\\b(true|false|and|AND|or|OR|not|NOT|null|nil|If|Switch)\\b)[a-zA-Z_][a-zA-Z_$0-9]*$/;\n\n/** check logic */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst OutputTreeMetaSchema = z.lazy(() =>\n  z\n    .object({\n      name: z\n        .string({\n          required_error: I18n.t('workflow_detail_node_error_name_empty'),\n        })\n        .min(1, I18n.t('workflow_detail_node_error_name_empty'))\n        .regex(\n          outputTreeValidationRule,\n          I18n.t('workflow_detail_node_error_format'),\n        )\n        .refine(\n          val => {\n            if (val === REASONING_CONTENT_NAME) {\n              return false;\n            }\n            return true;\n          },\n          {\n            message: I18n.t('workflow_250213_01'),\n          },\n        ),\n      children: z.array(OutputTreeMetaSchema).optional(),\n    })\n    .passthrough(),\n);\n\nconst omitErrorBody = (value, isBatch) => {\n  // Batch, remove errorBody from children\n  if (isBatch) {\n    return value?.map(v => ({\n      ...v,\n      children: v?.children?.filter(c => c?.name !== 'errorBody'),\n    }));\n  }\n  // Single, remove errorBody from value\n  return value?.filter(v => v?.name !== 'errorBody');\n};\n\nexport const llmOutputTreeMetaValidator: Validate = ({ value, formValues }) => {\n  /**\n   * Determine whether the error exception handling is turned on. If it is turned on, you need to filter out the errorBody and check it.\n   */\n  const { settingOnErrorIsOpen = false } = (get(formValues, 'settingOnError') ??\n    {}) as { settingOnErrorIsOpen?: boolean };\n\n  /**\n   * According to the batch data, whether it is currently in the batch state\n   */\n  const batchValue = get(formValues, 'batchMode');\n  const isBatch = batchValue === 'batch';\n  const reasoningContentOmittedValue = omitSystemReasoningContent(\n    value,\n    isBatch,\n  );\n\n  const parsed = z\n    .array(OutputTreeMetaSchema)\n    .safeParse(\n      settingOnErrorIsOpen\n        ? omitErrorBody(reasoningContentOmittedValue, isBatch)\n        : reasoningContentOmittedValue,\n    );\n\n  if (!parsed.success) {\n    const errorText = JSON.stringify((parsed as { error: ZodError }).error);\n    return errorText;\n  }\n\n  return undefined;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport const defaultKnowledgeGlobalSetting = {\n  auto: false,\n  min_score: 0.5,\n  no_recall_reply_customize_prompt: I18n.t('No_recall_006'),\n  no_recall_reply_mode: 0,\n  search_strategy: 0,\n  show_source: false,\n  show_source_mode: 0,\n  top_k: 3,\n  use_rerank: true,\n  use_rewrite: true,\n  use_nl2_sql: true,\n};\n\nexport const defaultResponseStyleMode = 0;\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const TypeMap = new Map([\n  [1, 'String'],\n  [2, 'Integer'],\n  [3, 'Number'],\n  [4, 'Object'],\n  [5, 'Array'],\n  [6, 'Bool'],\n]);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { camelCase } from 'lodash-es';\nimport type {\n  ILibraryItem,\n  LibraryType,\n} from '@coze-common/editor-plugins/library-insert';\nimport { DEFAULT_MODEL_TYPE } from '@coze-workflow/nodes';\nimport {\n  BlockInput,\n  GenerationDiversity,\n  VariableTypeDTO,\n  type InputValueDTO,\n} from '@coze-workflow/base';\nimport { ModelParamType, type Model } from '@coze-arch/bot-api/developer_api';\n\nimport { isDraftByProjectId } from '@/nodes-v2/llm/skills/utils';\n\nimport {\n  type BoundKnowledgeItem,\n  type BoundPluginItem,\n  type BoundSkills,\n  type BoundWorkflowItem,\n  SkillType,\n} from './skills/types';\nimport { defaultKnowledgeGlobalSetting } from './skills/constants';\n\nconst getDefaultModels = (modelMeta: Model): InputValueDTO[] => {\n  const defaultModel: InputValueDTO[] = [];\n\n  modelMeta?.model_params?.forEach(p => {\n    const k = camelCase(p.name) as string;\n    const { type } = p;\n    // Priority to take the balance, custom bottom line\n    const defaultValue =\n      p.default_val[GenerationDiversity.Balance] ??\n      p.default_val[GenerationDiversity.Customize];\n\n    if (defaultValue !== undefined) {\n      if (ModelParamType.Float === type) {\n        defaultModel.push(BlockInput.createFloat(k, defaultValue));\n      } else if (ModelParamType.Int === type || ['modelType'].includes(k)) {\n        defaultModel.push(BlockInput.createInteger(k, defaultValue));\n      }\n    }\n  });\n\n  return defaultModel;\n};\n\nexport const getDefaultLLMParams = (models: Model[]) => {\n  const modelMeta =\n    models.find(m => m.model_type === DEFAULT_MODEL_TYPE) ?? models[0];\n\n  const llmParam = [\n    BlockInput.createInteger('modelType', `${modelMeta?.model_type ?? ''}`),\n    BlockInput.createString('modelName', modelMeta?.name ?? ''),\n    BlockInput.createString('generationDiversity', GenerationDiversity.Balance),\n    ...getDefaultModels(modelMeta),\n  ].filter(Boolean);\n\n  return llmParam;\n};\n\nexport const reviseLLMParamPair = (d: InputValueDTO): [string, unknown] => {\n  let k = d?.name || '';\n\n  // The TODO front end does not rely on this field. After confirming that the back end does not rely on it, it can be deleted.\n  // Compatible with a long-standing spelling error\n  if (k === 'modleName') {\n    k = 'modelName';\n  }\n  let v = d.input.value.content;\n  if (\n    [VariableTypeDTO.float, VariableTypeDTO.integer].includes(\n      d.input.type as VariableTypeDTO,\n    )\n  ) {\n    v = Number(d.input.value.content);\n  }\n\n  return [k, v];\n};\n\nexport const modelItemToBlockInput = (\n  model: Model,\n  modelMeta: Model | undefined,\n): BlockInput[] =>\n  Object.keys(model).map(k => {\n    const type = modelMeta?.model_params?.find(\n      p => camelCase(p.name) === k,\n    )?.type;\n    if (ModelParamType.Float === type) {\n      return BlockInput.createFloat(k, model[k]);\n    } else if (ModelParamType.Int === type || ['modelType'].includes(k)) {\n      return BlockInput.createInteger(k, model[k]);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    let _k = k;\n    // The TODO front end does not rely on this field. After confirming that the back end does not rely on it, it can be deleted.\n    if (_k === 'modelName') {\n      _k = 'modleName';\n    }\n    return BlockInput.createString(_k, model[k]);\n  });\n\nconst libraryType2SkillsType = (type: LibraryType): SkillType => {\n  if (type === 'plugin') {\n    return SkillType.Plugin;\n  }\n\n  if (type === 'imageflow' || type === 'workflow') {\n    return SkillType.Workflow;\n  }\n\n  return SkillType.Knowledge;\n};\n\nexport const addSKillFromLibrary = (\n  library: ILibraryItem,\n  _skills: BoundSkills,\n): BoundSkills => {\n  const type = libraryType2SkillsType(library.type);\n  const skills: BoundSkills = _skills || {};\n\n  if (type === SkillType.Plugin) {\n    const data = skills.pluginFCParam?.pluginList || [];\n    const detail = library.detail_info?.plugin_detail;\n    data.push({\n      plugin_id: detail?.plugin_id as string,\n      api_id: detail?.api_id as string,\n      api_name: detail?.name as string,\n      plugin_version: '', // And @Zhang Yousong, confirm, do not send the version\n      is_draft: isDraftByProjectId(detail?.project_id),\n    });\n\n    return {\n      ...skills,\n      pluginFCParam: {\n        pluginList: data as Array<BoundPluginItem>,\n      },\n    };\n  } else if (type === SkillType.Workflow) {\n    const data = skills.workflowFCParam?.workflowList || [];\n    const detail = library.detail_info?.workflow_detail;\n    data.push({\n      plugin_id: detail?.plugin_id as string,\n      workflow_id: detail?.workflow_id as string,\n      plugin_version: '',\n      workflow_version: '', // And @Zhang Yousong, confirm, do not send the version\n      is_draft: isDraftByProjectId(detail?.project_id),\n    });\n\n    return {\n      ...skills,\n      workflowFCParam: {\n        workflowList: data as Array<BoundWorkflowItem>,\n      },\n    };\n  } else if (type === SkillType.Knowledge) {\n    const data = skills.knowledgeFCParam?.knowledgeList || [];\n    const detail = library.detail_info?.knowledge_detail;\n\n    data.push({\n      id: detail?.id as string,\n      name: detail?.name as string,\n    });\n\n    return {\n      ...skills,\n      knowledgeFCParam: {\n        ...skills.knowledgeFCParam,\n        knowledgeList: data as Array<BoundKnowledgeItem>,\n        global_setting:\n          skills.knowledgeFCParam?.global_setting ??\n          defaultKnowledgeGlobalSetting,\n      },\n    };\n  }\n\n  return skills;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { useForm } from '@flowgram-adapter/free-layout-editor';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { ExpressionEditor } from '@/nodes-v2/components/expression-editor';\nimport { useWorkflowModels } from '@/hooks';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { CopyButton } from '@/components/copy-button';\n\nexport const UserPrompt = ({ field, fieldState }) => {\n  const form = useForm();\n  const readonly = useReadonly();\n  const { models } = useWorkflowModels();\n\n  const modelType = form.getValueIn('model.modelType');\n  const curModel = models?.find(model => model.model_type === modelType);\n  const isUserPromptRequired = curModel?.is_up_required ?? false;\n\n  useEffect(() => {\n    // TODO: Temporary solution, replaced after the node engine provides a new API\n    field._fieldModel.validate();\n  }, [isUserPromptRequired]);\n\n  return (\n    <FormCard\n      key={'FormCard'}\n      header={I18n.t('workflow_detail_llm_prompt')}\n      tooltip={I18n.t('workflow_detail_llm_prompt_tooltip')}\n      required={isUserPromptRequired}\n      actionButton={\n        readonly ? [<CopyButton value={field?.value as string} />] : []\n      }\n    >\n      <ExpressionEditor\n        placeholder={I18n.t('workflow_detail_llm_prompt_content')}\n        maxLength={500}\n        {...field}\n        inputParameters={form.getValueIn('$$input_decorator$$.inputParameters')}\n        key=\"ExpressionEditor\"\n        isError={!!fieldState?.errors?.length}\n      />\n      <FormItemFeedback errors={fieldState?.errors} />\n    </FormCard>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { EditorAPI } from '@coze-editor/editor/preset-prompt';\n\nexport const focusToAnchor = (\n  editor: EditorAPI,\n  pos?: { from: number; to: number },\n) => {\n  if (pos) {\n    editor.$view.dispatch({\n      selection: { anchor: pos.to },\n    });\n  }\n\n  editor.$view.focus();\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/bot-semi';\nimport { ThemeExtension } from '@coze-common/editor-plugins/theme';\nimport {\n  PromptEditorRender,\n  type PromptEditorRenderProps,\n} from '@coze-common/prompt-kit-base/editor';\nimport { EditorView } from '@codemirror/view';\n\nimport { WORKFLOW_PLAYGROUND_CONTENT_ID } from '@/constants';\n\ninterface EditorWithPromptKitProps extends PromptEditorRenderProps {\n  wrapperClassName?: string;\n  wrapperStyle?: React.CSSProperties;\n}\n\nexport const SystemPromptEditor: FC<EditorWithPromptKitProps> = props => {\n  const {\n    readonly,\n    placeholder,\n    defaultValue,\n    value,\n    onChange,\n    isControled,\n    wrapperClassName = '',\n    wrapperStyle,\n    dataTestID,\n    onFocus,\n    onBlur,\n  } = props;\n\n  const [isFocused, setIsFocused] = useState(false);\n\n  const handleOnFocus = () => {\n    setIsFocused(true);\n    onFocus?.();\n  };\n\n  const handleOnBlur = () => {\n    setIsFocused(false);\n    onBlur?.();\n  };\n\n  return (\n    <Tooltip\n      content={I18n.t('db_table_0129_003')}\n      trigger=\"custom\"\n      position=\"top\"\n      autoAdjustOverflow={false}\n      visible={isFocused && readonly}\n      getPopupContainer={() =>\n        document.getElementById(WORKFLOW_PLAYGROUND_CONTENT_ID) ?? document.body\n      }\n    >\n      <div\n        className={wrapperClassName}\n        style={wrapperStyle}\n        onMouseEnter={() => {\n          setIsFocused(true);\n        }}\n        onMouseLeave={() => {\n          setIsFocused(false);\n        }}\n      >\n        <PromptEditorRender\n          defaultValue={defaultValue ?? value}\n          value={value}\n          onChange={onChange}\n          readonly={readonly}\n          placeholder={placeholder}\n          options={{\n            minHeight: 112,\n            fontSize: 12,\n          }}\n          dataTestID={dataTestID}\n          isControled={isControled}\n          onFocus={handleOnFocus}\n          onBlur={handleOnBlur}\n        />\n        <ThemeExtension\n          themes={[\n            EditorView.theme({\n              '.cm-line': {\n                lineHeight: '18px !important',\n              },\n            }),\n          ]}\n        />\n      </div>\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { create } from 'zustand';\nimport type { ILibraryList } from '@coze-common/editor-plugins/library-insert';\n\ninterface LibrariesStore {\n  libraries: ILibraryList;\n  updateLibraries: (libraries: ILibraryList) => void;\n}\n\nexport const useLibrariesStore = create<LibrariesStore>(set => ({\n  libraries: [],\n  updateLibraries: libraries =>\n    set({\n      libraries,\n    }),\n}));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useMemo } from 'react';\n\nimport { useGlobalVariableServiceState } from '@coze-workflow/variable';\nimport {\n  NLPromptButton,\n  NLPromptModal,\n  NlPromptAction,\n  NlPromptShortcut,\n} from '@coze-workflow/resources-adapter';\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { type EditorAPI, useEditor } from '@coze-common/prompt-kit-base/editor';\nimport { usePromptConfiguratorModal } from '@coze-common/prompt-kit-adapter/create-prompt';\nimport { RecommendPannel } from '@coze-common/prompt-kit/prompt-recommend';\nimport { usePromptLibraryModal } from '@coze-common/prompt-kit';\nimport {\n  ContentSearchPopover,\n  type ContentSearchPopoverProps,\n} from '@coze-common/editor-plugins/library-variable-insert';\nimport {\n  type ILibraryItem,\n  LibraryBlockWidget,\n} from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport {\n  Completion,\n  Validation,\n  HighlightExpressionOnActive,\n} from '@coze-common/editor-plugins/expression';\nimport { InsertInputSlotAction } from '@coze-common/editor-plugins/actions';\nimport { ActionBar } from '@coze-common/editor-plugins/action-bar';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozCrossFill,\n  IconCozLightbulb,\n  IconCozTrayArrowUp,\n} from '@coze-arch/coze-design/icons';\nimport { Tooltip, IconButton, Button } from '@coze-arch/coze-design';\n\nimport { focusToAnchor } from '@/nodes-v2/components/system-prompt/utils';\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\nimport { useGlobalState } from '@/hooks';\nimport { useLLMPromptHistory } from '@/form-extensions/hooks';\nimport { useTestRunResult } from '@/components/test-run/img-log/use-test-run-result';\nimport { ExpandEditorContainer } from '@/components/editor-container';\n\nimport { useVariableTree } from '../expression-editor/hooks';\nimport { type ExpressionEditorProps } from '../expression-editor';\nimport { useLibrariesStore } from './use-libraries-store';\nimport { SystemPromptEditor } from './system-prompt-editor';\n\nimport styles from './index.module.less';\ninterface ExpandSheetEditorProps\n  extends ExpressionEditorProps,\n    ContentSearchPopoverProps {\n  readonly?: boolean;\n  onAddLibrary?: (library: ILibraryItem) => void;\n}\n\nexport const ExpandSheetEditor: FC<ExpandSheetEditorProps> = props => {\n  const { readonly } = props;\n  const { getNodeSetterId } = useNodeTestId();\n  const dataTestID = getNodeSetterId(props.name);\n  const editor = useEditor<EditorAPI>();\n  const { id, type } = useGlobalVariableServiceState();\n\n  const { libraries } = useLibrariesStore(state => ({\n    libraries: state.libraries,\n  }));\n\n  const variableTree: ExpressionEditorTreeNode[] = useVariableTree();\n\n  const { setFullscreenPanel } = useNodeFormPanelState();\n\n  const {\n    spaceId,\n    projectId,\n    workflowId,\n    info: { name = '', desc = '' },\n  } = useGlobalState();\n  const isHitLLMPromptSkills = true;\n\n  const testRunResult = useTestRunResult();\n  const contextHistory = useLLMPromptHistory(props?.value, testRunResult);\n\n  const getConversationId = () => '';\n  const getPromptContextInfo = useMemo(\n    () => () => ({\n      // No need to pass bot_id workflow scenario\n      botId: '',\n      name,\n      description: desc,\n      contextHistory,\n    }),\n    [name, desc, contextHistory],\n  );\n  const prompt = editor?.getValue();\n\n  const { open, node: PromptLibrary } = usePromptLibraryModal({\n    spaceId,\n    getConversationId,\n    getPromptContextInfo,\n    source: 'app_detail_page',\n    projectId,\n    workflowId,\n    editor,\n    onInsertPrompt: (insertPrompt, info) => props?.onChange(insertPrompt),\n  });\n\n  const { open: openCreatePrompt, node: promptConfiguratorModal } =\n    usePromptConfiguratorModal({\n      spaceId,\n      projectId,\n      workflowId,\n      source: 'app_detail_page',\n    });\n\n  return (\n    <>\n      <ExpandEditorContainer\n        id={'system-prompt-expand-editor'}\n        closeButton={\n          <div className=\"flex items-center gap-[8px]\">\n            <Tooltip content={I18n.t('compare_tooltips_submit_to_the_prompt')}>\n              <Button\n                color=\"secondary\"\n                icon={<IconCozTrayArrowUp />}\n                onClick={() =>\n                  openCreatePrompt({\n                    mode: 'create',\n                    defaultPrompt: editor?.getValue(),\n                  })\n                }\n              ></Button>\n            </Tooltip>\n\n            {/* will support soon */}\n            {IS_OPEN_SOURCE ? null : (\n              <NLPromptButton disabled={props?.readonly} onlyIcon />\n            )}\n\n            <Tooltip content={I18n.t('workflow_prompt_editor_view_library')}>\n              <IconButton\n                onClick={() => {\n                  open();\n                }}\n                icon={<IconCozLightbulb />}\n                color=\"secondary\"\n                disabled={readonly}\n              />\n            </Tooltip>\n            <IconButton\n              onClick={() => setFullscreenPanel(null)}\n              color=\"secondary\"\n              icon={<IconCozCrossFill color=\"#060709CC\" />}\n            />\n          </div>\n        }\n        containerClassName=\"bg-[#FCFCFF]\"\n        headerClassName=\"bg-[#FCFCFF] text-[16px] leading-[22px] font-medium mb-[12px] !p-[20px]\"\n        editorTitle={\n          <div className=\"flex items-center gap-[8px]\">\n            <div\n              className=\"text-[16px] leading-[22px] font-medium\"\n              style={{\n                color: 'var(--Fg-COZ-fg-plus, rgba(6, 7, 9, 0.96))',\n              }}\n            >\n              {I18n.t('workflow_LLM_node_sp_title')}\n            </div>\n          </div>\n        }\n        contentClassName={styles['editor-content']}\n        editorContent={\n          <>\n            <div className=\"relative w-full h-full pl-[8px] pr-[20px]\">\n              <SystemPromptEditor\n                defaultValue={props?.value}\n                onChange={props?.onChange}\n                readonly={props?.readonly}\n                placeholder={props?.placeholder as React.ReactNode}\n                wrapperClassName={styles['prompt-editor']}\n                wrapperStyle={{\n                  height: '100%',\n                }}\n                dataTestID={dataTestID}\n              />\n\n              <InputSlotWidget mode=\"input\" />\n              <LibraryBlockWidget\n                {...(isHitLLMPromptSkills\n                  ? {\n                      librarys: libraries,\n                      disabledTooltips: props.readonly,\n                    }\n                  : {\n                      librarys: [],\n                      readonly: true,\n                    })}\n                spaceId={spaceId}\n                projectId={type === 'project' ? id : undefined}\n                onAddLibrary={props.onAddLibrary}\n                onRename={pos => focusToAnchor(editor, pos)}\n              />\n              <NlPromptShortcut shortcutKey=\"/\" />\n\n              <HighlightExpressionOnActive />\n              {isHitLLMPromptSkills ? (\n                <ContentSearchPopover\n                  variableTree={variableTree}\n                  libraries={libraries}\n                  readonly={props.readonly}\n                  onInsert={pos => focusToAnchor(editor, pos)}\n                />\n              ) : (\n                <Completion variableTree={variableTree} />\n              )}\n\n              <Validation variableTree={variableTree} />\n\n              {!props?.readonly && (\n                <>\n                  <ActionBar>\n                    <NlPromptAction />\n                    <InsertInputSlotAction />\n                  </ActionBar>\n                  {prompt?.length === 0 ? (\n                    <RecommendPannel\n                      tabs={['Recommended', 'Team']}\n                      importPromptWhenEmpty={props?.value}\n                      source=\"app_detail_page\"\n                      projectId={projectId}\n                      workflowId={workflowId}\n                      spaceId={spaceId}\n                      getConversationId={getConversationId}\n                      getPromptContextInfo={getPromptContextInfo}\n                      onInsertPrompt={(insertPrompt, info) => {\n                        props?.onChange(insertPrompt);\n                      }}\n                      listContainerClassName=\"h-[211px]\"\n                      cardClassName=\"w-[240xp]\"\n                    />\n                  ) : null}\n                </>\n              )}\n            </div>\n            <NLPromptModal\n              getConversationId={getConversationId}\n              getPromptContextInfo={getPromptContextInfo}\n            />\n            {PromptLibrary}\n            {promptConfiguratorModal}\n          </>\n        }\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { NLPromptButton } from '@coze-workflow/resources-adapter';\nimport { PromptEditorProvider } from '@coze-common/prompt-kit-base/editor';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozExpand,\n  IconCozLightbulb,\n  IconCozMinimize,\n  IconCozTrayArrowUp,\n} from '@coze-arch/coze-design/icons';\nimport { Tooltip, IconButton, Button } from '@coze-arch/coze-design';\nimport { UIIconButton } from '@coze-arch/bot-semi';\n\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\nimport { CopyButton } from '@/components/copy-button';\n\nimport { useLibrariesStore } from './use-libraries-store';\nimport { ExpandSheetEditor } from './expand-sheet-editor';\n\nimport styles from './index.module.less';\n\nexport const PromptKitBar = props => {\n  const { openPromptLibrary, readonly, value, openCreatePrompt } = props;\n\n  const { updateLibraries } = useLibrariesStore(state => ({\n    updateLibraries: state.updateLibraries,\n  }));\n\n  const { fullscreenPanel, setFullscreenPanel } = useNodeFormPanelState();\n  const fullscreenPanelVisible = !!fullscreenPanel;\n\n  useEffect(() => {\n    updateLibraries(props.libraries || []);\n  }, [props.libraries]);\n\n  const handleExpandClick = () => {\n    setFullscreenPanel(\n      fullscreenPanelVisible ? null : (\n        <PublicScopeProvider>\n          <PromptEditorProvider>\n            <ExpandSheetEditor {...props} />\n          </PromptEditorProvider>\n        </PublicScopeProvider>\n      ),\n    );\n  };\n\n  return (\n    <div\n      className={`flex justify-between items-center gap-[8px] h-[28px] ${styles['kit-button-container']}`}\n    >\n      {readonly ? <CopyButton value={value as string} /> : null}\n      <Tooltip content={I18n.t('compare_tooltips_submit_to_the_prompt')}>\n        <Button\n          color=\"secondary\"\n          disabled={readonly}\n          icon={<IconCozTrayArrowUp />}\n          onClick={() =>\n            openCreatePrompt({\n              mode: 'create',\n              defaultPrompt: value,\n            })\n          }\n        ></Button>\n      </Tooltip>\n      <Tooltip content={I18n.t('workflow_prompt_editor_view_library')}>\n        <IconButton\n          onClick={e => {\n            e.stopPropagation();\n            openPromptLibrary();\n          }}\n          icon={<IconCozLightbulb />}\n          color=\"secondary\"\n          disabled={readonly}\n        />\n      </Tooltip>\n\n      <Tooltip\n        content={I18n.t(\n          fullscreenPanelVisible ? 'collapse' : 'workflow_prompt_editor_expand',\n        )}\n      >\n        <UIIconButton\n          onClick={handleExpandClick}\n          icon={\n            fullscreenPanelVisible ? (\n              <IconCozMinimize color=\"#6B6D75\" />\n            ) : (\n              <IconCozExpand color=\"#6B6D75\" />\n            )\n          }\n          color=\"#6B6D75\"\n        />\n      </Tooltip>\n\n      <div className={styles['nl-prompt']}>\n        {/* will support soon */}\n        {IS_OPEN_SOURCE ? null : (\n          <NLPromptButton\n            disabled={readonly}\n            onlyIcon\n            className=\"!h-6 !p-1 !rounded-[5px]\"\n            tooltip={I18n.t('prompt_optimization_button_hover_tooltip')}\n            size=\"small\"\n            style={{ minWidth: '24px' }}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState, useRef } from 'react';\n\nimport classNames from 'classnames';\nimport { useGlobalVariableServiceState } from '@coze-workflow/variable';\nimport { NLPromptModal } from '@coze-workflow/resources-adapter';\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-prompt';\nimport { usePromptConfiguratorModal } from '@coze-common/prompt-kit-adapter/create-prompt';\nimport { usePromptLibraryModal } from '@coze-common/prompt-kit';\nimport {\n  ContentSearchPopover,\n  type ContentSearchPopoverProps,\n} from '@coze-common/editor-plugins/library-variable-insert';\nimport {\n  type ILibraryItem,\n  LibraryBlockWidget,\n} from '@coze-common/editor-plugins/library-insert';\nimport { InputSlotWidget } from '@coze-common/editor-plugins/input-slot';\nimport {\n  Completion,\n  Validation,\n  HighlightExpressionOnActive,\n} from '@coze-common/editor-plugins/expression';\nimport { I18n } from '@coze-arch/i18n';\nimport { useFlags } from '@coze-arch/bot-flags';\n\nimport { useGlobalState } from '@/hooks';\nimport { FormCard } from '@/form-extensions/components/form-card';\n\nimport { useVariableTree } from '../expression-editor/hooks';\nimport { type ExpressionEditorProps } from '../expression-editor';\nimport { focusToAnchor } from './utils';\nimport { SystemPromptEditor } from './system-prompt-editor';\nimport { PromptKitBar } from './prompt-kit-bar';\n\nimport s from './index.module.less';\n\ninterface EditorWithPromptKitProps\n  extends ExpressionEditorProps,\n    ContentSearchPopoverProps {\n  getConversationId: () => string;\n  getPromptContextInfo: () => {\n    botId?: string | undefined;\n    name: string;\n    description: string;\n  };\n  readonly?: boolean;\n  onAddLibrary?: (library: ILibraryItem) => void;\n  onRename?: () => void;\n}\n\nexport const EditorWithPromptKit: FC<EditorWithPromptKitProps> = props => {\n  const {\n    name,\n    getConversationId,\n    getPromptContextInfo,\n    readonly,\n    placeholder,\n    value,\n    onChange,\n    libraries = [],\n    onAddLibrary,\n  } = props;\n  const { id, type } = useGlobalVariableServiceState();\n  const { getNodeSetterId } = useNodeTestId();\n  const dataTestID = getNodeSetterId(name);\n\n  const { spaceId, projectId, workflowId } = useGlobalState();\n  const [isFocused, setIsFocused] = useState(false);\n  const variableTree: ExpressionEditorTreeNode[] = useVariableTree();\n  const editor = useEditor<EditorAPI>();\n\n  const promptValue = useRef<string>(value || '');\n\n  const [FLAGS] = useFlags();\n  // Support soon, so stay tuned.\n  const isHitLLMPromptSkills = FLAGS['bot.automation.llm_prompt_skills'];\n\n  const { open, node: PromptLibrary } = usePromptLibraryModal({\n    spaceId,\n    getConversationId,\n    projectId,\n    workflowId,\n    getPromptContextInfo,\n    source: 'app_detail_page',\n    editor,\n    onInsertPrompt: (prompt, info) => props?.onChange(prompt),\n  });\n\n  const { open: openCreatePrompt, node: promptConfiguratorModal } =\n    usePromptConfiguratorModal({\n      spaceId,\n      source: 'app_detail_page',\n      projectId,\n      workflowId,\n    });\n\n  const handleOnFocus = () => {\n    setIsFocused(true);\n  };\n\n  const handleOnBlur = () => {\n    setIsFocused(false);\n  };\n\n  return (\n    <div className={s.container} onBlur={() => onChange?.(promptValue.current)}>\n      <FormCard\n        defaultExpand\n        showBottomBorder\n        noPadding\n        header={I18n.t('workflow_LLM_node_sp_title')}\n        tooltip={I18n.t('workflow_detail_llm_sys_prompt_content_tips')}\n        contentClassName={classNames(s['code-content'], {\n          [s['code-content-focus']]: isFocused,\n        })}\n        actionButton={\n          <PromptKitBar\n            {...props}\n            getConversationId={getConversationId}\n            getPromptContextInfo={getPromptContextInfo}\n            onInsertPrompt={prompt => props?.onChange(prompt)}\n            openPromptLibrary={open}\n            openCreatePrompt={openCreatePrompt}\n            onAddLibrary={onAddLibrary}\n          />\n        }\n      >\n        <SystemPromptEditor\n          defaultValue={value}\n          value={value}\n          onChange={v => (promptValue.current = v)}\n          readonly={readonly}\n          placeholder={placeholder as React.ReactNode}\n          isControled\n          dataTestID={dataTestID}\n          onFocus={handleOnFocus}\n          onBlur={handleOnBlur}\n        />\n        <InputSlotWidget mode=\"input\" />\n        <LibraryBlockWidget\n          {\n            // Support soon, so stay tuned.\n            ...(isHitLLMPromptSkills\n              ? {\n                  librarys: libraries,\n                  disabledTooltips: readonly,\n                }\n              : {\n                  librarys: [],\n                  readonly: true,\n                })\n          }\n          spaceId={spaceId}\n          projectId={type === 'project' ? id : undefined}\n          onAddLibrary={(library, pos) => {\n            focusToAnchor(editor, pos);\n            onAddLibrary?.(library);\n          }}\n          onRename={pos => focusToAnchor(editor, pos)}\n        />\n        <HighlightExpressionOnActive />\n\n        {/* Support soon, so stay tuned. */}\n        {isHitLLMPromptSkills ? (\n          <ContentSearchPopover\n            variableTree={variableTree}\n            libraries={libraries}\n            readonly={readonly}\n            onInsert={pos => focusToAnchor(editor, pos)}\n          />\n        ) : (\n          <Completion variableTree={variableTree} />\n        )}\n\n        <Validation variableTree={variableTree} />\n      </FormCard>\n      <NLPromptModal\n        getConversationId={getConversationId}\n        getPromptContextInfo={getPromptContextInfo}\n      />\n      {PromptLibrary}\n      {promptConfiguratorModal}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, type FC } from 'react';\n\nimport type {\n  ILibraryItem,\n  ILibraryList,\n} from '@coze-common/editor-plugins/library-insert';\nimport { NLPromptProvider } from '@coze-workflow/resources-adapter';\nimport { PromptEditorProvider } from '@coze-common/prompt-kit-base/editor';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\nimport { useGlobalState } from '@/hooks';\nimport { useLLMPromptHistory } from '@/form-extensions/hooks';\nimport { useTestRunResult } from '@/components/test-run/img-log/use-test-run-result';\n\nimport type { ExpressionEditorProps } from '../expression-editor';\nimport { EditorWithPromptKit } from './prompt-editor-with-kit';\n\nexport interface SystemPromptProps extends ExpressionEditorProps {\n  libraries: ILibraryList;\n  onAddLibrary?: (library: ILibraryItem) => void;\n}\n\nexport const SystemPrompt: FC<SystemPromptProps> = props => {\n  const readonly = useReadonly();\n\n  const { fullscreenPanel } = useNodeFormPanelState();\n\n  const {\n    info: { name = '', desc = '' },\n  } = useGlobalState();\n\n  const testRunResult = useTestRunResult();\n  const contextHistory = useLLMPromptHistory(props?.value, testRunResult);\n\n  const getConversationId = () => '';\n  const getPromptContextInfo = useMemo(\n    () => () => ({\n      // No need to pass bot_id workflow scenario\n      botId: '',\n      name,\n      description: desc,\n      contextHistory,\n    }),\n    [name, desc, contextHistory],\n  );\n\n  return (\n    <PromptEditorProvider>\n      <NLPromptProvider>\n        <EditorWithPromptKit\n          {...props}\n          readonly={(readonly || !!fullscreenPanel) as boolean}\n          getConversationId={getConversationId}\n          getPromptContextInfo={getPromptContextInfo}\n        />\n      </NLPromptProvider>\n    </PromptEditorProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport {\n  type GetLLMNodeFCSettingDetailResponse,\n  WorkflowMode,\n} from '@coze-arch/idl/workflow_api';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type ILibraryList,\n  type ILibraryItem,\n} from '@coze-common/editor-plugins/library-insert';\n\nimport { useGlobalState } from '@/hooks';\n\nimport { getSkillsQueryParams } from '../skills/utils';\nimport { useQuerySettingDetail } from '../skills/use-query-setting-detail';\nimport type { BoundKnowledgeItem, BoundSkills } from '../skills/types';\n\ninterface Props {\n  fcParam?: BoundSkills;\n}\n\nenum DatasetFormat {\n  Doc = 0,\n  Table = 1,\n  Image = 2,\n  Database = 3,\n}\n\nconst formatSkills2Libraries = (\n  skillsDetail: GetLLMNodeFCSettingDetailResponse,\n  fcParam?: BoundSkills,\n): ILibraryList => {\n  const result: ILibraryList = [];\n\n  const plugins: ILibraryItem[] | undefined =\n    fcParam?.pluginFCParam?.pluginList?.map(item => {\n      const pluginDetail = skillsDetail?.plugin_detail_map?.[item.plugin_id];\n      const apiDetail = skillsDetail?.plugin_api_detail_map?.[item.api_id];\n\n      return {\n        type: 'plugin',\n        id: item.plugin_id,\n        icon_url: pluginDetail?.icon_url || '',\n        name: apiDetail?.name || '',\n        desc: apiDetail?.description || '',\n        api_id: apiDetail?.id,\n      };\n    });\n\n  const workflows: ILibraryItem[] | undefined =\n    fcParam?.workflowFCParam?.workflowList\n      ?.filter(item => {\n        const detail = skillsDetail?.workflow_detail_map?.[item.workflow_id];\n        return (\n          detail?.flow_mode === WorkflowMode.Workflow ||\n          detail?.flow_mode === WorkflowMode.ChatFlow\n        );\n      })\n      ?.map(item => {\n        const detail = skillsDetail?.workflow_detail_map?.[item.workflow_id];\n\n        return {\n          type: 'workflow',\n          id: item.workflow_id,\n          icon_url: detail?.icon_url || '',\n          name: detail?.name || '',\n          desc: detail?.description || '',\n        };\n      });\n\n  const imageflows: ILibraryItem[] | undefined =\n    fcParam?.workflowFCParam?.workflowList\n      ?.filter(item => {\n        const detail = skillsDetail?.workflow_detail_map?.[item.workflow_id];\n        return detail?.flow_mode === WorkflowMode.Imageflow;\n      })\n      ?.map(item => {\n        const detail = skillsDetail?.workflow_detail_map?.[item.workflow_id];\n\n        return {\n          type: 'imageflow',\n          id: item.workflow_id,\n          icon_url: detail?.icon_url || '',\n          name: detail?.name || '',\n          desc: detail?.description || '',\n        };\n      });\n\n  const genDatasetFilter =\n    (target: DatasetFormat) => (item: BoundKnowledgeItem) => {\n      const detail = skillsDetail?.dataset_detail_map?.[item.id];\n      return detail?.format_type === target;\n    };\n\n  const tables: ILibraryItem[] | undefined =\n    fcParam?.knowledgeFCParam?.knowledgeList\n      ?.filter(genDatasetFilter(DatasetFormat.Table))\n      ?.map(item => {\n        const detail = skillsDetail?.dataset_detail_map?.[item.id];\n\n        return {\n          type: 'table',\n          id: item.id,\n          icon_url: detail?.icon_url || '',\n          name: detail?.name || '',\n          desc: '',\n        };\n      });\n\n  const images: ILibraryItem[] | undefined =\n    fcParam?.knowledgeFCParam?.knowledgeList\n      ?.filter(genDatasetFilter(DatasetFormat.Image))\n      ?.map(item => {\n        const detail = skillsDetail?.dataset_detail_map?.[item.id];\n\n        return {\n          type: 'image',\n          id: item.id,\n          icon_url: detail?.icon_url || '',\n          name: detail?.name || '',\n          desc: '',\n        };\n      });\n\n  const docs: ILibraryItem[] | undefined =\n    fcParam?.knowledgeFCParam?.knowledgeList\n      ?.filter(genDatasetFilter(DatasetFormat.Doc))\n      ?.map(item => {\n        const detail = skillsDetail?.dataset_detail_map?.[item.id];\n\n        return {\n          type: 'text',\n          id: item.id,\n          icon_url: detail?.icon_url || '',\n          name: detail?.name || '',\n          desc: '',\n        };\n      });\n\n  if (plugins?.length) {\n    result.push({\n      type: 'plugin',\n      items: plugins,\n    });\n  }\n\n  if (workflows?.length) {\n    result.push({\n      type: 'workflow',\n      items: workflows,\n    });\n  }\n\n  if (imageflows?.length) {\n    result.push({\n      type: 'imageflow',\n      items: imageflows,\n    });\n  }\n\n  if (tables?.length) {\n    result.push({\n      type: 'table',\n      items: tables,\n    });\n  }\n\n  if (images?.length) {\n    result.push({\n      type: 'image',\n      items: images,\n    });\n  }\n\n  if (docs?.length) {\n    result.push({\n      type: 'text',\n      items: docs,\n    });\n  }\n\n  return result;\n};\n\nexport default function useSkillLibraries(props: Props) {\n  const { fcParam = {} } = props;\n\n  const globalState = useGlobalState();\n  const node = useCurrentEntity();\n\n  const { data: skillsDetail, refetch } = useQuerySettingDetail({\n    workflowId: globalState.workflowId,\n    spaceId: globalState.spaceId,\n    nodeId: node.id,\n    ...getSkillsQueryParams(fcParam),\n  });\n\n  const libraries = useMemo(\n    () =>\n      formatSkills2Libraries(\n        skillsDetail as GetLLMNodeFCSettingDetailResponse,\n        fcParam,\n      ),\n    [skillsDetail, fcParam],\n  );\n\n  return {\n    libraries,\n    refetch,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback } from 'react';\n\nimport { useForm, useRefresh } from '@flowgram-adapter/free-layout-editor';\nimport type { ILibraryItem } from '@coze-common/editor-plugins/library-insert';\nimport type { InputValueVO } from '@coze-workflow/base';\n\nimport { addSKillFromLibrary } from '@/nodes-v2/llm/utils';\n\nimport type { BoundSkills } from '../skills/types';\nimport {\n  SystemPrompt as DefaultSystemPrompt,\n  type SystemPromptProps,\n} from '../../components/system-prompt';\nimport useSkillLibraries from './use-skill-libraries';\n\ninterface Props extends Omit<SystemPromptProps, 'libraries'> {\n  inputParameters?: InputValueVO[];\n  fcParam?: BoundSkills;\n  placeholder?: string;\n}\n\nexport const SystemPrompt = (props: Props) => {\n  const { placeholder, inputParameters, fcParam, onAddLibrary, ...rest } =\n    props;\n\n  const form = useForm();\n  const refresh = useRefresh();\n\n  const { libraries, refetch } = useSkillLibraries({ fcParam });\n\n  const handleAddLibrary = useCallback(\n    (library: ILibraryItem) => {\n      form.setValueIn(\n        'fcParam',\n        addSKillFromLibrary(library, form.getValueIn('fcParam')),\n      );\n\n      refresh();\n\n      setTimeout(() => {\n        refetch();\n      }, 10);\n    },\n    [onAddLibrary],\n  );\n\n  return (\n    <DefaultSystemPrompt\n      {...rest}\n      onAddLibrary={handleAddLibrary}\n      libraries={libraries}\n      placeholder={placeholder}\n      inputParameters={inputParameters}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMutation } from '@tanstack/react-query';\nimport { workflowApi } from '@coze-workflow/base/api';\n\nimport { useGlobalState } from '@/hooks';\n\nimport {\n  type WorkflowFCSetting,\n  type KnowledgeGlobalSetting,\n  type PluginFCSetting,\n} from './types';\n\n// const mockSettings = {\n//           plugin_fc_setting: {\n//             request_params: [\n//               {\n//                 name: 'fieldName',\n//                 type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                 sub_type: 1,\n//                 location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                 is_required: false,\n//                 sub_parameters: [\n//                   {\n//                     name: 'fieldName',\n//                     type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                     sub_type: 1,\n//                     location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                     is_required: false,\n//                     local_default : '', // default\n//                     local_disable: false,//enabled\n//                     assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//                   },\n//                 ],\n//                 local_default : '', // default\n//                 local_disable: false,//enabled\n//                 assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//               },\n//             ],\n//             response_params: [\n//               {\n//                 name: 'fieldName',\n//                 type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                 sub_type: 1,\n//                 location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                 is_required: false,\n//                 sub_parameters: [\n//                   {\n//                     name: 'fieldName',\n//                     type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                     sub_type: 1,\n//                     location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                     is_required: false,\n//                     local_default : '', // default\n//                     local_disable: false,//enabled\n//                     assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//                   },\n//                 ],\n//                 local_default : '', // default\n//                 local_disable: false,//enabled\n//                 assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//               },\n//             ],\n//             response_style: {\n//               Mode: 1,//Raw = 0,//Raw Output Card = 1,//Render as Card Template = 2,//Template content containing variables, render TODO with jinja2\n//             },\n//           },\n//           workflow_fc_setting: {\n//             request_params: [\n//               {\n//                 name: 'fieldName',\n//                 type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                 sub_type: 1,\n//                 location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                 is_required: false,\n//                 sub_parameters: [\n//                   {\n//                     name: 'fieldName',\n//                     type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                     sub_type: 1,\n//                     location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                     is_required: false,\n//                     local_default : '', // default\n//                     local_disable: false,//enabled\n//                     assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//                   },\n//                 ],\n//                 local_default : '', // default\n//                 local_disable: false,//enabled\n//                 assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//               },\n//             ],\n//             response_params: [\n//               {\n//                 name: 'fieldName',\n//                 type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                 sub_type: 1,\n//                 location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                 is_required: false,\n//                 sub_parameters: [\n//                   {\n//                     name: 'fieldName',\n//                     type: 1, // String  = 1, Integer = 2, Number  = 3, Object  = 4, Array   = 5, Bool    = 6,\n//                     sub_type: 1,\n//                     location: 1, // Path   = 1, Query  = 2, Body   = 3, Header = 4,\n//                     is_required: false,\n//                     local_default : '', // default\n//                     local_disable: false,//enabled\n//                     assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//                   },\n//                 ],\n//                 local_default : '', // default\n//                 local_disable: false,//enabled\n//                 assist_type: 1, //DEFAULT = 1, IMAGE   = 2, DOC     = 3,CODE    = 4,PPT     = 5, TXT     = 6, EXCEL   = 7, AUDIO   = 8, ZIP     = 9,VIDEO   = 10,\n//               },\n//             ],\n//             response_style: {\n//               Mode: 1,//Raw = 0,//Raw Output Card = 1,//Render as Card Template = 2,//Template content containing variables, render TODO with jinja2\n//             },\n//           },\n//           dataset_fc_setting: {\n//             top_k: 5,//Recall Quantity\n//             min_score: 0.46,//minimum similarity threshold for recall\n//             Auto: true,//whether to recall automatically\n//             search_mode: 1,//search strategy\n//             no_recall_reply_mode: 1,//no recall reply mode, default 0\n//             no_recall_reply_customize_prompt:\n//               'Sorry, your question is beyond my knowledge and cannot be answered at this stage ',//Custom prompt when no recall reply, takes effect when NoRecallReplyMode = 1\n//             show_source: true,//whether to show the source\n//             show_source_mode: 1,//source display method, default value 0 card list method\n//           },\n//         }\n\nexport const useQueryLatestFCSettings = (params: { nodeId: string }) => {\n  const { workflowId, spaceId } = useGlobalState();\n\n  const mutation = useMutation({\n    mutationFn: (options: {\n      pluginFCSetting?: PluginFCSetting;\n      workflowFCSetting?: WorkflowFCSetting;\n      datasetFCSetting?: KnowledgeGlobalSetting;\n      // plugin_from?: PluginFrom;\n    }) =>\n      workflowApi.GetLLMNodeFCSettingsMerged({\n        workflow_id: workflowId,\n        space_id: spaceId,\n        plugin_fc_setting: options.pluginFCSetting,\n        workflow_fc_setting: options.workflowFCSetting,\n        // plugin_from: options.plugin_from,\n      }),\n    // return Promise.resolve({\n    //   data: mockSettings,\n    // });\n  });\n\n  return mutation;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC } from 'react';\n\nimport { cloneDeep, set } from 'lodash-es';\nimport { type WithCustomStyle } from '@coze-workflow/base/types';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tree, Tooltip } from '@coze-arch/bot-semi';\nimport { IconInfo } from '@coze-arch/bot-icons';\nimport { Form, Select, Switch } from '@coze-arch/coze-design';\n\nimport { VariableTypeTag } from '@/form-extensions/components/variable-type-tag';\n\nimport { type FCResponseParamsSetting, type PluginFCSetting } from './types';\nimport { TypeMap } from './constants';\n\nexport interface ResponseSettings {\n  response_params?: PluginFCSetting['response_params'];\n  response_style?: PluginFCSetting['response_style'];\n}\n\ninterface OutputParamsFormProps {\n  initValue?: ResponseSettings;\n  onChange: (value: ResponseSettings) => void;\n}\n\nexport const OutputParamsForm: FC<\n  WithCustomStyle<OutputParamsFormProps>\n> = props => {\n  const { initValue, onChange } = props;\n\n  const handleResponseModeChange = value => {\n    onChange?.({\n      ...initValue,\n      response_style: {\n        mode: value,\n      },\n    });\n  };\n\n  const handleParamEnableChange =\n    (indexPath: Array<number | string>, item: FCResponseParamsSetting) =>\n    (enable: boolean) => {\n      if (!initValue) {\n        return;\n      }\n\n      const newValue = cloneDeep(initValue);\n\n      set(newValue.response_params ?? [], indexPath.join('.'), {\n        ...item,\n        local_disable: !enable,\n      });\n\n      onChange?.(newValue);\n    };\n\n  const normalizeTreeData = (\n    responseParams: PluginFCSetting['response_params'],\n    indexPath: Array<number | string> = [],\n  ) =>\n    responseParams?.map((item, index) => {\n      const currentIndexPath = [...indexPath, index];\n\n      return {\n        label: (\n          <div className=\"flex items-center text-xs\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center\">\n                <div className=\"font-medium\">{item.name}</div>\n                <div>\n                  <VariableTypeTag>\n                    {TypeMap.get(item.type as number)}\n                  </VariableTypeTag>\n                </div>\n              </div>\n              {item.desc ? <div className=\"coz-fg-dim\">{item.desc}</div> : null}\n            </div>\n            <div\n              style={{\n                flex: '0 0 60px',\n              }}\n            >\n              <Switch\n                size=\"mini\"\n                checked={item.local_disable === true ? false : true}\n                onChange={handleParamEnableChange(currentIndexPath, item)}\n              />\n            </div>\n          </div>\n        ),\n        value: item.name,\n        key: currentIndexPath.join('-'),\n        children: item.sub_parameters\n          ? normalizeTreeData(item.sub_parameters, [\n              ...currentIndexPath,\n              'sub_parameters',\n            ])\n          : null,\n      };\n    });\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      <>\n        <div>\n          <Form.Label text={I18n.t('skillset_241115_01')} />\n        </div>\n        <Select\n          className=\"mb-4\"\n          defaultValue={initValue?.response_style?.mode}\n          disabled\n          optionList={[\n            {\n              label: I18n.t('skillset_241115_02'),\n              value: 1,\n            },\n            {\n              label: I18n.t('skillset_241115_03'),\n              value: 0,\n            },\n          ]}\n          onChange={handleResponseModeChange}\n        />\n      </>\n      <>\n        <div>\n          <Form.Label text={I18n.t('workflow_detail_end_output')} />\n        </div>\n        <div className=\"text-xs text-left coz-fg-secondary coz-mg-hglt py-2 px-3 rounded-lg\">\n          {I18n.t('plugin_bot_ide_plugin_setting_modal_item_enable_tip')}\n        </div>\n        <div className=\"flex text-xs coz-fg-dim font-medium mt-3\">\n          <div className=\"flex-1 pl-[26px]\">\n            {I18n.t('Create_newtool_s3_table_name')}\n          </div>\n          <div\n            style={{\n              flex: '0 0 60px',\n            }}\n          >\n            {I18n.t('plugin_edit_tool_default_value_config_item_enable')}\n            <Tooltip content={I18n.t('plugin_bot_ide_output_param_enable_tip')}>\n              <IconInfo className=\"relative left-[2px] top-[3px]\" />\n            </Tooltip>\n          </div>\n        </div>\n        <div className=\"flex-1 overflow-y-auto\">\n          <Tree\n            treeData={normalizeTreeData(initValue?.response_params)}\n            defaultExpandAll\n          />\n        </div>\n      </>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type RefObject } from 'react';\n\nimport { type WithCustomStyle } from '@coze-workflow/base/types';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/bot-semi';\nimport { IconInfo } from '@coze-arch/bot-icons';\nimport { Input, Switch, Table, Tag } from '@coze-arch/coze-design';\n\nimport { VariableTypeTag } from '@/form-extensions/components/variable-type-tag';\n\nimport { useTableScroll } from './use-table-scroll';\nimport { type FCRequestParamsSetting, type PluginFCSetting } from './types';\nimport { TypeMap } from './constants';\n\ninterface InputParamsFormProps {\n  initValue?: PluginFCSetting['request_params'];\n  onChange: (value: PluginFCSetting['request_params']) => void;\n}\n\nconst GAP = 55;\n\nexport const InputParamsForm: FC<\n  WithCustomStyle<InputParamsFormProps>\n> = props => {\n  const { initValue = [], onChange } = props;\n  const { containerRef, scroll } = useTableScroll(GAP);\n\n  const handleDefaultValueChange = index => (value: string) => {\n    onChange?.(\n      initValue.map((item, _index) => {\n        if (_index === index) {\n          return {\n            ...item,\n            local_default: value,\n          };\n        } else {\n          return item;\n        }\n      }),\n    );\n  };\n\n  const handleEnableChange = index => (checked: boolean) => {\n    onChange?.(\n      initValue.map((item, _index) => {\n        if (_index === index) {\n          return {\n            ...item,\n            local_disable: !checked,\n          };\n        } else {\n          return item;\n        }\n      }),\n    );\n  };\n\n  return (\n    <div ref={containerRef as RefObject<HTMLDivElement>} className=\"h-full\">\n      <Table\n        tableProps={{\n          dataSource: initValue,\n          scroll,\n          columns: [\n            {\n              title: I18n.t('Create_newtool_s3_table_name'),\n              dataIndex: 'name',\n              width: 300,\n              render: (text, record: FCRequestParamsSetting, index) => (\n                <div>\n                  <div className=\"flex items-center gap-2\">\n                    <div>{record.name}</div>\n                    <VariableTypeTag>\n                      {TypeMap.get(record.type as number)}\n                    </VariableTypeTag>\n                    {record.is_required ? (\n                      <Tag color=\"red\" size=\"mini\">\n                        {I18n.t('required')}\n                      </Tag>\n                    ) : null}\n                  </div>\n                  <div className=\"coz-fg-dim font-normal leading-4\">\n                    {record.desc}\n                  </div>\n                </div>\n              ),\n            },\n            {\n              title: I18n.t(\n                'plugin_edit_tool_default_value_config_item_default_value',\n              ),\n              dataIndex: 'defaultValue',\n              width: 160,\n              render: (text, record: FCRequestParamsSetting, index) => (\n                <Input\n                  size=\"small\"\n                  defaultValue={record.local_default}\n                  onChange={handleDefaultValueChange(index)}\n                />\n              ),\n            },\n            {\n              title: () => (\n                <div>\n                  {I18n.t('plugin_edit_tool_default_value_config_item_enable')}\n                  <Tooltip\n                    content={I18n.t(\n                      'plugin_bot_ide_plugin_setting_modal_item_enable_tip',\n                    )}\n                  >\n                    <IconInfo className=\"relative left-[2px] top-[2px]\" />\n                  </Tooltip>\n                </div>\n              ),\n              dataIndex: 'enable',\n              render: (text, record: FCRequestParamsSetting, index) => (\n                <Switch\n                  size=\"mini\"\n                  checked={record.local_disable === false ? true : false}\n                  onChange={handleEnableChange(index)}\n                />\n              ),\n            },\n          ],\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useRef } from 'react';\n\nimport { useSize } from 'ahooks';\n\nexport function useTableScroll(gap: number) {\n  const containerRef = useRef<HTMLElement>(null);\n\n  const size = useSize(containerRef);\n  const scroll = useMemo(\n    () => ({ y: size?.height ? size.height - gap : 0 }),\n    [size, gap],\n  );\n\n  return {\n    containerRef,\n    scroll,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport classnames from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  Button,\n  Modal,\n  Nav,\n  NavItem,\n  Typography,\n} from '@coze-arch/coze-design';\n\nimport { type PluginFCSetting } from './types';\nimport { OutputParamsForm, type ResponseSettings } from './output-params-form';\nimport { InputParamsForm } from './input-params-form';\n\nimport styles from './plugin-setting-form-modal.module.less';\n\ninterface PluginSettingFormModalProps {\n  visible: boolean;\n  setting?: PluginFCSetting;\n  onSubmit?: (setting?: PluginFCSetting) => void;\n  onCancel: () => void;\n}\n\nenum SettingNavKey {\n  Input = 'input',\n  Output = 'output',\n}\n\nexport const PluginSettingFormModal: FC<\n  PluginSettingFormModalProps\n> = props => {\n  const { visible, setting: originSetting, onSubmit, onCancel } = props;\n  const [activeKey, setActiveKey] = useState(SettingNavKey.Input);\n  const [setting, updateSetting] = useState<PluginFCSetting | undefined>(\n    originSetting,\n  );\n\n  const handleParamsChange =\n    (key: keyof PluginFCSetting) =>\n    (settingParams: PluginFCSetting[keyof PluginFCSetting]) => {\n      updateSetting({\n        ...setting,\n        [key]: settingParams,\n      });\n    };\n\n  const handleResponseParamsChange = (responseSettings: ResponseSettings) => {\n    updateSetting({\n      ...setting,\n      ...responseSettings,\n    });\n  };\n\n  const handleSubmit = () => {\n    onSubmit?.(setting);\n  };\n\n  return (\n    <Modal\n      className={styles['plugin-setting-form-modal']}\n      size=\"xl\"\n      visible={visible}\n      onCancel={onCancel}\n      bodyStyle={{\n        padding: 0,\n      }}\n      height={700}\n      footer={\n        <div className=\"pt-0 flex\">\n          <div\n            className=\"coz-bg-primary p-4\"\n            style={{\n              flex: '0 0 220px',\n            }}\n          ></div>\n          <div className=\"flex-1 pb-4 pr-4\">\n            <Button color=\"hgltplus\" onClick={handleSubmit}>\n              {I18n.t('Save')}\n            </Button>\n          </div>\n        </div>\n      }\n    >\n      <div className=\"flex h-full\">\n        <div\n          className=\"coz-bg-primary p-4\"\n          style={{\n            flex: '0 0 220px',\n          }}\n        >\n          <Typography.Title heading={4} className=\"!mb-4 px-2\">\n            {I18n.t('basic_setting')}\n          </Typography.Title>\n          <Nav\n            className={styles['plugin-setting-nav']}\n            selectedKeys={[activeKey]}\n            onSelect={({ itemKey }) => setActiveKey(itemKey as SettingNavKey)}\n          >\n            <NavItem\n              itemKey={SettingNavKey.Input}\n              text={I18n.t('Create_newtool_s2_title')}\n            ></NavItem>\n            <NavItem\n              itemKey={SettingNavKey.Output}\n              text={I18n.t('Create_newtool_s3_Outputparameters')}\n            ></NavItem>\n          </Nav>\n        </div>\n        <div className=\"flex-1 px-4 pt-[50px] relative h-full overflow-y-hidden\">\n          <div\n            className={classnames(\n              {\n                hidden: activeKey !== SettingNavKey.Input,\n                block: activeKey === SettingNavKey.Input,\n              },\n              'h-full',\n            )}\n          >\n            <InputParamsForm\n              initValue={setting?.request_params}\n              onChange={handleParamsChange('request_params')}\n            />\n          </div>\n          <div\n            className={classnames(\n              {\n                hidden: activeKey !== SettingNavKey.Output,\n                block: activeKey === SettingNavKey.Output,\n              },\n              'h-full',\n            )}\n          >\n            <OutputParamsForm\n              initValue={{\n                response_params: setting?.response_params,\n                response_style: setting?.response_style,\n              }}\n              onChange={handleResponseParamsChange}\n            />\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozSetting } from '@coze-arch/coze-design/icons';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { useQueryLatestFCSettings } from './use-query-latest-fc-settings';\nimport { type BoundWorkflowItem, type PluginFCSetting } from './types';\nimport { TooltipAction } from './tooltip-action';\nimport { PluginSettingFormModal } from './plugin-setting-form-modal';\nimport { defaultResponseStyleMode } from './constants';\n\ninterface WorkflowSettingProps extends BoundWorkflowItem {\n  setting?: PluginFCSetting;\n  onChange?: (setting?: PluginFCSetting) => void;\n}\n\nexport const WorkflowSetting: FC<WorkflowSettingProps> = props => {\n  const { setting, onChange } = props;\n  const node = useCurrentEntity();\n  const mutation = useQueryLatestFCSettings({\n    nodeId: node.id,\n  });\n  const [latestSetting, setLatestSetting] = useState<\n    PluginFCSetting | undefined\n  >(undefined);\n  const [visible, setVisible] = useState(false);\n\n  const handleEdit = () => {\n    mutation.mutate(\n      {\n        workflowFCSetting: setting\n          ? {\n              workflow_id: props.workflow_id,\n              plugin_id: props.plugin_id,\n              is_draft: props.is_draft,\n              workflow_version: props.workflow_version,\n              ...setting,\n            }\n          : {\n              workflow_id: props.workflow_id,\n              plugin_id: props.plugin_id,\n              request_params: [],\n              response_params: [],\n              workflow_version: props.workflow_version,\n              response_style: {\n                mode: defaultResponseStyleMode,\n              },\n            },\n      },\n      {\n        onSuccess: res => {\n          setLatestSetting(res?.worflow_fc_setting);\n          setVisible(true);\n        },\n      },\n    );\n  };\n\n  const handleSubmit = (newSetting?: PluginFCSetting) => {\n    onChange?.(newSetting);\n    setVisible(false);\n  };\n\n  return (\n    <>\n      <TooltipAction\n        tooltip={I18n.t('plugin_bot_ide_plugin_setting_icon_tip')}\n        icon={<IconCozSetting />}\n        onClick={handleEdit}\n      />\n      {visible ? (\n        <PluginSettingFormModal\n          visible={visible}\n          setting={latestSetting}\n          onSubmit={handleSubmit}\n          onCancel={() => setVisible(false)}\n        />\n      ) : null}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozSetting } from '@coze-arch/coze-design/icons';\n\nimport { useQueryLatestFCSettings } from './use-query-latest-fc-settings';\nimport { type BoundPluginItem, type PluginFCSetting } from './types';\nimport { TooltipAction } from './tooltip-action';\nimport { PluginSettingFormModal } from './plugin-setting-form-modal';\nimport { defaultResponseStyleMode } from './constants';\n\ninterface PluginSettingProps extends BoundPluginItem {\n  setting?: PluginFCSetting;\n  onChange?: (setting?: PluginFCSetting) => void;\n}\n\nexport const PluginSetting: FC<PluginSettingProps> = props => {\n  const { setting, onChange } = props;\n  const node = useCurrentEntity();\n  const mutation = useQueryLatestFCSettings({\n    nodeId: node.id,\n  });\n  const [latestSetting, setLatestSetting] = useState<\n    PluginFCSetting | undefined\n  >(undefined);\n  const [visible, setVisible] = useState(false);\n\n  const handleEdit = () => {\n    mutation.mutate(\n      {\n        pluginFCSetting: setting\n          ? {\n              plugin_id: props.plugin_id,\n              api_id: props.api_id,\n              api_name: props.api_name,\n              is_draft: props.is_draft,\n              plugin_version: props.plugin_version,\n              plugin_from: props.plugin_from,\n              ...setting,\n            }\n          : {\n              plugin_id: props.plugin_id,\n              api_id: props.api_id,\n              api_name: props.api_name,\n              request_params: [],\n              response_params: [],\n              plugin_from: props.plugin_from,\n              response_style: {\n                mode: defaultResponseStyleMode,\n              },\n              is_draft: props.is_draft,\n              plugin_version: props.plugin_version,\n            },\n      },\n      {\n        onSuccess: res => {\n          setLatestSetting(res?.plugin_fc_setting);\n          setVisible(true);\n        },\n      },\n    );\n  };\n\n  const handleSubmit = (newSetting?: PluginFCSetting) => {\n    onChange?.(newSetting);\n    setVisible(false);\n  };\n\n  return (\n    <>\n      <TooltipAction\n        tooltip={I18n.t('plugin_bot_ide_plugin_setting_icon_tip')}\n        icon={<IconCozSetting />}\n        onClick={handleEdit}\n      />\n      {visible ? (\n        <PluginSettingFormModal\n          visible={visible}\n          setting={latestSetting}\n          onSubmit={handleSubmit}\n          onCancel={() => setVisible(false)}\n        />\n      ) : null}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { omit } from 'lodash-es';\nimport {\n  RagModeConfiguration,\n  type IDataSetInfo,\n} from '@coze-data/knowledge-modal-base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Button, Modal } from '@coze-arch/coze-design';\n\nimport { type KnowledgeGlobalSetting } from './types';\nimport { defaultKnowledgeGlobalSetting } from './constants';\n\nimport styles from './knowledge-setting-form-modal.module.less';\n\ninterface KnowledgeSettingFormModalProps {\n  visible: boolean;\n  setting?: KnowledgeGlobalSetting;\n  onSubmit?: (setting?: KnowledgeGlobalSetting) => void;\n  onCancel: () => void;\n}\n\nexport const KnowledgeSettingFormModal: FC<\n  KnowledgeSettingFormModalProps\n> = props => {\n  const { visible, onSubmit } = props;\n  const [setting, updateSetting] = useState<KnowledgeGlobalSetting | undefined>(\n    props.setting ?? defaultKnowledgeGlobalSetting,\n  );\n\n  const handleSubmit = () => {\n    onSubmit?.(setting);\n  };\n\n  const handleOnChange = (newSetting: IDataSetInfo) => {\n    updateSetting({\n      use_rerank: newSetting.recall_strategy?.use_rerank ?? true,\n      use_rewrite: newSetting.recall_strategy?.use_rewrite ?? true,\n      use_nl2_sql: newSetting.recall_strategy?.use_nl2sql ?? true,\n      ...omit(newSetting, ['recall_strategy']),\n    });\n  };\n\n  const getDataSetInfo = (value: KnowledgeGlobalSetting): IDataSetInfo => ({\n    recall_strategy: {\n      use_rerank: value.use_rerank ?? true,\n      use_rewrite: value.use_rewrite ?? true,\n      use_nl2sql: value.use_nl2_sql ?? true,\n    },\n    ...omit(value, ['use_rerank', 'use_rewrite', 'use_nl2_sql']),\n  });\n\n  return (\n    <Modal\n      size=\"large\"\n      height={700}\n      visible={visible}\n      onCancel={props.onCancel}\n      title={I18n.t('dataset_settings_title')}\n      footer={\n        <div>\n          <Button color=\"hgltplus\" onClick={handleSubmit}>\n            {I18n.t('Save')}\n          </Button>\n        </div>\n      }\n    >\n      <div className={styles['rag-mode-config-wrapper']}>\n        <RagModeConfiguration\n          dataSetInfo={getDataSetInfo(setting as KnowledgeGlobalSetting)}\n          showTitle={false}\n          onDataSetInfoChange={handleOnChange}\n          showAuto={false}\n          showSourceDisplay={false}\n          showNL2SQLConfig\n        />\n      </div>\n    </Modal>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozSetting } from '@coze-arch/coze-design/icons';\n\nimport { type KnowledgeGlobalSetting } from './types';\nimport { TooltipAction } from './tooltip-action';\nimport { KnowledgeSettingFormModal } from './knowledge-setting-form-modal';\n\ninterface KnowledgeSettingProps {\n  setting?: KnowledgeGlobalSetting;\n  onChange?: (setting?: KnowledgeGlobalSetting) => void;\n}\n\nexport const KnowledgeSetting: FC<KnowledgeSettingProps> = props => {\n  const { setting, onChange } = props;\n  const [visible, setVisible] = useState(false);\n\n  const handleSubmit = (newSetting?: KnowledgeGlobalSetting) => {\n    onChange?.(newSetting);\n    setVisible(false);\n  };\n\n  return (\n    <>\n      <TooltipAction\n        tooltip={I18n.t('plugin_bot_ide_plugin_setting_icon_tip')}\n        icon={<IconCozSetting />}\n        onClick={() => setVisible(true)}\n      />\n      <KnowledgeSettingFormModal\n        visible={visible}\n        setting={setting}\n        onSubmit={handleSubmit}\n        onCancel={() => setVisible(false)}\n      />\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozEmpty } from '@coze-arch/coze-design/icons';\nimport { EmptyState } from '@coze-arch/coze-design';\n\nexport function EmptySkill() {\n  return (\n    <div className=\"flex justify-center pt-[13px] pb-[3px]\">\n      <EmptyState\n        icon={<IconCozEmpty />}\n        size=\"default\"\n        title={I18n.t('wf_chatflow_155')}\n      ></EmptyState>\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, type ReactNode } from 'react';\n\nimport copy from 'copy-to-clipboard';\nimport { type APIParameter } from '@coze-workflow/base/api';\nimport { REPORT_EVENTS as ReportEventNames } from '@coze-arch/report-events';\nimport { I18n } from '@coze-arch/i18n';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { IconCozCopy, IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tag, Toast } from '@coze-arch/coze-design';\n\nimport { VariableTypeTag } from '@/form-extensions/components/variable-type-tag';\nimport { IconNameDescCard } from '@/form-extensions/components/icon-name-desc-card';\n\nimport { TooltipAction } from './tooltip-action';\nimport { TypeMap } from './constants';\n\ninterface BoundItemCardProps {\n  iconUrl?: string;\n  title: string;\n  pasteTitle?: string;\n  params?: Array<APIParameter>;\n  description?: ReactNode;\n  settingRender: ReactNode;\n  versionRender?: ReactNode;\n  onRemove?: () => void;\n  readonly?: boolean;\n  hideActions?: boolean;\n  className?: string;\n}\n\nexport const BoundItemCard: FC<BoundItemCardProps> = props => {\n  const {\n    title,\n    pasteTitle,\n    iconUrl,\n    description,\n    onRemove,\n    settingRender,\n    versionRender,\n    params,\n    readonly,\n    hideActions,\n    className,\n  } = props;\n\n  const handleCopy = () => {\n    try {\n      const res = copy(pasteTitle ?? title);\n      if (!res) {\n        throw new CustomError(ReportEventNames.copy, 'empty content');\n      }\n\n      Toast.success({\n        content: I18n.t('copy_success'),\n        showClose: false,\n        id: 'plugin_copy_id',\n      });\n    } catch {\n      Toast.warning({\n        content: I18n.t('copy_failed'),\n        showClose: false,\n      });\n    }\n  };\n\n  const actions = (\n    <>\n      {params ? (\n        <TooltipAction\n          tooltip={params.map(param => (\n            <div className=\"mb-3\">\n              <div className=\"flex items-center mb-2 gap-1\">\n                {param.name}\n                {TypeMap.get(param.type as number) ? (\n                  <VariableTypeTag size=\"xs\">\n                    {TypeMap.get(param.type as number)}\n                  </VariableTypeTag>\n                ) : null}\n                {param.is_required ? (\n                  <Tag size=\"mini\" color=\"yellow\">\n                    {I18n.t('required')}\n                  </Tag>\n                ) : null}\n              </div>\n              <div className=\"font-normal coz-fg-secondary leading-4\">\n                {param.desc}\n              </div>\n            </div>\n          ))}\n          icon={<IconCozInfoCircle />}\n        />\n      ) : null}\n\n      <TooltipAction\n        tooltip={I18n.t('bot_edit_page_plugin_copy_tool_name_tip')}\n        icon={<IconCozCopy />}\n        onClick={handleCopy}\n      />\n      {settingRender}\n    </>\n  );\n\n  return (\n    <IconNameDescCard\n      icon={iconUrl}\n      name={title}\n      description={description as string}\n      onRemove={onRemove}\n      actions={hideActions ? [] : actions}\n      nameSuffix={versionRender}\n      readonly={readonly}\n      className={className}\n      descriptionTooltipPosition=\"bottom\"\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useRef, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { ModalI18nKey } from '@coze-workflow/components/workflow-modal';\nimport {\n  WorkflowModalFrom,\n  useWorkflowModalParts,\n} from '@coze-workflow/components';\nimport { KnowledgeListModalContent } from '@coze-data/knowledge-modal-adapter';\nimport { I18n } from '@coze-arch/i18n';\nimport { UITabsModal } from '@coze-arch/bot-semi';\nimport { type Dataset } from '@coze-arch/bot-api/knowledge';\nimport { From } from '@coze-agent-ide/plugin-shared';\nimport { usePluginModalParts } from '@coze-agent-ide/bot-plugin-export/agentSkillPluginModal/hooks';\n\nimport { useGlobalState, useSpaceId, useNodeVersionService } from '@/hooks';\n\nimport { isDraftByProjectId } from './utils';\nimport {\n  SkillType,\n  type BoundSkills,\n  type BoundWorkflowItem,\n  type BoundPluginItem,\n  type BoundKnowledgeItem,\n} from './types';\nimport {\n  SkillKnowledgeSider,\n  SkillKnowledgeSiderCategory,\n} from './skill-knowledge-sider';\n\nimport s from './skill-modal.module.less';\n\nexport interface SkillModalProps {\n  visible: boolean;\n  onSkillsChange: (\n    type: SkillType,\n    data:\n      | Array<BoundWorkflowItem>\n      | Array<BoundPluginItem>\n      | Array<BoundKnowledgeItem>,\n  ) => void;\n  boundSkills?: BoundSkills;\n  onCancel: () => void;\n}\n\nexport const SkillModal: FC<SkillModalProps> = props => {\n  const { visible, onSkillsChange, boundSkills, onCancel } = props;\n\n  const { projectId, getProjectApi, playgroundProps } = useGlobalState();\n  const windowRef = useRef<WindowProxy | null>();\n  const spaceID = useSpaceId();\n\n  const nodeVersionService = useNodeVersionService();\n  const [category, setCategory] = useState<SkillKnowledgeSiderCategory>(\n    SkillKnowledgeSiderCategory.Library,\n  );\n\n  // Plugin Add pop-up window\n  const pluginModalFrom = projectId\n    ? From.ProjectWorkflow\n    : From.WorkflowAddNode;\n\n  const getOnSkillsChange = (type: SkillType) => data =>\n    onSkillsChange(type, data);\n\n  const [activeKey, setActiveKey] = useState<SkillType>(SkillType.Plugin);\n  const pluginModalParts = usePluginModalParts({\n    pluginApiList: boundSkills?.pluginFCParam?.pluginList ?? [],\n    onPluginApiListChange: getOnSkillsChange(SkillType.Plugin),\n    from: pluginModalFrom,\n    projectId,\n    openModeCallback: async val => {\n      if (!val) {\n        return;\n      }\n      if (\n        !(await nodeVersionService.addApiCheck(val.plugin_id, val.version_ts))\n      ) {\n        return;\n      }\n      onSkillsChange(SkillType.Plugin, [\n        ...(boundSkills?.pluginFCParam?.pluginList ?? []),\n        {\n          plugin_id: val.plugin_id as string,\n          api_id: val.api_id as string,\n          api_name: val.name as string,\n          plugin_version: val.version_ts || '',\n          is_draft: isDraftByProjectId(val.project_id),\n          plugin_from: val.plugin_from,\n        },\n      ]);\n    },\n  });\n\n  const sourceTitle = I18n.t('workflow_241119_01');\n  const workflowModalParts = useWorkflowModalParts({\n    from: projectId\n      ? WorkflowModalFrom.ProjectWorkflowAddNode\n      : WorkflowModalFrom.WorkflowAddNode,\n    projectId,\n    workFlowList: (boundSkills?.workflowFCParam?.workflowList ?? []).map(\n      item => ({\n        workflow_id: item.workflow_id,\n        plugin_id: item.plugin_id,\n        name: '',\n        desc: '',\n        parameters: [],\n        plugin_icon: '',\n      }),\n    ),\n    onWorkFlowListChange: () => null,\n    onAdd: async (val, config) => {\n      if (!val) {\n        return;\n      }\n      if (\n        !(await nodeVersionService.addSubWorkflowCheck(\n          val.workflow_id,\n          val.version_name,\n        ))\n      ) {\n        return;\n      }\n      onSkillsChange(SkillType.Workflow, [\n        ...(boundSkills?.workflowFCParam?.workflowList ?? []),\n        {\n          plugin_id: val.plugin_id,\n          workflow_id: val.workflow_id,\n          plugin_version: '',\n          workflow_version: val.version_name || '',\n          is_draft: isDraftByProjectId(val.project_id),\n        },\n      ]);\n    },\n    onRemove: val => {\n      onSkillsChange(\n        SkillType.Workflow,\n        (boundSkills?.workflowFCParam?.workflowList ?? []).filter(\n          item => item.workflow_id !== val.workflow_id,\n        ),\n      );\n    },\n    i18nMap: {\n      [ModalI18nKey.ListItemRemove]: {\n        key: 'scene_workflow_delete_workflow_button',\n        options: { source: sourceTitle },\n      },\n      [ModalI18nKey.ListItemRemoveConfirmTitle]: {\n        key: 'scene_workflow_delete_workflow_popup_title',\n        options: { source: sourceTitle },\n      },\n      [ModalI18nKey.ListItemRemoveConfirmDescription]: {\n        key: 'scene_workflow_delete_workflow_popup_subtitle',\n        options: { source: sourceTitle },\n      },\n    },\n  });\n\n  const handleKnowledgeListChange = (data: Dataset[]) => {\n    onSkillsChange(\n      SkillType.Knowledge,\n      data?.map(item => ({\n        id: item.dataset_id as string,\n        name: item.name as string,\n      })),\n    );\n  };\n\n  return (\n    <UITabsModal\n      visible={visible}\n      onCancel={onCancel}\n      tabs={{\n        tabsProps: {\n          lazyRender: true,\n          activeKey,\n          onChange: (key: string) => setActiveKey(key as SkillType),\n        },\n        tabPanes: [\n          {\n            tabPaneProps: {\n              tab: I18n.t('Tools'),\n              itemKey: SkillType.Plugin,\n            },\n            content: (\n              <div className={s.main}>\n                <div className={s.sider}>{pluginModalParts.sider}</div>\n                <div className={s.content}>\n                  <div className={s.filter}>{pluginModalParts.filter}</div>\n                  <div className={s['content-inner']}>\n                    {pluginModalParts.content}\n                  </div>\n                </div>\n              </div>\n            ),\n          },\n          {\n            tabPaneProps: {\n              tab: I18n.t('Workflow'),\n              itemKey: SkillType.Workflow,\n            },\n            content: (\n              <div className={s.main}>\n                <div className={s.sider}>{workflowModalParts.sider}</div>\n                <div className={s.content}>\n                  <div className={s.filter}>{workflowModalParts.filter}</div>\n                  <div className={s['content-inner']}>\n                    {workflowModalParts.content}\n                  </div>\n                </div>\n              </div>\n            ),\n          },\n          {\n            tabPaneProps: {\n              tab: I18n.t('Datasets'),\n              itemKey: SkillType.Knowledge,\n            },\n            content: (\n              <div className={s.main}>\n                {projectId ? (\n                  <div className={s.sider}>\n                    <SkillKnowledgeSider\n                      projectId={projectId}\n                      category={category}\n                      setCategory={setCategory}\n                    />\n                  </div>\n                ) : null}\n\n                <div className={classNames(s.content, s['data-sets-content'])}>\n                  <div className={s['content-inner']}>\n                    <KnowledgeListModalContent\n                      projectID={\n                        category === SkillKnowledgeSiderCategory.Project\n                          ? projectId\n                          : undefined\n                      }\n                      datasetList={(\n                        boundSkills?.knowledgeFCParam?.knowledgeList ?? []\n                      ).map(item => ({\n                        dataset_id: item.id,\n                        name: item.name,\n                      }))}\n                      onDatasetListChange={handleKnowledgeListChange}\n                      beforeCreate={shouldUpload => {\n                        if (shouldUpload && !projectId) {\n                          windowRef.current = window.open();\n                        }\n                      }}\n                      onClickAddKnowledge={(id, unitType, shouldUpload) => {\n                        if (shouldUpload) {\n                          if (projectId) {\n                            const IDENav = getProjectApi()?.navigate;\n                            IDENav?.(\n                              `/knowledge/${id}?module=upload&type=${unitType}`,\n                            );\n                          } else if (windowRef.current) {\n                            if (id) {\n                              windowRef.current.location = `/space/${spaceID}/knowledge/${id}/upload?type=${unitType}`;\n                            } else {\n                              windowRef.current.close();\n                            }\n                          }\n                        }\n                        if (projectId) {\n                          playgroundProps.refetchProjectResourceList?.();\n                        }\n                      }}\n                    />\n                  </div>\n                </div>\n              </div>\n            ),\n          },\n        ],\n      }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useState } from 'react';\n\nimport { AddIcon } from '@/nodes-v2/components/add-icon';\n\nimport { SkillModal, type SkillModalProps } from './skill-modal';\n\nexport const AddSkill: FC<\n  Omit<SkillModalProps, 'visible' | 'onCancel'> & {\n    disabledTooltip?: string;\n  }\n> = props => {\n  const [modalVisible, setModalVisible] = useState(false);\n\n  const handleOpenModal = e => {\n    e.stopPropagation();\n    setModalVisible(true);\n  };\n  const handleCloseModal = () => setModalVisible(false);\n\n  return (\n    <div\n      onClick={e => {\n        e.stopPropagation();\n      }}\n    >\n      <AddIcon\n        disabledTooltip={props.disabledTooltip}\n        onClick={handleOpenModal}\n      />\n\n      <SkillModal\n        visible={modalVisible}\n        onCancel={handleCloseModal}\n        {...props}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport { type FC } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tag, Tooltip } from '@coze-arch/coze-design';\nimport { useCurrentEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { useGlobalState } from '@/hooks';\nimport { FormCard } from '@/form-extensions/components/form-card';\n\nimport {\n  SubWorkflowSkillVersion,\n  ApiSkillVersion,\n} from '../../../components/reference-node-info';\nimport { WorkflowSetting } from './workflow-setting';\nimport { isSkillsEmpty, getSkillsQueryParams } from './utils';\nimport { useQuerySettingDetail } from './use-query-setting-detail';\nimport { useModelSkillDisabled } from './use-model-skill-disabled';\nimport {\n  SkillType,\n  type BoundSkills,\n  type BoundWorkflowItem,\n  type BoundPluginItem,\n  type BoundKnowledgeItem,\n  type PluginFCSetting,\n  type KnowledgeGlobalSetting,\n} from './types';\nimport { PluginSetting } from './plugin-setting';\nimport { KnowledgeSetting } from './knowledge-setting';\nimport { EmptySkill } from './empty-skill';\nimport { defaultKnowledgeGlobalSetting } from './constants';\nimport { BoundItemCard } from './bound-item-card';\nimport { AddSkill } from './add-skill';\n\ninterface SkillsProps {\n  value?: BoundSkills;\n  onChange?: (data: BoundSkills) => void;\n}\n\nexport const Skills: FC<SkillsProps> = props => {\n  const { value = {}, onChange } = props;\n  const isEmpty = isSkillsEmpty(value);\n  const globalState = useGlobalState();\n  const node = useCurrentEntity();\n  const readonly = useReadonly();\n  const modelSkillDisabled = useModelSkillDisabled();\n  const disabledTooltip = modelSkillDisabled\n    ? I18n.t('workflow_250310_03', undefined, '')\n    : '';\n\n  const { data: skillsDetail, refetch } = useQuerySettingDetail({\n    workflowId: globalState.workflowId,\n    spaceId: globalState.spaceId,\n    nodeId: node.id,\n    ...getSkillsQueryParams(value),\n  });\n\n  const handleSkillsChange = (\n    type: SkillType,\n    data:\n      | Array<BoundWorkflowItem>\n      | Array<BoundPluginItem>\n      | Array<BoundKnowledgeItem>,\n  ) => {\n    if (type === SkillType.Plugin) {\n      onChange?.({\n        ...value,\n        pluginFCParam: {\n          pluginList: data as Array<BoundPluginItem>,\n        },\n      });\n    } else if (type === SkillType.Workflow) {\n      onChange?.({\n        ...value,\n        workflowFCParam: {\n          workflowList: data as Array<BoundWorkflowItem>,\n        },\n      });\n    } else if (type === SkillType.Knowledge) {\n      onChange?.({\n        ...value,\n        knowledgeFCParam: {\n          ...value.knowledgeFCParam,\n          knowledgeList: data as Array<BoundKnowledgeItem>,\n          global_setting:\n            value.knowledgeFCParam?.global_setting ??\n            defaultKnowledgeGlobalSetting,\n        },\n      });\n    }\n\n    // The onChange value passing of the form is asynchronous, so there is a delay here\n    setTimeout(() => {\n      refetch();\n    }, 10);\n  };\n\n  const handleRemovePlugin = (plugin: BoundPluginItem) => () => {\n    onChange?.({\n      ...value,\n      pluginFCParam: {\n        pluginList: value?.pluginFCParam?.pluginList?.filter(\n          item => item.api_id !== plugin.api_id,\n        ),\n      },\n    });\n  };\n\n  const handleRemoveWorkflow = (workflow: BoundWorkflowItem) => () => {\n    onChange?.({\n      ...value,\n      workflowFCParam: {\n        workflowList: value?.workflowFCParam?.workflowList?.filter(\n          item => item.workflow_id !== workflow.workflow_id,\n        ),\n      },\n    });\n  };\n\n  const handleRemoveKnowledge = (knowledge: BoundKnowledgeItem) => () => {\n    onChange?.({\n      ...value,\n      knowledgeFCParam: {\n        knowledgeList: value?.knowledgeFCParam?.knowledgeList?.filter(\n          item => item.id !== knowledge.id,\n        ),\n      },\n    });\n  };\n\n  const handlePluginItemSettingChange =\n    (plugin: BoundPluginItem) => (setting: PluginFCSetting | undefined) => {\n      onChange?.({\n        ...value,\n        pluginFCParam: {\n          pluginList: value.pluginFCParam?.pluginList?.map(item => {\n            if (item.api_id === plugin.api_id) {\n              return {\n                ...item,\n                fc_setting: setting,\n              };\n            } else {\n              return item;\n            }\n          }),\n        },\n      });\n    };\n\n  const handleWorkflowItemSettingChange =\n    (workflow: BoundWorkflowItem) => (setting: PluginFCSetting | undefined) => {\n      onChange?.({\n        ...value,\n        workflowFCParam: {\n          workflowList: value.workflowFCParam?.workflowList?.map(item => {\n            if (item.workflow_id === workflow.workflow_id) {\n              return {\n                ...item,\n                fc_setting: setting,\n              };\n            } else {\n              return item;\n            }\n          }),\n        },\n      });\n    };\n\n  const handleKnowledgeGlobalSettingChange = (\n    setting: KnowledgeGlobalSetting | undefined,\n  ) => {\n    onChange?.({\n      ...value,\n      knowledgeFCParam: {\n        ...value?.knowledgeFCParam,\n        global_setting: setting,\n      },\n    });\n  };\n\n  return (\n    <FormCard\n      header={I18n.t('chatflow_agent_skill_name')}\n      actionButton={\n        readonly ? null : (\n          <AddSkill\n            boundSkills={value}\n            onSkillsChange={handleSkillsChange}\n            disabledTooltip={disabledTooltip}\n          />\n        )\n      }\n    >\n      {isEmpty ? <EmptySkill /> : null}\n      {value.pluginFCParam?.pluginList?.map(item => {\n        const pluginDetail = skillsDetail?.plugin_detail_map?.[item.plugin_id];\n        const apiDetail = skillsDetail?.plugin_api_detail_map?.[item.api_id];\n        const title =\n          pluginDetail && apiDetail\n            ? `${pluginDetail?.name} / ${apiDetail?.name}`\n            : '';\n\n        return (\n          <BoundItemCard\n            title={title}\n            pasteTitle={apiDetail?.name}\n            description={apiDetail?.description}\n            iconUrl={pluginDetail?.icon_url}\n            onRemove={handleRemovePlugin(item)}\n            params={apiDetail?.parameters ?? []}\n            readonly={readonly}\n            hideActions={modelSkillDisabled}\n            versionRender={\n              <div className=\"flex gap-1\">\n                <ApiSkillVersion\n                  versionTs={item.plugin_version}\n                  versionName={pluginDetail?.version_name}\n                  latestVersionName={pluginDetail?.latest_version_name}\n                  latestVersionTs={pluginDetail?.latest_version_ts}\n                  pluginId={item.plugin_id}\n                />\n                {disabledTooltip ? (\n                  <Tooltip content={disabledTooltip}>\n                    <Tag size=\"mini\" color=\"yellow\">\n                      {I18n.t('workflow_250310_02', undefined, '')}\n                    </Tag>\n                  </Tooltip>\n                ) : null}\n              </div>\n            }\n            settingRender={\n              <PluginSetting\n                {...item}\n                setting={item.fc_setting}\n                onChange={handlePluginItemSettingChange(item)}\n              />\n            }\n          />\n        );\n      })}\n      {value.workflowFCParam?.workflowList?.map(item => {\n        const detail = skillsDetail?.workflow_detail_map?.[item.workflow_id];\n        return (\n          <BoundItemCard\n            title={detail?.name ?? ''}\n            description={detail?.description}\n            iconUrl={detail?.icon_url}\n            onRemove={handleRemoveWorkflow(item)}\n            params={detail?.api_detail?.parameters ?? []}\n            versionRender={\n              <SubWorkflowSkillVersion\n                versionName={item.workflow_version}\n                latestVersionName={detail?.latest_version_name}\n                workflowId={item.workflow_id}\n              />\n            }\n            settingRender={\n              <WorkflowSetting\n                {...item}\n                setting={item.fc_setting}\n                onChange={handleWorkflowItemSettingChange(item)}\n              />\n            }\n          />\n        );\n      })}\n      {value.knowledgeFCParam?.knowledgeList?.map(item => {\n        const detail = skillsDetail?.dataset_detail_map?.[item.id];\n        return (\n          <BoundItemCard\n            title={detail?.name ?? ''}\n            iconUrl={detail?.icon_url}\n            onRemove={handleRemoveKnowledge(item)}\n            settingRender={\n              <KnowledgeSetting\n                setting={value.knowledgeFCParam?.global_setting}\n                onChange={handleKnowledgeGlobalSettingChange}\n              />\n            }\n          />\n        );\n      })}\n    </FormCard>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useService } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowModelsService } from '@/services';\n\nimport { useModelType } from '../hooks/use-model-type';\n\n/**\n * Is the judgment model a supporting skill?\n */\nexport function useModelSkillDisabled() {\n  const modelType = useModelType();\n\n  const modelsService = useService(WorkflowModelsService);\n  return !(modelType && modelsService.isFunctionCallModel(modelType));\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, set, omit, isEmpty } from 'lodash-es';\nimport {\n  Field,\n  ValidateTrigger,\n  FieldArray,\n  type FieldRenderProps,\n  type FieldArrayRenderProps,\n  type FormMetaV2,\n  type FormRenderProps,\n  nanoid,\n  type Validate,\n} from '@flowgram-adapter/free-layout-editor';\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { nodeUtils, ViewVariableType } from '@coze-workflow/nodes';\nimport {\n  BlockInput,\n  concatTestId,\n  type InputValueDTO,\n  type RefExpression,\n  type ValueExpression,\n  ValueExpressionType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus, IconCozMinus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { type IModelValue } from '@/typing';\nimport { WorkflowModelsService } from '@/services';\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { createProvideNodeBatchVariables } from '@/nodes-v2/materials/provide-node-batch-variable';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\nimport { ChatHistory } from '@/nodes-v2/llm/chat-history';\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ValueExpressionInput } from '@/nodes-v2/components/value-expression-input';\nimport { Outputs } from '@/nodes-v2/components/outputs';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { NodeInputName } from '@/nodes-v2/components/node-input-name';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { BatchMode } from '@/nodes-v2/components/batch-mode';\nimport { Batch } from '@/nodes-v2/components/batch/batch';\nimport { useGetWorkflowMode, useGlobalState } from '@/hooks';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\nimport { ModelSelect } from '@/components/model-select';\n\nimport { nodeMetaValidate } from '../materials/node-meta-validate';\nimport { SettingOnError } from '../components/setting-on-error';\nimport NodeMeta from '../components/node-meta';\nimport { Vision, isVisionInput } from './vision';\nimport {\n  llmOutputTreeMetaValidator,\n  llmInputNameValidator,\n} from './validators';\nimport {\n  getDefaultLLMParams,\n  modelItemToBlockInput,\n  reviseLLMParamPair,\n} from './utils';\nimport { UserPrompt } from './user-prompt';\nimport { type FormData } from './types';\nimport { SystemPrompt } from './system-prompt';\nimport { type BoundSkills } from './skills/types';\nimport {\n  formatFcParamOnInit,\n  formatFcParamOnSubmit,\n} from './skills/data-transformer';\nimport { Skills } from './skills';\nimport {\n  formatReasoningContentOnInit,\n  formatReasoningContentOnSubmit,\n  provideReasoningContentEffect,\n  sortOutputs,\n} from './cot';\n\nimport styles from './index.module.less';\n\n/** Default session rounds */\nconst DEFAULT_CHAT_ROUND = 3;\n\nconst Render = ({ form }: FormRenderProps<FormData>) => {\n  const readonly = useReadonly();\n  const { isChatflow } = useGetWorkflowMode();\n  const { isBindDouyin } = useGlobalState();\n\n  return (\n    <PublicScopeProvider>\n      <>\n        <NodeMeta\n          deps={['outputs', 'batchMode']}\n          outputsPath={'outputs'}\n          batchModePath={'batchMode'}\n        />\n        <Field name={'batchMode'}>\n          {({ field }: FieldRenderProps<string>) => (\n            <BatchMode\n              name={field.name}\n              value={field.value}\n              onChange={field.onChange}\n              onBlur={field.onBlur}\n            />\n          )}\n        </Field>\n        <Field name={'model'}>\n          {({ field }: FieldRenderProps<IModelValue | undefined>) => (\n            <FormCard\n              header={I18n.t('workflow_detail_llm_model')}\n              tooltip={I18n.t('workflow_detail_llm_prompt_tooltip')}\n            >\n              <ModelSelect {...field} readonly={readonly} />\n            </FormCard>\n          )}\n        </Field>\n        <Batch batchModeName={'batchMode'} name={'batch'} />\n        {!isBindDouyin ? (\n          <Field name=\"fcParam\">\n            {({ field }: FieldRenderProps<BoundSkills | undefined>) => (\n              <Skills {...field} />\n            )}\n          </Field>\n        ) : null}\n        <FieldArray\n          name={'$$input_decorator$$.inputParameters'}\n          defaultValue={[\n            { name: 'input', input: { type: ValueExpressionType.REF } },\n          ]}\n        >\n          {({\n            field,\n          }: FieldArrayRenderProps<{\n            name: string;\n            input: { type: ValueExpressionType };\n          }>) => (\n            <FormCard\n              header={I18n.t('workflow_detail_node_parameter_input')}\n              tooltip={I18n.t('workflow_detail_llm_input_tooltip')}\n            >\n              <div className={styles['columns-title']}>\n                <ColumnsTitleWithAction\n                  columns={[\n                    {\n                      title: I18n.t('workflow_detail_variable_input_name'),\n                      style: {\n                        flex: 2,\n                      },\n                    },\n                    {\n                      title: I18n.t('workflow_detail_variable_input_value'),\n                      style: {\n                        flex: 3,\n                      },\n                    },\n                  ]}\n                  readonly={readonly}\n                />\n              </div>\n              {field.map((child, index) =>\n                isVisionInput(child.value) ? null : (\n                  <div\n                    key={child.key}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'flex-start',\n                      paddingBottom: 4,\n                      gap: 4,\n                    }}\n                  >\n                    <Field name={`${child.name}.name`}>\n                      {({\n                        field: childNameField,\n                        fieldState: nameFieldState,\n                      }: FieldRenderProps<string>) => (\n                        <div\n                          style={{\n                            flex: 2,\n                            minWidth: 0,\n                          }}\n                        >\n                          <NodeInputName\n                            {...childNameField}\n                            input={form.getValueIn<RefExpression>(\n                              `${child.name}.input`,\n                            )}\n                            inputParameters={field.value || []}\n                            isError={!!nameFieldState?.errors?.length}\n                          />\n                          <FormItemFeedback errors={nameFieldState?.errors} />\n                        </div>\n                      )}\n                    </Field>\n                    <Field name={`${child.name}.input`}>\n                      {({\n                        field: childInputField,\n                        fieldState: inputFieldState,\n                      }: FieldRenderProps<ValueExpression | undefined>) => (\n                        <div style={{ flex: 3, minWidth: 0 }}>\n                          <ValueExpressionInput\n                            {...childInputField}\n                            isError={!!inputFieldState?.errors?.length}\n                          />\n                          <FormItemFeedback errors={inputFieldState?.errors} />\n                        </div>\n                      )}\n                    </Field>\n                    {readonly ? (\n                      <></>\n                    ) : (\n                      <div className=\"leading-none\">\n                        <IconButton\n                          size=\"small\"\n                          color=\"secondary\"\n                          data-testid={concatTestId(child.name, 'remove')}\n                          icon={<IconCozMinus className=\"text-sm\" />}\n                          onClick={() => {\n                            field.delete(index);\n                          }}\n                        />\n                      </div>\n                    )}\n                  </div>\n                ),\n              )}\n              {isChatflow ? (\n                <Field name={'$$input_decorator$$.chatHistorySetting'}>\n                  {({\n                    field: enableChatHistoryField,\n                  }: FieldRenderProps<{\n                    enableChatHistory: boolean;\n                    chatHistoryRound: number;\n                  }>) => (\n                    <ChatHistory\n                      {...enableChatHistoryField}\n                      style={{ paddingRight: '32px' }}\n                      showLine={false}\n                    />\n                  )}\n                </Field>\n              ) : null}\n              {readonly ? (\n                <></>\n              ) : (\n                <div className={styles['input-add-icon']}>\n                  <IconButton\n                    className=\"!block\"\n                    color=\"highlight\"\n                    size=\"small\"\n                    icon={<IconCozPlus className=\"text-sm\" />}\n                    onClick={() => {\n                      field.append({\n                        name: '',\n                        input: { type: ValueExpressionType.REF },\n                      });\n                    }}\n                  />\n                </div>\n              )}\n            </FormCard>\n          )}\n        </FieldArray>\n        {!isBindDouyin ? <Vision /> : null}\n        <Field\n          name=\"$$prompt_decorator$$.systemPrompt\"\n          deps={['$$input_decorator$$.inputParameters']}\n          defaultValue={''}\n        >\n          {({ field }: FieldRenderProps<string>) => (\n            <>\n              <SystemPrompt\n                {...field}\n                placeholder={I18n.t('workflow_detail_llm_sys_prompt_content')}\n                fcParam={form.getValueIn('fcParam')}\n                inputParameters={form.getValueIn(\n                  '$$input_decorator$$.inputParameters',\n                )}\n              />\n            </>\n          )}\n        </Field>\n        <Field\n          name=\"$$prompt_decorator$$.prompt\"\n          deps={['$$input_decorator$$.inputParameters', 'model']}\n          defaultValue={''}\n        >\n          {({ field, fieldState }: FieldRenderProps<string>) => (\n            <>\n              <UserPrompt field={field} fieldState={fieldState} />\n            </>\n          )}\n        </Field>\n        <Field\n          name={'outputs'}\n          deps={['batchMode']}\n          defaultValue={[{ name: 'output', type: ViewVariableType.String }]}\n        >\n          {({ field, fieldState }) => (\n            <Outputs\n              id={'llm-node-output'}\n              value={field.value}\n              onChange={field.onChange}\n              batchMode={form.getValueIn('batchMode')}\n              withDescription\n              showResponseFormat\n              titleTooltip={I18n.t('workflow_detail_llm_output_tooltip')}\n              disabledTypes={[]}\n              needErrorBody={form.getValueIn(\n                'settingOnError.settingOnErrorIsOpen',\n              )}\n              errors={fieldState?.errors}\n              sortValue={sortOutputs}\n            />\n          )}\n        </Field>\n        <SettingOnError outputsPath={'outputs'} batchModePath={'batchMode'} />\n      </>\n    </PublicScopeProvider>\n  );\n};\n\nconst NEW_NODE_DEFAULT_VERSION = '3';\n\nconst userPromptFieldKey = '$$prompt_decorator$$.prompt';\n\nexport const LLM_FORM_META: FormMetaV2<FormData> = {\n  render: props => <Render {...props} />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    outputs: llmOutputTreeMetaValidator,\n    '$$input_decorator$$.inputParameters.*.name': llmInputNameValidator,\n    '$$input_decorator$$.inputParameters.*.input':\n      createValueExpressionInputValidate({ required: true }),\n    'batch.inputLists.*.name': createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'batch.inputLists') || []).map(item => item.name),\n      skipValidate: ({ formValues }) => formValues.batchMode === 'single',\n    }),\n    [userPromptFieldKey]: (({ value, formValues, context }) => {\n      const { playgroundContext } = context;\n      const modelType = get(formValues, 'model.modelType');\n      const curModel = playgroundContext?.models?.find(\n        model => model.model_type === modelType,\n      );\n      const isUserPromptRequired = curModel?.is_up_required ?? false;\n      if (!isUserPromptRequired) {\n        return undefined;\n      }\n      return value?.length\n        ? undefined\n        : I18n.t('workflow_detail_llm_prompt_error_empty');\n    }) as Validate,\n  },\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    batchMode: createProvideNodeBatchVariables('batchMode', 'batch.inputLists'),\n    'batch.inputLists': createProvideNodeBatchVariables(\n      'batchMode',\n      'batch.inputLists',\n    ),\n    outputs: provideNodeOutputVariablesEffect,\n    model: provideReasoningContentEffect,\n  },\n  // eslint-disable-next-line complexity\n  formatOnInit(value, context) {\n    const { node, playgroundContext } = context;\n    const modelsService = node.getService<WorkflowModelsService>(\n      WorkflowModelsService,\n    );\n    const models = modelsService.getModels();\n    let llmParam = get(value, 'inputs.llmParam');\n\n    // When first dragged into the canvas: Parse out the default value from the backend return value.\n    if (!llmParam) {\n      llmParam = getDefaultLLMParams(models);\n    }\n\n    const model: { [k: string]: unknown } = {};\n\n    llmParam.forEach((d: InputValueDTO) => {\n      const [k, v] = reviseLLMParamPair(d);\n      model[k] = v;\n    });\n\n    const { prompt } = model;\n    delete model.prompt;\n    delete model.systemPrompt;\n    delete model.enableChatHistory;\n\n    const inputParameters = get(value, 'inputs.inputParameters');\n    const outputs = get(value, 'outputs');\n    const isBatch = get(value, 'inputs.batch.batchEnable');\n\n    const initValue = {\n      nodeMeta: value?.nodeMeta,\n      $$input_decorator$$: {\n        inputParameters: !inputParameters\n          ? [{ name: 'input', input: { type: ValueExpressionType.REF } }]\n          : inputParameters,\n        chatHistorySetting: {\n          // Whether to open session history\n          enableChatHistory:\n            get(\n              llmParam.find(item => item.name === 'enableChatHistory'),\n              'input.value.content',\n            ) || false,\n\n          // Number of session rounds, the default is 3 rounds\n          chatHistoryRound: Number(\n            get(\n              llmParam.find(item => item.name === 'chatHistoryRound'),\n              'input.value.content',\n              DEFAULT_CHAT_ROUND,\n            ),\n          ),\n        },\n      },\n      outputs: isEmpty(outputs)\n        ? [{ name: 'output', type: ViewVariableType.String, key: nanoid() }]\n        : formatReasoningContentOnInit({\n            modelsService,\n            isBatch,\n            outputs,\n            modelType: model.modelType as number,\n          }),\n\n      // The model will re-fill the value according to llmParam, and the previous chatHistoryRound will also be filled at this time.\n      // Since a chatHistoryRound will be re-added when submitting, it will be ignored here to avoid problems.\n      model: omit(model, ['chatHistoryRound']),\n      $$prompt_decorator$$: {\n        prompt,\n        systemPrompt: get(\n          llmParam.find(item => item.name === 'systemPrompt'),\n          'input.value.content',\n        ),\n      },\n      batchMode: isBatch ? 'batch' : 'single',\n      batch: nodeUtils.batchToVO(get(value, 'inputs.batch'), context),\n      fcParam: formatFcParamOnInit(get(value, 'inputs.fcParam')),\n    };\n\n    // Get the version information sent by the backend\n    const schema = JSON.parse(\n      playgroundContext.globalState.info?.schema_json || '{}',\n    );\n    const curNode = schema?.nodes?.find(_node => _node.id === node.id);\n    const versionFromBackend =\n      parseInt(curNode?.data?.version) >= parseInt(NEW_NODE_DEFAULT_VERSION)\n        ? curNode?.data?.version\n        : NEW_NODE_DEFAULT_VERSION;\n    // [LLM node revised requirements, new node defaults to 3]\n    set(initValue, 'version', versionFromBackend);\n\n    return initValue;\n  },\n  formatOnSubmit(value, context) {\n    const { node, playgroundContext } = context;\n    const { globalState } = playgroundContext;\n\n    const models = node\n      .getService<WorkflowModelsService>(WorkflowModelsService)\n      .getModels();\n    const { model } = value;\n    const modelMeta = models.find(m => m.model_type === model.modelType);\n\n    const llmParam = modelItemToBlockInput(model, modelMeta);\n    const { batchMode } = value;\n    const batchDTO = nodeUtils.batchToDTO(value.batch, context);\n\n    const prompt = BlockInput.createString(\n      'prompt',\n      value.$$prompt_decorator$$.prompt,\n    );\n\n    const enableChatHistory = BlockInput.createBoolean(\n      'enableChatHistory',\n      // The workflow has no session history, it needs to be set to false, and the session flow is checked according to the actual check.\n      globalState.isChatflow\n        ? Boolean(\n            get(\n              value,\n              '$$input_decorator$$.chatHistorySetting.enableChatHistory',\n            ),\n          )\n        : false,\n    );\n    const chatHistoryRound = BlockInput.createInteger(\n      'chatHistoryRound',\n      get(value, '$$input_decorator$$.chatHistorySetting.chatHistoryRound'),\n    );\n    const systemPrompt = BlockInput.createString(\n      'systemPrompt',\n      get(value, '$$prompt_decorator$$.systemPrompt'),\n    );\n    llmParam.push(prompt, enableChatHistory, chatHistoryRound, systemPrompt);\n    const isBatch = batchMode === 'batch';\n    const formattedValue: Record<string, unknown> = {\n      nodeMeta: value.nodeMeta,\n      inputs: {\n        inputParameters: get(value, '$$input_decorator$$.inputParameters'),\n        llmParam,\n        fcParam: formatFcParamOnSubmit(value.fcParam),\n        batch: isBatch\n          ? {\n              batchEnable: batchMode === 'batch',\n              ...batchDTO,\n            }\n          : undefined,\n      },\n      outputs: formatReasoningContentOnSubmit(value.outputs, isBatch),\n      /**\n       * - \"LLM node format optimization\" requirement, integrate the output content into the prompt to limit the output format, the backend needs flag distinction logic, version 2\n       * - \"LLM node revised requirements fallback logic\", version 3\n       */\n\n      version: NEW_NODE_DEFAULT_VERSION,\n    };\n\n    return formattedValue;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { nameValidationRule } from '@/nodes-v2/components/helpers';\n\nimport { isVisionEqual, isVisionInput } from '../vision';\n\nexport const llmInputNameValidator = ({ value, formValues, name }) => {\n  const validatorRule = nameValidationRule;\n\n  /** name check */\n  if (!validatorRule.test(value)) {\n    return I18n.t('workflow_detail_node_error_format');\n  }\n\n  const inputValues =\n    get(formValues, '$$input_decorator$$.inputParameters') || [];\n  const paths = name.split('.');\n  paths.pop();\n  const inputValue = get(formValues, paths);\n\n  if (!inputValue) {\n    return;\n  }\n\n  const sameVisionInputs = inputValues.filter(\n    item => item.name === value && isVisionEqual(item, inputValue),\n  );\n\n  // All scenes are input or visually understood, and the same name is directly returned.\n  if (sameVisionInputs.length > 1) {\n    return I18n.t('workflow_detail_node_input_duplicated');\n  }\n\n  // Scenes with the same name as the input and visual understanding parameters are returned that cannot be the same name as the visual understanding parameters\n  // Visual understanding of parameters and input duplicate names, return cannot duplicate input names\n  const differentVisionInputs = inputValues.filter(\n    item => item.name === value && !isVisionEqual(item, inputValue),\n  );\n  if (differentVisionInputs.length > 0) {\n    if (isVisionInput(inputValue)) {\n      return I18n.t('workflow_250317_01', undefined, '');\n    } else {\n      return I18n.t('workflow_250317_02', undefined, '');\n    }\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, isUndefined, set } from 'lodash-es';\n\nimport {\n  type BoundKnowledgeItem,\n  type BoundSkills,\n  type KnowledgeGlobalSetting,\n} from './types';\n\ninterface KnowledgeGlobalSettingDTO extends KnowledgeGlobalSetting {\n  search_mode?: number;\n}\n\ninterface FunctionCallParamDTO extends BoundSkills {\n  knowledgeFCParam?: {\n    knowledgeList?: Array<BoundKnowledgeItem>;\n    global_setting?: KnowledgeGlobalSettingDTO;\n  };\n}\n\ntype FunctionCallParamVO = BoundSkills;\n\n/**\n * FC parameter backend to frontend\n * @param fcParamDTO\n * @returns\n */\nexport function formatFcParamOnInit(fcParamDTO?: FunctionCallParamDTO) {\n  if (!fcParamDTO) {\n    return fcParamDTO;\n  }\n  const searchMode = get(\n    fcParamDTO,\n    'knowledgeFCParam.global_setting.search_mode',\n  );\n\n  if (isUndefined(searchMode)) {\n    return fcParamDTO;\n  }\n\n  delete fcParamDTO?.knowledgeFCParam?.global_setting?.search_mode;\n  set(\n    fcParamDTO,\n    'knowledgeFCParam.global_setting.search_strategy',\n    searchMode,\n  );\n\n  return fcParamDTO;\n}\n\n/**\n * FC parameter front-end to back-end\n * @param fcParamVO\n * @returns\n */\nexport function formatFcParamOnSubmit(fcParamVO?: FunctionCallParamVO) {\n  if (!fcParamVO) {\n    return fcParamVO;\n  }\n  const searchStrategy = get(\n    fcParamVO,\n    'knowledgeFCParam.global_setting.search_strategy',\n  );\n\n  if (isUndefined(searchStrategy)) {\n    return fcParamVO;\n  }\n\n  delete fcParamVO?.knowledgeFCParam?.global_setting?.search_strategy;\n  set(fcParamVO, 'knowledgeFCParam.global_setting.search_mode', searchStrategy);\n\n  return fcParamVO;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { LLM_FORM_META } from './llm-form-meta';\n\nexport const LLM_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.LLM,\n  meta: {\n    nodeDTOType: StandardNodeType.LLM,\n    style: {\n      width: 360,\n    },\n    size: { width: 360, height: 130.7 },\n    test,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    batchPath: '/batch',\n    inputParametersPath: '/$$input_decorator$$/inputParameters',\n    getLLMModelIdsByNodeJSON: nodeJSON =>\n      nodeJSON.data.inputs.llmParam.find(p => p.name === 'modelType')?.input\n        .value.content,\n    helpLink: '/open/docs/guides/llm_node',\n  },\n  formMeta: LLM_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject, isChatflow } = context;\n    /** Not in session flow, LLM nodes do not need to be associated with the environment */\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const enableChatHistory =\n      formData?.$$input_decorator$$?.chatHistorySetting?.enableChatHistory;\n    if (!isChatflow || !enableChatHistory) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: !isInProject,\n      isNeedConversation: true,\n    });\n  },\n  generateFormBatchProperties(node) {\n    const batchModePath = '/batchMode';\n    const batchDataPath = '/batch';\n    const { formModel } = node.getData(FlowNodeFormData);\n    const batchMode = formModel.getFormItemValueByPath(batchModePath);\n    if (batchMode !== 'batch') {\n      return {};\n    }\n    const batchData = formModel.getFormItemValueByPath(batchDataPath);\n    const parameters = batchData?.inputLists;\n    return generateParametersToProperties(parameters, { node });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.$$input_decorator$$?.inputParameters;\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/naming-convention -- todo */\n/** Remarks Default size */\nexport const CommentDefaultSize = {\n  width: 240,\n  height: 150,\n};\n\n/** Remarks Default value */\nexport const CommentDefaultNote = JSON.stringify([\n  {\n    type: 'paragraph',\n    children: [{ text: '' }],\n  },\n]);\n\nexport const CommentDefaultSchemaType = 'slate';\n\nexport const CommentDefaultVO = {\n  schemaType: CommentDefaultSchemaType,\n  note: CommentDefaultNote,\n  size: CommentDefaultSize,\n};\n\nexport const CommentDefaultDTO = {\n  inputs: {\n    schemaType: CommentDefaultSchemaType,\n    note: CommentDefaultNote,\n  },\n  size: CommentDefaultSize,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport type { ICommentNodeVO, ICommentNodeDTO } from './type';\nimport {\n  CommentDefaultDTO,\n  CommentDefaultNote,\n  CommentDefaultVO,\n  CommentDefaultSize,\n  CommentDefaultSchemaType,\n} from './constant';\n\nexport const COMMENT_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.Comment,\n  meta: {\n    disableSideSheet: true,\n    nodeDTOType: StandardNodeType.Comment,\n    renderKey: StandardNodeType.Comment,\n    size: {\n      width: 240,\n      height: 150,\n    },\n  },\n  formMeta: {\n    render: () => <></>,\n    formatOnInit: (\n      value: ICommentNodeDTO = CommentDefaultDTO,\n    ): ICommentNodeVO => {\n      const { inputs, ...rest } = value;\n      return {\n        ...rest,\n        schemaType: inputs?.schemaType ?? CommentDefaultSchemaType, // The default is to use the slate format, and other formats will be considered later.\n        note: inputs?.note ?? CommentDefaultNote,\n        size: value.size ?? CommentDefaultSize,\n      };\n    },\n    formatOnSubmit(value: ICommentNodeVO = CommentDefaultVO): ICommentNodeDTO {\n      const { note, schemaType, ...rest } = value;\n      return {\n        ...rest,\n        inputs: {\n          schemaType: schemaType ?? CommentDefaultSchemaType, // The default is to use the slate format, and other formats will be considered later.\n          note: note ?? CommentDefaultNote,\n        },\n        size: value.size ?? CommentDefaultSize,\n      };\n    },\n  },\n  getInputPoints: () => [], // Comment node no input\n  getOutputPoints: () => [], // Comment node has no output\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/base';\n\nexport function getOutputsDefaultValue() {\n  return [\n    {\n      key: nanoid(),\n      name: 'outputList',\n      type: ViewVariableType.ArrayObject,\n    },\n    {\n      key: nanoid(),\n      name: 'rowNum',\n      type: ViewVariableType.Integer,\n    },\n  ];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type DatabaseField } from '@coze-workflow/base';\ninterface SelectAndSetFieldsFieldContextProps {\n  shouldDisableRemove?: (field?: DatabaseField) => boolean;\n}\n\nexport const SelectAndSetFieldsFieldContext =\n  createContext<SelectAndSetFieldsFieldContextProps>({});\n\nexport const useSelectAndSetFieldsContext = () =>\n  useContext(SelectAndSetFieldsFieldContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useNodeTestId, type DatabaseField } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { useToggle } from '@coze-arch/hooks';\nimport { Dropdown, Tooltip } from '@coze-arch/coze-design';\n\nimport { DataTypeTag } from '@/node-registries/common/components';\nimport { AddButton } from '@/form';\n\ninterface SelectFieldsButtonProps {\n  onSelect?: (id: number) => void;\n  selectedFieldIDs?: number[];\n  fields?: DatabaseField[];\n  filterSystemFields?: boolean;\n  readonly?: boolean;\n  testName?: string;\n}\n\nconst MenuItem = ({\n  field,\n  onSelect,\n}: {\n  field: DatabaseField;\n  onSelect?: (id: number) => void;\n}) => (\n  <Dropdown.Item className=\"!p-0 m-0\">\n    <Tooltip\n      className=\"!translate-x-[-6px]\"\n      content={field.name}\n      position=\"left\"\n    >\n      <div\n        className=\"w-[196px] h-[32px] p-[8px] flex items-center justify-between\"\n        onClick={e => {\n          e.stopPropagation();\n          onSelect?.(field.id as number);\n        }}\n      >\n        <span className=\"text-[14px] truncate w-[100px]\">{field.name}</span>\n\n        <DataTypeTag type={field.type} />\n      </div>\n    </Tooltip>\n  </Dropdown.Item>\n);\n\nexport function SelectFieldsButton({\n  onSelect,\n  selectedFieldIDs = [],\n  fields = [],\n  filterSystemFields = true,\n  readonly = false,\n  testName,\n}: SelectFieldsButtonProps) {\n  const { state: visible, toggle } = useToggle(false);\n  const { getNodeSetterId } = useNodeTestId();\n  const addButtonTestId = getNodeSetterId(\n    testName || 'select-fileds-add-button',\n  );\n\n  fields = fields?.filter(\n    ({ isSystemField, id }) =>\n      (!isSystemField || !filterSystemFields) &&\n      !selectedFieldIDs?.includes(id),\n  );\n\n  const disabled = readonly || !fields || fields.length === 0;\n\n  useEffect(() => {\n    if (disabled && visible) {\n      toggle();\n    }\n  }, [disabled, visible]);\n\n  if (disabled) {\n    return (\n      <Tooltip\n        content={I18n.t('workflow_database_no_fields', {}, '')}\n      >\n        <AddButton disabled={disabled} />\n      </Tooltip>\n    );\n  }\n\n  return (\n    <Dropdown\n      className=\"max-h-[260px] overflow-auto\"\n      visible={visible}\n      trigger=\"custom\"\n      render={\n        <Dropdown.Menu>\n          {fields.map(field => (\n            <MenuItem field={field} onSelect={onSelect} />\n          ))}\n        </Dropdown.Menu>\n      }\n      position=\"bottomRight\"\n      onClickOutSide={() => toggle()}\n    >\n      <div onClick={() => toggle()}>\n        <AddButton dataTestId={addButtonTestId} />\n      </div>\n    </Dropdown>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseSettingField } from '@coze-workflow/base';\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { useFieldArray } from '@/form';\n\nimport { SelectFieldsButton } from '../../components';\n\nexport function SelectAndSetFieldsAddButton({\n  afterAppend,\n}: {\n  afterAppend?: () => void;\n}) {\n  const { value, append, readonly } = useFieldArray<DatabaseSettingField>();\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const selectedFieldIDs = value?.map(({ fieldID }) => fieldID);\n\n  return (\n    <SelectFieldsButton\n      readonly={readonly}\n      selectedFieldIDs={selectedFieldIDs}\n      onSelect={id => {\n        append({ fieldID: id });\n        afterAppend?.();\n      }}\n      fields={currentDatabase?.fields?.filter(\n        ({ isSystemField }) => !isSystemField,\n      )}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren } from 'react';\n\nimport { type DatabaseSettingField } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section, useFieldArray, useSectionRef } from '@/form';\n\nimport { SelectAndSetFieldsAddButton } from './select-and-set-fields-add-button';\n\nexport function SelectAndSetFieldsSection({ children }: PropsWithChildren) {\n  const { value } = useFieldArray<DatabaseSettingField>();\n  const sectionRef = useSectionRef();\n\n  return (\n    <Section\n      ref={sectionRef}\n      title={I18n.t('workflow_select_and_set_fields_title')}\n      isEmpty={!value || value?.length === 0}\n      emptyText={I18n.t('workflow_select_and_set_fields_empty')}\n      actions={[\n        <SelectAndSetFieldsAddButton\n          afterAppend={() => sectionRef.current?.open()}\n        />,\n      ]}\n    >\n      {children}\n    </Section>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseSettingField } from '@coze-workflow/base';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { DataTypeTag } from '@/node-registries/common/components';\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { FieldArrayItem, useFieldArray } from '@/form';\n\nimport { useSelectAndSetFieldsContext } from './select-and-set-fields-context';\n\nexport function SelectAndSetFieldsItem({ index }: { index: number }) {\n  const { name, value, remove, readonly } =\n    useFieldArray<DatabaseSettingField>();\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const { shouldDisableRemove } = useSelectAndSetFieldsContext();\n\n  const fieldSchema = value?.[index];\n  const field = currentDatabase?.fields?.find(\n    ({ id }) => id === fieldSchema?.fieldID,\n  );\n\n  return (\n    <FieldArrayItem\n      onRemove={() => remove(index)}\n      disableRemove={readonly || shouldDisableRemove?.(field)}\n    >\n      <ValueExpressionInputField\n        label={field?.name}\n        required={field?.required}\n        tooltip={field?.description}\n        labelExtra={field?.type && <DataTypeTag type={field.type} />}\n        name={`${name}.${index}.fieldValue`}\n        inputType={field?.type}\n      />\n    </FieldArrayItem>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseSettingField } from '@coze-workflow/base';\n\nimport { FieldArrayList, useFieldArray } from '@/form';\n\nimport { SelectAndSetFieldsItem } from './select-and-set-fields-item';\n\nexport function SelectAndSetFieldsList() {\n  const { value } = useFieldArray<DatabaseSettingField>();\n\n  return (\n    <FieldArrayList>\n      {value?.map(({ fieldID }, index) => (\n        <SelectAndSetFieldsItem key={fieldID} index={index} />\n      ))}\n    </FieldArrayList>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ColumnTitles } from '@/form';\n\nexport function SelectAndSetFieldsColumnsTitle() {\n  return (\n    <ColumnTitles\n      columns={[\n        {\n          label: I18n.t('workflow_detail_node_parameter_name'),\n          style: { width: 148 },\n        },\n        { label: I18n.t('workflow_detail_end_output_value') },\n      ]}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SelectAndSetFieldsSection } from './select-and-set-fields-section';\nimport { SelectAndSetFieldsList } from './select-and-set-fields-list';\nimport { SelectAndSetFieldsColumnsTitle } from './select-and-set-fields-columns-title';\n\nexport const SelectAndSetFields = () => (\n  <SelectAndSetFieldsSection>\n    <SelectAndSetFieldsColumnsTitle />\n    <SelectAndSetFieldsList />\n  </SelectAndSetFieldsSection>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseField } from '@coze-workflow/base';\n\nimport { withFieldArray, type FieldProps } from '@/form';\n\nimport { SelectAndSetFieldsFieldContext } from './select-and-set-fields-context';\nimport { SelectAndSetFields } from './select-and-set-fields';\ninterface SelectAndSetFieldsFieldProps extends Pick<FieldProps, 'name'> {\n  shouldDisableRemove?: (field?: DatabaseField) => boolean;\n}\n\nexport const SelectAndSetFieldsField = withFieldArray<\n  SelectAndSetFieldsFieldProps,\n  DatabaseField\n>(({ shouldDisableRemove = () => false }) => (\n  <SelectAndSetFieldsFieldContext.Provider\n    value={{\n      shouldDisableRemove,\n    }}\n  >\n    <SelectAndSetFields />\n  </SelectAndSetFieldsFieldContext.Provider>\n));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { useNodeTestId, type WorkflowDatabase } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport {\n  DatabaseSelect,\n  type DatabaseSelectValue,\n} from '@/form-extensions/setters/database-select';\nimport { Section, Field, type FieldProps } from '@/form';\n\ntype DatabaseSelectFieldProps = FieldProps<DatabaseSelectValue> & {\n  afterChange?: (value?: WorkflowDatabase) => void;\n};\n\nexport const DatabaseSelectField = ({\n  name,\n  label,\n  tooltip,\n  afterChange,\n  ...rest\n}: DatabaseSelectFieldProps) => {\n  const [changed, setChanged] = useState(false);\n  const { data: currentDatabase, isLoading } = useCurrentDatabaseQuery();\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  useEffect(() => {\n    if (changed && !isLoading) {\n      afterChange?.(currentDatabase);\n      setChanged(false);\n    }\n  }, [currentDatabase?.id]);\n\n  return (\n    <Section title={I18n.t('workflow_database_node_database_table_title')}>\n      <Field<DatabaseSelectValue> name={name} {...rest}>\n        {({ value, onChange, readonly }) => (\n          <DatabaseSelect\n            value={value}\n            readonly={readonly}\n            onChange={newValue => {\n              onChange(newValue);\n              setChanged(true);\n            }}\n            addButtonTestID={getNodeSetterId(`${name}.addButton`)}\n            libraryCardTestID={getNodeSetterId(`${name}.libraryCard`)}\n          />\n        )}\n      </Field>\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { OutputsField as BaseOutputsField } from '@/node-registries/common/fields/outputs';\nimport { type FieldProps } from '@/form';\n\nexport function OutputsField({\n  name,\n  deps,\n}: Pick<FieldProps, 'name' | 'deps'>) {\n  return (\n    <BaseOutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('workflow_240218_08')}\n      id=\"database-node-outputs\"\n      name={name}\n      deps={deps}\n      topLevelReadonly={true}\n      disabledTypes={[ViewVariableType.Object]}\n      defaultValue={[\n        {\n          key: nanoid(),\n          name: 'outputList',\n          type: ViewVariableType.ArrayObject,\n        },\n        {\n          key: nanoid(),\n          name: 'rowNum',\n          type: ViewVariableType.Integer,\n        },\n      ]}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ConditionLogic, useNodeTestId } from '@coze-workflow/base';\n\nimport { withField, useField, type FieldProps } from '@/form';\nimport {\n  ConditionItemLogic,\n  type ConditionItemLogicProps,\n} from '@/components/condition-item-logic';\n\nexport const ConditionLogicField = withField<\n  Pick<ConditionItemLogicProps, 'showStroke'> & FieldProps\n>(({ showStroke }) => {\n  const { name, value, onChange, readonly } = useField<ConditionLogic>();\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <ConditionItemLogic\n      logic={value}\n      readonly={readonly}\n      onChange={onChange}\n      showStroke={showStroke}\n      testId={getNodeSetterId(name)}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type DatabaseConditionRight,\n  type DatabaseConditionOperator,\n  type ViewVariableType,\n} from '@coze-workflow/base';\nimport { Input } from '@coze-arch/coze-design';\n\nimport { ValueExpressionInput } from '@/nodes-v2/components/value-expression-input';\nimport { withField, useField } from '@/form';\n\ninterface ConditionRightFieldProps {\n  operation?: DatabaseConditionOperator;\n  dataType?: ViewVariableType;\n}\n\nexport const ConditionRightField = withField(\n  ({ operation, dataType }: ConditionRightFieldProps) => {\n    const { name, value, onChange, readonly } =\n      useField<DatabaseConditionRight>();\n\n    if (operation === 'IS_NULL' || operation === 'IS_NOT_NULL') {\n      return <Input value={'empty'} disabled size=\"small\" />;\n    }\n\n    if (operation === 'BE_TRUE') {\n      return <Input value={'true'} disabled size=\"small\" />;\n    }\n\n    if (operation === 'BE_FALSE') {\n      return <Input value={'false'} disabled size=\"small\" />;\n    }\n\n    return (\n      <ValueExpressionInput\n        name={name}\n        value={value}\n        inputType={dataType}\n        readonly={readonly}\n        onChange={newValue => {\n          onChange(newValue as DatabaseConditionRight);\n        }}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ViewVariableType,\n  type DatabaseConditionOperator,\n  useNodeTestId,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { withField, useField, Select } from '@/form';\n\nimport { getConditionOperatorOptions } from './get-condition-operator-options';\n\ninterface ConditionOperatorFieldProps {\n  dataType?: ViewVariableType;\n}\n\nexport const ConditionOperatorField = withField(\n  ({ dataType }: ConditionOperatorFieldProps) => {\n    const { name, value, onChange, readonly } =\n      useField<DatabaseConditionOperator>();\n    const options = getConditionOperatorOptions(dataType);\n\n    const { getNodeSetterId } = useNodeTestId();\n\n    return (\n      <Select\n        className=\"w-[42px]\"\n        data-testid={getNodeSetterId(name)}\n        value={value}\n        disabled={readonly}\n        onChange={newValue => {\n          onChange(newValue as DatabaseConditionOperator);\n        }}\n        optionList={options}\n        placeholder={I18n.t('workflow_detail_condition_pleaseselect')}\n        renderSelectedItem={optionsNode => (\n          <Tooltip content={optionsNode.label}>\n            <div className={'flex items-center h-[24px]'}>\n              {optionsNode.operationIcon}\n            </div>\n          </Tooltip>\n        )}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { type ConditionOperator } from '@coze-workflow/base';\n\nimport { ConditionOperatorMap } from '@/constants/condition-operator-map';\n\nexport function getConditionOperatorOptions(fieldType?: ViewVariableType) {\n  let supportedOperators: ConditionOperator[] = [];\n\n  if (\n    fieldType === ViewVariableType.Number ||\n    fieldType === ViewVariableType.Integer\n  ) {\n    supportedOperators = [\n      'EQUAL',\n      'NOT_EQUAL',\n      'GREATER_THAN',\n      'LESS_THAN',\n      'GREATER_EQUAL',\n      'LESS_EQUAL',\n      'IN',\n      'NOT_IN',\n      'IS_NULL',\n      'IS_NOT_NULL',\n    ];\n  }\n\n  if (fieldType === ViewVariableType.String) {\n    supportedOperators = [\n      'EQUAL',\n      'NOT_EQUAL',\n      'LIKE',\n      'NOT_LIKE',\n      'IN',\n      'NOT_IN',\n      'IS_NULL',\n      'IS_NOT_NULL',\n    ];\n  }\n\n  if (fieldType === ViewVariableType.Time) {\n    supportedOperators = [\n      'EQUAL',\n      'NOT_EQUAL',\n      'GREATER_THAN',\n      'LESS_THAN',\n      'GREATER_EQUAL',\n      'LESS_EQUAL',\n      'IS_NULL',\n      'IS_NOT_NULL',\n    ];\n  }\n\n  if (fieldType === ViewVariableType.Boolean) {\n    supportedOperators = [\n      'EQUAL',\n      'NOT_EQUAL',\n      'IS_NULL',\n      'IS_NOT_NULL',\n      'BE_TRUE',\n      'BE_FALSE',\n    ];\n  }\n\n  return supportedOperators.map(operator => ({\n    label: ConditionOperatorMap[operator].label,\n    value: operator,\n    operationIcon: ConditionOperatorMap[operator].operationIcon,\n  }));\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseConditionLeft, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { withField, Select, useField } from '@/form';\n\ninterface ConditionLeftFieldProps {\n  onChange?: (value: DatabaseConditionLeft) => void;\n}\n\nexport const ConditionLeftField = withField<ConditionLeftFieldProps>(\n  ({ onChange: propOnChange }) => {\n    const { name, value, onChange, readonly } =\n      useField<DatabaseConditionLeft>();\n    const { data: currentDatabase } = useCurrentDatabaseQuery();\n    const { getNodeSetterId } = useNodeTestId();\n\n    const handleChange = newValue => {\n      onChange(newValue as DatabaseConditionLeft);\n      propOnChange?.(newValue as DatabaseConditionLeft);\n    };\n\n    return (\n      <Select\n        data-testid={getNodeSetterId(name)}\n        className=\"w-full\"\n        value={value}\n        onChange={handleChange}\n        disabled={readonly}\n        placeholder={I18n.t(\n          'workflow_condition_left_placeholder',\n          {},\n          '',\n        )}\n        optionList={currentDatabase?.fields?.map(field => ({\n          label: <span className=\"max-w-[220px] truncate\">{field.name}</span>,\n          value: field.name,\n        }))}\n      />\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useMemo } from 'react';\n\nimport {\n  type DatabaseCondition,\n  ViewVariableType,\n  useNodeTestId,\n} from '@coze-workflow/base';\n\nimport { useDatabaseNodeService } from '@/hooks';\nimport { IconRemove, withField, useField, useForm } from '@/form';\n\nimport { useConditionLeftDataType } from './use-condition-left-data-type';\nimport { ConditionRightField } from './condition-right-field';\nimport { ConditionOperatorField } from './condition-operator-field';\nimport { ConditionLeftField } from './condition-left-field';\n\nconst leftTypeToListTypeMaps = {\n  [ViewVariableType.String]: ViewVariableType.ArrayString,\n  [ViewVariableType.Integer]: ViewVariableType.ArrayInteger,\n  [ViewVariableType.Time]: ViewVariableType.ArrayTime,\n  [ViewVariableType.Number]: ViewVariableType.ArrayNumber,\n  [ViewVariableType.Boolean]: ViewVariableType.ArrayBoolean,\n};\n\nexport const ConditionItemField = withField(\n  ({\n    disableRemove = false,\n    onClickRemove,\n  }: {\n    disableRemove?: boolean;\n    onClickRemove?: () => void;\n  }) => {\n    const { name, value } = useField<DatabaseCondition>();\n    const dataType = useConditionLeftDataType();\n    const operator = value?.operator;\n    const { getNodeSetterId } = useNodeTestId();\n\n    const clearUpRightValueAndOperatorValueOnLeftChange =\n      useClearUpRightValueAndOperatorValueOnLeftChange();\n\n    useCleanupRightValueOnOperatorChange();\n\n    // In the case of belonging to or not belonging to the operator, the type of the rvalue is the array type of the lvalue\n    const rightFieldDataType = useMemo(\n      () =>\n        ['IN', 'NOT_IN'].includes(operator || '')\n          ? leftTypeToListTypeMaps?.[dataType as ViewVariableType] ??\n            ViewVariableType.ArrayString\n          : dataType,\n      [operator, dataType],\n    );\n\n    return (\n      <div className=\"flex items-center gap-[4px] min-w-0\">\n        <div className=\"flex flex-1 items-center gap-[4px] min-w-0\">\n          <div className=\"w-[42px]\">\n            <ConditionOperatorField\n              dataType={dataType}\n              name={`${name}.operator`}\n            />\n          </div>\n          <div className=\"flex-1 flex flex-col gap-[4px] min-w-0\">\n            <ConditionLeftField\n              name={`${name}.left`}\n              onChange={() => clearUpRightValueAndOperatorValueOnLeftChange()}\n            />\n            <ConditionRightField\n              operation={value?.operator}\n              name={`${name}.right`}\n              dataType={rightFieldDataType}\n            />\n          </div>\n        </div>\n        {!disableRemove && (\n          <IconRemove\n            onClick={onClickRemove}\n            testId={`${getNodeSetterId(name)}.remove`}\n          />\n        )}\n      </div>\n    );\n  },\n);\n\nfunction useCleanupRightValueOnOperatorChange() {\n  const { name, value } = useField<DatabaseCondition>();\n  const form = useForm();\n  const databaseNodeService = useDatabaseNodeService();\n\n  useEffect(() => {\n    if (\n      databaseNodeService.checkConditionOperatorNoNeedRight(value?.operator)\n    ) {\n      form.setFieldValue(`${name}.right`, undefined);\n    }\n  }, [value?.operator]);\n}\n\nfunction useClearUpRightValueAndOperatorValueOnLeftChange() {\n  const form = useForm();\n  const { value, name } = useField<DatabaseCondition>();\n\n  return useCallback(() => {\n    form.setFieldValue(`${name}.operator`, undefined);\n    form.setFieldValue(`${name}.right`, undefined);\n  }, [form, name, value]);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseCondition } from '@coze-workflow/base';\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { useField } from '@/form';\n\nexport function useConditionLeftDataType() {\n  const { value } = useField<DatabaseCondition>();\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const field = currentDatabase?.fields?.find(\n    item => item.name === value?.left,\n  );\n  return field?.type;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseCondition } from '@coze-workflow/base';\n\nimport { useFieldArray, FieldArrayList } from '@/form';\n\nimport { ConditionItemField } from './condition-item-field';\n\ninterface ConditionListProps {\n  min?: number;\n}\n\nexport function ConditionList({ min }: ConditionListProps) {\n  const { name, value, remove, readonly } = useFieldArray<DatabaseCondition>();\n\n  return (\n    <FieldArrayList>\n      {value?.map((_, index) => (\n        <ConditionItemField\n          name={`${name}.[${index}]`}\n          disableRemove={\n            readonly || (min !== undefined ? value?.length <= min : false)\n          }\n          onClickRemove={() => {\n            remove(index);\n          }}\n          hasFeedback={false}\n        />\n      ))}\n    </FieldArrayList>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseCondition, useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozPlus } from '@coze-arch/coze-design/icons';\nimport { Button } from '@coze-arch/coze-design';\n\nimport { useFieldArray } from '@/form';\n\nexport function ConditionAddButton() {\n  const { append, readonly } = useFieldArray<DatabaseCondition>();\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <Button\n      disabled={readonly}\n      className=\"mt-[4px]\"\n      onClick={() =>\n        append({ left: undefined, operator: undefined, right: undefined })\n      }\n      icon={<IconCozPlus />}\n      size=\"small\"\n      color=\"highlight\"\n      data-testid={getNodeSetterId('condition-add-button')}\n    >\n      {I18n.t('workflow_add_condition')}\n    </Button>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type DatabaseCondition, ConditionLogic } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  type FieldProps,\n  FieldArray,\n  Section,\n  useWatch,\n  FieldEmpty,\n} from '@/form';\n\nimport { ConditionLogicField } from './condition-logic-field';\nimport { ConditionList } from './condition-list';\nimport { ConditionAddButton } from './condition-add-button';\n\ntype ConditionFieldProps = Pick<FieldProps, 'name' | 'label' | 'tooltip'> & {\n  min?: number;\n};\n\nexport function ConditionField({\n  name,\n  label,\n  tooltip,\n  min,\n}: ConditionFieldProps) {\n  const conditionListName = `${name}.conditionList`;\n  const conditions = useWatch<DatabaseCondition[]>(conditionListName);\n\n  return (\n    <FieldArray name={conditionListName}>\n      <Section title={label} tooltip={tooltip}>\n        <div>\n          <div className=\"flex\">\n            {conditions?.length > 1 && (\n              <ConditionLogicField\n                name={`${name}.logic`}\n                defaultValue={ConditionLogic.AND}\n                showStroke={true}\n              />\n            )}\n            <div className=\"flex-1 min-w-0\">\n              <ConditionList min={min} />\n            </div>\n          </div>\n          <FieldEmpty\n            isEmpty={!conditions || conditions.length === 0}\n            text={I18n.t('workflow_condition_empty')}\n          />\n          <ConditionAddButton />\n        </div>\n      </Section>\n    </FieldArray>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ExpressionEditor } from '@/nodes-v2/components/expression-editor';\nimport { AutoGenerate } from '@/form-extensions/setters/sql/sql/auto-generate';\nimport { useField, withField } from '@/form';\n\nimport styles from './index.module.less';\n\nconst Sql = () => {\n  const { value, onChange, readonly, errors } = useField<string>();\n\n  const [key, setKey] = useState<number>(0);\n\n  function handleSubmit(newValue) {\n    onChange(newValue);\n    setKey(key + 1);\n  }\n\n  return (\n    <div className={styles.container}>\n      {/* will support soon */}\n      {!readonly && !IS_OPEN_SOURCE ? (\n        <AutoGenerate\n          className={styles['auto-generate']}\n          onSubmit={handleSubmit}\n        />\n      ) : null}\n\n      <ExpressionEditor\n        key={key.toString()}\n        value={value}\n        onChange={e => onChange(e)}\n        readonly={readonly}\n        isError={Boolean(errors?.length)}\n        placeholder={I18n.t('workflow_240218_12')}\n        name={'/sql'}\n      />\n    </div>\n  );\n};\n\nexport const SqlField = withField(Sql);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  DatabaseSelectField,\n  OutputsField,\n} from '@/node-registries/database/common/fields';\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Section } from '@/form';\n\nimport { InputsParametersField } from '../../common/fields';\nimport { SqlField } from './components/sql-field';\n\nconst Render = () => {\n  const { getNodeSetterId } = useNodeTestId();\n  const setterTestId = getNodeSetterId('');\n\n  return (\n    <NodeConfigForm>\n      <InputsParametersField\n        testId={setterTestId}\n        name=\"inputParameters\"\n        tooltip={I18n.t(\n          'workflow_240218_07',\n          {},\n          'SQL',\n        )}\n      />\n      <DatabaseSelectField name=\"databaseInfoList\" />\n      <Section\n        title={I18n.t('workflow_240218_09', {}, 'SQL')}\n        tooltip={I18n.t(\n          'workflow_240218_10',\n          {},\n          'SQL,,rowNum,outputListSQL',\n        )}\n      >\n        <SqlField name=\"sql\" />\n      </Section>\n      <OutputsField name=\"outputs\" />\n    </NodeConfigForm>\n  );\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateTrigger,\n  type WorkflowNodeRegistry,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { getOutputsDefaultValue } from '@/node-registries/database/common/utils';\n\nimport FormRender from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nexport const DATABASE_NODE_FORM_META: WorkflowNodeRegistry['formMeta'] = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputParameters.*.name': createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'inputParameters') || []).map(item => item.name),\n    }),\n    'inputParameters.*.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n    sql: ({ value }) =>\n      !value ? I18n.t('workflow_detail_node_error_empty') : undefined,\n    databaseInfoList: ({ value }) => {\n      if (!value || value.length === 0) {\n        return I18n.t('workflow_detail_node_error_empty');\n      }\n    },\n  },\n\n  // default value\n  defaultValues: {\n    inputParameters: [{ name: 'input' }],\n    databaseInfoList: [],\n    outputs: getOutputsDefaultValue(),\n  },\n\n  // side effect\n  effect: {\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Initialize data conversion\n  formatOnInit: transformOnInit,\n\n  // commit data conversion\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function transformOnInit(value) {\n  if (!value) {\n    return;\n  }\n\n  const { inputs = {}, nodeMeta, outputs } = value;\n\n  return {\n    nodeMeta,\n    ...inputs,\n    outputs,\n  };\n}\n\nexport function transformOnSubmit(value) {\n  const { nodeMeta, outputs, ...inputs } = value;\n  return {\n    nodeMeta,\n    inputs,\n    outputs,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { DATABASE_NODE_FORM_META } from './form-meta';\n\nexport const DATABASE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Database,\n  meta: {\n    nodeDTOType: StandardNodeType.Database,\n    style: {\n      width: 484,\n    },\n    size: DEFAULT_NODE_SIZE,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    test,\n    helpLink: '/open/docs/guides/database_sql_node',\n  },\n  formMeta: DATABASE_NODE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputParameters;\n\n    return generateParametersToProperties(inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WorkflowNode } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { DatabaseNodeService, ValueExpressionService } from '@/services';\n\nexport const createConditionValidator = (conditionFieldPath: string) => ({\n  [`${conditionFieldPath}.*.left`]: ({ value }) => {\n    if (value === undefined) {\n      return I18n.t('workflow_detail_node_error_empty');\n    }\n  },\n  [`${conditionFieldPath}.*.operator`]: ({ value }) => {\n    if (value === undefined) {\n      return I18n.t('workflow_detail_condition_condition_empty');\n    }\n  },\n  [`${conditionFieldPath}.*.right`]: ({ name, value, context }) => {\n    const node = new WorkflowNode(context.node);\n    const conditionPathName = name.replace('.right', '');\n    const condition = node.getValueByPath(conditionPathName);\n    const databaseNodeService = context.node.getService(DatabaseNodeService);\n    const valueExpressionService = context.node.getService(\n      ValueExpressionService,\n    );\n\n    // If no rvalue is required, skip the verification\n    if (\n      databaseNodeService.checkConditionOperatorNoNeedRight(condition?.operator)\n    ) {\n      return;\n    }\n\n    if (value === undefined) {\n      return I18n.t('workflow_detail_node_error_empty');\n    }\n\n    // Check if the reference variable is deleted\n    if (\n      valueExpressionService.isRefExpression(value) &&\n      !valueExpressionService.isRefExpressionVariableExists(value, context.node)\n    ) {\n      return I18n.t('workflow_detail_variable_referenced_error');\n    }\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { databaseSelectFieldName } from '@/constants/database-field-names';\n\nexport const createDatabaseValidator = () => ({\n  [databaseSelectFieldName]: ({ value }) => {\n    if (!value || value.length === 0) {\n      return I18n.t('workflow_detail_node_error_empty');\n    }\n  },\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionService } from '@/services';\n\nexport function createSelectAndSetFieldsValidator() {\n  return {\n    ['inputs.*.fieldInfo.*.fieldValue']: ({ value, context }) => {\n      const valueExpressionService = context.node.getService(\n        ValueExpressionService,\n      );\n\n      // Check if the reference variable has been deleted\n      if (\n        valueExpressionService.isRefExpression(value) &&\n        !valueExpressionService.isRefExpressionVariableExists(\n          value,\n          context.node,\n        )\n      ) {\n        return I18n.t('workflow_detail_variable_referenced_error');\n      }\n    },\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\n\nexport function useCurrentDatabaseField(fieldID?: number) {\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  return currentDatabase?.fields?.find(item => item.id === fieldID);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ConditionLogic } from '@coze-workflow/base';\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { useForm } from '@/form';\n\nexport function useResetCondition(conditionFieldName: string) {\n  const form = useForm();\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n\n  return () => {\n    // There is currently a selected database, and an empty condition is required.\n    if (currentDatabase) {\n      form.setFieldValue(conditionFieldName, {\n        conditionList: [\n          { left: undefined, operator: undefined, right: undefined },\n        ],\n        logic: ConditionLogic.AND,\n      });\n    } else {\n      form.setFieldValue(conditionFieldName, undefined);\n    }\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useResetSelectAndSetFields } from '@/node-registries/database/common/hooks';\nimport {\n  SelectAndSetFieldsField,\n  DatabaseSelectField,\n  OutputsField,\n} from '@/node-registries/database/common/fields';\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport {\n  createSelectAndSetFieldsFieldName,\n  databaseSelectFieldName,\n} from '@/constants/database-field-names';\n\nexport const DatabaseCreateForm: React.FC = withNodeConfigForm(() => {\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const resetSelectAndSetFields = useResetSelectAndSetFields(\n    createSelectAndSetFieldsFieldName,\n  );\n\n  return (\n    <>\n      <DatabaseSelectField\n        name={databaseSelectFieldName}\n        afterChange={() => {\n          resetSelectAndSetFields();\n        }}\n      />\n      {currentDatabase ? (\n        <SelectAndSetFieldsField\n          name={createSelectAndSetFieldsFieldName}\n          shouldDisableRemove={field => field?.required ?? false}\n        />\n      ) : null}\n      <OutputsField name=\"outputs\" />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { useForm } from '@/form';\n\nexport function useResetSelectAndSetFields(name: string) {\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const form = useForm();\n\n  return () => {\n    const newSelectFieldSchemas =\n      currentDatabase?.fields\n        ?.filter(({ required }) => required)\n        ?.map(({ id }) => ({\n          fieldID: id,\n        })) || [];\n\n    form.setFieldValue(name, newSelectFieldSchemas);\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ValidateTrigger } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\n\nimport { DatabaseNodeService } from '@/services/database-node-service';\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  createDatabaseValidator,\n  createSelectAndSetFieldsValidator,\n} from '@/node-registries/database/common/validators';\nimport { getOutputsDefaultValue } from '@/node-registries/database/common/utils';\nimport { createSelectAndSetFieldsFieldName } from '@/constants/database-field-names';\n\nimport { DatabaseCreateForm } from './database-create-form';\n\nexport const DatabaseCreateFormMeta: WorkflowNodeRegistry['formMeta'] = {\n  render: () => <DatabaseCreateForm />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ...createDatabaseValidator(),\n    ...createSelectAndSetFieldsValidator(),\n  },\n  defaultValues: {\n    inputs: {\n      databaseInfoList: [],\n    },\n    outputs: getOutputsDefaultValue(),\n  },\n  formatOnInit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertSettingFieldDTOToField(\n      createSelectAndSetFieldsFieldName,\n      value,\n    );\n\n    return value;\n  },\n\n  formatOnSubmit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertSettingFieldToDTO(\n      createSelectAndSetFieldsFieldName,\n      value,\n      context.node,\n    );\n\n    return value;\n  },\n  effect: {\n    outputs: provideNodeOutputVariablesEffect,\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { type NodeTestMeta } from '@/test-run-kit';\nimport { DatabaseNodeService } from '@/services';\n\nimport { test } from './node-test';\nimport { DatabaseCreateFormMeta } from './database-create-form-meta';\n\nexport const DATABASE_CREATE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.DatabaseCreate,\n    meta: {\n      nodeDTOType: StandardNodeType.DatabaseCreate,\n      test,\n      helpLink: '/open/docs/guides/database_insert_node',\n    },\n    formMeta: DatabaseCreateFormMeta,\n    onInit: async (nodeJson, context: WorkflowPlaygroundContext) => {\n      if (!nodeJson) {\n        return;\n      }\n      const databaseNodeService =\n        context.entityManager.getService<DatabaseNodeService>(\n          DatabaseNodeService,\n        );\n      const databaseId =\n        nodeJson?.data.inputs.databaseInfoList?.[0]?.databaseInfoID ?? '';\n      if (!databaseId) {\n        return;\n      }\n      await databaseNodeService.load(databaseId);\n    },\n    onDispose: (nodeJson, context: WorkflowPlaygroundContext) => {\n      if (!nodeJson) {\n        return;\n      }\n      const databaseNodeService =\n        context.entityManager.getService<DatabaseNodeService>(\n          DatabaseNodeService,\n        );\n\n      const databaseId =\n        get(nodeJson, 'inputs.databaseInfoList[0].databaseInfoID') ?? '';\n      if (!databaseId) {\n        return;\n      }\n      databaseNodeService.clearDatabaseError(databaseId);\n    },\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  async generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const databaseID = formData?.inputs?.databaseInfoList[0]?.databaseInfoID;\n    if (!databaseID) {\n      return {};\n    }\n    const db = await MemoryApi.GetDatabaseByID({\n      id: databaseID,\n      need_sys_fields: true,\n    });\n    const fieldInfo = formData?.inputs?.insertParam?.fieldInfo ?? [];\n\n    const parameters = fieldInfo.map(item => {\n      const databaseField = db?.database_info?.field_list?.find(\n        field => field.alterId === item.fieldID,\n      );\n      return {\n        name: `__setting_field_${item?.fieldID}`,\n        title: databaseField?.name,\n        input: item?.fieldValue,\n      };\n    });\n\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useResetCondition } from '@/node-registries/database/common/hooks';\nimport {\n  DatabaseSelectField,\n  OutputsField,\n  ConditionField,\n} from '@/node-registries/database/common/fields';\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport {\n  databaseSelectFieldName,\n  deleteConditionFieldName,\n} from '@/constants/database-field-names';\n\nexport const DatabaseDeleteForm: React.FC = withNodeConfigForm(() => {\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const resetCondition = useResetCondition(deleteConditionFieldName);\n\n  return (\n    <>\n      <DatabaseSelectField\n        name={databaseSelectFieldName}\n        afterChange={() => {\n          resetCondition();\n        }}\n      />\n      {currentDatabase ? (\n        <ConditionField\n          label={I18n.t('workflow_delete_conditon_title')}\n          name={deleteConditionFieldName}\n          min={1}\n        />\n      ) : null}\n      <OutputsField name=\"outputs\" />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ValidateTrigger } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\n\nimport { DatabaseNodeService } from '@/services';\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  createConditionValidator,\n  createDatabaseValidator,\n} from '@/node-registries/database/common/validators';\nimport { getOutputsDefaultValue } from '@/node-registries/database/common/utils';\nimport {\n  deleteConditionListFieldName,\n  deleteConditionLogicFieldName,\n} from '@/constants/database-field-names';\n\nimport { DatabaseDeleteForm } from './database-delete-form';\n\nexport const DatabaseDeleteFormMeta: WorkflowNodeRegistry['formMeta'] = {\n  render: () => <DatabaseDeleteForm />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ...createConditionValidator(deleteConditionListFieldName),\n    ...createDatabaseValidator(),\n  },\n  defaultValues: {\n    inputs: {\n      databaseInfoList: [],\n    },\n    outputs: getOutputsDefaultValue(),\n  },\n  effect: {\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  formatOnInit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertConditionDTOToCondition(\n      deleteConditionListFieldName,\n      value,\n    );\n    value = databaseNodeService.convertConditionLogicDTOToConditionLogic(\n      deleteConditionLogicFieldName,\n      value,\n    );\n\n    return value;\n  },\n\n  formatOnSubmit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertConditionToDTO(\n      deleteConditionListFieldName,\n      value,\n      context.node,\n    );\n\n    value = databaseNodeService.convertConditionLogicToConditionLogicDTO(\n      deleteConditionLogicFieldName,\n      value,\n    );\n\n    return value;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { DatabaseDeleteFormMeta } from './database-delete-form-meta';\n\nexport const DATABASE_DELETE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.DatabaseDelete,\n    meta: {\n      nodeDTOType: StandardNodeType.DatabaseDelete,\n      test,\n      helpLink: '/open/docs/guides/database_delete_node',\n    },\n    formMeta: DatabaseDeleteFormMeta,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const conditionList = (\n      formData?.inputs?.deleteParam?.condition?.conditionList ?? []\n    ).map((item, idx) => {\n      const { left, right } = item;\n      const name = left;\n      const rightValue = right;\n      return {\n        name: `__condition_right_${idx}`,\n        title: `${name}`,\n        input: rightValue,\n      };\n    });\n\n    return generateParametersToProperties(conditionList, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type FieldProps, InputNumberField, Section } from '@/form';\n\nexport function QueryLimitField({ name }: Pick<FieldProps, 'name'>) {\n  return (\n    <Section title={I18n.t('workflow_query_limit_title')}>\n      <InputNumberField className=\"w-full\" name={name} defaultValue={100} />\n    </Section>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { cloneDeep, set } from 'lodash-es';\nimport {\n  type ViewVariableMeta,\n  type ViewVariableType,\n} from '@coze-workflow/base';\n\nimport { SelectFieldsButton } from '@/node-registries/database/common/components';\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport { useFieldArray, useForm } from '@/form';\n\nimport { type QueryFieldSchema } from './types';\n\ninterface QueryFieldsAddButtonProps {\n  afterAppend?: () => void;\n}\n\nexport function QueryFieldsAddButton({\n  afterAppend,\n}: QueryFieldsAddButtonProps) {\n  const { value, append, readonly } = useFieldArray<QueryFieldSchema>();\n  const selectedFieldIDs = value?.map(({ fieldID }) => fieldID);\n  const form = useForm();\n\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const outputs = form.getValueIn<ViewVariableMeta[]>('outputs');\n\n  return (\n    <SelectFieldsButton\n      onSelect={id => {\n        append({ fieldID: id, isDistinct: false });\n        const field = currentDatabase?.fields?.find(item => item.id === id);\n        const outputListField = cloneDeep(outputs)?.find(\n          item => item.name === 'outputList',\n        ) as ViewVariableMeta;\n        const rowNumField = outputs?.find(item => item.name === 'rowNum');\n        const curIdField = outputListField?.children?.find(\n          item => item.name === field?.name,\n        );\n        if (!curIdField) {\n          if (!Array.isArray(outputListField?.children)) {\n            set(outputListField, 'children', []);\n          }\n          outputListField?.children?.push({\n            key: nanoid(),\n            name: field?.name ?? '',\n            type: field?.type as ViewVariableType,\n          });\n          form.setValueIn('outputs', [outputListField, rowNumField]);\n        }\n        afterAppend?.();\n      }}\n      selectedFieldIDs={selectedFieldIDs}\n      fields={currentDatabase?.fields}\n      filterSystemFields={false}\n      readonly={readonly}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren, useRef } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section, type SectionRefType, useFieldArray } from '@/form';\n\nimport { type QueryFieldSchema } from './types';\nimport { QueryFieldsAddButton } from './query-fields-add-button';\n\nexport function QueryFieldsSection({ children }: PropsWithChildren) {\n  const sectionRef = useRef<SectionRefType>();\n  const { value } = useFieldArray<QueryFieldSchema>();\n\n  return (\n    <Section\n      ref={sectionRef}\n      title={I18n.t('workflow_query_fields_title')}\n      isEmpty={!value || value.length === 0}\n      emptyText={I18n.t('workflow_query_fields_empty')}\n      actions={[\n        <QueryFieldsAddButton\n          afterAppend={() => {\n            sectionRef.current?.open();\n          }}\n        />,\n      ]}\n    >\n      {children}\n    </Section>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId } from '@coze-workflow/base';\n\nimport { useCurrentDatabaseField } from '@/node-registries/database/common/hooks';\nimport { DataTypeTag } from '@/node-registries/common/components';\nimport { FieldArrayItem, Label, useFieldArray } from '@/form';\n\nimport { type QueryFieldSchema } from './types';\n\ninterface QueryFieldsItemProps {\n  index: number;\n}\n\nexport function QueryFieldsItem({ index }: QueryFieldsItemProps) {\n  const { name, value, remove, readonly } = useFieldArray<QueryFieldSchema>();\n  const databaseField = useCurrentDatabaseField(value?.[index].fieldID);\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <FieldArrayItem\n      disableRemove={readonly}\n      onRemove={() => remove(index)}\n      removeTestId={`${getNodeSetterId(name)}.remove`}\n    >\n      <Label\n        className=\"w-[249px]\"\n        extra={<DataTypeTag type={databaseField?.type}></DataTypeTag>}\n      >\n        <span className=\"max-w-[200px] truncate\">{databaseField?.name}</span>\n      </Label>\n    </FieldArrayItem>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FieldArrayList, useFieldArray } from '@/form';\n\nimport { type QueryFieldSchema } from './types';\nimport { QueryFieldsItem } from './query-fields-item';\n\nexport function QueryFieldsList() {\n  const { value } = useFieldArray<QueryFieldSchema>();\n\n  return (\n    <FieldArrayList>\n      {value?.map((item, index) => (\n        <QueryFieldsItem index={index} />\n      ))}\n    </FieldArrayList>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ColumnTitles } from '@/form';\n\nexport function QueryFieldsColumnTitles() {\n  return (\n    <ColumnTitles\n      columns={[\n        {\n          label: I18n.t('workflow_query_fields_name', {}, ''),\n          style: {\n            width: 249,\n          },\n        },\n        // {\n        //   Label: I18n.t ('workflow_query_fields_remove_duplicates ', {}, ' deduplicate'),\n        // },\n      ]}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { QueryFieldsSection } from './query-fields-section';\nimport { QueryFieldsList } from './query-fields-list';\nimport { QueryFieldsColumnTitles } from './query-fields-column-titles';\n\nexport function QueryFields() {\n  return (\n    <QueryFieldsSection>\n      <QueryFieldsColumnTitles />\n      <QueryFieldsList />\n    </QueryFieldsSection>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FieldArray, type FieldProps } from '@/form';\n\nimport { QueryFields } from './query-fields';\n\nexport function QueryFieldsField({ name }: Pick<FieldProps, 'name'>) {\n  return (\n    <FieldArray name={name}>\n      <QueryFields />\n    </FieldArray>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useWatch } from '@/form';\nimport { queryFieldsFieldName } from '@/constants/database-field-names';\n\nimport { type QueryFieldSchema } from '../query-fields-field/types';\n\nexport function useQueryFieldIDs() {\n  const queryFieldsFieldValue =\n    useWatch<QueryFieldSchema[]>(queryFieldsFieldName);\n  const selectedFieldIDs = queryFieldsFieldValue?.map(({ fieldID }) => fieldID);\n  return selectedFieldIDs;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useFieldArray } from '@/form';\n\nimport { useQueryFieldIDs } from './use-query-field-ids';\nimport { type OrderByFieldSchema } from './types';\n\n// Listen to the query field. When the query field changes, check whether the sorting field exists in the query field. If it does not exist, remove it.\nexport const useValidateOrderFields = () => {\n  const { value, onChange } = useFieldArray<OrderByFieldSchema>();\n  const queryFieldIDs = useQueryFieldIDs();\n  useEffect(() => {\n    const fieldSchemaFiltered = value?.filter(({ fieldID }) =>\n      queryFieldIDs.includes(fieldID),\n    );\n    onChange(fieldSchemaFiltered || []);\n  }, [queryFieldIDs?.join(',')]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SelectFieldsButton } from '@/node-registries/database/common/components';\nimport { useFieldArray } from '@/form';\n\nimport { useQueryFields } from './use-query-fields';\nimport { type OrderByFieldSchema } from './types';\ninterface OrderByAddButtonProps {\n  afterAppend?: () => void;\n}\n\nexport function OrderByAddButton({ afterAppend }: OrderByAddButtonProps) {\n  const queryFields = useQueryFields();\n  const { value, append, readonly } = useFieldArray<OrderByFieldSchema>();\n  const selectedFieldIDs = value?.map(({ fieldID }) => fieldID);\n\n  return (\n    <SelectFieldsButton\n      onSelect={id => {\n        append({ fieldID: id, isAsc: true });\n        afterAppend?.();\n      }}\n      selectedFieldIDs={selectedFieldIDs}\n      fields={queryFields}\n      filterSystemFields={false}\n      readonly={readonly}\n      testName=\"order-fileds-add-button\"\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentDatabaseQuery } from '@/hooks';\n\nimport { useQueryFieldIDs } from './use-query-field-ids';\n\nexport function useQueryFields() {\n  const queryFieldIDs = useQueryFieldIDs();\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const queryFields = currentDatabase?.fields?.filter(item =>\n    queryFieldIDs?.includes(item.id),\n  );\n  return queryFields;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type PropsWithChildren, useRef } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section, type SectionRefType, useFieldArray } from '@/form';\n\nimport { type OrderByFieldSchema } from './types';\nimport { OrderByAddButton } from './order-by-add-button';\n\nexport function OrderBySection({ children }: PropsWithChildren) {\n  const sectionRef = useRef<SectionRefType>();\n  const { value } = useFieldArray<OrderByFieldSchema>();\n\n  return (\n    <Section\n      ref={sectionRef}\n      title={I18n.t('workflow_order_by_title', {}, '')}\n      actions={[\n        <OrderByAddButton\n          afterAppend={() => {\n            sectionRef.current?.open();\n          }}\n        />,\n      ]}\n      isEmpty={!value || value.length === 0}\n      emptyText={I18n.t('workflow_order_by_empty', {}, '')}\n    >\n      {children}\n    </Section>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType, useNodeTestId } from '@coze-workflow/base';\nimport { SingleSelect } from '@coze-arch/coze-design';\n\nimport { withField, useField } from '@/form';\n\ninterface AceOrDescProps {\n  type?: ViewVariableType;\n}\n\nconst AceOrDescLabelMap = {\n  [ViewVariableType.String]: ['A  Z', 'Z  A'],\n  [ViewVariableType.Integer]: ['0  9', '9  0'],\n  [ViewVariableType.Number]: ['0  9', '9  0'],\n  [ViewVariableType.Boolean]: ['0  1', '1  0'],\n  [ViewVariableType.Time]: ['0  9', '9  0'],\n};\n\nexport const AceOrDescField = withField<AceOrDescProps>(({ type }) => {\n  const { name, value, onChange, readonly } = useField<boolean>();\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const [aceLabel, descLabel] =\n    type === undefined ? [] : AceOrDescLabelMap[type];\n\n  return (\n    <SingleSelect\n      layout=\"hug\"\n      disabled={readonly}\n      value={`${value}`}\n      onChange={e => onChange(e.target.value === 'true')}\n      options={[\n        {\n          label: aceLabel,\n          value: 'true',\n        },\n        {\n          label: descLabel,\n          value: 'false',\n        },\n      ]}\n      size=\"small\"\n      data-testid={getNodeSetterId(name)}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCurrentDatabaseField } from '@/node-registries/database/common/hooks';\nimport { DataTypeTag } from '@/node-registries/common/components';\nimport { Label, withField, useField } from '@/form';\n\nimport { type OrderByFieldSchema } from './types';\nimport { AceOrDescField } from './ace-or-desc-field';\n\nexport const OrderByItemField = withField(() => {\n  const { name, value } = useField<OrderByFieldSchema>();\n  const databaseField = useCurrentDatabaseField(value?.fieldID);\n\n  return (\n    <>\n      <Label\n        className=\"w-[138px]\"\n        extra={<DataTypeTag type={databaseField?.type}></DataTypeTag>}\n      >\n        <span className=\"w-[90px] truncate\">{databaseField?.name}</span>\n      </Label>\n      <AceOrDescField name={`${name}.isAsc`} type={databaseField?.type} />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  SortableList,\n  SortableItem,\n  FieldArrayList,\n  FieldArrayItem,\n  useFieldArray,\n} from '@/form';\n\nimport { type OrderByFieldSchema } from './types';\nimport { OrderByItemField } from './order-by-item-field';\n\nexport function OrderByList() {\n  const { value, move, remove, name, readonly } =\n    useFieldArray<OrderByFieldSchema>();\n  return (\n    <FieldArrayList>\n      <SortableList\n        onSortEnd={({ from, to }) => {\n          move(from, to);\n        }}\n      >\n        {value?.map((item, index) => (\n          <SortableItem\n            key={item?.fieldID}\n            sortableID={item?.fieldID}\n            index={index}\n          >\n            <FieldArrayItem\n              disableRemove={readonly}\n              onRemove={() => {\n                remove(index);\n              }}\n            >\n              <OrderByItemField name={`${name}.${index}`} />\n            </FieldArrayItem>\n          </SortableItem>\n        ))}\n      </SortableList>\n    </FieldArrayList>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useValidateOrderFields } from './use-validate-order-by-fields';\nimport { OrderBySection } from './order-by-section';\nimport { OrderByList } from './order-by-list';\n\nexport function OrderBy() {\n  useValidateOrderFields();\n\n  return (\n    <OrderBySection>\n      <OrderByList />\n    </OrderBySection>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FieldArray, type FieldProps } from '@/form';\n\nimport { OrderBy } from './order-by';\n\nexport function OrderByField({ name }: Pick<FieldProps, 'name'>) {\n  return (\n    <FieldArray name={name}>\n      <OrderBy />\n    </FieldArray>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  DatabaseSelectField,\n  ConditionField,\n  OutputsField,\n} from '@/node-registries/database/common/fields';\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport {\n  databaseSelectFieldName,\n  queryFieldsFieldName,\n  queryConditionFieldName,\n  orderByFieldName,\n  queryLimitFieldName,\n} from '@/constants/database-field-names';\n\nimport { useResetFields } from './use-reset-fields';\nimport { QueryLimitField } from './query-limit-field';\nimport { QueryFieldsField } from './query-fields-field';\nimport { OrderByField } from './order-by-field';\n\nexport const DatabaseQueryForm: React.FC = withNodeConfigForm(() => {\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const resetFields = useResetFields();\n\n  return (\n    <>\n      <DatabaseSelectField\n        name={databaseSelectFieldName}\n        afterChange={resetFields}\n      />\n      {currentDatabase ? (\n        <QueryFieldsField name={queryFieldsFieldName} />\n      ) : null}\n      {currentDatabase ? (\n        <ConditionField\n          label={I18n.t('workflow_query_condition_title')}\n          name={queryConditionFieldName}\n        />\n      ) : null}\n      {currentDatabase ? <OrderByField name={orderByFieldName} /> : null}\n      {currentDatabase ? <QueryLimitField name={queryLimitFieldName} /> : null}\n      <OutputsField deps={[queryFieldsFieldName]} name=\"outputs\" />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useResetCondition } from '@/node-registries/database/common/hooks';\nimport { useForm } from '@/form';\nimport {\n  queryFieldsFieldName,\n  orderByFieldName,\n  queryLimitFieldName,\n  queryConditionFieldName,\n} from '@/constants/database-field-names';\n\nexport function useResetFields() {\n  const form = useForm();\n  const resetCondition = useResetCondition(queryConditionFieldName);\n\n  const resetQueryFields = () => {\n    form.setFieldValue(queryFieldsFieldName, undefined);\n  };\n\n  const resetOrderBy = () => {\n    form.setFieldValue(orderByFieldName, undefined);\n  };\n\n  const resetQueryLimit = () => {\n    form.setFieldValue(queryLimitFieldName, undefined);\n  };\n\n  return () => {\n    resetCondition();\n    resetQueryFields();\n    resetOrderBy();\n    resetQueryLimit();\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ValidateTrigger } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { DatabaseNodeService } from '@/services';\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  createConditionValidator,\n  createDatabaseValidator,\n} from '@/node-registries/database/common/validators';\nimport { getOutputsDefaultValue } from '@/node-registries/database/common/utils';\nimport {\n  queryConditionListFieldName,\n  queryLimitFieldName,\n  queryConditionLogicFieldName,\n} from '@/constants/database-field-names';\n\nimport { DatabaseQueryForm } from './database-query-form';\n\nexport const DatabaseQueryFormMeta: WorkflowNodeRegistry['formMeta'] = {\n  render: () => <DatabaseQueryForm />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    [queryLimitFieldName]: ({ value }) => {\n      if (value < 1 || value > 1000) {\n        return I18n.t('workflow_database_query_limit');\n      }\n    },\n    ...createConditionValidator(queryConditionListFieldName),\n    ...createDatabaseValidator(),\n  },\n  defaultValues: {\n    inputs: {\n      databaseInfoList: [],\n    },\n    outputs: getOutputsDefaultValue(),\n  },\n  effect: {\n    outputs: provideNodeOutputVariablesEffect,\n  },\n  formatOnInit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertConditionDTOToCondition(\n      queryConditionListFieldName,\n      value,\n    );\n\n    value = databaseNodeService.convertConditionLogicDTOToConditionLogic(\n      queryConditionLogicFieldName,\n      value,\n    );\n\n    return value;\n  },\n  formatOnSubmit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertConditionToDTO(\n      queryConditionListFieldName,\n      value,\n      context.node,\n    );\n\n    value = databaseNodeService.convertConditionLogicToConditionLogicDTO(\n      queryConditionLogicFieldName,\n      value,\n    );\n\n    return value;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { DatabaseQueryFormMeta } from './database-query-form-meta';\n\nexport const DATABASE_QUERY_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.DatabaseQuery,\n    meta: {\n      nodeDTOType: StandardNodeType.DatabaseQuery,\n      test,\n      helpLink: '/open/docs/guides/database_select_node',\n    },\n    formMeta: DatabaseQueryFormMeta,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const conditionList = (\n      formData?.inputs?.selectParam?.condition?.conditionList ?? []\n    ).map((item, idx) => {\n      const { left, right } = item;\n      const name = left;\n      const rightValue = right;\n      return {\n        name: `__condition_right_${idx}`,\n        title: `${name}`,\n        input: rightValue,\n      };\n    });\n\n    return generateParametersToProperties(conditionList, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useResetCondition } from '@/node-registries/database/common/hooks';\nimport {\n  ConditionField,\n  DatabaseSelectField,\n  OutputsField,\n  SelectAndSetFieldsField,\n} from '@/node-registries/database/common/fields';\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport { useCurrentDatabaseQuery } from '@/hooks';\nimport {\n  databaseSelectFieldName,\n  updateConditionFieldName,\n  updateSelectAndSetFieldsFieldName,\n} from '@/constants/database-field-names';\n\nimport { useResetSelectAndSetFields } from './use-reset-select-and-set-fields';\n\nexport const DatabaseUpdateForm: React.FC = withNodeConfigForm(() => {\n  const { data: currentDatabase } = useCurrentDatabaseQuery();\n  const resetCondition = useResetCondition(updateConditionFieldName);\n  const resetSelectAndSetFields = useResetSelectAndSetFields();\n\n  return (\n    <>\n      <DatabaseSelectField\n        name={databaseSelectFieldName}\n        afterChange={() => {\n          resetCondition();\n          resetSelectAndSetFields();\n        }}\n      />\n      {currentDatabase ? (\n        <ConditionField\n          label={I18n.t('workflow_update_condition_title')}\n          name={updateConditionFieldName}\n          min={1}\n        />\n      ) : null}\n      {currentDatabase ? (\n        <SelectAndSetFieldsField name={updateSelectAndSetFieldsFieldName} />\n      ) : null}\n      <OutputsField name=\"outputs\" />\n    </>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useForm } from '@/form';\nimport { updateSelectAndSetFieldsFieldName } from '@/constants/database-field-names';\n\nexport function useResetSelectAndSetFields() {\n  const form = useForm();\n  return () => {\n    form.setFieldValue(updateSelectAndSetFieldsFieldName, undefined);\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ValidateTrigger } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\n\nimport { DatabaseNodeService } from '@/services/database-node-service';\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  createConditionValidator,\n  createDatabaseValidator,\n  createSelectAndSetFieldsValidator,\n} from '@/node-registries/database/common/validators';\nimport { getOutputsDefaultValue } from '@/node-registries/database/common/utils';\nimport {\n  updateSelectAndSetFieldsFieldName,\n  updateConditionListFieldName,\n  updateConditionLogicFieldName,\n} from '@/constants/database-field-names';\n\nimport { DatabaseUpdateForm } from './database-update-form';\n\nexport const DatabaseUpdateFormMeta: WorkflowNodeRegistry['formMeta'] = {\n  render: () => <DatabaseUpdateForm />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ...createDatabaseValidator(),\n    ...createConditionValidator(updateConditionListFieldName),\n    ...createSelectAndSetFieldsValidator(),\n  },\n  defaultValues: {\n    inputs: {\n      databaseInfoList: [],\n    },\n    outputs: getOutputsDefaultValue(),\n  },\n  formatOnInit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertSettingFieldDTOToField(\n      updateSelectAndSetFieldsFieldName,\n      value,\n    );\n\n    value = databaseNodeService.convertConditionDTOToCondition(\n      updateConditionListFieldName,\n      value,\n    );\n\n    value = databaseNodeService.convertConditionLogicDTOToConditionLogic(\n      updateConditionLogicFieldName,\n      value,\n    );\n\n    return value;\n  },\n\n  formatOnSubmit: (value, context) => {\n    const databaseNodeService =\n      context.node.getService<DatabaseNodeService>(DatabaseNodeService);\n\n    value = databaseNodeService.convertSettingFieldToDTO(\n      updateSelectAndSetFieldsFieldName,\n      value,\n      context.node,\n    );\n\n    value = databaseNodeService.convertConditionToDTO(\n      updateConditionListFieldName,\n      value,\n      context.node,\n    );\n\n    value = databaseNodeService.convertConditionLogicToConditionLogicDTO(\n      updateConditionLogicFieldName,\n      value,\n    );\n\n    return value;\n  },\n  effect: {\n    outputs: provideNodeOutputVariablesEffect,\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { DatabaseUpdateFormMeta } from './database-update-form-meta';\n\nexport const DATABASE_UPDATE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    meta: {\n      nodeDTOType: StandardNodeType.DatabaseUpdate,\n      test,\n      helpLink: '/open/docs/guides/database_update_node',\n    },\n    type: StandardNodeType.DatabaseUpdate,\n    formMeta: DatabaseUpdateFormMeta,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MemoryApi } from '@coze-arch/bot-api';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  async generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const databaseID = formData?.inputs?.databaseInfoList[0]?.databaseInfoID;\n    if (!databaseID) {\n      return {};\n    }\n    const db = await MemoryApi.GetDatabaseByID({\n      id: databaseID,\n      need_sys_fields: true,\n    });\n    const fieldInfo = formData?.inputs?.updateParam?.fieldInfo ?? [];\n\n    const parameters = fieldInfo.map(item => {\n      const databaseField = db?.database_info?.field_list?.find(\n        field => field.alterId === item.fieldID,\n      );\n      return {\n        name: `__setting_field_${item?.fieldID}`,\n        title: databaseField?.name,\n        input: item?.fieldValue,\n      };\n    });\n\n    const conditionList = (\n      formData?.inputs?.updateParam?.condition?.conditionList ?? []\n    ).map((item, idx) => {\n      const { left, right } = item;\n      const name = left;\n      const rightValue = right;\n      return {\n        name: `__condition_right_${idx}`,\n        title: `${name}`,\n        input: rightValue,\n      };\n    });\n\n    return {\n      ...generateParametersToProperties(conditionList, { node }),\n      ...generateParametersToProperties(parameters, { node }),\n    };\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { DatasetSelect as BaseDatasetSelect } from '@/form-extensions/components/dataset-select';\nimport { useField, withField } from '@/form';\n\nconst DatasetSelect = () => {\n  const { value, onChange, readonly, onBlur } = useField<string[]>();\n\n  return (\n    <BaseDatasetSelect\n      value={value as string[]}\n      onChange={v => {\n        onChange(v);\n        onBlur?.();\n      }}\n      readonly={!!readonly}\n    />\n  );\n};\n\nexport const DatasetSelectField = withField(DatasetSelect);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport {\n  type RefExpression,\n  ValueExpressionType,\n  type ViewVariableType,\n  type LiteralExpression,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport AutoSizeTooltip from '@/ui-components/auto-size-tooltip';\nimport { DataTypeTag } from '@/node-registries/common/components';\nimport { ColumnsTitle } from '@/form-extensions/components/columns-title';\nimport { Section } from '@/form';\n\nimport { ValueExpressionInputField } from '../../../common/fields';\n\ninterface DatasetParamsFieldProps {\n  inputFiedlName: string;\n  paramName: string;\n  inputType?: ViewVariableType;\n  paramType?: ViewVariableType;\n  availableFileTypes?: ViewVariableType[];\n  disabledTypes?: ViewVariableType[];\n  required?: boolean;\n  defaultValue?: RefExpression | LiteralExpression;\n  tooltip?: React.ReactNode;\n  testId?: string;\n}\n\nexport const DatasetParamsField = ({\n  inputFiedlName,\n  paramName,\n  paramType,\n  inputType,\n  availableFileTypes,\n  disabledTypes,\n  required = true,\n  defaultValue = { type: ValueExpressionType.REF },\n  tooltip,\n  testId,\n}: DatasetParamsFieldProps) => (\n  <Section title={I18n.t('workflow_detail_node_input')} tooltip={tooltip}>\n    <ColumnsTitle\n      columns={[\n        {\n          title: I18n.t('workflow_detail_node_parameter_name'),\n          style: { flex: 2 },\n        },\n        {\n          title: I18n.t('workflow_detail_end_output_value'),\n          style: { flex: 3 },\n        },\n      ]}\n      className=\"mb-[8px]\"\n    />\n    <div className=\"w-full flex gap-[4px] items-center\">\n      <div style={{ flex: 2 }}>\n        <div className=\"flex items-center max-w-[120px]\">\n          <AutoSizeTooltip\n            content={paramName}\n            showArrow\n            position=\"top\"\n            className=\"grow-1 truncate\"\n          >\n            <span\n              className={classNames(\n                'flex-1 grow-1 truncate coz-fg-primary text-[12px] leading-[24px]',\n              )}\n            >\n              {paramName}\n            </span>\n          </AutoSizeTooltip>\n          {required ? (\n            <span\n              className=\"mt-[2px]\"\n              style={{\n                color: 'var(--light-usage-danger-color-danger,#f93920)',\n              }}\n            >\n              *\n            </span>\n          ) : null}\n          <DataTypeTag type={paramType} />\n        </div>\n      </div>\n      <div style={{ flex: 3 }}>\n        <ValueExpressionInputField\n          testId={testId}\n          name={inputFiedlName}\n          required={required}\n          inputType={inputType}\n          availableFileTypes={availableFileTypes}\n          disabledTypes={disabledTypes}\n          defaultValue={defaultValue}\n        />\n      </div>\n    </div>\n  </Section>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useDataSetInfos } from '@/hooks';\nimport { type DataSetInfo } from '@/form-extensions/components/dataset-setting/type';\nimport { DataSetSetting as BaseDatasetSetting } from '@/form-extensions/components/dataset-setting';\nimport { useField, useWatch, withField } from '@/form';\n\nconst DatasetSetting = () => {\n  const { value, onChange, onBlur, readonly } = useField<DataSetInfo>();\n  const selectDataSet = useWatch<string[]>(\n    'inputs.datasetParameters.datasetParam',\n  );\n\n  const { dataSets, isReady } = useDataSetInfos({ ids: selectDataSet });\n\n  return (\n    <BaseDatasetSetting\n      dataSetInfo={value as DataSetInfo}\n      onDataSetInfoChange={(v: DataSetInfo) => {\n        onChange(v);\n        onBlur?.();\n      }}\n      readonly={!!readonly}\n      dataSets={dataSets}\n      isReady={isReady}\n    />\n  );\n};\n\nexport const DatasetSettingField = withField(DatasetSetting);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { OutputsField } from '@/node-registries/common/fields';\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Section } from '@/form';\n\nimport { DatasetSelectField } from '../common/componets/dataset-select-field';\nimport { DatasetParamsField } from '../common/componets/dataset-params-field';\nimport { DatasetSettingField } from './components/dataset-setting-field';\n\nconst Render = () => (\n  <NodeConfigForm>\n    <DatasetParamsField\n      inputFiedlName=\"inputs.inputParameters.Query\"\n      testId=\"/inputs/inputParameters/Query\"\n      tooltip={I18n.t(\n        'workflow_detail_knowledge_input_tooltip',\n        {},\n        '',\n      )}\n      paramName={'Query'}\n      paramType={ViewVariableType.String}\n      inputType={ViewVariableType.String}\n    />\n    <Section\n      title={I18n.t('workflow_detail_knowledge_knowledge', {}, '')}\n      tooltip={I18n.t(\n        'workflow_detail_knowledge_knowledge_tooltip',\n        {},\n        '',\n      )}\n    >\n      <div className=\"w-full mb-[16px]\">\n        <DatasetSelectField name=\"inputs.datasetParameters.datasetParam\" />\n      </div>\n      <DatasetSettingField name=\"inputs.datasetParameters.datasetSetting\" />\n    </Section>\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('workflow_detail_knowledge_output_tooltip')}\n      id={'dataset-node-output'}\n      name={'outputs'}\n      withDescription={false}\n      jsonImport={false}\n      customReadonly={true}\n      disabled={true}\n      allowAppendRootData={false}\n      hasFeedback={false}\n    />\n  </NodeConfigForm>\n);\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\n\nimport FormRender from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nconst datasetParamFieldName = 'inputs.datasetParameters.datasetParam';\n\nexport const DATASET_NODE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onBlur,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputs.inputParameters.Query': createValueExpressionInputValidate({\n      required: true,\n    }),\n    [datasetParamFieldName]: ({ value }) => {\n      if (!value || value.length === 0) {\n        return I18n.t('workflow_detail_knowledge_error_empty');\n      }\n      return undefined;\n    },\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { isNil, set } from 'lodash-es';\nimport { BlockInput, ViewVariableType } from '@coze-workflow/base';\n\nexport function transformOnInit(value) {\n  // New drag-in node initialization\n  if (!value) {\n    return {\n      nodeMeta: undefined,\n      inputs: {\n        inputParameters: {\n          Query: { type: 'ref', content: '' },\n        },\n        datasetParameters: {\n          datasetParam: [],\n          datasetSetting: {},\n        },\n      },\n      outputs: [\n        {\n          key: nanoid(),\n          name: 'outputList',\n          type: ViewVariableType.ArrayObject,\n          children: [\n            {\n              key: nanoid(),\n              name: 'output',\n              type: ViewVariableType.String,\n            },\n          ],\n        },\n      ],\n    };\n  }\n\n  const { inputParameters, datasetParam } = value.inputs;\n  const formData = {\n    ...value,\n    inputs: {\n      datasetParameters: {},\n    },\n  };\n\n  formData.inputs.inputParameters = inputParameters.reduce(\n    (map, obj: { name: string | number; input: unknown }) => {\n      map[obj.name] = obj.input;\n      return map;\n    },\n    {},\n  );\n  formData.inputs.datasetParameters.datasetParam = datasetParam[0]?.input.value\n    .content as string[];\n  // In the case of initial creation/stock data, the top_k and min_score are empty, and the initial default value is processed in the dataset-settings component\n  formData.inputs.datasetParameters.datasetSetting = {\n    top_k: datasetParam.find(item => item.name === 'topK')?.input.value\n      .content as number,\n\n    min_score: datasetParam.find(item => item.name === 'minScore')?.input.value\n      .content as number,\n\n    strategy: datasetParam.find(item => item.name === 'strategy')?.input.value\n      .content as number,\n\n    use_nl2sql: datasetParam.find(item => item.name === 'useNl2sql')?.input\n      .value.content as boolean,\n    use_rerank: datasetParam.find(item => item.name === 'useRerank')?.input\n      .value.content as boolean,\n    use_rewrite: datasetParam.find(item => item.name === 'useRewrite')?.input\n      .value.content as boolean,\n    is_personal_only: datasetParam.find(item => item.name === 'isPersonalOnly')\n      ?.input.value.content as boolean,\n  };\n\n  return formData;\n}\n\nexport function transformOnSubmit(value) {\n  const { nodeMeta, inputs, outputs } = value;\n  const { inputParameters = { Query: { type: 'ref' } }, datasetParameters } =\n    inputs ?? {};\n  const { datasetParam, datasetSetting } = datasetParameters ?? {};\n  const actualData = {\n    nodeMeta,\n    outputs,\n    inputs: {\n      datasetParam: [] as unknown[],\n    },\n  };\n\n  set(\n    actualData.inputs,\n    'inputParameters',\n    Object.entries(inputParameters).map(([key, mapValue]) => ({\n      name: key,\n      input: mapValue,\n    })) || [],\n  );\n\n  set(actualData.inputs, 'datasetParam', [\n    {\n      name: 'datasetList',\n      input: {\n        type: 'list',\n        schema: {\n          type: 'string',\n        },\n        value: {\n          type: 'literal',\n          content: datasetParam || [],\n        },\n      },\n    },\n    {\n      name: 'topK',\n      input: {\n        type: 'integer',\n        value: {\n          type: 'literal',\n          content: datasetSetting?.top_k,\n        },\n      },\n    },\n    BlockInput.createBoolean('useRerank', datasetSetting?.use_rerank),\n    BlockInput.createBoolean('useRewrite', datasetSetting?.use_rewrite),\n    BlockInput.createBoolean(\n      'isPersonalOnly',\n      datasetSetting?.is_personal_only,\n    ),\n  ]);\n\n  // No fields are passed without a table knowledge base use_nl2sql\n  if (!isNil(datasetSetting?.use_nl2sql)) {\n    actualData.inputs.datasetParam.push(\n      BlockInput.createBoolean('useNl2sql', datasetSetting?.use_nl2sql),\n    );\n  }\n\n  // Strategy may be fulltext\n  if (datasetSetting?.min_score) {\n    actualData.inputs.datasetParam.push({\n      name: 'minScore',\n      input: {\n        type: 'float',\n        value: {\n          type: 'literal',\n          content: datasetSetting?.min_score,\n        },\n      },\n    });\n  }\n\n  // Added search policy configuration, there may be no strategy data not in grey release\n  // Strategy may be 0\n  if (!isNil(datasetSetting?.strategy)) {\n    actualData.inputs.datasetParam.push({\n      name: 'strategy',\n      input: {\n        type: 'integer',\n        value: {\n          type: 'literal',\n          content: datasetSetting?.strategy,\n        },\n      },\n    });\n  }\n\n  return actualData;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  DEFAULT_OUTPUTS_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { DATASET_NODE_FORM_META } from './form-meta';\nexport const DATASET_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Dataset,\n  meta: {\n    nodeDTOType: StandardNodeType.Dataset,\n    style: {\n      width: 484,\n    },\n    size: { width: DEFAULT_NODE_SIZE.width, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: '/inputs/inputParameters',\n    test,\n    helpLink: '/open/docs/guides/knowledge_node',\n  },\n  formMeta: DATASET_NODE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputs?.inputParameters;\n\n    return generateParametersToProperties(\n      Object.entries(inputParameters || {}).map(([key, value]) => ({\n        name: key,\n        required: true,\n        input: value,\n      })),\n      { node },\n    );\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { DatasetWriteParser as BaseDatasetWriteParser } from '@/form-extensions/components/dataset-write-parser';\nimport { useField, withField } from '@/form';\n\nconst DatasetWriteParser = props => {\n  const { name, value, onChange, readonly } = useField<string[]>();\n\n  return (\n    <BaseDatasetWriteParser\n      value={value as string[]}\n      onChange={onChange}\n      readonly={!!readonly}\n      context={{\n        meta: {\n          name,\n        },\n      }}\n      {...props}\n    />\n  );\n};\n\nexport const DatasetWriteParserField = withField(DatasetWriteParser);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  DatasetWriteChunk as BaseDatasetWriteChunk,\n  type ChunkValue,\n} from '@/form-extensions/components/dataset-write-chunk';\nimport { InputField, useField, withField } from '@/form';\n\nconst DatasetWriteChunk = props => {\n  const { name, value, onChange, onBlur, readonly } = useField<ChunkValue>();\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <BaseDatasetWriteChunk\n      value={value as ChunkValue}\n      onChange={(v: ChunkValue) => {\n        onChange(v);\n        onBlur?.();\n      }}\n      readonly={!!readonly}\n      context={{\n        meta: {\n          name,\n        },\n      }}\n      customInputComp={\n        <InputField\n          name=\"inputs.datasetWriteParameters.chunkStrategy.separator\"\n          style={{\n            fontSize: '12px',\n            width: '100%',\n          }}\n          placeholder={I18n.t('datasets_custom_segmentID_placeholder')}\n          data-testid={getNodeSetterId('dataset-write-separator-input')}\n        />\n      }\n      {...props}\n    />\n  );\n};\n\nexport const DatasetWriteChunkField = withField(DatasetWriteChunk);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section, useWatch } from '@/form';\nimport { ColumnsTitle } from '@/form-extensions/components/columns-title';\nimport { DatasetWriteParserField } from './dataset-write-parser-field';\nimport { DatasetWriteChunkField } from './dataset-write-chunk-field';\n\nconst columnsTitleStyle = {\n  color: 'var(--Fg-COZ-fg-primary, rgba(6, 7, 9, 0.80))',\n  fontSize: '12px',\n  fontStyle: 'normal',\n  fontWeight: '500',\n  lineHeight: '16px',\n};\n\nexport const DatasetWriteSetting = () => {\n  const datasetPatam = useWatch<string[]>({\n    name: 'inputs.datasetParameters.datasetParam',\n  });\n  const isDatasetEmpty = !datasetPatam?.length;\n\n  if (isDatasetEmpty) {\n    return null;\n  }\n\n  return (\n    <Section title={I18n.t('kl_write_033')}>\n      <div className=\"pt-[16px]\">\n        <ColumnsTitle\n          columns={[\n            {\n              title: I18n.t('kl_write_032'),\n              style: columnsTitleStyle,\n            },\n          ]}\n        />\n        <DatasetWriteParserField\n          name=\"inputs.datasetWriteParameters.parsingStrategy\"\n          options={{\n            mode: 'card',\n            direction: 'horizontal',\n            options: [\n              {\n                value: 'fast',\n                label: I18n.t('kl_write_004'),\n                tooltip: I18n.t('kl_write_005'),\n              },\n              {\n                value: 'accurate',\n                label: I18n.t('kl_write_006'),\n                tooltip: I18n.t('kl_write_007'),\n              },\n            ],\n            radioCardClassName: 'px-[11px] py-[6px]',\n          }}\n        />\n      </div>\n      <ColumnsTitle\n        columns={[\n          {\n            title: I18n.t('kl_write_011'),\n            style: columnsTitleStyle,\n          },\n        ]}\n      />\n      <DatasetWriteChunkField\n        name=\"inputs.datasetWriteParameters.chunkStrategy\"\n        feedbackTextClassName=\"w-[160px] text-[12px] leading-[16px] text-[#ff441e]\"\n        hasFeedback={false}\n        options={{\n          mode: 'card',\n          direction: 'horizontal',\n          options: [\n            {\n              value: 'default',\n              label: I18n.t('kl_write_012'),\n              tooltip: I18n.t('kl_write_013'),\n            },\n            // Phase 1 does not support hierarchical segmentation\n            // {\n            //   value: 'layer',\n            //   Labels: 'Segmented by hierarchy',\n            //   tooltip:\n            //     'Segmented according to the document hierarchy, suitable for documents organized according to the hierarchy, such as papers, books, manuals, etc. ',\n            // },\n            {\n              value: 'custom',\n              label: I18n.t('datasets_segment_tag_custom'),\n              tooltip: I18n.t(\n                'datasets_createFileModel_step3_customDescription',\n              ),\n            },\n          ],\n          radioCardClassName: 'px-[11px] py-[6px]',\n        }}\n      />\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Section } from '@/form';\n\nimport { DatasetSelectField } from '../common/componets/dataset-select-field';\nimport { DatasetParamsField } from '../common/componets/dataset-params-field';\nimport { OutputsField } from '../../common/fields';\nimport { DatasetWriteSetting } from './components/dataset-write-setting';\n\nconst FormRender = () => (\n  <NodeConfigForm>\n    <DatasetParamsField\n      inputFiedlName=\"inputs.inputParameters.knowledge\"\n      testId=\"/inputs/inputParameters/knowledge\"\n      tooltip={I18n.t(\n        'knowledge_write_tips_doc',\n        {},\n        ' File-Doc ',\n      )}\n      paramName={'knowledge'}\n      paramType={ViewVariableType.Doc}\n      inputType={ViewVariableType.File}\n      availableFileTypes={[ViewVariableType.Doc, ViewVariableType.Txt]}\n      disabledTypes={ViewVariableType.getComplement([\n        ViewVariableType.Doc,\n        ViewVariableType.Txt,\n      ])}\n    />\n    <Section\n      title={I18n.t('workflow_detail_knowledge_knowledge')}\n      tooltip={I18n.t('knowledge_writing_101')}\n    >\n      <DatasetSelectField name=\"inputs.datasetParameters.datasetParam\" />\n    </Section>\n    <DatasetWriteSetting />\n\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('workflow_detail_knowledge_output_tooltip')}\n      id={'dataset-write-node-output'}\n      name={'outputs'}\n      withDescription={false}\n      jsonImport={false}\n      customReadonly={true}\n      disabled={true}\n      allowAppendRootData={false}\n      hasFeedback={false}\n    />\n  </NodeConfigForm>\n);\n\nexport default FormRender;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { set } from 'lodash-es';\nimport { ViewVariableType } from '@coze-workflow/base';\n\nimport type { DatasetNodeActualData, DatasetNodeFormData } from './type';\n\nconst TEST_RUN_FILE_NAME_KEY = 'x-wf-file_name';\n\nexport function transformOnInit(\n  value: DatasetNodeActualData,\n): DatasetNodeFormData {\n  // New drag-in node initialization\n  if (!value) {\n    return {\n      nodeMeta: undefined,\n      inputs: {\n        inputParameters: {\n          knowledge: { type: 'ref' },\n        },\n        datasetParameters: {\n          datasetParam: [],\n          datasetSetting: {\n            top_k: 1,\n            min_score: 0,\n            strategy: 0,\n          },\n        },\n        datasetWriteParameters: undefined,\n      },\n      outputs: [\n        {\n          key: nanoid(),\n          name: 'documentId',\n          type: ViewVariableType.String,\n        },\n        {\n          key: nanoid(),\n          name: 'fileName',\n          type: ViewVariableType.String,\n        },\n        {\n          key: nanoid(),\n          name: 'fileUrl',\n          type: ViewVariableType.String,\n        },\n      ],\n    };\n  }\n\n  const { inputParameters, datasetParam, strategyParam } = value.inputs;\n  const formData = {\n    ...value,\n  };\n\n  set(\n    formData,\n    'inputs.inputParameters',\n    inputParameters.reduce(\n      (map, obj: { name: string | number; input: unknown }) => {\n        map[obj.name] = obj.input;\n        return map;\n      },\n      {},\n    ),\n  );\n\n  set(\n    formData,\n    'inputs.datasetParameters.datasetParam',\n    datasetParam[0]?.input.value.content,\n  );\n\n  set(formData, 'inputs.datasetWriteParameters', {\n    ...strategyParam,\n    indexStrategy: {\n      ...strategyParam.indexStrategy,\n      vectorModel: {\n        name: strategyParam.indexStrategy.vectorModel,\n      },\n    },\n  });\n\n  return formData as unknown as DatasetNodeFormData;\n}\n\ninterface FileUrlProps {\n  type: string;\n  content?: string | number | boolean | unknown[];\n  rawMeta?: {\n    fileName: string;\n    type: number;\n  };\n}\n\nconst getFormatFileUrl = (inputValue: FileUrlProps) => {\n  const originUrl = inputValue?.content ?? '';\n  const fileName = inputValue?.rawMeta?.fileName ?? '';\n  try {\n    const urlObj = new URL(originUrl as string);\n    const params = new URLSearchParams(urlObj.search);\n\n    if (params.has(TEST_RUN_FILE_NAME_KEY)) {\n      params.set(TEST_RUN_FILE_NAME_KEY, fileName);\n    } else {\n      params.append(TEST_RUN_FILE_NAME_KEY, fileName);\n    }\n\n    urlObj.search = params.toString();\n\n    return urlObj.toString();\n  } catch (e) {\n    return originUrl;\n  }\n};\n\nexport function transformOnSubmit(\n  value: DatasetNodeFormData,\n): DatasetNodeActualData {\n  const { nodeMeta, inputs, outputs } = value;\n  const {\n    inputParameters = { knowledge: { type: 'ref' } },\n    datasetParameters,\n    datasetWriteParameters,\n  } = inputs ?? {};\n  const { datasetParam } = datasetParameters ?? {};\n  const actualData = { nodeMeta, outputs, inputs: {} };\n\n  const nextInputParameters =\n    Object.entries(inputParameters).map(([key, mapValue]) => ({\n      name: key,\n      input: mapValue as FileUrlProps,\n    })) || [];\n\n  if (\n    nextInputParameters?.[0]?.input?.type !== 'ref' &&\n    nextInputParameters?.[0]?.input?.content\n  ) {\n    nextInputParameters[0].input.content = getFormatFileUrl(\n      nextInputParameters[0].input,\n    );\n  }\n\n  set(actualData.inputs, 'inputParameters', nextInputParameters);\n\n  set(actualData.inputs, 'datasetParam', [\n    {\n      name: 'datasetList',\n      input: {\n        type: 'list',\n        schema: {\n          type: 'string',\n        },\n        value: {\n          type: 'literal',\n          content: datasetParam || [],\n        },\n      },\n    },\n  ]);\n\n  set(actualData.inputs, 'strategyParam', {\n    parsingStrategy: datasetWriteParameters?.parsingStrategy,\n    chunkStrategy: datasetWriteParameters?.chunkStrategy,\n    indexStrategy: {\n      ...datasetWriteParameters?.indexStrategy,\n      vectorModel: datasetWriteParameters?.indexStrategy?.vectorModel?.name,\n    },\n  });\n\n  return actualData as DatasetNodeActualData;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { createValueExpressionInputValidate } from '@/node-registries/common/validators';\nimport { fireNodeTitleChange } from '@/node-registries/common/effects';\n\nimport FormRender from './form';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nconst datasetParamFieldName = 'inputs.datasetParameters.datasetParam';\nconst separatorFieldName =\n  'inputs.datasetWriteParameters.chunkStrategy.separator';\n\nexport const DATASET_WRITE_FORM_META: FormMetaV2<FormData> = {\n  render: () => <FormRender />,\n\n  validateTrigger: ValidateTrigger.onBlur,\n\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputs.inputParameters.knowledge': createValueExpressionInputValidate({\n      required: true,\n    }),\n    [datasetParamFieldName]: ({ value }) => {\n      if (!value || value.length === 0) {\n        return I18n.t('workflow_detail_knowledge_error_empty');\n      }\n      return undefined;\n    },\n    [separatorFieldName]: ({ value, formValues }) => {\n      const separatorType = get(\n        formValues,\n        'inputs.datasetWriteParameters.chunkStrategy.separatorType',\n      );\n\n      if (separatorType === 'custom' && !value) {\n        return I18n.t('datasets_custom_segmentID_error');\n      }\n\n      return undefined;\n    },\n  },\n\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { DATASET_WRITE_FORM_META } from './form-meta';\n\nexport const DATASET_WRITE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.DatasetWrite,\n  meta: {\n    nodeDTOType: StandardNodeType.DatasetWrite,\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    style: {\n      width: 484,\n    },\n    size: { width: 484, height: 416 },\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    inputParametersPath: '/inputs/inputParameters',\n    test,\n    helpLink: '/open/docs/guides/knowledge_base_writing_node',\n  },\n  formMeta: DATASET_WRITE_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputs?.inputParameters;\n\n    return generateParametersToProperties(\n      Object.entries(inputParameters || {}).map(([key, value]) => ({\n        name: key,\n        required: true,\n        input: value,\n      })),\n      { node },\n    );\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport md5 from 'md5';\nimport { get } from 'lodash-es';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport {\n  DEFAULT_NODE_META_PATH,\n  type FormNodeMeta,\n} from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta, type WorkflowNodeEntity } from '@/test-run-kit';\n\nimport { AuthType, BodyType } from './setters/constants';\nimport { getVariableInfoFromExpression } from './components/variable-support/utils';\n\nconst generateExpressionString = (\n  expressionStr,\n  {\n    node,\n    /**\n     * Label prefix for form display\n     */\n    labelPrefix = '',\n    /**\n     * Name prefix, used to distinguish variables\n     */\n    namePrefix = '',\n  }: {\n    node: WorkflowNodeEntity;\n    labelPrefix?: string;\n    namePrefix?: string;\n  },\n) => {\n  if (!expressionStr) {\n    return {};\n  }\n  const doubleBracedPattern = /{{([^}]+)}}/g;\n  const matches = expressionStr.match(doubleBracedPattern);\n  // Remove {{}} from string\n  const matchesContent = matches?.map((varStr: string) =>\n    varStr.replace(/^{{|}}$/g, ''),\n  );\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const parameters: any[] = [];\n  const cache: Record<string, boolean> = {};\n\n  matchesContent?.forEach((varStr: string) => {\n    const { nodeNameWithDot, fieldPart, fieldKeyPath } =\n      getVariableInfoFromExpression(varStr);\n\n    // case:__body_bodyData_rawText + md5(\"block_out_100001.input.field\")\n    const fieldName = namePrefix + md5(nodeNameWithDot + fieldPart);\n    const workflowVariable =\n      node.context.variableService.getWorkflowVariableByKeyPath(fieldKeyPath, {\n        node,\n      });\n    // Duplicate variables are displayed only once\n    if (\n      !cache[fieldName] &&\n      workflowVariable &&\n      !workflowVariable.globalVariableKey\n    ) {\n      cache[fieldName] = true;\n      const variableNode: WorkflowNodeEntity = workflowVariable?.node;\n      const variableNodeTitle = variableNode\n        ? variableNode\n            .getData<FlowNodeFormData>(FlowNodeFormData)\n            .formModel.getFormItemValueByPath<FormNodeMeta>(\n              DEFAULT_NODE_META_PATH,\n            )?.title\n        : '';\n      parameters.push({\n        title: [labelPrefix, variableNodeTitle, fieldPart]\n          .filter(Boolean)\n          .join('-'),\n        name: fieldName,\n        required: true,\n        input: {\n          type: 'ref',\n          content: {\n            keyPath: fieldKeyPath,\n          },\n        },\n      });\n    }\n  });\n\n  return generateParametersToProperties(parameters, { node });\n};\n\nconst generateAuth = (node: WorkflowNodeEntity) => {\n  const formData = node\n    .getData(FlowNodeFormData)\n    .formModel.getFormItemValueByPath('/');\n  const isAuthOpen = formData?.inputs?.auth?.authOpen;\n  const authType = formData?.inputs?.auth?.authType;\n  if (!isAuthOpen || !authType) {\n    return {};\n  }\n  const authDataPathMap = {\n    [AuthType.BasicAuth]: 'auth.authData.basicAuthData',\n    [AuthType.Bearer]: 'auth.authData.bearerTokenData',\n    [AuthType.Custom]: 'auth.authData.customData.data',\n  };\n  const pathStr = authDataPathMap[authType].split('.').join('_');\n  const parameters = (\n    get(formData.inputs, authDataPathMap[authType]) || []\n  ).map(i => ({\n    ...i,\n    name: `__${pathStr}_${i.name}`,\n    title: `${I18n.t('node_http_auth')}-${i.name}`,\n  }));\n  return generateParametersToProperties(parameters, { node });\n};\n\nconst generateBody = (node: WorkflowNodeEntity) => {\n  const formData = node\n    .getData(FlowNodeFormData)\n    .formModel.getFormItemValueByPath('/');\n  const bodyType = formData?.inputs?.body?.bodyType;\n  const bodyDataPathMap = {\n    [BodyType.Binary]: 'body.bodyData.binary',\n    [BodyType.FormData]: 'body.bodyData.formData',\n    [BodyType.FormUrlEncoded]: 'body.bodyData.formURLEncoded',\n    [BodyType.Json]: 'body.bodyData.json',\n    [BodyType.RawText]: 'body.bodyData.rawText',\n  };\n  const dataPath = bodyDataPathMap[bodyType];\n  const parameters = get(formData.inputs, dataPath);\n  if (bodyType === BodyType.FormUrlEncoded || bodyType === BodyType.FormData) {\n    const prefixName =\n      bodyType === BodyType.FormUrlEncoded ? 'formUrlEncoded' : 'formData';\n    const pathStr = dataPath.split('.').join('_');\n    return generateParametersToProperties(\n      parameters.map(i => ({\n        ...i,\n        name: `__${pathStr}_${md5(i.name as string)}`,\n        title: `${prefixName}-${i.name}`,\n      })),\n      { node },\n    );\n  } else if (bodyType === BodyType.Json || bodyType === BodyType.RawText) {\n    return generateExpressionString(parameters, {\n      node,\n      labelPrefix: I18n.t('node_http_body'),\n      namePrefix: `__${dataPath.replaceAll('.', '_')}_`,\n    });\n  } else if (bodyType === BodyType.Binary) {\n    return generateParametersToProperties(\n      [\n        {\n          name: `__${dataPath.replaceAll('.', '_')}_fileURL`,\n          title: `${I18n.t('node_http_body')}-${I18n.t(\n            'node_http_body_binary',\n          )}`,\n          input: parameters?.fileURL,\n        },\n      ],\n      { node },\n    );\n  }\n  return {};\n};\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const url = formData.inputs?.apiInfo?.url;\n    const params = formData?.inputs?.params || [];\n    const headers = formData?.inputs?.headers || [];\n    return {\n      ...generateExpressionString(url, {\n        node,\n        labelPrefix: I18n.t('node_http_api'),\n        namePrefix: '__apiInfo_url_',\n      }),\n      ...generateParametersToProperties(\n        params.map(i => ({\n          ...i,\n          name: `__params_${md5(i.name as string)}`,\n          title: `${I18n.t('node_http_request_params')}-${i.name}`,\n        })),\n        { node },\n      ),\n      ...generateParametersToProperties(\n        headers.map(i => ({\n          ...i,\n          name: `__headers_${md5(i.name as string)}`,\n          title: `${I18n.t('node_http_headers')}-${i.name}`,\n        })),\n        { node },\n      ),\n      ...generateAuth(node),\n      ...generateBody(node),\n    };\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useLatest } from '../utils';\n\ntype Keymap = Record<string, (e: KeyboardEvent) => void>;\n\nfunction useKeyboard(enable: boolean, keymap: Keymap) {\n  const keymapRef = useLatest(keymap);\n\n  useEffect(() => {\n    if (!enable) {\n      return;\n    }\n\n    function handleKeydown(e: KeyboardEvent) {\n      const callback = keymapRef.current[e.key];\n      if (typeof callback === 'function') {\n        callback(e);\n      }\n    }\n\n    document.addEventListener('keydown', handleKeydown, true);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeydown, true);\n    };\n  }, [enable, keymapRef]);\n}\n\nexport { useKeyboard };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WidgetType } from '@codemirror/view';\n\nimport type { InputVariableInfo, RangeType } from './types';\n\nimport s from './index.module.less';\n\nexport class VariableSubfixWidget extends WidgetType {\n  constructor(\n    protected range: RangeType,\n    protected variableContext: {\n      varaibleInfo: InputVariableInfo;\n      isDarkTheme?: boolean;\n      noLabel?: boolean;\n    },\n    protected openList?: (range: RangeType) => void,\n  ) {\n    super();\n  }\n\n  // Insert variable block dom in editor\n  toDOM() {\n    const node = document.createElement('span');\n    node.classList.add(s.content);\n    // Global variable cursor style\n    if (this.variableContext.varaibleInfo.globalVariableKey) {\n      node.classList.add(s['pointer-content']);\n    }\n    if (!this.variableContext.varaibleInfo.isValid) {\n      node.classList.add(s['error-content']);\n    }\n    if (this.variableContext?.isDarkTheme) {\n      node.classList.add(s['dark-suffix']);\n    }\n    node.onclick = () => {\n      this.openList?.(this.range);\n    };\n    if (!this.variableContext?.noLabel) {\n      node.innerText = this.variableContext.varaibleInfo\n        .parsedKeyPath as string;\n    } else {\n      node.classList.add(s['variable-suffix']);\n    }\n    return node;\n  }\n\n  eq(other: VariableSubfixWidget) {\n    return (\n      this.range.from === other.range.from &&\n      this.range.to === other.range.to &&\n      this.variableContext.varaibleInfo ===\n        other.variableContext.varaibleInfo &&\n      this.variableContext?.noLabel === other.variableContext?.noLabel &&\n      this.variableContext?.isDarkTheme === other.variableContext?.isDarkTheme\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WidgetType } from '@codemirror/view';\n\nimport { getIconSvgString } from './utils';\nimport type { InputVariableInfo, RangeType } from './types';\n\nimport s from './index.module.less';\n\nexport class VariablePrefixWidget extends WidgetType {\n  constructor(\n    protected openList: (range: RangeType) => void,\n    protected variableContext: {\n      nodeName: string;\n      varaibleInfo: InputVariableInfo;\n      range: {\n        from: number;\n        to: number;\n      };\n      isDarkTheme?: boolean;\n      languageId?: string;\n    },\n    protected readonly?: boolean,\n  ) {\n    super();\n  }\n\n  // Insert variable block dom in editor\n  toDOM() {\n    const { range, varaibleInfo, nodeName, isDarkTheme, languageId } =\n      this.variableContext;\n    const node = document.createElement('span');\n    node.classList.add(s.node);\n    if (isDarkTheme) {\n      node.classList.add(s.nodeDark);\n    }\n    node.onclick = () => {\n      if (this.readonly) {\n        return;\n      }\n      this.openList(range);\n    };\n\n    if (!varaibleInfo.isValid) {\n      node.classList.add(s['node-error']);\n    }\n\n    let icon: HTMLImageElement | HTMLDivElement;\n\n    if (varaibleInfo?.globalVariableKey) {\n      icon = document.createElement('div');\n      icon.innerHTML = getIconSvgString(isDarkTheme ? 'white' : '#080D1E')[\n        varaibleInfo?.globalVariableKey\n      ];\n      icon.classList.add(s.svg);\n    } else {\n      icon = document.createElement('img');\n      (icon as HTMLImageElement).src = varaibleInfo?.iconUrl ?? '';\n      icon.classList.add(s.image);\n    }\n\n    const nodeNamePart = document.createElement('span');\n    nodeNamePart.classList.add(s.nodeName);\n    nodeNamePart.classList.add(\n      languageId === 'json' ? s.jsonLineHeight : s.baseLineHeight,\n    );\n    nodeNamePart.innerText = varaibleInfo?.nodeTitle ?? nodeName;\n\n    const split = document.createElement('span');\n    split.classList.add(s.split);\n    split.innerText = '-';\n\n    const wrapper = document.createElement('span');\n    wrapper.classList.add(s.wrapper);\n\n    wrapper.appendChild(icon);\n    wrapper.appendChild(nodeNamePart);\n    wrapper.appendChild(split);\n\n    node.appendChild(wrapper);\n\n    return node;\n  }\n\n  eq(other: VariablePrefixWidget) {\n    return (\n      this.openList === other.openList &&\n      this.variableContext.nodeName === other.variableContext.nodeName &&\n      this.variableContext.range.from === other.variableContext.range.from &&\n      this.variableContext.range.to === other.variableContext.range.to &&\n      this.variableContext.varaibleInfo ===\n        other.variableContext.varaibleInfo &&\n      this.readonly === other.readonly &&\n      this.variableContext.isDarkTheme === other.variableContext.isDarkTheme\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { WidgetType } from '@codemirror/view';\n\nimport { getIconSvgString } from './utils';\nimport type { RangeType } from './types';\n\nimport s from './index.module.less';\n\nexport class VariableDeleteWidget extends WidgetType {\n  constructor(\n    protected range: RangeType,\n    protected openList: (range: RangeType) => void,\n  ) {\n    super();\n  }\n\n  // Insert variable block dom in editor\n  toDOM() {\n    const wrapper = document.createElement('span');\n    wrapper.classList.add(s['deleted-variable']);\n    wrapper.onclick = () => {\n      this.openList(this.range);\n    };\n\n    const img = document.createElement('div');\n    img.classList.add(s.svg);\n    img.innerHTML = getIconSvgString().delete;\n\n    const text = document.createElement('span');\n    text.classList.add(s['deleted-text']);\n    text.innerText = I18n.t('node_http_var_infer_delete', {}, '');\n\n    wrapper.appendChild(img);\n    wrapper.appendChild(text);\n\n    return wrapper;\n  }\n\n  eq(other: VariableDeleteWidget) {\n    return (\n      this.openList === other.openList &&\n      this.range.from === other.range.from &&\n      this.range.to === other.range.to\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useLayoutEffect, useRef } from 'react';\n\nimport classNames from 'classnames';\nimport { useGetWorkflowVariableByKeyPath } from '@coze-workflow/variable';\nimport { useInjector } from '@coze-editor/editor/react';\nimport {\n  type SelectionEnlargerSpec,\n  astDecorator,\n  deletionEnlarger,\n  selectionEnlarger,\n} from '@coze-editor/editor';\nimport { StateField } from '@codemirror/state';\n\nimport { VariableSubfixWidget } from '../variable-subfix-widget';\nimport { VariablePrefixWidget } from '../variable-prefix-widget';\nimport { VariableDeleteWidget } from '../variable-deleted-widget';\nimport {\n  useLatest,\n  findInputVariable,\n  getVariableRanges,\n  getVariableInfoFromExpression,\n} from '../utils';\nimport type { RangeType, InputVariableInfo } from '../types';\nimport s from '../index.module.less';\n\n/**\n * Variable text is replaced with a custom style\n */\nexport const useVariableInjector = ({\n  availableVariables,\n  openUpdateDropdown,\n  updateRange,\n  setPos,\n  readonly,\n  isDarkTheme,\n  languageId,\n}) => {\n  const darkThemeRef = useLatest(isDarkTheme);\n  const openUpdateDropdownRef = useLatest(openUpdateDropdown);\n\n  const varibaleInfoRef = useRef<InputVariableInfo>();\n  const injector = useInjector();\n  const getVariableByKeyPath = useGetWorkflowVariableByKeyPath();\n\n  useLayoutEffect(() => {\n    const field = StateField.define<SelectionEnlargerSpec[]>({\n      create(state) {\n        return getVariableRanges(state);\n      },\n      update(value, tr) {\n        if (tr.docChanged) {\n          return getVariableRanges(tr.state);\n        }\n        return value;\n      },\n    });\n\n    return injector.inject([\n      field,\n      selectionEnlarger.of(state => state.field(field)),\n      deletionEnlarger.of(state => state.field(field)),\n      astDecorator.whole.of((cursor, state) => {\n        if (\n          cursor.name === 'Interpolation' &&\n          cursor.node.firstChild?.name === '{{' &&\n          cursor.node.lastChild?.name === '}}'\n        ) {\n          const from = cursor.node.firstChild.to;\n          const to = cursor.node.lastChild.from;\n          const sliceContent = state.sliceDoc(from, to);\n\n          const {\n            globalVariableKey,\n            nodeName,\n            nodeNameWithDot,\n            fieldPart,\n            fieldKeyPath,\n            parsedKeyPath,\n          } = getVariableInfoFromExpression(sliceContent);\n\n          if (nodeName && fieldPart) {\n            const nodeNameWithDotLength = nodeNameWithDot?.length;\n            const matchedVariable = getVariableByKeyPath(fieldKeyPath);\n\n            const varaibleInfo = findInputVariable(\n              availableVariables,\n              {\n                globalVariableKey,\n                nodePart: nodeName,\n                fieldPart,\n                parsedKeyPath,\n              },\n              matchedVariable,\n            );\n\n            varibaleInfoRef.current = varaibleInfo;\n\n            // Variable does not exist\n            if (!varaibleInfo?.isVariableExist) {\n              const variableDeleteWidget = new VariableDeleteWidget(\n                {\n                  from: from - 2,\n                  to: to + 2,\n                },\n                (range: RangeType) => {\n                  openUpdateDropdownRef.current();\n                  updateRange.current = range;\n                  // When clicking on a variable, set the pop-up position\n                  setPos(from);\n                },\n              );\n              return [\n                {\n                  type: 'replace',\n                  from: cursor.from,\n                  to: cursor.node.lastChild.to,\n                  widget: variableDeleteWidget,\n                  atomicRange: true,\n                },\n              ];\n            }\n\n            const variablePrefixWidget = new VariablePrefixWidget(\n              (range: RangeType) => {\n                openUpdateDropdownRef.current();\n                updateRange.current = range;\n                // When clicking on a variable, set the pop-up position\n                setPos(from);\n              },\n              {\n                nodeName,\n                range: {\n                  from: from - 2,\n                  to: to + 2,\n                },\n                varaibleInfo: varibaleInfoRef.current,\n                isDarkTheme: darkThemeRef.current,\n                languageId,\n              },\n              readonly,\n            );\n\n            const variableSubfixWidget = new VariableSubfixWidget(\n              {\n                from: from - 2,\n                to: to + 2,\n              },\n              { varaibleInfo, isDarkTheme },\n              (range: RangeType) => {\n                openUpdateDropdownRef.current();\n                updateRange.current = range;\n                // When clicking on a variable, set the pop-up position\n                setPos(from);\n              },\n            );\n\n            const flowVariableSubfixWidget = new VariableSubfixWidget(\n              {\n                from,\n                to,\n              },\n              { varaibleInfo, isDarkTheme, noLabel: true },\n            );\n\n            return [\n              {\n                type: 'replace',\n                from: cursor.from,\n                to: from + nodeNameWithDotLength,\n                widget: variablePrefixWidget,\n                atomicRange: true,\n              },\n              globalVariableKey\n                ? {\n                    type: 'replace',\n                    from: from + nodeNameWithDotLength,\n                    to,\n                    // Global variable scene, non-editable variable fields\n                    widget: variableSubfixWidget,\n                    atomicRange: true,\n                  }\n                : {\n                    type: 'className',\n                    className: classNames(s.content, {\n                      [s['dark-content']]: isDarkTheme,\n                      [s['error-content']]: !varaibleInfo.isValid,\n                    }),\n                    from: from + nodeNameWithDotLength,\n                    to,\n                  },\n\n              {\n                type: 'replace',\n                from: to,\n                to: cursor.node.lastChild.to,\n                widget: flowVariableSubfixWidget,\n                atomicRange: true,\n              },\n            ];\n          }\n        }\n      }),\n    ]);\n  }, [injector, availableVariables, isDarkTheme]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\nimport { useEditor } from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-universal';\n\nimport { getOptionInfoFromDOM } from '../utils';\nimport { useOptionsOperations } from './use-options-operations';\nimport { useKeyboard } from './use-keyboard';\n\nexport const useKeyboardActions = ({\n  dropDownVisible,\n  editorRef,\n  interpolationContent,\n  dropdownRef,\n  variableMenuRef,\n  openMenu,\n  setActiveOptionHover,\n  setTreeVisible,\n  isInputDropdownOpen,\n  applyNode,\n}) => {\n  const editor = useEditor<EditorAPI>();\n\n  const isOptionsVisible = getOptionInfoFromDOM(\n    variableMenuRef.current?.treeContainerRef,\n    '.semi-tree-option-list .semi-tree-option',\n  );\n\n  /**\n   * Disable the default behavior of ArrowUp/ArrowDown/Enter when the recommendation panel appears\n   * Change up and down keys to switch recommendations\n   * Left-click to close the variable list, right-click to open the variable list, and press Enter to insert.\n   */\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    if (dropDownVisible) {\n      editor.disableKeybindings([\n        'ArrowUp',\n        'ArrowLeft',\n        'ArrowRight',\n        'ArrowDown',\n      ]);\n    }\n\n    // When the variable list is detected, disable carriage return\n    if (isOptionsVisible) {\n      editor.disableKeybindings([\n        'Enter',\n        'ArrowUp',\n        'ArrowLeft',\n        'ArrowRight',\n        'ArrowDown',\n      ]);\n    }\n\n    if (!dropDownVisible && !isOptionsVisible) {\n      editor.disableKeybindings([]);\n    }\n  }, [dropDownVisible, editor, isOptionsVisible]);\n\n  const { prev, next, left, right, apply } = useOptionsOperations({\n    editorRef,\n    context: interpolationContent,\n    dropdownContext: {\n      setActiveOptionHover,\n      dropdownRef,\n      variableMenuRef,\n    },\n    setTreeVisible,\n    isInputDropdownOpen,\n    applyNode,\n  });\n\n  // Press the up and down keys to switch the recommended items, and press Enter to fill in.\n  useKeyboard(dropDownVisible, {\n    ArrowUp: prev,\n    ArrowDown: next,\n    ArrowLeft: left,\n    ArrowRight: right,\n    Enter: apply,\n  });\n\n  // ESC Close\n  useKeyboard(dropDownVisible, {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Escape() {\n      openMenu(false);\n      setTreeVisible(false);\n    },\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { getOptionInfoFromDOM, selectNodeByIndex } from '../utils';\nimport type { UseOptionsOperationsProps } from '../types';\n\nfunction useOptionsOperations(props: UseOptionsOperationsProps) {\n  const {\n    editorRef,\n    dropdownContext: { dropdownRef, setActiveOptionHover, variableMenuRef },\n    setTreeVisible,\n    isInputDropdownOpen,\n    applyNode,\n  } = props;\n\n  return useMemo(() => {\n    function prev() {\n      if (variableMenuRef.current) {\n        // operation variable menu\n        const optionsInfo = getOptionInfoFromDOM(\n          variableMenuRef.current?.treeContainerRef,\n          '.semi-tree-option-list .semi-tree-option',\n        );\n\n        if (!optionsInfo) {\n          return;\n        }\n\n        const { elements, selectedIndex } = optionsInfo;\n        if (elements.length === 1) {\n          return;\n        }\n\n        const newIndex =\n          selectedIndex - 1 < 0 ? elements.length - 1 : selectedIndex - 1;\n        selectNodeByIndex(elements, newIndex);\n        return;\n      }\n      const optionsInfo = getOptionInfoFromDOM(dropdownRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { elements, selectedIndex } = optionsInfo;\n\n      if (elements.length === 1) {\n        return;\n      }\n\n      const newIndex =\n        selectedIndex - 1 < 0 ? elements.length - 1 : selectedIndex - 1;\n      selectNodeByIndex(elements, newIndex);\n      setActiveOptionHover(newIndex);\n    }\n\n    function next() {\n      if (variableMenuRef.current) {\n        // operation variable menu\n        const optionsInfo = getOptionInfoFromDOM(\n          variableMenuRef.current?.treeContainerRef,\n          '.semi-tree-option-list .semi-tree-option',\n        );\n\n        if (!optionsInfo) {\n          return;\n        }\n\n        const { elements, selectedIndex } = optionsInfo;\n        const newIndex =\n          selectedIndex + 1 >= elements.length ? 0 : selectedIndex + 1;\n        selectNodeByIndex(elements, newIndex);\n        return;\n      }\n\n      const optionsInfo = getOptionInfoFromDOM(dropdownRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n\n      const { elements, selectedIndex } = optionsInfo;\n\n      const newIndex =\n        selectedIndex + 1 >= elements.length ? 0 : selectedIndex + 1;\n      selectNodeByIndex(elements, newIndex);\n      setActiveOptionHover(newIndex);\n    }\n\n    function left() {\n      // As soon as you press the left button, the variables panel should close\n      setTreeVisible(false);\n      const optionsInfo = getOptionInfoFromDOM(dropdownRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n      setActiveOptionHover(NaN);\n    }\n\n    /**\n     * Open directly when the variable panel is closed\n     */\n    function right() {\n      if (!variableMenuRef.current) {\n        setTreeVisible(true);\n      }\n      const optionsInfo = getOptionInfoFromDOM(dropdownRef.current);\n      if (!optionsInfo) {\n        return;\n      }\n      const { selectedIndex } = optionsInfo;\n      setActiveOptionHover(selectedIndex);\n    }\n\n    function apply() {\n      if (!variableMenuRef.current?.treeRef) {\n        return;\n      }\n      const optionsInfo = getOptionInfoFromDOM(\n        variableMenuRef.current?.treeContainerRef,\n        '.semi-tree-option-list .semi-tree-option',\n      );\n      if (!optionsInfo) {\n        return;\n      }\n      const { selectedElement } = optionsInfo;\n      const selectedDataKey = selectedElement?.getAttribute('data-key');\n      if (!selectedDataKey) {\n        return;\n      }\n      const variableTreeNode =\n        variableMenuRef.current?.treeRef?.state?.keyEntities?.[selectedDataKey]\n          ?.data;\n      if (!variableTreeNode) {\n        return;\n      }\n\n      applyNode(\n        variableTreeNode,\n        { type: isInputDropdownOpen ? 'input' : 'update' },\n        editorRef,\n      );\n    }\n\n    return {\n      prev,\n      next,\n      left,\n      right,\n      apply,\n    };\n  }, [isInputDropdownOpen, setTreeVisible]);\n}\n\nexport { useOptionsOperations };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useRef, useCallback, useEffect } from 'react';\n\nimport type { WorkflowVariableFacade } from '@coze-workflow/variable/src/core/workflow-variable-facade';\nimport {\n  WORKFLOW_VARIABLE_SOURCE,\n  TRANS_WORKFLOW_VARIABLE_SOURCE,\n  allGlobalVariableKeys,\n} from '@coze-workflow/variable';\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport {\n  getCurrentMentionReplaceRange,\n  Mention,\n  PositionMirror,\n  useEditor,\n} from '@coze-editor/editor/react';\nimport { type EditorAPI } from '@coze-editor/editor/preset-universal';\nimport { Completion } from '@coze-common/editor-plugins/expression';\nimport { I18n } from '@coze-arch/i18n';\nimport type { TreeNodeData } from '@coze-arch/bot-semi/Tree';\nimport { Dropdown, Toast, type Tree } from '@coze-arch/coze-design';\nimport type { EditorState } from '@codemirror/state';\n\nimport { SelectType } from '@/form-extensions/components/tree-variable-selector/types';\nimport CompositeSelectTreePanel from '@/form-extensions/components/tree-variable-selector/composite-select-tree-panel';\n\nimport { useLatest } from './utils';\nimport type { ApplyNodeType, VariableWithNodeInfo } from './types';\nimport { useInterpolationContent } from './hooks/use-interpolation-content';\nimport { useSelection, useKeyboardActions, useVariableInjector } from './hooks';\nimport { DropdownType } from './constants';\n\nconst DEFAULT_MIN_WIDTH = 206;\n\ninterface VariableExtensionProps {\n  availableVariables: VariableWithNodeInfo[];\n  getVariableByKeyPath: (\n    keyPath: string[],\n  ) => WorkflowVariableFacade | undefined;\n  variableDataSource?: TreeNodeData[];\n  readonly?: boolean;\n  variableTree?: ExpressionEditorTreeNode[];\n  isDarkTheme?: boolean;\n  languageId?: string;\n}\n\nconst DROPDOWN_CLASS = 'tree-variable-selector-dropdown';\n\n/**\n * Wrokflow variable extension\n * - Support process variables + global variables\n */\nexport function VariableExtension({\n  readonly,\n  availableVariables,\n  variableDataSource,\n  getVariableByKeyPath,\n  variableTree,\n  isDarkTheme,\n  languageId,\n}: VariableExtensionProps) {\n  const editor = useEditor<EditorAPI>();\n  const [pos, setPos] = useState(-1); // Current cursor position\n  const [posKey, setPosKey] = useState('');\n\n  const inputDropdownRef = useRef(null);\n  const inputTreeRef = useRef(null);\n\n  const updateDropdownRef = useRef<HTMLDivElement>(null);\n  const updateTreeRef = useRef<{\n    treeRef: Tree;\n    treeContainerRef: HTMLDivElement;\n  }>(null);\n\n  const editorRef = useLatest(editor);\n  const selection = useSelection(editor);\n  const interpolationContent = useInterpolationContent(\n    editor,\n    selection?.anchor,\n  );\n\n  // Control the visibility of input prompt boxes\n  const [inputDropdownOpen, setInputOpen] = useState(false);\n  // Controls the visibility of the edit variable prompt box\n  const [updateDropdownOpen, setUpdateOpen] = useState(false);\n  // How to open the current prompt panel\n  const [dropdownType, setDropdownType] = useState(DropdownType.Input);\n  const isInputDropdownOpen = dropdownType === DropdownType.Input;\n  const updateRange = useRef({\n    from: 0,\n    to: 0,\n  });\n\n  const dropDownVisible = updateDropdownOpen || inputDropdownOpen;\n\n  // variable insertion logic\n  useVariableInjector({\n    availableVariables,\n    openUpdateDropdown: () => {\n      if (variableDataSource?.length && !readonly) {\n        // Do not open when variable is empty\n        setUpdateOpen(true);\n      }\n      setDropdownType(DropdownType.Update);\n    },\n    updateRange,\n    setPos,\n    readonly,\n    isDarkTheme,\n    languageId,\n  });\n\n  const [activeOption, setActiveOption] = useState<string | undefined>('');\n  const [treeVisible, setTreeVisible] = useState(false);\n\n  useEffect(() => {\n    if (!dropDownVisible) {\n      setActiveOption('');\n    }\n  }, [dropDownVisible]);\n\n  // Replace selected variable\n  const handleSelect: ApplyNodeType = (\n    data,\n    { type, customRange },\n    curEditorRef,\n  ) => {\n    const curEditor = editor ?? curEditorRef?.current;\n    if (!curEditor) {\n      return;\n    }\n    const variable = getVariableByKeyPath(data?.path ?? []);\n    if (!variable?.expressionPath) {\n      Toast.error(I18n.t('node_http_var_infer_delete', {}, ''));\n      return;\n    }\n    curEditor.focus();\n    const { expressionPath: curExpressionPath } = variable;\n    const globalVariableKey =\n      curExpressionPath.source !== WORKFLOW_VARIABLE_SOURCE;\n    let textContent = '';\n    if (globalVariableKey) {\n      // KeyPath already includes the source.\n      textContent =\n        curExpressionPath.keyPath?.reduce((pre, cur) => {\n          if (pre) {\n            return `${pre}[\"${cur}\"]`;\n          }\n          return cur;\n        }, '') ?? '';\n    } else {\n      textContent =\n        TRANS_WORKFLOW_VARIABLE_SOURCE +\n        (curExpressionPath.keyPath?.join('.') ?? '');\n    }\n\n    // Next time you open the menu, the Variables panel should not automatically expand\n    setTreeVisible(false);\n    if (type === 'input') {\n      const range =\n        customRange ?? getCurrentMentionReplaceRange(curEditor.$view.state);\n      if (!range) {\n        return;\n      }\n      curEditor.replaceText({\n        ...range,\n        text: `{{${textContent}}}`,\n      });\n    } else {\n      curEditor.replaceText({\n        ...updateRange.current,\n        text: `{{${textContent}}}`,\n      });\n      setUpdateOpen(false);\n    }\n  };\n\n  useKeyboardActions({\n    dropDownVisible,\n    editorRef,\n    interpolationContent,\n    dropdownRef: isInputDropdownOpen ? inputDropdownRef : updateDropdownRef,\n    variableMenuRef: isInputDropdownOpen ? inputTreeRef : updateTreeRef,\n    openMenu: isInputDropdownOpen ? setInputOpen : setUpdateOpen,\n    setActiveOptionHover: (index: number) => {\n      setActiveOption(variableDataSource?.[index]?.value as string);\n    },\n    setTreeVisible,\n    isInputDropdownOpen,\n    applyNode: handleSelect,\n  });\n\n  const handleOptionHover = useCallback(\n    (option: TreeNodeData) => {\n      setActiveOption(option?.value as string);\n    },\n    [setActiveOption],\n  );\n\n  const customInterpolationRule = (content?: string, textBefore?: string) => {\n    let isInVariableString = false;\n    allGlobalVariableKeys?.forEach(key => {\n      if (content?.startsWith(key) && textBefore !== key) {\n        isInVariableString = true;\n      }\n    });\n    if (!isInVariableString) {\n      const regex = new RegExp(\n        `${TRANS_WORKFLOW_VARIABLE_SOURCE}(\\\\d+)\\\\.(?!\\\\S)`,\n      );\n      const isFieldPartEmpty = textBefore?.match(regex);\n\n      isInVariableString = Boolean(\n        content?.startsWith(TRANS_WORKFLOW_VARIABLE_SOURCE) &&\n          !isFieldPartEmpty,\n      );\n    }\n    return isInVariableString;\n  };\n\n  const handleOnClickOutSide = e => {\n    if (!updateDropdownRef.current) {\n      return;\n    }\n    if (\n      updateTreeRef.current?.treeContainerRef?.contains?.(\n        e?.target as HTMLElement,\n      )\n    ) {\n      return;\n    }\n    setUpdateOpen(false);\n    // After an unexpected shutdown, the next variable panel should not automatically expand\n    setTreeVisible(false);\n  };\n\n  return (\n    <div>\n      <Dropdown\n        trigger=\"custom\"\n        visible={inputDropdownOpen}\n        rePosKey={posKey}\n        motion={false}\n        position=\"bottom\"\n        className={`overflow-visible ${DROPDOWN_CLASS}`}\n        style={{\n          minWidth: DEFAULT_MIN_WIDTH,\n        }}\n        render={\n          <div onMouseDown={e => e.preventDefault()} ref={inputDropdownRef}>\n            <CompositeSelectTreePanel\n              ref={inputTreeRef}\n              treeData={variableDataSource}\n              activeOption={activeOption}\n              onSelect={(data, selectType) => {\n                if (selectType === SelectType.Option) {\n                  return;\n                }\n                handleSelect(data as TreeNodeData, { type: 'input' });\n              }}\n              onOptionHover={handleOptionHover}\n              controlledActive={treeVisible}\n              getOptionPopupContainer={() =>\n                (document.querySelector(`.${DROPDOWN_CLASS}`) as HTMLElement) ||\n                document.body\n              }\n            />\n          </div>\n        }\n        getPopupContainer={() => document.body}\n      >\n        <PositionMirror\n          position={pos - 1}\n          onChange={() => setPosKey(String(Math.random()))}\n        />\n      </Dropdown>\n      <Dropdown\n        trigger=\"custom\"\n        visible={updateDropdownOpen}\n        motion={false}\n        rePosKey={posKey}\n        position=\"bottom\"\n        className={`overflow-visible ${DROPDOWN_CLASS}`}\n        onClickOutSide={handleOnClickOutSide}\n        style={{\n          minWidth: DEFAULT_MIN_WIDTH,\n        }}\n        render={\n          <div onMouseDown={e => e.preventDefault()} ref={updateDropdownRef}>\n            <CompositeSelectTreePanel\n              ref={updateTreeRef}\n              treeData={variableDataSource}\n              activeOption={activeOption}\n              onSelect={(data, selectType) => {\n                if (selectType === SelectType.Option) {\n                  return;\n                }\n                handleSelect(data as TreeNodeData, { type: 'update' });\n              }}\n              onOptionHover={handleOptionHover}\n              controlledActive={treeVisible}\n              getOptionPopupContainer={() =>\n                (document.querySelector(`.${DROPDOWN_CLASS}`) as HTMLElement) ||\n                document.body\n              }\n            />\n          </div>\n        }\n        getPopupContainer={() => document.body}\n      >\n        <PositionMirror\n          position={pos - 1}\n          onChange={() => setPosKey(String(Math.random()))}\n        />\n      </Dropdown>\n      <Completion\n        disabled={dropDownVisible}\n        disableUpdateTrigger\n        variableTree={variableTree ?? []}\n        customApplyNode={(node, context) => {\n          handleSelect(\n            { path: (node?.value as string)?.split('.') },\n            {\n              type: 'input',\n              customRange: {\n                // Supplementary double braces position\n                from: context.from - 2,\n                to: context.to + 2,\n              },\n            },\n          );\n        }}\n        customInterpolationRule={customInterpolationRule}\n      />\n\n      <Mention\n        triggerCharacters={['{', '{}']}\n        onOpenChange={({\n          value,\n          state,\n        }: {\n          value: boolean;\n          state: EditorState;\n        }) => {\n          const curPos = state.selection.main.head;\n          if (variableDataSource?.length && !readonly) {\n            // Do not open when variable is empty\n            setInputOpen(value);\n          }\n          setPos(curPos);\n          if (value) {\n            setDropdownType(DropdownType.Input);\n          }\n        }}\n      />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-universal';\nimport { type EditorView } from '@codemirror/view';\nimport { syntaxTree } from '@codemirror/language';\n\nimport { type InterpolationContent } from '../types';\n\nfunction getInterpolationContentAtPos(view: EditorView, pos: number) {\n  const tree = syntaxTree(view.state);\n  const cursor = tree.cursorAt(pos);\n\n  do {\n    if (\n      cursor.node.type.name === 'Interpolation' &&\n      cursor.node.firstChild &&\n      cursor.node.lastChild &&\n      pos >= cursor.node.firstChild.to &&\n      pos <= cursor.node.lastChild.from\n    ) {\n      const text = view.state.sliceDoc(\n        cursor.node.firstChild.to,\n        cursor.node.lastChild.from,\n      );\n      const offset = pos - cursor.node.firstChild.to;\n      return {\n        from: cursor.node.firstChild.to,\n        to: cursor.node.lastChild.from,\n        text,\n        offset,\n        textBefore: text.slice(0, offset),\n      };\n    }\n  } while (cursor.parent());\n}\n\nfunction useInterpolationContent(\n  editor: EditorAPI | undefined,\n  pos: number | undefined,\n): InterpolationContent | undefined {\n  return useMemo(() => {\n    if (!editor || typeof pos === 'undefined') {\n      return;\n    }\n\n    const view = editor.$view;\n    const res = getInterpolationContentAtPos(view, pos);\n    return res;\n  }, [editor, pos]);\n}\n\nexport { useInterpolationContent };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-universal';\nimport { type ViewUpdate } from '@codemirror/view';\n\nimport { useLatest, isSkipSelectionChangeUserEvent } from '../utils';\n\ninterface Selection {\n  anchor: number;\n  head: number;\n  from: number;\n  to: number;\n}\n\nfunction isSameSelection(a?: Selection, b?: Selection) {\n  if (!a && !b) {\n    return true;\n  }\n\n  return (\n    a &&\n    b &&\n    a.anchor === b.anchor &&\n    a.head === b.head &&\n    a.from === b.from &&\n    a.to === b.to\n  );\n}\n\nfunction useSelection(editor: EditorAPI | undefined) {\n  const [selection, setSelection] = useState<Selection | undefined>();\n\n  const selectionRef = useLatest(selection);\n\n  useEffect(() => {\n    if (!editor) {\n      return;\n    }\n\n    const view = editor.$view;\n\n    function updateSelection(update?: ViewUpdate) {\n      // Ignore the selection change caused by replaceTextByRange (effect: no selection change is triggered, and the recommendation panel is not displayed)\n      if (update?.transactions.some(tr => isSkipSelectionChangeUserEvent(tr))) {\n        setSelection(undefined);\n        return;\n      }\n\n      const { from, to, anchor, head } = view.state.selection.main;\n      const newSelection = { from, to, anchor, head };\n      if (isSameSelection(newSelection, selectionRef.current)) {\n        return;\n      }\n\n      setSelection({ from, to, anchor, head });\n    }\n\n    function handleSelectionChange(e: { update: ViewUpdate }) {\n      updateSelection(e.update);\n    }\n\n    function handleFocus() {\n      updateSelection();\n    }\n\n    editor.$on('selectionChange', handleSelectionChange);\n    editor.$on('focus', handleFocus);\n\n    return () => {\n      editor.$off('selectionChange', handleSelectionChange);\n      editor.$off('focus', handleFocus);\n    };\n  }, [editor]);\n\n  return selection;\n}\n\nexport { useSelection };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type ExpressionEditorTreeNode,\n  ExpressionEditorTreeHelper,\n} from '@coze-workflow/components';\nimport { type WorkflowVariableFacade } from '@coze-workflow/variable/src/core/workflow-variable-facade';\nimport {\n  getGlobalVariableAlias,\n  TRANS_WORKFLOW_VARIABLE_SOURCE,\n} from '@coze-workflow/variable';\n\nexport const useVariableTree = ({\n  variables,\n  getNodeInfoInVariableMeta,\n}): ExpressionEditorTreeNode[] => {\n  const availableVariables: ExpressionEditorTreeHelper.AvailableVariable[] =\n    variables.map((variable: WorkflowVariableFacade) => ({\n      // Process variable specialization logic because block-output is not a valid variable name\n      name: variable.globalVariableKey\n        ? variable.expressionPath?.source\n        : TRANS_WORKFLOW_VARIABLE_SOURCE +\n          variable.expressionPath?.keyPath?.[0],\n      keyPath: [variable.expressionPath?.keyPath?.[0]],\n      variable: variable.viewMeta\n        ? {\n            ...variable.viewMeta,\n            ...(variable.node\n              ? getNodeInfoInVariableMeta(variable.node)\n              : {\n                  nodeTitle: getGlobalVariableAlias(variable.globalVariableKey),\n                  nodeId: variable.globalVariableKey,\n                }),\n            children: [\n              {\n                ...variable.viewMeta,\n                ...(variable.node\n                  ? getNodeInfoInVariableMeta(variable.node)\n                  : {\n                      nodeTitle: getGlobalVariableAlias(\n                        variable.globalVariableKey,\n                      ),\n                      nodeId: variable.globalVariableKey,\n                    }),\n              },\n            ],\n          }\n        : undefined,\n    }));\n\n  const variableTree =\n    ExpressionEditorTreeHelper.createVariableTree(availableVariables);\n  return variableTree;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useCallback,\n  useEffect,\n  useRef,\n  useImperativeHandle,\n} from 'react';\n\nimport {\n  type EditorAPI,\n  transformerCreator,\n} from '@coze-editor/editor/preset-code';\nimport { json } from '@coze-editor/editor/language-json';\n\nimport { CodeEditor } from '@/components/code-editor';\n\nimport { JsonEditorTheme } from '../../constants';\n\ninterface BaseJsonEditorProps {\n  value: string;\n  onChange?: (value: string) => void;\n  className?: string;\n  dataTestID?: string;\n  placeholder?: string | HTMLElement;\n  isDarkTheme?: boolean;\n  readonly?: boolean;\n  minHeight?: string | number;\n  maxHeight?: string | number;\n  editerHeight?: string | number;\n  padding?: string | number;\n  borderRadius?: string | number;\n}\n\ninterface Match {\n  match: string;\n  range: [number, number];\n}\n\nfunction findAllMatches(inputString: string, regex: RegExp): Match[] {\n  const globalRegex = new RegExp(\n    regex,\n    regex.flags.includes('g') ? regex.flags : `${regex.flags}g`,\n  );\n  let match;\n  const matches: Match[] = [];\n\n  while (true) {\n    match = globalRegex.exec(inputString);\n    if (!match) {\n      break;\n    }\n\n    if (match.index === globalRegex.lastIndex) {\n      globalRegex.lastIndex++;\n    }\n    matches.push({\n      match: match[0],\n      range: [match.index, match.index + match[0].length],\n    });\n  }\n\n  return matches;\n}\n\nconst transformer = transformerCreator(text => {\n  const originalSource = text.toString();\n  const matches = findAllMatches(originalSource, /\\{\\{([^\\}]*)\\}\\}/g);\n\n  if (matches.length > 0) {\n    matches.forEach(({ range }) => {\n      text.replaceRange(range[0], range[1], 'null');\n    });\n  }\n\n  return text;\n});\n\nexport const BaseJsonEditor = React.forwardRef(\n  (props: BaseJsonEditorProps, ref) => {\n    const {\n      value,\n      onChange,\n      placeholder,\n      className,\n      isDarkTheme,\n      readonly,\n      minHeight = '100px',\n      maxHeight,\n      editerHeight,\n      padding,\n      borderRadius,\n    } = props;\n\n    const apiRef = useRef<EditorAPI | null>(null);\n\n    const handleChange = useCallback(\n      (e: { value: string }) => {\n        if (typeof onChange === 'function') {\n          onChange(e.value);\n        }\n      },\n      [onChange],\n    );\n\n    useEffect(() => {\n      apiRef.current?.updateASTDecorations();\n    }, [isDarkTheme]);\n\n    // Value controlled;\n    useEffect(() => {\n      const editor = apiRef.current;\n\n      if (!editor) {\n        return;\n      }\n\n      if (typeof value === 'string' && value !== editor.getValue()) {\n        editor.setValue(value);\n      }\n    }, [value]);\n\n    const formatJson = async () => {\n      const view = apiRef.current?.$view;\n      if (!view) {\n        return;\n      }\n      view.dispatch(\n        await json.languageService.format(view.state, {\n          tabSize: 2,\n        }),\n      );\n    };\n\n    useImperativeHandle(ref, () => ({\n      formatJson,\n    }));\n\n    return (\n      <div className={className}>\n        <CodeEditor\n          defaultValue={value ?? ''}\n          onChange={handleChange}\n          options={{\n            placeholder,\n            lineWrapping: true,\n            theme: isDarkTheme ? JsonEditorTheme.Dark : JsonEditorTheme.Light,\n            languageId: 'json',\n            editable: !readonly,\n            transformer,\n            minHeight,\n            maxHeight,\n            editerHeight,\n            borderRadius,\n            padding,\n            fontSize: 12,\n            lineHeight: 20,\n          }}\n          didMount={api => (apiRef.current = api)}\n        />\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { forwardRef, useCallback, useEffect, useRef } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-universal';\n\nimport { TextEditor } from '@/components/code-editor';\n\ninterface RawTextEditorProps {\n  value: string;\n  onChange: (value: string) => void;\n  className?: string;\n  readonly?: boolean;\n  dataTestID?: string;\n  placeholder?: string | HTMLElement;\n  minHeight?: string | number;\n}\n\nexport const BaseRawTextEditor = forwardRef<HTMLDivElement, RawTextEditorProps>(\n  (props, ref) => {\n    const { value, onChange, placeholder, className, minHeight, readonly } =\n      props;\n\n    const apiRef = useRef<EditorAPI | null>(null);\n\n    const handleChange = useCallback(\n      (e: { value: string }) => {\n        if (typeof onChange === 'function') {\n          onChange(e.value);\n        }\n      },\n      [onChange],\n    );\n\n    // Value controlled;\n    useEffect(() => {\n      const editor = apiRef.current;\n\n      if (!editor) {\n        return;\n      }\n\n      if (typeof value === 'string' && value !== editor.getValue()) {\n        editor.setValue(value);\n      }\n    }, [value]);\n\n    return (\n      <div ref={ref} className={className}>\n        <TextEditor\n          defaultValue={value ?? ''}\n          onChange={handleChange}\n          options={{\n            placeholder,\n            lineWrapping: true,\n            minHeight,\n            fontSize: 12,\n            editable: !readonly,\n            lineHeight: 20,\n          }}\n          didMount={api => (apiRef.current = api)}\n        />\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useEffect, useRef } from 'react';\n\nimport { type EditorAPI } from '@coze-editor/editor/preset-code';\n\nimport { CodeEditor } from '@/components/code-editor';\n\nimport { JsonEditorTheme } from '../../constants';\n\ninterface BaseBashEditorProps {\n  value: string;\n  onChange?: (value: string) => void;\n  className?: string;\n  dataTestID?: string;\n  placeholder?: string | HTMLElement;\n  isDarkTheme?: boolean;\n  readonly?: boolean;\n  minHeight?: string | number;\n  maxHeight?: string | number;\n  editerHeight?: string | number;\n  padding?: string | number;\n}\n\nexport const BaseBashEditor = (props: BaseBashEditorProps) => {\n  const {\n    value,\n    onChange,\n    placeholder,\n    className,\n    isDarkTheme,\n    readonly,\n    minHeight = '100px',\n    maxHeight,\n    editerHeight,\n    padding,\n  } = props;\n\n  const apiRef = useRef<EditorAPI | null>(null);\n\n  const handleChange = useCallback(\n    (e: { value: string }) => {\n      if (typeof onChange === 'function') {\n        onChange(e.value);\n      }\n    },\n    [onChange],\n  );\n\n  // Value controlled;\n  useEffect(() => {\n    const editor = apiRef.current;\n\n    if (!editor) {\n      return;\n    }\n\n    if (typeof value === 'string' && value !== editor.getValue()) {\n      editor.setValue(value);\n    }\n  }, [value]);\n\n  return (\n    <div className={className}>\n      <CodeEditor\n        defaultValue={value ?? ''}\n        onChange={handleChange}\n        options={{\n          placeholder,\n          lineWrapping: true,\n          theme: isDarkTheme ? JsonEditorTheme.Dark : JsonEditorTheme.Light,\n          languageId: 'shell',\n          editable: !readonly,\n          minHeight,\n          maxHeight,\n          editerHeight,\n          padding,\n          fontSize: 12,\n          lineHeight: 20,\n        }}\n        didMount={api => (apiRef.current = api)}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, type FC } from 'react';\n\nimport classNames from 'classnames';\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport {\n  useAvailableWorkflowVariables,\n  useGetWorkflowVariableByKeyPath,\n  isGlobalVariableKey,\n} from '@coze-workflow/variable';\n\nimport { VariableExtension } from '@/node-registries/http/components/variable-support';\nimport { useNodeServiceAndRefreshForTitleChange } from '@/form-extensions/hooks/use-node-available-variables';\nimport {\n  formatDataWithGlobalVariable,\n  processDataSourceLabelRender,\n} from '@/form-extensions/components/tree-variable-selector/utils';\nimport { useFormatVariableDataSource } from '@/form-extensions/components/tree-variable-selector/useFormatVariableDataSource';\nimport useGlobalVariableCache from '@/form-extensions/components/tree-variable-selector/use-global-variable-cache';\nimport GlobalVarIcon from '@/form-extensions/components/tree-variable-selector/global-var-icon';\nimport { NodeIcon } from '@/components/node-icon';\n\nimport { useVariableWithNodeInfo } from '../hooks/use-variable-with-node';\nimport { useVariableTree } from '../hooks/use-variable-tree';\nimport { BaseRawTextEditor } from '../../components/base-editor';\n\nimport styles from './index.module.less';\n\ninterface RawTextEditorContainerProps {\n  name: string;\n  value: string;\n  onChange: (value: string) => void;\n  key?: string;\n  placeholder?: string | HTMLElement;\n  readonly?: boolean;\n  disableSuggestion?: boolean;\n  disableCounter?: boolean;\n  minRows?: number;\n  maxLength?: number;\n  onBlur?: () => void;\n  onFocus?: () => void;\n  isError?: boolean;\n  minHeight?: string | number;\n}\n\n/**\n * Global variable hint logic layer\n */\nexport const InnerEditor: FC<RawTextEditorContainerProps> = props => {\n  const { value, onChange, placeholder, minHeight, readonly = false } = props;\n\n  const editorContainerRef = useRef<HTMLDivElement>(null);\n\n  const getVariableByKeyPath = useGetWorkflowVariableByKeyPath();\n  const allVariables = useAvailableWorkflowVariables();\n  const { getNodeInfoInVariableMeta } =\n    useNodeServiceAndRefreshForTitleChange();\n  const availableVariables = useVariableWithNodeInfo(\n    allVariables,\n    getNodeInfoInVariableMeta,\n  );\n  /** Selectable variable data with default backstop */\n  const defaultVariableDataSource = useFormatVariableDataSource({\n    disabledTypes: [],\n  });\n\n  const dataSourceWithGlobal = useGlobalVariableCache(\n    defaultVariableDataSource,\n  );\n\n  // Process DataSource data, add partial fields/renders\n  const variableDataSource = processDataSourceLabelRender({\n    dataSource: dataSourceWithGlobal,\n    icon: node =>\n      isGlobalVariableKey(node.value) ? (\n        <GlobalVarIcon nodeId={node.value} />\n      ) : (\n        <NodeIcon\n          size={16}\n          alt=\"logo\"\n          nodeId={node.value}\n          className=\"leading-[0px]\"\n        />\n      ),\n  });\n\n  const variableDataSourceWithGroup =\n    formatDataWithGlobalVariable(variableDataSource);\n\n  const variableTree: ExpressionEditorTreeNode[] = useVariableTree({\n    variables: allVariables,\n    getNodeInfoInVariableMeta,\n  });\n\n  return (\n    <div className=\"w-full\">\n      <BaseRawTextEditor\n        ref={editorContainerRef}\n        readonly={readonly}\n        value={value}\n        className={classNames(\n          styles['editor-render'],\n          styles['editor-render-cm-content'],\n        )}\n        placeholder={placeholder}\n        // dataTestID={dataTestID}\n        onChange={onChange}\n        minHeight={minHeight}\n      />\n      <VariableExtension\n        readonly={readonly}\n        availableVariables={availableVariables}\n        variableDataSource={variableDataSourceWithGroup}\n        getVariableByKeyPath={getVariableByKeyPath}\n        variableTree={variableTree}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EditorProvider } from '@coze-editor/editor/react';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { useField, withField } from '@/form';\nimport { InnerEditorContainer } from '@/components/editor-container';\n\nimport { InnerEditor } from './inner-editor';\n\nimport styles from './index.module.less';\n\nexport const RawTextEditorField = withField(\n  ({\n    placeholder,\n    minHeight,\n  }: {\n    placeholder?: string;\n    minHeight?: string | number;\n  }) => {\n    const { name, value, onChange, onBlur, errors } = useField<string>();\n    const readonly = useReadonly();\n\n    return (\n      <InnerEditorContainer\n        name={name}\n        onBlur={() => onBlur?.()}\n        className={styles['raw-editor-container']}\n        isError={!readonly && !!errors?.length}\n      >\n        <EditorProvider>\n          <InnerEditor\n            name={'http-field-json-editor'}\n            placeholder={placeholder}\n            value={value as string}\n            onChange={onChange}\n            minHeight={minHeight}\n            // Forbid editing in the form\n            readonly={readonly}\n          />\n        </EditorProvider>\n      </InnerEditorContainer>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\n\nexport function transJsTypeToViewVariableType(value: unknown) {\n  switch (typeof value) {\n    case 'string':\n      return ViewVariableType.String;\n    case 'number':\n      return ViewVariableType.Number;\n    case 'boolean':\n      return ViewVariableType.Boolean;\n    default:\n      return ViewVariableType.String;\n  }\n}\n\nexport function transStringParamsToFormData(params: Record<string, string>) {\n  if (!params) {\n    return [];\n  }\n  return Object.entries(params).map(([key, value]) => ({\n    name: key,\n    type: transJsTypeToViewVariableType(value),\n    input: { type: 'literal', content: value },\n  }));\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useCallback, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { EditorProvider } from '@coze-editor/editor/react';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconWarningInfo } from '@coze-arch/bot-icons';\nimport {\n  IconCozImport,\n  IconCozMoon,\n  IconCozSun,\n} from '@coze-arch/coze-design/icons';\nimport { IconButton, Modal, Toast } from '@coze-arch/coze-design';\n\nimport { CURLParser, type ParsedResult } from '@/utils';\nimport {\n  useEditorThemeState,\n  EditorTheme,\n} from '@/hooks/use-editor-theme-state';\nimport { ExpandEditorContainer } from '@/components/editor-container';\n\nimport { HttpMethod } from '../constants';\nimport { BaseBashEditor } from '../../components/base-editor';\n\nimport styles from './index.module.less';\n\nexport const CurlExpandEditor: FC<{\n  id: string;\n  onChange: (data: ParsedResult) => void;\n  onClose: () => void;\n}> = props => {\n  const { id, onClose, onChange } = props;\n\n  const [curlStr, setCurlStr] = useState('');\n\n  const { isDarkTheme, setEditorTheme } = useEditorThemeState();\n\n  const handleChangeTheme = () => {\n    const nextTheme = isDarkTheme ? EditorTheme.Light : EditorTheme.Dark;\n    setEditorTheme(nextTheme);\n  };\n\n  const onConfirmImport = useCallback(\n    async () =>\n      new Promise(resolve => {\n        Modal.warning({\n          icon: (\n            <IconWarningInfo\n              className={styles.warningIcon}\n              style={{\n                width: 22,\n                height: 22,\n              }}\n            />\n          ),\n          title: I18n.t('workflow_json_node_update_tips_title'),\n          content: I18n.t('workflow_json_node_update_tips_content'),\n          okType: 'warning',\n          okText: I18n.t('Confirm'),\n          cancelText: I18n.t('Cancel'),\n          onOk: () => {\n            try {\n              const curlObj = new CURLParser(curlStr);\n              const nextFormData = curlObj.parse();\n              if (!HttpMethod?.[nextFormData?.method]) {\n                throw new Error('cURL Method Error');\n              }\n              onChange(nextFormData);\n            } catch (e) {\n              Toast.warning({\n                content: 'cURL Format Error',\n                duration: 3,\n              });\n              console.warn('cURL Format Error', e);\n            }\n            resolve(true);\n          },\n          onCancel: () => resolve(false),\n        });\n      }),\n    [curlStr],\n  );\n\n  return (\n    <ExpandEditorContainer\n      id={id}\n      onClose={onClose}\n      closeIconClassName={classNames({\n        [styles.themeIconDark]: isDarkTheme,\n      })}\n      editorTitle={I18n.t('node_http_import_curl', {}, ' cURL')}\n      headerClassName={classNames(styles['expand-header'], {\n        [styles['expand-header-dark']]: isDarkTheme,\n      })}\n      contentClassName={classNames(styles['expand-content'], {\n        [styles['expand-content-dark']]: isDarkTheme,\n      })}\n      editorContent={\n        <EditorProvider>\n          <BaseBashEditor\n            className={styles.editorWrapper}\n            placeholder={I18n.t(\n              'node_http_import_curl_placeholder',\n              {},\n              'cURL',\n            )}\n            value={curlStr}\n            onChange={v => setCurlStr(v as string)}\n            minHeight=\"100%\"\n            maxHeight=\"100%\"\n            editerHeight=\"100%\"\n            padding=\"12px\"\n            isDarkTheme={isDarkTheme}\n          />\n        </EditorProvider>\n      }\n      actions={[\n        <IconButton\n          color=\"highlight\"\n          className={classNames(styles.importButton, {\n            [styles.importButtonDark]: isDarkTheme,\n          })}\n          icon={<IconCozImport className={styles.buttonIcon} />}\n          onClick={onConfirmImport}\n        >\n          {I18n.t('import', {}, '')}\n        </IconButton>,\n        <span>\n          <IconButton\n            onClick={handleChangeTheme}\n            icon={\n              isDarkTheme ? (\n                <IconCozMoon fontSize={18} className={styles.themeIconDark} />\n              ) : (\n                <IconCozSun fontSize={18} className={styles.themeIconLight} />\n              )\n            }\n            size=\"small\"\n            color=\"secondary\"\n            aria-label=\"close\"\n          />\n        </span>,\n      ]}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozImport } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\n\nimport { CurlExpandEditor } from './curl-expand-editor';\n\nimport styles from './index.module.less';\n\nexport const CurlImport = ({\n  onChange,\n  customClassNames = '',\n  testId,\n  disabled,\n  disabledTooltip = I18n.t('node_http_import_curl', {}, ' cURL'),\n}) => {\n  const { getNodeSetterId } = useNodeTestId();\n\n  const { setFullscreenPanel } = useNodeFormPanelState();\n\n  const handleOnClick = () => {\n    setFullscreenPanel(\n      <PublicScopeProvider>\n        <CurlExpandEditor\n          onChange={onChange}\n          onClose={() => {\n            setFullscreenPanel(null);\n          }}\n          id={'import-curl'}\n        />\n      </PublicScopeProvider>,\n    );\n  };\n\n  return (\n    <div\n      className={classNames({\n        [customClassNames]: customClassNames,\n      })}\n      data-testid={testId}\n    >\n      <Tooltip\n        content={\n          disabled\n            ? disabledTooltip\n            : I18n.t('node_http_import_curl', {}, ' cURL')\n        }\n      >\n        <IconButton\n          data-testid={getNodeSetterId('apiInfo-import-curl-btn')}\n          className={classNames('!block', {\n            [styles.importButton]: true,\n            [styles.importButtonDisabled]: disabled,\n          })}\n          size=\"small\"\n          color=\"highlight\"\n          disabled={disabled}\n          icon={<IconCozImport className={styles.buttonIcon} />}\n          onClick={handleOnClick}\n        >\n          <span\n            style={{\n              fontSize: 12,\n              fontWeight: 500,\n              lineHeight: '16px',\n            }}\n          >\n            {I18n.t('node_http_import_curl', {}, ' cURL')}\n          </span>\n        </IconButton>\n      </Tooltip>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { useNodeTestId, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type ParsedResult } from '@/utils';\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { Section, SelectField, useForm } from '@/form';\n\nimport {\n  BodyType,\n  bodyTypeToField,\n  contentTypeToBodyType,\n  HttpMethod,\n} from '../constants';\nimport { RawTextEditorField } from '../../fields/raw-text-editor';\nimport { transStringParamsToFormData } from './utils';\nimport { CurlImport } from './curl-import';\n\nexport const ApiSetter = () => {\n  const readonly = useReadonly();\n  const { getNodeSetterId } = useNodeTestId();\n  const form = useForm();\n\n  const handleCurlImport = (parsedCurl: ParsedResult) => {\n    const isGetMethod = parsedCurl.method === HttpMethod.GET;\n    form.setFieldValue('inputs.apiInfo', {\n      method: parsedCurl.method,\n      url: isGetMethod ? parsedCurl?.originPath : parsedCurl?.url,\n    });\n    form.setFieldValue(\n      'inputs.params',\n      transStringParamsToFormData(\n        isGetMethod ? parsedCurl?.query : parsedCurl?.params,\n      ),\n    );\n    const curlHeaders = {};\n    // Specialized logic, filtering content-type fields, generated by the backend when sending a request\n    for (const key in parsedCurl?.headers) {\n      if (key.toLowerCase() !== 'content-type') {\n        curlHeaders[key] = parsedCurl?.headers[key];\n      }\n    }\n    form.setFieldValue(\n      'inputs.headers',\n      transStringParamsToFormData(curlHeaders),\n    );\n\n    const contentType = (parsedCurl?.body as Record<string, string>)?.type;\n    const bodyType = contentTypeToBodyType?.[contentType] ?? BodyType.Empty;\n    form.setFieldValue('inputs.body.bodyType', bodyType);\n\n    const parsedCurlBody = (parsedCurl?.body as Record<string, string>).data;\n    if (contentType === BodyType.Empty) {\n      return;\n    }\n    let bodyData;\n    if (\n      // The body parameter of the Binary type is the file path, which is not processed by the front end and is directly set empty.\n      bodyType === BodyType.Binary\n    ) {\n      bodyData = {\n        fileURL: {\n          type: 'literal',\n          content: '',\n          rawMeta: { type: 8 },\n        },\n      };\n    } else if (\n      bodyType === BodyType.FormUrlEncoded ||\n      bodyType === BodyType.FormData\n    ) {\n      bodyData = Object.keys(parsedCurlBody)?.map(key => ({\n        name: key,\n        type: ViewVariableType.String,\n        input: { type: 'literal', content: parsedCurlBody[key] },\n      }));\n    } else if (bodyType === BodyType.RawText) {\n      bodyData = parsedCurlBody;\n    } else if (bodyType === BodyType.Json) {\n      bodyData = JSON.stringify(parsedCurlBody);\n    }\n    form.setFieldValue('inputs.body.bodyData', {\n      [bodyTypeToField[bodyType]]: bodyData,\n    });\n  };\n\n  const optionList = useMemo(\n    () =>\n      Object.keys(HttpMethod).map(item => ({\n        label: HttpMethod?.[item],\n        value: HttpMethod?.[item],\n      })),\n    [],\n  );\n\n  return (\n    <Section\n      title={I18n.t('node_http_api', {}, 'API')}\n      tooltip={I18n.t('node_http_api_tooltips', {}, 'API')}\n      actions={[\n        <CurlImport\n          onChange={handleCurlImport}\n          testId={'apiInfo-import-curl'}\n          disabled={readonly}\n        />,\n      ]}\n    >\n      <div className=\"flex flex-col gap-[8px]\">\n        <SelectField\n          name={'inputs.apiInfo.method'}\n          defaultValue={HttpMethod.GET}\n          optionList={optionList}\n          data-testid={getNodeSetterId('apiInfo-method-select')}\n          style={{\n            width: '100%',\n            borderColor:\n              'var(--Stroke-COZ-stroke-plus, rgba(84, 97, 156, 0.27))',\n          }}\n        />\n        <RawTextEditorField\n          name={'inputs.apiInfo.url'}\n          placeholder={I18n.t(\n            'node_http_url_input',\n            {},\n            'URL\"{{\"',\n          )}\n          minHeight={56}\n        />\n      </div>\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState } from 'react';\n\nimport classNames from 'classnames';\nimport { type ExpressionEditorTreeNode } from '@coze-workflow/components';\nimport {\n  useAvailableWorkflowVariables,\n  useGetWorkflowVariableByKeyPath,\n  isGlobalVariableKey,\n} from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { VariableExtension } from '@/node-registries/http/components/variable-support';\nimport { useNodeServiceAndRefreshForTitleChange } from '@/form-extensions/hooks/use-node-available-variables';\nimport {\n  formatDataWithGlobalVariable,\n  processDataSourceLabelRender,\n} from '@/form-extensions/components/tree-variable-selector/utils';\nimport { useFormatVariableDataSource } from '@/form-extensions/components/tree-variable-selector/useFormatVariableDataSource';\nimport useGlobalVariableCache from '@/form-extensions/components/tree-variable-selector/use-global-variable-cache';\nimport GlobalVarIcon from '@/form-extensions/components/tree-variable-selector/global-var-icon';\nimport { WORKFLOW_PLAYGROUND_CONTENT_ID } from '@/constants';\nimport { NodeIcon } from '@/components/node-icon';\n\nimport { useVariableWithNodeInfo } from '../hooks/use-variable-with-node';\nimport { useVariableTree } from '../hooks/use-variable-tree';\nimport { BaseJsonEditor } from '../../components/base-editor';\n\nimport styles from './index.module.less';\n\ninterface InnerEditorProps {\n  name: string;\n  value: string;\n  onChange?: (value: string) => void;\n  key?: string;\n  placeholder?: string | HTMLElement;\n  readonly?: boolean;\n  disableSuggestion?: boolean;\n  disableCounter?: boolean;\n  minRows?: number;\n  maxLength?: number;\n  onBlur?: () => void;\n  onFocus?: () => void;\n  isError?: boolean;\n  isDarkTheme?: boolean;\n  minHeight?: string | number;\n  maxHeight?: string | number;\n  editerHeight?: string | number;\n  padding?: string | number;\n  borderRadius?: string | number;\n  editorClassName?: string;\n}\n\n/**\n * Global variable hint logic layer\n */\nexport const InnerEditor = React.forwardRef(\n  (props: InnerEditorProps, editorRef) => {\n    const {\n      value,\n      onChange,\n      placeholder,\n      isDarkTheme,\n      readonly = false,\n      minHeight,\n      maxHeight,\n      editerHeight,\n      padding,\n      borderRadius,\n      editorClassName,\n    } = props;\n\n    const getVariableByKeyPath = useGetWorkflowVariableByKeyPath();\n    const allVariables = useAvailableWorkflowVariables();\n    const { getNodeInfoInVariableMeta } =\n      useNodeServiceAndRefreshForTitleChange();\n    const availableVariables = useVariableWithNodeInfo(\n      allVariables,\n      getNodeInfoInVariableMeta,\n    );\n    /** Selectable variable data with default backstop */\n    const defaultVariableDataSource = useFormatVariableDataSource({\n      disabledTypes: [],\n    });\n\n    const dataSourceWithGlobal = useGlobalVariableCache(\n      defaultVariableDataSource,\n    );\n\n    // Process DataSource data, add partial fields/renders\n    const variableDataSource = processDataSourceLabelRender({\n      dataSource: dataSourceWithGlobal,\n      icon: node =>\n        isGlobalVariableKey(node.value) ? (\n          <GlobalVarIcon nodeId={node.value} />\n        ) : (\n          <NodeIcon\n            size={16}\n            alt=\"logo\"\n            nodeId={node.value}\n            className=\"leading-[0px]\"\n          />\n        ),\n    });\n\n    const variableDataSourceWithGroup =\n      formatDataWithGlobalVariable(variableDataSource);\n\n    const variableTree: ExpressionEditorTreeNode[] = useVariableTree({\n      variables: allVariables,\n      getNodeInfoInVariableMeta,\n    });\n\n    const [isHover, setHover] = useState<boolean>(false);\n\n    return (\n      <Tooltip\n        content={I18n.t('db_table_0129_003')}\n        trigger=\"custom\"\n        position=\"top\"\n        autoAdjustOverflow={false}\n        visible={readonly && isHover}\n        getPopupContainer={() =>\n          document.getElementById(WORKFLOW_PLAYGROUND_CONTENT_ID) ??\n          document.body\n        }\n      >\n        <div\n          className=\"w-full h-full\"\n          onMouseEnter={() => setHover(true)}\n          onMouseLeave={() => setHover(false)}\n        >\n          <BaseJsonEditor\n            ref={editorRef}\n            readonly={readonly}\n            value={value}\n            className={classNames(\n              styles['editor-render'],\n              styles['editor-render-cm-content'],\n              editorClassName,\n            )}\n            placeholder={placeholder}\n            // dataTestID={dataTestID}\n            onChange={onChange}\n            minHeight={minHeight}\n            maxHeight={maxHeight}\n            editerHeight={editerHeight}\n            padding={padding}\n            borderRadius={borderRadius}\n            isDarkTheme={isDarkTheme}\n          />\n          <VariableExtension\n            readonly={readonly}\n            isDarkTheme={isDarkTheme}\n            availableVariables={availableVariables}\n            variableDataSource={variableDataSourceWithGroup}\n            getVariableByKeyPath={getVariableByKeyPath}\n            variableTree={variableTree}\n            languageId=\"json\"\n          />\n        </div>\n      </Tooltip>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FC, useRef, useEffect } from 'react';\n\nimport classNames from 'classnames';\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport { EditorProvider } from '@coze-editor/editor/react';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozBroom,\n  IconCozMoon,\n  IconCozSun,\n} from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport {\n  useEditorThemeState,\n  EditorTheme,\n} from '@/hooks/use-editor-theme-state';\nimport { ExpandEditorContainer } from '@/components/editor-container';\n\nimport { InnerEditor } from '../inner-editor';\nimport styles from '../index.module.less';\n\nexport const JsonExpandEditor: FC<{\n  id: string;\n  value: string;\n  onChange: (data: string) => void;\n  onClose: () => void;\n}> = props => {\n  const { id, onClose, value, onChange } = props;\n  const readonly = useReadonly();\n  const editorRef = useRef<{ formatJson: () => Promise<void> }>(null);\n\n  const { isDarkTheme, setEditorTheme } = useEditorThemeState();\n\n  const handleChangeTheme = () => {\n    const nextTheme = isDarkTheme ? EditorTheme.Light : EditorTheme.Dark;\n    setEditorTheme(nextTheme);\n  };\n\n  const handleFormatJson = () => {\n    editorRef.current?.formatJson?.();\n  };\n\n  useEffect(() => {\n    if (!editorRef.current) {\n      return;\n    }\n    editorRef.current?.formatJson?.();\n  }, []);\n\n  return (\n    <ExpandEditorContainer\n      id={id}\n      onClose={onClose}\n      closeIconClassName={classNames({\n        [styles.themeIconDark]: isDarkTheme,\n      })}\n      editorTitle={'JSON'}\n      headerClassName={classNames(styles['expand-header'], {\n        [styles['expand-header-dark']]: isDarkTheme,\n      })}\n      contentClassName={classNames(styles['expand-content'], {\n        [styles['expand-content-dark']]: isDarkTheme,\n      })}\n      editorContent={\n        <PublicScopeProvider>\n          <EditorProvider>\n            <InnerEditor\n              ref={editorRef}\n              value={value}\n              placeholder={I18n.t('node_http_json_data_input')}\n              onChange={v => {\n                onChange(v as string);\n              }}\n              name={id}\n              isDarkTheme={isDarkTheme}\n              readonly={readonly}\n              minHeight=\"100%\"\n              maxHeight=\"100%\"\n              editerHeight=\"100%\"\n              padding=\"12px\"\n              editorClassName={styles.editorWrapper}\n            />\n          </EditorProvider>\n        </PublicScopeProvider>\n      }\n      actions={[\n        <Tooltip content={I18n.t('node_http_json_format')}>\n          <span>\n            <IconButton\n              onClick={handleFormatJson}\n              icon={\n                <IconCozBroom\n                  fontSize={18}\n                  className={classNames(\n                    isDarkTheme ? styles.themeIconDark : styles.themeIconLight,\n                  )}\n                />\n              }\n              size=\"small\"\n              color=\"secondary\"\n              aria-label=\"format\"\n            />\n          </span>\n        </Tooltip>,\n        <span>\n          <IconButton\n            onClick={handleChangeTheme}\n            icon={\n              isDarkTheme ? (\n                <IconCozMoon fontSize={18} className={styles.themeIconDark} />\n              ) : (\n                <IconCozSun fontSize={18} className={styles.themeIconLight} />\n              )\n            }\n            size=\"small\"\n            color=\"secondary\"\n            aria-label=\"close\"\n          />\n        </span>,\n      ]}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { IconCozEdit } from '@coze-arch/coze-design/icons';\nimport { IconButton, Tooltip } from '@coze-arch/coze-design';\n\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\n\nimport styles from '../index.module.less';\nimport { JsonExpandEditor } from './json-expand-editor';\n\ninterface JSONImportProps {\n  value: string;\n  onChange: (value: string) => void;\n  onBlur?: () => void;\n  customClassNames?: string;\n  testId?: string;\n  disabled?: boolean;\n  readonly?: boolean;\n  disabledTooltip?: string;\n}\n\nexport const JsonImport = ({\n  value,\n  onChange,\n  customClassNames,\n  testId,\n  disabled,\n  disabledTooltip,\n}: JSONImportProps) => {\n  const { getNodeSetterId } = useNodeTestId();\n\n  const { setFullscreenPanel } = useNodeFormPanelState();\n\n  const handleOnClick = (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.stopPropagation();\n    setFullscreenPanel(\n      <JsonExpandEditor\n        value={value}\n        onChange={onChange}\n        onClose={() => {\n          setFullscreenPanel(null);\n        }}\n        id={'import-json'}\n      />,\n    );\n  };\n\n  return (\n    <div\n      className={classNames({\n        [customClassNames as string]: customClassNames,\n      })}\n      data-testid={testId}\n    >\n      <Tooltip content={disabled ? disabledTooltip : 'Edit JSON'}>\n        <IconButton\n          data-testid={getNodeSetterId('body-json-import-btn')}\n          className={classNames('!block', {\n            [styles.importButton]: true,\n            [styles.importButtonDisabled]: disabled,\n          })}\n          size=\"small\"\n          color=\"highlight\"\n          disabled={disabled}\n          icon={<IconCozEdit className={styles.buttonIcon} />}\n          onClick={handleOnClick}\n        >\n          <span\n            style={{\n              fontSize: 12,\n              fontWeight: 500,\n              lineHeight: '16px',\n            }}\n          >\n            Edit JSON\n          </span>\n        </IconButton>\n      </Tooltip>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useField, withField } from '@/form';\n\nimport { JsonImport } from './json-import-components';\n\nexport const JsonImportField = withField(() => {\n  const { value, onChange, onBlur, readonly } = useField<string>();\n\n  return (\n    <JsonImport\n      value={value as string}\n      onChange={onChange}\n      onBlur={onBlur}\n      disabled={readonly}\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EditorProvider } from '@coze-editor/editor/react';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useEditorThemeState } from '@/hooks/use-editor-theme-state';\nimport { useField, withField } from '@/form';\nimport { InnerEditorContainer } from '@/components/editor-container';\n\nimport { InnerEditor } from './inner-editor';\n\nimport styles from './index.module.less';\n\nexport const JsonExtensionEditorField = withField(() => {\n  const { value, errors, readonly } = useField<string>();\n\n  const { isDarkTheme } = useEditorThemeState();\n\n  return (\n    <InnerEditorContainer\n      name={'http-field-json-container'}\n      className={styles['json-editor-container']}\n      isError={!readonly && !!errors?.length}\n    >\n      <EditorProvider>\n        <InnerEditor\n          name={'http-field-json-editor'}\n          placeholder={I18n.t('node_http_json_input')}\n          value={value as string}\n          minHeight={78}\n          // Forbid editing in the form\n          readonly={true}\n          borderRadius={8}\n          isDarkTheme={isDarkTheme}\n        />\n      </EditorProvider>\n    </InnerEditorContainer>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FieldProps, useField, withField } from '@/form';\nimport {\n  Select,\n  type SelectProps as BaseSelectProps,\n} from '@coze-arch/coze-design';\nimport { BodyType } from '../../setters/constants';\nimport { useNodeFormPanelState } from '@/hooks/use-node-side-sheet-store';\n\ntype SelectProps = Omit<\n  BaseSelectProps,\n  'value' | 'onChange' | 'onBlur' | 'onFocus' | 'hasError'\n>;\n\nexport const BodyTypeSelectField: React.FC<SelectProps & FieldProps> =\n  withField<SelectProps>(props => {\n    const { value, onChange, onBlur, errors } = useField<string | number>();\n\n    const { fullscreenPanel, setFullscreenPanel } = useNodeFormPanelState();\n\n    const handleOnChange = (v: string | number) => {\n      if (fullscreenPanel && v !== BodyType.Json) {\n        setFullscreenPanel(null);\n      }\n      onChange(v);\n    };\n\n    return (\n      <Select\n        {...props}\n        value={value}\n        onChange={v => handleOnChange(v as string | number)}\n        onBlur={onBlur}\n        hasError={errors && errors.length > 0}\n      />\n    );\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport {\n  useNodeTestId,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { Section, FieldArray, Field, AddButton, useWatch } from '@/form';\nimport { CopyButton } from '@/components/copy-button';\n\nimport { BodyType, bodyTypeToField, bodyTypeToLabel } from '../constants';\nimport { RawTextEditorField } from '../../fields/raw-text-editor';\nimport {\n  JsonExtensionEditorField,\n  JsonImportField,\n} from '../../fields/json-import-editor';\nimport { BodyTypeSelectField } from '../../fields/body-type-select';\nimport { INPUT_VALUE_COLUMNS } from '../../constants';\nimport { ParametersInputGroupField } from '../../../common/fields';\n\nexport const BodySetter = ({ setterName }) => {\n  const readonly = useReadonly();\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const optionList = useMemo(\n    () =>\n      Object.keys(BodyType).map(item => ({\n        label: I18n.t(bodyTypeToLabel[BodyType[item]]),\n        value: BodyType[item],\n      })),\n    [],\n  );\n\n  const bodyType: BodyType = useWatch(`${setterName}.bodyType`);\n\n  const bodyFormName = useMemo(\n    () => `${setterName}.bodyData.${bodyTypeToField[bodyType]}`,\n    [setterName, bodyType],\n  );\n\n  const bodyActions = useMemo(() => {\n    if (\n      bodyType === BodyType.FormData ||\n      bodyType === BodyType.FormUrlEncoded\n    ) {\n      return !readonly\n        ? [\n            <FieldArray key={bodyFormName} name={bodyFormName}>\n              {({ append }) => (\n                <AddButton\n                  onClick={() =>\n                    append({\n                      name: '',\n                      type: ViewVariableType.String,\n                      input: {\n                        type: ValueExpressionType.LITERAL,\n                        content: '',\n                      },\n                    })\n                  }\n                />\n              )}\n            </FieldArray>,\n          ]\n        : [];\n    } else if (bodyType === BodyType.Json) {\n      return !readonly\n        ? [<JsonImportField name={bodyFormName} hasFeedback={false} />]\n        : [\n            <Field<string> name={bodyFormName}>\n              {({ value }) => <CopyButton value={value as string} />}\n            </Field>,\n          ];\n    } else if (bodyType === BodyType.RawText) {\n      return readonly\n        ? [\n            <Field<string> name={bodyFormName}>\n              {({ value }) => <CopyButton value={value as string} />}\n            </Field>,\n          ]\n        : [];\n    }\n    return [];\n  }, [bodyFormName, bodyType]);\n\n  return (\n    <Section\n      title={I18n.t('node_http_body')}\n      tooltip={I18n.t('node_http_body_desc')}\n      actions={bodyActions}\n    >\n      <div className=\"flex flex-col\">\n        <BodyTypeSelectField\n          defaultValue={BodyType.Empty}\n          name={`${setterName}.bodyType`}\n          size=\"small\"\n          data-testid={getNodeSetterId('body-type-select')}\n          optionList={optionList}\n          disabled={readonly}\n          style={{\n            width: '100%',\n            borderColor:\n              'var(--Stroke-COZ-stroke-plus, rgba(84, 97, 156, 0.27))',\n            marginBottom: '8px',\n          }}\n        />\n        {bodyType === BodyType.Json && (\n          <JsonExtensionEditorField name={bodyFormName} />\n        )}\n        {bodyType === BodyType.FormData && (\n          <ParametersInputGroupField\n            fieldEditable={!readonly}\n            columns={INPUT_VALUE_COLUMNS}\n            name={bodyFormName}\n            disabledTypes={ViewVariableType.getComplement([\n              ViewVariableType.String,\n              ViewVariableType.File,\n              ViewVariableType.Image,\n              ViewVariableType.Video,\n              ViewVariableType.Svg,\n              ViewVariableType.Txt,\n              ViewVariableType.Doc,\n              ViewVariableType.Excel,\n              ViewVariableType.Ppt,\n              ViewVariableType.Zip,\n              ViewVariableType.Code,\n            ])}\n          />\n        )}\n        {bodyType === BodyType.FormUrlEncoded && (\n          <ParametersInputGroupField\n            fieldEditable={!readonly}\n            hiddenTypes\n            columns={INPUT_VALUE_COLUMNS}\n            name={bodyFormName}\n            inputType={ViewVariableType.String}\n          />\n        )}\n        {bodyType === BodyType.RawText && (\n          <RawTextEditorField\n            name={bodyFormName}\n            minHeight={78}\n            placeholder={I18n.t('node_http_raw_text_input')}\n          />\n        )}\n        {bodyType === BodyType.Binary && (\n          <ValueExpressionInputField\n            inputType={ViewVariableType.File}\n            availableFileTypes={[\n              ViewVariableType.File,\n              ViewVariableType.Image,\n              ViewVariableType.Video,\n              ViewVariableType.Svg,\n              ViewVariableType.Txt,\n              ViewVariableType.Doc,\n              ViewVariableType.Excel,\n              ViewVariableType.Ppt,\n              ViewVariableType.Zip,\n              ViewVariableType.Code,\n            ]}\n            disabledTypes={ViewVariableType.getComplement([\n              ViewVariableType.File,\n              ViewVariableType.Image,\n              ViewVariableType.Video,\n              ViewVariableType.Svg,\n              ViewVariableType.Txt,\n              ViewVariableType.Doc,\n              ViewVariableType.Excel,\n              ViewVariableType.Ppt,\n              ViewVariableType.Zip,\n              ViewVariableType.Code,\n              ViewVariableType.ArrayFile,\n            ])}\n            name={`${bodyFormName}.fileURL`}\n          />\n        )}\n      </div>\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\n\n// import { I18n } from '@coze-arch/i18n';\nimport { Select } from '@coze-arch/coze-design';\n\nimport InputLabel from '@/nodes-v2/components/input-label';\nimport { useField, withField } from '@/form';\n\nimport { CustomAuthAddToType } from '../constants';\n\nexport const AddToField = withField(({ readonly }: { readonly?: boolean }) => {\n  const { value, onChange } = useField<CustomAuthAddToType>();\n\n  const { getNodeSetterId } = useNodeTestId();\n\n  const optionList = [\n    {\n      label: 'Header',\n      value: CustomAuthAddToType.Header,\n    },\n    {\n      label: 'Query',\n      value: CustomAuthAddToType.Query,\n    },\n  ];\n\n  return (\n    <div className=\"flex items-center pl-[4px] gap-[4px] mt-[6px]\">\n      <div\n        style={{\n          flex: 2,\n        }}\n      >\n        <InputLabel label=\"Add To\" />\n      </div>\n      <div\n        style={{\n          flex: 3,\n        }}\n      >\n        <Select\n          size=\"small\"\n          data-testid={getNodeSetterId('auth-add-to-select')}\n          optionList={optionList}\n          value={value}\n          disabled={readonly}\n          style={{\n            width: '100%',\n            borderColor:\n              'var(--Stroke-COZ-stroke-plus, rgba(84, 97, 156, 0.27))',\n          }}\n          onChange={v => onChange(v as CustomAuthAddToType)}\n        />\n      </div>\n    </div>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useMemo, useRef } from 'react';\n\nimport {\n  type InputTypeValueVO,\n  useNodeTestId,\n  ValueExpressionType,\n  ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport {\n  Section,\n  type SectionRefType,\n  SelectField,\n  SwitchField,\n  useWatch,\n} from '@/form';\n\nimport {\n  AuthType,\n  authTypeToField,\n  authTypeToLabelKey,\n  CustomAuthAddToType,\n} from '../constants';\nimport { ParametersInputGroupField } from '../../../common/fields';\nimport { AddToField } from './add-to-field';\n\nexport const AuthSetter = ({ setterName }) => {\n  const sectionRef = useRef<SectionRefType>(null);\n  const { getNodeSetterId } = useNodeTestId();\n  const readonly = useReadonly();\n\n  const optionList = useMemo(\n    () =>\n      [AuthType.Bearer, AuthType.Custom].map(item => ({\n        label: I18n.t(authTypeToLabelKey[item] as I18nKeysNoOptionsType),\n        value: item,\n      })),\n    [],\n  );\n\n  const authType: AuthType = useWatch(`${setterName}.authType`);\n\n  const authOpen = useWatch(`${setterName}.authOpen`);\n\n  useEffect(() => {\n    if (authOpen) {\n      sectionRef.current?.open();\n    } else {\n      sectionRef.current?.close();\n    }\n  }, [authOpen]);\n\n  const paramsFieldName = useMemo(\n    () =>\n      authType === AuthType.Custom\n        ? `${setterName}.authData.${authTypeToField[authType]}.data`\n        : `${setterName}.authData.${authTypeToField[authType]}`,\n    [authType, setterName],\n  );\n\n  const authDataDefaultValueMap: Record<AuthType, InputTypeValueVO[]> = {\n    [AuthType.BasicAuth]: [\n      {\n        name: 'username',\n        type: ViewVariableType.String,\n        input: { type: ValueExpressionType.LITERAL, content: '' },\n      },\n      {\n        name: 'password',\n        type: ViewVariableType.String,\n        input: { type: ValueExpressionType.LITERAL, content: '' },\n      },\n    ],\n    [AuthType.Bearer]: [\n      {\n        name: 'token',\n        type: ViewVariableType.String,\n        input: {\n          type: ValueExpressionType.LITERAL,\n          content: '',\n        },\n      },\n    ],\n    [AuthType.Custom]: [\n      {\n        name: 'Key',\n        type: ViewVariableType.String,\n        input: {\n          type: ValueExpressionType.LITERAL,\n          content: '',\n        },\n      },\n      {\n        name: 'Value',\n        type: ViewVariableType.String,\n        input: {\n          type: ValueExpressionType.LITERAL,\n          content: '',\n        },\n      },\n    ],\n  };\n\n  return (\n    <Section\n      ref={sectionRef}\n      title={I18n.t('node_http_auth')}\n      tooltip={I18n.t('node_http_auth_desc')}\n      actions={[\n        <SwitchField\n          name={`${setterName}.authOpen`}\n          defaultValue={false}\n          size=\"mini\"\n        />,\n      ]}\n      isEmpty={!authOpen}\n      emptyText={I18n.t('http_node_auth_notopen')}\n    >\n      <div className=\"flex flex-col\">\n        <SelectField\n          name={`${setterName}.authType`}\n          size=\"small\"\n          data-testid={getNodeSetterId('auth-type-select')}\n          optionList={optionList}\n          style={{\n            width: '100%',\n            borderColor:\n              'var(--Stroke-COZ-stroke-plus, rgba(84, 97, 156, 0.27))',\n            marginBottom: '8px',\n          }}\n        />\n        <div className=\"pl-[4px]\">\n          <ParametersInputGroupField\n            defaultValue={authDataDefaultValueMap[authType]}\n            name={paramsFieldName}\n            deps={[`${setterName}.authType`]}\n            key={authType}\n            nameReadonly\n            hiddenTypeTag\n            fieldEditable={false}\n            hiddenRemove\n            hiddenTypes\n            inputType={ViewVariableType.String}\n          />\n        </div>\n        {authType === AuthType.Custom && (\n          <AddToField\n            deps={[`${setterName}.authType`]}\n            defaultValue={CustomAuthAddToType.Header}\n            name={`${setterName}.authData.${authTypeToField[authType]}.addTo`}\n            readonly={readonly}\n          />\n        )}\n      </div>\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Section, InputNumberField } from '@/form';\n\nimport { OutputsField, ParametersInputGroup } from '../common/fields';\nimport { ApiSetter, AuthSetter, BodySetter } from './setters';\nimport { INPUT_VALUE_COLUMNS } from './constants';\n\nconst Render = () => (\n  <NodeConfigForm>\n    <ApiSetter />\n    <ParametersInputGroup\n      name=\"inputs.params\"\n      title={I18n.t('node_http_request_params')}\n      tooltip={I18n.t('node_http_request_params_desc')}\n      hiddenTypes\n      defaultValue={[]}\n      columns={INPUT_VALUE_COLUMNS}\n      inputType={ViewVariableType.String}\n    />\n    <ParametersInputGroup\n      name=\"inputs.headers\"\n      title={I18n.t('node_http_headers')}\n      tooltip={I18n.t('node_http_headers_desc')}\n      hiddenTypes\n      defaultValue={[]}\n      columns={INPUT_VALUE_COLUMNS}\n      defaultAppendValue={{\n        name: '',\n        type: ViewVariableType.String,\n        input: { type: ValueExpressionType.LITERAL, content: '' },\n      }}\n      inputType={ViewVariableType.String}\n    />\n    <AuthSetter setterName=\"inputs.auth\" />\n\n    <BodySetter setterName=\"inputs.body\" />\n\n    <Section title={I18n.t('node_http_timeout_setting')}>\n      <InputNumberField\n        name=\"inputs.setting.timeout\"\n        defaultValue={120}\n        max={180}\n        min={0}\n        className=\"w-full\"\n        style={{\n          height: '24px',\n          borderColor: 'var(--Stroke-COZ-stroke-plus, rgba(84, 97, 156, 0.27))',\n        }}\n      />\n    </Section>\n    <Section title={I18n.t('node_http_retry_count')}>\n      <InputNumberField\n        name=\"inputs.setting.retryTimes\"\n        defaultValue={3}\n        max={10}\n        min={0}\n        className=\"w-full\"\n        style={{\n          height: '24px',\n          borderColor: 'var(--Stroke-COZ-stroke-plus, rgba(84, 97, 156, 0.27))',\n        }}\n      />\n    </Section>\n    <OutputsField\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('node_http_response_data')}\n      id=\"database-node-outputs\"\n      name=\"outputs\"\n      topLevelReadonly={true}\n      disabledTypes={[\n        ViewVariableType.Object,\n        ViewVariableType.ArrayBoolean,\n        ViewVariableType.ArrayObject,\n        ViewVariableType.ArrayInteger,\n        ViewVariableType.ArrayNumber,\n        ViewVariableType.ArrayString,\n      ]}\n      customReadonly\n    />\n  </NodeConfigForm>\n);\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\n\nimport { getVariableInfoFromExpression } from '../variable-support/utils';\n\ninterface Options {\n  required?: boolean;\n  emptyMessage?: string;\n  invalidMessage?: string;\n}\n\nexport const expressionStringValidator = (\n  expressionStr: string,\n  { node }: NodeFormContext,\n  options: Options,\n) => {\n  const { required = true, emptyMessage, invalidMessage } = options;\n  const doubleBracedPattern = /{{([^}]+)}}/g;\n  const matches = expressionStr?.match(doubleBracedPattern);\n  // Remove {{}} from string\n  const matchesContent = matches?.map((varStr: string) =>\n    varStr.replace(/^{{|}}$/g, ''),\n  );\n  let hasInvalidVar = false;\n  matchesContent?.forEach((varStr: string) => {\n    const { fieldKeyPath } = getVariableInfoFromExpression(varStr);\n    const workflowVariable =\n      node.context.variableService.getWorkflowVariableByKeyPath(fieldKeyPath, {\n        node,\n      });\n\n    if (!workflowVariable) {\n      hasInvalidVar = true;\n    }\n  });\n\n  if (required && !expressionStr) {\n    return emptyMessage;\n  } else if (hasInvalidVar) {\n    return invalidMessage;\n  }\n  return;\n};\n\nexport const createEexpressionStringValidator =\n  ({ required, emptyMessage, invalidMessage }: Options) =>\n  ({ value, context }) =>\n    expressionStringValidator(value, context, {\n      required,\n      emptyMessage,\n      invalidMessage,\n    });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, isString } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n  type Validate,\n} from '@flowgram-adapter/free-layout-editor';\nimport { json, type Text } from '@coze-editor/editor/language-json';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { valueExpressionValidator } from '@/form-extensions/validators';\n\nimport { BodyType } from './setters/constants';\nimport { createAuthValidator } from './setters/auth/create-auth-validator';\nimport FormRender from './form-render';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\nimport { expressionStringValidator } from './components/base-editor/validate';\n\nconst urlPathName = 'inputs.apiInfo.url';\nconst headersPathName = 'inputs.headers.*.name';\nconst headersInputPathName = 'inputs.headers.*.input';\nconst paramsPathName = 'inputs.params.*.name';\nconst paramsInputPathName = 'inputs.params.*.input';\nconst bodyJsonPathName = 'inputs.body.bodyData.json';\nconst bodyRawTextPathName = 'inputs.body.bodyData.rawText';\nconst bodyFormDataPathName = 'inputs.body.bodyData.formData.*.name';\nconst bodyFormDataInputPathName = 'inputs.body.bodyData.formData.*.input';\nconst bodyFormURLEncodedPathName = 'inputs.body.bodyData.formURLEncoded.*.name';\nconst bodyFormURLEncodedInputPathName =\n  'inputs.body.bodyData.formURLEncoded.*.input';\nconst httpNameValidationRule =\n  /^(?!.*\\b(true|false|and|AND|or|OR|not|NOT|null|nil|If|Switch)\\b)[a-zA-Z_][-a-zA-Z_$0-9]*$/;\nconst httpNameValidationRuleError = I18n.t('node_http_name_rule');\n\ninterface Match {\n  match: string;\n  range: [number, number];\n}\n\nexport const HTTP_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onBlur,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    [urlPathName]: ({ value, context }) => {\n      if (isString(value) && value?.length > 10000) {\n        return I18n.t('node_http_url_length_limit');\n      }\n      return expressionStringValidator(value, context, {\n        emptyMessage: I18n.t('node_http_url_required'),\n        invalidMessage: I18n.t('node_http_url_invalid_var'),\n      });\n    },\n    [headersPathName]: createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'inputs.headers') || []).map(item => item.name),\n      validatorConfig: {\n        rule: httpNameValidationRule,\n        errorMessage: httpNameValidationRuleError,\n      },\n    }),\n    [headersInputPathName]: createValueExpressionInputValidate({\n      required: false,\n    }),\n    [paramsPathName]: createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'inputs.params') || []).map(item => item.name),\n      validatorConfig: {\n        rule: httpNameValidationRule,\n        errorMessage: httpNameValidationRuleError,\n      },\n    }),\n    [paramsInputPathName]: createValueExpressionInputValidate({\n      required: false,\n    }),\n    [bodyJsonPathName]: (async ({ value, formValues, context }) => {\n      const bodyType = get(formValues, 'inputs.body.bodyType');\n      if (bodyType !== BodyType.Json) {\n        return;\n      }\n\n      function findAllMatches(inputString: string, regex: RegExp): Match[] {\n        const globalRegex = new RegExp(\n          regex,\n          regex.flags.includes('g') ? regex.flags : `${regex.flags}g`,\n        );\n        const matches: Match[] = [];\n        const matchIterator = inputString.matchAll(globalRegex);\n        for (const match of matchIterator) {\n          if (match.index === undefined) {\n            continue;\n          }\n          matches.push({\n            match: match[0],\n            range: [match.index, match.index + match[0].length],\n          });\n        }\n\n        return matches;\n      }\n\n      const transform = (text: Text) => {\n        const originalSource = text.toString();\n        const matches = findAllMatches(originalSource, /\\{\\{([^\\}]*)\\}\\}/g);\n\n        if (matches.length > 0) {\n          matches.forEach(({ range }) => {\n            text.replaceRange(range[0], range[1], 'null');\n          });\n        }\n\n        return text;\n      };\n\n      const jsonErrors = await json.languageService.validate(value ?? '', {\n        transform,\n      });\n\n      if (jsonErrors.length > 0) {\n        return I18n.t('workflow_json_syntax_error', {}, 'JSON ');\n      }\n\n      return expressionStringValidator(value, context, {\n        emptyMessage: I18n.t('node_http_json_required'),\n        invalidMessage: I18n.t('node_http_json_invalid_var'),\n      });\n    }) as Validate,\n    [bodyRawTextPathName]: ({ value, formValues, context }) => {\n      const bodyType = get(formValues, 'inputs.body.bodyType');\n      if (bodyType !== BodyType.RawText) {\n        return;\n      }\n      return expressionStringValidator(value, context, {\n        required: false,\n        emptyMessage: '',\n        invalidMessage: I18n.t('node_http_raw_text_invalid_var'),\n      });\n    },\n    [bodyFormDataPathName]: ({ value, formValues, context, name }) => {\n      const bodyType = get(formValues, 'inputs.body.bodyType');\n      if (bodyType !== BodyType.FormData) {\n        return;\n      }\n      return createNodeInputNameValidate({\n        getNames: ({ formValues: curFormValues }) => {\n          const formData = get(curFormValues, 'inputs.body.bodyData.formData');\n          return formData?.map(item => item.name);\n        },\n        validatorConfig: {\n          rule: httpNameValidationRule,\n          errorMessage: httpNameValidationRuleError,\n        },\n      })({ value, formValues, context, name });\n    },\n    [bodyFormDataInputPathName]: ({ value, formValues, context }) => {\n      const { node, playgroundContext } = context;\n      const bodyType = get(formValues, 'inputs.body.bodyType');\n      if (bodyType !== BodyType.FormData) {\n        return;\n      }\n      return valueExpressionValidator({\n        value,\n        playgroundContext,\n        node,\n        required: false,\n      });\n    },\n    [bodyFormURLEncodedPathName]: ({ value, formValues, context, name }) => {\n      const bodyType = get(formValues, 'inputs.body.bodyType');\n      if (bodyType !== BodyType.FormUrlEncoded) {\n        return;\n      }\n      return createNodeInputNameValidate({\n        getNames: ({ formValues: curFormValues }) => {\n          const formURLEncodedData = get(\n            curFormValues,\n            'inputs.body.bodyData.formURLEncoded',\n          );\n          return formURLEncodedData?.map(item => item.name);\n        },\n        validatorConfig: {\n          rule: httpNameValidationRule,\n          errorMessage: httpNameValidationRuleError,\n        },\n      })({ value, formValues, context, name });\n    },\n    [bodyFormURLEncodedInputPathName]: ({ value, formValues, context }) => {\n      const { node, playgroundContext } = context;\n      const bodyType = get(formValues, 'inputs.body.bodyType');\n      if (bodyType !== BodyType.FormUrlEncoded) {\n        return;\n      }\n      return valueExpressionValidator({\n        value,\n        playgroundContext,\n        node,\n        required: false,\n      });\n    },\n    ...createAuthValidator(),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\nimport { nanoid } from 'nanoid';\nimport { get, isEmpty, set } from 'lodash-es';\nimport { type NodeFormContext } from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  type NodeDataDTO,\n  ViewVariableType,\n  VariableTypeDTO,\n  type InputTypeValueDTO,\n  type InputValueDTO,\n  type ValueExpressionDTO,\n  type InputTypeValueVO,\n  type ValueExpression,\n} from '@coze-workflow/base';\n\nimport { type HeaderAndParamsDataDTO } from './types';\nimport {\n  AuthType,\n  BodyType,\n  HttpMethod,\n  CustomAuthAddToType,\n} from './setters/constants';\nimport { fileTypeDTOToVO, fileTypeVOToDTO } from './constants';\n\ninterface FormData {\n  inputs: Record<string, unknown>;\n}\n\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const transformOnInit = (\n  value: NodeDataDTO,\n  context: NodeFormContext,\n) => {\n  const { playgroundContext, node } = context;\n  const { variableService } = playgroundContext;\n  const {\n    inputs = {\n      apiInfo: {\n        method: HttpMethod.GET,\n        url: undefined,\n      },\n      body: {\n        bodyType: BodyType.Empty,\n        bodyData: undefined,\n      },\n      headers: undefined,\n      params: undefined,\n      auth: {\n        authType: AuthType.Bearer,\n        authData: {\n          customData: {\n            data: undefined,\n            addTo: CustomAuthAddToType.Header,\n          },\n          basicAuthData: undefined,\n          bearerTokenData: undefined,\n        },\n      },\n      setting: {\n        timeout: 120, //unit second\n        retryTimes: 3,\n      },\n    },\n    outputs,\n  } = value || {};\n\n  const initValue = {\n    nodeMeta: value?.nodeMeta,\n    inputParameters: [],\n    inputs,\n    outputs: isEmpty(outputs)\n      ? [\n          {\n            key: nanoid(),\n            type: ViewVariableType.String,\n            name: 'body',\n          },\n          {\n            key: nanoid(),\n            type: ViewVariableType.Integer,\n            name: 'statusCode',\n          },\n          {\n            key: nanoid(),\n            type: ViewVariableType.String,\n            name: 'headers',\n          },\n        ]\n      : outputs,\n  };\n\n  const headersData = get(\n    initValue,\n    'inputs.headers',\n  ) as HeaderAndParamsDataDTO[];\n\n  if (headersData) {\n    const headersDataVO = headersData.map(param => ({\n      name: param.name,\n      type: VariableTypeDTO.string,\n      input: param.input,\n    }));\n    const transHeadersData = variableUtils.inputTypeValueDTOToVO(\n      headersDataVO as InputTypeValueDTO[],\n      variableService,\n      {\n        node,\n      },\n    );\n    set(initValue, 'inputs.headers', transHeadersData);\n  }\n\n  const paramsData = get(value, 'inputs.params') as HeaderAndParamsDataDTO[];\n\n  if (paramsData) {\n    const paramsDataVO = paramsData.map(param => ({\n      name: param.name,\n      type: VariableTypeDTO.string,\n      input: param.input,\n    }));\n    const transParamsData = variableUtils.inputTypeValueDTOToVO(\n      paramsDataVO as InputTypeValueDTO[],\n      variableService,\n      {\n        node,\n      },\n    );\n    set(initValue, 'inputs.params', transParamsData);\n  }\n\n  const baseAuthPath = 'inputs.auth.authData';\n  const authDataPathArray = [\n    'basicAuthData',\n    'customData.data',\n    'bearerTokenData',\n  ];\n\n  authDataPathArray.forEach(authDataPath => {\n    const authData = get(initValue, `${baseAuthPath}.${authDataPath}`);\n    if (authData) {\n      const transAuthData = (authData as InputTypeValueDTO[]).map(param => ({\n        name: param.name,\n        type: variableUtils.DTOTypeToViewType(param.type),\n        input: variableUtils.valueExpressionToVO(param.input, variableService),\n      }));\n      set(initValue, `${baseAuthPath}.${authDataPath}`, transAuthData);\n    }\n  });\n\n  const baseBodyPath = 'inputs.body.bodyData';\n\n  const formURLEncodedPath = 'formURLEncoded';\n  const formURLEncodedData = get(\n    initValue,\n    `${baseBodyPath}.${formURLEncodedPath}`,\n  );\n  if (formURLEncodedData) {\n    const transBodyData = (formURLEncodedData as InputValueDTO[]).map(\n      param => ({\n        name: param.name,\n        type: VariableTypeDTO.string,\n        input: param.input,\n      }),\n    );\n\n    set(\n      initValue,\n      `${baseBodyPath}.${formURLEncodedPath}`,\n      variableUtils.inputTypeValueDTOToVO(\n        transBodyData as InputTypeValueDTO[],\n        variableService,\n        {\n          node,\n        },\n      ),\n    );\n  }\n\n  const formDataPath = 'formData';\n  const formData = get(initValue, `${baseBodyPath}.${formDataPath}`);\n  if (formData) {\n    const { data = [] as InputValueDTO[], typeMapping = '{}' } = formData;\n\n    const parsedTypeMapping = JSON.parse(typeMapping);\n\n    const initData = data?.map(param => {\n      const basicTypeDTO = get(parsedTypeMapping, `${param.name}.basicType`);\n      let type = fileTypeDTOToVO[basicTypeDTO];\n      /*\n       * Compatible with complex data types\n       * rawMeta.type stores ViewVariableType\n       */\n      if (param.input?.value?.rawMeta?.type) {\n        type = param.input?.value?.rawMeta?.type;\n      }\n\n      return {\n        name: param.name,\n        type,\n        input: variableUtils.valueExpressionToVO(param.input, variableService),\n      };\n    });\n\n    set(initValue, `${baseBodyPath}.${formDataPath}`, initData);\n  }\n\n  const binaryPath = 'binary.fileURL';\n  const binaryData = get(\n    initValue,\n    `${baseBodyPath}.${binaryPath}`,\n  ) as unknown as ValueExpressionDTO;\n  const binaryDataVO = variableUtils.inputValueToVO(\n    {\n      name: 'fileURL',\n      input: binaryData,\n    },\n    variableService,\n  );\n  set(\n    initValue,\n    `${baseBodyPath}.${binaryPath}`,\n    binaryDataVO?.input ?? {\n      type: 'literal',\n      content: '',\n    },\n  );\n\n  return initValue;\n};\n\n/**\n * Front-end form data - > node back-end data\n */\nexport const transformOnSubmit = (\n  value: FormData,\n  context: NodeFormContext,\n): NodeDataDTO => {\n  const formattedValue: Record<string, unknown> = {\n    ...value,\n  };\n\n  const { node, playgroundContext } = context;\n  const { variableService } = playgroundContext;\n\n  const headersData = get(value, 'inputs.headers');\n  if (headersData) {\n    const transHeadersData = variableUtils\n      .inputTypeValueVOToDTO(\n        headersData as InputTypeValueVO[],\n        variableService,\n        {\n          node,\n        },\n      )\n      .map(param => ({\n        // Backend does not require type\n        name: param.name,\n        input: param.input,\n      }));\n    set(formattedValue, 'inputs.headers', transHeadersData);\n  }\n\n  const paramsData = get(value, 'inputs.params');\n  if (paramsData) {\n    const transParamsData = variableUtils\n      .inputTypeValueVOToDTO(\n        paramsData as InputTypeValueVO[],\n        variableService,\n        {\n          node,\n        },\n      )\n      .map(param => ({\n        // Backend does not require type\n        name: param.name,\n        input: param.input,\n      }));\n    set(formattedValue, 'inputs.params', transParamsData);\n  }\n\n  const baseAuthPath = 'inputs.auth.authData';\n  const authDataPathArray = [\n    'basicAuthData',\n    'customData.data',\n    'bearerTokenData',\n  ];\n\n  authDataPathArray.forEach(authDataPath => {\n    const authData = get(formattedValue, `${baseAuthPath}.${authDataPath}`);\n    if (authData) {\n      const transAuthData = variableUtils.inputTypeValueVOToDTO(\n        authData as InputTypeValueVO[],\n        variableService,\n        {\n          node,\n        },\n      );\n      set(formattedValue, `${baseAuthPath}.${authDataPath}`, transAuthData);\n    }\n  });\n\n  const baseBodyPath = 'inputs.body.bodyData';\n\n  const formURLEncodedPath = 'formURLEncoded';\n  const formURLEncodedData = get(\n    formattedValue,\n    `${baseBodyPath}.${formURLEncodedPath}`,\n  );\n  if (formURLEncodedData) {\n    const transBodyData = variableUtils\n      .inputTypeValueVOToDTO(\n        formURLEncodedData as InputTypeValueVO[],\n        variableService,\n        {\n          node,\n        },\n      )\n      .map(param => ({\n        // Backend does not require type\n        name: param.name,\n        input: param.input,\n      }));\n\n    set(formattedValue, `${baseBodyPath}.${formURLEncodedPath}`, transBodyData);\n  }\n\n  const formDataPath = 'formData';\n  const formData = get(\n    formattedValue,\n    `${baseBodyPath}.${formDataPath}`,\n  ) as InputTypeValueVO[];\n  if (formData) {\n    const transBodyData = {\n      data: [] as { name: string; input: ValueExpressionDTO }[],\n      typeMapping: {},\n    };\n\n    formData?.forEach(param => {\n      transBodyData.data.push({\n        name: param.name,\n        input: variableUtils.valueExpressionToDTO(\n          param.input,\n          variableService,\n          {\n            node,\n          },\n        ),\n      });\n\n      set(transBodyData.typeMapping, param.name, {\n        basicType: fileTypeVOToDTO[param.type],\n      });\n    });\n\n    set(formattedValue, `${baseBodyPath}.${formDataPath}`, {\n      ...transBodyData,\n      typeMapping: JSON.stringify(transBodyData.typeMapping ?? {}),\n    });\n  }\n\n  const binaryPath = 'binary.fileURL';\n  const defaultBinaryDataVO = {\n    fileURL: {\n      type: 'string',\n      schema: [],\n      assistType: ViewVariableType.String,\n      value: {\n        type: 'literal',\n        content: '',\n        rawMeta: { type: ViewVariableType.File },\n      },\n    },\n  };\n  const binaryData =\n    get(formattedValue, `${baseBodyPath}.${binaryPath}`) ?? defaultBinaryDataVO;\n  if (binaryData) {\n    const transBinaryData = variableUtils.valueExpressionToDTO(\n      binaryData as ValueExpression,\n      variableService,\n      {\n        node,\n      },\n    );\n\n    set(formattedValue, `${baseBodyPath}.${binaryPath}`, transBinaryData);\n  }\n\n  return formattedValue as unknown as NodeDataDTO;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { HTTP_FORM_META } from './form-meta';\n\nexport const HTTP_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Http,\n  meta: {\n    nodeDTOType: StandardNodeType.Http,\n    style: {\n      width: 360,\n    },\n    size: { width: 360, height: 130.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    test,\n    helpLink: '/open/docs/guides/http_node',\n  },\n  formMeta: HTTP_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SizeSelect } from '@coze-workflow/components';\n\nimport { withField, useField } from '@/form';\n\nconst ratioOptions = [\n  {\n    label: '16:9 (1024*576)',\n    value: {\n      width: 1024,\n      height: 576,\n    },\n  },\n  {\n    label: '3:2 (1024*682)',\n    value: {\n      width: 1024,\n      height: 682,\n    },\n  },\n  {\n    label: '4:3 (1024*768)',\n    value: {\n      width: 1024,\n      height: 768,\n    },\n  },\n  {\n    label: '1:1 (1024*1024)',\n    value: {\n      width: 1024,\n      height: 1024,\n    },\n  },\n  {\n    label: '3:4 (768*1024)',\n    value: {\n      width: 768,\n      height: 1024,\n    },\n  },\n  {\n    label: '2:3 (682*1024)',\n    value: {\n      width: 682,\n      height: 1024,\n    },\n  },\n  {\n    label: '9:16 (576*1024)',\n    value: {\n      width: 576,\n      height: 1024,\n    },\n  },\n];\n\nexport const RatioField = withField(() => {\n  const { value, readonly, onChange } = useField<{\n    width?: number;\n    height?: number;\n  }>();\n\n  return (\n    <SizeSelect\n      value={value}\n      onChange={onChange}\n      readonly={readonly}\n      minWidth={512}\n      maxWidth={1536}\n      minHeight={512}\n      maxHeight={1536}\n      options={ratioOptions}\n      layoutStyle=\"vertical\"\n    />\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\n\nimport thumbnail8 from '../../assets/8.png';\nimport thumbnail7 from '../../assets/7.jpg';\nimport thumbnail6 from '../../assets/6.jpg';\nimport thumbnail5 from '../../assets/5.jpg';\nimport thumbnail4 from '../../assets/4.jpg';\nimport thumbnail3 from '../../assets/3.jpg';\nimport thumbnail2 from '../../assets/2.jpg';\nimport thumbnail1 from '../../assets/1.jpg';\n\nconst thumbnails = [\n  thumbnail1,\n  thumbnail2,\n  thumbnail3,\n  thumbnail4,\n  thumbnail5,\n  thumbnail6,\n  thumbnail7,\n  thumbnail8,\n];\n\nexport function createModelOptions() {\n  let models = [1, 8, 2, 3, 4, 5, 6, 7];\n\n  if (IS_OVERSEA) {\n    models = models.filter(model => ![6].includes(model));\n  }\n\n  return models.map(model => ({\n    label: I18n.t(`Imageflow_model${model}` as I18nKeysNoOptionsType),\n    value: model,\n    thumbnail: thumbnails[model - 1],\n  }));\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ImageModelSelectField } from '@/node-registries/common/components';\nimport { type FieldProps } from '@/form';\n\nimport { createModelOptions } from './create-model-options';\n\nexport const ModelField = (props: Omit<FieldProps, 'children'>) => (\n  <ImageModelSelectField options={createModelOptions()} {...props} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section, SliderField, type FieldProps } from '@/form';\n\nimport { RatioField } from './ratio-field';\nimport { ModelField } from './model-field';\n\nexport const ModelSettingField = ({ name }: Pick<FieldProps, 'name'>) => (\n  <Section title={I18n.t('Imageflow_model_deploy')}>\n    <div className=\"flex flex-col gap-[8px]\">\n      <ModelField\n        name={`${name}.model`}\n        layout=\"vertical\"\n        label={I18n.t('Imageflow_model')}\n      />\n      <RatioField\n        name={`${name}.custom_ratio`}\n        layout=\"vertical\"\n        label={I18n.t('Imageflow_ratio')}\n        tooltip={I18n.t('Imageflow_size_range')}\n      />\n      <SliderField\n        name={`${name}.ddim_steps`}\n        layout=\"vertical\"\n        label={I18n.t('Imageflow_generate_standard')}\n        tooltip={I18n.t('imageflow_generation_desc1')}\n        min={1}\n        max={40}\n        step={1}\n      />\n    </div>\n  </Section>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEFAULT_REFERENCE = {\n  weight: 0.7,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\n\nimport thumbnail7 from '../../assets/reference-7.png';\nimport thumbnail6 from '../../assets/reference-6.jpg';\nimport thumbnail5 from '../../assets/reference-5.jpg';\nimport thumbnail4 from '../../assets/reference-4.jpg';\nimport thumbnail3 from '../../assets/reference-3.jpg';\nimport thumbnail2 from '../../assets/reference-2.jpg';\nimport thumbnail1 from '../../assets/reference-1.jpg';\n\nconst thumbnails = [\n  thumbnail1,\n  thumbnail2,\n  thumbnail3,\n  thumbnail4,\n  thumbnail5,\n  thumbnail6,\n  thumbnail7,\n];\n\nexport function createPreprocessorOptions({\n  currentPreprocessor,\n  allSelectedPreprocessor = [],\n}: {\n  currentPreprocessor?: number;\n  allSelectedPreprocessor: number[];\n}) {\n  const options = [1, 2, 3, 4, 5, 7, 6].map(index => ({\n    label: I18n.t(`Imageflow_reference${index}` as I18nKeysNoOptionsType),\n    value: index,\n    tooltip: I18n.t(\n      `imageflow_reference_desc${index}` as I18nKeysNoOptionsType,\n    ),\n    thumbnail: thumbnails[index - 1],\n    disabled: isPreprocessorDisabled({\n      currentItemPreprocessor: currentPreprocessor,\n      currentOptionPreprocessor: index,\n      allSelectedPreprocessor,\n    }),\n  }));\n\n  return options;\n}\n\nfunction isPreprocessorDisabled({\n  currentItemPreprocessor,\n  currentOptionPreprocessor,\n  allSelectedPreprocessor,\n}: {\n  currentItemPreprocessor?: number;\n  currentOptionPreprocessor: number;\n  allSelectedPreprocessor: number[];\n}) {\n  let disabled = false;\n\n  // If the preprocessor for the current option is already selected by the current item, remove it from the allSelectedPreprocessor\n  allSelectedPreprocessor = allSelectedPreprocessor.filter(\n    item =>\n      !(\n        item === currentItemPreprocessor &&\n        currentItemPreprocessor === currentOptionPreprocessor\n      ),\n  );\n\n  // The same model cannot be added\n  if (allSelectedPreprocessor.includes(currentOptionPreprocessor)) {\n    disabled = true;\n  }\n\n  // Numbers 1 to 4 can only appear at most two models with numbers above 4, and there is no limit.\n  const group = [1, 2, 3, 4];\n  if (group.includes(currentOptionPreprocessor)) {\n    const isPreprocessorGroup =\n      allSelectedPreprocessor.filter(item => group.includes(item)).length === 2;\n\n    if (isPreprocessorGroup) {\n      disabled = true;\n    }\n  }\n\n  return disabled;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { ImageModelSelectField } from '@/node-registries/common/components';\nimport {\n  withFieldArray,\n  Section,\n  FieldArrayList,\n  FieldArrayItem,\n  ColumnTitles,\n  useFieldArray,\n  InputNumberField,\n  AddButton,\n} from '@/form';\n\nimport { type Reference } from '../../types';\nimport { DEFAULT_REFERENCE } from '../../constants';\nimport { createPreprocessorOptions } from './create-preprocessor-options';\n\nexport const ReferencesField = withFieldArray(() => {\n  const { name, value, append, remove } = useFieldArray<Reference>();\n\n  const preprocessors = useMemo(\n    () =>\n      value\n        ?.map(item => item.preprocessor)\n        .filter(item => item !== undefined) || [],\n    [value],\n  );\n\n  return (\n    <Section\n      title={I18n.t('Imageflow_reference_image')}\n      actions={[\n        <AddButton\n          key=\"add\"\n          onClick={() => append(DEFAULT_REFERENCE)}\n          disabled={value && value?.length >= 5}\n        />,\n      ]}\n    >\n      <ColumnTitles\n        columns={[\n          {\n            label: I18n.t('Imageflow_reference_info1'),\n            style: {\n              width: 120,\n            },\n          },\n          {\n            label: I18n.t('Imageflow_reference_info2'),\n            style: {\n              width: 150,\n            },\n          },\n          {\n            label: I18n.t('Imageflow_reference_info3'),\n          },\n        ]}\n      />\n      <FieldArrayList>\n        {value?.map((item, index) => {\n          const preprocessorName = `${name}.${index}.preprocessor`;\n          const urlName = `${name}.${index}.url`;\n          const weightName = `${name}.${index}.weight`;\n\n          const options = createPreprocessorOptions({\n            currentPreprocessor: item.preprocessor,\n            allSelectedPreprocessor: preprocessors,\n          });\n\n          return (\n            <FieldArrayItem onRemove={() => remove(index)}>\n              <div className=\"flex-[2_1_0%] min-w-[0px] max-w-[120px]\">\n                <ImageModelSelectField\n                  name={preprocessorName}\n                  options={options}\n                  showClear={true}\n                  placeholder={I18n.t('Imageflow_mode_choose')}\n                />\n              </div>\n\n              <div className=\"w-[150px]\">\n                <ValueExpressionInputField\n                  name={urlName}\n                  inputType={ViewVariableType.Image}\n                  selectStyle={{\n                    width: 80,\n                  }}\n                />\n              </div>\n\n              <div className=\"w-full\">\n                <InputNumberField\n                  name={weightName}\n                  min={0}\n                  max={1}\n                  step={0.1}\n                />\n              </div>\n            </FieldArrayItem>\n          );\n        })}\n      </FieldArrayList>\n    </Section>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ExpressionEditorField } from '@/node-registries/common/components';\nimport { withField, useField, Section } from '@/form';\n\nexport const PromptField = withField(\n  () => {\n    const { name } = useField();\n    const promptName = `${name}.prompt`;\n    const negativePromptName = `${name}.negative_prompt`;\n    // Guarantee that the testID of the previous node remains unchanged\n    const promptTestIDSuffix = name.replace('inputs.', '');\n    const negativePromptTestIDSuffix = name.replace('inputs.', '');\n\n    return (\n      <Section\n        title={I18n.t('Imageflow_prompt')}\n        tooltip={I18n.t('imageflow_generation_desc4')}\n      >\n        <ExpressionEditorField\n          name={promptName}\n          testIDSuffix={promptTestIDSuffix}\n          label={I18n.t('Imageflow_positive')}\n          placeholder={I18n.t('Imageflow_positive_placeholder')}\n          required={true}\n          layout=\"vertical\"\n        />\n        <ExpressionEditorField\n          name={negativePromptName}\n          testIDSuffix={negativePromptTestIDSuffix}\n          label={I18n.t('Imageflow_negative')}\n          placeholder={I18n.t('Imageflow_negative_placeholder')}\n          layout=\"vertical\"\n        />\n      </Section>\n    );\n  },\n  {\n    hasFeedback: false,\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useUpdateEffect, usePrevious } from 'ahooks';\n\nimport { withNodeConfigForm } from '@/node-registries/common/hocs';\nimport {\n  OutputsField,\n  InputsParametersField,\n} from '@/node-registries/common/fields';\nimport { useFieldValidate, useForm } from '@/form';\n\nimport { type FormData } from './types';\nimport { ModelSettingField, ReferencesField, PromptField } from './components';\n\nexport const FormRender = withNodeConfigForm(() => {\n  const validateModel = useFieldValidate('inputs.modelSetting.model');\n\n  useReferenceModelChangeEffect(validateModel);\n\n  return (\n    <>\n      <ModelSettingField name=\"inputs.modelSetting\" />\n      <ReferencesField name=\"inputs.references\" />\n      <InputsParametersField name=\"inputs.inputParameters\" />\n      <PromptField name=\"inputs.prompt\" />\n      <OutputsField name=\"outputs\" readonly={true} />\n    </>\n  );\n});\n\n// Listening to referenced model changes triggers model validation for model settings\n// With useWatch, you can't currently listen to the reference model. Instead, listen to the entire form value first\nfunction useReferenceModelChangeEffect(callback: () => void) {\n  const form = useForm<FormData>();\n  const { values } = form;\n  const previousReferences = usePrevious(values?.inputs?.references);\n\n  useUpdateEffect(() => {\n    const currentPreprocessors = values?.inputs?.references?.map(\n      reference => reference.preprocessor,\n    );\n    const previousPreprocessors = previousReferences?.map(\n      reference => reference.preprocessor,\n    );\n\n    const isSamePreprocessors =\n      currentPreprocessors?.length === previousPreprocessors?.length &&\n      currentPreprocessors?.every(\n        (preprocessor, index) =>\n          preprocessor === previousPreprocessors?.[index],\n      );\n\n    if (!isSamePreprocessors) {\n      callback();\n    }\n  }, [values]);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { get, set } from 'lodash-es';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionService } from '@/services';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport {\n  fireNodeTitleChange,\n  provideNodeOutputVariablesEffect,\n} from '@/node-registries/common/effects';\n\nimport { type FormData } from './types';\nimport { FormRender } from './form';\n\nexport const IMAGE_GENERATE_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    ['inputs.modelSetting.model']: ({ value, formValues }) => {\n      const invalidPreprocessors = {\n        1: [4, 5, 6],\n        8: [1, 2, 3, 4, 5, 6, 7],\n        3: [7],\n        6: [6, 7],\n      };\n\n      // Get references field\n      const references = formValues?.inputs?.references || [];\n\n      // Gets an array of invalid preprocessor values corresponding to the value\n      const invalidValues = invalidPreprocessors[value] || [];\n\n      // Check if the preprocessor in the references contains invalid values\n      for (const reference of references) {\n        if (invalidValues.includes(reference?.preprocessor)) {\n          return I18n.t('Imageflow_not_support');\n        }\n      }\n    },\n    ['inputs.prompt.prompt']: ({ value }) => {\n      if (!value) {\n        return I18n.t('workflow_detail_node_error_empty');\n      }\n    },\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // default value\n  defaultValues: () => ({\n    inputs: {\n      modelSetting: {\n        model: 1,\n        custom_ratio: {\n          width: 1024,\n          height: 1024,\n        },\n        ddim_steps: 25,\n      },\n      references: [],\n      prompt: {\n        prompt: '',\n        negative_prompt: '',\n      },\n      inputParameters: [],\n    },\n    outputs: [\n      {\n        key: nanoid(),\n        name: 'data',\n        type: ViewVariableType.Image,\n      },\n      {\n        key: nanoid(),\n        name: 'msg',\n        type: ViewVariableType.String,\n      },\n    ],\n  }),\n\n  formatOnInit(value, context) {\n    const { node } = context;\n    const valueExpressionService = node.getService<ValueExpressionService>(\n      ValueExpressionService,\n    );\n\n    const references = get(value, 'inputs.references') || [];\n    set(\n      value,\n      'inputs.references',\n      references.map(item => ({\n        ...item,\n        url: valueExpressionService.toVO(item.url),\n      })),\n    );\n\n    return value;\n  },\n\n  formatOnSubmit(value, context) {\n    const { node } = context;\n    const valueExpressionService = node.getService<ValueExpressionService>(\n      ValueExpressionService,\n    );\n\n    const references = get(value, 'inputs.references') || [];\n    set(\n      value,\n      'inputs.references',\n      references.map(item => ({\n        ...item,\n        url: valueExpressionService.toDTO(item.url),\n      })),\n    );\n\n    return value;\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { IMAGE_GENERATE_FORM_META } from './form-meta';\n\nexport const IMAGE_GENERATE_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> =\n  {\n    type: StandardNodeType.ImageGenerate,\n    width: 508,\n    meta: {\n      nodeDTOType: StandardNodeType.ImageGenerate,\n      test,\n      helpLink: '/open/docs/guides/image_generation_node',\n    },\n    formMeta: IMAGE_GENERATE_FORM_META,\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n, type I18nKeysNoOptionsType } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters =\n      formData?.inputParameters || formData?.inputs.inputParameters || [];\n    const references = (\n      formData?.references ||\n      formData?.inputs?.references ||\n      []\n    )\n      .filter(item => item.preprocessor)\n      .map(item => ({\n        name: `__image_references_${item.preprocessor}`,\n        title: I18n.t(\n          `Imageflow_reference${item.preprocessor}` as I18nKeysNoOptionsType,\n        ),\n        input: item.url,\n      }));\n\n    return {\n      ...generateParametersToProperties(references, { node }),\n      ...generateParametersToProperties(inputParameters, { node }),\n    };\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  StandardNodeType,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nexport const IMAGE_REFERENCE_NODE_REGISTRY: WorkflowNodeRegistry = {\n  type: StandardNodeType.ImageReference,\n  meta: {\n    nodeDTOType: StandardNodeType.ImageReference,\n  },\n  formMeta: () => {\n    throw new Error(I18n.t('workflow_node_invalid'));\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from '@flowgram-adapter/free-layout-editor';\nimport { ViewVariableType } from '@coze-workflow/nodes';\nimport { I18n } from '@coze-arch/i18n';\n\nexport const DEFAULT_USER_RESPONSE_PARAM_NAME = 'USER_RESPONSE';\nexport const DEFAULT_OPTION_ID_NAME = 'optionId';\nexport const DEFAULT_OPTION_CONTENT_NAME = 'optionContent';\n\nexport const DEFAULT_OUTPUT_NAMES = [\n  DEFAULT_USER_RESPONSE_PARAM_NAME,\n  DEFAULT_OPTION_ID_NAME,\n  DEFAULT_OPTION_CONTENT_NAME,\n];\n\nexport const DEFAULT_USE_RESPONSE = [\n  {\n    key: nanoid(),\n    name: DEFAULT_USER_RESPONSE_PARAM_NAME,\n    type: ViewVariableType.String,\n    required: true,\n    description: I18n.t(\n      'workflow_ques_ans_type_direct_key_decr',\n      {},\n      '',\n    ),\n  },\n];\n\nexport const DEFAULT_EXTRACT_OUTPUT = [\n  {\n    key: nanoid(),\n    name: 'output',\n    type: ViewVariableType.String,\n    required: true,\n  },\n];\n\nexport const DEFAULT_ANSWER_OPTION_OUTPUT = [\n  {\n    key: nanoid(),\n    name: DEFAULT_OPTION_ID_NAME,\n    type: ViewVariableType.String,\n    required: false,\n  },\n  {\n    key: nanoid(),\n    name: DEFAULT_OPTION_CONTENT_NAME,\n    type: ViewVariableType.String,\n    required: false,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { SliderWithInput as SliderWithInputLegacy } from '@/form-extensions/components/slider-with-input';\nimport { useField, withField } from '@/form';\n\nconst SliderWithInput = props => {\n  const { value, onChange, readonly } = useField<string | number>();\n\n  return (\n    <SliderWithInputLegacy\n      value={value}\n      onChange={onChange}\n      readonly={!!readonly}\n      {...props}\n    />\n  );\n};\n\nexport const SliderWithInputField = withField(SliderWithInput);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozSetting,\n  IconCozInfoCircle,\n} from '@coze-arch/coze-design/icons';\nimport {\n  IconButton,\n  Tooltip,\n  Typography,\n  Popover,\n  Divider,\n} from '@coze-arch/coze-design';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { ExpressionEditorField } from '@/node-registries/common/fields';\nimport { useWatch } from '@/form';\nimport { CopyButton } from '@/components/copy-button';\n\nimport { SliderWithInputField } from './slider-with-input-field';\n\nimport styles from './question-limit.module.less';\n\nconst MAX_ROUND = 5;\nconst MIN_ROUND = 1;\n\nexport const QuestionLimit = () => {\n  const { getNodeSetterId } = useNodeTestId();\n  const readonly = useReadonly();\n  const systemPrompt = useWatch<string>({ name: 'llmParam.systemPrompt' });\n\n  const label = I18n.t(\n    'workflow_ques_ans_type_direct_exrtact_title',\n    {},\n    \"Extract variables from user's response.\",\n  );\n\n  return (\n    <div className=\"flex flex-col w-full mb-2\">\n      <Divider margin=\"12px\" />\n      <div className=\"flex w-full justify-between items-center\">\n        <Typography.Text\n          className=\"mr-[6px] text-xs\"\n          ellipsis={{\n            showTooltip: {\n              opts: {\n                content: label,\n              },\n            },\n          }}\n          style={{\n            maxWidth: 'calc(100% - 24px)',\n            color: '#1C1F23',\n          }}\n        >\n          {label}\n        </Typography.Text>\n        <Popover\n          autoAdjustOverflow={false}\n          className={styles['limit-wrapper']}\n          trigger=\"click\"\n          position=\"topRight\"\n          content={\n            <div className={styles['sys-popover-content']}>\n              <div className=\"flex items-center mb-[4px]\">\n                <span className={styles['content-title']}>\n                  {I18n.t(\n                    'workflow_ques_ans_type_direct_exrtact_context_setting',\n                    {},\n                    'Maximum dialogue rounds',\n                  )}\n                </span>\n                <Tooltip\n                  content={I18n.t(\n                    'workflow_ques_ans_type_direct_context_setting_tooltips',\n                    {},\n                    '',\n                  )}\n                >\n                  <IconCozInfoCircle className=\"text-[#A7A9B0] text-[16px] ml-1\" />\n                </Tooltip>\n              </div>\n              <div className=\"w-full relative  mb-[16px]\">\n                <SliderWithInputField\n                  name=\"questionOutputs.limit\"\n                  defaultValue={3}\n                  max={MAX_ROUND}\n                  min={MIN_ROUND}\n                  sliderStyle={{\n                    width: '100%',\n                  }}\n                />\n                <div\n                  className={`w-full flex justify-between absolute ${styles['slider-marks']}`}\n                >\n                  <div>{MIN_ROUND}</div>\n                  <div>{MAX_ROUND}</div>\n                </div>\n              </div>\n              <div className=\"flex items-center justify-between mb-[4px]\">\n                <div className=\"flex items-center\">\n                  <span className={styles['content-title']}>\n                    {I18n.t('workflow_question_sp', {}, '')}\n                  </span>\n                  <Tooltip\n                    content={I18n.t(\n                      'workflow_question_sp_setting',\n                      {},\n                      '',\n                    )}\n                  >\n                    <IconCozInfoCircle className=\"text-[#A7A9B0] text-[16px] ml-1\" />\n                  </Tooltip>\n                </div>\n                {readonly ? <CopyButton value={systemPrompt ?? ''} /> : null}\n              </div>\n              <ExpressionEditorField\n                name=\"llmParam.systemPrompt\"\n                defaultValue=\"\"\n                placeholder={I18n.t(\n                  'workflow_question_sp_placeholder',\n                  {},\n                  ',,',\n                )}\n                className=\"!p-[4px]\"\n                containerClassName=\"!bg-transparent\"\n                shouldUseContainerRef\n              />\n            </div>\n          }\n        >\n          <IconButton\n            size=\"default\"\n            color=\"secondary\"\n            data-testid={getNodeSetterId('question-limit-setting')}\n            wrapperClass=\"flex justify-end\"\n            className=\"!p-[4px] !max-w-[24px] !min-w-[24px] !h-[24px]\"\n            icon={<IconCozSetting />}\n          />\n        </Popover>\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { FILE_TYPES, ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Section, useWatch } from '@/form';\n\nimport {\n  DEFAULT_EXTRACT_OUTPUT,\n  DEFAULT_ANSWER_OPTION_OUTPUT,\n} from '../constants';\nimport {\n  CheckboxWithTipsField,\n  OutputsDisplayField,\n  OutputsField,\n} from '../../common/fields';\nimport { QuestionLimit } from './question-limit';\n\nexport const QuestionOutputs = () => {\n  const answerType = useWatch({ name: 'questionParams.answer_type' });\n  const extraOutput = useWatch<Boolean>({\n    name: 'questionOutputs.extra_output',\n  });\n  const isOptionAnswer = answerType === 'option';\n\n  return (\n    <Section\n      title={I18n.t('workflow_detail_node_output')}\n      tooltip={I18n.t('workflow_ques_output_tooltips')}\n      actions={\n        isOptionAnswer\n          ? []\n          : [\n              <CheckboxWithTipsField\n                name=\"questionOutputs.extra_output\"\n                defaultValue={false}\n                text={I18n.t(\n                  'workflow_ques_ans_type_direct_checkbox',\n                  {},\n                  '',\n                )}\n                itemTooltip={I18n.t(\n                  'workflow_ques_ans_type_direct_checkbox_tooltips',\n                  {},\n                  '',\n                )}\n              />,\n            ]\n      }\n    >\n      {isOptionAnswer ? (\n        <OutputsDisplayField\n          id={'question-node-option-output'}\n          name={'questionOutputs.optionOutput'}\n          defaultValue={DEFAULT_ANSWER_OPTION_OUTPUT}\n        />\n      ) : (\n        <>\n          <OutputsField\n            title=\"\"\n            id={'question-node-user-output'}\n            name={'questionOutputs.userOutput'}\n            noCard\n            jsonImport={false}\n            disabled={true}\n            allowAppendRootData={false}\n            topLevelReadonly\n            withRequired\n            hasFeedback={false}\n          />\n          {extraOutput ? (\n            <>\n              <QuestionLimit />\n              <OutputsField\n                title=\"\"\n                id={'question-node-extract-output'}\n                name={'questionOutputs.extractOutput'}\n                defaultValue={DEFAULT_EXTRACT_OUTPUT}\n                hiddenTypes={[\n                  ...FILE_TYPES,\n                  ViewVariableType.ArrayBoolean,\n                  ViewVariableType.ArrayInteger,\n                  ViewVariableType.ArrayNumber,\n                  ViewVariableType.ArrayObject,\n                  ViewVariableType.ArrayString,\n                  ViewVariableType.Object,\n                ]}\n                noCard\n                withRequired\n                jsonImport={false}\n                hasFeedback={false}\n              />\n            </>\n          ) : null}\n        </>\n      )}\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst ASCII_TO_A_INDEX = 65; // The ASCII serial number corresponding to the letter A\n\nexport function convertNumberToLetters(n) {\n  let result = '';\n  while (n >= 0) {\n    result = String.fromCharCode((n % 26) + ASCII_TO_A_INDEX) + result;\n    n = Math.floor(n / 26) - 1;\n  }\n  return result;\n}\n\nexport const generatePortId = (index: number) => `branch_${index}`;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect } from 'react';\n\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { ExpressionEditor } from '@/nodes-v2/components/expression-editor';\nimport {\n  calcPortId,\n  convertNumberToLetters,\n} from '@/form-extensions/setters/answer-option/utils';\nimport { withField, useField, SortableItem, FieldArrayItem } from '@/form';\n\nimport styles from './index.module.less';\n\nexport const AnswerItemField = withField(\n  ({\n    showOptionName,\n    optionPlaceholder,\n    optionIndex,\n    movePostion,\n    onItemDelete,\n    answerOptions,\n  }: {\n    showOptionName?: boolean;\n    optionPlaceholder?: string;\n    optionIndex: number;\n    movePostion: {\n      start?: number;\n      end?: number;\n    };\n    onItemDelete: (index: number) => void;\n    answerOptions: { name: string }[];\n  }) => {\n    const { value, onChange, onBlur, readonly, errors } = useField<string>();\n\n    useEffect(() => {\n      if (\n        movePostion?.start === optionIndex ||\n        movePostion?.end === optionIndex\n      ) {\n        onBlur?.();\n      }\n    }, [movePostion]);\n\n    return (\n      <div className=\"w-full\">\n        <SortableItem\n          key={optionIndex}\n          sortableID={calcPortId(optionIndex)}\n          index={optionIndex}\n          containerClassName=\"items-center\"\n          hanlderClassName=\"!p-0\"\n        >\n          <FieldArrayItem\n            className=\"!pt-[0px] items-center\"\n            containerClassName=\"items-center\"\n            removeIconClassName=\"!h-[24px] !min-w-[24px] !max-w-[24px] !p-[4px]\"\n            disableRemove={answerOptions?.length <= 1 || readonly}\n            onRemove={() => {\n              if (answerOptions?.length <= 1 || readonly) {\n                return;\n              }\n              onItemDelete(optionIndex);\n            }}\n          >\n            {showOptionName ? (\n              <div className=\"break-keep w-[48px]\">\n                {convertNumberToLetters(optionIndex)}\n              </div>\n            ) : null}\n            <div className=\"items-center space-x-1 w-full min-h-[24px] leading-[24px]\">\n              {!readonly ? (\n                <ExpressionEditor\n                  name={'/questionParams/options'}\n                  value={value as string}\n                  onChangeTrigger=\"onChange\"\n                  onChange={val => onChange?.(val as string)}\n                  onBlur={() => {\n                    onBlur?.();\n                  }}\n                  isError={errors && errors?.length > 0}\n                  minRows={1}\n                  placeholder={optionPlaceholder}\n                  disableSuggestion={false}\n                  className=\"!px-[4px] !py-[2px]\"\n                  containerClassName={styles['answer-editor']}\n                />\n              ) : (\n                <div className=\"w-full\">{value ?? ''}</div>\n              )}\n            </div>\n          </FieldArrayItem>\n        </SortableItem>\n        <FormItemFeedback className=\"pl-[68px]\" errors={errors} />\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { AddButton } from '@/form';\n\nexport interface AddOptionButtonProps {\n  /** Whether to display the title line */\n  showTitleRow?: boolean;\n\n  /** Whether to display option labels */\n  showOptionName?: boolean;\n\n  /** Option placeholder */\n  optionPlaceholder?: string;\n\n  /** Default branch name */\n  defaultOptionText?: string;\n\n  /** Option maximum quantity limit, default value is integer maximum */\n  maxItems?: number;\n\n  /** Display Forbid Add Tooltip */\n  showDisableAddTooltip?: boolean;\n  customDisabledAddTooltip?: string;\n  className?: string;\n  dataTestId?: string;\n  value;\n  onClick;\n  readonly;\n  children;\n}\n\nexport const AddOptionButton = ({\n  className,\n  showDisableAddTooltip = true,\n  maxItems = Number.MAX_SAFE_INTEGER,\n  customDisabledAddTooltip,\n  value,\n  onClick,\n  readonly,\n  children,\n  dataTestId,\n}: AddOptionButtonProps) =>\n  showDisableAddTooltip && (value?.length as number) >= maxItems ? (\n    <Tooltip\n      content={\n        customDisabledAddTooltip ||\n        I18n.t('workflow_250117_05', { maxCount: maxItems })\n      }\n    >\n      <AddButton\n        className={className}\n        children={children}\n        dataTestId={dataTestId}\n      />\n    </Tooltip>\n  ) : (\n    <AddButton\n      className={className}\n      disabled={readonly}\n      children={children}\n      onClick={onClick}\n      dataTestId={dataTestId}\n    />\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo, useState } from 'react';\n\nimport update from 'immutability-helper';\nimport classNames from 'classnames';\nimport { ViewVariableType } from '@coze-workflow/variable';\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport { useUpdateSortedPortLines } from '@/hooks';\nimport { ColumnsTitleWithAction } from '@/form-extensions/components/columns-title-with-action';\nimport { RadioGroupField } from '@/form/fields';\nimport {\n  Section,\n  useFieldArray,\n  SortableList,\n  FieldArray,\n  useWatch,\n} from '@/form';\nimport { OptionType } from '@/constants/question-settings';\n\nimport { generatePortId } from './utils';\nimport { AnswerItemField } from './answer-item';\nimport { AddOptionButton } from './add-option-button';\n\nimport styles from './index.module.less';\n\nexport interface AnswerOptionProps {\n  /** Whether to display the title line */\n  showTitleRow?: boolean;\n\n  /** Whether to display option labels */\n  showOptionName?: boolean;\n\n  /** Option placeholder */\n  optionPlaceholder?: string;\n\n  /** Default branch name */\n  defaultOptionText?: string;\n}\n\nconst AnswerOption = ({\n  optionPlaceholder,\n  defaultOptionText,\n  showTitleRow = true,\n  showOptionName = true,\n}: AnswerOptionProps) => {\n  const { value, move, name, readonly, onChange, append } = useFieldArray<{\n    name: string;\n  }>();\n  const answerType = useWatch({ name: 'questionParams.answer_type' });\n  const optionType = useWatch({ name: 'questionParams.option_type' });\n\n  const { getNodeSetterId } = useNodeTestId();\n  const updateSortedPortLines = useUpdateSortedPortLines(generatePortId);\n  const [movePostion, setMovePostion] = useState<{\n    start?: number;\n    end?: number;\n  }>({});\n\n  const isStaticOption = useMemo(\n    () => optionType === OptionType.Static,\n    [optionType],\n  );\n\n  if (answerType !== 'option') {\n    return;\n  }\n\n  const onItemDelete = (index: number) => {\n    // Move the port to be deleted to the end so that the deletion does not affect other connection sequences\n    updateSortedPortLines(index, value?.length as number);\n\n    const newVal = update(value, { $splice: [[index, 1]] });\n    onChange(newVal);\n  };\n\n  return (\n    <Section\n      title={\n        <div className=\"text-xs font-normal\">\n          {I18n.t('workflow_ques_ans_type_option_label', {}, '')}\n        </div>\n      }\n      headerClassName=\"pt-[12px] !mb-[4px]\"\n      noPadding\n      collapsible={false}\n    >\n      <div className={`w-full p-[8px] ${styles['parameters-wrapper']}`}>\n        <div className=\"w-full mb-[8px]\">\n          <RadioGroupField\n            name=\"questionParams.option_type\"\n            data-testid={getNodeSetterId('questionParams.option_type')}\n            type=\"button\"\n            className=\"w-full\"\n            buttonSize=\"middle\"\n            defaultValue={OptionType.Static}\n            options={[\n              {\n                label: I18n.t(\n                  'workflow_question_fixed_content',\n                  {},\n                  '',\n                ),\n                value: OptionType.Static,\n                className: styles['option-radio-group'],\n              },\n              {\n                label: I18n.t(\n                  'workflow_question_ dynamic_content',\n                  {},\n                  '',\n                ),\n                value: OptionType.Dynamic,\n                className: styles['option-radio-group'],\n              },\n            ]}\n          />\n        </div>\n        {showTitleRow ? (\n          <ColumnsTitleWithAction\n            columns={[\n              {\n                title: I18n.t('workflow_ques_ans_type_option_title'),\n                style: {\n                  width: isStaticOption ? '67px' : '56px',\n                },\n              },\n              {\n                title: I18n.t('workflow_ques_ans_type_option_content'),\n                style: {\n                  flex: 1,\n                },\n              },\n            ]}\n            readonly={readonly}\n            className={classNames(\n              'mb-[8px]',\n              readonly\n                ? styles.parametersTitleReadonly\n                : styles.parametersTitle,\n            )}\n          />\n        ) : null}\n        {!isStaticOption ? (\n          <div className=\"flex items-center w-full text-xs mt-2\">\n            <div\n              className=\"break-keep mr-[4px]\"\n              style={{\n                minWidth: isStaticOption ? '48px' : '56px',\n              }}\n            >\n              <Tooltip\n                trigger=\"hover\"\n                content={I18n.t(\n                  'workflow_question_dynamic',\n                  {},\n                  'dynamicOption',\n                )}\n              >\n                <span>{I18n.t('workflow_question_az', {}, 'A~Z')}</span>\n              </Tooltip>\n            </div>\n            <div className=\"w-full items-center\">\n              <ValueExpressionInputField\n                name={'questionParams.dynamic_option'}\n                availableFileTypes={[ViewVariableType.ArrayString]}\n                disabledTypes={ViewVariableType.getComplement([\n                  ViewVariableType.ArrayString,\n                ])}\n              />\n            </div>\n          </div>\n        ) : (\n          <>\n            <SortableList\n              onSortEnd={({ from, to }) => {\n                if (readonly) {\n                  return;\n                }\n                updateSortedPortLines(from, to);\n                move(from, to);\n                setMovePostion({\n                  start: from,\n                  end: to,\n                });\n              }}\n            >\n              <div className=\"w-full flex flex-col gap-[8px] text-xs leading-[24px]\">\n                {value?.map((_item, index) => (\n                  <AnswerItemField\n                    name={`${name}.${index}.name`}\n                    answerOptions={value}\n                    optionPlaceholder={optionPlaceholder}\n                    optionIndex={index}\n                    movePostion={movePostion}\n                    showOptionName={showOptionName}\n                    hasFeedback={false}\n                    onItemDelete={onItemDelete}\n                  />\n                ))}\n              </div>\n            </SortableList>\n            <AddOptionButton\n              className=\"w-full mt-[8px]\"\n              dataTestId={getNodeSetterId('answer-option-add-btn')}\n              readonly={readonly}\n              onClick={() => {\n                append({\n                  name: '',\n                });\n              }}\n              children={\n                <span className=\"text-[12px] font-medium\">\n                  {I18n.t('workflow_question_add_option', {}, '')}\n                </span>\n              }\n              value={value}\n            />\n          </>\n        )}\n\n        <div className=\"flex items-center w-full text-xs mt-2\">\n          <div\n            className=\"break-keep mr-[4px]\"\n            style={{\n              minWidth: isStaticOption ? '48px' : '56px',\n              marginLeft: isStaticOption ? '16px' : '0px',\n            }}\n          >\n            {I18n.t('workflow_ques_ans_type_option_other', {}, 'other')}\n          </div>\n          <div className=\"space-x-1 w-full leading-[16px]\">\n            {defaultOptionText}\n          </div>\n        </div>\n      </div>\n    </Section>\n  );\n};\n\nexport const AnswerOptionField = ({\n  name,\n  optionPlaceholder,\n  defaultOptionText,\n}) => (\n  <FieldArray name={name} defaultValue={[{ name: '' }, { name: '' }]}>\n    <AnswerOption\n      optionPlaceholder={optionPlaceholder}\n      defaultOptionText={defaultOptionText}\n    />\n  </FieldArray>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { Section } from '@/form';\nimport { AnswerType } from '@/constants/question-settings';\n\nimport {\n  ModelSelectField,\n  InputsParametersField,\n  ExpressionEditorField,\n  RadioSetterField,\n} from '../common/fields';\nimport { QuestionOutputs } from './components/question-outputs';\nimport { AnswerOptionField } from './components/answer-option-field';\n\nconst Render = () => (\n  <NodeConfigForm>\n    <ModelSelectField\n      name=\"llmParam\"\n      title={I18n.t('workflow_detail_llm_model')}\n    />\n    <InputsParametersField\n      name=\"inputParameters\"\n      tooltip={I18n.t(\n        'workflow_ques_input_tooltips',\n        {},\n        ',',\n      )}\n    />\n    <Section\n      title={I18n.t('workflow_ques_content', {}, '')}\n      tooltip={I18n.t(\n        'workflow_ques_content_tooltips',\n        {},\n        '',\n      )}\n    >\n      <div className=\"w-full mb-[12px]\">\n        <ExpressionEditorField\n          name=\"questionParams.question\"\n          dataTestName=\"/questionParams/question\"\n          placeholder={I18n.t('workflow_ques_content_placeholder')}\n          className=\"!p-[4px]\"\n          containerClassName=\"!bg-transparent\"\n        />\n      </div>\n      <Section\n        headerClassName=\"!mb-0\"\n        title={\n          <div className=\"text-xs font-normal\">\n            {I18n.t('workflow_ques_ans_type', {}, '')}\n          </div>\n        }\n        noPadding\n        collapsible={false}\n      >\n        <RadioSetterField\n          name=\"questionParams.answer_type\"\n          defaultValue={AnswerType.Text}\n          options={{\n            key: 'questionParams.answer_type',\n            mode: 'card',\n            direction: 'vertical',\n            customClassName: 'pt-[4px] gap-y-[4px]',\n            options: [\n              {\n                value: AnswerType.Text,\n                label: I18n.t('workflow_ques_ans_type_direct', {}, ''),\n              },\n              {\n                value: AnswerType.Option,\n                label: I18n.t('workflow_ques_ans_type_option', {}, ''),\n              },\n            ],\n          }}\n        />\n      </Section>\n      <AnswerOptionField\n        name=\"questionParams.options\"\n        optionPlaceholder={I18n.t(\n          'workflow_ans_content_placeholder',\n          {},\n          '{{}}',\n        )}\n        defaultOptionText={I18n.t(\n          'workflow_ques_ans_type_option_other_placeholder',\n          {},\n          '',\n        )}\n      />\n    </Section>\n    <QuestionOutputs />\n  </NodeConfigForm>\n);\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport interface QuestionOutputsValue {\n  userOutput: Array<any>;\n  extractOutput: Array<any>;\n  extra_output: boolean;\n}\n\nexport const formatOutput = (value: QuestionOutputsValue) => {\n  const { userOutput, extractOutput, extra_output } = value;\n\n  if (extra_output) {\n    return [...userOutput, ...extractOutput];\n  }\n  return userOutput;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isEqual, get } from 'lodash-es';\nimport {\n  type Effect,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodePortsData } from '@flowgram-adapter/free-layout-editor';\n\nimport { formatOutput } from '../utils';\n\nexport const syncQuestionAnswerTypeEffect: Effect = props => {\n  const { value, formValues, context } = props;\n  const { node } = context;\n\n  const formModel = node.getData(FlowNodeFormData).getFormModel<FormModelV2>();\n  const portsData = node.getData<WorkflowNodePortsData>(WorkflowNodePortsData);\n  const outputs = get(formValues, 'outputs');\n\n  if (value === 'text') {\n    portsData.updateStaticPorts([\n      {\n        type: 'input',\n      },\n      {\n        type: 'output',\n      },\n    ]);\n  } else {\n    portsData.updateStaticPorts([\n      {\n        type: 'input',\n      },\n    ]);\n  }\n\n  // The value cannot be obtained when the form is initialized, so it needs to be delayed for a while.\n  setTimeout(() => {\n    let syncOutputValue: unknown = [];\n    if (value === 'text') {\n      if (outputs) {\n        const questionOutputs = get(formValues, 'questionOutputs');\n        syncOutputValue = formatOutput(questionOutputs);\n      }\n    } else {\n      const optionOutput = get(formValues, 'questionOutputs.optionOutput');\n      syncOutputValue = optionOutput;\n    }\n\n    // Synchronize the value of questionOutput to the output\n    if (outputs && !isEqual(outputs, syncOutputValue)) {\n      formModel.setValueIn('outputs', syncOutputValue);\n    }\n  }, 200);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n  DataEvent,\n  type EffectOptions,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\nimport { createNodeInputNameValidate } from '@/nodes-v2/components/node-input-name/validate';\nimport { valueExpressionValidator } from '@/form-extensions/validators';\nimport { OptionType } from '@/constants/question-settings';\n\nimport { outputTreeMetaValidator } from '../common/fields/outputs';\nimport FormRender from './form';\nimport {\n  syncQuestionAnswerTypeEffect,\n  syncQuestionOptionTypeEffect,\n  syncQuestionOutputsEffect,\n} from './effects';\nimport { transformOnInit, transformOnSubmit } from './data-transformer';\n\nconst questionFieldName = 'questionParams.question';\nconst questionOptionsFieldName = 'questionParams.options.*.name';\nconst questionDynamicFieldName = 'questionParams.dynamic_option';\n\nexport const QUESTION_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onBlur,\n\n  // validation rules\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    'inputParameters.*.name': createNodeInputNameValidate({\n      getNames: ({ formValues }) =>\n        (get(formValues, 'inputParameters') || []).map(item => item.name),\n    }),\n    'inputParameters.*.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n    [questionFieldName]: ({ value }) =>\n      value\n        ? undefined\n        : I18n.t('workflow_detail_node_error_empty', {}, ''),\n    [questionOptionsFieldName]: ({ value, formValues }) => {\n      const anwserType = get(formValues, 'questionParams.answer_type');\n      const optionType = get(formValues, 'questionParams.option_type');\n      if (anwserType !== 'option' || optionType !== OptionType.Static) {\n        return undefined;\n      }\n      if (!value) {\n        return I18n.t('workflow_ques_option_notempty', {}, '');\n      }\n      const options = get(formValues, 'questionParams.options');\n\n      return options.filter(option => option?.name === value)?.length > 1\n        ? I18n.t('workflow_ques_ans_testrun_dulpicate', {}, '')\n        : undefined;\n    },\n    [questionDynamicFieldName]: ({ value, formValues, context }) => {\n      const { node, playgroundContext } = context;\n      const anwserType = get(formValues, 'questionParams.answer_type');\n      const optionType = get(formValues, 'questionParams.option_type');\n\n      if (anwserType !== 'option' || optionType !== OptionType.Dynamic) {\n        return undefined;\n      }\n      return valueExpressionValidator({\n        value,\n        playgroundContext,\n        node,\n        required: true,\n      });\n    },\n    'questionOutputs.extractOutput': outputTreeMetaValidator,\n  },\n\n  // Side effect management\n  effect: {\n    'questionParams.answer_type': [\n      {\n        effect: syncQuestionAnswerTypeEffect,\n        event: DataEvent.onValueChange,\n      },\n      {\n        effect: syncQuestionAnswerTypeEffect,\n        event: DataEvent.onValueInit,\n      },\n    ] as unknown as EffectOptions[],\n    'questionParams.option_type': [\n      {\n        effect: syncQuestionOptionTypeEffect,\n        event: DataEvent.onValueChange,\n      },\n    ],\n    questionOutputs: [\n      {\n        effect: syncQuestionOutputsEffect,\n        event: DataEvent.onValueChange,\n      },\n    ] as unknown as EffectOptions[],\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: transformOnInit,\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type Effect,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { OptionType } from '@/constants/question-settings';\n\nexport const syncQuestionOptionTypeEffect: Effect = props => {\n  const { value, context } = props;\n  const { node } = context;\n  const formModel = node.getData(FlowNodeFormData).getFormModel<FormModelV2>();\n  if (value === OptionType.Dynamic) {\n    return;\n  }\n  formModel.setValueIn('questionParams.dynamic_option', null);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport {\n  type Effect,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { formatOutput } from '../utils';\n\nexport const syncQuestionOutputsEffect: Effect = props => {\n  const { value, formValues, context } = props;\n  const { node } = context;\n\n  const formModel = node.getData(FlowNodeFormData).getFormModel<FormModelV2>();\n  const outputs = get(formValues, 'outputs');\n\n  // Synchronize the value of questionOutputs to outputs\n  if (outputs) {\n    formModel.setValueIn('outputs', formatOutput(value));\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { variableUtils } from '@coze-workflow/variable';\nimport { getDefaultLLMParams, formatModelData } from '@coze-workflow/nodes';\n\nimport { OptionType } from '@/constants/question-settings';\n\nimport {\n  DEFAULT_USE_RESPONSE,\n  DEFAULT_USER_RESPONSE_PARAM_NAME,\n  DEFAULT_EXTRACT_OUTPUT,\n  DEFAULT_ANSWER_OPTION_OUTPUT,\n  DEFAULT_OUTPUT_NAMES,\n} from './constants';\n\nexport function transformOnInit(value, context) {\n  const { playgroundContext } = context;\n  const { variableService } = playgroundContext;\n  const { models } = playgroundContext;\n  const { inputs = {}, outputs = DEFAULT_USE_RESPONSE, nodeMeta } = value || {};\n\n  const {\n    inputParameters = [],\n    answer_type = 'text',\n    dynamic_option,\n    option_type = OptionType.Static,\n    extra_output,\n    question,\n    options,\n    limit = 3,\n  } = inputs;\n\n  const isAnswerTypeOption = answer_type === 'option';\n\n  const userOutput = (outputs || []).filter(\n    item => item.name === DEFAULT_USER_RESPONSE_PARAM_NAME,\n  );\n\n  const extractOutput = (outputs || []).filter(item =>\n    isAnswerTypeOption\n      ? !DEFAULT_OUTPUT_NAMES.includes(item.name)\n      : item.name !== DEFAULT_USER_RESPONSE_PARAM_NAME,\n  );\n\n  let llmParam = get(value, 'inputs.llmParam');\n  // When first dragged into the canvas: Parse out the default value from the backend return value.\n  if (!llmParam) {\n    llmParam = getDefaultLLMParams(models);\n  }\n\n  return {\n    llmParam,\n    nodeMeta,\n    questionOutputs: {\n      limit,\n      extra_output: isAnswerTypeOption ? false : extra_output,\n      userOutput: userOutput.length > 0 ? userOutput : DEFAULT_USE_RESPONSE,\n      extractOutput:\n        extractOutput.length > 0 ? extractOutput : DEFAULT_EXTRACT_OUTPUT,\n      optionOutput: DEFAULT_ANSWER_OPTION_OUTPUT,\n    },\n    outputs,\n    inputParameters: inputParameters ?? [],\n    questionParams: {\n      answer_type,\n      question,\n      options,\n      option_type,\n      dynamic_option: variableUtils.valueExpressionToVO(\n        dynamic_option,\n        variableService,\n      ),\n    },\n  };\n}\n\nexport function transformOnSubmit(value, context) {\n  const { playgroundContext, node } = context;\n  const { variableService } = playgroundContext;\n\n  const { models } = playgroundContext;\n\n  const {\n    llmParam,\n    nodeMeta,\n    inputParameters,\n    questionOutputs,\n    outputs,\n    questionParams,\n  } = value;\n\n  const { limit, extra_output } = questionOutputs;\n\n  const { question, answer_type, options, dynamic_option, option_type } =\n    questionParams;\n\n  const modelMeta = models.find(m => m.model_type === llmParam?.modelType);\n\n  return {\n    inputs: {\n      llmParam: {\n        ...formatModelData(llmParam, modelMeta),\n        systemPrompt: llmParam?.systemPrompt ?? '',\n      },\n      inputParameters: inputParameters ?? [],\n      extra_output,\n      answer_type,\n      option_type,\n      dynamic_option: !dynamic_option\n        ? null\n        : variableUtils.valueExpressionToDTO(dynamic_option, variableService, {\n            node,\n          }),\n      question,\n      options,\n      limit,\n    },\n    nodeMeta,\n    outputs,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  DEFAULT_OUTPUTS_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { QUESTION_FORM_META } from './form-meta';\n\nexport const QUESTION_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Question,\n  meta: {\n    nodeDTOType: StandardNodeType.Question,\n    size: { width: DEFAULT_NODE_SIZE.width, height: 156.7 },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    useDynamicPort: true,\n    inputParametersPath: '/inputParameters',\n    getLLMModelIdsByNodeJSON: nodeJSON =>\n      nodeJSON?.data?.inputs?.llmParam?.modelType,\n    test,\n    helpLink: '/open/docs/guides/question_node',\n  },\n  formMeta: QUESTION_FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { type IFormSchema } from '@coze-workflow/test-run-next';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\nimport { AnswerType, OptionType } from '@/constants/question-settings';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const inputParameters = formData?.inputParameters;\n\n    const inputProperties = generateParametersToProperties(inputParameters, {\n      node,\n    });\n    const answerType = formData?.questionParams?.answer_type;\n    const optionType = formData?.questionParams?.option_type;\n    let dynamicProperties: IFormSchema['properties'] = {};\n    if (answerType === AnswerType.Option && optionType === OptionType.Dynamic) {\n      const dynamicOption = formData?.questionParams?.dynamic_option;\n      dynamicProperties = generateParametersToProperties(\n        [\n          {\n            name: 'dynamic_option',\n            input: dynamicOption,\n          },\n        ],\n        { node },\n      );\n    }\n\n    return {\n      ...inputProperties,\n      ...dynamicProperties,\n    };\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/base';\n\nimport { StringMethod } from './constants';\n\n/**\n * Checks if the provided string method is a split method.\n *\n * @param {StringMethod} method - The string method to be checked.\n * @returns {boolean} Returns true if the method is a split method, false otherwise.\n */\nexport const isSplitMethod = (method: StringMethod) =>\n  method === StringMethod.Split;\n\n/**\n * Generates the default output configuration based on the provided string method.\n *\n * @param {StringMethod} method - The string method used to determine the output type.\n * @returns {Array<Object>} An array containing the default output configuration.\n */\nexport const getDefaultOutput = (method: StringMethod) => {\n  const isSplit = isSplitMethod(method);\n  return [\n    {\n      key: nanoid(),\n      name: 'output',\n      type: isSplit ? ViewVariableType.ArrayString : ViewVariableType.String,\n      required: true,\n    },\n  ];\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useNodeTestId } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\nimport { SelectField } from '@/form';\n\nimport { STRING_METHOD_OPTIONS, StringMethod } from '../../constants';\n\nexport const MethodSelectorSetter = ({ name }: { name: string }) => {\n  const readonly = useReadonly();\n  const { getNodeSetterId } = useNodeTestId();\n\n  return (\n    <div className=\"flex justify-between align-items\">\n      <div className=\"font-semibold text-[12px] leading-[24px]\">\n        {I18n.t('workflow_stringprocess_node_method')}\n      </div>\n\n      <div>\n        <SelectField\n          name={name}\n          readonly={readonly}\n          defaultValue={StringMethod.Concat}\n          optionList={STRING_METHOD_OPTIONS}\n          data-testid={getNodeSetterId('text-method-select')}\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const getMaxIndex = (values: string[], prefixStr: string): number => {\n  if (!Array.isArray(values)) {\n    return 1;\n  }\n\n  const maxIndex =\n    values.length === 0\n      ? 0\n      : Math.max(\n          ...values\n            .map(item => Number(item?.split(prefixStr)[1] ?? 0))\n            .filter(v => !isNaN(v)),\n        );\n\n  return maxIndex + 1;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type PropsWithChildren } from 'react';\n\nimport {\n  type InputValueVO,\n  ValueExpressionType,\n  type ViewVariableType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ValueExpressionInputField } from '@/node-registries/common/fields';\nimport {\n  Section,\n  useFieldArray,\n  useSectionRef,\n  AddButton,\n  ColumnTitles,\n  FieldArrayList,\n  FieldArrayItem,\n  withFieldArray,\n} from '@/form';\n\nimport { PREFIX_STR } from '../../constants';\nimport { getMaxIndex } from './utils';\n\ninterface InputsProps {\n  minItems: number;\n  maxItems: number;\n  inputType?: ViewVariableType;\n  disabledTypes?: ViewVariableType[];\n}\n\nexport const Inputs = withFieldArray(\n  ({\n    children,\n    minItems = 0,\n    inputType,\n    disabledTypes,\n    maxItems = Number.MAX_SAFE_INTEGER,\n  }: InputsProps & PropsWithChildren) => {\n    const sectionRef = useSectionRef();\n    const { value, append, remove, readonly } = useFieldArray<InputValueVO>();\n    const safeValue = value || [];\n\n    return (\n      <Section\n        ref={sectionRef}\n        title={I18n.t('workflow_detail_node_parameter_input')}\n        tooltip={I18n.t('workflow_stringprocess_input_tooltips')}\n        isEmpty={!value || value?.length === 0}\n        emptyText={I18n.t('workflow_inputs_empty')}\n        actions={[\n          safeValue.length >= maxItems ? null : (\n            <AddButton\n              disabled={readonly}\n              onClick={() => {\n                const names = safeValue.map(item => item?.name ?? '');\n                const index = getMaxIndex(names, PREFIX_STR);\n                append({\n                  name: `${PREFIX_STR}${index}`,\n                  input: { type: ValueExpressionType.REF },\n                });\n                sectionRef.current?.open();\n              }}\n            />\n          ),\n        ]}\n      >\n        <ColumnTitles\n          columns={[\n            {\n              label: I18n.t('workflow_detail_node_parameter_name'),\n              style: { width: 148 },\n            },\n            { label: I18n.t('workflow_detail_end_output_value') },\n          ]}\n        />\n\n        <FieldArrayList>\n          {value?.map(({ name }, index) => (\n            <FieldArrayItem\n              onRemove={() => remove(index)}\n              disableRemove={readonly || safeValue.length <= minItems}\n            >\n              <ValueExpressionInputField\n                key={index}\n                label={name}\n                required={false}\n                inputType={inputType}\n                disabledTypes={disabledTypes}\n                name={`inputParameters.${index}.input`}\n              />\n            </FieldArrayItem>\n          ))}\n        </FieldArrayList>\n\n        {children}\n      </Section>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { debounce } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/coze-design';\n\nimport {\n  BaseDelimiterSelector,\n  type DelimiterSelectorValue,\n} from '@/form-extensions/setters/delimiter-selector';\nimport { LabelWithTooltip } from '@/form-extensions/components/label-with-tooltip';\n\nimport { CONCAT_CHAR_SETTINGS } from '../../constants';\nimport { type SettingInfo } from './types';\n\nimport s from './index.module.less';\n\nconst DELAY_TIME = 500;\n\ninterface Props {\n  readonly?: boolean;\n  settingInfo?: SettingInfo;\n  value: DelimiterSelectorValue;\n  onChange: (value: DelimiterSelectorValue) => void;\n}\n\nexport const SettingForm = ({\n  settingInfo,\n  value,\n  readonly,\n  onChange,\n}: Props) => {\n  const debouncedChange = debounce(onChange, DELAY_TIME);\n\n  // Prevent trigger node selection\n  return (\n    <div className={s['setting-form']} onClick={e => e.stopPropagation()}>\n      {Boolean(settingInfo?.formTitle) && (\n        <Typography.Title className={s['setting-form-title']}>\n          {settingInfo?.formTitle}\n        </Typography.Title>\n      )}\n\n      {Boolean(settingInfo?.formDescription) && (\n        <Typography.Paragraph className={s['setting-form-desc']}>\n          {settingInfo?.formDescription}\n        </Typography.Paragraph>\n      )}\n\n      <LabelWithTooltip\n        label={I18n.t('workflow_stringprocess_concat_array_symbol_title')}\n        tooltip={I18n.t('workflow_textprocess_concat_symbol_tips')}\n      />\n\n      <BaseDelimiterSelector\n        readonly={!!readonly}\n        value={value}\n        onChange={debouncedChange}\n        options={CONCAT_CHAR_SETTINGS}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozSetting } from '@coze-arch/coze-design/icons';\nimport { Popover, IconButton } from '@coze-arch/coze-design';\n\nimport { type DelimiterSelectorValue } from '@/form-extensions/setters/delimiter-selector';\nimport { useField, withField } from '@/form';\n\nimport { SettingForm } from './setting-form';\n\nimport styles from './index.module.less';\n\nexport const SettingButtonField = withField(() => {\n  const { value, onChange, readonly } = useField<DelimiterSelectorValue>();\n\n  const formSetting = {\n    formTitle: I18n.t('workflow_stringprocess_concat_array_title'),\n    formDescription: I18n.t('workflow_stringprocess_concat_array_desc'),\n  };\n\n  return (\n    <Popover\n      keepDOM\n      stopPropagation\n      trigger=\"click\"\n      position=\"bottomRight\"\n      className={styles['setting-popover']}\n      content={\n        readonly ? null : (\n          <SettingForm\n            settingInfo={formSetting}\n            value={value as DelimiterSelectorValue}\n            onChange={v => {\n              onChange?.(v);\n            }}\n          />\n        )\n      }\n    >\n      <IconButton\n        size=\"small\"\n        disabled={readonly}\n        icon={<IconCozSetting className=\"text-sm\" />}\n        color=\"highlight\"\n      />\n    </Popover>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  DEFAULT_DELIMITER_OPTIONS,\n  SYSTEM_DELIMITER,\n} from '@coze-workflow/nodes';\nimport { type InputValueVO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { ExpressionEditor } from '@/nodes-v2/components/expression-editor';\nimport { Section, withField, useField, useForm, useWatch } from '@/form';\n\nimport tooltipImageUrlZh from '../../assets/concat_example_zh.png';\nimport tooltipImageUrlEn from '../../assets/concat_example_en.png';\nimport { SettingButtonField } from './setting-button';\n\nconst TOOLTIP_IMAGE_URL = IS_OVERSEA ? tooltipImageUrlEn : tooltipImageUrlZh;\nconst ExpressionEditorField = withField<\n  {\n    placeholder: string;\n    inputParameters: InputValueVO[];\n    onChange: (v: string) => void;\n  },\n  string\n>(props => {\n  const { name, value, onChange, errors } = useField<string>();\n\n  return (\n    <ExpressionEditor\n      {...props}\n      name={name}\n      value={value as string}\n      onChange={v => {\n        onChange(v as string);\n      }}\n      isError={errors && errors?.length > 0}\n    />\n  );\n});\n\ninterface Props {\n  /** String Splice symbol field name */\n  concatCharFieldName: string;\n\n  /** String Splicing result field name */\n  concatResultFieldName: string;\n}\n\nexport const ConcatSetting = ({\n  concatCharFieldName,\n  concatResultFieldName,\n}: Props) => {\n  const form = useForm();\n\n  const inputParameters = useWatch({\n    name: 'inputParameters',\n  });\n\n  return (\n    <Section\n      title={I18n.t('workflow_stringprocess_node_method_concat')}\n      tooltip={<img src={TOOLTIP_IMAGE_URL} alt=\"alt image\" width=\"740px\" />}\n      tooltipClassName=\"toolip-with-white-bg\"\n      actions={[\n        <SettingButtonField\n          name={concatCharFieldName}\n          defaultValue={{\n            value: SYSTEM_DELIMITER.comma,\n            options: DEFAULT_DELIMITER_OPTIONS,\n          }}\n        />,\n      ]}\n    >\n      <ExpressionEditorField\n        name={concatResultFieldName}\n        defaultValue=\"\"\n        placeholder={I18n.t('workflow_stringprocess_concat_tips')}\n        inputParameters={inputParameters as InputValueVO[]}\n        onChange={(value: string) => {\n          form.setFieldValue(concatResultFieldName, value);\n        }}\n      />\n    </Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport {\n  BaseDelimiterSelector,\n  type DelimiterSelectorValue,\n} from '@/form-extensions/setters/delimiter-selector';\nimport { withField, useField, Section } from '@/form';\n\nimport { SPLIT_CHAR_SETTING } from '../constants';\n\nexport const DelimiterSelectorField = withField(props => {\n  const { value, onChange, readonly, errors } =\n    useField<DelimiterSelectorValue>();\n\n  return (\n    <Section\n      title={I18n.t('workflow_stringprocess_delimiter_title')}\n      tooltip={I18n.t('workflow_stringprocess_delimiter_tooltips')}\n    >\n      <BaseDelimiterSelector\n        {...props}\n        value={value as DelimiterSelectorValue}\n        readonly={!!readonly}\n        onChange={onChange}\n        options={SPLIT_CHAR_SETTING}\n        hasError={errors && errors?.length > 0}\n      />\n      <FormItemFeedback errors={errors} />\n    </Section>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { NodeConfigForm } from '@/node-registries/common/components';\nimport { useWatch } from '@/form';\n\nimport { OutputsField } from '../common/fields';\nimport { isSplitMethod } from './utils';\nimport { CONCAT_DEFAULT_INPUTS, type StringMethod } from './constants';\nimport {\n  MethodSelectorSetter,\n  Inputs,\n  ConcatSetting,\n  DelimiterSelectorField,\n} from './components';\n\nconst Render = () => {\n  // Listen for character handling method changes\n  const method = useWatch<StringMethod>({ name: 'method' });\n\n  // Whether to split strings\n  const isSplit = isSplitMethod(method);\n\n  return (\n    <NodeConfigForm>\n      {/* Select string application */}\n      <MethodSelectorSetter name=\"method\" />\n\n      {/* input */}\n      <Inputs\n        name=\"inputParameters\"\n        defaultValue={CONCAT_DEFAULT_INPUTS}\n        // String delimited with only one input\n        minItems={isSplit ? 1 : 0}\n        maxItems={isSplit ? 1 : Number.MAX_SAFE_INTEGER}\n        // String splitting can only enter strings\n        inputType={isSplit ? ViewVariableType.String : undefined}\n        disabledTypes={\n          isSplit\n            ? ViewVariableType.getComplement([ViewVariableType.String])\n            : []\n        }\n      />\n\n      {/* String split/stitch settings */}\n      {isSplit ? (\n        <DelimiterSelectorField name=\"delimiter\" hasFeedback={false} />\n      ) : (\n        <ConcatSetting\n          concatCharFieldName=\"concatChar\"\n          concatResultFieldName=\"concatResult\"\n        />\n      )}\n\n      {/* output */}\n      <OutputsField\n        name=\"outputs\"\n        title={I18n.t('workflow_detail_node_output')}\n        tooltip={I18n.t('workflow_stringprocess_output_tooltips')}\n        id=\"text-process-node-output\"\n        topLevelReadonly={true}\n        customReadonly\n      />\n    </NodeConfigForm>\n  );\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { BlockInput, type InputValueDTO } from '@coze-workflow/base';\n\nimport { getDefaultOutput, isSplitMethod } from './utils';\nimport { type BackendData, type FormData } from './types';\nimport {\n  BACK_END_NAME_MAP,\n  CONCAT_DEFAULT_INPUTS,\n  FIELD_NAME_MAP,\n  OPTION_SCHEMA,\n  PREFIX_STR,\n  StringMethod,\n} from './constants';\n\n/**\n * Find a field in InputValueDTO\n * @param params\n * @param name\n * @returns\n */\nfunction getParam(params: InputValueDTO[], name: string) {\n  return params.find(item => item.name === name);\n}\n\n/**\n * Backend Data - > Frontend Form Data\n * @param value\n * @returns\n */\nexport const formatOnInit = (value: BackendData) => {\n  // When initialization has no value, return string concatenation default settings\n  if (!value) {\n    return {\n      method: StringMethod.Concat,\n      inputParameters: CONCAT_DEFAULT_INPUTS,\n      outputs: getDefaultOutput(StringMethod.Concat),\n    };\n  }\n\n  const { nodeMeta, inputs, outputs } = value;\n  const {\n    method = StringMethod.Concat,\n    inputParameters,\n    splitParams,\n    concatParams,\n  } = inputs || {};\n\n  const baseValue = {\n    method,\n    nodeMeta,\n    outputs,\n    inputParameters,\n  };\n\n  const isSplit = isSplitMethod(method);\n\n  // String concatenation parameter initialization\n  if (!isSplit && Array.isArray(concatParams)) {\n    // Splicing result\n    const resultItem = getParam(concatParams, FIELD_NAME_MAP.concatResult);\n\n    // concatenated characters\n    const charItem = getParam(\n      concatParams,\n      BACK_END_NAME_MAP.arrayItemConcatChar,\n    );\n\n    // All splicing characters\n    const charOptions = getParam(\n      concatParams,\n      BACK_END_NAME_MAP.allArrayItemConcatChars,\n    );\n\n    // If there are splicing characters\n    const hasChatOptions =\n      charOptions &&\n      (BlockInput.toLiteral(charOptions) as unknown[]).length > 0;\n\n    if (resultItem) {\n      baseValue[FIELD_NAME_MAP.concatResult] = BlockInput.toLiteral(resultItem);\n    }\n\n    if (hasChatOptions && charItem) {\n      baseValue[FIELD_NAME_MAP.concatChar] = {\n        value: BlockInput.toLiteral(charItem),\n        options: BlockInput.toLiteral(charOptions),\n      };\n    }\n  } else if (method === StringMethod.Split) {\n    // String delimited initialization\n    if (!inputParameters?.length) {\n      Object.assign(baseValue, {\n        inputParameters: [{ name: PREFIX_STR }],\n      });\n    }\n\n    if (Array.isArray(splitParams)) {\n      // Current selection separator\n      const delimiterValueItem = getParam(\n        splitParams,\n        BACK_END_NAME_MAP.delimiters,\n      );\n\n      // All separators\n      const delimiterOptionsItem = getParam(\n        splitParams,\n        BACK_END_NAME_MAP.allDelimiters,\n      );\n\n      // Is there a delimiter option?\n      const hasDelimiterOptions =\n        delimiterOptionsItem &&\n        (BlockInput.toLiteral(delimiterOptionsItem) as unknown[]).length > 0;\n\n      if (hasDelimiterOptions && delimiterValueItem) {\n        baseValue[FIELD_NAME_MAP.delimiter] = {\n          value: BlockInput.toLiteral(delimiterValueItem),\n          options: BlockInput.toLiteral(delimiterOptionsItem),\n        };\n      }\n    }\n  }\n\n  return baseValue;\n};\n\n/**\n * Front-end form structure data - > back-end data\n * @param value\n * @returns\n */\nexport const formatOnSubmit = (value: FormData) => {\n  const method = get(value, FIELD_NAME_MAP.method);\n  const nodeMeta = get(value, 'nodeMeta');\n\n  // Splicing Mode - Splicing Characters\n  const arrayItemConcatChar = get(\n    value,\n    `${FIELD_NAME_MAP.concatChar}.value`,\n    '',\n  );\n\n  // Splicing mode - all splicing characters (including customizations)\n  const allArrayItemConcatChars = get(\n    value,\n    `${FIELD_NAME_MAP.concatChar}.options`,\n    [],\n  );\n\n  // Splicing Mode - Splicing Results\n  const concatResult = get(value, FIELD_NAME_MAP.concatResult, '');\n\n  // Imported parameter variable\n  const inputParameters = get(value, 'inputParameters', []);\n\n  // Separator Mode - Separator\n  const delimiterValue = get(value, `${FIELD_NAME_MAP.delimiter}.value`, []);\n\n  // Separation mode - all separators (including customizations)\n  const allDelimiters = get(value, `${FIELD_NAME_MAP.delimiter}.options`, []);\n\n  // output variable\n  const outputs = get(value, FIELD_NAME_MAP.outputs);\n\n  const baseValue = {\n    nodeMeta,\n    inputs: {\n      method,\n      inputParameters,\n    },\n    outputs,\n  };\n\n  if (!method) {\n    return baseValue;\n  }\n\n  switch (method) {\n    case StringMethod.Concat:\n      Object.assign(baseValue.inputs, {\n        concatParams: [\n          // Splicing result\n          BlockInput.createString(FIELD_NAME_MAP.concatResult, concatResult),\n\n          // Current selection splice\n          BlockInput.createString(\n            BACK_END_NAME_MAP.arrayItemConcatChar,\n            arrayItemConcatChar,\n          ),\n\n          // All current splices\n          BlockInput.createArray(\n            BACK_END_NAME_MAP.allArrayItemConcatChars,\n            allArrayItemConcatChars,\n            OPTION_SCHEMA,\n          ),\n        ],\n      });\n      break;\n    case StringMethod.Split:\n      Object.assign(baseValue.inputs, {\n        splitParams: [\n          // Current selection separator (multiple)\n          BlockInput.createArray(BACK_END_NAME_MAP.delimiters, delimiterValue, {\n            type: 'string',\n          }),\n\n          // All current separators\n          BlockInput.createArray(\n            BACK_END_NAME_MAP.allDelimiters,\n            allDelimiters,\n            OPTION_SCHEMA,\n          ),\n        ],\n      });\n      break;\n    default:\n      break;\n  }\n\n  return baseValue;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n  DataEvent,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { provideNodeOutputVariablesEffect } from '@/nodes-v2/materials/provide-node-output-variables';\nimport { nodeMetaValidate } from '@/nodes-v2/materials/node-meta-validate';\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\n\nimport { createValueExpressionInputValidate } from '../common/validators';\nimport Render from './form';\nimport { handleMethodChangeEffect } from './effects/handle-method-change-effect';\nimport { formatOnInit, formatOnSubmit } from './data-transformer';\nimport { StringMethod } from './constants';\n\nexport const FORM_META: FormMetaV2<FormData> = {\n  render: () => <Render />,\n  validateTrigger: ValidateTrigger.onChange,\n  validate: {\n    nodeMeta: nodeMetaValidate,\n    // check input\n    'inputParameters.*.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n    // Verify splicing content\n    concatResult: ({ value, formValues }) => {\n      // Only the splicing mode verifies the splicing content.\n      if (formValues?.method === StringMethod.Split) {\n        return undefined;\n      }\n\n      return !value?.length\n        ? I18n.t('workflow_testset_required_tip', {\n            param_name: I18n.t('Content'),\n          })\n        : undefined;\n    },\n\n    // check separator\n    delimiter: ({ value: setterValue, formValues }) => {\n      // Only split mode checks delimiters\n      if (formValues?.method === StringMethod.Concat) {\n        return undefined;\n      }\n\n      if (!setterValue?.value || setterValue?.value.length === 0) {\n        return I18n.t('workflow_testset_required_tip', {\n          param_name: I18n.t('workflow_stringprocess_delimiter_title'),\n        });\n      }\n      return undefined;\n    },\n  },\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n\n    // Listen for character handling method changes\n    method: [\n      {\n        effect: handleMethodChangeEffect,\n        event: DataEvent.onValueChange,\n      },\n    ],\n  },\n  formatOnInit,\n  formatOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// import { get } from 'lodash-es';\nimport {\n  type Effect,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { DEFAULT_DELIMITER_OPTIONS } from '@coze-workflow/nodes';\n\nimport { getDefaultOutput, isSplitMethod } from '../utils';\n\nexport const handleMethodChangeEffect: Effect = props => {\n  const { value, context } = props;\n  const { node } = context;\n\n  const formModel = node.getData(FlowNodeFormData).getFormModel<FormModelV2>();\n\n  if (!formModel) {\n    return;\n  }\n\n  formModel.setValueIn('outputs', getDefaultOutput(value));\n\n  if (isSplitMethod(value)) {\n    formModel.setValueIn('delimiter', {\n      value: [],\n      options: DEFAULT_DELIMITER_OPTIONS,\n    });\n  }\n\n  formModel.setValueIn('inputParameters', [\n    { name: isSplitMethod(value) ? 'String' : 'String1' },\n  ]);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_OUTPUTS_PATH,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\n\nexport const TEXT_PROCESS_NODE_REGISTRY: WorkflowNodeRegistry<NodeTestMeta> = {\n  type: StandardNodeType.Text,\n  meta: {\n    nodeDTOType: StandardNodeType.Text,\n    style: {\n      width: 360,\n    },\n    size: { width: 360, height: 130.7 },\n    inputParametersPath: '/inputParameters',\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    outputsPath: DEFAULT_OUTPUTS_PATH,\n    test,\n    helpLink: '/open/docs/guides/text_processing_node',\n  },\n  formMeta: FORM_META,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport { generateParametersToProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    const parameters = formData?.inputParameters;\n    return generateParametersToProperties(parameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, set } from 'lodash-es';\nimport { type WorkflowNodeFormMeta } from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  DEFAULT_NODE_META_PATH,\n  DEFAULT_NODE_SIZE,\n  type WorkflowNodeRegistry,\n} from '@coze-workflow/nodes';\nimport {\n  StandardNodeType,\n  ValueExpression,\n  type VariableTypeDTO,\n  ViewVariableType,\n  type NodeMeta,\n  type InputValueDTO,\n  type RefExpressionContent,\n} from '@coze-workflow/base';\nconst NODE_WIDTH = DEFAULT_NODE_SIZE.width;\nconst NODE_HEIGHT = 113;\nconst INPUT_PATH = '/inputParameters';\n\nconst helpLinkMap = {\n  [StandardNodeType.ClearContext]:\n    '/open/docs/guides/clear_conversation_history',\n  [StandardNodeType.CreateConversation]:\n    '/open/docs/guides/create_conversation',\n  [StandardNodeType.QueryMessageList]: '/open/docs/guides/query_message_list',\n  [StandardNodeType.UpdateConversation]: '/open/docs/guides/edit_conversation',\n  [StandardNodeType.DeleteConversation]:\n    '/open/docs/guides/delete_conversation',\n  [StandardNodeType.QueryConversationList]:\n    '/open/docs/guides/query_conversation_list',\n  [StandardNodeType.QueryConversationHistory]:\n    '/open/docs/guides/query_conversation_history',\n  [StandardNodeType.CreateMessage]: '/open/docs/guides/create_message',\n  [StandardNodeType.UpdateMessage]: '/open/docs/guides/edit_message',\n  [StandardNodeType.DeleteMessage]: '/open/docs/guides/delete_message',\n};\n\nexport const createNodeRegistry = (\n  nodeType: StandardNodeType,\n  formMeta: WorkflowNodeFormMeta,\n  fieldConfig: Record<\n    string,\n    {\n      description: string;\n      name: string;\n      required: boolean;\n      type: string;\n    }\n  >,\n  nodeMeta?: Partial<NodeMeta>,\n  // eslint-disable-next-line max-params\n): WorkflowNodeRegistry => ({\n  type: nodeType,\n  meta: {\n    nodeDTOType: nodeType,\n    style: {\n      width: NODE_WIDTH,\n    },\n    size: { width: NODE_WIDTH, height: NODE_HEIGHT },\n    nodeMetaPath: DEFAULT_NODE_META_PATH,\n    inputParametersPath: INPUT_PATH, // Imported parameter path, practice running and other functions rely on this path to extract parameters\n    getInputVariableTag(name, input, extra) {\n      const field = fieldConfig[name || ''];\n\n      let invalid = false;\n\n      if (field?.required) {\n        const content = input?.content as RefExpressionContent;\n        const isRef = content?.keyPath?.length > 0;\n\n        // When initializing the process, it is possible that the variable module has not been initialized, and the variable will not be obtained here...\n        const variable = extra?.variableService.getWorkflowVariableByKeyPath(\n          content?.keyPath,\n          { node: extra?.node, checkScope: true },\n        );\n\n        // Required scene if:\n        // 1. Empty, error reported\n        // 2. Not empty\n        //   2.1 Reference to a variable, and the variable does not exist, an error is reported\n        invalid = ValueExpression.isEmpty(input) || (isRef && !variable);\n      }\n\n      return {\n        label: name,\n        type: field?.type\n          ? variableUtils.DTOTypeToViewType(field.type as VariableTypeDTO)\n          : ViewVariableType.String,\n        invalid,\n      };\n    },\n    helpLink: helpLinkMap[nodeType],\n    ...nodeMeta,\n  },\n  beforeNodeSubmit: nodeData => {\n    const inputParameters = get(\n      nodeData,\n      'data.inputs.inputParameters',\n      [],\n    ) as InputValueDTO[];\n\n    // For fixed parameter types, you need to set the type field to a predefined type, rather than the variable type populated on the right\n    inputParameters.forEach(param => {\n      const config = fieldConfig[param.name || ''];\n      if (config && param.input.type) {\n        set(param, 'input.type', config.type);\n      }\n    });\n\n    return nodeData;\n  },\n  formMeta,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport omit from 'lodash-es/omit';\nimport { type NodeDataDTO, type InputValueVO } from '@coze-workflow/base';\n\ninterface FormData {\n  inputParameters: InputValueVO[];\n}\n\n/**\n * Front-end form data - > node back-end data\n * @param value\n * @returns\n */\nexport const transformOnSubmit = (value: FormData): NodeDataDTO => {\n  const formattedValue: Record<string, unknown> = {\n    ...value,\n    inputs: {\n      inputParameters: value?.inputParameters || [],\n    },\n  };\n\n  return omit(formattedValue, ['inputParameters']) as unknown as NodeDataDTO;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport omit from 'lodash-es/omit';\nimport {\n  type InputValueVO,\n  type ViewVariableTreeNode,\n  type NodeDataDTO,\n} from '@coze-workflow/base';\n\nconst isEmptyArrayOrNil = (value: unknown) =>\n  // eslint-disable-next-line eqeqeq\n  (Array.isArray(value) && value.length === 0) || value == null;\n/**\n * Node Backend Data - > Frontend Form Data\n */\nexport const createTransformOnInit =\n  (\n    defaultInputValue: InputValueVO[] = [],\n    defaultOutputValue: ViewVariableTreeNode[] = [],\n  ) =>\n  (value: NodeDataDTO) => {\n    const { inputs, outputs } = value || {};\n    const inputParameters = inputs?.inputParameters || [];\n\n    // Since variables that are not filled in will be filtered out during commit, the default value needs to be added during initialization\n    // See also: packages/workflow/nodes/src/workflow-json-format: 241\n    const refillInputParamters = defaultInputValue.map(cur => {\n      const { name } = cur;\n      const target = inputParameters.find(item => item.name === name);\n      if (target) {\n        return target;\n      }\n      return cur;\n    }, []);\n\n    const initValue = {\n      ...omit(value, ['inputs']),\n      inputParameters: refillInputParamters,\n      outputs: isEmptyArrayOrNil(outputs) ? defaultOutputValue : outputs,\n    };\n\n    return initValue;\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nexport const CONVERSATION_NAME = 'conversationName';\n\nexport const PARAMS_COLUMNS = [\n  {\n    title: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 180 },\n  },\n  {\n    title: I18n.t('workflow_detail_node_parameter_value'),\n    style: { flex: '1' },\n  },\n];\n\nexport const INPUT_COLUMNS_NARROW = [\n  {\n    title: I18n.t('workflow_detail_node_parameter_name'),\n    style: { width: 140 },\n  },\n  {\n    title: I18n.t('workflow_detail_node_parameter_value'),\n    style: { flex: '1' },\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { set, cloneDeep } from 'lodash-es';\nimport {\n  DataEvent,\n  type EffectOptions,\n  type Effect,\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { ValueExpression, WorkflowMode } from '@coze-workflow/base';\n\nimport { CONVERSATION_NAME } from './constants';\n\n/** Delay 200ms. At this time, the variable scope can only be detected after the equilateral connection is connected. */\nconst DELAY = 200;\n\nconst effect: Effect = ({ value, context }) => {\n  if (!context) {\n    return;\n  }\n  const { node, playgroundContext } = context;\n\n  const { variableService, nodesService, globalState } = playgroundContext;\n  const startNode = nodesService.getStartNode();\n  const formModel = node.getData(FlowNodeFormData).getFormModel<FormModelV2>();\n  const isChatflow = globalState.flowMode === WorkflowMode.ChatFlow;\n  const { isInIDE } = globalState;\n\n  setTimeout(() => {\n    const startConversationNameVar =\n      variableService.getWorkflowVariableByKeyPath(\n        [startNode.id, 'CONVERSATION_NAME'],\n        {\n          node,\n          checkScope: true,\n        },\n      );\n\n    const clonedValue = cloneDeep(value);\n    const conversationNameItem = clonedValue.find(\n      v => v.name === CONVERSATION_NAME,\n    );\n    const noValue = ValueExpression.isEmpty(\n      conversationNameItem?.input as ValueExpression,\n    );\n\n    // If you can find the CONVERSATION_NAME parameters of the start node\n    if (\n      startConversationNameVar &&\n      conversationNameItem &&\n      isChatflow &&\n      noValue\n    ) {\n      if (formModel) {\n        set(conversationNameItem, 'input', {\n          type: 'ref',\n          content: {\n            keyPath: ['100001', 'CONVERSATION_NAME'],\n          },\n        });\n        formModel.setValueIn('inputParameters', clonedValue);\n      }\n    } else if (!isInIDE && !isChatflow && conversationNameItem && noValue) {\n      // Non-project workflow, if there is a CONVERSATION_NAME field with no value, fill in the default value default\n      if (formModel) {\n        set(conversationNameItem, 'input', {\n          type: 'literal',\n          content: 'Default',\n        });\n        formModel.setValueIn('inputParameters', clonedValue);\n      }\n    }\n  }, DELAY);\n};\n\nexport const syncConversationNameEffect: EffectOptions[] = [\n  {\n    event: DataEvent.onValueInit,\n    effect,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Field,\n  FieldArray,\n  type FieldArrayRenderProps,\n  type FieldRenderProps,\n} from '@flowgram-adapter/free-layout-editor';\nimport { variableUtils } from '@coze-workflow/variable';\nimport {\n  ViewVariableType,\n  type InputValueVO,\n  type ValueExpression,\n  type VariableTypeDTO,\n} from '@coze-workflow/base';\n\nimport { ValueExpressionInput } from '@/nodes-v2/components/value-expression-input';\nimport { FormItemFeedback } from '@/nodes-v2/components/form-item-feedback';\nimport { FormCard } from '@/form-extensions/components/form-card';\nimport { ColumnsTitle } from '@/form-extensions/components/columns-title';\n\nimport InputLabel from '../input-label';\n\nexport interface FixedInputParametersProps {\n  fieldName?: string;\n  defaultValue?: InputValueVO[];\n  headerTitle: string;\n  headerTootip: string;\n  columns?: {\n    title: string;\n    style: React.CSSProperties;\n  }[];\n  fieldConfig?: Record<\n    string,\n    {\n      description: string;\n      name: string;\n      required: boolean;\n      type: string;\n      optionsList?: {\n        label: string;\n        value: string;\n      }[];\n    }\n  >;\n  readonly?: boolean;\n}\n\nconst FixedInputParameters = (props: FixedInputParametersProps) => {\n  const {\n    fieldName = 'inputParameters',\n    defaultValue = [],\n    headerTitle,\n    headerTootip,\n    columns,\n    fieldConfig = {},\n    readonly = false,\n  } = props;\n  return (\n    <FieldArray name={fieldName} defaultValue={defaultValue}>\n      {({ field: _field }: FieldArrayRenderProps<InputValueVO>) => (\n        <>\n          <FormCard header={headerTitle} tooltip={headerTootip}>\n            <div className=\"pb-[8px]\">\n              <ColumnsTitle columns={columns ?? []} />\n            </div>\n\n            {Object.keys(fieldConfig).map((_fieldName, index) => (\n              <div\n                key={_fieldName}\n                className=\"array-item-wrapper flex items-start pb-[8px]\"\n              >\n                <div className={'w-[140px]'}>\n                  <InputLabel\n                    required={fieldConfig[_fieldName]?.required}\n                    label={fieldConfig[_fieldName]?.name}\n                    tooltip={fieldConfig[_fieldName]?.description}\n                    tootipIconClassName=\"coz-fg-secondary\"\n                    tag={null}\n                  />\n                </div>\n\n                <Field name={`inputParameters.${index}.input`}>\n                  {({\n                    field: childField,\n                    fieldState: childState,\n                  }: FieldRenderProps<ValueExpression | undefined>) => (\n                    <div className=\"flex-1 min-w-0\">\n                      <ValueExpressionInput\n                        {...childField}\n                        readonly={readonly}\n                        disabledTypes={ViewVariableType.getComplement([\n                          variableUtils.DTOTypeToViewType(\n                            fieldConfig[_fieldName].type as VariableTypeDTO,\n                          ),\n                        ])}\n                        literalConfig={{\n                          // Drop down to select the data source\n                          optionsList: fieldConfig[_fieldName]?.optionsList,\n                        }}\n                        isError={!!childState?.errors?.length}\n                      />\n                      <FormItemFeedback errors={childState?.errors} />\n                    </div>\n                  )}\n                </Field>\n              </div>\n            ))}\n          </FormCard>\n        </>\n      )}\n    </FieldArray>\n  );\n};\n\nexport default FixedInputParameters;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Field } from '@flowgram-adapter/free-layout-editor';\nimport { PublicScopeProvider } from '@coze-workflow/variable';\nimport {\n  type InputValueVO,\n  type ViewVariableTreeNode,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { Outputs } from '@/nodes-v2/components/outputs';\n\nimport NodeMeta from '../components/node-meta';\nimport FixedInputParameters from '../components/fixed-input-parameters';\nimport { INPUT_COLUMNS_NARROW } from './constants';\nexport interface FormRenderProps {\n  defaultInputValue: InputValueVO[] | undefined;\n  defaultOutputValue: ViewVariableTreeNode[] | undefined;\n  fieldConfig: Record<\n    string,\n    {\n      description: string;\n      name: string;\n      required: boolean;\n      type: string;\n      optionsList?: {\n        label: string;\n        value: string;\n      }[];\n    }\n  >;\n  readonly: boolean;\n  inputTooltip: string;\n  outputTooltip: string;\n  hasInputs?: boolean;\n}\n\nexport const createFormRender = ({\n  defaultInputValue,\n  defaultOutputValue,\n  fieldConfig,\n  readonly,\n  inputTooltip = '',\n  outputTooltip = '',\n  hasInputs = true,\n}: FormRenderProps) => (\n  <PublicScopeProvider>\n    <>\n      <NodeMeta fieldName=\"nodeMeta\" />\n\n      {hasInputs ? (\n        <FixedInputParameters\n          fieldName=\"inputParameters\"\n          defaultValue={defaultInputValue}\n          headerTitle={I18n.t('workflow_detail_node_parameter_input')}\n          headerTootip={inputTooltip}\n          columns={INPUT_COLUMNS_NARROW}\n          fieldConfig={fieldConfig}\n          readonly={readonly}\n        />\n      ) : null}\n\n      <Field name=\"outputs\" defaultValue={defaultOutputValue}>\n        {({ field, fieldState }) => (\n          <Outputs\n            id={'create-conversation-node-output'}\n            value={field.value}\n            onChange={field.onChange}\n            titleTooltip={outputTooltip}\n            readonly\n            needErrorBody={false}\n            errors={fieldState?.errors}\n          />\n        )}\n      </Field>\n    </>\n  </PublicScopeProvider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  [CONVERSATION_NAME]: {\n    description: I18n.t('wf_chatflow_24'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: 'string',\n  },\n  limit: {\n    description: I18n.t('wf_chatflow_34'),\n    name: 'limit',\n    required: false,\n    type: 'integer',\n  },\n  beforeId: {\n    description: I18n.t('wf_chatflow_35'),\n    name: 'beforeId',\n    required: false,\n    type: 'string',\n  },\n  afterId: {\n    description: I18n.t('wf_chatflow_36'),\n    name: 'afterId',\n    required: false,\n    type: 'string',\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = [\n  {\n    name: CONVERSATION_NAME,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  },\n  {\n    name: 'limit',\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  },\n  {\n    name: 'beforeId',\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  },\n  {\n    name: 'afterId',\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  },\n];\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'messageList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'messageId',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'role',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'contentType',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n  {\n    key: nanoid(),\n    name: 'firstId',\n    type: ViewVariableType.String,\n  },\n  {\n    key: nanoid(),\n    name: 'lastId',\n    type: ViewVariableType.String,\n  },\n  {\n    key: nanoid(),\n    name: 'hasMore',\n    type: ViewVariableType.Boolean,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = ({ form }) => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('wf_chatflow_33'),\n    outputTooltip: I18n.t('wf_chatflow_37'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\n\nimport { transformOnSubmit } from '../transform-on-submit';\nimport { createTransformOnInit } from '../transform-on-init';\nimport { syncConversationNameEffect } from '../sync-conversation-name-effect';\nimport { provideNodeOutputVariablesEffect } from '../../materials/provide-node-output-variables';\nimport FormRender from './form-render';\nimport { DEFAULT_CONVERSATION_VALUE, DEFAULT_OUTPUTS } from './constants';\n\ninterface FormData {\n  inputParameters: InputValueVO[];\n}\n\nexport const QUERY_MESSAGE_LIST_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: props => <FormRender {...props} />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    // Required\n    'inputParameters.0.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n    inputParameters: syncConversationNameEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: createTransformOnInit(\n    DEFAULT_CONVERSATION_VALUE,\n    DEFAULT_OUTPUTS,\n  ),\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { QUERY_MESSAGE_LIST_FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const QUERY_MESSAGE_LIST_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.QueryMessageList,\n  QUERY_MESSAGE_LIST_FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('wf_chatflow_14'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: 'string',\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = [\n  {\n    name: CONVERSATION_NAME,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  },\n];\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n  {\n    key: nanoid(),\n    name: 'isExisted',\n    type: ViewVariableType.Boolean,\n  },\n  {\n    key: nanoid(),\n    name: 'conversationId',\n    type: ViewVariableType.String,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('wf_chatflow_13'),\n    outputTooltip: I18n.t('wf_chatflow_15'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\n\nimport { transformOnSubmit } from '../transform-on-submit';\nimport { createTransformOnInit } from '../transform-on-init';\nimport { provideNodeOutputVariablesEffect } from '../../materials/provide-node-output-variables';\nimport FormRender from './form-render';\nimport { DEFAULT_CONVERSATION_VALUE, DEFAULT_OUTPUTS } from './constants';\n\ninterface FormData {\n  inputParameters: InputValueVO[];\n}\n\nexport const CREATE_CONVERSATION_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    // Required\n    'inputParameters.0.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: createTransformOnInit(\n    DEFAULT_CONVERSATION_VALUE,\n    DEFAULT_OUTPUTS,\n  ),\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { CREATE_CONVERSATION_FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const CREATE_CONVERSATION_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.CreateConversation,\n  CREATE_CONVERSATION_FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasConversationNode: true,\n      disableBot: true,\n      disableBotTooltip: I18n.t('wf_chatflow_141'),\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('wf_chatflow_24'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: 'string',\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = [\n  {\n    name: CONVERSATION_NAME,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  },\n];\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('wf_chatflow_23'),\n    outputTooltip: I18n.t('wf_chatflow_25'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\n\nimport { transformOnSubmit } from '../transform-on-submit';\nimport { createTransformOnInit } from '../transform-on-init';\nimport { syncConversationNameEffect } from '../sync-conversation-name-effect';\nimport { provideNodeOutputVariablesEffect } from '../../materials/provide-node-output-variables';\nimport FormRender from './form-render';\nimport { DEFAULT_CONVERSATION_VALUE, DEFAULT_OUTPUTS } from './constants';\n\ninterface FormData {\n  inputParameters: InputValueVO[];\n}\n\nexport const CLEAR_CONTEXT_FORM_META: FormMetaV2<FormData> = {\n  // Node form rendering\n  render: () => <FormRender />,\n\n  // verification trigger timing\n  validateTrigger: ValidateTrigger.onChange,\n\n  // validation rules\n  validate: {\n    // Required\n    'inputParameters.0.input': createValueExpressionInputValidate({\n      required: true,\n    }),\n  },\n\n  // Side effect management\n  effect: {\n    nodeMeta: fireNodeTitleChange,\n    outputs: provideNodeOutputVariablesEffect,\n    inputParameters: syncConversationNameEffect,\n  },\n\n  // Node Backend Data - > Frontend Form Data\n  formatOnInit: createTransformOnInit(\n    DEFAULT_CONVERSATION_VALUE,\n    DEFAULT_OUTPUTS,\n  ),\n\n  // Front-end form data - > node back-end data\n  formatOnSubmit: transformOnSubmit,\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { CLEAR_CONTEXT_FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const CLEAR_CONTEXT_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.ClearContext,\n  CLEAR_CONTEXT_FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  ValidateTrigger,\n  type FormMetaV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type InputValueVO } from '@coze-workflow/base';\n\nimport { fireNodeTitleChange } from '@/nodes-v2/materials/fire-node-title-change';\nimport { createValueExpressionInputValidate } from '@/nodes-v2/materials/create-value-expression-input-validate';\n\nimport { provideNodeOutputVariablesEffect } from '../materials/provide-node-output-variables';\nimport { transformOnSubmit } from './transform-on-submit';\nimport { createTransformOnInit } from './transform-on-init';\nimport { syncConversationNameEffect } from './sync-conversation-name-effect';\n\ninterface ChatFormData {\n  inputParameters: InputValueVO[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n\nexport const createFormMeta = ({\n  fieldConfig,\n  needSyncConversationName,\n  defaultInputValue,\n  defaultOutputValue,\n  formRenderComponent,\n  customValidators = {},\n}): FormMetaV2<ChatFormData> => {\n  // Define an uppercase variable reference component\n  const FormRender = formRenderComponent;\n\n  const formMeta = {\n    // Node form rendering\n    render: () => <FormRender />,\n\n    // verification trigger timing\n    validateTrigger: ValidateTrigger.onChange,\n\n    // validation rules\n    validate: {\n      // Required\n      'inputParameters.*.input': createValueExpressionInputValidate({\n        required: ({ name }) => {\n          const fieldName = name\n            .replace('inputParameters.', '')\n            .replace('.input', '');\n\n          return Boolean(fieldConfig[fieldName]?.required);\n        },\n      }),\n      ...customValidators,\n    },\n\n    // Side effect management\n    effect: {\n      nodeMeta: fireNodeTitleChange,\n      outputs: provideNodeOutputVariablesEffect,\n    },\n\n    // Node Backend Data - > Frontend Form Data\n    formatOnInit: createTransformOnInit(defaultInputValue, defaultOutputValue),\n\n    // Front-end form data - > node back-end data\n    formatOnSubmit: transformOnSubmit,\n  };\n\n  // Need to synchronize the value of CONVERSATION_NAME field\n  if (needSyncConversationName) {\n    Object.assign(formMeta.effect, {\n      inputParameters: syncConversationNameEffect,\n    });\n  }\n\n  return formMeta;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('workflow_250407_019'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: 'string',\n  },\n  newConversationName: {\n    description: I18n.t('workflow_250407_020'),\n    name: 'newConversationName',\n    required: true,\n    type: 'string',\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = Object.keys(FIELD_CONFIG).map(\n  fieldName => ({\n    name: fieldName,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  }),\n);\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n  {\n    key: nanoid(),\n    name: 'isExisted',\n    type: ViewVariableType.Boolean,\n  },\n  {\n    key: nanoid(),\n    name: 'conversationId',\n    type: ViewVariableType.String,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport {\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n  FIELD_CONFIG,\n} from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: FIELD_CONFIG,\n  needSyncConversationName: false,\n  defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const UPDATE_CONVERSATION_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.UpdateConversation,\n  FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasConversationNode: true,\n      disableBot: true,\n      disableBotTooltip: I18n.t('wf_chatflow_141'),\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('workflow_250407_023'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: 'string',\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = Object.keys(FIELD_CONFIG).map(\n  fieldName => ({\n    name: fieldName,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  }),\n);\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport {\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n  FIELD_CONFIG,\n} from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: FIELD_CONFIG,\n  needSyncConversationName: false,\n  defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const DELETE_CONVERSATION_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.DeleteConversation,\n  FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasConversationNode: true,\n      disableBot: true,\n      disableBotTooltip: I18n.t('wf_chatflow_141'),\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ViewVariableType } from '@coze-workflow/variable';\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'conversationList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'conversationName',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'conversationId',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport { DEFAULT_OUTPUTS } from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: {},\n  needSyncConversationName: false,\n  defaultInputValue: [],\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport { DEFAULT_OUTPUTS } from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: [],\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: {},\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n    hasInputs: false,\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\n\nexport const QUERY_CONVERSATION_LIST_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.QueryConversationList,\n  FORM_META,\n  {},\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { generateEnvToRelatedContextProperties } from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n      hasConversationNode: true,\n      disableBot: true,\n      disableBotTooltip: I18n.t('wf_chatflow_141'),\n    });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { VariableTypeDTO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('workflow_250407_028'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n  rounds: {\n    description: I18n.t('workflow_250407_029'),\n    name: 'rounds',\n    required: true,\n    type: VariableTypeDTO.integer,\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = Object.keys(FIELD_CONFIG).map(\n  fieldName => ({\n    name: fieldName,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  }),\n);\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'messageList',\n    type: ViewVariableType.ArrayObject,\n    children: [\n      {\n        key: nanoid(),\n        name: 'role',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport {\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n  FIELD_CONFIG,\n} from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: FIELD_CONFIG,\n  needSyncConversationName: true,\n  defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const QUERY_CONVERSATION_HISTORY_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.QueryConversationHistory,\n  FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { type InputValueVO, VariableTypeDTO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('workflow_250407_005'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n\n  role: {\n    description: I18n.t('workflow_250407_006'),\n    name: 'role',\n    required: true,\n    type: VariableTypeDTO.string,\n\n    // option default\n    defaultValue: 'user',\n\n    // list of options\n    optionsList: [\n      { label: 'user', value: 'user' },\n      { label: 'assistant', value: 'assistant' },\n    ],\n  },\n\n  content: {\n    description: I18n.t('workflow_250407_007'),\n    name: 'content',\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE: InputValueVO[] = Object.keys(\n  FIELD_CONFIG,\n).map(fieldName => {\n  // For the role field, you need to set the literal default\n  if (fieldName === 'role') {\n    return {\n      name: fieldName,\n      input: {\n        type: ValueExpressionType.LITERAL,\n        content: FIELD_CONFIG[fieldName].defaultValue,\n      },\n    };\n  }\n\n  return {\n    name: fieldName,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  };\n});\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n  {\n    key: nanoid(),\n    name: 'message',\n    type: ViewVariableType.Object,\n    children: [\n      {\n        key: nanoid(),\n        name: 'messageId',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'role',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'contentType',\n        type: ViewVariableType.String,\n      },\n      {\n        key: nanoid(),\n        name: 'content',\n        type: ViewVariableType.String,\n      },\n    ],\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport {\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n  FIELD_CONFIG,\n} from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: FIELD_CONFIG,\n  needSyncConversationName: true,\n  defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const CREATE_MESSAGE_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.CreateMessage,\n  FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { VariableTypeDTO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('workflow_250407_010'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n\n  messageId: {\n    description: I18n.t('workflow_250407_011'),\n    name: 'messageId',\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n\n  newContent: {\n    description: I18n.t('workflow_250407_012'),\n    name: 'newContent',\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = Object.keys(FIELD_CONFIG).map(\n  fieldName => ({\n    name: fieldName,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  }),\n);\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport {\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n  FIELD_CONFIG,\n} from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: FIELD_CONFIG,\n  needSyncConversationName: true,\n  defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const UPDATE_MESSAGE_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.UpdateMessage,\n  FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport { ValueExpressionType, ViewVariableType } from '@coze-workflow/variable';\nimport { VariableTypeDTO } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { CONVERSATION_NAME } from '../constants';\n\nexport const FIELD_CONFIG = {\n  conversationName: {\n    description: I18n.t('workflow_250407_015'),\n    name: CONVERSATION_NAME,\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n\n  messageId: {\n    description: I18n.t('workflow_250407_016'),\n    name: 'messageId',\n    required: true,\n    type: VariableTypeDTO.string,\n  },\n};\n\nexport const DEFAULT_CONVERSATION_VALUE = Object.keys(FIELD_CONFIG).map(\n  fieldName => ({\n    name: fieldName,\n    input: {\n      type: ValueExpressionType.REF,\n    },\n  }),\n);\n\nexport const DEFAULT_OUTPUTS = [\n  {\n    key: nanoid(),\n    name: 'isSuccess',\n    type: ViewVariableType.Boolean,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FormMetaV2 } from '@flowgram-adapter/free-layout-editor';\n\nimport { createFormMeta } from '../create-form-meta';\nimport FormRender from './form-render';\nimport {\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n  FIELD_CONFIG,\n} from './constants';\n\nexport const FORM_META: FormMetaV2 = createFormMeta({\n  fieldConfig: FIELD_CONFIG,\n  needSyncConversationName: true,\n  defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n  defaultOutputValue: DEFAULT_OUTPUTS,\n  formRenderComponent: FormRender,\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { useReadonly } from '@/nodes-v2/hooks/use-readonly';\n\nimport { createFormRender } from '../create-form-render';\nimport {\n  FIELD_CONFIG,\n  DEFAULT_CONVERSATION_VALUE,\n  DEFAULT_OUTPUTS,\n} from './constants';\n\nconst Render = () => {\n  const readonly = useReadonly();\n\n  return createFormRender({\n    defaultInputValue: DEFAULT_CONVERSATION_VALUE,\n    defaultOutputValue: DEFAULT_OUTPUTS,\n    fieldConfig: FIELD_CONFIG,\n    readonly,\n    inputTooltip: I18n.t('Input'),\n    outputTooltip: I18n.t('Output'),\n  });\n};\n\nexport default Render;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { createNodeRegistry } from '../create-node-registry';\nimport { test } from './node-test';\nimport { FORM_META } from './form-meta';\nimport { FIELD_CONFIG } from './constants';\n\nexport const DELETE_MESSAGE_NODE_REGISTRY = createNodeRegistry(\n  StandardNodeType.DeleteMessage,\n  FORM_META,\n  FIELD_CONFIG,\n  { test },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  generateParametersToProperties,\n  generateEnvToRelatedContextProperties,\n} from '@/test-run-kit';\nimport { type NodeTestMeta } from '@/test-run-kit';\n\nexport const test: NodeTestMeta = {\n  generateRelatedContext(node, context) {\n    const { isInProject } = context;\n    if (isInProject) {\n      return {};\n    }\n    return generateEnvToRelatedContextProperties({\n      isNeedBot: true,\n    });\n  },\n  generateFormInputProperties(node) {\n    const formData = node\n      .getData(FlowNodeFormData)\n      .formModel.getFormItemValueByPath('/');\n    return generateParametersToProperties(formData?.inputParameters, { node });\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { VARIABLE_MERGE_NODE_REGISTRY } from '@/nodes-v2/variable-merge';\nimport { VARIABLE_ASSIGN_NODE_REGISTRY } from '@/nodes-v2/variable-assign';\nimport { LLM_NODE_REGISTRY } from '@/nodes-v2/llm';\nimport {\n  CODE_NODE_REGISTRY,\n  COMMENT_NODE_REGISTRY,\n  DATABASE_CREATE_NODE_REGISTRY,\n  DATABASE_DELETE_NODE_REGISTRY,\n  DATABASE_NODE_REGISTRY,\n  DATABASE_QUERY_NODE_REGISTRY,\n  DATABASE_UPDATE_NODE_REGISTRY,\n  DATASET_NODE_REGISTRY,\n  DATASET_WRITE_NODE_REGISTRY,\n  END_NODE_REGISTRY,\n  HTTP_NODE_REGISTRY,\n  IMAGE_CANVAS_NODE_REGISTRY,\n  IMAGE_GENERATE_NODE_REGISTRY,\n  IMAGE_REFERENCE_NODE_REGISTRY,\n  INPUT_NODE_REGISTRY,\n  LOOP_NODE_REGISTRY,\n  LTM_NODE_REGISTRY,\n  OUTPUT_NODE_REGISTRY,\n  QUESTION_NODE_REGISTRY,\n  START_NODE_REGISTRY,\n  TEXT_PROCESS_NODE_REGISTRY,\n  TRIGGER_DELETE_NODE_REGISTRY,\n  TRIGGER_READ_NODE_REGISTRY,\n  TRIGGER_UPSERT_NODE_REGISTRY,\n  BREAK_NODE_REGISTRY,\n  CONTINUE_NODE_REGISTRY,\n  SET_VARIABLE_NODE_REGISTRY,\n  BATCH_NODE_REGISTRY,\n  INTENT_NODE_REGISTRY,\n  IF_NODE_REGISTRY,\n  PLUGIN_NODE_REGISTRY,\n  SUB_WORKFLOW_NODE_REGISTRY,\n  VARIABLE_NODE_REGISTRY,\n  JSON_STRINGIFY_NODE_REGISTRY,\n} from '@/node-registries';\n\nimport {\n  CLEAR_CONTEXT_NODE_REGISTRY,\n  CREATE_CONVERSATION_NODE_REGISTRY,\n  QUERY_MESSAGE_LIST_NODE_REGISTRY,\n  UPDATE_CONVERSATION_NODE_REGISTRY,\n  DELETE_CONVERSATION_NODE_REGISTRY,\n  QUERY_CONVERSATION_LIST_NODE_REGISTRY,\n  QUERY_CONVERSATION_HISTORY_NODE_REGISTRY,\n  CREATE_MESSAGE_NODE_REGISTRY,\n  UPDATE_MESSAGE_NODE_REGISTRY,\n  DELETE_MESSAGE_NODE_REGISTRY,\n} from './chat';\n\nexport const NODES_V2 = [\n  JSON_STRINGIFY_NODE_REGISTRY,\n  IF_NODE_REGISTRY,\n  INTENT_NODE_REGISTRY,\n  SUB_WORKFLOW_NODE_REGISTRY,\n  CODE_NODE_REGISTRY,\n  LTM_NODE_REGISTRY,\n  IMAGE_GENERATE_NODE_REGISTRY,\n  IMAGE_REFERENCE_NODE_REGISTRY,\n  TRIGGER_READ_NODE_REGISTRY,\n  TRIGGER_DELETE_NODE_REGISTRY,\n  IMAGE_CANVAS_NODE_REGISTRY,\n  OUTPUT_NODE_REGISTRY,\n  END_NODE_REGISTRY,\n  INPUT_NODE_REGISTRY,\n  START_NODE_REGISTRY,\n  TRIGGER_UPSERT_NODE_REGISTRY,\n  PLUGIN_NODE_REGISTRY,\n  LLM_NODE_REGISTRY,\n  HTTP_NODE_REGISTRY,\n  LOOP_NODE_REGISTRY,\n  SET_VARIABLE_NODE_REGISTRY,\n  CONTINUE_NODE_REGISTRY,\n  BREAK_NODE_REGISTRY,\n  BATCH_NODE_REGISTRY,\n  COMMENT_NODE_REGISTRY,\n  CREATE_CONVERSATION_NODE_REGISTRY,\n  CLEAR_CONTEXT_NODE_REGISTRY,\n  QUERY_MESSAGE_LIST_NODE_REGISTRY,\n  UPDATE_CONVERSATION_NODE_REGISTRY,\n  DELETE_CONVERSATION_NODE_REGISTRY,\n  QUERY_CONVERSATION_LIST_NODE_REGISTRY,\n  QUERY_CONVERSATION_HISTORY_NODE_REGISTRY,\n  CREATE_MESSAGE_NODE_REGISTRY,\n  UPDATE_MESSAGE_NODE_REGISTRY,\n  DELETE_MESSAGE_NODE_REGISTRY,\n  VARIABLE_MERGE_NODE_REGISTRY,\n  VARIABLE_ASSIGN_NODE_REGISTRY,\n  DATABASE_CREATE_NODE_REGISTRY,\n  DATABASE_QUERY_NODE_REGISTRY,\n  DATABASE_DELETE_NODE_REGISTRY,\n  DATABASE_UPDATE_NODE_REGISTRY,\n  QUESTION_NODE_REGISTRY,\n  DATASET_WRITE_NODE_REGISTRY,\n  DATASET_NODE_REGISTRY,\n  TEXT_PROCESS_NODE_REGISTRY,\n  DATABASE_NODE_REGISTRY,\n  VARIABLE_NODE_REGISTRY,\n];\nexport const NODE_V2_TYPES = NODES_V2.map(r => r.type);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeRegistry } from '@coze-workflow/nodes';\nimport { type StandardNodeType } from '@coze-workflow/base';\n\nimport { NODE_V2_TYPES, NODES_V2 } from '@/nodes-v2/constants';\n\nexport const isNodeV2registry = (registry: WorkflowNodeRegistry) =>\n  NODES_V2.some(r => NODE_V2_TYPES.includes(registry.type));\n\nexport const isNodeV2 = (node: FlowNodeEntity) =>\n  NODE_V2_TYPES.includes(node.flowNodeType);\n\nexport const getNodeV2Registry = (nodeType: StandardNodeType) =>\n  NODES_V2.find(r => r.type === nodeType);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useQuery, type UseQueryResult } from '@tanstack/react-query';\nimport {\n  type DatasetFCItem,\n  type GetLLMNodeFCSettingDetailResponse,\n  type PluginFCItem,\n  workflowApi,\n  type WorkflowFCItem,\n} from '@coze-workflow/base/api';\n\nimport { PromiseLimiter } from '@/utils/promise-limiter';\n\n// Limit concurrency, because there may be many LLM nodes on the same process, simultaneously requesting\nconst CONCURRENCY = 3;\n\nconst limiter = new PromiseLimiter(CONCURRENCY, true);\n\nexport const useQuerySettingDetail = (params: {\n  workflowId: string;\n  spaceId: string;\n  nodeId: string;\n  plugin_list?: Array<PluginFCItem>;\n  workflow_list?: Array<WorkflowFCItem>;\n  dataset_list?: Array<DatasetFCItem>;\n  enabled?: boolean;\n}): UseQueryResult<GetLLMNodeFCSettingDetailResponse> => {\n  const { nodeId, enabled = true } = params;\n  return useQuery({\n    queryKey: [nodeId, 'settingDetail'],\n    queryFn: () =>\n      limiter.run(() =>\n        workflowApi.GetLLMNodeFCSettingDetail({\n          workflow_id: params.workflowId,\n          space_id: params.spaceId,\n          plugin_list: params.plugin_list,\n          workflow_list: params.workflow_list,\n          dataset_list: params.dataset_list,\n        }),\n      ),\n    enabled,\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Limit concurrency\n */\nexport class PromiseLimiter<T> {\n  private concurrency: number;\n  private activeCount: number;\n  private enable: boolean;\n\n  constructor(concurrency: number, enable = true) {\n    this.concurrency = concurrency;\n    this.pendingPromises = [];\n    this.activeCount = 0;\n    this.enable = enable;\n  }\n\n  private pendingPromises: Array<{\n    promiseFactory: () => Promise<T>;\n    resolve: (value: T | PromiseLike<T>) => void;\n    reject: (reason?: string) => void;\n  }>;\n\n  run(promiseFactory: () => Promise<T>): Promise<T> {\n    if (!this.enable) {\n      return promiseFactory();\n    }\n\n    return new Promise<T>((resolve, reject) => {\n      this.pendingPromises.push({ promiseFactory, resolve, reject });\n      this.next();\n    });\n  }\n\n  private next() {\n    if (this.activeCount < this.concurrency) {\n      const item = this.pendingPromises.shift();\n      if (!item) {\n        return;\n      }\n\n      const { promiseFactory, resolve, reject } = item;\n      this.activeCount++;\n      promiseFactory()\n        .then(result => {\n          resolve(result);\n        })\n        .catch(error => {\n          reject(error);\n        })\n        .finally(() => {\n          this.activeCount--;\n          this.next();\n        });\n    }\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type BoundSkills } from './types';\n\n/**\n * Determine whether it is a draft according to the projectId\n * Plugins in library project_id = '0'\n */\nexport function isDraftByProjectId(projectId?: string) {\n  return projectId && projectId !== '0' ? true : false;\n}\n\n/**\n * Is the skill empty?\n * @param value\n * @returns\n */\nexport function isSkillsEmpty(value: BoundSkills) {\n  return (\n    !value.pluginFCParam?.pluginList?.length &&\n    !value.workflowFCParam?.workflowList?.length &&\n    !value.knowledgeFCParam?.knowledgeList?.length\n  );\n}\n\n/**\n * Get skill query parameters\n * @param fcParam\n * @returns\n */\nexport function getSkillsQueryParams(boundSkills?: BoundSkills) {\n  return {\n    plugin_list: boundSkills?.pluginFCParam?.pluginList?.map(item => ({\n      plugin_id: item.plugin_id,\n      api_id: item.api_id,\n      api_name: item.api_name,\n      is_draft: item.is_draft,\n      plugin_version: item.plugin_version,\n      plugin_from: item.plugin_from,\n    })),\n    workflow_list: boundSkills?.workflowFCParam?.workflowList?.map(item => ({\n      workflow_id: item.workflow_id,\n      plugin_id: item.plugin_id,\n      is_draft: item.is_draft,\n      workflow_version: item.workflow_version,\n    })),\n    dataset_list: boundSkills?.knowledgeFCParam?.knowledgeList?.map(item => ({\n      dataset_id: item.id,\n      is_draft: false,\n    })),\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFunction, isBoolean } from 'lodash-es';\n\nimport { valueExpressionValidator } from '@/form-extensions/validators';\n\ninterface Options {\n  /** Required also supports functional formal verification */\n  required?: boolean | ((validateProps) => boolean);\n  emptyErrorMessage?: string;\n  skipValidate?: ({ value, formValues }) => boolean;\n}\n\nexport const createValueExpressionInputValidate =\n  ({ required, emptyErrorMessage, skipValidate }: Options) =>\n  ({ name, value, formValues, context }) => {\n    const { playgroundContext, node } = context;\n    let computeRequired = false;\n\n    if (skipValidate?.({ value, formValues })) {\n      return;\n    }\n\n    if (isBoolean(required)) {\n      computeRequired = required;\n    }\n\n    if (isFunction(required)) {\n      computeRequired = required({ name, value, formValues, context });\n    }\n\n    return valueExpressionValidator({\n      value,\n      playgroundContext,\n      node,\n      required: computeRequired,\n      emptyErrorMessage,\n    });\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  DataEvent,\n  type EffectOptions,\n  type Effect,\n} from '@flowgram-adapter/free-layout-editor';\nconst effect: Effect = ({ context }) => {\n  if (!context) {\n    return;\n  }\n  context.playgroundContext.nodesService.fireNodesTitleChange();\n};\nexport const fireNodeTitleChange: EffectOptions[] = [\n  {\n    event: DataEvent.onValueChange,\n    effect,\n  },\n  {\n    event: DataEvent.onValueInit,\n    effect,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport { nodeMetaValidator } from '@coze-workflow/nodes';\n\n/**\n * Node meta check\n * @param param0\n * @returns\n */\nexport const nodeMetaValidate: Validate = ({ value, context }) => {\n  const res = nodeMetaValidator({\n    value,\n    context,\n    options: {},\n  });\n\n  if (res === true) {\n    return;\n  }\n\n  return res;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport {\n  FlowNodeVariableData,\n  ASTKind,\n  type Effect,\n  DataEvent,\n} from '@flowgram-adapter/free-layout-editor';\nimport { parseNodeBatchByInputList } from '@coze-workflow/variable';\nfunction createEffect(\n  batchModePath: string,\n  batchInputListPath: string,\n): Effect {\n  return ({ formValues, context }) => {\n    const batchMode = get(formValues, batchModePath);\n    const batch = get(formValues, batchInputListPath);\n\n    const { node } = context || {};\n\n    if (!node) {\n      return;\n    }\n\n    const variableData: FlowNodeVariableData =\n      node.getData(FlowNodeVariableData);\n\n    if (!variableData.private) {\n      variableData.initPrivate();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const scope = variableData.private!;\n\n    const declarations =\n      batchMode === 'batch' ? parseNodeBatchByInputList(node.id, batch) : [];\n    scope.ast.set('/node/locals', {\n      kind: ASTKind.VariableDeclarationList,\n      declarations,\n    });\n  };\n}\n\nexport function createProvideNodeBatchVariables(\n  batchModePath: string,\n  batchInputListPath: string,\n) {\n  return [\n    {\n      effect: createEffect(batchModePath, batchInputListPath),\n      event: DataEvent.onValueChange,\n    },\n    {\n      effect: createEffect(batchModePath, batchInputListPath),\n      event: DataEvent.onValueInit,\n    },\n  ];\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FlowNodeVariableData,\n  ASTKind,\n  type Effect,\n  DataEvent,\n} from '@flowgram-adapter/free-layout-editor';\nimport { parseNodeOutputByViewVariableMeta } from '@coze-workflow/variable';\nfunction createEffect(): Effect {\n  return ({ value, context }) => {\n    if (!context) {\n      return;\n    }\n    const { node } = context;\n    const variableData: FlowNodeVariableData =\n      node.getData(FlowNodeVariableData);\n    const scope = variableData.public;\n    const declarations = parseNodeOutputByViewVariableMeta(node.id, value);\n\n    scope.ast.set('/node/outputs', {\n      kind: ASTKind.VariableDeclarationList,\n      declarations,\n    });\n  };\n}\n\nexport const provideNodeOutputVariablesEffect = [\n  {\n    effect: createEffect(),\n    event: DataEvent.onValueChange,\n  },\n  {\n    effect: createEffect(),\n    event: DataEvent.onValueInit,\n  },\n];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Validate } from '@flowgram-adapter/free-layout-editor';\nimport { settingOnErrorValidator } from '@coze-workflow/nodes';\n\n/**\n * exception setting check\n * @param param0\n * @returns\n */\nexport const settingOnErrorValidate: Validate = ({ value, context }) => {\n  const res = settingOnErrorValidator({\n    value,\n    context,\n    options: {},\n  });\n\n  if (res === true) {\n    return;\n  }\n\n  return res;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeResult } from '@coze-workflow/base';\nimport { logger } from '@coze-arch/logger';\n\ninterface Extra {\n  response_extra: { variable_select: number[] };\n}\n\n/**\n * Determine whether it is an output variable according to the execution result\n * @param ref\n * @param result\n * @returns\n */\nexport function isOutputVariable(\n  groupIndex: number,\n  variableIndex: number,\n  result: NodeResult | undefined,\n): boolean {\n  if (!result || !result.extra) {\n    return false;\n  }\n\n  try {\n    const extra = JSON.parse(result.extra) as Extra;\n\n    if (!extra?.response_extra?.variable_select) {\n      return false;\n    }\n\n    return extra.response_extra.variable_select[groupIndex] === variableIndex;\n  } catch (error) {\n    logger.error(error);\n  }\n\n  return !!result;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type WorkflowDocumentOptions,\n  type WorkflowLineEntity,\n  type WorkflowPortEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base/types';\n\nimport {\n  WorkflowLinesServiceProvider,\n  type WorkflowLinesService,\n} from '../services/workflow-line-service';\n\n@injectable()\nexport class WorkflowDocumentCustomOptions implements WorkflowDocumentOptions {\n  @inject(WorkflowLinesServiceProvider)\n  linesServiceProvider: () => WorkflowLinesService;\n\n  // copy form packages/workflow-sdk/core/src/workflow-document-container-module.ts\n  cursors: {\n    grab: 'url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMCAyMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMC40ODczIDIuNjIzNzhDOS45MDczMSAyLjYyMzc4IDkuNDM3MTMgMy4wOTM5NiA5LjQzNzEzIDMuNjczOTZWNS4xNDM3NkM5LjM5NDI4IDQuNDAyNzQgOC43Nzk3OCAzLjgxNTA0IDguMDI4MDIgMy44MTUwNEM3LjI0ODQ4IDMuODE1MDQgNi42MTY1MyA0LjQ0Njk5IDYuNjE2NTMgNS4yMjY1M1YxMS44Mjg5TDUuNjc0MTggMTEuMDA0OUM1LjE1NDg3IDEwLjU1MDkgNC40MDk1IDEwLjQ2MzYgMy43OTkzOCAxMC43ODU1TDMuNjk2OTQgMTAuODM5NkMzLjA2MjE3IDExLjE3NDUgMi45MjI2IDEyLjAyMjggMy40MTY2MiAxMi41NDM0TDcuMzM5NTkgMTYuNjc3NVYxNy4zMjU5QzcuMzM5NTkgMTcuNzg2MiA3LjcxMjY5IDE4LjE1OTMgOC4xNzI5MiAxOC4xNTkzSDEzLjgwODRDMTQuMjY4NyAxOC4xNTkzIDE0LjY0MTcgMTcuNzg2MiAxNC42NDE3IDE3LjMyNTlWMTYuNzkzNUMxNS44MDk0IDE1LjY0ODUgMTYuNDY3MyAxNC4wODE5IDE2LjQ2NzMgMTIuNDQ2NVYxMS40OTY3TDE2LjQ2NzEgNi42MzY4NUMxNi40NjcxIDUuOTU2MyAxNS45MTU0IDUuNDA0NjEgMTUuMjM0OCA1LjQwNDYxQzE0LjU1NDMgNS40MDQ2MSAxNC4wMDI2IDUuOTU2MyAxNC4wMDI2IDYuNjM2ODVMMTQuMDAyMSA1LjA0NzI4QzE0LjAwMjEgNC4zNjY3MyAxMy40NTA0IDMuODE1MDQgMTIuNzY5OCAzLjgxNTA0QzEyLjA4OTMgMy44MTUwNCAxMS41Mzc2IDQuMzY2NzMgMTEuNTM3NiA1LjA0NzI4TDExLjUzNzUgMy42NzM5NUMxMS41Mzc1IDMuMDkzOTYgMTEuMDY3MyAyLjYyMzc4IDEwLjQ4NzMgMi42MjM3OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNDg3NCAxLjM3NDAyQzExLjM2MTIgMS4zNzQwMiAxMi4xMjExIDEuODYxMTggMTIuNTEwNSAyLjU3ODY4QzEyLjU5NTggMi41Njk4MyAxMi42ODIzIDIuNTY1MjggMTIuNzcgMi41NjUyOEMxMy44Mjc4IDIuNTY1MjggMTQuNzMxMSAzLjIyNzAxIDE1LjA4ODUgNC4xNTkxMUMxNS4xMzcgNC4xNTYyOSAxNS4xODU4IDQuMTU0ODYgMTUuMjM1IDQuMTU0ODZDMTYuNjA1OSA0LjE1NDg2IDE3LjcxNzIgNS4yNjYxOSAxNy43MTcyIDYuNjM3MDlMMTcuNzE3NCAxMi40NDY3QzE3LjcxNzQgMTQuMjM1NSAxNy4wNjQ0IDE1Ljk1NTkgMTUuODkxOSAxNy4yOTA0VjE3LjMyNjJDMTUuODkxOSAxOC40NzY4IDE0Ljk1OTEgMTkuNDA5NSAxMy44MDg1IDE5LjQwOTVIOC4xNzMwNkM3LjAyMjQ3IDE5LjQwOTUgNi4wODk3MyAxOC40NzY4IDYuMDg5NzMgMTcuMzI2MlYxNy4xNzY0TDIuNTEwMDMgMTMuNDA0MUMxLjQ0NTk5IDEyLjI4MjggMS43NDY2IDEwLjQ1NTUgMy4xMTM3OSA5LjczNDI0TDMuMjE2MjQgOS42ODAxOUMzLjg5MTY4IDkuMzIzODMgNC42NjE4NSA5LjI1NDAxIDUuMzY2NjYgOS40NTE5OFY1LjIyNjc4QzUuMzY2NjYgMy43NTY4NyA2LjU1ODI2IDIuNTY1MjggOC4wMjgxNiAyLjU2NTI4QzguMTcyOTMgMi41NjUyOCA4LjMxNDk5IDIuNTc2ODQgOC40NTM0NyAyLjU5OTA3QzguODM5NDMgMS44NzA0MiA5LjYwNTQ2IDEuMzc0MDIgMTAuNDg3NCAxLjM3NDAyWk0xMi40NDc2IDMuODU3ODdWOS40NzY0NkMxMi40NDc2IDkuNzI4NTIgMTIuMjQzMyA5LjkzMjg1IDExLjk5MTMgOS45MzI4NUMxMS43MzkyIDkuOTMyODUgMTEuNTM0OSA5LjcyODUyIDExLjUzNDkgOS40NzY0NlYzLjc5NjU1QzExLjUzNDkgMy43Nzk1NiAxMS41MzU4IDMuNzYyNzcgMTEuNTM3NiAzLjc0NjI2VjMuNjc0MkMxMS41Mzc2IDMuNDMyODIgMTEuNDU2MiAzLjIxMDQ2IDExLjMxOTMgMy4wMzMwOUMxMS4xMjcyIDIuNzg0MjggMTAuODI2MSAyLjYyNDAyIDEwLjQ4NzQgMi42MjQwMkMxMC4xMjM4IDIuNjI0MDIgOS44MDMzMiAyLjgwODg2IDkuNjE0ODMgMy4wODk3QzkuNTAyNjkgMy4yNTY3OSA5LjQzNzI2IDMuNDU3ODUgOS40MzcyNiAzLjY3NDJWMy43ODU3M0M5LjQzNzM1IDMuNzg5MzMgOS40MzczOSAzLjc5Mjk0IDkuNDM3MzkgMy43OTY1NVY5LjkwMTdDOS40MzczOSAxMC4xNTM3IDkuMjMzMDYgMTAuMzU4MSA4Ljk4MTAxIDEwLjM1ODFDOC43Mjg5NSAxMC4zNTgxIDguNTI0NjIgMTAuMTUzNyA4LjUyNDYyIDkuOTAxN1YzLjkwNTA3QzguNDE3NzMgMy44NjQ5IDguMzA0NjggMy44MzczMiA4LjE4NzI2IDMuODI0MTVDOC4xMzUwNCAzLjgxODI5IDguMDgxOTUgMy44MTUyOCA4LjAyODE2IDMuODE1MjhDNy4yNDg2MSAzLjgxNTI4IDYuNjE2NjYgNC40NDcyMyA2LjYxNjY2IDUuMjI2NzhWMTEuODI5Mkw1LjY3NDMxIDExLjAwNTJDNS41Nzg2OCAxMC45MjE2IDUuNDc1MzcgMTAuODUwNCA1LjM2NjY2IDEwLjc5MTlDNC44ODUwNiAxMC41MzI5IDQuMjk3MjggMTAuNTIzMSAzLjc5OTUyIDEwLjc4NThMMy42OTcwNyAxMC44Mzk4QzMuMDYyMzEgMTEuMTc0NyAyLjkyMjczIDEyLjAyMzEgMy40MTY3NSAxMi41NDM3TDcuMzM5NzMgMTYuNjc3N1YxNy4zMjYyQzcuMzM5NzMgMTcuNzg2NCA3LjcxMjgyIDE4LjE1OTUgOC4xNzMwNiAxOC4xNTk1SDEzLjgwODVDMTQuMjY4OCAxOC4xNTk1IDE0LjY0MTkgMTcuNzg2NCAxNC42NDE5IDE3LjMyNjJWMTYuNzkzOEMxNS43Mzc5IDE1LjcxOSAxNi4zODQ3IDE0LjI3MjggMTYuNDYgMTIuNzQ3QzE2LjQ2NDEgMTIuNjY0MSAxNi40NjY1IDEyLjU4MDkgMTYuNDY3MiAxMi40OTc1TDE2LjQ2NzQgMTIuNDQ2N0wxNi40NjcyIDYuNjM3MDlDMTYuNDY3MiA1Ljk2MjMgMTUuOTI0OCA1LjQxNDE5IDE1LjI1MjIgNS40MDQ5N0wxNS4yMzUgNS40MDQ4NkMxNS4xMjQ2IDUuNDA0ODYgMTUuMDE3NyA1LjQxOTM2IDE0LjkxNTkgNS40NDY1NlY5LjYwMjI2QzE0LjkxNTkgOS44NTQzMSAxNC43MTE2IDEwLjA1ODYgMTQuNDU5NSAxMC4wNTg2QzE0LjIwNzUgMTAuMDU4NiAxNC4wMDMxIDkuODU0MzEgMTQuMDAzMSA5LjYwMjI2VjYuNjA1MTRDMTQuMDAyOSA2LjYxNTc2IDE0LjAwMjcgNi42MjY0MSAxNC4wMDI3IDYuNjM3MDlWOS4yNzcwNUwxNC4wMDIyIDUuMDQ3NTJDMTQuMDAyMiA0Ljg2OTEzIDEzLjk2NDMgNC42OTk2IDEzLjg5NjEgNC41NDY1M0MxMy43MDY0IDQuMTIwNzIgMTMuMjgyMiAzLjgyMjM1IDEyLjc4NzYgMy44MTU0MUwxMi43NyAzLjgxNTI4QzEyLjY1ODQgMy44MTUyOCAxMi41NTA0IDMuODMwMSAxMi40NDc2IDMuODU3ODdaIiBmaWxsPSIjMUQxQzIzIi8+Cjwvc3ZnPg==\"), auto';\n    grabbing: 'url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMCAyMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjYxODE3IDUuNTk4NzVDNi42MTgxNyA0LjgxOTIgNy4yNTAxMiA0LjE4NzI2IDguMDI5NjcgNC4xODcyNkM4Ljc3ODczIDQuMTg3MjYgOS4zOTE1MiA0Ljc3MDc1IDkuNDM4MjkgNS41MDgwMUM5LjQ1OTkyIDQuOTQ3MSA5LjkyMTQ3IDQuNDk5MDIgMTAuNDg3NyA0LjQ5OTAyQzExLjA2NzcgNC40OTkwMiAxMS41Mzc4IDQuOTY5MiAxMS41Mzc4IDUuNTQ5MTlWOC43NjI0NkwxMS41Mzc5IDYuNzExNUMxMS41Mzc5IDYuMDMwOTUgMTIuMDg5NiA1LjQ3OTI2IDEyLjc3MDIgNS40NzkyNkMxMy40NTA3IDUuNDc5MjYgMTQuMDAyNCA2LjAzMDk1IDE0LjAwMjQgNi43MTE1TDE0LjAwMjQgOC43NjI0NkwxNC4wMDI5IDguMDE5ODNDMTQuMDAyOSA3LjMzOTI5IDE0LjU1NDYgNi43ODc1OSAxNS4yMzUyIDYuNzg3NTlDMTUuOTE1NyA2Ljc4NzU5IDE2LjQ2NzQgNy4zMzkyOCAxNi40Njc0IDguMDE5ODNWMTEuNDk3TDE2LjQ2NzUgMTIuNDQ2N0MxNi40Njc1IDE0LjA4MjEgMTUuODA5NiAxNS42NDg3IDE0LjY0MiAxNi43OTM4VjE3LjMyNjJDMTQuNjQyIDE3Ljc4NjQgMTQuMjY4OSAxOC4xNTk1IDEzLjgwODcgMTguMTU5NUg4LjE3MzE3QzcuNzEyOTMgMTguMTU5NSA3LjMzOTg0IDE3Ljc4NjQgNy4zMzk4NCAxNy4zMjYyVjE1Ljk0MjRMNS4zNDU2MiAxNC43NTM0QzQuNTg5MjQgMTQuMzAyNCA0LjEyNTkxIDEzLjQ4NjcgNC4xMjU4OSAxMi42MDYxTDQuMTI1ODMgOS4yODM4M0M0LjEyNTgyIDguOTU0MjcgNC4zMjAwMyA4LjY1NTY2IDQuNjIxMjkgOC41MjIwNUw2LjYxODE3IDcuNjM2MzRWNS41OTg3NVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNDg3OCAzLjI0OTAyQzExLjI3OTYgMy4yNDkwMiAxMS45Nzc4IDMuNjQ5MDIgMTIuMzkxNyA0LjI1Nzk2QzEyLjUxNTEgNC4yMzkwNiAxMi42NDE2IDQuMjI5MjYgMTIuNzcwMyA0LjIyOTI2QzEzLjcyMjQgNC4yMjkyNiAxNC41NDkzIDQuNzY1MzEgMTQuOTY1NyA1LjU1MjA3QzE1LjA1NDMgNS41NDI1IDE1LjE0NDIgNS41Mzc1OSAxNS4yMzUzIDUuNTM3NTlDMTYuNjA2MiA1LjUzNzU5IDE3LjcxNzYgNi42NDg5MyAxNy43MTc2IDguMDE5ODNMMTcuNzE3NyAxMi40NDY3QzE3LjcxNzcgMTQuMjM1NSAxNy4wNjQ3IDE1Ljk1NTkgMTUuODkyMSAxNy4yOTA0VjE3LjMyNjJDMTUuODkyMSAxOC40NzY4IDE0Ljk1OTQgMTkuNDA5NSAxMy44MDg4IDE5LjQwOTVIOC4xNzMzMkM3LjAyMjczIDE5LjQwOTUgNi4wODk5OCAxOC40NzY4IDYuMDg5OTggMTcuMzI2MlYxNi42NTI0TDQuNzA1NjMgMTUuODI3QzMuNTcxMDYgMTUuMTUwNSAyLjg3NjA3IDEzLjkyNzEgMi44NzYwNCAxMi42MDYxTDIuODc1OTggOS4yODM4NUMyLjg3NTk2IDguNDU5OTYgMy4zNjE0OSA3LjcxMzQ1IDQuMTE0NjIgNy4zNzk0TDUuMzY4MzIgNi44MjMzM1Y1LjU5ODc1QzUuMzY4MzIgNC4xMjg4NSA2LjU1OTkxIDIuOTM3MjYgOC4wMjk4MiAyLjkzNzI2QzguNjA4MzEgMi45MzcyNiA5LjE0MzU1IDMuMTIxNyA5LjU4MDA1IDMuNDM1MDVDOS44NTg1MyAzLjMxNTMyIDEwLjE2NTQgMy4yNDkwMiAxMC40ODc4IDMuMjQ5MDJaTTEyLjQ0NzkgNS41MjE4NlY5LjQ3NTU3QzEyLjQ0NzkgOS43Mjc2MiAxMi4yNDM2IDkuOTMxOTUgMTEuOTkxNiA5LjkzMTk1QzExLjc1NjggOS45MzE5NSAxMS41NjM0IDkuNzU0NjUgMTEuNTM4IDkuNTI2NjNDMTEuNTM2MSA5LjUwOTg3IDExLjUzNTIgOS40OTI4MyAxMS41MzUyIDkuNDc1NTdWNS40NzE1OEMxMS41MTU0IDUuMjAwODMgMTEuMzkzIDQuOTU4NTggMTEuMjA2NiA0Ljc4MzU4QzExLjAxODggNC42MDcxMSAxMC43NjU5IDQuNDk5MDIgMTAuNDg3OCA0LjQ5OTAyQzEwLjQ3NjYgNC40OTkwMiAxMC40NjU0IDQuNDk5MTkgMTAuNDU0MiA0LjQ5OTU0QzkuOTAzNDcgNC41MTY4NCA5LjQ1OTY0IDQuOTU4MjQgOS40Mzg0NCA1LjUwODAxQzkuNDM4MiA1LjUwNDMgOS40Mzc5NSA1LjUwMDU4IDkuNDM3NjkgNS40OTY4OFY5LjkwMjQzQzkuNDM3NjkgMTAuMTU0NSA5LjIzMzM2IDEwLjM1ODggOC45ODEzMSAxMC4zNTg4QzguNzI5MjUgMTAuMzU4OCA4LjUyNDkyIDEwLjE1NDUgOC41MjQ5MiA5LjkwMjQzVjQuMjc2NTNDOC4zNzA4NiA0LjIxODgyIDguMjA0MDIgNC4xODcyNiA4LjAyOTgyIDQuMTg3MjZDNy4yNTAyNyA0LjE4NzI2IDYuNjE4MzIgNC44MTkyIDYuNjE4MzIgNS41OTg3NUw2LjYxODI3IDkuOTc1OTlDNi42MTgyNyAxMC4yMjggNi40MTM5NCAxMC40MzI0IDYuMTYxODkgMTAuNDMyNEM1LjkwOTgzIDEwLjQzMjQgNS43MDU1IDEwLjIyOCA1LjcwNTUgOS45NzU5OVY4LjA0MTIyTDQuNjIxNDQgOC41MjIwNUM0LjMyMDE4IDguNjU1NjYgNC4xMjU5NyA4Ljk1NDI3IDQuMTI1OTggOS4yODM4M0w0LjEyNjA0IDEyLjYwNjFDNC4xMjYwNiAxMy40ODY3IDQuNTg5MzkgMTQuMzAyNCA1LjM0NTc2IDE0Ljc1MzRMNy4zMzk5OCAxNS45NDI0VjE3LjMyNjJDNy4zMzk5OCAxNy43ODY0IDcuNzEzMDggMTguMTU5NSA4LjE3MzMyIDE4LjE1OTVIMTMuODA4OEMxNC4yNjkgMTguMTU5NSAxNC42NDIxIDE3Ljc4NjQgMTQuNjQyMSAxNy4zMjYyVjE2Ljc5MzhDMTUuNzM4MSAxNS43MTkgMTYuMzg1IDE0LjI3MjggMTYuNDYwMyAxMi43NDdDMTYuNDY0NiAxMi42NiAxNi40NjcgMTIuNTcyOCAxNi40Njc2IDEyLjQ4NTRMMTYuNDY3NyAxMi40NDY3TDE2LjQ2NzYgOC4wMTk4M0MxNi40Njc2IDcuMzQ1MDQgMTUuOTI1MiA2Ljc5NjkzIDE1LjI1MjUgNi43ODc3MUwxNS4yMzUzIDYuNzg3NTlDMTUuMTI1IDYuNzg3NTkgMTUuMDE4IDYuODAyMSAxNC45MTYyIDYuODI5MzFWOS42MDEzNkMxNC45MTYyIDkuODUzNDIgMTQuNzExOSAxMC4wNTc3IDE0LjQ1OTggMTAuMDU3N0MxNC4yMDc4IDEwLjA1NzcgMTQuMDAzNCA5Ljg1MzQxIDE0LjAwMzQgOS42MDEzNlY3Ljk4OTg1QzE0LjAwMzIgNy45OTk4MiAxNC4wMDMxIDguMDA5ODEgMTQuMDAzMSA4LjAxOTgzTDE0LjAwMzQgOS42MDEzNkwxNC4wMDI1IDYuNzExNUMxNC4wMDI1IDYuNDQ5NzQgMTMuOTIwOSA2LjIwNzA1IDEzLjc4MTggNi4wMDc0OEMxMy41NjIgNS42OTI0MiAxMy4xOTg5IDUuNDg0ODMgMTIuNzg3IDUuNDc5MzdMMTIuNzcwMyA1LjQ3OTI2QzEyLjY1ODggNS40NzkyNiAxMi41NTA3IDUuNDk0MDggMTIuNDQ3OSA1LjUyMTg2WiIgZmlsbD0iIzFEMUMyMyIvPgo8L3N2Zz4=\"), auto';\n  };\n\n  /** Is there an error in the connection? */\n  isErrorLine(\n    fromPort?: WorkflowPortEntity,\n    toPort?: WorkflowPortEntity,\n  ): boolean {\n    const linesService = this.linesServiceProvider();\n    return linesService.isError(fromPort?.node?.id, toPort?.node?.id);\n  }\n\n  /** Are the lines vertical? */\n  isVerticalLine(line: WorkflowLineEntity): boolean {\n    return this.isSubCanvasLinkLine(line);\n  }\n\n  /** Does the line hide the arrow? */\n  isHideArrowLine(line: WorkflowLineEntity): boolean {\n    return this.isSubCanvasLinkLine(line);\n  }\n\n  /** Is the line disabled? */\n  isDisabledLine(line: WorkflowLineEntity): boolean {\n    return this.isSubCanvasLinkLine(line);\n  }\n\n  /** Can lines be deleted? */\n  canDeleteLine(line: WorkflowLineEntity): boolean {\n    if (\n      line.from?.flowNodeType === StandardNodeType.Loop &&\n      line.to?.flowNodeType === FlowNodeBaseType.SUB_CANVAS\n    ) {\n      return false;\n    }\n    if (\n      line.from?.flowNodeType === StandardNodeType.Batch &&\n      line.to?.flowNodeType === FlowNodeBaseType.SUB_CANVAS\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  /** Are the two ports allowed to connect? */\n  // eslint-disable-next-line complexity -- TODO configuration move to node\n  canAddLine(\n    fromPort: WorkflowPortEntity,\n    toPort: WorkflowPortEntity,\n  ): boolean {\n    // Cannot be the same node self-looping\n    if (fromPort.node === toPort.node) {\n      return false;\n    }\n    if (toPort.node.flowNodeType === StandardNodeType.Comment) {\n      return false;\n    }\n    // Child canvas nodes connect to sub-nodes\n    if (\n      (fromPort.node.flowNodeType === FlowNodeBaseType.SUB_CANVAS &&\n        fromPort.node === toPort.node.parent) ||\n      (toPort.node.flowNodeType === FlowNodeBaseType.SUB_CANVAS &&\n        toPort.node === fromPort.node.parent)\n    ) {\n      return true;\n    }\n    // Loop and loopFunction connections cannot be changed\n    if (\n      toPort.portID === 'loop-function-inline-input' ||\n      fromPort.portID === 'loop-function-inline-output' ||\n      fromPort.portID === 'loop-output-to-function'\n    ) {\n      return false;\n    }\n    if (\n      toPort.portID === 'batch-function-inline-input' ||\n      fromPort.portID === 'batch-function-inline-output' ||\n      fromPort.portID === 'batch-output-to-function'\n    ) {\n      return false;\n    }\n    // Not in different containers\n    if (fromPort.node.parent?.id !== toPort.node.parent?.id) {\n      return false;\n    }\n    // Unable to connect to wrong port\n    if (\n      fromPort.node.flowNodeType === 'error' ||\n      toPort.node.flowNodeType === 'error'\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  private isSubCanvasLinkLine(line: WorkflowLineEntity): boolean {\n    if (\n      line.fromPort.portID === 'loop-output-to-function' &&\n      line.toPort?.portID === 'loop-function-input'\n    ) {\n      return true;\n    }\n    if (\n      line.fromPort.portID === 'batch-output-to-function' &&\n      line.toPort?.portID === 'batch-function-input'\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  allNodesDefaultExpanded = false;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type ConditionOperator } from '@coze-workflow/base';\nexport abstract class DatabaseNodeService {\n  /**\n   * Converts a database settings field to a database settings field DTO.\n   * @Param name Name of database settings field DTO\n   * @Param value entire form data\n   */\n  abstract convertSettingFieldToDTO(\n    name: string,\n    value: any,\n    node: FlowNodeEntity,\n  ): any;\n  /**\n   * Converts the database settings field DTO to a database settings field.\n   * @Param name Name of database settings field DTO\n   * @Param value entire form data\n   */\n  abstract convertSettingFieldDTOToField(name: string, value: any): any;\n  /**\n   * Converts a conditional DTO in a form to a condition\n   * @param name name of conditional DTO\n   * @Param value entire form data\n   */\n  abstract convertConditionDTOToCondition(name: string, value: any): any;\n\n  /**\n   * Converts conditional logic DTO to conditional logic.\n   * @param name name of conditional logic DTO\n   * @Param value The value of the conditional logic DTO\n   * @Returns value of entire form data\n   */\n  abstract convertConditionLogicDTOToConditionLogic(\n    name: string,\n    value: any,\n  ): any;\n\n  /**\n   * Convert conditional logic to conditional logic DTO.\n   * @param name name of conditional logic\n   * @param value value of conditional logic\n   * @Returns value of entire form data\n   */\n  abstract convertConditionLogicToConditionLogicDTO(\n    name: string,\n    value: any,\n  ): any;\n\n  /**\n   * Convert Condition to Conditional DTO\n   * @param name The name of the condition\n   * @Param value entire form data\n   */\n  abstract convertConditionToDTO(\n    name: string,\n    value: any,\n    node: FlowNodeEntity,\n  ): any;\n\n  /**\n   * Determine whether the current condition does not require an rvalue\n   * @param condition Current condition data\n   * @Returns true if the condition does not require an lvalue, false otherwise\n   */\n  abstract checkConditionOperatorNoNeedRight(\n    conditionOperator?: ConditionOperator,\n  ): boolean;\n\n  abstract store: any;\n\n  /**\n   * Query the current database data\n   */\n  abstract load(id: string): void;\n\n  /**\n   * Error messages for clearing the database cache\n   */\n  abstract clearDatabaseError(id: string): void;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { set } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport {\n  FlowNodeFormData,\n  type FormModelV2,\n} from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport { PlaygroundConfigEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  type WorkflowNodeMeta,\n  WorkflowSelectService,\n  getAntiOverlapPosition,\n  type WorkflowNodeEntity,\n  type WorkflowNodeJSON,\n  type WorkflowNodeRegistry,\n  type WorkflowSubCanvas,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type IPoint } from '@flowgram-adapter/common';\nimport { WorkflowNodesService } from '@coze-workflow/nodes';\nimport { StandardNodeType, reporter } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Modal } from '@coze-arch/bot-semi';\nimport { handlePluginRiskWarning } from '@coze-agent-ide/plugin-risk-warning';\n\nimport { WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { getNodeV2Registry, isNodeV2 } from '@/nodes-v2';\nimport { LayoutPanelKey } from '@/constants';\n\nimport { WorkflowGlobalStateEntity } from '../entities';\nimport { WorkflowFloatLayoutService } from './workflow-float-layout-service';\nimport { WorkflowCustomDragService } from './workflow-drag-service';\n\n/**\n * Invoke the canvas editing service\n */\n@injectable()\nexport class WorkflowEditService {\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowCustomDragService)\n  readonly dragService: WorkflowCustomDragService;\n  @inject(WorkflowGlobalStateEntity) workflowState: WorkflowGlobalStateEntity;\n  @inject(WorkflowDocument) protected workflowDocument: WorkflowDocument;\n  @inject(WorkflowSelectService) protected selectService: WorkflowSelectService;\n  @inject(WorkflowNodesService) protected nodesService: WorkflowNodesService;\n  @inject(PlaygroundConfigEntity)\n  protected playgroundConfig: PlaygroundConfigEntity;\n  @inject(WorkflowFloatLayoutService)\n  protected floatLayoutService: WorkflowFloatLayoutService;\n  @inject(WorkflowPlaygroundContext)\n  protected context: WorkflowPlaygroundContext;\n\n  /**\n   * Create Node\n   * @param type\n   * @param nodeJson\n   * @param event\n   */\n  // eslint-disable-next-line max-params\n  addNode = async (\n    type: StandardNodeType,\n    nodeJson?: Partial<WorkflowNodeJSON>,\n    event?: { clientX: number; clientY: number },\n    isDrag?: boolean,\n  ): Promise<WorkflowNodeEntity | undefined> => {\n    if (this.globalState.readonly) {\n      return;\n    }\n    if (type === StandardNodeType.Api) {\n      handlePluginRiskWarning();\n    }\n    let dragNode: WorkflowNodeEntity | undefined;\n    // create uniq title\n    if (nodeJson && nodeJson.data.nodeMeta.title) {\n      nodeJson.data.nodeMeta.title = this.nodesService.createUniqTitle(\n        nodeJson.data.nodeMeta.title,\n      );\n    }\n\n    if (!event) {\n      // exception handling\n      this.dragService.endDrag();\n      return;\n    }\n\n    try {\n      // node initialization logic\n      const nodeV2Registry = getNodeV2Registry(type);\n      await nodeV2Registry?.onInit?.(\n        nodeJson as WorkflowNodeJSON,\n        this.context,\n      );\n    } catch (error) {\n      reporter.errorEvent({\n        eventName: 'workflow_registry_v2_on_init_error',\n        namespace: 'workflow',\n        error,\n      });\n    }\n\n    if (isDrag) {\n      // Drag and drop to generate nodes\n      dragNode = await this.dragService.dropCard(\n        type,\n        event,\n        nodeJson,\n        this.dragService.state.dropNode,\n      );\n    } else {\n      // @Deprecated The logic here cannot run here at present, you can consider deleting it later.\n      let position: IPoint;\n      const nodeMeta =\n        this.workflowDocument.getNodeRegister<WorkflowNodeRegistry>(type).meta;\n      const { width } = nodeMeta?.size || { width: 0, height: 0 };\n      position = this.playgroundConfig.getPosFromMouseEvent(event);\n      position = getAntiOverlapPosition(this.workflowDocument, {\n        // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n        x: position.x + width / 2,\n        y: position.y,\n      });\n      const dropNode = this.getDropNode();\n      const { allowDrop } = this.dragService.canDropToNode({\n        dragNodeType: type,\n        dropNode,\n      });\n      if (!allowDrop) {\n        return;\n      }\n      if (dropNode && dropNode.flowNodeType !== FlowNodeBaseType.ROOT) {\n        const childrenLength = dropNode.collapsedChildren.length;\n        const dropNodePadding =\n          this.workflowDocument.layout.getPadding(dropNode);\n        position = {\n          x: dropNodePadding.left + childrenLength * 30,\n          y: dropNodePadding.top + childrenLength * 30,\n        };\n      }\n      dragNode = await this.workflowDocument.createWorkflowNodeByType(\n        type,\n        position as IPoint,\n        nodeJson,\n        dropNode.id,\n      );\n    }\n    this.dragService.endDrag();\n    if (dragNode) {\n      this.focusNode(dragNode);\n    }\n    return dragNode;\n  };\n\n  private getDropNode(): WorkflowNodeEntity {\n    const { activatedNode } = this.selectService;\n    if (!activatedNode) {\n      return this.workflowDocument.root;\n    }\n    const linageNodes: WorkflowNodeEntity[] = [];\n    let currentNode: WorkflowNodeEntity | undefined = activatedNode;\n    while (currentNode) {\n      linageNodes.push(currentNode);\n      currentNode = currentNode.parent;\n    }\n    return (\n      linageNodes.find(\n        n =>\n          [FlowNodeBaseType.ROOT, FlowNodeBaseType.SUB_CANVAS].includes(\n            n.flowNodeType as FlowNodeBaseType,\n          ) || n.getNodeMeta<WorkflowNodeMeta>().isContainer,\n      ) ?? this.workflowDocument.root\n    );\n  }\n\n  /**\n   * copy node\n   * @param node\n   */\n  copyNode = async (node: WorkflowNodeEntity): Promise<WorkflowNodeEntity> => {\n    const json = await this.workflowDocument.toNodeJSON(node);\n    const position = {\n      x: json.meta!.position!.x + 30,\n      y: json.meta!.position!.y + 30,\n    };\n    const newNode = await this.workflowDocument.copyNodeFromJSON(\n      json.type as string,\n      this.recreateNodeJSON(json),\n      '',\n      position,\n      node.parent?.id,\n    );\n    const subCanvas: WorkflowSubCanvas = newNode\n      .getNodeMeta()\n      ?.subCanvas?.(newNode);\n    if (subCanvas?.canvasNode) {\n      this.selectService.selection = [newNode, subCanvas.canvasNode];\n    } else {\n      this.focusNode(newNode);\n    }\n    return newNode;\n  };\n\n  /**\n   * Delete lines\n   */\n  deleteNode = (node: WorkflowNodeEntity, noConfirm?: boolean) => {\n    if (noConfirm) {\n      this.disposeNode(node);\n    } else {\n      Modal.error({\n        // closable: false,\n        title: I18n.t('workflow_detail_select_delete_popup_title'),\n        content: I18n.t('workflow_detail_select_delete_popup_subtitle'),\n        onOk: () => this.disposeNode(node),\n        okText: I18n.t('workflow_add_delete'),\n        cancelText: I18n.t('Cancel'),\n      });\n    }\n  };\n\n  /**\n   * Before destroying the node, run the node's custom onDispose method\n   * @param node\n   */\n  private disposeNode(node: WorkflowNodeEntity) {\n    if (isNodeV2(node)) {\n      const formModel = node\n        .getData<FlowNodeFormData>(FlowNodeFormData)\n        .getFormModel<FormModelV2>();\n\n      node.getNodeRegister()?.onDispose?.(formModel.getValues(), this.context);\n    }\n\n    node.dispose();\n  }\n\n  recreateNodeJSON(\n    nodeJSON: WorkflowNodeJSON,\n    titleCache: string[] = [],\n    shouldReplaceId = true,\n  ): WorkflowNodeJSON {\n    // Override ID\n    if (shouldReplaceId) {\n      nodeJSON.id = this.nodesService.createUniqID();\n    }\n    // Override title\n    if (nodeJSON.data?.nodeMeta?.title) {\n      set(\n        nodeJSON,\n        'data.nodeMeta.title',\n        this.nodesService.createUniqTitle(\n          nodeJSON.data.nodeMeta.title,\n          undefined,\n          titleCache,\n        ),\n      );\n      titleCache.push(nodeJSON.data.nodeMeta.title);\n    }\n    // Recursive processing of sub-nodes\n    if (nodeJSON.blocks) {\n      nodeJSON.blocks = nodeJSON.blocks.map(n =>\n        this.recreateNodeJSON(n, titleCache),\n      );\n    }\n    return nodeJSON;\n  }\n\n  /** Select the node and switch the node if the floating panel on the right is a node form */\n  focusNode(node?: WorkflowNodeEntity): void {\n    if (node) {\n      this.selectService.selectNodeAndFocus(node);\n    }\n    if (\n      this.floatLayoutService.getPanel('right').key !== LayoutPanelKey.NodeForm\n    ) {\n      return;\n    }\n    if (!node) {\n      this.floatLayoutService.close('right');\n      return;\n    }\n    this.floatLayoutService.open(LayoutPanelKey.NodeForm, 'right', {\n      node,\n    });\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { injectable } from 'inversify';\nimport { type IntelligenceType } from '@coze-arch/idl/intelligence_api';\nimport { Emitter, type Event } from '@flowgram-adapter/common';\n\n/**\n * Chatflow testrun item info\n */\nexport interface SelectItem {\n  name: string;\n  value: string;\n  avatar: string;\n  type: IntelligenceType;\n}\n\nexport interface ConversationItem {\n  label: string;\n  value: string;\n  conversationId: string;\n}\n\n@injectable()\nexport class ChatflowService {\n  selectItem?: SelectItem;\n  selectConversationItem?: ConversationItem;\n\n  onSelectItemChangeEmitter = new Emitter<SelectItem | undefined>();\n  onSelectItemChange: Event<SelectItem | undefined> =\n    this.onSelectItemChangeEmitter.event;\n\n  onSelectConversationItemChangeEmitter = new Emitter<\n    ConversationItem | undefined\n  >();\n  onSelectConversationItemChange: Event<ConversationItem | undefined> =\n    this.onSelectConversationItemChangeEmitter.event;\n\n  setSelectItem(selectItem?: SelectItem) {\n    this.selectItem = selectItem;\n    this.onSelectItemChangeEmitter.fire(selectItem);\n  }\n\n  setSelectConversationItem(conversationItem?: ConversationItem) {\n    this.selectConversationItem = conversationItem;\n    this.onSelectConversationItemChangeEmitter.fire(conversationItem);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { inject, injectable } from 'inversify';\nimport {\n  FlowNodeFormData,\n  getNodeError,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  type WorkflowNodeMeta,\n  type WorkflowNodeEntity,\n  WorkflowNodePortsData,\n  type WorkflowPortEntity,\n  WorkflowNodeLinesData,\n} from '@flowgram-adapter/free-layout-editor';\nimport { GlobalVariableService } from '@coze-workflow/variable';\nimport { SETTING_ON_ERROR_PORT } from '@coze-workflow/nodes';\nimport {\n  type ValidationService,\n  type ValidationState,\n  type ValidateErrorMap,\n  type ValidateError,\n  type ValidateResult,\n  type WorkflowValidateErrorMap,\n} from '@coze-workflow/base/services';\nimport { workflowApi, StandardNodeType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  ValidateErrorType,\n  type ValidateTreeRequest,\n  type ValidateErrorData,\n  type ValidateTreeInfo,\n} from '@coze-arch/bot-api/workflow_api';\n\nimport { WorkflowGlobalStateEntity } from '../entities';\n\nconst createStore = () =>\n  createWithEqualityFn<ValidationState>(\n    () => ({\n      errors: {},\n      errorsV2: {},\n      validating: false,\n    }),\n    shallow,\n  );\n\nconst isLineError = (data: ValidateErrorData) =>\n  data.type === ValidateErrorType.BotConcurrentPathErr ||\n  data.type === ValidateErrorType.BotValidatePathErr;\nconst formatSchemaError2ValidateError = (\n  data?: ValidateErrorData[],\n): ValidateErrorMap => {\n  const map: ValidateErrorMap = {};\n  if (!data) {\n    return map;\n  }\n\n  data.forEach(item => {\n    const { node_error, path_error } = item;\n    const isLine = isLineError(item);\n    const nodeId = (isLine ? path_error?.start : node_error?.node_id) || '';\n    const targetNodeId = isLine ? path_error?.end : undefined;\n    const errorType = isLine ? 'line' : 'node';\n    const error: ValidateError = {\n      nodeId,\n      targetNodeId,\n      errorType,\n      errorInfo: item.message || '',\n      errorLevel: 'error',\n    };\n    const errors = map[nodeId] || [];\n    errors.push(error);\n    map[nodeId] = errors;\n  });\n\n  return map;\n};\nconst formatSchemaError2WorkflowError = (data?: ValidateTreeInfo[]) => {\n  const map: WorkflowValidateErrorMap = {};\n  if (!data) {\n    return map;\n  }\n  data.forEach(item => {\n    const { errors, workflow_id, ...rest } = item;\n    if (!errors?.length || !workflow_id) {\n      return;\n    }\n    map[workflow_id] = {\n      workflowId: workflow_id,\n      ...rest,\n      errors: formatSchemaError2ValidateError(errors),\n    };\n  });\n  return map;\n};\n\n/**\n * Workflow Execution Status Validation Service\n */\n@injectable()\nexport class WorkflowValidationService implements ValidationService {\n  @inject(WorkflowDocument) private readonly document: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n  @inject(GlobalVariableService)\n  private readonly globalVariable: GlobalVariableService;\n\n  store = createStore();\n\n  /** Verified node */\n  public validatedNodeMap: Record<string, boolean> = {};\n\n  /** Clear Verified Node State */\n  public clearValidatedNodeMap() {\n    this.validatedNodeMap = {};\n  }\n\n  /** check node */\n  public async validateNode(node: WorkflowNodeEntity): Promise<ValidateResult> {\n    const nodeErrorResult = this.validateNodeError(node);\n    const formValidateResult = await this.validateForm(node);\n    const subCanvasPortValidateResult = this.validateSubCanvasPort(node);\n    const settingOnErrorResult = this.validateSettingOnErrorPort(node);\n\n    const validateResults = [\n      nodeErrorResult,\n      formValidateResult,\n      subCanvasPortValidateResult,\n      settingOnErrorResult,\n    ].filter(Boolean) as ValidateResult[];\n\n    return this.mergeValidateResult(...validateResults);\n  }\n\n  /** validation workflow */\n  public async validateWorkflow(): Promise<ValidateResult> {\n    const nodes = this.document.getAssociatedNodes();\n    const results: ValidateResult[] = await Promise.all(\n      nodes.map(this.validateNode.bind(this)),\n    );\n    return this.mergeValidateResult(...results);\n  }\n\n  /** merge validation result */\n  private mergeValidateResult(...result: ValidateResult[]): ValidateResult {\n    const hasError = result.some(item => item.hasError);\n\n    const nodeErrorMap = result.reduce<ValidateErrorMap>(\n      (errorMap, nodeValidateResult) => {\n        if (!nodeValidateResult.hasError) {\n          return errorMap;\n        }\n        Object.entries(nodeValidateResult.nodeErrorMap).forEach(\n          ([nodeId, nodeErrors]) => {\n            errorMap[nodeId] = errorMap[nodeId] ?? [];\n            errorMap[nodeId].push(...nodeErrors);\n          },\n        );\n        return errorMap;\n      },\n      {},\n    );\n\n    return {\n      hasError,\n      nodeErrorMap,\n    };\n  }\n\n  /** check node error */\n  private validateNodeError(\n    node: WorkflowNodeEntity,\n  ): ValidateResult | undefined {\n    const invalidError = getNodeError(node);\n    if (!invalidError) {\n      return;\n    }\n    return {\n      hasError: true,\n      nodeErrorMap: {\n        [node.id]: [\n          {\n            errorInfo: invalidError.message,\n            errorLevel: 'error',\n            errorType: 'node',\n            nodeId: node.id,\n          },\n        ],\n      },\n    };\n  }\n\n  /** Verify Node Form */\n  private async validateForm(\n    node: WorkflowNodeEntity,\n  ): Promise<ValidateResult | undefined> {\n    const invalidError = getNodeError(node);\n    const formData = node?.getData<FlowNodeFormData>(FlowNodeFormData);\n\n    if (invalidError || !formData.formModel.initialized) {\n      return;\n    }\n\n    // Node Form Validation\n    const feedbacks = await formData.formModel.validateWithFeedbacks();\n    const nodeFormError = feedbacks\n      .filter(\n        feedback =>\n          feedback.feedbackStatus === 'warning' ||\n          feedback.feedbackStatus === 'error',\n      )\n      .map(feedback => {\n        let feedbackText = feedback.feedbackText || '';\n        // The output feedbacks need to be parsed, and there is no good way to judge different feedbacks for the time being.\n        try {\n          const parsedError = JSON.parse(feedbackText);\n          const { issues, name } = parsedError;\n          if (name === 'ZodError' && issues?.[0]?.message) {\n            feedbackText = issues?.[0].message;\n          }\n        } catch (e) {\n          console.log(e);\n        }\n        return {\n          errorInfo: feedbackText,\n          errorLevel: feedback.feedbackStatus,\n          errorType: 'node',\n          nodeId: node.id,\n        };\n      }) as ValidateError[];\n    const hasError = !!nodeFormError.length;\n\n    this.validatedNodeMap[node.id] = true;\n\n    const formValidateResult: ValidateResult = {\n      hasError,\n      nodeErrorMap: {\n        [node.id]: nodeFormError,\n      },\n    };\n\n    return formValidateResult;\n  }\n\n  /** check subcanvas port */\n  private validateSubCanvasPort(\n    node: WorkflowNodeEntity,\n  ): ValidateResult | undefined {\n    const nodeMeta = node.getNodeMeta<WorkflowNodeMeta>();\n    const subCanvas = nodeMeta.subCanvas?.(node);\n    if (!subCanvas || !subCanvas.isCanvas) {\n      return;\n    }\n    const { parentNode, canvasNode } = subCanvas;\n    const portsData = node.getData<WorkflowNodePortsData>(\n      WorkflowNodePortsData,\n    );\n    const { allPorts: ports } = portsData;\n    const inputPort = ports.find(port =>\n      String(port.portID).endsWith('function-inline-output'),\n    );\n    const outputPort = ports.find(port =>\n      String(port.portID).endsWith('function-inline-input'),\n    );\n    if (!inputPort || !outputPort) {\n      return;\n    }\n    const isInputPortEmpty = inputPort.allLines.length === 0;\n    const isOutputPortEmpty = outputPort.allLines.length === 0;\n    const errors: ValidateError[] = [];\n    if (isInputPortEmpty) {\n      const errorMessage =\n        parentNode.flowNodeType === StandardNodeType.Loop\n          ? I18n.t('workflow_testrun_check list_loopbody_start_unconnect')\n          : I18n.t('workflow_testrun_check list_batchbody_start_unconnect');\n      errors.push({\n        errorInfo: errorMessage,\n        errorLevel: 'error',\n        errorType: 'node',\n        nodeId: node.id,\n      });\n      (\n        inputPort as WorkflowPortEntity & {\n          errorMessage?: string;\n        }\n      ).errorMessage = errorMessage;\n      inputPort.hasError = true;\n    } else {\n      inputPort.hasError = false;\n    }\n    // All leaf nodes are end nodes\n    const isAllLeafEnds = canvasNode.collapsedChildren\n      .filter(\n        childNode =>\n          childNode.getData(WorkflowNodeLinesData).outputNodes.length === 0,\n      )\n      .every(childNode => childNode.getNodeMeta().isNodeEnd);\n    if (isOutputPortEmpty && !isAllLeafEnds) {\n      const errorMessage =\n        parentNode.flowNodeType === StandardNodeType.Loop\n          ? I18n.t('workflow_testrun_check list_loopbody_end_unconnect')\n          : I18n.t('workflow_testrun_check list_batchbody_end_unconnect');\n      errors.push({\n        errorInfo: errorMessage,\n        errorLevel: 'error',\n        errorType: 'node',\n        nodeId: node.id,\n      });\n      (\n        outputPort as WorkflowPortEntity & {\n          errorMessage?: string;\n        }\n      ).errorMessage = errorMessage;\n      outputPort.hasError = true;\n    } else {\n      outputPort.hasError = false;\n    }\n    return {\n      hasError: !!errors.length,\n      nodeErrorMap: {\n        [node.id]: errors,\n      },\n    };\n  }\n\n  /**\n   * check exception setting port\n   */\n  private validateSettingOnErrorPort(\n    node: WorkflowNodeEntity,\n  ): ValidateResult | undefined {\n    const portsData = node.getData<WorkflowNodePortsData>(\n      WorkflowNodePortsData,\n    );\n    const { allPorts: ports } = portsData;\n    const settingOnErrorPort = ports.find(\n      port => String(port.portID) === SETTING_ON_ERROR_PORT,\n    );\n\n    if (!settingOnErrorPort) {\n      return;\n    }\n    const isSettingOnErrorEmpty = settingOnErrorPort.allLines.length === 0;\n    const errors: ValidateError[] = [];\n    if (isSettingOnErrorEmpty) {\n      const errorMessage = I18n.t(\n        'workflow_250407_214',\n        undefined,\n        '',\n      );\n      errors.push({\n        errorInfo: errorMessage,\n        errorLevel: 'error',\n        errorType: 'node',\n        nodeId: node.id,\n      });\n      (\n        settingOnErrorPort as WorkflowPortEntity & {\n          errorMessage?: string;\n        }\n      ).errorMessage = errorMessage;\n      settingOnErrorPort.hasError = true;\n    } else {\n      settingOnErrorPort.hasError = false;\n    }\n\n    return {\n      hasError: !!errors.length,\n      nodeErrorMap: {\n        [node.id]: errors,\n      },\n    };\n  }\n\n  /** Validation canvas schema */\n  public async validateSchema() {\n    const json = await this.document.toJSON();\n    const params =\n      this.globalVariable.state.type === 'project'\n        ? {\n            bind_project_id: this.globalVariable.state.id,\n          }\n        : {\n            bind_bot_id: this.globalVariable.state.id,\n          };\n    const { data } = await workflowApi.ValidateSchema({\n      schema: JSON.stringify(json),\n      ...params,\n    });\n    const hasError = !!data?.length;\n    const nodeErrorMap = formatSchemaError2ValidateError(data);\n\n    return {\n      hasError,\n      nodeErrorMap,\n    };\n  }\n\n  /** New validation canvas schema */\n  public async validateSchemaV2() {\n    const params: ValidateTreeRequest = {\n      workflow_id: this.globalState.workflowId,\n    };\n    if (this.globalVariable.state.type === 'project') {\n      params.bind_project_id = this.globalVariable.state.id;\n    } else {\n      params.bind_bot_id = this.globalVariable.state.id;\n    }\n    const json = await this.document.toJSON();\n    const { data } = await workflowApi.ValidateTree({\n      schema: JSON.stringify(json),\n      ...params,\n    });\n\n    const errors = formatSchemaError2WorkflowError(data);\n    const hasError = !!Object.keys(errors).length;\n\n    return {\n      hasError,\n      errors,\n    };\n  }\n\n  getErrors(id: string) {\n    return this.store.getState().errors[id] || [];\n  }\n  setErrors(errors: ValidateErrorMap, force?: boolean) {\n    const prev = this.store.getState().errors;\n    const next = force ? errors : { ...prev, ...errors };\n    this.store.setState({\n      errors: next,\n    });\n  }\n  clearErrors() {\n    this.store.setState({ errors: {}, errorsV2: {} });\n  }\n\n  setErrorsV2(errors: WorkflowValidateErrorMap) {\n    this.store.setState({\n      errorsV2: errors,\n    });\n  }\n  isLineError(fromId: string, toId?: string) {\n    const errors = this.store.getState().errorsV2;\n    /** Find only line errors for this workflow */\n    const myErrors = errors[this.globalState.workflowId]?.errors;\n    if (!myErrors) {\n      return false;\n    }\n    const nodeErrors = myErrors[fromId] || [];\n    const lineError = nodeErrors.find(\n      error => error.errorType === 'line' && error.targetNodeId === toId,\n    );\n    return !!lineError;\n  }\n\n  /** Non-responsive, use with caution */\n  get validating() {\n    return this.store.getState().validating;\n  }\n  set validating(value: boolean) {\n    this.store.setState({\n      validating: value,\n    });\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type ValueExpression,\n  type ValueExpressionDTO,\n  type RefExpression,\n} from '@coze-workflow/variable';\n\nexport abstract class ValueExpressionService {\n  /**\n   * Determine whether a value is a value expression\n   * @param value\n   * @Returns is a value expression\n   */\n  abstract isValueExpression(value: unknown): boolean;\n\n  /**\n   * Determine whether a value is a value expression DTO\n   * @param value\n   * @Returns is a value expression DTO\n   */\n  abstract isValueExpressionDTO(value: unknown): boolean;\n\n  /**\n   * Determine whether the value is a reference expression\n   * @param value\n   * @Returns is a reference expression\n   */\n  abstract isRefExpression(value: unknown): boolean;\n\n  /**\n   * Determine whether the value is a literal expression\n   * @param value\n   * @Returns is a literal expression\n   */\n  abstract isLiteralExpression(value: RefExpression): boolean;\n\n  /**\n   * Determine whether a reference expression variable exists\n   * @param value reference expression\n   * @param node Current node\n   * Does @returns exist\n   */\n  abstract isRefExpressionVariableExists(\n    value: RefExpression,\n    node: FlowNodeEntity,\n  ): boolean;\n\n  /**\n   * Convert value expressions to DTO\n   * @param valueExpression\n   * @param currentNode\n   * @Returns value expression DTO\n   */\n  abstract toDTO(\n    valueExpression?: ValueExpression,\n    currentNode?: FlowNodeEntity,\n  ): ValueExpressionDTO | undefined;\n\n  /**\n   * Converting a value expression DTO to a value expression\n   * @param dto value expression DTO\n   * @Returns value expression\n   */\n  abstract toVO(dto?: ValueExpressionDTO): ValueExpression | undefined;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { injectable, inject } from 'inversify';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type ValueExpression,\n  type ValueExpressionDTO,\n  type RefExpression,\n  ValueExpressionType,\n  WorkflowVariableService,\n  variableUtils,\n} from '@coze-workflow/variable';\nimport { ValueExpression as ValueExpressionUtils } from '@coze-workflow/base';\n\nimport { type ValueExpressionService } from './value-expression-service';\n\n@injectable()\nexport class ValueExpressionServiceImpl implements ValueExpressionService {\n  @inject(WorkflowVariableService)\n  private readonly variableService: WorkflowVariableService;\n\n  public isValueExpression(value: unknown): boolean {\n    if (value === undefined || value === null) {\n      return false;\n    }\n\n    return ValueExpressionUtils.isExpression(value as ValueExpression);\n  }\n\n  public isValueExpressionDTO(value: unknown): boolean {\n    return (\n      (typeof value === 'object' &&\n        value !== null &&\n        (value as any).value?.type === ValueExpressionType.REF) ||\n      (value as any).value?.type === ValueExpressionType.LITERAL\n    );\n  }\n\n  public isRefExpression(value: unknown): boolean {\n    if (value === undefined || value === null) {\n      return false;\n    }\n\n    return ValueExpressionUtils.isRef(value as ValueExpression);\n  }\n\n  public isLiteralExpression(value: unknown): boolean {\n    if (value === undefined || value === null) {\n      return false;\n    }\n\n    return ValueExpressionUtils.isLiteral(value as ValueExpression);\n  }\n\n  // Convert ValueExpression to ValueExpressionDTO\n  public toDTO(\n    valueExpression?: ValueExpression,\n    currentNode?: FlowNodeEntity,\n  ): ValueExpressionDTO | undefined {\n    if (!valueExpression) {\n      return undefined;\n    }\n\n    const dto = variableUtils.valueExpressionToDTO(\n      valueExpression,\n      this.variableService,\n      { node: currentNode },\n    );\n\n    return dto;\n  }\n\n  // Generating ValueExpression from ValueExpressionDTO\n  public toVO(dto?: ValueExpressionDTO): ValueExpression | undefined {\n    if (!dto) {\n      return undefined;\n    }\n\n    const vo = variableUtils.valueExpressionToVO(dto, this.variableService);\n\n    return vo;\n  }\n\n  public isRefExpressionVariableExists(\n    value: RefExpression,\n    node: FlowNodeEntity,\n  ): boolean {\n    const variable = this.variableService.getViewVariableByKeyPath(\n      value?.content?.keyPath,\n      {\n        node,\n      },\n    );\n\n    const isValidVariable = variable !== null && variable !== undefined;\n\n    return isValidVariable;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { set, get } from 'lodash-es';\nimport { injectable, inject } from 'inversify';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type DatabaseSettingField,\n  type DatabaseSettingFieldDTO,\n  type DatabaseConditionDTO,\n  type DatabaseCondition,\n  ValueExpressionType,\n  ConditionLogicDTO,\n  ConditionLogic,\n  type ConditionOperator,\n  workflowQueryClient,\n} from '@coze-workflow/base';\nimport { type SingleDatabaseResponse } from '@coze-arch/idl/memory';\nimport { I18n } from '@coze-arch/i18n';\nimport { MemoryApi } from '@coze-arch/bot-api';\n\nimport { ValueExpressionService } from './value-expression-service';\nimport { type DatabaseNodeService } from './database-node-service';\n\nconst STALE_TIME = 20000;\n\ninterface DatabaseNodeServiceState {\n  /**\n   * Is the database data loading?\n   */\n  loading: boolean;\n\n  /**\n   */\n  data: Record<string, SingleDatabaseResponse>;\n\n  /**\n   */\n  error: Record<string, string | undefined>;\n}\n\ninterface DatabasenNodeServiceAction {\n  getData: (id: string) => SingleDatabaseResponse;\n  setData: (id: string, value: SingleDatabaseResponse) => void;\n  getError: (id: string) => string | undefined;\n  setError: (id: string, value: string | undefined) => void;\n  clearError: (id: string) => void;\n}\n\nexport type DatabseNodeStore = DatabaseNodeServiceState &\n  DatabasenNodeServiceAction;\n\nconst createStore = () =>\n  createWithEqualityFn<DatabseNodeStore>(\n    (setStore, getStore) => ({\n      loading: false,\n      data: {},\n      error: {},\n\n      getData(id) {\n        return getStore().data[id];\n      },\n\n      setData(id, value) {\n        setStore({\n          data: {\n            ...getStore().data,\n            [id]: value,\n          },\n        });\n      },\n\n      getError(id) {\n        return getStore().error[id];\n      },\n\n      setError(id, value) {\n        setStore({\n          error: {\n            ...getStore().error,\n            [id]: value,\n          },\n        });\n      },\n\n      clearError(id) {\n        setStore({\n          error: {\n            ...getStore().error,\n            [id]: undefined,\n          },\n        });\n      },\n    }),\n    shallow,\n  );\n\n@injectable()\nexport class DatabaseNodeServiceImpl implements DatabaseNodeService {\n  store = createStore();\n\n  @inject(ValueExpressionService)\n  private readonly valueExpressionService: ValueExpressionService;\n\n  public convertSettingFieldToDTO(\n    name: string,\n    value: any,\n    node: FlowNodeEntity,\n  ) {\n    const databaseSettingField = get(value, name);\n\n    if (!databaseSettingField) {\n      return value;\n    }\n\n    const databaseSettingFieldDTO: DatabaseSettingFieldDTO[] = (\n      databaseSettingField as DatabaseSettingField[]\n    ).map(field => {\n      const { fieldID, fieldValue = { type: ValueExpressionType.LITERAL } } =\n        field;\n\n      return [\n        {\n          name: 'fieldID',\n          input: {\n            type: 'string',\n            value: {\n              type: ValueExpressionType.LITERAL,\n              content: fieldID.toString(),\n            },\n          },\n        },\n        {\n          name: 'fieldValue',\n          input: this.valueExpressionService.toDTO(fieldValue, node),\n        },\n      ];\n    });\n\n    set(value, name, databaseSettingFieldDTO);\n\n    return value;\n  }\n\n  public convertSettingFieldDTOToField(name: string, value: any) {\n    const databaseSettingFieldDTO = get(value, name);\n\n    if (!databaseSettingFieldDTO) {\n      return value;\n    }\n\n    const databaseSettingField: DatabaseSettingField[] = (\n      databaseSettingFieldDTO as DatabaseSettingFieldDTO[]\n    ).map(field => ({\n      fieldID: Number(field[0].input.value.content),\n      fieldValue: this.valueExpressionService.toVO(field[1]?.input),\n    }));\n\n    set(value, name, databaseSettingField);\n\n    return value;\n  }\n\n  public convertConditionDTOToCondition(name: string, value: any) {\n    const conditionDTO = get(value, name);\n\n    if (!conditionDTO) {\n      return value;\n    }\n\n    const condition: DatabaseCondition[] = conditionDTO.map(\n      ([left, operator, right]) => ({\n        left: left?.input.value.content,\n        operator: operator?.input.value.content,\n        right: this.valueExpressionService.toVO(right?.input),\n      }),\n    );\n\n    set(value, name, condition);\n\n    return value;\n  }\n\n  public convertConditionToDTO(name: string, value: any, node: FlowNodeEntity) {\n    const condition: DatabaseCondition[] = get(value, name);\n\n    if (!condition) {\n      return value;\n    }\n\n    const conditionDTO: DatabaseConditionDTO[] = condition.map(\n      ({ left, operator, right }) => [\n        left\n          ? {\n              name: 'left',\n              input: {\n                type: 'string',\n                value: {\n                  type: ValueExpressionType.LITERAL,\n                  content: left,\n                },\n              },\n            }\n          : undefined,\n        operator\n          ? {\n              // The translation of operators is not uniform, so operation is used here for the time being\n              name: 'operation',\n              input: {\n                type: 'string',\n                value: {\n                  type: ValueExpressionType.LITERAL,\n                  content: operator,\n                },\n              },\n            }\n          : undefined,\n        right\n          ? {\n              name: 'right',\n              input: this.valueExpressionService.toDTO(right, node),\n            }\n          : undefined,\n      ],\n    );\n\n    set(value, name, conditionDTO);\n\n    return value;\n  }\n\n  public convertConditionLogicDTOToConditionLogic(name: string, value: any) {\n    const conditionLogicDTO: ConditionLogicDTO = get(value, name);\n\n    const conditionLogic: ConditionLogic =\n      conditionLogicDTO === ConditionLogicDTO.AND\n        ? ConditionLogic.AND\n        : ConditionLogic.OR;\n\n    set(value, name, conditionLogic);\n\n    return value;\n  }\n\n  public convertConditionLogicToConditionLogicDTO(name: string, value: any) {\n    const conditionLogic: ConditionLogic = get(value, name);\n\n    const conditionLogicDTO: ConditionLogicDTO =\n      conditionLogic === ConditionLogic.AND\n        ? ConditionLogicDTO.AND\n        : ConditionLogicDTO.OR;\n\n    set(value, name, conditionLogicDTO);\n\n    return value;\n  }\n\n  public checkConditionOperatorNoNeedRight(\n    conditionOperator?: ConditionOperator,\n  ) {\n    return ['IS_NULL', 'IS_NOT_NULL', 'BE_TRUE', 'BE_FALSE'].includes(\n      conditionOperator || '',\n    );\n  }\n\n  get state() {\n    return this.store.getState();\n  }\n\n  set loading(v: boolean) {\n    this.store.setState({\n      loading: v,\n    });\n  }\n\n  async load(id: string) {\n    if (!id) {\n      return;\n    }\n    try {\n      this.loading = true;\n      const data = await workflowQueryClient.fetchQuery({\n        queryKey: ['MemoryApi.GetDatabaseByID', id],\n        queryFn: async () =>\n          await MemoryApi.GetDatabaseByID({ id, need_sys_fields: true }),\n        staleTime: STALE_TIME,\n      });\n      this.state.setData(id, data);\n    } catch (error) {\n      this.state.setError(id, error);\n      this.state.setData(id, {\n        database_info: {\n          id,\n          table_name: I18n.t('invalid_database', {}, ''),\n        },\n        BaseResp: {},\n      });\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  clearDatabaseError(id: string) {\n    this.state.clearError(id);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { type FormModelV2 } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport { workflowApi, StandardNodeType, BlockInput } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { type GetApiDetailRequest } from '@coze-arch/bot-api/workflow_api';\nimport { Modal } from '@coze-arch/coze-design';\n\nimport { WorkflowPlaygroundContext } from '@/workflow-playground-context';\nimport { isNodeV2 } from '@/nodes-v2';\nimport { type ApiNodeFormData } from '@/node-registries/plugin/types';\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\ninterface NodeWithVersion {\n  node: FlowNodeEntity;\n  /**\n   * Note that the version may not exist!!!\n   * 1. Old data\n   * 2. Resources in the project are moved to the repository\n   */\n  /**\n   * 1. versionName: In the form of v0.0.1, it is the version index of wf and the explicit version number\n   * 2. versionTs: timestamp in the form of string, which is the version index of the plugin, wf has no such concept\n   */\n  version?: string;\n}\n\ntype SubWorkflowNodeWithVersion = NodeWithVersion & {\n  workflowId: string;\n};\ntype ApiNodeWithVersion = NodeWithVersion & {\n  pluginId: string;\n  apiName: string;\n};\n\nconst MY_SUB_WORKFLOW_NODE_VERSION_PATH = '/inputs/workflowVersion';\nconst MY_SUB_WORKFLOW_NODE_ID_PATH = '/inputs/workflowId';\nconst MY_API_NODE_PARAMS = '/inputs/apiParam';\nconst LLM_WORKFLOW_FC_PATH = '/fcParam/workflowFCParam/workflowList';\nconst LLM_API_FC_PATH = '/fcParam/pluginFCParam/pluginList';\n\nexport const isApiNode = (node: FlowNodeEntity) =>\n  StandardNodeType.Api === node.flowNodeType;\n\nexport const isSubWorkflowNode = (node: FlowNodeEntity) =>\n  StandardNodeType.SubWorkflow === node.flowNodeType;\n\nexport const isLLMNode = (node: FlowNodeEntity) =>\n  node.flowNodeType === StandardNodeType.LLM;\n\nexport const getNodeFormModelV2 = (node: FlowNodeEntity) => {\n  const nodeFormV2 = node\n    .getData<FlowNodeFormData>(FlowNodeFormData)\n    .getFormModel<FormModelV2>();\n\n  return nodeFormV2;\n};\n\nexport const getNodeFormValue = <T>(node: FlowNodeEntity, path: string): T => {\n  const nodeForm = node.getData<FlowNodeFormData>(FlowNodeFormData).formModel;\n  const nodeFormV2 = getNodeFormModelV2(node);\n\n  if (isNodeV2(node) && nodeFormV2?.getValueIn) {\n    return nodeFormV2.getValueIn(path) as T;\n  }\n\n  const value = nodeForm.getFormItemValueByPath(path);\n  return value;\n};\n\nexport const getNodeFormModel = (node: FlowNodeEntity, path: string) => {\n  const nodeForm = node.getData<FlowNodeFormData>(FlowNodeFormData).formModel;\n  const item = nodeForm.getFormItemByPath(path);\n\n  return item;\n};\n\nexport const getMySubWorkflowNodeVersion = (node: FlowNodeEntity) =>\n  getNodeFormValue<string | undefined>(node, MY_SUB_WORKFLOW_NODE_VERSION_PATH);\nexport const getMySubWorkflowNodeId = (node: FlowNodeEntity) =>\n  getNodeFormValue<string>(node, MY_SUB_WORKFLOW_NODE_ID_PATH);\n\nexport const getLLMWorkflowFC = (node: FlowNodeEntity) =>\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getNodeFormValue<any[]>(node, LLM_WORKFLOW_FC_PATH);\nexport const getLLMApiFC = (node: FlowNodeEntity) =>\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getNodeFormValue<any[]>(node, LLM_API_FC_PATH);\nexport const getLLMWorkflowFCById = (\n  node: FlowNodeEntity,\n  workflowId: string,\n) => {\n  const workflowList = getLLMWorkflowFC(node) || [];\n  const current = workflowList.find(w => w.workflow_id === workflowId);\n  return current;\n};\nexport const getLLMApiFCById = (node: FlowNodeEntity, pluginId: string) => {\n  const pluginList = getLLMApiFC(node) || [];\n  const current = pluginList.find(w => w.plugin_id === pluginId);\n  return current;\n};\n\nexport const getMyApiNodeParams = (node: FlowNodeEntity) =>\n  getNodeFormValue<BlockInput[]>(node, MY_API_NODE_PARAMS);\nexport const getMyApiNodeParam = (node: FlowNodeEntity, name: string) => {\n  const params = getMyApiNodeParams(node);\n  const block = params?.find(i => i.name === name);\n  if (!block) {\n    return;\n  }\n  return BlockInput.toLiteral<string>(block);\n};\nexport const getMyApiNodeId = (node: FlowNodeEntity) =>\n  getMyApiNodeParam(node, 'pluginID');\nexport const getMyApiNodeVersion = (node: FlowNodeEntity) =>\n  getMyApiNodeParam(node, 'pluginVersion');\nexport const getMyApiNodeName = (node: FlowNodeEntity) =>\n  getMyApiNodeParam(node, 'apiName');\n\n/**\n * Set the version number of the subprocess node\n */\nexport const setSubWorkflowNodeVersion = (\n  node: FlowNodeEntity,\n  version: string,\n) => {\n  const formModelV2 = getNodeFormModelV2(node);\n\n  if (isNodeV2(node) && formModelV2?.getValueIn) {\n    const value = formModelV2.getValueIn<Record<string, unknown>>('/inputs');\n    formModelV2.setValueIn('/inputs', {\n      ...value,\n      workflowVersion: version,\n    });\n    return;\n  }\n\n  const inputsModel = getNodeFormModel(node, '/inputs');\n  if (inputsModel) {\n    inputsModel.value = {\n      ...inputsModel.value,\n      workflowVersion: version,\n    };\n  }\n};\n\nexport const setApiNodeVersion = (node: FlowNodeEntity, version: string) => {\n  const formModelV2 = getNodeFormModelV2(node);\n\n  if (isNodeV2(node) && formModelV2?.getValueIn) {\n    const value = formModelV2.getValueIn<ApiNodeFormData['inputs']>('/inputs');\n    formModelV2.setValueIn('/inputs', {\n      ...value,\n      apiParam: value?.apiParam.map(i => {\n        if (i.name === 'pluginVersion') {\n          return BlockInput.create('pluginVersion', version);\n        }\n        return i;\n      }),\n    });\n    return;\n  }\n\n  const inputsModel = getNodeFormModel(node, '/inputs');\n  if (inputsModel) {\n    inputsModel.value = {\n      ...inputsModel.value,\n      apiParam: inputsModel.value.apiParam.map(i => {\n        if (i.name === 'pluginVersion') {\n          return BlockInput.create('pluginVersion', version);\n        }\n        return i;\n      }),\n    };\n  }\n};\n\nconst setLLMWorkflowFCVersion = (\n  node: FlowNodeEntity,\n  workflowId: string,\n  version: string,\n) => {\n  const form = getNodeFormModelV2(node);\n  const value = form.getValueIn(LLM_WORKFLOW_FC_PATH);\n  if (Array.isArray(value)) {\n    const idx = value.findIndex(i => i.workflow_id === workflowId);\n    if (idx > -1) {\n      value[idx].workflow_version = version;\n      form.setValueIn(LLM_WORKFLOW_FC_PATH, [...value]);\n    }\n  }\n};\n\nconst setLLMApiFCVersion = (\n  node: FlowNodeEntity,\n  pluginId: string,\n  version: string,\n) => {\n  const form = getNodeFormModelV2(node);\n  const value = form.getValueIn(LLM_API_FC_PATH);\n  if (Array.isArray(value)) {\n    const idx = value.findIndex(i => i.plugin_id === pluginId);\n    if (idx > -1) {\n      value[idx].plugin_version = version;\n      form.setValueIn(LLM_API_FC_PATH, [...value]);\n    }\n  }\n};\n\n/**\n * Get the version information of the plug-in node\n */\nexport const getApiNodeVersion = (node: FlowNodeEntity) => {\n  const nodeDataEntity = node.getData<WorkflowNodeData>(WorkflowNodeData);\n  // The type of subprocess is used here, and the api is actually the same.\n  const nodeData = nodeDataEntity.getNodeData<StandardNodeType.Api>();\n  return {\n    latestVersionTs: nodeData.latestVersionTs,\n    latestVersionName: nodeData.latestVersionName,\n    versionName: nodeData.versionName,\n  };\n};\n\n/**\n * Get subprocess node information\n */\nexport const getSubWorkflowNode = (node: FlowNodeEntity) => {\n  const nodeDataEntity = node.getData<WorkflowNodeData>(WorkflowNodeData);\n  const nodeData = nodeDataEntity.getNodeData<StandardNodeType.SubWorkflow>();\n  return nodeData;\n};\n\nexport const recreateNodeForm = async (\n  node: FlowNodeEntity,\n  context: WorkflowPlaygroundContext,\n) => {\n  const formData = node.getData<FlowNodeFormData>(FlowNodeFormData);\n\n  const nodeRegistry = node.getNodeRegistry();\n\n  // After modifying the version, you need to rerequest the corresponding data, because the keys of the relevant data are all with versions and will not be retrieved.\n  await nodeRegistry?.onInit?.({ data: formData.toJSON() }, context);\n\n  await formData.recreateForm(\n    node.getNodeRegister().formMeta,\n    formData.toJSON(),\n  );\n};\n\nconst fetchApiNodeVersionName = async (params: GetApiDetailRequest) => {\n  try {\n    const { data } = await workflowApi.GetApiDetail(params);\n    return {\n      latestVersionName: data?.latest_version_name,\n      versionName: data?.version_name,\n    };\n  } catch {\n    return {};\n  }\n};\n\nconst forceUpdateModel = (oldVersion?: string, newVersion?: string) =>\n  new Promise<boolean>(resolve =>\n    Modal.confirm({\n      title: I18n.t('workflow_version_update_model_title'),\n      content: I18n.t('workflow_version_add_model_content', {\n        oldVersion,\n        newVersion,\n      }),\n      okText: I18n.t('confirm'),\n      cancelText: I18n.t('cancel'),\n      onOk: () => resolve(true),\n      onCancel: () => resolve(false),\n    }),\n  );\n\n@injectable()\nexport class NodeVersionService {\n  @inject(WorkflowDocument) document: WorkflowDocument;\n\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowPlaygroundContext) context: WorkflowPlaygroundContext;\n\n  /**\n   * Traverse the process and get all the subprocesses and corresponding versions of the specified workflowId in the process\n   */\n  getSubWorkflowNodesWithVersion(workflowId: string) {\n    const allNodes = this.document.getAllNodes();\n    const nodesWithVersion: SubWorkflowNodeWithVersion[] = [];\n    allNodes.forEach(node => {\n      // There is a corresponding subprocess node\n      if (\n        isSubWorkflowNode(node) &&\n        getMySubWorkflowNodeId(node) === workflowId\n      ) {\n        nodesWithVersion.push({\n          node,\n          workflowId,\n          version: getMySubWorkflowNodeVersion(node),\n        });\n        return;\n      }\n      // The llm node needs to drill down into the skill to see if there is a reference to the corresponding sub-process.\n      if (isLLMNode(node)) {\n        const wf = getLLMWorkflowFCById(node, workflowId);\n        if (wf) {\n          nodesWithVersion.push({\n            node,\n            workflowId,\n            version: wf.workflow_version,\n          });\n        }\n      }\n    });\n    return nodesWithVersion;\n  }\n\n  /**\n   * Traverse the process and get all the nodes and corresponding versions of the specified pluginId in the process\n   */\n  getPluginNodesWithVersion(pluginId: string) {\n    const allNodes = this.document.getAllNodes();\n    const nodesWithVersion: ApiNodeWithVersion[] = [];\n    allNodes.forEach(node => {\n      if (isApiNode(node) && getMyApiNodeId(node) === pluginId) {\n        nodesWithVersion.push({\n          node,\n          pluginId,\n          apiName: getMyApiNodeName(node) || '',\n          version: getMyApiNodeVersion(node),\n        });\n        return;\n      }\n      if (isLLMNode(node)) {\n        const p = getLLMApiFCById(node, pluginId);\n        if (p) {\n          nodesWithVersion.push({\n            node,\n            pluginId,\n            apiName: p.api_name,\n            version: p.plugin_version,\n          });\n        }\n      }\n    });\n    return nodesWithVersion;\n  }\n\n  async setSubWorkflowNodesVersion(\n    nodes: SubWorkflowNodeWithVersion[],\n    version: string,\n  ) {\n    nodes.forEach(({ node, workflowId }) => {\n      if (isSubWorkflowNode(node)) {\n        setSubWorkflowNodeVersion(node, version);\n        return;\n      }\n      if (isLLMNode(node)) {\n        setLLMWorkflowFCVersion(node, workflowId, version);\n        return;\n      }\n    });\n    await Promise.all(\n      nodes.map(({ node }) => recreateNodeForm(node, this.context)),\n    );\n  }\n\n  async setApiNodesVersion(nodes: ApiNodeWithVersion[], version: string) {\n    nodes.forEach(({ node, pluginId }) => {\n      if (isApiNode(node)) {\n        setApiNodeVersion(node, version);\n        return;\n      }\n      if (isLLMNode(node)) {\n        setLLMApiFCVersion(node, pluginId, version);\n        return;\n      }\n    });\n    await Promise.all(\n      nodes.map(({ node }) => recreateNodeForm(node, this.context)),\n    );\n  }\n\n  async updateSubWorkflowNodesVersion(workflowId: string, version: string) {\n    const nodes = this.getSubWorkflowNodesWithVersion(workflowId);\n    await this.setSubWorkflowNodesVersion(nodes, version);\n  }\n  async updateApiNodesVersion(pluginId: string, version: string) {\n    const nodes = this.getPluginNodesWithVersion(pluginId);\n    await this.setApiNodesVersion(nodes, version);\n  }\n\n  async updateNodesVersion(node: FlowNodeEntity, version: string) {\n    if (isSubWorkflowNode(node)) {\n      await this.updateSubWorkflowNodesVersion(\n        getMySubWorkflowNodeId(node),\n        version,\n      );\n      return;\n    }\n    if (isApiNode(node)) {\n      await this.updateApiNodesVersion(getMyApiNodeId(node) || '', version);\n      return;\n    }\n  }\n\n  nodesCheck<T extends NodeWithVersion>(nodes: T[], targetVersion: string) {\n    /**\n     * There are two types of nodes that require an updated version:\n     * 1. Node without version number\n     * 2. There is a version number, but the versions are inconsistent\n     */\n    const needUpdateNodes = nodes.filter(\n      ({ version }) => version !== targetVersion,\n    );\n    /**\n     * The updated version of a node with a version number is a lossy forced update, and it needs to be counted to prompt the user. Nodes without a version number are lossless updates.\n     */\n    const needForceNodes = needUpdateNodes.filter(({ version }) => !!version);\n    const needUpdate = !!needUpdateNodes.length;\n    const needForce = !!needForceNodes.length;\n    return {\n      needForce,\n      needUpdate,\n      needUpdateNodes,\n      needForceNodes,\n    };\n  }\n\n  async addSubWorkflowCheck(workflowId?: string, targetVersion?: string) {\n    // If the process to be added does not have a version number, skip the version unification step\n    if (!targetVersion || !workflowId) {\n      return true;\n    }\n    const sameNodesWithVersion =\n      this.getSubWorkflowNodesWithVersion(workflowId);\n    // Nodes without the same process\n    if (!sameNodesWithVersion.length) {\n      return true;\n    }\n    const { needForce, needUpdate, needForceNodes, needUpdateNodes } =\n      this.nodesCheck(sameNodesWithVersion, targetVersion);\n    if (needForce) {\n      const oldVersion = needForceNodes[0].version as string;\n      const confirm = await forceUpdateModel(oldVersion, targetVersion);\n      if (!confirm) {\n        return false;\n      }\n    }\n    if (needUpdate) {\n      await this.setSubWorkflowNodesVersion(needUpdateNodes, targetVersion);\n    }\n    return true;\n  }\n\n  async addApiCheck(pluginId?: string, targetVersionTs?: string) {\n    /**\n     * 1. The version number does not exist, which means that the latest version is referenced, and the verification is skipped directly.\n     * 2. '0' is also regarded as the latest version, which is semantically equivalent to null and skips verification directly\n     */\n    if (!pluginId || !targetVersionTs || targetVersionTs === '0') {\n      return true;\n    }\n    const sameNodesWithVersion = this.getPluginNodesWithVersion(pluginId);\n    if (!sameNodesWithVersion.length) {\n      return true;\n    }\n    const { needForce, needUpdate, needForceNodes, needUpdateNodes } =\n      this.nodesCheck(sameNodesWithVersion, targetVersionTs);\n    if (needForce) {\n      const oldNode = needForceNodes[0];\n      const { latestVersionName: targetVersion, versionName: oldVersion } =\n        await fetchApiNodeVersionName({\n          pluginID: pluginId,\n          apiName: oldNode.apiName,\n          plugin_version: oldNode.version,\n          space_id: this.globalState.spaceId,\n        });\n      const confirm = await forceUpdateModel(\n        oldVersion || oldNode.version,\n        targetVersion || targetVersionTs,\n      );\n      if (!confirm) {\n        return false;\n      }\n    }\n    if (needUpdate) {\n      await this.setApiNodesVersion(needUpdateNodes, targetVersionTs);\n    }\n    return true;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { inject, injectable } from 'inversify';\nimport {\n  type ApiNodeDetailDTO,\n  type ApiNodeIdentifier,\n} from '@coze-workflow/nodes';\nimport { workflowApi, workflowQueryClient } from '@coze-workflow/base';\nimport {\n  PluginProductStatus,\n  ProductUnlistType,\n} from '@coze-arch/idl/developer_api';\nimport { I18n } from '@coze-arch/i18n';\nimport { type PluginFrom } from '@coze-arch/bot-api/playground_api';\n\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\ninterface PluginNodeServiceState {\n  /**\n   * Is the plug-in node data loading?\n   */\n  loading: boolean;\n\n  /**\n   * Plug-in node data, key is the unique identifier of the plug-in specific tool, and value is the plug-in node data.\n   */\n  data: Record<string, ApiNodeDetailDTO>;\n\n  /**\n   * Plug-in node data loading error message, key is the unique identifier of the plug-in specific tool, and value is the error message\n   */\n  error: Record<string, string | undefined>;\n}\n\ninterface PluginNodeServiceAction {\n  getData: (identifier: ApiNodeIdentifier) => ApiNodeDetailDTO;\n  setData: (identifier: ApiNodeIdentifier, value: ApiNodeDetailDTO) => void;\n  getError: (identifier: ApiNodeIdentifier) => string | undefined;\n  setError: (identifier: ApiNodeIdentifier, value: string | undefined) => void;\n  clearError: (identifier: ApiNodeIdentifier) => void;\n}\n\nexport type PluginNodeStore = PluginNodeServiceState & PluginNodeServiceAction;\n\nconst STALE_TIME = 5000;\n\nfunction getCacheKey(identifier: ApiNodeIdentifier) {\n  return `${identifier.pluginID}_${identifier.plugin_version}_${identifier.api_id}`;\n}\n\nconst createStore = () =>\n  createWithEqualityFn<PluginNodeServiceState & PluginNodeServiceAction>(\n    (set, get) => ({\n      loading: false,\n      data: {},\n      error: {},\n\n      getData(identifier) {\n        const key = getCacheKey(identifier);\n        return get().data[key];\n      },\n\n      setData(identifier, value) {\n        const key = getCacheKey(identifier);\n        set({\n          data: {\n            ...get().data,\n            [key]: value,\n          },\n        });\n      },\n\n      getError(identifier) {\n        const key = getCacheKey(identifier);\n        return get().error[key];\n      },\n\n      setError(identifier, value) {\n        const key = getCacheKey(identifier);\n        set({\n          error: {\n            ...get().error,\n            [key]: value,\n          },\n        });\n      },\n\n      clearError(identifier) {\n        const key = getCacheKey(identifier);\n        set({\n          error: {\n            ...get().error,\n            [key]: undefined,\n          },\n        });\n      },\n    }),\n    shallow,\n  );\n\n@injectable()\nexport class PluginNodeService {\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n\n  store = createStore();\n\n  set loading(v: boolean) {\n    this.store.setState({\n      loading: v,\n    });\n  }\n\n  get state() {\n    return this.store.getState();\n  }\n\n  getApiDetail(identifier: ApiNodeIdentifier) {\n    return this.state.getData(identifier);\n  }\n\n  getApiError(identifier: ApiNodeIdentifier) {\n    return this.state.getError(identifier);\n  }\n\n  clearApiError(identifier: ApiNodeIdentifier) {\n    this.state.clearError(identifier);\n  }\n\n  async fetchData(identifier: ApiNodeIdentifier, pluginFrom?: PluginFrom) {\n    const { spaceId, projectId } = this.globalState;\n    return workflowQueryClient.fetchQuery({\n      queryKey: [\n        'loadApiNodeDetail',\n        spaceId,\n        identifier.pluginID,\n        identifier.plugin_version,\n        identifier.apiName,\n        identifier.api_id,\n        projectId,\n        pluginFrom,\n      ],\n      // 1. Set up a 5s cache to ensure that the same request is only sent once in a process, and there will be no excessive performance degradation.\n      // 2. api detail contains the input and output, version information of the plug-in, the data has real-time sensitivity, and there is no data lag.\n      staleTime: STALE_TIME,\n      queryFn: async () =>\n        await workflowApi.GetApiDetail(\n          {\n            ...identifier,\n            space_id: spaceId,\n            project_id: projectId,\n            plugin_from: pluginFrom,\n          },\n          {\n            __disableErrorToast: true,\n          },\n        ),\n    });\n  }\n\n  /**\n   * Plugin status check, whether it is invalid, and determine whether ApiNode is available\n   * @param params\n   * Whether @returns is invalid\n   */\n  isApiNodeDeprecated(params: {\n    currentSpaceID: string;\n    pluginSpaceID?: string;\n    pluginProductStatus?: PluginProductStatus;\n    pluginProductUnlistType?: ProductUnlistType;\n  }): boolean {\n    const {\n      currentSpaceID,\n      pluginSpaceID,\n      pluginProductStatus,\n      pluginProductUnlistType,\n    } = params;\n\n    // Not removed from the shelves\n    if (pluginProductStatus !== PluginProductStatus.Unlisted) {\n      return false;\n    }\n    // Removed by administrator\n    if (pluginProductUnlistType === ProductUnlistType.ByAdmin) {\n      return true;\n    }\n    // Removed by the user, but not the creation space of the current plugin\n    if (\n      pluginProductUnlistType === ProductUnlistType.ByUser &&\n      currentSpaceID !== pluginSpaceID\n    ) {\n      return true;\n    }\n\n    // Removed by the user, but in the plugin creation space\n    return false;\n  }\n\n  async load(identifier: ApiNodeIdentifier, pluginFrom?: PluginFrom) {\n    let apiDetail: ApiNodeDetailDTO | undefined;\n    let errorMessage = '';\n\n    try {\n      this.loading = true;\n      const response = await this.fetchData(identifier, pluginFrom);\n      apiDetail = response.data as ApiNodeDetailDTO;\n    } catch (error) {\n      errorMessage = error.message;\n      if (error.code === '702095021') {\n        errorMessage = I18n.t('workflow_node_lose_efficacy', {\n          name: identifier.apiName,\n        });\n      }\n    } finally {\n      this.loading = false;\n    }\n\n    if (errorMessage) {\n      this.state.setError(identifier, errorMessage);\n    }\n\n    if (!apiDetail) {\n      this.state.setError(identifier, errorMessage || 'loadApiNode failed');\n      return;\n    } else {\n      this.state.setData(identifier, {\n        ...apiDetail,\n        // If the plug-in name is changed (for example, getStock is changed to getStock_v1), apiName will not change or getStock, and name is the updated getStock_v1\n        // At this time, the name field needs to be taken first, otherwise testrun will use the old apiName, resulting in unsuccessful practice run\n        apiName: apiDetail.name || apiDetail.apiName,\n      });\n    }\n\n    const deprecated = this.isApiNodeDeprecated({\n      currentSpaceID: this.globalState.spaceId,\n      pluginSpaceID: apiDetail.spaceID,\n      pluginProductStatus: apiDetail.pluginProductStatus,\n      pluginProductUnlistType: apiDetail.pluginProductUnlistType,\n    });\n\n    if (deprecated) {\n      this.state.setError(\n        identifier,\n        I18n.t('workflow_node_lose_efficacy', { name: identifier.apiName }),\n      );\n    }\n\n    return apiDetail;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport type { WorkflowJSON } from '@flowgram-adapter/free-layout-editor';\nimport { getTestDataByTestset, FieldName } from '@coze-workflow/test-run';\nimport { StandardNodeType } from '@coze-workflow/base';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { IntelligenceType } from '@coze-arch/idl/intelligence_api';\nimport { ComponentType } from '@coze-arch/idl/debugger_api';\nimport { typeSafeJSONParse } from '@coze-arch/bot-utils';\nimport { debuggerApi } from '@coze-arch/bot-api';\n\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\nconst STORAGE_KEY = 'workflow_current_related_bot_value';\nconst TESTSET_CONNECTOR_ID = '10000';\n\ninterface SaveType {\n  id: string;\n  type: 'bot' | 'project';\n}\n\ninterface CaseCachesType {\n  [FieldName.Bot]?: {\n    id: string;\n    type: IntelligenceType;\n  };\n  [key: string]: unknown;\n}\n\n@injectable()\nexport class RelatedCaseDataService {\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n\n  caseCaches: CaseCachesType | undefined = undefined;\n  setCasePromise: Promise<void> | undefined = undefined;\n\n  private getURLSearchParamsBotId(): SaveType | undefined {\n    const sourceBotId = new URLSearchParams(window.location.search).get(\n      'bot_id',\n    );\n    if (!sourceBotId) {\n      return undefined;\n    }\n\n    return {\n      id: sourceBotId,\n      type: 'bot',\n    };\n  }\n\n  private async setDefaultCase(workflowJSON?: WorkflowJSON) {\n    const userInfo = userStoreService.getUserInfo();\n\n    const startNode = workflowJSON?.nodes?.find(\n      node => node.type === StandardNodeType.Start,\n    );\n\n    /* will support soon */\n    if (IS_OPEN_SOURCE) {\n      return;\n    }\n\n    const caseData = await debuggerApi.MGetCaseData({\n      bizCtx: {\n        connectorID: TESTSET_CONNECTOR_ID,\n        bizSpaceID: this.globalState.spaceId,\n        connectorUID: userInfo?.user_id_str,\n      },\n      bizComponentSubject: {\n        componentType: ComponentType.CozeStartNode,\n        parentComponentType: ComponentType.CozeWorkflow,\n        componentID: startNode?.id,\n        parentComponentID: this.globalState.workflowId,\n      },\n      caseName: undefined,\n      pageLimit: 1, // Default test set data will only be in the first\n    });\n\n    const defaultCaseData = caseData?.cases?.find(\n      item => item?.caseBase?.isDefault,\n    );\n\n    if (defaultCaseData) {\n      this.caseCaches = getTestDataByTestset(defaultCaseData);\n    }\n  }\n\n  getDefaultCaseCaches() {\n    return this.caseCaches;\n  }\n\n  genSaveTypeFormCaches() {\n    let res: SaveType | undefined = undefined;\n    const caseData = this.getDefaultCaseCaches();\n\n    if (caseData?.[FieldName.Bot]?.id) {\n      res = {\n        id: caseData?.[FieldName.Bot]?.id,\n        type:\n          caseData[FieldName.Bot]?.type === IntelligenceType.Project\n            ? 'project'\n            : 'bot',\n      };\n    }\n\n    return res;\n  }\n\n  async getAsyncRelatedBotValue(workflowJSON?: WorkflowJSON) {\n    const { workflowId } = this.globalState;\n    if (!workflowId) {\n      return undefined;\n    }\n\n    if (!this.setCasePromise) {\n      this.setCasePromise = this.setDefaultCase(workflowJSON);\n    }\n\n    const store = localStorage.getItem(STORAGE_KEY);\n\n    const jsonStore = typeSafeJSONParse(store);\n\n    let res: SaveType | undefined = undefined;\n\n    if (typeof jsonStore === 'object') {\n      res = jsonStore?.[`${workflowId}`];\n    }\n\n    if (!res) {\n      try {\n        await this.setCasePromise;\n        res = this.genSaveTypeFormCaches();\n      } catch (e) {\n        console.error('getDefaultCase Error: ', e);\n      }\n    }\n\n    const urlBot = this.getURLSearchParamsBotId();\n\n    if (urlBot) {\n      res = urlBot;\n    }\n\n    return res;\n  }\n\n  getRelatedBotValue() {\n    const { workflowId } = this.globalState;\n    if (!workflowId) {\n      return undefined;\n    }\n\n    const store = localStorage.getItem(STORAGE_KEY);\n\n    const jsonStore = typeSafeJSONParse(store);\n\n    let res: SaveType | undefined = undefined;\n\n    if (typeof jsonStore === 'object') {\n      res = jsonStore?.[`${workflowId}`];\n    }\n\n    if (!res) {\n      res = this.genSaveTypeFormCaches();\n    }\n\n    const urlBot = this.getURLSearchParamsBotId();\n\n    if (urlBot) {\n      res = urlBot;\n    }\n\n    return res;\n  }\n\n  updateRelatedBot(value?: SaveType, targetWorkflowId?: string) {\n    const workflowId = targetWorkflowId || this.globalState.workflowId;\n\n    if (!workflowId) {\n      return;\n    }\n\n    const store = localStorage.getItem(STORAGE_KEY);\n    let jsonStore = typeSafeJSONParse(store) as Record<string, SaveType>;\n\n    if (!jsonStore || typeof jsonStore !== 'object') {\n      jsonStore = {};\n    }\n\n    if (!value) {\n      delete jsonStore[`${workflowId}`];\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(jsonStore));\n    } else {\n      jsonStore[`${workflowId}`] = value;\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(jsonStore));\n    }\n  }\n\n  clear() {\n    localStorage.removeItem(STORAGE_KEY);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { debounce } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport { workflowApi } from '@coze-workflow/base';\nimport { type ChatFlowRole } from '@coze-arch/bot-api/workflow_api';\n\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\nconst DEBOUNCE_TIME = 1000;\n\nexport interface RoleServiceState {\n  /**\n   * Is the first load complete?\n   */\n  isReady: boolean;\n  /**\n   * Is the role configuration loading?\n   */\n  loading: boolean;\n  /**\n   * Are you saving the role configuration?\n   */\n  saving: boolean;\n  /**\n   * role configuration data\n   */\n  data: ChatFlowRole | null;\n}\n\nconst createStore = () =>\n  createWithEqualityFn<RoleServiceState>(\n    () => ({\n      isReady: false,\n      loading: false,\n      saving: false,\n      data: null,\n    }),\n    shallow,\n  );\n\n@injectable()\nexport class RoleService {\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n\n  store = createStore();\n\n  get role() {\n    return this.store.getState().data;\n  }\n\n  set role(v: ChatFlowRole | null) {\n    this.store.setState({\n      data: v,\n    });\n  }\n\n  set loading(v: boolean) {\n    this.store.setState({\n      loading: v,\n    });\n  }\n\n  async load() {\n    const { workflowId } = this.globalState;\n    this.loading = true;\n    const res = await workflowApi.GetChatFlowRole({\n      workflow_id: workflowId,\n      connector_id: '10000010',\n      ext: {\n        _caller: 'CANVAS',\n      },\n    });\n    this.store.setState({\n      isReady: true,\n      loading: false,\n      data: res.role || null,\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  async save(next: any) {\n    const { workflowId } = this.globalState;\n    await workflowApi.CreateChatFlowRole({\n      chat_flow_role: {\n        workflow_id: workflowId,\n        connector_id: '10000010',\n        ...next,\n      },\n    });\n    this.role = next;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  debounceSave = debounce((next: any) => {\n    this.save(next);\n  }, DEBOUNCE_TIME);\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  Tracker,\n  ReporterEventName,\n  type PickReporterParams,\n  type ReporterParams,\n} from '@coze-workflow/test-run';\nimport Tea from '@coze-arch/tea';\nimport { WorkflowExeStatus } from '@coze-arch/bot-api/workflow_api';\n\nimport { WorkflowGlobalStateEntity } from '../entities';\n\nconst utils = {\n  executeStatus2TestRunResult: (executeStatus: WorkflowExeStatus) => {\n    const map = {\n      [WorkflowExeStatus.Success]: 'success',\n      [WorkflowExeStatus.Cancel]: 'cancel',\n      [WorkflowExeStatus.Fail]: 'fail',\n    };\n    return map[executeStatus] || 'success';\n  },\n};\n\n@injectable()\nexport class TestRunReporterService {\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n\n  tracker = new Tracker();\n\n  utils = utils;\n\n  private send<T extends ReporterEventName>(key: T, params: ReporterParams[T]) {\n    if (!Tea || typeof Tea.event !== 'function') {\n      return;\n    }\n    Tea.event(key, params);\n  }\n\n  private workflowCommonParams() {\n    const params = {\n      space_id: this.globalState.spaceId,\n      workflow_id: this.globalState.workflowId,\n      project_id: this.globalState.projectId,\n      workflow_mode: this.globalState.flowMode,\n    };\n    return params;\n  }\n\n  tryStart(params: PickReporterParams<ReporterEventName.TryStart, 'scene'>) {\n    const data: ReporterParams[ReporterEventName.TryStart] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n\n    this.send(ReporterEventName.TryStart, data);\n  }\n  runEnd(\n    params: PickReporterParams<\n      ReporterEventName.RunEnd,\n      'testrun_type' | 'testrun_result' | 'execute_id'\n    >,\n  ) {\n    const data: ReporterParams[ReporterEventName.RunEnd] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n\n    this.send(ReporterEventName.RunEnd, data);\n  }\n  /** Form schema generation speed report */\n  formSchemaGen = {\n    start: () => this.tracker.start(),\n    end: (\n      key: string,\n      params: PickReporterParams<ReporterEventName.FormSchemaGen, 'node_type'>,\n    ) => {\n      const time = this.tracker.end(key);\n      if (!time) {\n        return;\n      }\n      const data: ReporterParams[ReporterEventName.FormSchemaGen] = {\n        ...this.workflowCommonParams(),\n        duration: time.duration,\n        ...params,\n      };\n      this.send(ReporterEventName.FormSchemaGen, data);\n    },\n  };\n  formRunUIMode(\n    params: PickReporterParams<ReporterEventName.FormRunUIMode, 'form_ui_mode'>,\n  ) {\n    const data: ReporterParams[ReporterEventName.FormRunUIMode] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n    this.send(ReporterEventName.FormRunUIMode, data);\n  }\n  formGenDataOrigin(\n    params: PickReporterParams<\n      ReporterEventName.FormGenDataOrigin,\n      'gen_data_origin'\n    >,\n  ) {\n    const data: ReporterParams[ReporterEventName.FormGenDataOrigin] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n    this.send(ReporterEventName.FormGenDataOrigin, data);\n  }\n  logRawOutputDifference(\n    params: PickReporterParams<\n      ReporterEventName.LogOutputDifference,\n      'error_msg' | 'log_node_type' | 'is_difference'\n    >,\n  ) {\n    const data: ReporterParams[ReporterEventName.LogOutputDifference] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n    this.send(ReporterEventName.LogOutputDifference, data);\n  }\n  logOutputMarkdown(\n    params: PickReporterParams<\n      ReporterEventName.LogOutputMarkdown,\n      'action_type'\n    >,\n  ) {\n    const data: ReporterParams[ReporterEventName.LogOutputMarkdown] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n    this.send(ReporterEventName.LogOutputMarkdown, data);\n  }\n  traceOpen(\n    params: PickReporterParams<\n      ReporterEventName.TraceOpen,\n      'log_id' | 'panel_type'\n    >,\n  ) {\n    const data: ReporterParams[ReporterEventName.TraceOpen] = {\n      ...this.workflowCommonParams(),\n      ...params,\n    };\n\n    this.send(ReporterEventName.TraceOpen, data);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { pick } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport { QueryClient } from '@tanstack/react-query';\nimport {\n  StandardNodeType,\n  workflowApi,\n  type WorkflowDetailInfoData,\n} from '@coze-workflow/base';\n\nimport {\n  type TriggerFormMeta,\n  fetchStartNodeTriggerFormValue,\n  fetchTriggerFormMeta,\n} from '@/node-registries/trigger-upsert/utils';\nimport { WorkflowGlobalStateEntity } from '@/entities';\n\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      staleTime: Infinity,\n    },\n  },\n});\n\nexport const loadSubWorkflowInfo = async ({\n  spaceId,\n  workflowId,\n}: {\n  spaceId: string;\n  workflowId: string;\n  isInProject: boolean;\n}) => {\n  const data = await queryClient.fetchQuery({\n    queryKey: ['loadSubWorkflowInfo', spaceId, workflowId],\n    queryFn: async () => {\n      const resp = await workflowApi.GetWorkflowDetailInfo(\n        {\n          space_id: spaceId,\n          workflow_filter_list: [\n            {\n              workflow_id: workflowId,\n            },\n          ],\n        },\n        { __disableErrorToast: true },\n      );\n      const workflowInfo = resp?.data?.[0];\n      return workflowInfo;\n    },\n  });\n  return data;\n};\n\n@injectable()\nexport class TriggerService {\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n\n  protected formMeta: TriggerFormMeta;\n  protected subWorkflowInfos: Record<string, WorkflowDetailInfoData> = {};\n  protected startNodeFormValues: Record<string, unknown> = {};\n  async load() {\n    // will support soon\n    if (this.globalState.projectId && !IS_OPEN_SOURCE) {\n      const meta = await fetchTriggerFormMeta({\n        spaceId: this.globalState.spaceId,\n        projectId: this.globalState.projectId,\n        workflowId: this.globalState.workflowId,\n      });\n      this.formMeta = meta;\n\n      const schema = JSON.parse(this.globalState.info?.schema_json || '{}');\n      const startNode = schema.nodes.filter(\n        node => node.type === StandardNodeType.Start,\n      );\n\n      const { formValue, triggerId } = await fetchStartNodeTriggerFormValue({\n        spaceId: this.globalState.spaceId,\n        projectId: this.globalState.projectId,\n        workflowId: this.globalState.workflowId,\n        projectVersion: this.globalState.projectCommitVersion,\n        outputs: startNode?.[0]?.data?.outputs,\n      });\n\n      // const { dynamicInputs, ...rest } = formValue ?? {};\n      const dynamicInputs = pick(\n        formValue,\n        meta.startNodeFormMeta.map(d => d.name),\n      );\n\n      this.setStartNodeFormValues({\n        isOpen: formValue.isOpen,\n        dynamicInputs: dynamicInputs ?? meta.startNodeDefaultFormValue,\n        parameters: formValue.parameters,\n        triggerId,\n      });\n\n      const triggerUpsertNodes = schema.nodes.filter(\n        node => node.type === StandardNodeType.TriggerUpsert,\n      );\n\n      const bindWorkflowIds = triggerUpsertNodes\n        .map(node => node?.data?.inputs?.meta?.workflowId)\n        .filter(Boolean);\n      await Promise.all(\n        bindWorkflowIds.map(workflowId => this.setBindWorkflowInfo(workflowId)),\n      );\n    }\n  }\n\n  getTriggerDynamicFormMeta() {\n    return this.formMeta;\n  }\n\n  getBindWorkflowInfo = (workflowId?: string) => {\n    if (!workflowId) {\n      return undefined;\n    }\n    return this.subWorkflowInfos[workflowId];\n  };\n\n  setBindWorkflowInfo = async (workflowId?: string) => {\n    if (!workflowId || this.subWorkflowInfos[workflowId]) {\n      return;\n    }\n\n    const info = await loadSubWorkflowInfo({\n      spaceId: this.globalState.spaceId,\n      isInProject: !!this.globalState.projectId,\n      workflowId,\n    });\n\n    this.subWorkflowInfos[workflowId] = info;\n  };\n\n  getStartNodeFormValues = () => this.startNodeFormValues;\n\n  setStartNodeFormValues = (values: Record<string, unknown>) => {\n    this.startNodeFormValues = {\n      ...this.startNodeFormValues,\n      ...values,\n    };\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get, debounce } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeFormData } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { Emitter, type Event } from '@flowgram-adapter/common';\nimport {\n  MessageBizType,\n  MessageOperateType,\n  StandardNodeType,\n} from '@coze-workflow/base';\nimport type { WsMessageProps } from '@coze-project-ide/framework/src/types';\nimport { getFlags } from '@coze-arch/bot-flags';\n\nimport {\n  WorkflowGlobalStateEntity,\n  WorkflowDependencyStateEntity,\n} from '@/entities';\nimport { DependencySourceType } from '@/constants';\n\nimport { WorkflowSaveService } from './workflow-save-service';\nimport { TestRunState, WorkflowRunService } from './workflow-run-service';\nimport { WorkflowOperationService } from './workflow-operation-service';\nimport { WorkflowModelsService } from './workflow-models-service';\n\nexport const bizTypeToDependencyTypeMap = {\n  [MessageBizType.Workflow]: DependencySourceType.Workflow,\n  [MessageBizType.Plugin]: DependencySourceType.Plugin,\n  [MessageBizType.Dataset]: DependencySourceType.DataSet,\n  [MessageBizType.Database]: DependencySourceType.DataBase,\n};\n\nconst DEBOUNCE_TIME = 2000;\nexport interface DependencyStore {\n  refreshModalVisible: boolean;\n  setRefreshModalVisible: (visible: boolean) => void;\n}\n\ninterface SubworkflowVersionChangeProps {\n  subWorkflowId: string;\n}\n\n@injectable()\nexport class WorkflowDependencyService {\n  @inject(WorkflowModelsService) modelsService: WorkflowModelsService;\n  @inject(WorkflowDocument) protected workflowDocument: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowSaveService) saveService: WorkflowSaveService;\n  @inject(WorkflowOperationService) operationService: WorkflowOperationService;\n  @inject(WorkflowRunService) testRunService: WorkflowRunService;\n  @inject(WorkflowDependencyStateEntity)\n  dependencyEntity: WorkflowDependencyStateEntity;\n\n  onDependencyChangeEmitter = new Emitter<WsMessageProps | undefined>();\n  onDependencyChange: Event<WsMessageProps | undefined> =\n    this.onDependencyChangeEmitter.event;\n\n  onSubWrokflowVersionChangeEmitter = new Emitter<\n    SubworkflowVersionChangeProps | undefined\n  >();\n  onSubWrokflowVersionChange: Event<SubworkflowVersionChangeProps | undefined> =\n    this.onSubWrokflowVersionChangeEmitter.event;\n\n  /**\n   * Possible badcases:\n   * - The save interface returns slowly, resulting in the refresh pop-up window of the long chain refresh before the version conflict error, but this scenario is relatively limited, and it is necessary to optimize it later.\n   * - Canvas interface returns slowly, resulting in a long chain push notification message consistent with the current version, resulting in an additional refresh.\n   * Avoid this problem by judging the version number again before refreshing.\n   */\n  private workflowDocumentReload = debounce(\n    (callback, messageVersion?: bigint) => {\n      const isVersionNewer =\n        messageVersion && this.dependencyEntity.saveVersion > messageVersion;\n      if (this.dependencyEntity.refreshModalVisible || isVersionNewer) {\n        return;\n      }\n      callback?.();\n    },\n    DEBOUNCE_TIME,\n  );\n\n  updateDependencySources(props: WsMessageProps, callback?: () => void) {\n    const FLAGS = getFlags();\n    if (!FLAGS['bot.automation.project_multi_tab']) {\n      return;\n    }\n\n    const allNodes = this.workflowDocument.getAllNodes();\n    const llmNodes = allNodes.filter(\n      n => n.flowNodeType === StandardNodeType.LLM,\n    );\n\n    // LLM Node Skill Update\n    llmNodes?.forEach(node => {\n      const formData = node.getData(FlowNodeFormData);\n      const formValue = formData.toJSON();\n      const llmSkillIdFields = [\n        { field: 'fcParam.pluginFCParam.pluginList', key: 'api_id' },\n        { field: 'fcParam.knowledgeFCParam.knowledgeList', key: 'id' },\n        { field: 'fcParam.workflowFCParam.workflowList', key: 'workflow_id' },\n      ];\n\n      const skillNeedRefresh = llmSkillIdFields.some(subSkill => {\n        const subSkillList = get(formValue.inputs, subSkill.field) ?? [];\n        return subSkillList.find(\n          (item: unknown) => get(item, subSkill.key) === props?.resId,\n        );\n      });\n\n      if (skillNeedRefresh) {\n        const nextProps: WsMessageProps = {\n          ...props,\n          extra: {\n            nodeIds: [node.id],\n          },\n        };\n        this.onDependencyChangeEmitter.fire(nextProps);\n      }\n    });\n    const { saveVersion } = this.dependencyEntity;\n\n    const dependencyHandlers: {\n      [key in DependencySourceType]: (\n        nodes: FlowNodeEntity[],\n        source?: WsMessageProps,\n      ) => Promise<void> | void;\n    } = {\n      [DependencySourceType.Workflow]: (_nodes, resource) => {\n        // The current workflow is updated on other pages\n        if (resource?.resId === this.globalState.workflowId) {\n          // If you modify the workflow name or description, saveVersion will not be updated\n          const isMetaUpdate =\n            resource?.operateType === MessageOperateType.MetaUpdate;\n          // Switch workflow type scene needs to be refreshed\n          const isFlowModeChange =\n            resource?.extra?.flowMode !== undefined &&\n            this.globalState.flowMode.toString() !== resource.extra.flowMode;\n          const metaUpdateNeedRefresh = isMetaUpdate && isFlowModeChange;\n          // No refresh required during practice runs\n          const isTestRunning =\n            this.testRunService.testRunState === TestRunState.Executing ||\n            this.testRunService.testRunState === TestRunState.Paused;\n          // The current version is larger than the saved version of other pages and does not need to be refreshed.\n          const resourceVersion = BigInt(resource?.saveVersion ?? 0);\n          const isCurVersionNewer = saveVersion > resourceVersion;\n          if (\n            isCurVersionNewer ||\n            this.dependencyEntity.refreshModalVisible ||\n            isTestRunning\n          ) {\n            if (metaUpdateNeedRefresh) {\n              this.workflowDocumentReload(callback);\n            }\n            return;\n          }\n          this.workflowDocumentReload(callback, resourceVersion);\n          return;\n        }\n\n        const subWorkflowNodes = _nodes.filter(\n          n => n.flowNodeType === StandardNodeType.SubWorkflow,\n        );\n        const needUpdateNodeIds: string[] = [];\n        subWorkflowNodes?.forEach(node => {\n          const formData = node.getData(FlowNodeFormData);\n          const formValue = formData.toJSON();\n          const { workflowId } = formValue.inputs;\n          // The child workflows within the current workflow are updated\n          if (resource?.resId === workflowId) {\n            needUpdateNodeIds.push(workflowId);\n          }\n        });\n        if (!needUpdateNodeIds.length) {\n          return;\n        }\n        const nextProps: WsMessageProps = {\n          ...props,\n          extra: {\n            nodeIds: needUpdateNodeIds,\n          },\n        };\n        this.onDependencyChangeEmitter.fire(nextProps);\n      },\n      [DependencySourceType.Plugin]: (nodes, resource) => {\n        const apiNodes = nodes.filter(\n          n => n.flowNodeType === StandardNodeType.Api,\n        );\n        const needUpdateNodeIds: string[] = [];\n        apiNodes?.forEach(node => {\n          const formData = node.getData(FlowNodeFormData);\n          const formValue = formData.toJSON();\n          const apiParam = formValue.inputs.apiParam.find(\n            param => param.name === 'apiID',\n          );\n          const apiID = apiParam.input.value.content ?? '';\n          if (apiID === resource?.resId) {\n            needUpdateNodeIds.push(node.id);\n          }\n        });\n        if (!needUpdateNodeIds.length) {\n          return;\n        }\n        const nextProps: WsMessageProps = {\n          ...props,\n          extra: {\n            nodeIds: needUpdateNodeIds,\n          },\n        };\n        this.onDependencyChangeEmitter.fire(nextProps);\n      },\n      [DependencySourceType.DataSet]: (_, resource) => {\n        // Clear the knowledge base cache\n        this.globalState.sharedDataSetStore.clearDataSetInfosMap();\n        this.onDependencyChangeEmitter.fire(resource);\n      },\n      [DependencySourceType.DataBase]: (_, resource) => {\n        this.onDependencyChangeEmitter.fire(resource);\n      },\n      [DependencySourceType.LLM]: (_, resource) => {\n        this.onDependencyChangeEmitter.fire(resource);\n      },\n    };\n\n    if (props?.bizType) {\n      // Set the refresh method in the refresh pop-up window\n      this.dependencyEntity.setRefreshFunc(() => {\n        callback?.();\n      });\n\n      const dependencyType = bizTypeToDependencyTypeMap[props.bizType];\n      dependencyHandlers[dependencyType](allNodes, props);\n    }\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type XYCoord } from 'react-dnd';\n\nimport { inject, injectable } from 'inversify';\nimport {\n  FlowNodeBaseType,\n  FlowNodeTransformData,\n} from '@flowgram-adapter/free-layout-editor';\nimport { PlaygroundConfigEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  WorkflowDragService,\n  WorkflowSelectService,\n  type WorkflowNodeEntity,\n  type WorkflowNodeJSON,\n  type WorkflowNodeMeta,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  Emitter,\n  Rectangle,\n  type PositionSchema,\n} from '@flowgram-adapter/common';\nimport { StandardNodeType } from '@coze-workflow/base/types';\nimport { I18n } from '@coze-arch/i18n';\n\nexport interface CardDragEvent {\n  type: 'startDrag' | 'endDrag';\n  nodeType?: StandardNodeType;\n  json?: Partial<WorkflowNodeJSON>;\n}\n\ninterface WorkflowCustomDragServiceState {\n  isDragging: boolean;\n  dragNode?: {\n    type: StandardNodeType;\n    json?: Partial<WorkflowNodeJSON>;\n  };\n  transforms?: FlowNodeTransformData[];\n  dropNode?: WorkflowNodeEntity;\n}\n\n@injectable()\nexport class WorkflowCustomDragService extends WorkflowDragService {\n  public state: WorkflowCustomDragServiceState;\n\n  private cardDragEmitter = new Emitter<CardDragEvent>();\n\n  readonly onCardDrag = this.cardDragEmitter.event;\n\n  constructor(\n    @inject(WorkflowDocument) protected document: WorkflowDocument,\n    @inject(WorkflowSelectService)\n    protected selectService: WorkflowSelectService,\n    @inject(PlaygroundConfigEntity)\n    protected playgroundConfig: PlaygroundConfigEntity,\n  ) {\n    super();\n    this.initState();\n    this._toDispose.pushAll([this.cardDragEmitter]);\n  }\n  /** Start dragging */\n  public startDrag(dragNode: WorkflowCustomDragServiceState['dragNode']): void {\n    const { isDragging, dragNode: oldDragNode } = this.state;\n    if (isDragging && oldDragNode) {\n      return;\n    }\n    this.isDragging = true;\n    this.state.isDragging = true;\n    this.state.dragNode = dragNode;\n    const containerTransforms = this.document\n      .getRenderDatas(FlowNodeTransformData, false)\n      .filter(transform => {\n        const { entity } = transform;\n        if (entity.originParent) {\n          return (\n            entity.getNodeMeta().selectable &&\n            entity.originParent.getNodeMeta().selectable\n          );\n        }\n        return entity.getNodeMeta().selectable;\n      })\n      .filter(transform => {\n        const { entity } = transform;\n        return entity.getNodeMeta<WorkflowNodeMeta>().isContainer;\n      });\n    this.state.transforms = containerTransforms;\n    this.cardDragEmitter.fire({\n      type: 'startDrag',\n      nodeType: dragNode?.type,\n      json: dragNode?.json,\n    });\n  }\n  /** end drag */\n  public endDrag() {\n    const { isDragging, dragNode } = this.state;\n    if (!isDragging && !dragNode?.type) {\n      return;\n    }\n    this.isDragging = false;\n    this.state.isDragging = false;\n    this.state.dragNode = undefined;\n    this.state.transforms = undefined;\n    this.cardDragEmitter.fire({\n      type: 'endDrag',\n      nodeType: dragNode?.type,\n      json: dragNode?.json,\n    });\n  }\n  /** Determine whether it can be placed according to the coordinates */\n  public canDrop(params: {\n    coord: XYCoord;\n    dragNode: WorkflowCustomDragServiceState['dragNode'];\n  }): boolean {\n    const { dragNode } = params;\n    if (!dragNode?.type) {\n      return false;\n    }\n    const { allowDrop, dropNode } = this.computeCanDrop(params);\n    this.setDropNode(dropNode);\n    return allowDrop;\n  }\n\n  /**\n   * Can it be placed in the node?\n   * NOTICE: If the following logic is still specialized in the future, it needs to be considered in the node meta configuration\n   */\n  public canDropToNode(params: {\n    dragNodeType?: StandardNodeType;\n    dropNode?: WorkflowNodeEntity;\n  }): {\n    allowDrop: boolean;\n    message?: string;\n    dropNode?: WorkflowNodeEntity;\n  } {\n    const { dragNodeType } = params;\n    const dropNode: WorkflowNodeEntity = params.dropNode ?? this.document.root;\n    if (!dragNodeType) {\n      return {\n        allowDrop: false,\n      };\n    }\n    // Start/end nodes are not allowed to put in any containers\n    if ([StandardNodeType.Start, StandardNodeType.End].includes(dragNodeType)) {\n      return {\n        allowDrop: false,\n        dropNode,\n      };\n    }\n    // Loop/Batch nodes do not allow nesting\n    if (\n      [StandardNodeType.Loop, StandardNodeType.Batch].includes(dragNodeType) &&\n      dropNode?.getNodeMeta<WorkflowNodeMeta>().isContainer\n    ) {\n      return {\n        allowDrop: false,\n        message: I18n.t('workflow_loop_nest_tips'),\n        dropNode,\n      };\n    }\n    // Break nodes and SetVariable nodes can only be dragged into the Loop node\n    if (\n      [\n        StandardNodeType.Break,\n        StandardNodeType.Continue,\n        StandardNodeType.SetVariable,\n      ].includes(dragNodeType)\n    ) {\n      const dropNodeMeta = dropNode.getNodeMeta<WorkflowNodeMeta>();\n      const dropSubCanvas = dropNodeMeta.subCanvas?.(dropNode);\n      if (\n        dropSubCanvas?.isCanvas &&\n        dropSubCanvas.parentNode.flowNodeType === StandardNodeType.Loop\n      ) {\n        return {\n          allowDrop: true,\n          message: I18n.t('workflow_loop_release_tips'),\n          dropNode,\n        };\n      } else {\n        return {\n          allowDrop: false,\n          message: I18n.t('workflow_loop_onlycanva_tips'),\n          dropNode,\n        };\n      }\n    }\n    // Place a node as a container\n    if (\n      [FlowNodeBaseType.ROOT, FlowNodeBaseType.SUB_CANVAS].includes(\n        dropNode.flowNodeType as FlowNodeBaseType,\n      ) ||\n      dropNode.getNodeMeta<WorkflowNodeMeta>().isContainer\n    ) {\n      return {\n        allowDrop: true,\n        dropNode,\n      };\n    }\n    return {\n      allowDrop: false,\n    };\n  }\n\n  /** Can it be placed */\n  public computeCanDrop(params: {\n    coord: XYCoord;\n    dragNode: WorkflowCustomDragServiceState['dragNode'];\n  }): {\n    allowDrop: boolean;\n    message?: string;\n    dropNode?: WorkflowNodeEntity;\n  } {\n    const { coord, dragNode } = params;\n    const addNodePanelWidth = 200;\n    const position = this.playgroundConfig.getPosFromMouseEvent(\n      {\n        clientX: coord.x + addNodePanelWidth,\n        clientY: coord.y,\n      },\n      true,\n    );\n    if (!dragNode?.type) {\n      return {\n        allowDrop: false,\n      };\n    }\n    const collisionTransform = this.getCollisionTransform({\n      position,\n      dragNode,\n    });\n    const dropNode = collisionTransform?.entity;\n    return this.canDropToNode({\n      dragNodeType: dragNode.type,\n      dropNode,\n    });\n  }\n  /** initialization state */\n  private initState(): void {\n    this.state = {\n      isDragging: false,\n      dragNode: undefined,\n      transforms: undefined,\n      dropNode: undefined,\n    };\n  }\n  /** Get overlap position */\n  private getCollisionTransform(params: {\n    position: PositionSchema;\n    dragNode: WorkflowCustomDragServiceState['dragNode'];\n  }): FlowNodeTransformData | undefined {\n    const { transforms } = this.state;\n    const { position, dragNode } = params;\n    if (!dragNode?.type || !transforms || transforms.length === 0) {\n      return undefined;\n    }\n    const draggingRect = new Rectangle(position.x, position.y, 200, 30);\n    const collisionTransform = transforms.find(transform => {\n      const { bounds, entity } = transform;\n      const padding = this.document.layout.getPadding(entity);\n      const transformRect = new Rectangle(\n        bounds.x + padding.left + padding.right,\n        bounds.y,\n        bounds.width,\n        bounds.height,\n      );\n      // Check if two squares collide with each other\n      return Rectangle.intersects(draggingRect, transformRect);\n    });\n    return collisionTransform;\n  }\n  /** Set the current placement node */\n  private setDropNode(newDropNode?: WorkflowNodeEntity) {\n    this.state.dropNode = newDropNode;\n    if (newDropNode) {\n      this.selectService.select(newDropNode);\n    } else {\n      this.selectService.clear();\n    }\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type React from 'react';\n\nimport { isFunction, isPlainObject, isString } from 'lodash-es';\nimport { injectable } from 'inversify';\nimport { Emitter } from '@flowgram-adapter/common';\n\ntype Area = 'right' | 'bottom';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type Render = (props?: any) => React.ReactNode;\n\nexport interface PanelInfo {\n  key: string;\n  area: Area;\n}\n\nexport interface LayoutSize {\n  height: number;\n  width: number;\n}\n\nexport class FloatLayoutPanel {\n  key: string | null = null;\n  panel: React.ReactNode = null;\n\n  onUpdateEmitter = new Emitter<React.ReactNode>();\n  onUpdate = this.onUpdateEmitter.event;\n\n  update(val: React.ReactNode) {\n    this.onUpdateEmitter.fire(val);\n  }\n\n  close() {\n    this.panel = null;\n    this.key = null;\n    this.update(null);\n  }\n  open(node: React.ReactNode, key: string) {\n    this.panel = node;\n    this.key = key;\n    this.update(node);\n  }\n\n  render() {\n    return this.panel;\n  }\n}\n\n@injectable()\nexport class WorkflowFloatLayoutService {\n  /** layout size */\n  size = {\n    height: 0,\n    width: 0,\n  };\n  onSizeChangeEmitter = new Emitter<LayoutSize>();\n  onSizeChange = this.onSizeChangeEmitter.event;\n\n  right = new FloatLayoutPanel();\n  bottom = new FloatLayoutPanel();\n\n  private components = new Map<string, Render>();\n\n  onMountEmitter = new Emitter<PanelInfo>();\n  onMount = this.onMountEmitter.event;\n\n  onUnmountEmitter = new Emitter<PanelInfo>();\n  onUnmount = this.onUnmountEmitter.event;\n\n  register(val: Record<string, Render>): void;\n  register(val: string, component: Render): void;\n  register(\n    val: string | Record<string, () => React.ReactNode>,\n    component?: () => React.ReactNode,\n  ) {\n    if (isPlainObject(val)) {\n      Object.entries(val).forEach(([key, comp]) => {\n        this.register(key, comp);\n      });\n    } else if (isString(val) && component && isFunction(component)) {\n      this.components.set(val, component);\n    }\n  }\n\n  open<T>(key: string, area: Area = 'right', props?: T) {\n    const panel = this.getPanel(area);\n    const component = this.components.get(key);\n\n    if (component && isFunction(component)) {\n      const prevKey = panel.key;\n      panel.open(component(props), key);\n      if (prevKey) {\n        this.onUnmountEmitter.fire({ key: prevKey, area });\n      }\n      this.onMountEmitter.fire({ key, area });\n    }\n  }\n  close(area: Area = 'right') {\n    const panel = this.getPanel(area);\n    const prevKey = panel.key;\n    panel.close();\n    if (prevKey) {\n      this.onUnmountEmitter.fire({ key: prevKey, area });\n    }\n  }\n  closeAll() {\n    this.close('right');\n    this.close('bottom');\n  }\n\n  getPanel(area: Area) {\n    if (area === 'right') {\n      return this.right;\n    }\n    return this.bottom;\n  }\n\n  setLayoutSize(size: LayoutSize) {\n    this.size = size;\n    this.onSizeChangeEmitter.fire(size);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { intersection } from 'lodash-es';\nimport { inject, injectable, postConstruct } from 'inversify';\nimport { WorkflowNodePanelService } from '@flowgram-adapter/free-layout-editor';\nimport { type PlaygroundDragEvent } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowLinesManager,\n  type WorkflowLinePortInfo,\n  type WorkflowLineEntity,\n  type WorkflowPortEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  type PositionSchema,\n  type Disposable,\n  DisposableCollection,\n} from '@flowgram-adapter/common';\nimport { ValidationService } from '@coze-workflow/base/services';\nimport type { StandardNodeType } from '@coze-workflow/base';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { WorkflowGlobalStateEntity } from '../entities';\nimport { WorkflowCustomDragService } from './workflow-drag-service';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const WorkflowLinesServiceProvider = Symbol(\n  'WorkflowLinesServiceProvider',\n);\n\n@injectable()\nexport class WorkflowLinesService {\n  @inject(ValidationService) private validationService: ValidationService;\n\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n\n  @inject(WorkflowLinesManager)\n  protected readonly linesManager: WorkflowLinesManager;\n\n  @inject(WorkflowNodePanelService)\n  protected nodePanelService: WorkflowNodePanelService;\n\n  @inject(WorkflowCustomDragService)\n  protected dragService: WorkflowCustomDragService;\n\n  protected toDispose = new DisposableCollection();\n\n  @postConstruct()\n  init() {\n    this.toDispose.pushAll([this.onDragLineEnd()]);\n  }\n\n  dispose() {\n    this.toDispose.dispose();\n  }\n\n  getLine(fromId?: string, toId?: string): WorkflowLineEntity | undefined {\n    const allLines = this.linesManager.getAllLines();\n\n    return allLines.find(\n      line => line.from.id === fromId && line.to?.id === toId,\n    );\n  }\n\n  getAllLines() {\n    return this.linesManager.getAllLines();\n  }\n\n  createLine(options: WorkflowLinePortInfo) {\n    return this.linesManager.createLine(options);\n  }\n\n  isError(fromId?: string, toId?: string): boolean {\n    if (!fromId) {\n      // No input port allowed\n      return true;\n    }\n\n    const line = this.getLine(fromId, toId);\n\n    if (!line) {\n      // Output does not exist\n      return false;\n    }\n\n    return this.validationService.isLineError(fromId, toId);\n  }\n\n  validateLine(fromId: string, toId: string) {\n    const line = this.getLine(fromId, toId);\n\n    line?.validate();\n  }\n\n  validateAllLine() {\n    const allLines = this.linesManager.getAllLines();\n\n    allLines.forEach(line => line.validate());\n  }\n\n  // Swap the connection between the two ports\n  replaceLineByPort(\n    oldPortInfo: WorkflowLinePortInfo,\n    newPortInfo: WorkflowLinePortInfo,\n  ) {\n    const allLines = this.linesManager.getAllLines();\n\n    const oldPortLines = allLines.filter(\n      line =>\n        line.info.from === oldPortInfo.from &&\n        line.info.fromPort === oldPortInfo.fromPort,\n    );\n\n    const newPortLines = allLines.filter(\n      line =>\n        line.info.from === newPortInfo.from &&\n        line.info.fromPort === newPortInfo.fromPort,\n    );\n\n    // Record the intersection of all connection endpoints\n    const intersectionToPort = intersection(\n      oldPortLines.map(line => line.toPort?.id),\n      newPortLines.map(line => line.toPort?.id),\n    );\n\n    oldPortLines\n      // If the ends of the two lines are the same, the exchange is abandoned.\n      // 1. There is no need to exchange, the connection after the exchange is the same\n      // 2. Two identical connections will be generated during the process, but two identical connections are not allowed in the canvas, which will cause one connection to be lost.\n      .filter(\n        line => !intersectionToPort.some(portId => portId === line.toPort?.id),\n      )\n      .forEach(line => {\n        this.linesManager.replaceLine(line.info, {\n          ...newPortInfo,\n          to: line.info.to,\n        });\n      });\n\n    newPortLines\n      .filter(\n        line => !intersectionToPort.some(portId => portId === line.toPort?.id),\n      )\n      .forEach(line => {\n        this.linesManager.replaceLine(line.info, {\n          ...oldPortInfo,\n          to: line.info.to,\n        });\n      });\n\n    this.linesManager.forceUpdate();\n  }\n\n  /** Monitor when dragging an empty line */\n  private onDragLineEnd(): Disposable {\n    return this.dragService.onDragLineEnd(\n      async (params: {\n        fromPort: WorkflowPortEntity;\n        toPort?: WorkflowPortEntity;\n        mousePos: PositionSchema;\n        line?: WorkflowLineEntity;\n        originLine?: WorkflowLineEntity;\n        event: PlaygroundDragEvent;\n      }) => {\n        const { fromPort, toPort, mousePos, line, originLine } = params;\n        if (originLine || !line) {\n          return;\n        }\n        if (toPort) {\n          return;\n        }\n        await this.nodePanelService.call({\n          fromPort,\n          toPort: undefined,\n          panelPosition: mousePos,\n          enableBuildLine: true,\n          panelProps: {\n            enableNodePlaceholder: true,\n            enableScrollClose: true,\n          },\n          canAddNode: ({ nodeType, containerNode }) => {\n            const canDropMessage = this.dragService.canDropToNode({\n              dragNodeType: nodeType as StandardNodeType,\n              dropNode: containerNode,\n            });\n            if (!canDropMessage.allowDrop) {\n              Toast.warning({\n                content: canDropMessage.message,\n              });\n            }\n            return canDropMessage.allowDrop;\n          },\n        });\n      },\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { injectable, inject } from 'inversify';\nimport { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { getLLMModels } from '@coze-workflow/nodes';\nimport { PUBLIC_SPACE_ID } from '@coze-workflow/base';\nimport { type Model } from '@coze-arch/bot-api/developer_api';\n\nimport { WorkflowGlobalStateEntity } from '@/entities';\n@injectable()\nexport class WorkflowModelsService {\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowDocument)\n  readonly document: WorkflowDocument;\n\n  protected models: Model[] = [];\n  async load() {\n    // TODO: Temporary solution, the template space is virtual space, and the model list is not loaded in read-only mode to solve the permission problem\n    if (\n      this.globalState.readonly &&\n      this.globalState.spaceId === PUBLIC_SPACE_ID\n    ) {\n      this.models = [];\n      return;\n    }\n    this.models = await getLLMModels({\n      info: this.globalState.info,\n      spaceId: this.globalState.spaceId,\n      document: this.document,\n      isBindDouyin: this.globalState.isBindDouyin,\n    });\n  }\n\n  getModels() {\n    return this.models;\n  }\n\n  /**\n   * Acquire all COT models\n   * @Returns all COT models\n   */\n  getCoTModels() {\n    return this.models.filter(model => model.model_ability?.cot_display);\n  }\n\n  /**\n   * Determine whether it is a COT model\n   * @param modelType\n   * @returns\n   */\n  isCoTModel(modelType: number): boolean {\n    return !!this.getCoTModels().find(model => model.model_type === modelType);\n  }\n\n  /**\n   * Determine whether it is a FunctionCall model\n   */\n  isFunctionCallModel(modelType: number): boolean {\n    return !!this.getModelAbility(modelType)?.function_call;\n  }\n\n  /**\n   * Get the model by type\n   * @param modelType\n   * @returns\n   */\n  getModelByType(modelType?: number) {\n    return this.models.find(model => model.model_type === modelType);\n  }\n\n  /**\n   * Acquire model capabilities\n   * @param modelType\n   * @returns\n   */\n  getModelAbility(modelType?: number) {\n    return this.getModelByType(modelType)?.model_ability;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { set } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport { type WorkflowJSON } from '@flowgram-adapter/free-layout-editor';\nimport { PUBLIC_SPACE_ID } from '@coze-workflow/base/constants';\nimport {\n  workflowApi,\n  WorkflowMode,\n  type CopyWorkflowData,\n  type WorkFlowTestRunData,\n  type GetWorkflowProcessResponse,\n  type GetWorkflowProcessRequest,\n  type Workflow,\n  type ReleasedWorkflow,\n  type WorkflowNodeTypeData,\n  type WorkflowNodeDebugV2Request,\n  VCSCanvasType,\n} from '@coze-workflow/base/api';\nimport { reporter } from '@coze-arch/logger';\nimport { getFlags } from '@coze-arch/bot-flags';\nimport { type PublishWorkflowRequest } from '@coze-arch/bot-api/workflow_api';\n\nenum MockTrafficEnabled {\n  DISABLE = 0,\n  ENABLE = 1,\n}\n\nimport {\n  WorkflowGlobalStateEntity,\n  WorkflowDependencyStateEntity,\n} from '../entities';\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const WorkflowOperationServiceProvider = Symbol(\n  'WorkflowOperationServiceProvider',\n);\n\n/**\n * Workflow addition, deletion, modification and other operation interface calls\n * Due to the existence of two different interfaces in multi-person collaboration and non-multiplayer modes, the judgment logic is uniformly converged here to reduce dirty code intrusion\n */\n@injectable()\nexport class WorkflowOperationService {\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowDependencyStateEntity)\n  readonly dependencyEntity: WorkflowDependencyStateEntity;\n\n  get spaceId() {\n    return this.globalState.spaceId;\n  }\n\n  get workflowId() {\n    return this.globalState.workflowId;\n  }\n\n  get logId() {\n    return this.globalState.logId;\n  }\n\n  get mocksetFgOption() {\n    const options = {\n      headers: {\n        'rpc-persist-mock-traffic-enable': MockTrafficEnabled.ENABLE,\n      },\n    };\n    return options;\n  }\n\n  publish = async (obj: Partial<PublishWorkflowRequest> = {}) => {\n    try {\n      let published = false;\n      this.globalState.updateConfig({ publishing: true });\n      const data = await workflowApi.PublishWorkflow({\n        workflow_id: this.workflowId,\n        space_id: this.spaceId,\n        // Abandoned, to be deleted\n        has_collaborator: false,\n        // Published without testrun verification\n        force: true,\n        ...obj,\n      });\n      published = !!data.data?.success;\n\n      reporter.successEvent({\n        eventName: 'workflow_publish_success',\n        namespace: 'workflow',\n      });\n\n      return published;\n    } catch (error) {\n      reporter.errorEvent({\n        eventName: 'workflow_publish_fail',\n        namespace: 'workflow',\n        error,\n      });\n      return false;\n    } finally {\n      this.globalState.updateConfig({ publishing: false });\n    }\n  };\n\n  copy = async (): Promise<\n    Pick<CopyWorkflowData, 'workflow_id'> | undefined\n  > => {\n    if (this.globalState.info.workflowSourceSpaceId === PUBLIC_SPACE_ID) {\n      const resp = await workflowApi.CopyWkTemplateApi(\n        {\n          target_space_id: this.spaceId,\n          workflow_ids: [this.workflowId || ''],\n        },\n        {\n          __disableErrorToast: true,\n        },\n      );\n      return { workflow_id: resp?.data?.[this.workflowId]?.workflow_id ?? '' };\n    } else {\n      const { data } = await workflowApi.CopyWorkflow({\n        space_id: this.spaceId,\n        workflow_id: this.workflowId,\n      });\n\n      return data;\n    }\n  };\n\n  save = async (json: WorkflowJSON, ignoreStatusTransfer: boolean) => {\n    const FLAGS = getFlags();\n    const { vcsData } = this.globalState.info;\n    const { saveVersion } = this.dependencyEntity;\n    const reqParams = {\n      schema: JSON.stringify(json),\n      workflow_id: this.workflowId,\n      space_id: this.spaceId,\n      submit_commit_id: vcsData?.submit_commit_id || '',\n      ignore_status_transfer: ignoreStatusTransfer,\n    };\n    // Required within the project only\n    if (\n      this.globalState.projectId &&\n      FLAGS?.['bot.automation.project_multi_tab']\n    ) {\n      set(reqParams, 'save_version', saveVersion.toString());\n    }\n    await workflowApi.SaveWorkflow(reqParams);\n    if (this.globalState.projectId) {\n      // In order to solve the problem that the canvas interface gets saveVersion and the long-chain push saveVersion are not synchronized, manually update here\n      this.dependencyEntity.addSaveVersion();\n    }\n  };\n\n  testRun = async ({\n    baseParam,\n    input,\n  }): Promise<WorkFlowTestRunData | undefined> => {\n    const options = {\n      ...this.mocksetFgOption,\n    };\n\n    // 1. When the practice runs to view the history, you need to pass in the commitId. 2. When the practice runs in non-draft mode in cooperation mode, pass in the commitId to prevent the fallback to draft\n    const commitId =\n      this.globalState.isViewHistory ||\n      (this.globalState.isCollaboratorMode &&\n        this.globalState.info.vcsData?.type !== VCSCanvasType.Draft)\n        ? this.globalState.info.vcsData?.submit_commit_id\n        : '';\n\n    const { data } = await workflowApi.WorkFlowTestRun(\n      {\n        ...baseParam,\n        commit_id: commitId,\n        input,\n      },\n      options,\n    );\n\n    return data;\n  };\n\n  testOneNode = async (params: WorkflowNodeDebugV2Request) =>\n    await workflowApi.WorkflowNodeDebugV2(params, this.mocksetFgOption);\n\n  getProcess = async (\n    executeId?: string,\n    subExecuteId?: string,\n  ): Promise<GetWorkflowProcessResponse> => {\n    const params: GetWorkflowProcessRequest = {\n      workflow_id: this.workflowId,\n      space_id: this.spaceId,\n      execute_id: executeId,\n      sub_execute_id: subExecuteId,\n    };\n\n    if (this.logId) {\n      params.log_id = this.logId;\n    }\n\n    // If it is the log of the subprocess, the asynchronous query will not be done for the time being, and there is a bug in the backend.\n    params.need_async = !subExecuteId;\n\n    const executeResult = await workflowApi.GetWorkFlowProcess(params);\n    return executeResult;\n  };\n\n  queryNodeType = async (): Promise<WorkflowNodeTypeData | undefined> => {\n    const params = {\n      workflow_id: this.workflowId,\n      space_id: this.spaceId,\n    };\n\n    const { data } = await workflowApi.QueryWorkflowNodeTypes(params);\n\n    const nodeTypes = data;\n\n    return nodeTypes;\n  };\n\n  getSubWorkflowList = async ({\n    workflowIds,\n    filterType,\n    pageParam,\n    name,\n    size,\n  }: any): Promise<ReleasedWorkflow[] | undefined> => {\n    const { data } = await workflowApi.GetReleasedWorkflows({\n      workflow_ids: workflowIds,\n      space_id: this.spaceId,\n      type: filterType,\n      page: pageParam,\n      name,\n      size,\n      flow_mode: WorkflowMode.All,\n    });\n\n    const releasedList = data.workflow_list;\n\n    return releasedList?.filter(item => item.workflow_id !== this.workflowId);\n  };\n\n  getReference = async (): Promise<Workflow[]> => {\n    const params = {\n      workflow_id: this.workflowId,\n      space_id: this.spaceId,\n    };\n\n    const { data } = await workflowApi.GetWorkflowReferences(params);\n    const referenceList = data.workflow_list || [];\n\n    return referenceList;\n  };\n\n  validateSchema = async (\n    json: any,\n    bind?: {\n      projectId?: string;\n      botId?: string;\n    },\n  ) => {\n    const { botId, projectId } = bind || {};\n    const { data } = await workflowApi.ValidateSchema({\n      schema: JSON.stringify(json),\n      bind_project_id: projectId,\n      bind_bot_id: botId,\n    });\n\n    return data;\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { omit } from 'lodash-es';\nimport { inject, injectable, postConstruct } from 'inversify';\nimport { type FeedbackStatus } from '@flowgram-adapter/free-layout-editor';\nimport { Playground } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  WorkflowLinesManager,\n} from '@flowgram-adapter/free-layout-editor';\nimport { Emitter } from '@flowgram-adapter/common';\nimport { workflowApi } from '@coze-workflow/base/api';\nimport {\n  type GetWorkFlowProcessData,\n  NodeExeStatus,\n  type NodeResult,\n  WorkflowExeStatus,\n} from '@coze-workflow/base/api';\nimport { reporter } from '@coze-arch/logger';\nimport { sleep } from '@coze-arch/bot-utils';\nimport { EVENT_NAMES, sendTeaEvent } from '@coze-arch/bot-tea';\n\nimport {\n  WorkflowExecStateEntity,\n  WorkflowExecStatus,\n  WorkflowGlobalStateEntity,\n  WorkflowTestFormStateEntity,\n} from '../entities';\nimport { type TestFormDefaultValue } from '../components/test-run/types';\nimport { START_NODE_ID } from '../components/test-run/constants';\nimport { WorkflowOperationService } from './workflow-operation-service';\nimport { TestRunReporterService } from './test-run-reporter-service';\nconst LOOP_GAP_TIME = 300;\n\nexport enum TestRunState {\n  /** vacant state */\n  Idle = 'idle',\n  /** in progress */\n  Executing = 'executing',\n  /** cancel */\n  Canceled = 'canceled',\n  /** pause */\n  Paused = 'paused',\n  /** success */\n  Succeed = 'succeed',\n  // fail\n  Failed = 'failed',\n}\n\nconst ExecuteStatusToTestRunStateMap = {\n  [WorkflowExeStatus.Cancel]: TestRunState.Canceled,\n  [WorkflowExeStatus.Fail]: TestRunState.Failed,\n  [WorkflowExeStatus.Success]: TestRunState.Succeed,\n};\n\nexport interface TestRunResultInfo {\n  // execution id\n  executeId?: string;\n}\n\ninterface TestRunOneNodeOptions {\n  nodeId: string;\n  input?: Record<string, string>;\n  batch?: Record<string, string>;\n  setting?: Record<string, string>;\n  botId?: string;\n  /** Whether to choose the application */\n  useProject?: boolean;\n}\n\n/**\n * Workflow execution\n */\n@injectable()\nexport class WorkflowRunService {\n  @inject(WorkflowDocument) protected document: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity)\n  readonly globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowExecStateEntity) readonly execState: WorkflowExecStateEntity;\n  @inject(WorkflowTestFormStateEntity)\n  readonly testFormState: WorkflowTestFormStateEntity;\n  @inject(WorkflowLinesManager)\n  protected readonly linesManager: WorkflowLinesManager;\n  @inject(WorkflowOperationService)\n  protected readonly operationService: WorkflowOperationService;\n  @inject(TestRunReporterService)\n  protected readonly reporter: TestRunReporterService;\n\n  @inject(Playground) protected playground: Playground;\n\n  protected readonly testRunStateEmitter = new Emitter<{\n    prevState: TestRunState;\n    curState: TestRunState;\n  }>();\n  readonly onTestRunStateChange = this.testRunStateEmitter.event;\n\n  private _testRunState: TestRunState = TestRunState.Idle;\n\n  public get testRunState() {\n    return this._testRunState;\n  }\n\n  private setTestRunState(state: TestRunState) {\n    if (state === this.testRunState) {\n      return;\n    }\n    this.testRunStateEmitter.fire({\n      prevState: this.testRunState,\n      curState: state,\n    });\n\n    this._testRunState = state;\n  }\n\n  @postConstruct()\n  protected init(): void {\n    /**\n     * Triggered when the canvas is destroyed\n     */\n    this.playground.toDispose.onDispose(() => this.dispose());\n\n    this.onTestRunStateChange(({ prevState, curState }) => {\n      // Monitor state changes and report testrun results\n      this.reportTestRunResult(prevState, curState);\n    });\n  }\n\n  dispose() {\n    /** Canvas destroyed, clearing all testForm cached data */\n    this.testFormState.clearFormData();\n    this.testFormState.clearTestFormDefaultValue();\n    /** Thaw test run on destruction */\n    this.testFormState.unfreezeTestRun();\n    // Clear dry running state\n    this.clearTestRun();\n  }\n\n  clearTestRun = () => {\n    this.clearTestRunResult();\n    this.clearTestRunState();\n  };\n\n  clearTestRunResult = () => {\n    this.testFormState.unfreezeTestRun();\n    this.globalState.viewStatus = WorkflowExecStatus.DEFAULT;\n    // Clear the node results to avoid echo when the test runs\n    if (this.execState.hasNodeResult) {\n      this.execState.clearNodeResult();\n    }\n    this.execState.clearNodeErrorMap();\n    this.execState.updateConfig({\n      executeLogId: undefined,\n      systemError: undefined,\n      isSingleMode: undefined,\n      executeId: '',\n    });\n    this.execState.clearNodeEvents();\n  };\n\n  /**\n   * Clear dry running state\n   */\n  clearTestRunState = () => {\n    this.setTestRunState(TestRunState.Idle);\n  };\n\n  cancelTestRun = async () => {\n    const { executeId } = this.execState.config;\n    sendTeaEvent(EVENT_NAMES.workflow_testrun_result_front, {\n      space_id: this.globalState.spaceId,\n      workflow_id: this.globalState.workflowId,\n      testrun_id: executeId || '',\n      action: 'manual_end',\n    });\n    try {\n      await workflowApi.CancelWorkFlow({\n        execute_id: executeId || '',\n        workflow_id: this.globalState.workflowId,\n        space_id: this.globalState.spaceId,\n      });\n      // eslint-disable-next-line no-useless-catch\n    } catch (e) {\n      throw e;\n    } finally {\n      // Whether the cancellation is successful or not, if it is cancelled in the suspended state, the rotation needs to be resumed.\n      this.continueTestRun();\n    }\n  };\n\n  updateExecuteState = ({\n    nodeResults,\n    executeStatus,\n    executeId,\n    reason,\n    projectId,\n    nodeEvents,\n  }: GetWorkFlowProcessData): void => {\n    // Update the status of each node\n    if (nodeResults && nodeResults.length) {\n      nodeResults.forEach((nodeResult: NodeResult) => {\n        const { nodeId } = nodeResult;\n        if (nodeId) {\n          this.execState.setNodeExecResult(nodeId, nodeResult);\n          // Update the line state of a node\n          const currentLines = this.linesManager\n            .getAllLines()\n            .filter(line => line?.to?.id === nodeResult.nodeId);\n\n          currentLines.forEach(currentLine => {\n            const fromNodeStatus = nodeResults.find(\n              node => node.nodeId === currentLine.from.id,\n            )?.nodeStatus;\n\n            currentLine.processing = Boolean(\n              nodeResult.nodeStatus === NodeExeStatus.Running &&\n                (fromNodeStatus === NodeExeStatus.Success ||\n                  fromNodeStatus === NodeExeStatus.Running),\n            );\n          });\n\n          // update node error\n          const errorLevel = nodeResult.errorLevel?.toLocaleLowerCase() || '';\n          if (['error', 'warning', 'pending'].includes(errorLevel || '')) {\n            this.execState.setNodeError(nodeId, [\n              {\n                nodeId,\n                errorInfo: nodeResult.errorInfo || '',\n                errorLevel: errorLevel as FeedbackStatus,\n                errorType: 'node',\n              },\n            ]);\n          }\n        }\n      });\n    }\n\n    this.execState.setNodeEvents(nodeEvents);\n\n    this.execState.updateConfig({\n      projectId,\n      executeLogId: executeId,\n      // The reason field is only valid if the run result is cancel or fail\n      systemError:\n        executeStatus &&\n        [WorkflowExeStatus.Cancel, WorkflowExeStatus.Fail].includes(\n          executeStatus,\n        )\n          ? reason\n          : '',\n    });\n  };\n\n  /**\n   * Obtain execution results and preprocess the data returned by the service.\n   * Can support fetching with execution ID, or directly passing data back to the service\n   */\n  runProcess = async ({\n    executeId,\n    processResp,\n    subExecuteId,\n  }: {\n    executeId?: string;\n    processResp?: GetWorkFlowProcessData;\n    subExecuteId?: string;\n  }): Promise<GetWorkFlowProcessData> => {\n    const data = processResp\n      ? processResp\n      : (await this.operationService.getProcess(executeId, subExecuteId)).data;\n\n    // An ancient bug, the backend returns Warn, and the front-end consumes Warning. Changing the code has too much impact, so do the conversion here.\n    data?.nodeResults?.forEach(node => {\n      if (node.errorLevel === 'Warn') {\n        node.errorLevel = 'warning';\n      }\n      try {\n        if (node.batch) {\n          const batchResults = JSON.parse(node.batch);\n          node.batch = JSON.stringify(\n            batchResults.map(d => ({\n              ...d,\n              errorLevel: d.errorLevel === 'Warn' ? 'warning' : d.errorLevel,\n            })),\n          );\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    });\n\n    return data || {};\n  };\n\n  // Pause test run\n  pauseTestRun = () => {\n    this.setTestRunState(TestRunState.Paused);\n  };\n\n  // Continue the test run\n  continueTestRun = () => {\n    if (this.testRunState === TestRunState.Paused) {\n      this.setTestRunState(TestRunState.Executing);\n    }\n  };\n\n  protected waitContinue = async () => {\n    if (this.testRunState !== TestRunState.Paused) {\n      return;\n    }\n    return new Promise(resolve => {\n      this.onTestRunStateChange(({ curState }) => {\n        if (curState !== TestRunState.Paused) {\n          resolve(true);\n        }\n      });\n    });\n  };\n\n  // Copy the original logic and poll every 300ms\n  loop = async (executeId?: string) => {\n    const result = await this.runProcess({ executeId });\n    this.execState.updateConfig(result || {});\n    this.updateExecuteState(result);\n\n    if (result?.executeStatus !== WorkflowExeStatus.Running) {\n      return result?.executeStatus;\n    }\n\n    await Promise.all([sleep(LOOP_GAP_TIME), this.waitContinue()]);\n\n    return this.loop(executeId);\n  };\n\n  finishProcess = () => {\n    this.testFormState.unfreezeTestRun();\n    this.globalState.viewStatus = WorkflowExecStatus.DONE;\n    if (!this.globalState.isViewHistory) {\n      // Refresh the publishable state based on practice run results\n      this.globalState.reload();\n    }\n  };\n\n  /* Report the test run results to count the success rate in the store */\n  reportTestRunResult = (prevState: TestRunState, curState: TestRunState) => {\n    const { executeId, isSingleMode } = this.execState.config;\n\n    // Single node mode does not require statistics\n    if (isSingleMode) {\n      return;\n    }\n\n    if (![TestRunState.Succeed, TestRunState.Failed].includes(curState)) {\n      return;\n    }\n    /* success */\n    if (curState === TestRunState.Succeed) {\n      sendTeaEvent(EVENT_NAMES.workflow_testrun_result_front, {\n        space_id: this.globalState.spaceId,\n        workflow_id: this.globalState.workflowId,\n        testrun_id: executeId,\n        action: 'testrun_end',\n        results: 'success',\n      });\n    }\n\n    if (curState === TestRunState.Failed) {\n      /* Trigger failed */\n      if (prevState === TestRunState.Idle) {\n        sendTeaEvent(EVENT_NAMES.workflow_testrun_result_front, {\n          space_id: this.globalState.spaceId,\n          workflow_id: this.globalState.workflowId,\n          action: 'testrun_end',\n          results: 'fail',\n          fail_end: 'server_end',\n          errtype: 'trigger_error',\n        });\n      }\n      /* Failed to run */\n      sendTeaEvent(EVENT_NAMES.workflow_testrun_result_front, {\n        space_id: this.globalState.spaceId,\n        workflow_id: this.globalState.workflowId,\n        testrun_id: executeId,\n        action: 'testrun_end',\n        results: 'fail',\n        fail_end: 'server_end',\n        errtype: 'run_error',\n      });\n    }\n  };\n\n  /**\n   * Run test run\n   */\n  testRun = async (\n    input?: Record<string, string>,\n    botId?: string,\n    /** Is the current selection an application? */\n    useProject?: boolean,\n  ) => {\n    if (this.globalState.config.saving) {\n      return;\n    }\n    this.testFormState.freezeTestRun(START_NODE_ID);\n\n    let executeStatus;\n    let executeId = '';\n\n    try {\n      this.execState.closeSideSheet();\n      // Update view to running\n      this.globalState.viewStatus = WorkflowExecStatus.EXECUTING;\n      const baseParam: {\n        workflow_id: string;\n        space_id: string;\n        bot_id?: string;\n        project_id?: string;\n      } = {\n        workflow_id: this.globalState.workflowId,\n        space_id: this.globalState.spaceId,\n      };\n      /** There is a variable node or a canvas with a variable node subprocess that needs to be passed bot_id, the same level as input*/\n      if (botId) {\n        const botIdKey = useProject ? 'project_id' : 'bot_id';\n        baseParam[botIdKey] = botId;\n      }\n      // If it is within the project, the projectId must be passed\n      if (this.globalState.projectId && !baseParam.project_id) {\n        baseParam.project_id = this.globalState.projectId;\n      }\n\n      const result = await this.operationService\n        .testRun({ baseParam, input })\n        .catch(e => {\n          sendTeaEvent(EVENT_NAMES.workflow_testrun_result_front, {\n            space_id: this.globalState.spaceId,\n            workflow_id: this.globalState.workflowId,\n            action: 'testrun_end',\n            results: 'fail',\n            fail_end: 'server_end',\n            errtype: 'trigger_error',\n          });\n          throw { ...e, errtype: 'trigger_error' };\n        });\n\n      executeId = result?.execute_id || '';\n      // There is an execution id, the test ran successfully\n      if (executeId) {\n        this.execState.updateConfig({\n          executeId,\n        });\n        this.setTestRunState(TestRunState.Executing);\n        executeStatus = await this.loop(executeId);\n        this.finishProcess();\n      }\n      this.reporter.runEnd({\n        testrun_type: 'flow',\n        testrun_result:\n          this.reporter.utils.executeStatus2TestRunResult(executeStatus),\n        execute_id: executeId,\n      });\n    } catch (error) {\n      executeStatus = WorkflowExeStatus.Fail;\n\n      this.clearTestRunResult();\n      this.execState.updateConfig({\n        systemError: error.msg || error.message,\n      });\n      this.reporter.runEnd({\n        testrun_type: 'flow',\n        testrun_result: 'error',\n      });\n    } finally {\n      // Failed to open pop-up window\n      if (executeStatus === WorkflowExeStatus.Fail) {\n        this.execState.openSideSheet();\n      }\n\n      // After running, regardless of success, restore the inPluginUpdated value to avoid testrun all the time.\n      this.globalState.inPluginUpdated = false;\n      this.setTestRunState(ExecuteStatusToTestRunStateMap[executeStatus]);\n    }\n  };\n\n  /**\n   * Get execution history data\n   */\n  getProcessResult = async (config: {\n    /** Whether to display node results */\n    showNodeResults?: boolean;\n    /** Specify the execution ID, if not, the last run result will be displayed */\n    executeId?: string;\n    /** Direct result server level return */\n    processResp?: GetWorkFlowProcessData;\n    /** subprocess execution id */\n    subExecuteId?: string;\n  }) => {\n    const { showNodeResults, executeId, processResp, subExecuteId } = config;\n\n    try {\n      const result = await this.runProcess({\n        executeId,\n        processResp,\n        subExecuteId,\n      });\n\n      this.execState.updateConfig(omit(result, 'nodeEvents'));\n\n      if (showNodeResults) {\n        /**\n         * Only synchronizes the resulting data to the node, but does not change global.config.info. Status\n         * Otherwise, the result of the last test run will affect whether the current process can be released\n         * This state can only be modified by real actions such as real test runs, back-end data, etc\n         */\n        this.globalState.viewStatus = WorkflowExecStatus.DONE;\n        this.updateExecuteState(omit(result, 'nodeEvents'));\n      }\n      return result;\n    } catch (e) {\n      reporter.errorEvent({\n        eventName: 'workflow_get_process_result_fail',\n        namespace: 'workflow',\n        error: e,\n      });\n      throw e;\n    }\n  };\n\n  getViewStatus() {\n    return this.globalState.viewStatus;\n  }\n\n  /**\n   * Get the node corresponding to the current test form schema\n   */\n  getTestFormNode() {\n    const schema = this.testFormState.formSchema;\n    if (!schema || !schema.id) {\n      return null;\n    }\n    return this.document.getNode(schema.id) || null;\n  }\n\n  /**\n   * single node operation\n   */\n  async testRunOneNode(options: TestRunOneNodeOptions) {\n    const { nodeId, input, batch, setting, botId, useProject } = options;\n    if (this.globalState.config.saving) {\n      return;\n    }\n    this.execState.updateConfig({\n      isSingleMode: true,\n    });\n    this.testFormState.freezeTestRun(nodeId);\n    this.execState.closeSideSheet();\n\n    let executeStatus;\n\n    try {\n      this.globalState.viewStatus = WorkflowExecStatus.EXECUTING;\n\n      const botIdParams = {};\n      if (botId) {\n        if (useProject) {\n          Object.assign(botIdParams, { project_id: botId });\n        } else {\n          Object.assign(botIdParams, { bot_id: botId });\n        }\n      }\n\n      // Within the project, project_id is used by default\n      if (this.globalState.projectId) {\n        Object.assign(botIdParams, { project_id: this.globalState.projectId });\n      }\n\n      const res = await this.operationService.testOneNode({\n        workflow_id: this.globalState.workflowId,\n        space_id: this.globalState.spaceId,\n        node_id: nodeId,\n        input,\n        batch,\n        setting,\n        ...botIdParams,\n      });\n\n      const executeId = res.data?.execute_id;\n      if (executeId) {\n        this.setTestRunState(TestRunState.Executing);\n        this.execState.updateConfig({ executeId });\n        executeStatus = await this.loop(executeId);\n        this.finishProcess();\n      }\n      this.reporter.runEnd({\n        testrun_type: 'node',\n        testrun_result:\n          this.reporter.utils.executeStatus2TestRunResult(executeStatus),\n        execute_id: executeId,\n      });\n    } catch (error) {\n      executeStatus = WorkflowExeStatus.Fail;\n      this.clearTestRunResult();\n      this.reporter.runEnd({\n        testrun_type: 'node',\n        testrun_result: 'error',\n      });\n      throw error;\n    } finally {\n      this.setTestRunState(ExecuteStatusToTestRunStateMap[executeStatus]);\n    }\n  }\n\n  setTestFormDefaultValue = (defaultValue: TestFormDefaultValue[]) => {\n    this.testFormState.setTestFormDefaultValue(defaultValue);\n  };\n\n  /** Polling for real-time data */\n  async getRTProcessResult(obj: { executeId?: string }) {\n    const { executeId } = obj;\n    if (!executeId) {\n      return;\n    }\n    let executeStatus;\n\n    try {\n      /** Request data directly */\n      const result = await this.runProcess({ executeId });\n      /** Update data to view */\n      this.execState.updateConfig(result || {});\n      this.updateExecuteState(result);\n      executeStatus = result?.executeStatus;\n      /**\n       * When still running, turn on polling\n       * Chatflow scenario, the backend may return 0, and polling is also required at this time\n       */\n      if (\n        result?.executeStatus === WorkflowExeStatus.Running ||\n        (result?.executeStatus as number) === 0\n      ) {\n        /** To turn on polling, you need to first make the view read-only */\n        this.globalState.viewStatus = WorkflowExecStatus.EXECUTING;\n        this.setTestRunState(TestRunState.Executing);\n        /**\n         * 1. To ensure the rhythm of the request is synchronized, sleep will also be done here\n         * 2. The suspension is also valid for it, but there is no such business scenario for the time being\n         */\n        await Promise.all([sleep(LOOP_GAP_TIME), this.waitContinue()]);\n        /** poll */\n        executeStatus = await this.loop(executeId);\n      }\n      this.finishProcess();\n    } catch (error) {\n      executeStatus = WorkflowExeStatus.Fail;\n      this.clearTestRunResult();\n      this.execState.updateConfig({\n        systemError: error.msg || error.message,\n      });\n    } finally {\n      this.globalState.inPluginUpdated = false;\n      this.setTestRunState(ExecuteStatusToTestRunStateMap[executeStatus]);\n    }\n  }\n\n  async testRunTrigger(triggerId: string) {\n    if (this.globalState.config.saving || !this.globalState.projectId) {\n      return;\n    }\n    this.testFormState.freezeTestRun(triggerId);\n    let executeStatus;\n    let executeId = '';\n    try {\n      this.globalState.viewStatus = WorkflowExecStatus.EXECUTING;\n\n      const result = await workflowApi.TestRunTrigger({\n        space_id: this.globalState.spaceId,\n        project_id: this.globalState.projectId,\n        trigger_id: triggerId,\n      });\n      executeId = result?.data?.execute_id || '';\n      if (executeId) {\n        this.execState.updateConfig({\n          executeId,\n        });\n        this.setTestRunState(TestRunState.Executing);\n        executeStatus = await this.loop(executeId);\n        this.finishProcess();\n      }\n      this.reporter.runEnd({\n        testrun_type: 'trigger',\n        testrun_result:\n          this.reporter.utils.executeStatus2TestRunResult(executeStatus),\n        execute_id: executeId,\n      });\n    } catch (error) {\n      executeStatus = WorkflowExeStatus.Fail;\n\n      this.clearTestRunResult();\n      this.execState.updateConfig({\n        systemError: error.msg || error.message,\n      });\n      this.reporter.runEnd({\n        testrun_type: 'trigger',\n        testrun_result: 'error',\n      });\n    } finally {\n      this.globalState.inPluginUpdated = false;\n      this.setTestRunState(ExecuteStatusToTestRunStateMap[executeStatus]);\n    }\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { debounce, isEmpty } from 'lodash-es';\nimport { inject, injectable } from 'inversify';\nimport { StackingContextManager } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  Playground,\n  PlaygroundConfigEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowContentChangeType,\n  WorkflowLineEntity,\n  WorkflowResetLayoutService,\n  delay,\n  type WorkflowContentChangeEvent,\n  type WorkflowDocument,\n  type WorkflowJSON,\n} from '@flowgram-adapter/free-layout-editor';\nimport { Emitter, type Disposable } from '@flowgram-adapter/common';\nimport { GlobalVariableService } from '@coze-workflow/variable';\nimport { WorkflowNodesService } from '@coze-workflow/nodes';\nimport { useWorkflowStore } from '@coze-workflow/base/store';\nimport { OperateType, WorkflowMode } from '@coze-workflow/base/api';\nimport {\n  StandardNodeType,\n  type WorkflowNodeJSON,\n  reporter,\n} from '@coze-workflow/base';\nimport { userStoreService } from '@coze-studio/user-store';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { logger } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { getFlags } from '@coze-arch/bot-flags';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { type Model } from '@coze-arch/bot-api/developer_api';\n\nimport { WorkflowModelsService } from '@/services/workflow-models-service';\nimport { TriggerService } from '@/services/trigger-service';\nimport { RelatedCaseDataService } from '@/services/related-case-data-service';\nimport { getNodeV2Registry } from '@/nodes-v2';\n\nimport { WorkflowPlaygroundContext } from '../workflow-playground-context';\nimport {\n  WorkflowGlobalStateEntity,\n  WorkflowDependencyStateEntity,\n} from '../entities';\nimport { WorkflowOperationService } from './workflow-operation-service';\n\n// This is not written dead, do not use it to judge the start node, please use flowNodeType\nconst START_NODE_ID = '100001';\nconst END_NODE_ID = '900001';\nconst CHAT_NODE_DEFAULT_ID = '110100';\nconst HIGH_DEBOUNCE_TIME = 1000;\nconst LOW_DEBOUNCE_TIME = 3000;\nconst RELOAD_DELAY_TIME = 500;\nconst RENDER_DELAY_TIME = 100;\n\nconst ERROR_CODE_SAVE_VERSION_CONFLICT = '720702239';\n\n/**\n * Create default, only start and end nodes\n */\nfunction createDefaultJSON(flowMode: WorkflowMode): WorkflowJSON {\n  if (flowMode === WorkflowMode.SceneFlow) {\n    return {\n      nodes: [\n        {\n          id: START_NODE_ID,\n          type: StandardNodeType.Start,\n          meta: {\n            position: { x: 0, y: 0 },\n          },\n          data: {\n            outputs: [\n              {\n                type: 'string',\n                name: '',\n                required: true,\n              },\n            ],\n          },\n        },\n        {\n          id: END_NODE_ID,\n          type: StandardNodeType.End,\n          meta: {\n            position: { x: 2000, y: 0 },\n          },\n        },\n        {\n          id: CHAT_NODE_DEFAULT_ID,\n          type: StandardNodeType.SceneChat,\n          meta: {\n            position: { x: 1000, y: 0 },\n          },\n        },\n      ],\n      edges: [\n        { sourceNodeID: START_NODE_ID, targetNodeID: CHAT_NODE_DEFAULT_ID },\n      ],\n    };\n  } else {\n    return {\n      nodes: [\n        {\n          id: START_NODE_ID,\n          type: StandardNodeType.Start,\n          meta: {\n            position: { x: 0, y: 0 },\n          },\n          data: {\n            outputs: [\n              {\n                type: 'string',\n                name: '',\n                required: true,\n              },\n            ],\n          },\n        },\n        {\n          id: END_NODE_ID,\n          type: StandardNodeType.End,\n          meta: {\n            position: { x: 1000, y: 0 },\n          },\n        },\n      ],\n      edges: [],\n    };\n  }\n}\n\n@injectable()\nexport class WorkflowSaveService {\n  @inject(WorkflowGlobalStateEntity) globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowNodesService) nodesService: WorkflowNodesService;\n  @inject(WorkflowOperationService) operationService: WorkflowOperationService;\n  @inject(WorkflowModelsService) modelsService: WorkflowModelsService;\n  @inject(TriggerService) triggerService: TriggerService;\n  @inject(GlobalVariableService) globalVariableService: GlobalVariableService;\n  @inject(RelatedCaseDataService) relatedBotService: RelatedCaseDataService;\n  @inject(WorkflowDependencyStateEntity)\n  dependencyEntity: WorkflowDependencyStateEntity;\n\n  @inject(WorkflowPlaygroundContext) context: WorkflowPlaygroundContext;\n  @inject(PlaygroundConfigEntity) playgroundConfig: PlaygroundConfigEntity;\n  @inject(WorkflowResetLayoutService)\n  resetLayoutService: WorkflowResetLayoutService;\n  @inject(Playground) playground: Playground;\n\n  @inject(StackingContextManager)\n  private readonly stackingContextManager: StackingContextManager;\n\n  protected workflowDocument: WorkflowDocument;\n  protected readonly onSavedEmitter = new Emitter<void>();\n  readonly onSaved = this.onSavedEmitter.event;\n\n  protected saveOnChangeDisposable?: Disposable;\n\n  // Whether the test run state needs to be streamed. When changing the node location, there is no need to re-test run\n  ignoreStatusTransfer = true;\n\n  /**\n   * Get workflow schema json\n   * @Param commitId process version information\n   * @Param type type information for process version, commit or publish\n   */\n  loadWorkflowJson = async (\n    commitId?: string,\n    type?: OperateType,\n    env?: string,\n  ) => {\n    let workflowJson: WorkflowJSON | undefined;\n    const {\n      workflowId,\n      spaceId,\n      workflowCommitId,\n      playgroundProps,\n      flowMode,\n      logId,\n      projectId,\n      projectCommitVersion,\n    } = this.globalState;\n\n    const FLAGS = getFlags();\n    const needUseLogId = IS_BOT_OP && logId;\n    const isPreviewInProject = Boolean(projectId && projectCommitVersion);\n    const hasExecuteId = Boolean(playgroundProps?.executeId);\n\n    // If it is a project, check the historical version.\n    if (isPreviewInProject) {\n      workflowJson = await this.globalState.loadHistory({\n        commit_id: commitId as string,\n        project_version: projectCommitVersion as string,\n        project_id: projectId as string,\n        log_id: logId,\n        type: type || OperateType.SubmitOperate,\n        env,\n      });\n    } else if (commitId || needUseLogId || hasExecuteId) {\n      workflowJson = await this.globalState.loadHistory({\n        commit_id: commitId as string,\n        log_id: logId,\n        type: type || OperateType.SubmitOperate,\n        execute_id: hasExecuteId ? playgroundProps?.executeId : undefined,\n        sub_execute_id: playgroundProps?.subExecuteId,\n        env,\n      });\n    } else if (workflowCommitId || needUseLogId) {\n      workflowJson = await this.globalState.loadHistory({\n        commit_id: workflowCommitId,\n        log_id: logId,\n        type:\n          this.globalState.config?.playgroundProps?.commitOptType ||\n          OperateType.SubmitOperate,\n      });\n    } else if (playgroundProps?.from === 'communityTrial') {\n      /**\n       * If it comes from a community trial, the historical version must be taken regardless of whether there is a commitId or not.\n       * Mainly deal with scenarios where db does not commitId request the latest schema in trial. This logic can be deleted after data cleaning is completed\n       */\n      workflowJson = await this.globalState.loadHistory({\n        commit_id: workflowCommitId,\n        type:\n          this.globalState.config?.playgroundProps?.commitOptType ||\n          OperateType.SubmitOperate,\n      });\n    } else {\n      workflowJson = await this.globalState.load(workflowId, spaceId);\n      // Process initialization settings saveVersion\n      const workflowInfo = this.globalState.config?.info;\n      FLAGS?.['bot.automation.project_multi_tab'] &&\n        projectId &&\n        this.dependencyEntity.setSaveVersion(\n          BigInt(workflowInfo?.save_version ?? ''),\n        );\n    }\n\n    if (!workflowJson || workflowJson.nodes.length === 0) {\n      workflowJson = createDefaultJSON(flowMode);\n    }\n\n    if (!workflowJson.edges) {\n      workflowJson.edges = [];\n    }\n\n    return workflowJson;\n  };\n\n  /**\n   * Initialize all node forms before rendering, and the form creation will not proceed until the initialization is completed.\n   * @param nodes All node data\n   */\n  async initNodeData(nodes: WorkflowNodeJSON[]) {\n    const promises: Promise<void>[] = [];\n    const stack: WorkflowNodeJSON[] = [...nodes];\n\n    while (stack.length > 0) {\n      const node = stack.pop() as WorkflowNodeJSON;\n      const registry = getNodeV2Registry(node.type as StandardNodeType);\n      if (registry?.onInit) {\n        promises.push(registry.onInit(node, this.context));\n      }\n\n      if (node.blocks && node.blocks.length > 0) {\n        stack.push(...node.blocks);\n      }\n    }\n\n    await Promise.all(promises);\n  }\n\n  /**\n   * Load document data\n   */\n  async loadDocument(doc: WorkflowDocument): Promise<void> {\n    this.workflowDocument = doc;\n    const { workflowId, getProjectApi } = this.globalState;\n\n    const projectApi = getProjectApi();\n\n    const loadingStartTime = Date.now();\n\n    try {\n      if (!workflowId) {\n        throw Error(I18n.t('workflow_detail_error_interface_initialization'));\n      }\n      projectApi?.setWidgetUIState('saving');\n      this.hideRenderLayer();\n\n      const userInfo = userStoreService.getUserInfo();\n      const locale = userInfo?.locale ?? navigator.language ?? 'en-US';\n\n      // load node information\n      const [, workflowJSON] = await Promise.all([\n        this.context.loadNodeInfos(locale),\n        this.loadWorkflowJson(),\n        // this.loadGlobalVariables(),\n      ]);\n\n      await this.loadGlobalVariables(workflowJSON);\n\n      await this.modelsService.load();\n\n      try {\n        await this.triggerService.load();\n      } catch (e) {\n        logger.error(e.message);\n      }\n\n      // Load large model context\n      this.context.models = this.modelsService.getModels() as Model[];\n\n      // Synchronize loaded nodes and edges to workflow store\n      useWorkflowStore.getState().setNodes(workflowJSON.nodes);\n      useWorkflowStore.getState().setEdges(workflowJSON.edges);\n\n      const loadDateTime = Date.now() - loadingStartTime;\n\n      const renderStartTime = Date.now();\n\n      // preload\n      await this.initNodeData(workflowJSON.nodes as WorkflowNodeJSON[]);\n\n      await this.workflowDocument.fromJSON(workflowJSON);\n      const renderTime = Date.now() - renderStartTime;\n\n      this.globalState.updateConfig({\n        loading: false,\n      });\n      projectApi?.setWidgetUIState('normal');\n      // Only with permission can it be automatically saved.\n      if (!this.globalState.readonly) {\n        this.saveOnChangeDisposable = doc.onContentChange(\n          this.listenContentChange,\n        );\n      }\n\n      const fitViewStartTime = Date.now();\n      await this.fitView();\n      const fitViewTime = Date.now() - fitViewStartTime;\n\n      const totalTime = Date.now() - loadingStartTime;\n\n      reporter.event({\n        eventName: 'workflow_load_document',\n        meta: {\n          totalTime,\n          loadDateTime,\n          renderTime,\n          fitViewTime,\n        },\n      });\n    } catch (e) {\n      this.globalState.updateConfig({\n        loadingError: e.message,\n        loading: false,\n      });\n      projectApi?.setWidgetUIState('error');\n\n      throw e;\n    } finally {\n      this.showRenderLayer();\n    }\n  }\n\n  async loadGlobalVariables(workflowJSON?: WorkflowJSON) {\n    const useNewGlobalVariableCache =\n      !this.globalState.isInIDE &&\n      !this.globalState.playgroundProps?.disableGetTestCase;\n\n    if (useNewGlobalVariableCache) {\n      const relatedBot = await this.relatedBotService.getAsyncRelatedBotValue(\n        workflowJSON,\n      );\n\n      if (!relatedBot?.id || !relatedBot?.type) {\n        return;\n      }\n\n      return this.globalVariableService.loadGlobalVariables(\n        relatedBot?.type,\n        relatedBot?.id,\n      );\n    }\n\n    return this.globalVariableService.loadGlobalVariables(\n      'project',\n      this.globalState.projectId,\n    );\n  }\n\n  /**\n   * By default, the start node will be centered\n   */\n  async fitView(): Promise<void> {\n    // Waiting for node rendering and layout calculation\n    await delay(RENDER_DELAY_TIME);\n\n    // Wait for DOM resize update\n    await new Promise<void>(resolve => {\n      window.requestAnimationFrame(() => resolve());\n    });\n\n    // execution layout\n    this.workflowDocument.fitView(false);\n\n    // Wait for the node to render after layout\n    await delay(RENDER_DELAY_TIME);\n  }\n\n  /**\n   * Save document data\n   */\n  save = async () => {\n    const { getProjectApi } = this.globalState;\n    const projectApi = getProjectApi();\n    const FLAGS = getFlags();\n\n    try {\n      // Disable saving in read-only state, and also disable saving if in the loaded state\n      if (this.globalState.readonly || this.globalState.loading) {\n        return;\n      }\n      reporter.event({\n        eventName: 'workflow_save',\n      });\n\n      this.globalState.updateConfig({\n        saveLoading: true,\n        saving: true,\n        savingError: false,\n      });\n      projectApi?.setWidgetUIState('saving');\n      const json = await this.workflowDocument.toJSON();\n\n      if (this.globalState.config.schemaGray) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any -- temporary field\n        (json as any).versions = this.globalState.config.schemaGray;\n      }\n\n      // Save the draft, store the nodes and edges of the workflow to zustand store\n      useWorkflowStore.getState().setNodes(json.nodes);\n      useWorkflowStore.getState().setEdges(json.edges);\n\n      // The problem of FIXME has not been located and cleared, so prevent the saving first.\n      if (json.nodes.length === 0) {\n        projectApi?.setWidgetUIState('error');\n        throw new CustomError(REPORT_EVENTS.parmasValidation, 'Saving Error');\n      }\n\n      await this.operationService.save(json, this.ignoreStatusTransfer);\n\n      this.ignoreStatusTransfer = true;\n\n      await this.globalState.reload();\n      this.globalState.updateConfig({\n        saveLoading: false,\n        saving: false,\n        savingError: false,\n      });\n      projectApi?.setWidgetUIState('normal');\n      // Get the latest saveVersion after successful saving\n      const workflowInfo = this.globalState.config.info;\n      FLAGS?.['bot.automation.project_multi_tab'] &&\n        this.globalState.projectId &&\n        this.dependencyEntity.setSaveVersion(\n          BigInt(workflowInfo?.save_version ?? ''),\n        );\n    } catch (e) {\n      this.globalState.updateConfig({\n        saveLoading: false,\n        saving: false,\n        savingError: true,\n      });\n      projectApi?.setWidgetUIState('error');\n\n      // The new version of the node will use e.name whether it is CustomNodeError to judge\n      if (\n        e.eventName === 'WorkflowSubWorkflowResourceLose' ||\n        e.eventName === 'WorkflowApiNodeResourceLose' ||\n        e?.name === 'CustomNodeError'\n      ) {\n        logger.warning(e.message);\n      } else if (\n        e.code === ERROR_CODE_SAVE_VERSION_CONFLICT &&\n        FLAGS?.['bot.automation.project_multi_tab']\n      ) {\n        // A workflow version conflict is found when saving, prompting the user to refresh the page\n        this.dependencyEntity.setRefreshModalVisible(true);\n        throw e;\n      } else {\n        throw e;\n      }\n    } finally {\n      this.onSavedEmitter.fire();\n    }\n  };\n\n  /**\n   * Determine whether it is a change from a free node\n   * Free node modification without re-test run\n   */\n  isAssociateChange(entity: FlowNodeEntity | WorkflowLineEntity) {\n    let isAssociateChange = false;\n    const associatedNodes = this.workflowDocument.getAssociatedNodes();\n    if (entity instanceof FlowNodeEntity) {\n      isAssociateChange = associatedNodes.some(node => node.id === entity.id);\n    } else if (entity instanceof WorkflowLineEntity) {\n      isAssociateChange = associatedNodes.some(\n        node => node.id === entity.from.id,\n      );\n    }\n    return isAssociateChange;\n  }\n\n  protected listenContentChange = ({\n    type,\n    entity,\n  }: WorkflowContentChangeEvent) => {\n    const { getProjectApi } = this.globalState;\n    const projectApi = getProjectApi();\n    this.globalState.updateConfig({\n      saving: true,\n    });\n    projectApi?.setWidgetUIState('saving');\n\n    const isAssociateChange = this.isAssociateChange(entity);\n\n    if (\n      type === WorkflowContentChangeType.MOVE_NODE ||\n      type === WorkflowContentChangeType.META_CHANGE ||\n      !isAssociateChange\n    ) {\n      this.lowPrioritySave();\n    } else {\n      this.ignoreStatusTransfer = false;\n      this.highPrioritySave();\n    }\n  };\n\n  /**\n   * High priority save, including node content, node addition and deletion, line addition and deletion\n   */\n  public highPrioritySave = debounce(() => {\n    reporter.event({\n      eventName: 'workflow_high_priority_save',\n    });\n    this.save();\n  }, HIGH_DEBOUNCE_TIME);\n\n  /**\n   * Low-priority saving, including node location moves\n   * @protected\n   */\n  public lowPrioritySave = debounce(() => {\n    reporter.event({\n      eventName: 'workflow_low_priority_save',\n    });\n    this.highPrioritySave();\n  }, LOW_DEBOUNCE_TIME - HIGH_DEBOUNCE_TIME);\n\n  waitSaving = () => {\n    if (!this.globalState.config.saving) {\n      return;\n    }\n    return new Promise(resolve => {\n      this.onSaved(() => resolve(true));\n    });\n  };\n\n  /**\n   * Overloading document data\n   */\n  reloadDocument = async ({\n    commitId,\n    type,\n    env,\n    customWorkflowJson,\n  }: {\n    commitId?: string;\n    type?: OperateType;\n    env?: string;\n    customWorkflowJson?: WorkflowJSON;\n  } = {}) => {\n    // Wait for the save to end\n\n    await this.waitSaving();\n\n    const workflowJson = !isEmpty(customWorkflowJson)\n      ? customWorkflowJson\n      : await this.loadWorkflowJson(commitId, type, env);\n    if (!workflowJson) {\n      return;\n    }\n    this.hideRenderLayer();\n\n    this.saveOnChangeDisposable?.dispose();\n\n    // preload\n    await this.initNodeData((workflowJson?.nodes as WorkflowNodeJSON[]) ?? []);\n    await this.workflowDocument.reload(workflowJson, RELOAD_DELAY_TIME);\n    if (!this.globalState.readonly) {\n      this.saveOnChangeDisposable = this.workflowDocument.onContentChange(\n        this.listenContentChange,\n      );\n    }\n\n    await this.fitView();\n    this.showRenderLayer();\n  };\n\n  private hideRenderLayer(): void {\n    this.stackingContextManager.node.style.opacity = '0';\n  }\n\n  private showRenderLayer(): void {\n    this.stackingContextManager.node.style.opacity = '1';\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity -- no need to fix */\n/* eslint-disable @typescript-eslint/no-namespace -- no need to fix */\nimport { customAlphabet } from 'nanoid';\nimport { traverse, type TraverseContext } from '@coze-workflow/base';\n\nimport type { WorkflowClipboardJSON, WorkflowClipboardNodeJSON } from '../type';\n\nnamespace UniqueWorkflowUtils {\n  /** Generate a unique ID */\n  const generateUniqueId = customAlphabet('1234567890', 6);\n  /** Get all node IDs */\n  export const getAllNodeIds = (json: WorkflowClipboardJSON): string[] => {\n    const nodeIds = new Set<string>();\n    const addNodeId = (node: WorkflowClipboardNodeJSON) => {\n      nodeIds.add(node.id);\n      if (node.blocks?.length) {\n        node.blocks.forEach(child => addNodeId(child));\n      }\n    };\n    json.nodes.forEach(node => addNodeId(node));\n    return Array.from(nodeIds);\n  };\n  /** Generate Node Replacement Map */\n  export const generateNodeReplaceMap = (\n    nodeIds: string[],\n    isUniqueId: (id: string) => boolean,\n  ): Map<string, string> => {\n    const nodeReplaceMap = new Map<string, string>();\n    nodeIds.forEach(id => {\n      if (isUniqueId(id)) {\n        nodeReplaceMap.set(id, id);\n      } else {\n        let newId: string;\n        do {\n          // Add a fixed prefix here to avoid the ID starting with 0 and the backend will report an error.\n          newId = `1${generateUniqueId()}`;\n        } while (!isUniqueId(newId));\n        nodeReplaceMap.set(id, newId);\n      }\n    });\n    return nodeReplaceMap;\n  };\n  /** Does it exist? */\n  const isExist = (value: unknown): boolean =>\n    value !== null && value !== undefined;\n  /** Does it need to be dealt with? */\n  const shouldHandle = (context: TraverseContext): boolean => {\n    const { node } = context;\n    // line data\n    if (\n      node?.key &&\n      ['sourceNodeID', 'targetNodeID'].includes(node.key) &&\n      node.parent?.parent?.key === 'edges'\n    ) {\n      return true;\n    }\n    // node data\n    if (\n      node?.key === 'id' &&\n      isExist(node.container?.type) &&\n      isExist(node.container?.meta) &&\n      isExist(node.container?.data)\n    ) {\n      return true;\n    }\n    // variable data\n    if (\n      node?.key === 'blockID' &&\n      isExist(node.container?.name) &&\n      node.container?.source === 'block-output'\n    ) {\n      return true;\n    }\n    return false;\n  };\n  /**\n   * Replace Node ID\n   * NOTICE: This method has a side effect and will modify the incoming json to prevent additional performance overhead caused by deep copies\n   */\n  export const replaceNodeId = (\n    json: WorkflowClipboardJSON,\n    nodeReplaceMap: Map<string, string>,\n  ): WorkflowClipboardJSON => {\n    traverse(json, context => {\n      if (!shouldHandle(context)) {\n        return;\n      }\n      const { node } = context;\n      if (nodeReplaceMap.has(node.value)) {\n        context.setValue(nodeReplaceMap.get(node.value));\n      }\n    });\n    return json;\n  };\n}\n\n/** Generate unique workflow JSON */\nexport const generateUniqueWorkflow = (params: {\n  json: WorkflowClipboardJSON;\n  isUniqueId: (id: string) => boolean;\n}): WorkflowClipboardJSON => {\n  const { json, isUniqueId } = params;\n  const nodeIds = UniqueWorkflowUtils.getAllNodeIds(json);\n  const nodeReplaceMap = UniqueWorkflowUtils.generateNodeReplaceMap(\n    nodeIds,\n    isUniqueId,\n  );\n  return UniqueWorkflowUtils.replaceNodeId(json, nodeReplaceMap);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable prefer-destructuring -- no need */\n/* eslint-disable @typescript-eslint/no-namespace -- use namespace for easy management */\nimport type { LayoutNode } from '@flowgram-adapter/free-layout-editor';\n\ninterface QuadTreeBounds {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface QuadTree {\n  bounds: QuadTreeBounds;\n  nodes: LayoutNode[];\n  northWest: QuadTree | null;\n  northEast: QuadTree | null;\n  southWest: QuadTree | null;\n  southEast: QuadTree | null;\n}\n\n/** default capacity */\nconst DEFAULT_CAPACITY = 4;\n\n/** Create a quadtree node */\nconst createNode = (bounds: QuadTreeBounds): QuadTree => ({\n  bounds,\n  nodes: [],\n  northWest: null,\n  northEast: null,\n  southWest: null,\n  southEast: null,\n});\n\n/** Check whether the node is within the boundary (the size of the node needs to be taken into account). */\nconst containsNode = (bounds: QuadTreeBounds, node: LayoutNode): boolean =>\n  node.position.x >= bounds.x &&\n  node.position.x + node.size.width <= bounds.x + bounds.width &&\n  node.position.y >= bounds.y &&\n  node.position.y + node.size.height <= bounds.y + bounds.height;\n\n/** subdivision node */\nconst subdivide = (quadTree: QuadTree): QuadTree => {\n  const { x, y, width, height } = quadTree.bounds;\n  const w = width / 2;\n  const h = height / 2;\n\n  return {\n    ...quadTree,\n    northWest: createNode({ x, y, width: w, height: h }),\n    northEast: createNode({ x: x + w, y, width: w, height: h }),\n    southWest: createNode({ x, y: y + h, width: w, height: h }),\n    southEast: createNode({ x: x + w, y: y + h, width: w, height: h }),\n  };\n};\n\n/** Insert Node */\nconst insert = (\n  quadTree: QuadTree,\n  node: LayoutNode,\n  capacity: number,\n): QuadTree => {\n  if (!containsNode(quadTree.bounds, node)) {\n    return quadTree;\n  }\n\n  if (!quadTree.northWest) {\n    const newNodes = [...quadTree.nodes, node];\n    if (newNodes.length <= capacity) {\n      return { ...quadTree, nodes: newNodes };\n    }\n  }\n\n  const updatedQuadTree = quadTree.northWest ? quadTree : subdivide(quadTree);\n\n  // Check if a node can be inserted into any subquadrant\n  const canInsertIntoQuadrant = (quadrant: QuadTree | null): boolean =>\n    quadrant ? containsNode(quadrant.bounds, node) : false;\n\n  // If a node cannot be inserted into any subquadrant, leave it in the current node\n  if (\n    !canInsertIntoQuadrant(updatedQuadTree.northWest) &&\n    !canInsertIntoQuadrant(updatedQuadTree.northEast) &&\n    !canInsertIntoQuadrant(updatedQuadTree.southWest) &&\n    !canInsertIntoQuadrant(updatedQuadTree.southEast)\n  ) {\n    return { ...updatedQuadTree, nodes: [...updatedQuadTree.nodes, node] };\n  }\n\n  const insertIntoQuadrant = (quadrant: QuadTree | null): QuadTree | null =>\n    quadrant ? insert(quadrant, node, capacity) : null;\n\n  return {\n    ...updatedQuadTree,\n    northWest: insertIntoQuadrant(updatedQuadTree.northWest),\n    northEast: insertIntoQuadrant(updatedQuadTree.northEast),\n    southWest: insertIntoQuadrant(updatedQuadTree.southWest),\n    southEast: insertIntoQuadrant(updatedQuadTree.southEast),\n  };\n};\n\n/** Calculate the distance between two nodes (taking into account the node center). */\nconst distance = (n1: LayoutNode, n2: LayoutNode): number => {\n  const dx =\n    n1.position.x + n1.size.width / 2 - (n2.position.x + n2.size.width / 2);\n  const dy =\n    n1.position.y + n1.size.height / 2 - (n2.position.y + n2.size.height / 2);\n  return Math.sqrt(dx * dx + dy * dy);\n};\n\n/** Calculate the minimum distance from a node to the boundary (taking into account the size of the node). */\nconst distanceToBounds = (node: LayoutNode, bounds: QuadTreeBounds): number => {\n  if (containsNode(bounds, node)) {\n    // If the node is completely within the boundary, return 0.\n    return 0;\n  }\n  const dx = Math.max(\n    bounds.x - (node.position.x + node.size.width),\n    0,\n    node.position.x - (bounds.x + bounds.width),\n  );\n  const dy = Math.max(\n    bounds.y - (node.position.y + node.size.height),\n    0,\n    node.position.y - (bounds.y + bounds.height),\n  );\n  return Math.sqrt(dx * dx + dy * dy);\n};\n\n/** Calculate the boundaries of a set of nodes (taking into account the size of the nodes). */\nconst calculateBounds = (nodes: LayoutNode[]): QuadTreeBounds => {\n  if (nodes.length === 0) {\n    // Returns a default boundary\n    return {\n      x: 0,\n      y: 0,\n      width: 1,\n      height: 1,\n    };\n  }\n\n  const xValues = nodes.map(node => node.position.x);\n  const yValues = nodes.map(node => node.position.y);\n  const widths = nodes.map(node => node.size.width);\n  const heights = nodes.map(node => node.size.height);\n\n  const minX = Math.min(...xValues);\n  const maxX = Math.max(...xValues.map((x, i) => x + widths[i]));\n  const minY = Math.min(...yValues);\n  const maxY = Math.max(...yValues.map((y, i) => y + heights[i]));\n\n  // Add some margins to ensure that all points are within the boundary\n  const margin = Math.max(maxX - minX, maxY - minY) * 0.1;\n\n  return {\n    x: minX - margin,\n    y: minY - margin,\n    width: maxX - minX + 2 * margin,\n    height: maxY - minY + 2 * margin,\n  };\n};\n\n/** Create a quadtree */\nexport const createQuadTree = (nodes: LayoutNode[]): QuadTree => {\n  const bounds = calculateBounds(nodes);\n  let quadTree = createNode(bounds);\n\n  nodes.forEach(node => {\n    quadTree = insert(quadTree, node, DEFAULT_CAPACITY);\n  });\n\n  return quadTree;\n};\n\n/** Find Nearest Neighbors */\nexport const findNearestNeighbor = (\n  quadTree: QuadTree,\n  targetNode: LayoutNode,\n): LayoutNode | null => {\n  const findNearest = (\n    node: QuadTree,\n    nearest: LayoutNode | null,\n    minDistance: number,\n  ): { nearest: LayoutNode | null; minDistance: number } => {\n    // Check all points in the current node\n    for (const currentNode of node.nodes) {\n      if (currentNode === targetNode) {\n        // exclude itself\n        continue;\n      }\n      const currentDistance = distance(targetNode, currentNode);\n      if (currentDistance < minDistance) {\n        nearest = currentNode;\n        minDistance = currentDistance;\n      }\n    }\n\n    // If this is a leaf node, return the result\n    if (!node.northWest) {\n      return { nearest, minDistance };\n    }\n\n    // check subquadtree\n    const quadrants = [\n      node.northWest,\n      node.northEast,\n      node.southWest,\n      node.southEast,\n    ]\n      .filter((q): q is QuadTree => q !== null)\n      .sort(\n        (a, b) =>\n          distanceToBounds(targetNode, a.bounds) -\n          distanceToBounds(targetNode, b.bounds),\n      );\n\n    for (const quadrant of quadrants) {\n      if (distanceToBounds(targetNode, quadrant.bounds) < minDistance) {\n        const result = findNearest(quadrant, nearest, minDistance);\n        nearest = result.nearest;\n        minDistance = result.minDistance;\n      }\n    }\n\n    return { nearest, minDistance };\n  };\n\n  const result = findNearest(quadTree, null, Infinity);\n  return result.nearest;\n};\n\n/** Quadtree tool class */\nexport namespace QuadTree {\n  export const create = createQuadTree;\n  export const find = findNearestNeighbor;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const WORKFLOW_CLIPBOARD_TYPE = 'coze-workflow-clipboard-data';\nexport const WORKFLOW_EXPORT_TYPE = 'coze-workflow-export-data';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { interfaces } from 'inversify';\nimport { bindContributions } from '@flowgram-adapter/common';\nimport type { WorkflowShortcutsContribution } from '@coze-workflow/render';\n\ninterface ShortcutFactory {\n  new (): WorkflowShortcutsContribution;\n}\n\nexport const bindShortcuts = (\n  bind: interfaces.Bind,\n  to: typeof WorkflowShortcutsContribution,\n  shortcuts: ShortcutFactory[],\n) => {\n  shortcuts.forEach(shortcut => {\n    bindContributions(bind, shortcut, [to]);\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reporter, logger } from '@coze-arch/logger';\nimport { Toast } from '@coze-arch/coze-design';\n\nexport const safeFn =\n  (fn: Function) =>\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- no need to check type\n  (...args: any[]) => {\n    try {\n      return fn(...args);\n    } catch (e) {\n      Toast.error({\n        content: `[Coze Workflow] Failed to run function: ${\n          fn.name || '() => any'\n        }`,\n      });\n      console.error('Failed to run function: ', e);\n      reporter.errorEvent({\n        namespace: 'workflow',\n        eventName: 'workflow_shortcuts_error',\n        error: e,\n      });\n      logger.error(e);\n    }\n  };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport type { WorkflowGlobalStateEntity } from '@/typing';\nimport type { WorkflowCustomDragService } from '@/services';\n\nimport type {\n  WorkflowClipboardNodeJSON,\n  WorkflowClipboardSource,\n} from '../../../type';\n\nexport interface NodeValidationContext {\n  node: WorkflowClipboardNodeJSON;\n  source: WorkflowClipboardSource;\n  globalState: WorkflowGlobalStateEntity;\n  dragService: WorkflowCustomDragService;\n  parent?: WorkflowNodeEntity;\n}\n\nexport interface NodeValidator {\n  run: (context: NodeValidationContext) => boolean;\n  setNext: (validator: NodeValidator) => NodeValidator;\n}\n\nexport abstract class BaseNodeValidator implements NodeValidator {\n  protected next: NodeValidator | null = null;\n\n  setNext(validator: NodeValidator): NodeValidator {\n    this.next = validator;\n    return validator;\n  }\n\n  run(context: NodeValidationContext): boolean {\n    const result = this.validate(context);\n    if (result !== null) {\n      return result;\n    }\n    return this.next?.run(context) ?? true;\n  }\n\n  protected abstract validate(context: NodeValidationContext): boolean | null;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ApiNodeData } from '@coze-workflow/nodes';\nimport { StandardNodeType } from '@coze-workflow/base';\nimport { PluginProductStatus } from '@coze-arch/idl/developer_api';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class ApiNodeValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node } = context;\n\n    if (node.type !== StandardNodeType.Api) {\n      return null;\n    }\n\n    // Cross-spatial copying of unshelved plug-in nodes is not allowed\n    const apiNodeData = node._temp.externalData as ApiNodeData;\n    const isListed =\n      apiNodeData?.pluginProductStatus === PluginProductStatus.Listed;\n    return isListed;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class CrossSpaceNodeValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node } = context;\n\n    // Nodes that do not allow cross-spatial replication\n    if (\n      [\n        StandardNodeType.Dataset,\n        StandardNodeType.DatasetWrite,\n        StandardNodeType.Database,\n        StandardNodeType.DatabaseQuery,\n        StandardNodeType.DatabaseCreate,\n        StandardNodeType.DatabaseUpdate,\n        StandardNodeType.DatabaseDelete,\n        StandardNodeType.SubWorkflow,\n        StandardNodeType.Imageflow,\n      ].includes(node.type as StandardNodeType)\n    ) {\n      return false;\n    }\n\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class DropValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node, dragService, parent } = context;\n\n    const canDropInfo = dragService.canDropToNode({\n      dragNodeType: node.type as StandardNodeType,\n      dropNode: parent,\n    });\n    if (!canDropInfo.allowDrop) {\n      return false;\n    }\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class LoopContextValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node, parent } = context;\n    const nodeType = node.type as StandardNodeType;\n\n    if (!parent) {\n      return null;\n    }\n\n    // Break/SetVariable/Continue Only allowed in Loop SubCanvas\n    if (\n      [\n        StandardNodeType.Break,\n        StandardNodeType.Continue,\n        StandardNodeType.SetVariable,\n      ].includes(nodeType)\n    ) {\n      const parentNodeMeta = parent.getNodeMeta();\n      const parentSubCanvas = parentNodeMeta.subCanvas?.(parent);\n      return (\n        parentSubCanvas?.isCanvas &&\n        parentSubCanvas.parentNode.flowNodeType === StandardNodeType.Loop\n      );\n    }\n\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class NestedLoopBatchValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node, parent } = context;\n    const nodeType = node.type as StandardNodeType;\n\n    if (!parent) {\n      return null;\n    }\n\n    // Loop/Batch do not allow nesting\n    if ([StandardNodeType.Loop, StandardNodeType.Batch].includes(nodeType)) {\n      return parent.flowNodeType !== FlowNodeBaseType.SUB_CANVAS;\n    }\n\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class SameSpaceValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { source, globalState } = context;\n\n    return source.spaceId === globalState.spaceId ? true : null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class SameWorkflowValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { source, globalState } = context;\n    return source.workflowId === globalState.workflowId ? true : null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class SceneNodeValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node } = context;\n\n    // Replication of scene workflow-specific nodes across workflows is not allowed\n    if (\n      node.type === StandardNodeType.SceneChat ||\n      node.type === StandardNodeType.SceneVariable\n    ) {\n      return false;\n    }\n\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  BaseNodeValidator,\n  type NodeValidationContext,\n} from './base-validator';\n\nexport class SubWorkflowSelfRefValidator extends BaseNodeValidator {\n  protected validate(context: NodeValidationContext): boolean | null {\n    const { node, globalState } = context;\n\n    // Do not allow a workflow to reference itself as a child workflow\n    if (\n      node.type === StandardNodeType.SubWorkflow &&\n      node.data?.inputs?.workflowId === globalState.workflowId\n    ) {\n      return false;\n    }\n\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseNodeValidator } from './base-validator';\n\nexport class ValidationChain extends BaseNodeValidator {\n  protected validate(): boolean | null {\n    return null;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport type { WorkflowCustomDragService } from '@/services';\nimport type { WorkflowGlobalStateEntity } from '@/typing';\n\nimport type {\n  WorkflowClipboardNodeJSON,\n  WorkflowClipboardSource,\n} from '../../type';\nimport {\n  ApiNodeValidator,\n  CrossSpaceNodeValidator,\n  DropValidator,\n  LoopContextValidator,\n  NestedLoopBatchValidator,\n  SameSpaceValidator,\n  SameWorkflowValidator,\n  SceneNodeValidator,\n  SubWorkflowSelfRefValidator,\n} from './validators';\nimport { ValidationChain } from './validators/validation-chain';\n\n/** Is it a legal node? */\nexport const isValidNode = (params: {\n  node: WorkflowClipboardNodeJSON;\n  parent?: WorkflowNodeEntity;\n  source: WorkflowClipboardSource;\n  globalState: WorkflowGlobalStateEntity;\n  dragService: WorkflowCustomDragService;\n}): boolean => {\n  const validationChain = new ValidationChain();\n  validationChain\n    // 1. Same space, same workflow\n    .setNext(new DropValidator())\n    .setNext(new LoopContextValidator())\n    .setNext(new NestedLoopBatchValidator())\n    .setNext(new SubWorkflowSelfRefValidator())\n    // 2. Same space, different workflows\n    .setNext(new SameWorkflowValidator())\n    .setNext(new SceneNodeValidator())\n    // 3. Cross-spatial space\n    .setNext(new SameSpaceValidator())\n    .setNext(new ApiNodeValidator())\n    .setNext(new CrossSpaceNodeValidator());\n\n  return validationChain.run(params);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { type WorkflowGlobalStateEntity } from '@/typing';\n\nimport { type WorkflowClipboardData } from '../../type';\nimport { WORKFLOW_CLIPBOARD_TYPE } from '../../constant';\n\n/** Check if the data is legitimate */\nexport const isValidData = (params: {\n  data: WorkflowClipboardData;\n  globalState: WorkflowGlobalStateEntity;\n}): boolean => {\n  const { data, globalState } = params;\n  if (data.type !== WORKFLOW_CLIPBOARD_TYPE) {\n    return false;\n  }\n  // The cross-domain name represents different environments, and the plug-ins on the shelves are different and cannot be copied.\n  if (data.source.host !== window.location.host) {\n    return false;\n  }\n  // Douyin space is not compatible with normal space\n  if (data.source.isDouyin !== globalState.isBindDouyin) {\n    Toast.warning({\n      content: I18n.t(\n        'workflow_node_copy_othercanva',\n        {},\n        '',\n      ),\n      showClose: false,\n    });\n    return false;\n  }\n  // Different canvas types cannot be copied\n  if (data.source.flowMode !== globalState.flowMode) {\n    Toast.warning({\n      content: I18n.t(\n        'workflow_node_copy_othercanva',\n        {},\n        '',\n      ),\n      showClose: false,\n    });\n    return false;\n  }\n  return true;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  FlowNodeBaseType,\n  FlowNodeTransformData,\n} from '@flowgram-adapter/free-layout-editor';\nimport { EntityManager } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowCommands,\n  WorkflowDocument,\n  type WorkflowEdgeJSON,\n  WorkflowHoverService,\n  type WorkflowLineEntity,\n  type WorkflowLinePortInfo,\n  WorkflowLinesManager,\n  WorkflowNodeEntity,\n  type WorkflowNodeMeta,\n  WorkflowSelectService,\n  type WorkflowSubCanvas,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  delay,\n  type IPoint,\n  type PositionSchema,\n  Rectangle,\n} from '@flowgram-adapter/common';\nimport {\n  type WorkflowShortcutsContribution,\n  type WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\nimport { type WorkflowNodeJSON } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\nimport {\n  WorkflowCustomDragService,\n  WorkflowEditService,\n  WorkflowSaveService,\n} from '@/services';\n\nimport { generateUniqueWorkflow } from '../../utils/unique-workflow';\nimport { safeFn } from '../../utils';\nimport type {\n  WorkflowClipboardData,\n  WorkflowClipboardJSON,\n  WorkflowClipboardNodeJSON,\n  WorkflowClipboardRect,\n  WorkflowClipboardSource,\n} from '../../type';\nimport { isValidNode } from './is-valid-node';\nimport { isValidData } from './is-valid-data';\n\n/**\n * Paste shortcut\n */\n@injectable()\nexport class WorkflowPasteShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  @inject(EntityManager) private entityManager: EntityManager;\n  @inject(WorkflowLinesManager) private linesManager: WorkflowLinesManager;\n  @inject(WorkflowDocument) private document: WorkflowDocument;\n  @inject(WorkflowHoverService) private hoverService: WorkflowHoverService;\n  @inject(WorkflowCustomDragService)\n  private dragService: WorkflowCustomDragService;\n  @inject(WorkflowSelectService) private selection: WorkflowSelectService;\n  @inject(WorkflowEditService) private editService: WorkflowEditService;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowSaveService) private saveService: WorkflowSaveService;\n\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowCommands.PASTE_NODES,\n      shortcuts: ['meta v', 'ctrl v'],\n      isEnabled: () => !this.globalState.readonly,\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  /** render */\n  public async render(params: {\n    json: WorkflowClipboardJSON;\n    source: WorkflowClipboardSource;\n    titleCache?: string[];\n    offset?: IPoint;\n    parent?: WorkflowNodeEntity;\n    toContainer?: WorkflowNodeEntity;\n  }): Promise<WorkflowNodeEntity[]> {\n    const {\n      json,\n      source,\n      titleCache = [],\n      offset = { x: 0, y: 0 },\n      parent,\n      toContainer,\n    } = params;\n    const nodes: WorkflowNodeEntity[] = await this.createNodes({\n      json: json.nodes,\n      source,\n      titleCache,\n      offset,\n      parent,\n      toContainer,\n    });\n    await this.nextTick(); // Waiting for node rendering and dynamic port rendering\n    this.createLines({\n      json: json.edges,\n      parent,\n    });\n    return nodes;\n  }\n  /** Apply clipboard data */\n  public async apply(\n    data: WorkflowClipboardData,\n  ): Promise<WorkflowNodeEntity[]> {\n    const { source, json: rawJSON } = data;\n    const json = generateUniqueWorkflow({\n      json: rawJSON,\n      isUniqueId: (id: string) => !this.entityManager.getEntityById(id),\n    });\n\n    // You need to initialize the node data before rebuilding the node\n    await this.saveService.initNodeData(json.nodes as WorkflowNodeJSON[]);\n\n    const titleCache: string[] = [];\n    const offset = this.calcPasteOffset(data.bounds);\n    const container = this.getSelectedContainer();\n    const nodes = await this.render({\n      json,\n      source,\n      titleCache,\n      offset,\n      parent: container,\n      toContainer: container,\n    });\n    this.selectNodes(nodes);\n    return nodes;\n  }\n  /** Handling replication events */\n  private async handle(\n    _event: KeyboardEvent,\n  ): Promise<WorkflowNodeEntity[] | undefined> {\n    const data = await this.tryReadClipboard();\n    if (!data) {\n      return;\n    }\n    if (!isValidData({ data, globalState: this.globalState })) {\n      return;\n    }\n    const nodes = await this.apply(data);\n    if (nodes.length > 0) {\n      Toast.success({\n        content: I18n.t('copy_success'),\n        showClose: false,\n      });\n      // Scroll to viewable area\n      this.scrollToNodes(nodes);\n    }\n    return nodes;\n  }\n  /** Try reading the clipboard */\n  private async tryReadClipboard(): Promise<WorkflowClipboardData | undefined> {\n    try {\n      // The user is required to grant the webpage clipboard read permission. If the user does not grant permission, the code may throw an exception NotAllowedError.\n      const text: string = (await navigator.clipboard.readText()) || '';\n      const clipboardData: WorkflowClipboardData = JSON.parse(text);\n      return clipboardData;\n      // eslint-disable-next-line @coze-arch/use-error-in-catch -- no need report error\n    } catch (e) {\n      // The data in the clipboard itself is not fixed, so there is no need to report an error.\n      return;\n    }\n  }\n  /** Calculate Paste Offset */\n  private calcPasteOffset(boundsData: WorkflowClipboardRect): IPoint {\n    const { x, y, width, height } = boundsData;\n    const rect = new Rectangle(x, y, width, height);\n    const { center } = rect;\n    const mousePos = this.hoverService.hoveredPos;\n    return {\n      x: mousePos.x - center.x,\n      y: mousePos.y - center.y,\n    };\n  }\n  /** Create Node */\n  private async createNodes(params: {\n    json: WorkflowClipboardNodeJSON[];\n    source: WorkflowClipboardSource;\n    titleCache: string[];\n    offset: IPoint;\n    parent?: WorkflowNodeEntity;\n    toContainer?: WorkflowNodeEntity;\n  }): Promise<WorkflowNodeEntity[]> {\n    const { json, source, titleCache, offset, parent, toContainer } = params;\n    const nodes: WorkflowNodeEntity[] = [];\n    await Promise.all(\n      json\n        .map(async (rawNodeJSON: WorkflowClipboardNodeJSON) => {\n          const { blocks, edges, ...nodeJSON } = rawNodeJSON;\n          const node = await this.createNode({\n            nodeJSON,\n            source,\n            titleCache,\n            offset,\n            parent,\n            toContainer,\n          });\n          if (!node) {\n            return;\n          }\n          const subCanvas = this.getNodeSubCanvas(node);\n          if (subCanvas) {\n            nodes.push(subCanvas.canvasNode);\n          }\n          if (blocks?.length) {\n            const container = this.getNodeSubCanvas(node)?.canvasNode ?? node;\n            this.render({\n              json: {\n                nodes: blocks,\n                edges: edges ?? [],\n              },\n              source,\n              titleCache,\n              offset,\n              parent: container,\n            });\n          }\n          nodes.push(node);\n        })\n        .filter(Boolean),\n    );\n    return nodes;\n  }\n  /** Get node child canvas information */\n  private getNodeSubCanvas(\n    node: WorkflowNodeEntity,\n  ): WorkflowSubCanvas | undefined {\n    if (!node) {\n      return;\n    }\n    const nodeMeta = node.getNodeMeta<WorkflowNodeMeta>();\n    const subCanvas = nodeMeta.subCanvas?.(node);\n    return subCanvas;\n  }\n  /** Create Node */\n  private async createNode(params: {\n    nodeJSON: WorkflowClipboardNodeJSON;\n    source: WorkflowClipboardSource;\n    titleCache: string[];\n    offset: IPoint;\n    parent?: WorkflowNodeEntity;\n    toContainer?: WorkflowNodeEntity;\n  }): Promise<WorkflowNodeEntity | undefined> {\n    const { nodeJSON, source, titleCache, offset, parent, toContainer } =\n      params;\n    if (\n      !isValidNode({\n        node: nodeJSON,\n        parent,\n        source,\n        globalState: this.globalState,\n        dragService: this.dragService,\n      })\n    ) {\n      return;\n    }\n    // Generate unique node titles\n    const processedNodeJSON = this.editService.recreateNodeJSON(\n      nodeJSON,\n      titleCache,\n      false,\n    );\n    if (processedNodeJSON.meta?.canvasPosition) {\n      processedNodeJSON.meta.canvasPosition = {\n        x: processedNodeJSON.meta.canvasPosition.x + offset.x,\n        y: processedNodeJSON.meta.canvasPosition.y + offset.y,\n      };\n    }\n    const nodePosition = this.calcNodePosition({\n      nodeJSON,\n      offset,\n      parent,\n      toContainer,\n    });\n    const node = await this.document.copyNodeFromJSON(\n      nodeJSON.type as string,\n      processedNodeJSON,\n      nodeJSON.id,\n      nodePosition,\n      parent?.id,\n    );\n    return node;\n  }\n  /** Create a connection */\n  private createLines(params: {\n    json: WorkflowEdgeJSON[];\n    parent?: WorkflowNodeEntity;\n  }): WorkflowLineEntity[] {\n    const { json, parent } = params;\n    return json\n      .map(edgeJSON => this.createLine({ edgeJSON, parent }))\n      .filter(Boolean) as WorkflowLineEntity[];\n  }\n  /** Create a connection */\n  private createLine(params: {\n    edgeJSON: WorkflowEdgeJSON;\n    parent?: WorkflowNodeEntity;\n  }): WorkflowLineEntity | undefined {\n    const { edgeJSON, parent } = params;\n    const fromNode = this.entityManager.getEntityById<WorkflowNodeEntity>(\n      edgeJSON.sourceNodeID,\n    );\n    const toNode = this.entityManager.getEntityById<WorkflowNodeEntity>(\n      edgeJSON.targetNodeID,\n    );\n    if (!fromNode || !toNode) {\n      return;\n    }\n    const lineInfo: WorkflowLinePortInfo = {\n      from: edgeJSON.sourceNodeID,\n      fromPort: edgeJSON.sourcePortID,\n      to: edgeJSON.targetNodeID,\n      toPort: edgeJSON.targetPortID,\n    };\n    if (!parent) {\n      return this.linesManager.createLine(lineInfo);\n    }\n    // To connect between parent and child nodes, you need to replace the parent node with the child canvas\n    const parentSubCanvas = this.getNodeSubCanvas(parent);\n    if (!parentSubCanvas) {\n      return this.linesManager.createLine(lineInfo);\n    }\n    if (lineInfo.from === parentSubCanvas.parentNode.id) {\n      return this.linesManager.createLine({\n        ...lineInfo,\n        from: parentSubCanvas.canvasNode.id,\n      });\n    }\n    if (lineInfo.to === parentSubCanvas.parentNode.id) {\n      return this.linesManager.createLine({\n        ...lineInfo,\n        to: parentSubCanvas.canvasNode.id,\n      });\n    }\n    return this.linesManager.createLine(lineInfo);\n  }\n  /** Calculate node location */\n  private calcNodePosition(params: {\n    nodeJSON: WorkflowClipboardNodeJSON;\n    parent?: WorkflowNodeEntity;\n    offset: IPoint;\n    toContainer?: WorkflowNodeEntity;\n  }): PositionSchema {\n    const { nodeJSON, parent, offset, toContainer } = params;\n\n    if (!nodeJSON.meta?.position) {\n      return this.hoverService.hoveredPos;\n    }\n\n    const bounds = new Rectangle(\n      nodeJSON._temp.bounds.x,\n      nodeJSON._temp.bounds.y,\n      nodeJSON._temp.bounds.width,\n      nodeJSON._temp.bounds.height,\n    );\n\n    const basePosition: PositionSchema =\n      parent && !toContainer\n        ? nodeJSON.meta.position\n        : {\n            x: offset.x + bounds.center.x,\n            y: offset.y + bounds.y,\n          };\n\n    if (toContainer) {\n      return this.dragService.adjustSubNodePosition(\n        nodeJSON.type as string,\n        toContainer,\n        basePosition,\n      );\n    }\n\n    return basePosition;\n  }\n  /** Get the container selected by the mouse */\n  private getSelectedContainer(): WorkflowNodeEntity | undefined {\n    const { activatedNode } = this.selection;\n    if (activatedNode?.flowNodeType === FlowNodeBaseType.SUB_CANVAS) {\n      return activatedNode;\n    }\n  }\n  /** Get the selected node */\n  private get selectedNodes(): WorkflowNodeEntity[] {\n    return this.selection.selection.filter(\n      n => n instanceof WorkflowNodeEntity,\n    ) as WorkflowNodeEntity[];\n  }\n  /** selected node */\n  private selectNodes(nodes: WorkflowNodeEntity[]): void {\n    if (nodes.length === 1) {\n      this.editService.focusNode(nodes[0]);\n    } else {\n      this.selection.selection = nodes;\n    }\n  }\n  /** Scroll to Node */\n  private async scrollToNodes(nodes: WorkflowNodeEntity[]): Promise<void> {\n    const nodeBounds = nodes.map(\n      node => node.getData(FlowNodeTransformData).bounds,\n    );\n    await this.document.playgroundConfig.scrollToView({\n      bounds: Rectangle.enlarge(nodeBounds),\n    });\n  }\n  /** Wait for the next frame. */\n  private async nextTick(): Promise<void> {\n    const frameTime = 16; // 16ms for a render frame\n    await delay(frameTime);\n    await new Promise(resolve => requestAnimationFrame(resolve));\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { LayoutNode } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport type { WorkflowNodeMeta } from '@coze-workflow/nodes';\n\nexport const subCanvasHandler = (node: LayoutNode) => {\n  if (node.entity.flowNodeType !== FlowNodeBaseType.SUB_CANVAS) {\n    return;\n  }\n  const nodeMeta = node.entity.getNodeMeta<WorkflowNodeMeta>();\n  const subCanvas = nodeMeta.subCanvas?.(node.entity);\n  return {\n    followTo: subCanvas?.parentNode.id,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  LayoutNode,\n  LayoutStore,\n} from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { QuadTree } from './quad-tree';\n\nexport interface CommentContext {\n  store: LayoutStore;\n  quadTree: QuadTree;\n}\n\nconst getQuadTree = (context: CommentContext): QuadTree => {\n  const nodes = context.store.nodes.filter(\n    node =>\n      ![StandardNodeType.Comment, FlowNodeBaseType.SUB_CANVAS].includes(\n        node.entity.flowNodeType as StandardNodeType | FlowNodeBaseType,\n      ),\n  );\n  context.quadTree = QuadTree.create(nodes);\n  return context.quadTree;\n};\n\nexport const commentNodeHandler = (\n  node: LayoutNode,\n  context: CommentContext,\n) => {\n  if (node.entity.flowNodeType !== StandardNodeType.Comment) {\n    return;\n  }\n  const quadTree = getQuadTree(context);\n  const followToNode = QuadTree.find(quadTree, node);\n  if (!followToNode) {\n    return;\n  }\n  // Add a small offset to prevent the following node from changing after triggering twice in a row\n  node.offset = {\n    x: 0,\n    y: -5,\n  };\n  return {\n    followTo: followToNode.id,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { GetFollowNode } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport { subCanvasHandler } from './sub-canvas-handler';\nimport {\n  type CommentContext,\n  commentNodeHandler,\n} from './comment-node-handler';\n\nexport const getFollowNode: GetFollowNode = (node, context) => {\n  if (node.entity.flowNodeType === FlowNodeBaseType.SUB_CANVAS) {\n    return subCanvasHandler(node);\n  }\n  if (node.entity.flowNodeType === StandardNodeType.Comment) {\n    return commentNodeHandler(node, context as CommentContext);\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  FreeOperationType,\n  HistoryService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { AutoLayoutService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  type PositionSchema,\n  TransformData,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  type WorkflowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\n\nimport { safeFn } from '../../utils';\nimport { getFollowNode } from './get-follow-node';\n\n/**\n * Auto layout shortcuts\n */\n@injectable()\nexport class WorkflowLayoutShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  public static readonly type = 'LAYOUT';\n\n  @inject(WorkflowDocument) private document: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  @inject(AutoLayoutService) private autoLayoutService: AutoLayoutService;\n  @inject(HistoryService) private historyService: HistoryService;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowLayoutShortcutsContribution.type,\n      shortcuts: ['alt shift f'],\n      isEnabled: () => !this.globalState.readonly,\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  private async handle(): Promise<void> {\n    await this.autoLayout();\n  }\n  public async autoLayout(): Promise<void> {\n    const nodes = this.document.getAllNodes();\n    const startPositions = nodes.map(this.getNodePosition);\n    await this.autoLayoutService.layout({\n      getFollowNode,\n    });\n    const endPositions = nodes.map(this.getNodePosition);\n    this.updateHistory({\n      nodes,\n      startPositions,\n      endPositions,\n    });\n  }\n  private getNodePosition(node: WorkflowNodeEntity): PositionSchema {\n    const transform = node.getData(TransformData);\n    return {\n      x: transform.position.x,\n      y: transform.position.y,\n    };\n  }\n  private updateHistory(params: {\n    nodes: WorkflowNodeEntity[];\n    startPositions: PositionSchema[];\n    endPositions: PositionSchema[];\n  }): void {\n    const { nodes, startPositions: oldValue, endPositions: value } = params;\n    const ids = nodes.map(node => node.id);\n    this.historyService.pushOperation(\n      {\n        type: FreeOperationType.dragNodes,\n        value: {\n          ids,\n          value,\n          oldValue,\n        },\n      },\n      {\n        noApply: true,\n      },\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base';\n\n/** Is there a system node? */\nexport const hasSystemNodes = (nodes: WorkflowNodeEntity[]): boolean =>\n  nodes.some(n =>\n    [StandardNodeType.Start, StandardNodeType.End].includes(\n      n.flowNodeType as StandardNodeType,\n    ),\n  );\n\nexport const isAllSystemNodes = (nodes: WorkflowNodeEntity[]): boolean =>\n  nodes.every(n =>\n    [StandardNodeType.Start, StandardNodeType.End].includes(\n      n.flowNodeType as StandardNodeType,\n    ),\n  );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { hasSystemNodes, isAllSystemNodes } from '../copy/is-system-nodes';\n\nexport const isValid = (nodes: WorkflowNodeEntity[]): boolean => {\n  if (isAllSystemNodes(nodes)) {\n    Toast.warning({\n      content: I18n.t('workflow_multi_choice_delete_failed'),\n      showClose: false,\n    });\n    return false;\n  } else if (hasSystemNodes(nodes)) {\n    Toast.warning({\n      content: I18n.t('workflow_multi_choice_delete_failed'),\n      showClose: false,\n    });\n    return true;\n  }\n  return true;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  WorkflowCommands,\n  WorkflowDocument,\n  WorkflowLineEntity,\n  WorkflowNodeEntity,\n  type WorkflowNodeMeta,\n  WorkflowSelectService,\n} from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\n\nimport { safeFn } from '../../utils';\nimport { isValid } from './is-valid';\n\n/**\n * Remove shortcuts\n */\n@injectable()\nexport class WorkflowDeleteShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  @inject(WorkflowDocument) private document: WorkflowDocument;\n  @inject(WorkflowSelectService) private selection: WorkflowSelectService;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowCommands.DELETE_NODES,\n      shortcuts: ['backspace', 'delete'],\n      isEnabled: () => !this.globalState.readonly,\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  private handle(): void {\n    if (!isValid(this.selectedNodes)) {\n      return;\n    }\n    // Delete the selected entity\n    this.selection.selection.forEach(entity => {\n      if (entity instanceof WorkflowNodeEntity) {\n        this.removeNode(entity);\n      } else if (entity instanceof WorkflowLineEntity) {\n        this.removeLine(entity);\n      } else {\n        entity.dispose();\n      }\n    });\n    // Filter out deleted entities\n    this.selection.selection = this.selection.selection.filter(\n      s => !s.disposed,\n    );\n  }\n  /** Get the selected node */\n  private get selectedNodes(): WorkflowNodeEntity[] {\n    return this.selection.selection.filter(\n      n => n instanceof WorkflowNodeEntity,\n    ) as WorkflowNodeEntity[];\n  }\n  /** Delete Node */\n  private removeNode(node: WorkflowNodeEntity): void {\n    if (!this.document.canRemove(node)) {\n      return;\n    }\n    const nodeMeta = node.getNodeMeta<WorkflowNodeMeta>();\n    const subCanvas = nodeMeta.subCanvas?.(node);\n    if (subCanvas?.isCanvas) {\n      subCanvas.parentNode.dispose();\n      return;\n    }\n    node.dispose();\n  }\n  /** Delete Connection */\n  private removeLine(line: WorkflowLineEntity): void {\n    if (!this.document.linesManager.canRemove(line)) {\n      return;\n    }\n    line.dispose();\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowNodeEntity,\n  WorkflowNodeMeta,\n} from '@flowgram-adapter/free-layout-editor';\nimport { StandardNodeType } from '@coze-workflow/base';\n\n/** Get available nodes */\nexport const getValidNodes = (\n  nodes: WorkflowNodeEntity[],\n): WorkflowNodeEntity[] =>\n  nodes.filter(n => {\n    if (\n      [\n        StandardNodeType.Start,\n        StandardNodeType.End,\n        FlowNodeBaseType.SUB_CANVAS,\n      ].includes(n.flowNodeType as StandardNodeType)\n    ) {\n      return false;\n    }\n    if (n.getNodeMeta<WorkflowNodeMeta>().copyDisable) {\n      return false;\n    }\n    return true;\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\nimport type { WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { isAllSystemNodes } from './is-system-nodes';\nimport { getValidNodes } from './get-valid-nodes';\n\nexport const isValid = (nodes: WorkflowNodeEntity[]): boolean => {\n  if (isAllSystemNodes(nodes)) {\n    Toast.warning({\n      content: I18n.t('workflow_multi_choice_copy_failed'),\n      showClose: false,\n    });\n    return false;\n  }\n  const validNodes = getValidNodes(nodes);\n  const nodeCount = validNodes.length;\n  if (nodeCount === 0) {\n    return false;\n  }\n  return true;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { TransformData } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowCommands,\n  WorkflowDocument,\n  type WorkflowEdgeJSON,\n  type WorkflowLineEntity,\n  WorkflowNodeEntity,\n  WorkflowNodeLinesData,\n  WorkflowSelectService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { Rectangle } from '@flowgram-adapter/common';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\nimport { WorkflowNodeData } from '@coze-workflow/nodes';\nimport type { StandardNodeType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\n\nimport { safeFn } from '../../utils';\nimport type {\n  WorkflowClipboardData,\n  WorkflowClipboardJSON,\n  WorkflowClipboardNodeTemporary,\n  WorkflowClipboardNodeJSON,\n  WorkflowClipboardRect,\n  WorkflowClipboardSource,\n} from '../../type';\nimport { WORKFLOW_CLIPBOARD_TYPE } from '../../constant';\nimport { isValid } from './is-valid';\nimport { hasSystemNodes } from './is-system-nodes';\nimport { getValidNodes } from './get-valid-nodes';\n\n/**\n * Copy shortcut\n */\n@injectable()\nexport class WorkflowCopyShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  @inject(WorkflowDocument) private document: WorkflowDocument;\n  @inject(WorkflowSelectService) private selection: WorkflowSelectService;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowCommands.COPY_NODES,\n      shortcuts: ['meta c', 'ctrl c'],\n      isEnabled: () => !this.globalState.readonly,\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  public async toData(): Promise<WorkflowClipboardData> {\n    const validNodes = getValidNodes(this.selectedNodes);\n    const source = this.toSource();\n    const json = await this.toJSON(validNodes);\n    const bounds = this.getEntireBounds(validNodes);\n    return {\n      type: WORKFLOW_CLIPBOARD_TYPE,\n      source,\n      json,\n      bounds,\n    };\n  }\n  /** Access to source data */\n  public toSource(): WorkflowClipboardSource {\n    return {\n      workflowId: this.globalState.workflowId,\n      flowMode: this.globalState.flowMode,\n      spaceId: this.globalState.spaceId,\n      isDouyin: this.globalState.isBindDouyin,\n      host: window.location.host,\n    };\n  }\n  /** Get the node's JSON */\n  public async toJSON(\n    nodes: WorkflowNodeEntity[],\n  ): Promise<WorkflowClipboardJSON> {\n    const nodeJSONs = await this.getNodeJSONs(nodes);\n    const edgeJSONs = this.getEdgeJSONs(nodes);\n    return {\n      nodes: nodeJSONs,\n      edges: edgeJSONs,\n    };\n  }\n  /** Handling replication events */\n  private async handle(): Promise<void> {\n    if (await this.hasTextSelected()) {\n      // If there is a selected text, copy the text first.\n      return;\n    }\n    if (!isValid(this.selectedNodes)) {\n      return;\n    }\n    const data = await this.toData();\n    await this.write(data);\n  }\n  /** Write to clipboard */\n  private async write(data: WorkflowClipboardData): Promise<void> {\n    try {\n      await navigator.clipboard.writeText(JSON.stringify(data));\n      if (hasSystemNodes(this.selectedNodes)) {\n        Toast.warning({\n          content: I18n.t('workflow_multi_choice_copy_partial_success'),\n          showClose: false,\n        });\n      } else {\n        Toast.success({\n          content: I18n.t('workflow_multi_choice_copy_success'),\n          showClose: false,\n        });\n      }\n    } catch (err) {\n      console.error('Failed to write text: ', err);\n    }\n  }\n  /** Is there any selected text? */\n  private async hasTextSelected(): Promise<boolean> {\n    if (!window.getSelection()?.toString()) {\n      return false;\n    }\n    await navigator.clipboard.writeText(\n      window.getSelection()?.toString() ?? '',\n    );\n    Toast.success({\n      content: I18n.t('workflow_text_copy', {}, ''),\n    });\n    return true;\n  }\n  /** Get the selected node */\n  private get selectedNodes(): WorkflowNodeEntity[] {\n    return this.selection.selection.filter(\n      n => n instanceof WorkflowNodeEntity,\n    ) as WorkflowNodeEntity[];\n  }\n  /** Get the node's JSON */\n  private async getNodeJSONs(\n    nodes: WorkflowNodeEntity[],\n  ): Promise<WorkflowClipboardNodeJSON[]> {\n    const nodeJSONs = await Promise.all(\n      nodes.map(node => this.tryToNodeJSON(node)),\n    );\n    return nodeJSONs.filter(Boolean) as WorkflowClipboardNodeJSON[];\n  }\n  /** Get the node's JSON */\n  private async toNodeJSON(\n    node: WorkflowNodeEntity,\n  ): Promise<WorkflowClipboardNodeJSON> {\n    const nodeJSON = (await this.document.toNodeJSON(\n      node,\n    )) as WorkflowClipboardNodeJSON;\n    nodeJSON._temp = this.getNodeTemporary(node);\n\n    // Recursive processing of blocks at all nested levels\n    if (nodeJSON.blocks?.length) {\n      await Promise.all(\n        nodeJSON.blocks.map(async childJSON => {\n          const child = this.document.getNode(childJSON.id);\n          if (!child) {\n            return;\n          }\n          childJSON._temp = this.getNodeTemporary(child);\n\n          // Recursive processing of sub-node blocks\n          if (childJSON.blocks?.length) {\n            await this.processBlocksRecursively(childJSON.blocks);\n          }\n        }),\n      );\n    }\n    return nodeJSON;\n  }\n  /** Recursive processing blocks */\n  private async processBlocksRecursively(\n    blocks: WorkflowClipboardNodeJSON[],\n  ): Promise<void> {\n    await Promise.all(\n      blocks.map(async blockJSON => {\n        const node = this.document.getNode(blockJSON.id);\n        if (!node) {\n          return;\n        }\n        blockJSON._temp = this.getNodeTemporary(node);\n\n        if (blockJSON.blocks?.length) {\n          await this.processBlocksRecursively(blockJSON.blocks);\n        }\n      }),\n    );\n  }\n  private async tryToNodeJSON(\n    node: WorkflowNodeEntity,\n  ): Promise<WorkflowClipboardNodeJSON | undefined> {\n    try {\n      return await this.toNodeJSON(node);\n      // eslint-disable-next-line @coze-arch/use-error-in-catch -- ignore error\n    } catch (err) {\n      return;\n    }\n  }\n  /** Get additional data for the node */\n  private getNodeTemporary(\n    node: WorkflowNodeEntity,\n  ): WorkflowClipboardNodeTemporary {\n    const bounds = this.getNodeBounds(node);\n    const nodeDataEntity = node.getData<WorkflowNodeData>(WorkflowNodeData);\n    const externalData = nodeDataEntity.getNodeData<StandardNodeType.Api>();\n    return {\n      bounds,\n      externalData,\n    };\n  }\n  /** Get the node's rectangle */\n  private getNodeBounds(node: WorkflowNodeEntity): WorkflowClipboardRect {\n    const nodeData = node.getData<TransformData>(TransformData);\n    return {\n      x: nodeData.bounds.x,\n      y: nodeData.bounds.y,\n      width: nodeData.bounds.width,\n      height: nodeData.bounds.height,\n    };\n  }\n  /** Get the edges of all nodes */\n  private getEdgeJSONs(nodes: WorkflowNodeEntity[]): WorkflowEdgeJSON[] {\n    const lineSet = new Set<WorkflowLineEntity>();\n    const nodeIdSet = new Set(nodes.map(n => n.id));\n    nodes.forEach(node => {\n      const linesData = node.getData(WorkflowNodeLinesData);\n      const lines = [...linesData.inputLines, ...linesData.outputLines];\n      lines.forEach(line => {\n        if (\n          nodeIdSet.has(line.from.id) &&\n          line.to?.id &&\n          nodeIdSet.has(line.to.id)\n        ) {\n          lineSet.add(line);\n        }\n      });\n    });\n    return Array.from(lineSet).map(line => line.toJSON());\n  }\n  /** Get the rectangle of all nodes */\n  private getEntireBounds(nodes: WorkflowNodeEntity[]): WorkflowClipboardRect {\n    const bounds = nodes.map(\n      node => node.getData<TransformData>(TransformData).bounds,\n    );\n    const rect = Rectangle.enlarge(bounds);\n    return {\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height,\n    };\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { PlaygroundConfigEntity } from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowCommands } from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\n\nimport { safeFn } from '../../utils';\n\n/**\n * Zoom shortcut\n */\n@injectable()\nexport class WorkflowZoomShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  @inject(PlaygroundConfigEntity)\n  private playgroundConfig: PlaygroundConfigEntity;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowCommands.ZOOM_IN,\n      shortcuts: ['meta =', 'ctrl ='],\n      execute: safeFn(this.zoomIn.bind(this)),\n    });\n    registry.addHandlers({\n      commandId: WorkflowCommands.ZOOM_OUT,\n      shortcuts: ['meta -', 'ctrl -'],\n      execute: safeFn(this.zoomOut.bind(this)),\n    });\n  }\n  private zoomIn(): void {\n    if (this.playgroundConfig.zoom > 1.9) {\n      return;\n    }\n    this.playgroundConfig.zoomin();\n  }\n  private zoomOut(): void {\n    if (this.playgroundConfig.zoom < 0.1) {\n      return;\n    }\n    this.playgroundConfig.zoomout();\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { FlowNodeBaseType } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  type WorkflowNodeEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\nimport { type WorkflowExportData } from '@/shortcuts/type';\nimport { WORKFLOW_EXPORT_TYPE } from '@/shortcuts/constant';\n\nimport { WorkflowCopyShortcutsContribution } from '../copy';\nimport { safeFn } from '../../utils';\n\n/**\n * Export shortcut\n */\n@injectable()\nexport class WorkflowExportShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  public static readonly type = 'EXPORT';\n\n  @inject(WorkflowDocument)\n  private document: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowCopyShortcutsContribution)\n  private copyShortcuts: WorkflowCopyShortcutsContribution;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowExportShortcutsContribution.type,\n      shortcuts: ['meta shift s', 'ctrl shift s'],\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  private async handle(): Promise<void> {\n    const data = await this.toJSON();\n    this.download({ data, filename: this.filename });\n  }\n  private async toJSON(): Promise<WorkflowExportData> {\n    const source = this.copyShortcuts.toSource();\n    const json = await this.copyShortcuts.toJSON(this.validNodes);\n    const data: WorkflowExportData = {\n      type: WORKFLOW_EXPORT_TYPE,\n      source,\n      json,\n    };\n    return data;\n  }\n  private get validNodes(): WorkflowNodeEntity[] {\n    return this.document.root.blocks.filter(\n      b => b.flowNodeType !== FlowNodeBaseType.SUB_CANVAS,\n    );\n  }\n  private get filename(): string {\n    return `coze-workflow-${this.globalState.workflowId}.flow`;\n  }\n  private download(params: {\n    data: WorkflowExportData;\n    filename: string;\n  }): void {\n    const { data, filename } = params;\n    // Create Blob Object\n    const blob = new Blob([JSON.stringify(data, null, 2)], {\n      type: 'application/json',\n    });\n\n    // Create a download link and trigger the download\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    document.body.appendChild(link);\n    link.click();\n\n    // clean up\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  EntityManager,\n  WorkflowDocument,\n} from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\nimport { type WorkflowExportData } from '@/shortcuts/type';\nimport { WORKFLOW_EXPORT_TYPE } from '@/shortcuts/constant';\nimport { WorkflowOperationService, WorkflowSaveService } from '@/services';\n\nimport { WorkflowPasteShortcutsContribution } from '../paste';\nimport { safeFn } from '../../utils';\n\n/**\n * Load file shortcut\n */\n@injectable()\nexport class WorkflowLoadShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  public static readonly type = 'LOAD';\n\n  @inject(WorkflowPasteShortcutsContribution)\n  private pasteShortcuts: WorkflowPasteShortcutsContribution;\n  @inject(WorkflowDocument)\n  private document: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowSaveService)\n  private saveService: WorkflowSaveService;\n  @inject(WorkflowOperationService) operationService: WorkflowOperationService;\n  @inject(EntityManager) private entityManager: EntityManager;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowLoadShortcutsContribution.type,\n      shortcuts: ['meta shift l', 'ctrl shift l'],\n      isEnabled: () => !this.globalState.readonly,\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  /** process */\n  private async handle(): Promise<void> {\n    const data = await this.load();\n    if (!data) {\n      return;\n    }\n    if (data.json.nodes.length > 200) {\n      // Large workflow, page refresh\n      await this.refresh(data);\n    } else {\n      // Small workflow, re-rendering\n      await this.rerender(data);\n    }\n  }\n  /** refresh */\n  private async refresh(data: WorkflowExportData): Promise<void> {\n    await this.operationService.save(\n      data.json,\n      this.saveService.ignoreStatusTransfer,\n    );\n    await this.globalState.reload();\n    window.location.reload();\n  }\n  /** re-render */\n  private async rerender(data: WorkflowExportData): Promise<void> {\n    this.document.clear();\n    this.entityManager.changeEntityLocked = true;\n    this.pasteShortcuts.render({\n      json: data.json,\n      source: data.source,\n    });\n    this.entityManager.changeEntityLocked = false;\n    await this.saveService.fitView();\n    this.saveService.save();\n  }\n  /** load */\n  private load(): Promise<WorkflowExportData | undefined> {\n    return new Promise((resolve, reject) => {\n      const handleError = (error: Error) => {\n        console.error(error);\n        Toast.error(`Load failed: ${error.message}`);\n        resolve(undefined);\n      };\n\n      const fileInput = document.createElement('input');\n      fileInput.type = 'file';\n      fileInput.accept = '.json,.flow';\n\n      fileInput.addEventListener('change', event => {\n        const file = (event.target as HTMLInputElement).files?.[0];\n\n        if (!file) {\n          resolve(undefined);\n          return;\n        }\n\n        const reader = new FileReader();\n        reader.onload = e => {\n          try {\n            const content: WorkflowExportData = JSON.parse(\n              e.target?.result as string,\n            );\n            if (!this.validate(content)) {\n              handleError(new Error('Invalid file'));\n              return;\n            }\n            resolve(content);\n          } catch (error) {\n            handleError(error as Error);\n          }\n        };\n        reader.onerror = () => handleError(new Error('Read file failed'));\n        reader.readAsText(file);\n      });\n\n      fileInput.click();\n    });\n  }\n  /** validation data */\n  private validate(data: WorkflowExportData): boolean {\n    if (data.type !== WORKFLOW_EXPORT_TYPE) {\n      return false;\n    }\n    return true;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport {\n  WorkflowDocument,\n  WorkflowSelectService,\n} from '@flowgram-adapter/free-layout-editor';\nimport type {\n  WorkflowShortcutsContribution,\n  WorkflowShortcutsRegistry,\n} from '@coze-workflow/render';\n\nimport { WorkflowGlobalStateEntity } from '@/typing';\n\nimport { safeFn } from '../../utils';\n\n/**\n * Select all shortcuts\n */\n@injectable()\nexport class WorkflowSelectAllShortcutsContribution\n  implements WorkflowShortcutsContribution\n{\n  public static readonly type = 'SELECT_ALL';\n\n  @inject(WorkflowDocument)\n  private document: WorkflowDocument;\n  @inject(WorkflowGlobalStateEntity)\n  private globalState: WorkflowGlobalStateEntity;\n  @inject(WorkflowSelectService)\n  private selectService: WorkflowSelectService;\n  /** Registration shortcut */\n  public registerShortcuts(registry: WorkflowShortcutsRegistry): void {\n    registry.addHandlers({\n      commandId: WorkflowSelectAllShortcutsContribution.type,\n      shortcuts: ['meta a', 'ctrl a'],\n      isEnabled: () => !this.globalState.readonly,\n      execute: safeFn(this.handle.bind(this)),\n    });\n  }\n  private handle(): void {\n    const nodes = this.document.root.blocks;\n    this.selectService.selection = nodes;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { type WorkflowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport {\n  generateInputJsonSchema,\n  variableUtils,\n} from '@coze-workflow/variable';\nimport { generateField } from '@coze-workflow/test-run-next';\nimport {\n  ValueExpressionType,\n  type VariableMetaDTO,\n  ViewVariableType,\n} from '@coze-workflow/base';\n\n/**\n * Transform structured inputs into Fields\n * fork from packages/workflow/playground/src/components/test-run/utils/generate-test-form-fields.ts\n * It is necessary to observe the changes of the two in time before the full amount.\n */\n\nexport const generateInputToField = (\n  data: any,\n  { node }: { node: WorkflowNodeEntity },\n) => {\n  if (data.input.type === ValueExpressionType.OBJECT_REF) {\n    const dtoMeta = variableUtils.inputValueToDTO(\n      data,\n      node.context.variableService,\n      { node },\n    );\n    const jsonSchema = generateInputJsonSchema(\n      (dtoMeta || {}) as VariableMetaDTO,\n      (v: any) => ({\n        name: v?.name,\n        ...(v?.input || {}),\n      }),\n    );\n    return generateField({\n      type: ViewVariableType.Object,\n      title: data.title || data.label || data.name,\n      name: data.name,\n      description: data.description,\n      required: data?.required,\n      validateJsonSchema: jsonSchema,\n      extra: {\n        ['x-dto-meta']: dtoMeta,\n      },\n    });\n  }\n\n  const workflowVariable =\n    node.context.variableService.getWorkflowVariableByKeyPath(\n      data.input.content.keyPath,\n      { node },\n    );\n\n  const viewVariable = workflowVariable?.viewMeta;\n  const type: ViewVariableType =\n    variableUtils.getValueExpressionViewType(\n      data.input,\n      node.context.variableService,\n      { node },\n    ) || ViewVariableType.String;\n  const dtoMeta: VariableMetaDTO | undefined =\n    variableUtils.getValueExpressionDTOMeta(\n      data.input,\n      node.context.variableService,\n      { node },\n    );\n\n  const jsonSchema = generateInputJsonSchema(\n    (dtoMeta || {}) as VariableMetaDTO,\n  );\n  return generateField({\n    title: data.title || data.label || data.name,\n    name: data.name,\n    type,\n    required: data?.required,\n    description: data.description,\n    validateJsonSchema: jsonSchema,\n    /**\n     * The location where the variable is partially created can set the default value of the variable\n     * In the position of the reference variable, get the default value as the form default value through meta\n     */\n    defaultValue: viewVariable?.defaultValue,\n    extra: {\n      ['x-dto-meta']: dtoMeta,\n    },\n  });\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isGlobalVariableKey } from '@coze-workflow/variable';\nimport { getSortedInputParameters } from '@coze-workflow/nodes';\nimport { ValueExpressionType } from '@coze-workflow/base';\n\nimport { isStaticObjectRef } from '@/components/test-run/utils/is-static-object-ref';\n\nimport type { WorkflowNodeEntity } from '../types';\nimport { generateInputToField } from './generate-input-to-field';\n\nexport const generateParametersToProperties = (\n  parameters: any[],\n  { node }: { node: WorkflowNodeEntity },\n) => {\n  if (!parameters || !Array.isArray(parameters)) {\n    return {};\n  }\n\n  const fields = parameters.filter(i => {\n    /** Object reference types do not need to be filtered, all static fields need to be filtered */\n    if (i.input?.type === ValueExpressionType.OBJECT_REF) {\n      return !isStaticObjectRef(i);\n    }\n    /** Direct filtering of non-reference types, no direct filtering of reference values */\n    if (i.input?.type !== 'ref' || !i.input?.content) {\n      return false;\n    }\n    /** If the reference is from itself, there is no need to fill it in */\n    const [nodeId] = i.input.content.keyPath || [];\n    if (nodeId && nodeId === node.id) {\n      return false;\n    }\n    if (isGlobalVariableKey(nodeId)) {\n      return false;\n    }\n\n    return true;\n  });\n  const sortedFields = getSortedInputParameters(fields);\n\n  return sortedFields\n    .map(field => generateInputToField(field, { node }))\n    .reduce((properties, field) => {\n      if (field.name) {\n        properties[field.name] = field;\n      }\n      return properties;\n    }, {});\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type IFormSchema,\n  isFormSchemaPropertyEmpty,\n  TestFormFieldName,\n} from '@coze-workflow/test-run-next';\n\nimport type { WorkflowNodeEntity } from '../types';\n\ninterface GroupOptions {\n  node: WorkflowNodeEntity;\n  fnName: string;\n  groupName: string;\n  properties: Required<IFormSchema>['properties'];\n}\n\nconst generateNodeFieldGroup = async (options: GroupOptions) => {\n  const { node, fnName, groupName, properties } = options;\n  const registry = node.getNodeRegistry();\n  const fn = registry?.meta?.test?.[fnName];\n  if (fn) {\n    const group = await fn(node);\n    if (!isFormSchemaPropertyEmpty(group)) {\n      properties[groupName] = {\n        type: 'object',\n        properties: group,\n      };\n    }\n  }\n};\n\ninterface GenerateFormNodeFieldOptions {\n  node: WorkflowNodeEntity;\n}\n\nexport const generateFormNodeField = async ({\n  node,\n}: GenerateFormNodeFieldOptions) => {\n  const properties = {};\n\n  await Promise.all([\n    generateNodeFieldGroup({\n      node,\n      fnName: 'generateFormBatchProperties',\n      groupName: TestFormFieldName.Batch,\n      properties,\n    }),\n    generateNodeFieldGroup({\n      node,\n      fnName: 'generateFormSettingProperties',\n      groupName: TestFormFieldName.Setting,\n      properties,\n    }),\n    generateNodeFieldGroup({\n      node,\n      fnName: 'generateFormInputProperties',\n      groupName: TestFormFieldName.Input,\n      properties,\n    }),\n  ]);\n\n  if (isFormSchemaPropertyEmpty(properties)) {\n    return null;\n  }\n  return {\n    type: 'object',\n    properties,\n    ['x-decorator']: 'NodeFieldCollapse',\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport {\n  type IFormSchema,\n  TestFormFieldName,\n} from '@coze-workflow/test-run-next';\nimport { I18n } from '@coze-arch/i18n';\nimport { IntelligenceType } from '@coze-arch/bot-api/intelligence_api';\ninterface GenerateEnvToRelatedContextPropertiesOptions {\n  isNeedBot: boolean;\n  isNeedConversation?: boolean;\n  hasVariableAssignNode?: boolean;\n  hasLTMNode?: boolean;\n  hasConversationNode?: boolean;\n  disableBot?: boolean;\n  disableBotTooltip?: string;\n  disableProject?: boolean;\n  disableProjectTooltip?: string;\n}\n\nexport const generateEnvToRelatedContextProperties = (\n  options: GenerateEnvToRelatedContextPropertiesOptions,\n) => {\n  const field: IFormSchema = {\n    ['x-component']: 'RelatedFieldCollapse',\n  };\n\n  const { isNeedBot, isNeedConversation } = options;\n  if (!isNeedBot && !isNeedConversation) {\n    return null;\n  }\n  field['x-component-props'] = options as any;\n  field['x-validator'] = (({ value }) => {\n    const botValue = value?.[TestFormFieldName.Bot];\n    const conversationValue = value?.[TestFormFieldName.Conversation];\n    if (isNeedBot && !botValue) {\n      return {\n        type: 'bot',\n        message: I18n.t('workflow_testset_required_tip', {\n          param_name: 'Bot',\n        }),\n      };\n    }\n    if (\n      isNeedConversation &&\n      botValue?.type === IntelligenceType.Project &&\n      !conversationValue\n    ) {\n      return {\n        type: 'conversation',\n        message: I18n.t('workflow_testset_required_tip', {\n          param_name: 'Conversation',\n        }),\n      };\n    }\n  }) as any;\n\n  return field;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WorkflowNodeRefVariablesData } from '@coze-workflow/variable';\nimport { type IFormSchema } from '@coze-workflow/test-run-next';\n\nimport type { WorkflowNodeEntity } from '../types';\nimport { generateEnvToRelatedContextProperties } from './generate-env-to-related-context-properties';\n\ninterface GenerateFormRelatedFieldOptions {\n  node: WorkflowNodeEntity;\n  isChatflow: boolean;\n  isInProject: boolean;\n  spaceId: string;\n  workflowId: string;\n}\n\nexport const generateFormRelatedField = async ({\n  node,\n  isChatflow,\n  isInProject,\n  spaceId,\n  workflowId,\n}: GenerateFormRelatedFieldOptions) => {\n  const registry = node.getNodeRegistry();\n\n  let field: IFormSchema | null = null;\n  if (registry?.meta?.test?.generateRelatedContext) {\n    field = await registry.meta.test.generateRelatedContext(node, {\n      isChatflow,\n      isInProject,\n      spaceId,\n      workflowId,\n    });\n  }\n  /** If the custom logic determines that the environment does not need to be selected, it is also necessary to determine the variable reference */\n  if (\n    !field &&\n    !isInProject &&\n    node.getData(WorkflowNodeRefVariablesData).hasGlobalRef\n  ) {\n    field = generateEnvToRelatedContextProperties({ isNeedBot: true });\n  }\n\n  return field;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type IFormSchema,\n  TestFormFieldName,\n  isFormSchemaPropertyEmpty,\n} from '@coze-workflow/test-run-next';\nimport { PUBLIC_SPACE_ID } from '@coze-workflow/base';\n\nimport { getTestsetField } from './generate-form-schema/testset-field';\nimport type { WorkflowNodeEntity } from '../types';\nimport { generateFormRelatedField } from './generate-form-related-field';\nimport { generateFormNodeField } from './generate-form-node-field';\n\ninterface GenerateFormSchemaOptions {\n  node: WorkflowNodeEntity;\n  workflowId: string;\n  spaceId: string;\n  isChatflow: boolean;\n  isInProject: boolean;\n  isPreview?: boolean;\n}\n\nexport const generateFormSchema = async (\n  options: GenerateFormSchemaOptions,\n) => {\n  const { node, spaceId, isPreview } = options;\n  const formSchema = {\n    type: 'object',\n    ['x-node-id']: node.id,\n    ['x-node-type']: node.flowNodeType,\n    properties: {},\n  };\n\n  const relatedField = await generateFormRelatedField(options);\n  if (relatedField) {\n    formSchema.properties[TestFormFieldName.Related] = relatedField;\n  }\n\n  /**\n   * Step1: Calculate node input\n   */\n  const nodeField = await generateFormNodeField(options);\n  if (nodeField) {\n    formSchema.properties[TestFormFieldName.Node] = nodeField;\n  }\n\n  const testset = node.getNodeRegistry().meta?.test?.testset;\n  /**\n   * If the test set is supported and the input is not empty, add the test set component\n   */\n  /* will support soon */\n  if (\n    !IS_OPEN_SOURCE &&\n    spaceId !== PUBLIC_SPACE_ID &&\n    !isPreview &&\n    testset &&\n    !isFormSchemaPropertyEmpty(formSchema.properties)\n  ) {\n    Object.assign(formSchema.properties, getTestsetField());\n  }\n\n  return formSchema as IFormSchema;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { invert } from 'lodash-es';\nimport {\n  safeJsonParse,\n  TestFormFieldName,\n  stringifyFormValuesFromBacked,\n} from '@coze-workflow/test-run-next';\nimport { workflowApi, StandardNodeType } from '@coze-workflow/base';\nimport { NodeHistoryScene } from '@coze-arch/bot-api/workflow_api';\n\ninterface GetNodeExecuteHistoryInputOptions {\n  workflowId: string;\n  spaceId: string;\n  nodeId: string;\n  nodeType: string;\n}\n\nexport const getNodeExecuteHistoryInput = async (\n  options: GetNodeExecuteHistoryInputOptions,\n) => {\n  const { spaceId, workflowId, nodeId, nodeType } = options;\n  const map = invert(StandardNodeType);\n  const nodeTypeStr = map[nodeType];\n  if (!nodeId || !nodeTypeStr) {\n    return;\n  }\n  try {\n    const res = await workflowApi.GetNodeExecuteHistory({\n      workflow_id: workflowId,\n      space_id: spaceId,\n      node_id: nodeId,\n      node_type: nodeTypeStr,\n      execute_id: '',\n      node_history_scene: NodeHistoryScene.TestRunInput,\n    });\n    const inputValues = safeJsonParse(res.data?.input);\n    if (inputValues) {\n      return {\n        [TestFormFieldName.Node]: {\n          [TestFormFieldName.Input]: stringifyFormValuesFromBacked(inputValues),\n        },\n      };\n    }\n    // eslint-disable-next-line @coze-arch/no-empty-catch\n  } catch {\n    //\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { intersection } from 'lodash-es';\nimport {\n  workflowApi,\n  CONVERSATION_NODES,\n  StandardNodeType,\n} from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\n\ninterface GetRelatedInfoOptions {\n  workflowId: string;\n  spaceId: string;\n}\nfunction checkHasConversationNode(typeList: StandardNodeType[]) {\n  return intersection(typeList, CONVERSATION_NODES).length > 0;\n}\n\nexport const getRelatedInfo = async (options: GetRelatedInfoOptions) => {\n  const { workflowId, spaceId } = options;\n  const { data: nodeTypes } = await workflowApi.QueryWorkflowNodeTypes({\n    workflow_id: workflowId,\n    space_id: spaceId,\n  });\n  const flowTypeList = nodeTypes?.node_types ?? [];\n  const subFlowTypeList = nodeTypes?.sub_workflow_node_types ?? [];\n  const sumTypeList = [\n    ...flowTypeList,\n    ...subFlowTypeList,\n  ] as StandardNodeType[];\n\n  const flowPropsList = nodeTypes?.nodes_properties ?? [];\n  const subFlowPropsList = nodeTypes?.sub_workflow_nodes_properties ?? [];\n  const sumPropsList = [...flowPropsList, ...subFlowPropsList];\n\n  const hasVariableNode = sumTypeList.includes(StandardNodeType.Variable);\n  const hasVariableAssignNode = sumTypeList.includes(\n    StandardNodeType.VariableAssign,\n  );\n\n  const hasIntentNode = sumTypeList.includes(StandardNodeType.Intent);\n  const hasLLMNode = sumTypeList.includes(StandardNodeType.LLM);\n  const hasLTMNode = sumTypeList.includes(StandardNodeType.LTM);\n  const hasConversationNode = checkHasConversationNode(sumTypeList);\n  const propsEnableChatHistory = sumPropsList.some(\n    item => item.is_enable_chat_history,\n  );\n  const hasNodeUseGlobalVariable = !!sumPropsList.find(\n    item => item.is_ref_global_variable,\n  );\n\n  const hasChatHistoryEnabledLLM =\n    (hasLLMNode || hasIntentNode) && propsEnableChatHistory;\n\n  const hasSubFlowNode = subFlowTypeList.some(it =>\n    [StandardNodeType.SubWorkflow].includes(it as StandardNodeType),\n  );\n\n  // The process (including the subflow drill-down node) has Variable, Database, and LLM for opening chat history | | subflow nodes have subflow\n  const isNeedBot =\n    hasNodeUseGlobalVariable ||\n    hasVariableAssignNode ||\n    hasVariableNode ||\n    hasLTMNode ||\n    hasChatHistoryEnabledLLM ||\n    hasSubFlowNode ||\n    hasConversationNode;\n\n  const isNeedConversation = hasChatHistoryEnabledLLM;\n\n  return {\n    isNeedBot,\n    isNeedConversation,\n    hasVariableNode,\n    hasVariableAssignNode,\n    hasNodeUseGlobalVariable,\n    hasLTMNode,\n    hasChatHistoryEnabledLLM,\n    hasConversationNode,\n    // When including a session class node, you need to disable the bot option\n    disableBot: hasConversationNode,\n    disableBotTooltip: hasConversationNode ? I18n.t('wf_chatflow_141') : '',\n    // Includes LTM nodes, project option needs to be disabled\n    disableProject: hasLTMNode,\n    disableProjectTooltip: hasLTMNode ? I18n.t('wf_chatflow_142') : '',\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type IFormSchema } from '@coze-workflow/test-run-next';\nimport { useTestFormService } from '@coze-workflow/test-run';\n\nimport { useGlobalState, useTestRunReporterService } from '@/hooks';\n\nimport { getNodeExecuteHistoryInput } from '../utils';\n\nexport const useFormDefaultValues = () => {\n  const testFormService = useTestFormService();\n  const globalState = useGlobalState();\n  const reporter = useTestRunReporterService();\n  const getDefaultValues = async (schema: IFormSchema) => {\n    if (!schema) {\n      return;\n    }\n    const nodeId = schema['x-node-id'] || '';\n    const nodeType = schema['x-node-type'] || '';\n\n    // Highest merit: The last value the user filled in\n    const cacheData = testFormService.getCacheValues(nodeId);\n    if (cacheData) {\n      reporter.formGenDataOrigin({ gen_data_origin: 'cache' });\n      return cacheData;\n    }\n\n    const historyValues = await getNodeExecuteHistoryInput({\n      workflowId: globalState.workflowId,\n      spaceId: globalState.spaceId,\n      nodeId,\n      nodeType,\n    });\n    if (historyValues) {\n      reporter.formGenDataOrigin({ gen_data_origin: 'history' });\n      return historyValues;\n    }\n  };\n\n  return { getDefaultValues };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** Pick from master, if there is any conflict, please refer to master */\nimport { useGlobalState } from '@/hooks';\n\n/**\n * Open workflow\n * TODO: Some dependencies have not been migrated yet. For the time being, put this hook here first, and you need to migrate later.\n */\nexport const useOpenWorkflow = () => {\n  const { projectId, getProjectApi } = useGlobalState();\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const open = (data: any) => {\n    const { workflowId, executeId, subExecuteId } = data;\n    const projectApi = getProjectApi();\n\n    if (projectId && projectApi) {\n      // in-app jump\n      projectApi.sendMsgOpenWidget(`/workflow/${workflowId}`, {\n        name: 'debug',\n        data: {\n          executeId,\n          subExecuteId,\n        },\n      });\n    } else {\n      // Resource library or operation and maintenance platform jump\n      const url = new URL(window.location.href);\n      const params = new URLSearchParams();\n\n      // Add/update query parameters to keep only these 4 parameters, including space_id\n      params.append('space_id', url.searchParams.get('space_id') || '0');\n      params.append('workflow_id', workflowId);\n      params.append('execute_id', executeId);\n      params.append('sub_execute_id', subExecuteId);\n\n      // Build a new URL\n      url.search = params.toString();\n\n      // Open in a new tab\n      window.open(url.toString(), '_blank');\n    }\n  };\n\n  return { open };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NavigateOptions } from 'react-router-dom';\n\nimport { type UseBoundStore, type StoreApi } from 'zustand';\nimport { type interfaces } from 'inversify';\nimport { type FieldRenderProps } from '@flowgram-adapter/free-layout-editor';\nimport { type WorkflowNodeJSON } from '@flowgram-adapter/free-layout-editor';\nimport type {\n  StandardNodeType,\n  GenerationDiversity,\n  WorkflowNodeRegistry,\n} from '@coze-workflow/base/types';\nimport {\n  type GetWorkFlowProcessData,\n  type OperateType,\n  type NodeTemplate as ServerNodeTemplate,\n} from '@coze-workflow/base/api';\nimport { type ResponseFormat } from '@coze-workflow/base';\nimport type { WsMessageProps } from '@coze-project-ide/framework/src/types';\nimport type {\n  User,\n  IntelligenceBasicInfo,\n  IntelligencePublishInfo,\n} from '@coze-arch/idl/intelligence_api';\nimport {\n  type PluginCategory,\n  type PluginAPINode,\n  type NodePanelSearchType,\n} from '@coze-arch/bot-api/workflow_api';\n// import {\n//   type PluginParameter,\n//   type DebugExample,\n//   type PluginAPIInfo,\n//   DebugExampleStatus,\n//   PluginInfo,\n//   PluginApi,\n// } from '@coze-arch/bot-api/plugin_develop';\n\nimport { type TestRunInstanceCallback } from '../hooks/use-test-run';\nimport {\n  WorkflowGlobalStateEntity,\n  type WorkflowInfo,\n} from '../entities/workflow-global-state-entity';\nimport { type TestFormDefaultValue } from '../components/test-run/types';\n\nexport type PluginApiNodeTemplate = Omit<PluginAPINode, 'node_type'> & {\n  type: StandardNodeType.Api;\n  nodeJSON: Partial<WorkflowNodeJSON>;\n  version?: string;\n};\n\nexport type PluginCategoryNodeTemplate = Omit<PluginCategory, 'node_type'> & {\n  type: StandardNodeType.Api;\n  categoryInfo: { categoryId: string; onlyOfficial?: boolean };\n};\n\n/**\n * Plug-in node information, including a list of tools under the plug-in\n */\nexport interface PluginNodeTemplate {\n  plugin_id: string;\n  name: string;\n  icon_url: string;\n  desc: string;\n  tools: Array<PluginApiNodeTemplate>;\n}\n\nexport interface SubWorkflowNodeTemplate {\n  type: StandardNodeType.SubWorkflow;\n  name?: string;\n  desc?: string;\n  icon_url?: string;\n  plugin_id?: string;\n  workflow_id: string;\n  version?: string;\n  nodeJSON: Partial<WorkflowNodeJSON>;\n}\n\nexport type NodeTemplate = Omit<ServerNodeTemplate, 'type'> & {\n  type: StandardNodeType;\n};\n\nexport type UnionNodeTemplate =\n  | NodeTemplate\n  | PluginApiNodeTemplate\n  | PluginCategoryNodeTemplate\n  | SubWorkflowNodeTemplate;\n\nexport interface DragObject {\n  nodeType: StandardNodeType;\n  nodeJson?: Partial<WorkflowNodeJSON>;\n  /**\n   * Node version information, it will only have value when dragging and dropping to add workflow and plug-in nodes with version information\n   * The pluginId plugin is the id of the plugin, and the workflow is the plugin id associated with the workflow after it is published.\n   * workflowId is the workflow id, the plugin does not pass it.\n   * version version information, plugin is version_ts field; workflow does not pass version, you need to call the interface to get it after drop\n   */\n  nodeVersionInfo: {\n    workflowId?: string;\n    pluginId?: string;\n    version?: string;\n  };\n  /** When the pop-up window is opened, the props passed to the pop-up window opening method */\n  modalProps?: unknown;\n}\nexport type HandleAddNode = (\n  item: DragObject,\n  coord: { x: number; y: number },\n  isDrag?: boolean,\n) => void;\n\nexport interface AddNodeRef {\n  handleAddNode: HandleAddNode;\n}\n\nexport interface ProjectApi {\n  /** jump */\n  navigate: (url: string, options?: NavigateOptions) => void;\n\n  ideGlobalStore: UseBoundStore<\n    StoreApi<{\n      projectInfo?: {\n        ownerInfo?: User;\n        projectInfo?: IntelligenceBasicInfo;\n        publishInfo?: IntelligencePublishInfo;\n      };\n    }>\n  >;\n  /** Set tab state */\n  setWidgetUIState: (status: string) => void;\n  /** Send a message and jump */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  sendMsgOpenWidget: (target: string, data?: any) => void;\n}\n\nexport type WorkflowPlaygroundProps = {\n  /** parent container */\n  parentContainer?: interfaces.Container;\n\n  /** The current canvas is attached to the class name for custom styles */\n  className?: string;\n\n  /** Current canvas custom style */\n  style?: React.CSSProperties;\n\n  /** Current canvas associated workflowId */\n  workflowId: string;\n\n  /** Process space ID, if not, public space ID */\n  spaceId?: string;\n\n  /** Process version */\n  commitId?: string;\n\n  /** The commit history version of the entire app, which only takes effect in the app */\n  projectCommitVersion?: string;\n\n  /** log ID */\n  logId?: string;\n\n  /** Execution ID */\n  executeId?: string;\n\n  /** subprocess execution ID */\n  subExecuteId?: string;\n\n  /** Submit operation type, the interface needs to be used */\n  commitOptType?: OperateType;\n\n  /**\n   * Open source, open from process preview, open from bot\n   *\n   * - explore process exploration\n   * - bot edit page\n   * - workflowStore\n   * - dupSuccess Copy process template/process item success\n   * - createSuccess\n   * - communityTrial packages/community/pages/src/flow-trial/page.tsx\n   */\n  from?:\n    | 'explore'\n    | 'bot'\n    | 'workflowStore'\n    | 'dupSuccess'\n    | 'createSuccess'\n    | 'communityTrial'\n    | 'op'\n    | 'workflowTemplate';\n\n  /** read-only mode */\n  readonly?: boolean;\n\n  /** Customize the left sidebar */\n  sidebar?: React.ForwardRefExoticComponent<React.RefAttributes<AddNodeRef>>;\n\n  /**\n   * Run result expansion mode, if not configured, expand according to the default rules (all image streams are expanded, and the workflow expansion end node)\n   * - all unfold\n   * - end shows only end nodes\n   */\n  defaultResultCollapseMode?: 'all' | 'end';\n\n  /** Custom top bar rendering */\n  renderHeader?: (actions: {\n    handleTestRun: () => Promise<void>;\n  }) => React.ReactNode;\n\n  /** Initialization success event */\n  onInit?: (workflowState: WorkflowGlobalStateEntity) => void;\n\n  /** Back button click */\n  onBackClick?: (workflowState: WorkflowGlobalStateEntity) => void;\n\n  /** Published successfully */\n  onPublish?: (workflowState: WorkflowGlobalStateEntity) => void;\n\n  /** run result unfolded state */\n  onTestRunResultVisibleChange?: (visible: boolean) => void;\n\n  /* testRun form default */\n  testFormDefaultValues?: TestFormDefaultValue[];\n\n  /** Whether to disable single node practice running */\n  disabledSingleNodeTest?: boolean;\n\n  /** Disable practice running and debugging tools */\n  disableTraceAndTestRun?: boolean;\n\n  /** The current project id, only the workflow within the project has this field */\n  projectId?: string;\n\n  /**\n   * The ability to obtain project injection, which is not imported in non-project environments\n   */\n  getProjectApi?: () => ProjectApi;\n\n  /**\n   * Refresh the list of project resources for calling after creating resources within the project\n   */\n  refetchProjectResourceList?: () => Promise<void>;\n\n  /** Disallow request testcase */\n  disableGetTestCase?: boolean;\n\n  /**\n   * Rename project resources\n   * @param workflowId\n   * @returns\n   */\n  renameProjectResource?: (workflowId: string) => void;\n\n  /** The node type currently registered on the canvas */\n  nodeRegistries?: WorkflowNodeRegistry[];\n} & TestRunInstanceCallback;\n\nexport interface WorkflowPlaygroundRef {\n  /**\n   * Execute the full process TestRun\n   * @param input default input\n   * Whether @return triggered successfully\n   */\n  triggerTestRun: (input?: Record<string, string>) => Promise<boolean>;\n  /**\n   * Cancel practice run\n   */\n  cancelTestRun: () => void;\n  /**\n   * Get practice run results in real time\n   */\n  getProcess: (obj: { executeId?: string }) => Promise<void>;\n  /**\n   * Show the running results\n   * @Param executeIdOrResp Specify the execution ID or directly pass in the service to return the execution result, and get the latest execution result without passing it.\n   */\n  showTestRunResult: (\n    executeIdOrResp?: string | GetWorkFlowProcessData,\n    subExecuteId?: string,\n  ) => void;\n  /**\n   * Hide run result\n   */\n  hideTestRunResult: () => void;\n  /**\n   * Reset process to historical version\n   * @param target version target\n   */\n  resetToHistory: (target: {\n    /** Target Version ID */\n    commitId: string;\n    /** operation type */\n    optType: OperateType;\n  }) => void;\n  /**\n   * Scroll to a node\n   * @param {string} nodeId\n   */\n  scrollToNode: (nodeId: string) => void;\n  /**\n   * Trigger view adaptation\n   * IDE scene canvas initialization may display none\n   * Automatic fitView may fail when clientWidth is 0\n   */\n  triggerFitView: () => void;\n  /**\n   * Refresh process information\n   */\n  reload: () => Promise<void>;\n  /**\n   * Loading global variables\n   */\n  loadGlobalVariables: () => Promise<void>;\n  /**\n   * Monitor resource changes\n   */\n  onResourceChange: (props: WsMessageProps, callback?: () => void) => void;\n}\n\nexport interface AddNodePanelProps {\n  /** Open from the Add Node button */\n  fromAddNodeBtn?: boolean;\n  /** Whether to enable workflow and plugin pop-up windows to add in batches, the default is false */\n  enableModalMultiAdd?: boolean;\n  /** Add Node Panel Enable Drag and Drop */\n  enableDrag?: boolean;\n  /** Whether to enable scrolling shutdown */\n  enableScrollClose?: boolean;\n  /** Whether to enable node occupancy */\n  enableNodePlaceholder?: boolean;\n  /** Panel component anchor element selector, used to exclude the anchor element when clicking outside */\n  anchorElement?: string;\n}\n\n/**\n * first-level classification node type\n */\nexport const enum NodeSearchSectionType {\n  Atom = 'atom',\n  SubWorkflow = 'sub_workflow',\n  Plugin = 'plugin',\n}\n\n/**\n * sub-category node data\n */\nexport interface NodeSearchCategoryData<DataType> {\n  /* Category ID to load more by category */\n  id?: NodePanelSearchType;\n  /* Category name */\n  categoryName?: string;\n  /* Node list */\n  nodeList: Array<DataType>;\n  /* Can load more */\n  hasMore?: boolean;\n  /** The cursor of the next page when loading more, empty when hasMore is false */\n  cursor?: string;\n}\n\n/**\n * atomic node classification data\n */\nexport type NodeCategory = NodeSearchCategoryData<UnionNodeTemplate>;\n\n/**\n * first level classification data\n */\nexport type NodeSearchResultSection =\n  | {\n      /* Category name  */\n      name: string;\n      /* Classified data, including sub-category information */\n      data: NodeCategory[];\n      /* Classify data types and judge the rendering logic of different nodes */\n      dataType: NodeSearchSectionType.Atom;\n    }\n  | {\n      name: string;\n      data: Array<NodeSearchCategoryData<SubWorkflowNodeTemplate>>;\n      dataType: NodeSearchSectionType.SubWorkflow;\n    }\n  | {\n      name: string;\n      data: Array<NodeSearchCategoryData<PluginNodeTemplate>>;\n      dataType: NodeSearchSectionType.Plugin;\n    };\n\nexport type NodeSearchResult = NodeSearchResultSection[];\n\nexport { WorkflowInfo, WorkflowGlobalStateEntity };\n\nexport interface IModelValue {\n  modelName?: string;\n  modelType?: number;\n  generationDiversity?: GenerationDiversity;\n  responseFormat?: ResponseFormat;\n  [k: string]: unknown;\n}\n\nexport type ComponentProps<TValue> = Omit<\n  FieldRenderProps<TValue>['field'],\n  'key'\n>;\n\nexport interface NodeMeta {\n  title: string;\n  icon: string;\n  subTitle: string;\n  description: string;\n  mainColor: string;\n}\n\nexport interface SettingOnErrorDTO {\n  switch: boolean;\n  dataOnErr: string;\n}\n\nexport interface SettingOnErrorVO {\n  settingOnErrorIsOpen: boolean;\n  settingOnErrorJSON: string;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { IconCozAddNode } from '@coze-arch/coze-design/icons';\nimport { IconButton, type ButtonProps } from '@coze-arch/coze-design';\nimport { IconAdd } from '@coze-arch/bot-icons';\n\nimport styles from './index.module.less';\n\ntype AddOperationProps = React.PropsWithChildren<{\n  readonly?: boolean;\n  onClick: React.MouseEventHandler<HTMLButtonElement>;\n  className?: string;\n  style?: React.CSSProperties;\n  disabled?: boolean;\n  subitem?: boolean;\n  size?: ButtonProps['size'];\n  color?: ButtonProps['color'];\n}>;\n\nexport default function AddOperation({\n  readonly,\n  onClick,\n  className,\n  style,\n  disabled,\n  subitem = false,\n  size,\n  color,\n  ...restProps\n}: AddOperationProps) {\n  if (readonly) {\n    return null;\n  }\n  return (\n    <IconButton\n      data-testid={restProps['data-testid']}\n      onClick={onClick}\n      className={classNames(\n        styles.container,\n        disabled ? styles.disabled : null,\n        className,\n      )}\n      style={style}\n      icon={subitem ? <IconCozAddNode /> : <IconAdd className={styles.icon} />}\n      disabled={disabled}\n      size={size}\n      color={color}\n    />\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { type PropsWithChildren, useRef } from 'react';\n\nimport classNames from 'classnames';\nimport { Tooltip, type TooltipProps } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\ntype AutoSizeTooltipProps = PropsWithChildren<\n  {\n    className?: string;\n    style?: React.CSSProperties;\n    containerClassName?: string;\n    containerStyle?: React.CSSProperties;\n    tooltipClassName?: string;\n    tooltipStyle?: React.CSSProperties;\n  } & Omit<TooltipProps, 'className' | 'style'>\n>;\n\nexport default function AutoSizeTooltip({\n  children,\n  className,\n  style,\n  tooltipClassName,\n  tooltipStyle,\n  containerClassName,\n  containerStyle,\n  ...rest\n}: AutoSizeTooltipProps) {\n  const nanoRef = useRef<HTMLDivElement | null>(null);\n  const renderContent = () => (\n    <>\n      <div\n        ref={nanoRef}\n        className={classNames(styles.nano, containerClassName)}\n        style={containerStyle}\n      />\n      <Tooltip\n        {...rest}\n        className={classNames(\n          styles.tooltip,\n          styles['top-level'],\n          tooltipClassName,\n        )}\n        style={{ left: 0, ...tooltipStyle }}\n      >\n        {children}\n      </Tooltip>\n    </>\n  );\n  return (\n    <div\n      className={classNames(styles.popup_container, className)}\n      style={style}\n    >\n      {renderContent()}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  type ComponentProps,\n  useRef,\n  useImperativeHandle,\n  useMemo,\n  useEffect,\n  type ForwardedRef,\n} from 'react';\n\nimport isNumber from 'lodash-es/isNumber';\nimport cs from 'classnames';\nimport { useReactive } from 'ahooks';\nimport {\n  Input as UIInput,\n  type InputProps,\n  type TooltipProps,\n} from '@coze-arch/coze-design';\n\nimport AutoSizeTooltip from '../auto-size-tooltip';\n\nimport s from './index.module.less';\n\nexport interface WorkflowSLInputRefType {\n  triggerFocus?: () => void;\n}\n\nexport type WorkflowSLInputProps = ComponentProps<typeof UIInput> & {\n  value: string | undefined;\n  onRef?: ForwardedRef<WorkflowSLInputRefType>;\n  ellipsis?: boolean;\n  handleChange?: (v: string) => void;\n  handleBlur?: (v: string) => void;\n  handleFocus?: (v: string) => void;\n  ellipsisTooltipProps?: TooltipProps;\n  onFocusTooltipProps?: TooltipProps;\n  tooltipProps?: TooltipProps;\n  inputProps?: InputProps;\n  errorMsg?: string;\n  errorMsgFloat?: boolean;\n  maxCount?: number;\n  className?: string;\n  style?: React.CSSProperties;\n};\n\nconst SL_INPUT_TIMEOUT = 10;\n\nexport default function WorkflowSLInput(props: WorkflowSLInputProps) {\n  const { ellipsis = true, maxCount } = props;\n  const showCount = isNumber(maxCount) && maxCount > 0;\n  useImperativeHandle(props.onRef, () => ({\n    triggerFocus,\n  }));\n  const $state = useReactive({\n    value: props.value,\n    inputOnFocus: false,\n    inputEle: false,\n  });\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const triggerFocus = () => {\n    $state.inputEle = true;\n    inputRef?.current?.focus();\n  };\n\n  const onFocus = () => {\n    $state.inputOnFocus = true;\n    $state.inputEle = true;\n    props?.handleFocus?.($state.value || '');\n  };\n\n  const onBlur = (e: React.FocusEvent<HTMLInputElement>) => {\n    $state.inputOnFocus = false;\n    props?.handleBlur?.($state.value || '');\n    props?.onBlur?.(e);\n    $state.inputEle = false;\n  };\n\n  const onChange = (v: string) => {\n    $state.value = v;\n    props?.handleChange?.(v);\n  };\n\n  const onclick = () => {\n    if (!$state.inputEle) {\n      setTimeout(() => {\n        inputRef?.current?.focus();\n      }, SL_INPUT_TIMEOUT);\n    }\n    $state.inputEle = true;\n  };\n  const hasEllipsis = useMemo(() => {\n    const clientWidth = inputRef.current?.clientWidth || 0;\n    const scrollWidth = inputRef.current?.scrollWidth || 0;\n    return clientWidth < scrollWidth - 1;\n  }, [\n    ellipsis,\n    $state.inputOnFocus,\n    $state.value,\n    inputRef.current?.clientWidth,\n    inputRef.current?.scrollWidth,\n    $state.inputEle,\n  ]);\n\n  useEffect(() => {\n    $state.value = props.value;\n  }, [props.value]);\n\n  const LimitCountNode = (\n    <span className={s['limit-count']}>\n      {$state.value?.length || 0}/{maxCount}\n    </span>\n  );\n\n  return (\n    <div\n      className={cs(s['input-wrapper'], props.className)}\n      style={props.style}\n    >\n      {!$state.inputEle && hasEllipsis ? (\n        <AutoSizeTooltip\n          content={$state.value}\n          position={'top'}\n          showArrow\n          mouseEnterDelay={300}\n          {...props.tooltipProps}\n        >\n          <div\n            className={cs(props?.errorMsg ? s['error-wrapper'] : null)}\n            onClick={onclick}\n          >\n            <UIInput\n              {...props.inputProps}\n              validateStatus={props.validateStatus}\n              ref={inputRef}\n              value={$state.value}\n              className={ellipsis ? s.input : ''}\n              suffix={showCount ? LimitCountNode : undefined}\n            ></UIInput>\n          </div>\n        </AutoSizeTooltip>\n      ) : (\n        <div className={cs(props?.errorMsg ? s['error-wrapper'] : null)}>\n          <AutoSizeTooltip\n            {...props.onFocusTooltipProps}\n            trigger=\"custom\"\n            visible={\n              Boolean(props.onFocusTooltipProps?.content) && $state.inputOnFocus\n            }\n            showArrow\n          >\n            <UIInput\n              {...props.inputProps}\n              validateStatus={props.validateStatus}\n              ref={inputRef}\n              value={$state.value}\n              className={ellipsis ? s.input : ''}\n              onChange={onChange}\n              onFocus={onFocus}\n              onBlur={onBlur}\n              suffix={showCount ? LimitCountNode : undefined}\n            ></UIInput>\n          </AutoSizeTooltip>\n        </div>\n      )}\n      {props?.errorMsg ? (\n        <div\n          className={cs(\n            s['error-content'],\n            props?.errorMsgFloat ? s['error-float'] : null,\n          )}\n        >\n          <div className={s['error-text']}>{props?.errorMsg}</div>\n        </div>\n      ) : null}\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useState, useMemo, useEffect } from 'react';\n\nimport { isBoolean } from 'lodash-es';\nimport { PUBLIC_SPACE_ID } from '@coze-workflow/base/constants';\nimport {\n  type GetWorkFlowProcessData,\n  type GetWorkflowProcessRequest,\n  OperateType,\n  workflowApi,\n} from '@coze-workflow/base/api';\nimport { reporter } from '@coze-arch/logger';\nimport { I18n } from '@coze-arch/i18n';\nimport { typeSafeJSONParse } from '@coze-arch/bot-utils';\nimport { Button, Space } from '@coze-arch/coze-design';\n\nimport { WorkflowPlayground } from './workflow-playground';\nimport {\n  type WorkflowPlaygroundRef,\n  type WorkflowPlaygroundProps,\n} from './typing';\nimport { type TestFormDefaultValue } from './components/test-run/types';\n\nexport interface WorkflowPlaygroundInitConfig {\n  spaceId?: string;\n  workflowId?: string;\n  commitId?: string;\n  /** process execution ID */\n  executeId?:\n    | {\n        /** Get the current process execution ID */\n        type: 'workflow';\n        value: string;\n      }\n    | {\n        /**\n         * Get the persistent process execution ID\n         * Solve the problem that the store configuration process case needs to be persisted\n         */\n        type: 'store';\n        value: string;\n        sourceWfId: string;\n      };\n  /** When configuring executeId, display the running results */\n  showExecuteResult?: boolean;\n  /** Set history input to practice run default when configuring executeId */\n  enableInitTestRunInput?: boolean;\n  /** Whether to disable single node practice running */\n  disabledSingleNodeTest?: boolean;\n  /** run success event */\n  onTestRunSucceed?: (executeId: string) => void;\n  /** Disable practice running and debugging tools */\n  disableTraceAndTestRun?: boolean;\n\n  disableGetTestCase?: boolean;\n}\n\nexport interface UseWorkflowPlaygroundProps {\n  /** source */\n  from?: WorkflowPlaygroundProps['from'];\n  onTriggerTestRun?: () => void;\n}\n\n/**\n * For previewing and running processes\n */\nexport function useWorkflowPlayground(props?: UseWorkflowPlaygroundProps) {\n  const workflowRef = useRef<WorkflowPlaygroundRef>(null);\n  const propsRef = useRef(props);\n  const [initConfig, setInitConfig] = useState<WorkflowPlaygroundInitConfig>();\n  const [isRunning, setIsRunning] = useState(false);\n  const [defaultInput, setDefaultInput] = useState<TestFormDefaultValue[]>([]);\n  const [testRunCount, setTestRunCount] = useState(0);\n  const lastTestRunResultRef = useRef<GetWorkFlowProcessData>();\n\n  const [testResultVisible, setTestResultVisible] = useState(false);\n\n  const isNodeLogNeedAsync = true;\n\n  useEffect(() => {\n    propsRef.current = props;\n  }, [props]);\n\n  /** Process Component */\n  const workflowComp = useMemo(() => {\n    if (!initConfig?.workflowId) {\n      return null;\n    }\n\n    const { spaceId, workflowId, commitId, onTestRunSucceed } = initConfig;\n\n    return (\n      <WorkflowPlayground\n        ref={workflowRef}\n        from={propsRef.current?.from}\n        readonly\n        spaceId={spaceId}\n        workflowId={workflowId}\n        commitId={commitId}\n        commitOptType={OperateType.PublishOperate}\n        defaultResultCollapseMode=\"all\"\n        disabledSingleNodeTest={initConfig.disabledSingleNodeTest}\n        disableGetTestCase={initConfig.disableGetTestCase}\n        renderHeader={() => null}\n        onTestRunStart={(_, isSingleMode) => {\n          // Single-node debugging, no history is recorded, so do not clear\n          if (isBoolean(isSingleMode) && !isSingleMode) {\n            lastTestRunResultRef.current = undefined;\n          }\n          setIsRunning(true);\n        }}\n        onTestRunEnd={() => {\n          setIsRunning(false);\n          setTestRunCount(val => val + 1);\n        }}\n        onTestRunResultVisibleChange={setTestResultVisible}\n        testFormDefaultValues={defaultInput}\n        onTestRunSucceed={onTestRunSucceed}\n        onInit={async () => {\n          if (!initConfig.executeId) {\n            return;\n          }\n\n          const getTestRunResult = async () => {\n            if (!initConfig?.workflowId || !initConfig?.executeId) {\n              return;\n            }\n            try {\n              let result: GetWorkFlowProcessData | undefined;\n              if (initConfig.executeId.type === 'store') {\n                const resp = await workflowApi.GetStoreTestRunHistory(\n                  {\n                    source_workflow_id: initConfig.executeId.sourceWfId,\n                    execute_id: initConfig.executeId.value,\n                  },\n                  {\n                    __disableErrorToast: true,\n                  },\n                );\n                result = resp.data;\n              } else {\n                const params: GetWorkflowProcessRequest = {\n                  workflow_id: initConfig.workflowId,\n                  space_id: initConfig.spaceId || PUBLIC_SPACE_ID,\n                  execute_id: initConfig.executeId.value,\n                };\n\n                if (isNodeLogNeedAsync) {\n                  params.need_async = isNodeLogNeedAsync;\n                }\n\n                const resp = await workflowApi.GetWorkFlowProcess(params, {\n                  __disableErrorToast: true,\n                });\n\n                result = resp.data;\n              }\n              return result;\n            } catch (e) {\n              reporter.error({\n                message: e.message,\n                error: e,\n              });\n            }\n          };\n\n          const testRunResult = await getTestRunResult();\n\n          if (!testRunResult?.executeId || testRunResult.executeId === '0') {\n            return;\n          }\n\n          // Default execution ID, recorded as a practice run\n          setTestRunCount(val => val + 1);\n\n          if (initConfig.enableInitTestRunInput) {\n            const startNodeInfo = (testRunResult.nodeResults || []).find(\n              item => item.NodeType === 'Start',\n            );\n            if (startNodeInfo) {\n              const inputVal = typeSafeJSONParse(\n                startNodeInfo.input || '{}',\n              ) as TestFormDefaultValue['input'];\n              setDefaultInput([{ input: inputVal }]);\n            }\n          }\n          if (initConfig.showExecuteResult) {\n            workflowRef.current?.showTestRunResult(testRunResult);\n            lastTestRunResultRef.current = testRunResult;\n          }\n        }}\n        disableTraceAndTestRun={initConfig?.disableTraceAndTestRun}\n      />\n    );\n  }, [initConfig, defaultInput, propsRef, isNodeLogNeedAsync]);\n\n  const testRunBtnsComp = useMemo(() => {\n    if (!workflowComp) {\n      return null;\n    }\n\n    return (\n      <Space>\n        {testRunCount > 0 ? (\n          <Button\n            color=\"highlight\"\n            disabled={isRunning}\n            onClick={() => {\n              if (testResultVisible) {\n                workflowRef.current?.hideTestRunResult();\n              } else {\n                workflowRef.current?.showTestRunResult(\n                  lastTestRunResultRef.current,\n                );\n              }\n            }}\n          >\n            {testResultVisible\n              ? I18n.t('workflow_detail_title_lastrun_hide')\n              : I18n.t('workflow_detail_title_lastrun_display')}\n          </Button>\n        ) : null}\n        {isRunning ? (\n          <Button\n            color=\"highlight\"\n            onClick={() => workflowRef.current?.cancelTestRun()}\n          >\n            {I18n.t('workflow_detail_title_testrun_cancel')}\n          </Button>\n        ) : null}\n        <Button\n          color=\"highlight\"\n          loading={isRunning}\n          onClick={() => {\n            propsRef.current?.onTriggerTestRun?.();\n            workflowRef.current?.triggerTestRun();\n          }}\n        >\n          {I18n.t('workflow_detail_title_testrun')}\n        </Button>\n      </Space>\n    );\n  }, [workflowComp, testRunCount, isRunning, testResultVisible]);\n\n  return {\n    init: (config?: WorkflowPlaygroundInitConfig, force?: boolean) => {\n      setInitConfig(val => {\n        // When non-forced update, compare workflowId consistency, if consistent, do not update\n        if (!force && val?.workflowId === config?.workflowId) {\n          return val;\n        }\n        return config;\n      });\n    },\n    /** Process component instance */\n    workflowRef,\n    /** Is it running? */\n    isRunning,\n    /** Is the running result displayed? */\n    testResultVisible,\n    /** Trigger practice run */\n    triggerTestRun: () => {\n      workflowRef.current?.triggerTestRun();\n    },\n    /** Cancel practice run */\n    cancelTestRun: () => {\n      workflowRef.current?.cancelTestRun();\n    },\n    /** Show the running results */\n    showTestRunResult: () => {\n      workflowRef.current?.showTestRunResult(lastTestRunResultRef.current);\n    },\n    /** Hide practice run results */\n    hideTestRunResult: () => {\n      workflowRef.current?.hideTestRunResult();\n    },\n    /** Process Component */\n    workflowComp,\n    /** Practice running components */\n    testRunBtnsComp,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Inspired from reach-ui: https://github.com/reach/reach-ui/blob/develop/packages/utils/src/use-force-update.ts\nimport React from 'react';\n\nexport const useForceUpdate = () => {\n  const [, rerender] = React.useState({});\n  return React.useCallback(() => rerender({}), []);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useLayoutEffect } from 'react';\n\nimport { useForceUpdate } from './use-force-update';\n\n/** createSlots is a factory that can create a\n *  typesafe Slots + Slot pair to use in a component definition\n *  For example: ActionList.Item uses createSlots to get a Slots wrapper\n *  + Slot component that is used by LeadingVisual, Description\n */\nconst createSlots = <SlotNames extends string>(slotNames: SlotNames[]) => {\n  type Slots = {\n    [key in SlotNames]?: React.ReactNode;\n  };\n\n  interface ContextProps {\n    registerSlot: (name: SlotNames, contents: React.ReactNode) => void;\n    unregisterSlot: (name: SlotNames) => void;\n    context: Record<string, unknown>;\n  }\n  const SlotsContext = React.createContext<ContextProps>({\n    registerSlot: () => null,\n    unregisterSlot: () => null,\n    context: {},\n  });\n\n  // maintain a static reference to avoid infinite render loop\n  const defaultContext = Object.freeze({});\n\n  /** Slots uses a Double render strategy inspired by [reach-ui/descendants](https://github.com/reach/reach-ui/tree/develop/packages/descendants)\n   *  Slot registers themself with the Slots parent.\n   *  When all the children have mounted = registered themselves in slot,\n   *  we re-render the parent component to render with slots\n   */\n  const Slots: React.FC<{\n    context?: ContextProps['context'];\n    children: (slots: Slots) => React.ReactNode;\n  }> = ({ context = defaultContext, children }) => {\n    // initialise slots\n    const slotsDefinition: Slots = {};\n    slotNames.map(name => (slotsDefinition[name] = null));\n    const slotsRef = React.useRef<Slots>(slotsDefinition);\n\n    const rerenderWithSlots = useForceUpdate();\n    const [isMounted, setIsMounted] = React.useState(false);\n\n    // fires after all the effects in children\n    useLayoutEffect(() => {\n      rerenderWithSlots();\n      setIsMounted(true);\n    }, [rerenderWithSlots]);\n\n    const registerSlot = React.useCallback(\n      (name: SlotNames, contents: React.ReactNode) => {\n        slotsRef.current[name] = contents;\n\n        // don't render until the component mounts = all slots are registered\n        if (isMounted) {\n          rerenderWithSlots();\n        }\n      },\n      [isMounted, rerenderWithSlots],\n    );\n\n    // Slot can be removed from the tree as well,\n    // we need to unregister them from the slot\n    const unregisterSlot = React.useCallback(\n      (name: SlotNames) => {\n        slotsRef.current[name] = null;\n        rerenderWithSlots();\n      },\n      [rerenderWithSlots],\n    );\n\n    /**\n     * Slots uses a render prop API so abstract the\n     * implementation detail of using a context provider.\n     */\n    const slots = slotsRef.current;\n\n    return (\n      <SlotsContext.Provider value={{ registerSlot, unregisterSlot, context }}>\n        {children(slots)}\n      </SlotsContext.Provider>\n    );\n  };\n\n  const Slot: React.FC<{\n    name: SlotNames;\n    children:\n      | React.ReactNode\n      | ((context: ContextProps['context']) => React.ReactNode);\n  }> = ({ name, children }) => {\n    const { registerSlot, unregisterSlot, context } =\n      React.useContext(SlotsContext);\n\n    useLayoutEffect(() => {\n      registerSlot(\n        name,\n        typeof children === 'function' ? children(context) : children,\n      );\n      return () => unregisterSlot(name);\n    }, [name, children, registerSlot, unregisterSlot, context]);\n\n    return null;\n  };\n\n  return { Slots, Slot };\n};\n\nexport default createSlots;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type WorkflowNodeJSON,\n  type WorkflowJSON,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowMode } from '@coze-workflow/base';\n\nfunction getIsInitStartOuputs(\n  initStartNode: WorkflowNodeJSON,\n  flowMode: WorkflowMode,\n) {\n  if (flowMode === WorkflowMode.Workflow) {\n    return (\n      initStartNode?.data?.outputs?.length === 1 ||\n      (initStartNode?.data?.outputs?.length === 2 &&\n        !initStartNode.data.outputs[1]?.name &&\n        initStartNode.data.outputs[1]?.required &&\n        initStartNode.data.outputs[1].type === 'string' &&\n        !initStartNode.data.outputs[1]?.assistType &&\n        !initStartNode.data.outputs[1]?.description)\n    );\n  } else if (flowMode === WorkflowMode.ChatFlow) {\n    return (\n      initStartNode?.data?.outputs?.length === 2 &&\n      initStartNode.data.outputs[0]?.name === 'USER_INPUT' &&\n      initStartNode.data.outputs[1]?.name === 'CONVERSATION_NAME'\n    );\n  }\n}\n\n/**\n *\n * Determine whether the current workflow is in an initial state\n * The number of nodes is 2.\n * - no edge\n * - The start node has only one input, or, there are two inputs, but the second input parameter is the default state\n * - The end node has only one valid output, or the form has multiple output variables configured, but all are in the default state\n */\nexport const getIsInitWorkflow = (\n  workflowShcmaJson: WorkflowJSON,\n  flowMode: WorkflowMode,\n) => {\n  if (!workflowShcmaJson) {\n    return false;\n  }\n  const isInitNodesNum = workflowShcmaJson.nodes?.length === 2;\n  if (!isInitNodesNum) {\n    return false;\n  }\n  const isHasEdge = workflowShcmaJson.edges?.length;\n  if (isHasEdge) {\n    return false;\n  }\n  const initStartNode = workflowShcmaJson.nodes[0];\n  const initEndNode = workflowShcmaJson.nodes[1];\n\n  const isInitStartOuputs = getIsInitStartOuputs(initStartNode, flowMode);\n  const isInitStart = !initStartNode?.edges && isInitStartOuputs;\n  const isInitEnd =\n    !initEndNode?.edges &&\n    initEndNode?.data?.inputs?.inputParameters?.length === 1;\n  return isInitStart && isInitEnd;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WORKFLOW_INNER_SIDE_SHEET_HOLDER } from '../constants';\n\nexport const getWorkflowInnerSideSheetHolder = () => {\n  const workflowContent = document.querySelector<HTMLElement>(\n    `#${WORKFLOW_INNER_SIDE_SHEET_HOLDER}`,\n  );\n  if (workflowContent) {\n    return workflowContent;\n  } else {\n    return document.body;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst workflowPath = 'work_flow';\n\n/**\n * Get Workflow page url\n * @param params related parameters\n * @returns Workflow page url\n */\nexport const getWorkflowUrl = (params: {\n  space_id: string;\n  workflow_id: string;\n  version?: string;\n}) => {\n  const urlParams = new URLSearchParams(params);\n  return `/${workflowPath}?${urlParams.toString()}`;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { get } from 'lodash-es';\nimport { StandardNodeType } from '@coze-workflow/base';\n\nimport {\n  type UnionNodeTemplate,\n  type NodeTemplate,\n  type PluginApiNodeTemplate,\n  type PluginCategoryNodeTemplate,\n  type SubWorkflowNodeTemplate,\n} from '@/typing';\n\nexport const isPluginApiNodeTemplate = (\n  nodeTemplate: unknown,\n): nodeTemplate is PluginApiNodeTemplate =>\n  Boolean(get(nodeTemplate, 'nodeJSON')) &&\n  get(nodeTemplate, 'type') === StandardNodeType.Api;\n\nexport const isPluginCategoryNodeTemplate = (\n  nodeTemplate: unknown,\n): nodeTemplate is PluginCategoryNodeTemplate =>\n  Boolean(get(nodeTemplate, 'categoryInfo'));\n\nexport const isSubWorkflowNodeTemplate = (\n  nodeTemplate: unknown,\n): nodeTemplate is SubWorkflowNodeTemplate =>\n  Boolean(get(nodeTemplate, 'nodeJSON')) &&\n  get(nodeTemplate, 'type') === StandardNodeType.SubWorkflow;\n\nexport const isNodeTemplate = (\n  nodeTemplate: UnionNodeTemplate,\n): nodeTemplate is NodeTemplate =>\n  !isPluginApiNodeTemplate(nodeTemplate) &&\n  !isPluginCategoryNodeTemplate(nodeTemplate) &&\n  !isSubWorkflowNodeTemplate(nodeTemplate);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** Exporting directly from yargs-parser will cause an error because the browser environment is not supported */\nimport yargsParser from 'yargs-parser/browser';\nimport multipart from 'parse-multipart';\nimport { cloneDeep } from 'lodash-es';\n\ninterface ParsedResult {\n  url: string;\n  originPath: string;\n  method: string;\n  params: Record<string, string>;\n  headers: Record<string, string>;\n  query: Record<string, string>;\n  body: string | Record<string, string> | undefined;\n}\n\nclass CURLParser {\n  cURLStr: string;\n\n  yargObj: Record<string, string | string[] | Record<string, string> | Buffer>;\n  constructor(cURLStr: string) {\n    this.cURLStr = cURLStr;\n    const yargObj = yargsParser(this.pretreatment(cURLStr));\n    this.yargObj = yargObj;\n  }\n  pretreatment(cURLStr: string) {\n    if (!cURLStr.startsWith('curl')) {\n      throw new Error('curl syntax error');\n    }\n    // Delete newline\n    const newLineFound = /\\r|\\n/.exec(cURLStr);\n    if (newLineFound) {\n      cURLStr = cURLStr.replace(/\\\\\\r|\\\\\\n/g, '');\n    }\n    // Change to universal spelling\n    cURLStr = cURLStr.replace(/ -XPOST/, ' -X POST');\n    cURLStr = cURLStr.replace(/ -XGET/, ' -X GET');\n    cURLStr = cURLStr.replace(/ -XPUT/, ' -X PUT');\n    cURLStr = cURLStr.replace(/ -XPATCH/, ' -X PATCH');\n    cURLStr = cURLStr.replace(/ -XDELETE/, ' -X DELETE');\n    cURLStr = cURLStr.replace(/ --header/g, ' -H');\n    cURLStr = cURLStr.replace(/ --user-agent/g, ' -A');\n    cURLStr = cURLStr.replace(/ --request/g, ' -X');\n    cURLStr = cURLStr.replace(\n      / --(data-binary|data-raw|data|data-urlencode)/g,\n      ' -d',\n    );\n    cURLStr = cURLStr.replace(/ --form/g, ' -f');\n    cURLStr = cURLStr.trim();\n    cURLStr = cURLStr.replace(/^curl/, '');\n    return cURLStr;\n  }\n  /** If there are two identical arguments written by mistake, take the last one */\n  getFirstItem(key: string) {\n    const e = this.yargObj[key];\n    if (!Array.isArray(e)) {\n      return e;\n    }\n    return e[e.length - 1] || '';\n  }\n  transKeyValueArrayToObj(keyValueArray: string[] | string) {\n    const keyValueObj = {};\n    let keyValueArr = cloneDeep(keyValueArray);\n    if (!Array.isArray(keyValueArr)) {\n      keyValueArr = [keyValueArr] as string[];\n    }\n    keyValueArr.forEach((item: string) => {\n      const arr = item.split('=');\n      try {\n        keyValueObj[arr[0]] = JSON.parse(arr[1]);\n      } catch (error) {\n        keyValueObj[arr[0]] = arr[1];\n      }\n    });\n\n    return keyValueObj;\n  }\n  getUrl() {\n    const { yargObj } = this;\n    let uri = '';\n    uri = yargObj._[0];\n    if (yargObj.url) {\n      uri = yargObj.url as string;\n    }\n    if (!uri) {\n      Object.values(yargObj).forEach(e => {\n        if (typeof e !== 'string') {\n          return;\n        }\n        if (e.startsWith('http') || e.startsWith('www.')) {\n          uri = e;\n        }\n      });\n    }\n    return uri.replace(/['\"]+/g, '');\n  }\n  getQuery(uri: string) {\n    const params = {};\n    try {\n      const obj = new URL(uri);\n      if (!obj?.searchParams) {\n        return params;\n      }\n      for (const [key, value] of obj.searchParams) {\n        params[key] = value;\n      }\n      return params;\n    } catch (error) {\n      return {};\n    }\n  }\n  getHeaders() {\n    const { yargObj } = this;\n    const headers = {};\n    if (!Reflect.has(yargObj, 'H')) {\n      return headers;\n    }\n    let yargHeaders = yargObj.H;\n    if (!Array.isArray(yargHeaders)) {\n      yargHeaders = [yargHeaders] as string[];\n    }\n    yargHeaders.forEach((item: string) => {\n      const i = item.indexOf(':');\n      const name = item.substring(0, i).trim();\n      const val = item.substring(i + 1).trim();\n      headers[name] = val;\n    });\n    if (Reflect.has(yargObj, 'A')) {\n      headers['user-agent'] = this.getFirstItem('A');\n    }\n    return headers;\n  }\n  getMethods() {\n    const { yargObj } = this;\n    let me = this.getFirstItem('X');\n    if (me) {\n      return (me as string).toUpperCase();\n    }\n    if (Reflect.has(yargObj, 'F')) {\n      if (!yargObj.F) {\n        // If there is a -F parameter but it is empty, it is an error curl.\n        throw new Error('curl -F params syntax error');\n      }\n      return 'POST';\n    }\n    if (Reflect.has(yargObj, 'f')) {\n      if (!yargObj.f) {\n        // If the --form parameter exists but is empty, it is an error curl.\n        throw new Error('curl --form params syntax error');\n      }\n      return 'POST';\n    }\n    if (Reflect.has(yargObj, 'd')) {\n      // Scenes where the --data parameter exists, but the value is empty, the default is a GET request\n      me = !yargObj?.d ? 'GET' : 'POST';\n    }\n    return (me ?? ('GET' as string)).toUpperCase();\n  }\n  getBody(headers: Record<string, string>) {\n    const contentType = headers['content-type'] || headers['Content-Type'];\n    let type = 'Empty';\n    let data = this.yargObj?.d;\n    if (contentType) {\n      if (contentType.indexOf('json') > -1) {\n        type = 'application/json';\n      } else if (contentType.indexOf('urlencoded') > -1) {\n        type = 'application/x-www-form-urlencoded';\n      } else if (this.cURLStr.indexOf('--data-urlencoded') > -1) {\n        type = 'application/x-www-form-urlencoded';\n      } else if (\n        Array.isArray(data) &&\n        type !== 'application/x-www-form-urlencoded'\n      ) {\n        type = 'application/x-www-form-urlencoded';\n        data = data.join('&');\n      } else if (contentType.indexOf('form-data') > -1) {\n        type = 'multipart/form-data';\n        let boundary = '';\n        const match = contentType.match(/boundary=.+/);\n        if (!match) {\n          type = 'text/plain';\n        } else {\n          boundary = match[0].slice(9);\n          try {\n            const parts = multipart.Parse(\n              (data ?? this.yargObj.F ?? '') as Buffer,\n              boundary,\n            );\n            if (parts?.length) {\n              this.yargObj.F = parts.map(\n                item => `${item.filename}=${item.data}`,\n              );\n            }\n          } catch (error) {\n            type = 'text/plain';\n          }\n        }\n      } else if (contentType.indexOf('application/octet-stream') > -1) {\n        type = 'application/octet-stream';\n      }\n      if (this.yargObj.F) {\n        type = 'multipart/form-data';\n      }\n    } else {\n      // --data \"key=value\"\n      const paramsD = this.yargObj?.d;\n      // -F \"file_field=@/path/to/local/file.txt\"\n      // --form 'str=\"123\"'\n      const paramsF = this.yargObj?.F ?? this.yargObj?.f;\n      if (typeof paramsF === 'string' && paramsF) {\n        type = 'multipart/form-data';\n      } else if (typeof paramsD === 'string' && paramsD) {\n        try {\n          JSON.parse(paramsD);\n          type = 'application/json';\n        } catch (error) {\n          // Type takes form-urlencoded when data is not a json string\n          type = 'application/x-www-form-urlencoded';\n        }\n      }\n    }\n    let body: string | Record<string, string> | undefined;\n    const formData = this.yargObj?.f ?? this.yargObj?.F;\n    const formParamData = this.yargObj?.f;\n    switch (type) {\n      case 'application/json':\n        try {\n          body = JSON.parse(data as string);\n        } catch (error) {\n          body = data as string;\n        }\n        break;\n      case 'application/x-www-form-urlencoded':\n        if (data) {\n          try {\n            const urlSearchParams = new URLSearchParams(data as string);\n            const params = {};\n            for (const [key, value] of urlSearchParams) {\n              params[key] = value;\n            }\n            body = params;\n          } catch (error) {\n            body = data as string;\n          }\n        } else if (formParamData) {\n          body = this.transKeyValueArrayToObj(\n            formParamData as string[] | string,\n          );\n        }\n        break;\n      case 'multipart/form-data':\n        if (formData) {\n          body = this.transKeyValueArrayToObj(formData as string[] | string);\n        }\n        break;\n      case 'application/octet-stream':\n        body = data as string;\n        break;\n      default:\n        body = undefined;\n        break;\n    }\n    const requestBody = {\n      type,\n      data: body,\n    };\n    return requestBody;\n  }\n  parse() {\n    const uri = this.getUrl();\n    const headers = this.getHeaders();\n    const method = this.getMethods();\n    const obj = new URL(uri);\n    const res: ParsedResult = {\n      url: uri,\n      originPath: obj?.origin + obj?.pathname,\n      params: {},\n      method,\n      headers,\n      query: this.getQuery(uri),\n      body: this.getBody(headers) as Record<string, string>,\n    };\n    return res;\n  }\n}\n\nexport { CURLParser, ParsedResult };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function getCanvasOffset() {\n  const canvasDOM = document.querySelector('.gedit-flow-background-layer');\n  const canvasRect = canvasDOM?.getBoundingClientRect();\n  return { x: canvasRect?.x ?? 0, y: canvasRect?.y ?? 0 };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PluginType } from '@coze-arch/bot-api/plugin_develop';\nimport { PluginDevelopApi } from '@coze-arch/bot-api';\n/**\n * Get the version number of the workflow according to the pluginId of the workflow.\n */\nexport const getWorkflowVersionByPluginId = async ({\n  spaceId,\n  pluginId,\n}: {\n  spaceId: string;\n  pluginId?: string;\n}) => {\n  if (!pluginId || pluginId === '0') {\n    return;\n  }\n  const resp = await PluginDevelopApi.GetPlaygroundPluginList(\n    {\n      space_id: spaceId,\n      page: 1,\n      size: 1,\n      plugin_ids: [pluginId],\n      plugin_types: [PluginType.WORKFLOW, PluginType.IMAGEFLOW],\n    },\n    {\n      __disableErrorToast: true,\n    },\n  );\n\n  // Complete version information\n  const versionName = resp.data?.plugin_list?.[0]?.version_name;\n  return versionName;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { EntityManager } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocumentProvider,\n  type WorkflowDocument,\n  type WorkflowNodeRegistry,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowBatchService,\n  WorkflowVariableService,\n  WorkflowVariableValidationService,\n} from '@coze-workflow/variable';\nimport {\n  type NodeTemplateInfo,\n  WorkflowNodesService,\n  type PlaygroundContext,\n} from '@coze-workflow/nodes';\nimport { NODE_ORDER, StandardNodeType } from '@coze-workflow/base/types';\nimport {\n  workflowApi,\n  WorkflowMode,\n  type NodeTemplateListResponse,\n} from '@coze-workflow/base/api';\nimport { REPORT_EVENTS } from '@coze-arch/report-events';\nimport { CustomError } from '@coze-arch/bot-error';\nimport {\n  type NodeCategory as ServerNodeCategory,\n  type PluginCategory,\n  type PluginAPINode,\n} from '@coze-arch/bot-api/workflow_api';\nimport {\n  ProductEntityType,\n  SortType,\n  type GetUserFavoriteListData,\n} from '@coze-arch/bot-api/product_api';\nimport { type Model } from '@coze-arch/bot-api/developer_api';\nimport { ProductApi } from '@coze-arch/bot-api';\n\nimport {\n  type NodeTemplate,\n  type PluginApiNodeTemplate,\n  type PluginCategoryNodeTemplate,\n  type NodeCategory,\n} from './typing';\nimport { createApiNodeInfo } from './hooks/use-add-node-modal/helper';\nimport { WorkflowGlobalStateEntity } from './entities';\nimport { PAGE_SIZE } from './components/node-panel/constant';\n\nexport interface ImageflowNode {\n  title: string;\n  desc: string;\n  icon: string;\n  apiName: string;\n  apiID: string;\n  pluginID: string;\n  pluginName: string;\n}\n\nexport interface ImageflowNodesGroup {\n  category: string;\n  tools: ImageflowNode[];\n}\n@injectable()\nexport class WorkflowPlaygroundContext implements PlaygroundContext {\n  protected nodeTemplateMap = new Map<StandardNodeType, NodeTemplate>();\n  protected pluginApiMap: Record<string, PluginAPINode> = {};\n  protected pluginCategoryMap: Record<string, PluginCategory> = {};\n  public favoritePlugins: GetUserFavoriteListData | undefined;\n\n  protected nodeCategoryList: ServerNodeCategory[] = [];\n  public imageflowNodes: ImageflowNode[];\n\n  @inject(WorkflowDocumentProvider)\n  protected documentProvider: WorkflowDocumentProvider;\n\n  @inject(WorkflowVariableService)\n  readonly variableService: WorkflowVariableService;\n  @inject(WorkflowBatchService) readonly batchService: WorkflowBatchService;\n  @inject(WorkflowVariableValidationService)\n  readonly variableValidationService: WorkflowVariableValidationService;\n  @inject(WorkflowNodesService) readonly nodesService: WorkflowNodesService;\n  @inject(EntityManager) public entityManager: EntityManager;\n\n  protected modelList: Model[];\n\n  get models() {\n    return this.modelList;\n  }\n\n  set models(models: Model[]) {\n    this.modelList = models;\n  }\n\n  /**\n   * Acquire documents\n   */\n  get document(): WorkflowDocument {\n    return this.documentProvider();\n  }\n  /**\n   * Get, workflow node template\n   */\n  async loadNodeInfos(locale: string): Promise<void> {\n    const nodeIds: StandardNodeType[] = Object.values(StandardNodeType);\n    let resp: NodeTemplateListResponse | undefined;\n    let favoritePlugins: GetUserFavoriteListData | undefined;\n    const response = await Promise.allSettled([\n      workflowApi.NodeTemplateList(\n        {\n          node_types: nodeIds,\n        },\n        {\n          headers: {\n            'x-locale': locale, // zh-CN, en-US\n          },\n        },\n      ),\n      this.fetchFavoritePlugins({ pageNum: 1 }),\n    ]);\n    response[0].status === 'fulfilled' && (resp = response[0].value);\n    response[1].status === 'fulfilled' && (favoritePlugins = response[1].value);\n\n    // Convert the template data returned by the server level to type: '1', which is the same as the standard StandardNodeType.\n    const typeKey = 'node_type';\n\n    this.favoritePlugins = favoritePlugins;\n    this.nodeCategoryList = resp?.data?.cate_list ?? [];\n    this.pluginApiMap = (resp?.data?.plugin_api_list ?? []).reduce<\n      Record<string, PluginAPINode>\n    >((acc, curr) => {\n      curr.api_id && (acc[curr.api_id] = curr);\n      return acc;\n    }, {});\n    this.pluginCategoryMap = (resp?.data?.plugin_category_list ?? []).reduce<\n      Record<string, PluginCategory>\n    >((acc, curr) => {\n      curr.plugin_category_id && (acc[curr.plugin_category_id] = curr);\n      return acc;\n    }, {});\n    resp?.data?.template_list?.forEach(temp => {\n      if (temp[typeKey]) {\n        this.nodeTemplateMap.set(`${temp[typeKey]}` as StandardNodeType, {\n          ...temp,\n          type: `${temp[typeKey]}` as StandardNodeType,\n        });\n      }\n    });\n  }\n\n  getImageFlowNode(pluginId: string, apiName: string) {\n    return this.imageflowNodes.find(\n      tool => tool.pluginID === pluginId && tool.apiName === apiName,\n    );\n  }\n\n  getNodeTemplateInfoByType = (\n    type: StandardNodeType,\n  ): NodeTemplateInfo | undefined => {\n    const registry = this.document.getNodeRegister<WorkflowNodeRegistry>(type);\n    if (\n      !registry ||\n      !registry.meta ||\n      registry.meta.nodeDTOType === undefined\n    ) {\n      throw new CustomError(\n        REPORT_EVENTS.parmasValidation,\n        `Unknown NodeMeta by type ${type}`,\n      );\n    }\n    const info = this.nodeTemplateMap.get(\n      registry.meta.nodeDTOType as StandardNodeType,\n    );\n\n    if (!info) {\n      return;\n    }\n\n    return {\n      title: info.name as string,\n      icon: info.icon_url as string,\n      description: info.desc as string,\n      mainColor: info.color || '',\n      subTitle: (type !== StandardNodeType.Start &&\n      type !== StandardNodeType.End\n        ? info.name\n        : '') as string,\n    };\n  };\n\n  /**\n   * This will prohibit operations such as circling and deleting\n   */\n  get disabled(): boolean {\n    return !!this.globalState?.readonly;\n  }\n\n  /**\n   * This way of passing through the context is not very good, and it needs to be rebuilt later.\n   */\n  get spaceId(): string | undefined {\n    return this.globalState?.spaceId;\n  }\n\n  get flowMode(): WorkflowMode {\n    return this.globalState?.flowMode ?? WorkflowMode.Workflow;\n  }\n\n  getTemplateList(types: StandardNodeType[] = []): NodeTemplate[] {\n    // HACK: The type of the passed type is string, and then the template returned by the backend is actually number.\n    return (\n      types\n        .sort(\n          (prev, next) => Number(NODE_ORDER[prev]) - Number(NODE_ORDER[next]),\n        )\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        .map(type => this.nodeTemplateMap.get(type)!)\n        .filter(Boolean)\n    );\n  }\n\n  async fetchFavoritePlugins({\n    pageNum,\n    pageSize = PAGE_SIZE,\n  }: {\n    pageNum: number;\n    pageSize?: number;\n  }): Promise<GetUserFavoriteListData | undefined> {\n    // will support soon\n    if (IS_OPEN_SOURCE) {\n      return {\n        favorite_products: [],\n        has_more: false,\n      };\n    }\n\n    const resp = await ProductApi.PublicGetUserFavoriteList({\n      entity_type: ProductEntityType.Plugin,\n      sort_type: SortType.Newest,\n      page_num: pageNum,\n      page_size: pageSize,\n    });\n    return resp.data;\n  }\n\n  getTemplateCategoryList(\n    enabledNodeTypes: StandardNodeType[] = [],\n    isSupportImageflowNodes = false,\n  ): NodeCategory[] {\n    const isBindDouyin = Boolean(this.globalState?.isBindDouyin);\n    const nodeCategoryList =\n      this.nodeCategoryList.length !== 0\n        ? this.nodeCategoryList\n        : // fallback when server data load failed\n          [\n            {\n              name: '',\n              node_type_list: enabledNodeTypes,\n            },\n          ];\n    return nodeCategoryList\n      .map(category => {\n        const nodeList =\n          category.node_type_list\n            ?.filter(item =>\n              enabledNodeTypes.includes(item as StandardNodeType),\n            )\n            ?.map(item => this.nodeTemplateMap.get(item as StandardNodeType))\n            ?.filter<NodeTemplate>((item): item is NodeTemplate =>\n              Boolean(item),\n            ) ?? [];\n        const pluginApiList: PluginApiNodeTemplate[] = (\n          category.plugin_api_id_list ?? []\n        )?.map(apiId => {\n          const pluginInfo = this.pluginApiMap[apiId];\n          const nodeJSON = createApiNodeInfo(\n            {\n              name: pluginInfo.api_name,\n              plugin_name: pluginInfo.name,\n              api_id: pluginInfo.api_id,\n              plugin_id: pluginInfo.plugin_id,\n              desc: pluginInfo.desc,\n            },\n            pluginInfo.icon_url,\n          );\n          return {\n            type: StandardNodeType.Api,\n            ...pluginInfo,\n            nodeJSON,\n          };\n        });\n        const pluginCategoryList: PluginCategoryNodeTemplate[] = (\n          category.plugin_category_id_list ?? []\n        ).map(categoryId => {\n          const pluginCategory = this.pluginCategoryMap[categoryId];\n          return {\n            type: StandardNodeType.Api,\n            ...pluginCategory,\n            categoryInfo: {\n              categoryId,\n              onlyOfficial: pluginCategory.only_official,\n            },\n          };\n        });\n        return {\n          categoryName: category.name,\n          nodeList: isSupportImageflowNodes\n            ? [\n                ...nodeList,\n                ...(isBindDouyin ? [] : pluginApiList),\n                ...(isBindDouyin ? [] : pluginCategoryList),\n              ]\n            : nodeList,\n        };\n      })\n      .filter(category => category.nodeList.length > 0);\n  }\n  get globalState() {\n    return this.entityManager.getEntity<WorkflowGlobalStateEntity>(\n      WorkflowGlobalStateEntity,\n    );\n  }\n\n  get schemaGray(): {\n    isBatchV2: boolean;\n  } {\n    // const { schemaGray } = this.globalState?.config ?? {};\n    return {\n      isBatchV2: false,\n    };\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst isAppleDevice = /(mac|iphone|ipod|ipad)/i.test(\n  typeof navigator !== 'undefined' ? navigator?.platform : '',\n);\n// Keyboard Event keyCode Alias\nconst aliasKeyCodeMap = {\n  '0': 48,\n  '1': 49,\n  '2': 50,\n  '3': 51,\n  '4': 52,\n  '5': 53,\n  '6': 54,\n  '7': 55,\n  '8': 56,\n  '9': 57,\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  ctrl: 17,\n  alt: 18,\n  pausebreak: 19,\n  capslock: 20,\n  esc: 27,\n  space: 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  leftarrow: 37,\n  uparrow: 38,\n  rightarrow: 39,\n  downarrow: 40,\n  insert: 45,\n  delete: 46,\n  a: 65,\n  b: 66,\n  c: 67,\n  d: 68,\n  e: 69,\n  f: 70,\n  g: 71,\n  h: 72,\n  i: 73,\n  j: 74,\n  k: 75,\n  l: 76,\n  m: 77,\n  n: 78,\n  o: 79,\n  p: 80,\n  q: 81,\n  r: 82,\n  s: 83,\n  t: 84,\n  u: 85,\n  v: 86,\n  w: 87,\n  x: 88,\n  y: 89,\n  z: 90,\n  leftwindowkey: 91,\n  rightwindowkey: 92,\n  meta: isAppleDevice ? [91, 93] : [91, 92],\n  selectkey: 93,\n  numpad0: 96,\n  numpad1: 97,\n  numpad2: 98,\n  numpad3: 99,\n  numpad4: 100,\n  numpad5: 101,\n  numpad6: 102,\n  numpad7: 103,\n  numpad8: 104,\n  numpad9: 105,\n  multiply: 106,\n  add: 107,\n  subtract: 109,\n  decimalpoint: 110,\n  divide: 111,\n  f1: 112,\n  f2: 113,\n  f3: 114,\n  f4: 115,\n  f5: 116,\n  f6: 117,\n  f7: 118,\n  f8: 119,\n  f9: 120,\n  f10: 121,\n  f11: 122,\n  f12: 123,\n  numlock: 144,\n  scrolllock: 145,\n  semicolon: 186,\n  equalsign: 187,\n  '=': 187,\n  comma: 188,\n  dash: 189,\n  '-': 189,\n  period: 190,\n  forwardslash: 191,\n  graveaccent: 192,\n  openbracket: 219,\n  backslash: 220,\n  closebracket: 221,\n  singlequote: 222,\n};\n\nconst modifierKey = {\n  ctrl: (event: KeyboardEvent) => event.ctrlKey,\n  shift: (event: KeyboardEvent) => event.shiftKey,\n  alt: (event: KeyboardEvent) => event.altKey,\n  meta: (event: KeyboardEvent) => {\n    if (event.type === 'keyup') {\n      return aliasKeyCodeMap.meta.includes(event.keyCode);\n    }\n    return event.metaKey;\n  },\n};\n\n// Number of activation keys based on event\nfunction countKeyByEvent(event: KeyboardEvent): number {\n  const countOfModifier = Object.keys(modifierKey).reduce((total, key) => {\n    if (modifierKey[key](event)) {\n      return total + 1;\n    }\n\n    return total;\n  }, 0);\n\n  // 16 17 18 91 92 is the keyCode of the modifier key. If keyCode is a modifier key, then the number of activations is the number of modifier keys. If not, then + 1 is required.\n  return [16, 17, 18, 91, 92].includes(event.keyCode)\n    ? countOfModifier\n    : countOfModifier + 1;\n}\n\n/**\n *\n * @param event\n * @param keyString 'ctrl.s' 'meta.s'\n * @param exactMatch\n */\nfunction isKeyStringMatch(\n  event: KeyboardEvent,\n  keyString: string,\n  exactMatch = true,\n): boolean {\n  // When the browser automatically completes the input, keyDown and keyUp events will be triggered, but at this time event.key, etc. are empty\n  if (!event.key || !keyString) {\n    return false;\n  }\n  // String in turn determines whether there is a key combination\n  const genArr = keyString.split(/\\s+/);\n  let genLen = 0;\n\n  for (const key of genArr) {\n    // key combination\n    const genModifier = modifierKey[key];\n    // keyCode alias\n    const aliasKeyCode: number | number[] = aliasKeyCodeMap[key.toLowerCase()];\n\n    if (\n      (genModifier && genModifier(event)) ||\n      (aliasKeyCode && aliasKeyCode === event.keyCode)\n    ) {\n      genLen++;\n    }\n  }\n\n  /**\n   * It is necessary to determine that the triggered key is exactly the same as the monitored key. The judgment method is that the triggered key is equal to the monitored key.\n   * genLen == genArr.length can determine that there is a listening key among the triggered keys\n   * countKeyByEvent (event) === genArr.length The number of keys triggered by the judgment is equal to the number of keys listened to\n   * It is mainly used to prevent the situation that pressing a subset of the key combination will also trigger, such as listening to the event that ctrl + a will trigger listening to the two keys ctrl and a.\n   */\n  if (exactMatch) {\n    return genLen === genArr.length && countKeyByEvent(event) === genArr.length;\n  }\n  return genLen === genArr.length;\n}\n\n/**\n * Matches the specified shortcut\n * @param event\n * @param shortcuts\n */\nexport function isShortcutsMatch(\n  event: KeyboardEvent,\n  shortcuts: string[],\n): boolean {\n  return shortcuts.some(keyString => isKeyStringMatch(event, keyString));\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlowNodeTransformData } from '@flowgram-adapter/free-layout-editor';\nimport { type SelectionService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowNodeEntity,\n  type WorkflowSelectService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { Rectangle } from '@flowgram-adapter/common';\n\nconst BOUNDS_PADDING = 2;\nexport function getSelectionBounds(\n  selectionService: SelectionService | WorkflowSelectService,\n  ignoreOneSelect?: boolean, // Ignore radio\n): Rectangle {\n  const selectedNodes = selectionService.selection.filter(\n    node => node instanceof WorkflowNodeEntity,\n  );\n\n  // It is not displayed when a single is selected.\n  return selectedNodes.length > (ignoreOneSelect ? 1 : 0)\n    ? Rectangle.enlarge(\n        selectedNodes.map(n => n.getData(FlowNodeTransformData)!.bounds),\n      ).pad(BOUNDS_PADDING)\n    : Rectangle.EMPTY;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport { inject, injectable } from 'inversify';\nimport { SelectorBoxConfigEntity } from '@flowgram-adapter/free-layout-editor';\nimport { FlowNodeTransformData } from '@flowgram-adapter/free-layout-editor';\nimport {\n  EditorState,\n  EditorStateConfigEntity,\n  Layer,\n  PlaygroundConfigEntity,\n  observeEntities,\n  observeEntity,\n  observeEntityDatas,\n  type LayerOptions,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowDocument,\n  WorkflowDragService,\n  WorkflowHoverService,\n  WorkflowLineEntity,\n  WorkflowLinesManager,\n  WorkflowNodeEntity,\n  WorkflowPortEntity,\n  WorkflowSelectService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { type IPoint } from '@flowgram-adapter/common';\n\nimport { getSelectionBounds } from '../utils/selection-utils';\nimport { PORT_BG_CLASS_NAME } from '../constants/points';\n\nexport interface HoverLayerOptions extends LayerOptions {\n  canHovered?: (e: MouseEvent, service: WorkflowHoverService) => boolean;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace HoverLayerOptions {\n  export const DEFAULT: HoverLayerOptions = {\n    canHovered: () => true,\n  };\n}\n\nconst LINE_CLASS_NAME = '.gedit-flow-activity-line';\nconst NODE_CLASS_NAME = '.gedit-flow-activity-node';\n\n@injectable()\nexport class HoverLayer extends Layer<HoverLayerOptions> {\n  static type = 'HoverLayer';\n  @inject(WorkflowDocument) document: WorkflowDocument;\n  @inject(WorkflowSelectService) selectionService: WorkflowSelectService;\n  @inject(WorkflowDragService) dragService: WorkflowDragService;\n  @inject(WorkflowHoverService) hoverService: WorkflowHoverService;\n  @inject(WorkflowLinesManager)\n  linesManager: WorkflowLinesManager;\n  @observeEntity(EditorStateConfigEntity)\n  protected editorStateConfig: EditorStateConfigEntity;\n  @observeEntity(SelectorBoxConfigEntity)\n  protected selectorBoxConfigEntity: SelectorBoxConfigEntity;\n  @inject(PlaygroundConfigEntity) configEntity: PlaygroundConfigEntity;\n  /**\n   * Listen node transform\n   */\n  @observeEntityDatas(WorkflowNodeEntity, FlowNodeTransformData)\n  protected readonly nodeTransforms: FlowNodeTransformData[];\n  /**\n   * Sort by Selected\n   * @private\n   */\n  protected nodeTransformsWithSort: FlowNodeTransformData[] = [];\n  autorun(): void {\n    const { activatedNode } = this.selectionService;\n    this.nodeTransformsWithSort = this.nodeTransforms\n      .filter(n => n.entity.id !== 'root')\n      .reverse() // The post-created one comes first\n      .sort(n1 => (n1.entity === activatedNode ? -1 : 0));\n  }\n  /**\n   * monitor line\n   */\n  @observeEntities(WorkflowLineEntity)\n  protected readonly lines: WorkflowLineEntity[];\n  /**\n   * Is the line being adjusted?\n   * @protected\n   */\n  get isDrawing(): boolean {\n    return this.linesManager.isDrawing;\n  }\n  onReady(): void {\n    this.options = {\n      ...HoverLayerOptions.DEFAULT,\n      ...this.options,\n    };\n    this.toDispose.pushAll([\n      // Monitor canvas mouse movement events\n      this.listenPlaygroundEvent('mousemove', (e: MouseEvent) => {\n        this.hoverService.hoveredPos = this.config.getPosFromMouseEvent(e);\n        if (!this.isEnabled()) {\n          return;\n        }\n        // @ts-expect-error -- linter-disable-autofix\n        if (!this.options.canHovered(e, this.hoverService)) {\n          return;\n        }\n        const mousePos = this.config.getPosFromMouseEvent(e);\n        // Update hover status\n        this.updateHoveredState(mousePos, e?.target as HTMLElement);\n      }),\n      this.selectionService.onSelectionChanged(() => this.autorun()),\n      // Control selection logic\n      this.listenPlaygroundEvent(\n        'mousedown',\n        (e: MouseEvent): boolean | undefined => {\n          if (!this.isEnabled() || this.isDrawing) {\n            return undefined;\n          }\n          const { hoveredNode } = this.hoverService;\n          // Reset line\n          if (hoveredNode && hoveredNode instanceof WorkflowLineEntity) {\n            this.dragService.resetLine(hoveredNode, e);\n            return true;\n          }\n          if (\n            hoveredNode &&\n            hoveredNode instanceof WorkflowPortEntity &&\n            hoveredNode.portType !== 'input' &&\n            !hoveredNode.disabled &&\n            e.button !== 1\n          ) {\n            e.stopPropagation();\n            e.preventDefault();\n            this.selectionService.clear();\n            this.dragService.startDrawingLine(hoveredNode, e);\n            return true;\n          }\n          const mousePos = this.config.getPosFromMouseEvent(e);\n          const selectionBounds = getSelectionBounds(\n            this.selectionService,\n            // Only multi-select mode is considered here, and radio mode has sunk into use-node-render\n            true,\n          );\n          if (\n            selectionBounds.width > 0 &&\n            selectionBounds.contains(mousePos.x, mousePos.y)\n          ) {\n            /**\n             * Drag select box\n             */\n            this.dragService.startDragSelectedNodes(e).then(dragSuccess => {\n              if (!dragSuccess) {\n                // The drag failed to trigger the click successfully.\n                if (hoveredNode && hoveredNode instanceof WorkflowNodeEntity) {\n                  if (e.metaKey || e.shiftKey || e.ctrlKey) {\n                    this.selectionService.toggleSelect(hoveredNode);\n                  } else {\n                    this.selectionService.selectNode(hoveredNode);\n                  }\n                } else {\n                  this.selectionService.clear();\n                }\n              }\n            });\n            // The trigger selector box will be organized here.\n            return true;\n          } else {\n            if (!hoveredNode) {\n              this.selectionService.clear();\n            }\n          }\n          return undefined;\n        },\n      ),\n    ]);\n  }\n\n  /**\n   * Update hoverd\n   * @param mousePos\n   */\n  updateHoveredState(mousePos: IPoint, target?: HTMLElement): void {\n    const nodeTransforms = this.nodeTransformsWithSort;\n    // //Determine whether the connection point is hover\n    const portHovered = this.linesManager.getPortFromMousePos(mousePos);\n\n    const lineDomNodes = this.playgroundNode.querySelectorAll(LINE_CLASS_NAME);\n    const checkTargetFromLine = [...lineDomNodes].some(lineDom =>\n      lineDom.contains(target as HTMLElement),\n    );\n    // By default, only output points can be hover\n    if (portHovered) {\n      // The output point can be directly selected.\n      if (portHovered.portType === 'output') {\n        this.updateHoveredKey(portHovered.id);\n      } else if (\n        checkTargetFromLine ||\n        target?.className?.includes?.(PORT_BG_CLASS_NAME)\n      ) {\n        // The input point uses to get the closest line\n        const lineHovered =\n          this.linesManager.getCloseInLineFromMousePos(mousePos);\n        if (lineHovered) {\n          this.updateHoveredKey(lineHovered.id);\n        }\n      }\n      return;\n    }\n\n    // Drawing situation, nodes and lines cannot be selected\n    if (this.isDrawing) {\n      return;\n    }\n\n    const nodeHovered = nodeTransforms.find((trans: FlowNodeTransformData) =>\n      trans.bounds.contains(mousePos.x, mousePos.y),\n    )?.entity as WorkflowNodeEntity;\n\n    // Determine whether the element where the current mouse position is located is inside the node\n    const nodeDomNodes = this.playgroundNode.querySelectorAll(NODE_CLASS_NAME);\n    const checkTargetFromNode = [...nodeDomNodes].some(nodeDom =>\n      nodeDom.contains(target as HTMLElement),\n    );\n\n    if (nodeHovered || checkTargetFromNode) {\n      if (nodeHovered?.id) {\n        this.updateHoveredKey(nodeHovered.id);\n      }\n    }\n\n    const nodeInContainer = !!(\n      nodeHovered?.parent && nodeHovered.parent.flowNodeType !== 'root'\n    );\n\n    // Get the closest line\n    // Lines will intersect. You need to get the line closest to the point. Lines that cannot be deleted cannot be selected.\n    const lineHovered = checkTargetFromLine\n      ? this.linesManager.getCloseInLineFromMousePos(mousePos)\n      : undefined;\n    const lineInContainer = !!lineHovered?.inContainer;\n\n    // Determine whether the node in the container is hover\n    if (nodeHovered && nodeInContainer) {\n      this.updateHoveredKey(nodeHovered.id);\n      return;\n    }\n    // Determine whether the lines in the container are hovered\n    if (lineHovered && lineInContainer) {\n      this.updateHoveredKey(lineHovered.id);\n      return;\n    }\n\n    // Determine whether the node is hovering\n    if (nodeHovered) {\n      this.updateHoveredKey(nodeHovered.id);\n      return;\n    }\n    // Determine if the line is hovering\n    if (lineHovered) {\n      this.hoverService.updateHoveredKey(lineHovered.id);\n      return;\n    }\n\n    // None of the above logic hits, then clear the hoverd.\n    this.hoverService.clearHovered();\n\n    const currentState = this.editorStateConfig.getCurrentState();\n    const isMouseFriendly =\n      currentState === EditorState.STATE_MOUSE_FRIENDLY_SELECT;\n\n    // The mouse is given priority, and instead of holding down the shift button, it is updated to small hands.\n    if (isMouseFriendly && !this.editorStateConfig.isPressingShift) {\n      this.configEntity.updateCursor('grab');\n    }\n  }\n\n  updateHoveredKey(key: string): void {\n    // Mouse priority interaction mode, if it is hover, you need to remove the small hand of the mouse and restore the original style of the mouse\n    this.configEntity.updateCursor('default');\n    this.hoverService.updateHoveredKey(key);\n  }\n\n  /**\n   * Determine if it can be hover\n   * Can @returns hover?\n   */\n  isEnabled(): boolean {\n    const currentState = this.editorStateConfig.getCurrentState();\n    // Select box condition disable hover\n    return (\n      (currentState === EditorState.STATE_SELECT ||\n        currentState === EditorState.STATE_MOUSE_FRIENDLY_SELECT) &&\n      !this.selectorBoxConfigEntity.isStart &&\n      !this.dragService.isDragging\n    );\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { Layer, SelectionService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowCommands,\n  WorkflowDocument,\n  WorkflowHoverService,\n  WorkflowLineEntity,\n  WorkflowLinesManager,\n  WorkflowNodeEntity,\n  type WorkflowNodeMeta,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowShortcutsRegistry } from '../workflow-shorcuts-contribution';\nimport { isShortcutsMatch } from '../utils/shortcuts-utils';\n\n@injectable()\nexport class ShortcutsLayer extends Layer<object> {\n  static type = 'ShortcutsLayer';\n  @inject(WorkflowShortcutsRegistry) shortcuts: WorkflowShortcutsRegistry;\n  @inject(SelectionService) selection: SelectionService;\n  @inject(WorkflowHoverService) hoverService: WorkflowHoverService;\n  @inject(WorkflowDocument) document: WorkflowDocument;\n  @inject(WorkflowLinesManager) linesManager: WorkflowLinesManager;\n  onReady(): void {\n    this.shortcuts.addHandlersIfNotFound(\n      /**\n       * delete\n       */\n      {\n        commandId: WorkflowCommands.DELETE_NODES,\n        shortcuts: ['backspace', 'delete'],\n        isEnabled: () =>\n          this.selection.selection.length > 0 &&\n          !this.config.disabled &&\n          !this.config.readonly,\n        execute: () => {\n          this.selection.selection.forEach(entity => {\n            if (entity instanceof WorkflowNodeEntity) {\n              if (!this.document.canRemove(entity)) {\n                return;\n              }\n              const nodeMeta = entity.getNodeMeta<WorkflowNodeMeta>();\n              const subCanvas = nodeMeta.subCanvas?.(entity);\n              if (subCanvas?.isCanvas) {\n                subCanvas.parentNode.dispose();\n                return;\n              }\n            } else if (\n              entity instanceof WorkflowLineEntity &&\n              !this.linesManager.canRemove(entity)\n            ) {\n              return;\n            }\n            entity.dispose();\n          });\n          this.selection.selection = this.selection.selection.filter(\n            s => !s.disposed,\n          );\n        },\n      },\n      /**\n       * enlarge\n       */\n      {\n        commandId: WorkflowCommands.ZOOM_IN,\n        shortcuts: ['meta =', 'ctrl ='],\n        execute: () => {\n          this.config.zoomin();\n        },\n      },\n      /**\n       * zoom out\n       */\n      {\n        commandId: WorkflowCommands.ZOOM_OUT,\n        shortcuts: ['meta -', 'ctrl -'],\n        execute: () => {\n          this.config.zoomout();\n        },\n      },\n    );\n    this.toDispose.pushAll([\n      // Monitor canvas mouse movement events\n      this.listenPlaygroundEvent('keydown', (e: KeyboardEvent) => {\n        if (!this.isFocused || e.target !== this.playgroundNode) {\n          return;\n        }\n        this.shortcuts.shortcutsHandlers.some(shortcutsHandler => {\n          if (\n            isShortcutsMatch(e, shortcutsHandler.shortcuts) &&\n            (!shortcutsHandler.isEnabled || shortcutsHandler.isEnabled(e))\n          ) {\n            shortcutsHandler.execute(e);\n            e.preventDefault();\n            return true;\n          }\n        });\n      }),\n    ]);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nanoid } from 'nanoid';\nimport {\n  Layer,\n  observeEntity,\n  PlaygroundConfigEntity,\n  SCALE_WIDTH,\n} from '@flowgram-adapter/free-layout-editor';\nimport { domUtils } from '@flowgram-adapter/common';\n\ninterface BackgroundScaleUnit {\n  realSize: number;\n  renderSize: number;\n  zoom: number;\n}\n\nconst PATTERN_ID = 'grid-dot-pattern';\nconst RENDER_SIZE = 20;\nconst DOT_SIZE = 1;\n\n/**\n * Dot grid background\n */\nexport class BackgroundLayer extends Layer {\n  static type = 'WorkflowBackgroundLayer';\n  @observeEntity(PlaygroundConfigEntity)\n  protected playgroundConfigEntity: PlaygroundConfigEntity;\n  protected patternId = `${PATTERN_ID}${nanoid()}`;\n\n  node = domUtils.createDivWithClass('gedit-flow-background-layer');\n  grid: HTMLElement = document.createElement('div');\n\n  /**\n   * current zoom ratio\n   */\n  get zoom(): number {\n    return this.config.finalScale;\n  }\n\n  onReady() {\n    const { firstChild } = this.pipelineNode;\n    // Insert the background to the bottom\n    this.pipelineNode.insertBefore(this.node, firstChild);\n    // Initialization settings Maximum 200% Minimum 10% Zoom\n    this.playgroundConfigEntity.updateConfig({\n      minZoom: 0.1,\n      maxZoom: 2,\n    });\n    // Make sure the dot is located below the line\n    this.grid.style.zIndex = '-1';\n    this.grid.style.position = 'relative';\n    this.node.appendChild(this.grid);\n    this.grid.className = 'gedit-grid-svg';\n  }\n\n  /**\n   * Minimum cell size\n   */\n  getScaleUnit(): BackgroundScaleUnit {\n    const { zoom } = this;\n\n    return {\n      realSize: RENDER_SIZE, // The actual size represented by a cell\n      renderSize: Math.round(RENDER_SIZE * zoom * 100) / 100, // The size value of a cell rendering\n      zoom, // zoom ratio\n    };\n  }\n  /**\n   * draw\n   */\n  autorun(): void {\n    const playgroundConfig = this.playgroundConfigEntity.config;\n    const scaleUnit = this.getScaleUnit();\n    const mod = scaleUnit.renderSize * 10;\n    const viewBoxWidth = playgroundConfig.width + mod * 2;\n    const viewBoxHeight = playgroundConfig.height + mod * 2;\n    const { scrollX } = playgroundConfig;\n    const { scrollY } = playgroundConfig;\n    const scrollXDelta = this.getScrollDelta(scrollX, mod);\n    const scrollYDelta = this.getScrollDelta(scrollY, mod);\n    domUtils.setStyle(this.node, {\n      left: scrollX - SCALE_WIDTH,\n      top: scrollY - SCALE_WIDTH,\n    });\n    this.drawGrid(scaleUnit);\n    // Set Grid\n    this.setSVGStyle(this.grid, {\n      width: viewBoxWidth,\n      height: viewBoxHeight,\n      left: SCALE_WIDTH - scrollXDelta - mod,\n      top: SCALE_WIDTH - scrollYDelta - mod,\n    });\n  }\n\n  /**\n   * Draw mesh\n   */\n  protected drawGrid(unit: BackgroundScaleUnit): void {\n    const minor = unit.renderSize;\n    if (!this.grid) {\n      return;\n    }\n    const patternSize = DOT_SIZE * this.zoom;\n    const newContent = `\n    <svg width=\"100%\" height=\"100%\">\n      <pattern id=\"${this.patternId}\" width=\"${minor}\" height=\"${minor}\" patternUnits=\"userSpaceOnUse\">\n        <circle\n          cx=\"${patternSize}\"\n          cy=\"${patternSize}\"\n          r=\"${patternSize}\"\n          stroke=\"#eceeef\"\n          fill-opacity=\"0.5\"\n        />\n      </pattern>\n      <rect width=\"100%\" height=\"100%\" fill=\"url(#${this.patternId})\"/>\n    </svg>`;\n    this.grid.innerHTML = newContent;\n  }\n\n  protected setSVGStyle(\n    svgElement: HTMLElement | undefined,\n    style: { width: number; height: number; left: number; top: number },\n  ): void {\n    if (!svgElement) {\n      return;\n    }\n\n    svgElement.style.width = `${style.width}px`;\n    svgElement.style.height = `${style.height}px`;\n    svgElement.style.left = `${style.left}px`;\n    svgElement.style.top = `${style.top}px`;\n  }\n\n  /**\n   * Get the relative scroll distance\n   * @param realScroll\n   * @param mod\n   */\n  protected getScrollDelta(realScroll: number, mod: number): number {\n    // There is no need to make up for the difference in forward scrolling.\n    if (realScroll >= 0) {\n      return realScroll % mod;\n    }\n    return mod - (Math.abs(realScroll) % mod);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\n// import { domUtils } from '@flowgram-adapter/common';\nimport { type FlowSelectorBoundsLayerOptions } from '@flowgram-adapter/free-layout-editor';\nimport {\n  SelectionService,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { getSelectionBounds } from '../../utils/selection-utils';\n\nimport styles from './index.module.less';\n\n/**\n * select box\n * @param props\n * @constructor\n */\nexport const SelectorBounds: React.FC<\n  FlowSelectorBoundsLayerOptions\n> = props => {\n  const selectService = useService<SelectionService>(SelectionService);\n  const bounds = getSelectionBounds(selectService, true);\n  if (bounds.width === 0 || bounds.height === 0) {\n    // domUtils.setStyle(domNode, {\n    //   display: 'none',\n    // });\n    return <></>;\n  }\n  const style = {\n    display: 'block',\n    left: bounds.left,\n    top: bounds.top,\n    width: bounds.width,\n    height: bounds.height,\n  };\n  // domUtils.setStyle(domNode, style);\n  return <div className={styles.selectorBoundsForground} style={style} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { inject, injectable } from 'inversify';\nimport { Gesture } from '@use-gesture/vanilla';\nimport {\n  FlowDebugLayer,\n  FlowNodesContentLayer,\n  FlowNodesTransformLayer,\n  FlowScrollBarLayer,\n  FlowSelectorBoundsLayer,\n  FlowSelectorBoxLayer,\n  type FlowRendererContribution,\n  type FlowRendererRegistry,\n} from '@flowgram-adapter/free-layout-editor';\nimport { StackingContextManager } from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowBezierLineContribution,\n  WorkflowFoldLineContribution,\n  WorkflowLinesLayer,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  PlaygroundLayer,\n  type PlaygroundContribution,\n} from '@flowgram-adapter/free-layout-editor';\nimport {\n  WorkflowHoverService,\n  WorkflowLinesManager,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { BackgroundLayer, HoverLayer, ShortcutsLayer } from './layer';\nimport { SelectorBounds } from './components/selector-bounds';\n\n@injectable()\nexport class WorkflowRenderContribution\n  implements FlowRendererContribution, PlaygroundContribution\n{\n  @inject(WorkflowHoverService) protected hoverService: WorkflowHoverService;\n  @inject(StackingContextManager)\n  protected stackingContext: StackingContextManager;\n  @inject(WorkflowLinesManager)\n  protected linesManager: WorkflowLinesManager;\n\n  registerRenderer(registry: FlowRendererRegistry): void {\n    // Canvas base layer, providing zoom, gesture, and more\n    registry.registerLayer(PlaygroundLayer, {\n      hoverService: this.hoverService,\n    });\n    registry.registerLayers(\n      FlowNodesContentLayer,\n      // FlowScrollLimitLayer,//control scrolling range\n      FlowScrollBarLayer, // scroll bar\n      HoverLayer, // Control hover\n      ShortcutsLayer, // Shortcut configuration\n    );\n    // line\n    registry.registerLayer(WorkflowLinesLayer, {\n      renderElement: () => this.stackingContext.node,\n    });\n    // Node location\n    registry.registerLayer(FlowNodesTransformLayer, {\n      renderElement: () => this.stackingContext.node,\n    });\n    registry.registerLayer<FlowSelectorBoundsLayer>(FlowSelectorBoundsLayer, {\n      disableBackground: true,\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      CustomBoundsRenderer: SelectorBounds as any,\n    });\n    registry.registerLayer<FlowSelectorBoxLayer>(FlowSelectorBoxLayer, {\n      canSelect: (event, entity) => {\n        // The following conditions must be met:\n        // 1. Non-left button cannot trigger box selection\n        if (event.button !== 0) {\n          return false;\n        }\n        const element = event.target as Element;\n        // 2. No element can trigger the box selection\n        if (!element) {\n          return false;\n        }\n        // 3. If there is a custom configuration, the configuration shall prevail.\n        if (element) {\n          if (element.closest('[data-flow-editor-selectable=\"true\"]')) {\n            return true;\n          }\n          if (element.closest('[data-flow-editor-selectable=\"false\"]')) {\n            return false;\n          }\n        }\n        // 4. Hovering to nodes or lines cannot trigger box selection\n        if (this.hoverService.isSomeHovered()) {\n          return false;\n        }\n        // 5. Cannot trigger box selection without being in the canvas\n        if (\n          !element.classList.contains('gedit-playground-layer') &&\n          !element.classList.contains('gedit-flow-background-layer') &&\n          // Blank space for connection\n          !element.closest('.gedit-flow-activity-edge')\n        ) {\n          return false;\n        }\n        return true;\n      },\n    });\n    // Debug Canvas\n    if (location.search.match('playground_debug')) {\n      registry.registerLayers(FlowDebugLayer);\n    }\n    // The background is inserted at the end, because the position will be adjusted inside.\n    registry.registerLayer(BackgroundLayer);\n  }\n\n  /**\n   * This is used to prevent gesture scaling of document.body\n   * @private\n   */\n  private _gestureForStopDefault = new Gesture(document.body, {\n    onPinch: () => {\n      // Do nothing\n    },\n  });\n  onReady(): void {\n    if (document.documentElement) {\n      document.documentElement.style.overscrollBehavior = 'none';\n    }\n    document.body.style.overscrollBehavior = 'none';\n    this.linesManager\n      .registerContribution(WorkflowBezierLineContribution)\n      .registerContribution(WorkflowFoldLineContribution);\n  }\n\n  onDispose() {\n    this._gestureForStopDefault.destroy();\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContainerModule } from 'inversify';\nimport { FlowRendererContribution } from '@flowgram-adapter/free-layout-editor';\nimport { PlaygroundContribution } from '@flowgram-adapter/free-layout-editor';\nimport { bindContributions } from '@flowgram-adapter/common';\n\nimport { WorkflowShortcutsRegistry } from './workflow-shorcuts-contribution';\nimport { WorkflowRenderContribution } from './workflow-render-contribution';\n\nexport const WorkflowRenderContainerModule = new ContainerModule(bind => {\n  bindContributions(bind, WorkflowRenderContribution, [\n    PlaygroundContribution,\n    FlowRendererContribution,\n  ]);\n  bind(WorkflowShortcutsRegistry).toSelf().inSingletonScope();\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useLayoutEffect, useMemo, useEffect } from 'react';\n\nimport { FlowRendererRegistry } from '@flowgram-adapter/free-layout-editor';\nimport {\n  LoggerEvent,\n  LoggerService,\n  useService,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowDocument } from '@flowgram-adapter/free-layout-editor';\nimport { reportTti } from '@coze-arch/report-tti/custom-perf-metric';\n\nimport styles from './index.module.less';\n\nexport const WorkflowLoader: React.FC = () => {\n  const doc = useService<WorkflowDocument>(WorkflowDocument);\n  const renderRegistry = useService<FlowRendererRegistry>(FlowRendererRegistry);\n  const loggerService = useService<LoggerService>(LoggerService);\n  useMemo(() => renderRegistry.init(), [renderRegistry]);\n  useLayoutEffect(() => {\n    // load data\n    doc.load();\n    // Destroy data\n    return () => doc.dispose();\n  }, [doc]);\n\n  useEffect(() => {\n    const disposable = loggerService.onLogger(({ event }) => {\n      if (event === LoggerEvent.CANVAS_TTI) {\n        // Report to coze\n        reportTti();\n      }\n    });\n\n    return () => {\n      disposable?.dispose();\n    };\n  }, []);\n\n  return <div className={styles.playgroundLoad} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useMemo } from 'react';\n\nimport { type interfaces } from 'inversify';\nimport { FlowRendererContainerModule } from '@flowgram-adapter/free-layout-editor';\nimport { createNodeCorePlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createFreeStackPlugin } from '@flowgram-adapter/free-layout-editor';\nimport { createFreeAutoLayoutPlugin } from '@flowgram-adapter/free-layout-editor';\nimport { FlowDocumentContainerModule } from '@flowgram-adapter/free-layout-editor';\nimport {\n  PlaygroundReactProvider,\n  type Plugin,\n} from '@flowgram-adapter/free-layout-editor';\nimport { WorkflowDocumentContainerModule } from '@flowgram-adapter/free-layout-editor';\n\nimport { WorkflowRenderContainerModule } from './workflow-render-container-module';\nimport { WorkflowLoader } from './workflow-loader';\n\nexport interface WorkflowRenderProviderProps {\n  children: React.ReactElement;\n  containerModules?: interfaces.ContainerModule[];\n  preset?: () => Plugin[];\n  parentContainer?: interfaces.Container;\n}\n\n/**\n * Canvas Engine Rendering\n */\nexport const WorkflowRenderProvider = (props: WorkflowRenderProviderProps) => {\n  const modules = useMemo(\n    () => [\n      FlowDocumentContainerModule, // default document\n      FlowRendererContainerModule, // default rendering\n      // FlowActivitiesContainerModule,//This is a module to fix the canvas, no dependency is currently required\n      WorkflowDocumentContainerModule, // extended document\n      WorkflowRenderContainerModule, // extended rendering\n      ...(props.containerModules || []),\n    ],\n    [],\n  );\n\n  const preset = useCallback(\n    () => [\n      createFreeAutoLayoutPlugin({}),\n      createFreeStackPlugin({}), // rendering hierarchy management\n      createNodeCorePlugin({}),\n      ...(props.preset?.() || []),\n    ],\n    [],\n  );\n\n  return (\n    <PlaygroundReactProvider\n      containerModules={modules}\n      plugins={preset}\n      parentContainer={props.parentContainer}\n    >\n      <WorkflowLoader />\n      {props.children}\n    </PlaygroundReactProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'reflect-metadata';\n\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { DndProvider } from 'react-dnd';\nimport { forwardRef, useEffect, type PropsWithChildren } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { QueryClientProvider } from '@tanstack/react-query';\nimport { GlobalError } from '@coze-foundation/layout';\nimport { WorkflowRenderProvider } from '@coze-workflow/render';\nimport { WorkflowNodesContainerModule } from '@coze-workflow/nodes';\nimport { WorkflowHistoryContainerModule } from '@coze-workflow/history';\nimport { PUBLIC_SPACE_ID } from '@coze-workflow/base/constants';\nimport { workflowQueryClient } from '@coze-workflow/base/api';\nimport { ErrorBoundary, logger } from '@coze-arch/logger';\nimport { useSpaceStore } from '@coze-arch/bot-studio-store';\n\nimport {\n  type WorkflowPlaygroundProps,\n  type WorkflowPlaygroundRef,\n} from './typing';\nimport { useWorkflowPreset } from './hooks';\nimport { WorkflowPageContainerModule } from './container/workflow-page-container-module';\nimport WorkflowContainer from './components/workflow-container';\n\nconst loggerWithScope = logger.createLoggerWith({\n  ctx: {\n    namespace: 'workflow-error',\n  },\n});\n\nconst PlayGroundErrorBoundary = (props: PropsWithChildren) => {\n  // Use your own ErrorBoundary to display errors under the operation and maintenance platform, which can display more detailed errors.\n  // At the same time, avoid white screen errors under the operation and maintenance platform.\n  if (IS_BOT_OP) {\n    return <>{props.children}</>;\n  }\n\n  return (\n    <ErrorBoundary\n      FallbackComponent={() => (IS_BOT_OP ? null : <GlobalError />)}\n      errorBoundaryName=\"workflow-error-boundary\"\n      logger={loggerWithScope}\n    >\n      {props.children}\n    </ErrorBoundary>\n  );\n};\n\nexport const WorkflowPlayground = forwardRef<\n  WorkflowPlaygroundRef,\n  WorkflowPlaygroundProps\n>(({ spaceId = PUBLIC_SPACE_ID, parentContainer, ...props }, ref) => {\n  console.log('debugger workflow playground');\n  const { spaceList, setSpace, fetchSpaces, checkSpaceID, inited } =\n    useSpaceStore(\n      useShallow(store => ({\n        spaceList: store.spaceList,\n        setSpace: store.setSpace,\n        fetchSpaces: store.fetchSpaces,\n        checkSpaceID: store.checkSpaceID,\n        inited: store.inited,\n      })),\n    );\n  useEffect(() => {\n    let isActive = true;\n    const initSpace = async () => {\n      if (!inited) {\n        await fetchSpaces(true);\n      }\n      if (!isActive) {\n        return;\n      }\n\n      checkSpaceID(spaceId);\n      if (spaceId !== PUBLIC_SPACE_ID) {\n        setSpace(spaceId);\n      }\n    };\n\n    initSpace();\n\n    return () => {\n      isActive = false;\n    };\n  }, [spaceId, fetchSpaces, setSpace, checkSpaceID]);\n\n  const preset = useWorkflowPreset(props);\n\n  if (!inited) {\n    return null;\n  }\n\n  return (\n    <DndProvider backend={HTML5Backend} context={window}>\n      <QueryClientProvider client={workflowQueryClient}>\n        <WorkflowRenderProvider\n          parentContainer={parentContainer}\n          containerModules={[\n            WorkflowNodesContainerModule,\n            WorkflowPageContainerModule,\n            WorkflowHistoryContainerModule,\n          ]}\n          preset={preset}\n        >\n          <PlayGroundErrorBoundary>\n            <WorkflowContainer\n              ref={ref}\n              {...props}\n              spaceId={spaceId}\n              spaceList={spaceList}\n            />\n          </PlayGroundErrorBoundary>\n        </WorkflowRenderProvider>\n      </QueryClientProvider>\n    </DndProvider>\n  );\n});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\n\nimport styles from './index.module.less';\n\nexport const Warning = () => (\n  <div className={classNames(styles.symbol, styles.warning)}>\n    <svg\n      style={{ width: 10, height: 10 }}\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        id=\"path1\"\n        fill=\"#ffffff\"\n        stroke=\"none\"\n        d=\"M 12 0 C 10.674479 0 9.6 1.074528 9.6 2.4 L 9.6 14.4 C 9.6 15.725521 10.674479 16.799999 12 16.799999 C 13.325521 16.799999 14.4 15.725521 14.4 14.4 L 14.4 2.4 C 14.4 1.074528 13.325521 0 12 0 Z\"\n      />\n      <path\n        id=\"path2\"\n        fill=\"#ffffff\"\n        stroke=\"none\"\n        d=\"M 12 19.200001 C 10.674479 19.200001 9.6 20.274479 9.6 21.6 C 9.6 22.925518 10.674479 24 12 24 C 13.325521 24 14.4 22.925518 14.4 21.6 C 14.4 20.274479 13.325521 19.200001 12 19.200001 Z\"\n      />\n    </svg>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport styles from './index.module.less';\n\n// The demo environment self-draws cross-hair, and the formal environment uses IconAdd.\nexport default function CrossHair(): JSX.Element {\n  return (\n    <div className={styles.symbol}>\n      <div className={styles.crossHair} />\n    </div>\n  );\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ReactDOM from 'react-dom';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { useService } from '@flowgram-adapter/free-layout-editor';\nimport {\n  usePlaygroundReadonlyState,\n  WorkflowDragService,\n  WorkflowHoverService,\n  WorkflowLinesManager,\n  type WorkflowPortEntity,\n} from '@flowgram-adapter/free-layout-editor';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport { PORT_BG_CLASS_NAME } from '../../constants/points';\nimport { Warning } from './warning';\nimport CrossHair from './cross-hair';\n\nimport styles from './index.module.less';\n\nexport interface WorkflowPortRenderProps {\n  entity: WorkflowPortEntity;\n  onClick?: (event: React.MouseEvent, port: WorkflowPortEntity) => void;\n}\n\nexport const WorkflowPortRender: React.FC<WorkflowPortRenderProps> =\n  React.memo<WorkflowPortRenderProps>(props => {\n    const dragService = useService<WorkflowDragService>(WorkflowDragService);\n    const hoverService = useService<WorkflowHoverService>(WorkflowHoverService);\n    const linesManager = useService<WorkflowLinesManager>(WorkflowLinesManager);\n    const { entity, onClick } = props;\n    const { portType, portID, relativePosition, disabled, errorMessage } =\n      entity as WorkflowPortEntity & {\n        errorMessage?: string;\n      };\n\n    const [targetElement, setTargetElement] = useState(entity.targetElement);\n    const [posX, updatePosX] = useState(relativePosition.x);\n    const [posY, updatePosY] = useState(relativePosition.y);\n    const [hovered, setHovered] = useState(false);\n    const [linked, setLinked] = useState(Boolean(entity?.lines?.length));\n    const [hasError, setHasError] = useState(props.entity.hasError);\n    const readonly = usePlaygroundReadonlyState();\n\n    const onMouseDown = useCallback(\n      (e: React.MouseEvent) => {\n        const isMouseCenterButton = e.button === 1;\n        if (portType === 'input' || disabled || isMouseCenterButton) {\n          return;\n        }\n        e.stopPropagation();\n        e.preventDefault();\n        dragService.startDrawingLine(entity, e);\n      },\n      // eslint-disable-next-line react-hooks/exhaustive-deps -- custom\n      [dragService, portType, portID],\n    );\n\n    useEffect(() => {\n      // useEffect timing issue may cause port.hasError to be not up-to-date, and validate needs to be triggered again\n      props.entity.validate();\n      setHasError(props.entity.hasError);\n      const dispose = props.entity.onEntityChange(() => {\n        // If there are mounted nodes, there is no need to update the location information\n        if (entity.targetElement) {\n          if (entity.targetElement !== targetElement) {\n            setTargetElement(entity.targetElement);\n          }\n          return;\n        }\n        const newPos = props.entity.relativePosition;\n        // Add round to avoid point jitter\n        updatePosX(Math.round(newPos.x));\n        updatePosY(Math.round(newPos.y));\n      });\n      const dispose2 = hoverService.onHoveredChange(id => {\n        setHovered(hoverService.isHovered(entity.id));\n      });\n      const dispose3 = props.entity.onErrorChanged(() => {\n        setHasError(props.entity.hasError);\n      });\n      const dispose4 = linesManager.onAvailableLinesChange(() => {\n        setTimeout(() => {\n          setLinked(Boolean(entity?.lines?.length));\n        }, 0);\n      });\n      return () => {\n        dispose.dispose();\n        dispose2.dispose();\n        dispose3.dispose();\n        dispose4.dispose();\n      };\n    }, [props.entity, hoverService, entity, targetElement, linesManager]);\n\n    // Monitor changes\n    const className = classNames(styles.workflowPoint, {\n      [styles.hovered]:\n        !readonly && hovered && !disabled && portType !== 'input',\n      // Dark blue dots when there are line links.\n      [styles.linked]: linked,\n    });\n\n    const icon = useMemo(() => {\n      const iconComp = (\n        <div\n          className={classNames({\n            [styles.bg]: true,\n            [PORT_BG_CLASS_NAME]: true,\n            'workflow-point-bg': true,\n            [styles.hasError]: hasError,\n          })}\n        >\n          {hasError ? <Warning /> : <CrossHair />}\n        </div>\n      );\n      if (hasError && errorMessage) {\n        return (\n          <Tooltip\n            className={styles.tooltip}\n            content={errorMessage}\n            trigger=\"hover\"\n            position=\"top\"\n          >\n            {iconComp}\n          </Tooltip>\n        );\n      }\n      return iconComp;\n    }, [hasError, errorMessage]);\n\n    const content = (\n      <div\n        className={className}\n        style={targetElement ? undefined : { left: posX, top: posY }}\n        onClick={e => onClick?.(e, entity)}\n        onMouseDown={onMouseDown}\n        data-port-entity-id={entity.id}\n        data-testid=\"bot-edit-multi-agent-flow-node-add-button\"\n      >\n        <div\n          className={classNames(styles.bgCircle, 'workflow-bg-circle')}\n        ></div>\n        {icon}\n        <div className={styles['focus-circle']} />\n      </div>\n    );\n    if (targetElement) {\n      return ReactDOM.createPortal(content, targetElement);\n    }\n    return content;\n  });\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Connection point radius\n\nexport const STROKE_WIDTH_SLECTED = 3;\n\nexport const STROKE_WIDTH = 2;\n\nexport const PORT_BG_CLASS_NAME = 'workflow-port-bg';\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  inject,\n  injectable,\n  multiInject,\n  optional,\n  postConstruct,\n} from 'inversify';\nimport { CommandRegistry } from '@flowgram-adapter/free-layout-editor';\n\ninterface ShorcutsHandler {\n  commandId: string;\n  shortcuts: string[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  isEnabled?: (...args: any[]) => boolean;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  execute: (...args: any[]) => void;\n}\n\nexport const WorkflowShortcutsContribution = Symbol(\n  'WorkflowShortcutsContribution',\n);\n\nexport interface WorkflowShortcutsContribution {\n  registerShortcuts: (registry: WorkflowShortcutsRegistry) => void;\n}\n\n@injectable()\nexport class WorkflowShortcutsRegistry {\n  @multiInject(WorkflowShortcutsContribution)\n  @optional()\n  protected contribs: WorkflowShortcutsContribution[];\n  @inject(CommandRegistry) protected commandRegistry: CommandRegistry;\n  readonly shortcutsHandlers: ShorcutsHandler[] = [];\n  addHandlers(...handlers: ShorcutsHandler[]): void {\n    // Registration command\n    handlers.forEach(handler => {\n      this.commandRegistry.registerCommand(\n        { id: handler.commandId },\n        { execute: handler.execute, isEnabled: handler.isEnabled },\n      );\n    });\n    this.shortcutsHandlers.push(...handlers);\n  }\n  addHandlersIfNotFound(...handlers: ShorcutsHandler[]): void {\n    handlers.forEach(handler => {\n      if (!this.has(handler.commandId)) {\n        this.addHandlers(handler);\n      }\n    });\n  }\n  has(commandId: string): boolean {\n    return this.shortcutsHandlers.some(\n      handler => handler.commandId === commandId,\n    );\n  }\n  @postConstruct()\n  protected init(): void {\n    this.contribs?.forEach(contrib => contrib.registerShortcuts(this));\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\nimport { Input } from '@coze-arch/coze-design';\n\nimport { type Setter } from '../types';\n\nimport styles from './string.module.less';\n\nexport interface StringOptions {\n  placeholder?: string;\n  width?: number | string;\n  maxCount?: number;\n  // The reason for adding this configuration is that the readonly style has a text box, and some scenes need to display only text.\n  textMode?: boolean;\n  testId?: string;\n}\n\nexport const String: Setter<string, StringOptions> = ({\n  value,\n  onChange,\n  readonly = false,\n  width = 'auto',\n  placeholder,\n  maxCount,\n  textMode = false,\n  testId,\n}) => {\n  const handleChange = (newValue: string) => {\n    onChange?.(newValue);\n  };\n\n  if (textMode) {\n    return (\n      <div style={{ width }} className={styles['text-mode']}>\n        {value}\n      </div>\n    );\n  }\n\n  return (\n    <Input\n      size=\"small\"\n      data-testid={testId}\n      className={cx({\n        [styles.readonly]: readonly,\n      })}\n      style={{\n        width,\n      }}\n      value={value}\n      onChange={handleChange}\n      readonly={readonly}\n      placeholder={placeholder}\n      maxLength={maxCount}\n      suffix={\n        maxCount === undefined ? null : (\n          <span className={styles.suffix}>\n            {`${value?.length || 0}/${maxCount}`}\n          </span>\n        )\n      }\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\nimport { CozInputNumber, Slider } from '@coze-arch/coze-design';\n\nimport type { Setter } from '../types';\n\nimport styles from './number.module.less';\n\nexport interface NumberOptions {\n  placeholder?: string;\n  width?: number | string;\n  step?: number;\n  max?: number;\n  min?: number;\n  mode?: 'input' | 'slider';\n  size?: 'small' | 'default';\n  style?: React.CSSProperties;\n}\n\nexport const Number: Setter<number, NumberOptions> = ({\n  value,\n  onChange,\n  width = '100%',\n  readonly = false,\n  mode = 'input',\n  max,\n  min,\n  step,\n  placeholder,\n  size = 'default',\n  style = {},\n}) => {\n  const handleChange = (newValue: number | string) => {\n    if (typeof newValue === 'number' && !readonly) {\n      onChange?.(newValue);\n    }\n  };\n\n  const handleSliderChange = (newValue?: number | number[]) => {\n    if (typeof newValue === 'number' && !readonly) {\n      onChange?.(newValue);\n    }\n  };\n\n  if (mode === 'slider') {\n    return (\n      <div className={styles.slider} style={{ width, ...style }}>\n        <Slider\n          className={cx({ [styles.readonly]: readonly })}\n          value={value}\n          min={min}\n          max={max}\n          step={step}\n          onChange={handleSliderChange}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <CozInputNumber\n      value={value}\n      onChange={handleChange}\n      className={cx({ [styles.readonly]: readonly })}\n      style={{ width, ...style }}\n      max={max}\n      min={min}\n      step={step}\n      placeholder={placeholder}\n      size={size}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { Switch } from '@coze-arch/coze-design';\n\nimport type { Setter } from '../types';\n\nexport const Boolean: Setter<boolean> = ({ value, onChange, readonly }) => (\n  <Switch checked={value} onChange={onChange} disabled={readonly} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\nimport { Select } from '@coze-arch/coze-design';\n\nimport type { Setter } from '../types';\nimport type { Options, EnumValue } from './types';\n\nimport styles from './enum.module.less';\n\nexport interface EnumOptions {\n  width?: number | string;\n  placeholder?: string;\n  options: Options;\n}\n\nexport const Enum: Setter<EnumValue, EnumOptions> = ({\n  value,\n  onChange,\n  readonly,\n  options = [],\n  placeholder,\n  width = '100%',\n}) => (\n  <Select\n    placeholder={placeholder}\n    className={cx({ [styles.readonly]: readonly })}\n    optionList={options}\n    style={{ width }}\n    value={value}\n    onChange={v => onChange?.(v as EnumValue)}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\ninterface ArraySetterContext {\n  currentAddIndex?: number;\n  currentIndex?: number;\n}\n\nconst arraySetterItemContext = createContext<ArraySetterContext>({});\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const ArraySetterItemContextProvider = arraySetterItemContext.Provider;\n\nexport const useArraySetterItemContext = () =>\n  useContext(arraySetterItemContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport classNames from 'classnames';\nimport { Tooltip, Avatar } from '@coze-arch/coze-design';\n\nimport { type EnumImageModelLabelProps } from './types';\n\nimport styles from './enum-image-model-label.module.less';\n\nexport function EnumImageModelLabel({\n  thumbnail,\n  label,\n  tooltip,\n  disabled = false,\n  disabledTooltip,\n}: EnumImageModelLabelProps) {\n  let content = (\n    <div className={styles.label}>\n      <Avatar\n        className={classNames(\n          styles.thumbnail,\n          'wf-enum-image-model-thumbnail',\n        )}\n        style={{ width: 16, height: 16 }}\n        shape=\"square\"\n        src={thumbnail}\n      />\n      <span className={styles.content}>{label}</span>\n    </div>\n  );\n\n  if (disabled && disabledTooltip) {\n    tooltip = disabledTooltip;\n  }\n\n  if (tooltip) {\n    content = (\n      <Tooltip content={tooltip} position=\"left\" spacing={40}>\n        {content}\n      </Tooltip>\n    );\n  }\n\n  return content;\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cx from 'classnames';\nimport { Select } from '@coze-arch/coze-design';\n\nimport { type Setter } from '../types';\nimport { type Value, type EnumImageModelOptions } from './types';\nimport { EnumImageModelLabel } from './enum-image-model-label';\n\nimport styles from './enum-image-model.module.less';\n\nexport const EnumImageModel: Setter<Value, EnumImageModelOptions> = ({\n  value,\n  onChange,\n  readonly = false,\n  width = '100%',\n  showClear = false,\n  placeholder = '',\n  options,\n  validateStatus,\n}) => (\n  <Select\n    size=\"small\"\n    className={cx('flex', {\n      [styles.select]: true,\n      [styles.readonly]: readonly,\n    })}\n    optionList={options.map(\n      ({ label, value: optionValue, thumbnail, disabled, tooltip }) => ({\n        label: (\n          <EnumImageModelLabel\n            thumbnail={thumbnail}\n            label={label}\n            tooltip={tooltip}\n            disabled={disabled}\n          />\n        ),\n        value: optionValue,\n        disabled,\n      }),\n    )}\n    style={{ width }}\n    value={value}\n    onChange={v => onChange?.(v as Value)}\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    renderSelectedItem={({ value: selectedValue }: any) => {\n      const option = options.find(item => item.value === selectedValue);\n\n      if (option) {\n        const { thumbnail, label } = option;\n        return <EnumImageModelLabel thumbnail={thumbnail} label={label} />;\n      }\n\n      return null;\n    }}\n    showClear={showClear}\n    onClear={() => {\n      onChange?.(undefined);\n    }}\n    placeholder={placeholder}\n    validateStatus={validateStatus}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Fixed internal field name\n */\nexport enum TestFormFieldName {\n  Node = '_node',\n  Batch = '_batch',\n  Input = '_input',\n  Setting = '_setting',\n  JSON = '_json',\n  /** Linked Content */\n  Related = '_related',\n  Bot = '_bot',\n  Conversation = '_conversation',\n  TestsetSelect = '_testset_select',\n  TestsetSave = '_testset_save',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { type FormSchemaReactComponents } from '../types';\nimport { SchemaField, type SchemaFieldProps } from './schema-field';\n\ninterface CreateSchemaFieldOptions {\n  components: FormSchemaReactComponents;\n}\n\ntype InnerSchemaField = React.FC<\n  Omit<SchemaFieldProps, 'components'> &\n    Pick<Partial<SchemaFieldProps>, 'components'>\n>;\n\nexport const createSchemaField = (options: CreateSchemaFieldOptions) => {\n  const InnerSchemaField: InnerSchemaField = ({ components, ...props }) => (\n    <SchemaField\n      components={{\n        ...options.components,\n        ...components,\n      }}\n      {...props}\n    />\n  );\n\n  return InnerSchemaField;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nexport type Int64 = string | number;\n\nexport enum TagType {\n  STRING = 0,\n  DOUBLE = 1,\n  BOOL = 2,\n  LONG = 3,\n  BYTES = 4,\n}\n\nexport interface Value {\n  v_str?: string;\n  v_double?: number;\n  v_bool?: boolean;\n  v_long?: Int64;\n  v_bytes?: Blob;\n}\n\nexport enum FrontedTagType {\n  /** Text */\n  TEXT = 0,\n  /** Time, with timestamp, in microseconds */\n  TIME = 1,\n  /** Time interval, in microseconds */\n  TIME_DURATION = 2,\n}\n\nexport interface FrontendTag {\n  key: string;\n  /** Multilingual, if there is no configuration value, use the key */\n  key_alias?: string;\n  tag_type: TagType;\n  value?: Value;\n  /** For custom rendering */\n  element?: ReactNode;\n  /** Front-end type for front-end processing */\n  frontend_tag_type?: FrontedTagType;\n  /** Can it be copied? */\n  can_copy?: boolean;\n}\n\nexport interface Tag {\n  key?: string;\n  tag_type?: TagType;\n  value?: Value;\n}\n\nexport enum InputOutputType {\n  /** Text type */\n  TEXT = 0,\n}\n\nexport interface SpanSummary {\n  tags?: Array<FrontendTag>;\n}\n\nexport interface SpanInputOutput {\n  /** TEXT */\n  type?: InputOutputType;\n  content?: string;\n}\n\nexport interface TraceFrontendSpan {\n  trace_id?: string;\n  log_id?: string;\n  span_id?: string;\n  type?: string;\n  name?: string;\n  alias_name?: string;\n  parent_id?: string;\n  /** That's in microseconds. */\n  duration?: Int64;\n  /** That's in microseconds. */\n  start_time?: Int64;\n  status_code?: number;\n  product_line?: string;\n  is_entry?: boolean;\n  is_key_span?: boolean;\n  owner_list?: Array<string>;\n  rundown_doc_url?: string;\n  tags?: Array<Tag>;\n  /** node details */\n  summary?: SpanSummary;\n  input?: SpanInputOutput;\n  output?: SpanInputOutput;\n}\n\nexport interface TraceHeader {\n  /** That's in microseconds. */\n  duration?: Int64;\n  /** Enter the number of tokens consumed */\n  tokens?: number;\n  status_code?: number;\n  tags?: Array<FrontendTag>;\n}\n\nexport interface TraceFrontend {\n  spans?: Array<TraceFrontendSpan>;\n  header?: TraceHeader;\n}\nexport interface MessageRenderOptions {\n  expandable?: boolean;\n  defaultExpand?: boolean;\n  showRole?: boolean;\n  rawMessageItem?: boolean;\n}\n\nexport enum MessageRole {\n  User = 'User',\n  Assistant = 'Assistant',\n  System = 'System',\n  Tool = 'Tool',\n}\n\nexport enum MessageScene {\n  Input = 'Input',\n  Output = 'Output',\n  History = 'History',\n  System = 'System',\n  Tool = 'Tool',\n}\n\nexport enum KeySceneField {\n  Status = '',\n  System = 'System',\n  History = '',\n  Input = '',\n  Output = '',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type Value, TagType } from '../typings/idl';\n\nexport enum StatusCode {\n  SUCCESS = 0,\n  ERROR = 1,\n}\n\nexport const META_TAGS_VALUE_TYPE_MAP: Record<TagType, keyof Value> = {\n  [TagType.STRING]: 'v_str',\n  [TagType.DOUBLE]: 'v_double',\n  [TagType.BOOL]: 'v_bool',\n  [TagType.LONG]: 'v_long',\n  [TagType.BYTES]: 'v_bytes',\n};\n\nexport enum RegionMap {\n  CN = 'cn',\n  I18N = 'i18N',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const STATUS_CODE_KEY = '_status_code';\n\nexport enum ObservationModules {\n  RUN_TREE = 'run_tree',\n  FLAME_THREAD = 'flame_thread',\n  INPUT = 'input',\n  OUTPUT = 'output',\n  META_TAGS = 'meta_tags',\n  SPAN_DETAIL = 'span_detail',\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum TraceChartsMode {\n  Table,\n  FlameThread,\n}\n\nexport const MAX_TRACE_LENGTH = 50;\n/** Log query for up to 7 days */\nexport const MAX_TRACE_TIME = 7;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Ajv from 'ajv';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { type IFormSchemaValidate } from '../form-engine';\n\nconst isEmptyValue = (v: unknown) => v === undefined || v === null || v === '';\n\ninterface GenerateFieldValidatorOptions {\n  name: string;\n  title?: string;\n  required?: boolean;\n  validateJsonSchema?: any;\n}\n\n/**\n * AJV instance cache\n * No need to import or create multiple times, optimizing memory overhead\n */\nlet ajvCache: undefined | Ajv;\n\nexport const generateFieldValidator = (\n  options: GenerateFieldValidatorOptions,\n) => {\n  const { required, title, name, validateJsonSchema } = options;\n\n  const validator: IFormSchemaValidate = ({ value }) => {\n    if (required && isEmptyValue(value)) {\n      return I18n.t('workflow_testset_required_tip', {\n        param_name: title || name,\n      });\n    }\n    // If there is a structured description, the value also needs to be deserialized\n    if (validateJsonSchema && value !== undefined) {\n      if (!ajvCache) {\n        ajvCache = new Ajv();\n      }\n      try {\n        const valueObject = JSON.parse(value);\n        const validate = ajvCache.compile(validateJsonSchema);\n        const valid = validate(valueObject);\n        return valid ? undefined : I18n.t('workflow_debug_wrong_json');\n      } catch {\n        /**\n         * There are many possibilities for error reporting, and the expected result is that the verification fails.\n         * 1. Value deserialization failed\n         * 2. The deserialized value is not legal\n         */\n        return I18n.t('workflow_debug_wrong_json');\n      }\n    }\n  };\n\n  return {\n    ['x-validator']: validator,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext } from 'react';\n\nimport type { FormSchemaReactComponents } from '../types';\n\nexport const ComponentsContext = createContext<FormSchemaReactComponents>({});\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ReactNode } from 'react';\n\nimport { ReactiveState } from '@flowgram-adapter/common';\n\nimport type { IFormSchema, FormSchemaUIState } from '../types';\n\ninterface PropertyWithKey {\n  key: string;\n  schema: IFormSchema;\n}\n\nexport class FormSchema implements IFormSchema {\n  /** IFormSchema pass-through properties */\n  type?: string | undefined;\n  title?: ReactNode;\n  description?: ReactNode;\n  required?: boolean;\n  properties?: Record<string, IFormSchema>;\n  defaultValue?: any;\n\n  /** Model Properties */\n  uiState = new ReactiveState<FormSchemaUIState>({ disabled: false });\n  path: string[] = [];\n\n  constructor(json: IFormSchema, path: string[] = []) {\n    this.fromJSON(json);\n    this.path = path;\n  }\n\n  get componentType() {\n    return this['x-component'];\n  }\n  get componentProps() {\n    return this['x-component-props'];\n  }\n  get decoratorType() {\n    return this['x-decorator'];\n  }\n  get decoratorProps() {\n    return this['x-decorator-props'];\n  }\n\n  fromJSON(json: IFormSchema) {\n    Object.entries(json).forEach(([key, value]) => {\n      this[key] = value;\n    });\n    this.uiState.value.disabled = json['x-disabled'] ?? false;\n  }\n\n  /**\n   * Obtain ordered properties\n   */\n  static getProperties(schema: FormSchema | IFormSchema) {\n    const orderProperties: PropertyWithKey[] = [];\n    const unOrderProperties: PropertyWithKey[] = [];\n    Object.entries(schema.properties || {}).forEach(([key, item]) => {\n      const index = item['x-index'];\n      if (index !== undefined && !isNaN(index)) {\n        orderProperties[index] = { schema: item, key };\n      } else {\n        unOrderProperties.push({ schema: item, key });\n      }\n    });\n    return orderProperties.concat(unOrderProperties).filter(item => !!item);\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext } from 'react';\n\nimport type { FormSchema } from './form-schema';\n\nexport const SchemaContext = createContext<FormSchema>({} as any);\n\nexport const FormSchemaContext = createContext<FormSchema>({} as any);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useMemo } from 'react';\n\nimport {\n  createForm,\n  ValidateTrigger,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport type { IFormSchema, IFormSchemaValidate } from '../types';\nimport { FormSchema } from '../shared';\n\ntype Rules = Record<string, IFormSchemaValidate>;\n\nconst getFieldPath = (...args: (string | undefined)[]) =>\n  args.filter(path => path).join('.');\n\nexport function validateResolver(schema: IFormSchema): Rules {\n  const rules = {};\n\n  visit(schema);\n\n  return rules;\n\n  function visit(current: IFormSchema, name?: string) {\n    if (name && current['x-validator']) {\n      rules[name] = current['x-validator'];\n    }\n    if (current.type === 'object' && current.properties) {\n      Object.entries(current.properties).forEach(([key, value]) => {\n        visit(value, getFieldPath(name, key));\n      });\n    }\n  }\n}\n\nexport const useCreateForm = (schema: IFormSchema, options: any = {}) => {\n  const { validate } = options;\n  const innerValidate = useMemo(\n    () => ({\n      ...validateResolver(schema),\n      ...validate,\n    }),\n    [schema],\n  );\n  const { form, control } = useMemo(\n    () =>\n      createForm({\n        validate: innerValidate,\n        validateTrigger: ValidateTrigger.onBlur,\n        ...options,\n      }),\n    [schema, innerValidate],\n  );\n  const formSchema = useMemo(\n    () => new FormSchema({ type: 'object', ...schema }),\n    [schema],\n  );\n\n  useEffect(() => {\n    if (options.onMounted) {\n      options.onMounted(control._formModel, formSchema);\n    }\n    const disposable = control._formModel.onFormValuesUpdated(payload => {\n      if (options?.onFormValuesChange) {\n        options.onFormValuesChange(payload);\n      }\n    });\n    return () => disposable.dispose();\n  }, [control]);\n\n  return {\n    form,\n    control,\n    model: control._formModel,\n    formSchema,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { SchemaContext } from '../shared';\n\nexport const useFieldSchema = () => useContext(SchemaContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useObserve } from '@flowgram-adapter/common';\n\nimport { useFieldSchema } from './use-field-schema';\n\nexport const useFieldUIState = () => {\n  const schema = useFieldSchema();\n  return useObserve(schema?.uiState?.value);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { ComponentsContext } from '../shared';\n\nexport const useComponents = () => useContext(ComponentsContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useContext } from 'react';\n\nimport { FormSchemaContext } from '../shared';\n\nexport const useFormSchema = () => useContext(FormSchemaContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useObserve } from '@flowgram-adapter/common';\n\nimport { useFormSchema } from './use-form-schema';\n\nexport const useFormUIState = () => {\n  const schema = useFormSchema();\n  return useObserve(schema?.uiState?.value);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { SchemaContext, type FormSchema } from '../shared';\nimport { useComponents } from '../hooks';\n\ninterface ObjectFieldProps {\n  schema: FormSchema;\n}\n\nexport const ObjectField: React.FC<\n  React.PropsWithChildren<ObjectFieldProps>\n> = ({ schema, children }) => {\n  const components = useComponents();\n  const renderDecorator = () => {\n    if (!schema.decoratorType || !components[schema.decoratorType]) {\n      return <>{children}</>;\n    }\n    return React.createElement(\n      components[schema.decoratorType],\n      schema.decoratorProps,\n      children,\n    );\n  };\n\n  return (\n    <SchemaContext.Provider value={schema}>\n      {renderDecorator()}\n    </SchemaContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport {\n  useCurrentField,\n  useCurrentFieldState,\n} from '@flowgram-adapter/free-layout-editor';\n\nimport { type FormSchemaUIState } from '../types';\nimport {\n  useFieldUIState,\n  useFieldSchema,\n  useComponents,\n  useFormUIState,\n} from '../hooks';\n\ninterface ReactiveFieldProps {\n  parentUIState?: FormSchemaUIState;\n}\n\n/**\n * Access Responsive Fields\n */\nconst ReactiveField: React.FC<ReactiveFieldProps> = ({ parentUIState }) => {\n  const components = useComponents();\n  const schema = useFieldSchema();\n  const field = useCurrentField();\n  const uiState = useFieldUIState();\n  const formUIState = useFormUIState();\n  const fieldState = useCurrentFieldState();\n  /**\n   * The autologous disabled state is controlled by the father along with the self\n   */\n  const disabled =\n    parentUIState?.disabled || uiState.disabled || formUIState.disabled;\n  const validateStatus = fieldState.errors?.length ? 'error' : undefined;\n\n  const renderComponent = () => {\n    if (!schema.componentType || !components[schema.componentType]) {\n      return null;\n    }\n    return React.createElement(components[schema.componentType], {\n      disabled,\n      validateStatus,\n      value: field.value,\n      onChange: field.onChange,\n      onFocus: field.onFocus,\n      onBlur: field.onBlur,\n      ['data-testid']: ['workflow', 'testrun', 'form', 'component']\n        .concat(schema.path)\n        .join('.'),\n      ...schema.componentProps,\n    });\n  };\n\n  const renderDecorator = (children: React.ReactNode) => {\n    if (!schema.decoratorType || !components[schema.decoratorType]) {\n      return <>{children}</>;\n    }\n    return React.createElement(\n      components[schema.decoratorType],\n      {\n        ...schema.decoratorProps,\n        ['data-testid']: ['workflow', 'testrun', 'form', 'decorator']\n          .concat(schema.path)\n          .join('.'),\n      },\n      children,\n    );\n  };\n\n  return renderDecorator(renderComponent());\n};\n\nexport { ReactiveField, ReactiveFieldProps };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { Field } from '@flowgram-adapter/free-layout-editor';\n\nimport { SchemaContext, type FormSchema } from '../shared';\nimport { useFieldUIState } from '../hooks';\nimport { ReactiveField } from './reactive-field';\n\ninterface FieldProps {\n  name: string;\n  schema: FormSchema;\n}\n\nexport const GeneralField: React.FC<React.PropsWithChildren<FieldProps>> = ({\n  schema,\n}) => {\n  const parentUIState = useFieldUIState();\n  return (\n    <SchemaContext.Provider value={schema}>\n      <Field name={schema.path.join('.')} defaultValue={schema.defaultValue}>\n        <ReactiveField parentUIState={parentUIState} />\n      </Field>\n    </SchemaContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FormSchema } from '../shared';\nimport { ObjectField } from './object-field';\nimport { GeneralField } from './general-field';\n\ninterface RecursionFieldProps {\n  schema: FormSchema;\n  name?: string;\n}\n\nconst computePath = (path?: string[], name?: string) =>\n  [...(path || []), name].filter((i): i is string => Boolean(i));\n\n/**\n * Recursive Field\n */\nconst RecursionField: React.FC<RecursionFieldProps> = ({ name, schema }) => {\n  const renderProperties = () => {\n    const properties = FormSchema.getProperties(schema);\n    if (!properties.length) {\n      return null;\n    }\n    const { path } = schema;\n    return (\n      <ObjectField schema={schema}>\n        {properties.map((item, index) => (\n          <RecursionField\n            name={item.key}\n            schema={new FormSchema(item.schema, computePath(path, item.key))}\n            key={`${index}-${item.key}`}\n          />\n        ))}\n      </ObjectField>\n    );\n  };\n\n  if (!name) {\n    return renderProperties();\n  }\n  if (schema.type === 'object') {\n    return renderProperties();\n  }\n\n  return <GeneralField name={name} schema={schema} />;\n};\n\nexport { RecursionField, type RecursionFieldProps };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport type { FormSchemaReactComponents } from '../types';\nimport {\n  ComponentsContext,\n  FormSchemaContext,\n  type FormSchema,\n} from '../shared';\nimport { RecursionField } from './recursion-field';\n\nexport interface SchemaFieldProps {\n  schema: FormSchema;\n  components: FormSchemaReactComponents;\n}\n\nexport const SchemaField: React.FC<SchemaFieldProps> = props => (\n  <ComponentsContext.Provider value={props.components}>\n    <FormSchemaContext.Provider value={props.schema}>\n      <RecursionField schema={props.schema} />\n    </FormSchemaContext.Provider>\n  </ComponentsContext.Provider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRef, useEffect } from 'react';\n\nimport clsx from 'clsx';\nimport BigNumber, { type BigNumber as IBigNumber } from 'bignumber.js';\nimport {\n  IconCozArrowDownFill,\n  IconCozArrowUpFill,\n} from '@coze-arch/coze-design/icons';\nimport { Input, type InputProps } from '@coze-arch/coze-design';\n\nimport css from './input-number.module.less';\n\nexport interface InputNumberProps {\n  value?: string;\n  style?: React.CSSProperties;\n  placeholder?: string;\n  validateStatus?: InputProps['validateStatus'];\n  disabled?: boolean;\n  onChange: (v?: string) => void;\n  onBlur: () => void;\n  onFocus: () => void;\n  /** integer */\n  int?: boolean;\n}\n\n/** Is it a legal numeric string? */\nfunction isValidNumber(str: string) {\n  try {\n    const value = new BigNumber(str);\n    return !value.isNaN();\n  } catch {\n    return false;\n  }\n}\n\nfunction normalizeNumber(str?: string) {\n  if (!str || !isValidNumber(str)) {\n    return;\n  }\n  return new BigNumber(str);\n}\n\nexport const InputNumber: React.FC<InputNumberProps> = ({\n  int,\n  onChange,\n  onBlur,\n  ...props\n}) => {\n  const verifiedRef = useRef<undefined | IBigNumber>(\n    normalizeNumber(props.value),\n  );\n\n  const fixed = (num: IBigNumber, innerInt?: boolean) =>\n    innerInt ? num.toFixed(0, BigNumber.ROUND_DOWN) : num.toFixed();\n\n  const handleBlur = () => {\n    if (props.value === '' || props.value === undefined) {\n      /** If the value is empty when out of focus, the verification value is also cleared */\n      verifiedRef.current = undefined;\n      if (props.value === '') {\n        onChange(undefined);\n      }\n    } else {\n      /** If the value is not empty when out of focus, you need to verify the legitimacy of the value */\n      /**\n       * 1. If the value itself is legal, format the value\n       * 2. If the value is not legal, the most recent legal value is adopted\n       * 3. If none, return undefined\n       */\n      let next: undefined | string;\n      const nextBig = normalizeNumber(props.value) || verifiedRef.current;\n      if (nextBig) {\n        next = fixed(nextBig, int);\n      }\n      if (next !== props.value) {\n        onChange(next);\n      }\n    }\n    onBlur();\n  };\n\n  const handlePlus = () => {\n    let next = '1';\n    if (verifiedRef.current) {\n      const nextNum = verifiedRef.current.plus('1');\n      next = fixed(nextNum, int);\n    }\n    onChange(next);\n  };\n\n  const handleMinus = () => {\n    let next = '0';\n    if (verifiedRef.current) {\n      const nextNum = verifiedRef.current.minus('1');\n      next = fixed(nextNum, int);\n    }\n    onChange(next);\n  };\n\n  /** When the value changes, you need to synchronize the value to a legal number */\n  useEffect(() => {\n    if (props.value === '' || props.value === undefined) {\n      verifiedRef.current = undefined;\n    }\n    const next = normalizeNumber(props.value);\n    if (next) {\n      verifiedRef.current = normalizeNumber(props.value);\n    }\n  }, [props.value]);\n\n  return (\n    <Input\n      onChange={onChange}\n      onBlur={handleBlur}\n      size=\"small\"\n      suffix={\n        props.disabled ? null : (\n          <div className={css.buttons}>\n            <div className={clsx(css.button, css.up)} onClick={handlePlus}>\n              <IconCozArrowUpFill />\n            </div>\n            <div className={clsx(css.button, css.down)} onClick={handleMinus}>\n              <IconCozArrowDownFill />\n            </div>\n          </div>\n        )\n      }\n      {...props}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EditorProvider, createRenderer } from '@coze-editor/editor/react';\nimport preset, {\n  languages,\n  createTheme,\n  tags,\n} from '@coze-editor/editor/preset-code';\nimport { json } from '@coze-editor/editor/language-json';\nimport { EditorView, tooltips } from '@codemirror/view';\n\nconst colors = {\n  background: '#F7F7FC',\n  // syntax\n  comment: '#000A298A',\n  key: '#00818C',\n  string: '#D1009D',\n  number: '#C74200',\n  boolean: '#2B57D9',\n  null: '#2B57D9',\n  separator: '#0F1529D1',\n};\n\nlanguages.register('json', json);\n\nconst JSONEditor: any = createRenderer(preset, [\n  EditorView.theme({\n    '&': {\n      borderRadius: '8px',\n    },\n    '.cm-scroller': {\n      transition: 'height .3s ease',\n    },\n    '.cm-content': {\n      paddingTop: '6px',\n      paddingBottom: '6px',\n    },\n    '.cm-completionIcon-property': {\n      backgroundImage:\n        'url(\"' +\n        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMi4zNTc2IDguMTAzNTVDMTIuMTYyMyA3LjkwODI5IDExLjg0NTcgNy45MDgyOSAxMS42NTA1IDguMTAzNTVMOC4xMDM1NSAxMS42NTA1QzcuOTA4MjkgMTEuODQ1NyA3LjkwODI5IDEyLjE2MjMgOC4xMDM1NSAxMi4zNTc2TDExLjY1MDUgMTUuOTA0NUMxMS44NDU3IDE2LjA5OTggMTIuMTYyMyAxNi4wOTk4IDEyLjM1NzYgMTUuOTA0NUwxNS45MDQ1IDEyLjM1NzZDMTYuMDk5OCAxMi4xNjIzIDE2LjA5OTggMTEuODQ1NyAxNS45MDQ1IDExLjY1MDVMMTIuMzU3NiA4LjEwMzU1WiIgZmlsbD0iIzA2MDcwOUNDIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMS4wMDI2IDEuNDU1NDVDMTEuNjIxNCAxLjA5ODE4IDEyLjM4MzggMS4wOTgxOCAxMy4wMDI2IDEuNDU1NDVMMjAuNjM4IDUuODYzNzRDMjEuMjU2OCA2LjIyMSAyMS42MzggNi44ODEyNiAyMS42MzggNy41OTU3OVYxNi40MTI0QzIxLjYzOCAxNy4xMjY5IDIxLjI1NjggMTcuNzg3MiAyMC42MzggMTguMTQ0NEwxMy4wMDI2IDIyLjU1MjdDMTIuMzgzOCAyMi45MSAxMS42MjE0IDIyLjkxIDExLjAwMjYgMjIuNTUyN0wzLjM2NzE5IDE4LjE0NDRDMi43NDgzOSAxNy43ODcyIDIuMzY3MTkgMTcuMTI2OSAyLjM2NzE5IDE2LjQxMjRWNy41OTU3OUMyLjM2NzE5IDYuODgxMjYgMi43NDgzOSA2LjIyMTAxIDMuMzY3MTkgNS44NjM3NEwxMS4wMDI2IDEuNDU1NDVaTTEyLjAwMjYgMy4xODc1TDE5LjYzOCA3LjU5NTc5VjE2LjQxMjRMMTIuMDAyNiAyMC44MjA3TDQuMzY3MTkgMTYuNDEyNEw0LjM2NzE5IDcuNTk1NzlMMTIuMDAyNiAzLjE4NzVaIiBmaWxsPSIjMDYwNzA5Q0MiLz48L3N2Zz4=' +\n        '\")',\n      backgroundSize: '11px 11px',\n      backgroundRepeat: 'no-repeat',\n      width: '11px',\n      height: '11px',\n    },\n    '.cm-completionIcon-property::after': {\n      content: '\"\"',\n    },\n    '.cm-selectionBackground': {\n      borderRadius: '4px',\n    },\n    '.cm-activeLineGutter': {\n      borderRadius: '4px 0 0 4px',\n    },\n    '.cm-activeLine': {\n      borderRadius: '0 4px 4px 0',\n    },\n    '&.cm-focused': {\n      outline: 'none',\n    },\n    '& *': {\n      fontFamily: 'Menlo, Monaco, \"Courier New\", monospace',\n    },\n    '.cm-tooltip': {\n      wordBreak: 'break-all',\n    },\n    '.cm-lineNumbers .cm-gutterElement': {\n      transform: 'translate(0, 1px)',\n    },\n    '.cm-foldGutter .cm-gutterElement > div': {\n      display: 'flex',\n      alignItems: 'center',\n    },\n    '.cm-completionIcon': {\n      fontSize: '11px',\n    },\n  }),\n  createTheme({\n    variant: 'light',\n    settings: {\n      background: colors.background,\n      foreground: '#4D4D4C',\n      caret: '#AEAFAD',\n      selection: '#52649A21',\n      gutterBackground: colors.background,\n      gutterForeground: '#000A298A',\n      gutterBorderColor: 'transparent',\n      gutterBorderWidth: 0,\n      lineHighlight: '#efefef78',\n      bracketColors: ['#E4D129', '#AC05FF', '#2B57D9'],\n      tooltip: {\n        backgroundColor: 'var(--coz-bg-max)',\n        color: 'var(--coz-fg-primary)',\n        border: 'solid 1px var(--coz-stroke-plus)',\n        boxShadow: 'var(--coz-shadow-default)',\n        borderRadius: '8px',\n      },\n      tooltipCompletion: {\n        backgroundColor: '#FFFFFF',\n        color: '#060709CC',\n      },\n      completionItemHover: {\n        backgroundColor: '#5768A114',\n      },\n      completionItemSelected: {\n        backgroundColor: '#52649A21',\n      },\n      completionItemIcon: {\n        color: '#060709CC',\n      },\n      completionItemLabel: {\n        color: '#060709CC',\n      },\n      completionItemDetail: {\n        color: '#2029459E',\n      },\n    },\n    styles: [\n      // JSON\n      {\n        tag: tags.comment,\n        color: colors.comment,\n      },\n      {\n        tag: [tags.propertyName],\n        color: colors.key,\n      },\n      {\n        tag: [tags.string],\n        color: colors.string,\n      },\n      {\n        tag: [tags.number],\n        color: colors.number,\n      },\n      {\n        tag: [tags.bool],\n        color: colors.boolean,\n      },\n      {\n        tag: [tags.null],\n        color: colors.null,\n      },\n      {\n        tag: [tags.separator],\n        color: colors.separator,\n      },\n    ],\n  }),\n  tooltips({\n    parent: document.body,\n    tooltipSpace() {\n      return {\n        left: 16,\n        top: 16,\n        right: window.innerWidth - 16,\n        bottom: window.innerHeight - 16,\n      };\n    },\n  }),\n]);\n\nexport { JSONEditor, EditorProvider };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nimport { uniqueId } from 'lodash-es';\nimport { type EditorAPI } from '@coze-editor/editor/preset-code';\nimport { json } from '@coze-editor/editor/language-json';\n\nimport { JSONEditor, EditorProvider } from './base';\n\ninterface JsonEditorProps {\n  value?: string;\n  height?: string;\n  disabled?: boolean;\n  extensions?: any[];\n  jsonSchema?: any;\n  onChange?: (v?: string) => void;\n  onBlur?: () => void;\n  onFocus?: () => void;\n  didMount?: (editor: any) => void;\n}\n\nexport const JsonEditor: React.FC<JsonEditorProps> = ({\n  value,\n  height,\n  disabled,\n  extensions,\n  jsonSchema,\n  onChange,\n  onBlur,\n  onFocus,\n  didMount,\n}) => {\n  const [focus, setFocus] = useState(false);\n  const [uri] = useState(() => `file:///${uniqueId()}.json`);\n  const editorRef = useRef<EditorAPI | null>(null);\n  const handleChange = val => {\n    onChange?.(val || undefined);\n  };\n\n  const handleBlur = useCallback(() => {\n    setFocus(false);\n    onBlur?.();\n  }, [onBlur]);\n\n  const handleFocus = useCallback(() => {\n    setFocus(true);\n    onFocus?.();\n  }, [onFocus]);\n\n  useEffect(() => {\n    const schemaURI = `file:///${uniqueId()}`;\n\n    json.languageService.configureSchemas({\n      uri: schemaURI,\n      fileMatch: [uri],\n      schema: jsonSchema || {},\n    });\n\n    editorRef.current?.validate();\n\n    return () => {\n      json.languageService.deleteSchemas(schemaURI);\n    };\n  }, [uri, jsonSchema]);\n\n  useEffect(() => {\n    if (!editorRef.current) {\n      return;\n    }\n\n    if (value !== editorRef.current.getValue()) {\n      editorRef.current.setValue(value || '');\n    }\n  }, [value]);\n\n  return (\n    <EditorProvider>\n      <JSONEditor\n        defaultValue={value ?? ''}\n        options={{\n          uri,\n          languageId: 'json',\n          fontSize: 12,\n          height: height ? height : focus ? '264px' : '120px',\n          readOnly: disabled,\n          editable: !disabled,\n        }}\n        extensions={extensions}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        onChange={e => handleChange(e.value)}\n        didMount={_ => {\n          editorRef.current = _;\n          didMount?.(_);\n        }}\n      />\n    </EditorProvider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface DebugUrlParams {\n  spaceId: string;\n  workflowId: string;\n  executeId: string;\n  nodeId?: string;\n  subExecuteId?: string;\n}\n\n/**\n * Calculate DebugUrl\n */\nconst getDebugUrl = (params: DebugUrlParams) => {\n  const { spaceId, workflowId, executeId, subExecuteId, nodeId } = params;\n  const search = new URLSearchParams({\n    space_id: spaceId,\n    workflow_id: workflowId,\n    execute_id: executeId,\n    node_id: nodeId || '',\n    sub_execute_id: subExecuteId || '',\n  });\n  return `/work_flow?${search.toString()}`;\n};\n\nexport const gotoDebugFlow = (params: DebugUrlParams, op?: boolean) => {\n  if (op) {\n    const { workflowId, executeId, subExecuteId, nodeId } = params;\n    const search = new URLSearchParams({\n      workflow_id: workflowId,\n      execute_id: executeId,\n      node_id: nodeId || '',\n      sub_execute_id: subExecuteId || '',\n    });\n    window.open(`${window.location.pathname}?${search.toString()}`);\n  }\n  const url = getDebugUrl(params);\n  window.open(url);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isString } from 'lodash-es';\n\nexport const safeFormatJsonString = (val: unknown): any => {\n  if (!isString(val)) {\n    return val;\n  }\n  try {\n    return JSON.stringify(JSON.parse(val), null, 2);\n  } catch {\n    return val;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface TypeSafeJSONParseOptions {\n  emptyValue?: any;\n  needReport?: boolean;\n  enableBigInt?: boolean;\n}\n\nexport const safeJsonParse = (\n  v: unknown,\n  options?: TypeSafeJSONParseOptions,\n): unknown => {\n  if (typeof v === 'object') {\n    return v;\n  }\n  try {\n    return JSON.parse(String(v));\n  } catch {\n    return options?.emptyValue;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useRef, useCallback } from 'react';\n\nimport { useMemoizedFn } from 'ahooks';\n\ninterface Config {\n  default?: number;\n  min?: number;\n  max?: number;\n}\n\n/**\n * Currently only highly variable is supported\n */\nexport const useResize = (config: Config) => {\n  const [dragging, setDragging] = useState(false);\n  const [height, setHeight] = useState(config.default);\n  const ref = useRef<HTMLDivElement>(null);\n  /**\n   * Dragging process\n   */\n  const resizing = useRef(false);\n  /**\n   * Y-axis variation\n   */\n  const startY = useRef(0);\n  /** starting position */\n  const start = useRef(0);\n\n  const handleMouseMove = useMemoizedFn(e => {\n    if (resizing.current) {\n      const newHeight = start.current - (e.clientY - startY.current); // Calculate the new height\n      if (config.max && newHeight > config.max) {\n        setHeight(config.max);\n      } else if (config.min && newHeight < config.min) {\n        setHeight(config.min);\n      } else {\n        setHeight(newHeight);\n      }\n    }\n  });\n  const handleMouseUp = useCallback(() => {\n    resizing.current = false;\n    setDragging(false);\n    document.removeEventListener('mousemove', handleMouseMove); // Cancel listening\n    document.removeEventListener('mouseup', handleMouseUp); // Cancel listening\n  }, [handleMouseMove]);\n\n  const handleMouseDown = useMemoizedFn(e => {\n    resizing.current = true;\n    setDragging(true);\n    startY.current = e.clientY; // Record the Y-axis coordinates when the mouse starts dragging\n    start.current = ref.current?.offsetHeight || 0;\n    document.addEventListener('mousemove', handleMouseMove); // Monitor mouse movement events\n    document.addEventListener('mouseup', handleMouseUp); // Monitor mouse lift events\n  });\n\n  return {\n    height,\n    bind: handleMouseDown,\n    ref,\n    dragging,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { isObject } from 'lodash-es';\nimport { clsx } from 'clsx';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { useResize } from './use-resize';\n\nimport css from './panel.module.less';\n\ninterface BasePanelProps {\n  className?: string;\n  /**\n   * Panel header, no pass and no render\n   */\n  header?: React.ReactNode;\n  /**\n   * Panel foot, do not pass and do not render\n   */\n  footer?: React.ReactNode;\n  /**\n   * Default initial height, does not support responsive\n   */\n  height?: number;\n  /**\n   * Can you drag and drop to change the height?\n   */\n  resizable?:\n    | boolean\n    | {\n        min?: number;\n        max?: number;\n      };\n  /**\n   * Click to close the event, which may only be triggered when rendering the panel header\n   */\n  onClose?: () => void;\n}\n\nexport const BottomPanel: React.FC<React.PropsWithChildren<BasePanelProps>> = ({\n  className,\n  header,\n  footer,\n  height,\n  resizable,\n  onClose,\n  children,\n}) => {\n  const {\n    height: innerHeight,\n    bind,\n    ref,\n    dragging,\n  } = useResize({\n    default: height,\n    ...(isObject(resizable) ? resizable : {}),\n  });\n\n  return (\n    <div\n      className={clsx(css['base-panel'], className, dragging && css.dragging)}\n      style={{ height: innerHeight }}\n      ref={ref}\n    >\n      {resizable ? (\n        <div className={css['resize-bar']} onMouseDown={bind} />\n      ) : null}\n      {header ? (\n        <div className={css['panel-header']}>\n          {header}\n          <IconButton\n            icon={<IconCozCross className={'text-[18px]'} />}\n            color=\"secondary\"\n            onClick={onClose}\n          />\n        </div>\n      ) : null}\n      <div className={css['panel-content']}>{children}</div>\n      {footer ? <div className={css['panel-footer']}>{footer}</div> : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clsx } from 'clsx';\nimport {\n  JsonEditor,\n  safeFormatJsonString,\n} from '@coze-workflow/test-run-shared';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozBroom } from '@coze-arch/coze-design/icons';\nimport { Tooltip, IconButton } from '@coze-arch/coze-design';\n\nimport css from './json.module.less';\n\nexport interface InputJsonProps {\n  value?: string;\n  disabled?: boolean;\n  extensions?: any;\n  jsonSchema?: any;\n  height?: string;\n  validateStatus?: 'error';\n  ['data-testid']?: string;\n  onChange?: (v?: string) => void;\n  didMount?: (editor: any) => void;\n}\n\nexport const InputJson: React.FC<InputJsonProps> = ({\n  value,\n  disabled,\n  validateStatus,\n  onChange,\n  ...props\n}) => {\n  const handleFormat = () => {\n    const next = safeFormatJsonString(value);\n    if (next !== value) {\n      onChange?.(next);\n    }\n  };\n\n  return (\n    <div\n      className={clsx(\n        css['input-json-wrap'],\n        disabled && css.disabled,\n        validateStatus === 'error' && css.error,\n      )}\n      data-testid={props['data-testid']}\n    >\n      <div className={css['json-header']}>\n        <div className={css['json-label']}>JSON</div>\n        <div>\n          <Tooltip content={I18n.t('workflow_exception_ignore_format')}>\n            <IconButton\n              icon={<IconCozBroom />}\n              disabled={disabled}\n              size=\"small\"\n              color=\"secondary\"\n              onMouseDown={e => e.preventDefault()}\n              onClick={handleFormat}\n            />\n          </Tooltip>\n        </div>\n      </div>\n      <div className={css['json-editor']}>\n        <JsonEditor\n          value={value}\n          disabled={disabled}\n          onChange={onChange}\n          {...props}\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tag, Tooltip, Typography } from '@coze-arch/coze-design';\n\nimport css from './item.module.less';\n\nexport interface FieldItemProps {\n  title?: React.ReactNode;\n  description?: React.ReactNode;\n  tag?: React.ReactNode;\n  tooltip?: React.ReactNode;\n  feedback?: string;\n  required?: boolean;\n  ['data-testid']?: string;\n}\n\nexport const FieldItem: React.FC<React.PropsWithChildren<FieldItemProps>> = ({\n  title,\n  required,\n  tooltip,\n  tag,\n  description,\n  children,\n  feedback,\n  ...props\n}) => (\n  <div className={css['field-item']} data-testid={props['data-testid']}>\n    {/* title */}\n    <div className={css['item-title']}>\n      <div className={css['item-label']}>\n        <Typography.Text className={css['title-text']} strong size=\"small\">\n          {title}\n        </Typography.Text>\n        {required ? (\n          <Typography.Text className={css['title-required']}>*</Typography.Text>\n        ) : null}\n        {tooltip ? (\n          <Tooltip content={tooltip}>\n            <IconCozInfoCircle className={css['tooltip-icon']} />\n          </Tooltip>\n        ) : null}\n\n        {tag ? (\n          <Tag className={css['item-tag']} size=\"mini\" color=\"primary\">\n            {tag}\n          </Tag>\n        ) : null}\n      </div>\n      {description ? (\n        <Typography.Text\n          ellipsis={{\n            showTooltip: {\n              opts: {\n                position: 'left',\n                style: {\n                  maxWidth: 500,\n                },\n              },\n            },\n          }}\n          className={css['item-description']}\n          size=\"small\"\n        >\n          {description}\n        </Typography.Text>\n      ) : null}\n    </div>\n    {/* children */}\n    <div>{children}</div>\n    {/* feedback */}\n    {feedback ? <div className={css['item-feedback']}>{feedback}</div> : null}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState, useRef } from 'react';\n\nimport { clsx } from 'clsx';\nimport { useInViewport } from 'ahooks';\nimport {\n  IconCozArrowDownFill,\n  IconCozInfoCircle,\n} from '@coze-arch/coze-design/icons';\nimport { Collapsible, Tooltip } from '@coze-arch/coze-design';\n\nimport css from './collapse.module.less';\n\ninterface CollapseProps {\n  label: React.ReactNode;\n  tooltip?: React.ReactNode;\n  extra?: React.ReactNode;\n  fade?: boolean;\n  duration?: number;\n}\n\nexport const GroupCollapse: React.FC<\n  React.PropsWithChildren<CollapseProps>\n> = ({ label, tooltip, extra, children }) => {\n  const [isOpen, setIsOpen] = useState(true);\n  const ref = useRef(null);\n  /**\n   * Detect if the title is sticky\n   */\n  const [inViewport] = useInViewport(ref);\n  return (\n    <div>\n      {/* probe element */}\n      <div ref={ref} />\n      {/* header */}\n      <div\n        onClick={() => setIsOpen(!isOpen)}\n        className={clsx(\n          css['collapse-title'],\n          (!inViewport || !isOpen) && css['is-sticky'],\n        )}\n      >\n        <IconCozArrowDownFill\n          className={clsx(css['collapse-icon'], !isOpen && css['is-close'])}\n        />\n        <span className={css['collapse-label']}>{label}</span>\n        {tooltip ? (\n          <Tooltip content={tooltip}>\n            <IconCozInfoCircle className={css['collapse-label-tooltip']} />\n          </Tooltip>\n        ) : null}\n        {extra ? (\n          <div\n            className={css['collapse-extra']}\n            onClick={e => e.stopPropagation()}\n          >\n            {extra}\n          </div>\n        ) : null}\n      </div>\n      {/* children */}\n      <Collapsible isOpen={isOpen} keepDOM fade duration={300}>\n        <div className={css['collapse-content']}>{children}</div>\n      </Collapsible>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Form, type FormModel } from '@flowgram-adapter/free-layout-editor';\n\nimport {\n  InputString,\n  InputNumber,\n  InputInteger,\n  InputJson,\n  SelectBoolean,\n  SelectVoice,\n  InputTime,\n  FieldItem,\n} from '../form-materials';\nimport {\n  createSchemaField,\n  type FormSchema,\n  useCreateForm,\n  type IFormSchema,\n  type FormSchemaReactComponents,\n} from '../../form-engine';\n\nconst SchemaField = createSchemaField({\n  components: {\n    InputString,\n    InputNumber,\n    InputInteger,\n    InputTime,\n    InputJson,\n    SelectBoolean,\n    SelectVoice,\n    FieldItem,\n  },\n});\n\ninterface TestRunFormProps {\n  schema: IFormSchema;\n  components?: FormSchemaReactComponents;\n  onFormValuesChange?: (payload: any) => void;\n  onMounted?: (formModel: FormModel, schema: FormSchema) => void;\n}\n\nexport const TestRunForm: React.FC<TestRunFormProps> = ({\n  schema,\n  components,\n  onFormValuesChange,\n  onMounted,\n}) => {\n  const { control, formSchema } = useCreateForm(schema, {\n    onFormValuesChange,\n    onMounted,\n  });\n  return (\n    <Form control={control}>\n      <SchemaField schema={formSchema} components={components} />\n    </Form>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport clsx from 'clsx';\nimport { TextArea } from '@coze-arch/coze-design';\n\nimport css from './input.module.less';\n\nexport interface InputStringProps {\n  value?: string;\n}\n\nexport const InputString: React.FC<InputStringProps> = props => (\n  <TextArea\n    className={clsx(css['input-string'], css.small)}\n    autosize={{ minRows: 1, maxRows: 5 }}\n    rows={1}\n    showClear\n    {...props}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputNumber as BaseInputNumber } from '../../base-form-materials';\n\nexport const InputNumber = props => <BaseInputNumber {...props} />;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputNumber as BaseInputNumber } from '../../base-form-materials';\n\nexport const InputInteger = props => <BaseInputNumber int {...props} />;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { clsx } from 'clsx';\nimport { DatePicker } from '@coze-arch/coze-design';\n\nimport css from './time.module.less';\n\nexport interface InputTimeProps {\n  className?: string;\n  value?: string;\n  onChange?: (v?: string) => void;\n}\n\nexport const InputTime: React.FC<InputTimeProps> = ({\n  className,\n  value,\n  onChange,\n  ...props\n}) => (\n  <DatePicker\n    className={clsx(css['input-time'], className)}\n    type=\"dateTime\"\n    size=\"small\"\n    showClear={false}\n    showSuffix={false}\n    value={value}\n    onChange={(_date, dateString) => {\n      if (typeof dateString === 'string' || dateString === undefined) {\n        onChange?.(dateString);\n      }\n    }}\n    {...props}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useMemo } from 'react';\n\nimport { clsx } from 'clsx';\nimport { Select, type SelectProps } from '@coze-arch/coze-design';\n\nimport css from './select.module.less';\n\ninterface SelectBooleanProps {\n  className?: string;\n  value?: boolean;\n  onChange?: (v?: boolean) => void;\n}\n\nexport const SelectBoolean: React.FC<SelectBooleanProps> = ({\n  className,\n  value,\n  onChange,\n  ...props\n}) => {\n  const formattedValue = useMemo(\n    () => (value === undefined ? undefined : Number(value)),\n    [value],\n  );\n\n  const handleChange = useCallback(\n    (v?: SelectProps['value']) => {\n      const next = v === undefined ? v : Boolean(v);\n      onChange?.(next);\n    },\n    [onChange],\n  );\n\n  return (\n    <Select\n      className={clsx(css['select-boolean'], className)}\n      size=\"small\"\n      value={formattedValue}\n      onChange={handleChange}\n      {...props}\n    >\n      <Select.Option value={1}>True</Select.Option>\n      <Select.Option value={0}>False</Select.Option>\n    </Select>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { VoiceSelect } from '@coze-workflow/components';\n\ninterface SelectVoiceProps {\n  value?: string;\n  onChange?: (v?: string) => void;\n  onBlur?: () => void;\n}\n\nexport const SelectVoice: React.FC<SelectVoiceProps> = ({\n  onChange,\n  onBlur,\n  ...props\n}) => {\n  const handleChange = (v?: string) => {\n    onChange?.(v);\n    onBlur?.();\n  };\n\n  return <VoiceSelect onChange={handleChange} {...props} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport {\n  FieldItem as BaseFieldItem,\n  type FieldItemProps,\n} from '../../base-form-materials';\nimport { useFieldSchema } from '../../../form-engine';\nimport { TestFormFieldName } from '../../../constants';\n\nexport const FieldItem: React.FC<React.PropsWithChildren<FieldItemProps>> = ({\n  tag,\n  ...props\n}) => {\n  const schema = useFieldSchema();\n\n  const isBatchField = schema.path.includes(TestFormFieldName.Batch);\n  /** Batch variable tag adds extra description */\n  const currentTag =\n    tag && isBatchField\n      ? `${tag} - ${I18n.t('workflow_detail_node_batch')}`\n      : tag;\n\n  return (\n    <BaseFieldItem\n      title={schema.title}\n      description={schema.description}\n      required={schema.required}\n      tag={currentTag}\n      {...props}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext, useRef } from 'react';\n\nimport {\n  createWithEqualityFn,\n  type UseBoundStoreWithEqualityFn,\n} from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { type StoreApi } from 'zustand';\n\nimport { type IFormSchema } from '../form-engine';\n\n/**\n * Global nature state centralized management within a single form\n */\nexport interface TestRunFormState {\n  schema: IFormSchema | null;\n  mode: 'form' | 'json';\n  patch: (next: Partial<TestRunFormState>) => void;\n  getSchema: () => TestRunFormState['schema'];\n}\n\nconst createStore = () =>\n  createWithEqualityFn<TestRunFormState>(\n    (set, get) => ({\n      schema: null,\n      mode: 'form',\n      patch: next => set(() => next),\n      getSchema: () => get().schema,\n    }),\n    shallow,\n  );\n\ntype FormStore = UseBoundStoreWithEqualityFn<StoreApi<TestRunFormState>>;\n\nconst FormContext = createContext<FormStore>({} as unknown as FormStore);\n\nexport const TestRunFormProvider: React.FC<React.PropsWithChildren> = ({\n  children,\n}) => {\n  const ref = useRef(createStore());\n  return (\n    <FormContext.Provider value={ref.current}>{children}</FormContext.Provider>\n  );\n};\n\nexport const useTestRunFormStore = <T,>(\n  selector: (s: TestRunFormState) => T,\n) => {\n  const store = useContext(FormContext);\n\n  return store(selector);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType, getFileAccept } from '@coze-workflow/base';\n\ninterface GenerateFieldComponentOptions {\n  type: ViewVariableType;\n  validateJsonSchema?: any;\n}\n\nexport const generateFieldComponent = (\n  options: GenerateFieldComponentOptions,\n) => {\n  const { type, validateJsonSchema } = options;\n  /** timbre type */\n  if (ViewVariableType.Voice === type) {\n    return {\n      ['x-component']: 'SelectVoice',\n    };\n  }\n  /** file type */\n  if (ViewVariableType.isFileType(type)) {\n    const fileType = [\n      ViewVariableType.Image,\n      ViewVariableType.ArrayImage,\n    ].includes(type)\n      ? 'image'\n      : 'object';\n    return {\n      ['x-component']: 'TypedFileInput',\n      ['x-component-props']: {\n        // If it is an array type, it indicates that it is a multi-selected file selector\n        multiple: ViewVariableType.isArrayType(type),\n        accept: getFileAccept(type),\n        fileType,\n      },\n    };\n  }\n  /** Exclude object types and array types for file types */\n  if (ViewVariableType.isArrayType(type) || ViewVariableType.Object === type) {\n    return {\n      ['x-component']: 'InputJson',\n      ['x-component-props']: {\n        jsonSchema: validateJsonSchema,\n      },\n      defaultValue: ViewVariableType.Object === type ? '{}' : '[]',\n    };\n  }\n  if (type === ViewVariableType.Integer) {\n    return {\n      ['x-component']: 'InputInteger',\n    };\n  }\n  if (type === ViewVariableType.Number) {\n    return {\n      ['x-component']: 'InputNumber',\n    };\n  }\n  if (type === ViewVariableType.Boolean) {\n    return {\n      ['x-component']: 'SelectBoolean',\n      defaultValue: true,\n    };\n  }\n  if (type === ViewVariableType.Time) {\n    return {\n      ['x-component']: 'InputTime',\n    };\n  }\n  /** String type and other unknown types all render normal text boxes */\n  return {\n    ['x-component']: 'InputString',\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ViewVariableType } from '@coze-workflow/base';\n\nimport { type IFormSchema } from '../form-engine';\nimport { generateFieldValidator } from './generate-field-validator';\nimport { generateFieldComponent } from './generate-field-component';\n\ninterface GenerateFieldOptions {\n  type: ViewVariableType;\n  name: string;\n  title?: string;\n  required?: boolean;\n  description?: string;\n  defaultValue?: string;\n  validateJsonSchema?: any;\n  extra?: IFormSchema;\n}\n\n/**\n * Form Field Schema Calculation\n */\nexport const generateField = (options: GenerateFieldOptions): IFormSchema => {\n  const {\n    type,\n    name,\n    title,\n    required = true,\n    description,\n    defaultValue,\n    validateJsonSchema,\n    extra,\n  } = options;\n\n  return {\n    name,\n    title,\n    description,\n    required,\n    ['x-decorator']: 'FieldItem',\n    ['x-decorator-props']: {\n      tag: ViewVariableType.LabelMap[type],\n    },\n    ['x-origin-type']: type as unknown as string,\n    ...generateFieldValidator(options),\n    // rendering component related\n    ...generateFieldComponent({ type, validateJsonSchema }),\n    // Component also comes with default values, and the default values of imported parameters have higher priority\n    defaultValue,\n    ...extra,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isObject } from 'lodash-es';\n\n/**\n * Is it an empty property?\n */\nexport const isFormSchemaPropertyEmpty = (properties: unknown) =>\n  isObject(properties) ? !Object.keys(properties).length : true;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isBoolean } from 'lodash-es';\n\nexport const stringifyFormValuesFromBacked = (value: object) => {\n  if (!value) {\n    return undefined;\n  }\n  return Object.keys(value).reduce((acc, key) => {\n    const val = value[key];\n    if (val === null || val === undefined) {\n      acc[key] = undefined;\n    } else if (typeof val === 'string' || isBoolean(val)) {\n      acc[key] = val;\n    } else {\n      acc[key] = JSON.stringify(value[key]);\n    }\n    return acc;\n  }, {});\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { uniqBy } from 'lodash-es';\nimport dayjs from 'dayjs';\nimport {\n  type Span,\n  type Int64,\n  type TraceFrontendSpan,\n} from '@coze-arch/bot-api/workflow_api';\n\nimport { type GotoParams } from './types';\n\nexport const sortSpans = (spans: TraceFrontendSpan[]) =>\n  uniqBy(spans, span => span.span_id).sort((a, b) => {\n    const startA = a.start_time ? Number(a.start_time) : Infinity;\n    const startB = b.start_time ? Number(b.start_time) : Infinity;\n    return startA - startB;\n  });\n\nexport const getTimeFromSpan = (span: Span) =>\n  span.start_time ? dayjs(span.start_time).format('YYYY-MM-DD HH:mm:ss') : '-';\n\nexport const isTriggerFromSpan = (span: Span) =>\n  span.tags?.find(t => t.key === 'is_trigger');\n\nexport const getStrFromSpan = (span: Span, key: string): string => {\n  const { tags } = span;\n  if (!Array.isArray(tags) || !tags.length) {\n    return '';\n  }\n  const target = tags.find(t => t.key === key);\n  return target?.value?.v_str || '';\n};\nexport const getLongFromSpan = (span: Span, key: string): Int64 | undefined => {\n  const { tags } = span;\n  if (!Array.isArray(tags) || !tags.length) {\n    return '';\n  }\n  const target = tags.find(t => t.key === key);\n  return target?.value?.v_long;\n};\n\nexport const getTokensFromSpan = (span: Span) =>\n  getLongFromSpan(span, 'tokens');\n\nconst DECIMAL = 60;\nconst UNIT_MILLISECOND = 1000;\nconst UNIT_SECOND = DECIMAL * UNIT_MILLISECOND;\nconst UNIT_MINUTES = DECIMAL * UNIT_SECOND;\nconst UNIT_HOUR = DECIMAL * UNIT_MINUTES;\n\nexport function formatDuration(time: number) {\n  if (time < UNIT_MILLISECOND) {\n    return `${time}ms`;\n  } else if (time < UNIT_SECOND) {\n    return `${(time / UNIT_MILLISECOND).toFixed(2)}s`;\n  } else if (time < UNIT_MINUTES) {\n    return `${(time / UNIT_SECOND).toFixed(2)}min`;\n  } else if (time < UNIT_HOUR) {\n    return `${(time / UNIT_MINUTES).toFixed(2)}h`;\n  } else {\n    return `${(time / UNIT_HOUR).toFixed(2)}d`;\n  }\n}\n\nexport const getGotoNodeParams = (span: Span): GotoParams => {\n  const workflowId = getStrFromSpan(span, 'workflow_id');\n  const nodeId = getStrFromSpan(span, 'workflow_node_id');\n  const executeId = getStrFromSpan(span, 'execute_id');\n  const subExecuteId = getStrFromSpan(span, 'sub_execute_id');\n\n  return {\n    workflowId,\n    nodeId,\n    executeId,\n    subExecuteId,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { IconCozFocus } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\nimport { type Span } from '@coze-arch/bot-api/workflow_api';\n\nimport { getStrFromSpan } from '../../utils';\n\nexport const FocusButton: React.FC<{\n  span: Span;\n  onClick: (span: Span) => void;\n}> = ({ span, onClick }) => {\n  const nodeId = useMemo(\n    () => getStrFromSpan(span, 'workflow_node_id'),\n    [span],\n  );\n\n  if (!nodeId) {\n    return null;\n  }\n\n  return (\n    <IconButton\n      icon={<IconCozFocus />}\n      size=\"mini\"\n      onClick={() => onClick(span)}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DECIMAL = 60;\nconst UNIT_MILLISECOND = 1000;\nconst UNIT_SECOND = DECIMAL * UNIT_MILLISECOND;\nconst UNIT_MINUTES = DECIMAL * UNIT_SECOND;\nconst UNIT_HOUR = DECIMAL * UNIT_MINUTES;\n\nexport function formatDuration(time: number) {\n  if (time < UNIT_MILLISECOND) {\n    return `${time}ms`;\n  } else if (time < UNIT_SECOND) {\n    return `${(time / UNIT_MILLISECOND).toFixed(2)}s`;\n  } else if (time < UNIT_MINUTES) {\n    return `${(time / UNIT_SECOND).toFixed(2)}min`;\n  } else if (time < UNIT_HOUR) {\n    return `${(time / UNIT_MINUTES).toFixed(2)}h`;\n  } else {\n    return `${(time / UNIT_HOUR).toFixed(2)}d`;\n  }\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StatusCode } from '../consts/basic';\n\nexport const getStandardStatusCode = (status: number) =>\n  status === StatusCode.SUCCESS ? StatusCode.SUCCESS : StatusCode.ERROR;\n\nexport const isSuccessStatus = (status?: number) =>\n  status === StatusCode.SUCCESS;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\nimport {\n  type TraceFlamethreadProps,\n  type NodePresetConfig,\n  type TraceTreeStyleDefaultProps,\n} from '../typings/graph';\nimport { type LineStyle } from '../common/tree';\nimport { type RectStyle } from '../common/flamethread';\nimport { ReactComponent as WorkflowIcon } from '../assets/graph/span-type/icon-workflow.svg';\nimport { ReactComponent as WorkflowStartIcon } from '../assets/graph/span-type/icon-workflow-start.svg';\nimport { ReactComponent as WorkflowEndIcon } from '../assets/graph/span-type/icon-workflow-end.svg';\nimport { ReactComponent as PluginToolIcon } from '../assets/graph/span-type/icon-plugin-tool.svg';\nimport { ReactComponent as MessageIcon } from '../assets/graph/span-type/icon-message.svg';\nimport { ReactComponent as LlmCallIcon } from '../assets/graph/span-type/icon-llm-call.svg';\nimport { ReactComponent as KnowledgeIcon } from '../assets/graph/span-type/icon-knowledge.svg';\nimport { ReactComponent as ConditionIcon } from '../assets/graph/span-type/icon-condition.svg';\nimport { ReactComponent as CodeIcon } from '../assets/graph/span-type/icon-code.svg';\nimport { ReactComponent as CardIcon } from '../assets/graph/span-type/icon-card.svg';\nimport { ReactComponent as BotIcon } from '../assets/graph/span-type/icon-bot.svg';\nimport { ReactComponent as AgentIcon } from '../assets/graph/span-type/icon-agent.svg';\nimport { StatusCode } from './basic';\n\nexport const TRACE_TREE_STYLE_DEFAULT_PROPS: TraceTreeStyleDefaultProps = {\n  lineStyle: {\n    normal: {\n      stroke: '#C6C6CD',\n      strokeWidth: 1,\n    },\n    hover: {\n      stroke: '#B4BAF6',\n      strokeWidth: 2,\n    },\n    select: {\n      stroke: '#B4BAF6',\n      strokeWidth: 2,\n    },\n  },\n  globalStyle: {\n    nodeBoxHeight: 20,\n    verticalInterval: 12,\n    offsetX: 10,\n  },\n};\n\nexport const SPAN_STATUS_CONFIG: Record<\n  StatusCode,\n  {\n    lineStyle?: LineStyle;\n  }\n> = {\n  [StatusCode.SUCCESS]: {},\n  [StatusCode.ERROR]: {\n    lineStyle: {\n      normal: {\n        stroke: '#FF441E',\n      },\n      hover: {\n        stroke: '#FF441E',\n      },\n      select: {\n        stroke: '#FF441E',\n      },\n    },\n  },\n};\n\nexport enum PresetSpanType {\n  UserInput = 'UserInput',\n  ThirdParty = 'ThirdParty',\n  ScheduledTasks = 'ScheduledTasks',\n  OpenDialog = 'OpenDialog',\n  InvokeAgent = 'InvokeAgent',\n  RestartAgent = 'RestartAgent',\n  SwitchAgent = 'SwitchAgent',\n  LLMCall = 'LLMCall',\n  LLMBatchCall = 'LLMBatchCall',\n  Workflow = 'Workflow',\n  WorkflowStart = 'WorkflowStart',\n  WorkflowEnd = 'WorkflowEnd',\n  PluginTool = 'PluginTool',\n  PluginToolBatch = 'PluginToolBatch',\n  Knowledge = 'Knowledge',\n  Code = 'Code',\n  CodeBatch = 'CodeBatch',\n  Condition = 'Condition',\n  Chain = 'Chain',\n  Card = 'Card',\n  WorkflowMessage = 'WorkflowMessage',\n  WorkflowLLMCall = 'WorkflowLLMCall',\n  WorkflowLLMBatchCall = 'WorkflowLLMBatchCall',\n  WorkflowCode = 'WorkflowCode',\n  WorkflowCodeBatch = 'WorkflowCodeBatch',\n  WorkflowCondition = 'WorkflowCondition',\n  WorkflowPluginTool = 'WorkflowPluginTool',\n  WorkflowPluginToolBatch = 'WorkflowPluginToolBatch',\n  WorkflowKnowledge = 'WorkflowKnowledge',\n}\n\nexport const NODE_PRESET_CONFIG_MAP: Record<PresetSpanType, NodePresetConfig> =\n  {\n    [PresetSpanType.UserInput]: {\n      icon: <BotIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(254, 242, 237)',\n          },\n          hover: {\n            fill: 'rgb(254, 221, 210)',\n          },\n          select: {\n            fill: 'rgb(253, 183, 165)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.ThirdParty]: {\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(253, 236, 239)',\n          },\n          hover: {\n            fill: 'rgb(251, 207, 216)',\n          },\n          select: {\n            fill: 'rgb(246, 160, 181)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.ScheduledTasks]: {\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(247, 233, 247)',\n          },\n          hover: {\n            fill: 'rgb(239, 202, 240)',\n          },\n          select: {\n            fill: 'rgb(221, 155, 224)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.OpenDialog]: {\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(243, 237, 249)',\n          },\n          hover: {\n            fill: 'rgb(226, 209, 244)',\n          },\n          select: {\n            fill: 'rgb(196, 167, 233)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.InvokeAgent]: {\n      icon: <AgentIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(236, 239, 248)',\n          },\n          hover: {\n            fill: 'rgb(209, 216, 240)',\n          },\n          select: {\n            fill: 'rgb(167, 179, 225)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.RestartAgent]: {\n      icon: <AgentIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(234, 245, 255)',\n          },\n          hover: {\n            fill: 'rgb(203, 231, 254)',\n          },\n          select: {\n            fill: 'rgb(152, 205, 253)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.SwitchAgent]: {\n      icon: <AgentIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(233, 247, 253)',\n          },\n          hover: {\n            fill: 'rgb(201, 236, 252)',\n          },\n          select: {\n            fill: 'rgb(149, 216, 248)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.LLMCall]: {\n      icon: <LlmCallIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(229, 247, 248)',\n          },\n          hover: {\n            fill: 'rgb(194, 239, 240)',\n          },\n          select: {\n            fill: 'rgb(138, 221, 226)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.LLMBatchCall]: {\n      icon: <LlmCallIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(228, 247, 244)',\n          },\n          hover: {\n            fill: 'rgb(192, 240, 232)',\n          },\n          select: {\n            fill: 'rgb(135, 224, 211)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.Workflow]: {\n      icon: <WorkflowIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(236, 247, 236)',\n          },\n          hover: {\n            fill: 'rgb(208, 240, 209)',\n          },\n          select: {\n            fill: 'rgb(164, 224, 167)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowStart]: {\n      icon: <WorkflowStartIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(243, 248, 236)',\n          },\n          hover: {\n            fill: 'rgb(227, 240, 208)',\n          },\n          select: {\n            fill: 'rgb(200, 226, 165)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowEnd]: {\n      icon: <WorkflowEndIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(242, 250, 230)',\n          },\n          hover: {\n            fill: 'rgb(227, 246, 197)',\n          },\n          select: {\n            fill: 'rgb(203, 237, 142)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.PluginTool]: {\n      icon: <PluginToolIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(255, 253, 234)',\n          },\n          hover: {\n            fill: 'rgb(254, 251, 203)',\n          },\n          select: {\n            fill: 'rgb(253, 243, 152)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.PluginToolBatch]: {\n      icon: <PluginToolIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(254, 251, 235)',\n          },\n          hover: {\n            fill: 'rgb(252, 245, 206)',\n          },\n          select: {\n            fill: 'rgb(249, 232, 158)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.Knowledge]: {\n      icon: <KnowledgeIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(255, 248, 234)',\n          },\n          hover: {\n            fill: 'rgb(254, 238, 204)',\n          },\n          select: {\n            fill: 'rgb(254, 217, 152)',\n          },\n        },\n      },\n    },\n    // from\n    [PresetSpanType.Code]: {\n      icon: <CodeIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(254, 242, 237)',\n          },\n          hover: {\n            fill: 'rgb(254, 221, 210)',\n          },\n          select: {\n            fill: 'rgb(253, 183, 165)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.CodeBatch]: {\n      icon: <CodeIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(253, 236, 239)',\n          },\n          hover: {\n            fill: 'rgb(251, 207, 216)',\n          },\n          select: {\n            fill: 'rgb(246, 160, 181)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.Condition]: {\n      icon: <ConditionIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(247, 233, 247)',\n          },\n          hover: {\n            fill: 'rgb(239, 202, 240)',\n          },\n          select: {\n            fill: 'rgb(221, 155, 224)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.Chain]: {\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(243, 237, 249)',\n          },\n          hover: {\n            fill: 'rgb(226, 209, 244)',\n          },\n          select: {\n            fill: 'rgb(196, 167, 233)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.Card]: {\n      icon: <CardIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(236, 239, 248)',\n          },\n          hover: {\n            fill: 'rgb(209, 216, 240)',\n          },\n          select: {\n            fill: 'rgb(167, 179, 225)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowMessage]: {\n      icon: <MessageIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(234, 245, 255)',\n          },\n          hover: {\n            fill: 'rgb(203, 231, 254)',\n          },\n          select: {\n            fill: 'rgb(152, 205, 253)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowLLMCall]: {\n      icon: <LlmCallIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(233, 247, 253)',\n          },\n          hover: {\n            fill: 'rgb(201, 236, 252)',\n          },\n          select: {\n            fill: 'rgb(149, 216, 248)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowLLMBatchCall]: {\n      icon: <LlmCallIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(229, 247, 248)',\n          },\n          hover: {\n            fill: 'rgb(194, 239, 240)',\n          },\n          select: {\n            fill: 'rgb(138, 221, 226)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.WorkflowCode]: {\n      icon: <CodeIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(228, 247, 244)',\n          },\n          hover: {\n            fill: 'rgb(192, 240, 232)',\n          },\n          select: {\n            fill: 'rgb(135, 224, 211)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.WorkflowCodeBatch]: {\n      icon: <CodeIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(236, 247, 236)',\n          },\n          hover: {\n            fill: 'rgb(208, 240, 209)',\n          },\n          select: {\n            fill: 'rgb(164, 224, 167)',\n          },\n        },\n      },\n    },\n\n    [PresetSpanType.WorkflowCondition]: {\n      icon: <ConditionIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(243, 248, 236)',\n          },\n          hover: {\n            fill: 'rgb(227, 240, 208)',\n          },\n          select: {\n            fill: 'rgb(200, 226, 165)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowPluginTool]: {\n      icon: <PluginToolIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(242, 250, 230)',\n          },\n          hover: {\n            fill: 'rgb(227, 246, 197)',\n          },\n          select: {\n            fill: 'rgb(203, 237, 142)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowPluginToolBatch]: {\n      icon: <PluginToolIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(255, 253, 234)',\n          },\n          hover: {\n            fill: 'rgb(254, 251, 203)',\n          },\n          select: {\n            fill: 'rgb(253, 243, 152)',\n          },\n        },\n      },\n    },\n    [PresetSpanType.WorkflowKnowledge]: {\n      icon: <KnowledgeIcon />,\n      flamethread: {\n        rectStyle: {\n          normal: {\n            fill: 'rgb(254, 251, 235)',\n          },\n          hover: {\n            fill: 'rgb(252, 245, 206)',\n          },\n          select: {\n            fill: 'rgb(249, 232, 158)',\n          },\n        },\n      },\n    },\n  };\n\nexport const FLAME_THREAD_DEFAULT_CONFIG: Pick<\n  TraceFlamethreadProps,\n  'rectStyle' | 'labelStyle' | 'rowHeight' | 'globalStyle' | 'datazoomDecimals'\n> = {\n  labelStyle: {\n    position: 'inside-left',\n    fontSize: 12,\n    fill: '#1D1C23CC',\n  },\n  rowHeight: 50,\n  globalStyle: {},\n  datazoomDecimals: 1,\n};\n\nexport const FLAME_THREAD_DEFAULT_RECT_STYLE: RectStyle = {\n  normal: {\n    fill: '#F7F7FA',\n  },\n  hover: {\n    fill: '#F0F0F5',\n  },\n  select: {\n    fill: '#C6C6CD',\n  },\n};\n\nexport const FLAME_THREAD_DEFAULT_TOOLTIP_STYLE = {\n  fill: '#212629',\n  shape: {\n    symbolType: 'square',\n    fill: '#212629',\n    size: 5,\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext } from 'react';\n\nimport { type TreeNodeInfo } from '../common/tree/typing';\n\ninterface TraceTreeContext {\n  treeMap: Record<string, TreeNodeInfo>;\n  onCollapse: (id: string, collapsed: boolean) => void;\n}\n\nexport const traceTreeContext = createContext<TraceTreeContext>({\n  treeMap: {},\n  onCollapse: (id, collapsed) => '',\n});\n\nexport const useTraceTree = () => useContext(traceTreeContext);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { clsx } from 'clsx';\nimport {\n  IconCozClockFill,\n  IconCozArrowLeftFill,\n} from '@coze-arch/coze-design/icons';\nimport { Tag, Tooltip, IconButton } from '@coze-arch/coze-design';\n\nimport { formatDuration } from '../utils/time';\nimport { isSuccessStatus } from '../utils/basic';\nimport {\n  type SpanNode,\n  type NodeConfig,\n  type NodePresetConfig,\n  type SpanNodeRenderOptions,\n  type RenderGraphNodeConfig,\n} from '../typings/graph';\nimport { NODE_PRESET_CONFIG_MAP, type PresetSpanType } from '../consts/graph';\nimport { type TreeNodeExtra } from '../common/tree';\nimport { ReactComponent as IconBroken } from '../assets/graph/icon-broken.svg';\nimport { useTraceTree } from './context';\n\nimport styles from './index.module.less';\n\nexport function getNodeConfig(\n  params: Pick<SpanNode, 'name' | 'type'> & {\n    customTypeConfigMap?: Record<string | number, NodePresetConfig | undefined>;\n  },\n): NodeConfig {\n  const { name, type, customTypeConfigMap } = params;\n  const nodeConfig: NodeConfig = {\n    character: name?.charAt(0),\n    color: '#b4baf6',\n  };\n\n  if (!type) {\n    return nodeConfig;\n  } else {\n    const presetNodeConfig =\n      customTypeConfigMap?.[type] ??\n      NODE_PRESET_CONFIG_MAP[type as PresetSpanType];\n\n    return {\n      ...nodeConfig,\n      ...presetNodeConfig,\n    };\n  }\n}\ninterface CustomTreeNodeProps {\n  renderGraphNodeConfig?: RenderGraphNodeConfig;\n  nodeData: TreeNodeExtra;\n}\n\nexport const CustomTreeNode = ({\n  renderGraphNodeConfig,\n  nodeData,\n}: CustomTreeNodeProps) => {\n  const { treeMap, onCollapse } = useTraceTree();\n\n  const { selected, hover, key } = nodeData;\n  const { spanNode } = nodeData?.extra as { spanNode: SpanNode };\n  const { type, name, status_code, isBroken, span_id, duration } = spanNode;\n  const { isCollapsed } = treeMap[key] || {};\n\n  const isLeaf = !spanNode.children || spanNode.children.length === 0;\n\n  const { customTypeConfigMap, traceTreeCustomRenderer } =\n    renderGraphNodeConfig || {};\n\n  const { icon, character, color } = getNodeConfig({\n    type,\n    name,\n    customTypeConfigMap,\n  });\n\n  const customTreeNodeContent = useMemo(\n    () => (\n      <div\n        className={clsx(styles['tree-custom-node-content'], {\n          [styles.selected]: selected,\n          [styles.hover]: hover,\n          [styles.error]: !isSuccessStatus(status_code),\n        })}\n      >\n        <span className={styles.title}>{name}</span>\n      </div>\n    ),\n    [selected, hover, status_code, name],\n  );\n\n  return (\n    <div className={styles['tree-custom-node']}>\n      <div className={styles['tree-custom-node-icon']}>\n        {isBroken ? <IconBroken /> : null}\n        {icon ?? (\n          <span\n            className={styles['tree-custom-node-icon-default']}\n            style={{\n              backgroundColor: color,\n            }}\n          >\n            {character}\n          </span>\n        )}\n      </div>\n      {traceTreeCustomRenderer?.renderTooltip ? (\n        <Tooltip\n          position=\"right\"\n          {...traceTreeCustomRenderer.renderTooltip?.(spanNode)}\n        >\n          {customTreeNodeContent}\n        </Tooltip>\n      ) : (\n        customTreeNodeContent\n      )}\n      <Tag\n        color={\n          Number(duration) > 60000\n            ? 'red'\n            : Number(duration) > 10000\n            ? 'yellow'\n            : 'green'\n        }\n        type=\"light\"\n        className={styles['node-tag']}\n        size=\"mini\"\n        prefixIcon={<IconCozClockFill />}\n      >\n        {formatDuration(Number(duration))}\n      </Tag>\n      {traceTreeCustomRenderer?.renderExtra?.(spanNode)}\n      {!isLeaf && (\n        <Tooltip content={isCollapsed ? '' : ''} position=\"right\">\n          <IconButton\n            color=\"secondary\"\n            size=\"mini\"\n            icon={\n              <IconCozArrowLeftFill\n                className={clsx(!isCollapsed && styles['is-open'])}\n              />\n            }\n            onClick={e => {\n              e.stopPropagation();\n              onCollapse?.(span_id || '', !isCollapsed);\n            }}\n          />\n        </Tooltip>\n      )}\n    </div>\n  );\n};\n\nexport const renderCustomTreeNode =\n  ({ renderGraphNodeConfig }: SpanNodeRenderOptions) =>\n  (nodeData: TreeNodeExtra) =>\n    (\n      <CustomTreeNode\n        nodeData={nodeData}\n        renderGraphNodeConfig={renderGraphNodeConfig}\n      />\n    );\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { uniqBy } from 'lodash-es';\n\nimport { type TraceFrontendSpan } from '../typings/idl';\nimport {\n  type SpanNode,\n  type RenderGraphNodeConfig,\n  type SpanNodeRenderOptions,\n} from '../typings/graph';\nimport { renderCustomTreeNode } from '../trace-tree/graph-render';\nimport {\n  FLAME_THREAD_DEFAULT_RECT_STYLE,\n  SPAN_STATUS_CONFIG,\n} from '../consts/graph';\nimport { NODE_PRESET_CONFIG_MAP, type PresetSpanType } from '../consts/graph';\nimport { StatusCode } from '../consts/basic';\nimport { type TreeNodeInfo } from '../common/tree/typing';\nimport { type TreeNode } from '../common/tree';\nimport { type RectStyle, type RectNode } from '../common/flamethread';\nimport { getStandardStatusCode } from './basic';\n\nexport function spans2SpanNodes(spans: TraceFrontendSpan[]): {\n  roots: SpanNode[];\n  spans: TraceFrontendSpan[];\n} {\n  if (spans.length === 0) {\n    return {\n      roots: [],\n      spans: [],\n    };\n  }\n\n  const roots: SpanNode[] = [];\n  const map: Record<string, SpanNode> = {};\n\n  const sortedSpans = uniqBy(spans, span => span.span_id).sort((a, b) => {\n    const startA = a.start_time ? Number(a.start_time) : Infinity;\n    const startB = b.start_time ? Number(b.start_time) : Infinity;\n    return startA - startB;\n  });\n\n  sortedSpans.forEach(span => {\n    const currentSpan: SpanNode = {\n      ...span,\n      children: [],\n    };\n    const { span_id } = span;\n    if (span_id) {\n      map[span_id] = currentSpan;\n    }\n  });\n\n  sortedSpans.forEach(span => {\n    const { span_id, parent_id } = span;\n    if (span_id) {\n      const spanNode = map[span_id];\n      const parentSpanNode = parent_id ? map[parent_id] : undefined;\n      if (parentSpanNode === undefined) {\n        roots.push({\n          ...spanNode,\n          isBroken: parent_id !== '0',\n        });\n      } else {\n        parentSpanNode.children = parentSpanNode.children ?? [];\n        parentSpanNode.children.push(spanNode);\n      }\n    }\n  });\n\n  return {\n    roots,\n    spans: sortedSpans,\n  };\n}\n\nexport const getSpanNodeInfo = (\n  spanNode: SpanNode,\n  map: Record<string, TreeNodeInfo> = {},\n) => {\n  const { isKeyNode, keyNodeParentId } = map[spanNode.parent_id || ''] || {};\n  if (spanNode.span_id) {\n    map[spanNode.span_id] = {\n      isCollapsed: false,\n      isKeyNode: spanNode.is_key_span,\n      keyNodeParentId: isKeyNode ? spanNode.parent_id : keyNodeParentId,\n    };\n  }\n\n  spanNode.children?.forEach(childSpan => getSpanNodeInfo(childSpan, map));\n};\n\nexport const geSpanNodeInfoMap = (spanNodes: SpanNode[]) => {\n  const map: Record<string, TreeNodeInfo> = {};\n  spanNodes.map(spanNode => getSpanNodeInfo(spanNode, map));\n  return map;\n};\n\nexport const spanNode2TreeNode = (\n  spanNodes: SpanNode[],\n  map: Record<string, TreeNodeInfo> = {},\n  options: SpanNodeRenderOptions = {},\n): TreeNode[] => {\n  const { showKeyNodeOnly } = options;\n  return (\n    spanNodes\n      .map(spanNode => {\n        const { status_code = StatusCode.SUCCESS } = spanNode;\n        const lineStyle =\n          SPAN_STATUS_CONFIG[getStandardStatusCode(status_code)]?.lineStyle;\n\n        const treeNode: TreeNode = {\n          key: spanNode.span_id || '',\n          title: renderCustomTreeNode(options),\n          lineStyle,\n          zIndex: spanNode.status_code === StatusCode.ERROR ? 1 : 0,\n          extra: {\n            spanNode,\n          },\n        };\n\n        const { isCollapsed, isKeyNode } = map[treeNode.key] || {};\n\n        if (showKeyNodeOnly && !isKeyNode) {\n          return (\n            spanNode2TreeNode(spanNode.children || [], map, options).flat() ??\n            []\n          );\n        }\n\n        if (!isCollapsed) {\n          treeNode.children =\n            spanNode2TreeNode(spanNode.children || [], map, options).flat() ??\n            [];\n        }\n        return treeNode;\n      })\n      .flat() || []\n  );\n};\n\nconst genRectStyle = (\n  span: SpanNode,\n  customTypeConfigMap?: RenderGraphNodeConfig['customTypeConfigMap'],\n): RectStyle => {\n  const { type = '' } = span;\n\n  const rectStyle =\n    customTypeConfigMap?.[type]?.flamethread?.rectStyle ??\n    NODE_PRESET_CONFIG_MAP[type as PresetSpanType]?.flamethread?.rectStyle ??\n    FLAME_THREAD_DEFAULT_RECT_STYLE;\n\n  return {\n    normal: rectStyle?.normal,\n    hover: rectStyle?.hover,\n    select: rectStyle?.select,\n  };\n};\n\nconst genRectNode = (info: {\n  span: TraceFrontendSpan;\n  startSpan?: TraceFrontendSpan;\n  rowNo: number;\n  customTypeConfigMap?: RenderGraphNodeConfig['customTypeConfigMap'];\n}): RectNode => {\n  const { span, startSpan, rowNo, customTypeConfigMap } = info;\n  const start =\n    (span.start_time as number) -\n    (startSpan ? (startSpan.start_time as number) : 0);\n  const end = start + (span.duration as number);\n  return {\n    key: span.span_id ?? '',\n    rowNo,\n    start,\n    end,\n    rectStyle: genRectStyle(span, customTypeConfigMap),\n    extra: {\n      span,\n    },\n  };\n};\n\nexport const spanData2flamethreadData = (\n  spans: TraceFrontendSpan[],\n  customTypeConfigMap?: RenderGraphNodeConfig['customTypeConfigMap'],\n): RectNode[] => {\n  const startSpan = spans?.[0] as TraceFrontendSpan | undefined;\n  return spans.map((span, index) =>\n    genRectNode({\n      span,\n      startSpan,\n      rowNo: index,\n      customTypeConfigMap,\n    }),\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { omit } from 'lodash-es';\n\nimport { type TreeNodeFlatten, type TreeNode, type Line } from './typing';\n\n/**\n * Generated based on TreeData:\n *\n * @param treeData tree original data source\n * @Param options.indentDisabled Whether to unindent. Valid only for the following scenarios: exception node + last node\n *\n * @returns\n * 1. nodes, node information after leveling\n * 2. lines, used to connect nodes\n */\nexport const flattenTreeData = (\n  treeData: TreeNode,\n  options: {\n    indentDisabled: boolean;\n  },\n): { nodes: TreeNodeFlatten[]; lines: Line[] } => {\n  const nodes: TreeNodeFlatten[] = [];\n  const lines: Line[] = [];\n  const walk = (\n    node: TreeNode,\n    nodeColNo: number,\n    fatherNodeFlatten?: TreeNodeFlatten,\n  ) => {\n    const nodeFlatten: TreeNodeFlatten = {\n      ...omit(node, ['children']),\n      colNo: nodeColNo,\n      rowNo: nodes.length,\n      unindented: fatherNodeFlatten?.colNo === nodeColNo, // Unindented\n    };\n    nodes.push(nodeFlatten);\n    if (fatherNodeFlatten !== undefined) {\n      lines.push({\n        startNode: fatherNodeFlatten,\n        endNode: nodeFlatten,\n      });\n    }\n\n    if (node.children) {\n      const childNodes = node.children;\n\n      childNodes.forEach((childNode, index) => {\n        // Cancel indentation. Effective scene: exception node + last node\n        const indentDisabled =\n          childNode.indentDisabled ?? options.indentDisabled;\n        if (indentDisabled && childNodes.length - 1 === index) {\n          walk(childNode, nodeColNo, nodeFlatten);\n        } else {\n          walk(childNode, nodeColNo + 1, nodeFlatten);\n        }\n      });\n    }\n  };\n  walk(treeData, 0);\n  return { nodes, lines };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type GlobalStyle, type LineStyle } from './typing';\n\nexport const defaultGlobalStyle: GlobalStyle = {\n  indent: 24,\n  verticalInterval: 16,\n  nodeBoxHeight: 16,\n  offsetX: 8,\n};\n\nexport const defaultLineStyle: LineStyle = {\n  normal: {\n    stroke: '#ccc',\n    strokeDasharray: '[]',\n    strokeWidth: 2,\n    lineRadius: 6,\n    lineGap: 0,\n  },\n  select: {\n    stroke: '#333',\n  },\n  hover: {\n    stroke: '#d25e5a',\n  },\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-magic-numbers -- there will be many numbers calculated in this component, no need to deal with them*/\nimport { type FC, useCallback, useMemo, useState } from 'react';\n\nimport { isFunction, mergeWith } from 'lodash-es';\n\nimport { flattenTreeData } from './util';\nimport type {\n  TreeProps,\n  TreeNode,\n  TreeNodeExtra,\n  MouseEventParams,\n  Line,\n  LineStyle,\n  GlobalStyle,\n} from './typing';\nimport { defaultGlobalStyle, defaultLineStyle } from './config';\n\nimport styles from './index.module.less';\n\nexport type {\n  TreeProps,\n  TreeNode,\n  TreeNodeExtra,\n  MouseEventParams,\n  LineStyle,\n  GlobalStyle,\n};\n\nexport const Tree: FC<TreeProps> = ({\n  treeData,\n  selectedKey,\n  indentDisabled = false,\n  lineStyle: gLineStyle,\n  globalStyle,\n  className,\n  onMouseMove,\n  onMouseEnter,\n  onMouseLeave,\n  onClick,\n  onSelect,\n}) => {\n  const [hoverKey, setHoverKey] = useState<string>('');\n\n  const { indent, verticalInterval, nodeBoxHeight, offsetX } = useMemo(\n    () =>\n      Object.assign(\n        {},\n        defaultGlobalStyle,\n        globalStyle,\n      ) as Required<GlobalStyle>,\n    [globalStyle],\n  );\n\n  /**\n   * Causes the Line of the specified selectKey to be placed at the top level.\n   * By adjusting the line order, the z-index effect is achieved: the line with the key ${selectKey} is at the top\n   */\n  const adjustLineOrder = useCallback(\n    (lines: Line[]): Line[] => {\n      let selectedLine, hoverLine;\n      let i = 0;\n      while (i < lines.length) {\n        const line = lines[i];\n        if (line.endNode.key === selectedKey) {\n          selectedLine = lines.splice(i, 1)[0];\n        } else if (line.endNode.key === hoverKey) {\n          hoverLine = lines.splice(i, 1)[0];\n        } else {\n          i++;\n        }\n      }\n\n      // Support controlling height according to zIndex\n      lines.sort((lineA, lineB) => {\n        const zIndexA = lineA.endNode.zIndex ?? -1;\n        const zIndexB = lineB.endNode.zIndex ?? -1;\n\n        if (zIndexA > zIndexB) {\n          return 1;\n        } else if (zIndexA < zIndexB) {\n          return -1;\n        } else {\n          return 0;\n        }\n      });\n\n      if (selectedLine) {\n        lines.push(selectedLine);\n      }\n      if (hoverLine) {\n        lines.push(hoverLine);\n      }\n\n      return lines;\n    },\n    [selectedKey, hoverKey],\n  );\n\n  const genLineStyle = useCallback(\n    (lineStyle?: LineStyle): LineStyle => ({\n      normal: Object.assign(\n        {},\n        defaultLineStyle?.normal,\n        gLineStyle?.normal,\n        lineStyle?.normal,\n      ),\n      select: Object.assign(\n        {},\n        defaultLineStyle?.select,\n        gLineStyle?.select,\n        lineStyle?.select,\n      ),\n      hover: Object.assign(\n        {},\n        defaultLineStyle?.hover,\n        gLineStyle?.hover,\n        lineStyle?.hover,\n      ),\n    }),\n    [gLineStyle],\n  );\n\n  /**\n   * Generate svg path from line information. colNo, rowNum all start from 0\n   */\n  const genSvgPath = useCallback(\n    (line: Line): string => {\n      const {\n        startNode: { colNo: startColNo, rowNo: startRowNo },\n        endNode: { colNo: endColNo, rowNo: endRowNo, lineStyle },\n      } = line;\n\n      const { normal: normalLineStyle = {} } = genLineStyle(lineStyle);\n\n      const { lineRadius = 0, lineGap = 0 } = normalLineStyle;\n      const nodeHeight = nodeBoxHeight + verticalInterval;\n\n      // starting point\n      const startX = startColNo * indent + offsetX;\n      const startY =\n        startRowNo * nodeHeight + (nodeBoxHeight + verticalInterval / 2);\n\n      if (startColNo === endColNo) {\n        // The length of the vertical line\n        const lineASize =\n          (endRowNo - startRowNo - 1) * nodeHeight + verticalInterval;\n        // Move to the starting point\n        const moveToStartPoint = `M ${startX} ${startY + lineGap}`;\n        // vertical line\n        const lineA = `L ${startX} ${startY + lineASize}`;\n        return `${moveToStartPoint} ${lineA}`;\n      } else {\n        // The length of the vertical line\n        const lineASize =\n          (endRowNo - startRowNo - 1) * nodeHeight +\n          verticalInterval / 2 +\n          nodeHeight / 2 -\n          lineRadius;\n        // The length of the horizontal line\n        const lineBSize =\n          (endColNo - startColNo) * indent - offsetX - lineRadius;\n        // Coordinates of the end point\n        const endX = startX + lineBSize + lineRadius;\n        const endY = startY + lineASize + lineRadius;\n\n        // Move to the starting point\n        const moveToStartPoint = `M ${startX} ${startY + lineGap}`;\n        // vertical line\n        const lineA = `L ${startX} ${startY + lineASize}`;\n        // Quadratic Bzier Curve\n        const qbc = `Q ${startX} ${endY} ${startX + lineRadius} ${endY}`;\n        // horizontal line\n        const lineB = `L ${endX - lineGap} ${endY}`;\n        return `${moveToStartPoint} ${lineA} ${qbc} ${lineB}`;\n      }\n    },\n    [genLineStyle, indent, nodeBoxHeight, offsetX, verticalInterval],\n  );\n\n  const genLineAttrs = useCallback(\n    (nodeKey: string, lineStyle: LineStyle) => {\n      if (hoverKey !== selectedKey) {\n        if (nodeKey === hoverKey) {\n          return mergeWith({}, lineStyle.normal, lineStyle.hover);\n        }\n        if (nodeKey === selectedKey) {\n          return mergeWith({}, lineStyle.normal, lineStyle.select);\n        }\n        return lineStyle.normal;\n      } else {\n        if (nodeKey === hoverKey) {\n          return mergeWith(\n            {},\n            lineStyle.normal,\n            lineStyle.select,\n            lineStyle.hover,\n          );\n        } else {\n          return lineStyle.normal;\n        }\n      }\n    },\n    [hoverKey, selectedKey],\n  );\n\n  const { nodes, lines: orgLines } = flattenTreeData(treeData, {\n    indentDisabled,\n  });\n  const lines = adjustLineOrder(orgLines);\n\n  return (\n    <div className={`${styles.tree} ${className ?? ''}`}>\n      <div\n        className={styles['tree-container']}\n        style={{ marginTop: -verticalInterval / 2 }}\n      >\n        <div className={styles['tree-path-list']}>\n          <svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">\n            {lines.map((line, index) => {\n              const path = genSvgPath(line);\n              const { lineStyle } = line.endNode;\n              const lineStyle0 = genLineStyle(lineStyle);\n              const attrs = genLineAttrs(line.endNode.key, lineStyle0);\n\n              return (\n                <path\n                  d={path}\n                  stroke={attrs?.stroke}\n                  strokeWidth={attrs?.strokeWidth}\n                  strokeDasharray={attrs?.strokeDasharray}\n                  fill=\"none\"\n                  // strokeLinecap=\"round\"\n                  key={line.endNode.key}\n                />\n              );\n            })}\n          </svg>\n        </div>\n        <div className={styles['tree-node-list']}>\n          {nodes.map(node => {\n            const { key, title, selectEnabled = true, colNo } = node;\n            const nodeExtra: TreeNodeExtra = {\n              ...node,\n              selected: selectedKey === key,\n              hover: hoverKey === key,\n            };\n\n            return (\n              <div\n                className={styles['tree-node']}\n                style={{\n                  paddingTop: verticalInterval / 2,\n                  paddingBottom: verticalInterval / 2,\n                }}\n                key={node.key}\n              >\n                <div\n                  className={styles['tree-node-box']}\n                  style={{\n                    marginLeft: colNo * indent,\n                    height: nodeBoxHeight,\n                  }}\n                  onClick={event => {\n                    if (selectEnabled) {\n                      onSelect?.({ node: nodeExtra });\n                    }\n                    onClick?.({ event, node: nodeExtra });\n                  }}\n                  onMouseMove={event => {\n                    onMouseMove?.({ event, node: nodeExtra });\n                  }}\n                  onMouseEnter={event => {\n                    if (selectEnabled) {\n                      setHoverKey(key);\n                    }\n                    onMouseEnter?.({\n                      event,\n                      node: { ...nodeExtra, hover: true },\n                    });\n                  }}\n                  onMouseLeave={event => {\n                    if (selectEnabled) {\n                      setHoverKey('');\n                    }\n                    onMouseLeave?.({\n                      event,\n                      node: { ...nodeExtra, hover: false },\n                    });\n                  }}\n                >\n                  {isFunction(title) ? title(nodeExtra) : title}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { clsx } from 'clsx';\n\nimport { geSpanNodeInfoMap, spanNode2TreeNode } from '../utils/graph';\nimport { type TraceTreeProps } from '../typings/graph';\nimport { TRACE_TREE_STYLE_DEFAULT_PROPS } from '../consts/graph';\nimport { type TreeNodeInfo } from '../common/tree/typing';\nimport { Tree, type TreeNode } from '../common/tree';\nimport { traceTreeContext } from './context';\n\nimport styles from './index.module.less';\n\nexport const TraceTree = (props: TraceTreeProps) => {\n  const {\n    spans: spanNodes,\n    selectedSpanId,\n    indentDisabled,\n    lineStyle: _lineStyle,\n    globalStyle: _globalStyle,\n    className,\n    onCollapseChange,\n    renderGraphNodeConfig,\n    defaultDisplayMode,\n    hostUser,\n    ...restProps\n  } = props;\n\n  const [treeData, setTreeData] = useState<TreeNode[]>();\n  const [treeMap, setTreeMap] = useState<Record<string, TreeNodeInfo>>(() =>\n    geSpanNodeInfoMap(spanNodes),\n  );\n\n  const lineStyle = useMemo(\n    () => ({\n      normal: Object.assign(\n        {},\n        TRACE_TREE_STYLE_DEFAULT_PROPS.lineStyle?.normal,\n        _lineStyle?.normal,\n      ),\n      select: Object.assign(\n        {},\n        TRACE_TREE_STYLE_DEFAULT_PROPS.lineStyle?.select,\n        _lineStyle?.select,\n      ),\n      hover: Object.assign(\n        {},\n        TRACE_TREE_STYLE_DEFAULT_PROPS.lineStyle?.hover,\n        _lineStyle?.hover,\n      ),\n    }),\n    [_lineStyle],\n  );\n\n  const globalStyle = useMemo(\n    () =>\n      Object.assign(\n        {},\n        TRACE_TREE_STYLE_DEFAULT_PROPS.globalStyle,\n        _globalStyle,\n      ),\n    [_globalStyle],\n  );\n  const handleCollapse = (id: string, collapsed: boolean) => {\n    setTreeMap({\n      ...treeMap,\n      [id]: {\n        ...treeMap[id],\n        isCollapsed: collapsed,\n      },\n    });\n    onCollapseChange?.(id);\n  };\n\n  useEffect(() => {\n    setTreeMap(geSpanNodeInfoMap(spanNodes));\n  }, [spanNodes]);\n\n  useEffect(() => {\n    if (spanNodes) {\n      const treeNodes = spanNode2TreeNode(spanNodes, treeMap, {\n        renderGraphNodeConfig,\n        showKeyNodeOnly: false,\n      });\n      setTreeData(treeNodes);\n    }\n  }, [treeMap]);\n\n  return (\n    <traceTreeContext.Provider\n      value={{\n        treeMap,\n        onCollapse: handleCollapse,\n      }}\n    >\n      <div className={styles['trace-tree-layout']}>\n        <div\n          className={clsx(\n            styles['trace-trees-wrapper'],\n            'trace-trees-scroll-ref',\n          )}\n        >\n          {treeData?.map(tree => (\n            <Tree\n              key={tree.key}\n              className={clsx(\n                styles['trace-tree'],\n                styles['trace-graph-panel-content-trace-tree'],\n              )}\n              treeData={tree}\n              selectedKey={selectedSpanId}\n              indentDisabled={indentDisabled}\n              lineStyle={lineStyle}\n              globalStyle={globalStyle}\n              {...restProps}\n            />\n          ))}\n        </div>\n      </div>\n    </traceTreeContext.Provider>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  type GlobalStyle,\n  type RectStyle,\n  type LabelStyle,\n  type LabelText,\n} from './typing';\n\nexport const defaultRectStyle: RectStyle = {\n  normal: {\n    fill: '#F7F7FA',\n    stroke: '#1D1C2314',\n    lineWidth: 1,\n    // lineDash: [4, 2],\n    lineDash: [],\n  },\n  hover: {\n    // fill: \"#6690F2\",\n    // stroke: \"#000\",\n    lineWidth: 1,\n    lineDash: [],\n  },\n  select: {\n    lineWidth: 1,\n    lineDash: [],\n  },\n};\n\nexport const defaultGlobalStyle: GlobalStyle = {\n  height: '100%',\n  width: '100%',\n  // padding: {\n  //   top: 50,\n  //   right: 60,\n  //   bottom: 80,\n  //   left: 60,\n  // },\n  // padding: {\n  //   top: 30,\n  //   right: 0,\n  //   bottom: 0,\n  //   left: 0,\n  // },\n  padding: {\n    top: 0,\n    right: 24,\n    bottom: 24,\n    left: 0,\n  },\n};\n\nexport const defaultDatazoomDecimals = 1;\n\nexport const defaultVisibleRowCount = 6;\nexport const defaultRowHeight = 42;\nexport const defaultVisibleColumnCount = 6; // 13 // 8\n\nexport const defaultLabelStyle: LabelStyle = {\n  position: 'inside-left',\n  fontSize: 12,\n  fill: '#212629',\n};\n\nexport const defaultLabelText: LabelText = (datum, element, params) =>\n  `${datum.start}-${datum.end}`;\n\n// padding of xScale (solve the problem of rect border being truncated after hover)\nexport const scrollbarMargin = 10;\nexport const datazoomHeight = 20;\nexport const datazoomDecimals = 0;\nexport const datazoomPaddingBottom = 18;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines */\n/* eslint-disable max-lines-per-function */\n\nimport {\n  useRef,\n  useEffect,\n  type FC,\n  useMemo,\n  useCallback,\n  useLayoutEffect,\n  useState,\n} from 'react';\n\nimport { pick, uniqWith } from 'lodash-es';\nimport {\n  View,\n  type ViewSpec,\n  ComponentEnum,\n  GrammarMarkType,\n  type GrammarScaleType,\n  type MarkSpec,\n  type IView,\n} from '@visactor/vgrammar';\n\nimport type {\n  FlamethreadProps,\n  RectNode,\n  RectStyle,\n  LabelStyle,\n  LabelText,\n  Tooltip,\n  IElement,\n  GlobalStyle,\n  InteractionEventHandler,\n} from './typing';\nimport {\n  datazoomDecimals,\n  datazoomHeight,\n  datazoomPaddingBottom,\n  defaultGlobalStyle,\n  defaultLabelStyle,\n  defaultLabelText,\n  defaultRectStyle,\n  defaultRowHeight,\n  defaultVisibleColumnCount,\n  scrollbarMargin,\n} from './config';\n\nimport styles from './index.module.less';\nexport type {\n  FlamethreadProps,\n  RectNode,\n  RectStyle,\n  LabelStyle,\n  LabelText,\n  Tooltip,\n  IElement,\n  GlobalStyle,\n  InteractionEventHandler,\n};\n\nexport const Flamethread: FC<FlamethreadProps> = props => {\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const viewRef = useRef<IView | null>(null);\n  const [viewSize, setViewSize] = useState({ width: 0, height: 0 });\n  const {\n    flamethreadData,\n    rowHeight = defaultRowHeight,\n    visibleColumnCount = defaultVisibleColumnCount,\n    tooltip,\n    rectStyle: globalRectStyle,\n    labelStyle: _globalLabelStyle,\n    globalStyle: _globalStyle,\n    axisLabelSuffix,\n    labelText,\n    selectedKey,\n    disableViewScroll = false,\n    enableAutoFit = false,\n    onClick,\n  } = props;\n\n  const genRectStyle = useCallback(\n    (rectStyle?: RectStyle): RectStyle => ({\n      normal: Object.assign(\n        {},\n        defaultRectStyle.normal,\n        globalRectStyle?.normal,\n        rectStyle?.normal,\n      ),\n      hover: Object.assign(\n        {},\n        defaultRectStyle.hover,\n        globalRectStyle?.hover,\n        rectStyle?.hover,\n      ),\n      select: Object.assign(\n        {},\n        defaultRectStyle.select,\n        globalRectStyle?.select,\n        rectStyle?.select,\n      ),\n    }),\n    [globalRectStyle],\n  );\n\n  const genLabelStyle = useCallback(\n    (labelStyle?: LabelStyle): LabelStyle =>\n      Object.assign({}, defaultLabelStyle, _globalLabelStyle, labelStyle),\n    [_globalLabelStyle],\n  );\n\n  const globalLabelStyle = useMemo(\n    () => Object.assign({}, defaultLabelStyle, _globalLabelStyle),\n    [_globalLabelStyle],\n  );\n\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers -- calculation required\n  const topOffset = datazoomHeight + datazoomPaddingBottom + 8;\n\n  const globalStyle: GlobalStyle = useMemo(\n    () => Object.assign({}, defaultGlobalStyle, _globalStyle),\n    [_globalStyle],\n  );\n\n  const totalRowHeight = useMemo(() => {\n    const rowCount = uniqWith(\n      flamethreadData,\n      (node0: RectNode, node1: RectNode) => node0.rowNo === node1.rowNo,\n    ).length;\n    return rowCount * rowHeight;\n  }, [flamethreadData]);\n\n  // Meaning of this parameter: Visual Window Height/Flame Map Height\n  const yScaleRangeFactor = useMemo(() => {\n    const rowCount = uniqWith(\n      flamethreadData,\n      (node0: RectNode, node1: RectNode) => node0.rowNo === node1.rowNo,\n    ).length;\n\n    return rowCount !== 0\n      ? ((viewRef.current?.getViewBox().height() || 300) - topOffset) /\n          (rowCount * rowHeight)\n      : 1;\n  }, [flamethreadData, viewSize.height]);\n\n  const spec = useMemo(() => {\n    const orgData = flamethreadData.map(node => {\n      const rectStyle = genRectStyle(node.rectStyle);\n      const labelStyle = genLabelStyle(node.labelStyle);\n      return {\n        ...node,\n        rectStyle,\n        labelStyle,\n      };\n    });\n\n    const marks = [\n      {\n        type: GrammarMarkType.component,\n        componentType: ComponentEnum.axis,\n        id: 'xAxis',\n        scale: 'xScale',\n        axisType: 'line',\n        tickCount: visibleColumnCount,\n        dependency: ['viewBox'],\n        encode: {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          update: (_scale: any, _element: any, params: any) => {\n            const scale = params.xScale;\n            const range = scale.range() as number[];\n            const tickData = scale.tickData(visibleColumnCount);\n            const dx =\n              tickData.length > 1\n                ? // eslint-disable-next-line @typescript-eslint/no-magic-numbers -- calculation required\n                  (range[1] - range[0]) / (tickData.length - 1) / 2\n                : 0;\n\n            return {\n              verticalFactor: -1,\n              x: params.viewBox.x1,\n              y: params.viewBox.y1 + topOffset,\n              start: { x: 0, y: 0 },\n              end: { x: params.viewBox.width(), y: 0 },\n              tick: { visible: false },\n              label: {\n                style: { dx: -dx },\n                formatMethod: (_value: string) => {\n                  const value = Number(_value);\n                  // Specialized logic: hide 0 ticks\n                  if (dx > 0 && value === 0) {\n                    return '';\n                  }\n                  return value !== 0 && axisLabelSuffix !== undefined\n                    ? `${value}${axisLabelSuffix}`\n                    : value;\n                },\n              },\n            };\n          },\n        },\n      },\n      {\n        type: GrammarMarkType.component,\n        componentType: ComponentEnum.grid,\n        tickCount: visibleColumnCount, // The types of the vgrammer library are not strictly written, but are actually usable\n        scale: 'xScale',\n        gridType: 'line',\n        gridShape: 'line',\n        dependency: ['viewBox'],\n        // dependency: [\"viewBox\"],\n        encode: {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          update: (_scale: any, _element: any, params: any) => ({\n            verticalFactor: -1,\n            length: params.viewBox.height() - topOffset,\n            x: params.viewBox.x1,\n            x1: params.viewBox.x2,\n            y: params.viewBox.y1 + topOffset,\n            start: { x: 0, y: 0 },\n            end: { x: params.viewBox.width(), y: 0 },\n            style: { stroke: '#ccc', lineWidth: 1, lineDash: [] },\n          }),\n        },\n      },\n      {\n        type: GrammarMarkType.group,\n        dependency: ['viewBox'],\n        encode: {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          update: (_scale: any, _element: IElement, params: any) => ({\n            x: params.viewBox.x1,\n            y: params.viewBox.y1 + topOffset,\n            width: params.viewBox.width(),\n            height: params.viewBox.height() - topOffset,\n            clip: true,\n          }),\n        },\n\n        marks: [\n          {\n            type: GrammarMarkType.rect,\n            id: 'rect',\n            from: { data: 'orgData' },\n            groupBy: 'start',\n            key: 'rowNo',\n            encode: {\n              update: {\n                x: { scale: 'xScale', field: 'start' },\n                x1: { scale: 'xScale', field: 'end' },\n                y: { scale: 'yScale', field: 'rowNo', band: 0.07 },\n                // height: { scale: 'yScale', band: 0.86 },\n                height: rowHeight - 4,\n                // height: { scale: \"yScale\", band: 0.7, offset: 0.15 },\n                fill: (datum, _element, _params) =>\n                  datum?.rectStyle?.normal?.fill,\n                innerBorder: (datum, _element, _params) => {\n                  const { stroke, lineWidth, lineDash } =\n                    datum.rectStyle.normal;\n                  return {\n                    stroke: lineWidth !== 0 ? stroke : null,\n                    lineWidth,\n                    lineDash,\n                    visible: true,\n                    // eslint-disable-next-line @typescript-eslint/no-magic-numbers -- size calculation, no processing required\n                    distance: lineWidth / 2,\n                  };\n                },\n              },\n              hover2: {\n                fill: (datum, _element, _params) =>\n                  datum?.rectStyle?.hover?.fill ??\n                  datum?.rectStyle?.normal?.fill,\n                innerBorder: (datum, _element, _params) => {\n                  const { stroke, lineWidth, lineDash } = Object.assign(\n                    {},\n                    datum?.rectStyle?.normal,\n                    datum?.rectStyle?.hover,\n                  );\n                  return {\n                    stroke: lineWidth !== 0 ? stroke : null,\n                    lineWidth,\n                    lineDash,\n                    visible: true,\n                    // eslint-disable-next-line @typescript-eslint/no-magic-numbers -- size calculation, no need to define constants\n                    distance: lineWidth / 2,\n                  };\n                },\n                zIndex: 2,\n              },\n              select2: {\n                fill: (datum, _element, _params) =>\n                  datum?.rectStyle?.select?.fill ??\n                  datum?.rectStyle?.normal?.fill,\n                innerBorder: (datum, _element, _params) => {\n                  const { stroke, lineWidth, lineDash } = Object.assign(\n                    {},\n                    datum?.rectStyle?.normal,\n                    datum?.rectStyle?.select,\n                  );\n                  return {\n                    stroke: lineWidth !== 0 ? stroke : null,\n                    lineWidth,\n                    lineDash,\n                    visible: true,\n                    // eslint-disable-next-line @typescript-eslint/no-magic-numbers -- size calculation, no need to define constants\n                    distance: lineWidth / 2,\n                  };\n                },\n                zIndex: 1,\n              },\n            },\n          },\n          {\n            type: GrammarMarkType.component,\n            componentType: ComponentEnum.label,\n            target: 'rect',\n            labelStyle: {\n              position: globalLabelStyle.position,\n              textStyle: {\n                fontSize: globalLabelStyle.fontSize,\n              },\n              animation: false,\n              overlap: {\n                hideOnHit: false,\n                clampForce: false,\n                strategy: [{ type: 'position', position: ['top-left'] }],\n              },\n            },\n            encode: {\n              update: {\n                pickable: false, // The types of the vgrammer library are not strictly written, but are actually usable\n                text: labelText ?? defaultLabelText,\n                fill: (datum, _element, _params) => datum?.labelStyle.fill,\n              },\n            },\n          },\n        ],\n      },\n\n      {\n        type: GrammarMarkType.component,\n        componentType: ComponentEnum.datazoom,\n        id: 'dataZoom',\n        dependency: ['viewBox'],\n        preview: {\n          data: 'table',\n          x: { scale: 'dataZoomXScale', field: ['start', 'end'] },\n          y: { scale: 'dataZoomYScale', field: 'rowNo' },\n        },\n        encode: {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          update: (_scale: any, _element: any, params: any) => ({\n            showDetail: false,\n            x: params.viewBox.x1,\n            y: params.viewBox.y1,\n            size: { width: params.viewBox.width(), height: datazoomHeight },\n            // start: 0,\n            // end: 1,\n            // fill: '#ff0000',\n            minSpan: 0.01,\n            selectedBackgroundStyle: {\n              fill: '#B4BAF6',\n            },\n            brushSelect: false,\n            startHandlerStyle: {\n              symbolType:\n                'M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\\nC0.3-1.4,0.3-1.4,0.3-1.4z;',\n              fill: '#ffffff',\n              scaleX: 1.2,\n              scaleY: 1.2,\n              stroke: '#aeb5be',\n              lineWidth: 1,\n              size: 20,\n            },\n            middleHandlerStyle: {\n              visible: false,\n            },\n            endHandlerStyle: {\n              symbolType:\n                'M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\\nC0.3-1.4,0.3-1.4,0.3-1.4z;',\n              fill: '#ffffff',\n              scaleX: 1.2,\n              scaleY: 1.2,\n              stroke: '#aeb5be',\n              lineWidth: 1,\n              size: 20,\n            },\n            startTextStyle: {\n              padding: 8,\n              textStyle: {\n                fontSize: 12,\n                lineHeight: '130%',\n                fill: '#606773',\n                // fill: '#ff0000',\n              },\n              formatMethod: (value: number) => value.toFixed(datazoomDecimals),\n            },\n            endTextStyle: {\n              padding: 8,\n              textStyle: {\n                fontSize: 12,\n                lineHeight: '130%',\n                fill: '#606773',\n              },\n              formatMethod: (value: number) => value.toFixed(datazoomDecimals),\n            },\n          }),\n        },\n      },\n    ] as MarkSpec[];\n\n    const padding = {\n      top: 3,\n      right: 0,\n      bottom: 0,\n      left: 0,\n    };\n\n    if (yScaleRangeFactor < 1) {\n      marks.unshift({\n        type: GrammarMarkType.component,\n        componentType: ComponentEnum.scrollbar,\n        direction: 'vertical',\n        id: 'verticalScrollbar',\n        dependency: ['viewBox', 'yScale'],\n        encode: {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          update: (_scale: any, _element: any, params: any) => {\n            const { yScale } = params;\n            const curRangeFactor = yScale?.rangeFactor?.() ?? [\n              0,\n              yScaleRangeFactor,\n            ];\n\n            return {\n              x: params.viewBox.x2 + scrollbarMargin,\n              y: params.viewBox.y1 + topOffset,\n              height: params.viewBox.height() - topOffset,\n              range: [curRangeFactor[1], curRangeFactor[0]],\n            };\n          },\n        },\n      });\n      padding.right = 22;\n    }\n\n    const spec0: ViewSpec = {\n      padding,\n      background: globalStyle.background,\n\n      data: [\n        {\n          id: 'orgData',\n          values: orgData,\n        },\n        {\n          id: 'markData',\n          source: 'orgData',\n        },\n      ],\n\n      scales: [\n        {\n          id: 'xScale',\n          type: 'linear' as GrammarScaleType,\n          domain: { data: 'markData', field: ['start', 'end'] },\n          dependency: ['viewBox'],\n          range: (_scale, params) => [0, params.viewBox.width()],\n          nice: true,\n        },\n        {\n          id: 'yScale',\n          type: 'band',\n          domain: { data: 'markData', field: 'rowNo' },\n          dependency: ['viewBox'],\n          range: (_scale, params) => {\n            const vHeight = params.viewBox.height() - topOffset;\n            const height = yScaleRangeFactor <= 1 ? vHeight : totalRowHeight;\n\n            return [0, height];\n          },\n          padding: 0,\n          round: false,\n        },\n        {\n          id: 'dataZoomXScale',\n          type: 'linear',\n          domain: { data: 'orgData', field: ['start', 'end'] },\n          dependency: ['viewBox'],\n          range: (_scale, params) => [0, params.viewBox.width()],\n        },\n        {\n          id: 'dataZoomYScale',\n          type: 'band',\n          domain: { data: 'orgData', field: 'rowNo' },\n          dependency: ['viewBox'],\n          range: (_scale, params) => [params.viewBox.height(), 0],\n          padding: 0.05,\n          round: true,\n        },\n      ],\n\n      marks,\n    };\n    return spec0;\n  }, [\n    flamethreadData,\n    visibleColumnCount,\n    globalLabelStyle.position,\n    globalLabelStyle.fontSize,\n    labelText,\n    yScaleRangeFactor,\n    totalRowHeight,\n    globalStyle.padding,\n    globalStyle.background,\n    genRectStyle,\n    genLabelStyle,\n    axisLabelSuffix,\n  ]);\n\n  const updateSelectedKey = useCallback(\n    (view: IView) => {\n      const rectElm = view?.getMarkById('rect');\n      const elements = rectElm?.elements;\n      elements?.forEach(element => {\n        element?.removeState('select2');\n      });\n      elements\n        ?.filter(element => {\n          const datum = element.getDatum();\n          return datum.key === selectedKey;\n        })[0]\n        ?.addState('select2');\n    },\n    [selectedKey],\n  );\n\n  // Create/update view\n  useLayoutEffect(() => {\n    const initializeYScale = (view: IView) => {\n      const yScale = view?.getScaleById('yScale');\n      yScale?.setRangeFactor([0, yScaleRangeFactor]);\n      yScale?.commit();\n    };\n\n    const initializeScale = (view: IView) => {\n      initializeYScale(view);\n    };\n\n    const registerEvent = (view: IView) => {\n      const rectElm = view?.getMarkById('rect');\n      // Rect click event\n      rectElm?.addEventListener('click', ((event, element) => {\n        onClick?.(event, element);\n      }) as InteractionEventHandler);\n\n      rectElm?.addEventListener('touchstart', ((event, element) => {\n        onClick?.(event, element);\n      }) as InteractionEventHandler);\n\n      // Rect hover highlight\n      view?.interaction('element-highlight', {\n        selector: 'rect',\n        highlightState: 'hover2',\n      });\n\n      view?.interaction('element-highlight', {\n        trigger: 'click',\n        // triggerOff: \"view:click\",\n        triggerOff: 'swipe',\n        selector: 'rect',\n        highlightState: 'select2',\n      });\n\n      if (!disableViewScroll) {\n        view.interaction('view-scroll', {\n          scaleY: 'yScale',\n        });\n      }\n\n      // Rect hover tooltip\n      if (tooltip) {\n        view?.interaction('tooltip', {\n          selector: 'rect',\n          ...tooltip,\n        });\n      }\n    };\n\n    if (containerRef.current && !viewRef.current) {\n      const view = new View({\n        autoFit: enableAutoFit,\n        container: containerRef.current,\n      });\n\n      view?.on('change', (...args) => {\n        const event = args[0];\n        const { start, end } = event.detail;\n        const xScale = view.getScaleById('xScale');\n        xScale?.setRangeFactor([start, end]);\n        xScale?.commit();\n        view?.run();\n      });\n\n      view?.on('scrollDrag', e => {\n        const direction = e?.target?.attribute?.direction;\n        if (direction === 'vertical') {\n          const range = e.detail.value;\n          const yScale = view.getScaleById('yScale');\n          yScale?.setRangeFactor(range);\n          yScale?.commit();\n          view.run();\n        }\n      });\n\n      view.parseSpec(spec);\n      initializeScale(view);\n      registerEvent(view);\n      view.run();\n      updateSelectedKey(view);\n\n      view.run();\n\n      viewRef.current = view;\n    } else if (viewRef.current) {\n      const view = viewRef.current;\n\n      view.updateSpec(spec);\n      initializeScale(view);\n      registerEvent(view);\n      view.run({ reuse: false });\n      updateSelectedKey(view);\n\n      view.run();\n    }\n  }, [\n    spec,\n    tooltip,\n    yScaleRangeFactor,\n    // onClick,\n    visibleColumnCount,\n    flamethreadData,\n  ]);\n\n  useEffect(() => {\n    if (viewRef.current) {\n      updateSelectedKey(viewRef.current);\n    }\n  }, [selectedKey]);\n\n  useEffect(\n    () => () => {\n      if (viewRef.current) {\n        viewRef.current.release();\n      }\n      viewRef.current = null;\n    },\n    [],\n  );\n\n  useEffect(() => {\n    const resizeObserver = new ResizeObserver(params => {\n      const width = params[0].target.clientWidth;\n      const height = params[0].target.clientHeight;\n      if (width !== undefined && height !== undefined && viewRef.current) {\n        viewRef.current.resize(width, height);\n        setViewSize({\n          width,\n          height,\n        });\n      }\n    });\n\n    if (containerRef.current) {\n      resizeObserver.observe(containerRef.current);\n    }\n  }, []);\n\n  return (\n    <div\n      className={styles['flame-thread-canvas-wrapper']}\n      style={{\n        ...pick(globalStyle, ['width', 'height']),\n        overflow: 'hidden',\n      }}\n      ref={containerRef}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { useMemoizedFn } from 'ahooks';\n\nimport { spanData2flamethreadData } from '../utils/graph';\nimport { type SpanNode, type TraceFlamethreadProps } from '../typings/graph';\nimport {\n  FLAME_THREAD_DEFAULT_CONFIG,\n  FLAME_THREAD_DEFAULT_TOOLTIP_STYLE,\n} from '../consts/graph';\nimport {\n  Flamethread,\n  type RectStyle,\n  type RectNode,\n  type Tooltip,\n  type LabelText,\n} from '../common/flamethread';\n\nexport const TraceFlameThread = (props: TraceFlamethreadProps) => {\n  const [flamethreadData, setFlamethreadData] = useState<RectNode[]>([]);\n\n  const {\n    spans,\n    selectedSpanId,\n    rectStyle: _rectStyle,\n    labelStyle: _labelStyle,\n    globalStyle: _globalStyle,\n    visibleColumnCount,\n    datazoomDecimals = FLAME_THREAD_DEFAULT_CONFIG.datazoomDecimals,\n    axisLabelSuffix,\n    disableViewScroll,\n    enableAutoFit,\n    onClick,\n    renderGraphNodeConfig,\n  } = props;\n\n  const { traceFlamethreadCustomRenderer, customTypeConfigMap } =\n    renderGraphNodeConfig || {};\n\n  useEffect(() => {\n    const rectNodes = spanData2flamethreadData(spans, customTypeConfigMap);\n    setFlamethreadData(rectNodes);\n  }, [spans]);\n\n  const rectStyle = useMemo((): RectStyle => {\n    const defaultRectStyle = FLAME_THREAD_DEFAULT_CONFIG.rectStyle;\n    return {\n      normal: Object.assign({}, defaultRectStyle?.normal, _rectStyle?.normal),\n      hover: Object.assign({}, defaultRectStyle?.hover, _rectStyle?.hover),\n      select: Object.assign({}, defaultRectStyle?.select, _rectStyle?.select),\n    };\n  }, [_rectStyle]);\n\n  const labelStyle = useMemo(\n    () =>\n      Object.assign({}, _labelStyle, FLAME_THREAD_DEFAULT_CONFIG.labelStyle),\n    [_labelStyle],\n  );\n\n  const globalStyle = useMemo(\n    () =>\n      Object.assign({}, _globalStyle, FLAME_THREAD_DEFAULT_CONFIG.globalStyle),\n    [_globalStyle],\n  );\n\n  const tooltip: Tooltip = useMemo(\n    () => ({\n      title: {\n        value: () => ({}),\n      },\n      content: (datum: RectNode) => {\n        const { span } = (datum.extra ?? {}) as { span: SpanNode };\n        if (!span) {\n          return [];\n        }\n\n        const tips =\n          traceFlamethreadCustomRenderer?.renderTooltip?.(span) ?? [];\n\n        return tips.map(({ key, value, fill }) => ({\n          key: {\n            text: key,\n            fill: fill ?? FLAME_THREAD_DEFAULT_TOOLTIP_STYLE.fill,\n          },\n          value: {\n            text: value ?? '',\n            fill: fill ?? FLAME_THREAD_DEFAULT_TOOLTIP_STYLE.fill,\n          },\n          shape: FLAME_THREAD_DEFAULT_TOOLTIP_STYLE.shape,\n        }));\n      },\n    }),\n    [traceFlamethreadCustomRenderer],\n  );\n\n  const labelText: LabelText = useMemoizedFn((datum: RectNode) => {\n    const { span } = (datum.extra ?? {}) as { span: SpanNode };\n    return span.name ?? '';\n  });\n\n  return flamethreadData ? (\n    <Flamethread\n      flamethreadData={flamethreadData}\n      tooltip={tooltip}\n      rectStyle={rectStyle}\n      labelStyle={labelStyle}\n      globalStyle={globalStyle}\n      labelText={labelText}\n      datazoomDecimals={datazoomDecimals}\n      visibleColumnCount={visibleColumnCount}\n      axisLabelSuffix={axisLabelSuffix}\n      selectedKey={selectedSpanId}\n      disableViewScroll={disableViewScroll}\n      enableAutoFit={enableAutoFit}\n      onClick={onClick}\n    />\n  ) : null;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport JSONBig from 'json-bigint';\nimport dayjs from 'dayjs';\n\nconst jsonBig = JSONBig({ storeAsString: true });\nexport const textWithFallback = (text?: string | number) =>\n  text && text !== '' ? text.toString() : '-';\n\nexport const formatTime = (timestamp?: number | string) =>\n  dayjs(Number(timestamp)).format('YYYY-MM-DD HH:mm:ss.SSS');\n\nexport const isJsonString = (str: string) => {\n  try {\n    const jsonData = JSON.parse(str);\n    if (\n      Object.prototype.toString.call(jsonData) !== '[object Object]' &&\n      Object.prototype.toString.call(jsonData) !== '[object Array]'\n    ) {\n      return false;\n    }\n  } catch (error) {\n    return false;\n  }\n  return true;\n};\n\nexport const jsonParseWithBigNumber = (jsonString: string) =>\n  JSON.parse(JSON.stringify(jsonBig.parse(jsonString)));\n\nexport const jsonParse = (\n  jsonString: string,\n): Record<string, unknown> | string => {\n  if (isJsonString(jsonString)) {\n    return jsonParseWithBigNumber(jsonString);\n  } else {\n    return jsonString;\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isString } from 'lodash-es';\nimport {\n  JsonViewer,\n  type JsonViewerProps,\n  type Path,\n} from '@textea/json-viewer';\n\nconst objectToCopyableString = (value: any): string => {\n  if (isString(value)) {\n    return value;\n  }\n  try {\n    return JSON.stringify(value, null, 4);\n  } catch (_err) {\n    return String(value);\n  }\n};\n\nexport const CustomJsonViewer = <T,>(props: JsonViewerProps<T>) => {\n  const { onCopy } = props;\n  return (\n    <JsonViewer\n      style={{\n        whiteSpace: 'pre-wrap',\n        fontSize: '12px',\n      }}\n      rootName={false}\n      {...props}\n      onCopy={(\n        _path: Path,\n        value: unknown,\n        copy: (value: string) => Promise<void>,\n      ) => {\n        copy(objectToCopyableString(value));\n        onCopy?.(_path, objectToCopyableString(value), copy);\n      }}\n    />\n  );\n};\nexport type { JsonViewerProps };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconCozCopy, IconCozCopyCheck } from '@coze-arch/coze-design/icons';\nimport { Typography } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\nconst { Text } = Typography;\n\ninterface MessageTitleProps {\n  text: string;\n  copyContent?: string;\n  description?: string;\n  onCopyClick?: (text: string) => void;\n}\n\nexport const MessageTitle = (props: MessageTitleProps) => {\n  const { text, copyContent, description, onCopyClick } = props;\n\n  return (\n    <div className={styles['message-title']}>\n      <Text\n        className={styles['message-title-text']}\n        copyable={\n          copyContent\n            ? {\n                content: copyContent,\n                icon: <IconCozCopy className={styles['copy-icon']} />,\n                successTip: <IconCozCopyCheck />,\n                onCopy: () => onCopyClick?.(copyContent),\n              }\n            : false\n        }\n      >\n        {text}\n      </Text>\n      {description ? (\n        <div className={styles['node-detail-title-description']}>\n          {description}\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// import ReactJson from 'react-json-view';\n\nimport { type CSSProperties } from 'react';\n\nimport { clsx } from 'clsx';\n\nimport { jsonParse, textWithFallback } from '../utils';\nimport { type I18nMapping } from '../typings/basic';\nimport { CustomJsonViewer, type JsonViewerProps } from '../custom-json-viewer';\nimport { type ObservationModules } from '../consts';\nimport { MessageTitle } from '../common/message-title';\n\nimport styles from './index.module.less';\n\nexport interface MessagePanelProps {\n  content: string;\n  category: ObservationModules;\n  i18nMapping: I18nMapping;\n  className?: string;\n  isError?: boolean;\n  onCopyClick?: (text: string) => void;\n  panelStyle?: CSSProperties;\n  encrypted?: boolean;\n  jsonViewerProps?: Partial<JsonViewerProps<Record<string, unknown> | string>>;\n}\n\nexport const MessagePanel = (props: MessagePanelProps) => {\n  const {\n    content,\n    category,\n    i18nMapping,\n    isError,\n    onCopyClick,\n    panelStyle,\n    encrypted,\n    jsonViewerProps = {},\n  } = props;\n  const i18nInfo = i18nMapping[category];\n  const inputValue = jsonParse(textWithFallback(content));\n\n  return (\n    <>\n      <MessageTitle\n        text={i18nInfo?.title ?? ''}\n        copyContent={\n          encrypted\n            ? ''\n            : typeof inputValue === 'string'\n            ? inputValue\n            : JSON.stringify(inputValue)\n        }\n        onCopyClick={onCopyClick}\n      />\n      {encrypted ? (\n        <div className={styles.encryption}>\n          <span></span>\n          <span className={styles['encryption-tip']}>\n            \n          </span>\n        </div>\n      ) : (\n        <div\n          className={clsx(\n            styles['message-panel-content'],\n            isError && styles['message-panel-content_error'],\n          )}\n          style={panelStyle}\n        >\n          {typeof inputValue === 'string' ? (\n            <div className={styles['message-panel-content-detail-text']}>\n              {inputValue}\n            </div>\n          ) : (\n            <div className={styles['message-panel-content-json-container']}>\n              <CustomJsonViewer\n                {...jsonViewerProps}\n                className={styles.content}\n                value={inputValue}\n                defaultInspectDepth={5}\n                onCopy={(_, txt) => onCopyClick?.(txt as string)}\n              />\n            </div>\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useMemo, useContext } from 'react';\n\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport { shallow } from 'zustand/shallow';\nimport { type Span } from '@coze-arch/bot-api/workflow_api';\n\nexport interface TraceListState {\n  spaceId: string;\n  workflowId: string;\n  isInOp?: boolean;\n  /** When opening it for the first time, you need to request the list first, and then select the first item. */\n  ready: boolean;\n  /** Currently selected span */\n  span: Span | null;\n}\n\nexport interface TraceListAction {\n  /** update status */\n  patch: (next: Partial<TraceListState>) => void;\n}\n\nconst createTraceListStore = (\n  params: Pick<TraceListState, 'spaceId' | 'workflowId' | 'isInOp'>,\n) =>\n  createWithEqualityFn<TraceListState & TraceListAction>(\n    set => ({\n      ...params,\n      ready: false,\n      span: null,\n      patch: next => set(() => next),\n    }),\n    shallow,\n  );\n\ntype TraceListStore = ReturnType<typeof createTraceListStore>;\n\nexport const TraceListContext = createContext<TraceListStore>(\n  {} as unknown as TraceListStore,\n);\n\nexport const TraceListProvider: React.FC<\n  React.PropsWithChildren<\n    Pick<TraceListState, 'spaceId' | 'workflowId' | 'isInOp'>\n  >\n> = ({ spaceId, workflowId, isInOp, children }) => {\n  const store = useMemo(\n    () => createTraceListStore({ spaceId, workflowId, isInOp }),\n    [spaceId, workflowId, isInOp],\n  );\n\n  return (\n    <TraceListContext.Provider value={store}>\n      {children}\n    </TraceListContext.Provider>\n  );\n};\n\nexport const useTraceListStore = <T,>(\n  selector: (s: TraceListState & TraceListAction) => T,\n) => {\n  const store = useContext(TraceListContext);\n\n  return store(selector);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useState } from 'react';\n\nimport dayjs from 'dayjs';\nimport { useMemoizedFn } from 'ahooks';\nimport { workflowApi } from '@coze-workflow/base';\nimport { type TraceFrontendSpan } from '@coze-arch/bot-api/workflow_api';\n\nimport { sortSpans } from '../../utils';\nimport { useTraceListStore } from '../../contexts';\nimport { MAX_TRACE_TIME } from '../../constants';\n\nexport const useTrace = () => {\n  const [loading, setLoading] = useState(false);\n  const [spans, setSpans] = useState<TraceFrontendSpan[] | null>(null);\n\n  const { span } = useTraceListStore(store => ({\n    span: store.span,\n  }));\n\n  const fetch = useMemoizedFn(async (logId: string) => {\n    setLoading(true);\n    /** When querying the log, the start and end time must be passed. Since the user can check the range within 7 days, he can directly fake the 7-day time interval. */\n    const now = dayjs().endOf('day').valueOf();\n    const end = dayjs()\n      .subtract(MAX_TRACE_TIME, 'day')\n      .startOf('day')\n      .valueOf();\n\n    try {\n      const { data } = await workflowApi.GetTraceSDK({\n        log_id: logId,\n        start_at: end,\n        end_at: now,\n      });\n      if (!data || !data.spans) {\n        return;\n      }\n      const next = sortSpans(data.spans);\n      setSpans(next);\n    } finally {\n      setLoading(false);\n    }\n  });\n\n  useEffect(() => {\n    if (span?.log_id) {\n      fetch(span.log_id);\n    }\n  }, [span, fetch]);\n\n  return { spans, loading };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconCozIllusEmpty } from '@coze-arch/coze-design/illustrations';\nimport { Spin } from '@coze-arch/coze-design';\n\nimport css from './template.module.less';\n\nexport const EmptyTemplate = () => (\n  <div className={css['full-template']}>\n    <IconCozIllusEmpty width=\"100px\" height=\"100px\" />\n  </div>\n);\n\nexport const LoadingTemplate = () => (\n  <div className={css['full-template']}>\n    <Spin />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isUndefined } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { Table } from '@coze-arch/coze-design';\nimport { type TraceFrontendSpan } from '@coze-arch/bot-api/workflow_api';\n\nimport { formatDuration, getTokensFromSpan } from '../../utils';\n\nimport css from './table.module.less';\n\ninterface TraceTableProps {\n  spans: TraceFrontendSpan[];\n}\n\nexport const TraceTable: React.FC<TraceTableProps> = ({ spans }) => {\n  const columns = [\n    {\n      title: I18n.t('platfrom_trigger_creat_name'),\n      dataIndex: 'name',\n    },\n    {\n      title: I18n.t('debug_asyn_task_task_status'),\n      dataIndex: 'status_code',\n      render: data =>\n        data === 0\n          ? I18n.t('debug_asyn_task_task_status_success')\n          : I18n.t('debug_asyn_task_task_status_failed'),\n      width: 78,\n    },\n    {\n      title: I18n.t('analytic_query_table_title_tokens'),\n      render: (_, row) => {\n        const v = getTokensFromSpan(row);\n        return isUndefined(v) ? '-' : v;\n      },\n      width: 78,\n    },\n    {\n      title: I18n.t('db_add_table_field_type_time'),\n      dataIndex: 'duration',\n      render: formatDuration,\n      width: 78,\n    },\n  ];\n\n  return (\n    <div className={css['trace-table']}>\n      <Table\n        tableProps={{\n          dataSource: spans,\n          rowKey: 'span_id',\n          columns,\n          size: 'small',\n        }}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, useState } from 'react';\n\nimport { clsx } from 'clsx';\nimport { gotoDebugFlow } from '@coze-workflow/test-run-shared';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  type Span,\n  type TraceFrontendSpan,\n} from '@coze-arch/bot-api/workflow_api';\nimport { IconCozExit } from '@coze-arch/coze-design/icons';\nimport { Typography, Select, IconButton } from '@coze-arch/coze-design';\n\nimport { FocusButton } from '../focus-button';\nimport { getGotoNodeParams } from '../../utils';\nimport { type GotoParams } from '../../types';\nimport {\n  TraceTree,\n  TraceFlameThread,\n  spans2SpanNodes,\n} from '../../observation-components';\nimport { useTraceListStore } from '../../contexts';\nimport { TraceChartsMode } from '../../constants';\nimport { useTrace } from './use-trace';\nimport { EmptyTemplate, LoadingTemplate } from './template';\nimport { TraceTable } from './table';\n\nimport css from './graph.module.less';\n\ninterface TraceGraphProps {\n  onOpenDetail: (span: TraceFrontendSpan) => void;\n  onGotoNode: (params: GotoParams) => void;\n}\n\nconst MODE_OPTIONS = [\n  {\n    label: I18n.t('analytic_query_detail_left_panel_flamethread'),\n    value: TraceChartsMode.FlameThread,\n  },\n  {\n    label: I18n.t('Starling_filebox_api_list'),\n    value: TraceChartsMode.Table,\n  },\n];\n\nexport const TraceGraph: React.FC<TraceGraphProps> = ({\n  onOpenDetail,\n  onGotoNode,\n}) => {\n  const [mode, setMode] = useState(TraceChartsMode.FlameThread);\n  const { ready, spaceId, isInOp } = useTraceListStore(store => ({\n    ready: store.ready,\n    spaceId: store.spaceId,\n    isInOp: store.isInOp,\n  }));\n  const { spans, loading } = useTrace();\n\n  const tree = useMemo(() => spans2SpanNodes(spans || ([] as any)), [spans]);\n\n  const handleFocusNode = (span: Span) => {\n    onGotoNode(getGotoNodeParams(span));\n  };\n\n  const jumpToDebugFlow = (span: Span) => {\n    const params = getGotoNodeParams(span);\n    gotoDebugFlow(\n      {\n        ...params,\n        spaceId,\n      },\n      isInOp,\n    );\n  };\n\n  if (!ready || loading) {\n    return <LoadingTemplate />;\n  }\n\n  if (!spans) {\n    return <EmptyTemplate />;\n  }\n\n  return (\n    <div className={css['trace-graph']}>\n      <div className={clsx(css['graph-part'], css['part-tree'])}>\n        <TraceTree\n          spans={tree.roots}\n          renderGraphNodeConfig={{\n            traceTreeCustomRenderer: {\n              renderExtra: span =>\n                span.parent_id && span.parent_id !== '0' ? (\n                  <FocusButton span={span} onClick={handleFocusNode} />\n                ) : (\n                  <IconButton\n                    size=\"mini\"\n                    icon={<IconCozExit />}\n                    onClick={e => {\n                      e.stopPropagation();\n                      jumpToDebugFlow(span);\n                    }}\n                  />\n                ),\n            },\n          }}\n          onSelect={v => {\n            const span = (v.node.extra as any)?.spanNode;\n            if (span) {\n              onOpenDetail(span);\n            }\n          }}\n        />\n      </div>\n      <div className={clsx(css['graph-part'], css['part-chart'])}>\n        <div className={css['trace-charts']}>\n          <div className={css['chart-header']}>\n            <Typography.Text strong fontSize=\"16px\">\n              {I18n.t('store_bot_detail_title_mobile')}\n            </Typography.Text>\n            <Select\n              size=\"small\"\n              className={css['mode-select']}\n              optionList={MODE_OPTIONS}\n              value={mode}\n              onChange={(v: any) => setMode(v)}\n            />\n          </div>\n          <div className={css['chart-content']}>\n            {mode === TraceChartsMode.Table && <TraceTable spans={spans} />}\n            {mode === TraceChartsMode.FlameThread && (\n              <TraceFlameThread spans={spans} />\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable complexity */\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nimport dayjs from 'dayjs';\nimport { useMemoizedFn } from 'ahooks';\nimport { workflowApi } from '@coze-workflow/base';\nimport { SpanStatus, type Span } from '@coze-arch/bot-api/workflow_api';\n\nimport { useTraceListStore } from '../../contexts';\nimport { MAX_TRACE_LENGTH, MAX_TRACE_TIME } from '../../constants';\n\nconst getDefaultDate = (): [Date, Date] => {\n  const end = dayjs().endOf('day').toDate();\n  const start = dayjs()\n    .subtract(MAX_TRACE_TIME - 1, 'day')\n    .startOf('day')\n    .toDate();\n\n  return [start, end];\n};\n\nexport const useOptions = (workflowId: string) => {\n  const [date, setDate] = useState<[Date, Date]>(getDefaultDate());\n  const [status, setStatus] = useState<SpanStatus>(SpanStatus.Unknown);\n  const [options, setOptions] = useState<Span[]>([]);\n\n  const optionsCacheRef = useRef(new Map<string, Span>());\n\n  const { ready, span, patch } = useTraceListStore(store => ({\n    span: store.span,\n    ready: store.ready,\n    patch: store.patch,\n  }));\n\n  const fetch = useMemoizedFn(async () => {\n    const searchParams = new URLSearchParams(location.search);\n    const executeMode = searchParams.get('execute_mode');\n    const executeId = searchParams.get('execute_id');\n\n    const { spans } = await workflowApi.ListRootSpans({\n      workflow_id: workflowId,\n      limit: MAX_TRACE_LENGTH,\n      offset: 0,\n      start_at: date[0].getTime(),\n      end_at: date[1].getTime(),\n      status: status === SpanStatus.Unknown ? undefined : status,\n      execute_mode: executeMode ? Number(executeMode) : undefined,\n    });\n    const next = spans || [];\n    let maybeInitialSpan = next[0];\n    if (executeId && !ready && !span) {\n      try {\n        const { data } = await workflowApi.GetTraceSDK({\n          execute_id: executeId,\n          workflow_id: workflowId,\n          start_at: date[0].getTime(),\n          end_at: date[1].getTime(),\n        });\n        const first = data?.spans?.[0];\n        if (first?.log_id) {\n          maybeInitialSpan = first;\n          const urlSpan = next.find(i => i.log_id === first.log_id);\n          if (!urlSpan) {\n            next.unshift(first);\n          }\n        }\n        // eslint-disable-next-line @coze-arch/no-empty-catch -- no error required\n      } catch {\n        // No error required\n      }\n    }\n    next.forEach(s => {\n      if (s.log_id) {\n        optionsCacheRef.current.set(s.log_id, s);\n      }\n    });\n    setOptions(next);\n    // If it is not initialized, it is initialized once\n    if (!ready && !span && maybeInitialSpan) {\n      patch({ span: maybeInitialSpan });\n    }\n    if (!ready) {\n      patch({ ready: true });\n    }\n  });\n\n  const handleDateChange = useCallback(\n    (next: [Date, Date]) => {\n      const [start, end] = next;\n      // The date selected by the time selector is 0:00 on the day, which needs to be converted to 11:59:59 on the day.\n      setDate([start, dayjs(end).endOf('day').toDate()] as [Date, Date]);\n    },\n    [setDate],\n  );\n\n  useEffect(() => {\n    fetch();\n  }, [date, status, fetch]);\n\n  return {\n    date,\n    status,\n    setStatus,\n    options,\n    optionsCacheRef,\n    fetch,\n    onDateChange: handleDateChange,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozFilter } from '@coze-arch/coze-design/icons';\nimport { Select, IconButton } from '@coze-arch/coze-design';\nimport { SpanStatus } from '@coze-arch/bot-api/workflow_api';\n\ninterface StatusSelectProps {\n  value: SpanStatus;\n  onChange: (v: SpanStatus) => void;\n}\n\nexport const StatusSelect: React.FC<StatusSelectProps> = ({\n  value,\n  onChange,\n}) => {\n  const triggerRender = useCallback(\n    () => (\n      <IconButton icon={<IconCozFilter />} color=\"secondary\" size=\"small\" />\n    ),\n    [],\n  );\n\n  return (\n    <Select\n      value={value}\n      triggerRender={triggerRender}\n      optionList={[\n        {\n          value: SpanStatus.Unknown,\n          label: I18n.t('query_status_all'),\n        },\n        {\n          value: SpanStatus.Fail,\n          label: I18n.t('query_status_failed'),\n        },\n        {\n          value: SpanStatus.Success,\n          label: I18n.t('query_status_completed'),\n        },\n      ]}\n      onChange={onChange as any}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { clsx } from 'clsx';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  IconCozCheckMarkCircleFillPalette,\n  IconCozCrossCircleFillPalette,\n} from '@coze-arch/coze-design/icons';\nimport { Tag } from '@coze-arch/coze-design';\n\ninterface StatusTagProps {\n  status?: number;\n  className?: string;\n  type?: 'normal' | 'icon';\n}\n\nexport const StatusIcon: React.FC<{ status?: number; className?: string }> = ({\n  status,\n  className,\n}) =>\n  status === 0 ? (\n    <IconCozCheckMarkCircleFillPalette\n      className={clsx(className, 'coz-fg-hglt-green')}\n    />\n  ) : (\n    <IconCozCrossCircleFillPalette\n      className={clsx(className, 'coz-fg-hglt-red')}\n    />\n  );\n\nexport const StatusTag: React.FC<StatusTagProps> = ({\n  status,\n  className,\n  type = 'normal',\n}) => {\n  const children = useMemo(() => {\n    if (type === 'icon') {\n      return null;\n    }\n    return status === 0\n      ? I18n.t('debug_asyn_task_task_status_success')\n      : I18n.t('debug_asyn_task_task_status_failed');\n  }, [status, type]);\n\n  return (\n    <Tag\n      prefixIcon={\n        status === 0 ? (\n          <IconCozCheckMarkCircleFillPalette />\n        ) : (\n          <IconCozCrossCircleFillPalette />\n        )\n      }\n      color={status === 0 ? 'green' : 'red'}\n      className={className}\n      size=\"mini\"\n    >\n      {children}\n    </Tag>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { gotoDebugFlow } from '@coze-workflow/test-run-shared';\nimport { I18n } from '@coze-arch/i18n';\nimport { type Span } from '@coze-arch/bot-api/workflow_api';\nimport { IconCozExit } from '@coze-arch/coze-design/icons';\nimport {\n  Typography,\n  Tag,\n  IconButton,\n  type ButtonProps,\n} from '@coze-arch/coze-design';\n\nimport { StatusIcon } from '../status-tag';\nimport {\n  getTimeFromSpan,\n  isTriggerFromSpan,\n  getGotoNodeParams,\n} from '../../utils';\nimport { useTraceListStore } from '../../contexts';\n\nimport css from './select-option.module.less';\n\ninterface SelectOptionProps {\n  span: Span;\n}\n\nexport const SelectOption: React.FC<SelectOptionProps> = ({ span }) => {\n  const time = useMemo(() => getTimeFromSpan(span), [span]);\n  const isTrigger = useMemo(() => isTriggerFromSpan(span), [span]);\n  const { spaceId, isInOp } = useTraceListStore(store => ({\n    spaceId: store.spaceId,\n    isInOp: store.isInOp,\n  }));\n  const jumpToDebugFlow: ButtonProps['onClick'] = e => {\n    e.stopPropagation();\n    const params = getGotoNodeParams(span);\n    gotoDebugFlow(\n      {\n        ...params,\n        spaceId,\n      },\n      isInOp,\n    );\n  };\n\n  return (\n    <div className={css['select-option']}>\n      <div className={css.title}>\n        <StatusIcon status={span.status_code} className={css.icon} />\n        <Typography.Text ellipsis={{ showTooltip: true }}>\n          {time}\n        </Typography.Text>\n      </div>\n      {isTrigger ? (\n        <Tag\n          style={{\n            color: 'var(--coz-fg-hglt)',\n            backgroundColor: 'var(--coz-mg-hglt)',\n          }}\n          size={'mini'}\n        >\n          {I18n.t('workflow_start_trigger_triggername')}\n        </Tag>\n      ) : null}\n      <IconButton\n        size=\"mini\"\n        icon={<IconCozExit />}\n        onClick={jumpToDebugFlow}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport dayjs from 'dayjs';\nimport { IconCozCalendar } from '@coze-arch/coze-design/icons';\nimport {\n  DatePicker as DatePickerCore,\n  type DatePickerProps as DatePickerCoreProps,\n  IconButton,\n} from '@coze-arch/coze-design';\n\ntype DatePickerProps = Pick<DatePickerCoreProps, 'value'> & {\n  onChange: (v: [Date, Date]) => void;\n};\n\nexport const DatePicker: React.FC<DatePickerProps> = ({\n  onChange,\n  ...props\n}) => {\n  const disabledDate = (date?: Date) => {\n    if (!date) {\n      return false;\n    }\n    const current = date.getTime();\n    const end = dayjs().endOf('day').valueOf();\n    const start = dayjs().subtract(6, 'day').startOf('day').valueOf();\n\n    return current < start || current > end;\n  };\n\n  const triggerRender = useCallback(\n    () => (\n      <IconButton icon={<IconCozCalendar />} color=\"secondary\" size=\"small\" />\n    ),\n    [],\n  );\n  const handleChange = (v: any) => {\n    onChange(v);\n  };\n\n  return (\n    <DatePickerCore\n      type=\"dateRange\"\n      triggerRender={triggerRender}\n      disabledDate={disabledDate}\n      onChange={handleChange}\n      {...props}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useMemo } from 'react';\n\nimport { useMemoizedFn } from 'ahooks';\nimport { Select } from '@coze-arch/coze-design';\n\nimport { getTimeFromSpan } from '../../utils';\nimport { useTraceListStore } from '../../contexts';\nimport { useOptions } from './use-options';\nimport { StatusSelect } from './status-select';\nimport { SelectOption } from './select-option';\nimport { DatePicker } from './date-picker';\n\nimport css from './trace-select.module.less';\n\nexport const TraceSelect: React.FC = () => {\n  const { span, workflowId, patch } = useTraceListStore(store => ({\n    span: store.span,\n    workflowId: store.workflowId,\n    patch: store.patch,\n  }));\n\n  const {\n    date,\n    status,\n    setStatus,\n    options,\n    optionsCacheRef,\n    fetch,\n    onDateChange,\n  } = useOptions(workflowId);\n\n  const optionList = useMemo(() => {\n    const temp = options.map(i => ({\n      ...i,\n      value: i.log_id,\n      label: <SelectOption span={i} />,\n    }));\n    return temp;\n  }, [options]);\n\n  const handleChange = useCallback(\n    (v: any) => {\n      patch({\n        span:\n          v && optionsCacheRef.current.has(v)\n            ? optionsCacheRef.current.get(v)\n            : null,\n      });\n    },\n    [optionsCacheRef, patch],\n  );\n\n  const handleDropdownVisibleChange = useMemoizedFn((v: boolean) => {\n    if (v) {\n      fetch();\n    }\n  });\n\n  return (\n    <div className={css['trace-select']}>\n      <div className={css['trace-filter']}>\n        <DatePicker value={date} onChange={onDateChange} />\n        <StatusSelect value={status} onChange={setStatus} />\n      </div>\n\n      <Select\n        className={css['main-select']}\n        optionList={optionList}\n        value={span?.log_id}\n        onChange={handleChange}\n        renderSelectedItem={e => {\n          const current = optionsCacheRef.current.get(e.value);\n          return current ? getTimeFromSpan(current) : '-';\n        }}\n        onDropdownVisibleChange={handleDropdownVisibleChange}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\n\nimport { TraceSelect } from '../trace-select';\n\nimport css from './header.module.less';\n\nexport const TraceListPanelHeader: React.FC = () => (\n  <div className={css['trace-panel-header']}>\n    <div className={css['header-tabs']}>\n      <div className={css['trace-title']}>{I18n.t('debug_btn')}</div>\n    </div>\n    <TraceSelect />\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { BottomPanel } from '@coze-workflow/test-run-shared';\nimport { type TraceFrontendSpan } from '@coze-arch/bot-api/workflow_api';\n\nimport { TraceGraph } from '../trace-graph';\nimport { type GotoParams } from '../../types';\nimport { TraceListProvider } from '../../contexts';\nimport { TraceListPanelHeader } from './header';\n\ninterface TraceListPanelProps {\n  spaceId: string;\n  workflowId: string;\n  maxHeight: number;\n  isInOp?: boolean;\n  onOpenDetail: (span: TraceFrontendSpan) => void;\n  onClose: () => void;\n  onGotoNode: (params: GotoParams) => void;\n}\n\nexport const TraceListPanel: React.FC<TraceListPanelProps> = ({\n  spaceId,\n  workflowId,\n  isInOp,\n  maxHeight,\n  onOpenDetail,\n  onGotoNode,\n  onClose,\n}) => (\n  <TraceListProvider spaceId={spaceId} workflowId={workflowId} isInOp={isInOp}>\n    <BottomPanel\n      header={<TraceListPanelHeader />}\n      height={300}\n      resizable={{\n        min: 300,\n        max: maxHeight,\n      }}\n      onClose={onClose}\n    >\n      <TraceGraph onOpenDetail={onOpenDetail} onGotoNode={onGotoNode} />\n    </BottomPanel>\n  </TraceListProvider>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Divider, Typography } from '@coze-arch/coze-design';\n\nimport styles from './pay-block.module.less';\n\ninterface PayBlockProps {\n  label: string;\n  value: string;\n}\n\nexport const PayBlock: React.FC<PayBlockProps> = ({ label, value }) => (\n  <div className={styles['pay-block']}>\n    <Typography.Text type=\"secondary\" size=\"small\">\n      {label}:\n    </Typography.Text>\n    <Typography.Text strong size=\"small\">\n      {value}\n    </Typography.Text>\n  </div>\n);\n\ninterface PayBlocksProps {\n  options: PayBlockProps[];\n}\n\nexport const PayBlocks: React.FC<PayBlocksProps> = ({ options }) => (\n  <div className={styles['pay-blocks']}>\n    {options.flatMap((item, idx) =>\n      idx < options.length - 1\n        ? [\n            <PayBlock key={item.label} {...item} />,\n            <Divider layout=\"vertical\" margin={4} style={{ height: '10px' }} />,\n          ]\n        : [<PayBlock key={item.label} {...item} />],\n    )}\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { isUndefined } from 'lodash-es';\nimport copy from 'copy-to-clipboard';\nimport { BottomPanel } from '@coze-workflow/test-run-shared';\nimport { I18n } from '@coze-arch/i18n';\nimport { type TraceFrontendSpan } from '@coze-arch/bot-api/workflow_api';\nimport { IconCozCopy } from '@coze-arch/coze-design/icons';\nimport { Divider, IconButton, Toast, Typography } from '@coze-arch/coze-design';\n\nimport { StatusTag } from '../status-tag';\nimport { FocusButton } from '../focus-button';\nimport {\n  formatDuration,\n  getTokensFromSpan,\n  getGotoNodeParams,\n} from '../../utils';\nimport { type GotoParams } from '../../types';\nimport {\n  MessagePanel,\n  ObservationModules,\n  type MessagePanelProps,\n} from '../../observation-components';\nimport { PayBlocks } from './pay-block';\n\nimport styles from './trace-detail-panel.module.less';\n\nconst ResultViewer: React.FC<\n  Omit<MessagePanelProps, 'i18nMapping'>\n> = props => (\n  <MessagePanel\n    {...props}\n    className={styles['json-viewer']}\n    i18nMapping={\n      {\n        [ObservationModules.INPUT]: {\n          title: I18n.t('workflow_detail_node_input'),\n        },\n        [ObservationModules.OUTPUT]: {\n          title: I18n.t('workflow_detail_node_output'),\n        },\n      } as unknown as MessagePanelProps['i18nMapping']\n    }\n  />\n);\n\ninterface TraceDetailPanelProps {\n  span: TraceFrontendSpan;\n  onClose: () => void;\n  onGotoNode: (params: GotoParams) => void;\n}\n\nexport const TraceDetailPanel: React.FC<TraceDetailPanelProps> = ({\n  span,\n  onClose,\n  onGotoNode,\n}) => {\n  const pays = useMemo(() => {\n    const temp = [\n      {\n        label: I18n.t('analytic_query_detail_key_latency'),\n        value: span.duration\n          ? formatDuration(span.duration as unknown as number)\n          : '0ms',\n      },\n    ];\n    const tokens = getTokensFromSpan(span);\n    if (!isUndefined(tokens)) {\n      temp.push({\n        label: I18n.t('analytic_query_table_title_tokens'),\n        value: `${tokens}`,\n      });\n    }\n    return temp;\n  }, [span]);\n\n  const handleCopy = () => {\n    try {\n      copy(span.log_id || '');\n      Toast.success({ content: I18n.t('copy_success'), showClose: false });\n    } catch {\n      Toast.error(I18n.t('copy_failed'));\n    }\n  };\n\n  const handleScroll = () => {\n    onGotoNode(getGotoNodeParams(span));\n  };\n\n  return (\n    <BottomPanel\n      header={I18n.t('workflow_running_results')}\n      onClose={onClose}\n      className={styles['trace-detail-panel']}\n    >\n      <div className={styles['trace-detail']}>\n        <div className={styles['detail-title']}>\n          <Typography.Text strong>{span.alias_name}</Typography.Text>\n          <StatusTag status={span.status_code} />\n          <FocusButton span={span} onClick={handleScroll} />\n        </div>\n        <PayBlocks options={pays} />\n        {span.log_id ? (\n          <div className={styles['log-id']}>\n            <Typography.Text type=\"secondary\" size=\"small\">\n              LogId: {span.log_id}\n            </Typography.Text>\n            <IconButton\n              icon={<IconCozCopy />}\n              size=\"mini\"\n              onClick={handleCopy}\n              color=\"secondary\"\n            />\n          </div>\n        ) : null}\n        <Divider margin={16} />\n        {span.input?.content ? (\n          <ResultViewer\n            content={span.input?.content}\n            category={ObservationModules.INPUT}\n            jsonViewerProps={{\n              displayDataTypes: false,\n            }}\n          />\n        ) : null}\n        {span.output?.content ? (\n          <ResultViewer\n            content={span.output?.content}\n            category={ObservationModules.OUTPUT}\n            jsonViewerProps={{\n              displayDataTypes: false,\n            }}\n          />\n        ) : null}\n      </div>\n    </BottomPanel>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum FileItemStatus {\n  Success = 'success',\n  UploadFail = 'uploadFail',\n  ValidateFail = 'validateFail',\n  Validating = 'validating',\n  Uploading = 'uploading',\n  Wait = 'wait',\n}\n\n// Image types that support preview\nexport const PREVIEW_IMAGE_TYPE = ['jpg', 'jpeg', 'png', 'webp', 'svg'];\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport mime from 'mime-types';\nimport {\n  IconCozFileAudio,\n  IconCozFileCode,\n  IconCozFilePptx,\n  IconCozFileDocx,\n  IconCozFileTxt,\n  IconCozFileZip,\n  IconCozFileXlsx,\n  IconCozFileVideo,\n  IconCozFileOther,\n  IconCozFilePdf,\n  IconCozFileCsv,\n} from '@coze-arch/coze-design/illustrations';\n\nimport { PREVIEW_IMAGE_TYPE } from './constants';\n\nconst codeExtensions = [\n  'js',\n  'jsx',\n  'ts',\n  'tsx',\n  'html',\n  'htm',\n  'css',\n  'scss',\n  'sass',\n  'less',\n  'py',\n  'java',\n  'c',\n  'cpp',\n  'h',\n  'hpp',\n  'cs',\n  'go',\n  'rb',\n  'php',\n  'swift',\n  'kt',\n  'kts',\n  'sql',\n  'pl',\n  'sh',\n  'bash',\n  'rs',\n  'dart',\n  'scala',\n  'yaml',\n  'yml',\n  'json',\n];\n\nfunction isCodeFile(extension: string) {\n  return codeExtensions.includes(extension);\n}\n\nfunction isAudioFile(extension: string) {\n  const mimeType = mime.lookup(extension);\n  return mimeType ? mimeType.startsWith('audio/') : false;\n}\n\nfunction isVideoFile(extension: string) {\n  const mimeType = mime.lookup(extension);\n  return mimeType ? mimeType.startsWith('video/') : false;\n}\n\nconst ICON_MAP = {\n  // ppt\n  ppt: IconCozFilePptx,\n  pptx: IconCozFilePptx,\n  // doc\n  doc: IconCozFileDocx,\n  docx: IconCozFileDocx,\n  pdf: IconCozFilePdf,\n  // txt\n  txt: IconCozFileTxt,\n  // zip\n  zip: IconCozFileZip,\n  rar: IconCozFileZip,\n  // excel\n  xls: IconCozFileXlsx,\n  xlsx: IconCozFileXlsx,\n  csv: IconCozFileCsv,\n  // code\n  code: IconCozFileCode,\n  // video\n  video: IconCozFileVideo,\n  // audio\n  audio: IconCozFileAudio,\n};\n\nexport const getIconByExtension = (extension: string) => {\n  let fileIcon = ICON_MAP[extension] ?? IconCozFileOther;\n  if (isAudioFile(extension)) {\n    fileIcon = ICON_MAP.audio;\n  } else if (isVideoFile(extension)) {\n    fileIcon = ICON_MAP.video;\n  } else if (isCodeFile(extension)) {\n    fileIcon = ICON_MAP.code;\n  }\n\n  return fileIcon;\n};\n\n/** Get filename suffix */\nexport function getFileExtension(name?: string) {\n  if (!name) {\n    return '';\n  }\n  const index = name.lastIndexOf('.');\n  return name.slice(index + 1).toLowerCase();\n}\n\nexport const isImageFile = (name: string) => {\n  const ext = getFileExtension(name);\n  return PREVIEW_IMAGE_TYPE.includes(ext);\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Spin, Image } from '@coze-arch/coze-design';\n\nimport { getIconByExtension, getFileExtension } from './utils';\nimport { FileItemStatus, PREVIEW_IMAGE_TYPE } from './constants';\n\nimport styles from './file-icon.module.less';\n\ninterface FileIconProps {\n  file: {\n    name: string;\n    url?: string;\n    status?: string;\n  };\n  size?: number;\n}\n\nexport const FileIcon = (props: FileIconProps) => {\n  const { size = 20, file } = props;\n\n  const { url, name, status } = file;\n\n  const extension = getFileExtension(name);\n\n  if (status === FileItemStatus.Uploading) {\n    return (\n      <Spin\n        wrapperClassName={styles['file-icon-loading']}\n        style={{ width: size, height: size, lineHeight: `${size}px` }}\n        spinning\n      />\n    );\n  }\n\n  if (PREVIEW_IMAGE_TYPE.includes(extension)) {\n    return (\n      <Image\n        preview={false}\n        className=\"object-contain object-center rounded-sm border-0\"\n        style={{ width: size, height: size }}\n        imgStyle={{ width: size, height: size }}\n        src={url}\n        alt=\"\"\n      />\n    );\n  }\n\n  const Icon = getIconByExtension(extension);\n\n  return <Icon style={{ width: size, height: size, fontSize: size }} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo, forwardRef, useImperativeHandle } from 'react';\n\nimport { useMemoizedFn } from 'ahooks';\nimport {\n  createSchemaField,\n  FormProvider,\n  type ISchema,\n  type JSXComponent,\n} from '@formily/react';\nimport {\n  createForm,\n  onFormValuesChange as innerOnFormValuesChange,\n  type Form,\n} from '@formily/core';\n\nimport {\n  Input,\n  FileUpload,\n  Switch,\n  InputInteger,\n  InputNumber,\n  FormItem,\n  FormSection,\n  VoiceSelect,\n  TextArea,\n  FullInput,\n  InputTime,\n} from '../form-materials';\n\nconst SchemaField = createSchemaField({\n  components: {\n    Input,\n    InputInteger,\n    InputNumber,\n    FormItem,\n    FormSection,\n    FileUpload,\n    Switch,\n    VoiceSelect,\n    TextArea,\n    FullInput,\n    InputTime,\n  },\n});\n\ninterface FormCoreProps {\n  schema: ISchema;\n  components?: Record<string, JSXComponent>;\n  disabled?: boolean;\n  initialValues?: any;\n  onFormValuesChange?: (form: Form) => void;\n}\n\ntype FormCoreRef = Form<any>;\n\nconst FormCore = forwardRef<FormCoreRef, FormCoreProps>(\n  (\n    { schema, components, initialValues, disabled, onFormValuesChange },\n    ref,\n  ) => {\n    const handleFormChange = useMemoizedFn((f: Form) => {\n      onFormValuesChange?.(f);\n    });\n\n    const form = useMemo(\n      () =>\n        createForm({\n          initialValues,\n          disabled,\n          effects() {\n            innerOnFormValuesChange(handleFormChange);\n          },\n        }),\n      [],\n    );\n\n    useImperativeHandle(ref, () => form, [form]);\n\n    return (\n      <FormProvider form={form}>\n        <SchemaField components={components} schema={schema} />\n      </FormProvider>\n    );\n  },\n);\n\nexport type { FormCoreProps, FormCoreRef };\n\nexport { FormCore, SchemaField };\n\nexport default FormCore;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { Suspense, lazy, forwardRef } from 'react';\n\nimport type { FormCoreProps, FormCoreRef } from './form-core';\n\nconst LazyComponent = lazy(async () => await import('./form-core'));\n\nexport const LazyFormCore = forwardRef<FormCoreRef, FormCoreProps>(\n  (props, ref) => (\n    <Suspense fallback={null}>\n      <LazyComponent ref={ref} {...props} />\n    </Suspense>\n  ),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { connect, mapProps } from '@formily/react';\nimport { Input as InputCore } from '@coze-arch/coze-design';\n\nconst InputAdapter = props => <InputCore size=\"small\" {...props} />;\n\nexport const Input = connect(InputAdapter, mapProps({ validateStatus: true }));\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport mime from 'mime-types';\nimport { isNil } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { getFileExtension } from '../file-icon';\nimport { type FileItem } from './types';\nimport { MAX_FILE_SIZE } from './constants';\n\ninterface UploadValidateRule {\n  maxSize?: number;\n  imageSize?: ImageSizeRule;\n  accept?: string;\n  customValidate?: (file: FileItem) => Promise<string | undefined>;\n}\n\n/**\n * Format file size\n * @param bytes file size\n * @Param decimals, default 2 digits\n * @example\n * formatBytes(1024);       // 1KB\n * formatBytes('1024');     // 1KB\n * formatBytes(1234);       // 1.21KB\n * formatBytes(1234, 3);    // 1.205KB\n */\nexport function formatBytes(bytes: number, decimals = 2) {\n  if (bytes === 0) {\n    return '0 Bytes';\n  }\n  const k = 1024,\n    dm = decimals,\n    sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],\n    i = Math.floor(Math.log(bytes) / Math.log(k));\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))}${sizes[i]}`;\n}\n\n/** file size verification  */\nexport const sizeValidate = (\n  size: number,\n  maxSize: number = MAX_FILE_SIZE,\n): string | undefined => {\n  if (maxSize && size > maxSize) {\n    return I18n.t('imageflow_upload_exceed', {\n      size: formatBytes(maxSize),\n    });\n  }\n};\n\nexport interface ImageSizeRule {\n  maxWidth?: number;\n  minWidth?: number;\n  maxHeight?: number;\n  minHeight?: number;\n  aspectRatio?: number;\n}\n\n/**\n * Get the width and height of the image\n */\nexport async function getImageSize(\n  file: FileItem,\n): Promise<{ width: number; height: number }> {\n  const url = URL.createObjectURL(file);\n\n  return new Promise((resolve, reject) => {\n    const img = new window.Image();\n    img.onload = () => {\n      resolve({\n        width: img.naturalWidth,\n        height: img.naturalHeight,\n      });\n    };\n    img.onerror = e => {\n      reject(e);\n    };\n    img.src = url;\n  });\n}\n\n/** image width check  */\n// eslint-disable-next-line complexity\nexport const imageSizeValidate = async (\n  file: FileItem,\n  rule?: ImageSizeRule,\n): Promise<string | undefined> => {\n  const { maxWidth, minWidth, maxHeight, minHeight, aspectRatio } = rule || {};\n\n  // No validation when undefined\n  if (isNil(maxWidth || minWidth || maxHeight || minHeight || aspectRatio)) {\n    return;\n  }\n\n  const { width, height } = await getImageSize(file);\n\n  if (maxWidth && width > maxWidth) {\n    return I18n.t('imageflow_upload_error5', {\n      value: `${maxWidth}px`,\n    });\n  }\n\n  if (minWidth && width < minWidth) {\n    return I18n.t('imageflow_upload_error3', {\n      value: `${minWidth}px`,\n    });\n  }\n\n  if (maxHeight && height > maxHeight) {\n    return I18n.t('imageflow_upload_error4', {\n      value: `${maxHeight}px`,\n    });\n  }\n\n  if (minHeight && height < minHeight) {\n    return I18n.t('imageflow_upload_error2', {\n      value: `${minHeight}px`,\n    });\n  }\n  if (aspectRatio && width / height > aspectRatio) {\n    return I18n.t('imageflow_upload_error1');\n  }\n};\n\nexport const acceptValidate = (fileName: string, accept?: string) => {\n  if (!accept) {\n    return;\n  }\n  const acceptList = accept.split(',');\n\n  const fileExtension = getFileExtension(fileName);\n  const mimeType = mime.lookup(fileExtension);\n\n  // Image/* matches all image types\n  if (acceptList.includes('image/*') && mimeType?.startsWith?.('image/')) {\n    return undefined;\n  }\n\n  if (!acceptList.includes(`.${fileExtension}`)) {\n    return I18n.t('imageflow_upload_error_type', {\n      type: `${acceptList.filter(Boolean).join('/')}`,\n    });\n  }\n};\n\nexport const validate = async (file: FileItem, rules?: UploadValidateRule) => {\n  const { size, name } = file;\n\n  const { maxSize, imageSize, accept, customValidate } = rules || {};\n\n  const validators = [\n    async () => await customValidate?.(file),\n    () => sizeValidate(size, maxSize),\n    async () => await imageSizeValidate(file, imageSize),\n    () => acceptValidate(name, accept),\n  ];\n\n  for await (const validator of validators) {\n    const errorMsg = await validator();\n    if (errorMsg) {\n      return errorMsg;\n    }\n  }\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const MAX_IMAGE_SIZE = 1024 * 1024 * 5;\nexport const MAX_FILE_SIZE = 1024 * 1024 * 20;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable max-lines-per-function */\nimport { useState } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { workflowApi, type ViewVariableType } from '@coze-workflow/base';\nimport { I18n } from '@coze-arch/i18n';\nimport { upLoadFile } from '@coze-arch/bot-utils';\nimport { CustomError } from '@coze-arch/bot-error';\nimport { Toast } from '@coze-arch/coze-design';\n\nimport { FileItemStatus } from '../file-icon';\nimport { validate } from './utils';\nimport { type FileItem } from './types';\nimport { MAX_IMAGE_SIZE, MAX_FILE_SIZE } from './constants';\n\nexport interface UploadConfig {\n  initialValue?: FileItem[];\n  customValidate?: (file: FileItem) => Promise<string | undefined>;\n  timeout?: number;\n  fileType?: 'object' | 'image';\n  multiple?: boolean;\n  maxSize?: number;\n  inputType?: ViewVariableType;\n  accept?: string;\n  maxFileCount?: number;\n}\n\nexport const useUpload = (props?: UploadConfig) => {\n  const {\n    initialValue = [],\n    customValidate,\n    timeout,\n    fileType,\n    multiple = true,\n    maxSize,\n    accept,\n    maxFileCount = 20,\n  } = props || {};\n  const [fileList, setFileList] = useState(initialValue);\n  const isUploading = fileList.some(\n    file => file.status === FileItemStatus.Uploading,\n  );\n\n  const updateFileItemProps = (uid, fileItemProps) => {\n    setFileList(prevList => {\n      const newList = [...prevList];\n      const index = newList.findIndex(item => item.uid === uid);\n      if (index !== -1) {\n        Object.keys(fileItemProps).forEach(key => {\n          newList[index][key] = fileItemProps[key];\n        });\n      }\n\n      return newList;\n    });\n  };\n\n  const uploadFileWithProgress = async file => {\n    let progressTimer;\n\n    try {\n      const doUpload = async () =>\n        await upLoadFile({\n          biz: 'workflow',\n          fileType,\n          file,\n          getProgress: percent => {\n            updateFileItemProps(file.uid, {\n              percent,\n            });\n          },\n        });\n\n      if (timeout) {\n        progressTimer = setTimeout(() => {\n          throw new Error('Upload timed out');\n        }, timeout);\n      }\n\n      const uri = await doUpload();\n\n      if (!uri) {\n        throw new CustomError('normal_error', 'no uri');\n      }\n\n      // Upload complete, clear timeout timer\n      clearTimeout(progressTimer);\n\n      // Add uri and get the url.\n      const { url } = await workflowApi.SignImageURL(\n        {\n          uri,\n        },\n        {\n          __disableErrorToast: true,\n        },\n      );\n\n      if (!url) {\n        throw new Error(I18n.t('imageflow_upload_error'));\n      }\n\n      updateFileItemProps(file.uid, {\n        url,\n        status: FileItemStatus.Success,\n      });\n\n      return url;\n    } catch (error) {\n      updateFileItemProps(file.uid, {\n        validateMessage: error.message || 'upload failed',\n        status: FileItemStatus.ValidateFail,\n      });\n      clearTimeout(progressTimer);\n    }\n  };\n\n  const validateFile = async (file: FileItem): Promise<string | undefined> => {\n    const validateMsg = await validate(file, {\n      customValidate,\n      maxSize: maxSize ?? fileType === 'image' ? MAX_IMAGE_SIZE : MAX_FILE_SIZE,\n      accept,\n    });\n    if (validateMsg) {\n      return validateMsg;\n    }\n  };\n\n  const upload = async (file: FileItem) => {\n    file.status = FileItemStatus.Uploading;\n    if (!file.uid) {\n      file.uid = nanoid();\n    }\n\n    const errorInfo = await validateFile(file);\n\n    if (errorInfo) {\n      Toast.error(errorInfo);\n      return;\n    }\n\n    if (!multiple && fileList[0]) {\n      setFileList([]);\n    }\n\n    let canUpload = true;\n\n    setFileList(prevList => {\n      if (prevList.length >= maxFileCount) {\n        Toast.warning(I18n.t('plugin_file_max'));\n        canUpload = false;\n        return prevList;\n      }\n      return [...prevList, file];\n    });\n\n    if (canUpload) {\n      await uploadFileWithProgress(file);\n    }\n  };\n\n  const deleteFile = (uid?: string) => {\n    const index = fileList.findIndex(item => uid === item.uid);\n\n    if (index !== -1 && uid) {\n      setFileList(prevList => {\n        const newList = [...prevList];\n        newList.splice(index, 1);\n        return newList;\n      });\n    }\n  };\n\n  return {\n    fileList,\n    upload,\n    isUploading,\n    deleteFile,\n    setFileList: _fileList => setFileList(_fileList),\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ClickAwayListener from 'react-click-away-listener';\nimport React, { useEffect, useRef } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport classNames from 'classnames';\nimport { useUpdateEffect, useMemoizedFn } from 'ahooks';\nimport { I18n } from '@coze-arch/i18n';\nimport { Upload, Toast } from '@coze-arch/coze-design';\n\nimport { FileIcon, FileItemStatus } from '../file-icon';\nimport { typeSafeJSONParse } from '../../utils';\nimport { formatBytes } from './utils';\nimport { useUpload } from './use-upload';\nimport { type FileItem } from './types';\n\nimport styles from './file-upload.module.less';\n\nexport interface FileUploadProps {\n  value: string;\n  accept: string;\n  multiple: boolean;\n  disabled?: boolean;\n  fileType: 'object' | 'image';\n  validateStatus?: string;\n  onBlur?: () => void;\n  onFocus?: () => void;\n  onChange?: (v?: string) => void;\n}\n\nconst TEST_RUN_FILE_NAME_KEY = 'x-wf-file_name';\n\nconst getFormatFileUrl = (curFile: FileItem) => {\n  const originUrl = curFile?.url ?? '';\n  const fileName = curFile?.name ?? '';\n  try {\n    const urlObj = new URL(originUrl);\n    const params = new URLSearchParams(urlObj.search);\n\n    if (params.has(TEST_RUN_FILE_NAME_KEY)) {\n      params.set(TEST_RUN_FILE_NAME_KEY, fileName);\n    } else {\n      params.append(TEST_RUN_FILE_NAME_KEY, fileName);\n    }\n\n    urlObj.search = params.toString();\n\n    return urlObj.toString();\n  } catch (e) {\n    return originUrl;\n  }\n};\n\nconst getParsedFileInfo = (formatUrl: string) => {\n  const url = new URL(formatUrl);\n  const params = new URLSearchParams(url.search);\n  const fileName =\n    params.get(TEST_RUN_FILE_NAME_KEY) ?? I18n.t('plugin_file_unknown');\n\n  return {\n    url: formatUrl,\n    uid: nanoid(),\n    name: fileName,\n  };\n};\n\nconst getInitialValue = (val: string, multiple: boolean): FileItem[] => {\n  if (multiple) {\n    const multipleVal = typeSafeJSONParse(val);\n    if (Array.isArray(multipleVal)) {\n      return multipleVal.map(url => getParsedFileInfo(url)) as FileItem[];\n    }\n  }\n  if (val) {\n    return [getParsedFileInfo(val)] as FileItem[];\n  }\n  return [];\n};\n\nexport const FileUpload: React.FC<FileUploadProps> = props => {\n  const {\n    validateStatus,\n    value,\n    onChange,\n    onBlur,\n    onFocus,\n    accept,\n    multiple,\n    disabled,\n    fileType,\n  } = props;\n\n  const focusRef = useRef(false);\n\n  const maxFileCount = multiple ? 20 : 1;\n\n  const { upload, fileList, isUploading, deleteFile, setFileList } = useUpload({\n    multiple,\n    fileType,\n    accept,\n    maxFileCount,\n  });\n\n  const handleFocus = () => {\n    if (!focusRef.current) {\n      focusRef.current = true;\n      onFocus?.();\n    }\n  };\n  const handleBlur = () => {\n    if (focusRef.current) {\n      focusRef.current = false;\n      onBlur?.();\n    }\n  };\n  const handleClickAway = () => {\n    if (!isUploading) {\n      handleBlur();\n    }\n  };\n\n  const handleUpload = async file => {\n    const { fileInstance } = file;\n    await upload(fileInstance);\n  };\n\n  const getSubmitValue = useMemoizedFn((): string | undefined => {\n    let newVal: string | undefined;\n    if (multiple) {\n      const next = fileList\n        .filter(item => item.url)\n        .map(item => getFormatFileUrl(item));\n      newVal = next.length ? JSON.stringify(next) : undefined;\n    } else {\n      const singleFile = fileList?.[0];\n      newVal = singleFile ? getFormatFileUrl(singleFile) : undefined;\n    }\n    return newVal;\n  });\n\n  const handleChange = useMemoizedFn(val => onChange?.(val));\n\n  // When the fileList is updated, onChange is triggered.\n  useUpdateEffect(() => {\n    const newVal = getSubmitValue();\n    handleChange?.(newVal);\n  }, [fileList]);\n\n  // When the form value is updated, sync to fileList\n  useEffect(() => {\n    const val = getSubmitValue();\n    if (val !== value) {\n      setFileList(getInitialValue(value, multiple));\n    }\n  }, [value]);\n\n  const handleAcceptInvalid = () => {\n    Toast.error(\n      I18n.t('imageflow_upload_error_type', {\n        type: accept,\n      }),\n    );\n  };\n\n  const semiFileList: any[] = fileList.map(file => ({\n    name: file.name,\n    size: file.size !== undefined ? formatBytes(file.size) : '',\n    uid: file.uid || nanoid(),\n    status: file.status || FileItemStatus.Success,\n    url: file.uil,\n    validateMessage: file.validateMessage,\n    percent: file.percent,\n    preview: true,\n  }));\n\n  return (\n    <ClickAwayListener onClickAway={handleClickAway}>\n      <div\n        className={classNames(styles.container, {\n          [styles['hide-upload-area']]: fileList.length >= maxFileCount,\n        })}\n      >\n        <Upload\n          disabled={disabled}\n          action=\"\"\n          limit={maxFileCount}\n          fileList={semiFileList}\n          data-testid={props['data-testid']}\n          className={validateStatus === 'error' ? 'has-error' : ''}\n          customRequest={handleUpload}\n          draggable={true}\n          dragMainText={I18n.t('imageflow_upload_action_common')}\n          dragSubText={I18n.t('imageflow_upload_type', {\n            type: accept,\n          })}\n          multiple={multiple}\n          accept={accept}\n          onDrop={handleFocus}\n          onOpenFileDialog={handleFocus}\n          onAcceptInvalid={handleAcceptInvalid}\n          previewFile={file => {\n            const { uid } = file;\n            const fileItem = fileList.find(item => item.uid === uid);\n            if (fileItem) {\n              return <FileIcon file={fileItem} size={36} />;\n            }\n          }}\n          onRemove={(currentFile, list, currentFileItem) => {\n            deleteFile(currentFileItem.uid);\n          }}\n          onClear={() => setFileList([])}\n        />\n      </div>\n    </ClickAwayListener>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { connect, mapProps } from '@formily/react';\n\nimport { FileUpload as FileUploadAdapter } from '../../file-upload';\n\nexport const FileUpload = connect(\n  FileUploadAdapter,\n  mapProps({ validateStatus: true }),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { connect } from '@formily/react';\nimport { Switch as CozSwitch } from '@coze-arch/coze-design';\n\nexport interface SwitchProps {\n  value?: boolean;\n  onChange?: (v: boolean) => void;\n}\n\nconst SwitchAdapter: React.FC<SwitchProps> = ({ value, ...props }) => (\n  <CozSwitch checked={value} {...props} size=\"small\" />\n);\n\nexport const Switch = connect(SwitchAdapter);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\n\nimport { CozInputNumber, type InputNumberProps } from '@coze-arch/coze-design';\n\nexport type BaseInputNumberAdapterProps = {\n  value?: number | string;\n  onChange?: (v?: number | string) => void;\n} & Pick<InputNumberProps, 'precision'>;\n\nexport const BaseInputNumberAdapter: React.FC<BaseInputNumberAdapterProps> = ({\n  onChange,\n  ...props\n}) => {\n  const handleChange = useCallback(\n    (v: number | string) => {\n      onChange?.(v === '' ? undefined : v);\n    },\n    [onChange],\n  );\n  return (\n    <CozInputNumber\n      onChange={handleChange}\n      {...props}\n      size=\"small\"\n      style={{ width: '100%' }}\n    />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { connect } from '@formily/react';\n\nimport {\n  BaseInputNumberAdapter,\n  type BaseInputNumberAdapterProps,\n} from './base-input-number';\n\nconst InputIntegerAdapter: React.FC<BaseInputNumberAdapterProps> = props => (\n  <BaseInputNumberAdapter {...props} precision={0.1} />\n);\n\nexport const InputInteger = connect(InputIntegerAdapter);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { connect } from '@formily/react';\n\nimport { BaseInputNumberAdapter } from './base-input-number';\n\nexport const InputNumber = connect(BaseInputNumberAdapter);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { connect, mapProps } from '@formily/react';\nimport { VoiceSelect as VoiceSelectBase } from '@coze-workflow/components';\n\nconst VoiceSelectAdapter = props => <VoiceSelectBase {...props} />;\n\nexport const VoiceSelect = connect(\n  VoiceSelectAdapter,\n  mapProps({ validateStatus: true }),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cls from 'classnames';\nimport { connect, mapProps } from '@formily/react';\nimport { TextArea as TextAreaCore } from '@coze-arch/coze-design';\n\nimport css from './text-area.module.less';\n\nexport interface TextAreaProps {\n  size?: string;\n  className?: string;\n}\n\nconst TextAreaAdapter: React.FC<TextAreaProps> = ({\n  size,\n  className,\n  ...props\n}) => (\n  <TextAreaCore\n    className={cls(\n      {\n        [css['text-area-small']]: size === 'small',\n      },\n      className,\n    )}\n    {...props}\n  />\n);\n\nexport const TextArea = connect(\n  TextAreaAdapter,\n  mapProps({ validateStatus: true }),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect, useRef, Suspense } from 'react';\n\nimport { nanoid } from 'nanoid';\nimport { debounce } from 'lodash-es';\nimport cls from 'classnames';\nimport { connect, mapProps } from '@formily/react';\nimport type { Editor } from '@coze-common/md-editor-adapter';\nimport {\n  delta2md,\n  md2html,\n  LazyEditorFullInputInner,\n  ToolbarItemEnum,\n} from '@coze-common/md-editor-adapter';\nimport { Modal } from '@coze-arch/coze-design';\n\nimport css from './full-input.module.less';\n\nexport interface InnerFullInputProps {\n  value?: string;\n  disabled?: boolean;\n  /** Whether it can be expanded, the default is true. */\n  expand?: boolean;\n  className?: string;\n  onChange: (v?: string) => void;\n  onExpand?: () => void;\n}\n\nexport type FullInputProps = InnerFullInputProps & {\n  modalTitle?: string;\n};\n\nconst InnerFullInputAdapter: React.FC<FullInputProps> = ({\n  className,\n  disabled,\n  expand = true,\n  value,\n  onChange,\n  ...props\n}) => {\n  const editorRef = useRef<Editor | null>(null);\n  const businessKeyRef = useRef(nanoid());\n  const innerValueRef = useRef<string | undefined>();\n\n  const handleChange = useRef(\n    debounce((v: string) => {\n      if (!editorRef.current) {\n        return;\n      }\n      /**\n       * deltas => md\n       */\n      const content = editorRef.current.getContent();\n      const { markdown } = delta2md(content.deltas[0], content.deltas);\n      /**\n       * Changes may come from user input or initialization, do a diff to ensure performance\n       */\n      if (markdown !== innerValueRef.current) {\n        innerValueRef.current = markdown;\n        onChange(markdown);\n      }\n    }, 500),\n  ).current;\n\n  useEffect(() => {\n    if (value !== innerValueRef.current) {\n      innerValueRef.current = value || '';\n      /**\n       * md => html\n       */\n      editorRef.current?.setHTML(md2html(value || ''));\n    }\n  }, [value]);\n\n  useEffect(\n    () => () => {\n      handleChange.cancel();\n    },\n    [handleChange],\n  );\n\n  return (\n    <Suspense fallback={null}>\n      <LazyEditorFullInputInner\n        field=\"full-input\"\n        className={cls(css['full-input'], className)}\n        businessKey={businessKeyRef.current}\n        noToolbar={disabled}\n        noExpand={!expand}\n        getEditor={editor => {\n          editorRef.current = editor;\n        }}\n        disabled={disabled}\n        onChange={handleChange}\n        registerToolItem={items =>\n          items\n            .filter(i => (i as any)?.type !== ToolbarItemEnum.Image)\n            .map(i => {\n              const item = i as any;\n              if (item?.type && item.extraPropsToBuiltinComp) {\n                item.extraPropsToBuiltinComp = {\n                  ...item.extraPropsToBuiltinComp,\n                  size: 'extra-small',\n                };\n              }\n              return item;\n            })\n        }\n        {...props}\n      />\n    </Suspense>\n  );\n};\n\nconst FullInputAdapter: React.FC<FullInputProps> = ({\n  expand,\n  modalTitle,\n  ...props\n}) => {\n  const [modalVisible, setModalVisible] = useState(false);\n\n  return (\n    <>\n      <Modal\n        visible={modalVisible}\n        centered\n        title={modalTitle}\n        onCancel={() => setModalVisible(false)}\n      >\n        <InnerFullInputAdapter\n          expand={false}\n          className={css['modal-full-input']}\n          {...props}\n        />\n      </Modal>\n      <InnerFullInputAdapter\n        expand={expand}\n        onExpand={() => setModalVisible(true)}\n        {...props}\n      />\n    </>\n  );\n};\n\nexport const FullInput = connect(\n  FullInputAdapter,\n  mapProps({ validateStatus: true }),\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Test run test form layout FormItem\n */\nimport React, { type FC, type ReactNode, type PropsWithChildren } from 'react';\n\nimport { connect, mapProps } from '@formily/react';\nimport { isDataField } from '@formily/core';\nimport { IconCozInfoCircle } from '@coze-arch/coze-design/icons';\nimport { Tooltip, Typography, Tag } from '@coze-arch/coze-design';\n\nimport styles from './index.module.less';\n\nexport interface FormItemProps {\n  required?: boolean;\n  label?: ReactNode;\n  description?: ReactNode;\n  tag?: ReactNode;\n  tooltip?: ReactNode;\n  feedbackText?: ReactNode;\n  action?: ReactNode;\n}\n\nexport const FormItemAdapter: FC<PropsWithChildren<FormItemProps>> = props => {\n  const {\n    required,\n    label,\n    feedbackText,\n    description,\n    tooltip,\n    tag,\n    action,\n    children,\n  } = props;\n\n  return (\n    <div className={styles['form-item']}>\n      <div className={styles['form-item-label']}>\n        <div className={styles['form-item-label-top']}>\n          <div className={styles['top-left']}>\n            <span className={styles['form-item-label-text']}>{label}</span>\n            {required ? (\n              <span className={styles['form-item-label-asterisk']}>*</span>\n            ) : null}\n            {tooltip ? (\n              <Tooltip content={tooltip}>\n                <IconCozInfoCircle className={styles['label-tooltip']} />\n              </Tooltip>\n            ) : null}\n\n            {tag ? (\n              <Tag className={styles.tag} size=\"mini\" color=\"primary\">\n                {tag}\n              </Tag>\n            ) : null}\n          </div>\n          {action}\n        </div>\n        {description ? (\n          <Typography.Text\n            size=\"small\"\n            type=\"secondary\"\n            ellipsis={{\n              showTooltip: true,\n            }}\n          >\n            {description}\n          </Typography.Text>\n        ) : null}\n      </div>\n\n      <div>{children}</div>\n      {feedbackText ? (\n        <div className={styles['form-item-feedback-wrap']}>\n          <Typography.Text\n            size=\"small\"\n            className={styles['form-item-feedback-text']}\n          >\n            {feedbackText}\n          </Typography.Text>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\nconst FormItem = connect(\n  FormItemAdapter,\n  mapProps(\n    {\n      title: 'label',\n      required: true,\n      tag: true,\n      description: true,\n    } as any,\n    (props, field) => ({\n      ...props,\n      feedbackText:\n        isDataField(field) && field.selfErrors?.length\n          ? field.selfErrors\n          : undefined,\n    }),\n  ),\n);\n\nexport { FormItem };\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState } from 'react';\n\nimport cls from 'classnames';\nimport {\n  IconCozArrowDownFill,\n  IconCozInfoCircle,\n} from '@coze-arch/coze-design/icons';\nimport { Collapsible, Tooltip, Typography } from '@coze-arch/coze-design';\n\nimport css from './index.module.less';\n\nexport interface FormSectionProps {\n  title?: React.ReactNode;\n  tooltip?: React.ReactNode;\n  action?: React.ReactNode;\n  collapsible?: boolean;\n}\n\nexport const FormSection: React.FC<\n  React.PropsWithChildren<FormSectionProps>\n> = ({ title, tooltip, action, collapsible, children }) => {\n  const [isOpen, setIsOpen] = useState(true);\n\n  const handleExpand = () => {\n    setIsOpen(!isOpen);\n  };\n\n  return (\n    <div className={css['form-section']}>\n      <div className={css['section-header']}>\n        <div\n          className={css['section-title']}\n          onClick={collapsible ? handleExpand : undefined}\n        >\n          {collapsible ? (\n            <IconCozArrowDownFill\n              className={cls(css['title-collapsible'], {\n                [css['is-close']]: !isOpen,\n              })}\n            />\n          ) : null}\n\n          <Typography.Text strong>{title}</Typography.Text>\n\n          {tooltip ? (\n            <Tooltip content={tooltip}>\n              <IconCozInfoCircle className={css['title-tooltip']} />\n            </Tooltip>\n          ) : null}\n        </div>\n        {action ? (\n          <div\n            className={css['section-action']}\n            onClick={e => {\n              e.stopPropagation();\n            }}\n          >\n            {action}\n          </div>\n        ) : null}\n      </div>\n      <Collapsible keepDOM fade isOpen={isOpen}>\n        <div className={css['section-context']}>{children}</div>\n      </Collapsible>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cls from 'classnames';\nimport { DatePicker } from '@coze-arch/coze-design';\n\nimport css from './time.module.less';\n\nexport interface InputTimeProps {\n  className?: string;\n  value?: string;\n  onChange?: (v?: string) => void;\n}\n\nexport const InputTime: React.FC<InputTimeProps> = ({\n  className,\n  value,\n  onChange,\n  ...props\n}) => (\n  <DatePicker\n    className={cls(css['input-time'], className)}\n    type=\"dateTime\"\n    size=\"small\"\n    showClear={false}\n    showSuffix={false}\n    value={value}\n    onChange={(_date, dateString) => {\n      if (typeof dateString === 'string' || dateString === undefined) {\n        onChange?.(dateString);\n      }\n    }}\n    {...props}\n  />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport cls from 'classnames';\n\nimport styles from './form-panel-layout.module.less';\n\ninterface FormPanelLayoutProps {\n  className?: string;\n}\n\nexport const FormPanelLayout: React.FC<\n  React.PropsWithChildren<FormPanelLayoutProps>\n> = ({ className, children }) => (\n  <div className={cls(styles['form-panel-layout'], className)}>{children}</div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IconCozPlayFill } from '@coze-arch/coze-design/icons';\nimport { Button, type ButtonProps } from '@coze-arch/coze-design';\n\nexport const BaseTestButton: React.FC<ButtonProps> = props => (\n  <Button color=\"green\" icon={<IconCozPlayFill />} {...props} />\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useState,\n  useRef,\n  useCallback,\n  useEffect,\n  forwardRef,\n  useImperativeHandle,\n  useMemo,\n  type MutableRefObject,\n} from 'react';\n\nimport { isNumber } from 'lodash-es';\nimport cls from 'classnames';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport styles from './resizable-panel.module.less';\n\ninterface ResizablePanelProps {\n  className?: string;\n  header?: React.ReactNode;\n  headerExtra?: React.ReactNode;\n  footer?: React.ReactNode;\n  hideClose?: boolean;\n  onClose: () => void;\n  onCloseWithoutAnimation?: () => void;\n  animation?: 'slide' | 'translateY';\n  translateYHeight?: string;\n  innerScrollRef?: MutableRefObject<HTMLDivElement | null>;\n  draggable?: boolean;\n}\n\nexport interface ResizablePanelRef {\n  minimize: () => void;\n  maximize: () => void;\n  close: () => void;\n  scrollTo: (options?: ScrollToOptions) => void;\n}\n\nconst MIN_HEIGHT = 156;\n\n/**\n * TODO: The core telescopic ability here wants to be replaced by semi Resizable later. Here are some temporary logical adaptations.\n */\nexport const ResizablePanel = forwardRef<\n  ResizablePanelRef,\n  React.PropsWithChildren<ResizablePanelProps>\n>(\n  (\n    {\n      className,\n      hideClose,\n      header,\n      footer,\n      onClose,\n      onCloseWithoutAnimation,\n      children,\n      animation,\n      translateYHeight = 'calc(100% - 52px)',\n      innerScrollRef: innerScrollRefFromProps,\n      draggable = true,\n      headerExtra,\n    },\n    ref,\n  ) => {\n    const [height, setHeight] = useState<null | number>(0);\n    const [isOpen, setIsOpen] = useState<null | boolean>(null);\n\n    const innerRef = useRef<HTMLDivElement>(null);\n    const _scrollRef = useRef<HTMLDivElement>(null);\n    const scrollRef = innerScrollRefFromProps || _scrollRef;\n\n    const isResizing = useRef(false);\n    const startY = useRef(0);\n    const startHeight = useRef(0);\n\n    const [transition, setTransition] = useState(true);\n\n    const handleMouseMove = useCallback(\n      e => {\n        if (isResizing.current) {\n          const newHeight = startHeight.current - (e.clientY - startY.current); // Calculate the new height\n          setHeight(newHeight > MIN_HEIGHT ? newHeight : MIN_HEIGHT);\n        }\n      },\n      [setHeight],\n    );\n    const handleMouseUp = useCallback(() => {\n      isResizing.current = false;\n      document.removeEventListener('mousemove', handleMouseMove); // Cancel listening\n      document.removeEventListener('mouseup', handleMouseUp); // Cancel listening\n    }, [handleMouseMove]);\n\n    const handleMouseDown = useCallback(\n      e => {\n        isResizing.current = true;\n        startY.current = e.clientY; // Record the Y-axis coordinates when the mouse starts dragging\n        startHeight.current = innerRef.current?.offsetHeight || 0;\n        document.addEventListener('mousemove', handleMouseMove); // Monitor mouse movement events\n        document.addEventListener('mouseup', handleMouseUp); // Monitor mouse lift events\n      },\n      [handleMouseMove, handleMouseUp],\n    );\n\n    const handleClose = () => {\n      setTransition(true);\n      onCloseWithoutAnimation?.();\n\n      if (animation) {\n        setIsOpen(false);\n      } else {\n        setHeight(0);\n      }\n\n      setTimeout(() => {\n        onClose();\n      }, 250);\n    };\n\n    useImperativeHandle(ref, () => ({\n      minimize: () => {\n        setTransition(true);\n        setHeight(MIN_HEIGHT);\n        setTimeout(() => setTransition(false), 250);\n      },\n      maximize: () => {\n        setTransition(true);\n        setHeight(null);\n        setTimeout(() => setTransition(false), 250);\n      },\n      close: () => {\n        handleClose();\n      },\n      scrollTo: (options?: ScrollToOptions) =>\n        scrollRef.current?.scrollTo(options),\n    }));\n\n    useEffect(() => {\n      setIsOpen(true);\n\n      setTimeout(() => {\n        setHeight(null);\n        setTimeout(() => {\n          setTransition(false);\n        }, 250);\n      }, 100);\n    }, []);\n\n    const styleMemo = useMemo(() => {\n      if (animation === 'slide') {\n        return {\n          height: '100%',\n        };\n      }\n\n      if (animation === 'translateY') {\n        return {\n          height: isNumber(height) ? `${height}px` : translateYHeight,\n          maxHeight: translateYHeight,\n        };\n      }\n\n      return {\n        height: isNumber(height) ? `${height}px` : '90%',\n      };\n    }, [height, animation, translateYHeight]);\n\n    return (\n      <div\n        ref={innerRef}\n        style={styleMemo}\n        className={cls(\n          styles.container,\n          {\n            [styles['resizable-panel']]: !animation,\n            [styles['need-transition']]: !animation && transition,\n\n            [styles['resizable-panel-translateY']]: animation === 'translateY',\n            [styles.show]: animation === 'translateY' && isOpen,\n            [styles.hide]: animation === 'translateY' && !isOpen,\n\n            [styles['resizable-panel-slide']]: animation === 'slide',\n            [styles['slide-in']]: animation === 'slide' && isOpen,\n            [styles['slide-out']]: animation === 'slide' && !isOpen,\n          },\n          className,\n        )}\n      >\n        {draggable ? (\n          <div\n            onMouseDown={handleMouseDown}\n            className={styles['panel-dragging']}\n          ></div>\n        ) : null}\n\n        {header ? (\n          <div className={styles['panel-header']}>\n            {header}\n            {hideClose ? null : (\n              <IconButton\n                icon={<IconCozCross className={'text-[18px]'} />}\n                color=\"secondary\"\n                onClick={handleClose}\n              />\n            )}\n          </div>\n        ) : null}\n        {headerExtra ? headerExtra : null}\n        <div ref={scrollRef} className={styles['panel-content']}>\n          {children}\n        </div>\n        {footer ? <div className={styles['panel-footer']}>{footer}</div> : null}\n      </div>\n    );\n  },\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useRef, useCallback } from 'react';\n\nimport { useMemoizedFn } from 'ahooks';\n\ninterface Config {\n  default?: number;\n  min?: number;\n  max?: number;\n}\n\n/**\n * Currently only highly variable is supported\n */\nexport const useResize = (config: Config) => {\n  const [dragging, setDragging] = useState(false);\n  const [height, setHeight] = useState(config.default);\n  const ref = useRef<HTMLDivElement>(null);\n  /**\n   * Dragging process\n   */\n  const resizing = useRef(false);\n  /**\n   * Y-axis variation\n   */\n  const startY = useRef(0);\n  /** starting position */\n  const start = useRef(0);\n\n  const handleMouseMove = useMemoizedFn(e => {\n    if (resizing.current) {\n      const newHeight = start.current - (e.clientY - startY.current); // Calculate the new height\n      if (config.max && newHeight > config.max) {\n        setHeight(config.max);\n      } else if (config.min && newHeight < config.min) {\n        setHeight(config.min);\n      } else {\n        setHeight(newHeight);\n      }\n    }\n  });\n  const handleMouseUp = useCallback(() => {\n    resizing.current = false;\n    setDragging(false);\n    document.removeEventListener('mousemove', handleMouseMove); // Cancel listening\n    document.removeEventListener('mouseup', handleMouseUp); // Cancel listening\n  }, [handleMouseMove]);\n\n  const handleMouseDown = useMemoizedFn(e => {\n    resizing.current = true;\n    setDragging(true);\n    startY.current = e.clientY; // Record the Y-axis coordinates when the mouse starts dragging\n    start.current = ref.current?.offsetHeight || 0;\n    document.addEventListener('mousemove', handleMouseMove); // Monitor mouse movement events\n    document.addEventListener('mouseup', handleMouseUp); // Monitor mouse lift events\n  });\n\n  return {\n    height,\n    bind: handleMouseDown,\n    ref,\n    dragging,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { isObject } from 'lodash-es';\nimport cls from 'classnames';\nimport { IconCozCross } from '@coze-arch/coze-design/icons';\nimport { IconButton } from '@coze-arch/coze-design';\n\nimport { useResize } from './use-resize';\n\nimport styles from './base-panel.module.less';\n\ninterface BasePanelProps {\n  className?: string;\n  /**\n   * Panel header, no pass and no render\n   */\n  header?: React.ReactNode;\n  /**\n   * Panel foot, do not pass and do not render\n   */\n  footer?: React.ReactNode;\n  /**\n   * Default initial height, does not support responsive\n   */\n  height?: number;\n  /**\n   * Can you drag and drop to change the height?\n   */\n  resizable?:\n    | boolean\n    | {\n        min?: number;\n        max?: number;\n      };\n  /**\n   * Click to close the event, which may only be triggered when rendering the panel header\n   */\n  onClose?: () => void;\n}\n\nexport const BasePanel: React.FC<React.PropsWithChildren<BasePanelProps>> = ({\n  className,\n  header,\n  footer,\n  height,\n  resizable,\n  onClose,\n  children,\n}) => {\n  const {\n    height: innerHeight,\n    bind,\n    ref,\n    dragging,\n  } = useResize({\n    default: height,\n    ...(isObject(resizable) ? resizable : {}),\n  });\n\n  return (\n    <div\n      className={cls(\n        styles['base-panel'],\n        className,\n        dragging && styles.dragging,\n      )}\n      style={{ height: innerHeight }}\n      ref={ref}\n    >\n      {resizable ? (\n        <div className={styles['resize-bar']} onMouseDown={bind} />\n      ) : null}\n      {header ? (\n        <div className={styles['panel-header']}>\n          {header}\n          <IconButton\n            icon={<IconCozCross className={'text-[18px]'} />}\n            color=\"secondary\"\n            onClick={onClose}\n          />\n        </div>\n      ) : null}\n      <div className={styles['panel-content']}>{children}</div>\n      {footer ? <div className={styles['panel-footer']}>{footer}</div> : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { Avatar, Typography } from '@coze-arch/coze-design';\nimport { type NodeEvent } from '@coze-arch/bot-api/workflow_api';\n\nimport styles from './node-event-info.module.less';\n\ninterface NodeEventInfoProps {\n  event: NodeEvent | undefined;\n}\n\nexport const NodeEventInfo: React.FC<NodeEventInfoProps> = ({ event }) => {\n  if (!event) {\n    return null;\n  }\n  return (\n    <div className={styles['node-event-info']}>\n      <Avatar src={event.node_icon} shape=\"square\" size=\"extra-extra-small\" />\n      <Typography.Text>{event.node_title}</Typography.Text>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useMemo } from 'react';\n\nimport { isNumber } from 'lodash-es';\nimport cls from 'classnames';\nimport { type NodeResult } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozWarningCircleFill } from '@coze-arch/coze-design/icons';\nimport { Tooltip } from '@coze-arch/coze-design';\n\nimport styles from './page-item.module.less';\n\ninterface PageItemProps {\n  data: NodeResult | null;\n  idx: number;\n  paging: number;\n  onChange: (v: number) => void;\n}\n\ntype Nilable<T> = T | undefined | null;\n\nexport function checkHasError(item: Nilable<NodeResult>) {\n  return Boolean(item?.errorInfo) && item?.errorLevel === 'Error';\n}\n\nexport function checkHasWarning(item: Nilable<NodeResult>) {\n  return Boolean(item?.errorInfo) && item?.errorLevel !== 'Error';\n}\n\nconst PageItemEmpty: React.FC<React.PropsWithChildren> = ({ children }) => (\n  <Tooltip\n    content={I18n.t('workflow_detail_testrun_panel_batch_naviagte_empty')}\n  >\n    <div className={cls(styles['page-item'], styles['page-item-empty'])}>\n      {children}\n    </div>\n  </Tooltip>\n);\n\nexport const PageItem: React.FC<PageItemProps> = ({\n  data,\n  idx,\n  paging,\n  onChange,\n}) => {\n  const isError = useMemo(() => checkHasError(data), [data]);\n  const isWarning = useMemo(() => checkHasWarning(data), [data]);\n\n  const page = useMemo(() => {\n    const temp = data?.index;\n    if (isNumber(temp)) {\n      return temp;\n    }\n    return idx;\n  }, [data, idx]);\n\n  const echoPage = useMemo(() => page + 1, [page]);\n\n  const handleChange = useCallback(() => {\n    onChange(page);\n  }, [page, onChange]);\n\n  if (!data) {\n    return <PageItemEmpty key={echoPage}>{echoPage}</PageItemEmpty>;\n  }\n\n  return (\n    <div\n      key={echoPage}\n      className={cls(styles['page-item'], {\n        [styles.error]: isError,\n        [styles.warning]: isWarning,\n        [styles.active]: page === paging,\n      })}\n      onClick={handleChange}\n    >\n      {echoPage}\n      {isError || isWarning ? (\n        <IconCozWarningCircleFill className={styles.icon} />\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useState,\n  useMemo,\n  useRef,\n  useEffect,\n  useCallback,\n} from 'react';\n\nimport { isUndefined } from 'lodash-es';\nimport cls from 'classnames';\nimport { type NodeResult } from '@coze-workflow/base/api';\nimport {\n  IconCozWarningCircleFill,\n  IconCozArrowDownFill,\n} from '@coze-arch/coze-design/icons';\nimport { Popover, Typography } from '@coze-arch/coze-design';\n\nimport { PageItem, checkHasError, checkHasWarning } from './page-item';\n\nimport s from './more-selector.module.less';\n\ninterface MoreSelectorProps {\n  /**\n   * Run result array\n   */\n  data: (NodeResult | null)[];\n  /** current selection index */\n  paging: number;\n  fixedCount: number;\n\n  /** placeholder */\n  placeholder: string;\n\n  /** Select index change event */\n  onChange: (p: number) => void;\n}\n\nexport const MoreSelector: React.FC<MoreSelectorProps> = ({\n  placeholder,\n  paging,\n  fixedCount,\n  data,\n  onChange,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const popoverRef = useRef<HTMLDivElement>(null);\n  const selectRef = useRef<HTMLDivElement>(null);\n\n  const currentItem = useMemo(\n    () => data.find(v => v?.index === paging),\n    [paging, data],\n  );\n\n  const hasError = useMemo(() => checkHasError(currentItem), [currentItem]);\n  const hasWarning = useMemo(() => checkHasWarning(currentItem), [currentItem]);\n\n  const handleChange = useCallback(\n    (v: number) => {\n      onChange(v);\n      setIsOpen(false);\n    },\n    [onChange, setIsOpen],\n  );\n\n  useEffect(() => {\n    const handle = (e: Event) => {\n      if (selectRef.current?.contains(e.target as Node)) {\n        return;\n      }\n\n      if (!popoverRef.current?.contains(e.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n    window.addEventListener('click', handle);\n    return () => window.removeEventListener('click', handle);\n  }, []);\n\n  return (\n    <Popover\n      keepDOM\n      trigger=\"custom\"\n      position=\"bottomRight\"\n      visible={isOpen}\n      content={\n        <div className={s['more-selector-content']} ref={popoverRef}>\n          {data.map((v, idx) => (\n            <PageItem\n              data={v}\n              idx={idx + fixedCount}\n              paging={paging}\n              onChange={handleChange}\n            />\n          ))}\n        </div>\n      }\n      getPopupContainer={() => selectRef?.current || document.body}\n    >\n      <div\n        ref={selectRef}\n        className={cls({\n          [s['ui-selector']]: true,\n          [s['has-value']]: !isUndefined(currentItem) || isOpen,\n          [s['has-error']]: hasError,\n          [s['has-warning']]: hasWarning,\n        })}\n        onClick={() => setIsOpen(p => !p)}\n      >\n        {placeholder && isUndefined(currentItem) ? (\n          <div className={s['ui-selector-placeholder']}>{placeholder}</div>\n        ) : null}\n        {!isUndefined(currentItem) && (\n          <div className={s['ui-selector-content']}>\n            <Typography.Text>{paging + 1}</Typography.Text>\n          </div>\n        )}\n        <div\n          className={cls({\n            [s['ui-selector-icon']]: true,\n            [s.selected]: isOpen,\n          })}\n        >\n          <IconCozArrowDownFill />\n        </div>\n\n        {hasError || hasWarning ? (\n          <div\n            className={cls({\n              [s['ui-selector-error-icon']]: hasError,\n              [s['ui-selector-warning-icon']]: hasWarning,\n            })}\n          >\n            <IconCozWarningCircleFill />\n          </div>\n        ) : null}\n      </div>\n    </Popover>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { type NodeResult } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\n\nimport { PageItem } from './page-item';\nimport { MoreSelector } from './more-selector';\n\nimport styles from './page-selector.module.less';\n\ninterface PageSelectorProps {\n  paging: number;\n  fixedCount?: number;\n  data: (NodeResult | null)[];\n  onChange: (val: number) => void;\n}\n\nconst MAX_FIXED_COUNT = 10;\n\nexport const PageSelector: React.FC<PageSelectorProps> = ({\n  paging,\n  fixedCount = MAX_FIXED_COUNT,\n  data,\n  onChange,\n}) => {\n  // Fixed display items, the maximum is 10, less than 10 items are displayed according to the actual display\n  const fixedItems = useMemo(\n    () => data.slice(0, fixedCount),\n    [fixedCount, data],\n  );\n  const moreItems = useMemo(() => data.slice(fixedCount), [data]);\n\n  // Do you need to show more through the drop-down box?\n  const hasMore = useMemo(() => data.length > fixedCount, [data, fixedCount]);\n\n  return (\n    <div style={{ display: 'flex' }} className={styles['page-selector']}>\n      {fixedItems.map((item, idx) => (\n        <PageItem data={item} idx={idx} paging={paging} onChange={onChange} />\n      ))}\n\n      {hasMore ? (\n        <MoreSelector\n          paging={paging}\n          fixedCount={fixedCount}\n          data={moreItems}\n          placeholder={I18n.t('drill_down_placeholer_select')}\n          onChange={page => {\n            onChange(page);\n          }}\n        />\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Batch pager\n */\nimport React, { useMemo } from 'react';\n\nimport { type NodeResult } from '@coze-workflow/base/api';\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography, Checkbox } from '@coze-arch/coze-design';\n\nimport { PageSelector } from './page-selector';\n\nimport styles from './pagination.module.less';\n\ninterface LogDetailPaginationProps {\n  paging: number;\n  data: (NodeResult | null)[];\n  onlyShowError: boolean;\n  disabled?: boolean;\n  fixedCount?: number;\n  onChange: (page: number) => void;\n  onShowErrorChange: (v: boolean) => void;\n}\n\nexport const LogDetailPagination: React.FC<LogDetailPaginationProps> = ({\n  paging,\n  data,\n  onlyShowError,\n  disabled,\n  fixedCount,\n  onChange,\n  onShowErrorChange,\n}) => {\n  const items = useMemo(() => {\n    if (onlyShowError) {\n      return data.filter(v => Boolean(v?.errorInfo));\n    }\n    return data;\n  }, [data, onlyShowError]);\n\n  const title = useMemo(() => {\n    if (onlyShowError) {\n      return `${I18n.t('workflow_batch_error_items')}: ${items.length}/${\n        data.length\n      }`;\n    }\n    return `${I18n.t('workflow_batch_total_items')}: ${data.length}`;\n  }, [data, items, onlyShowError]);\n\n  return (\n    <div>\n      <div className={styles['pagination-header']}>\n        <Typography.Text className=\"font-semibold\">{title}</Typography.Text>\n\n        <Checkbox\n          checked={onlyShowError}\n          disabled={disabled}\n          onChange={e => {\n            const checked = Boolean(e.target.checked);\n            onShowErrorChange(checked);\n          }}\n          aria-label={I18n.t('workflow_batch_error_only')}\n        >\n          {I18n.t('workflow_batch_error_only')}\n        </Checkbox>\n      </div>\n\n      <PageSelector\n        data={items}\n        paging={paging}\n        onChange={onChange}\n        fixedCount={fixedCount}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type NodeExeStatus } from '@coze-arch/bot-api/workflow_api';\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\n\nimport { type WorkflowLinkLogData } from '../../../types';\nimport {\n  ConditionLogParser,\n  OutputLogParser,\n  NormalLogParser,\n  isOutputLog,\n  isConditionLog,\n  FunctionCallLogParser,\n  isFunctionCallLog,\n  WorkflowLinkParser,\n  isWorkflowLinkLog,\n  type Log,\n} from '../../../features/log';\n\nexport const LogField: React.FC<{\n  log: Log;\n  node?: FlowNodeEntity;\n  nodeStatus?: NodeExeStatus;\n  onPreview: (value: string, path: string[]) => void;\n  onOpenWorkflowLink?: (data: WorkflowLinkLogData) => void;\n}> = ({ log, node, nodeStatus, onPreview, onOpenWorkflowLink }) => {\n  if (isConditionLog(log)) {\n    return <ConditionLogParser log={log} />;\n  }\n\n  if (isFunctionCallLog(log)) {\n    return <FunctionCallLogParser log={log} />;\n  }\n\n  if (isOutputLog(log)) {\n    return (\n      <OutputLogParser\n        log={log}\n        node={node}\n        nodeStatus={nodeStatus}\n        onPreview={onPreview}\n      />\n    );\n  }\n\n  if (isWorkflowLinkLog(log)) {\n    return (\n      <WorkflowLinkParser log={log} onOpenWorkflowLink={onOpenWorkflowLink} />\n    );\n  }\n\n  return <NormalLogParser log={log} />;\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozIllusDone } from '@coze-arch/coze-design/illustrations';\n\nimport styles from './empty.module.less';\n\nexport const EmptyFiled = () => (\n  <div className={styles['log-filed-empty']}>\n    <IconCozIllusDone width=\"120\" height=\"120\" />\n    <p>{I18n.t('workflow_batch_no_failed_entries')}</p>\n  </div>\n);\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type NodeResult } from '@coze-workflow/base/api';\n\nimport { type WorkflowLinkLogData } from '../../../types';\nimport { generateLog } from '../../../features/log';\nimport { LogField } from './log-field';\nimport { EmptyFiled } from './empty';\n\ninterface LogFieldsProps {\n  data: NodeResult | undefined;\n  node?: FlowNodeEntity;\n  onPreview: (value: string, path: string[]) => void;\n  onOpenWorkflowLink?: (data: WorkflowLinkLogData) => void;\n}\n\nexport const LogFields: React.FC<LogFieldsProps> = ({\n  data,\n  node,\n  onPreview,\n  onOpenWorkflowLink,\n}) => {\n  const { nodeStatus } = data || {};\n  const { logs } = useMemo(() => generateLog(data, node), [data, node]);\n\n  if (!data) {\n    return <EmptyFiled />;\n  }\n\n  return (\n    <>\n      {logs.map((log, idx) => (\n        <LogField\n          key={idx}\n          log={log}\n          node={node}\n          nodeStatus={nodeStatus}\n          onPreview={onPreview}\n          onOpenWorkflowLink={onOpenWorkflowLink}\n        />\n      ))}\n    </>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useLayoutEffect, useMemo, useState } from 'react';\n\nimport { type FlowNodeEntity } from '@flowgram-adapter/free-layout-editor';\nimport { type NodeResult } from '@coze-workflow/base/api';\n\nimport { type WorkflowLinkLogData } from '../../types';\nimport { useMarkdownModal } from '../../features/log';\nimport { LogDetailPagination } from './pagination';\nimport { type LogImages as LogImagesType } from './log-images';\nimport { LogFields } from './log-fields';\nimport useGetCurrentResult from './hooks/use-get-current-result';\n\nimport css from './log-detail.module.less';\n\ninterface LogDetailProps {\n  result: NodeResult;\n  node?: FlowNodeEntity;\n  paginationFixedCount?: number;\n\n  LogImages: LogImagesType;\n\n  spaceId: string;\n  workflowId: string;\n  onOpenWorkflowLink?: (data: WorkflowLinkLogData) => void;\n}\n\nexport const LogDetail: React.FC<LogDetailProps> = ({\n  result,\n  node,\n  paginationFixedCount,\n\n  LogImages,\n\n  spaceId,\n  workflowId,\n  onOpenWorkflowLink,\n}) => {\n  const { isBatch, nodeId } = result;\n  /** Start from 0 */\n  const [paging, setPaging] = useState(0);\n  /** Just look at the error. */\n  const [onlyShowError, setOnlyShowError] = useState(false);\n\n  const { current, batchData } = useGetCurrentResult({\n    result,\n    paging,\n    spaceId,\n    workflowId,\n  });\n\n  const echoCurrent = useMemo(() => {\n    if (!isBatch || !onlyShowError) {\n      return current;\n    }\n    return current?.errorInfo ? current : undefined;\n  }, [isBatch, onlyShowError, current]);\n\n  const { modal, open } = useMarkdownModal();\n\n  // When the paging data changes, re-select the first item\n  useLayoutEffect(() => {\n    setPaging(0);\n  }, [batchData]);\n\n  return (\n    <div className={css['log-detail']}>\n      {/* paging */}\n      {isBatch ? (\n        <LogDetailPagination\n          paging={paging}\n          data={batchData}\n          fixedCount={paginationFixedCount}\n          onlyShowError={onlyShowError}\n          onChange={setPaging}\n          onShowErrorChange={setOnlyShowError}\n        />\n      ) : null}\n      {echoCurrent ? (\n        <LogImages testRunResult={echoCurrent} nodeId={nodeId} />\n      ) : null}\n      <LogFields\n        data={echoCurrent}\n        node={node}\n        onPreview={open}\n        onOpenWorkflowLink={onOpenWorkflowLink}\n      />\n      {modal}\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useMemo } from 'react';\n\nimport { useQuery } from '@tanstack/react-query';\nimport { type NodeResult, workflowApi } from '@coze-workflow/base/api';\n\nimport { typeSafeJSONParse } from '../../../utils';\n\ninterface Props {\n  result: NodeResult;\n  paging: number;\n  spaceId: string;\n  workflowId: string;\n}\n\nexport default function useGetCurrentResult({\n  result,\n  paging,\n  spaceId,\n  workflowId,\n}: Props) {\n  const isNodeLogNeedAsync = true;\n  const { batch, isBatch } = result || {};\n\n  // Deserialize to get all iterated arrays\n  const batchData: NodeResult[] = useMemo(() => {\n    if (!isBatch) {\n      return [];\n    }\n    const data = typeSafeJSONParse(batch);\n    return (Array.isArray(data) ? data : []).map(i => {\n      if (!i) {\n        return i;\n      }\n      return {\n        ...i,\n        /** The tag is not included in the batch data, and it is added manually. */\n        isBatch: true,\n      };\n    });\n  }, [isBatch, batch]);\n\n  // Current execution log (get full log synchronously)\n  const current: NodeResult | undefined = useMemo(() => {\n    if (!isBatch) {\n      return result;\n    }\n\n    return batchData.find(i => i?.index === paging);\n  }, [paging, isBatch, batchData, result]);\n\n  const isUseAsyncNodeResult = () => {\n    if (!isNodeLogNeedAsync) {\n      return false;\n    }\n\n    if (!current) {\n      return false;\n    }\n\n    if (!current.needAsync) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const { data: currentAsync } = useQuery({\n    retry: 1,\n    queryKey: [\n      'WorkflowApiGetNodeExecuteHistory',\n      workflowId,\n      spaceId,\n      current?.executeId,\n      current?.nodeId,\n      current?.NodeType,\n      isBatch,\n      paging,\n    ],\n    queryFn: () =>\n      workflowApi\n        .GetNodeExecuteHistory({\n          workflow_id: workflowId,\n          space_id: spaceId,\n          execute_id: current?.executeId || '',\n          node_id: current?.nodeId || '',\n          node_type: current?.NodeType || '',\n          is_batch: isBatch,\n          batch_index: isBatch ? paging : undefined,\n        })\n        .then(res => res.data)\n        .catch(() => current),\n    enabled: isUseAsyncNodeResult(),\n  });\n\n  return {\n    current: isUseAsyncNodeResult() ? currentAsync : current,\n    batchData,\n  };\n}\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNil } from 'lodash-es';\nimport { useRequest } from 'ahooks';\nimport { type CaseDataDetail } from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\n\nimport { useTestsetManageStore } from '../use-testset-manage-store';\nimport {\n  typeSafeJSONParse,\n  traverseTestsetNodeFormSchemas,\n  getTestsetFormSubFieldName,\n  isTestsetFormSameFieldType,\n  assignTestsetFormDefaultValue,\n} from '../../../utils';\nimport { type NodeFormSchema, type FormItemSchema } from '../../../types';\n\nexport const useEditFormSchemas = (testset?: CaseDataDetail | null) => {\n  const { bizCtx, bizComponentSubject } = useTestsetManageStore(store => ({\n    bizCtx: store.bizCtx,\n    bizComponentSubject: store.bizComponentSubject,\n  }));\n  const { data: schemas, loading: schemasLoading } = useRequest(\n    async () => {\n      const localSchemas = (typeSafeJSONParse(testset?.caseBase?.input) ||\n        []) as NodeFormSchema[];\n      const res = await debuggerApi.GetSchemaByID({\n        bizComponentSubject,\n        bizCtx,\n      });\n      const remoteSchemas = (typeSafeJSONParse(res.schemaJson) ||\n        []) as NodeFormSchema[];\n\n      if (localSchemas.length) {\n        // Edit schema: compare local and remote schemas and try to assign values\n        const localSchemaMap: Record<string, FormItemSchema | undefined> = {};\n        traverseTestsetNodeFormSchemas(\n          localSchemas,\n          (schema, ipt) =>\n            (localSchemaMap[getTestsetFormSubFieldName(schema, ipt)] = ipt),\n        );\n\n        traverseTestsetNodeFormSchemas(remoteSchemas, (schema, ipt) => {\n          const subName = getTestsetFormSubFieldName(schema, ipt);\n          const field = localSchemaMap[subName];\n\n          if (\n            isTestsetFormSameFieldType(ipt.type, field?.type) &&\n            !isNil(field?.value)\n          ) {\n            ipt.value = field?.value;\n          }\n        });\n      } else {\n        // Creation mode: assigns default values\n        traverseTestsetNodeFormSchemas(remoteSchemas, (schema, ipt) => {\n          assignTestsetFormDefaultValue(ipt);\n        });\n      }\n\n      return remoteSchemas;\n    },\n    { refreshDeps: [testset] },\n  );\n\n  return {\n    schemas,\n    schemasLoading,\n  };\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type ChangeEvent, type FocusEvent } from 'react';\n\nimport {\n  Input,\n  withField,\n  type InputProps,\n  type CommonFieldProps,\n} from '@coze-arch/coze-design';\n\nimport styles from './name-input.module.less';\n\nconst TESTSET_NAME_MAX_LEN = 50;\n\nfunction count(val: unknown) {\n  return val ? `${val}`.length : 0;\n}\n\n/** The suffix & blur trim is required to expand the original input */\nfunction InnerInput(props: InputProps) {\n  const onBlur = (evt: FocusEvent<HTMLInputElement>) => {\n    props.onChange?.(\n      `${props.value ?? ''}`.trim(),\n      {} as unknown as ChangeEvent<HTMLInputElement>,\n    );\n    props.onBlur?.(evt);\n  };\n\n  return (\n    <Input\n      {...props}\n      maxLength={props.maxLength ?? TESTSET_NAME_MAX_LEN}\n      autoComplete=\"off\"\n      onBlur={onBlur}\n      suffix={\n        <div className={styles.suffix}>\n          {count(props.value)}/{props.maxLength ?? TESTSET_NAME_MAX_LEN}\n        </div>\n      }\n    />\n  );\n}\n\nexport const TestsetNameInput = withField(InnerInput, {}) as (\n  props: CommonFieldProps & InputProps,\n) => JSX.Element;\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Fragment, useMemo } from 'react';\n\nimport cls from 'classnames';\nimport { I18n } from '@coze-arch/i18n';\nimport {\n  Form,\n  FormSelect,\n  FormTextArea,\n  Avatar,\n  useFieldState,\n} from '@coze-arch/coze-design';\nimport { IntelligenceType } from '@coze-arch/bot-api/intelligence_api';\nimport { ComponentType } from '@coze-arch/bot-api/debugger_api';\n\nimport { useTestsetManageStore } from '../use-testset-manage-store';\nimport {\n  getTestsetFormSubFieldType,\n  getTestsetFormSubFieldName,\n  getTestsetFormItemPlaceholder,\n  getTestsetFormItemCustomProps,\n} from '../../../utils';\nimport {\n  type NodeFormSchema,\n  type FormItemSchema,\n  type ArrayFieldSchema,\n} from '../../../types';\nimport {\n  FormItemSchemaType,\n  TESTSET_FORM_BOOLEAN_SELECT_OPTIONS,\n  TESTSET_BOT_NAME,\n} from '../../../constants';\n\nimport styles from './edit-form-section.module.less';\n\n/** integer type form precision */\nconst INTEGER_PRECISION = 0.1;\n\n/** Bot field name fixed value */\nconst BOT_FIELD_NAME = `${TESTSET_BOT_NAME}_${ComponentType.CozeVariableBot}`;\n\ninterface EditFormSectionTitleProps {\n  schema: NodeFormSchema;\n}\n\nconst EditFormSectionTitle: React.FC<EditFormSectionTitleProps> = ({\n  schema,\n}) => {\n  const title = useMemo(() => {\n    // Currently only two nodes are start and variable\n    switch (schema.component_type) {\n      case ComponentType.CozeStartNode:\n        return I18n.t('workflow_testset_start_node');\n      case ComponentType.CozeVariableBot:\n        return I18n.t('workflow_testset_vardatabase_node');\n      case ComponentType.CozeVariableChat:\n        return I18n.t('wf_chatflow_72');\n      default:\n        return schema.component_name;\n    }\n  }, [schema]);\n\n  return (\n    <div className={styles['form-section-title']}>\n      {schema.component_icon ? (\n        <Avatar src={schema.component_icon} shape=\"square\" size=\"extra-small\" />\n      ) : null}\n      {title}\n    </div>\n  );\n};\n\ninterface FormLabelProps {\n  schema: FormItemSchema;\n}\n\nconst FormLabel: React.FC<FormLabelProps> = ({ schema }) => {\n  const label = useMemo(() => {\n    if (schema.type === FormItemSchemaType.BOT) {\n      return I18n.t('workflow_testset_vardatabase_tip');\n    } else if (schema.type === FormItemSchemaType.CHAT) {\n      return I18n.t('wf_chatflow_74');\n    }\n    return schema.name;\n  }, [schema]);\n  const typeLabel = useMemo(() => {\n    switch (schema.type) {\n      case FormItemSchemaType.STRING:\n      case FormItemSchemaType.FLOAT:\n      case FormItemSchemaType.NUMBER:\n      case FormItemSchemaType.OBJECT:\n      case FormItemSchemaType.BOOLEAN:\n      case FormItemSchemaType.INTEGER:\n      case FormItemSchemaType.TIME:\n        return getTestsetFormSubFieldType(schema.type);\n      case FormItemSchemaType.LIST: {\n        const subType = (schema.schema as ArrayFieldSchema).type;\n        return subType\n          ? `Array<${getTestsetFormSubFieldType(subType)}>`\n          : 'Array';\n      }\n      case FormItemSchemaType.BOT:\n        return '';\n      case FormItemSchemaType.CHAT:\n        return '';\n      default:\n        return schema.type;\n    }\n  }, [schema]);\n\n  return (\n    <div className={styles['form-item-label']}>\n      <div\n        className={cls(styles['label-text'], {\n          [styles.required]: schema.required,\n        })}\n      >\n        {label}\n      </div>\n      {typeLabel ? (\n        <div className={styles['label-type']}>{typeLabel}</div>\n      ) : null}\n    </div>\n  );\n};\n\ninterface FormItemProps {\n  schema: FormItemSchema;\n  formSchema: NodeFormSchema;\n  disabled?: boolean;\n  projectId?: string;\n}\nconst FormItem: React.FC<FormItemProps> = ({\n  schema,\n  formSchema,\n  disabled,\n  projectId,\n}) => {\n  const { type, name, required } = schema;\n  const { formRenders } = useTestsetManageStore(store => ({\n    formRenders: store.formRenders,\n  }));\n  const CustomFormItem = formRenders?.[type];\n  const fieldName = getTestsetFormSubFieldName(formSchema, schema);\n  const placeholder = getTestsetFormItemPlaceholder(schema);\n  const requiredMsg = I18n.t('workflow_testset_required_tip', {\n    param_name:\n      schema.type === FormItemSchemaType.BOT ||\n      schema.type === FormItemSchemaType.CHAT\n        ? ''\n        : name,\n  });\n\n  if (typeof CustomFormItem !== 'undefined') {\n    return (\n      <CustomFormItem\n        field={fieldName}\n        disabled={disabled}\n        rules={[{ required, message: requiredMsg }]}\n        noLabel={true}\n        placeholder={placeholder}\n        {...getTestsetFormItemCustomProps(schema, projectId)}\n      />\n    );\n  }\n\n  switch (type) {\n    case FormItemSchemaType.BOOLEAN:\n      return (\n        <FormSelect\n          className={styles['form-item-select']}\n          field={fieldName}\n          disabled={disabled}\n          rules={[{ required, message: requiredMsg }]}\n          optionList={TESTSET_FORM_BOOLEAN_SELECT_OPTIONS}\n          noLabel={true}\n          placeholder={placeholder}\n          showClear={!required}\n        />\n      );\n    case FormItemSchemaType.INTEGER:\n    case FormItemSchemaType.FLOAT:\n    case FormItemSchemaType.NUMBER:\n      return (\n        <Form.InputNumber\n          field={fieldName}\n          trigger={['change', 'blur']}\n          precision={\n            type === FormItemSchemaType.INTEGER ? INTEGER_PRECISION : undefined\n          }\n          rules={[{ required, message: requiredMsg }]}\n          disabled={disabled}\n          noLabel={true}\n          style={{ width: '100%' }}\n          placeholder={placeholder}\n        />\n      );\n    case FormItemSchemaType.OBJECT:\n    case FormItemSchemaType.LIST:\n      return (\n        <FormTextArea\n          field={fieldName}\n          trigger={['change', 'blur']}\n          rules={[{ required, message: requiredMsg }]}\n          disabled={disabled}\n          noLabel={true}\n          placeholder={placeholder}\n        />\n      );\n    case FormItemSchemaType.TIME:\n      return <Form.DatePicker type=\"dateTime\" field={fieldName} />;\n    case FormItemSchemaType.STRING:\n    default:\n      return (\n        <FormTextArea\n          field={fieldName}\n          autosize={{ minRows: 2, maxRows: 5 }}\n          trigger={['change', 'blur']}\n          rules={[{ required, message: requiredMsg }]}\n          disabled={disabled}\n          noLabel={true}\n          placeholder={placeholder}\n        />\n      );\n  }\n};\n\ninterface EditFormSectionProps {\n  schema: NodeFormSchema;\n  disabled?: boolean;\n}\n\nexport const EditFormSection: React.FC<EditFormSectionProps> = ({\n  schema,\n  disabled,\n}) => {\n  const { projectId } = useTestsetManageStore(store => ({\n    projectId: store.projectId,\n  }));\n\n  const botFieldValue = useFieldState(BOT_FIELD_NAME);\n\n  // Determine whether the application is selected, and only the selected application will echo the dialog component.\n  // The application is directly selected by default in the application, and the dialog component can be echoed.\n  const isBotSelectProject =\n    (botFieldValue?.value?.id &&\n      botFieldValue?.value?.type === IntelligenceType.Project) ||\n    projectId;\n\n  return (\n    <Form.Section\n      text={<EditFormSectionTitle schema={schema} />}\n      className={styles['edit-form-section']}\n    >\n      {schema.inputs\n        .filter(i => {\n          if (projectId && i.type === FormItemSchemaType.BOT) {\n            return false;\n          }\n          // The dialog component will only exist within the app\n          if (!isBotSelectProject && i.type === FormItemSchemaType.CHAT) {\n            return false;\n          }\n          return true;\n        })\n        .map((s, idx) => (\n          <Fragment key={idx}>\n            <FormLabel schema={s} />\n            <FormItem\n              schema={s}\n              formSchema={schema}\n              disabled={disabled}\n              projectId={botFieldValue?.value}\n            />\n          </Fragment>\n        ))}\n    </Form.Section>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useMemo,\n  useCallback,\n  useRef,\n  useState,\n  useEffect,\n} from 'react';\n\nimport { isNil, cloneDeep } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozArrowLeft } from '@coze-arch/coze-design/icons';\nimport {\n  Form,\n  FormTextArea,\n  Spin,\n  Button,\n  type FormApi,\n  Tooltip,\n  Toast,\n} from '@coze-arch/coze-design';\nimport {\n  type CaseDataDetail,\n  type CaseDataBase,\n} from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\n\nimport { useTestsetManageStore } from '../use-testset-manage-store';\nimport { AutoGenButton } from '../auto-gen-button';\nimport { ResizablePanel, type ResizablePanelRef } from '../../resizable-panel';\nimport {\n  traverseTestsetNodeFormSchemas,\n  getTestsetFormSubFieldName,\n  transTestsetBoolSelect2Bool,\n  transTestsetFormItemSchema2Form,\n  getTestsetNameRules,\n} from '../../../utils';\nimport { type NodeFormSchema } from '../../../types';\nimport {\n  FormItemSchemaType,\n  type TestsetFormValuesForBoolSelect,\n} from '../../../constants';\nimport { useEditFormSchemas } from './use-edit-form-schemas';\nimport { TestsetNameInput } from './name-input';\nimport { EditFormSection } from './edit-form-section';\n\nimport styles from './edit-form.module.less';\n\nconst TESTSET_NAME_FIELD = '__TESTSET_NAME__';\nconst TESTSET_DESC_FIELD = '__TESTSET_DESC__';\n\ninterface TestsetEditFormProps {\n  data?: CaseDataDetail | null;\n}\n\nexport const TestsetEditForm: React.FC<TestsetEditFormProps> = ({ data }) => {\n  const {\n    bizComponentSubject,\n    bizCtx,\n    editMode,\n    generating,\n    closeEditPanel,\n    updateEditPanelCloseState,\n  } = useTestsetManageStore(store => ({\n    bizCtx: store.bizCtx,\n    bizComponentSubject: store.bizComponentSubject,\n    editMode: store.editMode,\n    closeEditPanel: store.closeEditPanel,\n    generating: store.generating,\n    updateEditPanelCloseState: store.updateEditPanelCloseState,\n  }));\n\n  const { schemas, schemasLoading } = useEditFormSchemas(data);\n  const [validating, setValidating] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const formRef = useRef<FormApi<Record<string, any>>>();\n  const resizablePanelRef = useRef<ResizablePanelRef | null>(null);\n\n  const title = useMemo(\n    () => (\n      <span className={'flex items-center'}>\n        <IconCozArrowLeft\n          className={'mr-[7px] cursor-pointer'}\n          onClick={() => resizablePanelRef.current?.close?.()}\n        />\n        <span className={'font-medium'}>\n          {editMode === 'edit'\n            ? I18n.t('workflow_testset_edit_title')\n            : I18n.t('workflow_testset_create_title')}\n        </span>\n      </span>\n    ),\n    [editMode],\n  );\n\n  const handleClose = useCallback(() => {\n    closeEditPanel();\n  }, [closeEditPanel]);\n\n  const handleUpdateCloseState = useCallback(() => {\n    updateEditPanelCloseState(false);\n  }, [updateEditPanelCloseState]);\n\n  const handleSubmit = async () => {\n    setValidating(true);\n    try {\n      await formRef.current?.validate();\n      const errors = formRef.current?.getFormState().errors;\n\n      if (Object.keys(errors ?? {}).length) {\n        return;\n      }\n\n      onSubmit();\n    } finally {\n      setValidating(false);\n    }\n  };\n\n  const onSubmit = async () => {\n    setSubmitting(true);\n    try {\n      const testsetFormValues = formRef.current?.getValues();\n\n      if (!testsetFormValues) {\n        return;\n      }\n\n      const inputSchemas = cloneDeep(schemas ?? []);\n      traverseTestsetNodeFormSchemas(inputSchemas, (schema, ipt) => {\n        const val = testsetFormValues[getTestsetFormSubFieldName(schema, ipt)];\n\n        if (!isNil(val)) {\n          ipt.value = val;\n        }\n\n        // Clears null values of objects/arrays, including empty strings\n        if (\n          !val &&\n          (ipt.type === FormItemSchemaType.LIST ||\n            ipt.type === FormItemSchemaType.OBJECT)\n        ) {\n          ipt.value = undefined;\n        }\n\n        // Bool type, you need to convert the enumeration to a boolean\n        if (ipt.type === FormItemSchemaType.BOOLEAN) {\n          ipt.value = transTestsetBoolSelect2Bool(\n            ipt.value as TestsetFormValuesForBoolSelect,\n          );\n        }\n      });\n\n      const caseBase: CaseDataBase = {\n        name: testsetFormValues[TESTSET_NAME_FIELD],\n        caseID: data?.caseBase?.caseID,\n        description: testsetFormValues[TESTSET_DESC_FIELD],\n        input: JSON.stringify(inputSchemas),\n      };\n\n      await debuggerApi.SaveCaseData({\n        bizComponentSubject,\n        bizCtx,\n        caseBase,\n      });\n\n      Toast.success(I18n.t('Save_success'));\n      handleClose();\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleGenerate = useCallback(\n    (nextSchemas: NodeFormSchema[]) => {\n      const formValues = formRef.current?.getValues() || {};\n      const validateFields: string[] = [];\n\n      traverseTestsetNodeFormSchemas(nextSchemas, (schema, ipt) => {\n        const fieldName = getTestsetFormSubFieldName(schema, ipt);\n        const value = transTestsetFormItemSchema2Form(ipt)?.value;\n        if (!isNil(value)) {\n          formValues[fieldName] = value;\n          validateFields.push(fieldName);\n        }\n      });\n\n      formRef.current?.setValues(formValues);\n      // Check again after setting the value\n      formRef.current?.validate(validateFields);\n    },\n    [formRef],\n  );\n\n  useEffect(() => {\n    formRef.current?.setValues({\n      [TESTSET_NAME_FIELD]: data?.caseBase?.name ?? '',\n      [TESTSET_DESC_FIELD]: data?.caseBase?.description,\n    });\n  }, [data]);\n\n  useEffect(() => {\n    if (typeof schemas === 'undefined') {\n      return;\n    }\n    const values = formRef.current?.getValues() ?? {};\n    traverseTestsetNodeFormSchemas(\n      schemas,\n      (schema, ipt) =>\n        (values[getTestsetFormSubFieldName(schema, ipt)] =\n          transTestsetFormItemSchema2Form(ipt)?.value),\n    );\n    formRef.current?.setValues(values);\n  }, [schemas]);\n\n  return (\n    <ResizablePanel\n      className={styles['edit-form-resizeable-panel']}\n      draggable={false}\n      animation={'slide'}\n      ref={resizablePanelRef}\n      header={title}\n      onClose={handleClose}\n      onCloseWithoutAnimation={handleUpdateCloseState}\n      footer={\n        <Tooltip\n          content={I18n.t('workflow_testset_submit_tooltip_for_expert_mode')}\n        >\n          <Button\n            color=\"hgltplus\"\n            style={{ width: '100%' }}\n            disabled={generating}\n            loading={validating || submitting}\n            onClick={handleSubmit}\n          >\n            {I18n.t('workflow_testset_edit_confirm')}\n          </Button>\n        </Tooltip>\n      }\n    >\n      <div className={styles['edit-form']}>\n        <Form<Record<string, unknown>>\n          showValidateIcon={false}\n          getFormApi={api => (formRef.current = api)}\n        >\n          <TestsetNameInput\n            field={TESTSET_NAME_FIELD}\n            trigger=\"blur\"\n            stopValidateWithError={true}\n            label={I18n.t('workflow_testset_name')}\n            placeholder={I18n.t('workflow_testset_name_placeholder')}\n            rules={getTestsetNameRules({\n              bizCtx,\n              bizComponentSubject,\n              originVal: data?.caseBase?.name,\n              isOversea: IS_OVERSEA,\n            })}\n          />\n\n          <div className={styles['edit-form-desc-input']}></div>\n          <FormTextArea\n            field={TESTSET_DESC_FIELD}\n            label={I18n.t('workflow_testset_desc')}\n            placeholder={I18n.t('workflow_testset_desc_placeholder')}\n            autosize={true}\n            maxCount={200}\n            maxLength={200}\n            rows={2}\n          />\n          <div className={styles['edit-form-title']}>\n            <span className={styles['title-text']}>\n              {I18n.t('workflow_testset_node_data')}\n            </span>\n            {IS_OVERSEA || IS_BOE ? (\n              <AutoGenButton onGenerate={handleGenerate} />\n            ) : null}\n          </div>\n          {schemasLoading ? <Spin /> : null}\n          {!schemasLoading && schemas?.length\n            ? schemas.map(schema => (\n                <EditFormSection\n                  key={schema.component_id}\n                  schema={schema}\n                  disabled={generating}\n                />\n              ))\n            : null}\n        </Form>\n      </div>\n    </ResizablePanel>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  useMemo,\n  useCallback,\n  useRef,\n  useState,\n  useEffect,\n} from 'react';\n\nimport { isNil, cloneDeep } from 'lodash-es';\nimport { I18n } from '@coze-arch/i18n';\nimport { IconCozCross, IconCozArrowLeft } from '@coze-arch/coze-design/icons';\nimport {\n  Form,\n  FormTextArea,\n  Spin,\n  Button,\n  type FormApi,\n  Tooltip,\n  Toast,\n} from '@coze-arch/coze-design';\nimport { IconButton, Typography } from '@coze-arch/coze-design';\nimport {\n  type CaseDataDetail,\n  type CaseDataBase,\n} from '@coze-arch/bot-api/debugger_api';\nimport { debuggerApi } from '@coze-arch/bot-api';\n\nimport { useTestsetManageStore } from '../use-testset-manage-store';\n// import { AutoGenButton } from '../auto-gen-button';\nimport {\n  traverseTestsetNodeFormSchemas,\n  getTestsetFormSubFieldName,\n  transTestsetBoolSelect2Bool,\n  transTestsetFormItemSchema2Form,\n  getTestsetNameRules,\n} from '../../../utils';\n// import { type NodeFormSchema } from '../../../types';\nimport {\n  FormItemSchemaType,\n  type TestsetFormValuesForBoolSelect,\n} from '../../../constants';\nimport { useEditFormSchemas } from './use-edit-form-schemas';\nimport { TestsetNameInput } from './name-input';\nimport { EditFormSection } from './edit-form-section';\n\nimport styles from './chat-flow-edit-form.module.less';\n\nconst TESTSET_NAME_FIELD = '__TESTSET_NAME__';\nconst TESTSET_DESC_FIELD = '__TESTSET_DESC__';\n\ninterface TestsetEditFormProps {\n  data?: CaseDataDetail | null;\n  onParentClose?: () => void;\n}\n\nexport const ChatFlowTestsetEditForm: React.FC<TestsetEditFormProps> = ({\n  data,\n  onParentClose,\n}) => {\n  const { bizComponentSubject, bizCtx, editMode, generating, closeEditPanel } =\n    useTestsetManageStore(store => ({\n      bizCtx: store.bizCtx,\n      bizComponentSubject: store.bizComponentSubject,\n      editMode: store.editMode,\n      closeEditPanel: store.closeEditPanel,\n      generating: store.generating,\n    }));\n\n  const { schemas, schemasLoading } = useEditFormSchemas(data);\n  const [validating, setValidating] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const formRef = useRef<FormApi<Record<string, any>>>();\n\n  const title = useMemo(\n    () =>\n      editMode === 'edit'\n        ? I18n.t('workflow_testset_edit_title')\n        : I18n.t('workflow_testset_create_title'),\n    [editMode],\n  );\n\n  const handleClose = useCallback(() => {\n    closeEditPanel();\n  }, [closeEditPanel]);\n\n  const handleSubmit = async () => {\n    setValidating(true);\n    try {\n      await formRef.current?.validate();\n      const errors = formRef.current?.getFormState().errors;\n\n      if (Object.keys(errors ?? {}).length) {\n        return;\n      }\n\n      onSubmit();\n    } finally {\n      setValidating(false);\n    }\n  };\n\n  const onSubmit = async () => {\n    setSubmitting(true);\n    try {\n      const testsetFormValues = formRef.current?.getValues();\n\n      if (!testsetFormValues) {\n        return;\n      }\n\n      const inputSchemas = cloneDeep(schemas ?? []);\n      traverseTestsetNodeFormSchemas(inputSchemas, (schema, ipt) => {\n        const val = testsetFormValues[getTestsetFormSubFieldName(schema, ipt)];\n\n        if (!isNil(val)) {\n          ipt.value = val;\n        }\n\n        // Clears null values of objects/arrays, including empty strings\n        if (\n          !val &&\n          (ipt.type === FormItemSchemaType.LIST ||\n            ipt.type === FormItemSchemaType.OBJECT)\n        ) {\n          ipt.value = undefined;\n        }\n\n        // Bool type, you need to convert the enumeration to a boolean\n        if (ipt.type === FormItemSchemaType.BOOLEAN) {\n          ipt.value = transTestsetBoolSelect2Bool(\n            ipt.value as TestsetFormValuesForBoolSelect,\n          );\n        }\n      });\n\n      const caseBase: CaseDataBase = {\n        name: testsetFormValues[TESTSET_NAME_FIELD],\n        caseID: data?.caseBase?.caseID,\n        description: testsetFormValues[TESTSET_DESC_FIELD],\n        input: JSON.stringify(inputSchemas),\n      };\n\n      await debuggerApi.SaveCaseData({\n        bizComponentSubject,\n        bizCtx,\n        caseBase,\n      });\n\n      Toast.success(I18n.t('Save_success'));\n      handleClose();\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // const handleGenerate = useCallback(\n  //   (nextSchemas: NodeFormSchema[]) => {\n  //     const formValues = formRef.current?.getValues() || {};\n  //     const validateFields: string[] = [];\n\n  //     traverseTestsetNodeFormSchemas(nextSchemas, (schema, ipt) => {\n  //       const fieldName = getTestsetFormSubFieldName(schema, ipt);\n  //       const value = transTestsetFormItemSchema2Form(ipt)?.value;\n  //       if (!isNil(value)) {\n  //         formValues[fieldName] = value;\n  //         validateFields.push(fieldName);\n  //       }\n  //     });\n\n  //     formRef.current?.setValues(formValues);\n  //     //Check again after setting the value\n  //     formRef.current?.validate(validateFields);\n  //   },\n  //   [formRef],\n  // );\n\n  useEffect(() => {\n    formRef.current?.setValues({\n      [TESTSET_NAME_FIELD]: data?.caseBase?.name ?? '',\n      [TESTSET_DESC_FIELD]: data?.caseBase?.description,\n    });\n  }, [data]);\n\n  useEffect(() => {\n    if (typeof schemas === 'undefined') {\n      return;\n    }\n    const values = formRef.current?.getValues() ?? {};\n    traverseTestsetNodeFormSchemas(\n      schemas,\n      (schema, ipt) =>\n        (values[getTestsetFormSubFieldName(schema, ipt)] =\n          transTestsetFormItemSchema2Form(ipt)?.value),\n    );\n    formRef.current?.setValues(values);\n  }, [schemas]);\n\n  return (\n    <div className={styles['edit-form']}>\n      <div className={styles['panel-header']}>\n        <div className={styles['header-title']}>\n          <IconButton\n            icon={<IconCozArrowLeft />}\n            color=\"secondary\"\n            onClick={handleClose}\n          />\n          <Typography.Text strong fontSize=\"16px\">\n            {title}\n          </Typography.Text>\n        </div>\n        <IconButton\n          icon={<IconCozCross />}\n          color=\"secondary\"\n          onClick={onParentClose}\n        />\n      </div>\n      <div className={styles['panel-content']}>\n        <Form<Record<string, unknown>>\n          showValidateIcon={false}\n          getFormApi={api => (formRef.current = api)}\n        >\n          <TestsetNameInput\n            field={TESTSET_NAME_FIELD}\n            trigger=\"blur\"\n            stopValidateWithError={true}\n            label={I18n.t('workflow_testset_name')}\n            placeholder={I18n.t('workflow_testset_name_placeholder')}\n            rules={getTestsetNameRules({\n              bizCtx,\n              bizComponentSubject,\n              originVal: data?.caseBase?.name,\n              isOversea: IS_OVERSEA,\n            })}\n          />\n          <div className={styles['edit-form-desc-input']}></div>\n\n          <FormTextArea\n            field={TESTSET_DESC_FIELD}\n            label={I18n.t('workflow_testset_desc')}\n            placeholder={I18n.t('workflow_testset_desc_placeholder')}\n            autosize={true}\n            maxCount={200}\n            maxLength={200}\n            rows={2}\n          />\n          <div className={styles['edit-form-title']}>\n            <span className={styles['title-text']}>\n              {I18n.t('workflow_testset_node_data')}\n            </span>\n            {/* {IS_OVERSEA || IS_BOE ? (\n              <AutoGenButton onGenerate={handleGenerate} />\n            ) : null} */}\n          </div>\n          {schemasLoading ? <Spin /> : null}\n          {!schemasLoading && schemas?.length\n            ? schemas.map(schema => (\n                <EditFormSection\n                  key={schema.component_id}\n                  schema={schema}\n                  disabled={generating}\n                />\n              ))\n            : null}\n        </Form>\n      </div>\n      <div className={styles['panel-footer']}>\n        <Tooltip\n          content={I18n.t('workflow_testset_submit_tooltip_for_expert_mode')}\n        >\n          <Button\n            color=\"hgltplus\"\n            style={{ width: '100%' }}\n            disabled={generating}\n            loading={validating || submitting}\n            onClick={handleSubmit}\n          >\n            {I18n.t('workflow_testset_edit_confirm')}\n          </Button>\n        </Tooltip>\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useTestsetManageStore } from '../use-testset-manage-store';\nimport { TestsetEditForm } from './edit-form';\nimport { ChatFlowTestsetEditForm } from './chat-flow-edit-form';\n\ninterface TestsetEditPanelProps {\n  isChatFlow?: boolean;\n  onParentClose?: () => void;\n}\n\nexport const TestsetEditPanel: React.FC<TestsetEditPanelProps> = ({\n  isChatFlow,\n  onParentClose,\n}) => {\n  const { editPanelVisible, editData } = useTestsetManageStore(store => ({\n    editPanelVisible: store.editPanelVisible,\n    editData: store.editData,\n  }));\n\n  if (!editPanelVisible) {\n    return null;\n  }\n\n  return isChatFlow ? (\n    <ChatFlowTestsetEditForm data={editData} onParentClose={onParentClose} />\n  ) : (\n    <TestsetEditForm data={editData} />\n  );\n};\n","/*\n * Copyright 2025 coze-dev Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { I18n } from '@coze-arch/i18n';\nimport { Typography } from '@coze-arch/coze-design';\n\nimport styles from './input-form-empty.module.less';\n\nexport const InputFormEmpty = () => (\n  <div className={styles['input-form-empty']}>\n    <Typography.Text className={'text-[12px] coz-fg-dim'}>\n      {I18n.t('workflow_testrun_input_form_empty')}\n    </Typography.Text>\n  </div>\n);\n"],"names":["questionLimit","props","BaseQuestionLimit","radio","styles","BaseRadio","select","value","onChange","options","readonly","selectOptions","size","style","emptyContent","getNodeSetterId","concatTestId","useNodeTestId","testId","onSelect","React","selectedOption","UISelect","I18n","settingOnErrorSetter","withValidation","context","SettingOnError","slider","max","min","step","marks","UISlider","isNil","undefined","Number","val","MessageGenerateMode","SpeakerType","useNormalizeValueWithRoleList","remoteValue","isLoading","roleList","useGetSceneFlowRoleList","item","role","_role","ValueDisplay","ContentDisplay","Tooltip","VariableTypeTag","RoleMessageSetValueDisplay","NicknameMessageSetValueDisplay","Placeholder","isRoleMessageSetValue","isRoleSpeakerValue","useGetRoleSpeakerDataSource","emptyNickNameIdx","_item_nickname","Space","useGetNicknameSpeakerDataSource","inputsParameters","useGetCurrentInputsParameters","ViewVariableType","VARIABLE_TYPE_ALIAS_MAP","SpeakerMessageSetArrayContext","createContext","SpeakerMessageSetArrayContextProvider","useSpeakerMessageSetContext","useContext","SpeakerSelect","withField","arrayValue","roleDataSource","nicknameDataSource","selectValue","setSelectValue","useState","speakerType","setSpeakerType","useEffect","outerTopSlotNode","RadioGroup","e","Radio","normalizeDataSource","dataSource","key","arrayValueWithoutSelectValue","_value","Select","record","MessageContentField","placeholder","validateStatus","ExpressionEditorContainer","Form","formatInitialValue","initValue","MessageSetForm","_formValue_speaker","_formValue_speaker1","initialValue","onSubmit","onCancel","setterContext","formRef","useRef","formValue","setFormValue","values","_ref","speaker","others","_formRef_current","RoleType","classnames","Button","SpeakerMessageSet","defaultFocused","onVisibleChange","index","popupVisible","setPopupVisible","handleSubmit","data","handleVisibleChange","visible","ValidationErrorWrapper","Popover","speakerMessageSetArray","sortable","currentAddIndexRef","node","useCurrentEntity","handleItemChange","_item","_index","handleDeleteItem","SortableList","dragOption","DragHandle","IconButton","IconNo","IconAdd","playgroundContext","globalState","res","workflowQueryClient","Infinity","SocialApi","speakerMessageSetSchema","z","existRole","parseResult","_JSON_parse","itemParseResult","JSON","buf","sql","setKey","AutoGenerate","newValue","ExpressionEditor","useNl2SqlMutation","databaseID","useCurrentDatabaseID","nl2sql","isFetching","useMutation","text","MemoryApi","Result","Spin","AutoGenerateButton","onClick","className","disabled","IconCozAiFill","formValues","setFormValues","isAutoGenerateEnabled","useEnabled","IconClose","BotSemiForm","formState","setVisible","prev","switchSetter","onValueChange","useCallback","checked","memoStyle","useMemo","UISwitch","SystemPromptEditor","defaultValue","wrapperClassName","wrapperStyle","isControled","dataTestID","onFocus","onBlur","isFocused","setIsFocused","_document_getElementById","WORKFLOW_PLAYGROUND_CONTENT_ID","document","PromptEditorRender","ExpandSheetEditor","_props_options","variableTree","useVariableTree","editor","useEditor","prompt","setFullscreenPanel","useNodeFormPanelState","spaceId","name","desc","useGlobalState","testRunResult","useTestRunResult","contextHistory","useLLMPromptHistory","getConversationId","getPromptContextInfo","NLPromptButton","UIIconButton","IconCozCrossFill","InputSlotWidget","LibraryBlockWidget","NlPromptShortcut","HighlightExpressionOnActive","Completion","Validation","ActionBar","NlPromptAction","InsertInputSlotAction","RecommendPannel","insertPrompt","NLPromptModal","PromptKitBar","openPromptLibrary","fullscreenPanel","fullscreenPanelVisible","IconCozKnowledge","PublicScopeProvider","PromptEditorProvider","IconCozMinimize","IconCozExpand","EditorWithPromptKit","feedbackText","feedbackStatus","projectId","workflowId","promptValue","open","PromptLibrary","usePromptLibraryModal","s","FormCard","classNames","v","systemPrompt","NLPromptProvider","temperature","InputNumber","textArea","UITextArea","textDisplay","Text","DEFAULT_TIME_ZONE","DEFAULT_TIME_ZONE_OFFSET","UNKNOWN_TIME_ZONE_OFFSET","dayjs","isoWeek","quartersOfYear","dayjsUTC","dayjsTimezone","generatedTimezones","timezoneOptions","timezoneMap","_I18n_language","locale","Intl","formatDateParts","Date","timeZoneName","find","targetTime","orderBy","toPairs","groupBy","_find","offset","itemKey","itemValue","error","logger","timezone","noop","showClear","TIME_ZONE_OPTIONS","TIME_ZOME_MAP","timezoneOptionsBase","cloneDeep","timezoneMapBase","timezoneValue","findTimezoneValue","nodes","Array","offsetValue","timezoneLabel","option","Cascader","first","second","inputValue","keyword","firstLabelLowerCase","secondLabelLowerCase","firstLabelArray","secondLabelArray","filterRenderProps","cls","labelString","Highlight","newTimezone","ValueExpressionType","sendTeaEvent","EVENT_NAMES","toStandardSetter","Setter","setterTestId","feedbackStatus2ValidateStatus","ObserverSetter","triggerBindWorkflow","selectedWorkflowInfo","getProjectApi","playgroundProps","projectApi","openWorkflowDetail","useOpenWorkflowDetail","sourceTitle","workflowModal","openWorkflow","closeWorkflow","useWorkflowModal","WorkflowModalFrom","WorkflowMode","config","ModalI18nKey","isWfInvalid","isLibraryWf","IconCozPlus","IconNameDescCard","window","triggerList","_list_list","currentPage","setPage","loading","setLoading","list","setList","latestLoading","useLatest","loadTriggerList","page","_triggerList_data_trigger_list_map","_triggerList_data_total","workflowApi","TriggerSetType","d","_d_config","console","testRunning","setTestRunning","testRun","_result_data","_result_data1","_d_triggerId","result","columns","cronJobTranslator","IconCozPlayCircle","IconCozTrashCan","Toast","IconCozTrigger","IS_BOT_OP","IconCozEye","Modal","IconCozRefresh","Notify","EmptyState","IconCozIllusEmpty","IconCozIllusEmptyDark","Table","pageSize","triggerParameterTitle","nameLabel","valueLabel","nameWidth","valueExpressionInput","globalReadonly","literalStyle","disabledTypes","availableFileTypes","literalDisabled","refDisabled","hideDeleteIcon","hideSettingIcon","variableTagStyle","setterReadonly","inputType","constantType","customFilterVar","literalConfig","inputPlaceholder","variablesDataSource","useRefInputProps","ValueExpressionInputComponent","meta","required","valueExpressionValidator","variableSelect","param","forArrayItem","VariableSelector","get","innerValue","viewVariableSelect","validation","setValidation","variableService","useService","WorkflowVariableService","keyPath","useVariableChange","variableMeta","optionFilter","subVariableMeta","emptyErrorMessage","variableValidationService","ValueExpression","children","FormProvider","baseFieldToField","baseField","baseFieldState","RequiredStar","IconInfo","tooltip","IconCozInfoCircle","Label","extra","FieldLayout","label","labelExtra","layout","Feedback","Field","hasFeedback","deps","field","formReadonly","useFormContext","BaseField","_field_errors_","fieldState","FieldProvider","FieldArray","fieldArray","BaseFieldArray","baseFieldArrayToFieldArray","newItem","from","to","FieldArrayProvider","IconRemove","IconCozMinus","FieldArrayItem","containerClassName","removeIconClassName","disableDelete","hiddenDelete","onDelete","disableRemove","hiddenRemove","onRemove","removeTestId","FieldArrayList","FieldEmpty","isEmpty","IconCozEmpty","Section","forwardRef","ref","title","tooltipClassName","actions","emptyText","collapsible","noPadding","headerClassName","formCardRef","useImperativeHandle","_formCardRef_current","AddButton","dataTestId","ColumnTitles","SortableItem","sortableID","hanlderClassName","isInIDE","Draggable","provided","snapshot","getCanvasOffset","x","y","IconCozHandle","onSortEnd","DragDropContext","Droppable","BaseSelect","FormContext","Error","FieldContext","useFieldContext","FieldArrayContext","useFieldArrayContext","InputField","errors","useField","Input","InputNumberField","CozInputNumber","SelectField","Checkbox","SwitchField","Switch","SliderField","Slider","TextArea","cx","RadioGroupField","rest","Cpt","Component","innerProps","withFieldArray","useForm","_baseForm_validate","baseForm","useBaseForm","useFieldArray","useWatch","useBaseWatch","useSectionRef","useLatestWorkflowJson","workflowDocument","WorkflowDocument","saveService","WorkflowSaveService","getLatestWorkflowJson","useWorkflowRunService","WorkflowRunService","useTestRunReporterService","TestRunReporterService","useScrollToNode","selectServices","WorkflowSelectService","playground","usePlayground","nodeId","success","useScrollToLine","lineService","useLineService","selectionService","SelectionService","fromId","toId","line","bounds","Rectangle","viewport","zoom","SizeSchema","pickSimpleNodeRenderData","pick","useNodeRenderData","initialRenderData","FlowNodeRenderData","nodeRenderData","setNodeRenderData","disposable","useRedoUndo","historyService","HistoryService","WorkflowHistoryConfig","useInputs","workflowNode","useWorkflowNode","i","_i_input_content","useInputVariables","needNullName","needNullType","availableVariables","useNodeAvailableVariablesWithNode","inputs","_variables","inputsWithVariables","ExpressionEditorTreeHelper","_v_variable","variables","setVariables","useThrottleEffect","useRoleService","RoleService","useRoleServiceStore","selector","roleService","useVariableService","useTestFormState","useConfigEntity","WorkflowTestFormStateEntity","useOpenTraceListPanel","floatLayoutService","useFloatLayoutService","LayoutPanelKey","useDependencyService","WorkflowDependencyService","useDependencyEntity","WorkflowDependencyStateEntity","useDataSetInfos","ids","dataSets","setDataSets","isReady","setReady","sharedDataSetStore","dependencyService","disposeRef","getDataSetInfos","_ids","_dataSets","source","MessageBizType","_disposeRef_current","useSaveService","useDatabaseNodeService","DatabaseNodeService","useDatabaseServiceStore","databaseNodeService","_data_inputs","_databaseList_","_data_databaseInfoList","databaseList","useCurrentDatabaseQuery","currentDatabaseID","useNewDatabaseQuery","id","getDatabaseDetail","getError","useShallow","state","rawData","transformRawDatabaseToDatabase","rawDatabase","_rawDatabase_field_list","fieldItemTypeToViewVariableType","type","typeMap","FieldItemType","useRelatedBotService","RelatedCaseDataService","createEncapsulatePlugin","createWorkflowEncapsulatePlugin","ctx","EntityManager","WorkflowGlobalStateEntity","WorkflowPlaygroundContext","relatedCaseDataService","useWorkflowPreset","createFreeLinesPlugin","LineAddButton","createWorkflowVariablePlugins","createFreeHistoryPlugin","createOperationReportPlugin","createMinimapPlugin","createFreeSnapPlugin","createFreeNodePanelPlugin","NodePanel","createHistoryNodePlugin","createContainerNodePlugin","createTestRunPlugin","useWorkflowModels","_modelsService_getModels","modelsService","WorkflowModelsService","models","setModels","bizTypeToDependencyTypeMap","DependencySourceType","useNodeVersionService","NodeVersionService","createApiNodeInfo","apiParams","templateIcon","plugin_name","api_id","plugin_id","version_ts","plugin_from","BlockInput","createSubWorkflowNodeInfo","workflowItem","isImageflow","workflow_id","version_name","semver","AddNodeModalCloseResult","Typography","useAddNodeModal","prevAddNodeRef","_globalState_config","_globalState_config1","useSpaceId","nodeVersionService","addNodeCallbackRef","onCloseRef","addNodeModalCloseResultRef","editService","WorkflowEditService","nodesService","WorkflowNodesService","createOpenWorkflowModalCallback","_playgroundContext_getTemplateList_","StandardNodeType","nodeJSON","position","isDrag","openWorkflowModalCallback","openImageflowModalCallback","onCloseModal","workflowModalFrom","_globalState_playgroundProps","modalState","isSelectProjectCategory","imageFlowModal","openImageflow","closeImageflow","pluginModalFrom","From","pluginModal","openPlugin","closePlugin","usePluginApisModal","pluginInfo","_playgroundContext_getNodeTemplateInfoByType","wrapOpenFunc","openFunc","closeFunc","onAdd","closeOnAdd","onClose","modalProps","_args_","_nodeJSON_data_nodeMeta","args","useAddNode","handleAddSubWorkflow","coord","nodeType","nodeJson","nodeVersionInfo","pluginId","versionName","getWorkflowVersionByPluginId","set","handleAddPlugin","version","handleAddNode","updateAddNodePosition","useBizIDEStateStore","create","uniqueId","isBizIDEOpen","isBizIDETesting","useBizIDEState","setUniqueId","setIsBizIDEOpen","setIsBizIDETesting","setData","openSideSheet","closeSideSheet","forceClose","useSingletonInnerSideSheet","openBizIDE","closeBizIDE","closed","closeConfirm","Promise","resolve","IconWarningInfo","forceCloseBizIDE","EditorTheme","EditorThemeContext","_next","useEditorThemeState","useExecStateEntity","useEntity","WorkflowExecStateEntity","WorkflowFloatLayoutService","useFloatLayoutSize","setSize","warn","once","throttle","useQuerySceneFlowMetaRole","isSceneFlow","useGetWorkflowMode","bindBizID","useQuery","useGetSceneFlowBot","_res_role_list","host","isImageFlow","isChatflow","listenChange","WorkflowLinesService","useNodeRenderScene","scene","NodeRenderSceneContext","useNodeSideSheetStore","width","NodeFormPanelContext","formatWithNodeVariables","hasDisabledTypes","listener","useVariableTypeChange","useRefInputNode","invalidContent","renderDisplayVarName","setFocused","refTagColor","renderExtraOption","enableSelectNode","popoverStyle","handleDataSource","variableTypeConstraints","onRefChange","handleRefRemove","focused","setStateFocused","_setFocused","renderVariableSelect","trigger","_value_content","renderVariableDisplay","IconCozApply","RefValueDisplay","useRefInput","NAME","useResizableSidePanelStore","devtools","persist","IS_DEV_MODE","useTemplateService","WorkflowTemplateStateEntity","useTestRun","callbacks","onBeforeTestRun","onTestRunStart","onTestRunEnd","onTestRunFailed","onTestRunCanceled","onTestRunSucceed","runService","executeId","isSingleMode","isSingleModeRef","onTestRunStateChange","testRunState","testRunFlow","useTestRunFlow","testRunInstance","TestRunState","dispose","prevState","curState","useUpdateSortedPortLines","calcPortId","startIndex","endIndex","oldPortInfo","newPortInfo","WorkflowNodePortsData","PREVIEW_IMAGE_TYPE","MAX_IMAGE_SIZE","MAX_FILE_SIZE","FileItemStatus","useUpload","customValidate","timeout","fileType","multiple","maxSize","accept","maxFileCount","fileList","setFileList","isUploading","file","updateFileItemProps","uid","fileItemProps","prevList","newList","Object","uploadFileWithProgress","progressTimer","doUpload","upLoadFile","percent","setTimeout","uri","CustomError","clearTimeout","url","validateFile","validateMsg","validate","upload","nanoid","errorInfo","canUpload","deleteFile","_fileList","formatBytes","bytes","decimals","Math","sizes","parseFloat","ACCEPT_MAP","getAccept","itemType","_ACCEPT_MAP_type","items","getFileExtension","sizeValidate","_getImageSize","URL","reject","img","imageSizeValidate","rule","maxWidth","minWidth","maxHeight","minHeight","aspectRatio","height","getImageSize","acceptValidate","fileName","mimeType","acceptList","fileExtension","mime","Boolean","rules","imageSize","validators","errorMsg","validator","useValidateWorkflow","validationService","useValidationService","feValidate","hasError","feErrorMap","beValidate","feHasError","beHasError","useWatchValidateWorkflow","debounceValidate","useMemoizedFn","debounce","globalVariableService","GlobalVariableService","globalVariableDispose","DisposableCollection","contentChangeDispose","useWorkflowOperation","WorkflowOperationService","useWorkflowReferences","operation","getWorkflowReferences","workflowList","refetch","BatchPath","BatchSize","BatchFunctionSize","BatchInputNameValidator","createNodeInputNameValidate","_get","batchInputs","input","BatchOutputNameValidator","batchOutputs","BatchInputValueValidator","createValueExpressionInputValidate","BatchConcurrentSizeField","FormItem","ValueExpressionInput","BatchInputsField","InputsField","BatchOutputsField","LoopOutputsField","BatchSizeField","BatchSettingsSection","BatchFormRender","NodeConfigForm","PrivateScopeProvider","BATCH_FORM_META","ValidateTrigger","nodeMetaValidate","fireNodeTitleChange","provideLoopInputsVariablesEffect","provideLoopOutputsVariablesEffect","formData","_formData_inputs","_formData_inputs1","_formData_inputs2","inputParameters","outputValues","concurrentSize","batchSize","outputValue","variableUtils","_outputValue_input_content_keyPath","_dto_input","_dto_input1","dto","BatchFunctionIDPrefix","getBatchFunctionID","batchID","getBatchID","batchFunctionID","createBatchFunctionJSON","FlowNodeBaseType","FlowRendererKey","transform","mousePos","FlowNodeTransformData","parentNodeID","canvasNode","parentNode","createBatchFunctionLines","params","delay","batchId","batchFunctionId","createBatchFunctionTemplateData","batchNode","batchFunctionNode","batchNodeDataEntity","WorkflowNodeData","batchFunctionNodeDataEntity","batchNodeData","createBatchFunction","batchJson","_batchJson_meta_position","_batchJson_meta_position1","batchPosition","batchFunctionJSON","BATCH_NODE_REGISTRY","DEFAULT_NODE_META_PATH","DEFAULT_OUTPUTS_PATH","canvasNodeID","test","_","isInProject","related","getRelatedInfo","generateEnvToRelatedContextProperties","formModel","FlowNodeFormData","generateParametersToProperties","parameters","json","BatchPort","Port","BatchContent","InputParameters","Outputs","FormRender","BREAK_FORM_META","BREAK_NODE_REGISTRY","BreakContent","INPUT_PATH","CODE_PATH","OUTPUT_PATH","DEFAULT_OUTPUTS","DEFAULT_INPUTS","CodeField","_errors_","outputParams","inputParams","useReadonly","flowNodeEntity","ConfigProvider","CodeSetterContext","CodeEditorWithBizIDE","form","InputsParametersField","OutputsField","CODE_FORM_META","createInputTreeValidator","createCodeInputsValidator","outputTreeMetaValidator","provideNodeOutputVariablesEffect","isBindDouyin","defaultCodeParams","getDefaultValue","CODE_NODE_REGISTRY","DEFAULT_NODE_SIZE","CodeContent","Header","extraOperation","nodeDisabled","readonlyAllowDeleteOperation","defaultNodeMeta","useDefaultNodeMeta","wrappedNode","WorkflowNode","triggerIsOpen","showTrigger","_wrappedNode_registry_meta","_wrappedNode_registry_meta1","NodeHeader","batchModePath","isSettingOnError","useIsSettingOnError","ViewDataTypeMap","DataTypeTag","Tag","ImageModelSelectField","EnumImageModel","ExpressionEditorField","minRows","maxLength","disableSuggestion","disableCounter","testIDSuffix","align","isBreakLine","Timezone","hoursLeaf","weekDaysNode","monthDaysNode","intervalDaysNode","triggeredEveryday","triggeredEveryweek","triggeredMonthly","triggeredInterval","treeData","createCron","schedule","head","cronGenerator","CronGenerator","hour","day","hour1","isUndefined","ReportEventNames","parseCron","cronExpr","_cronExpr_split_call","cronUnits","dayOfMonth","dayOfWeek","numberHour","renderDisplay","nodeList","_dayNode_match","formatHours","hours","dayNode","days","numberRegx","formattedHours","FixCronjobSelect","_onChange","displayText","Suffix","setPrompt","cronjob","setCronjob","aiGenerating","setAIGenerating","cancelRequest","Popconfirm","IconCozStopCircle","AIButton","_rs_data_content","rs","CopilotType","AICronjobSelect","needRefInput","onLiteralChange","isRef","CronJobSelect","_value_type","CronJobType","useWatchFormErrors","content","cronjobTranslateText","DynamicForm","formMeta","components","fields","_components_field_setter","_field_layout","createEffectFromVariableProvider","provideLoopInputsVariables","provideLoopOutputsVariables","InputTreeWithValidation","InputTree","InputsTreeField","customReadonly","ValueExpressionInputField","selectStyle","ValueExpressionInputLegacy","NodeInputNameField","initValidate","isPureText","prefix","suffix","format","initialized","setInitialized","userEdited","setUserEdited","variableName","setVariableName","setText","WorkflowVariableFacadeService","computedVariableName","getVariableName","onInputChange","newInputValue","computedUniqueName","getUniqueName","paramsTitle","expressionTitle","onAppend","nthCannotDeleted","showEmptyText","nameProps","inputProps","_value_length","remove","append","length","_onAppend","ColumnsTitleWithAction","FieldRows","isTree","createInputsValidator","SettingOnErrorField","outputsPath","SettingOnErrorComp","ParametersInputGroupField","nameReadonly","fieldEditable","hiddenTypeTag","InputLabel","InputNameField","ParametersInputGroup","defaultAppendValue","hiddenTypes","ModelSelectField","ModelSelect","RadioSetterField","_props_dataTestName","ExpressionEditorLeagcy","CheckboxWithTipsField","itemTooltip","OutputsDisplayField","OutputsParamDisplay","_item_name","customLabel","customTooltip","customStyles","labelStyles","switchCustomStyles","AutoSizeTooltip","AnswerContentField","switchLabel","switchTooltip","enableStreamingOutput","editorFieldName","switchFieldName","switchTestId","LoopOutputSelectField","LoopOutputSelect","BatchModeField","fieldName","BatchMode","COLUMNS","CUSTOM_SETTER_MAP","CUSTOM_SETTER_STYLE","renderCustomSetter","fieldDef","customSetterProps","description","setterProps","CustomSetter","InputsKVField","_getSortedInputParameters","inputsDef","jsonSchema","getInputType","generateInputJsonSchema","reporter","getCustomSetterProps","topLevelReadonly","settingOnErrorPath","noCard","jsonImport","allowAppendRootData","withDescription","withRequired","batchMode","settingOnErrorIsOpen","outputTreeValidationRule","OutputTreeMetaSchema","omitErrorBody","isBatch","_v_children","c","batchValue","parsed","withNodeConfigForm","getCustomVal","_field_schema","_field_schema1","fieldType","minimum","maximum","exclusiveMinimum","exclusiveMaximum","bizExtend","inputEnum","enumVarNames","isEnum","isSlider","updateNodeValidate","settingOnErrorValidate","updateNodePorts","isSettingOnErrorV2","updateNodeFormat","formatOnInit","formatOnSubmit","formated","settingOnErrorInit","settingOnErrorSave","withSettingOnError","compose","fns","f","nodeV2RegistryUtils","inputTreeValidator","createOutputsValidator","outputTreeValidator","createAnswerContentValidator","CONTINUE_FORM_META","CONTINUE_NODE_REGISTRY","ContinueContent","TERMINATE_PLAN_PATH","ANSWER_CONTENT_PATH","STREAMING_OUTPUT_PATH","defaultTerminalPlanOptions","TerminatePlan","TerminatePlanField","_STREAMING_OUTPUT_PATH_split","terminatePlan","END_FORM_META","finalValue","_value_inputs","nodeMeta","streamingOutput","VariableTypeDTO","END_NODE_REGISTRY","EndContent","TerminatePlanContent","DropdownType","iconCozWarningCircleFillPaletteSvg","color","iconCozFolderUrlSvg","iconCozPeopleUrlSvg","iconCozSettingUrlSvg","findInputVariable","fieldPartInfo","matchedVariable","globalVariableKey","nodePart","fieldPart","parsedKeyPath","isValid","variable","nodePartEqual","curParsedKeyPath","getVariableRanges","ranges","cursor","tree","syntaxTree","_cursor_node_firstChild","_cursor_node_lastChild","matches","TRANS_WORKFLOW_VARIABLE_SOURCE","allGlobalVariableKeys","varKey","curMatch","SELECTED_OPTION_CLASSNAME","getOptionInfoFromDOM","root","foundNodes","optionElements","selectedIndex","element","selectNodeByIndex","elements","newSelectedElement","isSkipSelectionChangeUserEvent","tr","getVariableInfoFromExpression","expression","str","fieldKeyPath","nodeName","nodeNameWithDot","last","parts","part","getIconSvgString","GlobalVariableKey","getVariableFieldKeys","keysString","traverse","obj","_obj_children","child","useVariableWithNodeInfo","getNodeInfoInVariableMeta","_variable_expressionPath_keyPath_","_variable_globalVariableKey","nodeEntity","nodeTitle","iconUrl","_variableMeta_nodeTitle","HttpMethod","AuthType","CustomAuthAddToType","BodyType","authTypeToLabelKey","authTypeToField","bodyTypeToField","bodyTypeToLabel","contentTypeToBodyType","CONDITION_PATH","ElseField","CONDITION_PORT_ID_PREFIX","MultiCondition","getNodeTestId","branches","setBranches","draggingBranchUid","setDraggingBranchUid","expanded","updateSortedPortLines","validateResults","initValidateResultsWithBranches","validateAllBranches","useConditionValidate","isEqual","useAutoSyncRenameData","_branches","handleBranchChange","branch","innerIndex","calcUid","uidArr","handleDeleteBranch","handleMoveBranch","dragIndex","hoverIndex","prevBranches","update","handleDragEnd","draggingBranch","draggingIndex","ConditionContextProvider","ConditionHeader","Logic","ConditionDraggableContainer","DraggableConditionBranch","CustomDragLayer","DraggableConditionBranchPreview","HiddenCondition","handleConditionItemChange","branchIndex","conditionItemIndex","conditionItem","_activeBranch_condition_conditions","activeBranch","newConditions","subIndex","HiddenConditionItem","ConditionField","isNewNodeRender","IF_FORM_META","msg","flatten","previousValue","currentValue","_currentValue_left","_currentValue_operator","_currentValue_right","_currentValue_left1","_currentValue_left2","_currentValue_operator1","_currentValue_operator2","_currentValue_right1","_currentValue_right2","_previousValue","_inputs_branches","_branch_condition_conditions","nodeUtils","condition","left","right","IF_NODE_REGISTRY","IfContent","Conditions","OUTPUTS","CanvasLazy","lazy","CanvasNode","Canvas","Suspense","IMAGE_CANVAS_FORM_META","variableDTOToVO","variableVOToDTO","vo","_d_name","IMAGE_CANVAS_NODE_REGISTRY","ImageCanvasContent","INPUT_FORM_META","_value_outputs","o","INPUT_NODE_REGISTRY","WorkflowNodeVariablesMeta","InputContent","validateIntentsName","intents","namePath","idx","names","INPUT_CHAT_HISTORY_SETTING_ENABLE","INTENT_MODE","INTENTS","QUICK_INTENTS","SYSTEM_PROMPT","getDefaultOutputs","intentMode","INTENT_NODE_MODE","isShow","ModeRadio","Item","portId","optionPlaceholder","optionEnableInterpolation","testIdPath","IconCozMinusCircle","FormItemFeedback","ItemField","OptionItem","dragRef","canDrag","optionName","showOptionName","isField","IconHandle","IntentsField","showTitleRow","defaultOptionText","maxItems","addButtonClassName","showDisableAddTooltip","customDisabledAddTooltip","customClassName","handleChange","onItemDelete","onItemChange","AddActionButton","isPreview","convertNumberToLetters","Intents","STANDARD_INTENT_ITEMS","QuickIntents","MINIMAL_INTENT_ITEMS","ChatHistoryEnableSwitch","VALUE","ChatHistoryPanel","enableChatHistory","OutputTree","ChatHistoryRound","w","safeValue","InputsParameters","AdvancedSetting","isEmptyIntents","intent","INTENT_FORM_META","_context_node","isMinimal","linesFrom","lines","outputsFormItem","intentsFormItem","quickIntentsFormItem","_line_to","_line_info","_line_info1","DataEvent","_llmParam_systemPrompt_value_content","_llmParam_systemPrompt","outputs","llmParam","getDefaultLLMParams","model","intentModeInInit","isMinimalMode","emptyIntent","intentsValue","omit","_modelMeta_name","quickIntents","chatHistorySetting","chatHistoryRound","modelMeta","m","systemPromptItem","formatModelData","INTENT_NODE_REGISTRY","_nodeJSON_data_inputs_llmParam","_formData_inputs_chatHistorySetting","IntentContent","JSON_STRINGIFY_FORM_META","JSON_STRINGIFY_NODE_REGISTRY","JsonStringifyContent","LoopPath","LoopType","LoopSize","LoopFunctionSize","LoopVariablePrefix","LoopFunctionIDPrefix","getLoopFunctionID","loopID","getLoopID","loopFunctionID","createLoopFunctionTemplateData","loopNode","loopFunctionNode","loopNodeDataEntity","loopFunctionNodeDataEntity","loopNodeData","createLoopFunctionLines","loopId","loopFunctionId","createLoopFunctionJSON","createLoopFunction","loopJson","_loopJson_meta_position","_loopJson_meta_position1","loopPosition","loopFunctionJSON","LoopInputNameValidator","_get1","loopInputs","LoopInputValueValidator","LoopOutputNameValidator","loopOutputs","useLoopType","loopType","setLoopType","getLoopType","_formModel_getValueIn","useLayoutEffect","disposer","LoopArrayField","LoopCountField","formatLoopOutputName","_input_content_keyPath","LoopOutputsCommonField","LoopSettingsSection","LoopTypeOptions","LoopTypeField","computedTestId","LoopVariablesField","LoopFormRender","LOOP_FORM_META","loopCount","LOOP_NODE_REGISTRY","LoopArray","loopArrayParameters","variableTags","useInputParametersVariableTags","VariableTagList","LoopPort","LoopVariables","LoopContent","HistorySwitchField","DEFAULT_VALUE","HistoryRoundField","showLine","Inputs","FLAGS","getFlags","HISTORY_FIELDS","LTM_FORM_META","_value_inputs_inputParameters","_inputParameters_find","_inputParameters_find1","_historyRoundItem_content","inputParametersWithNoHistoryFields","historySwitchItem","historyRoundItem","historySetting","LTM_NODE_REGISTRY","LtmContent","OUTPUT_FORM_META","OUTPUT_NODE_REGISTRY","OutputContent","useFlags","OutputTextContent","OutputContentOld","isApiOutputsChanged","prevOutputs","nextOutputs","sortedPrevOutputs","sortBy","sortedNextOutputs","isChanged","prevOutput","nextOutput","updateApiParamValue","paramName","updateValue","_this","apiNameParam","getApiNodeIdentifier","apiParam","fieldsToExtract","blockInput","extractApiNodeData","apiDetailData","computeNodeVersion","latestVersionTs","latestVersionName","errorSettings","ERROR_BODY_NAME","generateErrorBodyMeta","IS_SUCCESS_NAME","generateIsSuccessMeta","usePluginNodeService","PluginNodeService","usePluginNodeServiceStore","pluginService","INPUTS_PATH","INPUT_PARAMS_PATH","INPUT_PARAMS_KEY","API_PARAMS_KEY","BATCH_MODE_PATH","BATCH_MODE_KEY","BATCH_PATH","BATCH_KEY","BATCH_INPUT_LIST_PATH","BATCH_INPUTS_LIST_KEY","NOT_FREE_PLUGINS_APINAME_DOC_MAP","ViewExample","debugExample","exampleNode","doShowExample","useViewExample","cache","Map","usePluginDetail","needQuery","_res_data_meta_info","ProductApi","ProductEntityType","PluginLink","identifier","getApiNodeDetail","searchParams","useSearchParams","spaceIdFromUrl","pluginProductStatus","apiNodeDetail","noNeedQuery","PluginProductStatus","storePluginId","IconCozLoading","_getProjectApi","ideNavigate","PluginFrom","url1","IconCozExit","createPluginLink","_form_initialValues_inputs","_apiDetail_inputs","indentifier","apiDetail","Batch","getPluginNodeService","getApiDetailApiParam","_nodeJson_inputs","getApiDetail","syncToApiNodeData","_getNodeTemplateInfoByType_mainColor","getNodeTemplateInfoByType","nodeDataEntity","apiNodeData","PLUGIN_FORM_META","inputDef","_formValues_inputs","createProvideNodeBatchVariables","originValue","_draft_inputs_batch","_draft_inputs_settingOnError","_draft_outputs_","draft","isBatchMode","originOutputs","_value_inputs_apiParam","_value_inputs_batch","_inputs_batch","_inputs_batch1","_latestValue_outputs","isUpdated","checkPluginUpdated","_outputs_","oldApiNameParam","isApiNameChanged","oldApiName","oldParamNames","newParamNames","isInputParamsChanged","isOutputsChanged","latestValue","syncToLatestValue","_draft_inputs","apiName","updateTime","syncInputParameters","_draft_inputs1","paramMap","keyBy","syncOutputs","outputVal","errorSetting","addErrorSetting","_originValue_outputs","originErrorBody","pluginInputs","pluginOutputs","inputParametersMap","refillInputParamters","getSortedInputParameters","inputParam","isCustomSetter","target","acc","cur","_value_inputs1","_value_inputs2","batchDTO","customProps","_nodeJson_data_inputs","getPluginFrom","PLUGIN_NODE_REGISTRY","DEFAULT_BATCH_PATH","_node_getNodeMeta","path","batchData","detail","nodeData","inputData","pluginFrom","_formValues_inputs_apiParam","_formValues_inputs1","PluginContent","_props_extra_nodeIds","getLeftRightVariable","_left_content_keyPath","_right_content_keyPath","_left_content1","_right_content1","_left_rawMeta_type","_right_rawMeta_type","leftKeyPath","rightKeyPath","leftVariable","rightVariable","MutableVariableAssignField","MutableVariableAssign","SetVariableField","SET_VARIABLE_FORM_META","valueExpressionValid","leftPath","rightPath","leftType","rightType","_formData_inputs_inputParameters","inputParameterVOs","inputParameterDTOs","inputParameterDTO","leftVariableDTO","rightVariableDTO","defaultInputParameterVOs","inputParameterVO","_leftVariableVO_content","_rightVariableVO_content","leftVariableVO","rightVariableVO","SET_VARIABLE_NODE_REGISTRY","SetTags","useSetTags","setVariableInputs","_variable_viewMeta_name","_left_content","pathLabel","viewType","SetVariableContent","submit","eventId","isOpen","triggerId","TriggerStatus","submitThrottle","_triggerSubmit","_dynamicInputs_TriggerForm_TriggerFormCronjobName_content","_dynamicInputs_TriggerForm_TriggerFormCronjobName","_dynamicInputs_TriggerForm_TriggerFormCronjobName1","dynamicInputs","_parameters","_parameters_key","TriggerForm","_v_content","k","useTrigger","triggerService","TriggerService","dynamicFormMeta","setTriggerIsOpen","_isOpen","onDynamicFormChange","triggerValues","latestTriggerValues","triggerValueSubmitProps","_triggerValueSubmitProps_current","_triggerId","triggerSubmit","_outputs_filter","FILE_TYPES","tabName","TriggerTestRunButton","FixedInputParameter","_d_description","START_FORM_META","_formValues_trigger","startNodeFormMeta","_startNodeFormMeta_find","inUseKeys","isPresetStartParams","flags","_outputsViewMeta_map","outputsViewMeta","viewMeta","_value_trigger_parameters","dtoMeta","literalContent","START_NODE_REGISTRY","generateField","StartContent","parseUploadURLFileName","_searchParams_get","getFileDefaultValue","assistType","getFileListDefaultValue","schema","getInputDefaultValue","_input_schema","getIdentifier","_inputs_workflowId","_inputs_workflowVersion","useSubWorkflowNodeService","SubWorkflowNodeService","useSubWorkflowNodeStore","subWorkflowService","SubWorkflowLink","workflowDetail","isProjectWorkflow","subWorkflowProjectId","commitId","latestVersion","workflowVersion","isLatest","handleClick","createSubWorkflowLink","_form_initialValues_inputs_workflowId","_form_initialValues_inputs_workflowVersion","_workflowDetail_inputs","getSubWorkflow","getSubWorkflowService","getSubWorkflowDetail","syncToSubWorkflowNodeData","_workflow_inputs","workflow","SUB_WORKFLOW_FORM_META","_subWorkflow_inputsDefinition","subWorkflow","inputNames","_value_inputs_workflowId","_value_inputs_workflowVersion","subWorkflowDetail","syncNodeMeta","Set","syncHiddenFields","end_type","space_id","inputDefs","workflowOutputs","workflowOutputsExisted","valueOutputsExisted","outputsValue","errorBody","prevOutputsValue","syncOutputValueKeys","currentOutputsValue","sameNameItem","prevItem","SUB_WORKFLOW_NODE_REGISTRY","isChatflowNode","conversationName","CONVERSATION_NAME","isConversationNameRef","_json","PlaygroundContext","startNode","nodeIsChatflow","startConversationNameVar","SubWorkflowContent","_data_nodeMeta","_data_inputs1","recreateNodeForm","getCacheKey","createStore","createWithEqualityFn","shallow","_resp_data","_workflowInfo_inputs","resp","workflowInfo","workflowTitle","errorMessage","response","notFoundMessage","createTransformOnInit","_inputs_inputParameters","transformOnInit","transformOnSubmit","getInputIsEmpty","_nodeUtils_refExpressionToValueDTO","TRIGGER_DELETE_FORM_META","TRIGGER_DELETE_NODE_REGISTRY","labelMap","requiredKeys","TriggerDeleteContent","_data_inputs_inputParameters","_data_inputs_inputParameters1","_data_inputs_inputParameters2","_data_inputs_inputParameters3","TRIGGER_READ_FORM_META","TRIGGER_READ_NODE_REGISTRY","fieldConfig","parentName","_field","capitalize","_childState_errors","childField","childState","TriggerListField","bindWorkflowId","TriggerBindWorkflowField","_bindWorkflowInfo_workflowParameters","_bindWorkflowInfo_workflowParameters1","bindWorkflowInfo","setBindWorkflowInfo","useAsyncEffect","_workflowInfo","_workflowParameters","fixedInputKeys","TRIGGER_UPSERT_FORM_META","triggerNodeDefaultFormValue","undefinedChecker","_props_value","_bindWorkflowInfo_inputs_find","_bindWorkflowInfo_inputs","_triggerNodeFormMeta_filter","_config_find_input_value_content","_config_find1","_data_inputs_meta","triggerNodeFormMeta","payload","DTOToVO","arrayDTOToObjVO","fixedInputsVO","dynamicInputsKeys","dynamicInputsVO","payloadVO","appId","fixedInputs","VOToDTO","objVOToArrayDTO","_Object_entries","_dynamicInputs_TriggerForm_TriggerFormCronjobName_type","_dynamicInputs_TriggerForm_TriggerFormCronjobName2","_payload","needSavePayloadKeys","TRIGGER_UPSERT_NODE_REGISTRY","_formData_inputs_dynamicInputs","configProperties","crontab","crontabProperties","payloadProperties","parameterKey","TriggerUpsertContent","dynamicKeys","_dynamicInputs_d_name","_variable_key","QueryClient","ModeValue","isSetMode","mode","VARIABLE_NODE_FORM_META","formattedInputParameters","VARIABLE_NODE_REGISTRY","inputParameter","VariableContent","uiOptions","RadioUI","useEntityFromContext","isBatchV2","processType","_node_parent","isExceptionSetting","SettingOnErrorProcessType","isBatchDisabled","disabledTooltip","BatchSettingForm","isSemiFormDestroyed","debouncedChange","commonSliderProps","InputSlider","LabelWithTooltip","BATCH_SIZE_MAX","BATCH_SIZE_MIN","BATCH_CONCURRENT_SIZE_MAX","BATCH_CONCURRENT_SIZE_MIN","_useField","batchModeName","actionButtonContent","_form_getValueIn","_form_getValueIn1","DEFAULT_BATCH_SIZE","DEFAULT_BATCH_CONCURRENT_SIZE","IconSetting","_childNameState_errors","childNameField","childNameState","NodeInputName","childInputField","childInputState","_field_value_length","_workflowNode_inputParameters","convertInputs","useParseText","containerRef","isError","shouldUseContainerRef","onChangeTrigger","focus","_setFocus","selectorBoxConfig","SelectorBoxConfigEntity","curEditorVal","setCurEditorVal","ExpressionEditorModel","setFocus","newFocusValue","overflow","ExpressionEditorEvent","Expression","_containerRef_current","ExpressionEditorCounter","fs","nameValidationRule","hideRequiredTag","tag","labelStyle","labelClassName","tootipPopoverClassName","tootipIconClassName","inputPrefix","defaultGetNames","_validatorConfig_rule","_validatorConfig_errorMessage","getNames","validatorConfig","invalidValues","skipValidate","validatorRule","validatorErrorMessage","foundSames","allowDeleteLast","emptyPlaceholder","showResponseFormat","needErrorBody","hide","defaultCollapse","needAppendChildWhenNodeIsPreset","sortValue","workflowReadonly","refresh","useRefresh","useIsSettingOnErrorV2","curBatchMode","onChangeWithoutHistory","outputTreeValue","WorkflowBatchService","sortedValue","sortErrorBody","component","fieldErrors","ValidationProvider","callback","Comp","inputTypes","matchType","forbidTypeCast","defaultInputType","variablesMatchedDataSource","formatVariableDataByMatchType","playgroundConfig","PlaygroundConfigEntity","SkillType","SkillKnowledgeSiderCategory","JsonEditorTheme","StringMethod","MATCHED_VARIABLE_TYPES","getMatchedVariableTypes","types","getVariableViewType","validateGroupName","variablesChangeEffects","createEffectOptions","_node_getData_getFormModel","_formModel_getField","hideTest","icon","subTitle","projectCommitVersion","isNodeSideSheet","NodeHeaderComponent","newTitle","InfoIcon","MergeStrategyField","TooltipWithDisabled","useVariablesFilter","matchedTypes","paths","_variable_content","_meta","GroupVariablesItem","groupIndex","variableIndex","execEntity","executeNodeResult","variablesField","variableField","disableDrag","isOutput","isOutputVariable","RefTagColor","GroupVariables","variablesError","variablesLength","variableFieldCandidate","setVariableFieldCandidate","variableFieldCandidateRef","updateVariableFieldCandidate","refreshKey","sortedFields","variablesIndex","GroupTypeTag","mergeGroup","alias","useGroupTypeAlias","_mergeGroup_variables","DeleteGroupButton","mergeGroupsField","canDelete","GroupName","disableEdit","isEdit","setIsEdit","inputRef","_inputRef_current","GroupHeader","nameField","nameFieldErrors","mergeGroupField","editName","handleBlur","editErrors","useEditName","setEditName","setEditErrors","validateName","_field_value","_e_target","message","AddGroupButton","generateGroupName","mergeGroups","groups","MergeGroupsField","variablesFieldState","VariableMergeForm","NodeMeta","VARIABLE_MERGE_FORM_META","provideMergeGroupVariablesEffect","viewType1","viewType2","firstVariableType","variableType","_initValue_inputs","_mergeGroup","_expr","VARIABLE_MERGE_NODE_REGISTRY","OutputSingleText","encodeValue","decodeValue","getIconByType","VARIABLE_TYPE_ICON_MAP","IconCozWarningCircle","GlobalVariableSelect","_value_content1","variablesFilter","useMatchType","selectRef","useGlobalVariableServiceState","isProject","isSelectedBotOrProject","useNewGlobalVariableCache","optionList","isGlobalVariableKey","handleVariableSelect","_selectRef_current","IconCozCross","selectedItem","op","BotProjectVariableSelect","arr","getDefaultInputValue","Render","getFieldType","valuePath","genGlobalVariablesFilter","selectedValue","_currentValue_content_keyPath","currentValueKeyPathStr","selectedValueKeyPathStrArr","_item_left_content_keyPath","_item_left","keyPathStr","_nameFieldState_errors","_childNameField_value_content_keyPath","nameFieldState","_inputFieldState_errors","inputFieldState","matchLeftType","VARIABLE_ASSIGN_FORM_META","_leftVariableVO_content_keyPath","_cur_left_content_keyPath","_cur_left_content_keyPath1","VARIABLE_ASSIGN_NODE_REGISTRY","_formData_$$input_decorator$$_inputParameters","_e_left_content_keyPath","ChatHistory","AddIcon","useModelType","isVisionInput","_value_input_rawMeta","DEFUALT_VISION_INPUT","VisionValueField","enabledTypes","newExpression","VisionNameField","_input_rawMeta","inputField","inputsField","VisionInputField","Vision","modelType","modelAbility","isVisionEqual","value1","value2","REASONING_CONTENT_NAME","readonlyTooltip","generateReasoningContent","isReasoningContent","isSystemReasoningContent","excludeReasoningContent","includeReasoningContent","addReasoningContent","_value_","removeReasoningContent","one","findReasoningContent","fn","_outputs__children","sortOutputs","omitSystemReasoningContent","provideReasoningContentEffect","getOutputs","defaultKnowledgeGlobalSetting","TypeMap","getDefaultModels","_modelMeta_model_params","defaultModel","p","_p_default_val_GenerationDiversity_Balance","camelCase","GenerationDiversity","ModelParamType","_models_find","_modelMeta_model_type","DEFAULT_MODEL_TYPE","reviseLLMParamPair","modelItemToBlockInput","_modelMeta_model_params_find","_k","libraryType2SkillsType","addSKillFromLibrary","library","_skills","skills","_skills_pluginFCParam","_library_detail_info","isDraftByProjectId","_skills_workflowFCParam","_library_detail_info1","data1","detail1","_skills_knowledgeFCParam","_library_detail_info2","_skills_knowledgeFCParam_global_setting","data2","detail2","UserPrompt","_fieldState_errors","_curModel_is_up_required","curModel","isUserPromptRequired","CopyButton","focusToAnchor","pos","ThemeExtension","EditorView","useLibrariesStore","libraries","info","openCreatePrompt","promptConfiguratorModal","usePromptConfiguratorModal","ExpandEditorContainer","IconCozTrayArrowUp","IconCozLightbulb","ContentSearchPopover","updateLibraries","onAddLibrary","isHitLLMPromptSkills","SystemPrompt","formatSkills2Libraries","skillsDetail","fcParam","_fcParam_pluginFCParam_pluginList","_fcParam_workflowFCParam_workflowList_filter","_fcParam_workflowFCParam_workflowList_filter1","_fcParam_knowledgeFCParam_knowledgeList_filter","_fcParam_knowledgeFCParam_knowledgeList_filter1","_fcParam_knowledgeFCParam_knowledgeList_filter2","plugins","_skillsDetail_plugin_detail_map","_skillsDetail_plugin_api_detail_map","pluginDetail","workflows","_skillsDetail_workflow_detail_map","imageflows","genDatasetFilter","_skillsDetail_dataset_detail_map","tables","images","docs","useSkillLibraries","useQuerySettingDetail","getSkillsQueryParams","handleAddLibrary","DefaultSystemPrompt","useQueryLatestFCSettings","OutputParamsForm","_initValue_response_style","handleParamEnableChange","indexPath","enable","_newValue_response_params","normalizeTreeData","responseParams","currentIndexPath","Tree","InputParamsForm","gap","scroll","useSize","handleDefaultValueChange","handleEnableChange","PluginSettingFormModal","originSetting","activeKey","setActiveKey","setting","updateSetting","Nav","NavItem","settingParams","responseSettings","WorkflowSetting","mutation","latestSetting","setLatestSetting","TooltipAction","IconCozSetting","newSetting","PluginSetting","KnowledgeSettingFormModal","_value_use_rerank","_value_use_rewrite","_value_use_nl2_sql","_props_setting","RagModeConfiguration","_newSetting_recall_strategy_use_rerank","_newSetting_recall_strategy_use_rewrite","_newSetting_recall_strategy_use_nl2sql","KnowledgeSetting","EmptySkill","BoundItemCard","pasteTitle","settingRender","versionRender","hideActions","IconCozCopy","copy","SiderCategory","selected","IconCozKnowledgeFill","SkillKnowledgeSider","category","setCategory","SkillModal","_boundSkills_pluginFCParam_pluginList","_boundSkills_workflowFCParam_workflowList","_boundSkills_knowledgeFCParam_knowledgeList","onSkillsChange","boundSkills","windowRef","spaceID","pluginModalParts","usePluginModalParts","workflowModalParts","useWorkflowModalParts","UITabsModal","KnowledgeListModalContent","shouldUpload","unitType","IDENav","AddSkill","modalVisible","setModalVisible","Skills","_value_pluginFCParam_pluginList","_value_workflowFCParam_workflowList","_value_knowledgeFCParam_knowledgeList","isSkillsEmpty","modelSkillDisabled","handleRemovePlugin","plugin","handleRemoveWorkflow","handleRemoveKnowledge","knowledge","handlePluginItemSettingChange","handleWorkflowItemSettingChange","handleKnowledgeGlobalSettingChange","_value_knowledgeFCParam_global_setting","_apiDetail_parameters","ApiSkillVersion","_detail_api_detail_parameters","_detail_name","SubWorkflowSkillVersion","_value_knowledgeFCParam","enableChatHistoryField","LLM_FORM_META","reasoningContentOmittedValue","inputValues","sameVisionInputs","differentVisionInputs","_playgroundContext_models","_playgroundContext_globalState_info","_schema_nodes","_curNode_data","_curNode_data1","formatReasoningContentOnInit","newOutputs","reasoningContent","formatFcParamOnInit","fcParamDTO","_fcParamDTO_knowledgeFCParam_global_setting","searchMode","curNode","_node","versionFromBackend","parseInt","formatFcParamOnSubmit","fcParamVO","_fcParamVO_knowledgeFCParam_global_setting","searchStrategy","formatReasoningContentOnSubmit","LLM_NODE_REGISTRY","_formData_$$input_decorator$$_chatHistorySetting","_formData_$$input_decorator$$","_nodeJSON_data_inputs_llmParam_find","CommentDefaultSize","CommentDefaultNote","CommentDefaultSchemaType","CommentDefaultVO","CommentDefaultDTO","COMMENT_NODE_REGISTRY","_inputs_schemaType","_inputs_note","_value_size","note","schemaType","getOutputsDefaultValue","SelectAndSetFieldsFieldContext","useSelectAndSetFieldsContext","MenuItem","Dropdown","SelectFieldsButton","selectedFieldIDs","filterSystemFields","testName","toggle","useToggle","addButtonTestId","isSystemField","SelectAndSetFieldsAddButton","_currentDatabase_fields","afterAppend","currentDatabase","fieldID","SelectAndSetFieldsSection","sectionRef","_sectionRef_current","SelectAndSetFieldsItem","shouldDisableRemove","fieldSchema","SelectAndSetFieldsList","SelectAndSetFieldsColumnsTitle","SelectAndSetFields","SelectAndSetFieldsField","DatabaseSelectField","afterChange","changed","setChanged","DatabaseSelect","BaseOutputsField","ConditionLogicField","showStroke","ConditionItemLogic","ConditionRightField","dataType","ConditionOperatorField","supportedOperators","operator","ConditionOperatorMap","optionsNode","ConditionLeftField","propOnChange","leftTypeToListTypeMaps","ConditionItemField","onClickRemove","useConditionLeftDataType","clearUpRightValueAndOperatorValueOnLeftChange","useClearUpRightValueAndOperatorValueOnLeftChange","useCleanupRightValueOnOperatorChange","rightFieldDataType","_leftTypeToListTypeMaps_dataType","ConditionList","ConditionAddButton","conditionListName","conditions","ConditionLogic","SqlField","DATABASE_NODE_FORM_META","DATABASE_NODE_REGISTRY","createConditionValidator","conditionFieldPath","conditionPathName","valueExpressionService","ValueExpressionService","createDatabaseValidator","databaseSelectFieldName","createSelectAndSetFieldsValidator","useCurrentDatabaseField","useResetCondition","conditionFieldName","DatabaseCreateForm","resetSelectAndSetFields","useResetSelectAndSetFields","_currentDatabase_fields_filter","newSelectFieldSchemas","createSelectAndSetFieldsFieldName","_field_required","DatabaseCreateFormMeta","DATABASE_CREATE_NODE_REGISTRY","_formData_inputs_databaseInfoList_","_formData_inputs_insertParam_fieldInfo","db","fieldInfo","_db_database_info_field_list","databaseField","_nodeJson_data_inputs_databaseInfoList__databaseInfoID","databaseId","DatabaseDeleteForm","resetCondition","deleteConditionFieldName","DatabaseDeleteFormMeta","deleteConditionListFieldName","deleteConditionLogicFieldName","DATABASE_DELETE_NODE_REGISTRY","_formData_inputs_deleteParam_condition_conditionList","conditionList","QueryLimitField","QueryFieldsAddButton","_cloneDeep","_outputListField_children","_outputListField_children1","_field_name","outputListField","rowNumField","QueryFieldsSection","QueryFieldsItem","QueryFieldsList","QueryFieldsColumnTitles","QueryFields","QueryFieldsField","useQueryFieldIDs","queryFieldsFieldValue","queryFieldsFieldName","useValidateOrderFields","queryFieldIDs","fieldSchemaFiltered","OrderByAddButton","queryFields","useQueryFields","OrderBySection","AceOrDescLabelMap","AceOrDescField","aceLabel","descLabel","SingleSelect","OrderByItemField","OrderByList","move","OrderBy","OrderByField","DatabaseQueryForm","resetQueryFields","resetOrderBy","resetQueryLimit","resetFields","queryConditionFieldName","orderByFieldName","queryLimitFieldName","DatabaseQueryFormMeta","queryConditionListFieldName","queryConditionLogicFieldName","DATABASE_QUERY_NODE_REGISTRY","_formData_inputs_selectParam_condition_conditionList","DatabaseUpdateForm","updateConditionFieldName","updateSelectAndSetFieldsFieldName","DatabaseUpdateFormMeta","updateConditionListFieldName","updateConditionLogicFieldName","DATABASE_UPDATE_NODE_REGISTRY","_formData_inputs_updateParam_fieldInfo","_formData_inputs_updateParam_condition_conditionList","DatasetSelectField","BaseDatasetSelect","DatasetParamsField","inputFiedlName","paramType","ColumnsTitle","DatasetSettingField","selectDataSet","BaseDatasetSetting","DATASET_NODE_FORM_META","_datasetParam_","_datasetParam_find","_datasetParam_find1","_datasetParam_find2","_datasetParam_find3","_datasetParam_find4","_datasetParam_find5","_datasetParam_find6","datasetParam","map","datasetParameters","datasetSetting","actualData","mapValue","DATASET_NODE_REGISTRY","DatasetWriteParserField","BaseDatasetWriteParser","DatasetWriteChunkField","BaseDatasetWriteChunk","columnsTitleStyle","DatasetWriteSetting","datasetPatam","TEST_RUN_FILE_NAME_KEY","getFormatFileUrl","_inputValue_rawMeta_fileName","_inputValue_content","originUrl","urlObj","URLSearchParams","DATASET_WRITE_FORM_META","separatorType","strategyParam","_nextInputParameters__input","_nextInputParameters__input1","_datasetWriteParameters_indexStrategy_vectorModel","datasetWriteParameters","nextInputParameters","DATASET_WRITE_NODE_REGISTRY","generateExpressionString","expressionStr","labelPrefix","namePrefix","matchesContent","varStr","md5","workflowVariable","_variableNode_getData_formModel_getFormItemValueByPath","variableNode","variableNodeTitle","generateAuth","_formData_inputs_auth","_formData_inputs_auth1","isAuthOpen","authType","authDataPathMap","pathStr","generateBody","_formData_inputs_body","bodyType","dataPath","bodyDataPathMap","prefixName","useKeyboard","keymap","keymapRef","handleKeydown","VariableSubfixWidget","WidgetType","_this_variableContext","_this_variableContext1","other","_other_variableContext","_other_variableContext1","range","variableContext","openList","VariablePrefixWidget","_varaibleInfo_iconUrl","_varaibleInfo_nodeTitle","varaibleInfo","isDarkTheme","languageId","nodeNamePart","split","wrapper","VariableDeleteWidget","useVariableInjector","openUpdateDropdown","updateRange","setPos","darkThemeRef","openUpdateDropdownRef","varibaleInfoRef","injector","useInjector","getVariableByKeyPath","useGetWorkflowVariableByKeyPath","StateField","selectionEnlarger","deletionEnlarger","astDecorator","sliceContent","nodeNameWithDotLength","variableDeleteWidget","variablePrefixWidget","variableSubfixWidget","flowVariableSubfixWidget","useKeyboardActions","_variableMenuRef_current","dropDownVisible","editorRef","interpolationContent","dropdownRef","variableMenuRef","openMenu","setActiveOptionHover","setTreeVisible","isInputDropdownOpen","applyNode","isOptionsVisible","next","apply","useOptionsOperations","optionsInfo","newIndex","optionsInfo1","elements1","selectedIndex1","newIndex1","NaN","_variableMenuRef_current1","_variableMenuRef_current_treeRef_state_keyEntities_selectedDataKey","selectedElement","selectedDataKey","variableTreeNode","DROPDOWN_CLASS","VariableExtension","variableDataSource","posKey","setPosKey","inputDropdownRef","inputTreeRef","updateDropdownRef","updateTreeRef","selection","useSelection","setSelection","selectionRef","view","handleSelectionChange","handleFocus","updateSelection","a","b","anchor","getInterpolationContentAtPos","inputDropdownOpen","setInputOpen","updateDropdownOpen","setUpdateOpen","dropdownType","setDropdownType","activeOption","setActiveOption","treeVisible","handleSelect","curEditorRef","_data_path","_curExpressionPath_keyPath_reduce","_curExpressionPath_keyPath_join","customRange","curEditor","curExpressionPath","WORKFLOW_VARIABLE_SOURCE","textContent","pre","getCurrentMentionReplaceRange","_variableDataSource_index","handleOptionHover","CompositeSelectTreePanel","selectType","SelectType","PositionMirror","String","_updateTreeRef_current_treeContainerRef","_node_value","textBefore","isInVariableString","regex","RegExp","isFieldPartEmpty","Mention","curPos","_variable_expressionPath","_variable_expressionPath_keyPath","_variable_expressionPath_keyPath1","getGlobalVariableAlias","INPUT_VALUE_COLUMNS","fileTypeDTOToVO","fileTypeVOToDTO","transformer","transformerCreator","findAllMatches","inputString","match","globalRegex","BaseJsonEditor","editerHeight","padding","borderRadius","apiRef","_apiRef_current","formatJson","CodeEditor","api","BaseRawTextEditor","TextEditor","BaseBashEditor","InnerEditor","editorContainerRef","allVariables","useAvailableWorkflowVariables","useNodeServiceAndRefreshForTitleChange","defaultVariableDataSource","useFormatVariableDataSource","dataSourceWithGlobal","useGlobalVariableCache","processDataSourceLabelRender","GlobalVarIcon","NodeIcon","variableDataSourceWithGroup","formatDataWithGlobalVariable","RawTextEditorField","InnerEditorContainer","EditorProvider","transStringParamsToFormData","transJsTypeToViewVariableType","CurlExpandEditor","curlStr","setCurlStr","setEditorTheme","onConfirmImport","nextFormData","curlObj","CURLParser","IconCozImport","IconCozMoon","IconCozSun","CurlImport","customClassNames","ApiSetter","parsedCurl","_parsedCurl_body","_contentTypeToBodyType_contentType","bodyData","_Object_keys","isGetMethod","curlHeaders","contentType","parsedCurlBody","editorClassName","isHover","setHover","JsonExpandEditor","_editorRef_current","IconCozBroom","JsonImport","IconCozEdit","JsonImportField","JsonExtensionEditorField","BodyTypeSelectField","handleOnChange","BodySetter","setterName","bodyFormName","bodyActions","AddToField","AuthSetter","authOpen","_sectionRef_current1","paramsFieldName","authDataDefaultValueMap","expressionStringValidator","emptyMessage","invalidMessage","hasInvalidVar","httpNameValidationRule","httpNameValidationRuleError","HTTP_FORM_META","isString","jsonErrors","curFormValues","formURLEncodedData","_binaryDataVO_input","headersData","headersDataVO","transHeadersData","paramsData","paramsDataVO","transParamsData","baseAuthPath","authDataPathArray","authDataPath","authData","transAuthData","baseBodyPath","formURLEncodedPath","transBodyData","formDataPath","typeMapping","parsedTypeMapping","initData","_param_input_value_rawMeta","_param_input_value_rawMeta1","binaryPath","binaryData","binaryDataVO","formattedValue","_transBodyData_typeMapping","transBodyData1","defaultBinaryDataVO","transBinaryData","HTTP_NODE_REGISTRY","_formData_inputs_apiInfo","headers","ratioOptions","RatioField","SizeSelect","thumbnails","thumbnail2","thumbnail3","thumbnail4","thumbnail5","thumbnail6","thumbnail7","thumbnail8","ModelField","ModelSettingField","DEFAULT_REFERENCE","ReferencesField","preprocessors","preprocessorName","urlName","weightName","createPreprocessorOptions","currentPreprocessor","allSelectedPreprocessor","isPreprocessorDisabled","currentItemPreprocessor","currentOptionPreprocessor","group","PromptField","promptName","negativePromptName","promptTestIDSuffix","negativePromptTestIDSuffix","useReferenceModelChangeEffect","_values_inputs","previousReferences","usePrevious","useUpdateEffect","_values_inputs_references","currentPreprocessors","reference","previousPreprocessors","preprocessor","useFieldValidate","IMAGE_GENERATE_FORM_META","references","invalidPreprocessors","IMAGE_GENERATE_NODE_REGISTRY","IMAGE_REFERENCE_NODE_REGISTRY","DEFAULT_USER_RESPONSE_PARAM_NAME","DEFAULT_OPTION_ID_NAME","DEFAULT_OPTION_CONTENT_NAME","DEFAULT_OUTPUT_NAMES","DEFAULT_USE_RESPONSE","DEFAULT_EXTRACT_OUTPUT","DEFAULT_ANSWER_OPTION_OUTPUT","SliderWithInputField","SliderWithInputLegacy","QuestionLimit","Divider","QuestionOutputs","answerType","extraOutput","isOptionAnswer","generatePortId","AnswerItemField","optionIndex","movePostion","answerOptions","AddOptionButton","AnswerOption","optionType","setMovePostion","isStaticOption","OptionType","AnswerOptionField","AnswerType","formatOutput","userOutput","extractOutput","extra_output","syncQuestionAnswerTypeEffect","portsData","syncOutputValue","QUESTION_FORM_META","_options_filter","anwserType","answer_type","dynamic_option","option_type","question","limit","isAnswerTypeOption","questionOutputs","questionParams","QUESTION_NODE_REGISTRY","inputProperties","_formData_questionParams","_formData_questionParams1","dynamicProperties","_formData_questionParams2","dynamicOption","PREFIX_STR","FIELD_NAME_MAP","BACK_END_NAME_MAP","STRING_METHOD_OPTIONS","OPTION_SCHEMA","CONCAT_DEFAULT_INPUTS","CONCAT_CHAR_SETTINGS","SPLIT_CHAR_SETTING","isSplitMethod","method","getDefaultOutput","isSplit","MethodSelectorSetter","getMaxIndex","prefixStr","maxIndex","_item_split_","isNaN","minItems","SettingForm","settingInfo","BaseDelimiterSelector","SettingButtonField","formSetting","ConcatSetting","concatCharFieldName","concatResultFieldName","tooltipImageUrlZh","SYSTEM_DELIMITER","DEFAULT_DELIMITER_OPTIONS","DelimiterSelectorField","getParam","FORM_META","setterValue","splitParams","concatParams","baseValue","resultItem","charItem","charOptions","hasChatOptions","delimiterValueItem","delimiterOptionsItem","arrayItemConcatChar","allArrayItemConcatChars","concatResult","delimiterValue","allDelimiters","TEXT_PROCESS_NODE_REGISTRY","NODE_WIDTH","helpLinkMap","createNodeRegistry","invalid","_content_keyPath","isEmptyArrayOrNil","defaultInputValue","defaultOutputValue","INPUT_COLUMNS_NARROW","syncConversationNameEffect","effect","clonedValue","conversationNameItem","noValue","headerTitle","headerTootip","_fieldName","_fieldConfig__fieldName","_fieldConfig__fieldName1","_fieldConfig__fieldName2","createFormRender","inputTooltip","outputTooltip","hasInputs","FixedInputParameters","FIELD_CONFIG","DEFAULT_CONVERSATION_VALUE","QUERY_MESSAGE_LIST_FORM_META","QUERY_MESSAGE_LIST_NODE_REGISTRY","CREATE_CONVERSATION_FORM_META","CREATE_CONVERSATION_NODE_REGISTRY","CLEAR_CONTEXT_FORM_META","CLEAR_CONTEXT_NODE_REGISTRY","createFormMeta","needSyncConversationName","formRenderComponent","customValidators","_fieldConfig_fieldName","UPDATE_CONVERSATION_NODE_REGISTRY","DELETE_CONVERSATION_NODE_REGISTRY","QUERY_CONVERSATION_LIST_NODE_REGISTRY","QUERY_CONVERSATION_HISTORY_NODE_REGISTRY","CREATE_MESSAGE_NODE_REGISTRY","UPDATE_MESSAGE_NODE_REGISTRY","DELETE_MESSAGE_NODE_REGISTRY","NODES_V2","NODE_V2_TYPES","r","isNodeV2","getNodeV2Registry","limiter","PromiseLimiter","promiseFactory","concurrency","enabled","computeRequired","isBoolean","isFunction","nodeMetaValidator","createEffect","batchInputListPath","batch","variableData","FlowNodeVariableData","scope","declarations","parseNodeBatchByInputList","ASTKind","parseNodeOutputByViewVariableMeta","settingOnErrorValidator","_extra_response_extra","WorkflowDocumentCustomOptions","fromPort","toPort","_fromPort_node","_toPort_node","linesService","_line_from","_line_from1","_line_to1","_fromPort_node_parent","_toPort_node_parent","_line_toPort","_line_toPort1","_linageNodes_find","activatedNode","linageNodes","currentNode","n","_node_getNodeRegister","titleCache","shouldReplaceId","event","handlePluginRiskWarning","dragNode","nodeV2Registry","getAntiOverlapPosition","dropNode","allowDrop","childrenLength","dropNodePadding","_newNode_getNodeMeta","newNode","subCanvas","noConfirm","ChatflowService","selectItem","conversationItem","Emitter","isLineError","ValidateErrorType","formatSchemaError2ValidateError","node_error","path_error","isLine","targetNodeId","errorType","formatSchemaError2WorkflowError","WorkflowValidationService","results","_key","nodeErrorMap","errorMap","nodeValidateResult","_errorMap_nodeId","nodeErrors","invalidError","getNodeError","nodeFormError","feedbacks","feedback","_issues_","issues","ports","inputPort","port","outputPort","isInputPortEmpty","isOutputPortEmpty","isAllLeafEnds","childNode","WorkflowNodeLinesData","errorMessage1","settingOnErrorPort","SETTING_ON_ERROR_PORT","isSettingOnErrorEmpty","force","_errors_this_globalState_workflowId","myErrors","ValueExpressionServiceImpl","ValueExpressionUtils","_value_value","_value_value1","valueExpression","setStore","getStore","DatabaseNodeServiceImpl","databaseSettingField","databaseSettingFieldDTO","fieldValue","_field_","conditionDTO","conditionLogic","conditionLogicDTO","ConditionLogicDTO","conditionOperator","LLM_WORKFLOW_FC_PATH","LLM_API_FC_PATH","isApiNode","isSubWorkflowNode","isLLMNode","getNodeFormModelV2","getNodeFormValue","nodeForm","nodeFormV2","getNodeFormModel","getMySubWorkflowNodeVersion","getMySubWorkflowNodeId","getLLMWorkflowFC","getLLMApiFC","getLLMWorkflowFCById","getLLMApiFCById","pluginList","getMyApiNodeParams","getMyApiNodeParam","block","getMyApiNodeId","getMyApiNodeVersion","getMyApiNodeName","setSubWorkflowNodeVersion","formModelV2","inputsModel","setApiNodeVersion","setLLMWorkflowFCVersion","setLLMApiFCVersion","getApiNodeVersion","getSubWorkflowNode","nodeRegistry","fetchApiNodeVersionName","forceUpdateModel","oldVersion","newVersion","allNodes","nodesWithVersion","wf","targetVersion","needUpdateNodes","needForceNodes","needUpdate","needForce","sameNodesWithVersion","targetVersionTs","oldNode","currentSpaceID","pluginSpaceID","pluginProductUnlistType","ProductUnlistType","STORAGE_KEY","sourceBotId","workflowJSON","_workflowJSON_nodes","userStoreService","_caseData_FieldName_Bot","_caseData_FieldName_Bot1","_caseData_FieldName_Bot2","caseData","FieldName","IntelligenceType","store","localStorage","jsonStore","typeSafeJSONParse","urlBot","targetWorkflowId","utils","executeStatus","WorkflowExeStatus","Tea","ReporterEventName","Tracker","time","queryClient","loadSubWorkflowInfo","llmNodes","llmSkillIdFields","subSkill","subSkillList","nextProps","saveVersion","dependencyHandlers","_nodes","resource","_resource_extra","_resource_saveVersion","isMetaUpdate","MessageOperateType","isFlowModeChange","isTestRunning","resourceVersion","BigInt","isCurVersionNewer","subWorkflowNodes","needUpdateNodeIds","apiNodes","_apiParam_input_value_content","messageVersion","isVersionNewer","WorkflowCustomDragService","WorkflowDragService","isDragging","oldDragNode","containerTransforms","entity","dragNodeType","_params_dropNode","dropNodeMeta","dropSubCanvas","collisionTransform","transforms","draggingRect","transformRect","newDropNode","selectService","FloatLayoutPanel","isPlainObject","comp","area","panel","prevKey","WorkflowLinesServiceProvider","Symbol","allLines","oldPortLines","newPortLines","intersectionToPort","intersection","originLine","containerNode","canDropMessage","PUBLIC_SPACE_ID","getLLMModels","_model_model_ability","_this_getModelAbility","_this_getModelByType","WorkflowOperationServiceProvider","_data_data","published","_resp_data_this_workflowId_workflow_id","ignoreStatusTransfer","vcsData","reqParams","_this_globalState_info_vcsData","_this_globalState_info_vcsData1","baseParam","VCSCanvasType","subExecuteId","workflowIds","filterType","pageParam","releasedList","bind","botId","ExecuteStatusToTestRunStateMap","useProject","WorkflowExecStatus","_res_data","botIdParams","sleep","nodeResults","reason","nodeEvents","nodeResult","currentLines","currentLine","_nodeResults_find","fromNodeStatus","NodeExeStatus","_nodeResult_errorLevel","errorLevel","_data_nodeResults","processResp","batchResults","START_NODE_ID","showNodeResults","END_NODE_ID","CHAT_NODE_DEFAULT_ID","promises","stack","registry","doc","loadingStartTime","userInfo","navigator","useWorkflowStore","loadDateTime","renderStartTime","renderTime","fitViewStartTime","fitViewTime","totalTime","_this_globalState_playgroundProps","relatedBot","isAssociateChange","associatedNodes","FlowNodeEntity","WorkflowLineEntity","env","workflowCommitId","flowMode","logId","isPreviewInProject","hasExecuteId","workflowJson","OperateType","_this_globalState_config_playgroundProps","_this_globalState_config_playgroundProps1","_this_globalState_config2","_workflowInfo_save_version","REPORT_EVENTS","WorkflowContentChangeType","LOW_DEBOUNCE_TIME","_this_saveOnChangeDisposable","_workflowJson_nodes","customWorkflowJson","UniqueWorkflowUtils","generateUniqueId","isExist","shouldHandle","QuadTree","WORKFLOW_CLIPBOARD_TYPE","WORKFLOW_EXPORT_TYPE","bindShortcuts","shortcuts","shortcut","bindContributions","safeFn","customAlphabet","nodeIds","addNodeId","_node_blocks","isUniqueId","nodeReplaceMap","newId","_node_parent_parent","_node_container","_node_container1","_node_container2","_node_container3","_node_container4","generateUniqueWorkflow","BaseNodeValidator","_this_next_run","ApiNodeValidator","CrossSpaceNodeValidator","DropValidator","dragService","parent","canDropInfo","LoopContextValidator","parentNodeMeta","parentSubCanvas","NestedLoopBatchValidator","SameSpaceValidator","SameWorkflowValidator","SceneNodeValidator","SubWorkflowSelfRefValidator","_node_data_inputs","ValidationChain","isValidNode","validationChain","isValidData","WorkflowPasteShortcutsContribution","WorkflowCommands","toContainer","rawJSON","container","_event","boundsData","center","rawNodeJSON","blocks","edges","_this_getNodeSubCanvas_canvasNode","_processedNodeJSON_meta","processedNodeJSON","nodePosition","edgeJSON","fromNode","toNode","lineInfo","_nodeJSON_meta","basePosition","WorkflowNodeEntity","nodeBounds","requestAnimationFrame","subCanvasHandler","createNode","containsNode","subdivide","quadTree","h","insert","capacity","newNodes","updatedQuadTree","canInsertIntoQuadrant","quadrant","insertIntoQuadrant","distance","n1","n2","dx","dy","distanceToBounds","calculateBounds","xValues","yValues","widths","heights","minX","maxX","minY","maxY","margin","createQuadTree","findNearestNeighbor","targetNode","findNearest","nearest","minDistance","currentDistance","q","getQuadTree","commentNodeHandler","followToNode","getFollowNode","WorkflowLayoutShortcutsContribution","startPositions","endPositions","TransformData","oldValue","FreeOperationType","hasSystemNodes","isAllSystemNodes","WorkflowDeleteShortcutsContribution","getValidNodes","validNodes","WorkflowCopyShortcutsContribution","err","_window_getSelection","_window_getSelection_toString","nodeJSONs","_nodeJSON_blocks","childJSON","_childJSON_blocks","blockJSON","_blockJSON_blocks","externalData","lineSet","nodeIdSet","linesData","rect","WorkflowZoomShortcutsContribution","WorkflowExportShortcutsContribution","filename","blob","Blob","link","WorkflowLoadShortcutsContribution","handleError","fileInput","_event_target_files","reader","FileReader","WorkflowSelectAllShortcutsContribution","generateInputToField","viewVariable","dtoMeta1","jsonSchema1","_i_input","isStaticObjectRef","_i_input1","_i_input2","properties","generateNodeFieldGroup","_registry_meta_test","fnName","groupName","isFormSchemaPropertyEmpty","generateFormNodeField","TestFormFieldName","isNeedBot","isNeedConversation","botValue","conversationValue","generateFormRelatedField","WorkflowNodeRefVariablesData","generateFormSchema","_node_getNodeRegistry_meta_test","formSchema","relatedField","nodeField","getNodeExecuteHistoryInput","nodeTypeStr","invert","NodeHistoryScene","safeJsonParse","stringifyFormValuesFromBacked","typeList","_nodeTypes_node_types","_nodeTypes_sub_workflow_node_types","_nodeTypes_nodes_properties","_nodeTypes_sub_workflow_nodes_properties","nodeTypes","flowTypeList","subFlowTypeList","sumTypeList","sumPropsList","hasVariableNode","hasVariableAssignNode","hasIntentNode","hasLLMNode","hasLTMNode","hasConversationNode","CONVERSATION_NODES","propsEnableChatHistory","hasNodeUseGlobalVariable","hasChatHistoryEnabledLLM","hasSubFlowNode","it","useFormDefaultValues","testFormService","useTestFormService","getDefaultValues","cacheData","historyValues","useOpenWorkflow","NodeSearchSectionType","AddOperation","_param","subitem","restProps","IconCozAddNode","tooltipStyle","containerStyle","nanoRef","WorkflowSLInput","_inputRef_current1","_$state_value","_props_onFocusTooltipProps","ellipsis","maxCount","showCount","isNumber","triggerFocus","$state","useReactive","hasEllipsis","clientWidth","scrollWidth","LimitCountNode","cs","UIInput","useWorkflowPlayground","workflowRef","propsRef","initConfig","setInitConfig","isRunning","setIsRunning","defaultInput","setDefaultInput","testRunCount","setTestRunCount","lastTestRunResultRef","testResultVisible","setTestResultVisible","workflowComp","_propsRef_current","WorkflowPlayground","_workflowRef_current","getTestRunResult","resp1","startNodeInfo","testRunBtnsComp","_workflowRef_current1","useForceUpdate","rerender","slotNames","SlotsContext","defaultContext","Slots","slotsDefinition","slotsRef","rerenderWithSlots","isMounted","setIsMounted","registerSlot","contents","unregisterSlot","slots","Slot","getIsInitWorkflow","workflowShcmaJson","_workflowShcmaJson_nodes","_workflowShcmaJson_edges","_initEndNode_data_inputs_inputParameters","initStartNode","_initStartNode_data_outputs","_initStartNode_data_outputs1","_initStartNode_data_outputs_","_initStartNode_data_outputs_1","_initStartNode_data_outputs_2","_initStartNode_data_outputs_3","_initStartNode_data_outputs2","_initStartNode_data_outputs_4","_initStartNode_data_outputs_5","initEndNode","isInitStartOuputs","isInitStart","isInitEnd","getWorkflowInnerSideSheetHolder","workflowContent","WORKFLOW_INNER_SIDE_SHEET_HOLDER","getWorkflowUrl","urlParams","isPluginApiNodeTemplate","nodeTemplate","isPluginCategoryNodeTemplate","isSubWorkflowNodeTemplate","isNodeTemplate","cURLStr","keyValueArray","keyValueObj","keyValueArr","yargObj","Reflect","yargHeaders","me","body","_this_yargObj_f","_this_yargObj","boundary","_this_yargObj2","_this_yargObj3","multipart","_this_yargObj4","_this_yargObj_F","_this_yargObj6","paramsD","paramsF","formParamData","urlSearchParams","yargsParser","_canvasRect_x","_canvasRect_y","canvasDOM","canvasRect","_resp_data_plugin_list_","PluginDevelopApi","PluginType","_resp_data_cate_list","_resp_data_plugin_api_list","_resp_data_plugin_category_list","_resp_data_template_list","favoritePlugins","typeKey","curr","temp","tool","_this_globalState","_this_globalState_flowMode","NODE_ORDER","pageNum","PAGE_SIZE","enabledNodeTypes","isSupportImageflowNodes","nodeCategoryList","_category_node_type_list_filter_map_filter","_category_plugin_category_id_list","pluginApiList","apiId","pluginCategoryList","categoryId","pluginCategory","_navigator","getSelectionBounds","ignoreOneSelect","selectedNodes","HoverLayerOptions","HoverLayer","Layer","hoveredNode","WorkflowPortEntity","selectionBounds","dragSuccess","_nodeTransforms_find","_target_className","nodeTransforms","portHovered","checkTargetFromLine","lineDom","PORT_BG_CLASS_NAME","lineHovered","nodeHovered","trans","checkTargetFromNode","nodeDom","nodeInContainer","lineHovered1","lineInContainer","EditorState","currentState","aliasKeyCodeMap","isAppleDevice","modifierKey","ShortcutsLayer","shortcutsHandler","isShortcutsMatch","keyString","isKeyStringMatch","countOfModifier","exactMatch","genArr","genLen","genModifier","aliasKeyCode","countKeyByEvent","total","BackgroundLayer","firstChild","RENDER_SIZE","scaleUnit","mod","viewBoxWidth","viewBoxHeight","scrollX","scrollY","scrollXDelta","scrollYDelta","domUtils","SCALE_WIDTH","unit","minor","patternSize","DOT_SIZE","newContent","svgElement","realScroll","SelectorBounds","WorkflowRenderContribution","PlaygroundLayer","FlowNodesContentLayer","FlowScrollBarLayer","WorkflowLinesLayer","FlowNodesTransformLayer","FlowSelectorBoundsLayer","FlowSelectorBoxLayer","location","FlowDebugLayer","WorkflowBezierLineContribution","WorkflowFoldLineContribution","Gesture","WorkflowRenderContainerModule","ContainerModule","PlaygroundContribution","FlowRendererContribution","WorkflowShortcutsRegistry","WorkflowLoader","renderRegistry","FlowRendererRegistry","loggerService","LoggerService","LoggerEvent","reportTti","WorkflowRenderProvider","modules","FlowDocumentContainerModule","FlowRendererContainerModule","WorkflowDocumentContainerModule","preset","createFreeAutoLayoutPlugin","createFreeStackPlugin","createNodeCorePlugin","PlaygroundReactProvider","loggerWithScope","PlayGroundErrorBoundary","ErrorBoundary","GlobalError","parentContainer","spaceList","setSpace","fetchSpaces","checkSpaceID","inited","useSpaceStore","isActive","initSpace","DndProvider","HTML5Backend","QueryClientProvider","WorkflowNodesContainerModule","WorkflowPageContainerModule","WorkflowHistoryContainerModule","WorkflowContainer","Warning","CrossHair","WorkflowPortRender","_entity_lines","hoverService","WorkflowHoverService","linesManager","WorkflowLinesManager","portType","portID","relativePosition","targetElement","setTargetElement","posX","updatePosX","posY","updatePosY","hovered","setHovered","linked","setLinked","setHasError","usePlaygroundReadonlyState","onMouseDown","isMouseCenterButton","newPos","dispose2","dispose3","dispose4","iconComp","ReactDOM","WorkflowShortcutsContribution","handlers","handler","commandId","_this_contribs","contrib","textMode","Enum","arraySetterItemContext","EnumImageModelLabel","thumbnail","Avatar","optionValue","TagType","StatusCode","ObservationModules","TraceChartsMode","ajvCache","ComponentsContext","FormSchema","_json_xdisabled","orderProperties","unOrderProperties","ReactiveState","SchemaContext","FormSchemaContext","getFieldPath","useCreateForm","innerValidate","visit","current","control","createForm","useFieldSchema","useFieldUIState","_schema_uiState","useObserve","useComponents","useFormSchema","useFormUIState","ObjectField","ReactiveField","parentUIState","useCurrentField","uiState","formUIState","useCurrentFieldState","GeneralField","computePath","RecursionField","renderProperties","SchemaField","normalizeNumber","isValidNumber","BigNumber","int","verifiedRef","fixed","num","innerInt","nextBig","css","clsx","IconCozArrowUpFill","IconCozArrowDownFill","languages","JSONEditor","createRenderer","createTheme","tags","tooltips","JsonEditor","extensions","didMount","schemaURI","getDebugUrl","search","gotoDebugFlow","safeFormatJsonString","useResize","dragging","setDragging","setHeight","resizing","startY","start","handleMouseMove","newHeight","handleMouseUp","_ref_current","BottomPanel","header","footer","resizable","innerHeight","isObject","InputJson","FieldItem","GroupCollapse","setIsOpen","inViewport","useInViewport","Collapsible","InputString","BaseInputNumber","InputInteger","InputTime","DatePicker","_date","dateString","SelectBoolean","SelectVoice","VoiceSelect","isBatchField","currentTag","BaseFieldItem","TestRunForm","onFormValuesChange","onMounted","TestRunFormProvider","useTestRunFormStore","isEmptyValue","generateFieldValidator","validateJsonSchema","Ajv","valueObject","valid","generateFieldComponent","getFileAccept","sortSpans","spans","uniqBy","span","startA","getTimeFromSpan","isTriggerFromSpan","_span_tags","t","getStrFromSpan","_target_value","getLongFromSpan","getTokensFromSpan","UNIT_SECOND","DECIMAL","UNIT_MINUTES","UNIT_HOUR","formatDuration","getGotoNodeParams","FocusButton","IconCozFocus","getStandardStatusCode","status","isSuccessStatus","SPAN_STATUS_CONFIG","NODE_PRESET_CONFIG_MAP","BotIcon","AgentIcon","LlmCallIcon","WorkflowIcon","WorkflowStartIcon","WorkflowEndIcon","PluginToolIcon","KnowledgeIcon","CodeIcon","ConditionIcon","CardIcon","MessageIcon","FLAME_THREAD_DEFAULT_CONFIG","FLAME_THREAD_DEFAULT_RECT_STYLE","FLAME_THREAD_DEFAULT_TOOLTIP_STYLE","traceTreeContext","collapsed","useTraceTree","CustomTreeNode","traceTreeCustomRenderer","renderGraphNodeConfig","treeMap","onCollapse","hover","spanNode","status_code","isBroken","span_id","duration","isCollapsed","isLeaf","customTypeConfigMap","character","getNodeConfig","nodeConfig","_customTypeConfigMap_type","presetNodeConfig","customTreeNodeContent","IconBroken","IconCozClockFill","UNIT_MILLISECOND","IconCozArrowLeftFill","renderCustomTreeNode","getSpanNodeInfo","_spanNode_children","isKeyNode","keyNodeParentId","childSpan","geSpanNodeInfoMap","spanNodes","spanNode2TreeNode","showKeyNodeOnly","_SPAN_STATUS_CONFIG_getStandardStatusCode","_spanNode2TreeNode_flat","_spanNode2TreeNode_flat1","lineStyle","treeNode","genRectStyle","_NODE_PRESET_CONFIG_MAP_type_flamethread","rectStyle","genRectNode","_span_span_id","startSpan","rowNo","end","spanData2flamethreadData","flattenTreeData","walk","nodeColNo","fatherNodeFlatten","nodeFlatten","childNodes","_childNode_indentDisabled","indentDisabled","defaultGlobalStyle","defaultLineStyle","selectedKey","gLineStyle","globalStyle","onMouseMove","onMouseEnter","onMouseLeave","hoverKey","setHoverKey","indent","verticalInterval","nodeBoxHeight","offsetX","adjustLineOrder","selectedLine","hoverLine","lineA","lineB","_lineA_endNode_zIndex","_lineB_endNode_zIndex","zIndexA","zIndexB","genLineStyle","genSvgPath","startColNo","startRowNo","endColNo","endRowNo","normalLineStyle","lineRadius","lineGap","nodeHeight","startX","lineASize","moveToStartPoint","lineASize1","lineBSize","endY","moveToStartPoint1","lineA1","qbc","endX","genLineAttrs","nodeKey","mergeWith","orgLines","lineStyle0","attrs","selectEnabled","colNo","nodeExtra","TraceTree","selectedSpanId","_lineStyle","_globalStyle","onCollapseChange","defaultDisplayMode","hostUser","setTreeData","setTreeMap","_TRACE_TREE_STYLE_DEFAULT_PROPS_lineStyle","_TRACE_TREE_STYLE_DEFAULT_PROPS_lineStyle1","_TRACE_TREE_STYLE_DEFAULT_PROPS_lineStyle2","defaultLabelStyle","defaultLabelText","datum","Flamethread","viewRef","viewSize","setViewSize","flamethreadData","rowHeight","visibleColumnCount","globalRectStyle","_globalLabelStyle","axisLabelSuffix","labelText","disableViewScroll","enableAutoFit","genLabelStyle","globalLabelStyle","topOffset","datazoomHeight","totalRowHeight","rowCount","uniqWith","node0","node1","yScaleRangeFactor","_viewRef_current","spec","orgData","GrammarMarkType","ComponentEnum","_scale","_element","scale","tickData","_params","_datum_rectStyle_normal","stroke","lineWidth","lineDash","_datum_rectStyle_hover_fill","_datum_rectStyle","_datum_rectStyle1","_datum_rectStyle_select_fill","_yScale_rangeFactor1","yScale","curRangeFactor","vHeight","updateSelectedKey","_elements_filter_","rectElm","initializeYScale","initializeScale","registerEvent","View","xScale","_e_target_attribute","direction","view1","resizeObserver","ResizeObserver","TraceFlameThread","setFlamethreadData","_rectStyle","_labelStyle","datazoomDecimals","traceFlamethreadCustomRenderer","defaultRectStyle","_traceFlamethreadCustomRenderer_renderTooltip1","_datum_extra","tips","fill","_span_name","jsonBig","JSONBig","textWithFallback","isJsonString","jsonData","jsonParseWithBigNumber","jsonString","jsonParse","objectToCopyableString","_err","CustomJsonViewer","onCopy","JsonViewer","_path","MessageTitle","copyContent","onCopyClick","IconCozCopyCheck","MessagePanel","_i18nInfo_title","i18nMapping","panelStyle","encrypted","jsonViewerProps","i18nInfo","txt","createTraceListStore","TraceListContext","TraceListProvider","isInOp","useTraceListStore","useTrace","setSpans","fetch","now","EmptyTemplate","LoadingTemplate","TraceTable","row","MODE_OPTIONS","TraceGraph","onOpenDetail","onGotoNode","setMode","ready","spans2SpanNodes","roots","sortedSpans","currentSpan","parent_id","_parentSpanNode_children","parentSpanNode","handleFocusNode","jumpToDebugFlow","_v_node_extra","getDefaultDate","MAX_TRACE_TIME","useOptions","date","setDate","setStatus","SpanStatus","setOptions","optionsCacheRef","patch","executeMode","maybeInitialSpan","_data_spans","handleDateChange","StatusSelect","triggerRender","IconCozFilter","StatusIcon","IconCozCheckMarkCircleFillPalette","IconCozCrossCircleFillPalette","StatusTag","SelectOption","isTrigger","IconCozCalendar","DatePickerCore","TraceSelect","onDateChange","handleDropdownVisibleChange","TraceListPanelHeader","TraceListPanel","PayBlock","PayBlocks","ResultViewer","TraceDetailPanel","_span_input","_span_input1","_span_output","_span_output1","pays","tokens","codeExtensions","ICON_MAP","IconCozFilePptx","IconCozFileDocx","IconCozFilePdf","IconCozFileTxt","IconCozFileZip","IconCozFileXlsx","IconCozFileCsv","IconCozFileCode","IconCozFileVideo","IconCozFileAudio","getIconByExtension","extension","_ICON_MAP_extension","fileIcon","IconCozFileOther","isImageFile","ext","FileIcon","Image","Icon","createSchemaField","FormSection","FileUpload","FullInput","FormCore","initialValues","handleFormChange","innerOnFormValuesChange","LazyComponent","LazyFormCore","connect","InputCore","mapProps","curFile","_curFile_url","_curFile_name","getParsedFileInfo","formatUrl","_params_get","getInitialValue","multipleVal","focusRef","handleUpload","fileInstance","getSubmitValue","newVal","singleFile","semiFileList","ClickAwayListener","Upload","fileItem","currentFile","currentFileItem","CozSwitch","BaseInputNumberAdapter","VoiceSelectBase","TextAreaCore","InnerFullInputAdapter","expand","businessKeyRef","innerValueRef","markdown","delta2md","md2html","LazyEditorFullInputInner","ToolbarItemEnum","modalTitle","action","_field_selfErrors","isDataField","FormPanelLayout","BaseTestButton","IconCozPlayFill","ResizablePanel","hideClose","onCloseWithoutAnimation","animation","translateYHeight","innerScrollRefFromProps","draggable","headerExtra","innerRef","_scrollRef","scrollRef","isResizing","startHeight","transition","setTransition","handleMouseDown","_innerRef_current","handleClose","_scrollRef_current","styleMemo","BasePanel","NodeEventInfo","checkHasError","checkHasWarning","PageItemEmpty","PageItem","paging","isWarning","echoPage","IconCozWarningCircleFill","MoreSelector","fixedCount","popoverRef","currentItem","hasWarning","handle","_popoverRef_current","PageSelector","fixedItems","moreItems","hasMore","LogDetailPagination","onlyShowError","onShowErrorChange","LogField","log","nodeStatus","onPreview","onOpenWorkflowLink","isConditionLog","ConditionLogParser","isFunctionCallLog","FunctionCallLogParser","isOutputLog","OutputLogParser","isWorkflowLinkLog","WorkflowLinkParser","NormalLogParser","EmptyFiled","IconCozIllusDone","LogFields","logs","generateLog","LogDetail","paginationFixedCount","LogImages","setPaging","setOnlyShowError","useGetCurrentResult","isUseAsyncNodeResult","currentAsync","echoCurrent","modal","useMarkdownModal","useEditFormSchemas","testset","bizCtx","bizComponentSubject","useTestsetManageStore","schemas","schemasLoading","useRequest","_testset_caseBase","localSchemas","debuggerApi","remoteSchemas","localSchemaMap","traverseTestsetNodeFormSchemas","ipt","getTestsetFormSubFieldName","isTestsetFormSameFieldType","assignTestsetFormDefaultValue","TestsetNameInput","_props_maxLength","_props_maxLength1","evt","BOT_FIELD_NAME","ComponentType","TESTSET_BOT_NAME","EditFormSectionTitle","FormLabel","FormItemSchemaType","typeLabel","getTestsetFormSubFieldType","subType","formRenders","CustomFormItem","getTestsetFormItemPlaceholder","requiredMsg","getTestsetFormItemCustomProps","FormSelect","TESTSET_FORM_BOOLEAN_SELECT_OPTIONS","FormTextArea","EditFormSection","_botFieldValue_value","_botFieldValue_value1","botFieldValue","useFieldState","isBotSelectProject","Fragment","TESTSET_NAME_FIELD","TESTSET_DESC_FIELD","TestsetEditForm","_data_caseBase","editMode","generating","closeEditPanel","updateEditPanelCloseState","validating","setValidating","submitting","setSubmitting","resizablePanelRef","IconCozArrowLeft","_resizablePanelRef_current","handleUpdateCloseState","_formRef_current1","testsetFormValues","inputSchemas","transTestsetBoolSelect2Bool","caseBase","nextSchemas","_formRef_current2","validateFields","_transTestsetFormItemSchema2Form","_data_caseBase_name","_data_caseBase1","_formRef_current_getValues","getTestsetNameRules","IS_OVERSEA","ChatFlowTestsetEditForm","onParentClose","TestsetEditPanel","isChatFlow","editPanelVisible","editData","InputFormEmpty"],"mappings":"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"}